<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.04641] Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models</title><meta property="og:description" content="This paper explores speculative speech recognition (SSR), where we empower conventional automatic speech recognition (ASR) with speculation capabilities, allowing the recognizer to run ahead of audio.
We introduce a me…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.04641">

<!--Generated on Mon Aug  5 13:52:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">[affiliation=1,2,3]BolajiYusuf
<span id="p1.3.1" class="ltx_ERROR undefined">\name</span>[affiliation=1]MuraliKarthick Baskar
<span id="p1.3.2" class="ltx_ERROR undefined">\name</span>[affiliation=1]AndrewRosenberg
<span id="p1.3.3" class="ltx_ERROR undefined">\name</span>[affiliation=1]BhuvanaRamabhadran














</p>
</div>
<h1 class="ltx_title ltx_title_document">Speculative Speech Recognition
<br class="ltx_break">by Audio-Prefixed Low-Rank Adaptation of Language Models</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">This paper explores speculative speech recognition (SSR), where we empower conventional automatic speech recognition (ASR) with speculation capabilities, allowing the recognizer to run ahead of audio.
We introduce a metric for measuring SSR performance and
we propose a model which does SSR by combining a RNN-Transducer-based ASR system with an audio-prefixed language model (LM).
The ASR system transcribes ongoing audio and feeds the resulting transcripts, along with an audio-dependent prefix, to the LM, which speculates likely completions for the transcriptions.
We experiment with a variety of ASR datasets on which show the efficacy our method and the feasibility of SSR as a method of reducing ASR latency.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>low-latency speech recognition, speculative speech recognition, prefix language model, low-rank adaptation
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The experience of users interacting with an automatic speech recognition (ASR) system is colored by its latency—how quickly it is able to respond to user requests—in addition to its accuracy.
A system which can respond quickly to user queries is generally preferred to a slower one with similar accuracy.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">There has therefore being considerable effort towards improving ASR latency, such as using lightweight, fully-causal or limited-context encoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and using modified training objectives such as timing penalties <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and FastEmit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> which encourage early output symbol emission to counteract the tendency of limited-context models to delay emission until enough context has been accumulated to make a confident decision.
These methods aim to make the latency as close to zero as possible without incurring significant degradation recognition accuracy, i.e.,
the best case for these approaches is that the model finishes transcription just as the user finishes speaking.
However, ASR is only the first step in user interaction and it is often followed by some form of natural language processing (NLP) such as information retrieval or machine translation or spoken language understanding.
Therefore, even if ASR latency were to reach zero, the overall end-to-end latency experienced by the user would still above zero.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Prefetching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> provides a template for reducing the end-to-end latency further.
The method hinges on the observation that there is a delay between the an ASR system's emission of the last output symbol and being able to confidently determine that the utterance has ended.
ASR hypotheses are sent downstream as soon as a token is emitted without awaiting the end-of-utterance confirmation, and the downstream computation commences immediately.
Thus, the endpointing latency is mitigated in exchange for extra computational overhead.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we tackle speculative speech recognition (SSR)<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Note that this bears no direct relation to speculative decoding in language modelling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, which involves using a small language model to speed up inference in a larger model.</span></span></span>, the problem of accurately generating the <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">full</em> transcription <em id="S1.p4.1.2" class="ltx_emph ltx_font_italic">before</em> the user has finished speaking.
Being able to solve this problem would allow any downstream NLP operations to be initiated earlier, and therefore further reduce end-to-end latency.
Conceptually, this problem has two parts: transcription and speculation,
where the former corresponds to the generation of textual tokens whose corresponding speech has actually been uttered and the latter corresponds to the generation of tokens which have no corresponding input speech.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Schwarz et. al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> recently proposed a method for SSR.
Their approach—which we take as baseline in this work—uses a hybrid of an RNN-Transducer (RNN-T) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> ASR system and a pretrained language model (LM), where the RNN-T transcribes the incomplete spoken utterance and the resulting hypotheses are fed into the LM to speculate likely completions.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The ASR-LM hybrid is however limited in that the LM is pretrained for generic text completion, and, consequently, does not account for the idiosyncrasies of operating on ASR output.
Specifically, it doesn't account for the fact that its input is a <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">hypothesis</em> from an ASR system and may thus contain errors; it also does not consider information contained in the audio signal which may be lost in the transcript, but would nevertheless be useful for speculation.
Therefore, we propose a modified scheme which prepends an audio-dependent soft prompt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to the ASR hypothesis as input to the LM.
We further finetune the LM with low-rank (LoRA) adapters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> which are trained—along with the soft prompt—to speculate the ideal suffix tokens to complete the ASR hypothesis,
thereby allowing the model to have knowledge of both its acoustic context and the possibility of errors from ASR when making decisions.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">As the main contributions of this work, we propose:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A Conformer-Transformer hybrid model which uses an audio-conditioned prefix LM for SSR, with experiments showing the efficacy of the proposed system on public datasets, and its superiority to purely LM-based speculation.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">An edit-distance-based alignment procedure to get training labels for error-aware speculative ASR systems.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Suffix Oracle Word Error Rate (SOWER), a metric for measuring the performance of a speculative ASR system, which accounts for various peculiarities of the problem.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2407.04641/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="253" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of the proposed model with trainable parameters in blue. A Conformer-Transducer ASR model decodes the speech into text. Then a language model is prompted with a prefix computed from the Conformer encoder output to predict likely completions for the partial ASR hypothesis.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.2" class="ltx_p">In conventional ASR, the goal is to predict a sequence of tokens <math id="S2.p1.1.m1.4" class="ltx_Math" alttext="Y=(y_{1},y_{2},\dots,y_{U})" display="inline"><semantics id="S2.p1.1.m1.4a"><mrow id="S2.p1.1.m1.4.4" xref="S2.p1.1.m1.4.4.cmml"><mi id="S2.p1.1.m1.4.4.5" xref="S2.p1.1.m1.4.4.5.cmml">Y</mi><mo id="S2.p1.1.m1.4.4.4" xref="S2.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.p1.1.m1.4.4.3.3" xref="S2.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S2.p1.1.m1.4.4.3.3.4" xref="S2.p1.1.m1.4.4.3.4.cmml">(</mo><msub id="S2.p1.1.m1.2.2.1.1.1" xref="S2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.p1.1.m1.2.2.1.1.1.2" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml">y</mi><mn id="S2.p1.1.m1.2.2.1.1.1.3" xref="S2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.5" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.3.3.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.p1.1.m1.3.3.2.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.2.cmml">y</mi><mn id="S2.p1.1.m1.3.3.2.2.2.3" xref="S2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.6" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">…</mi><mo id="S2.p1.1.m1.4.4.3.3.7" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.4.4.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.p1.1.m1.4.4.3.3.3.2" xref="S2.p1.1.m1.4.4.3.3.3.2.cmml">y</mi><mi id="S2.p1.1.m1.4.4.3.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.3.cmml">U</mi></msub><mo stretchy="false" id="S2.p1.1.m1.4.4.3.3.8" xref="S2.p1.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.4b"><apply id="S2.p1.1.m1.4.4.cmml" xref="S2.p1.1.m1.4.4"><eq id="S2.p1.1.m1.4.4.4.cmml" xref="S2.p1.1.m1.4.4.4"></eq><ci id="S2.p1.1.m1.4.4.5.cmml" xref="S2.p1.1.m1.4.4.5">𝑌</ci><vector id="S2.p1.1.m1.4.4.3.4.cmml" xref="S2.p1.1.m1.4.4.3.3"><apply id="S2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2.2">𝑦</ci><cn type="integer" id="S2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">…</ci><apply id="S2.p1.1.m1.4.4.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.p1.1.m1.4.4.3.3.3.2">𝑦</ci><ci id="S2.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3.3">𝑈</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.4c">Y=(y_{1},y_{2},\dots,y_{U})</annotation></semantics></math> given a sequence of acoustic inputs <math id="S2.p1.2.m2.4" class="ltx_Math" alttext="\mathbf{\textbf{X}}=(\mathbf{\textbf{x}}_{1},\mathbf{\textbf{x}}_{2},\dots,\mathbf{\textbf{x}}_{T})" display="inline"><semantics id="S2.p1.2.m2.4a"><mrow id="S2.p1.2.m2.4.4" xref="S2.p1.2.m2.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.4.4.5" xref="S2.p1.2.m2.4.4.5a.cmml">X</mtext><mo id="S2.p1.2.m2.4.4.4" xref="S2.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.p1.2.m2.4.4.3.3" xref="S2.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S2.p1.2.m2.4.4.3.3.4" xref="S2.p1.2.m2.4.4.3.4.cmml">(</mo><msub id="S2.p1.2.m2.2.2.1.1.1" xref="S2.p1.2.m2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.2.2.1.1.1.2" xref="S2.p1.2.m2.2.2.1.1.1.2a.cmml">x</mtext><mn id="S2.p1.2.m2.2.2.1.1.1.3" xref="S2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.4.4.3.3.5" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.3.3.2.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.2a.cmml">x</mtext><mn id="S2.p1.2.m2.3.3.2.2.2.3" xref="S2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.2.m2.4.4.3.3.6" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.p1.2.m2.4.4.3.3.7" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.p1.2.m2.4.4.3.3.3" xref="S2.p1.2.m2.4.4.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.4.4.3.3.3.2" xref="S2.p1.2.m2.4.4.3.3.3.2a.cmml">x</mtext><mi id="S2.p1.2.m2.4.4.3.3.3.3" xref="S2.p1.2.m2.4.4.3.3.3.3.cmml">T</mi></msub><mo stretchy="false" id="S2.p1.2.m2.4.4.3.3.8" xref="S2.p1.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.4b"><apply id="S2.p1.2.m2.4.4.cmml" xref="S2.p1.2.m2.4.4"><eq id="S2.p1.2.m2.4.4.4.cmml" xref="S2.p1.2.m2.4.4.4"></eq><ci id="S2.p1.2.m2.4.4.5a.cmml" xref="S2.p1.2.m2.4.4.5"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.4.4.5.cmml" xref="S2.p1.2.m2.4.4.5">X</mtext></ci><vector id="S2.p1.2.m2.4.4.3.4.cmml" xref="S2.p1.2.m2.4.4.3.3"><apply id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.1.2a.cmml" xref="S2.p1.2.m2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.1.2">x</mtext></ci><cn type="integer" id="S2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.2a.cmml" xref="S2.p1.2.m2.3.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2.2">x</mtext></ci><cn type="integer" id="S2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">…</ci><apply id="S2.p1.2.m2.4.4.3.3.3.cmml" xref="S2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.p1.2.m2.4.4.3.3.3.2a.cmml" xref="S2.p1.2.m2.4.4.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.p1.2.m2.4.4.3.3.3.2">x</mtext></ci><ci id="S2.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.p1.2.m2.4.4.3.3.3.3">𝑇</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.4c">\mathbf{\textbf{X}}=(\mathbf{\textbf{x}}_{1},\mathbf{\textbf{x}}_{2},\dots,\mathbf{\textbf{x}}_{T})</annotation></semantics></math>.
This generally involves modelling the conditional probability:</p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\displaystyle P(Y|\mathbf{\textbf{X}})=\prod_{u=1}^{U}P(y_{u}|\mathbf{\textbf{X}},y_{&lt;u})." display="inline"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3a.cmml">X</mtext></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E1.m1.2.2.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.2.cmml"><munderover id="S2.E1.m1.2.2.1.1.2.2a" xref="S2.E1.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S2.E1.m1.2.2.1.1.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.cmml">∏</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.3.2" xref="S2.E1.m1.2.2.1.1.2.2.2.3.2.cmml">u</mi><mo id="S2.E1.m1.2.2.1.1.2.2.2.3.1" xref="S2.E1.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.1.1.2.2.2.3.3" xref="S2.E1.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.1.1.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml">U</mi></munderover></mstyle><mrow id="S2.E1.m1.2.2.1.1.2.1" xref="S2.E1.m1.2.2.1.1.2.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.3" xref="S2.E1.m1.2.2.1.1.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.1.2" xref="S2.E1.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">u</mi></msub><mo fence="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1a.cmml">X</mtext><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml">u</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"></eq><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.3">𝑃</ci><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">X</mtext></ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><apply id="S2.E1.m1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2">product</csymbol><apply id="S2.E1.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.3"><eq id="S2.E1.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S2.E1.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.3.2">𝑢</ci><cn type="integer" id="S2.E1.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.1.1.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3">𝑈</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1"><times id="S2.E1.m1.2.2.1.1.2.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.2"></times><ci id="S2.E1.m1.2.2.1.1.2.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3">𝑃</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.2">conditional</csymbol><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.2">𝑦</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.3">𝑢</ci></apply><list id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><ci id="S2.E1.m1.1.1a.cmml" xref="S2.E1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">X</mtext></ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3"><lt id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\displaystyle P(Y|\mathbf{\textbf{X}})=\prod_{u=1}^{U}P(y_{u}|\mathbf{\textbf{X}},y_{&lt;u}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.7" class="ltx_p">In speculative ASR, instead of the full acoustic input (<span id="S2.p1.7.1" class="ltx_text ltx_markedasmath ltx_font_bold">X</span>), the input is a prefix comprising its first <math id="S2.p1.4.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.p1.4.m2.1a"><mi id="S2.p1.4.m2.1.1" xref="S2.p1.4.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m2.1b"><ci id="S2.p1.4.m2.1.1.cmml" xref="S2.p1.4.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m2.1c">j</annotation></semantics></math> frames, <math id="S2.p1.5.m3.4" class="ltx_Math" alttext="\mathbf{\textbf{X}}^{p}=(\mathbf{\textbf{x}}_{1},\mathbf{\textbf{x}}_{2},\dots,\mathbf{\textbf{x}}_{j}):j&lt;T" display="inline"><semantics id="S2.p1.5.m3.4a"><mrow id="S2.p1.5.m3.4.4" xref="S2.p1.5.m3.4.4.cmml"><mrow id="S2.p1.5.m3.4.4.3" xref="S2.p1.5.m3.4.4.3.cmml"><msup id="S2.p1.5.m3.4.4.3.5" xref="S2.p1.5.m3.4.4.3.5.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.4.4.3.5.2" xref="S2.p1.5.m3.4.4.3.5.2a.cmml">X</mtext><mi id="S2.p1.5.m3.4.4.3.5.3" xref="S2.p1.5.m3.4.4.3.5.3.cmml">p</mi></msup><mo id="S2.p1.5.m3.4.4.3.4" xref="S2.p1.5.m3.4.4.3.4.cmml">=</mo><mrow id="S2.p1.5.m3.4.4.3.3.3" xref="S2.p1.5.m3.4.4.3.3.4.cmml"><mo stretchy="false" id="S2.p1.5.m3.4.4.3.3.3.4" xref="S2.p1.5.m3.4.4.3.3.4.cmml">(</mo><msub id="S2.p1.5.m3.2.2.1.1.1.1" xref="S2.p1.5.m3.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.2.2.1.1.1.1.2" xref="S2.p1.5.m3.2.2.1.1.1.1.2a.cmml">x</mtext><mn id="S2.p1.5.m3.2.2.1.1.1.1.3" xref="S2.p1.5.m3.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.5.m3.4.4.3.3.3.5" xref="S2.p1.5.m3.4.4.3.3.4.cmml">,</mo><msub id="S2.p1.5.m3.3.3.2.2.2.2" xref="S2.p1.5.m3.3.3.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.3.3.2.2.2.2.2" xref="S2.p1.5.m3.3.3.2.2.2.2.2a.cmml">x</mtext><mn id="S2.p1.5.m3.3.3.2.2.2.2.3" xref="S2.p1.5.m3.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.5.m3.4.4.3.3.3.6" xref="S2.p1.5.m3.4.4.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.p1.5.m3.1.1" xref="S2.p1.5.m3.1.1.cmml">…</mi><mo id="S2.p1.5.m3.4.4.3.3.3.7" xref="S2.p1.5.m3.4.4.3.3.4.cmml">,</mo><msub id="S2.p1.5.m3.4.4.3.3.3.3" xref="S2.p1.5.m3.4.4.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.4.4.3.3.3.3.2" xref="S2.p1.5.m3.4.4.3.3.3.3.2a.cmml">x</mtext><mi id="S2.p1.5.m3.4.4.3.3.3.3.3" xref="S2.p1.5.m3.4.4.3.3.3.3.3.cmml">j</mi></msub><mo rspace="0.278em" stretchy="false" id="S2.p1.5.m3.4.4.3.3.3.8" xref="S2.p1.5.m3.4.4.3.3.4.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.p1.5.m3.4.4.4" xref="S2.p1.5.m3.4.4.4.cmml">:</mo><mrow id="S2.p1.5.m3.4.4.5" xref="S2.p1.5.m3.4.4.5.cmml"><mi id="S2.p1.5.m3.4.4.5.2" xref="S2.p1.5.m3.4.4.5.2.cmml">j</mi><mo id="S2.p1.5.m3.4.4.5.1" xref="S2.p1.5.m3.4.4.5.1.cmml">&lt;</mo><mi id="S2.p1.5.m3.4.4.5.3" xref="S2.p1.5.m3.4.4.5.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m3.4b"><apply id="S2.p1.5.m3.4.4.cmml" xref="S2.p1.5.m3.4.4"><ci id="S2.p1.5.m3.4.4.4.cmml" xref="S2.p1.5.m3.4.4.4">:</ci><apply id="S2.p1.5.m3.4.4.3.cmml" xref="S2.p1.5.m3.4.4.3"><eq id="S2.p1.5.m3.4.4.3.4.cmml" xref="S2.p1.5.m3.4.4.3.4"></eq><apply id="S2.p1.5.m3.4.4.3.5.cmml" xref="S2.p1.5.m3.4.4.3.5"><csymbol cd="ambiguous" id="S2.p1.5.m3.4.4.3.5.1.cmml" xref="S2.p1.5.m3.4.4.3.5">superscript</csymbol><ci id="S2.p1.5.m3.4.4.3.5.2a.cmml" xref="S2.p1.5.m3.4.4.3.5.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.4.4.3.5.2.cmml" xref="S2.p1.5.m3.4.4.3.5.2">X</mtext></ci><ci id="S2.p1.5.m3.4.4.3.5.3.cmml" xref="S2.p1.5.m3.4.4.3.5.3">𝑝</ci></apply><vector id="S2.p1.5.m3.4.4.3.3.4.cmml" xref="S2.p1.5.m3.4.4.3.3.3"><apply id="S2.p1.5.m3.2.2.1.1.1.1.cmml" xref="S2.p1.5.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m3.2.2.1.1.1.1.1.cmml" xref="S2.p1.5.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S2.p1.5.m3.2.2.1.1.1.1.2a.cmml" xref="S2.p1.5.m3.2.2.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.2.2.1.1.1.1.2.cmml" xref="S2.p1.5.m3.2.2.1.1.1.1.2">x</mtext></ci><cn type="integer" id="S2.p1.5.m3.2.2.1.1.1.1.3.cmml" xref="S2.p1.5.m3.2.2.1.1.1.1.3">1</cn></apply><apply id="S2.p1.5.m3.3.3.2.2.2.2.cmml" xref="S2.p1.5.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m3.3.3.2.2.2.2.1.cmml" xref="S2.p1.5.m3.3.3.2.2.2.2">subscript</csymbol><ci id="S2.p1.5.m3.3.3.2.2.2.2.2a.cmml" xref="S2.p1.5.m3.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.3.3.2.2.2.2.2.cmml" xref="S2.p1.5.m3.3.3.2.2.2.2.2">x</mtext></ci><cn type="integer" id="S2.p1.5.m3.3.3.2.2.2.2.3.cmml" xref="S2.p1.5.m3.3.3.2.2.2.2.3">2</cn></apply><ci id="S2.p1.5.m3.1.1.cmml" xref="S2.p1.5.m3.1.1">…</ci><apply id="S2.p1.5.m3.4.4.3.3.3.3.cmml" xref="S2.p1.5.m3.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.5.m3.4.4.3.3.3.3.1.cmml" xref="S2.p1.5.m3.4.4.3.3.3.3">subscript</csymbol><ci id="S2.p1.5.m3.4.4.3.3.3.3.2a.cmml" xref="S2.p1.5.m3.4.4.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.5.m3.4.4.3.3.3.3.2.cmml" xref="S2.p1.5.m3.4.4.3.3.3.3.2">x</mtext></ci><ci id="S2.p1.5.m3.4.4.3.3.3.3.3.cmml" xref="S2.p1.5.m3.4.4.3.3.3.3.3">𝑗</ci></apply></vector></apply><apply id="S2.p1.5.m3.4.4.5.cmml" xref="S2.p1.5.m3.4.4.5"><lt id="S2.p1.5.m3.4.4.5.1.cmml" xref="S2.p1.5.m3.4.4.5.1"></lt><ci id="S2.p1.5.m3.4.4.5.2.cmml" xref="S2.p1.5.m3.4.4.5.2">𝑗</ci><ci id="S2.p1.5.m3.4.4.5.3.cmml" xref="S2.p1.5.m3.4.4.5.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m3.4c">\mathbf{\textbf{X}}^{p}=(\mathbf{\textbf{x}}_{1},\mathbf{\textbf{x}}_{2},\dots,\mathbf{\textbf{x}}_{j}):j&lt;T</annotation></semantics></math>, and the goal is to model the <em id="S2.p1.7.2" class="ltx_emph ltx_font_italic">full</em> output sequence, <math id="S2.p1.6.m4.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.p1.6.m4.1a"><mi id="S2.p1.6.m4.1.1" xref="S2.p1.6.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m4.1b"><ci id="S2.p1.6.m4.1.1.cmml" xref="S2.p1.6.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m4.1c">Y</annotation></semantics></math>, as if the input were the entirety of <span id="S2.p1.7.3" class="ltx_text ltx_markedasmath ltx_font_bold">X</span>:</p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle P(Y|\mathbf{\textbf{X}}^{p})=\prod_{u=1}^{U}P(y_{u}|\mathbf{\textbf{X}}^{p},y_{&lt;u})." display="inline"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.2a.cmml">X</mtext><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml">p</mi></msup></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml"><munderover id="S2.E2.m1.1.1.1.1.2.2a" xref="S2.E2.m1.1.1.1.1.2.2.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.2.cmml">∏</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.2.3.2" xref="S2.E2.m1.1.1.1.1.2.2.2.3.2.cmml">u</mi><mo id="S2.E2.m1.1.1.1.1.2.2.2.3.1" xref="S2.E2.m1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.1.1.2.2.2.3.3" xref="S2.E2.m1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml">U</mi></munderover></mstyle><mrow id="S2.E2.m1.1.1.1.1.2.1" xref="S2.E2.m1.1.1.1.1.2.1.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.3" xref="S2.E2.m1.1.1.1.1.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.2.1.2" xref="S2.E2.m1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.2.1.1.1" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.2.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.2.1.1.1.1" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.2.cmml">y</mi><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.3.cmml">u</mi></msub><mo fence="false" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.3.cmml"><msup id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2a.cmml">X</mtext><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.2" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.2.cmml"></mi><mo id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.1" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.3.cmml">u</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.2.1.1.1.3" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"></eq><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝑃</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2">𝑌</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.2">X</mtext></ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><apply id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2">product</csymbol><apply id="S2.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.3"><eq id="S2.E2.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.3.2">𝑢</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3">𝑈</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1"><times id="S2.E2.m1.1.1.1.1.2.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.2"></times><ci id="S2.E2.m1.1.1.1.1.2.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.3">𝑃</ci><apply id="S2.E2.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.3">conditional</csymbol><apply id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.2">𝑦</ci><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.4.3">𝑢</ci></apply><list id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2"><apply id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2a.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.2">X</mtext></ci><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.2">𝑦</ci><apply id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3"><lt id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.1"></lt><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.2">absent</csymbol><ci id="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.3">𝑢</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle P(Y|\mathbf{\textbf{X}}^{p})=\prod_{u=1}^{U}P(y_{u}|\mathbf{\textbf{X}}^{p},y_{&lt;u}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Baseline speculative ASR with ASR-LM hybrid</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.3" class="ltx_p">Our approach to solving speculative ASR is based on the hybrid approach from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, with the LSTMs in the RNN-T and LM replaced by a pretrained Conformer-Transducer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> ASR model and a pretrained Transformer language model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
The Transducer is used to transcribe the spoken prefix <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{\textbf{X}}^{p}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><msup id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2a.cmml">X</mtext><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2a.cmml" xref="S2.SS1.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">X</mtext></ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbf{\textbf{X}}^{p}</annotation></semantics></math> into <math id="S2.SS1.p1.2.m2.3" class="ltx_Math" alttext="{Y}^{p}=({y}_{1},\dots,{y}_{r})" display="inline"><semantics id="S2.SS1.p1.2.m2.3a"><mrow id="S2.SS1.p1.2.m2.3.3" xref="S2.SS1.p1.2.m2.3.3.cmml"><msup id="S2.SS1.p1.2.m2.3.3.4" xref="S2.SS1.p1.2.m2.3.3.4.cmml"><mi id="S2.SS1.p1.2.m2.3.3.4.2" xref="S2.SS1.p1.2.m2.3.3.4.2.cmml">Y</mi><mi id="S2.SS1.p1.2.m2.3.3.4.3" xref="S2.SS1.p1.2.m2.3.3.4.3.cmml">p</mi></msup><mo id="S2.SS1.p1.2.m2.3.3.3" xref="S2.SS1.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.3.3.2.2" xref="S2.SS1.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.3.3.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.3.cmml">(</mo><msub id="S2.SS1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml">y</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.3.3.2.2.4" xref="S2.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.3.3.2.2.5" xref="S2.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml">r</mi></msub><mo stretchy="false" id="S2.SS1.p1.2.m2.3.3.2.2.6" xref="S2.SS1.p1.2.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.3b"><apply id="S2.SS1.p1.2.m2.3.3.cmml" xref="S2.SS1.p1.2.m2.3.3"><eq id="S2.SS1.p1.2.m2.3.3.3.cmml" xref="S2.SS1.p1.2.m2.3.3.3"></eq><apply id="S2.SS1.p1.2.m2.3.3.4.cmml" xref="S2.SS1.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.4.1.cmml" xref="S2.SS1.p1.2.m2.3.3.4">superscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.4.2.cmml" xref="S2.SS1.p1.2.m2.3.3.4.2">𝑌</ci><ci id="S2.SS1.p1.2.m2.3.3.4.3.cmml" xref="S2.SS1.p1.2.m2.3.3.4.3">𝑝</ci></apply><vector id="S2.SS1.p1.2.m2.3.3.2.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2"><apply id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3">𝑟</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.3c">{Y}^{p}=({y}_{1},\dots,{y}_{r})</annotation></semantics></math>, and the LM is used to predict the suffix <math id="S2.SS1.p1.3.m3.2" class="ltx_Math" alttext="Y^{s}=(y_{r+1}\dots,y_{U})" display="inline"><semantics id="S2.SS1.p1.3.m3.2a"><mrow id="S2.SS1.p1.3.m3.2.2" xref="S2.SS1.p1.3.m3.2.2.cmml"><msup id="S2.SS1.p1.3.m3.2.2.4" xref="S2.SS1.p1.3.m3.2.2.4.cmml"><mi id="S2.SS1.p1.3.m3.2.2.4.2" xref="S2.SS1.p1.3.m3.2.2.4.2.cmml">Y</mi><mi id="S2.SS1.p1.3.m3.2.2.4.3" xref="S2.SS1.p1.3.m3.2.2.4.3.cmml">s</mi></msup><mo id="S2.SS1.p1.3.m3.2.2.3" xref="S2.SS1.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S2.SS1.p1.3.m3.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.2.2.2.2.3" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">(</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.2.cmml">r</mi><mo id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml">…</mi></mrow><mo id="S2.SS1.p1.3.m3.2.2.2.2.4" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S2.SS1.p1.3.m3.2.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.3.m3.2.2.2.2.2.3" xref="S2.SS1.p1.3.m3.2.2.2.2.2.3.cmml">U</mi></msub><mo stretchy="false" id="S2.SS1.p1.3.m3.2.2.2.2.5" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.2b"><apply id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2"><eq id="S2.SS1.p1.3.m3.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.3"></eq><apply id="S2.SS1.p1.3.m3.2.2.4.cmml" xref="S2.SS1.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.4.1.cmml" xref="S2.SS1.p1.3.m3.2.2.4">superscript</csymbol><ci id="S2.SS1.p1.3.m3.2.2.4.2.cmml" xref="S2.SS1.p1.3.m3.2.2.4.2">𝑌</ci><ci id="S2.SS1.p1.3.m3.2.2.4.3.cmml" xref="S2.SS1.p1.3.m3.2.2.4.3">𝑠</ci></apply><interval closure="open" id="S2.SS1.p1.3.m3.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2"><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1"><times id="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1"></times><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.2">𝑦</ci><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3"><plus id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.1"></plus><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.2">𝑟</ci><cn type="integer" id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3">…</ci></apply><apply id="S2.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2.3">𝑈</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.2c">Y^{s}=(y_{r+1}\dots,y_{U})</annotation></semantics></math> by conditioning on the transcription.
This essentially parameterizes (<a href="#S2.E2" title="In 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) thus:</p>
<table id="S4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle P(Y|\mathbf{\textbf{X}}^{p})" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2a.cmml">X</mtext><mi id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">p</mi></msup></mrow><mo stretchy="false" id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><times id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"></times><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝑃</ci><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2">𝑌</ci><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">X</mtext></ci><ci id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle P(Y|\mathbf{\textbf{X}}^{p})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.3" class="ltx_Math" alttext="\displaystyle=\underbrace{\prod_{u=1}^{r}P_{\phi}(y_{u}|\mathbf{\textbf{X}}^{p},y_{&lt;u})}_{\text{Transcription by RNN-T}}\cdot\underbrace{\prod_{u=r+1}^{U}P_{\theta}(y_{u}|y_{&lt;u})}_{\text{Speculation by LM}}," display="inline"><semantics id="S2.E3.m2.3a"><mrow id="S2.E3.m2.3.3.1" xref="S2.E3.m2.3.3.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.2" xref="S2.E3.m2.3.3.1.1.2.cmml"></mi><mo id="S2.E3.m2.3.3.1.1.1" xref="S2.E3.m2.3.3.1.1.1.cmml">=</mo><mrow id="S2.E3.m2.3.3.1.1.3" xref="S2.E3.m2.3.3.1.1.3.cmml"><munder id="S2.E3.m2.3.3.1.1.3.2" xref="S2.E3.m2.3.3.1.1.3.2.cmml"><munder accentunder="true" id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml"><mrow id="S2.E3.m2.1.1.1" xref="S2.E3.m2.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.1.1.1.2" xref="S2.E3.m2.1.1.1.2.cmml"><munderover id="S2.E3.m2.1.1.1.2a" xref="S2.E3.m2.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3.m2.1.1.1.2.2.2" xref="S2.E3.m2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S2.E3.m2.1.1.1.2.2.3" xref="S2.E3.m2.1.1.1.2.2.3.cmml"><mi id="S2.E3.m2.1.1.1.2.2.3.2" xref="S2.E3.m2.1.1.1.2.2.3.2.cmml">u</mi><mo id="S2.E3.m2.1.1.1.2.2.3.1" xref="S2.E3.m2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m2.1.1.1.2.2.3.3" xref="S2.E3.m2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.1.1.1.2.3" xref="S2.E3.m2.1.1.1.2.3.cmml">r</mi></munderover></mstyle><mrow id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml"><msub id="S2.E3.m2.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.3.cmml"><mi id="S2.E3.m2.1.1.1.1.3.2" xref="S2.E3.m2.1.1.1.1.3.2.cmml">P</mi><mi id="S2.E3.m2.1.1.1.1.3.3" xref="S2.E3.m2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m2.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m2.1.1.1.1.1.1.1.4" xref="S2.E3.m2.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.1.4.2" xref="S2.E3.m2.1.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S2.E3.m2.1.1.1.1.1.1.1.4.3" xref="S2.E3.m2.1.1.1.1.1.1.1.4.3.cmml">u</mi></msub><mo fence="false" id="S2.E3.m2.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E3.m2.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.1.1.1.1.1.1.1.2.3.cmml"><msup id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2a.cmml">X</mtext><mi id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.E3.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.2.cmml"></mi><mo id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.1" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">&lt;</mo><mi id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">u</mi></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m2.1.1.2" xref="S2.E3.m2.1.1.2.cmml">⏟</mo></munder><mtext id="S2.E3.m2.3.3.1.1.3.2.2" xref="S2.E3.m2.3.3.1.1.3.2.2a.cmml">Transcription by RNN-T</mtext></munder><mo rspace="0.222em" id="S2.E3.m2.3.3.1.1.3.1" xref="S2.E3.m2.3.3.1.1.3.1.cmml">⋅</mo><munder id="S2.E3.m2.3.3.1.1.3.3" xref="S2.E3.m2.3.3.1.1.3.3.cmml"><munder accentunder="true" id="S2.E3.m2.2.2" xref="S2.E3.m2.2.2.cmml"><mrow id="S2.E3.m2.2.2.1" xref="S2.E3.m2.2.2.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.2.2.1.2" xref="S2.E3.m2.2.2.1.2.cmml"><munderover id="S2.E3.m2.2.2.1.2a" xref="S2.E3.m2.2.2.1.2.cmml"><mo movablelimits="false" id="S2.E3.m2.2.2.1.2.2.2" xref="S2.E3.m2.2.2.1.2.2.2.cmml">∏</mo><mrow id="S2.E3.m2.2.2.1.2.2.3" xref="S2.E3.m2.2.2.1.2.2.3.cmml"><mi id="S2.E3.m2.2.2.1.2.2.3.2" xref="S2.E3.m2.2.2.1.2.2.3.2.cmml">u</mi><mo id="S2.E3.m2.2.2.1.2.2.3.1" xref="S2.E3.m2.2.2.1.2.2.3.1.cmml">=</mo><mrow id="S2.E3.m2.2.2.1.2.2.3.3" xref="S2.E3.m2.2.2.1.2.2.3.3.cmml"><mi id="S2.E3.m2.2.2.1.2.2.3.3.2" xref="S2.E3.m2.2.2.1.2.2.3.3.2.cmml">r</mi><mo id="S2.E3.m2.2.2.1.2.2.3.3.1" xref="S2.E3.m2.2.2.1.2.2.3.3.1.cmml">+</mo><mn id="S2.E3.m2.2.2.1.2.2.3.3.3" xref="S2.E3.m2.2.2.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.E3.m2.2.2.1.2.3" xref="S2.E3.m2.2.2.1.2.3.cmml">U</mi></munderover></mstyle><mrow id="S2.E3.m2.2.2.1.1" xref="S2.E3.m2.2.2.1.1.cmml"><msub id="S2.E3.m2.2.2.1.1.3" xref="S2.E3.m2.2.2.1.1.3.cmml"><mi id="S2.E3.m2.2.2.1.1.3.2" xref="S2.E3.m2.2.2.1.1.3.2.cmml">P</mi><mi id="S2.E3.m2.2.2.1.1.3.3" xref="S2.E3.m2.2.2.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.2.2.1.1.2" xref="S2.E3.m2.2.2.1.1.2.cmml">​</mo><mrow id="S2.E3.m2.2.2.1.1.1.1" xref="S2.E3.m2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.2.2.1.1.1.1.2" xref="S2.E3.m2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.2.2.1.1.1.1.1" xref="S2.E3.m2.2.2.1.1.1.1.1.cmml"><msub id="S2.E3.m2.2.2.1.1.1.1.1.2" xref="S2.E3.m2.2.2.1.1.1.1.1.2.cmml"><mi id="S2.E3.m2.2.2.1.1.1.1.1.2.2" xref="S2.E3.m2.2.2.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.E3.m2.2.2.1.1.1.1.1.2.3" xref="S2.E3.m2.2.2.1.1.1.1.1.2.3.cmml">u</mi></msub><mo fence="false" id="S2.E3.m2.2.2.1.1.1.1.1.1" xref="S2.E3.m2.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E3.m2.2.2.1.1.1.1.1.3" xref="S2.E3.m2.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E3.m2.2.2.1.1.1.1.1.3.2" xref="S2.E3.m2.2.2.1.1.1.1.1.3.2.cmml">y</mi><mrow id="S2.E3.m2.2.2.1.1.1.1.1.3.3" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m2.2.2.1.1.1.1.1.3.3.2" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E3.m2.2.2.1.1.1.1.1.3.3.1" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S2.E3.m2.2.2.1.1.1.1.1.3.3.3" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.3.cmml">u</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E3.m2.2.2.1.1.1.1.3" xref="S2.E3.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m2.2.2.2" xref="S2.E3.m2.2.2.2.cmml">⏟</mo></munder><mtext id="S2.E3.m2.3.3.1.1.3.3.2" xref="S2.E3.m2.3.3.1.1.3.3.2a.cmml">Speculation by LM</mtext></munder></mrow></mrow><mo id="S2.E3.m2.3.3.1.2" xref="S2.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.3b"><apply id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1"><eq id="S2.E3.m2.3.3.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S2.E3.m2.3.3.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.2">absent</csymbol><apply id="S2.E3.m2.3.3.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.3"><ci id="S2.E3.m2.3.3.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.3.1">⋅</ci><apply id="S2.E3.m2.3.3.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.3.2">subscript</csymbol><apply id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1"><ci id="S2.E3.m2.1.1.2.cmml" xref="S2.E3.m2.1.1.2">⏟</ci><apply id="S2.E3.m2.1.1.1.cmml" xref="S2.E3.m2.1.1.1"><apply id="S2.E3.m2.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.2.1.cmml" xref="S2.E3.m2.1.1.1.2">superscript</csymbol><apply id="S2.E3.m2.1.1.1.2.2.cmml" xref="S2.E3.m2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.2.2.1.cmml" xref="S2.E3.m2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.E3.m2.1.1.1.2.2.2.cmml" xref="S2.E3.m2.1.1.1.2.2.2">product</csymbol><apply id="S2.E3.m2.1.1.1.2.2.3.cmml" xref="S2.E3.m2.1.1.1.2.2.3"><eq id="S2.E3.m2.1.1.1.2.2.3.1.cmml" xref="S2.E3.m2.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m2.1.1.1.2.2.3.2.cmml" xref="S2.E3.m2.1.1.1.2.2.3.2">𝑢</ci><cn type="integer" id="S2.E3.m2.1.1.1.2.2.3.3.cmml" xref="S2.E3.m2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m2.1.1.1.2.3.cmml" xref="S2.E3.m2.1.1.1.2.3">𝑟</ci></apply><apply id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1"><times id="S2.E3.m2.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.2"></times><apply id="S2.E3.m2.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.2">𝑃</ci><ci id="S2.E3.m2.1.1.1.1.3.3.cmml" xref="S2.E3.m2.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.E3.m2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E3.m2.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S2.E3.m2.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.4.3">𝑢</ci></apply><list id="S2.E3.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.2">X</mtext></ci><ci id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><apply id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3"><lt id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.1"></lt><csymbol cd="latexml" id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.2">absent</csymbol><ci id="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.2.2.2.3.3">𝑢</ci></apply></apply></list></apply></apply></apply></apply><ci id="S2.E3.m2.3.3.1.1.3.2.2a.cmml" xref="S2.E3.m2.3.3.1.1.3.2.2"><mtext mathsize="70%" id="S2.E3.m2.3.3.1.1.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.3.2.2">Transcription by RNN-T</mtext></ci></apply><apply id="S2.E3.m2.3.3.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.3.3.1.cmml" xref="S2.E3.m2.3.3.1.1.3.3">subscript</csymbol><apply id="S2.E3.m2.2.2.cmml" xref="S2.E3.m2.2.2"><ci id="S2.E3.m2.2.2.2.cmml" xref="S2.E3.m2.2.2.2">⏟</ci><apply id="S2.E3.m2.2.2.1.cmml" xref="S2.E3.m2.2.2.1"><apply id="S2.E3.m2.2.2.1.2.cmml" xref="S2.E3.m2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.2.1.cmml" xref="S2.E3.m2.2.2.1.2">superscript</csymbol><apply id="S2.E3.m2.2.2.1.2.2.cmml" xref="S2.E3.m2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.2.2.1.cmml" xref="S2.E3.m2.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.E3.m2.2.2.1.2.2.2.cmml" xref="S2.E3.m2.2.2.1.2.2.2">product</csymbol><apply id="S2.E3.m2.2.2.1.2.2.3.cmml" xref="S2.E3.m2.2.2.1.2.2.3"><eq id="S2.E3.m2.2.2.1.2.2.3.1.cmml" xref="S2.E3.m2.2.2.1.2.2.3.1"></eq><ci id="S2.E3.m2.2.2.1.2.2.3.2.cmml" xref="S2.E3.m2.2.2.1.2.2.3.2">𝑢</ci><apply id="S2.E3.m2.2.2.1.2.2.3.3.cmml" xref="S2.E3.m2.2.2.1.2.2.3.3"><plus id="S2.E3.m2.2.2.1.2.2.3.3.1.cmml" xref="S2.E3.m2.2.2.1.2.2.3.3.1"></plus><ci id="S2.E3.m2.2.2.1.2.2.3.3.2.cmml" xref="S2.E3.m2.2.2.1.2.2.3.3.2">𝑟</ci><cn type="integer" id="S2.E3.m2.2.2.1.2.2.3.3.3.cmml" xref="S2.E3.m2.2.2.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.E3.m2.2.2.1.2.3.cmml" xref="S2.E3.m2.2.2.1.2.3">𝑈</ci></apply><apply id="S2.E3.m2.2.2.1.1.cmml" xref="S2.E3.m2.2.2.1.1"><times id="S2.E3.m2.2.2.1.1.2.cmml" xref="S2.E3.m2.2.2.1.1.2"></times><apply id="S2.E3.m2.2.2.1.1.3.cmml" xref="S2.E3.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.1.3.1.cmml" xref="S2.E3.m2.2.2.1.1.3">subscript</csymbol><ci id="S2.E3.m2.2.2.1.1.3.2.cmml" xref="S2.E3.m2.2.2.1.1.3.2">𝑃</ci><ci id="S2.E3.m2.2.2.1.1.3.3.cmml" xref="S2.E3.m2.2.2.1.1.3.3">𝜃</ci></apply><apply id="S2.E3.m2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m2.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m2.2.2.1.1.1.1.1.2.2.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.E3.m2.2.2.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S2.E3.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3.2">𝑦</ci><apply id="S2.E3.m2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3"><lt id="S2.E3.m2.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S2.E3.m2.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E3.m2.2.2.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m2.2.2.1.1.1.1.1.3.3.3">𝑢</ci></apply></apply></apply></apply></apply></apply><ci id="S2.E3.m2.3.3.1.1.3.3.2a.cmml" xref="S2.E3.m2.3.3.1.1.3.3.2"><mtext mathsize="70%" id="S2.E3.m2.3.3.1.1.3.3.2.cmml" xref="S2.E3.m2.3.3.1.1.3.3.2">Speculation by LM</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.3c">\displaystyle=\underbrace{\prod_{u=1}^{r}P_{\phi}(y_{u}|\mathbf{\textbf{X}}^{p},y_{&lt;u})}_{\text{Transcription by RNN-T}}\cdot\underbrace{\prod_{u=r+1}^{U}P_{\theta}(y_{u}|y_{&lt;u})}_{\text{Speculation by LM}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.5" class="ltx_p">where <math id="S2.SS1.p1.4.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S2.SS1.p1.4.m1.1a"><mi id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><ci id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">\phi</annotation></semantics></math> denotes the parameters of the Transducer model and <math id="S2.SS1.p1.5.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p1.5.m2.1a"><mi id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.1b"><ci id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.1c">\theta</annotation></semantics></math> denotes the parameters of the language model.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Audio-aware speculative ASR</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.3" class="ltx_p">Simply stacking the Transducer and the LM as in Section <a href="#S2.SS1" title="2.1 Baseline speculative ASR with ASR-LM hybrid ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a> implicitly assumes that the transcription is an efficient enough summary of the input speech for the purposes of speculating the suffix, i.e., that <math id="S2.SS2.p1.1.m1.2" class="ltx_Math" alttext="P(Y^{s}|X^{p},Y^{p})=P(Y^{s}|Y^{p})" display="inline"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><msup id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.2.cmml">Y</mi><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.3.cmml">s</mi></msup><mo fence="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.3.cmml"><msup id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.2.cmml">Y</mi><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml">p</mi></msup></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.1.m1.2.2.3" xref="S2.SS2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S2.SS2.p1.1.m1.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.3" xref="S2.SS2.p1.1.m1.2.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.2.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p1.1.m1.2.2.2.1.1" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.2.2.2.1.1.2" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.2.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><msup id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.2" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.2.cmml">Y</mi><mi id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.3" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.3.cmml">s</mi></msup><mo fence="false" id="S2.SS2.p1.1.m1.2.2.2.1.1.1.1" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.1.cmml">|</mo><msup id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.2" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.2.cmml">Y</mi><mi id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.3" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.3.cmml">p</mi></msup></mrow><mo stretchy="false" id="S2.SS2.p1.1.m1.2.2.2.1.1.3" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2"><eq id="S2.SS2.p1.1.m1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.3"></eq><apply id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"><times id="S2.SS2.p1.1.m1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.2"></times><ci id="S2.SS2.p1.1.m1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.3">𝑃</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.2">𝑌</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.4.3">𝑠</ci></apply><list id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2"><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.2">𝑌</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.2.2.2.3">𝑝</ci></apply></list></apply></apply><apply id="S2.SS2.p1.1.m1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2"><times id="S2.SS2.p1.1.m1.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.2"></times><ci id="S2.SS2.p1.1.m1.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.3">𝑃</ci><apply id="S2.SS2.p1.1.m1.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.2">𝑌</ci><ci id="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.2.3">𝑠</ci></apply><apply id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.2">𝑌</ci><ci id="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.2.2.2.1.1.1.3.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">P(Y^{s}|X^{p},Y^{p})=P(Y^{s}|Y^{p})</annotation></semantics></math>.
However, the speech signal itself contains information such as speaker, channel or domain clues which could be useful for better constraining the language model output.
Furthermore, since the Transducer objective considers all possible alignments
(in contrast to hybrid models which use forced alignment)
,
there is only a loose correspondence between the input frame and the output token (<math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">j</annotation></semantics></math> and <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">r</annotation></semantics></math> respectively in Section <a href="#S2.SS1" title="2.1 Baseline speculative ASR with ASR-LM hybrid ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>), meaning that the ASR can choose to transcribe sounds later than they are uttered.
We argue, therefore, that it would be useful to condition the suffix generation on a representation of the audio signal.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.5" class="ltx_p">To this end, we add a fixed-length representation, <math id="S2.SS2.p2.1.m1.3" class="ltx_Math" alttext="\mathbf{\textbf{A}}^{p}=(\mathbf{\textbf{a}}_{1},\dots,\mathbf{\textbf{a}}_{M})" display="inline"><semantics id="S2.SS2.p2.1.m1.3a"><mrow id="S2.SS2.p2.1.m1.3.3" xref="S2.SS2.p2.1.m1.3.3.cmml"><msup id="S2.SS2.p2.1.m1.3.3.4" xref="S2.SS2.p2.1.m1.3.3.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.3.3.4.2" xref="S2.SS2.p2.1.m1.3.3.4.2a.cmml">A</mtext><mi id="S2.SS2.p2.1.m1.3.3.4.3" xref="S2.SS2.p2.1.m1.3.3.4.3.cmml">p</mi></msup><mo id="S2.SS2.p2.1.m1.3.3.3" xref="S2.SS2.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p2.1.m1.3.3.2.2" xref="S2.SS2.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.2.2.3" xref="S2.SS2.p2.1.m1.3.3.2.3.cmml">(</mo><msub id="S2.SS2.p2.1.m1.2.2.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.2.2.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2a.cmml">a</mtext><mn id="S2.SS2.p2.1.m1.2.2.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.1.m1.3.3.2.2.4" xref="S2.SS2.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p2.1.m1.3.3.2.2.5" xref="S2.SS2.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p2.1.m1.3.3.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.3.3.2.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2a.cmml">a</mtext><mi id="S2.SS2.p2.1.m1.3.3.2.2.2.3" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.2.2.6" xref="S2.SS2.p2.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.3b"><apply id="S2.SS2.p2.1.m1.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3"><eq id="S2.SS2.p2.1.m1.3.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3.3"></eq><apply id="S2.SS2.p2.1.m1.3.3.4.cmml" xref="S2.SS2.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.4.1.cmml" xref="S2.SS2.p2.1.m1.3.3.4">superscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.4.2a.cmml" xref="S2.SS2.p2.1.m1.3.3.4.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.3.3.4.2.cmml" xref="S2.SS2.p2.1.m1.3.3.4.2">A</mtext></ci><ci id="S2.SS2.p2.1.m1.3.3.4.3.cmml" xref="S2.SS2.p2.1.m1.3.3.4.3">𝑝</ci></apply><vector id="S2.SS2.p2.1.m1.3.3.2.3.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2"><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.2a.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2">a</mtext></ci><cn type="integer" id="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">…</ci><apply id="S2.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.2.2.2.2a.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2">a</mtext></ci><ci id="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3">𝑀</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.3c">\mathbf{\textbf{A}}^{p}=(\mathbf{\textbf{a}}_{1},\dots,\mathbf{\textbf{a}}_{M})</annotation></semantics></math>, of the audio as a prefix to the language model.
<math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{\textbf{A}}^{p}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msup id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2a.cmml">A</mtext><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2a.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">A</mtext></ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathbf{\textbf{A}}^{p}</annotation></semantics></math> is the output of a multihead attention layer whose keys and values are projections of the Transducer's Conformer encoder output, and whose queries are projections a sequence of <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">M</annotation></semantics></math> trainable vectors, <math id="S2.SS2.p2.4.m4.3" class="ltx_Math" alttext="\mathbf{\textbf{Q}}=(\mathbf{\textbf{q}}_{1},\dots,\mathbf{\textbf{q}}_{M})" display="inline"><semantics id="S2.SS2.p2.4.m4.3a"><mrow id="S2.SS2.p2.4.m4.3.3" xref="S2.SS2.p2.4.m4.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.3.3.4" xref="S2.SS2.p2.4.m4.3.3.4a.cmml">Q</mtext><mo id="S2.SS2.p2.4.m4.3.3.3" xref="S2.SS2.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.p2.4.m4.3.3.2.2" xref="S2.SS2.p2.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p2.4.m4.3.3.2.2.3" xref="S2.SS2.p2.4.m4.3.3.2.3.cmml">(</mo><msub id="S2.SS2.p2.4.m4.2.2.1.1.1" xref="S2.SS2.p2.4.m4.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.2.2.1.1.1.2" xref="S2.SS2.p2.4.m4.2.2.1.1.1.2a.cmml">q</mtext><mn id="S2.SS2.p2.4.m4.2.2.1.1.1.3" xref="S2.SS2.p2.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.4.m4.3.3.2.2.4" xref="S2.SS2.p2.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.p2.4.m4.3.3.2.2.5" xref="S2.SS2.p2.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p2.4.m4.3.3.2.2.2" xref="S2.SS2.p2.4.m4.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.3.3.2.2.2.2" xref="S2.SS2.p2.4.m4.3.3.2.2.2.2a.cmml">q</mtext><mi id="S2.SS2.p2.4.m4.3.3.2.2.2.3" xref="S2.SS2.p2.4.m4.3.3.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S2.SS2.p2.4.m4.3.3.2.2.6" xref="S2.SS2.p2.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.3b"><apply id="S2.SS2.p2.4.m4.3.3.cmml" xref="S2.SS2.p2.4.m4.3.3"><eq id="S2.SS2.p2.4.m4.3.3.3.cmml" xref="S2.SS2.p2.4.m4.3.3.3"></eq><ci id="S2.SS2.p2.4.m4.3.3.4a.cmml" xref="S2.SS2.p2.4.m4.3.3.4"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.3.3.4.cmml" xref="S2.SS2.p2.4.m4.3.3.4">Q</mtext></ci><vector id="S2.SS2.p2.4.m4.3.3.2.3.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2"><apply id="S2.SS2.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.2.2.1.1.1.2a.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1.2">q</mtext></ci><cn type="integer" id="S2.SS2.p2.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">…</ci><apply id="S2.SS2.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.3.3.2.2.2.2a.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2.2.2">q</mtext></ci><ci id="S2.SS2.p2.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.4.m4.3.3.2.2.2.3">𝑀</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.3c">\mathbf{\textbf{Q}}=(\mathbf{\textbf{q}}_{1},\dots,\mathbf{\textbf{q}}_{M})</annotation></semantics></math>.
Thus, when the Transformer speculates the <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">u</annotation></semantics></math>th overall output token, its input is:</p>
<table id="S4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\displaystyle c_{u}=\bigl{(}\mathbf{\textbf{a}}_{1},\mathbf{\textbf{a}}_{2},\dots,\mathbf{\textbf{a}}_{M},\mathbf{\textbf{e}}[y_{1}],\mathbf{\textbf{e}}[y_{2}],\dots\mathbf{\textbf{e}}[y_{u-1}]\bigr{)}," display="inline"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.8" xref="S2.E4.m1.2.2.1.1.8.cmml"><mi id="S2.E4.m1.2.2.1.1.8.2" xref="S2.E4.m1.2.2.1.1.8.2.cmml">c</mi><mi id="S2.E4.m1.2.2.1.1.8.3" xref="S2.E4.m1.2.2.1.1.8.3.cmml">u</mi></msub><mo id="S2.E4.m1.2.2.1.1.7" xref="S2.E4.m1.2.2.1.1.7.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.6.6" xref="S2.E4.m1.2.2.1.1.6.7.cmml"><mo maxsize="120%" minsize="120%" id="S2.E4.m1.2.2.1.1.6.6.7" xref="S2.E4.m1.2.2.1.1.6.7.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.2a.cmml">a</mtext><mn id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E4.m1.2.2.1.1.6.6.8" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><msub id="S2.E4.m1.2.2.1.1.2.2.2" xref="S2.E4.m1.2.2.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.2.2.2.2" xref="S2.E4.m1.2.2.1.1.2.2.2.2a.cmml">a</mtext><mn id="S2.E4.m1.2.2.1.1.2.2.2.3" xref="S2.E4.m1.2.2.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S2.E4.m1.2.2.1.1.6.6.9" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><mi mathvariant="normal" id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">…</mi><mo id="S2.E4.m1.2.2.1.1.6.6.10" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><msub id="S2.E4.m1.2.2.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.3.3.3.2" xref="S2.E4.m1.2.2.1.1.3.3.3.2a.cmml">a</mtext><mi id="S2.E4.m1.2.2.1.1.3.3.3.3" xref="S2.E4.m1.2.2.1.1.3.3.3.3.cmml">M</mi></msub><mo id="S2.E4.m1.2.2.1.1.6.6.11" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><mrow id="S2.E4.m1.2.2.1.1.4.4.4" xref="S2.E4.m1.2.2.1.1.4.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.4.4.4.3" xref="S2.E4.m1.2.2.1.1.4.4.4.3a.cmml">e</mtext><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.4.4.4.2" xref="S2.E4.m1.2.2.1.1.4.4.4.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.4.4.4.1.1" xref="S2.E4.m1.2.2.1.1.4.4.4.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.4.4.1.1.2" xref="S2.E4.m1.2.2.1.1.4.4.4.1.2.1.cmml">[</mo><msub id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.2" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.2.cmml">y</mi><mn id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.3" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.4.4.1.1.3" xref="S2.E4.m1.2.2.1.1.4.4.4.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.6.6.12" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><mrow id="S2.E4.m1.2.2.1.1.5.5.5" xref="S2.E4.m1.2.2.1.1.5.5.5.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.5.5.5.3" xref="S2.E4.m1.2.2.1.1.5.5.5.3a.cmml">e</mtext><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.5.5.5.2" xref="S2.E4.m1.2.2.1.1.5.5.5.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.5.5.5.1.1" xref="S2.E4.m1.2.2.1.1.5.5.5.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.5.5.5.1.1.2" xref="S2.E4.m1.2.2.1.1.5.5.5.1.2.1.cmml">[</mo><msub id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.2" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.2.cmml">y</mi><mn id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.3" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.5.5.5.1.1.3" xref="S2.E4.m1.2.2.1.1.5.5.5.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.6.6.13" xref="S2.E4.m1.2.2.1.1.6.7.cmml">,</mo><mrow id="S2.E4.m1.2.2.1.1.6.6.6" xref="S2.E4.m1.2.2.1.1.6.6.6.cmml"><mi mathvariant="normal" id="S2.E4.m1.2.2.1.1.6.6.6.3" xref="S2.E4.m1.2.2.1.1.6.6.6.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.6.6.6.2" xref="S2.E4.m1.2.2.1.1.6.6.6.2.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.6.6.6.4" xref="S2.E4.m1.2.2.1.1.6.6.6.4a.cmml">e</mtext><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.6.6.6.2a" xref="S2.E4.m1.2.2.1.1.6.6.6.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.6.6.6.1.1" xref="S2.E4.m1.2.2.1.1.6.6.6.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.6.6.6.1.1.2" xref="S2.E4.m1.2.2.1.1.6.6.6.1.2.1.cmml">[</mo><msub id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.2" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.2.cmml">y</mi><mrow id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.2.cmml">u</mi><mo id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.1" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.6.6.6.1.1.3" xref="S2.E4.m1.2.2.1.1.6.6.6.1.2.1.cmml">]</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S2.E4.m1.2.2.1.1.6.6.14" xref="S2.E4.m1.2.2.1.1.6.7.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.7.cmml" xref="S2.E4.m1.2.2.1.1.7"></eq><apply id="S2.E4.m1.2.2.1.1.8.cmml" xref="S2.E4.m1.2.2.1.1.8"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.8.1.cmml" xref="S2.E4.m1.2.2.1.1.8">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.8.2.cmml" xref="S2.E4.m1.2.2.1.1.8.2">𝑐</ci><ci id="S2.E4.m1.2.2.1.1.8.3.cmml" xref="S2.E4.m1.2.2.1.1.8.3">𝑢</ci></apply><vector id="S2.E4.m1.2.2.1.1.6.7.cmml" xref="S2.E4.m1.2.2.1.1.6.6"><apply id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.2a.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2">a</mtext></ci><cn type="integer" id="S2.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S2.E4.m1.2.2.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.2.2.2.2a.cmml" xref="S2.E4.m1.2.2.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.2.2.2.2">a</mtext></ci><cn type="integer" id="S2.E4.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.2.2.2.3">2</cn></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">…</ci><apply id="S2.E4.m1.2.2.1.1.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3.3.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.3.3.2a.cmml" xref="S2.E4.m1.2.2.1.1.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.3.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.3.3.2">a</mtext></ci><ci id="S2.E4.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3.3.3">𝑀</ci></apply><apply id="S2.E4.m1.2.2.1.1.4.4.4.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4"><times id="S2.E4.m1.2.2.1.1.4.4.4.2.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.2"></times><ci id="S2.E4.m1.2.2.1.1.4.4.4.3a.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.3"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.4.4.4.3.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.3">e</mtext></ci><apply id="S2.E4.m1.2.2.1.1.4.4.4.1.2.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1"><csymbol cd="latexml" id="S2.E4.m1.2.2.1.1.4.4.4.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.2">𝑦</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.4.4.4.1.1.1.3">1</cn></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.5.5.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5"><times id="S2.E4.m1.2.2.1.1.5.5.5.2.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.2"></times><ci id="S2.E4.m1.2.2.1.1.5.5.5.3a.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.3"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.5.5.5.3.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.3">e</mtext></ci><apply id="S2.E4.m1.2.2.1.1.5.5.5.1.2.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1"><csymbol cd="latexml" id="S2.E4.m1.2.2.1.1.5.5.5.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.2">𝑦</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.5.5.5.1.1.1.3">2</cn></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1.6.6.6.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6"><times id="S2.E4.m1.2.2.1.1.6.6.6.2.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.2"></times><ci id="S2.E4.m1.2.2.1.1.6.6.6.3.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.3">…</ci><ci id="S2.E4.m1.2.2.1.1.6.6.6.4a.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.4"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.6.6.6.4.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.4">e</mtext></ci><apply id="S2.E4.m1.2.2.1.1.6.6.6.1.2.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1"><csymbol cd="latexml" id="S2.E4.m1.2.2.1.1.6.6.6.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.2">𝑦</ci><apply id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3"><minus id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.2">𝑢</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.6.6.6.1.1.1.3.3">1</cn></apply></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle c_{u}=\bigl{(}\mathbf{\textbf{a}}_{1},\mathbf{\textbf{a}}_{2},\dots,\mathbf{\textbf{a}}_{M},\mathbf{\textbf{e}}[y_{1}],\mathbf{\textbf{e}}[y_{2}],\dots\mathbf{\textbf{e}}[y_{u-1}]\bigr{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.7" class="ltx_p">where <math id="S2.SS2.p2.6.m1.1" class="ltx_Math" alttext="\mathbf{\textbf{e}}[\cdot]" display="inline"><semantics id="S2.SS2.p2.6.m1.1a"><mrow id="S2.SS2.p2.6.m1.1.2" xref="S2.SS2.p2.6.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.6.m1.1.2.2" xref="S2.SS2.p2.6.m1.1.2.2a.cmml">e</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m1.1.2.1" xref="S2.SS2.p2.6.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.6.m1.1.2.3.2" xref="S2.SS2.p2.6.m1.1.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m1.1.2.3.2.1" xref="S2.SS2.p2.6.m1.1.2.3.1.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m1.1.1" xref="S2.SS2.p2.6.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.6.m1.1.2.3.2.2" xref="S2.SS2.p2.6.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m1.1b"><apply id="S2.SS2.p2.6.m1.1.2.cmml" xref="S2.SS2.p2.6.m1.1.2"><times id="S2.SS2.p2.6.m1.1.2.1.cmml" xref="S2.SS2.p2.6.m1.1.2.1"></times><ci id="S2.SS2.p2.6.m1.1.2.2a.cmml" xref="S2.SS2.p2.6.m1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.6.m1.1.2.2.cmml" xref="S2.SS2.p2.6.m1.1.2.2">e</mtext></ci><apply id="S2.SS2.p2.6.m1.1.2.3.1.cmml" xref="S2.SS2.p2.6.m1.1.2.3.2"><csymbol cd="latexml" id="S2.SS2.p2.6.m1.1.2.3.1.1.cmml" xref="S2.SS2.p2.6.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS2.p2.6.m1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m1.1c">\mathbf{\textbf{e}}[\cdot]</annotation></semantics></math> denotes the LM's input embedding lookup.
Although it is possible in theory to use other speech representations, we choose the Conformer output since we get it for free as part of the ASR computation.
Moreover, we know that it is rich in lexical content since it is an encoding that is used directly for ASR.
We use a fixed-length summary of the encoding as prefix because doing so reduces (when <math id="S2.SS2.p2.7.m2.1" class="ltx_Math" alttext="j&gt;M" display="inline"><semantics id="S2.SS2.p2.7.m2.1a"><mrow id="S2.SS2.p2.7.m2.1.1" xref="S2.SS2.p2.7.m2.1.1.cmml"><mi id="S2.SS2.p2.7.m2.1.1.2" xref="S2.SS2.p2.7.m2.1.1.2.cmml">j</mi><mo id="S2.SS2.p2.7.m2.1.1.1" xref="S2.SS2.p2.7.m2.1.1.1.cmml">&gt;</mo><mi id="S2.SS2.p2.7.m2.1.1.3" xref="S2.SS2.p2.7.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m2.1b"><apply id="S2.SS2.p2.7.m2.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1"><gt id="S2.SS2.p2.7.m2.1.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1.1"></gt><ci id="S2.SS2.p2.7.m2.1.1.2.cmml" xref="S2.SS2.p2.7.m2.1.1.2">𝑗</ci><ci id="S2.SS2.p2.7.m2.1.1.3.cmml" xref="S2.SS2.p2.7.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m2.1c">j&gt;M</annotation></semantics></math>), and keeps fixed, the computational cost of the subsequent LM decoding compared to using the encoding directly.
Ultimately, instead of (<a href="#S2.E3" title="In 2.1 Baseline speculative ASR with ASR-LM hybrid ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), we have the following parameterization:</p>
<table id="S4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.5" class="ltx_Math" alttext="\displaystyle P(Y|\mathbf{\textbf{X}}^{p})=P_{\phi}(Y^{p}|\mathbf{\textbf{X}}^{p})\prod_{u=r+1}^{U}P_{\phi_{e},\theta,Q,\zeta}(y_{u}|y_{&lt;u},\mathbf{\textbf{X}}^{p})," display="inline"><semantics id="S2.E5.m1.5a"><mrow id="S2.E5.m1.5.5.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml"><mi id="S2.E5.m1.5.5.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.5.5.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.5.5.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.5.5.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S2.E5.m1.5.5.1.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E5.m1.5.5.1.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.2a.cmml">X</mtext><mi id="S2.E5.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.3.cmml">p</mi></msup></mrow><mo stretchy="false" id="S2.E5.m1.5.5.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.4" xref="S2.E5.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.E5.m1.5.5.1.1.3" xref="S2.E5.m1.5.5.1.1.3.cmml"><msub id="S2.E5.m1.5.5.1.1.3.4" xref="S2.E5.m1.5.5.1.1.3.4.cmml"><mi id="S2.E5.m1.5.5.1.1.3.4.2" xref="S2.E5.m1.5.5.1.1.3.4.2.cmml">P</mi><mi id="S2.E5.m1.5.5.1.1.3.4.3" xref="S2.E5.m1.5.5.1.1.3.4.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E5.m1.5.5.1.1.3.3" xref="S2.E5.m1.5.5.1.1.3.3.cmml">​</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.5.5.1.1.2.1.1.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml"><msup id="S2.E5.m1.5.5.1.1.2.1.1.1.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.cmml"><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml">Y</mi><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.2.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.3.cmml">p</mi></msup><mo fence="false" id="S2.E5.m1.5.5.1.1.2.1.1.1.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.1.cmml">|</mo><msup id="S2.E5.m1.5.5.1.1.2.1.1.1.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.2.1.1.1.3.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.2a.cmml">X</mtext><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.3.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.3.cmml">p</mi></msup></mrow><mo stretchy="false" id="S2.E5.m1.5.5.1.1.2.1.1.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.5.5.1.1.3.3a" xref="S2.E5.m1.5.5.1.1.3.3.cmml">​</mo><mrow id="S2.E5.m1.5.5.1.1.3.2" xref="S2.E5.m1.5.5.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.E5.m1.5.5.1.1.3.2.2" xref="S2.E5.m1.5.5.1.1.3.2.2.cmml"><munderover id="S2.E5.m1.5.5.1.1.3.2.2a" xref="S2.E5.m1.5.5.1.1.3.2.2.cmml"><mo movablelimits="false" id="S2.E5.m1.5.5.1.1.3.2.2.2.2" xref="S2.E5.m1.5.5.1.1.3.2.2.2.2.cmml">∏</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.2.2.3" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.2.2.3.2" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.2.cmml">u</mi><mo id="S2.E5.m1.5.5.1.1.3.2.2.2.3.1" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.1.cmml">=</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.2" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.2.cmml">r</mi><mo id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.1" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.1.cmml">+</mo><mn id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.3" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.E5.m1.5.5.1.1.3.2.2.3" xref="S2.E5.m1.5.5.1.1.3.2.2.3.cmml">U</mi></munderover></mstyle><mrow id="S2.E5.m1.5.5.1.1.3.2.1" xref="S2.E5.m1.5.5.1.1.3.2.1.cmml"><msub id="S2.E5.m1.5.5.1.1.3.2.1.3" xref="S2.E5.m1.5.5.1.1.3.2.1.3.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.1.3.2" xref="S2.E5.m1.5.5.1.1.3.2.1.3.2.cmml">P</mi><mrow id="S2.E5.m1.4.4.4.4" xref="S2.E5.m1.4.4.4.5.cmml"><msub id="S2.E5.m1.4.4.4.4.1" xref="S2.E5.m1.4.4.4.4.1.cmml"><mi id="S2.E5.m1.4.4.4.4.1.2" xref="S2.E5.m1.4.4.4.4.1.2.cmml">ϕ</mi><mi id="S2.E5.m1.4.4.4.4.1.3" xref="S2.E5.m1.4.4.4.4.1.3.cmml">e</mi></msub><mo id="S2.E5.m1.4.4.4.4.2" xref="S2.E5.m1.4.4.4.5.cmml">,</mo><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">θ</mi><mo id="S2.E5.m1.4.4.4.4.3" xref="S2.E5.m1.4.4.4.5.cmml">,</mo><mi id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">Q</mi><mo id="S2.E5.m1.4.4.4.4.4" xref="S2.E5.m1.4.4.4.5.cmml">,</mo><mi id="S2.E5.m1.3.3.3.3" xref="S2.E5.m1.3.3.3.3.cmml">ζ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E5.m1.5.5.1.1.3.2.1.2" xref="S2.E5.m1.5.5.1.1.3.2.1.2.cmml">​</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.1.1.1" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.cmml"><msub id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.2.cmml">y</mi><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.3.cmml">u</mi></msub><mo fence="false" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.3.cmml"><msub id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.1" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.3.cmml">u</mi></mrow></msub><mo id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.3.cmml">,</mo><msup id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2a.cmml">X</mtext><mi id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.3.cmml">p</mi></msup></mrow></mrow><mo stretchy="false" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.3" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.5.5.1.2" xref="S2.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.5b"><apply id="S2.E5.m1.5.5.1.1.cmml" xref="S2.E5.m1.5.5.1"><eq id="S2.E5.m1.5.5.1.1.4.cmml" xref="S2.E5.m1.5.5.1.1.4"></eq><apply id="S2.E5.m1.5.5.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1"><times id="S2.E5.m1.5.5.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.2"></times><ci id="S2.E5.m1.5.5.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.3">𝑃</ci><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2">𝑌</ci><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.3.2a.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.2">X</mtext></ci><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply><apply id="S2.E5.m1.5.5.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.3"><times id="S2.E5.m1.5.5.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.3"></times><apply id="S2.E5.m1.5.5.1.1.3.4.cmml" xref="S2.E5.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.4.1.cmml" xref="S2.E5.m1.5.5.1.1.3.4">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.3.4.2.cmml" xref="S2.E5.m1.5.5.1.1.3.4.2">𝑃</ci><ci id="S2.E5.m1.5.5.1.1.3.4.3.cmml" xref="S2.E5.m1.5.5.1.1.3.4.3">italic-ϕ</ci></apply><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2">superscript</csymbol><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2">𝑌</ci><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.2.3.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.3">𝑝</ci></apply><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.3.2a.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.2.1.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.2">X</mtext></ci><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S2.E5.m1.5.5.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2"><apply id="S2.E5.m1.5.5.1.1.3.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2">superscript</csymbol><apply id="S2.E5.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.2">product</csymbol><apply id="S2.E5.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3"><eq id="S2.E5.m1.5.5.1.1.3.2.2.2.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.1"></eq><ci id="S2.E5.m1.5.5.1.1.3.2.2.2.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.2">𝑢</ci><apply id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3"><plus id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.1"></plus><ci id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.2">𝑟</ci><cn type="integer" id="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.E5.m1.5.5.1.1.3.2.2.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2.3">𝑈</ci></apply><apply id="S2.E5.m1.5.5.1.1.3.2.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1"><times id="S2.E5.m1.5.5.1.1.3.2.1.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.2"></times><apply id="S2.E5.m1.5.5.1.1.3.2.1.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.3">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.3.2.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.3.2">𝑃</ci><list id="S2.E5.m1.4.4.4.5.cmml" xref="S2.E5.m1.4.4.4.4"><apply id="S2.E5.m1.4.4.4.4.1.cmml" xref="S2.E5.m1.4.4.4.4.1"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.4.4.1.1.cmml" xref="S2.E5.m1.4.4.4.4.1">subscript</csymbol><ci id="S2.E5.m1.4.4.4.4.1.2.cmml" xref="S2.E5.m1.4.4.4.4.1.2">italic-ϕ</ci><ci id="S2.E5.m1.4.4.4.4.1.3.cmml" xref="S2.E5.m1.4.4.4.4.1.3">𝑒</ci></apply><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝜃</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">𝑄</ci><ci id="S2.E5.m1.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3">𝜁</ci></list></apply><apply id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.3">conditional</csymbol><apply id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.2">𝑦</ci><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.4.3">𝑢</ci></apply><list id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2"><apply id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3"><lt id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2a.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.2">X</mtext></ci><ci id="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1.1.1.1.2.2.2.3">𝑝</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.5c">\displaystyle P(Y|\mathbf{\textbf{X}}^{p})=P_{\phi}(Y^{p}|\mathbf{\textbf{X}}^{p})\prod_{u=r+1}^{U}P_{\phi_{e},\theta,Q,\zeta}(y_{u}|y_{&lt;u},\mathbf{\textbf{X}}^{p}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.9" class="ltx_p">where <math id="S2.SS2.p2.8.m1.1" class="ltx_Math" alttext="\zeta" display="inline"><semantics id="S2.SS2.p2.8.m1.1a"><mi id="S2.SS2.p2.8.m1.1.1" xref="S2.SS2.p2.8.m1.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m1.1b"><ci id="S2.SS2.p2.8.m1.1.1.cmml" xref="S2.SS2.p2.8.m1.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m1.1c">\zeta</annotation></semantics></math> denotes the multihead attention parameters.
Our training process will involve keeping the first term on the right hand side fixed, and learning parameters which maximize the second term—<math id="S2.SS2.p2.9.m2.10" class="ltx_Math" alttext="P_{\phi_{e},\theta,Q,\zeta}(Y^{s}|Y^{p},\mathbf{\textbf{X}}^{p})\coloneqq\prod_{u=r+1}^{U}P_{\phi_{e},\theta,Q,\zeta}(y_{u}|y_{&lt;u},\mathbf{\textbf{X}}^{p})" display="inline"><semantics id="S2.SS2.p2.9.m2.10a"><mrow id="S2.SS2.p2.9.m2.10.10" xref="S2.SS2.p2.9.m2.10.10.cmml"><mrow id="S2.SS2.p2.9.m2.9.9.1" xref="S2.SS2.p2.9.m2.9.9.1.cmml"><msub id="S2.SS2.p2.9.m2.9.9.1.3" xref="S2.SS2.p2.9.m2.9.9.1.3.cmml"><mi id="S2.SS2.p2.9.m2.9.9.1.3.2" xref="S2.SS2.p2.9.m2.9.9.1.3.2.cmml">P</mi><mrow id="S2.SS2.p2.9.m2.4.4.4.4" xref="S2.SS2.p2.9.m2.4.4.4.5.cmml"><msub id="S2.SS2.p2.9.m2.4.4.4.4.1" xref="S2.SS2.p2.9.m2.4.4.4.4.1.cmml"><mi id="S2.SS2.p2.9.m2.4.4.4.4.1.2" xref="S2.SS2.p2.9.m2.4.4.4.4.1.2.cmml">ϕ</mi><mi id="S2.SS2.p2.9.m2.4.4.4.4.1.3" xref="S2.SS2.p2.9.m2.4.4.4.4.1.3.cmml">e</mi></msub><mo id="S2.SS2.p2.9.m2.4.4.4.4.2" xref="S2.SS2.p2.9.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.1.1.1.1" xref="S2.SS2.p2.9.m2.1.1.1.1.cmml">θ</mi><mo id="S2.SS2.p2.9.m2.4.4.4.4.3" xref="S2.SS2.p2.9.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.2.2.2.2" xref="S2.SS2.p2.9.m2.2.2.2.2.cmml">Q</mi><mo id="S2.SS2.p2.9.m2.4.4.4.4.4" xref="S2.SS2.p2.9.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.3.3.3.3" xref="S2.SS2.p2.9.m2.3.3.3.3.cmml">ζ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.9.m2.9.9.1.2" xref="S2.SS2.p2.9.m2.9.9.1.2.cmml">​</mo><mrow id="S2.SS2.p2.9.m2.9.9.1.1.1" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.9.m2.9.9.1.1.1.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.9.m2.9.9.1.1.1.1" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.cmml"><msup id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.cmml"><mi id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.2.cmml">Y</mi><mi id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.3.cmml">s</mi></msup><mo fence="false" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.3.cmml"><msup id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.2.cmml">Y</mi><mi id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2a.cmml">X</mtext><mi id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.3.cmml">p</mi></msup></mrow></mrow><mo stretchy="false" id="S2.SS2.p2.9.m2.9.9.1.1.1.3" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.SS2.p2.9.m2.10.10.3" xref="S2.SS2.p2.9.m2.10.10.3.cmml">≔</mo><mrow id="S2.SS2.p2.9.m2.10.10.2" xref="S2.SS2.p2.9.m2.10.10.2.cmml"><msubsup id="S2.SS2.p2.9.m2.10.10.2.2" xref="S2.SS2.p2.9.m2.10.10.2.2.cmml"><mo id="S2.SS2.p2.9.m2.10.10.2.2.2.2" xref="S2.SS2.p2.9.m2.10.10.2.2.2.2.cmml">∏</mo><mrow id="S2.SS2.p2.9.m2.10.10.2.2.2.3" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.2.2.3.2" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.2.cmml">u</mi><mo id="S2.SS2.p2.9.m2.10.10.2.2.2.3.1" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.2" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.2.cmml">r</mi><mo id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.1" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.1.cmml">+</mo><mn id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.3" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.SS2.p2.9.m2.10.10.2.2.3" xref="S2.SS2.p2.9.m2.10.10.2.2.3.cmml">U</mi></msubsup><mrow id="S2.SS2.p2.9.m2.10.10.2.1" xref="S2.SS2.p2.9.m2.10.10.2.1.cmml"><msub id="S2.SS2.p2.9.m2.10.10.2.1.3" xref="S2.SS2.p2.9.m2.10.10.2.1.3.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.1.3.2" xref="S2.SS2.p2.9.m2.10.10.2.1.3.2.cmml">P</mi><mrow id="S2.SS2.p2.9.m2.8.8.4.4" xref="S2.SS2.p2.9.m2.8.8.4.5.cmml"><msub id="S2.SS2.p2.9.m2.8.8.4.4.1" xref="S2.SS2.p2.9.m2.8.8.4.4.1.cmml"><mi id="S2.SS2.p2.9.m2.8.8.4.4.1.2" xref="S2.SS2.p2.9.m2.8.8.4.4.1.2.cmml">ϕ</mi><mi id="S2.SS2.p2.9.m2.8.8.4.4.1.3" xref="S2.SS2.p2.9.m2.8.8.4.4.1.3.cmml">e</mi></msub><mo id="S2.SS2.p2.9.m2.8.8.4.4.2" xref="S2.SS2.p2.9.m2.8.8.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.5.5.1.1" xref="S2.SS2.p2.9.m2.5.5.1.1.cmml">θ</mi><mo id="S2.SS2.p2.9.m2.8.8.4.4.3" xref="S2.SS2.p2.9.m2.8.8.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.6.6.2.2" xref="S2.SS2.p2.9.m2.6.6.2.2.cmml">Q</mi><mo id="S2.SS2.p2.9.m2.8.8.4.4.4" xref="S2.SS2.p2.9.m2.8.8.4.5.cmml">,</mo><mi id="S2.SS2.p2.9.m2.7.7.3.3" xref="S2.SS2.p2.9.m2.7.7.3.3.cmml">ζ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.9.m2.10.10.2.1.2" xref="S2.SS2.p2.9.m2.10.10.2.1.2.cmml">​</mo><mrow id="S2.SS2.p2.9.m2.10.10.2.1.1.1" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.cmml"><msub id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.2.cmml">y</mi><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.3.cmml">u</mi></msub><mo fence="false" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.3.cmml"><msub id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.1" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.3.cmml">u</mi></mrow></msub><mo id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2a.cmml">X</mtext><mi id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.3.cmml">p</mi></msup></mrow></mrow><mo stretchy="false" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.3" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m2.10b"><apply id="S2.SS2.p2.9.m2.10.10.cmml" xref="S2.SS2.p2.9.m2.10.10"><ci id="S2.SS2.p2.9.m2.10.10.3.cmml" xref="S2.SS2.p2.9.m2.10.10.3">≔</ci><apply id="S2.SS2.p2.9.m2.9.9.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1"><times id="S2.SS2.p2.9.m2.9.9.1.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.2"></times><apply id="S2.SS2.p2.9.m2.9.9.1.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.9.9.1.3.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.3">subscript</csymbol><ci id="S2.SS2.p2.9.m2.9.9.1.3.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.3.2">𝑃</ci><list id="S2.SS2.p2.9.m2.4.4.4.5.cmml" xref="S2.SS2.p2.9.m2.4.4.4.4"><apply id="S2.SS2.p2.9.m2.4.4.4.4.1.cmml" xref="S2.SS2.p2.9.m2.4.4.4.4.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.4.4.4.4.1.1.cmml" xref="S2.SS2.p2.9.m2.4.4.4.4.1">subscript</csymbol><ci id="S2.SS2.p2.9.m2.4.4.4.4.1.2.cmml" xref="S2.SS2.p2.9.m2.4.4.4.4.1.2">italic-ϕ</ci><ci id="S2.SS2.p2.9.m2.4.4.4.4.1.3.cmml" xref="S2.SS2.p2.9.m2.4.4.4.4.1.3">𝑒</ci></apply><ci id="S2.SS2.p2.9.m2.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.1.1.1.1">𝜃</ci><ci id="S2.SS2.p2.9.m2.2.2.2.2.cmml" xref="S2.SS2.p2.9.m2.2.2.2.2">𝑄</ci><ci id="S2.SS2.p2.9.m2.3.3.3.3.cmml" xref="S2.SS2.p2.9.m2.3.3.3.3">𝜁</ci></list></apply><apply id="S2.SS2.p2.9.m2.9.9.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4">superscript</csymbol><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.2">𝑌</ci><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.4.3">𝑠</ci></apply><list id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2"><apply id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2a.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.2">X</mtext></ci><ci id="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p2.9.m2.9.9.1.1.1.1.2.2.2.3">𝑝</ci></apply></list></apply></apply><apply id="S2.SS2.p2.9.m2.10.10.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2"><apply id="S2.SS2.p2.9.m2.10.10.2.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.2.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2">superscript</csymbol><apply id="S2.SS2.p2.9.m2.10.10.2.2.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.2.2.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p2.9.m2.10.10.2.2.2.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.2">product</csymbol><apply id="S2.SS2.p2.9.m2.10.10.2.2.2.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3"><eq id="S2.SS2.p2.9.m2.10.10.2.2.2.3.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.1"></eq><ci id="S2.SS2.p2.9.m2.10.10.2.2.2.3.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.2">𝑢</ci><apply id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3"><plus id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.1"></plus><ci id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.2">𝑟</ci><cn type="integer" id="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.SS2.p2.9.m2.10.10.2.2.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.2.3">𝑈</ci></apply><apply id="S2.SS2.p2.9.m2.10.10.2.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1"><times id="S2.SS2.p2.9.m2.10.10.2.1.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.2"></times><apply id="S2.SS2.p2.9.m2.10.10.2.1.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.1.3.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.3">subscript</csymbol><ci id="S2.SS2.p2.9.m2.10.10.2.1.3.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.3.2">𝑃</ci><list id="S2.SS2.p2.9.m2.8.8.4.5.cmml" xref="S2.SS2.p2.9.m2.8.8.4.4"><apply id="S2.SS2.p2.9.m2.8.8.4.4.1.cmml" xref="S2.SS2.p2.9.m2.8.8.4.4.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.8.8.4.4.1.1.cmml" xref="S2.SS2.p2.9.m2.8.8.4.4.1">subscript</csymbol><ci id="S2.SS2.p2.9.m2.8.8.4.4.1.2.cmml" xref="S2.SS2.p2.9.m2.8.8.4.4.1.2">italic-ϕ</ci><ci id="S2.SS2.p2.9.m2.8.8.4.4.1.3.cmml" xref="S2.SS2.p2.9.m2.8.8.4.4.1.3">𝑒</ci></apply><ci id="S2.SS2.p2.9.m2.5.5.1.1.cmml" xref="S2.SS2.p2.9.m2.5.5.1.1">𝜃</ci><ci id="S2.SS2.p2.9.m2.6.6.2.2.cmml" xref="S2.SS2.p2.9.m2.6.6.2.2">𝑄</ci><ci id="S2.SS2.p2.9.m2.7.7.3.3.cmml" xref="S2.SS2.p2.9.m2.7.7.3.3">𝜁</ci></list></apply><apply id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.2">𝑦</ci><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.4.3">𝑢</ci></apply><list id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2"><apply id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3"><lt id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2a.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.2">X</mtext></ci><ci id="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p2.9.m2.10.10.2.1.1.1.1.2.2.2.3">𝑝</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m2.10c">P_{\phi_{e},\theta,Q,\zeta}(Y^{s}|Y^{p},\mathbf{\textbf{X}}^{p})\coloneqq\prod_{u=r+1}^{U}P_{\phi_{e},\theta,Q,\zeta}(y_{u}|y_{&lt;u},\mathbf{\textbf{X}}^{p})</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Alignment and finetuning for speculation</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">With the parameters of the Conformer-Transducer fixed, we add LoRA layers to each Transformer layer in the LM.
The LoRA parameters are trained along with the LM's tied embedding-softmax layer, the cross-attention parameters and query vectors to maximize the log-likelihood of the correct suffix.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.5" class="ltx_p">We do the finetuning on a dataset of audio-text transcription <math id="S2.SS3.p2.1.m1.2" class="ltx_Math" alttext="(\mathbf{\textbf{X}},Y)" display="inline"><semantics id="S2.SS3.p2.1.m1.2a"><mrow id="S2.SS3.p2.1.m1.2.3.2" xref="S2.SS3.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.2.3.2.1" xref="S2.SS3.p2.1.m1.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1a.cmml">X</mtext><mo id="S2.SS3.p2.1.m1.2.3.2.2" xref="S2.SS3.p2.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS3.p2.1.m1.2.2" xref="S2.SS3.p2.1.m1.2.2.cmml">Y</mi><mo stretchy="false" id="S2.SS3.p2.1.m1.2.3.2.3" xref="S2.SS3.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.2b"><interval closure="open" id="S2.SS3.p2.1.m1.2.3.1.cmml" xref="S2.SS3.p2.1.m1.2.3.2"><ci id="S2.SS3.p2.1.m1.1.1a.cmml" xref="S2.SS3.p2.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">X</mtext></ci><ci id="S2.SS3.p2.1.m1.2.2.cmml" xref="S2.SS3.p2.1.m1.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.2c">(\mathbf{\textbf{X}},Y)</annotation></semantics></math> pairs.
For each training sample, we first get <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{\textbf{X}}^{p}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><msup id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2a.cmml">X</mtext><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2a.cmml" xref="S2.SS3.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">X</mtext></ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\mathbf{\textbf{X}}^{p}</annotation></semantics></math> by truncating the last <span id="S2.SS3.p2.5.1" class="ltx_text ltx_font_italic">1 second</span> of audio.
Then we pass the truncated audio to the Transducer-based ASR system to get a hypothesized transcript <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="\hat{Y}^{p}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><msup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.2.2.cmml">Y</mi><mo id="S2.SS3.p2.3.m3.1.1.2.1" xref="S2.SS3.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2"><ci id="S2.SS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1.2.1">^</ci><ci id="S2.SS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.2">𝑌</ci></apply><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\hat{Y}^{p}</annotation></semantics></math>.
Next we feed this hypothesis into the language model—along with the prefix from the cross-attention on the encoder output—to predict <math id="S2.SS3.p2.4.m4.3" class="ltx_Math" alttext="Y^{s}=(y_{r+1},\dots,y_{U})" display="inline"><semantics id="S2.SS3.p2.4.m4.3a"><mrow id="S2.SS3.p2.4.m4.3.3" xref="S2.SS3.p2.4.m4.3.3.cmml"><msup id="S2.SS3.p2.4.m4.3.3.4" xref="S2.SS3.p2.4.m4.3.3.4.cmml"><mi id="S2.SS3.p2.4.m4.3.3.4.2" xref="S2.SS3.p2.4.m4.3.3.4.2.cmml">Y</mi><mi id="S2.SS3.p2.4.m4.3.3.4.3" xref="S2.SS3.p2.4.m4.3.3.4.3.cmml">s</mi></msup><mo id="S2.SS3.p2.4.m4.3.3.3" xref="S2.SS3.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS3.p2.4.m4.3.3.2.2" xref="S2.SS3.p2.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS3.p2.4.m4.3.3.2.2.3" xref="S2.SS3.p2.4.m4.3.3.2.3.cmml">(</mo><msub id="S2.SS3.p2.4.m4.2.2.1.1.1" xref="S2.SS3.p2.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS3.p2.4.m4.2.2.1.1.1.2" xref="S2.SS3.p2.4.m4.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.SS3.p2.4.m4.2.2.1.1.1.3" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p2.4.m4.2.2.1.1.1.3.2" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.2.cmml">r</mi><mo id="S2.SS3.p2.4.m4.2.2.1.1.1.3.1" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.1.cmml">+</mo><mn id="S2.SS3.p2.4.m4.2.2.1.1.1.3.3" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.p2.4.m4.3.3.2.2.4" xref="S2.SS3.p2.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">…</mi><mo id="S2.SS3.p2.4.m4.3.3.2.2.5" xref="S2.SS3.p2.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p2.4.m4.3.3.2.2.2" xref="S2.SS3.p2.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS3.p2.4.m4.3.3.2.2.2.2" xref="S2.SS3.p2.4.m4.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS3.p2.4.m4.3.3.2.2.2.3" xref="S2.SS3.p2.4.m4.3.3.2.2.2.3.cmml">U</mi></msub><mo stretchy="false" id="S2.SS3.p2.4.m4.3.3.2.2.6" xref="S2.SS3.p2.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.3b"><apply id="S2.SS3.p2.4.m4.3.3.cmml" xref="S2.SS3.p2.4.m4.3.3"><eq id="S2.SS3.p2.4.m4.3.3.3.cmml" xref="S2.SS3.p2.4.m4.3.3.3"></eq><apply id="S2.SS3.p2.4.m4.3.3.4.cmml" xref="S2.SS3.p2.4.m4.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.3.3.4.1.cmml" xref="S2.SS3.p2.4.m4.3.3.4">superscript</csymbol><ci id="S2.SS3.p2.4.m4.3.3.4.2.cmml" xref="S2.SS3.p2.4.m4.3.3.4.2">𝑌</ci><ci id="S2.SS3.p2.4.m4.3.3.4.3.cmml" xref="S2.SS3.p2.4.m4.3.3.4.3">𝑠</ci></apply><vector id="S2.SS3.p2.4.m4.3.3.2.3.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2"><apply id="S2.SS3.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1.2">𝑦</ci><apply id="S2.SS3.p2.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3"><plus id="S2.SS3.p2.4.m4.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.1"></plus><ci id="S2.SS3.p2.4.m4.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.2">𝑟</ci><cn type="integer" id="S2.SS3.p2.4.m4.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">…</ci><apply id="S2.SS3.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS3.p2.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.2.3">𝑈</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.3c">Y^{s}=(y_{r+1},\dots,y_{U})</annotation></semantics></math>—the portion of <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">Y</annotation></semantics></math> corresponding to the truncated 1 second of audio.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">Determining <math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><mi id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">r</annotation></semantics></math> for training, however, is not as trivial as it may seem.
Consider, for example, an utterance whose correct transcription is <span id="S2.SS3.p3.1.1" class="ltx_text ltx_font_italic">``i'd like to call my father"</span>, but for which the ASR generates the prefix <span id="S2.SS3.p3.1.2" class="ltx_text ltx_font_italic">``i'd line to call ma-"</span>.
Because of the ASR errors, the correct suffix is not clearly defined.
It is therefore necessary to first determine what part of the transcription has been covered—possibly erroneously—by the ASR and what part remains to be speculated.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para ltx_noindent">
<p id="S2.SS3.p4.7" class="ltx_p"><span id="S2.SS3.p4.7.1" class="ltx_text ltx_font_bold">AWSED</span>: We propose solving this problem by Alignment With Subsequence Edit Distance (AWSED).
This procedure, illustrated in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Alignment and finetuning for speculation ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, involves computing the Levenshtein distance (LVD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> between <math id="S2.SS3.p4.1.m1.1" class="ltx_Math" alttext="\hat{Y}^{p}" display="inline"><semantics id="S2.SS3.p4.1.m1.1a"><msup id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml"><mover accent="true" id="S2.SS3.p4.1.m1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.2.cmml"><mi id="S2.SS3.p4.1.m1.1.1.2.2" xref="S2.SS3.p4.1.m1.1.1.2.2.cmml">Y</mi><mo id="S2.SS3.p4.1.m1.1.1.2.1" xref="S2.SS3.p4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p4.1.m1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2"><ci id="S2.SS3.p4.1.m1.1.1.2.1.cmml" xref="S2.SS3.p4.1.m1.1.1.2.1">^</ci><ci id="S2.SS3.p4.1.m1.1.1.2.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2.2">𝑌</ci></apply><ci id="S2.SS3.p4.1.m1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">\hat{Y}^{p}</annotation></semantics></math> and all left-substrings of <math id="S2.SS3.p4.2.m2.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS3.p4.2.m2.1a"><mi id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><ci id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">Y</annotation></semantics></math>.
More concretely, taking the left- and right-substring of <math id="S2.SS3.p4.3.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS3.p4.3.m3.1a"><mi id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><ci id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">Y</annotation></semantics></math> at some index <math id="S2.SS3.p4.4.m4.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S2.SS3.p4.4.m4.1a"><mi id="S2.SS3.p4.4.m4.1.1" xref="S2.SS3.p4.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m4.1b"><ci id="S2.SS3.p4.4.m4.1.1.cmml" xref="S2.SS3.p4.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m4.1c">v</annotation></semantics></math> respectively as <math id="S2.SS3.p4.5.m5.3" class="ltx_Math" alttext="Y_{:v}\coloneqq(y_{1},\dots,y_{v})" display="inline"><semantics id="S2.SS3.p4.5.m5.3a"><mrow id="S2.SS3.p4.5.m5.3.3" xref="S2.SS3.p4.5.m5.3.3.cmml"><msub id="S2.SS3.p4.5.m5.3.3.4" xref="S2.SS3.p4.5.m5.3.3.4.cmml"><mi id="S2.SS3.p4.5.m5.3.3.4.2" xref="S2.SS3.p4.5.m5.3.3.4.2.cmml">Y</mi><mrow id="S2.SS3.p4.5.m5.3.3.4.3" xref="S2.SS3.p4.5.m5.3.3.4.3.cmml"><mi id="S2.SS3.p4.5.m5.3.3.4.3.2" xref="S2.SS3.p4.5.m5.3.3.4.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS3.p4.5.m5.3.3.4.3.1" xref="S2.SS3.p4.5.m5.3.3.4.3.1.cmml">:</mo><mi id="S2.SS3.p4.5.m5.3.3.4.3.3" xref="S2.SS3.p4.5.m5.3.3.4.3.3.cmml">v</mi></mrow></msub><mo id="S2.SS3.p4.5.m5.3.3.3" xref="S2.SS3.p4.5.m5.3.3.3.cmml">≔</mo><mrow id="S2.SS3.p4.5.m5.3.3.2.2" xref="S2.SS3.p4.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS3.p4.5.m5.3.3.2.2.3" xref="S2.SS3.p4.5.m5.3.3.2.3.cmml">(</mo><msub id="S2.SS3.p4.5.m5.2.2.1.1.1" xref="S2.SS3.p4.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS3.p4.5.m5.2.2.1.1.1.2" xref="S2.SS3.p4.5.m5.2.2.1.1.1.2.cmml">y</mi><mn id="S2.SS3.p4.5.m5.2.2.1.1.1.3" xref="S2.SS3.p4.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p4.5.m5.3.3.2.2.4" xref="S2.SS3.p4.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS3.p4.5.m5.1.1" xref="S2.SS3.p4.5.m5.1.1.cmml">…</mi><mo id="S2.SS3.p4.5.m5.3.3.2.2.5" xref="S2.SS3.p4.5.m5.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p4.5.m5.3.3.2.2.2" xref="S2.SS3.p4.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS3.p4.5.m5.3.3.2.2.2.2" xref="S2.SS3.p4.5.m5.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS3.p4.5.m5.3.3.2.2.2.3" xref="S2.SS3.p4.5.m5.3.3.2.2.2.3.cmml">v</mi></msub><mo stretchy="false" id="S2.SS3.p4.5.m5.3.3.2.2.6" xref="S2.SS3.p4.5.m5.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.5.m5.3b"><apply id="S2.SS3.p4.5.m5.3.3.cmml" xref="S2.SS3.p4.5.m5.3.3"><ci id="S2.SS3.p4.5.m5.3.3.3.cmml" xref="S2.SS3.p4.5.m5.3.3.3">≔</ci><apply id="S2.SS3.p4.5.m5.3.3.4.cmml" xref="S2.SS3.p4.5.m5.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p4.5.m5.3.3.4.1.cmml" xref="S2.SS3.p4.5.m5.3.3.4">subscript</csymbol><ci id="S2.SS3.p4.5.m5.3.3.4.2.cmml" xref="S2.SS3.p4.5.m5.3.3.4.2">𝑌</ci><apply id="S2.SS3.p4.5.m5.3.3.4.3.cmml" xref="S2.SS3.p4.5.m5.3.3.4.3"><ci id="S2.SS3.p4.5.m5.3.3.4.3.1.cmml" xref="S2.SS3.p4.5.m5.3.3.4.3.1">:</ci><csymbol cd="latexml" id="S2.SS3.p4.5.m5.3.3.4.3.2.cmml" xref="S2.SS3.p4.5.m5.3.3.4.3.2">absent</csymbol><ci id="S2.SS3.p4.5.m5.3.3.4.3.3.cmml" xref="S2.SS3.p4.5.m5.3.3.4.3.3">𝑣</ci></apply></apply><vector id="S2.SS3.p4.5.m5.3.3.2.3.cmml" xref="S2.SS3.p4.5.m5.3.3.2.2"><apply id="S2.SS3.p4.5.m5.2.2.1.1.1.cmml" xref="S2.SS3.p4.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS3.p4.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p4.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS3.p4.5.m5.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS3.p4.5.m5.2.2.1.1.1.3.cmml" xref="S2.SS3.p4.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS3.p4.5.m5.1.1.cmml" xref="S2.SS3.p4.5.m5.1.1">…</ci><apply id="S2.SS3.p4.5.m5.3.3.2.2.2.cmml" xref="S2.SS3.p4.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS3.p4.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p4.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS3.p4.5.m5.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS3.p4.5.m5.3.3.2.2.2.3.cmml" xref="S2.SS3.p4.5.m5.3.3.2.2.2.3">𝑣</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.5.m5.3c">Y_{:v}\coloneqq(y_{1},\dots,y_{v})</annotation></semantics></math> and <math id="S2.SS3.p4.6.m6.3" class="ltx_Math" alttext="Y_{v:}\coloneqq(y_{v+1},\dots,y_{U})" display="inline"><semantics id="S2.SS3.p4.6.m6.3a"><mrow id="S2.SS3.p4.6.m6.3.3" xref="S2.SS3.p4.6.m6.3.3.cmml"><msub id="S2.SS3.p4.6.m6.3.3.4" xref="S2.SS3.p4.6.m6.3.3.4.cmml"><mi id="S2.SS3.p4.6.m6.3.3.4.2" xref="S2.SS3.p4.6.m6.3.3.4.2.cmml">Y</mi><mrow id="S2.SS3.p4.6.m6.3.3.4.3" xref="S2.SS3.p4.6.m6.3.3.4.3.cmml"><mi id="S2.SS3.p4.6.m6.3.3.4.3.2" xref="S2.SS3.p4.6.m6.3.3.4.3.2.cmml">v</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS3.p4.6.m6.3.3.4.3.1" xref="S2.SS3.p4.6.m6.3.3.4.3.1.cmml">:</mo><mi id="S2.SS3.p4.6.m6.3.3.4.3.3" xref="S2.SS3.p4.6.m6.3.3.4.3.3.cmml"></mi></mrow></msub><mo id="S2.SS3.p4.6.m6.3.3.3" xref="S2.SS3.p4.6.m6.3.3.3.cmml">≔</mo><mrow id="S2.SS3.p4.6.m6.3.3.2.2" xref="S2.SS3.p4.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS3.p4.6.m6.3.3.2.2.3" xref="S2.SS3.p4.6.m6.3.3.2.3.cmml">(</mo><msub id="S2.SS3.p4.6.m6.2.2.1.1.1" xref="S2.SS3.p4.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS3.p4.6.m6.2.2.1.1.1.2" xref="S2.SS3.p4.6.m6.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.SS3.p4.6.m6.2.2.1.1.1.3" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p4.6.m6.2.2.1.1.1.3.2" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.2.cmml">v</mi><mo id="S2.SS3.p4.6.m6.2.2.1.1.1.3.1" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.1.cmml">+</mo><mn id="S2.SS3.p4.6.m6.2.2.1.1.1.3.3" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.p4.6.m6.3.3.2.2.4" xref="S2.SS3.p4.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS3.p4.6.m6.1.1" xref="S2.SS3.p4.6.m6.1.1.cmml">…</mi><mo id="S2.SS3.p4.6.m6.3.3.2.2.5" xref="S2.SS3.p4.6.m6.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p4.6.m6.3.3.2.2.2" xref="S2.SS3.p4.6.m6.3.3.2.2.2.cmml"><mi id="S2.SS3.p4.6.m6.3.3.2.2.2.2" xref="S2.SS3.p4.6.m6.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS3.p4.6.m6.3.3.2.2.2.3" xref="S2.SS3.p4.6.m6.3.3.2.2.2.3.cmml">U</mi></msub><mo stretchy="false" id="S2.SS3.p4.6.m6.3.3.2.2.6" xref="S2.SS3.p4.6.m6.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.6.m6.3b"><apply id="S2.SS3.p4.6.m6.3.3.cmml" xref="S2.SS3.p4.6.m6.3.3"><ci id="S2.SS3.p4.6.m6.3.3.3.cmml" xref="S2.SS3.p4.6.m6.3.3.3">≔</ci><apply id="S2.SS3.p4.6.m6.3.3.4.cmml" xref="S2.SS3.p4.6.m6.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p4.6.m6.3.3.4.1.cmml" xref="S2.SS3.p4.6.m6.3.3.4">subscript</csymbol><ci id="S2.SS3.p4.6.m6.3.3.4.2.cmml" xref="S2.SS3.p4.6.m6.3.3.4.2">𝑌</ci><apply id="S2.SS3.p4.6.m6.3.3.4.3.cmml" xref="S2.SS3.p4.6.m6.3.3.4.3"><ci id="S2.SS3.p4.6.m6.3.3.4.3.1.cmml" xref="S2.SS3.p4.6.m6.3.3.4.3.1">:</ci><ci id="S2.SS3.p4.6.m6.3.3.4.3.2.cmml" xref="S2.SS3.p4.6.m6.3.3.4.3.2">𝑣</ci><csymbol cd="latexml" id="S2.SS3.p4.6.m6.3.3.4.3.3.cmml" xref="S2.SS3.p4.6.m6.3.3.4.3.3">absent</csymbol></apply></apply><vector id="S2.SS3.p4.6.m6.3.3.2.3.cmml" xref="S2.SS3.p4.6.m6.3.3.2.2"><apply id="S2.SS3.p4.6.m6.2.2.1.1.1.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p4.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1.2">𝑦</ci><apply id="S2.SS3.p4.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3"><plus id="S2.SS3.p4.6.m6.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.1"></plus><ci id="S2.SS3.p4.6.m6.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.2">𝑣</ci><cn type="integer" id="S2.SS3.p4.6.m6.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p4.6.m6.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p4.6.m6.1.1.cmml" xref="S2.SS3.p4.6.m6.1.1">…</ci><apply id="S2.SS3.p4.6.m6.3.3.2.2.2.cmml" xref="S2.SS3.p4.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS3.p4.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p4.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS3.p4.6.m6.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS3.p4.6.m6.3.3.2.2.2.3.cmml" xref="S2.SS3.p4.6.m6.3.3.2.2.2.3">𝑈</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.6.m6.3c">Y_{v:}\coloneqq(y_{v+1},\dots,y_{U})</annotation></semantics></math>, then the desired target suffix, <math id="S2.SS3.p4.7.m7.1" class="ltx_Math" alttext="Y^{s}=Y_{v^{*}:}" display="inline"><semantics id="S2.SS3.p4.7.m7.1a"><mrow id="S2.SS3.p4.7.m7.1.1" xref="S2.SS3.p4.7.m7.1.1.cmml"><msup id="S2.SS3.p4.7.m7.1.1.2" xref="S2.SS3.p4.7.m7.1.1.2.cmml"><mi id="S2.SS3.p4.7.m7.1.1.2.2" xref="S2.SS3.p4.7.m7.1.1.2.2.cmml">Y</mi><mi id="S2.SS3.p4.7.m7.1.1.2.3" xref="S2.SS3.p4.7.m7.1.1.2.3.cmml">s</mi></msup><mo id="S2.SS3.p4.7.m7.1.1.1" xref="S2.SS3.p4.7.m7.1.1.1.cmml">=</mo><msub id="S2.SS3.p4.7.m7.1.1.3" xref="S2.SS3.p4.7.m7.1.1.3.cmml"><mi id="S2.SS3.p4.7.m7.1.1.3.2" xref="S2.SS3.p4.7.m7.1.1.3.2.cmml">Y</mi><mrow id="S2.SS3.p4.7.m7.1.1.3.3" xref="S2.SS3.p4.7.m7.1.1.3.3.cmml"><msup id="S2.SS3.p4.7.m7.1.1.3.3.2" xref="S2.SS3.p4.7.m7.1.1.3.3.2.cmml"><mi id="S2.SS3.p4.7.m7.1.1.3.3.2.2" xref="S2.SS3.p4.7.m7.1.1.3.3.2.2.cmml">v</mi><mo id="S2.SS3.p4.7.m7.1.1.3.3.2.3" xref="S2.SS3.p4.7.m7.1.1.3.3.2.3.cmml">∗</mo></msup><mo lspace="0.278em" rspace="0.278em" id="S2.SS3.p4.7.m7.1.1.3.3.1" xref="S2.SS3.p4.7.m7.1.1.3.3.1.cmml">:</mo><mi id="S2.SS3.p4.7.m7.1.1.3.3.3" xref="S2.SS3.p4.7.m7.1.1.3.3.3.cmml"></mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.7.m7.1b"><apply id="S2.SS3.p4.7.m7.1.1.cmml" xref="S2.SS3.p4.7.m7.1.1"><eq id="S2.SS3.p4.7.m7.1.1.1.cmml" xref="S2.SS3.p4.7.m7.1.1.1"></eq><apply id="S2.SS3.p4.7.m7.1.1.2.cmml" xref="S2.SS3.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p4.7.m7.1.1.2.1.cmml" xref="S2.SS3.p4.7.m7.1.1.2">superscript</csymbol><ci id="S2.SS3.p4.7.m7.1.1.2.2.cmml" xref="S2.SS3.p4.7.m7.1.1.2.2">𝑌</ci><ci id="S2.SS3.p4.7.m7.1.1.2.3.cmml" xref="S2.SS3.p4.7.m7.1.1.2.3">𝑠</ci></apply><apply id="S2.SS3.p4.7.m7.1.1.3.cmml" xref="S2.SS3.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p4.7.m7.1.1.3.1.cmml" xref="S2.SS3.p4.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS3.p4.7.m7.1.1.3.2.cmml" xref="S2.SS3.p4.7.m7.1.1.3.2">𝑌</ci><apply id="S2.SS3.p4.7.m7.1.1.3.3.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3"><ci id="S2.SS3.p4.7.m7.1.1.3.3.1.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.1">:</ci><apply id="S2.SS3.p4.7.m7.1.1.3.3.2.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.p4.7.m7.1.1.3.3.2.1.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.2">superscript</csymbol><ci id="S2.SS3.p4.7.m7.1.1.3.3.2.2.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.2.2">𝑣</ci><times id="S2.SS3.p4.7.m7.1.1.3.3.2.3.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.2.3"></times></apply><csymbol cd="latexml" id="S2.SS3.p4.7.m7.1.1.3.3.3.cmml" xref="S2.SS3.p4.7.m7.1.1.3.3.3">absent</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.7.m7.1c">Y^{s}=Y_{v^{*}:}</annotation></semantics></math>, where:</p>
<table id="S4.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle v^{*}=\operatorname*{arg\,min}_{v}\ L(\hat{Y}^{p},Y_{:v})," display="inline"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><msup id="S2.E6.m1.1.1.1.1.4" xref="S2.E6.m1.1.1.1.1.4.cmml"><mi id="S2.E6.m1.1.1.1.1.4.2" xref="S2.E6.m1.1.1.1.1.4.2.cmml">v</mi><mo id="S2.E6.m1.1.1.1.1.4.3" xref="S2.E6.m1.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml"><mrow id="S2.E6.m1.1.1.1.1.2.4" xref="S2.E6.m1.1.1.1.1.2.4.cmml"><munder id="S2.E6.m1.1.1.1.1.2.4.1" xref="S2.E6.m1.1.1.1.1.2.4.1.cmml"><mrow id="S2.E6.m1.1.1.1.1.2.4.1.2" xref="S2.E6.m1.1.1.1.1.2.4.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.2.4.1.2.2" xref="S2.E6.m1.1.1.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E6.m1.1.1.1.1.2.4.1.2.1" xref="S2.E6.m1.1.1.1.1.2.4.1.2.1.cmml">​</mo><mi id="S2.E6.m1.1.1.1.1.2.4.1.2.3" xref="S2.E6.m1.1.1.1.1.2.4.1.2.3.cmml">min</mi></mrow><mi id="S2.E6.m1.1.1.1.1.2.4.1.3" xref="S2.E6.m1.1.1.1.1.2.4.1.3.cmml">v</mi></munder><mo id="S2.E6.m1.1.1.1.1.2.4a" xref="S2.E6.m1.1.1.1.1.2.4.cmml">⁡</mo><mi id="S2.E6.m1.1.1.1.1.2.4.2" xref="S2.E6.m1.1.1.1.1.2.4.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E6.m1.1.1.1.1.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E6.m1.1.1.1.1.2.2.2.3" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">(</mo><msup id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.E6.m1.1.1.1.1.1.1.1.1.2.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.E6.m1.1.1.1.1.2.2.2.4" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E6.m1.1.1.1.1.2.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E6.m1.1.1.1.1.2.2.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.2.2.2.cmml">Y</mi><mrow id="S2.E6.m1.1.1.1.1.2.2.2.2.3" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E6.m1.1.1.1.1.2.2.2.2.3.2" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S2.E6.m1.1.1.1.1.2.2.2.2.3.1" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="S2.E6.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml">v</mi></mrow></msub><mo stretchy="false" id="S2.E6.m1.1.1.1.1.2.2.2.5" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3"></eq><apply id="S2.E6.m1.1.1.1.1.4.cmml" xref="S2.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.4.1.cmml" xref="S2.E6.m1.1.1.1.1.4">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.4.2.cmml" xref="S2.E6.m1.1.1.1.1.4.2">𝑣</ci><times id="S2.E6.m1.1.1.1.1.4.3.cmml" xref="S2.E6.m1.1.1.1.1.4.3"></times></apply><apply id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"><times id="S2.E6.m1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.3"></times><apply id="S2.E6.m1.1.1.1.1.2.4.cmml" xref="S2.E6.m1.1.1.1.1.2.4"><apply id="S2.E6.m1.1.1.1.1.2.4.1.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.4.1.1.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.2.4.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1.2"><times id="S2.E6.m1.1.1.1.1.2.4.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1.2.1"></times><ci id="S2.E6.m1.1.1.1.1.2.4.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1.2.2">arg</ci><ci id="S2.E6.m1.1.1.1.1.2.4.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1.2.3">min</ci></apply><ci id="S2.E6.m1.1.1.1.1.2.4.1.3.cmml" xref="S2.E6.m1.1.1.1.1.2.4.1.3">𝑣</ci></apply><ci id="S2.E6.m1.1.1.1.1.2.4.2.cmml" xref="S2.E6.m1.1.1.1.1.2.4.2">𝐿</ci></apply><interval closure="open" id="S2.E6.m1.1.1.1.1.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2"><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2"><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2">𝑌</ci></apply><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.2">𝑌</ci><apply id="S2.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3"><ci id="S2.E6.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.1">:</ci><csymbol cd="latexml" id="S2.E6.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.2">absent</csymbol><ci id="S2.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.3">𝑣</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle v^{*}=\operatorname*{arg\,min}_{v}\ L(\hat{Y}^{p},Y_{:v}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p4.20" class="ltx_p">where <math id="S2.SS3.p4.8.m1.2" class="ltx_Math" alttext="L(s_{1},s_{2})" display="inline"><semantics id="S2.SS3.p4.8.m1.2a"><mrow id="S2.SS3.p4.8.m1.2.2" xref="S2.SS3.p4.8.m1.2.2.cmml"><mi id="S2.SS3.p4.8.m1.2.2.4" xref="S2.SS3.p4.8.m1.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.8.m1.2.2.3" xref="S2.SS3.p4.8.m1.2.2.3.cmml">​</mo><mrow id="S2.SS3.p4.8.m1.2.2.2.2" xref="S2.SS3.p4.8.m1.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS3.p4.8.m1.2.2.2.2.3" xref="S2.SS3.p4.8.m1.2.2.2.3.cmml">(</mo><msub id="S2.SS3.p4.8.m1.1.1.1.1.1" xref="S2.SS3.p4.8.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p4.8.m1.1.1.1.1.1.2" xref="S2.SS3.p4.8.m1.1.1.1.1.1.2.cmml">s</mi><mn id="S2.SS3.p4.8.m1.1.1.1.1.1.3" xref="S2.SS3.p4.8.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p4.8.m1.2.2.2.2.4" xref="S2.SS3.p4.8.m1.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p4.8.m1.2.2.2.2.2" xref="S2.SS3.p4.8.m1.2.2.2.2.2.cmml"><mi id="S2.SS3.p4.8.m1.2.2.2.2.2.2" xref="S2.SS3.p4.8.m1.2.2.2.2.2.2.cmml">s</mi><mn id="S2.SS3.p4.8.m1.2.2.2.2.2.3" xref="S2.SS3.p4.8.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S2.SS3.p4.8.m1.2.2.2.2.5" xref="S2.SS3.p4.8.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.8.m1.2b"><apply id="S2.SS3.p4.8.m1.2.2.cmml" xref="S2.SS3.p4.8.m1.2.2"><times id="S2.SS3.p4.8.m1.2.2.3.cmml" xref="S2.SS3.p4.8.m1.2.2.3"></times><ci id="S2.SS3.p4.8.m1.2.2.4.cmml" xref="S2.SS3.p4.8.m1.2.2.4">𝐿</ci><interval closure="open" id="S2.SS3.p4.8.m1.2.2.2.3.cmml" xref="S2.SS3.p4.8.m1.2.2.2.2"><apply id="S2.SS3.p4.8.m1.1.1.1.1.1.cmml" xref="S2.SS3.p4.8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.8.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.8.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p4.8.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.8.m1.1.1.1.1.1.2">𝑠</ci><cn type="integer" id="S2.SS3.p4.8.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.8.m1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS3.p4.8.m1.2.2.2.2.2.cmml" xref="S2.SS3.p4.8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.8.m1.2.2.2.2.2.1.cmml" xref="S2.SS3.p4.8.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p4.8.m1.2.2.2.2.2.2.cmml" xref="S2.SS3.p4.8.m1.2.2.2.2.2.2">𝑠</ci><cn type="integer" id="S2.SS3.p4.8.m1.2.2.2.2.2.3.cmml" xref="S2.SS3.p4.8.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.8.m1.2c">L(s_{1},s_{2})</annotation></semantics></math> is the LVD between the strings <math id="S2.SS3.p4.9.m2.1" class="ltx_Math" alttext="s_{1}" display="inline"><semantics id="S2.SS3.p4.9.m2.1a"><msub id="S2.SS3.p4.9.m2.1.1" xref="S2.SS3.p4.9.m2.1.1.cmml"><mi id="S2.SS3.p4.9.m2.1.1.2" xref="S2.SS3.p4.9.m2.1.1.2.cmml">s</mi><mn id="S2.SS3.p4.9.m2.1.1.3" xref="S2.SS3.p4.9.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.9.m2.1b"><apply id="S2.SS3.p4.9.m2.1.1.cmml" xref="S2.SS3.p4.9.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.9.m2.1.1.1.cmml" xref="S2.SS3.p4.9.m2.1.1">subscript</csymbol><ci id="S2.SS3.p4.9.m2.1.1.2.cmml" xref="S2.SS3.p4.9.m2.1.1.2">𝑠</ci><cn type="integer" id="S2.SS3.p4.9.m2.1.1.3.cmml" xref="S2.SS3.p4.9.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.9.m2.1c">s_{1}</annotation></semantics></math> and <math id="S2.SS3.p4.10.m3.1" class="ltx_Math" alttext="s_{2}" display="inline"><semantics id="S2.SS3.p4.10.m3.1a"><msub id="S2.SS3.p4.10.m3.1.1" xref="S2.SS3.p4.10.m3.1.1.cmml"><mi id="S2.SS3.p4.10.m3.1.1.2" xref="S2.SS3.p4.10.m3.1.1.2.cmml">s</mi><mn id="S2.SS3.p4.10.m3.1.1.3" xref="S2.SS3.p4.10.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.10.m3.1b"><apply id="S2.SS3.p4.10.m3.1.1.cmml" xref="S2.SS3.p4.10.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.10.m3.1.1.1.cmml" xref="S2.SS3.p4.10.m3.1.1">subscript</csymbol><ci id="S2.SS3.p4.10.m3.1.1.2.cmml" xref="S2.SS3.p4.10.m3.1.1.2">𝑠</ci><cn type="integer" id="S2.SS3.p4.10.m3.1.1.3.cmml" xref="S2.SS3.p4.10.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.10.m3.1c">s_{2}</annotation></semantics></math>.
Note that rather than having to compute <math id="S2.SS3.p4.11.m4.2" class="ltx_Math" alttext="L(\hat{Y}^{p},Y_{:v})" display="inline"><semantics id="S2.SS3.p4.11.m4.2a"><mrow id="S2.SS3.p4.11.m4.2.2" xref="S2.SS3.p4.11.m4.2.2.cmml"><mi id="S2.SS3.p4.11.m4.2.2.4" xref="S2.SS3.p4.11.m4.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.11.m4.2.2.3" xref="S2.SS3.p4.11.m4.2.2.3.cmml">​</mo><mrow id="S2.SS3.p4.11.m4.2.2.2.2" xref="S2.SS3.p4.11.m4.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS3.p4.11.m4.2.2.2.2.3" xref="S2.SS3.p4.11.m4.2.2.2.3.cmml">(</mo><msup id="S2.SS3.p4.11.m4.1.1.1.1.1" xref="S2.SS3.p4.11.m4.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.p4.11.m4.1.1.1.1.1.2" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p4.11.m4.1.1.1.1.1.2.2" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.SS3.p4.11.m4.1.1.1.1.1.2.1" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p4.11.m4.1.1.1.1.1.3" xref="S2.SS3.p4.11.m4.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS3.p4.11.m4.2.2.2.2.4" xref="S2.SS3.p4.11.m4.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p4.11.m4.2.2.2.2.2" xref="S2.SS3.p4.11.m4.2.2.2.2.2.cmml"><mi id="S2.SS3.p4.11.m4.2.2.2.2.2.2" xref="S2.SS3.p4.11.m4.2.2.2.2.2.2.cmml">Y</mi><mrow id="S2.SS3.p4.11.m4.2.2.2.2.2.3" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.cmml"><mi id="S2.SS3.p4.11.m4.2.2.2.2.2.3.2" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS3.p4.11.m4.2.2.2.2.2.3.1" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.SS3.p4.11.m4.2.2.2.2.2.3.3" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.3.cmml">v</mi></mrow></msub><mo stretchy="false" id="S2.SS3.p4.11.m4.2.2.2.2.5" xref="S2.SS3.p4.11.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.11.m4.2b"><apply id="S2.SS3.p4.11.m4.2.2.cmml" xref="S2.SS3.p4.11.m4.2.2"><times id="S2.SS3.p4.11.m4.2.2.3.cmml" xref="S2.SS3.p4.11.m4.2.2.3"></times><ci id="S2.SS3.p4.11.m4.2.2.4.cmml" xref="S2.SS3.p4.11.m4.2.2.4">𝐿</ci><interval closure="open" id="S2.SS3.p4.11.m4.2.2.2.3.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2"><apply id="S2.SS3.p4.11.m4.1.1.1.1.1.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.11.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1">superscript</csymbol><apply id="S2.SS3.p4.11.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2"><ci id="S2.SS3.p4.11.m4.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2.1">^</ci><ci id="S2.SS3.p4.11.m4.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1.2.2">𝑌</ci></apply><ci id="S2.SS3.p4.11.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.11.m4.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.SS3.p4.11.m4.2.2.2.2.2.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.11.m4.2.2.2.2.2.1.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p4.11.m4.2.2.2.2.2.2.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2.2">𝑌</ci><apply id="S2.SS3.p4.11.m4.2.2.2.2.2.3.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3"><ci id="S2.SS3.p4.11.m4.2.2.2.2.2.3.1.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.1">:</ci><csymbol cd="latexml" id="S2.SS3.p4.11.m4.2.2.2.2.2.3.2.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.2">absent</csymbol><ci id="S2.SS3.p4.11.m4.2.2.2.2.2.3.3.cmml" xref="S2.SS3.p4.11.m4.2.2.2.2.2.3.3">𝑣</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.11.m4.2c">L(\hat{Y}^{p},Y_{:v})</annotation></semantics></math> separately for each <math id="S2.SS3.p4.12.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S2.SS3.p4.12.m5.1a"><mi id="S2.SS3.p4.12.m5.1.1" xref="S2.SS3.p4.12.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.12.m5.1b"><ci id="S2.SS3.p4.12.m5.1.1.cmml" xref="S2.SS3.p4.12.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.12.m5.1c">v</annotation></semantics></math>, we need only one run of the dynamic programming algorithm for computing the LVD to get <math id="S2.SS3.p4.13.m6.1" class="ltx_Math" alttext="v^{*}" display="inline"><semantics id="S2.SS3.p4.13.m6.1a"><msup id="S2.SS3.p4.13.m6.1.1" xref="S2.SS3.p4.13.m6.1.1.cmml"><mi id="S2.SS3.p4.13.m6.1.1.2" xref="S2.SS3.p4.13.m6.1.1.2.cmml">v</mi><mo id="S2.SS3.p4.13.m6.1.1.3" xref="S2.SS3.p4.13.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.13.m6.1b"><apply id="S2.SS3.p4.13.m6.1.1.cmml" xref="S2.SS3.p4.13.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.13.m6.1.1.1.cmml" xref="S2.SS3.p4.13.m6.1.1">superscript</csymbol><ci id="S2.SS3.p4.13.m6.1.1.2.cmml" xref="S2.SS3.p4.13.m6.1.1.2">𝑣</ci><times id="S2.SS3.p4.13.m6.1.1.3.cmml" xref="S2.SS3.p4.13.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.13.m6.1c">v^{*}</annotation></semantics></math>
because the last row of the matrix of accumulated costs already contains <math id="S2.SS3.p4.14.m7.2" class="ltx_Math" alttext="L(\hat{Y}^{p},Y_{:v})" display="inline"><semantics id="S2.SS3.p4.14.m7.2a"><mrow id="S2.SS3.p4.14.m7.2.2" xref="S2.SS3.p4.14.m7.2.2.cmml"><mi id="S2.SS3.p4.14.m7.2.2.4" xref="S2.SS3.p4.14.m7.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.14.m7.2.2.3" xref="S2.SS3.p4.14.m7.2.2.3.cmml">​</mo><mrow id="S2.SS3.p4.14.m7.2.2.2.2" xref="S2.SS3.p4.14.m7.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS3.p4.14.m7.2.2.2.2.3" xref="S2.SS3.p4.14.m7.2.2.2.3.cmml">(</mo><msup id="S2.SS3.p4.14.m7.1.1.1.1.1" xref="S2.SS3.p4.14.m7.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.p4.14.m7.1.1.1.1.1.2" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p4.14.m7.1.1.1.1.1.2.2" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.SS3.p4.14.m7.1.1.1.1.1.2.1" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p4.14.m7.1.1.1.1.1.3" xref="S2.SS3.p4.14.m7.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS3.p4.14.m7.2.2.2.2.4" xref="S2.SS3.p4.14.m7.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p4.14.m7.2.2.2.2.2" xref="S2.SS3.p4.14.m7.2.2.2.2.2.cmml"><mi id="S2.SS3.p4.14.m7.2.2.2.2.2.2" xref="S2.SS3.p4.14.m7.2.2.2.2.2.2.cmml">Y</mi><mrow id="S2.SS3.p4.14.m7.2.2.2.2.2.3" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.cmml"><mi id="S2.SS3.p4.14.m7.2.2.2.2.2.3.2" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS3.p4.14.m7.2.2.2.2.2.3.1" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.SS3.p4.14.m7.2.2.2.2.2.3.3" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.3.cmml">v</mi></mrow></msub><mo stretchy="false" id="S2.SS3.p4.14.m7.2.2.2.2.5" xref="S2.SS3.p4.14.m7.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.14.m7.2b"><apply id="S2.SS3.p4.14.m7.2.2.cmml" xref="S2.SS3.p4.14.m7.2.2"><times id="S2.SS3.p4.14.m7.2.2.3.cmml" xref="S2.SS3.p4.14.m7.2.2.3"></times><ci id="S2.SS3.p4.14.m7.2.2.4.cmml" xref="S2.SS3.p4.14.m7.2.2.4">𝐿</ci><interval closure="open" id="S2.SS3.p4.14.m7.2.2.2.3.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2"><apply id="S2.SS3.p4.14.m7.1.1.1.1.1.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.14.m7.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1">superscript</csymbol><apply id="S2.SS3.p4.14.m7.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2"><ci id="S2.SS3.p4.14.m7.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2.1">^</ci><ci id="S2.SS3.p4.14.m7.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1.2.2">𝑌</ci></apply><ci id="S2.SS3.p4.14.m7.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.14.m7.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.SS3.p4.14.m7.2.2.2.2.2.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.14.m7.2.2.2.2.2.1.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p4.14.m7.2.2.2.2.2.2.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2.2">𝑌</ci><apply id="S2.SS3.p4.14.m7.2.2.2.2.2.3.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3"><ci id="S2.SS3.p4.14.m7.2.2.2.2.2.3.1.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.1">:</ci><csymbol cd="latexml" id="S2.SS3.p4.14.m7.2.2.2.2.2.3.2.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.2">absent</csymbol><ci id="S2.SS3.p4.14.m7.2.2.2.2.2.3.3.cmml" xref="S2.SS3.p4.14.m7.2.2.2.2.2.3.3">𝑣</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.14.m7.2c">L(\hat{Y}^{p},Y_{:v})</annotation></semantics></math> for every <math id="S2.SS3.p4.15.m8.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S2.SS3.p4.15.m8.1a"><mi id="S2.SS3.p4.15.m8.1.1" xref="S2.SS3.p4.15.m8.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.15.m8.1b"><ci id="S2.SS3.p4.15.m8.1.1.cmml" xref="S2.SS3.p4.15.m8.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.15.m8.1c">v</annotation></semantics></math>, and we only need to take the <math id="S2.SS3.p4.16.m9.1" class="ltx_Math" alttext="\operatorname*{arg\,min}" display="inline"><semantics id="S2.SS3.p4.16.m9.1a"><mrow id="S2.SS3.p4.16.m9.1.1" xref="S2.SS3.p4.16.m9.1.1.cmml"><mi id="S2.SS3.p4.16.m9.1.1.2" xref="S2.SS3.p4.16.m9.1.1.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.SS3.p4.16.m9.1.1.1" xref="S2.SS3.p4.16.m9.1.1.1.cmml">​</mo><mi id="S2.SS3.p4.16.m9.1.1.3" xref="S2.SS3.p4.16.m9.1.1.3.cmml">min</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.16.m9.1b"><apply id="S2.SS3.p4.16.m9.1.1.cmml" xref="S2.SS3.p4.16.m9.1.1"><times id="S2.SS3.p4.16.m9.1.1.1.cmml" xref="S2.SS3.p4.16.m9.1.1.1"></times><ci id="S2.SS3.p4.16.m9.1.1.2.cmml" xref="S2.SS3.p4.16.m9.1.1.2">arg</ci><ci id="S2.SS3.p4.16.m9.1.1.3.cmml" xref="S2.SS3.p4.16.m9.1.1.3">min</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.16.m9.1c">\operatorname*{arg\,min}</annotation></semantics></math> on this row.
In case multiple indices are tied for the <math id="S2.SS3.p4.17.m10.1" class="ltx_Math" alttext="\operatorname*{arg\,min}" display="inline"><semantics id="S2.SS3.p4.17.m10.1a"><mrow id="S2.SS3.p4.17.m10.1.1" xref="S2.SS3.p4.17.m10.1.1.cmml"><mi id="S2.SS3.p4.17.m10.1.1.2" xref="S2.SS3.p4.17.m10.1.1.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.SS3.p4.17.m10.1.1.1" xref="S2.SS3.p4.17.m10.1.1.1.cmml">​</mo><mi id="S2.SS3.p4.17.m10.1.1.3" xref="S2.SS3.p4.17.m10.1.1.3.cmml">min</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.17.m10.1b"><apply id="S2.SS3.p4.17.m10.1.1.cmml" xref="S2.SS3.p4.17.m10.1.1"><times id="S2.SS3.p4.17.m10.1.1.1.cmml" xref="S2.SS3.p4.17.m10.1.1.1"></times><ci id="S2.SS3.p4.17.m10.1.1.2.cmml" xref="S2.SS3.p4.17.m10.1.1.2">arg</ci><ci id="S2.SS3.p4.17.m10.1.1.3.cmml" xref="S2.SS3.p4.17.m10.1.1.3">min</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.17.m10.1c">\operatorname*{arg\,min}</annotation></semantics></math>, we pick the leftmost one.
In our running example, the AWSED procedure yields the resulting <math id="S2.SS3.p4.18.m11.1" class="ltx_Math" alttext="Y^{s}" display="inline"><semantics id="S2.SS3.p4.18.m11.1a"><msup id="S2.SS3.p4.18.m11.1.1" xref="S2.SS3.p4.18.m11.1.1.cmml"><mi id="S2.SS3.p4.18.m11.1.1.2" xref="S2.SS3.p4.18.m11.1.1.2.cmml">Y</mi><mi id="S2.SS3.p4.18.m11.1.1.3" xref="S2.SS3.p4.18.m11.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.18.m11.1b"><apply id="S2.SS3.p4.18.m11.1.1.cmml" xref="S2.SS3.p4.18.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.18.m11.1.1.1.cmml" xref="S2.SS3.p4.18.m11.1.1">superscript</csymbol><ci id="S2.SS3.p4.18.m11.1.1.2.cmml" xref="S2.SS3.p4.18.m11.1.1.2">𝑌</ci><ci id="S2.SS3.p4.18.m11.1.1.3.cmml" xref="S2.SS3.p4.18.m11.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.18.m11.1c">Y^{s}</annotation></semantics></math> as <span id="S2.SS3.p4.20.1" class="ltx_text ltx_font_italic">``-my father"</span>.
Had we taken the rightmost <math id="S2.SS3.p4.19.m12.1" class="ltx_Math" alttext="\operatorname*{arg\,min}" display="inline"><semantics id="S2.SS3.p4.19.m12.1a"><mrow id="S2.SS3.p4.19.m12.1.1" xref="S2.SS3.p4.19.m12.1.1.cmml"><mi id="S2.SS3.p4.19.m12.1.1.2" xref="S2.SS3.p4.19.m12.1.1.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.SS3.p4.19.m12.1.1.1" xref="S2.SS3.p4.19.m12.1.1.1.cmml">​</mo><mi id="S2.SS3.p4.19.m12.1.1.3" xref="S2.SS3.p4.19.m12.1.1.3.cmml">min</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.19.m12.1b"><apply id="S2.SS3.p4.19.m12.1.1.cmml" xref="S2.SS3.p4.19.m12.1.1"><times id="S2.SS3.p4.19.m12.1.1.1.cmml" xref="S2.SS3.p4.19.m12.1.1.1"></times><ci id="S2.SS3.p4.19.m12.1.1.2.cmml" xref="S2.SS3.p4.19.m12.1.1.2">arg</ci><ci id="S2.SS3.p4.19.m12.1.1.3.cmml" xref="S2.SS3.p4.19.m12.1.1.3">min</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.19.m12.1c">\operatorname*{arg\,min}</annotation></semantics></math>, then <math id="S2.SS3.p4.20.m13.1" class="ltx_Math" alttext="Y^{s}" display="inline"><semantics id="S2.SS3.p4.20.m13.1a"><msup id="S2.SS3.p4.20.m13.1.1" xref="S2.SS3.p4.20.m13.1.1.cmml"><mi id="S2.SS3.p4.20.m13.1.1.2" xref="S2.SS3.p4.20.m13.1.1.2.cmml">Y</mi><mi id="S2.SS3.p4.20.m13.1.1.3" xref="S2.SS3.p4.20.m13.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.20.m13.1b"><apply id="S2.SS3.p4.20.m13.1.1.cmml" xref="S2.SS3.p4.20.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.20.m13.1.1.1.cmml" xref="S2.SS3.p4.20.m13.1.1">superscript</csymbol><ci id="S2.SS3.p4.20.m13.1.1.2.cmml" xref="S2.SS3.p4.20.m13.1.1.2">𝑌</ci><ci id="S2.SS3.p4.20.m13.1.1.3.cmml" xref="S2.SS3.p4.20.m13.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.20.m13.1c">Y^{s}</annotation></semantics></math> would have been <span id="S2.SS3.p4.20.2" class="ltx_text ltx_font_italic">``-father"</span>.
This choice however does not affect the overall word edit distance from the correct transcription, which is 2 in both cases (1 substitution and 1 insertion for <span id="S2.SS3.p4.20.3" class="ltx_text ltx_font_italic">``i'd line to call ma my father"</span>, and 2 substitutions for <span id="S2.SS3.p4.20.4" class="ltx_text ltx_font_italic">``i'd line to call ma father"</span>).</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2407.04641/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>AWSED procedure for computing the optimal alignment between a hypothesis prefix and a full reference.
</figcaption>
</figure>
<div id="S2.SS3.p5" class="ltx_para">
<p id="S2.SS3.p5.1" class="ltx_p">We use stochastic gradient descent with Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> to finetune. For each mini-batch <math id="S2.SS3.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S2.SS3.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><ci id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">\mathcal{B}</annotation></semantics></math>, we minimize the cross-entropy:</p>
<table id="S4.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E7.m1.7" class="ltx_Math" alttext="\displaystyle J_{\mathcal{B}}=-\sum_{(\mathbf{\textbf{X}},Y)\in\mathcal{B}}\sum_{u={v^{*}+1}}^{U}\log P_{\phi_{e},\theta+\Delta\theta,\mathbf{\textbf{Q}},\zeta}(y_{u}|\hat{Y}^{p},\mathbf{\textbf{X}}^{p})," display="inline"><semantics id="S2.E7.m1.7a"><mrow id="S2.E7.m1.7.7.1" xref="S2.E7.m1.7.7.1.1.cmml"><mrow id="S2.E7.m1.7.7.1.1" xref="S2.E7.m1.7.7.1.1.cmml"><msub id="S2.E7.m1.7.7.1.1.3" xref="S2.E7.m1.7.7.1.1.3.cmml"><mi id="S2.E7.m1.7.7.1.1.3.2" xref="S2.E7.m1.7.7.1.1.3.2.cmml">J</mi><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.7.7.1.1.3.3" xref="S2.E7.m1.7.7.1.1.3.3.cmml">ℬ</mi></msub><mo id="S2.E7.m1.7.7.1.1.2" xref="S2.E7.m1.7.7.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.7.7.1.1.1" xref="S2.E7.m1.7.7.1.1.1.cmml"><mo id="S2.E7.m1.7.7.1.1.1a" xref="S2.E7.m1.7.7.1.1.1.cmml">−</mo><mrow id="S2.E7.m1.7.7.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E7.m1.7.7.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.2.cmml"><munder id="S2.E7.m1.7.7.1.1.1.1.2a" xref="S2.E7.m1.7.7.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E7.m1.7.7.1.1.1.1.2.2" xref="S2.E7.m1.7.7.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.2.4.2.1" xref="S2.E7.m1.2.2.2.4.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1a.cmml">X</mtext><mo id="S2.E7.m1.2.2.2.4.2.2" xref="S2.E7.m1.2.2.2.4.1.cmml">,</mo><mi id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml">Y</mi><mo stretchy="false" id="S2.E7.m1.2.2.2.4.2.3" xref="S2.E7.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.2.2.2.5" xref="S2.E7.m1.2.2.2.5.cmml">ℬ</mi></mrow></munder></mstyle><mrow id="S2.E7.m1.7.7.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E7.m1.7.7.1.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.1.2.cmml"><munderover id="S2.E7.m1.7.7.1.1.1.1.1.2a" xref="S2.E7.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E7.m1.7.7.1.1.1.1.1.2.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.2" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">u</mi><mo id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.1" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.cmml"><msup id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.2.cmml">v</mi><mo id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.3" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.3.cmml">∗</mo></msup><mo id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.1" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.3" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.E7.m1.7.7.1.1.1.1.1.2.3" xref="S2.E7.m1.7.7.1.1.1.1.1.2.3.cmml">U</mi></munderover></mstyle><mrow id="S2.E7.m1.7.7.1.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.7.7.1.1.1.1.1.1.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.3.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E7.m1.7.7.1.1.1.1.1.1.3a" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E7.m1.7.7.1.1.1.1.1.1.3.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.2.cmml">P</mi><mrow id="S2.E7.m1.6.6.4.4" xref="S2.E7.m1.6.6.4.5.cmml"><msub id="S2.E7.m1.5.5.3.3.1" xref="S2.E7.m1.5.5.3.3.1.cmml"><mi id="S2.E7.m1.5.5.3.3.1.2" xref="S2.E7.m1.5.5.3.3.1.2.cmml">ϕ</mi><mi id="S2.E7.m1.5.5.3.3.1.3" xref="S2.E7.m1.5.5.3.3.1.3.cmml">e</mi></msub><mo id="S2.E7.m1.6.6.4.4.3" xref="S2.E7.m1.6.6.4.5.cmml">,</mo><mrow id="S2.E7.m1.6.6.4.4.2" xref="S2.E7.m1.6.6.4.4.2.cmml"><mi id="S2.E7.m1.6.6.4.4.2.2" xref="S2.E7.m1.6.6.4.4.2.2.cmml">θ</mi><mo id="S2.E7.m1.6.6.4.4.2.1" xref="S2.E7.m1.6.6.4.4.2.1.cmml">+</mo><mrow id="S2.E7.m1.6.6.4.4.2.3" xref="S2.E7.m1.6.6.4.4.2.3.cmml"><mi mathvariant="normal" id="S2.E7.m1.6.6.4.4.2.3.2" xref="S2.E7.m1.6.6.4.4.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.6.6.4.4.2.3.1" xref="S2.E7.m1.6.6.4.4.2.3.1.cmml">​</mo><mi id="S2.E7.m1.6.6.4.4.2.3.3" xref="S2.E7.m1.6.6.4.4.2.3.3.cmml">θ</mi></mrow></mrow><mo id="S2.E7.m1.6.6.4.4.4" xref="S2.E7.m1.6.6.4.5.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1a.cmml">Q</mtext><mo id="S2.E7.m1.6.6.4.4.5" xref="S2.E7.m1.6.6.4.5.cmml">,</mo><mi id="S2.E7.m1.4.4.2.2" xref="S2.E7.m1.4.4.2.2.cmml">ζ</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.7.7.1.1.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.3.cmml">u</mi></msub><mo fence="false" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml"><msup id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2a.cmml">X</mtext><mi id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">p</mi></msup></mrow></mrow><mo stretchy="false" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E7.m1.7.7.1.2" xref="S2.E7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.7b"><apply id="S2.E7.m1.7.7.1.1.cmml" xref="S2.E7.m1.7.7.1"><eq id="S2.E7.m1.7.7.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.2"></eq><apply id="S2.E7.m1.7.7.1.1.3.cmml" xref="S2.E7.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.3.1.cmml" xref="S2.E7.m1.7.7.1.1.3">subscript</csymbol><ci id="S2.E7.m1.7.7.1.1.3.2.cmml" xref="S2.E7.m1.7.7.1.1.3.2">𝐽</ci><ci id="S2.E7.m1.7.7.1.1.3.3.cmml" xref="S2.E7.m1.7.7.1.1.3.3">ℬ</ci></apply><apply id="S2.E7.m1.7.7.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1"><minus id="S2.E7.m1.7.7.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1"></minus><apply id="S2.E7.m1.7.7.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1"><apply id="S2.E7.m1.7.7.1.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S2.E7.m1.7.7.1.1.1.1.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.2.2"></sum><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><in id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></in><interval closure="open" id="S2.E7.m1.2.2.2.4.1.cmml" xref="S2.E7.m1.2.2.2.4.2"><ci id="S2.E7.m1.1.1.1.1a.cmml" xref="S2.E7.m1.1.1.1.1"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">X</mtext></ci><ci id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2">𝑌</ci></interval><ci id="S2.E7.m1.2.2.2.5.cmml" xref="S2.E7.m1.2.2.2.5">ℬ</ci></apply></apply><apply id="S2.E7.m1.7.7.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1"><apply id="S2.E7.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E7.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E7.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3"><eq id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.2">𝑢</ci><apply id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3"><plus id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.1"></plus><apply id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2">superscript</csymbol><ci id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.2">𝑣</ci><times id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.2.3"></times></apply><cn type="integer" id="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.E7.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.2.3">𝑈</ci></apply><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1"><times id="S2.E7.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.2"></times><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3"><log id="S2.E7.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.1"></log><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.3.2.2">𝑃</ci><list id="S2.E7.m1.6.6.4.5.cmml" xref="S2.E7.m1.6.6.4.4"><apply id="S2.E7.m1.5.5.3.3.1.cmml" xref="S2.E7.m1.5.5.3.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.3.3.1.1.cmml" xref="S2.E7.m1.5.5.3.3.1">subscript</csymbol><ci id="S2.E7.m1.5.5.3.3.1.2.cmml" xref="S2.E7.m1.5.5.3.3.1.2">italic-ϕ</ci><ci id="S2.E7.m1.5.5.3.3.1.3.cmml" xref="S2.E7.m1.5.5.3.3.1.3">𝑒</ci></apply><apply id="S2.E7.m1.6.6.4.4.2.cmml" xref="S2.E7.m1.6.6.4.4.2"><plus id="S2.E7.m1.6.6.4.4.2.1.cmml" xref="S2.E7.m1.6.6.4.4.2.1"></plus><ci id="S2.E7.m1.6.6.4.4.2.2.cmml" xref="S2.E7.m1.6.6.4.4.2.2">𝜃</ci><apply id="S2.E7.m1.6.6.4.4.2.3.cmml" xref="S2.E7.m1.6.6.4.4.2.3"><times id="S2.E7.m1.6.6.4.4.2.3.1.cmml" xref="S2.E7.m1.6.6.4.4.2.3.1"></times><ci id="S2.E7.m1.6.6.4.4.2.3.2.cmml" xref="S2.E7.m1.6.6.4.4.2.3.2">Δ</ci><ci id="S2.E7.m1.6.6.4.4.2.3.3.cmml" xref="S2.E7.m1.6.6.4.4.2.3.3">𝜃</ci></apply></apply><ci id="S2.E7.m1.3.3.1.1a.cmml" xref="S2.E7.m1.3.3.1.1"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S2.E7.m1.3.3.1.1.cmml" xref="S2.E7.m1.3.3.1.1">Q</mtext></ci><ci id="S2.E7.m1.4.4.2.2.cmml" xref="S2.E7.m1.4.4.2.2">𝜁</ci></list></apply></apply><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.4.3">𝑢</ci></apply><list id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑌</ci></apply><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2">X</mtext></ci><ci id="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑝</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.7c">\displaystyle J_{\mathcal{B}}=-\sum_{(\mathbf{\textbf{X}},Y)\in\mathcal{B}}\sum_{u={v^{*}+1}}^{U}\log P_{\phi_{e},\theta+\Delta\theta,\mathbf{\textbf{Q}},\zeta}(y_{u}|\hat{Y}^{p},\mathbf{\textbf{X}}^{p}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p5.4" class="ltx_p">with respect to the cross-attention parameters (<math id="S2.SS3.p5.2.m1.1" class="ltx_Math" alttext="\zeta" display="inline"><semantics id="S2.SS3.p5.2.m1.1a"><mi id="S2.SS3.p5.2.m1.1.1" xref="S2.SS3.p5.2.m1.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m1.1b"><ci id="S2.SS3.p5.2.m1.1.1.cmml" xref="S2.SS3.p5.2.m1.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m1.1c">\zeta</annotation></semantics></math>), soft prompt query vectors (<span id="S2.SS3.p5.4.1" class="ltx_text ltx_markedasmath ltx_font_bold">Q</span>) and LoRA parameters (<math id="S2.SS3.p5.4.m3.1" class="ltx_Math" alttext="\Delta\theta" display="inline"><semantics id="S2.SS3.p5.4.m3.1a"><mrow id="S2.SS3.p5.4.m3.1.1" xref="S2.SS3.p5.4.m3.1.1.cmml"><mi mathvariant="normal" id="S2.SS3.p5.4.m3.1.1.2" xref="S2.SS3.p5.4.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p5.4.m3.1.1.1" xref="S2.SS3.p5.4.m3.1.1.1.cmml">​</mo><mi id="S2.SS3.p5.4.m3.1.1.3" xref="S2.SS3.p5.4.m3.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.4.m3.1b"><apply id="S2.SS3.p5.4.m3.1.1.cmml" xref="S2.SS3.p5.4.m3.1.1"><times id="S2.SS3.p5.4.m3.1.1.1.cmml" xref="S2.SS3.p5.4.m3.1.1.1"></times><ci id="S2.SS3.p5.4.m3.1.1.2.cmml" xref="S2.SS3.p5.4.m3.1.1.2">Δ</ci><ci id="S2.SS3.p5.4.m3.1.1.3.cmml" xref="S2.SS3.p5.4.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.4.m3.1c">\Delta\theta</annotation></semantics></math>).</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Metrics</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">SSR differs from conventional ASR in one crucial respect: it has no single correct answer; for a given prefix audio, it is impossible to determine the suffix with perfect certitude.
This makes the word error rate (WER) metric
unsuitable for out purposes.
Moreover WER—or any other metric that is computed over the entire sentence—also encompasses a measure of the prefix transcription accuracy and thus can only be, at best, a diffuse proxy for speculation performance.
Hence, we seek a metric which isolates the accuracy of the speculated suffix while also accounting for the uncertainty inherent in the task.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">One solution would be to treat the task as a language modeling one, and to report the perplexity of the correct suffix.
Perplexity however has the drawback that it is not an operational measure, i.e., we can use it to compare systems and say lower is better, but knowing the exact perplexity score says little about the conditions under which the system is usable.
Furthermore, perplexity has to be computed with ``teacher-forcing", which does not reflect the practical usage of an ASR system.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">Instead, we treat speculation as a quasi-retrieval problem and propose an analog of recall-at-k.
The metric, which we term suffix oracle word error rate (SOWER) is computed by truncating <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">t</annotation></semantics></math> seconds from the end of the audio, letting the system hypothesize <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">k</annotation></semantics></math> suffixes <math id="S3.SS1.p3.3.m3.5" class="ltx_Math" alttext="\hat{Y}^{s}(1),\dots,\hat{Y}^{s}(k)" display="inline"><semantics id="S3.SS1.p3.3.m3.5a"><mrow id="S3.SS1.p3.3.m3.5.5.2" xref="S3.SS1.p3.3.m3.5.5.3.cmml"><mrow id="S3.SS1.p3.3.m3.4.4.1.1" xref="S3.SS1.p3.3.m3.4.4.1.1.cmml"><msup id="S3.SS1.p3.3.m3.4.4.1.1.2" xref="S3.SS1.p3.3.m3.4.4.1.1.2.cmml"><mover accent="true" id="S3.SS1.p3.3.m3.4.4.1.1.2.2" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2.cmml"><mi id="S3.SS1.p3.3.m3.4.4.1.1.2.2.2" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2.2.cmml">Y</mi><mo id="S3.SS1.p3.3.m3.4.4.1.1.2.2.1" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.3.m3.4.4.1.1.2.3" xref="S3.SS1.p3.3.m3.4.4.1.1.2.3.cmml">s</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.4.4.1.1.1" xref="S3.SS1.p3.3.m3.4.4.1.1.1.cmml">​</mo><mrow id="S3.SS1.p3.3.m3.4.4.1.1.3.2" xref="S3.SS1.p3.3.m3.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.4.4.1.1.3.2.1" xref="S3.SS1.p3.3.m3.4.4.1.1.cmml">(</mo><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS1.p3.3.m3.4.4.1.1.3.2.2" xref="S3.SS1.p3.3.m3.4.4.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.3.m3.5.5.2.3" xref="S3.SS1.p3.3.m3.5.5.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p3.3.m3.3.3" xref="S3.SS1.p3.3.m3.3.3.cmml">…</mi><mo id="S3.SS1.p3.3.m3.5.5.2.4" xref="S3.SS1.p3.3.m3.5.5.3.cmml">,</mo><mrow id="S3.SS1.p3.3.m3.5.5.2.2" xref="S3.SS1.p3.3.m3.5.5.2.2.cmml"><msup id="S3.SS1.p3.3.m3.5.5.2.2.2" xref="S3.SS1.p3.3.m3.5.5.2.2.2.cmml"><mover accent="true" id="S3.SS1.p3.3.m3.5.5.2.2.2.2" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2.cmml"><mi id="S3.SS1.p3.3.m3.5.5.2.2.2.2.2" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2.2.cmml">Y</mi><mo id="S3.SS1.p3.3.m3.5.5.2.2.2.2.1" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.3.m3.5.5.2.2.2.3" xref="S3.SS1.p3.3.m3.5.5.2.2.2.3.cmml">s</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.5.5.2.2.1" xref="S3.SS1.p3.3.m3.5.5.2.2.1.cmml">​</mo><mrow id="S3.SS1.p3.3.m3.5.5.2.2.3.2" xref="S3.SS1.p3.3.m3.5.5.2.2.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.5.5.2.2.3.2.1" xref="S3.SS1.p3.3.m3.5.5.2.2.cmml">(</mo><mi id="S3.SS1.p3.3.m3.2.2" xref="S3.SS1.p3.3.m3.2.2.cmml">k</mi><mo stretchy="false" id="S3.SS1.p3.3.m3.5.5.2.2.3.2.2" xref="S3.SS1.p3.3.m3.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.5b"><list id="S3.SS1.p3.3.m3.5.5.3.cmml" xref="S3.SS1.p3.3.m3.5.5.2"><apply id="S3.SS1.p3.3.m3.4.4.1.1.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1"><times id="S3.SS1.p3.3.m3.4.4.1.1.1.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.1"></times><apply id="S3.SS1.p3.3.m3.4.4.1.1.2.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.4.4.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2">superscript</csymbol><apply id="S3.SS1.p3.3.m3.4.4.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2"><ci id="S3.SS1.p3.3.m3.4.4.1.1.2.2.1.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2.1">^</ci><ci id="S3.SS1.p3.3.m3.4.4.1.1.2.2.2.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2.2.2">𝑌</ci></apply><ci id="S3.SS1.p3.3.m3.4.4.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.4.4.1.1.2.3">𝑠</ci></apply><cn type="integer" id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">1</cn></apply><ci id="S3.SS1.p3.3.m3.3.3.cmml" xref="S3.SS1.p3.3.m3.3.3">…</ci><apply id="S3.SS1.p3.3.m3.5.5.2.2.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2"><times id="S3.SS1.p3.3.m3.5.5.2.2.1.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.1"></times><apply id="S3.SS1.p3.3.m3.5.5.2.2.2.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.5.5.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2">superscript</csymbol><apply id="S3.SS1.p3.3.m3.5.5.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2"><ci id="S3.SS1.p3.3.m3.5.5.2.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2.1">^</ci><ci id="S3.SS1.p3.3.m3.5.5.2.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2.2.2">𝑌</ci></apply><ci id="S3.SS1.p3.3.m3.5.5.2.2.2.3.cmml" xref="S3.SS1.p3.3.m3.5.5.2.2.2.3">𝑠</ci></apply><ci id="S3.SS1.p3.3.m3.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.5c">\hat{Y}^{s}(1),\dots,\hat{Y}^{s}(k)</annotation></semantics></math>, and returning the minimal WER between the hypotheses and the correct suffix <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="Y^{s}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msup id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">Y</mi><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑌</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">Y^{s}</annotation></semantics></math>:</p>
<table id="S4.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\displaystyle S(t,k)=\min_{i\in[1,k]}\text{WER}(\hat{Y}^{s}(i),Y^{s})." display="inline"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.4" xref="S3.E8.m1.6.6.1.1.4.cmml"><mi id="S3.E8.m1.6.6.1.1.4.2" xref="S3.E8.m1.6.6.1.1.4.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.4.1" xref="S3.E8.m1.6.6.1.1.4.1.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.4.3.2" xref="S3.E8.m1.6.6.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.4.3.2.1" xref="S3.E8.m1.6.6.1.1.4.3.1.cmml">(</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">t</mi><mo id="S3.E8.m1.6.6.1.1.4.3.2.2" xref="S3.E8.m1.6.6.1.1.4.3.1.cmml">,</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">k</mi><mo stretchy="false" id="S3.E8.m1.6.6.1.1.4.3.2.3" xref="S3.E8.m1.6.6.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.3" xref="S3.E8.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml"><mrow id="S3.E8.m1.6.6.1.1.2.4" xref="S3.E8.m1.6.6.1.1.2.4.cmml"><munder id="S3.E8.m1.6.6.1.1.2.4.1" xref="S3.E8.m1.6.6.1.1.2.4.1.cmml"><mi id="S3.E8.m1.6.6.1.1.2.4.1.2" xref="S3.E8.m1.6.6.1.1.2.4.1.2.cmml">min</mi><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mi id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.4.cmml">i</mi><mo id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">∈</mo><mrow id="S3.E8.m1.2.2.2.5.2" xref="S3.E8.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.5.2.1" xref="S3.E8.m1.2.2.2.5.1.cmml">[</mo><mn id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">1</mn><mo id="S3.E8.m1.2.2.2.5.2.2" xref="S3.E8.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S3.E8.m1.2.2.2.5.2.3" xref="S3.E8.m1.2.2.2.5.1.cmml">]</mo></mrow></mrow></munder><mo lspace="0.167em" id="S3.E8.m1.6.6.1.1.2.4a" xref="S3.E8.m1.6.6.1.1.2.4.cmml">⁡</mo><mtext id="S3.E8.m1.6.6.1.1.2.4.2" xref="S3.E8.m1.6.6.1.1.2.4.2a.cmml">WER</mtext></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.2.3" xref="S3.E8.m1.6.6.1.1.2.3.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.2.2.3" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">(</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml"><msup id="S3.E8.m1.6.6.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">Y</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml">s</mi></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.1.3.2.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">i</mi><mo stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.2.2.2.4" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">,</mo><msup id="S3.E8.m1.6.6.1.1.2.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.6.6.1.1.2.2.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.2.2.cmml">Y</mi><mi id="S3.E8.m1.6.6.1.1.2.2.2.2.3" xref="S3.E8.m1.6.6.1.1.2.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.2.2.5" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><eq id="S3.E8.m1.6.6.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.3"></eq><apply id="S3.E8.m1.6.6.1.1.4.cmml" xref="S3.E8.m1.6.6.1.1.4"><times id="S3.E8.m1.6.6.1.1.4.1.cmml" xref="S3.E8.m1.6.6.1.1.4.1"></times><ci id="S3.E8.m1.6.6.1.1.4.2.cmml" xref="S3.E8.m1.6.6.1.1.4.2">𝑆</ci><interval closure="open" id="S3.E8.m1.6.6.1.1.4.3.1.cmml" xref="S3.E8.m1.6.6.1.1.4.3.2"><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝑡</ci><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝑘</ci></interval></apply><apply id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"><times id="S3.E8.m1.6.6.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.3"></times><apply id="S3.E8.m1.6.6.1.1.2.4.cmml" xref="S3.E8.m1.6.6.1.1.2.4"><apply id="S3.E8.m1.6.6.1.1.2.4.1.cmml" xref="S3.E8.m1.6.6.1.1.2.4.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.4.1.1.cmml" xref="S3.E8.m1.6.6.1.1.2.4.1">subscript</csymbol><min id="S3.E8.m1.6.6.1.1.2.4.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2.4.1.2"></min><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><in id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></in><ci id="S3.E8.m1.2.2.2.4.cmml" xref="S3.E8.m1.2.2.2.4">𝑖</ci><interval closure="closed" id="S3.E8.m1.2.2.2.5.1.cmml" xref="S3.E8.m1.2.2.2.5.2"><cn type="integer" id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">1</cn><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑘</ci></interval></apply></apply><ci id="S3.E8.m1.6.6.1.1.2.4.2a.cmml" xref="S3.E8.m1.6.6.1.1.2.4.2"><mtext id="S3.E8.m1.6.6.1.1.2.4.2.cmml" xref="S3.E8.m1.6.6.1.1.2.4.2">WER</mtext></ci></apply><interval closure="open" id="S3.E8.m1.6.6.1.1.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><times id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1"></times><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2"><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.2.2">𝑌</ci></apply><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝑖</ci></apply><apply id="S3.E8.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2.2">𝑌</ci><ci id="S3.E8.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2.3">𝑠</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\displaystyle S(t,k)=\min_{i\in[1,k]}\text{WER}(\hat{Y}^{s}(i),Y^{s}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.7" class="ltx_p">This measures how well we expect the model to do if we return the top-<math id="S3.SS1.p3.5.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p3.5.m1.1a"><mi id="S3.SS1.p3.5.m1.1.1" xref="S3.SS1.p3.5.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m1.1b"><ci id="S3.SS1.p3.5.m1.1.1.cmml" xref="S3.SS1.p3.5.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m1.1c">k</annotation></semantics></math> hypotheses.
By default, we set <math id="S3.SS1.p3.6.m2.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="S3.SS1.p3.6.m2.1a"><mrow id="S3.SS1.p3.6.m2.1.1" xref="S3.SS1.p3.6.m2.1.1.cmml"><mi id="S3.SS1.p3.6.m2.1.1.2" xref="S3.SS1.p3.6.m2.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.6.m2.1.1.1" xref="S3.SS1.p3.6.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.6.m2.1.1.3" xref="S3.SS1.p3.6.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m2.1b"><apply id="S3.SS1.p3.6.m2.1.1.cmml" xref="S3.SS1.p3.6.m2.1.1"><eq id="S3.SS1.p3.6.m2.1.1.1.cmml" xref="S3.SS1.p3.6.m2.1.1.1"></eq><ci id="S3.SS1.p3.6.m2.1.1.2.cmml" xref="S3.SS1.p3.6.m2.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.6.m2.1.1.3.cmml" xref="S3.SS1.p3.6.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m2.1c">t=1</annotation></semantics></math> and <math id="S3.SS1.p3.7.m3.1" class="ltx_Math" alttext="k=8" display="inline"><semantics id="S3.SS1.p3.7.m3.1a"><mrow id="S3.SS1.p3.7.m3.1.1" xref="S3.SS1.p3.7.m3.1.1.cmml"><mi id="S3.SS1.p3.7.m3.1.1.2" xref="S3.SS1.p3.7.m3.1.1.2.cmml">k</mi><mo id="S3.SS1.p3.7.m3.1.1.1" xref="S3.SS1.p3.7.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.7.m3.1.1.3" xref="S3.SS1.p3.7.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m3.1b"><apply id="S3.SS1.p3.7.m3.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1"><eq id="S3.SS1.p3.7.m3.1.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1.1"></eq><ci id="S3.SS1.p3.7.m3.1.1.2.cmml" xref="S3.SS1.p3.7.m3.1.1.2">𝑘</ci><cn type="integer" id="S3.SS1.p3.7.m3.1.1.3.cmml" xref="S3.SS1.p3.7.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m3.1c">k=8</annotation></semantics></math> in our experiments.
Note that, to get the correct suffix for evaluation, we once again use the AWSED procedure described in Section <a href="#S2.SS3" title="2.3 Alignment and finetuning for speculation ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a> on the prefix transcription and the full reference.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Datasets and model architecture</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We use Speechstew <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, an amalgamation of multiple public corpora totalling about 5000 hours, to pretrain the Conformer for transcription.
We conduct two sets of experiments, varying the pretraining, finetuinnig and testing data:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Librispeech-only</span>: Here, we use Librispeech LM data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> for pretraining the language model, finetune on the 960h Librispeech training set, and test on the Librispeech test splits.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p"><span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">Multi-domain</span>: Here, we pretrain the LM with data composed of the Librispeech LM data along with text from the Switchboard <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, TED-LIUM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and Wall Street Journal <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> corpora. We finetune on Speechstew, and test on the AMI-IHM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, Librispeech, Switchboard and TED-LIUM test sets.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">The Transducer model has a 100 million parameter, 17-layer Conformer-L <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> encoder with 512-dimensional layers operating on 80-dimensional log-mel filterbank inputs, an LSTM prediction network with one 512-dimensional layer, and a 2-layer feedforward joint network with 512-dimensional intermediate layer and 1024-dimensional output softmax layer corresponding to 1024 Librispeech word-piece <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> targets.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">The LM is a 100 million parameter transformer decoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> with eight 1024-dimensional layers, each split into 16 attention heads, and tied embedding-softmax with the same 1024 word piece units as the Transducer.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.2" class="ltx_p">We use <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="M=64" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">M</mi><mo id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"></eq><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝑀</ci><cn type="integer" id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">M=64</annotation></semantics></math> queries (equivalent in length to <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="2.56" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mn id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">2.56</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><cn type="float" id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">2.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">2.56</annotation></semantics></math> seconds of audio) of 1024 dimensions and a single 1024-dimensional cross-attention layer with four heads for computing the soft-prompt.
We set the rank of the LoRA adapters to 10 for the Librispeech experiments and 50 for the multi-domain experiments, resulting in 12 million and 19 million trainable parameters respectively to be finetuned for speculation.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Speculation systems</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We report results for four model configurations:</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p"><span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_bold">Pretrained model (PM)</span>: This is the our replication of the model from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> (described in §<a href="#S2.SS1" title="2.1 Baseline speculative ASR with ASR-LM hybrid ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>), which uses the pretrained LM to speculate suffixes without any finetuning or audio prefix.
We note that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> also incorporates a confidence model on top of speculation.
Here, we focus only on the speculator itself.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.2" class="ltx_p"><span id="S3.SS3.p3.2.1" class="ltx_text ltx_font_bold">Hypothesis-only finetuned (HO)</span>: Similar to PM, this configuration only uses the Transducer hypotheses—without audio encoding—as the LM input.
The LM, however, is finetuned for speculation.
Instead of the audio-aware prefix, <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{\textbf{A}}^{p}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msup id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2a.cmml">A</mtext><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2a.cmml" xref="S3.SS3.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">A</mtext></ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{\textbf{A}}^{p}</annotation></semantics></math>, we use the trainable vectors, <math id="S3.SS3.p3.2.m2.3" class="ltx_Math" alttext="\mathbf{\textbf{q}}_{1},\dots,\mathbf{\textbf{q}}_{M}" display="inline"><semantics id="S3.SS3.p3.2.m2.3a"><mrow id="S3.SS3.p3.2.m2.3.3.2" xref="S3.SS3.p3.2.m2.3.3.3.cmml"><msub id="S3.SS3.p3.2.m2.2.2.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.2.2.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.2a.cmml">q</mtext><mn id="S3.SS3.p3.2.m2.2.2.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.2.m2.3.3.2.3" xref="S3.SS3.p3.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p3.2.m2.3.3.2.4" xref="S3.SS3.p3.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS3.p3.2.m2.3.3.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.3.3.2.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.2a.cmml">q</mtext><mi id="S3.SS3.p3.2.m2.3.3.2.2.3" xref="S3.SS3.p3.2.m2.3.3.2.2.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.3b"><list id="S3.SS3.p3.2.m2.3.3.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2"><apply id="S3.SS3.p3.2.m2.2.2.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.2a.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.2">q</mtext></ci><cn type="integer" id="S3.SS3.p3.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">…</ci><apply id="S3.SS3.p3.2.m2.3.3.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.3.3.2.2.2a.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2">q</mtext></ci><ci id="S3.SS3.p3.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.3c">\mathbf{\textbf{q}}_{1},\dots,\mathbf{\textbf{q}}_{M}</annotation></semantics></math>, directly as the (audio-agnostic) prefix and finetune them along with the LM softmax and LoRA layers.
This configuration allows us to separate what improvements, if any, come from ASR-error-aware finetuning and what improvements come from using an audio prefix.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.1" class="ltx_p"><span id="S3.SS3.p4.1.1" class="ltx_text ltx_font_bold">Speech-prefix finetuned (SP)</span>: This is the full configuration as described in §<a href="#S2.SS2" title="2.2 Audio-aware speculative ASR ‣ 2 Methods ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>, which uses an audio-dependent soft prompt.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.1" class="ltx_p"><span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_bold">Speech prefix + Text Injection (ST)</span>: This configuration adds text injection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to SP.
While finetuning on paired speech-text data, the trainable parameters are jointly trained on the text used to pretrain the respective LM, so that the LM does not overfit to the paired training data.
Since the text-only training mini-batches have no audio input, their cross-attention keys and values and, consequently the LM prompts, are set to 0.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>SOWER on the Librispeech dev and test sets; ``tavg" is the average of the test sets.
PM-1w and ST-1w denote SOWER computed on just the first suffix word;
<math id="S3.T1.5.m1.1" class="ltx_Math" alttext="\Delta_{97.5}" display="inline"><semantics id="S3.T1.5.m1.1b"><msub id="S3.T1.5.m1.1.1" xref="S3.T1.5.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T1.5.m1.1.1.2" xref="S3.T1.5.m1.1.1.2.cmml">Δ</mi><mn id="S3.T1.5.m1.1.1.3" xref="S3.T1.5.m1.1.1.3.cmml">97.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.m1.1c"><apply id="S3.T1.5.m1.1.1.cmml" xref="S3.T1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.m1.1.1.1.cmml" xref="S3.T1.5.m1.1.1">subscript</csymbol><ci id="S3.T1.5.m1.1.1.2.cmml" xref="S3.T1.5.m1.1.1.2">Δ</ci><cn type="float" id="S3.T1.5.m1.1.1.3.cmml" xref="S3.T1.5.m1.1.1.3">97.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.m1.1d">\Delta_{97.5}</annotation></semantics></math> and <math id="S3.T1.6.m2.1" class="ltx_Math" alttext="\Delta_{2.5}" display="inline"><semantics id="S3.T1.6.m2.1b"><msub id="S3.T1.6.m2.1.1" xref="S3.T1.6.m2.1.1.cmml"><mi mathvariant="normal" id="S3.T1.6.m2.1.1.2" xref="S3.T1.6.m2.1.1.2.cmml">Δ</mi><mn id="S3.T1.6.m2.1.1.3" xref="S3.T1.6.m2.1.1.3.cmml">2.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.m2.1c"><apply id="S3.T1.6.m2.1.1.cmml" xref="S3.T1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.6.m2.1.1.1.cmml" xref="S3.T1.6.m2.1.1">subscript</csymbol><ci id="S3.T1.6.m2.1.1.2.cmml" xref="S3.T1.6.m2.1.1.2">Δ</ci><cn type="float" id="S3.T1.6.m2.1.1.3.cmml" xref="S3.T1.6.m2.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.m2.1d">\Delta_{2.5}</annotation></semantics></math> denote respectively the <math id="S3.T1.7.m3.1" class="ltx_Math" alttext="97.5" display="inline"><semantics id="S3.T1.7.m3.1b"><mn id="S3.T1.7.m3.1.1" xref="S3.T1.7.m3.1.1.cmml">97.5</mn><annotation-xml encoding="MathML-Content" id="S3.T1.7.m3.1c"><cn type="float" id="S3.T1.7.m3.1.1.cmml" xref="S3.T1.7.m3.1.1">97.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.m3.1d">97.5</annotation></semantics></math> and <math id="S3.T1.8.m4.1" class="ltx_Math" alttext="2.5" display="inline"><semantics id="S3.T1.8.m4.1b"><mn id="S3.T1.8.m4.1.1" xref="S3.T1.8.m4.1.1.cmml">2.5</mn><annotation-xml encoding="MathML-Content" id="S3.T1.8.m4.1c"><cn type="float" id="S3.T1.8.m4.1.1.cmml" xref="S3.T1.8.m4.1.1">2.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.m4.1d">2.5</annotation></semantics></math> percentile values of the improvement over PM estimated with blockwise bootstrap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
</figcaption>
<div id="S3.T1.10" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:164.3pt;height:72.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-60.0pt,26.6pt) scale(0.578157455202133,0.578157455202133) ;">
<table id="S3.T1.10.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.10.2.2" class="ltx_tr">
<td id="S3.T1.10.2.2.3" class="ltx_td ltx_border_tt"></td>
<td id="S3.T1.10.2.2.4" class="ltx_td ltx_align_center ltx_border_tt">dev-c</td>
<td id="S3.T1.10.2.2.5" class="ltx_td ltx_align_center ltx_border_tt">dev-o</td>
<td id="S3.T1.10.2.2.6" class="ltx_td ltx_align_center ltx_border_tt">test-c</td>
<td id="S3.T1.10.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">test-o</td>
<td id="S3.T1.10.2.2.8" class="ltx_td ltx_align_center ltx_border_tt">tavg</td>
<td id="S3.T1.9.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.9.1.1.1.m1.1" class="ltx_Math" alttext="\Delta_{97.5}" display="inline"><semantics id="S3.T1.9.1.1.1.m1.1a"><msub id="S3.T1.9.1.1.1.m1.1.1" xref="S3.T1.9.1.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T1.9.1.1.1.m1.1.1.2" xref="S3.T1.9.1.1.1.m1.1.1.2.cmml">Δ</mi><mn id="S3.T1.9.1.1.1.m1.1.1.3" xref="S3.T1.9.1.1.1.m1.1.1.3.cmml">97.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.1.1.1.m1.1b"><apply id="S3.T1.9.1.1.1.m1.1.1.cmml" xref="S3.T1.9.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.1.1.1.m1.1.1.1.cmml" xref="S3.T1.9.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.1.1.1.m1.1.1.2.cmml" xref="S3.T1.9.1.1.1.m1.1.1.2">Δ</ci><cn type="float" id="S3.T1.9.1.1.1.m1.1.1.3.cmml" xref="S3.T1.9.1.1.1.m1.1.1.3">97.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.1.1.1.m1.1c">\Delta_{97.5}</annotation></semantics></math></td>
<td id="S3.T1.10.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.10.2.2.2.m1.1" class="ltx_Math" alttext="\Delta_{2.5}" display="inline"><semantics id="S3.T1.10.2.2.2.m1.1a"><msub id="S3.T1.10.2.2.2.m1.1.1" xref="S3.T1.10.2.2.2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T1.10.2.2.2.m1.1.1.2" xref="S3.T1.10.2.2.2.m1.1.1.2.cmml">Δ</mi><mn id="S3.T1.10.2.2.2.m1.1.1.3" xref="S3.T1.10.2.2.2.m1.1.1.3.cmml">2.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.2.2.2.m1.1b"><apply id="S3.T1.10.2.2.2.m1.1.1.cmml" xref="S3.T1.10.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.2.2.2.m1.1.1.1.cmml" xref="S3.T1.10.2.2.2.m1.1.1">subscript</csymbol><ci id="S3.T1.10.2.2.2.m1.1.1.2.cmml" xref="S3.T1.10.2.2.2.m1.1.1.2">Δ</ci><cn type="float" id="S3.T1.10.2.2.2.m1.1.1.3.cmml" xref="S3.T1.10.2.2.2.m1.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.2.2.2.m1.1c">\Delta_{2.5}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.10.2.3.1" class="ltx_tr">
<td id="S3.T1.10.2.3.1.1" class="ltx_td ltx_align_left ltx_border_t">PM</td>
<td id="S3.T1.10.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">75.0</td>
<td id="S3.T1.10.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">79.4</td>
<td id="S3.T1.10.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t">74.4</td>
<td id="S3.T1.10.2.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.2</td>
<td id="S3.T1.10.2.3.1.6" class="ltx_td ltx_align_center ltx_border_t">77.8</td>
<td id="S3.T1.10.2.3.1.7" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S3.T1.10.2.3.1.8" class="ltx_td ltx_align_center ltx_border_t">0</td>
</tr>
<tr id="S3.T1.10.2.4.2" class="ltx_tr">
<td id="S3.T1.10.2.4.2.1" class="ltx_td ltx_align_left">HO</td>
<td id="S3.T1.10.2.4.2.2" class="ltx_td ltx_align_center">69.0</td>
<td id="S3.T1.10.2.4.2.3" class="ltx_td ltx_align_center">73.2</td>
<td id="S3.T1.10.2.4.2.4" class="ltx_td ltx_align_center">69.0</td>
<td id="S3.T1.10.2.4.2.5" class="ltx_td ltx_align_center ltx_border_r">75.0</td>
<td id="S3.T1.10.2.4.2.6" class="ltx_td ltx_align_center">72.0</td>
<td id="S3.T1.10.2.4.2.7" class="ltx_td ltx_align_center">5.6</td>
<td id="S3.T1.10.2.4.2.8" class="ltx_td ltx_align_center">6.2</td>
</tr>
<tr id="S3.T1.10.2.5.3" class="ltx_tr">
<td id="S3.T1.10.2.5.3.1" class="ltx_td ltx_align_left">SP</td>
<td id="S3.T1.10.2.5.3.2" class="ltx_td ltx_align_center">64.1</td>
<td id="S3.T1.10.2.5.3.3" class="ltx_td ltx_align_center">68.7</td>
<td id="S3.T1.10.2.5.3.4" class="ltx_td ltx_align_center">64.8</td>
<td id="S3.T1.10.2.5.3.5" class="ltx_td ltx_align_center ltx_border_r">69.6</td>
<td id="S3.T1.10.2.5.3.6" class="ltx_td ltx_align_center">67.2</td>
<td id="S3.T1.10.2.5.3.7" class="ltx_td ltx_align_center">9.9</td>
<td id="S3.T1.10.2.5.3.8" class="ltx_td ltx_align_center">11.4</td>
</tr>
<tr id="S3.T1.10.2.6.4" class="ltx_tr">
<td id="S3.T1.10.2.6.4.1" class="ltx_td ltx_align_left">ST</td>
<td id="S3.T1.10.2.6.4.2" class="ltx_td ltx_align_center">61.0</td>
<td id="S3.T1.10.2.6.4.3" class="ltx_td ltx_align_center">66.6</td>
<td id="S3.T1.10.2.6.4.4" class="ltx_td ltx_align_center">61.7</td>
<td id="S3.T1.10.2.6.4.5" class="ltx_td ltx_align_center ltx_border_r">66.9</td>
<td id="S3.T1.10.2.6.4.6" class="ltx_td ltx_align_center">64.3</td>
<td id="S3.T1.10.2.6.4.7" class="ltx_td ltx_align_center">12.8</td>
<td id="S3.T1.10.2.6.4.8" class="ltx_td ltx_align_center">14.2</td>
</tr>
<tr id="S3.T1.10.2.7.5" class="ltx_tr">
<td id="S3.T1.10.2.7.5.1" class="ltx_td ltx_align_left ltx_border_t">PM-1w</td>
<td id="S3.T1.10.2.7.5.2" class="ltx_td ltx_align_center ltx_border_t">61.3</td>
<td id="S3.T1.10.2.7.5.3" class="ltx_td ltx_align_center ltx_border_t">67.2</td>
<td id="S3.T1.10.2.7.5.4" class="ltx_td ltx_align_center ltx_border_t">62.0</td>
<td id="S3.T1.10.2.7.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.1</td>
<td id="S3.T1.10.2.7.5.6" class="ltx_td ltx_align_center ltx_border_t">65.1</td>
<td id="S3.T1.10.2.7.5.7" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S3.T1.10.2.7.5.8" class="ltx_td ltx_align_center ltx_border_t">0</td>
</tr>
<tr id="S3.T1.10.2.8.6" class="ltx_tr">
<td id="S3.T1.10.2.8.6.1" class="ltx_td ltx_align_left ltx_border_bb">ST-1w</td>
<td id="S3.T1.10.2.8.6.2" class="ltx_td ltx_align_center ltx_border_bb">46.1</td>
<td id="S3.T1.10.2.8.6.3" class="ltx_td ltx_align_center ltx_border_bb">51.7</td>
<td id="S3.T1.10.2.8.6.4" class="ltx_td ltx_align_center ltx_border_bb">46.4</td>
<td id="S3.T1.10.2.8.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">52.1</td>
<td id="S3.T1.10.2.8.6.6" class="ltx_td ltx_align_center ltx_border_bb">49.3</td>
<td id="S3.T1.10.2.8.6.7" class="ltx_td ltx_align_center ltx_border_bb">15.3</td>
<td id="S3.T1.10.2.8.6.8" class="ltx_td ltx_align_center ltx_border_bb">15.8</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Oracle WER on the Librispeech dev and test sets. WERR denotes the percentage tavg WER recovered by speculation, computed as <math id="S3.T2.2.m1.1" class="ltx_Math" alttext="100*\frac{sys-baseline}{topline-baseline}" display="inline"><semantics id="S3.T2.2.m1.1b"><mrow id="S3.T2.2.m1.1.1" xref="S3.T2.2.m1.1.1.cmml"><mn id="S3.T2.2.m1.1.1.2" xref="S3.T2.2.m1.1.1.2.cmml">100</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T2.2.m1.1.1.1" xref="S3.T2.2.m1.1.1.1.cmml">∗</mo><mfrac id="S3.T2.2.m1.1.1.3" xref="S3.T2.2.m1.1.1.3.cmml"><mrow id="S3.T2.2.m1.1.1.3.2" xref="S3.T2.2.m1.1.1.3.2.cmml"><mrow id="S3.T2.2.m1.1.1.3.2.2" xref="S3.T2.2.m1.1.1.3.2.2.cmml"><mi id="S3.T2.2.m1.1.1.3.2.2.2" xref="S3.T2.2.m1.1.1.3.2.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.2.1" xref="S3.T2.2.m1.1.1.3.2.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.2.3" xref="S3.T2.2.m1.1.1.3.2.2.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.2.1b" xref="S3.T2.2.m1.1.1.3.2.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.2.4" xref="S3.T2.2.m1.1.1.3.2.2.4.cmml">s</mi></mrow><mo id="S3.T2.2.m1.1.1.3.2.1" xref="S3.T2.2.m1.1.1.3.2.1.cmml">−</mo><mrow id="S3.T2.2.m1.1.1.3.2.3" xref="S3.T2.2.m1.1.1.3.2.3.cmml"><mi id="S3.T2.2.m1.1.1.3.2.3.2" xref="S3.T2.2.m1.1.1.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.3" xref="S3.T2.2.m1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1b" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.4" xref="S3.T2.2.m1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1c" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.5" xref="S3.T2.2.m1.1.1.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1d" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.6" xref="S3.T2.2.m1.1.1.3.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1e" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.7" xref="S3.T2.2.m1.1.1.3.2.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1f" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.8" xref="S3.T2.2.m1.1.1.3.2.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.2.3.1g" xref="S3.T2.2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.2.3.9" xref="S3.T2.2.m1.1.1.3.2.3.9.cmml">e</mi></mrow></mrow><mrow id="S3.T2.2.m1.1.1.3.3" xref="S3.T2.2.m1.1.1.3.3.cmml"><mrow id="S3.T2.2.m1.1.1.3.3.2" xref="S3.T2.2.m1.1.1.3.3.2.cmml"><mi id="S3.T2.2.m1.1.1.3.3.2.2" xref="S3.T2.2.m1.1.1.3.3.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.3" xref="S3.T2.2.m1.1.1.3.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1b" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.4" xref="S3.T2.2.m1.1.1.3.3.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1c" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.5" xref="S3.T2.2.m1.1.1.3.3.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1d" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.6" xref="S3.T2.2.m1.1.1.3.3.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1e" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.7" xref="S3.T2.2.m1.1.1.3.3.2.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.2.1f" xref="S3.T2.2.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.2.8" xref="S3.T2.2.m1.1.1.3.3.2.8.cmml">e</mi></mrow><mo id="S3.T2.2.m1.1.1.3.3.1" xref="S3.T2.2.m1.1.1.3.3.1.cmml">−</mo><mrow id="S3.T2.2.m1.1.1.3.3.3" xref="S3.T2.2.m1.1.1.3.3.3.cmml"><mi id="S3.T2.2.m1.1.1.3.3.3.2" xref="S3.T2.2.m1.1.1.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.3" xref="S3.T2.2.m1.1.1.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1b" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.4" xref="S3.T2.2.m1.1.1.3.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1c" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.5" xref="S3.T2.2.m1.1.1.3.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1d" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.6" xref="S3.T2.2.m1.1.1.3.3.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1e" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.7" xref="S3.T2.2.m1.1.1.3.3.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1f" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.8" xref="S3.T2.2.m1.1.1.3.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T2.2.m1.1.1.3.3.3.1g" xref="S3.T2.2.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.T2.2.m1.1.1.3.3.3.9" xref="S3.T2.2.m1.1.1.3.3.3.9.cmml">e</mi></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.m1.1c"><apply id="S3.T2.2.m1.1.1.cmml" xref="S3.T2.2.m1.1.1"><times id="S3.T2.2.m1.1.1.1.cmml" xref="S3.T2.2.m1.1.1.1"></times><cn type="integer" id="S3.T2.2.m1.1.1.2.cmml" xref="S3.T2.2.m1.1.1.2">100</cn><apply id="S3.T2.2.m1.1.1.3.cmml" xref="S3.T2.2.m1.1.1.3"><divide id="S3.T2.2.m1.1.1.3.1.cmml" xref="S3.T2.2.m1.1.1.3"></divide><apply id="S3.T2.2.m1.1.1.3.2.cmml" xref="S3.T2.2.m1.1.1.3.2"><minus id="S3.T2.2.m1.1.1.3.2.1.cmml" xref="S3.T2.2.m1.1.1.3.2.1"></minus><apply id="S3.T2.2.m1.1.1.3.2.2.cmml" xref="S3.T2.2.m1.1.1.3.2.2"><times id="S3.T2.2.m1.1.1.3.2.2.1.cmml" xref="S3.T2.2.m1.1.1.3.2.2.1"></times><ci id="S3.T2.2.m1.1.1.3.2.2.2.cmml" xref="S3.T2.2.m1.1.1.3.2.2.2">𝑠</ci><ci id="S3.T2.2.m1.1.1.3.2.2.3.cmml" xref="S3.T2.2.m1.1.1.3.2.2.3">𝑦</ci><ci id="S3.T2.2.m1.1.1.3.2.2.4.cmml" xref="S3.T2.2.m1.1.1.3.2.2.4">𝑠</ci></apply><apply id="S3.T2.2.m1.1.1.3.2.3.cmml" xref="S3.T2.2.m1.1.1.3.2.3"><times id="S3.T2.2.m1.1.1.3.2.3.1.cmml" xref="S3.T2.2.m1.1.1.3.2.3.1"></times><ci id="S3.T2.2.m1.1.1.3.2.3.2.cmml" xref="S3.T2.2.m1.1.1.3.2.3.2">𝑏</ci><ci id="S3.T2.2.m1.1.1.3.2.3.3.cmml" xref="S3.T2.2.m1.1.1.3.2.3.3">𝑎</ci><ci id="S3.T2.2.m1.1.1.3.2.3.4.cmml" xref="S3.T2.2.m1.1.1.3.2.3.4">𝑠</ci><ci id="S3.T2.2.m1.1.1.3.2.3.5.cmml" xref="S3.T2.2.m1.1.1.3.2.3.5">𝑒</ci><ci id="S3.T2.2.m1.1.1.3.2.3.6.cmml" xref="S3.T2.2.m1.1.1.3.2.3.6">𝑙</ci><ci id="S3.T2.2.m1.1.1.3.2.3.7.cmml" xref="S3.T2.2.m1.1.1.3.2.3.7">𝑖</ci><ci id="S3.T2.2.m1.1.1.3.2.3.8.cmml" xref="S3.T2.2.m1.1.1.3.2.3.8">𝑛</ci><ci id="S3.T2.2.m1.1.1.3.2.3.9.cmml" xref="S3.T2.2.m1.1.1.3.2.3.9">𝑒</ci></apply></apply><apply id="S3.T2.2.m1.1.1.3.3.cmml" xref="S3.T2.2.m1.1.1.3.3"><minus id="S3.T2.2.m1.1.1.3.3.1.cmml" xref="S3.T2.2.m1.1.1.3.3.1"></minus><apply id="S3.T2.2.m1.1.1.3.3.2.cmml" xref="S3.T2.2.m1.1.1.3.3.2"><times id="S3.T2.2.m1.1.1.3.3.2.1.cmml" xref="S3.T2.2.m1.1.1.3.3.2.1"></times><ci id="S3.T2.2.m1.1.1.3.3.2.2.cmml" xref="S3.T2.2.m1.1.1.3.3.2.2">𝑡</ci><ci id="S3.T2.2.m1.1.1.3.3.2.3.cmml" xref="S3.T2.2.m1.1.1.3.3.2.3">𝑜</ci><ci id="S3.T2.2.m1.1.1.3.3.2.4.cmml" xref="S3.T2.2.m1.1.1.3.3.2.4">𝑝</ci><ci id="S3.T2.2.m1.1.1.3.3.2.5.cmml" xref="S3.T2.2.m1.1.1.3.3.2.5">𝑙</ci><ci id="S3.T2.2.m1.1.1.3.3.2.6.cmml" xref="S3.T2.2.m1.1.1.3.3.2.6">𝑖</ci><ci id="S3.T2.2.m1.1.1.3.3.2.7.cmml" xref="S3.T2.2.m1.1.1.3.3.2.7">𝑛</ci><ci id="S3.T2.2.m1.1.1.3.3.2.8.cmml" xref="S3.T2.2.m1.1.1.3.3.2.8">𝑒</ci></apply><apply id="S3.T2.2.m1.1.1.3.3.3.cmml" xref="S3.T2.2.m1.1.1.3.3.3"><times id="S3.T2.2.m1.1.1.3.3.3.1.cmml" xref="S3.T2.2.m1.1.1.3.3.3.1"></times><ci id="S3.T2.2.m1.1.1.3.3.3.2.cmml" xref="S3.T2.2.m1.1.1.3.3.3.2">𝑏</ci><ci id="S3.T2.2.m1.1.1.3.3.3.3.cmml" xref="S3.T2.2.m1.1.1.3.3.3.3">𝑎</ci><ci id="S3.T2.2.m1.1.1.3.3.3.4.cmml" xref="S3.T2.2.m1.1.1.3.3.3.4">𝑠</ci><ci id="S3.T2.2.m1.1.1.3.3.3.5.cmml" xref="S3.T2.2.m1.1.1.3.3.3.5">𝑒</ci><ci id="S3.T2.2.m1.1.1.3.3.3.6.cmml" xref="S3.T2.2.m1.1.1.3.3.3.6">𝑙</ci><ci id="S3.T2.2.m1.1.1.3.3.3.7.cmml" xref="S3.T2.2.m1.1.1.3.3.3.7">𝑖</ci><ci id="S3.T2.2.m1.1.1.3.3.3.8.cmml" xref="S3.T2.2.m1.1.1.3.3.3.8">𝑛</ci><ci id="S3.T2.2.m1.1.1.3.3.3.9.cmml" xref="S3.T2.2.m1.1.1.3.3.3.9">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.m1.1d">100*\frac{sys-baseline}{topline-baseline}</annotation></semantics></math>, and ST(k=1) refers to using 1-best speculation from ST instead of 8-best.
</figcaption>
<div id="S3.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:167.7pt;height:86.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-55.4pt,28.6pt) scale(0.602240774366591,0.602240774366591) ;">
<table id="S3.T2.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.3.1.1.1" class="ltx_tr">
<th id="S3.T2.3.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S3.T2.3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">dev-c</th>
<th id="S3.T2.3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">dev-o</th>
<th id="S3.T2.3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">test-c</th>
<th id="S3.T2.3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">test-o</th>
<th id="S3.T2.3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">tavg</th>
<th id="S3.T2.3.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">WERR</th>
</tr>
<tr id="S3.T2.3.1.2.2" class="ltx_tr">
<th id="S3.T2.3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Baseline</th>
<th id="S3.T2.3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">11.3</th>
<th id="S3.T2.3.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">16.3</th>
<th id="S3.T2.3.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">11.6</th>
<th id="S3.T2.3.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">15.6</th>
<th id="S3.T2.3.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">13.6</th>
<th id="S3.T2.3.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.3.1.3.1" class="ltx_tr">
<td id="S3.T2.3.1.3.1.1" class="ltx_td ltx_align_left ltx_border_t">PM</td>
<td id="S3.T2.3.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">8.9</td>
<td id="S3.T2.3.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">13.9</td>
<td id="S3.T2.3.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">9.1</td>
<td id="S3.T2.3.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">13.6</td>
<td id="S3.T2.3.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">11.4</td>
<td id="S3.T2.3.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">21.8</td>
</tr>
<tr id="S3.T2.3.1.4.2" class="ltx_tr">
<td id="S3.T2.3.1.4.2.1" class="ltx_td ltx_align_left">HO</td>
<td id="S3.T2.3.1.4.2.2" class="ltx_td ltx_align_center">8.3</td>
<td id="S3.T2.3.1.4.2.3" class="ltx_td ltx_align_center">13.1</td>
<td id="S3.T2.3.1.4.2.4" class="ltx_td ltx_align_center">8.5</td>
<td id="S3.T2.3.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">12.7</td>
<td id="S3.T2.3.1.4.2.6" class="ltx_td ltx_align_center">10.6</td>
<td id="S3.T2.3.1.4.2.7" class="ltx_td ltx_align_center">29.7</td>
</tr>
<tr id="S3.T2.3.1.5.3" class="ltx_tr">
<td id="S3.T2.3.1.5.3.1" class="ltx_td ltx_align_left">SP</td>
<td id="S3.T2.3.1.5.3.2" class="ltx_td ltx_align_center">7.8</td>
<td id="S3.T2.3.1.5.3.3" class="ltx_td ltx_align_center">12.5</td>
<td id="S3.T2.3.1.5.3.4" class="ltx_td ltx_align_center">8.1</td>
<td id="S3.T2.3.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r">12.1</td>
<td id="S3.T2.3.1.5.3.6" class="ltx_td ltx_align_center">10.1</td>
<td id="S3.T2.3.1.5.3.7" class="ltx_td ltx_align_center">34.7</td>
</tr>
<tr id="S3.T2.3.1.6.4" class="ltx_tr">
<td id="S3.T2.3.1.6.4.1" class="ltx_td ltx_align_left">ST</td>
<td id="S3.T2.3.1.6.4.2" class="ltx_td ltx_align_center">7.5</td>
<td id="S3.T2.3.1.6.4.3" class="ltx_td ltx_align_center">12.3</td>
<td id="S3.T2.3.1.6.4.4" class="ltx_td ltx_align_center">7.8</td>
<td id="S3.T2.3.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r">11.8</td>
<td id="S3.T2.3.1.6.4.6" class="ltx_td ltx_align_center">9.8</td>
<td id="S3.T2.3.1.6.4.7" class="ltx_td ltx_align_center">37.6</td>
</tr>
<tr id="S3.T2.3.1.7.5" class="ltx_tr">
<td id="S3.T2.3.1.7.5.1" class="ltx_td ltx_align_left ltx_border_t">ST (k=1)</td>
<td id="S3.T2.3.1.7.5.2" class="ltx_td ltx_align_center ltx_border_t">10.2</td>
<td id="S3.T2.3.1.7.5.3" class="ltx_td ltx_align_center ltx_border_t">15.3</td>
<td id="S3.T2.3.1.7.5.4" class="ltx_td ltx_align_center ltx_border_t">10.4</td>
<td id="S3.T2.3.1.7.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">14.6</td>
<td id="S3.T2.3.1.7.5.6" class="ltx_td ltx_align_center ltx_border_t">12.5</td>
<td id="S3.T2.3.1.7.5.7" class="ltx_td ltx_align_center ltx_border_t">10.9</td>
</tr>
<tr id="S3.T2.3.1.8.6" class="ltx_tr">
<td id="S3.T2.3.1.8.6.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Topline</td>
<td id="S3.T2.3.1.8.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2.1</td>
<td id="S3.T2.3.1.8.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">4.7</td>
<td id="S3.T2.3.1.8.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2.2</td>
<td id="S3.T2.3.1.8.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">4.8</td>
<td id="S3.T2.3.1.8.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">3.5</td>
<td id="S3.T2.3.1.8.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">100</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Librispeech results</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">First we conduct experiments of the Librispeech test sets, where we truncate the last second of audio from each utterance and speculate them with various systems.
This 1 second of audio contains an average of around 2 words/utterance (1.98-2.2 depending on the test set) which the systems must speculate.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3.3 Speculation systems ‣ 3 Experiments ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows SOWER—<math id="S3.SS4.p2.1.m1.2" class="ltx_Math" alttext="S(1,8)" display="inline"><semantics id="S3.SS4.p2.1.m1.2a"><mrow id="S3.SS4.p2.1.m1.2.3" xref="S3.SS4.p2.1.m1.2.3.cmml"><mi id="S3.SS4.p2.1.m1.2.3.2" xref="S3.SS4.p2.1.m1.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.2.3.1" xref="S3.SS4.p2.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.2.3.3.2" xref="S3.SS4.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.2.3.3.2.1" xref="S3.SS4.p2.1.m1.2.3.3.1.cmml">(</mo><mn id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.p2.1.m1.2.3.3.2.2" xref="S3.SS4.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS4.p2.1.m1.2.2" xref="S3.SS4.p2.1.m1.2.2.cmml">8</mn><mo stretchy="false" id="S3.SS4.p2.1.m1.2.3.3.2.3" xref="S3.SS4.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.2b"><apply id="S3.SS4.p2.1.m1.2.3.cmml" xref="S3.SS4.p2.1.m1.2.3"><times id="S3.SS4.p2.1.m1.2.3.1.cmml" xref="S3.SS4.p2.1.m1.2.3.1"></times><ci id="S3.SS4.p2.1.m1.2.3.2.cmml" xref="S3.SS4.p2.1.m1.2.3.2">𝑆</ci><interval closure="open" id="S3.SS4.p2.1.m1.2.3.3.1.cmml" xref="S3.SS4.p2.1.m1.2.3.3.2"><cn type="integer" id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">1</cn><cn type="integer" id="S3.SS4.p2.1.m1.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2">8</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.2c">S(1,8)</annotation></semantics></math>—on the Librispeech test sets. All the systems, including PM, yield SOWER below 100, i.e., on average, picking the best of top-8 speculated hypotheses is better than not speculating at all.
HO significantly outperforms PM, highlighting the positive impact of making the LM ASR-error-aware.
SP yields a further 6.7% relative improvement over HO.
Finetuning jointly with unpaired text (ST) leads to further improvements, indicating that the SP—and HO—loses some capacity as a language model while fitting the ASR training set (which is much smaller than the unpaired data), and this capacity can be somewhat recovered by joint training.
Finally, the table also shows that speculating only the next word is, as expected, easier than predicting the rest of the utterance—with ST-1w in particular averaging SOWER below 50% on single word prediction.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">On inspecting the transcriptions and listening to the corresponding audio, we found several cases where the prefix audio ends with the beginnings of a sound, usually a stop consonant, which the ASR does not transcribe.
Where the systems without audio prompt speculate semantically-appropriate completions, the ones with audio prompt speculate semantically-appropriate completions which also start with the correct phoneme.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.1" class="ltx_p">Table <a href="#S3.T2" title="Table 2 ‣ 3.3 Speculation systems ‣ 3 Experiments ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the Librispeech oracle WER computed over the entire utterances (not just the suffixes), and therefore show the impact of speculation on the whole WER.
The speculation methods are compared with two purely Conformer-Transducer systems: a baseline, where each utterance is truncated and no speculation is done, and a topline which sees the entire audio without truncation or need to speculate.
Overall, the oracle word error rates of the speculation methods follows the same trends as the SOWER, with the best speculation method (ST) recovering about 37.6% of the gap between the baseline and the topline.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.5" class="ltx_p">Table <a href="#S3.T2" title="Table 2 ‣ 3.3 Speculation systems ‣ 3 Experiments ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> also shows the oracle WER of the best system, ST, at <math id="S3.SS4.p5.1.m1.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="S3.SS4.p5.1.m1.1a"><mrow id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml"><mi id="S3.SS4.p5.1.m1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.2.cmml">k</mi><mo id="S3.SS4.p5.1.m1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1"><eq id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1"></eq><ci id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2">𝑘</ci><cn type="integer" id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">k=1</annotation></semantics></math>.
Unsurprisingly, the oracle WER (and SOWER although it is not shown) degrades as <math id="S3.SS4.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p5.2.m2.1a"><mi id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><ci id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">k</annotation></semantics></math> is decreased.
More interestingly, we see that even at <math id="S3.SS4.p5.3.m3.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="S3.SS4.p5.3.m3.1a"><mrow id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml"><mi id="S3.SS4.p5.3.m3.1.1.2" xref="S3.SS4.p5.3.m3.1.1.2.cmml">k</mi><mo id="S3.SS4.p5.3.m3.1.1.1" xref="S3.SS4.p5.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS4.p5.3.m3.1.1.3" xref="S3.SS4.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><apply id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1"><eq id="S3.SS4.p5.3.m3.1.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1.1"></eq><ci id="S3.SS4.p5.3.m3.1.1.2.cmml" xref="S3.SS4.p5.3.m3.1.1.2">𝑘</ci><cn type="integer" id="S3.SS4.p5.3.m3.1.1.3.cmml" xref="S3.SS4.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">k=1</annotation></semantics></math>, ST outperforms the baseline.
In other words, even one-shot speculation with ST is slightly better than no speculation at all.
In fact, we found that all the speculation systems improve upon the baseline with the exception of PM at <math id="S3.SS4.p5.4.m4.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="S3.SS4.p5.4.m4.1a"><mrow id="S3.SS4.p5.4.m4.1.1" xref="S3.SS4.p5.4.m4.1.1.cmml"><mi id="S3.SS4.p5.4.m4.1.1.2" xref="S3.SS4.p5.4.m4.1.1.2.cmml">k</mi><mo id="S3.SS4.p5.4.m4.1.1.1" xref="S3.SS4.p5.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS4.p5.4.m4.1.1.3" xref="S3.SS4.p5.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m4.1b"><apply id="S3.SS4.p5.4.m4.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1"><eq id="S3.SS4.p5.4.m4.1.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1"></eq><ci id="S3.SS4.p5.4.m4.1.1.2.cmml" xref="S3.SS4.p5.4.m4.1.1.2">𝑘</ci><cn type="integer" id="S3.SS4.p5.4.m4.1.1.3.cmml" xref="S3.SS4.p5.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.4.m4.1c">k=1</annotation></semantics></math> (which has SOWER <math id="S3.SS4.p5.5.m5.1" class="ltx_Math" alttext="&gt;100" display="inline"><semantics id="S3.SS4.p5.5.m5.1a"><mrow id="S3.SS4.p5.5.m5.1.1" xref="S3.SS4.p5.5.m5.1.1.cmml"><mi id="S3.SS4.p5.5.m5.1.1.2" xref="S3.SS4.p5.5.m5.1.1.2.cmml"></mi><mo id="S3.SS4.p5.5.m5.1.1.1" xref="S3.SS4.p5.5.m5.1.1.1.cmml">&gt;</mo><mn id="S3.SS4.p5.5.m5.1.1.3" xref="S3.SS4.p5.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.m5.1b"><apply id="S3.SS4.p5.5.m5.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1"><gt id="S3.SS4.p5.5.m5.1.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1.1"></gt><csymbol cd="latexml" id="S3.SS4.p5.5.m5.1.1.2.cmml" xref="S3.SS4.p5.5.m5.1.1.2">absent</csymbol><cn type="integer" id="S3.SS4.p5.5.m5.1.1.3.cmml" xref="S3.SS4.p5.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.5.m5.1c">&gt;100</annotation></semantics></math>).</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>SOWER on various test sets.</figcaption>
<div id="S3.T3.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:175.9pt;height:54.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-58.1pt,17.9pt) scale(0.602249993218316,0.602249993218316) ;">
<table id="S3.T3.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.2.2.2" class="ltx_tr">
<th id="S3.T3.2.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S3.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">ami</th>
<th id="S3.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">test-c</th>
<th id="S3.T3.2.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">test-o</th>
<th id="S3.T3.2.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">swbd</th>
<th id="S3.T3.2.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">ted</th>
<th id="S3.T3.2.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">tavg</th>
<th id="S3.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S3.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\Delta_{97.5}" display="inline"><semantics id="S3.T3.1.1.1.1.m1.1a"><msub id="S3.T3.1.1.1.1.m1.1.1" xref="S3.T3.1.1.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T3.1.1.1.1.m1.1.1.2" xref="S3.T3.1.1.1.1.m1.1.1.2.cmml">Δ</mi><mn id="S3.T3.1.1.1.1.m1.1.1.3" xref="S3.T3.1.1.1.1.m1.1.1.3.cmml">97.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.1.m1.1b"><apply id="S3.T3.1.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.1.1.1.1.m1.1.1.1.cmml" xref="S3.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T3.1.1.1.1.m1.1.1.2.cmml" xref="S3.T3.1.1.1.1.m1.1.1.2">Δ</ci><cn type="float" id="S3.T3.1.1.1.1.m1.1.1.3.cmml" xref="S3.T3.1.1.1.1.m1.1.1.3">97.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.1.m1.1c">\Delta_{97.5}</annotation></semantics></math></th>
<th id="S3.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S3.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="\Delta_{2.5}" display="inline"><semantics id="S3.T3.2.2.2.2.m1.1a"><msub id="S3.T3.2.2.2.2.m1.1.1" xref="S3.T3.2.2.2.2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T3.2.2.2.2.m1.1.1.2" xref="S3.T3.2.2.2.2.m1.1.1.2.cmml">Δ</mi><mn id="S3.T3.2.2.2.2.m1.1.1.3" xref="S3.T3.2.2.2.2.m1.1.1.3.cmml">2.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.2.m1.1b"><apply id="S3.T3.2.2.2.2.m1.1.1.cmml" xref="S3.T3.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.2.2.2.2.m1.1.1.1.cmml" xref="S3.T3.2.2.2.2.m1.1.1">subscript</csymbol><ci id="S3.T3.2.2.2.2.m1.1.1.2.cmml" xref="S3.T3.2.2.2.2.m1.1.1.2">Δ</ci><cn type="float" id="S3.T3.2.2.2.2.m1.1.1.3.cmml" xref="S3.T3.2.2.2.2.m1.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.2.m1.1c">\Delta_{2.5}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.2.2.3.1" class="ltx_tr">
<td id="S3.T3.2.2.3.1.1" class="ltx_td ltx_align_left ltx_border_t">PM</td>
<td id="S3.T3.2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">95.6</td>
<td id="S3.T3.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">80.0</td>
<td id="S3.T3.2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t">84.2</td>
<td id="S3.T3.2.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t">93.7</td>
<td id="S3.T3.2.2.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.8</td>
<td id="S3.T3.2.2.3.1.7" class="ltx_td ltx_align_center ltx_border_t">88.7</td>
<td id="S3.T3.2.2.3.1.8" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S3.T3.2.2.3.1.9" class="ltx_td ltx_align_center ltx_border_t">0</td>
</tr>
<tr id="S3.T3.2.2.4.2" class="ltx_tr">
<td id="S3.T3.2.2.4.2.1" class="ltx_td ltx_align_left">HO</td>
<td id="S3.T3.2.2.4.2.2" class="ltx_td ltx_align_center">88.6</td>
<td id="S3.T3.2.2.4.2.3" class="ltx_td ltx_align_center">80.2</td>
<td id="S3.T3.2.2.4.2.4" class="ltx_td ltx_align_center">84.1</td>
<td id="S3.T3.2.2.4.2.5" class="ltx_td ltx_align_center">89.8</td>
<td id="S3.T3.2.2.4.2.6" class="ltx_td ltx_align_center ltx_border_r">86.3</td>
<td id="S3.T3.2.2.4.2.7" class="ltx_td ltx_align_center">85.8</td>
<td id="S3.T3.2.2.4.2.8" class="ltx_td ltx_align_center">1.4</td>
<td id="S3.T3.2.2.4.2.9" class="ltx_td ltx_align_center">5.8</td>
</tr>
<tr id="S3.T3.2.2.5.3" class="ltx_tr">
<td id="S3.T3.2.2.5.3.1" class="ltx_td ltx_align_left">SP</td>
<td id="S3.T3.2.2.5.3.2" class="ltx_td ltx_align_center">79.2</td>
<td id="S3.T3.2.2.5.3.3" class="ltx_td ltx_align_center">69.7</td>
<td id="S3.T3.2.2.5.3.4" class="ltx_td ltx_align_center">73.7</td>
<td id="S3.T3.2.2.5.3.5" class="ltx_td ltx_align_center">82.3</td>
<td id="S3.T3.2.2.5.3.6" class="ltx_td ltx_align_center ltx_border_r">76.1</td>
<td id="S3.T3.2.2.5.3.7" class="ltx_td ltx_align_center">76.2</td>
<td id="S3.T3.2.2.5.3.8" class="ltx_td ltx_align_center">10.4</td>
<td id="S3.T3.2.2.5.3.9" class="ltx_td ltx_align_center">15.1</td>
</tr>
<tr id="S3.T3.2.2.6.4" class="ltx_tr">
<td id="S3.T3.2.2.6.4.1" class="ltx_td ltx_align_left ltx_border_bb">ST</td>
<td id="S3.T3.2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_bb">79.6</td>
<td id="S3.T3.2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_bb">67.0</td>
<td id="S3.T3.2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_bb">71.6</td>
<td id="S3.T3.2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_bb">83.2</td>
<td id="S3.T3.2.2.6.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">77.8</td>
<td id="S3.T3.2.2.6.4.7" class="ltx_td ltx_align_center ltx_border_bb">75.8</td>
<td id="S3.T3.2.2.6.4.8" class="ltx_td ltx_align_center ltx_border_bb">10.2</td>
<td id="S3.T3.2.2.6.4.9" class="ltx_td ltx_align_center ltx_border_bb">15.0</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Multi-domain results</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">In addition to Librispeech, we report results on the AMI, Switchboard and TED-LIUM test sets in order to test generalization of the proposed speculation methods across domains.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">Table <a href="#S3.T3" title="Table 3 ‣ 3.4 Librispeech results ‣ 3 Experiments ‣ Speculative Speech Recognition by Audio-Prefixed Low-Rank Adaptation of Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the SOWER across test sets.
Here we find that the improvements from HO compared to PM are more subdued.
In fact, for the Librispeech test sets, HO is slightly worse than PM.
The largest improvements are on AMI, which is not represented in the LM pretraining data, and thus benefits the most from finetuning on the Speechstew training set–which does contain AMI data.
SP outperforms HO by a larger margin across all datasets, underscoring the importance of conditioning the LM on audio.
Finally, we observe that ST does not outperform SP in terms of SOWER, except on Librispeech.
This is likely due to the fact that the Librispeech text is the most represented in the unpaired text used for joint training.</p>
</div>
<div id="S3.SS5.p3" class="ltx_para">
<p id="S3.SS5.p3.1" class="ltx_p">Qualitatively, we found that because the Speechstew data is an amalgamation of various datasets, some of which have transcripts with punctuation and extra tags like ``[laughter]", ``[noise]" etc., HO learns to frequently speculate these tags even for datasets like Librispeech which are normalized, and thus increases number of errors, while SP does so less frequently.
This explains some of the degradation of HO on Librispeech.
It also hints at another advantage of having audio conditioning, namely it triggers domain-specific behavior in the LM.


</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusions</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, we've tackled the problem of doing ASR before the getting the input by using an LM to speculate the missing parts.
We propose an approach to reducing the entropy in speculation by feeding a fixed-length audio prefix to the LM, and a mechanism for finetuning the LM in the presence ASR-errors.
This speculative model is able to correctly retrieve 35.7% of suffixes up to one second ahead of time—and 50.7% when predicting only the next word, showing its viability as a means of achieving negative latency in ASR.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Future work in this direction include finding other ways of reducing the suffix entropy such as incorporating user-specific language models (as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>) or biasing lists, retrieving from related documents <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> or simply using better LMs.
Furthermore, although we show that we can run ahead-of-audio, fully realizing the latency improvements would require using efficient LMs and LM inference schemes such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> especially for larger LMs.
Another interesting direction is to incorporate speculation directly into the ASR—the transducer objective, for instance, places no limits on input and output lengths.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. He <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Streaming end-to-end speech recognition for mobile devices,'' in <em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic">ICASSP 2019 - 2019 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2019, pp. 6381–6385.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
T. N. Sainath <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Two-Pass End-to-End Speech Recognition,'' in <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, 2019, pp. 2773–2777.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Q. Zhang, H. Lu, H. Sak, A. Tripathi, E. McDermott, S. Koo, and S. Kumar, ``Transformer transducer: A streamable speech recognition model with transformer encoders and rnn-t loss,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2020, pp. 7829–7833.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
G. Strimel, Y. Xie, B. J. King, M. Radfar, A. Rastrow, and A. Mouchtaris, ``Lookahead when it matters: Adaptive non-causal transformers for streaming neural transducers,'' in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2023, pp. 32 654–32 676.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
B. Li <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Towards Fast and Accurate Streaming End-To-End ASR,'' in <em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic">2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2020, pp. 6069–6073.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Yu, Chiu <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Fastemit: Low-latency streaming asr with sequence-level emission regularization,'' in <em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">ICASSP 2021-2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2021, pp. 6004–6008.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S.-Y. Chang, B. Li, D. Rybach, Y. He, W. Li, T. N. Sainath, and T. Strohman, ``Low latency speech recognition using end-to-end prefetching.'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2020, pp. 1962–1966.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B. Li <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``A Better and Faster End-to-End Model for Streaming ASR,'' in <em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">ICASSP 2021-2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2021, pp. 5634–5638.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Leviathan, M. Kalman, and Y. Matias, ``Fast inference from transformers via speculative decoding,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2023, pp. 19 274–19 286.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. Chen, S. Borgeaud, G. Irving, J.-B. Lespiau, L. Sifre, and J. Jumper, ``Accelerating large language model decoding with speculative sampling,'' <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.01318</em>, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
A. Schwarz, D. He, M. Van Segbroeck, M. Hethnawi, and A. Rastrow, ``Personalized Predictive ASR for Latency Reduction in Voice Assistants,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, 2023, pp. 745–749.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Graves, ``Sequence transduction with recurrent neural networks,'' <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1211.3711</em>, 2012.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
B. Lester, R. Al-Rfou, and N. Constant, ``The power of scale for parameter-efficient prompt tuning,'' in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>.   Punta Cana, Dominican Republic: Association for Computational Linguistics, Nov. 2021, pp. 3045–3059. [Online]. Available: <a target="_blank" href="https://aclanthology.org/2021.emnlp-main.243" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2021.emnlp-main.243</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen, ``LoRA: Low-rank adaptation of large language models,'' in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022. [Online]. Available: <a target="_blank" href="https://openreview.net/forum?id=nZeVKeeFYf9" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=nZeVKeeFYf9</a>

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Gulati, J. Qin, C.-C. Chiu, N. Parmar, Y. Zhang, J. Yu, W. Han, S. Wang, Z. Zhang, Y. Wu, and R. Pang, ``Conformer: Convolution-augmented Transformer for Speech Recognition,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 5036–5040.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Vaswani <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Attention is all you need,'' <em id="bib.bib16.2.2" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
V. I. Levenshtein <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Binary codes capable of correcting deletions, insertions, and reversals,'' in <em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic">Soviet physics doklady</em>, vol. 10, no. 8.   Soviet Union, 1966, pp. 707–710.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, ``Adam: A method for stochastic optimization,'' in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings</em>, Y. Bengio and Y. LeCun, Eds., 2015. [Online]. Available: <a target="_blank" href="http://arxiv.org/abs/1412.6980" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1412.6980</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
W. Chan, D. Park, C. Lee, Y. Zhang, Q. Le, and M. Norouzi, ``Speechstew: Simply mix all available speech recognition data to train one large neural network,'' in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. MLSLP</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
V. Panayotov, G. Chen, D. Povey, and S. Khudanpur, ``Librispeech: an asr corpus based on public domain audio books,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">2015 IEEE international conference on acoustics, speech and signal processing (ICASSP)</em>.   IEEE, 2015, pp. 5206–5210.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
J. J. Godfrey, E. C. Holliman, and J. McDaniel, ``SWITCHBOARD: telephone speech corpus for research and development,'' in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 1992 IEEE International Conference on Acoustics, Speech and Signal Processing - Volume 1</em>, ser. ICASSP'92.   USA: IEEE Computer Society, 1992, p. 517–520.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
A. Rousseau, P. Deléglise, and Y. Esteve, ``TED-LIUM: an Automatic Speech Recognition dedicated corpus.'' in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">LREC</em>, 2012, pp. 125–129.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
F. Hernandez, V. Nguyen, S. Ghannay, N. Tomashenko, and Y. Esteve, ``TED-LIUM 3: Twice as much data and corpus repartition for experiments on speaker adaptation,'' in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Speech and Computer: 20th International Conference, SPECOM 2018, Leipzig, Germany, September 18–22, 2018, Proceedings 20</em>.   Springer, 2018, pp. 198–208.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
D. B. Paul and J. M. Baker, ``The design for the Wall Street Journal-based CSR corpus,'' in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Speech and Natural Language: Proceedings of a Workshop Held at Harriman, New York, February 23-26, 1992</em>, 1992. [Online]. Available: <a target="_blank" href="https://aclanthology.org/H92-1073" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/H92-1073</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
W. Kraaij, T. Hain, M. Lincoln, and W. Post, ``The AMI meeting corpus,'' in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Methods and Techniques in Behavioral Research</em>, 2005.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Kudo and J. Richardson, ``SentencePiece: A simple and language independent subword tokenizer and detokenizer for neural text processing,'' in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, E. Blanco and W. Lu, Eds.   Brussels, Belgium: Association for Computational Linguistics, Nov. 2018, pp. 66–71. [Online]. Available: <a target="_blank" href="https://aclanthology.org/D18-2012" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/D18-2012</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
P. Wang, T. N. Sainath, and R. J. Weiss, ``Multitask Training with Text Data for End-to-End Speech Recognition,'' in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2021</em>, 2021, pp. 2566–2570.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
B. Yusuf, A. Gandhe, and A. Sokolov, ``USTED: Improving ASR with a Unified Speech and Text Encoder-Decoder,'' in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of ICASSP 2022 - 2022 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE Signal Processing Society, 2022, pp. 8297–8301.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
M. Bisani and H. Ney, ``Bootstrap estimates for confidence intervals in asr performance evaluation,'' in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">2004 IEEE International Conference on Acoustics, Speech, and Signal Processing</em>, vol. 1, 2004, pp. I–409.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Z. Liu and F. Peng, ``Statistical Testing on ASR Performance via Blockwise Bootstrap,'' in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 596–600.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
D. M. Chan, S. Ghosh, A. Rastrow, and B. Hoffmeister, ``Domain adaptation with external off-policy acoustic catalogs for scalable contextual end-to-end automated speech recognition,'' in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
B. Yusuf, A. Gourav, A. Gandhe, and I. Bulyko, ``On-the-Fly Text Retrieval for end-to-end ASR Adaptation,'' in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023-2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Wu, T. Munkhdalai, P. Rondon, G. Pundak, K. C. Sim, and C. Li, ``Dual-Mode NAM: Effective Top-K Context Injection for End-to-End ASR,'' in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, 2023, pp. 221–225.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.04640" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.04641" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.04641">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.04641" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.04642" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 13:52:11 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
