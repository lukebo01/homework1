<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.03461] A Density-Guided Temporal Attention Transformer for Indiscernible Object Counting in Underwater Videos</title><meta property="og:description" content="Dense object counting or crowd counting has come a long way thanks to the recent development in the vision community. However, indiscernible object counting, which aims to count the number of targets that are blended w…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Density-Guided Temporal Attention Transformer for Indiscernible Object Counting in Underwater Videos">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="A Density-Guided Temporal Attention Transformer for Indiscernible Object Counting in Underwater Videos">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.03461">

<!--Generated on Fri Apr  5 14:00:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">A Density-Guided Temporal Attention Transformer for Indiscernible Object Counting in Underwater Videos</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Dense object counting or crowd counting has come a long way thanks to the recent development in the vision community. However, indiscernible object counting, which aims to count the number of targets that are blended with respect to their surroundings, has been a challenge. Image-based object counting datasets have been the mainstream of the current publicly available datasets. Therefore, we propose a large-scale dataset called YoutubeFish-35, which contains a total of 35 sequences of high-definition videos with high frame-per-second and more than 150,000 annotated center points across a selected variety of scenes. For bench-marking purposes, we select three mainstream methods for dense object counting and carefully evaluate them on the newly collected dataset. We propose TransVidCount, a new strong baseline that combines density and regression branches along the temporal domain in a unified framework and can effectively tackle indiscernible object counting with state-of-the-art performance on YoutubeFish-35 dataset.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
Indiscernible Object Counting, Temporal Transformer, Underwater Vision</p>
</div>
<figure id="S0.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S0.T1.18.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Overview of the publicly available dense object (or crowd) counting datasets.</figcaption>
<table id="S0.T1.14" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S0.T1.14.15.1" class="ltx_tr">
<td id="S0.T1.14.15.1.1" class="ltx_td ltx_align_right"><span id="S0.T1.14.15.1.1.1" class="ltx_text" style="font-size:80%;">Datasets</span></td>
<td id="S0.T1.14.15.1.2" class="ltx_td ltx_align_center"><span id="S0.T1.14.15.1.2.1" class="ltx_text" style="font-size:80%;">Type</span></td>
<td id="S0.T1.14.15.1.3" class="ltx_td ltx_align_right"><span id="S0.T1.14.15.1.3.1" class="ltx_text" style="font-size:80%;">IOC</span></td>
<td id="S0.T1.14.15.1.4" class="ltx_td ltx_nopad_r ltx_align_right"><span id="S0.T1.14.15.1.4.1" class="ltx_text" style="font-size:80%;">Camera</span></td>
<td id="S0.T1.14.15.1.5" class="ltx_td"></td>
<td id="S0.T1.14.15.1.6" class="ltx_td"></td>
<td id="S0.T1.14.15.1.7" class="ltx_td"></td>
<td id="S0.T1.14.15.1.8" class="ltx_td"></td>
<td id="S0.T1.14.15.1.9" class="ltx_td"></td>
<td id="S0.T1.14.15.1.10" class="ltx_td"></td>
</tr>
<tr id="S0.T1.14.16.2" class="ltx_tr">
<td id="S0.T1.14.16.2.1" class="ltx_td ltx_align_right"><span id="S0.T1.14.16.2.1.1" class="ltx_text" style="font-size:80%;">View</span></td>
<td id="S0.T1.14.16.2.2" class="ltx_td ltx_align_center"><span id="S0.T1.14.16.2.2.1" class="ltx_text" style="font-size:80%;"># of Seq</span></td>
<td id="S0.T1.14.16.2.3" class="ltx_td ltx_nopad_r ltx_align_right"><span id="S0.T1.14.16.2.3.1" class="ltx_text" style="font-size:80%;">Average</span></td>
<td id="S0.T1.14.16.2.4" class="ltx_td"></td>
<td id="S0.T1.14.16.2.5" class="ltx_td"></td>
<td id="S0.T1.14.16.2.6" class="ltx_td"></td>
<td id="S0.T1.14.16.2.7" class="ltx_td"></td>
<td id="S0.T1.14.16.2.8" class="ltx_td"></td>
<td id="S0.T1.14.16.2.9" class="ltx_td"></td>
<td id="S0.T1.14.16.2.10" class="ltx_td"></td>
</tr>
<tr id="S0.T1.14.17.3" class="ltx_tr">
<td id="S0.T1.14.17.3.1" class="ltx_td ltx_align_right"><span id="S0.T1.14.17.3.1.1" class="ltx_text" style="font-size:80%;">Resolution</span></td>
<td id="S0.T1.14.17.3.2" class="ltx_td ltx_align_center"><span id="S0.T1.14.17.3.2.1" class="ltx_text" style="font-size:80%;"># of Image</span></td>
<td id="S0.T1.14.17.3.3" class="ltx_td"></td>
<td id="S0.T1.14.17.3.4" class="ltx_td"></td>
<td id="S0.T1.14.17.3.5" class="ltx_td"></td>
<td id="S0.T1.14.17.3.6" class="ltx_td"></td>
<td id="S0.T1.14.17.3.7" class="ltx_td"></td>
<td id="S0.T1.14.17.3.8" class="ltx_td"></td>
<td id="S0.T1.14.17.3.9" class="ltx_td"></td>
<td id="S0.T1.14.17.3.10" class="ltx_td"></td>
</tr>
<tr id="S0.T1.3.3" class="ltx_tr">
<td id="S0.T1.3.3.4" class="ltx_td"></td>
<td id="S0.T1.3.3.5" class="ltx_td"></td>
<td id="S0.T1.3.3.6" class="ltx_td"></td>
<td id="S0.T1.3.3.7" class="ltx_td"></td>
<td id="S0.T1.3.3.8" class="ltx_td"></td>
<td id="S0.T1.3.3.9" class="ltx_td"></td>
<td id="S0.T1.1.1.1" class="ltx_td ltx_align_center"><math id="S0.T1.1.1.1.m1.1" class="ltx_Math" alttext="&lt;50" display="inline"><semantics id="S0.T1.1.1.1.m1.1a"><mrow id="S0.T1.1.1.1.m1.1.1" xref="S0.T1.1.1.1.m1.1.1.cmml"><mi id="S0.T1.1.1.1.m1.1.1.2" xref="S0.T1.1.1.1.m1.1.1.2.cmml"></mi><mo mathsize="80%" id="S0.T1.1.1.1.m1.1.1.1" xref="S0.T1.1.1.1.m1.1.1.1.cmml">&lt;</mo><mn mathsize="80%" id="S0.T1.1.1.1.m1.1.1.3" xref="S0.T1.1.1.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S0.T1.1.1.1.m1.1b"><apply id="S0.T1.1.1.1.m1.1.1.cmml" xref="S0.T1.1.1.1.m1.1.1"><lt id="S0.T1.1.1.1.m1.1.1.1.cmml" xref="S0.T1.1.1.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S0.T1.1.1.1.m1.1.1.2.cmml" xref="S0.T1.1.1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S0.T1.1.1.1.m1.1.1.3.cmml" xref="S0.T1.1.1.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.1.1.1.m1.1c">&lt;50</annotation></semantics></math></td>
<td id="S0.T1.2.2.2" class="ltx_td ltx_align_center"><math id="S0.T1.2.2.2.m1.1" class="ltx_Math" alttext="51\sim 200" display="inline"><semantics id="S0.T1.2.2.2.m1.1a"><mrow id="S0.T1.2.2.2.m1.1.1" xref="S0.T1.2.2.2.m1.1.1.cmml"><mn mathsize="80%" id="S0.T1.2.2.2.m1.1.1.2" xref="S0.T1.2.2.2.m1.1.1.2.cmml">51</mn><mo mathsize="80%" id="S0.T1.2.2.2.m1.1.1.1" xref="S0.T1.2.2.2.m1.1.1.1.cmml">∼</mo><mn mathsize="80%" id="S0.T1.2.2.2.m1.1.1.3" xref="S0.T1.2.2.2.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S0.T1.2.2.2.m1.1b"><apply id="S0.T1.2.2.2.m1.1.1.cmml" xref="S0.T1.2.2.2.m1.1.1"><csymbol cd="latexml" id="S0.T1.2.2.2.m1.1.1.1.cmml" xref="S0.T1.2.2.2.m1.1.1.1">similar-to</csymbol><cn type="integer" id="S0.T1.2.2.2.m1.1.1.2.cmml" xref="S0.T1.2.2.2.m1.1.1.2">51</cn><cn type="integer" id="S0.T1.2.2.2.m1.1.1.3.cmml" xref="S0.T1.2.2.2.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.2.2.2.m1.1c">51\sim 200</annotation></semantics></math></td>
<td id="S0.T1.3.3.3" class="ltx_td ltx_align_left"><math id="S0.T1.3.3.3.m1.1" class="ltx_Math" alttext="&gt;200" display="inline"><semantics id="S0.T1.3.3.3.m1.1a"><mrow id="S0.T1.3.3.3.m1.1.1" xref="S0.T1.3.3.3.m1.1.1.cmml"><mi id="S0.T1.3.3.3.m1.1.1.2" xref="S0.T1.3.3.3.m1.1.1.2.cmml"></mi><mo mathsize="80%" id="S0.T1.3.3.3.m1.1.1.1" xref="S0.T1.3.3.3.m1.1.1.1.cmml">&gt;</mo><mn mathsize="80%" id="S0.T1.3.3.3.m1.1.1.3" xref="S0.T1.3.3.3.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S0.T1.3.3.3.m1.1b"><apply id="S0.T1.3.3.3.m1.1.1.cmml" xref="S0.T1.3.3.3.m1.1.1"><gt id="S0.T1.3.3.3.m1.1.1.1.cmml" xref="S0.T1.3.3.3.m1.1.1.1"></gt><csymbol cd="latexml" id="S0.T1.3.3.3.m1.1.1.2.cmml" xref="S0.T1.3.3.3.m1.1.1.2">absent</csymbol><cn type="integer" id="S0.T1.3.3.3.m1.1.1.3.cmml" xref="S0.T1.3.3.3.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.3.3.3.m1.1c">&gt;200</annotation></semantics></math></td>
<td id="S0.T1.3.3.10" class="ltx_td ltx_align_center"><span id="S0.T1.3.3.10.1" class="ltx_text" style="font-size:80%;">Total</span></td>
</tr>
<tr id="S0.T1.5.5" class="ltx_tr">
<td id="S0.T1.5.5.3" class="ltx_td ltx_align_right">
<span id="S0.T1.5.5.3.1" class="ltx_text" style="font-size:80%;">NC4K </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.5.5.3.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S0.T1.5.5.3.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.5.5.4" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.4.1" class="ltx_text" style="font-size:80%;">Image</span></td>
<td id="S0.T1.4.4.1" class="ltx_td ltx_align_right">
<span id="S0.T1.4.4.1.1" class="ltx_text" style="font-size:80%;"></span><svg id="S0.T1.4.4.1.pic1" class="ltx_picture" height="11.02" overflow="visible" version="1.1" width="15.75"><g transform="translate(0,11.02) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><path d="M 0 5.51 L 3.94 0 L 15.75 11.02 L 3.94 2.36 Z" style="stroke:none"></path></g></svg>
</td>
<td id="S0.T1.5.5.5" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.5.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.5.5.6" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.5.5.2" class="ltx_td ltx_align_left">
<span id="S0.T1.5.5.2.1" class="ltx_text" style="font-size:80%;">709</span><math id="S0.T1.5.5.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.5.5.2.m1.1a"><mo mathsize="80%" id="S0.T1.5.5.2.m1.1.1" xref="S0.T1.5.5.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.5.5.2.m1.1b"><times id="S0.T1.5.5.2.m1.1.1.cmml" xref="S0.T1.5.5.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.5.5.2.m1.1c">\times</annotation></semantics></math><span id="S0.T1.5.5.2.2" class="ltx_text" style="font-size:80%;">530</span>
</td>
<td id="S0.T1.5.5.7" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.7.1" class="ltx_text" style="font-size:80%;">4,121</span></td>
<td id="S0.T1.5.5.8" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.8.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.5.5.9" class="ltx_td ltx_align_left"><span id="S0.T1.5.5.9.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.5.5.10" class="ltx_td ltx_align_center"><span id="S0.T1.5.5.10.1" class="ltx_text" style="font-size:80%;">4,121</span></td>
</tr>
<tr id="S0.T1.7.7" class="ltx_tr">
<td id="S0.T1.7.7.3" class="ltx_td ltx_align_right">
<span id="S0.T1.7.7.3.1" class="ltx_text" style="font-size:80%;">COD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.7.7.3.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S0.T1.7.7.3.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.7.7.4" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.4.1" class="ltx_text" style="font-size:80%;">Image</span></td>
<td id="S0.T1.6.6.1" class="ltx_td ltx_align_right">
<span id="S0.T1.6.6.1.1" class="ltx_text" style="font-size:80%;"></span><svg id="S0.T1.6.6.1.pic1" class="ltx_picture" height="11.02" overflow="visible" version="1.1" width="15.75"><g transform="translate(0,11.02) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><path d="M 0 5.51 L 3.94 0 L 15.75 11.02 L 3.94 2.36 Z" style="stroke:none"></path></g></svg>
</td>
<td id="S0.T1.7.7.5" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.5.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.7.7.6" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.7.7.2" class="ltx_td ltx_align_left">
<span id="S0.T1.7.7.2.1" class="ltx_text" style="font-size:80%;">964</span><math id="S0.T1.7.7.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.7.7.2.m1.1a"><mo mathsize="80%" id="S0.T1.7.7.2.m1.1.1" xref="S0.T1.7.7.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.7.7.2.m1.1b"><times id="S0.T1.7.7.2.m1.1.1.cmml" xref="S0.T1.7.7.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.7.7.2.m1.1c">\times</annotation></semantics></math><span id="S0.T1.7.7.2.2" class="ltx_text" style="font-size:80%;">737</span>
</td>
<td id="S0.T1.7.7.7" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.7.1" class="ltx_text" style="font-size:80%;">5,066</span></td>
<td id="S0.T1.7.7.8" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.8.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.7.7.9" class="ltx_td ltx_align_left"><span id="S0.T1.7.7.9.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.7.7.10" class="ltx_td ltx_align_center"><span id="S0.T1.7.7.10.1" class="ltx_text" style="font-size:80%;">5,066</span></td>
</tr>
<tr id="S0.T1.9.9" class="ltx_tr">
<td id="S0.T1.9.9.3" class="ltx_td ltx_align_right">
<span id="S0.T1.9.9.3.1" class="ltx_text" style="font-size:80%;">IOCfish5K </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.9.9.3.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S0.T1.9.9.3.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.9.9.4" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.4.1" class="ltx_text" style="font-size:80%;">Image</span></td>
<td id="S0.T1.8.8.1" class="ltx_td ltx_align_right">
<span id="S0.T1.8.8.1.1" class="ltx_text" style="font-size:80%;"></span><svg id="S0.T1.8.8.1.pic1" class="ltx_picture" height="11.02" overflow="visible" version="1.1" width="15.75"><g transform="translate(0,11.02) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><path d="M 0 5.51 L 3.94 0 L 15.75 11.02 L 3.94 2.36 Z" style="stroke:none"></path></g></svg>
</td>
<td id="S0.T1.9.9.5" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.5.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.9.9.6" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.9.9.2" class="ltx_td ltx_align_left">
<span id="S0.T1.9.9.2.1" class="ltx_text" style="font-size:80%;">1920</span><math id="S0.T1.9.9.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.9.9.2.m1.1a"><mo mathsize="80%" id="S0.T1.9.9.2.m1.1.1" xref="S0.T1.9.9.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.9.9.2.m1.1b"><times id="S0.T1.9.9.2.m1.1.1.cmml" xref="S0.T1.9.9.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.9.9.2.m1.1c">\times</annotation></semantics></math><span id="S0.T1.9.9.2.2" class="ltx_text" style="font-size:80%;">1080</span>
</td>
<td id="S0.T1.9.9.7" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.7.1" class="ltx_text" style="font-size:80%;">2,663</span></td>
<td id="S0.T1.9.9.8" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.8.1" class="ltx_text" style="font-size:80%;">1,957</span></td>
<td id="S0.T1.9.9.9" class="ltx_td ltx_align_left"><span id="S0.T1.9.9.9.1" class="ltx_text" style="font-size:80%;">1,017</span></td>
<td id="S0.T1.9.9.10" class="ltx_td ltx_align_center"><span id="S0.T1.9.9.10.1" class="ltx_text" style="font-size:80%;">5,637</span></td>
</tr>
<tr id="S0.T1.10.10" class="ltx_tr">
<td id="S0.T1.10.10.2" class="ltx_td ltx_align_right">
<span id="S0.T1.10.10.2.1" class="ltx_text" style="font-size:80%;">UCSD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.10.10.2.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S0.T1.10.10.2.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.10.10.3" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.3.1" class="ltx_text" style="font-size:80%;">Video</span></td>
<td id="S0.T1.10.10.4" class="ltx_td ltx_align_right"><span id="S0.T1.10.10.4.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.10.10.5" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.5.1" class="ltx_text" style="font-size:80%;">Fixed</span></td>
<td id="S0.T1.10.10.6" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.6.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="S0.T1.10.10.1" class="ltx_td ltx_align_left">
<span id="S0.T1.10.10.1.1" class="ltx_text" style="font-size:80%;">238</span><math id="S0.T1.10.10.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.10.10.1.m1.1a"><mo mathsize="80%" id="S0.T1.10.10.1.m1.1.1" xref="S0.T1.10.10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.10.10.1.m1.1b"><times id="S0.T1.10.10.1.m1.1.1.cmml" xref="S0.T1.10.10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.10.10.1.m1.1c">\times</annotation></semantics></math><span id="S0.T1.10.10.1.2" class="ltx_text" style="font-size:80%;">158</span>
</td>
<td id="S0.T1.10.10.7" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.7.1" class="ltx_text" style="font-size:80%;">2,000</span></td>
<td id="S0.T1.10.10.8" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.8.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.10.10.9" class="ltx_td ltx_align_left"><span id="S0.T1.10.10.9.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.10.10.10" class="ltx_td ltx_align_center"><span id="S0.T1.10.10.10.1" class="ltx_text" style="font-size:80%;">2,000</span></td>
</tr>
<tr id="S0.T1.11.11" class="ltx_tr">
<td id="S0.T1.11.11.2" class="ltx_td ltx_align_right">
<span id="S0.T1.11.11.2.1" class="ltx_text" style="font-size:80%;">Mall </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.11.11.2.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S0.T1.11.11.2.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.11.11.3" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.3.1" class="ltx_text" style="font-size:80%;">Video</span></td>
<td id="S0.T1.11.11.4" class="ltx_td ltx_align_right"><span id="S0.T1.11.11.4.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.11.11.5" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.5.1" class="ltx_text" style="font-size:80%;">Fixed</span></td>
<td id="S0.T1.11.11.6" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.6.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="S0.T1.11.11.1" class="ltx_td ltx_align_left">
<span id="S0.T1.11.11.1.1" class="ltx_text" style="font-size:80%;">640</span><math id="S0.T1.11.11.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.11.11.1.m1.1a"><mo mathsize="80%" id="S0.T1.11.11.1.m1.1.1" xref="S0.T1.11.11.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.11.11.1.m1.1b"><times id="S0.T1.11.11.1.m1.1.1.cmml" xref="S0.T1.11.11.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.11.11.1.m1.1c">\times</annotation></semantics></math><span id="S0.T1.11.11.1.2" class="ltx_text" style="font-size:80%;">480</span>
</td>
<td id="S0.T1.11.11.7" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.7.1" class="ltx_text" style="font-size:80%;">2,000</span></td>
<td id="S0.T1.11.11.8" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.8.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.11.11.9" class="ltx_td ltx_align_left"><span id="S0.T1.11.11.9.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.11.11.10" class="ltx_td ltx_align_center"><span id="S0.T1.11.11.10.1" class="ltx_text" style="font-size:80%;">2,000</span></td>
</tr>
<tr id="S0.T1.12.12" class="ltx_tr">
<td id="S0.T1.12.12.2" class="ltx_td ltx_align_right">
<span id="S0.T1.12.12.2.1" class="ltx_text" style="font-size:80%;">CrowdFlow </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S0.T1.12.12.2.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib6" title="" class="ltx_ref">6</a><span id="S0.T1.12.12.2.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S0.T1.12.12.3" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.3.1" class="ltx_text" style="font-size:80%;">Video</span></td>
<td id="S0.T1.12.12.4" class="ltx_td ltx_align_right"><span id="S0.T1.12.12.4.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S0.T1.12.12.5" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.5.1" class="ltx_text" style="font-size:80%;">Moving</span></td>
<td id="S0.T1.12.12.6" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.6.1" class="ltx_text" style="font-size:80%;">5</span></td>
<td id="S0.T1.12.12.1" class="ltx_td ltx_align_left">
<span id="S0.T1.12.12.1.1" class="ltx_text" style="font-size:80%;">1280</span><math id="S0.T1.12.12.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.12.12.1.m1.1a"><mo mathsize="80%" id="S0.T1.12.12.1.m1.1.1" xref="S0.T1.12.12.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.12.12.1.m1.1b"><times id="S0.T1.12.12.1.m1.1.1.cmml" xref="S0.T1.12.12.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.12.12.1.m1.1c">\times</annotation></semantics></math><span id="S0.T1.12.12.1.2" class="ltx_text" style="font-size:80%;">720</span>
</td>
<td id="S0.T1.12.12.7" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.7.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.12.12.8" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.8.1" class="ltx_text" style="font-size:80%;">0</span></td>
<td id="S0.T1.12.12.9" class="ltx_td ltx_align_left"><span id="S0.T1.12.12.9.1" class="ltx_text" style="font-size:80%;">3,200</span></td>
<td id="S0.T1.12.12.10" class="ltx_td ltx_align_center"><span id="S0.T1.12.12.10.1" class="ltx_text" style="font-size:80%;">3,200</span></td>
</tr>
<tr id="S0.T1.14.14" class="ltx_tr">
<td id="S0.T1.14.14.3" class="ltx_td ltx_align_right"><span id="S0.T1.14.14.3.1" class="ltx_text" style="font-size:80%;">YoutubeFish-35 (Ours)</span></td>
<td id="S0.T1.14.14.4" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.4.1" class="ltx_text" style="font-size:80%;">Video</span></td>
<td id="S0.T1.13.13.1" class="ltx_td ltx_align_right"><svg id="S0.T1.13.13.1.m1.1.1.pic1" class="ltx_picture ltx_markedasmath" height="11.02" overflow="visible" version="1.1" width="15.75"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,11.02) matrix(1 0 0 -1 0 0)"><path d="M 0 5.51 L 3.94 0 L 15.75 11.02 L 3.94 2.36 Z" style="stroke:none"></path></g></svg></td>
<td id="S0.T1.14.14.5" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.5.1" class="ltx_text" style="font-size:80%;">Moving</span></td>
<td id="S0.T1.14.14.6" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.6.1" class="ltx_text" style="font-size:80%;">35</span></td>
<td id="S0.T1.14.14.2" class="ltx_td ltx_align_left">
<span id="S0.T1.14.14.2.1" class="ltx_text" style="font-size:80%;">1920</span><math id="S0.T1.14.14.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S0.T1.14.14.2.m1.1a"><mo mathsize="80%" id="S0.T1.14.14.2.m1.1.1" xref="S0.T1.14.14.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S0.T1.14.14.2.m1.1b"><times id="S0.T1.14.14.2.m1.1.1.cmml" xref="S0.T1.14.14.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S0.T1.14.14.2.m1.1c">\times</annotation></semantics></math><span id="S0.T1.14.14.2.2" class="ltx_text" style="font-size:80%;">1080</span>
</td>
<td id="S0.T1.14.14.7" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.7.1" class="ltx_text" style="font-size:80%;">4,235</span></td>
<td id="S0.T1.14.14.8" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.8.1" class="ltx_text" style="font-size:80%;">715</span></td>
<td id="S0.T1.14.14.9" class="ltx_td ltx_align_left"><span id="S0.T1.14.14.9.1" class="ltx_text" style="font-size:80%;">300</span></td>
<td id="S0.T1.14.14.10" class="ltx_td ltx_align_center"><span id="S0.T1.14.14.10.1" class="ltx_text" style="font-size:80%;">5,250</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Object counting is a critical task in computer vision, involving the counting of specific object instances in images or videos. While it may seem similar to object detection, object counting presents unique challenges beyond traditional detection methods. These challenges include dealing with overlapping instances, partial occlusion, varying object sizes, crowded scenes, density estimation, specialized validation metrics, and the need for tailored model design. There is a growing interest in dense object-related tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, particularly for crowded scenes, driven by various real-world applications such as event monitoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, surveillance security <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, commercial fishery management <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and wildlife preservation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. These applications all require precise counting of densely clustered objects in crowded environments.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recently, the focus on object counting within indiscernible or camouflaged scenes has intensified due to the unexplored nature of this field. Studies such as Camouflaged Object Detection (COD) or Camouflaged Segmentation (CIS), along with Indiscernible Object Counting (IOC) have delved into this area. As defined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, an indiscernible scene pertains to situations where foreground objects closely resemble the background in terms of patterns, colors, or textures.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>Visualizations of the dataset: YoutubeFish-35, the first video-based dataset for indiscernible object counting with point-level annotations.</figcaption><img src="/html/2403.03461/assets/figure/youtubefish35.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="239" alt="Refer to caption">
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Although several datasets with instance-level or point-level annotations can facilitate research in Indiscernible Object Counting (IOC), a dedicated video-based dataset capturing indiscernible or camouflaged scenes would be particularly beneficial to IOC research. Such a dataset could provide a better understanding of the challenges associated with object counting in these complex scenarios, enabling the development and evaluation of more robust IOC techniques.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To facilitate the research on Indiscernible Object Counting (IOC) and align it more closely with real-world applications, we introduced a video-based dataset, YoutubeFish-35. This dataset offers high-definition videos that capture scenes where objects are challenging to discern due to high blending into their surroundings. By providing a diverse range of scenarios and challenges, YoutubeFish-35 propels IOC research toward solutions that can effectively address the intricacies of object counting in complex and realistic scenarios.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Image-based Object Counting.</span> Image-based object counting has extensively employed CNNs and can be broadly categorized into three following directions. Detection-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> identify individual instances through object detection models and subsequently count instances. Regression-based methods directly predict object counts, utilizing handcrafted features or deep learning architectures to learn the mapping between image features and counts. The latest work like CLTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposed an end-to-end transformer-based network to count and localize the crowd. Density-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> focus on estimating object density, leading to the prediction of density maps for count integration. IOCFormer, on the other hand, adds the density branch on top of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> to achieve satisfying results on the IOC task. These directions represent diverse strategies to address the multifaceted challenge of crowd counting, each offering unique advantages and limitations.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Video-based Object Counting.</span> Video-based methods have fewer options than single-image techniques despite videos being more practical for real-world applications. ConvLSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> utilizes a bidirectional convolutional LSTM to capture temporal information. MOPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> employs a pyramid-like optical flow structure to decode motion information for count estimation while Locality-constrained Spatial Transformer (LSTN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> uses a spatial transformer network to predict the density map of consecutive frames. The Spatial-Temporal Graph Network (STGN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> efficiently and accurately counts crowds in videos by learning relations between pixels and patches in local spatial-temporal domains. Nevertheless, all the aforementioned and existing endeavors predominantly revolve around tallying human crowds within videos, which could potentially disregard the imperative task of counting objects within indiscernible scenes.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>The overview of our proposed method: TransVidCount.</figcaption><img src="/html/2403.03461/assets/figure/image.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="699" height="195" alt="Refer to caption">
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Dataset: YoutubeFish-35</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p"><span id="S3.p1.1.1" class="ltx_text ltx_font_bold">Data Collection.</span> We were inspired by the IOCfish5K dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and decided to create a new dataset. Our focus was on selecting high-definition free-view video sequences that contain temporal information. This allowed us to extend object counting to video-based methods, which are often more applicable to real-world situations. Our dataset follows the definition of indiscernible objects for underwater scenes. In the first data collection stage, we manually selected and downloaded 35 different high-quality videos from YouTube. The video sequences are mostly recorded between 25 to 30 fps in 1080 HD resolution.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">Annotation Pipeline.</span> We selected 35 individual 150-frame segments which we think have the most diverse environments (e.g., ocean, lake, river), lighting conditions (e.g., muddy, dark with light), and movement (e.g., sudden movement, swimming in school) as in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ A Density-Guided Temporal Attention Transformer for Indiscernible Object Counting in Underwater Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We followed the definition and annotation principle of IOCfish5K, in which the goal was to annotate each animal with a point at the center of its visible part using a modified version of the labelme software with custom features. This step takes around 250 human hours.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The overall architecture of our proposed method is an end-to-end network that takes consecutive frames as input, which is shown in Fig. 2. There are three main components of the network: (1) a shared CNN-based backbone, (2) a density map module, (3) an encoder-decoder transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Density Map Module</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.5" class="ltx_p">Employing pseudo density maps to semi-supervise predicted counts from generated density maps holds significant potential. This approach elegantly encodes the region’s crowd density and provides valuable localization information. A sequence of images will be fed into a shared backbone to generate image features <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="{F}_{I}^{t}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msubsup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">F</mi><mi id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">I</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝐹</ci><ci id="S4.SS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3">𝐼</ci></apply><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{F}_{I}^{t}</annotation></semantics></math> followed by a series of convolution blocks to generate intermediate density features <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="{F}^{t}_{dm}\in\mathbb{R}^{h^{\prime}\times w^{\prime}\times d^{\prime}}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msubsup id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.2.cmml">F</mi><mrow id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.3.2" xref="S4.SS1.p1.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.1.2.3.1" xref="S4.SS1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.1.1.2.3.3" xref="S4.SS1.p1.2.m2.1.1.2.3.3.cmml">m</mi></mrow><mi id="S4.SS1.p1.2.m2.1.1.2.2.3" xref="S4.SS1.p1.2.m2.1.1.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml"><msup id="S4.SS1.p1.2.m2.1.1.3.3.2" xref="S4.SS1.p1.2.m2.1.1.3.3.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.3.2.2" xref="S4.SS1.p1.2.m2.1.1.3.3.2.2.cmml">h</mi><mo id="S4.SS1.p1.2.m2.1.1.3.3.2.3" xref="S4.SS1.p1.2.m2.1.1.3.3.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.2.m2.1.1.3.3.1" xref="S4.SS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msup id="S4.SS1.p1.2.m2.1.1.3.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.3.3.2" xref="S4.SS1.p1.2.m2.1.1.3.3.3.2.cmml">w</mi><mo id="S4.SS1.p1.2.m2.1.1.3.3.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.3.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.2.m2.1.1.3.3.1a" xref="S4.SS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msup id="S4.SS1.p1.2.m2.1.1.3.3.4" xref="S4.SS1.p1.2.m2.1.1.3.3.4.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.3.4.2" xref="S4.SS1.p1.2.m2.1.1.3.3.4.2.cmml">d</mi><mo id="S4.SS1.p1.2.m2.1.1.3.3.4.3" xref="S4.SS1.p1.2.m2.1.1.3.3.4.3.cmml">′</mo></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><in id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></in><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.2">𝐹</ci><ci id="S4.SS1.p1.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3"><times id="S4.SS1.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.1"></times><ci id="S4.SS1.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.2">𝑑</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3"><times id="S4.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.1"></times><apply id="S4.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2.2">ℎ</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2.3">′</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.3">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.3.2">𝑤</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.3.3">′</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.3.4.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.3.4.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.4">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.3.4.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.4.2">𝑑</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.4.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.4.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">{F}^{t}_{dm}\in\mathbb{R}^{h^{\prime}\times w^{\prime}\times d^{\prime}}</annotation></semantics></math>. Then, the density map head with <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><times id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">1</cn><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">1\times 1</annotation></semantics></math> convolution layer will output the final density map prediction <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="D\in\mathbb{R}^{h\times w\times 1}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">D</mi><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.4.m4.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.3.3.1" xref="S4.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.4.m4.1.1.3.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.3.3.1a" xref="S4.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.p1.4.m4.1.1.3.3.4" xref="S4.SS1.p1.4.m4.1.1.3.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><in id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></in><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝐷</ci><apply id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3"><times id="S4.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.1"></times><ci id="S4.SS1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.2">ℎ</ci><ci id="S4.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3">𝑤</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.3.4.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">D\in\mathbb{R}^{h\times w\times 1}</annotation></semantics></math>. The Euclidean distance is used to measure the difference between the estimated density map <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="{D}^{i}_{dm}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msubsup id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">D</mi><mrow id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.1.1.3.1" xref="S4.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml">m</mi></mrow><mi id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝐷</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><times id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.1"></times><ci id="S4.SS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.2">𝑑</ci><ci id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">{D}^{i}_{dm}</annotation></semantics></math> and ground truth. The loss is defined as:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.1" class="ltx_Math" alttext="L_{dm}=\frac{1}{N}\sum^{N}_{i=1}||D^{i}_{dm}-D^{i}_{pdm}||^{2}_{2}" display="block"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><msub id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.3.2" xref="S4.E1.m1.1.1.3.2.cmml">L</mi><mrow id="S4.E1.m1.1.1.3.3" xref="S4.E1.m1.1.1.3.3.cmml"><mi id="S4.E1.m1.1.1.3.3.2" xref="S4.E1.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.3.3.1" xref="S4.E1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E1.m1.1.1.3.3.3" xref="S4.E1.m1.1.1.3.3.3.cmml">m</mi></mrow></msub><mo id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml"><mfrac id="S4.E1.m1.1.1.1.3" xref="S4.E1.m1.1.1.1.3.cmml"><mn id="S4.E1.m1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.E1.m1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.1.2" xref="S4.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><munderover id="S4.E1.m1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E1.m1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.1.1.1.1.2.3" xref="S4.E1.m1.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.3.2" xref="S4.E1.m1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E1.m1.1.1.1.1.2.3.1" xref="S4.E1.m1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E1.m1.1.1.1.1.2.3.3" xref="S4.E1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.1.1.1.1.2.2.3" xref="S4.E1.m1.1.1.1.1.2.2.3.cmml">N</mi></munderover><msubsup id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">D</mi><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi></mrow><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">D</mi><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">m</mi></mrow><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.3.cmml">2</mn><mn id="S4.E1.m1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><eq id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2"></eq><apply id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.3.2">𝐿</ci><apply id="S4.E1.m1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.3.3"><times id="S4.E1.m1.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.3.3.1"></times><ci id="S4.E1.m1.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.3.3.2">𝑑</ci><ci id="S4.E1.m1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.3.3.3">𝑚</ci></apply></apply><apply id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><times id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.2"></times><apply id="S4.E1.m1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.3"><divide id="S4.E1.m1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.3"></divide><cn type="integer" id="S4.E1.m1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.3.2">1</cn><ci id="S4.E1.m1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1"><apply id="S4.E1.m1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E1.m1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.2">superscript</csymbol><sum id="S4.E1.m1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2"></sum><ci id="S4.E1.m1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.3">𝑁</ci></apply><apply id="S4.E1.m1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.3"><eq id="S4.E1.m1.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.3.1"></eq><ci id="S4.E1.m1.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E1.m1.1.1.1.1.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1"><minus id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝐷</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝐷</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑑</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑚</ci></apply></apply></apply></apply><cn type="integer" id="S4.E1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S4.E1.m1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">L_{dm}=\frac{1}{N}\sum^{N}_{i=1}||D^{i}_{dm}-D^{i}_{pdm}||^{2}_{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Temporal Density-Guided Transformer</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Encoder.</span> Inspired by the density-enhanced transformer encoder (DETE) proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we further implement and integrate a temporal-attention mechanism to allow the encoder part to capture better the temporal information to boost the representations. Similarly, the encoder is made up of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">L</annotation></semantics></math> layers of Multi-head Self-Attention (MSA) blocks, where:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.1" class="ltx_Math" alttext="F^{\prime}_{l-1}=MSA(LN(F_{l-1}+TA(F_{dm})))" display="block"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><msubsup id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.3.2.2" xref="S4.E2.m1.1.1.3.2.2.cmml">F</mi><mrow id="S4.E2.m1.1.1.3.3" xref="S4.E2.m1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.3.3.2" xref="S4.E2.m1.1.1.3.3.2.cmml">l</mi><mo id="S4.E2.m1.1.1.3.3.1" xref="S4.E2.m1.1.1.3.3.1.cmml">−</mo><mn id="S4.E2.m1.1.1.3.3.3" xref="S4.E2.m1.1.1.3.3.3.cmml">1</mn></mrow><mo id="S4.E2.m1.1.1.3.2.3" xref="S4.E2.m1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.E2.m1.1.1.2" xref="S4.E2.m1.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.1.1.1.4" xref="S4.E2.m1.1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.2a" xref="S4.E2.m1.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.1.1.1.5" xref="S4.E2.m1.1.1.1.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.2b" xref="S4.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.2a" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><eq id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.2"></eq><apply id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.3">subscript</csymbol><apply id="S4.E2.m1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.3.2.1.cmml" xref="S4.E2.m1.1.1.3">superscript</csymbol><ci id="S4.E2.m1.1.1.3.2.2.cmml" xref="S4.E2.m1.1.1.3.2.2">𝐹</ci><ci id="S4.E2.m1.1.1.3.2.3.cmml" xref="S4.E2.m1.1.1.3.2.3">′</ci></apply><apply id="S4.E2.m1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.3.3"><minus id="S4.E2.m1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.3.3.1"></minus><ci id="S4.E2.m1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.E2.m1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><times id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3">𝑀</ci><ci id="S4.E2.m1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.4">𝑆</ci><ci id="S4.E2.m1.1.1.1.5.cmml" xref="S4.E2.m1.1.1.1.5">𝐴</ci><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3">𝐿</ci><ci id="S4.E2.m1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4">𝑁</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1"><plus id="S4.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.2"></plus><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.2">𝐹</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.4">𝐴</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">F^{\prime}_{l-1}=MSA(LN(F_{l-1}+TA(F_{dm})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="F_{l}=F^{\prime}_{l-1}+FC\big{(}LN(F^{\prime}_{l})\big{)}" display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><msub id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml">F</mi><mi id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml">l</mi></msub><mo id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.3.2.2" xref="S4.E3.m1.1.1.1.3.2.2.cmml">F</mi><mrow id="S4.E3.m1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E3.m1.1.1.1.3.3.1" xref="S4.E3.m1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E3.m1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.3.3.3.cmml">1</mn></mrow><mo id="S4.E3.m1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.2a" xref="S4.E3.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.2a" xref="S4.E3.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"></eq><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2">𝐹</ci><ci id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3">𝑙</ci></apply><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><plus id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></plus><apply id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.3.2.2">𝐹</ci><ci id="S4.E3.m1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.3.2.3">′</ci></apply><apply id="S4.E3.m1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3"><minus id="S4.E3.m1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.3.3.1"></minus><ci id="S4.E3.m1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.E3.m1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3">𝐹</ci><ci id="S4.E3.m1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.4">𝐶</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">F_{l}=F^{\prime}_{l-1}+FC\big{(}LN(F^{\prime}_{l})\big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.6" class="ltx_p">as <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="LN(\cdot)" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><mi id="S4.SS2.p3.1.m1.1.2.2" xref="S4.SS2.p3.1.m1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.1.2.1" xref="S4.SS2.p3.1.m1.1.2.1.cmml">​</mo><mi id="S4.SS2.p3.1.m1.1.2.3" xref="S4.SS2.p3.1.m1.1.2.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.1.2.1a" xref="S4.SS2.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p3.1.m1.1.2.4.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.1.2.4.2.1" xref="S4.SS2.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p3.1.m1.1.2.4.2.2" xref="S4.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.2"><times id="S4.SS2.p3.1.m1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.2.1"></times><ci id="S4.SS2.p3.1.m1.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.2.2">𝐿</ci><ci id="S4.SS2.p3.1.m1.1.2.3.cmml" xref="S4.SS2.p3.1.m1.1.2.3">𝑁</ci><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">LN(\cdot)</annotation></semantics></math> stands for layer normalization, <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="TA(\cdot)" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.2.1" xref="S4.SS2.p3.2.m2.1.2.1.cmml">​</mo><mi id="S4.SS2.p3.2.m2.1.2.3" xref="S4.SS2.p3.2.m2.1.2.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.2.1a" xref="S4.SS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p3.2.m2.1.2.4.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.4.2.1" xref="S4.SS2.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.4.2.2" xref="S4.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.2.cmml" xref="S4.SS2.p3.2.m2.1.2"><times id="S4.SS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.1"></times><ci id="S4.SS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2">𝑇</ci><ci id="S4.SS2.p3.2.m2.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3">𝐴</ci><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">TA(\cdot)</annotation></semantics></math> stands for temporal attention layer and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="FC(\cdot)" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.2.2" xref="S4.SS2.p3.3.m3.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.2.1" xref="S4.SS2.p3.3.m3.1.2.1.cmml">​</mo><mi id="S4.SS2.p3.3.m3.1.2.3" xref="S4.SS2.p3.3.m3.1.2.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.2.1a" xref="S4.SS2.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p3.3.m3.1.2.4.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.4.2.1" xref="S4.SS2.p3.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.4.2.2" xref="S4.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.2.cmml" xref="S4.SS2.p3.3.m3.1.2"><times id="S4.SS2.p3.3.m3.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.1"></times><ci id="S4.SS2.p3.3.m3.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2">𝐹</ci><ci id="S4.SS2.p3.3.m3.1.2.3.cmml" xref="S4.SS2.p3.3.m3.1.2.3">𝐶</ci><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">FC(\cdot)</annotation></semantics></math> stands for feed-forward layers while <math id="S4.SS2.p3.4.m4.4" class="ltx_Math" alttext="l=1,2,...,L" display="inline"><semantics id="S4.SS2.p3.4.m4.4a"><mrow id="S4.SS2.p3.4.m4.4.5" xref="S4.SS2.p3.4.m4.4.5.cmml"><mi id="S4.SS2.p3.4.m4.4.5.2" xref="S4.SS2.p3.4.m4.4.5.2.cmml">l</mi><mo id="S4.SS2.p3.4.m4.4.5.1" xref="S4.SS2.p3.4.m4.4.5.1.cmml">=</mo><mrow id="S4.SS2.p3.4.m4.4.5.3.2" xref="S4.SS2.p3.4.m4.4.5.3.1.cmml"><mn id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">1</mn><mo id="S4.SS2.p3.4.m4.4.5.3.2.1" xref="S4.SS2.p3.4.m4.4.5.3.1.cmml">,</mo><mn id="S4.SS2.p3.4.m4.2.2" xref="S4.SS2.p3.4.m4.2.2.cmml">2</mn><mo id="S4.SS2.p3.4.m4.4.5.3.2.2" xref="S4.SS2.p3.4.m4.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p3.4.m4.3.3" xref="S4.SS2.p3.4.m4.3.3.cmml">…</mi><mo id="S4.SS2.p3.4.m4.4.5.3.2.3" xref="S4.SS2.p3.4.m4.4.5.3.1.cmml">,</mo><mi id="S4.SS2.p3.4.m4.4.4" xref="S4.SS2.p3.4.m4.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.4b"><apply id="S4.SS2.p3.4.m4.4.5.cmml" xref="S4.SS2.p3.4.m4.4.5"><eq id="S4.SS2.p3.4.m4.4.5.1.cmml" xref="S4.SS2.p3.4.m4.4.5.1"></eq><ci id="S4.SS2.p3.4.m4.4.5.2.cmml" xref="S4.SS2.p3.4.m4.4.5.2">𝑙</ci><list id="S4.SS2.p3.4.m4.4.5.3.1.cmml" xref="S4.SS2.p3.4.m4.4.5.3.2"><cn type="integer" id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">1</cn><cn type="integer" id="S4.SS2.p3.4.m4.2.2.cmml" xref="S4.SS2.p3.4.m4.2.2">2</cn><ci id="S4.SS2.p3.4.m4.3.3.cmml" xref="S4.SS2.p3.4.m4.3.3">…</ci><ci id="S4.SS2.p3.4.m4.4.4.cmml" xref="S4.SS2.p3.4.m4.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.4c">l=1,2,...,L</annotation></semantics></math>. And the <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="F_{dm}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><msub id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">F</mi><mrow id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.1.1.3.1" xref="S4.SS2.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.5.m5.1.1.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝐹</ci><apply id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3"><times id="S4.SS2.p3.5.m5.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3.1"></times><ci id="S4.SS2.p3.5.m5.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.2">𝑑</ci><ci id="S4.SS2.p3.5.m5.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">F_{dm}</annotation></semantics></math> denotes the sets of density maps that are properly reshaped by a series of convolutional layers to match the dimension of input or output of each layer of the transformer encoder blocks. Each independent self-attention module consists of three inputs: query, key, and value, which are computed from <math id="S4.SS2.p3.6.m6.1" class="ltx_Math" alttext="F_{l-1}" display="inline"><semantics id="S4.SS2.p3.6.m6.1a"><msub id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">F</mi><mrow id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml"><mi id="S4.SS2.p3.6.m6.1.1.3.2" xref="S4.SS2.p3.6.m6.1.1.3.2.cmml">l</mi><mo id="S4.SS2.p3.6.m6.1.1.3.1" xref="S4.SS2.p3.6.m6.1.1.3.1.cmml">−</mo><mn id="S4.SS2.p3.6.m6.1.1.3.3" xref="S4.SS2.p3.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">𝐹</ci><apply id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3"><minus id="S4.SS2.p3.6.m6.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.1.1.3.1"></minus><ci id="S4.SS2.p3.6.m6.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.1.1.3.2">𝑙</ci><cn type="integer" id="S4.SS2.p3.6.m6.1.1.3.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">F_{l-1}</annotation></semantics></math>:</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.5" class="ltx_Math" alttext="SA(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{D}})V," display="block"><semantics id="S4.E4.m1.5a"><mrow id="S4.E4.m1.5.5.1" xref="S4.E4.m1.5.5.1.1.cmml"><mrow id="S4.E4.m1.5.5.1.1" xref="S4.E4.m1.5.5.1.1.cmml"><mrow id="S4.E4.m1.5.5.1.1.2" xref="S4.E4.m1.5.5.1.1.2.cmml"><mi id="S4.E4.m1.5.5.1.1.2.2" xref="S4.E4.m1.5.5.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.2.1" xref="S4.E4.m1.5.5.1.1.2.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.2.3" xref="S4.E4.m1.5.5.1.1.2.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.2.1a" xref="S4.E4.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S4.E4.m1.5.5.1.1.2.4.2" xref="S4.E4.m1.5.5.1.1.2.4.1.cmml"><mo stretchy="false" id="S4.E4.m1.5.5.1.1.2.4.2.1" xref="S4.E4.m1.5.5.1.1.2.4.1.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">Q</mi><mo id="S4.E4.m1.5.5.1.1.2.4.2.2" xref="S4.E4.m1.5.5.1.1.2.4.1.cmml">,</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">K</mi><mo id="S4.E4.m1.5.5.1.1.2.4.2.3" xref="S4.E4.m1.5.5.1.1.2.4.1.cmml">,</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">V</mi><mo stretchy="false" id="S4.E4.m1.5.5.1.1.2.4.2.4" xref="S4.E4.m1.5.5.1.1.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.1" xref="S4.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.5.5.1.1.3" xref="S4.E4.m1.5.5.1.1.3.cmml"><mi id="S4.E4.m1.5.5.1.1.3.2" xref="S4.E4.m1.5.5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.3" xref="S4.E4.m1.5.5.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1a" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.4" xref="S4.E4.m1.5.5.1.1.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1b" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.5" xref="S4.E4.m1.5.5.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1c" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.6" xref="S4.E4.m1.5.5.1.1.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1d" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.7" xref="S4.E4.m1.5.5.1.1.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1e" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.8" xref="S4.E4.m1.5.5.1.1.3.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1f" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.5.5.1.1.3.9.2" xref="S4.E4.m1.4.4.cmml"><mo stretchy="false" id="S4.E4.m1.5.5.1.1.3.9.2.1" xref="S4.E4.m1.4.4.cmml">(</mo><mfrac id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml"><mrow id="S4.E4.m1.4.4.2" xref="S4.E4.m1.4.4.2.cmml"><mi id="S4.E4.m1.4.4.2.2" xref="S4.E4.m1.4.4.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.2.1" xref="S4.E4.m1.4.4.2.1.cmml">​</mo><msup id="S4.E4.m1.4.4.2.3" xref="S4.E4.m1.4.4.2.3.cmml"><mi id="S4.E4.m1.4.4.2.3.2" xref="S4.E4.m1.4.4.2.3.2.cmml">K</mi><mi id="S4.E4.m1.4.4.2.3.3" xref="S4.E4.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S4.E4.m1.4.4.3" xref="S4.E4.m1.4.4.3.cmml"><mi id="S4.E4.m1.4.4.3.2" xref="S4.E4.m1.4.4.3.2.cmml">D</mi></msqrt></mfrac><mo stretchy="false" id="S4.E4.m1.5.5.1.1.3.9.2.2" xref="S4.E4.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.1.1.3.1g" xref="S4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S4.E4.m1.5.5.1.1.3.10" xref="S4.E4.m1.5.5.1.1.3.10.cmml">V</mi></mrow></mrow><mo id="S4.E4.m1.5.5.1.2" xref="S4.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.5b"><apply id="S4.E4.m1.5.5.1.1.cmml" xref="S4.E4.m1.5.5.1"><eq id="S4.E4.m1.5.5.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1"></eq><apply id="S4.E4.m1.5.5.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.2"><times id="S4.E4.m1.5.5.1.1.2.1.cmml" xref="S4.E4.m1.5.5.1.1.2.1"></times><ci id="S4.E4.m1.5.5.1.1.2.2.cmml" xref="S4.E4.m1.5.5.1.1.2.2">𝑆</ci><ci id="S4.E4.m1.5.5.1.1.2.3.cmml" xref="S4.E4.m1.5.5.1.1.2.3">𝐴</ci><vector id="S4.E4.m1.5.5.1.1.2.4.1.cmml" xref="S4.E4.m1.5.5.1.1.2.4.2"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝑄</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝐾</ci><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝑉</ci></vector></apply><apply id="S4.E4.m1.5.5.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.3"><times id="S4.E4.m1.5.5.1.1.3.1.cmml" xref="S4.E4.m1.5.5.1.1.3.1"></times><ci id="S4.E4.m1.5.5.1.1.3.2.cmml" xref="S4.E4.m1.5.5.1.1.3.2">𝑠</ci><ci id="S4.E4.m1.5.5.1.1.3.3.cmml" xref="S4.E4.m1.5.5.1.1.3.3">𝑜</ci><ci id="S4.E4.m1.5.5.1.1.3.4.cmml" xref="S4.E4.m1.5.5.1.1.3.4">𝑓</ci><ci id="S4.E4.m1.5.5.1.1.3.5.cmml" xref="S4.E4.m1.5.5.1.1.3.5">𝑡</ci><ci id="S4.E4.m1.5.5.1.1.3.6.cmml" xref="S4.E4.m1.5.5.1.1.3.6">𝑚</ci><ci id="S4.E4.m1.5.5.1.1.3.7.cmml" xref="S4.E4.m1.5.5.1.1.3.7">𝑎</ci><ci id="S4.E4.m1.5.5.1.1.3.8.cmml" xref="S4.E4.m1.5.5.1.1.3.8">𝑥</ci><apply id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.5.5.1.1.3.9.2"><divide id="S4.E4.m1.4.4.1.cmml" xref="S4.E4.m1.5.5.1.1.3.9.2"></divide><apply id="S4.E4.m1.4.4.2.cmml" xref="S4.E4.m1.4.4.2"><times id="S4.E4.m1.4.4.2.1.cmml" xref="S4.E4.m1.4.4.2.1"></times><ci id="S4.E4.m1.4.4.2.2.cmml" xref="S4.E4.m1.4.4.2.2">𝑄</ci><apply id="S4.E4.m1.4.4.2.3.cmml" xref="S4.E4.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.2.3.1.cmml" xref="S4.E4.m1.4.4.2.3">superscript</csymbol><ci id="S4.E4.m1.4.4.2.3.2.cmml" xref="S4.E4.m1.4.4.2.3.2">𝐾</ci><ci id="S4.E4.m1.4.4.2.3.3.cmml" xref="S4.E4.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S4.E4.m1.4.4.3.cmml" xref="S4.E4.m1.4.4.3"><root id="S4.E4.m1.4.4.3a.cmml" xref="S4.E4.m1.4.4.3"></root><ci id="S4.E4.m1.4.4.3.2.cmml" xref="S4.E4.m1.4.4.3.2">𝐷</ci></apply></apply><ci id="S4.E4.m1.5.5.1.1.3.10.cmml" xref="S4.E4.m1.5.5.1.1.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.5c">SA(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{D}})V,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.4" class="ltx_p">as the standard implementation in most transformer frameworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, where <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">Q</annotation></semantics></math>, <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">K</annotation></semantics></math>, and <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">V</annotation></semantics></math> represents queries, keys and values. <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">D</annotation></semantics></math> stands for the dimension of features.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.2" class="ltx_p"><span id="S4.SS2.p5.2.1" class="ltx_text ltx_font_bold">Decoder.</span> The original implementation of the decoder of the regression branch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> follow CDETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as a trainable query <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">Q</annotation></semantics></math> was used as input for the decoder when cross-attention is performed between the queries and the input feature map, the temporal information of density maps are embedded to the queries <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">Q</annotation></semantics></math> to make point predictions.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p">The current method for training queries relies on examining the entire patch to locate each target. Therefore, we argue that by incorporating the density map information, the queries can be properly guided toward better understanding and interpretation when trying to localize and classify whether it is an object or not. The density-guided queries are built upon the conditional cross-attention:</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="Q_{d}=W_{Q}+F(conv(TA(F_{dm})))," display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml">Q</mi><mi id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml">d</mi></msub><mo id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S4.E5.m1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.3.3.cmml">Q</mi></msub><mo id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2a" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.5" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2b" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.6" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.6.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2c" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"></eq><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2">𝑄</ci><ci id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><plus id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></plus><apply id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.2">𝑊</ci><ci id="S4.E5.m1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3">𝑄</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3">𝐹</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">𝑐</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.5">𝑛</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.6">𝑣</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝐴</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">Q_{d}=W_{Q}+F(conv(TA(F_{dm}))),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p8" class="ltx_para ltx_noindent">
<p id="S4.SS2.p8.1" class="ltx_p">The decoder output will be sent to the regression head and classification head to generate coordinates along with confidence score predictions.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Loss Function</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Following the acquisition of one-to-one matching results and obtaining the generated density map, we proceed with the calculation of the loss for subsequent backpropagation. Our approach involves direct point predictions, with the resultant loss encompassing all three of the density map generation, point regression, and classification components.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.3" class="ltx_p">Finally, the localization loss <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="L_{loc}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">L</mi><mrow id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.3.1a" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.1.m1.1.1.3.4" xref="S4.SS3.p2.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝐿</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><times id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝑙</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑜</ci><ci id="S4.SS3.p2.1.m1.1.1.3.4.cmml" xref="S4.SS3.p2.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">L_{loc}</annotation></semantics></math> computes the <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">L</mi><mn id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">L_{1}</annotation></semantics></math> distance between predicted points and ground-truth coordinates while the <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="L_{cls}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">L</mi><mrow id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.3.2" xref="S4.SS3.p2.3.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.1.1.3.1" xref="S4.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.3.m3.1.1.3.3" xref="S4.SS3.p2.3.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.1.1.3.1a" xref="S4.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.3.m3.1.1.3.4" xref="S4.SS3.p2.3.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝐿</ci><apply id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3"><times id="S4.SS3.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.p2.3.m3.1.1.3.1"></times><ci id="S4.SS3.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.p2.3.m3.1.1.3.2">𝑐</ci><ci id="S4.SS3.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3">𝑙</ci><ci id="S4.SS3.p2.3.m3.1.1.3.4.cmml" xref="S4.SS3.p2.3.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">L_{cls}</annotation></semantics></math> is the focal loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> for target or background. The end-to-end loss can be written in the form:</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="L_{total}=\lambda_{reg}\cdot(L_{cls}+L_{loc})+\lambda_{dm}\cdot L_{dm}" display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><msub id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.3.2" xref="S4.E6.m1.1.1.3.2.cmml">L</mi><mrow id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.3.3.2" xref="S4.E6.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.3.3.1" xref="S4.E6.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.3.3.3" xref="S4.E6.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.3.3.1a" xref="S4.E6.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.3.3.4" xref="S4.E6.m1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.3.3.1b" xref="S4.E6.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.3.3.5" xref="S4.E6.m1.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.3.3.1c" xref="S4.E6.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.3.3.6" xref="S4.E6.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml">λ</mi><mrow id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.3.1a" xref="S4.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.3.3.4" xref="S4.E6.m1.1.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">⋅</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.2.3.4" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.3.3.4" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.4.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml"><msub id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.E6.m1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.3.2.3.cmml"><mi id="S4.E6.m1.1.1.1.3.2.3.2" xref="S4.E6.m1.1.1.1.3.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.3.2.3.1" xref="S4.E6.m1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.3.2.3.3" xref="S4.E6.m1.1.1.1.3.2.3.3.cmml">m</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.3.1.cmml">⋅</mo><msub id="S4.E6.m1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.3.3.2.cmml">L</mi><mrow id="S4.E6.m1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.3.3.3.cmml"><mi id="S4.E6.m1.1.1.1.3.3.3.2" xref="S4.E6.m1.1.1.1.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.3.3.3.1" xref="S4.E6.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.3.3.3.3" xref="S4.E6.m1.1.1.1.3.3.3.3.cmml">m</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><eq id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></eq><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3.2">𝐿</ci><apply id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3"><times id="S4.E6.m1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.3.3.1"></times><ci id="S4.E6.m1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.3.3.2">𝑡</ci><ci id="S4.E6.m1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.3.3.3">𝑜</ci><ci id="S4.E6.m1.1.1.3.3.4.cmml" xref="S4.E6.m1.1.1.3.3.4">𝑡</ci><ci id="S4.E6.m1.1.1.3.3.5.cmml" xref="S4.E6.m1.1.1.3.3.5">𝑎</ci><ci id="S4.E6.m1.1.1.3.3.6.cmml" xref="S4.E6.m1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><plus id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></plus><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><ci id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2">⋅</ci><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2">𝜆</ci><apply id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><times id="S4.E6.m1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.1"></times><ci id="S4.E6.m1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2">𝑟</ci><ci id="S4.E6.m1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S4.E6.m1.1.1.1.1.3.3.4.cmml" xref="S4.E6.m1.1.1.1.1.3.3.4">𝑔</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><plus id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.2">𝐿</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.2">𝑐</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.3">𝑙</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.2">𝐿</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.2">𝑙</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply><apply id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3"><ci id="S4.E6.m1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.3.1">⋅</ci><apply id="S4.E6.m1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.3.2.2">𝜆</ci><apply id="S4.E6.m1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.3.2.3"><times id="S4.E6.m1.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.1.1.1.3.2.3.1"></times><ci id="S4.E6.m1.1.1.1.3.2.3.2.cmml" xref="S4.E6.m1.1.1.1.3.2.3.2">𝑑</ci><ci id="S4.E6.m1.1.1.1.3.2.3.3.cmml" xref="S4.E6.m1.1.1.1.3.2.3.3">𝑚</ci></apply></apply><apply id="S4.E6.m1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.3.3.2">𝐿</ci><apply id="S4.E6.m1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3.3"><times id="S4.E6.m1.1.1.1.3.3.3.1.cmml" xref="S4.E6.m1.1.1.1.3.3.3.1"></times><ci id="S4.E6.m1.1.1.1.3.3.3.2.cmml" xref="S4.E6.m1.1.1.1.3.3.3.2">𝑑</ci><ci id="S4.E6.m1.1.1.1.3.3.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">L_{total}=\lambda_{reg}\cdot(L_{cls}+L_{loc})+\lambda_{dm}\cdot L_{dm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.2" class="ltx_p">where <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="\lambda_{reg}=1" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mrow id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><msub id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.cmml">λ</mi><mrow id="S4.SS3.p4.1.m1.1.1.2.3" xref="S4.SS3.p4.1.m1.1.1.2.3.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2.3.2" xref="S4.SS3.p4.1.m1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p4.1.m1.1.1.2.3.1" xref="S4.SS3.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p4.1.m1.1.1.2.3.3" xref="S4.SS3.p4.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p4.1.m1.1.1.2.3.1a" xref="S4.SS3.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p4.1.m1.1.1.2.3.4" xref="S4.SS3.p4.1.m1.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S4.SS3.p4.1.m1.1.1.1" xref="S4.SS3.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><eq id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1.1"></eq><apply id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2">𝜆</ci><apply id="S4.SS3.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3"><times id="S4.SS3.p4.1.m1.1.1.2.3.1.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3.1"></times><ci id="S4.SS3.p4.1.m1.1.1.2.3.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3.2">𝑟</ci><ci id="S4.SS3.p4.1.m1.1.1.2.3.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3.3">𝑒</ci><ci id="S4.SS3.p4.1.m1.1.1.2.3.4.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3.4">𝑔</ci></apply></apply><cn type="integer" id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\lambda_{reg}=1</annotation></semantics></math> and <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="\lambda_{dm}=0.25" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mrow id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><msub id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2.2" xref="S4.SS3.p4.2.m2.1.1.2.2.cmml">λ</mi><mrow id="S4.SS3.p4.2.m2.1.1.2.3" xref="S4.SS3.p4.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2.3.2" xref="S4.SS3.p4.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p4.2.m2.1.1.2.3.1" xref="S4.SS3.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p4.2.m2.1.1.2.3.3" xref="S4.SS3.p4.2.m2.1.1.2.3.3.cmml">m</mi></mrow></msub><mo id="S4.SS3.p4.2.m2.1.1.1" xref="S4.SS3.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><eq id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1.1"></eq><apply id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.2.1.cmml" xref="S4.SS3.p4.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2">𝜆</ci><apply id="S4.SS3.p4.2.m2.1.1.2.3.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3"><times id="S4.SS3.p4.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3.1"></times><ci id="S4.SS3.p4.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3.2">𝑑</ci><ci id="S4.SS3.p4.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3.3">𝑚</ci></apply></apply><cn type="float" id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">\lambda_{dm}=0.25</annotation></semantics></math>. The entire model is jointly trained, and during inference, we take the point predictions as the result.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Visualization of the count estimation of CLTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, IOCFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and TransVidCount. The first row contains the input images and the corresponding ground-truth counts, while the latter rows represent the predicted counts and their coordinates.</figcaption><img src="/html/2403.03461/assets/figure/Picture1.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="643" height="238" alt="Refer to caption">
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experiment Settings</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.3" class="ltx_p"><span id="S5.SS1.p1.3.1" class="ltx_text ltx_font_bold">Implementation Details.</span> There are a total of 25 sequences in training set, <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><cn type="integer" id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">3</annotation></semantics></math> sequences in validation set, and <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="7" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mn id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><cn type="integer" id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">7</annotation></semantics></math> sequences in testing set. We conduct our experiments using PyTorch and <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><cn type="integer" id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">4</annotation></semantics></math> Nvidia Tesla V100 for training. For a fair comparison, we adapt the official implementation of MAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, CLTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, and IOCFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and used similar hyper-parameters during training. All methods are trained for 750 epochs with the exact same learning rate setting. During the inference phase, we divide the images into patches of identical dimensions as those employed during the training process. We apply a threshold of 0.3 to eliminate predictions related to the background.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> To assess the performance of the proposed method, we calculate the Mean Absolute Error (MAE), Mean Square Error (MSE), and Mean Normalized Absolute Error (NAE) by comparing predicted counts with ground-truth counts across all images following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. No additional post-processing are being made to the predictions of all the compared methods.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Quantitative Results</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Results on YoutubeFish-35.</span> We compare our proposed method with some of the latest crowd counting and indiscernible object counting techniques, as showcased in the results of the testing split of our newly introduced dataset in Table 2. Our approach leverages temporal information and demonstrates its ability to provide more accurate counts in dynamic scenarios, where object densities change over time. Visualizations of the predicted counts and coordinates are presented in Fig. 3 as our TransVidCount can accurately locate some of the highly-occluded targets in comparison to other image-based methods. These enhanced queries improve our single-frame method by an 11% margin and video-based method by a 15% margin over the existing SOTA.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Ablation Experiment.</span> We extend our analysis to compare the various operations employed during the aggregation of density-guided queries, as detailed in Table 3. The outcomes of this comparative evaluation serve to affirm the efficacy of our approach utilizing density-guided queries in augmenting the features. This is accomplished by leveraging the information derived from the consecutive density maps, thus providing substantial validation for the utility of our proposed method in enhancing feature extraction and representation.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.7.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Comparison of the evaluation metrics (MAE, MSE, and NAE) on the YoutubeFish-35 testing split.</figcaption>
<table id="S5.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.3.3" class="ltx_tr">
<th id="S5.T2.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T2.3.3.4.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:90%;">MAE </span><math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S5.T2.2.2.2.1" class="ltx_text" style="font-size:90%;">MSE </span><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.3.3.3.1" class="ltx_text" style="font-size:90%;">NAE </span><math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><ci id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\downarrow</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T2.3.4.1" class="ltx_tr">
<th id="S5.T2.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T2.3.4.1.1.1" class="ltx_text" style="font-size:90%;">MAN (CVPR’22)</span></th>
<td id="S5.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.3.4.1.2.1" class="ltx_text" style="font-size:90%;">35.952</span></td>
<td id="S5.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.3.4.1.3.1" class="ltx_text" style="font-size:90%;">44.533</span></td>
<td id="S5.T2.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.4.1.4.1" class="ltx_text" style="font-size:90%;">1.056</span></td>
</tr>
<tr id="S5.T2.3.5.2" class="ltx_tr">
<th id="S5.T2.3.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S5.T2.3.5.2.1.1" class="ltx_text" style="font-size:90%;">CLTR (ECCV’22)</span></th>
<td id="S5.T2.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.3.5.2.2.1" class="ltx_text" style="font-size:90%;">21.068</span></td>
<td id="S5.T2.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.3.5.2.3.1" class="ltx_text" style="font-size:90%;">36.630</span></td>
<td id="S5.T2.3.5.2.4" class="ltx_td ltx_align_center"><span id="S5.T2.3.5.2.4.1" class="ltx_text" style="font-size:90%;">0.597</span></td>
</tr>
<tr id="S5.T2.3.6.3" class="ltx_tr">
<th id="S5.T2.3.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S5.T2.3.6.3.1.1" class="ltx_text" style="font-size:90%;">IOCFormer (CVPR’23)</span></th>
<td id="S5.T2.3.6.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.3.6.3.2.1" class="ltx_text" style="font-size:90%;">16.194</span></td>
<td id="S5.T2.3.6.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.3.6.3.3.1" class="ltx_text" style="font-size:90%;">22.005</span></td>
<td id="S5.T2.3.6.3.4" class="ltx_td ltx_align_center"><span id="S5.T2.3.6.3.4.1" class="ltx_text" style="font-size:90%;">0.493</span></td>
</tr>
<tr id="S5.T2.3.7.4" class="ltx_tr">
<th id="S5.T2.3.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T2.3.7.4.1.1" class="ltx_text" style="font-size:90%;">TransVidCount (frame=1)</span></th>
<td id="S5.T2.3.7.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.3.7.4.2.1" class="ltx_text" style="font-size:90%;">14.372</span></td>
<td id="S5.T2.3.7.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.3.7.4.3.1" class="ltx_text" style="font-size:90%;">19.194</span></td>
<td id="S5.T2.3.7.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.3.7.4.4.1" class="ltx_text" style="font-size:90%;">0.514</span></td>
</tr>
<tr id="S5.T2.3.8.5" class="ltx_tr">
<th id="S5.T2.3.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S5.T2.3.8.5.1.1" class="ltx_text" style="font-size:90%;">TransVidCount (frame=5)</span></th>
<td id="S5.T2.3.8.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T2.3.8.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13.714</span></td>
<td id="S5.T2.3.8.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T2.3.8.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">17.909</span></td>
<td id="S5.T2.3.8.5.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.3.8.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.394</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.7.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>Ablation study of the density-guided methods.</figcaption>
<table id="S5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.3.3" class="ltx_tr">
<th id="S5.T3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.3.4.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<th id="S5.T3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.3.3.5.1" class="ltx_text" style="font-size:90%;">Operation</span></th>
<th id="S5.T3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S5.T3.1.1.1.1" class="ltx_text" style="font-size:90%;">MAE </span><math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S5.T3.2.2.2.1" class="ltx_text" style="font-size:90%;">MSE </span><math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><ci id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<span id="S5.T3.3.3.3.1" class="ltx_text" style="font-size:90%;">NAE </span><math id="S5.T3.3.3.3.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T3.3.3.3.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.m1.1b"><ci id="S5.T3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.m1.1c">\downarrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.3.4.1" class="ltx_tr">
<th id="S5.T3.3.4.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="S5.T3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S5.T3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">16.194</span></td>
<td id="S5.T3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">22.005</span></td>
<td id="S5.T3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.4.1.5.1" class="ltx_text" style="font-size:90%;">0.493</span></td>
</tr>
<tr id="S5.T3.3.5.2" class="ltx_tr">
<th id="S5.T3.3.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S5.T3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">Baseline</span></th>
<td id="S5.T3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.5.2.2.1" class="ltx_text" style="font-size:90%;">Add.</span></td>
<td id="S5.T3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.5.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13.481</span></td>
<td id="S5.T3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">18.359</span></td>
<td id="S5.T3.3.5.2.5" class="ltx_td ltx_align_center"><span id="S5.T3.3.5.2.5.1" class="ltx_text" style="font-size:90%;">0.472</span></td>
</tr>
<tr id="S5.T3.3.6.3" class="ltx_tr">
<th id="S5.T3.3.6.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_r"></th>
<td id="S5.T3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">Concat.</span></td>
<td id="S5.T3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T3.3.6.3.3.1" class="ltx_text" style="font-size:90%;">13.714</span></td>
<td id="S5.T3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T3.3.6.3.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">17.909</span></td>
<td id="S5.T3.3.6.3.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T3.3.6.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.394</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.3" class="ltx_p"><span id="S5.SS2.p3.3.1" class="ltx_text ltx_font_bold">Limitations.</span> We want to further discuss some limitations of the IOC task and our framework. First, larger objects (or objects that are closer to the camera) often resulted in duplicated prediction due to a fixed cropping size being adapted in such object counting frameworks. This can either be addressed by resizing the image or equipping post-processing with detection results. We would also like to mention that the latency (<math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mn id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><cn type="integer" id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">5</annotation></semantics></math>-frames) is roughly 30<math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mo id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><csymbol cd="latexml" id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\%</annotation></semantics></math> higher than the baseline model (<math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mn id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><cn type="integer" id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">1</annotation></semantics></math>-frame), which might be some trade-off that we need to evaluate when deploying to real-world applications.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In conclusion, our research presents a new video-based dataset and a novel approach for counting indiscernible objects in underwater videos, addressing the challenge of counting obscured and hard-to-discern objects and providing a benchmark for future studies. TransVidCount, with its attention mechanisms and temporal modeling, outperforms traditional methods and other deep learning architectures, showcasing its effectiveness in improving count accuracies.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Yunqiu Lv, Jing Zhang, Yuchao Dai, Aixuan Li, Bowen Liu, Nick Barnes, and
Deng-Ping Fan,

</span>
<span class="ltx_bibblock">“Simultaneously localize, segment and rank the camouflaged
objects,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, 2021, pp. 11591–11601.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Deng-Ping Fan, Ge-Peng Ji, Ming-Ming Cheng, and Ling Shao,

</span>
<span class="ltx_bibblock">“Concealed object detection,”

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>,
vol. 44, no. 10, pp. 6024–6042, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Guolei Sun, Zhaochong An, Yun Liu, Ce Liu, Christos Sakaridis, Deng-Ping Fan,
and Luc Van Gool,

</span>
<span class="ltx_bibblock">“Indiscernible object counting in underwater scenes,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, 2023, pp. 13791–13801.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Antoni B Chan, Zhang-Sheng John Liang, and Nuno Vasconcelos,

</span>
<span class="ltx_bibblock">“Privacy preserving crowd monitoring: Counting people without people
models or tracking,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">2008 IEEE conference on computer vision and pattern
recognition</span>. IEEE, 2008, pp. 1–7.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Ke Chen, Chen Change Loy, Shaogang Gong, and Tony Xiang,

</span>
<span class="ltx_bibblock">“Feature mining for localised crowd counting.,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">2012 British Machine Vision Conference</span>, 2012, vol. 1, p. 3.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Gregory Schröder, Tobias Senst, Erik Bochinski, and Thomas Sikora,

</span>
<span class="ltx_bibblock">“Optical flow dataset and benchmark for visual crowd analysis,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">2018 15th IEEE International Conference on Advanced Video and
Signal Based Surveillance (AVSS)</span>. IEEE, 2018, pp. 1–6.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yanyan Fang, Biyun Zhan, Wandi Cai, Shenghua Gao, and Bo Hu,

</span>
<span class="ltx_bibblock">“Locality-constrained spatial transformer network for video crowd
counting,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">2019 IEEE international conference on multimedia and expo
(ICME)</span>. IEEE, 2019, pp. 814–819.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Song Zhang, Xinting Yang, Yizhong Wang, Zhenxi Zhao, Jintao Liu, Yang Liu,
Chuanheng Sun, and Chao Zhou,

</span>
<span class="ltx_bibblock">“Automatic fish population counting by machine vision and a hybrid
deep neural network model,”

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Animals</span>, vol. 10, no. 2, pp. 364, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Carlos Arteta, Victor Lempitsky, and Andrew Zisserman,

</span>
<span class="ltx_bibblock">“Counting in the wild,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Computer Vision–ECCV 2016: 14th European Conference,
Amsterdam, The Netherlands, October 11–14, 2016, Proceedings, Part VII 14</span>.
Springer, 2016, pp. 483–498.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Ibrahim Saygin Topkaya, Hakan Erdogan, and Fatih Porikli,

</span>
<span class="ltx_bibblock">“Counting people by clustering person detector outputs,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">2014 11th IEEE international conference on advanced video and
signal based surveillance (AVSS)</span>. IEEE, 2014, pp. 313–318.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Dingkang Liang, Wei Xu, and Xiang Bai,

</span>
<span class="ltx_bibblock">“An end-to-end transformer model for crowd localization,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>. Springer, 2022, pp.
38–54.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Hui Lin, Zhiheng Ma, Rongrong Ji, Yaowei Wang, and Xiaopeng Hong,

</span>
<span class="ltx_bibblock">“Boosting crowd counting via multifaceted attention,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, 2022, pp. 19628–19637.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Feng Xiong, Xingjian Shi, and Dit-Yan Yeung,

</span>
<span class="ltx_bibblock">“Spatiotemporal modeling for crowd counting in videos,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, 2017, pp. 5151–5159.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Mohammad Asiful Hossain, Kevin Cannons, Daesik Jang, Fabio Cuzzolin, and Zhan
Xu,

</span>
<span class="ltx_bibblock">“Video-based crowd counting using a multi-scale optical flow pyramid
network,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proceedings of the Asian Conference on Computer Vision</span>,
2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Yanyan Fang, Biyun Zhan, Wandi Cai, Shenghua Gao, and Bo Hu,

</span>
<span class="ltx_bibblock">“Locality-constrained spatial transformer network for video crowd
counting,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">2019 IEEE international conference on multimedia and expo
(ICME)</span>. IEEE, 2019, pp. 814–819.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Zhe Wu, Xinfeng Zhang, Geng Tian, Yaowei Wang, and Qingming Huang,

</span>
<span class="ltx_bibblock">“Spatial-temporal graph network for video crowd counting,”

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Circuits and Systems for Video Technology</span>,
vol. 33, no. 1, pp. 228–241, 2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko,

</span>
<span class="ltx_bibblock">“End-to-end object detection with transformers,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">European conference on computer vision</span>. Springer, 2020, pp.
213–229.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Depu Meng, Xiaokang Chen, Zejia Fan, Gang Zeng, Houqiang Li, Yuhui Yuan, Lei
Sun, and Jingdong Wang,

</span>
<span class="ltx_bibblock">“Conditional detr for fast training convergence,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, 2021, pp. 3651–3660.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár,

</span>
<span class="ltx_bibblock">“Focal loss for dense object detection,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, 2017, pp. 2980–2988.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.03460" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.03461" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.03461">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.03461" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.03462" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 14:00:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
