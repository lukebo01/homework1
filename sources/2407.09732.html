<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.09732] Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis</title><meta property="og:description" content="It is too early to conclude that Mamba is a better alternative to transformers for speech before comparing Mamba with transformers in terms of both performance and efficiency in multiple speech-related tasks. To reach …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.09732">

<!--Generated on Mon Aug  5 13:49:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">It is too early to conclude that Mamba is a better alternative to transformers for speech before comparing Mamba with transformers in terms of both performance and efficiency in multiple speech-related tasks. To reach this conclusion, we propose and evaluate three models for three tasks: Mamba-TasNet for speech separation, ConMamba for speech recognition, and VALL-M for speech synthesis. We compare them with transformers of similar sizes in performance, memory, and speed. Our Mamba or Mamba-transformer hybrid models show comparable or higher performance than their transformer counterparts: Sepformer, Conformer, and VALL-E. They are more efficient than transformers in memory and speed for speech longer than a threshold duration, inversely related to the resolution of a speech token. Mamba for separation is the most efficient, and Mamba for recognition is the least. Further, we show that Mamba is not more efficient than transformer for speech shorter than the threshold duration and performs worse in models that require joint modeling of text and speech, such as cross or masked attention of two inputs. Therefore, we argue that the superiority of Mamba or transformer depends on particular problems and models. Code available<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Mamba-TasNet: https://github.com/xi-j/Mamba-TasNet 
<br class="ltx_break">ConMamba: https://github.com/xi-j/Mamba-ASR
</span></span></span>.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
State space model, speech separation, automatic speech recognition, text-to-speech synthesis</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Speech and text are two closely related modalities, and both can be a long sequence of hundreds or thousands of tokens. Both the local and context information are necessary to understand either one modality alone or to translate between them. Therefore, a powerful and efficient sequence modeling mechanism, usually a recurrent neural network (RNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> or a transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, is commonly used in the literature to comprehend both local nuances and global context. In particular, transformer models have become the de facto choice for many popular speech tasks, including separation, recognition, and synthesis, due to the reliability and scalability of performance. However, efficiency-wise, transformer models suffer from quadratic complexity in token length, which is unfriendly for long speech and text sequences. A good tradeoff between performance and efficiency needs to be found for model deployment with memory and time constraints.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2407.09732/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="186" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>We propose three models for speech separation, recognition, and synthesis.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A recently proposed state space model, Mamba, appears to be a strong candidate for sequence modeling tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Mamba enjoys linear complexity in token length and performs on par with transformers. This performance is first demonstrated in text, image, and biomedical data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Several recent works have also applied Mamba to audio and speech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, despite the popularity of Mamba, most research focuses on a single task and emphasizes performance. To fully investigate if Mamba is a better alternative to transformers, it is essential to compare it across multiple tasks and evaluate its memory and speed efficiency as well.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To complete this puzzle, we make a thorough performance and efficiency comparison between Mamba and transformers for three speech and text modeling scenarios in this paper: speech-to-speech, speech-to-text, and text-to-speech. We study a representative task for each scenario: speech separation, automatic speech recognition (ASR), and text-to-speech synthesis (TTS). Respectively, we propose and evaluate Mamba-TasNet for separation, ConMamba for recognition, and VALL-M and VALL-ME for synthesis in rivals of state-of-the-art transformer models Sepformer, Conformer, and VALL-E. These models differ in both functionality and architecture, particularly in terms of the resolution of each speech token and, therefore, the number of tokens for a continuous speech. Based on our performance analysis and memory and speed benchmark for speech inputs or outputs of different durations, we make observations below:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Bidirectional Mamba performs similarly or better than self-attention in Mamba-TasNet and the ConMamba encoder than Sepformer and the Conformer encoder for separation and ASR.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Unidirectional Mamba performs slightly worse than masked or cross-attention to joint text and speech inputs in the ASR decoder and VALL-E’s autoregressive language model. A hybrid Mamba encoder and transformer decoder model performs similarly or better than transformer encoder-decoder models for ASR and TTS.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Mamba becomes significantly more efficient in memory and speed for speech longer than a threshold duration. The threshold depends on the resolution of a speech token. Mamba has a greater advantage in high-resolution tasks such as separation but a minor or no advantage in low-resolution tasks such as ASR.</p>
</div>
</li>
</ul>
<p id="S1.p3.2" class="ltx_p">We hope our observations can encourage consideration of the more suitable use cases of Mamba in speech and promote better and more efficient model designs.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Mamba has shown a transformer-level performance in numerous modalities that can represented as a sequence, including text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, and biomedical data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Audio or speech, either in waveform or spectrogram, is naturally a sequence. Most early works apply Mamba to a single audio or speech task:
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to speech enhancement, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to speech separation, and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> to audio detection and classification. Other works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> propose a self-supervised audio transformer trained with masked spectrogram modeling. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> are the two most comprehensive studies of applications of Mamba in speech at the time this paper is written. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> studies Mamba for speech enhancement and recognition. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> studies Mamba for speech recognition, synthesis, understanding, and summarization. Despite the wide range of tasks, they focus on performance and lack speed and memory comparison with respect to speech duration between Mamba and transformers. Therefore, a solid conclusion that Mamba is better than transformers for speech in all scenarios is yet to be made. This work does not search for a particular scenario where Mamba is better than transformers. Instead, we make a fair comparison between Mamba and transformer in multiple identical settings.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2407.09732/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="297" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>The architecture of unidirectional and bidirectional Mamba.</figcaption>
</figure>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2407.09732/assets/x3.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="473" height="280" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.2.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Mamba encoder, decoder, and ConMamba encoder layers. When used alone, the FeedForward module in the encoder and decoder is optional (none in Mamba-TasNet), and the CrossMamba module in the decoder is not needed.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We present our Mamba models in a bottom-up manner. We first introduce the shared building blocks of all models in Sec.<a href="#S3.SS1" title="3.1 Preliminary ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> and then move to particular model designs in Sec.<a href="#S3.SS2" title="3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminary</h3>

<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Unidirectional and Bidirectional Mamba</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.4" class="ltx_p">The core of Mamba is a linear selective state space model (SSM). In the equation below, <math id="S3.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\textbf{h}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><msub id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.1.m1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.1.1.2a.cmml">h</mtext><mi id="S3.SS1.SSS1.p1.1.m1.1.1.3" xref="S3.SS1.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">h</mtext></ci><ci id="S3.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\textbf{h}_{t}</annotation></semantics></math>, <math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\textbf{x}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><msub id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.2.m2.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.2a.cmml">x</mtext><mi id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">x</mtext></ci><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">\textbf{x}_{t}</annotation></semantics></math> and <math id="S3.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\textbf{y}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><msub id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2a.cmml">y</mtext><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">y</mtext></ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">\textbf{y}_{t}</annotation></semantics></math> are the state, input, and output at time <math id="S3.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mi id="S3.SS1.SSS1.p1.4.m4.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><ci id="S3.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">t</annotation></semantics></math>. <span id="S3.SS1.SSS1.p1.4.1" class="ltx_text ltx_font_bold">A</span>, <span id="S3.SS1.SSS1.p1.4.2" class="ltx_text ltx_font_bold">B</span>, and <span id="S3.SS1.SSS1.p1.4.3" class="ltx_text ltx_font_bold">C</span> are learnable parameters corresponding to the state transition matrix, input matrix, and output matrix.</p>
<table id="S7.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\displaystyle\textbf{h}_{t}=\textbf{A}\textbf{h}_{t-1}+\textbf{B}\textbf{x}_{t},\hskip 4.0pt\textbf{y}_{t}=\textbf{C}\textbf{h}_{t}" display="inline"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2a.cmml">h</mtext><mi id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.3.2.2c.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.2.2a" xref="S3.E1.m1.1.1.1.1.3.2.2c.cmml">A</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.2.2b" xref="S3.E1.m1.1.1.1.1.3.2.2c.cmml">h</mtext></mrow><mrow id="S3.E1.m1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2.3.2" xref="S3.E1.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.3.2.3.1" xref="S3.E1.m1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.3.3.2c.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.3.2a" xref="S3.E1.m1.1.1.1.1.3.3.2c.cmml">B</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.3.2b" xref="S3.E1.m1.1.1.1.1.3.3.2c.cmml">x</mtext></mrow><mi id="S3.E1.m1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo rspace="0.567em" id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml"><msub id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2a.cmml">y</mtext><mi id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.cmml">=</mo><msub id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml"><mrow id="S3.E1.m1.2.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.3.2c.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.3.2a" xref="S3.E1.m1.2.2.2.2.3.2c.cmml">C</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.3.2b" xref="S3.E1.m1.2.2.2.2.3.2c.cmml">h</mtext></mrow><mi id="S3.E1.m1.2.2.2.2.3.3" xref="S3.E1.m1.2.2.2.2.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.3a.cmml" xref="S3.E1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"></eq><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2">h</mtext></ci><ci id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><plus id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1"></plus><apply id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.2c.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2"><mrow id="S3.E1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">A</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.2.2b.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">h</mtext></mrow></ci><apply id="S3.E1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3"><minus id="S3.E1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.3.2c.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2"><mrow id="S3.E1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.3.2a.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2">B</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.3.3.2b.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2">x</mtext></mrow></ci><ci id="S3.E1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><eq id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1"></eq><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2a.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">y</mtext></ci><ci id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.3.2c.cmml" xref="S3.E1.m1.2.2.2.2.3.2"><mrow id="S3.E1.m1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.3.2a.cmml" xref="S3.E1.m1.2.2.2.2.3.2">C</mtext><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.3.2b.cmml" xref="S3.E1.m1.2.2.2.2.3.2">h</mtext></mrow></ci><ci id="S3.E1.m1.2.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\displaystyle\textbf{h}_{t}=\textbf{A}\textbf{h}_{t-1}+\textbf{B}\textbf{x}_{t},\hskip 4.0pt\textbf{y}_{t}=\textbf{C}\textbf{h}_{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.9" class="ltx_p">Thanks to its linearity, we can express the entire sequence <span id="S3.SS1.SSS1.p1.9.1" class="ltx_text ltx_font_bold">y</span> of length <math id="S3.SS1.SSS1.p1.5.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m1.1a"><mi id="S3.SS1.SSS1.p1.5.m1.1.1" xref="S3.SS1.SSS1.p1.5.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m1.1b"><ci id="S3.SS1.SSS1.p1.5.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m1.1c">L</annotation></semantics></math> as a convolution between <span id="S3.SS1.SSS1.p1.9.2" class="ltx_text ltx_font_bold">x</span> of the same length and a kernel <span id="S3.SS1.SSS1.p1.9.3" class="ltx_text ltx_font_bold">K</span>. Since <math id="S3.SS1.SSS1.p1.6.m2.1" class="ltx_Math" alttext="\textbf{A}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m2.1a"><msub id="S3.SS1.SSS1.p1.6.m2.1.1" xref="S3.SS1.SSS1.p1.6.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.6.m2.1.1.2" xref="S3.SS1.SSS1.p1.6.m2.1.1.2a.cmml">A</mtext><mi id="S3.SS1.SSS1.p1.6.m2.1.1.3" xref="S3.SS1.SSS1.p1.6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m2.1b"><apply id="S3.SS1.SSS1.p1.6.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m2.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.6.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1.2">A</mtext></ci><ci id="S3.SS1.SSS1.p1.6.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m2.1c">\textbf{A}_{t}</annotation></semantics></math>, <math id="S3.SS1.SSS1.p1.7.m3.1" class="ltx_Math" alttext="\textbf{B}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.7.m3.1a"><msub id="S3.SS1.SSS1.p1.7.m3.1.1" xref="S3.SS1.SSS1.p1.7.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.7.m3.1.1.2" xref="S3.SS1.SSS1.p1.7.m3.1.1.2a.cmml">B</mtext><mi id="S3.SS1.SSS1.p1.7.m3.1.1.3" xref="S3.SS1.SSS1.p1.7.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m3.1b"><apply id="S3.SS1.SSS1.p1.7.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.7.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.7.m3.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.7.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1.2">B</mtext></ci><ci id="S3.SS1.SSS1.p1.7.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m3.1c">\textbf{B}_{t}</annotation></semantics></math>, and <math id="S3.SS1.SSS1.p1.8.m4.1" class="ltx_Math" alttext="\textbf{C}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.8.m4.1a"><msub id="S3.SS1.SSS1.p1.8.m4.1.1" xref="S3.SS1.SSS1.p1.8.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.8.m4.1.1.2" xref="S3.SS1.SSS1.p1.8.m4.1.1.2a.cmml">C</mtext><mi id="S3.SS1.SSS1.p1.8.m4.1.1.3" xref="S3.SS1.SSS1.p1.8.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m4.1b"><apply id="S3.SS1.SSS1.p1.8.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.8.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.8.m4.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.8.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1.2">C</mtext></ci><ci id="S3.SS1.SSS1.p1.8.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m4.1c">\textbf{C}_{t}</annotation></semantics></math> are all dependent on input <math id="S3.SS1.SSS1.p1.9.m5.1" class="ltx_Math" alttext="\textbf{x}_{t}" display="inline"><semantics id="S3.SS1.SSS1.p1.9.m5.1a"><msub id="S3.SS1.SSS1.p1.9.m5.1.1" xref="S3.SS1.SSS1.p1.9.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.9.m5.1.1.2" xref="S3.SS1.SSS1.p1.9.m5.1.1.2a.cmml">x</mtext><mi id="S3.SS1.SSS1.p1.9.m5.1.1.3" xref="S3.SS1.SSS1.p1.9.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m5.1b"><apply id="S3.SS1.SSS1.p1.9.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.9.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.9.m5.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.SSS1.p1.9.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1.2">x</mtext></ci><ci id="S3.SS1.SSS1.p1.9.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m5.1c">\textbf{x}_{t}</annotation></semantics></math> (i.e. selective), Equation <a href="#S3.E2" title="In 3.1.1 Unidirectional and Bidirectional Mamba ‣ 3.1 Preliminary ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> cannot be computed directly but is computed by a parallel scan algorithm instead.</p>
<table id="S7.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\displaystyle\textbf{K}=(C\textbf{B},\textbf{A}\textbf{B},...,C\textbf{A}^{L-1}\textbf{B}),\hskip 4.0pt\textbf{y}=\textbf{x}\ast\textbf{K}" display="inline"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.3.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.4" xref="S3.E2.m1.3.3.1.1.4a.cmml">K</mtext><mo id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3a.cmml">B</mtext></mrow><mo id="S3.E2.m1.3.3.1.1.2.2.4" xref="S3.E2.m1.3.3.1.1.2.3.cmml">,</mo><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1c.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1a" xref="S3.E2.m1.1.1c.cmml">A</mtext><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1b" xref="S3.E2.m1.1.1c.cmml">B</mtext></mrow><mo id="S3.E2.m1.3.3.1.1.2.2.5" xref="S3.E2.m1.3.3.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">…</mi><mo id="S3.E2.m1.3.3.1.1.2.2.6" xref="S3.E2.m1.3.3.1.1.2.3.cmml">,</mo><mrow id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.2.2.1" xref="S3.E2.m1.3.3.1.1.2.2.2.1.cmml">​</mo><msup id="S3.E2.m1.3.3.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.2.2.3.2" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2a.cmml">A</mtext><mrow id="S3.E2.m1.3.3.1.1.2.2.2.3.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.3.3.2" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.2.cmml">L</mi><mo id="S3.E2.m1.3.3.1.1.2.2.2.3.3.1" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S3.E2.m1.3.3.1.1.2.2.2.3.3.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.2.2.1a" xref="S3.E2.m1.3.3.1.1.2.2.2.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.2.2.4" xref="S3.E2.m1.3.3.1.1.2.2.2.4a.cmml">B</mtext></mrow><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.2.7" xref="S3.E2.m1.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.567em" id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.3a.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.2.2a.cmml">y</mtext><mo id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.2.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.3.2" xref="S3.E2.m1.4.4.2.2.3.2a.cmml">x</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.4.4.2.2.3.1" xref="S3.E2.m1.4.4.2.2.3.1.cmml">∗</mo><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.3.3" xref="S3.E2.m1.4.4.2.2.3.3a.cmml">K</mtext></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3a.cmml" xref="S3.E2.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><eq id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"></eq><ci id="S3.E2.m1.3.3.1.1.4a.cmml" xref="S3.E2.m1.3.3.1.1.4"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.4">K</mtext></ci><vector id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.2">𝐶</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.3a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3">B</mtext></ci></apply><ci id="S3.E2.m1.1.1c.cmml" xref="S3.E2.m1.1.1"><mrow id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1">A</mtext><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1b.cmml" xref="S3.E2.m1.1.1">B</mtext></mrow></ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">…</ci><apply id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2"><times id="S3.E2.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.1"></times><ci id="S3.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2">𝐶</ci><apply id="S3.E2.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.2.3.2a.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2">A</mtext></ci><apply id="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3"><minus id="S3.E2.m1.3.3.1.1.2.2.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.1"></minus><ci id="S3.E2.m1.3.3.1.1.2.2.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.2">𝐿</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.2.2.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.1.1.2.2.2.4a.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.4"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.4">B</mtext></ci></apply></vector></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><eq id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1"></eq><ci id="S3.E2.m1.4.4.2.2.2a.cmml" xref="S3.E2.m1.4.4.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2">y</mtext></ci><apply id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3"><ci id="S3.E2.m1.4.4.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.1">∗</ci><ci id="S3.E2.m1.4.4.2.2.3.2a.cmml" xref="S3.E2.m1.4.4.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2">x</mtext></ci><ci id="S3.E2.m1.4.4.2.2.3.3a.cmml" xref="S3.E2.m1.4.4.2.2.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.4.4.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3">K</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\displaystyle\textbf{K}=(C\textbf{B},\textbf{A}\textbf{B},...,C\textbf{A}^{L-1}\textbf{B}),\hskip 4.0pt\textbf{y}=\textbf{x}\ast\textbf{K}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.10" class="ltx_p">A (unidirectional) Mamba is an SSM sandwiched by gated linear layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Mamba is non-linear but causal. For most speech-related tasks, such as speech separation and recognition, bidirectional modeling is prefered since it allows for the incorporation of both past and future information. Therefore, we borrow the bidirectional Mamba proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for these non-causal tasks. The architectures of both unidirectional and bidirectional Mamba are illustrated in Fig.<a href="#S2.F2" title="Figure 2 ‣ 2 Related Works ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. For bidirectional Mamba, two SSMs and causal convolutions run in parallel, one for the original sequence and the other one for the reversed sequence. The outputs of the SSMs are averaged to incorporate information in both directions.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Mamba Encoder and Decoder</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">Common add-ons to stabilize training and improve performance for attention, including feature normalization and residual connection, can also be applied to Mamba. Following the naming convention of transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we call a block with bidirectional Mamba, normalization, and residual connection a <span id="S3.SS1.SSS2.p1.1.1" class="ltx_text ltx_font_italic">Mamba encoder layer</span> and a block with unidirectional Mamba a <span id="S3.SS1.SSS2.p1.1.2" class="ltx_text ltx_font_italic">Mamba decoder layer</span>. We present these layers in Fig.<a href="#S2.F3" title="Figure 3 ‣ 2 Related Works ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, along with a <span id="S3.SS1.SSS2.p1.1.3" class="ltx_text ltx_font_italic">ConMamba encoder layer</span>, which we will elaborate on in the next section. Notice that we can optionally add a feedforward module after the Mamba module. This design has been justified in Mamba-based large language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. We follow this design to build codec language models for VALL-M and VALL-ME.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.7" class="ltx_p">Encoder-decoder models, a large school of transformers, have both encoder and decoder layers. Their features are merged together by cross-attention, with the encoder outputs as the keys (<math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mi id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><ci id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">k</annotation></semantics></math>) and values (<math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="v=k" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mrow id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.1.1.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml">v</mi><mo id="S3.SS1.SSS2.p2.2.m2.1.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml">=</mo><mi id="S3.SS1.SSS2.p2.2.m2.1.1.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><apply id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1"><eq id="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.1"></eq><ci id="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">v=k</annotation></semantics></math>) and the decoder features as the queries (<math id="S3.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><mi id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">q</annotation></semantics></math>). <math id="S3.SS1.SSS2.p2.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m4.1a"><mi id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.1b"><ci id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.1c">k</annotation></semantics></math> and <math id="S3.SS1.SSS2.p2.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><mi id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><ci id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">q</annotation></semantics></math> are often of different lengths or even modalities (e.g. speech and text). Unfortunately, there is no native analog of cross-attention in Mamba that can handle multiple inputs of variable lengths. To address this, we propose <span id="S3.SS1.SSS2.p2.7.1" class="ltx_text ltx_font_italic">CrossMamba</span>, a unidirectional Mamba on two or more inputs, as a plug-in replacement for cross-attention. We simply concatenate <math id="S3.SS1.SSS2.p2.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><mi id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><ci id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">k</annotation></semantics></math> and <math id="S3.SS1.SSS2.p2.7.m7.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.SSS2.p2.7.m7.1a"><mi id="S3.SS1.SSS2.p2.7.m7.1.1" xref="S3.SS1.SSS2.p2.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m7.1b"><ci id="S3.SS1.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m7.1c">q</annotation></semantics></math> together as the inputs and only keep the latter half of the outputs with the same length as the query:</p>
<table id="S7.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.5" class="ltx_math_unparsed" alttext="\displaystyle\textit{CrossMamba}(k,q)=\textit{UniMamba}(\textit{cat}(k,q))[-len(q):]" display="inline"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5b"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.5.6">CrossMamba</mtext><mrow id="S3.E3.m1.5.7"><mo stretchy="false" id="S3.E3.m1.5.7.1">(</mo><mi id="S3.E3.m1.1.1">k</mi><mo id="S3.E3.m1.5.7.2">,</mo><mi id="S3.E3.m1.2.2">q</mi><mo stretchy="false" id="S3.E3.m1.5.7.3">)</mo></mrow><mo id="S3.E3.m1.5.8">=</mo><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.5.9">UniMamba</mtext><mrow id="S3.E3.m1.5.10"><mo stretchy="false" id="S3.E3.m1.5.10.1">(</mo><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.5.10.2">cat</mtext><mrow id="S3.E3.m1.5.10.3"><mo stretchy="false" id="S3.E3.m1.5.10.3.1">(</mo><mi id="S3.E3.m1.3.3">k</mi><mo id="S3.E3.m1.5.10.3.2">,</mo><mi id="S3.E3.m1.4.4">q</mi><mo stretchy="false" id="S3.E3.m1.5.10.3.3">)</mo></mrow><mo stretchy="false" id="S3.E3.m1.5.10.4">)</mo></mrow><mrow id="S3.E3.m1.5.11"><mo stretchy="false" id="S3.E3.m1.5.11.1">[</mo><mo lspace="0em" id="S3.E3.m1.5.11.2">−</mo><mi id="S3.E3.m1.5.11.3">l</mi><mi id="S3.E3.m1.5.11.4">e</mi><mi id="S3.E3.m1.5.11.5">n</mi><mrow id="S3.E3.m1.5.11.6"><mo stretchy="false" id="S3.E3.m1.5.11.6.1">(</mo><mi id="S3.E3.m1.5.5">q</mi><mo rspace="0.278em" stretchy="false" id="S3.E3.m1.5.11.6.2">)</mo></mrow><mo rspace="0em" id="S3.E3.m1.5.11.7">:</mo><mo stretchy="false" id="S3.E3.m1.5.11.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\displaystyle\textit{CrossMamba}(k,q)=\textit{UniMamba}(\textit{cat}(k,q))[-len(q):]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p2.8" class="ltx_p">More general, more than two inputs <math id="S3.SS1.SSS2.p2.8.m1.5" class="ltx_Math" alttext="\{x\}_{n}=x_{1},x_{2},...,x_{n}" display="inline"><semantics id="S3.SS1.SSS2.p2.8.m1.5a"><mrow id="S3.SS1.SSS2.p2.8.m1.5.5" xref="S3.SS1.SSS2.p2.8.m1.5.5.cmml"><msub id="S3.SS1.SSS2.p2.8.m1.5.5.5" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.cmml"><mrow id="S3.SS1.SSS2.p2.8.m1.5.5.5.2.2" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.2.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.8.m1.5.5.5.2.2.1" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.2.1.cmml">{</mo><mi id="S3.SS1.SSS2.p2.8.m1.1.1" xref="S3.SS1.SSS2.p2.8.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.8.m1.5.5.5.2.2.2" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.2.1.cmml">}</mo></mrow><mi id="S3.SS1.SSS2.p2.8.m1.5.5.5.3" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.3.cmml">n</mi></msub><mo id="S3.SS1.SSS2.p2.8.m1.5.5.4" xref="S3.SS1.SSS2.p2.8.m1.5.5.4.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.8.m1.5.5.3.3" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.4.cmml"><msub id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.2" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.3" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.4" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.2" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.2.cmml">x</mi><mn id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.3" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.5" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.8.m1.2.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.cmml">…</mi><mo id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.6" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.cmml"><mi id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.2" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.3" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.8.m1.5b"><apply id="S3.SS1.SSS2.p2.8.m1.5.5.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5"><eq id="S3.SS1.SSS2.p2.8.m1.5.5.4.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.4"></eq><apply id="S3.SS1.SSS2.p2.8.m1.5.5.5.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.5.5.5.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.5">subscript</csymbol><set id="S3.SS1.SSS2.p2.8.m1.5.5.5.2.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.2.2"><ci id="S3.SS1.SSS2.p2.8.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.1.1">𝑥</ci></set><ci id="S3.SS1.SSS2.p2.8.m1.5.5.5.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.5.3">𝑛</ci></apply><list id="S3.SS1.SSS2.p2.8.m1.5.5.3.4.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3"><apply id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p2.8.m1.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2">…</ci><apply id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.5.5.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.8.m1.5c">\{x\}_{n}=x_{1},x_{2},...,x_{n}</annotation></semantics></math> can be processed in the same way:</p>
<table id="S7.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\textit{CrossMamba}(\{x\}_{n})=\textit{UniMamba}(\textit{cat}(\{x\}_{n}))[-len(x_{n}):]" display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2b"><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.2.3">CrossMamba</mtext><mrow id="S3.E4.m1.2.4"><mo stretchy="false" id="S3.E4.m1.2.4.1">(</mo><msub id="S3.E4.m1.2.4.2"><mrow id="S3.E4.m1.2.4.2.2"><mo stretchy="false" id="S3.E4.m1.2.4.2.2.1">{</mo><mi id="S3.E4.m1.1.1">x</mi><mo stretchy="false" id="S3.E4.m1.2.4.2.2.2">}</mo></mrow><mi id="S3.E4.m1.2.4.2.3">n</mi></msub><mo stretchy="false" id="S3.E4.m1.2.4.3">)</mo></mrow><mo id="S3.E4.m1.2.5">=</mo><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.2.6">UniMamba</mtext><mrow id="S3.E4.m1.2.7"><mo stretchy="false" id="S3.E4.m1.2.7.1">(</mo><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.2.7.2">cat</mtext><mrow id="S3.E4.m1.2.7.3"><mo stretchy="false" id="S3.E4.m1.2.7.3.1">(</mo><msub id="S3.E4.m1.2.7.3.2"><mrow id="S3.E4.m1.2.7.3.2.2"><mo stretchy="false" id="S3.E4.m1.2.7.3.2.2.1">{</mo><mi id="S3.E4.m1.2.2">x</mi><mo stretchy="false" id="S3.E4.m1.2.7.3.2.2.2">}</mo></mrow><mi id="S3.E4.m1.2.7.3.2.3">n</mi></msub><mo stretchy="false" id="S3.E4.m1.2.7.3.3">)</mo></mrow><mo stretchy="false" id="S3.E4.m1.2.7.4">)</mo></mrow><mrow id="S3.E4.m1.2.8"><mo stretchy="false" id="S3.E4.m1.2.8.1">[</mo><mo lspace="0em" id="S3.E4.m1.2.8.2">−</mo><mi id="S3.E4.m1.2.8.3">l</mi><mi id="S3.E4.m1.2.8.4">e</mi><mi id="S3.E4.m1.2.8.5">n</mi><mrow id="S3.E4.m1.2.8.6"><mo stretchy="false" id="S3.E4.m1.2.8.6.1">(</mo><msub id="S3.E4.m1.2.8.6.2"><mi id="S3.E4.m1.2.8.6.2.2">x</mi><mi id="S3.E4.m1.2.8.6.2.3">n</mi></msub><mo rspace="0.278em" stretchy="false" id="S3.E4.m1.2.8.6.3">)</mo></mrow><mo rspace="0em" id="S3.E4.m1.2.8.7">:</mo><mo stretchy="false" id="S3.E4.m1.2.8.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle\textit{CrossMamba}(\{x\}_{n})=\textit{UniMamba}(\textit{cat}(\{x\}_{n}))[-len(x_{n}):]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Models</h3>

<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Mamba-TasNet</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.2" class="ltx_p">Mamba-TasNet follows the design of Conv-TasNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> with a linear waveform encoder &amp; decoder pair and a mask estimation network (MaskNet) in between. The full architecture is drawn in Fig.<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The MaskNet is a Mamba encoder model. A stack of Mamba encoder blocks processes the encoded features of the mixture. <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">S</annotation></semantics></math> masks corresponding to <math id="S3.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">S</annotation></semantics></math> sources are estimated from the features after the last block. The separated sources are reconstructed to waveforms by the decoder.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.1" class="ltx_p">Notice that Mamba-TasNet is a <span id="S3.SS2.SSS1.p2.1.1" class="ltx_text ltx_font_italic">single-path</span> model. Time-domain RNN or transformer-based separation models after DPRNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> often follow a dual-path (or multi-path) architecture for both performance and efficiency considerations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. An earlier Mamba separation model, DPMamba <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, also adopts a dual-path architecture. In these models, a waveform (downsampled by the encoder but still thousands of tokens) is split into chunks of the same sizes. Intra-chunk and inter-chunk RNNs or transformers each process a sequence much shorter in length than the waveform to alleviate the high complexity of RNN and transformer in sequence length. On the other hand, since Mamba enjoys linear complexity in sequence length, we hypothesize that dual-path architecture is not necessary for Mamba. Our results prove this hypothesis.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2407.09732/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="485" height="380" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.2.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>The architecture of Mamba-TasNet, ConMamba, and VALL-M.</figcaption>
</figure>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>ConMamba</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.2" class="ltx_p">Conformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> proposes to add a convolution module in the transformer encoder block to effectively exploit local features. This inspires us to add a convolution module to the Mamba encoder block. The new ConMamba block is depicted at the bottom of Fig.<a href="#S2.F3" title="Figure 3 ‣ 2 Related Works ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. A ConMamba block contains Mamba, feedforward, and convolution modules. The computation workflow from input <math id="S3.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">x</annotation></semantics></math> to output <math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">y</annotation></semantics></math> is followed:</p>
<table id="S7.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle x^{\prime}=x+\frac{1}{2}\textit{FeedForward}(x)" display="inline"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><msup id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2.cmml"><mi id="S3.E5.m1.1.2.2.2" xref="S3.E5.m1.1.2.2.2.cmml">x</mi><mo id="S3.E5.m1.1.2.2.3" xref="S3.E5.m1.1.2.2.3.cmml">′</mo></msup><mo id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">=</mo><mrow id="S3.E5.m1.1.2.3" xref="S3.E5.m1.1.2.3.cmml"><mi id="S3.E5.m1.1.2.3.2" xref="S3.E5.m1.1.2.3.2.cmml">x</mi><mo id="S3.E5.m1.1.2.3.1" xref="S3.E5.m1.1.2.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.2.3.3" xref="S3.E5.m1.1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E5.m1.1.2.3.3.2" xref="S3.E5.m1.1.2.3.3.2.cmml"><mfrac id="S3.E5.m1.1.2.3.3.2a" xref="S3.E5.m1.1.2.3.3.2.cmml"><mn id="S3.E5.m1.1.2.3.3.2.2" xref="S3.E5.m1.1.2.3.3.2.2.cmml">1</mn><mn id="S3.E5.m1.1.2.3.3.2.3" xref="S3.E5.m1.1.2.3.3.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.3.3.1" xref="S3.E5.m1.1.2.3.3.1.cmml">​</mo><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.2.3.3.3" xref="S3.E5.m1.1.2.3.3.3a.cmml">FeedForward</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.3.3.1a" xref="S3.E5.m1.1.2.3.3.1.cmml">​</mo><mrow id="S3.E5.m1.1.2.3.3.4.2" xref="S3.E5.m1.1.2.3.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.2.3.3.4.2.1" xref="S3.E5.m1.1.2.3.3.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E5.m1.1.2.3.3.4.2.2" xref="S3.E5.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><eq id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></eq><apply id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.1.cmml" xref="S3.E5.m1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.1.2.2.2.cmml" xref="S3.E5.m1.1.2.2.2">𝑥</ci><ci id="S3.E5.m1.1.2.2.3.cmml" xref="S3.E5.m1.1.2.2.3">′</ci></apply><apply id="S3.E5.m1.1.2.3.cmml" xref="S3.E5.m1.1.2.3"><plus id="S3.E5.m1.1.2.3.1.cmml" xref="S3.E5.m1.1.2.3.1"></plus><ci id="S3.E5.m1.1.2.3.2.cmml" xref="S3.E5.m1.1.2.3.2">𝑥</ci><apply id="S3.E5.m1.1.2.3.3.cmml" xref="S3.E5.m1.1.2.3.3"><times id="S3.E5.m1.1.2.3.3.1.cmml" xref="S3.E5.m1.1.2.3.3.1"></times><apply id="S3.E5.m1.1.2.3.3.2.cmml" xref="S3.E5.m1.1.2.3.3.2"><divide id="S3.E5.m1.1.2.3.3.2.1.cmml" xref="S3.E5.m1.1.2.3.3.2"></divide><cn type="integer" id="S3.E5.m1.1.2.3.3.2.2.cmml" xref="S3.E5.m1.1.2.3.3.2.2">1</cn><cn type="integer" id="S3.E5.m1.1.2.3.3.2.3.cmml" xref="S3.E5.m1.1.2.3.3.2.3">2</cn></apply><ci id="S3.E5.m1.1.2.3.3.3a.cmml" xref="S3.E5.m1.1.2.3.3.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.2.3.3.3.cmml" xref="S3.E5.m1.1.2.3.3.3">FeedForward</mtext></ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle x^{\prime}=x+\frac{1}{2}\textit{FeedForward}(x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle x^{\prime\prime}=x^{\prime}+\textit{BiMamba}(x^{\prime})" display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msup id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">x</mi><mo id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">′′</mo></msup><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">x</mi><mo id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3a.cmml">BiMamba</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝑥</ci><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">′′</ci></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><plus id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></plus><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3.2">𝑥</ci><ci id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3">′</ci></apply><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3">BiMamba</mtext></ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle x^{\prime\prime}=x^{\prime}+\textit{BiMamba}(x^{\prime})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle x^{\prime\prime\prime}=x^{\prime\prime}+\textit{Convolution}(x^{\prime\prime})" display="inline"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><msup id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml">x</mi><mo id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml">′′′</mo></msup><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><msup id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.3.2.cmml">x</mi><mo id="S3.E7.m1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.3.3.cmml">′′</mo></msup><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3a.cmml">Convolution</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">′′</mo></msup><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></eq><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2">𝑥</ci><ci id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3">′′′</ci></apply><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><plus id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></plus><apply id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.3.2">𝑥</ci><ci id="S3.E7.m1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.3.3">′′</ci></apply><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3">Convolution</mtext></ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3">′′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle x^{\prime\prime\prime}=x^{\prime\prime}+\textit{Convolution}(x^{\prime\prime})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle y=\textit{LayerNorm}(x^{\prime\prime\prime}+\frac{1}{2}\textit{FeedForward}(x^{\prime\prime\prime}))" display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">y</mi><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><msup id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml">′′′</mo></msup><mo id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E8.m1.1.1.1.1.1.1.1.3a" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E8.m1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mn id="S3.E8.m1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.1.1.1.1.1.1.1.4" xref="S3.E8.m1.1.1.1.1.1.1.1.4a.cmml">FeedForward</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.2a" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">′′′</mo></msup><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">𝑦</ci><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><times id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><plus id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"></plus><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">′′′</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"><divide id="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2">1</cn><cn type="integer" id="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S3.E8.m1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.4"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.4">FeedForward</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3">′′′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle y=\textit{LayerNorm}(x^{\prime\prime\prime}+\frac{1}{2}\textit{FeedForward}(x^{\prime\prime\prime}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p1.3" class="ltx_p">ConMamba’s encoder consists of a stack of ConMamba encoder blocks following a CNN frontend to compress the spectrogram into tokens, as illustrated in the middle of Fig.<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Then, we can estimate text token probability from the last encoder representation or add a transformer or Mamba decoder to output tokens autoregressively. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> has implemented the latter approach with a Mamba encoder and a transformer decoder and reported a higher performance than the Conformer. However, since half of their model is still transformer, whether Mamba alone contributes to the high performance is still to be determined. To make our results more convincing, we implement and compare a ConMamba encoder-only, ConMamba encoder-Mamba decoder, and ConMamba encoder-transformer decoder model against a Conformer encoder-only and Conformer encoder-transformer decoder model.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>VALL-M</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.6" class="ltx_p">VALL-E <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> formulates speech synthesis as a language modeling task in a speech codec. The tokens in this language are the codes from 8 hierarchical codebooks in EnCodec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. The language modeling task aims to maximize the conditional probability <math id="S3.SS2.SSS3.p1.1.m1.4" class="ltx_Math" alttext="p(\mathbf{C}|\mathbf{x},\tilde{\mathbf{C}};\theta)" display="inline"><semantics id="S3.SS2.SSS3.p1.1.m1.4a"><mrow id="S3.SS2.SSS3.p1.1.m1.4.4" xref="S3.SS2.SSS3.p1.1.m1.4.4.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.4.4.3" xref="S3.SS2.SSS3.p1.1.m1.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.1.m1.4.4.2" xref="S3.SS2.SSS3.p1.1.m1.4.4.2.cmml">​</mo><mrow id="S3.SS2.SSS3.p1.1.m1.4.4.1.1" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.2.cmml">𝐂</mi><mo fence="false" id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.1" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.2" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.2.1" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.1.cmml">,</mo><mover accent="true" id="S3.SS2.SSS3.p1.1.m1.2.2" xref="S3.SS2.SSS3.p1.1.m1.2.2.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.2.2.2" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.cmml">𝐂</mi><mo id="S3.SS2.SSS3.p1.1.m1.2.2.1" xref="S3.SS2.SSS3.p1.1.m1.2.2.1.cmml">~</mo></mover><mo id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.2.2" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.SS2.SSS3.p1.1.m1.3.3" xref="S3.SS2.SSS3.p1.1.m1.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.4b"><apply id="S3.SS2.SSS3.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4"><times id="S3.SS2.SSS3.p1.1.m1.4.4.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.2"></times><ci id="S3.SS2.SSS3.p1.1.m1.4.4.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.3">𝑝</ci><apply id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.2">𝐂</ci><list id="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.4.4.1.1.1.3.2"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">𝐱</ci><apply id="S3.SS2.SSS3.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.2"><ci id="S3.SS2.SSS3.p1.1.m1.2.2.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.2.1">~</ci><ci id="S3.SS2.SSS3.p1.1.m1.2.2.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.2.2">𝐂</ci></apply><ci id="S3.SS2.SSS3.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.3.3">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.4c">p(\mathbf{C}|\mathbf{x},\tilde{\mathbf{C}};\theta)</annotation></semantics></math>, where <math id="S3.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mi id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><ci id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">\mathbf{x}</annotation></semantics></math> is the phoneme sequence of the speech to synthesize, <math id="S3.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\tilde{\mathbf{C}}\in\mathbb{R}^{\tilde{T}\times 8}" display="inline"><semantics id="S3.SS2.SSS3.p1.3.m3.1a"><mrow id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p1.3.m3.1.1.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS3.p1.3.m3.1.1.2.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.2.cmml">𝐂</mi><mo id="S3.SS2.SSS3.p1.3.m3.1.1.2.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS2.SSS3.p1.3.m3.1.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p1.3.m3.1.1.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.cmml"><mover accent="true" id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.2.cmml">T</mi><mo id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.1.cmml">~</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.3.cmml">8</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.1b"><apply id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1"><in id="S3.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.1"></in><apply id="S3.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.1">~</ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.2">𝐂</ci></apply><apply id="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3"><times id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.1">~</ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.2.2">𝑇</ci></apply><cn type="integer" id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.3">8</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.1c">\tilde{\mathbf{C}}\in\mathbb{R}^{\tilde{T}\times 8}</annotation></semantics></math> is 8 sequences of codes tokenized from a short enrollment of the speaker to clone, <math id="S3.SS2.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{C}\in\mathbb{R}^{T\times 8}" display="inline"><semantics id="S3.SS2.SSS3.p1.4.m4.1a"><mrow id="S3.SS2.SSS3.p1.4.m4.1.1" xref="S3.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS3.p1.4.m4.1.1.2" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.cmml">𝐂</mi><mo id="S3.SS2.SSS3.p1.4.m4.1.1.1" xref="S3.SS2.SSS3.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p1.4.m4.1.1.3" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.4.m4.1.1.3.2" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p1.4.m4.1.1.3.3" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.2" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.1" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.3" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.3.cmml">8</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.4.m4.1b"><apply id="S3.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1"><in id="S3.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.1"></in><ci id="S3.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.2">𝐂</ci><apply id="S3.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3"><times id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.2">𝑇</ci><cn type="integer" id="S3.SS2.SSS3.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.3.3">8</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.4.m4.1c">\mathbf{C}\in\mathbb{R}^{T\times 8}</annotation></semantics></math> is the code sequences of the synthesized speech, and <math id="S3.SS2.SSS3.p1.5.m5.2" class="ltx_Math" alttext="\theta=\{\theta_{\text{AR}},\theta_{\text{NAR}}\}" display="inline"><semantics id="S3.SS2.SSS3.p1.5.m5.2a"><mrow id="S3.SS2.SSS3.p1.5.m5.2.2" xref="S3.SS2.SSS3.p1.5.m5.2.2.cmml"><mi id="S3.SS2.SSS3.p1.5.m5.2.2.4" xref="S3.SS2.SSS3.p1.5.m5.2.2.4.cmml">θ</mi><mo id="S3.SS2.SSS3.p1.5.m5.2.2.3" xref="S3.SS2.SSS3.p1.5.m5.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS3.p1.5.m5.2.2.2.2" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.3" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.2.cmml">θ</mi><mtext id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3a.cmml">AR</mtext></msub><mo id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.4" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.2" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.2.cmml">θ</mi><mtext id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3a.cmml">NAR</mtext></msub><mo stretchy="false" id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.5" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.5.m5.2b"><apply id="S3.SS2.SSS3.p1.5.m5.2.2.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2"><eq id="S3.SS2.SSS3.p1.5.m5.2.2.3.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.3"></eq><ci id="S3.SS2.SSS3.p1.5.m5.2.2.4.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.4">𝜃</ci><set id="S3.SS2.SSS3.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2"><apply id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.1.1.1.3">AR</mtext></ci></apply><apply id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3a.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS3.p1.5.m5.2.2.2.2.2.3">NAR</mtext></ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.5.m5.2c">\theta=\{\theta_{\text{AR}},\theta_{\text{NAR}}\}</annotation></semantics></math> denotes the model parameters. <math id="S3.SS2.SSS3.p1.6.m6.4" class="ltx_Math" alttext="p(\mathbf{C}|\mathbf{x},\tilde{\mathbf{C}};\theta)" display="inline"><semantics id="S3.SS2.SSS3.p1.6.m6.4a"><mrow id="S3.SS2.SSS3.p1.6.m6.4.4" xref="S3.SS2.SSS3.p1.6.m6.4.4.cmml"><mi id="S3.SS2.SSS3.p1.6.m6.4.4.3" xref="S3.SS2.SSS3.p1.6.m6.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.6.m6.4.4.2" xref="S3.SS2.SSS3.p1.6.m6.4.4.2.cmml">​</mo><mrow id="S3.SS2.SSS3.p1.6.m6.4.4.1.1" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.2" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.2" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.2.cmml">𝐂</mi><mo fence="false" id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.1" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.2" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.1.cmml"><mi id="S3.SS2.SSS3.p1.6.m6.1.1" xref="S3.SS2.SSS3.p1.6.m6.1.1.cmml">𝐱</mi><mo id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.2.1" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.1.cmml">,</mo><mover accent="true" id="S3.SS2.SSS3.p1.6.m6.2.2" xref="S3.SS2.SSS3.p1.6.m6.2.2.cmml"><mi id="S3.SS2.SSS3.p1.6.m6.2.2.2" xref="S3.SS2.SSS3.p1.6.m6.2.2.2.cmml">𝐂</mi><mo id="S3.SS2.SSS3.p1.6.m6.2.2.1" xref="S3.SS2.SSS3.p1.6.m6.2.2.1.cmml">~</mo></mover><mo id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.2.2" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.SS2.SSS3.p1.6.m6.3.3" xref="S3.SS2.SSS3.p1.6.m6.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.3" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.6.m6.4b"><apply id="S3.SS2.SSS3.p1.6.m6.4.4.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4"><times id="S3.SS2.SSS3.p1.6.m6.4.4.2.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.2"></times><ci id="S3.SS2.SSS3.p1.6.m6.4.4.3.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.3">𝑝</ci><apply id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1"><csymbol cd="latexml" id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.2">𝐂</ci><list id="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.4.4.1.1.1.3.2"><ci id="S3.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1">𝐱</ci><apply id="S3.SS2.SSS3.p1.6.m6.2.2.cmml" xref="S3.SS2.SSS3.p1.6.m6.2.2"><ci id="S3.SS2.SSS3.p1.6.m6.2.2.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.2.2.1">~</ci><ci id="S3.SS2.SSS3.p1.6.m6.2.2.2.cmml" xref="S3.SS2.SSS3.p1.6.m6.2.2.2">𝐂</ci></apply><ci id="S3.SS2.SSS3.p1.6.m6.3.3.cmml" xref="S3.SS2.SSS3.p1.6.m6.3.3">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.6.m6.4c">p(\mathbf{C}|\mathbf{x},\tilde{\mathbf{C}};\theta)</annotation></semantics></math> can be optimized by solving two separate language modeling tasks due to the hierarchy of codes. An autoregressive (AR) task maximizes the next code probability of the code sequence obtained from the first quantizer:</p>
<table id="S7.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.15" class="ltx_Math" alttext="\displaystyle p(C_{:,1}|\mathbf{x},\tilde{\mathbf{C}}_{:,1};\theta_{AR})=\prod_{t=0}^{T}p(C_{t,1}|C_{&lt;t,1},\tilde{\mathbf{C}}_{:,1},\mathbf{x};\theta_{AR})" display="inline"><semantics id="S3.E9.m1.15a"><mrow id="S3.E9.m1.15.15" xref="S3.E9.m1.15.15.cmml"><mrow id="S3.E9.m1.14.14.1" xref="S3.E9.m1.14.14.1.cmml"><mi id="S3.E9.m1.14.14.1.3" xref="S3.E9.m1.14.14.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.14.14.1.2" xref="S3.E9.m1.14.14.1.2.cmml">​</mo><mrow id="S3.E9.m1.14.14.1.1.1" xref="S3.E9.m1.14.14.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.14.14.1.1.1.2" xref="S3.E9.m1.14.14.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.14.14.1.1.1.1" xref="S3.E9.m1.14.14.1.1.1.1.cmml"><msub id="S3.E9.m1.14.14.1.1.1.1.4" xref="S3.E9.m1.14.14.1.1.1.1.4.cmml"><mi id="S3.E9.m1.14.14.1.1.1.1.4.2" xref="S3.E9.m1.14.14.1.1.1.1.4.2.cmml">C</mi><mrow id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.3.cmml"><mo rspace="0em" id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">:</mo><mo id="S3.E9.m1.2.2.2.4.1" xref="S3.E9.m1.2.2.2.3.cmml">,</mo><mn id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E9.m1.14.14.1.1.1.1.3" xref="S3.E9.m1.14.14.1.1.1.1.3.cmml">|</mo><mrow id="S3.E9.m1.14.14.1.1.1.1.2.2" xref="S3.E9.m1.14.14.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.12.12" xref="S3.E9.m1.12.12.cmml">𝐱</mi><mo id="S3.E9.m1.14.14.1.1.1.1.2.2.3" xref="S3.E9.m1.14.14.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E9.m1.14.14.1.1.1.1.1.1.1" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.2.cmml">𝐂</mi><mo id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E9.m1.4.4.2.4" xref="S3.E9.m1.4.4.2.3.cmml"><mo rspace="0em" id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">:</mo><mo id="S3.E9.m1.4.4.2.4.1" xref="S3.E9.m1.4.4.2.3.cmml">,</mo><mn id="S3.E9.m1.4.4.2.2" xref="S3.E9.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.14.14.1.1.1.1.2.2.4" xref="S3.E9.m1.14.14.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E9.m1.14.14.1.1.1.1.2.2.2" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.cmml"><mi id="S3.E9.m1.14.14.1.1.1.1.2.2.2.2" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.2" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.1" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.3" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.3.cmml">R</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E9.m1.14.14.1.1.1.3" xref="S3.E9.m1.14.14.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.15.15.3" xref="S3.E9.m1.15.15.3.cmml">=</mo><mrow id="S3.E9.m1.15.15.2" xref="S3.E9.m1.15.15.2.cmml"><mstyle displaystyle="true" id="S3.E9.m1.15.15.2.2" xref="S3.E9.m1.15.15.2.2.cmml"><munderover id="S3.E9.m1.15.15.2.2a" xref="S3.E9.m1.15.15.2.2.cmml"><mo movablelimits="false" id="S3.E9.m1.15.15.2.2.2.2" xref="S3.E9.m1.15.15.2.2.2.2.cmml">∏</mo><mrow id="S3.E9.m1.15.15.2.2.2.3" xref="S3.E9.m1.15.15.2.2.2.3.cmml"><mi id="S3.E9.m1.15.15.2.2.2.3.2" xref="S3.E9.m1.15.15.2.2.2.3.2.cmml">t</mi><mo id="S3.E9.m1.15.15.2.2.2.3.1" xref="S3.E9.m1.15.15.2.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.15.15.2.2.2.3.3" xref="S3.E9.m1.15.15.2.2.2.3.3.cmml">0</mn></mrow><mi id="S3.E9.m1.15.15.2.2.3" xref="S3.E9.m1.15.15.2.2.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E9.m1.15.15.2.1" xref="S3.E9.m1.15.15.2.1.cmml"><mi id="S3.E9.m1.15.15.2.1.3" xref="S3.E9.m1.15.15.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.15.15.2.1.2" xref="S3.E9.m1.15.15.2.1.2.cmml">​</mo><mrow id="S3.E9.m1.15.15.2.1.1.1" xref="S3.E9.m1.15.15.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.15.15.2.1.1.1.2" xref="S3.E9.m1.15.15.2.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.15.15.2.1.1.1.1" xref="S3.E9.m1.15.15.2.1.1.1.1.cmml"><msub id="S3.E9.m1.15.15.2.1.1.1.1.5" xref="S3.E9.m1.15.15.2.1.1.1.1.5.cmml"><mi id="S3.E9.m1.15.15.2.1.1.1.1.5.2" xref="S3.E9.m1.15.15.2.1.1.1.1.5.2.cmml">C</mi><mrow id="S3.E9.m1.6.6.2.4" xref="S3.E9.m1.6.6.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1" xref="S3.E9.m1.5.5.1.1.cmml">t</mi><mo id="S3.E9.m1.6.6.2.4.1" xref="S3.E9.m1.6.6.2.3.cmml">,</mo><mn id="S3.E9.m1.6.6.2.2" xref="S3.E9.m1.6.6.2.2.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E9.m1.15.15.2.1.1.1.1.4" xref="S3.E9.m1.15.15.2.1.1.1.1.4.cmml">|</mo><mrow id="S3.E9.m1.15.15.2.1.1.1.1.3.3" xref="S3.E9.m1.15.15.2.1.1.1.1.3.4.cmml"><msub id="S3.E9.m1.15.15.2.1.1.1.1.1.1.1" xref="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.2" xref="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.2.cmml">C</mi><mrow id="S3.E9.m1.9.9.3.3" xref="S3.E9.m1.9.9.3.4.cmml"><mrow id="S3.E9.m1.9.9.3.3.1" xref="S3.E9.m1.9.9.3.3.1.cmml"><mi id="S3.E9.m1.9.9.3.3.1.2" xref="S3.E9.m1.9.9.3.3.1.2.cmml"></mi><mo id="S3.E9.m1.9.9.3.3.1.1" xref="S3.E9.m1.9.9.3.3.1.1.cmml">&lt;</mo><mi id="S3.E9.m1.7.7.1.1" xref="S3.E9.m1.7.7.1.1.cmml">t</mi></mrow><mo id="S3.E9.m1.9.9.3.3.2" xref="S3.E9.m1.9.9.3.4.cmml">,</mo><mn id="S3.E9.m1.8.8.2.2" xref="S3.E9.m1.8.8.2.2.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.15.15.2.1.1.1.1.3.3.4" xref="S3.E9.m1.15.15.2.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.2" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.2.cmml">𝐂</mi><mo id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.1" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.E9.m1.11.11.2.4" xref="S3.E9.m1.11.11.2.3.cmml"><mo rspace="0em" id="S3.E9.m1.10.10.1.1" xref="S3.E9.m1.10.10.1.1.cmml">:</mo><mo id="S3.E9.m1.11.11.2.4.1" xref="S3.E9.m1.11.11.2.3.cmml">,</mo><mn id="S3.E9.m1.11.11.2.2" xref="S3.E9.m1.11.11.2.2.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.15.15.2.1.1.1.1.3.3.5" xref="S3.E9.m1.15.15.2.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E9.m1.13.13" xref="S3.E9.m1.13.13.cmml">𝐱</mi><mo id="S3.E9.m1.15.15.2.1.1.1.1.3.3.6" xref="S3.E9.m1.15.15.2.1.1.1.1.3.4.cmml">;</mo><msub id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.2" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.2.cmml">θ</mi><mrow id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.2" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.1" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.3" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.3.cmml">R</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E9.m1.15.15.2.1.1.1.3" xref="S3.E9.m1.15.15.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.15b"><apply id="S3.E9.m1.15.15.cmml" xref="S3.E9.m1.15.15"><eq id="S3.E9.m1.15.15.3.cmml" xref="S3.E9.m1.15.15.3"></eq><apply id="S3.E9.m1.14.14.1.cmml" xref="S3.E9.m1.14.14.1"><times id="S3.E9.m1.14.14.1.2.cmml" xref="S3.E9.m1.14.14.1.2"></times><ci id="S3.E9.m1.14.14.1.3.cmml" xref="S3.E9.m1.14.14.1.3">𝑝</ci><apply id="S3.E9.m1.14.14.1.1.1.1.cmml" xref="S3.E9.m1.14.14.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.14.14.1.1.1.1.3.cmml" xref="S3.E9.m1.14.14.1.1.1.1.3">conditional</csymbol><apply id="S3.E9.m1.14.14.1.1.1.1.4.cmml" xref="S3.E9.m1.14.14.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.14.14.1.1.1.1.4.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.4">subscript</csymbol><ci id="S3.E9.m1.14.14.1.1.1.1.4.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.4.2">𝐶</ci><list id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.4"><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">:</ci><cn type="integer" id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">1</cn></list></apply><list id="S3.E9.m1.14.14.1.1.1.1.2.3.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2"><ci id="S3.E9.m1.12.12.cmml" xref="S3.E9.m1.12.12">𝐱</ci><apply id="S3.E9.m1.14.14.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.14.14.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.1.1.1.2.2">𝐂</ci></apply><list id="S3.E9.m1.4.4.2.3.cmml" xref="S3.E9.m1.4.4.2.4"><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">:</ci><cn type="integer" id="S3.E9.m1.4.4.2.2.cmml" xref="S3.E9.m1.4.4.2.2">1</cn></list></apply><apply id="S3.E9.m1.14.14.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.14.14.1.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E9.m1.14.14.1.1.1.1.2.2.2.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3"><times id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.2">𝐴</ci><ci id="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E9.m1.14.14.1.1.1.1.2.2.2.3.3">𝑅</ci></apply></apply></list></apply></apply><apply id="S3.E9.m1.15.15.2.cmml" xref="S3.E9.m1.15.15.2"><apply id="S3.E9.m1.15.15.2.2.cmml" xref="S3.E9.m1.15.15.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.2.1.cmml" xref="S3.E9.m1.15.15.2.2">superscript</csymbol><apply id="S3.E9.m1.15.15.2.2.2.cmml" xref="S3.E9.m1.15.15.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.2.2.1.cmml" xref="S3.E9.m1.15.15.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E9.m1.15.15.2.2.2.2.cmml" xref="S3.E9.m1.15.15.2.2.2.2">product</csymbol><apply id="S3.E9.m1.15.15.2.2.2.3.cmml" xref="S3.E9.m1.15.15.2.2.2.3"><eq id="S3.E9.m1.15.15.2.2.2.3.1.cmml" xref="S3.E9.m1.15.15.2.2.2.3.1"></eq><ci id="S3.E9.m1.15.15.2.2.2.3.2.cmml" xref="S3.E9.m1.15.15.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E9.m1.15.15.2.2.2.3.3.cmml" xref="S3.E9.m1.15.15.2.2.2.3.3">0</cn></apply></apply><ci id="S3.E9.m1.15.15.2.2.3.cmml" xref="S3.E9.m1.15.15.2.2.3">𝑇</ci></apply><apply id="S3.E9.m1.15.15.2.1.cmml" xref="S3.E9.m1.15.15.2.1"><times id="S3.E9.m1.15.15.2.1.2.cmml" xref="S3.E9.m1.15.15.2.1.2"></times><ci id="S3.E9.m1.15.15.2.1.3.cmml" xref="S3.E9.m1.15.15.2.1.3">𝑝</ci><apply id="S3.E9.m1.15.15.2.1.1.1.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.15.15.2.1.1.1.1.4.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.4">conditional</csymbol><apply id="S3.E9.m1.15.15.2.1.1.1.1.5.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.1.1.1.1.5.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E9.m1.15.15.2.1.1.1.1.5.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.5.2">𝐶</ci><list id="S3.E9.m1.6.6.2.3.cmml" xref="S3.E9.m1.6.6.2.4"><ci id="S3.E9.m1.5.5.1.1.cmml" xref="S3.E9.m1.5.5.1.1">𝑡</ci><cn type="integer" id="S3.E9.m1.6.6.2.2.cmml" xref="S3.E9.m1.6.6.2.2">1</cn></list></apply><list id="S3.E9.m1.15.15.2.1.1.1.1.3.4.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3"><apply id="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.1.1.1.2">𝐶</ci><list id="S3.E9.m1.9.9.3.4.cmml" xref="S3.E9.m1.9.9.3.3"><apply id="S3.E9.m1.9.9.3.3.1.cmml" xref="S3.E9.m1.9.9.3.3.1"><lt id="S3.E9.m1.9.9.3.3.1.1.cmml" xref="S3.E9.m1.9.9.3.3.1.1"></lt><csymbol cd="latexml" id="S3.E9.m1.9.9.3.3.1.2.cmml" xref="S3.E9.m1.9.9.3.3.1.2">absent</csymbol><ci id="S3.E9.m1.7.7.1.1.cmml" xref="S3.E9.m1.7.7.1.1">𝑡</ci></apply><cn type="integer" id="S3.E9.m1.8.8.2.2.cmml" xref="S3.E9.m1.8.8.2.2">1</cn></list></apply><apply id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2"><ci id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.1">~</ci><ci id="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.2.2.2.2.2">𝐂</ci></apply><list id="S3.E9.m1.11.11.2.3.cmml" xref="S3.E9.m1.11.11.2.4"><ci id="S3.E9.m1.10.10.1.1.cmml" xref="S3.E9.m1.10.10.1.1">:</ci><cn type="integer" id="S3.E9.m1.11.11.2.2.cmml" xref="S3.E9.m1.11.11.2.2">1</cn></list></apply><ci id="S3.E9.m1.13.13.cmml" xref="S3.E9.m1.13.13">𝐱</ci><apply id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3"><times id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.2">𝐴</ci><ci id="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E9.m1.15.15.2.1.1.1.1.3.3.3.3.3">𝑅</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.15c">\displaystyle p(C_{:,1}|\mathbf{x},\tilde{\mathbf{C}}_{:,1};\theta_{AR})=\prod_{t=0}^{T}p(C_{t,1}|C_{&lt;t,1},\tilde{\mathbf{C}}_{:,1},\mathbf{x};\theta_{AR})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p1.7" class="ltx_p">The other non-autoregressive (NAR) task works on details from the second to the last residual codebooks. It is allowed to look at the entire code sequence from the first quantizer:</p>
<table id="S7.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.12" class="ltx_Math" alttext="\displaystyle p(\mathbf{C}_{:,2:8}|\mathbf{x},\tilde{\mathbf{C}};\theta_{NAR})=\prod_{j=2}^{8}p(C_{:,j}|\mathbf{C}_{:,&lt;j},\mathbf{x},\tilde{\mathbf{C}};\theta_{NAR})" display="inline"><semantics id="S3.E10.m1.12a"><mrow id="S3.E10.m1.12.12" xref="S3.E10.m1.12.12.cmml"><mrow id="S3.E10.m1.11.11.1" xref="S3.E10.m1.11.11.1.cmml"><mi id="S3.E10.m1.11.11.1.3" xref="S3.E10.m1.11.11.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.11.11.1.2" xref="S3.E10.m1.11.11.1.2.cmml">​</mo><mrow id="S3.E10.m1.11.11.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.11.11.1.1.1.2" xref="S3.E10.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.11.11.1.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.cmml"><msub id="S3.E10.m1.11.11.1.1.1.1.3" xref="S3.E10.m1.11.11.1.1.1.1.3.cmml"><mi id="S3.E10.m1.11.11.1.1.1.1.3.2" xref="S3.E10.m1.11.11.1.1.1.1.3.2.cmml">𝐂</mi><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><mrow id="S3.E10.m1.2.2.2.4.2" xref="S3.E10.m1.2.2.2.4.1.cmml"><mo rspace="0em" id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">:</mo><mo id="S3.E10.m1.2.2.2.4.2.1" xref="S3.E10.m1.2.2.2.4.1.cmml">,</mo><mn id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">2</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">:</mo><mn id="S3.E10.m1.2.2.2.5" xref="S3.E10.m1.2.2.2.5.cmml">8</mn></mrow></msub><mo fence="false" id="S3.E10.m1.11.11.1.1.1.1.2" xref="S3.E10.m1.11.11.1.1.1.1.2.cmml">|</mo><mrow id="S3.E10.m1.11.11.1.1.1.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml">𝐱</mi><mo id="S3.E10.m1.11.11.1.1.1.1.1.1.2" xref="S3.E10.m1.11.11.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E10.m1.8.8" xref="S3.E10.m1.8.8.cmml"><mi id="S3.E10.m1.8.8.2" xref="S3.E10.m1.8.8.2.cmml">𝐂</mi><mo id="S3.E10.m1.8.8.1" xref="S3.E10.m1.8.8.1.cmml">~</mo></mover><mo id="S3.E10.m1.11.11.1.1.1.1.1.1.3" xref="S3.E10.m1.11.11.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E10.m1.11.11.1.1.1.1.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.11.11.1.1.1.1.1.1.1.2" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1a" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.4" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.4.cmml">R</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E10.m1.11.11.1.1.1.3" xref="S3.E10.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.12.12.3" xref="S3.E10.m1.12.12.3.cmml">=</mo><mrow id="S3.E10.m1.12.12.2" xref="S3.E10.m1.12.12.2.cmml"><mstyle displaystyle="true" id="S3.E10.m1.12.12.2.2" xref="S3.E10.m1.12.12.2.2.cmml"><munderover id="S3.E10.m1.12.12.2.2a" xref="S3.E10.m1.12.12.2.2.cmml"><mo movablelimits="false" id="S3.E10.m1.12.12.2.2.2.2" xref="S3.E10.m1.12.12.2.2.2.2.cmml">∏</mo><mrow id="S3.E10.m1.12.12.2.2.2.3" xref="S3.E10.m1.12.12.2.2.2.3.cmml"><mi id="S3.E10.m1.12.12.2.2.2.3.2" xref="S3.E10.m1.12.12.2.2.2.3.2.cmml">j</mi><mo id="S3.E10.m1.12.12.2.2.2.3.1" xref="S3.E10.m1.12.12.2.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.12.12.2.2.2.3.3" xref="S3.E10.m1.12.12.2.2.2.3.3.cmml">2</mn></mrow><mn id="S3.E10.m1.12.12.2.2.3" xref="S3.E10.m1.12.12.2.2.3.cmml">8</mn></munderover></mstyle><mrow id="S3.E10.m1.12.12.2.1" xref="S3.E10.m1.12.12.2.1.cmml"><mi id="S3.E10.m1.12.12.2.1.3" xref="S3.E10.m1.12.12.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.12.12.2.1.2" xref="S3.E10.m1.12.12.2.1.2.cmml">​</mo><mrow id="S3.E10.m1.12.12.2.1.1.1" xref="S3.E10.m1.12.12.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.12.12.2.1.1.1.2" xref="S3.E10.m1.12.12.2.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.12.12.2.1.1.1.1" xref="S3.E10.m1.12.12.2.1.1.1.1.cmml"><msub id="S3.E10.m1.12.12.2.1.1.1.1.4" xref="S3.E10.m1.12.12.2.1.1.1.1.4.cmml"><mi id="S3.E10.m1.12.12.2.1.1.1.1.4.2" xref="S3.E10.m1.12.12.2.1.1.1.1.4.2.cmml">C</mi><mrow id="S3.E10.m1.4.4.2.4" xref="S3.E10.m1.4.4.2.3.cmml"><mo rspace="0em" id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml">:</mo><mo id="S3.E10.m1.4.4.2.4.1" xref="S3.E10.m1.4.4.2.3.cmml">,</mo><mi id="S3.E10.m1.4.4.2.2" xref="S3.E10.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E10.m1.12.12.2.1.1.1.1.3" xref="S3.E10.m1.12.12.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.E10.m1.12.12.2.1.1.1.1.2.2" xref="S3.E10.m1.12.12.2.1.1.1.1.2.3.cmml"><msub id="S3.E10.m1.12.12.2.1.1.1.1.1.1.1" xref="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.2" xref="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.2.cmml">𝐂</mi><mrow id="S3.E10.m1.6.6.2.2" xref="S3.E10.m1.6.6.2.3.cmml"><mo rspace="0em" id="S3.E10.m1.5.5.1.1" xref="S3.E10.m1.5.5.1.1.cmml">:</mo><mo id="S3.E10.m1.6.6.2.2.2" xref="S3.E10.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E10.m1.6.6.2.2.1" xref="S3.E10.m1.6.6.2.2.1.cmml"><mi id="S3.E10.m1.6.6.2.2.1.2" xref="S3.E10.m1.6.6.2.2.1.2.cmml"></mi><mo id="S3.E10.m1.6.6.2.2.1.1" xref="S3.E10.m1.6.6.2.2.1.1.cmml">&lt;</mo><mi id="S3.E10.m1.6.6.2.2.1.3" xref="S3.E10.m1.6.6.2.2.1.3.cmml">j</mi></mrow></mrow></msub><mo id="S3.E10.m1.12.12.2.1.1.1.1.2.2.3" xref="S3.E10.m1.12.12.2.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E10.m1.9.9" xref="S3.E10.m1.9.9.cmml">𝐱</mi><mo id="S3.E10.m1.12.12.2.1.1.1.1.2.2.4" xref="S3.E10.m1.12.12.2.1.1.1.1.2.3.cmml">,</mo><mover accent="true" id="S3.E10.m1.10.10" xref="S3.E10.m1.10.10.cmml"><mi id="S3.E10.m1.10.10.2" xref="S3.E10.m1.10.10.2.cmml">𝐂</mi><mo id="S3.E10.m1.10.10.1" xref="S3.E10.m1.10.10.1.cmml">~</mo></mover><mo id="S3.E10.m1.12.12.2.1.1.1.1.2.2.5" xref="S3.E10.m1.12.12.2.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.2" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.2" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.3" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1a" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.4" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.4.cmml">R</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E10.m1.12.12.2.1.1.1.3" xref="S3.E10.m1.12.12.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.12b"><apply id="S3.E10.m1.12.12.cmml" xref="S3.E10.m1.12.12"><eq id="S3.E10.m1.12.12.3.cmml" xref="S3.E10.m1.12.12.3"></eq><apply id="S3.E10.m1.11.11.1.cmml" xref="S3.E10.m1.11.11.1"><times id="S3.E10.m1.11.11.1.2.cmml" xref="S3.E10.m1.11.11.1.2"></times><ci id="S3.E10.m1.11.11.1.3.cmml" xref="S3.E10.m1.11.11.1.3">𝑝</ci><apply id="S3.E10.m1.11.11.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.11.11.1.1.1.1.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.2">conditional</csymbol><apply id="S3.E10.m1.11.11.1.1.1.1.3.cmml" xref="S3.E10.m1.11.11.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.1.1.3.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.11.11.1.1.1.1.3.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.3.2">𝐂</ci><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><ci id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3">:</ci><list id="S3.E10.m1.2.2.2.4.1.cmml" xref="S3.E10.m1.2.2.2.4.2"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">:</ci><cn type="integer" id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">2</cn></list><cn type="integer" id="S3.E10.m1.2.2.2.5.cmml" xref="S3.E10.m1.2.2.2.5">8</cn></apply></apply><list id="S3.E10.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1"><ci id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7">𝐱</ci><apply id="S3.E10.m1.8.8.cmml" xref="S3.E10.m1.8.8"><ci id="S3.E10.m1.8.8.1.cmml" xref="S3.E10.m1.8.8.1">~</ci><ci id="S3.E10.m1.8.8.2.cmml" xref="S3.E10.m1.8.8.2">𝐂</ci></apply><apply id="S3.E10.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3"><times id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.2">𝑁</ci><ci id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.3">𝐴</ci><ci id="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1.1.1.3.4">𝑅</ci></apply></apply></list></apply></apply><apply id="S3.E10.m1.12.12.2.cmml" xref="S3.E10.m1.12.12.2"><apply id="S3.E10.m1.12.12.2.2.cmml" xref="S3.E10.m1.12.12.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.12.12.2.2.1.cmml" xref="S3.E10.m1.12.12.2.2">superscript</csymbol><apply id="S3.E10.m1.12.12.2.2.2.cmml" xref="S3.E10.m1.12.12.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.12.12.2.2.2.1.cmml" xref="S3.E10.m1.12.12.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E10.m1.12.12.2.2.2.2.cmml" xref="S3.E10.m1.12.12.2.2.2.2">product</csymbol><apply id="S3.E10.m1.12.12.2.2.2.3.cmml" xref="S3.E10.m1.12.12.2.2.2.3"><eq id="S3.E10.m1.12.12.2.2.2.3.1.cmml" xref="S3.E10.m1.12.12.2.2.2.3.1"></eq><ci id="S3.E10.m1.12.12.2.2.2.3.2.cmml" xref="S3.E10.m1.12.12.2.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E10.m1.12.12.2.2.2.3.3.cmml" xref="S3.E10.m1.12.12.2.2.2.3.3">2</cn></apply></apply><cn type="integer" id="S3.E10.m1.12.12.2.2.3.cmml" xref="S3.E10.m1.12.12.2.2.3">8</cn></apply><apply id="S3.E10.m1.12.12.2.1.cmml" xref="S3.E10.m1.12.12.2.1"><times id="S3.E10.m1.12.12.2.1.2.cmml" xref="S3.E10.m1.12.12.2.1.2"></times><ci id="S3.E10.m1.12.12.2.1.3.cmml" xref="S3.E10.m1.12.12.2.1.3">𝑝</ci><apply id="S3.E10.m1.12.12.2.1.1.1.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.12.12.2.1.1.1.1.3.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.3">conditional</csymbol><apply id="S3.E10.m1.12.12.2.1.1.1.1.4.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.12.12.2.1.1.1.1.4.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.12.12.2.1.1.1.1.4.2.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.4.2">𝐶</ci><list id="S3.E10.m1.4.4.2.3.cmml" xref="S3.E10.m1.4.4.2.4"><ci id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1.1">:</ci><ci id="S3.E10.m1.4.4.2.2.cmml" xref="S3.E10.m1.4.4.2.2">𝑗</ci></list></apply><list id="S3.E10.m1.12.12.2.1.1.1.1.2.3.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2"><apply id="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.1.1.1.2">𝐂</ci><list id="S3.E10.m1.6.6.2.3.cmml" xref="S3.E10.m1.6.6.2.2"><ci id="S3.E10.m1.5.5.1.1.cmml" xref="S3.E10.m1.5.5.1.1">:</ci><apply id="S3.E10.m1.6.6.2.2.1.cmml" xref="S3.E10.m1.6.6.2.2.1"><lt id="S3.E10.m1.6.6.2.2.1.1.cmml" xref="S3.E10.m1.6.6.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E10.m1.6.6.2.2.1.2.cmml" xref="S3.E10.m1.6.6.2.2.1.2">absent</csymbol><ci id="S3.E10.m1.6.6.2.2.1.3.cmml" xref="S3.E10.m1.6.6.2.2.1.3">𝑗</ci></apply></list></apply><ci id="S3.E10.m1.9.9.cmml" xref="S3.E10.m1.9.9">𝐱</ci><apply id="S3.E10.m1.10.10.cmml" xref="S3.E10.m1.10.10"><ci id="S3.E10.m1.10.10.1.cmml" xref="S3.E10.m1.10.10.1">~</ci><ci id="S3.E10.m1.10.10.2.cmml" xref="S3.E10.m1.10.10.2">𝐂</ci></apply><apply id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3"><times id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.2">𝑁</ci><ci id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.3">𝐴</ci><ci id="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E10.m1.12.12.2.1.1.1.1.2.2.2.3.4">𝑅</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.12c">\displaystyle p(\mathbf{C}_{:,2:8}|\mathbf{x},\tilde{\mathbf{C}};\theta_{NAR})=\prod_{j=2}^{8}p(C_{:,j}|\mathbf{C}_{:,&lt;j},\mathbf{x},\tilde{\mathbf{C}};\theta_{NAR})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p1.8" class="ltx_p">Due to the causal (for speech tokens) or non-causal nature of the tasks, we solve the AR task with a Mamba decoder and the NAR task with a Mamba encoder model. We call this model VALL-M. We provide another model with a transformer decoder model for the AR task and a Mamba encoder model for the NAR task. We call this hybrid model VALL-ME.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.5.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Model configuration of all Mamba and transformer models. + 4 and + 6 means 4 or 6 additional Mamba or transformer decoder layers for encoder-decoder ASR. 12 + 12 means 12 layers for both AR and NAR language models for VALL-E, VALL-M, and VALL-ME. 
<br class="ltx_break"></figcaption>
<p id="S3.T1.3" class="ltx_p"><span id="S3.T1.3.3" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S3.T1.3.3.3.3" class="ltx_inline-block ltx_transformed_outer" style="width:388.9pt;height:234pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T1.3.3.3.3.3" class="ltx_p"><span id="S3.T1.3.3.3.3.3.3" class="ltx_text">
<span id="S3.T1.3.3.3.3.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S3.T1.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T1.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Model</span>
<span id="S3.T1.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Dimension <math id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.1.1.1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.1.1.1.1.m1.1c">D</annotation></semantics></math></span>
<span id="S3.T1.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"># Layers</span>
<span id="S3.T1.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Token Res (ms)</span>
<span id="S3.T1.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">#Tokens for 10s</span></span>
</span>
<span class="ltx_tbody">
<span id="S3.T1.2.2.2.2.2.2.2.2" class="ltx_tr">
<span id="S3.T1.2.2.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Sepformer</span>
<span id="S3.T1.2.2.2.2.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_tt">256</span>
<span id="S3.T1.2.2.2.2.2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_tt">16 <math id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1a"><mo id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.2.2.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1b"><times id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.2.2.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.2.2.2.2.1.m1.1c">\times</annotation></semantics></math> 2</span>
<span id="S3.T1.2.2.2.2.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_tt">1</span>
<span id="S3.T1.2.2.2.2.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt">10,000</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.4.1" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Mamba-TasNet (M)</span>
<span id="S3.T1.3.3.3.3.3.3.3.4.1.2" class="ltx_td ltx_align_center">256</span>
<span id="S3.T1.3.3.3.3.3.3.3.4.1.3" class="ltx_td ltx_align_center">32</span>
<span id="S3.T1.3.3.3.3.3.3.3.4.1.4" class="ltx_td ltx_align_center">1</span>
<span id="S3.T1.3.3.3.3.3.3.3.4.1.5" class="ltx_td ltx_align_center">10,000</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.5.2" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Mamba-TasNet (L)</span>
<span id="S3.T1.3.3.3.3.3.3.3.5.2.2" class="ltx_td ltx_align_center">512</span>
<span id="S3.T1.3.3.3.3.3.3.3.5.2.3" class="ltx_td ltx_align_center">32</span>
<span id="S3.T1.3.3.3.3.3.3.3.5.2.4" class="ltx_td ltx_align_center">1</span>
<span id="S3.T1.3.3.3.3.3.3.3.5.2.5" class="ltx_td ltx_align_center">10,000</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.6.3" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Conformer (S)</span>
<span id="S3.T1.3.3.3.3.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.6.3.2.1" class="ltx_text">144</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.6.3.3.1" class="ltx_text">12 + 4</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.6.3.4.1" class="ltx_text">40</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.6.3.5" class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.6.3.5.1" class="ltx_text">250</span></span></span>
<span id="S3.T1.3.3.3.3.3.3.3.7.4" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">ConMamba (S)</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.8.5" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Conformer (L)</span>
<span id="S3.T1.3.3.3.3.3.3.3.8.5.2" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.8.5.2.1" class="ltx_text">512</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.8.5.3" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.8.5.3.1" class="ltx_text">12 + 6</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.8.5.4" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.8.5.4.1" class="ltx_text">40</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.8.5.5" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.8.5.5.1" class="ltx_text">250</span></span></span>
<span id="S3.T1.3.3.3.3.3.3.3.9.6" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.9.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">ConMamba (L)</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.10.7" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.10.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Conformer (CTC)</span>
<span id="S3.T1.3.3.3.3.3.3.3.10.7.2" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.10.7.2.1" class="ltx_text">256</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.10.7.3" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.10.7.3.1" class="ltx_text">18</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.10.7.4" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.10.7.4.1" class="ltx_text">40</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.10.7.5" class="ltx_td ltx_align_center ltx_rowspan ltx_rowspan_2"><span id="S3.T1.3.3.3.3.3.3.3.10.7.5.1" class="ltx_text">250</span></span></span>
<span id="S3.T1.3.3.3.3.3.3.3.11.8" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.11.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">ConMamba (CTC)</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.3" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">VALL-E</span>
<span id="S3.T1.3.3.3.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_3"><span id="S3.T1.3.3.3.3.3.3.3.3.3.1" class="ltx_text">1024</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_3"><span id="S3.T1.3.3.3.3.3.3.3.3.4.1" class="ltx_text">12 + 12</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_3"><span id="S3.T1.3.3.3.3.3.3.3.3.1.1" class="ltx_text">13 <math id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\frac{1}{3}" display="inline"><semantics id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1a"><mfrac id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.cmml"><mn id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.2" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.2.cmml">1</mn><mn id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.3" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.3.cmml">3</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1b"><apply id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.cmml" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1"><divide id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.1.cmml" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1"></divide><cn type="integer" id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.2.cmml" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.2">1</cn><cn type="integer" id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.3.cmml" xref="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.3.3.3.3.3.1.1.m1.1c">\frac{1}{3}</annotation></semantics></math></span></span>
<span id="S3.T1.3.3.3.3.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_3"><span id="S3.T1.3.3.3.3.3.3.3.3.5.1" class="ltx_text">750</span></span></span>
</span>
<span class="ltx_tfoot">
<span id="S3.T1.3.3.3.3.3.3.3.12.1" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.12.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">VALL-M</span></span>
<span id="S3.T1.3.3.3.3.3.3.3.13.2" class="ltx_tr">
<span id="S3.T1.3.3.3.3.3.3.3.13.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">VALL-ME</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.2.1.1" class="ltx_text ltx_font_bold">Fig. 5</span>: </span>Comparisons of memory and speed for transformer and Mamba models in speech separation, recognition, and synthesis, with respect to speech inputs or outputs of different durations, benchmarked in an NVIDIA L40 GPU with 48GB memory.</figcaption>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.2.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Speech separation signal quality of Mamba-TasNet, DPMamba, and Sepformer on WSJ0-2mix test set.
<br class="ltx_break"></figcaption>
<p id="S3.T2.3" class="ltx_p"><span id="S3.T2.3.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S3.T2.3.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:354.2pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T2.3.1.1.1" class="ltx_p"><span id="S3.T2.3.1.1.1.1" class="ltx_text">
<span id="S3.T2.3.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S3.T2.3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Model</span>
<span id="S3.T2.3.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">SI-SNRi (dB)</span>
<span id="S3.T2.3.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">SDRi (dB)</span>
<span id="S3.T2.3.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">#Params (M)</span></span>
</span>
<span class="ltx_tbody">
<span id="S3.T2.3.1.1.1.1.1.2.1" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Sepformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite></span>
<span id="S3.T2.3.1.1.1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_tt">22.3</span>
<span id="S3.T2.3.1.1.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">22.4</span>
<span id="S3.T2.3.1.1.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt">25.7</span></span>
<span id="S3.T2.3.1.1.1.1.1.3.2" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">DPMamba (M) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite></span>
<span id="S3.T2.3.1.1.1.1.1.3.2.2" class="ltx_td ltx_align_center"><span id="S3.T2.3.1.1.1.1.1.3.2.2.1" class="ltx_text ltx_font_bold">22.6</span></span>
<span id="S3.T2.3.1.1.1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.3.1.1.1.1.1.3.2.3.1" class="ltx_text ltx_font_bold">22.7</span></span>
<span id="S3.T2.3.1.1.1.1.1.3.2.4" class="ltx_td ltx_align_center">15.9</span></span>
<span id="S3.T2.3.1.1.1.1.1.4.3" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S3.T2.3.1.1.1.1.1.4.3.1.1" class="ltx_text ltx_font_bold">Mamba-TasNet</span> (M)</span>
<span id="S3.T2.3.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_center">22.4</span>
<span id="S3.T2.3.1.1.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r">22.6</span>
<span id="S3.T2.3.1.1.1.1.1.4.3.4" class="ltx_td ltx_align_center">15.6</span></span>
<span id="S3.T2.3.1.1.1.1.1.5.4" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">QDPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite></span>
<span id="S3.T2.3.1.1.1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">23.6</span>
<span id="S3.T2.3.1.1.1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">n.r.</span>
<span id="S3.T2.3.1.1.1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">200</span></span>
<span id="S3.T2.3.1.1.1.1.1.6.5" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">DPMamba (L)</span>
<span id="S3.T2.3.1.1.1.1.1.6.5.2" class="ltx_td ltx_align_center">23.4</span>
<span id="S3.T2.3.1.1.1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r">23.6</span>
<span id="S3.T2.3.1.1.1.1.1.6.5.4" class="ltx_td ltx_align_center">59.8</span></span>
<span id="S3.T2.3.1.1.1.1.1.7.6" class="ltx_tr">
<span id="S3.T2.3.1.1.1.1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S3.T2.3.1.1.1.1.1.7.6.1.1" class="ltx_text ltx_font_bold">Mamba-TasNet</span> (L)</span>
<span id="S3.T2.3.1.1.1.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.3.1.1.1.1.1.7.6.2.1" class="ltx_text ltx_font_bold">23.7</span></span>
<span id="S3.T2.3.1.1.1.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T2.3.1.1.1.1.1.7.6.3.1" class="ltx_text ltx_font_bold">23.8</span></span>
<span id="S3.T2.3.1.1.1.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb">59.6</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T3.2.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>Speech recognition WER (%) of ConMamba and Conformer on LibriSpeech test sets.
<br class="ltx_break"></figcaption>
<p id="S3.T3.3" class="ltx_p"><span id="S3.T3.3.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S3.T3.3.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:455.9pt;height:306pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T3.3.1.1.1" class="ltx_p"><span id="S3.T3.3.1.1.1.1" class="ltx_text">
<span id="S3.T3.3.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span class="ltx_tbody">
<span id="S3.T3.3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Model</span>
<span id="S3.T3.3.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Encoder</span>
<span id="S3.T3.3.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Decoder</span>
<span id="S3.T3.3.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">test-clean</span>
<span id="S3.T3.3.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">test-other</span>
<span id="S3.T3.3.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">#Params (M)</span></span>
<span id="S3.T3.3.1.1.1.1.1.2.2" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_6"><span id="S3.T3.3.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_italic">without LM</span></span></span>
<span id="S3.T3.3.1.1.1.1.1.3.3" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Conformer (S) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite></span>
<span id="S3.T3.3.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">Conformer</span>
<span id="S3.T3.3.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">4.1</span>
<span id="S3.T3.3.1.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.0</span>
<span id="S3.T3.3.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">13.3</span></span>
<span id="S3.T3.3.1.1.1.1.1.4.4" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_rowspan ltx_rowspan_2"><span id="S3.T3.3.1.1.1.1.1.4.4.1.1" class="ltx_text"><span id="S3.T3.3.1.1.1.1.1.4.4.1.1.1" class="ltx_text ltx_font_bold">ConMamba</span> (S)</span></span>
<span id="S3.T3.3.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center"><span id="S3.T3.3.1.1.1.1.1.4.4.4.1" class="ltx_text ltx_font_bold">4.0</span></span>
<span id="S3.T3.3.1.1.1.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.3.1.1.1.1.1.4.4.5.1" class="ltx_text ltx_font_bold">9.5</span></span>
<span id="S3.T3.3.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center">14.1</span></span>
<span id="S3.T3.3.1.1.1.1.1.5.5" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.5.5.1" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">Mamba</span>
<span id="S3.T3.3.1.1.1.1.1.5.5.3" class="ltx_td ltx_align_center"><span id="S3.T3.3.1.1.1.1.1.5.5.3.1" class="ltx_text ltx_font_bold">4.0</span></span>
<span id="S3.T3.3.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">9.7</span>
<span id="S3.T3.3.1.1.1.1.1.5.5.5" class="ltx_td ltx_align_center">15.0</span></span>
<span id="S3.T3.3.1.1.1.1.1.6.6" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.6.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Conformer (L)</span>
<span id="S3.T3.3.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">Conformer</span>
<span id="S3.T3.3.1.1.1.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.1.1.1.6.6.4.1" class="ltx_text ltx_font_bold">2.6</span></span>
<span id="S3.T3.3.1.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.3.1.1.1.1.1.6.6.5.1" class="ltx_text ltx_font_bold">6.7</span></span>
<span id="S3.T3.3.1.1.1.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t">109.1</span></span>
<span id="S3.T3.3.1.1.1.1.1.7.7" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_rowspan ltx_rowspan_2"><span id="S3.T3.3.1.1.1.1.1.7.7.1.1" class="ltx_text"><span id="S3.T3.3.1.1.1.1.1.7.7.1.1.1" class="ltx_text ltx_font_bold">ConMamba</span> (L)</span></span>
<span id="S3.T3.3.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">2.8</span>
<span id="S3.T3.3.1.1.1.1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.3.1.1.1.1.1.7.7.5.1" class="ltx_text ltx_font_bold">6.7</span></span>
<span id="S3.T3.3.1.1.1.1.1.7.7.6" class="ltx_td ltx_align_center">115.2</span></span>
<span id="S3.T3.3.1.1.1.1.1.8.8" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.8.8.1" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r">Mamba</span>
<span id="S3.T3.3.1.1.1.1.1.8.8.3" class="ltx_td ltx_align_center">3.0</span>
<span id="S3.T3.3.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r">7.0</span>
<span id="S3.T3.3.1.1.1.1.1.8.8.5" class="ltx_td ltx_align_center">122.9</span></span>
<span id="S3.T3.3.1.1.1.1.1.9.9" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.9.9.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Conformer (CTC)</span>
<span id="S3.T3.3.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_colspan ltx_colspan_2">Conformer Encoder Only</span>
<span id="S3.T3.3.1.1.1.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_t">4.3</span>
<span id="S3.T3.3.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.3</span>
<span id="S3.T3.3.1.1.1.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">28.8</span></span>
<span id="S3.T3.3.1.1.1.1.1.10.10" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.3.1.1.1.1.1.10.10.1.1" class="ltx_text ltx_font_bold">ConMamba</span> (CTC)</span>
<span id="S3.T3.3.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_colspan ltx_colspan_2">ConMamba Encoder Only</span>
<span id="S3.T3.3.1.1.1.1.1.10.10.3" class="ltx_td ltx_align_center"><span id="S3.T3.3.1.1.1.1.1.10.10.3.1" class="ltx_text ltx_font_bold">3.9</span></span>
<span id="S3.T3.3.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.3.1.1.1.1.1.10.10.4.1" class="ltx_text ltx_font_bold">10.3</span></span>
<span id="S3.T3.3.1.1.1.1.1.10.10.5" class="ltx_td ltx_align_center">31.6</span></span>
<span id="S3.T3.3.1.1.1.1.1.11.11" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.11.11.1" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_6"><span id="S3.T3.3.1.1.1.1.1.11.11.1.1" class="ltx_text ltx_font_italic">with LM</span></span></span>
<span id="S3.T3.3.1.1.1.1.1.12.12" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.12.12.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Conformer (S)</span>
<span id="S3.T3.3.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_t">Conformer</span>
<span id="S3.T3.3.1.1.1.1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_t">2.5</span>
<span id="S3.T3.3.1.1.1.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.1</span>
<span id="S3.T3.3.1.1.1.1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_t">13.3</span></span>
<span id="S3.T3.3.1.1.1.1.1.13.13" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.13.13.1" class="ltx_td ltx_align_center ltx_border_r ltx_rowspan ltx_rowspan_2"><span id="S3.T3.3.1.1.1.1.1.13.13.1.1" class="ltx_text"><span id="S3.T3.3.1.1.1.1.1.13.13.1.1.1" class="ltx_text ltx_font_bold">ConMamba</span> (S)</span></span>
<span id="S3.T3.3.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_r">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center"><span id="S3.T3.3.1.1.1.1.1.13.13.4.1" class="ltx_text ltx_font_bold">2.4</span></span>
<span id="S3.T3.3.1.1.1.1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.3.1.1.1.1.1.13.13.5.1" class="ltx_text ltx_font_bold">5.8</span></span>
<span id="S3.T3.3.1.1.1.1.1.13.13.6" class="ltx_td ltx_align_center">14.1</span></span>
<span id="S3.T3.3.1.1.1.1.1.14.14" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.14.14.1" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_r">Mamba</span>
<span id="S3.T3.3.1.1.1.1.1.14.14.3" class="ltx_td ltx_align_center">2.5</span>
<span id="S3.T3.3.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_r">6.5</span>
<span id="S3.T3.3.1.1.1.1.1.14.14.5" class="ltx_td ltx_align_center">15.0</span></span>
<span id="S3.T3.3.1.1.1.1.1.15.15" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.15.15.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Conformer (L)</span>
<span id="S3.T3.3.1.1.1.1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_t">Conformer</span>
<span id="S3.T3.3.1.1.1.1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.1.1.1.15.15.4.1" class="ltx_text ltx_font_bold">2.0</span></span>
<span id="S3.T3.3.1.1.1.1.1.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.3.1.1.1.1.1.15.15.5.1" class="ltx_text ltx_font_bold">4.5</span></span>
<span id="S3.T3.3.1.1.1.1.1.15.15.6" class="ltx_td ltx_align_center ltx_border_t">109.1</span></span>
<span id="S3.T3.3.1.1.1.1.1.16.16" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.16.16.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_rowspan ltx_rowspan_2"><span id="S3.T3.3.1.1.1.1.1.16.16.1.1" class="ltx_text"><span id="S3.T3.3.1.1.1.1.1.16.16.1.1.1" class="ltx_text ltx_font_bold">ConMamba</span> (L)</span></span>
<span id="S3.T3.3.1.1.1.1.1.16.16.2" class="ltx_td ltx_align_center">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.16.16.3" class="ltx_td ltx_align_center ltx_border_r">Transformer</span>
<span id="S3.T3.3.1.1.1.1.1.16.16.4" class="ltx_td ltx_align_center">2.1</span>
<span id="S3.T3.3.1.1.1.1.1.16.16.5" class="ltx_td ltx_align_center ltx_border_r">4.9</span>
<span id="S3.T3.3.1.1.1.1.1.16.16.6" class="ltx_td ltx_align_center">115.2</span></span>
<span id="S3.T3.3.1.1.1.1.1.17.17" class="ltx_tr">
<span id="S3.T3.3.1.1.1.1.1.17.17.1" class="ltx_td ltx_align_center ltx_border_bb">ConMamba</span>
<span id="S3.T3.3.1.1.1.1.1.17.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">Mamba</span>
<span id="S3.T3.3.1.1.1.1.1.17.17.3" class="ltx_td ltx_align_center ltx_border_bb">2.4</span>
<span id="S3.T3.3.1.1.1.1.1.17.17.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">5.7</span>
<span id="S3.T3.3.1.1.1.1.1.17.17.5" class="ltx_td ltx_align_center ltx_border_bb">122.9</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T4.2.1.1" class="ltx_text ltx_font_bold">Table 4</span>: </span>Speech synthesis subjective evaluation of VALL-M and VALL-ME against VALL-E. 
<br class="ltx_break"></figcaption>
<p id="S3.T4.3" class="ltx_p"><span id="S3.T4.3.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S3.T4.3.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:403.5pt;height:72pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T4.3.1.1.1" class="ltx_p"><span id="S3.T4.3.1.1.1.1" class="ltx_text">
<span id="S3.T4.3.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S3.T4.3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T4.3.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Model</span>
<span id="S3.T4.3.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">AR</span>
<span id="S3.T4.3.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">NAR</span>
<span id="S3.T4.3.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CMOS-N</span>
<span id="S3.T4.3.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">CMOS-S</span>
<span id="S3.T4.3.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">#Params (M)</span></span>
</span>
<span class="ltx_tbody">
<span id="S3.T4.3.1.1.1.1.1.2.1" class="ltx_tr">
<span id="S3.T4.3.1.1.1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">VALL-E <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite></span>
<span id="S3.T4.3.1.1.1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_tt">Transformer</span>
<span id="S3.T4.3.1.1.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Transformer</span>
<span id="S3.T4.3.1.1.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.3.1.1.1.1.1.2.1.4.1" class="ltx_text ltx_font_bold">0.00</span></span>
<span id="S3.T4.3.1.1.1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.00</span>
<span id="S3.T4.3.1.1.1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_tt">367.5</span></span>
<span id="S3.T4.3.1.1.1.1.1.3.2" class="ltx_tr">
<span id="S3.T4.3.1.1.1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T4.3.1.1.1.1.1.3.2.1.1" class="ltx_text ltx_font_bold">VALL-M</span></span>
<span id="S3.T4.3.1.1.1.1.1.3.2.2" class="ltx_td ltx_align_center">Mamba</span>
<span id="S3.T4.3.1.1.1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">Mamba</span>
<span id="S3.T4.3.1.1.1.1.1.3.2.4" class="ltx_td ltx_align_center">-0.41</span>
<span id="S3.T4.3.1.1.1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r">-0.25</span>
<span id="S3.T4.3.1.1.1.1.1.3.2.6" class="ltx_td ltx_align_center">431.1</span></span>
<span id="S3.T4.3.1.1.1.1.1.4.3" class="ltx_tr">
<span id="S3.T4.3.1.1.1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T4.3.1.1.1.1.1.4.3.1.1" class="ltx_text ltx_font_bold">VALL-ME</span></span>
<span id="S3.T4.3.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">Transformer</span>
<span id="S3.T4.3.1.1.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">Mamba</span>
<span id="S3.T4.3.1.1.1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">-0.01</span>
<span id="S3.T4.3.1.1.1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T4.3.1.1.1.1.1.4.3.5.1" class="ltx_text ltx_font_bold">0.20</span></span>
<span id="S3.T4.3.1.1.1.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_bb">401.5</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Models</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We implemented Mamba-TasNet, ConMamba, and VALL-M of the same dimension and number of layers as their transformer counterparts, as documented in Table.<a href="#S3.T1" title="Table 1 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Token resolution refers to the duration of a speech token that makes up the input sequence to the transformer or Mamba layers, equal to the total downsampling stride of the feature extractor and CNN frontend divided by the sampling rate. Separation models have the smallest token resolution of 1 ms to reconstruct the waveform perfectly. Recognition models have the largest token resolution of 40 ms, barely smaller than the duration of a letter or phoneme to recognize. Token resolution is inversely proportional to the number of tokens for a given speech length, leading to differences in speed and memory usage across models. We will discuss the effect of it later.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Training and Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We trained all models with the same optimizer, learning rate, number of epochs, and data augmentation as the existing transformer receipts<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>
Sepformer:<a target="_blank" href="https://github.com/speechbrain/speechbrain/blob/develop/recipes/WSJ0Mix/separation/hparams/sepformer.yaml" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/speechbrain/speechbrain/blob/develop/recipes/WSJ0Mix/separation/hparams/sepformer.yaml</a></span></span></span>
<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>
Conformer:<a target="_blank" href="https://github.com/speechbrain/speechbrain/blob/develop/recipes/LibriSpeech/ASR/transformer/hparams/conformer_large.yaml" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/speechbrain/speechbrain/blob/develop/recipes/LibriSpeech/ASR/transformer/hparams/conformer_large.yaml</a></span></span></span>
<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>
VALL-E:<a target="_blank" href="https://github.com/lifeiteng/vall-e" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/lifeiteng/vall-e</a>
</span></span></span>.
Mamba-TasNet (M, L) were trained with a cosine decay scheduler following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, and Mamba-TasNet (L) was trained with a lower learning rate of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="1.0e^{-4}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">1.0</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">​</mo><msup id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS2.p1.1.m1.1.1.3.3a" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p1.1.m1.1.1.3.3.2" xref="S4.SS2.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></times><cn type="float" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">1.0</cn><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">𝑒</ci><apply id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3"><minus id="S4.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">1.0e^{-4}</annotation></semantics></math> for loss stability <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Following convention, we trained Mamba-TasNet on WSJ0-2mix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, ConMamba on LibriSpeech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, and VALL-M on LibriTTS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Mamba-TasNet (M, L) and ConMamba (S, L) were trained on one NVIDIA L40. ConMamba (CTC) was trained on four A40s. VALL-M was trained on four L40s. Conformer (CTC) and VALL-E were reproduced on the same dataset and hardware. We evaluated separation models by the improvement of signal-to-distortion ratio (SDRi) and scale-invariant signal-to-noise ratio (SI-SDRi) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, ASR models by word error rate (WER) with or without an external pre-trained language model (with a small beam of 10 samples), and TTS models by comparative mean opinion score of speech naturalness and speaker similarity (CMOS-N and CMOS-S, with a scale of -6 to 6) compared to VALL-E.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Performance</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We report the performance of Mamba-TasNet, ConMamba, and VALL-M &amp; VALL-ME in Table.<a href="#S3.T2" title="Table 2 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S3.T3" title="Table 3 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and <a href="#S3.T4" title="Table 4 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, compared to transformer models Sepformer, Conformer and VALL-E. For separation, we also compare with an earlier dual-path Mamba model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Mamba-TasNet (M) achieves a slightly higher performance than Sepformer in both SI-SNRi (+0.1dB) and SDRi (+0.2dB) despite with the same number of layers, Mamba-TasNet is 40% smaller than Sepformer. Mamba-TasNet (M) is slightly worse than DPMamba (M), but when doubling the feature dimension from 256 to 512, Mamba-TasNet (L) outperforms both DPMamba (L) and QDPN, a transformer model more than three times larger. For ASR, the ConMamba encoder-only and the ConMamba encoder-transformer decoder model (S) outperform the Conformer encoder-only or the Conformer encoder-transformer decoder model (S) with a 1.0 and 0.5 lower WER on test-other without LM. In (L) size, the ConMamba encoder slightly loses to the ConMamba encoder, both with a transformer decoder. Fixing the ConMamba encoder, the Mamba decoder performs slightly worse than the transformer decoder in both (S) and (L) sizes. For TTS, we observe a similar result. The Mamba AR and Mamba NAR model VALL-M is worse than VALL-E, particularly regarding speech naturalness (-0.41). However, the transformer AR and Mamba NAR model VALL-ME receive a comparable (-0.01) score in naturalness and a higher (+0.20) score in similarity than VALL-E.

<br class="ltx_break">In summary, the Mamba encoders perform on par or better than transformer encoders in separation, ConMamba encoders, and NAR LM, but the Mamba decoders perform slightly worse than transformer decoders as ASR decoders and AR LM.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Efficiency</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We benchmark the memory and speed of both Mamba and transformer models in all three tasks in Fig.<a href="#S3.F5" title="Figure 5 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. For separation and ASR, the memory and processing time are averaged for different input speech durations. For TTS, we plot the memory and time of all samples we benchmark since we cannot control the exact duration of the output speech.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">Memory</span> usage is smaller for Mamba-TasNet (M) than Sepformer in all speech durations. ConMamba and VALL-M have similar memory usage to Conformer and VALL-E until around 30 and 15 seconds, respectively. After, the memory for Conformer and VALL-E increases quadratically, while the memory for ConMamba and VALL-M increases linearly with a gentle slope. After 4 seconds, Mamba-TasNet (L) also consumes less memory than Sepformer, although the former is twice as large as the latter.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_bold">Speed</span> follows a similar pattern as memory. Mamba-TasNet (M) is faster than Sepformer for all durations. Mamba-TasNet (L) catches up with Sepformer after 12 seconds. ConMamba and VALL-M are faster than Conformer and VALL-E after 60 and 15 seconds, respectively.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion and Limitation</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We remark on the performance and efficiency of Mamba following the results. First, bidirectional Mamba challenges self-attention in performance. We get similar or better scores when replacing the transformer encoder layers in separation, Conformer encoder, and NAR LM with Mamba encoder layers. However, Mamba loses to cross- or masked attention for multimodal data: encoder acoustic features and decoder textual features for ASR and text prompts and speaker enrollment for TTS. The performance gap might be due to the gap in modeling power: Cross- or masked attention is not strictly causal in processing the keys or the unmasked part of the sequence, but Mamba in decoders processes the entire concatenated sequence, including the encoder’s keys or the phoneme sequence, unidirectionally. Efficiency-wise, we observe Mamba is more efficient for long speech sequences than transformers. Referring to Table <a href="#S3.T1" title="Table 1 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we observe Mamba is most efficient for time-domain separation, where each token lasts 1 ms, and least for ASR, where each token lasts 40 ms. Figure <a href="#S3.F5" title="Figure 5 ‣ 3.2.3 VALL-M ‣ 3.2 Models ‣ 3 Methods ‣ Speech Slytherin: Examining the Performance and Efficiency of Mamba for Speech Separation, Recognition, and Synthesis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows ConMamba is not significantly more efficient than Conformer until 30 seconds for memory or 60 seconds for speed. Finally, we want to emphasize that this early study focuses on the vanilla transformer and Mamba architecture. We are not aiming for the best performance and efficiency with modified architecture. It is also possible that Mamba could be implemented more efficiently with better hardware and improved algorithms in the future. We hope our results and analysis can provide insights into the application of Mamba for different speech-processing scenarios.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work presents Mamba-TasNet for separation, ConMamba for ASR, and VALL-M and VALL-ME for TTS. We demonstrate their comparable or higher performance and better efficiency in long speech than transformers. We observe this efficiency is inversely related to the resolution of a speech token. Mamba-TasNet is more efficient than Sepformer in all durations, while VALL-M and ConMamba are more efficient for durations of 15 seconds or longer. We conclude by discussing favorable use cases for Mamba in tasks requiring high speech resolution and its limitations, including joint modeling of multimodal data such as text and speech.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>ACKNOWLEDGMENT</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">This work is funded by the National Institutes of Health (NIH- NIDCD) and a grant from Marie-Josee and Henry R. Kravis.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber,

</span>
<span class="ltx_bibblock">“Long short-term memory,”

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Neural Computation</span>, vol. 9, no. 8, pp. 1735–1780, 1997.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, <span id="bib.bib2.1.1" class="ltx_text ltx_font_caligraphic">L</span>ukasz Kaiser, and Illia Polosukhin,

</span>
<span class="ltx_bibblock">“Attention is all you need,”

</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao,

</span>
<span class="ltx_bibblock">“Mamba: Linear-time sequence modeling with selective state spaces,”

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2312.00752</span>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Lianghui Zhu, Bencheng Liao, Qian Zhang, Xinlong Wang, Wenyu Liu, and Xinggang Wang,

</span>
<span class="ltx_bibblock">“Vision mamba: Efficient visual representation learning with bidirectional state space model,”

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2401.09417</span>, 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Changsheng Quan and Xiaofei Li,

</span>
<span class="ltx_bibblock">“Multichannel long-term streaming neural speech enhancement for static and moving speakers,”

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2403.07675</span>, 2024.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Xilin Jiang, Cong Han, and Nima Mesgarani,

</span>
<span class="ltx_bibblock">“Dual-path mamba: Short and long-term bidirectional selective structured state space models for speech separation,”

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2403.18257</span>, 2024.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Mehmet Hamza Erol, Arda Senocak, Jiu Feng, and Joon Son Chung,

</span>
<span class="ltx_bibblock">“Audio mamba: Bidirectional state space model for audio representation learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2406.03344</span>, 2024.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Roger Waleffe, Wonmin Byeon, Duncan Riach, Brandon Norick, Vijay Korthikanti, Tri Dao, Albert Gu, Ali Hatamizadeh, Sudhakar Singh, Deepak Narayanan, Garvit Kulshreshtha, Vartika Singh, Jared Casper, Jan Kautz, Mohammad Shoeybi, and Bryan Catanzaro,

</span>
<span class="ltx_bibblock">“An empirical study of mamba-based language models,” 2024.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Rui Xu, Shu Yang, Yihui Wang, Bo Du, and Hao Chen,

</span>
<span class="ltx_bibblock">“A survey on vision mamba: Models, applications and challenges,”

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2404.18861</span>, 2024.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Yijun Yang, Zhaohu Xing, and Lei Zhu,

</span>
<span class="ltx_bibblock">“Vivim: a video vision mamba for medical video object segmentation,”

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2401.14168</span>, 2024.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Guo Chen, Yifei Huang, Jilan Xu, Baoqi Pei, Zhe Chen, Zhiqi Li, Jiahao Wang, Kunchang Li, Tong Lu, and Limin Wang,

</span>
<span class="ltx_bibblock">“Video mamba suite: State space model as a versatile alternative for video understanding,”

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2403.09626</span>, 2024.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Jun Ma, Feifei Li, and Bo Wang,

</span>
<span class="ltx_bibblock">“U-mamba: Enhancing long-range dependency for biomedical image segmentation,”

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2401.04722</span>, 2024.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Rong Chao, Wen-Huang Cheng, Moreno La Quatra, Sabato Marco Siniscalchi, Chao-Han Huck Yang, Szu-Wei Fu, and Yu Tsao,

</span>
<span class="ltx_bibblock">“An investigation of incorporating mamba for speech enhancement,”

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2405.06573</span>, 2024.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Yueyuan Sui, Minghui Zhao, Junxi Xia, Xiaofan Jiang, and Stephen Xia,

</span>
<span class="ltx_bibblock">“Tramba: A hybrid transformer and mamba architecture for practical audio and bone conduction speech super resolution and enhancement on mobile and wearable platforms,”

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2405.01242</span>, 2024.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Kai Li and Guo Chen,

</span>
<span class="ltx_bibblock">“Spmamba: State-space model is all you need in speech separation,”

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2404.02063</span>, 2024.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Yujie Chen, Jiangyan Yi, Jun Xue, Chenglong Wang, Xiaohui Zhang, Shunbo Dong, Siding Zeng, Jianhua Tao, Lv Zhao, and Cunhang Fan,

</span>
<span class="ltx_bibblock">“Rawbmamba: End-to-end bidirectional state space model for audio deepfake detection,”

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2406.06086</span>, 2024.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jiaju Lin and Haoxuan Hu,

</span>
<span class="ltx_bibblock">“Audio mamba: Pretrained audio state space model for audio tagging,”

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2405.13636</span>, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Sarthak Yadav and Zheng-Hua Tan,

</span>
<span class="ltx_bibblock">“Audio mamba: Selective state spaces for self-supervised audio representations,”

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2406.02178</span>, 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Siavash Shams, Sukru Samet Dindar, Xilin Jiang, and Nima Mesgarani,

</span>
<span class="ltx_bibblock">“Ssamba: Self-supervised audio representation learning with mamba state space model,”

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2405.11831</span>, 2024.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Xiangyu Zhang, Qiquan Zhang, Hexin Liu, Tianyi Xiao, Xinyuan Qian, Beena Ahmed, Eliathamby Ambikairajah, Haizhou Li, and Julien Epps,

</span>
<span class="ltx_bibblock">“Mamba in speech: Towards an alternative to self-attention,”

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2405.12609</span>, 2024.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Koichi Miyazaki, Yoshiki Masuyama, and Masato Murata,

</span>
<span class="ltx_bibblock">“Exploring the capability of mamba in speech applications,”

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2406.16808</span>, 2024.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Opher Lieber, Barak Lenz, Hofit Bata, Gal Cohen, Jhonathan Osin, Itay Dalmedigos, Erez Safahi, Shaked Meirom, Yonatan Belinkov, Shai Shalev-Shwartz, et al.,

</span>
<span class="ltx_bibblock">“Jamba: A hybrid transformer-mamba language model,”

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2403.19887</span>, 2024.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Yi Luo and Nima Mesgarani,

</span>
<span class="ltx_bibblock">“Conv-tasnet: Surpassing ideal time–frequency magnitude masking for speech separation,”

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">IEEE/ACM transactions on audio, speech, and language processing</span>, vol. 27, no. 8, pp. 1256–1266, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Yi Luo, Zhuo Chen, and Takuya Yoshioka,

</span>
<span class="ltx_bibblock">“Dual-path rnn: efficient long sequence modeling for time-domain single-channel speech separation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>. IEEE, 2020, pp. 46–50.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Jingjing Chen, Qirong Mao, and Dong Liu,

</span>
<span class="ltx_bibblock">“Dual-Path Transformer Network: Direct Context-Aware Modeling for End-to-End Monaural Speech Separation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech 2020</span>, 2020, pp. 2642–2646.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Cem Subakan, Mirco Ravanelli, Samuele Cornell, Mirko Bronzi, and Jianyuan Zhong,

</span>
<span class="ltx_bibblock">“Attention is all you need in speech separation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">ICASSP 2021-2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>. IEEE, 2021, pp. 21–25.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Shengkui Zhao and Bin Ma,

</span>
<span class="ltx_bibblock">“Mossformer: Pushing the performance limit of monaural speech separation using gated single-head transformer with convolution-augmented joint self-attentions,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">ICASSP 2023-2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>. IEEE, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Anmol Gulati, James Qin, Chung-Cheng Chiu, Niki Parmar, Yu Zhang, Jiahui Yu, Wei Han, Shibo Wang, Zhengdong Zhang, Yonghui Wu, and Ruoming Pang,

</span>
<span class="ltx_bibblock">“Conformer: Convolution-augmented Transformer for Speech Recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech 2020</span>, 2020, pp. 5036–5040.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Chengyi Wang, Sanyuan Chen, Yu Wu, Ziqiang Zhang, Long Zhou, Shujie Liu, Zhuo Chen, Yanqing Liu, Huaming Wang, Jinyu Li, et al.,

</span>
<span class="ltx_bibblock">“Neural codec language models are zero-shot text to speech synthesizers,”

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2301.02111</span>, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Alexandre Défossez, Jade Copet, Gabriel Synnaeve, and Yossi Adi,

</span>
<span class="ltx_bibblock">“High fidelity neural audio compression,”

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2210.13438</span>, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Joel Rixen and Matthias Renz,

</span>
<span class="ltx_bibblock">“QDPN - Quasi-dual-path Network for single-channel Speech Separation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech 2022</span>, 2022, pp. 5353–5357.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
John R Hershey, Zhuo Chen, Jonathan Le Roux, and Shinji Watanabe,

</span>
<span class="ltx_bibblock">“Deep clustering: Discriminative embeddings for segmentation and separation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">2016 IEEE international conference on acoustics, speech and signal processing (ICASSP)</span>. IEEE, 2016, pp. 31–35.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Vassil Panayotov, Guoguo Chen, Daniel Povey, and Sanjeev Khudanpur,

</span>
<span class="ltx_bibblock">“Librispeech: An asr corpus based on public domain audio books,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">2015 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>, 2015, pp. 5206–5210.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Heiga Zen, Viet Dang, Robert A. J. Clark, Yu Zhang, Ron J. Weiss, Ye Jia, Z. Chen, and Yonghui Wu,

</span>
<span class="ltx_bibblock">“Libritts: A corpus derived from librispeech for text-to-speech,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Interspeech</span>, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Jonathan Le Roux, Scott Wisdom, Hakan Erdogan, and John R Hershey,

</span>
<span class="ltx_bibblock">“Sdr–half-baked or well done?,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">ICASSP 2019-2019 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>. IEEE, 2019, pp. 626–630.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.09731" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.09732" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.09732">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.09732" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.09733" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 13:49:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
