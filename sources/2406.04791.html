<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.04791] Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR</title><meta property="og:description" content="Despite recent improvements in End-to-End Automatic Speech Recognition (E2E ASR) systems, the performance can degrade due to vocal characteristic mismatches between training and testing data, particularly with limited …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.04791">

<!--Generated on Fri Jul  5 19:43:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">[]ShaojunLi
<span id="p1.3.1" class="ltx_ERROR undefined">\name</span>[]DaimengWei
<span id="p1.3.2" class="ltx_ERROR undefined">\name</span>[]HengchaoShang
<span id="p1.3.3" class="ltx_ERROR undefined">\name</span>[]JiaxinGUO
<span id="p1.3.4" class="ltx_ERROR undefined">\name</span>[]ZongYaoLI
<span id="p1.3.5" class="ltx_ERROR undefined">\name</span>[]ZhanglinWu
<span id="p1.3.6" class="ltx_ERROR undefined">\name</span>[]ZhiqiangRao
<span id="p1.3.7" class="ltx_ERROR undefined">\name</span>[]YuanchangLuo
<span id="p1.3.8" class="ltx_ERROR undefined">\name</span>[]XianghuiHe
<span id="p1.3.9" class="ltx_ERROR undefined">\name</span>[]HaoYang




</p>
</div>
<h1 class="ltx_title ltx_title_document">Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Despite recent improvements in End-to-End Automatic Speech Recognition (E2E ASR) systems, the performance can degrade due to vocal characteristic mismatches between training and testing data, particularly with limited target speaker adaptation data. We propose a novel speaker adaptation approach Speaker-Smoothed kNN that leverages k-Nearest Neighbors (kNN) retrieval techniques to improve model output by finding correctly pronounced tokens from its pre-built datastore during the decoding phase. Moreover, we utilize x-vector to dynamically adjust kNN interpolation parameters for data sparsity issue. This approach was validated using KeSpeech and MagicData corpora under in-domain and all-domain settings. Our method consistently performs comparably to fine-tuning without the associated performance degradation during speaker changes. Furthermore, in the all-domain setting, our method achieves state-of-the-art results, reducing the CER in both single speaker and multi-speaker test scenarios.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>speech recognition, speaker adaptation, k-nearest neighbors
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recently, end-to-end automatic speech recognition (E2E ASR) systems have demonstrated considerable performance improvements, aided by extensive training data amassed from a variety of speakers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Despite these advancements, the performance of E2E systems can plummet dramatically when confronted with significant voice character mismatch between training and testing conditions. In response to this issue, speaker adaptation algorithms seek to rectify the aforementioned mismatch by tailoring the ASR model to fit the specific characteristics of the target speaker.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The biggest challenge of speaker adaptation is that the adaptation data amount from the target speaker is usually very small. There are two types of methods to address such a challenge.
The first type is model-based method, it studies how to effectively utilize few-shot speaker data. Some methods directly fine-tune the parameters of the pre-trained model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, or train the model from speaker-independent parameters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. To alleviate the overfitting problem caused by the limited adaptation data, the L2 norm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, Kullback–Leibler divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> are introduced to regularize the adapted model. There are also many approaches utilizing data augmentation, for example, generating speaker data via TTS to augment the model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. However, most of these methods potentially suffer from significant performance drops when the amount of adaptation data decreases.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The second type is feature-based method, in which auxiliary speaker embeddings, such as i-vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and x-vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, are fed into an ASR model along with speech features.
In this way, the model is working on the acoustic features, i.e. either by normalizing acoustic features to be speaker-independent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> or by introducing additional speaker related knowledge (e.g., i-vector) to adapt the acoustic model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. A summary vector of each utterance can be trained to replace speaker i-vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. To adapt to acoustic variability <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, shifting and scaling parameters are added in the layer-normalization layer. Recently, the attention mechanism is introduced to speaker-aware training (SAT). Typically, a speaker-aware persistent memory is incorporated to the transformer based ASR model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. These memories performance always hit a bottleneck with the limited capacity of tens or hundreds of speaker embedding search space.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.2" class="ltx_p">Considering the large size of E2E ASR training set, there may be utterances of similar voice characters as that of the target speaker. Thus, it is reasonable to utilize the similar utterances to be a supplement for target speaker data in the adaptation process. Motivated by this idea, we introduce a kNN retrieval techniques to ASR model which initially proposed for regulating autoregressive decoding (AD) of language model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. We expect this kNN classifier to find the correctly pronounced token from its pre-built datastore at each decoding to correct the model's erroneous output. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> modified kNN to apply to frame-level CTC decoding, but lacked further research on AD and the risk of false recall when data is sparse in kNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Therefore, we firstly explore the effectiveness of kNN token-level representation. It was found that there may be some problems when speaker adaptation is used directly on kNN, because kNN has the fixed interpolation parameters, <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">T</annotation></semantics></math> and <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\lambda</annotation></semantics></math>. To solve this problem, we propose a Speaker-Smoothed kNN network, which uses extra information such as x-vector to dynamically adjust the interpolation ratio. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> uses few-shot speaker data to extract similar pronunciations from training data, which is similar to our idea. However, this training method only uses utterance level information and re-training is required when the speaker is switched.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We test proposed Speaker-Smoothed kNN using KeSpeech and MagicData copora with in-domain and all-domain settings. In the in-domain setting, our method performs close to fine-tuning without experiencing performance degradation like fine-tune and kNN method when the speaker changes. In the all-domain setting, our method achieves sota in both single speaker and speaker change scenarios, reduce 12.35 and 24.68 CER on the single speaker and multi-speaker test sets respectively.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Here we give a brief introduction of kNN method. kNN uses token-level context retrieval to enhance the quality of a pre-trained neural machine translation (NMT) model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. This method includes two steps:</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.6" class="ltx_p"><span id="S2.p2.6.1" class="ltx_text ltx_font_bold">Datastore Construction</span> The datastore is a translation memory which converts bilingual sentence pairs into a set of key-value pairs. Given a reference corpus <math id="S2.p2.1.m1.4" class="ltx_Math" alttext="(x,y)\in(\mathcal{X},\mathcal{Y})" display="inline"><semantics id="S2.p2.1.m1.4a"><mrow id="S2.p2.1.m1.4.5" xref="S2.p2.1.m1.4.5.cmml"><mrow id="S2.p2.1.m1.4.5.2.2" xref="S2.p2.1.m1.4.5.2.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.5.2.2.1" xref="S2.p2.1.m1.4.5.2.1.cmml">(</mo><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">x</mi><mo id="S2.p2.1.m1.4.5.2.2.2" xref="S2.p2.1.m1.4.5.2.1.cmml">,</mo><mi id="S2.p2.1.m1.2.2" xref="S2.p2.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.p2.1.m1.4.5.2.2.3" xref="S2.p2.1.m1.4.5.2.1.cmml">)</mo></mrow><mo id="S2.p2.1.m1.4.5.1" xref="S2.p2.1.m1.4.5.1.cmml">∈</mo><mrow id="S2.p2.1.m1.4.5.3.2" xref="S2.p2.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.5.3.2.1" xref="S2.p2.1.m1.4.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.3.3" xref="S2.p2.1.m1.3.3.cmml">𝒳</mi><mo id="S2.p2.1.m1.4.5.3.2.2" xref="S2.p2.1.m1.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.4.4" xref="S2.p2.1.m1.4.4.cmml">𝒴</mi><mo stretchy="false" id="S2.p2.1.m1.4.5.3.2.3" xref="S2.p2.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.4b"><apply id="S2.p2.1.m1.4.5.cmml" xref="S2.p2.1.m1.4.5"><in id="S2.p2.1.m1.4.5.1.cmml" xref="S2.p2.1.m1.4.5.1"></in><interval closure="open" id="S2.p2.1.m1.4.5.2.1.cmml" xref="S2.p2.1.m1.4.5.2.2"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑥</ci><ci id="S2.p2.1.m1.2.2.cmml" xref="S2.p2.1.m1.2.2">𝑦</ci></interval><interval closure="open" id="S2.p2.1.m1.4.5.3.1.cmml" xref="S2.p2.1.m1.4.5.3.2"><ci id="S2.p2.1.m1.3.3.cmml" xref="S2.p2.1.m1.3.3">𝒳</ci><ci id="S2.p2.1.m1.4.4.cmml" xref="S2.p2.1.m1.4.4">𝒴</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.4c">(x,y)\in(\mathcal{X},\mathcal{Y})</annotation></semantics></math>, the pre-trained NMT model generates the context representation <math id="S2.p2.2.m2.2" class="ltx_Math" alttext="f_{\theta}(x,y_{&lt;t})" display="inline"><semantics id="S2.p2.2.m2.2a"><mrow id="S2.p2.2.m2.2.2" xref="S2.p2.2.m2.2.2.cmml"><msub id="S2.p2.2.m2.2.2.3" xref="S2.p2.2.m2.2.2.3.cmml"><mi id="S2.p2.2.m2.2.2.3.2" xref="S2.p2.2.m2.2.2.3.2.cmml">f</mi><mi id="S2.p2.2.m2.2.2.3.3" xref="S2.p2.2.m2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.2.m2.2.2.2" xref="S2.p2.2.m2.2.2.2.cmml">​</mo><mrow id="S2.p2.2.m2.2.2.1.1" xref="S2.p2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S2.p2.2.m2.2.2.1.1.2" xref="S2.p2.2.m2.2.2.1.2.cmml">(</mo><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">x</mi><mo id="S2.p2.2.m2.2.2.1.1.3" xref="S2.p2.2.m2.2.2.1.2.cmml">,</mo><msub id="S2.p2.2.m2.2.2.1.1.1" xref="S2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S2.p2.2.m2.2.2.1.1.1.2" xref="S2.p2.2.m2.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.p2.2.m2.2.2.1.1.1.3" xref="S2.p2.2.m2.2.2.1.1.1.3.cmml"><mi id="S2.p2.2.m2.2.2.1.1.1.3.2" xref="S2.p2.2.m2.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.p2.2.m2.2.2.1.1.1.3.1" xref="S2.p2.2.m2.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.p2.2.m2.2.2.1.1.1.3.3" xref="S2.p2.2.m2.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.p2.2.m2.2.2.1.1.4" xref="S2.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.2b"><apply id="S2.p2.2.m2.2.2.cmml" xref="S2.p2.2.m2.2.2"><times id="S2.p2.2.m2.2.2.2.cmml" xref="S2.p2.2.m2.2.2.2"></times><apply id="S2.p2.2.m2.2.2.3.cmml" xref="S2.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.2.2.3.1.cmml" xref="S2.p2.2.m2.2.2.3">subscript</csymbol><ci id="S2.p2.2.m2.2.2.3.2.cmml" xref="S2.p2.2.m2.2.2.3.2">𝑓</ci><ci id="S2.p2.2.m2.2.2.3.3.cmml" xref="S2.p2.2.m2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S2.p2.2.m2.2.2.1.2.cmml" xref="S2.p2.2.m2.2.2.1.1"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑥</ci><apply id="S2.p2.2.m2.2.2.1.1.1.cmml" xref="S2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.p2.2.m2.2.2.1.1.1.2">𝑦</ci><apply id="S2.p2.2.m2.2.2.1.1.1.3.cmml" xref="S2.p2.2.m2.2.2.1.1.1.3"><lt id="S2.p2.2.m2.2.2.1.1.1.3.1.cmml" xref="S2.p2.2.m2.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p2.2.m2.2.2.1.1.1.3.2.cmml" xref="S2.p2.2.m2.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.p2.2.m2.2.2.1.1.1.3.3.cmml" xref="S2.p2.2.m2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.2c">f_{\theta}(x,y_{&lt;t})</annotation></semantics></math> at each timestep <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">t</annotation></semantics></math>.
Then we collect the output hidden state <math id="S2.p2.4.m4.2" class="ltx_Math" alttext="f_{\theta}(x,y_{&lt;t})" display="inline"><semantics id="S2.p2.4.m4.2a"><mrow id="S2.p2.4.m4.2.2" xref="S2.p2.4.m4.2.2.cmml"><msub id="S2.p2.4.m4.2.2.3" xref="S2.p2.4.m4.2.2.3.cmml"><mi id="S2.p2.4.m4.2.2.3.2" xref="S2.p2.4.m4.2.2.3.2.cmml">f</mi><mi id="S2.p2.4.m4.2.2.3.3" xref="S2.p2.4.m4.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.2.2.2" xref="S2.p2.4.m4.2.2.2.cmml">​</mo><mrow id="S2.p2.4.m4.2.2.1.1" xref="S2.p2.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S2.p2.4.m4.2.2.1.1.2" xref="S2.p2.4.m4.2.2.1.2.cmml">(</mo><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><mo id="S2.p2.4.m4.2.2.1.1.3" xref="S2.p2.4.m4.2.2.1.2.cmml">,</mo><msub id="S2.p2.4.m4.2.2.1.1.1" xref="S2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S2.p2.4.m4.2.2.1.1.1.2" xref="S2.p2.4.m4.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.p2.4.m4.2.2.1.1.1.3" xref="S2.p2.4.m4.2.2.1.1.1.3.cmml"><mi id="S2.p2.4.m4.2.2.1.1.1.3.2" xref="S2.p2.4.m4.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.p2.4.m4.2.2.1.1.1.3.1" xref="S2.p2.4.m4.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.p2.4.m4.2.2.1.1.1.3.3" xref="S2.p2.4.m4.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.p2.4.m4.2.2.1.1.4" xref="S2.p2.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.2b"><apply id="S2.p2.4.m4.2.2.cmml" xref="S2.p2.4.m4.2.2"><times id="S2.p2.4.m4.2.2.2.cmml" xref="S2.p2.4.m4.2.2.2"></times><apply id="S2.p2.4.m4.2.2.3.cmml" xref="S2.p2.4.m4.2.2.3"><csymbol cd="ambiguous" id="S2.p2.4.m4.2.2.3.1.cmml" xref="S2.p2.4.m4.2.2.3">subscript</csymbol><ci id="S2.p2.4.m4.2.2.3.2.cmml" xref="S2.p2.4.m4.2.2.3.2">𝑓</ci><ci id="S2.p2.4.m4.2.2.3.3.cmml" xref="S2.p2.4.m4.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S2.p2.4.m4.2.2.1.2.cmml" xref="S2.p2.4.m4.2.2.1.1"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑥</ci><apply id="S2.p2.4.m4.2.2.1.1.1.cmml" xref="S2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S2.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S2.p2.4.m4.2.2.1.1.1.2">𝑦</ci><apply id="S2.p2.4.m4.2.2.1.1.1.3.cmml" xref="S2.p2.4.m4.2.2.1.1.1.3"><lt id="S2.p2.4.m4.2.2.1.1.1.3.1.cmml" xref="S2.p2.4.m4.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p2.4.m4.2.2.1.1.1.3.2.cmml" xref="S2.p2.4.m4.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.p2.4.m4.2.2.1.1.1.3.3.cmml" xref="S2.p2.4.m4.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.2c">f_{\theta}(x,y_{&lt;t})</annotation></semantics></math> as key and <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="y_{t}" display="inline"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">y</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑦</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">y_{t}</annotation></semantics></math> as value to construct the whole datastore <math id="S2.p2.6.m6.2" class="ltx_Math" alttext="(\mathcal{K},\mathcal{V})" display="inline"><semantics id="S2.p2.6.m6.2a"><mrow id="S2.p2.6.m6.2.3.2" xref="S2.p2.6.m6.2.3.1.cmml"><mo stretchy="false" id="S2.p2.6.m6.2.3.2.1" xref="S2.p2.6.m6.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">𝒦</mi><mo id="S2.p2.6.m6.2.3.2.2" xref="S2.p2.6.m6.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.2.2" xref="S2.p2.6.m6.2.2.cmml">𝒱</mi><mo stretchy="false" id="S2.p2.6.m6.2.3.2.3" xref="S2.p2.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.2b"><interval closure="open" id="S2.p2.6.m6.2.3.1.cmml" xref="S2.p2.6.m6.2.3.2"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝒦</ci><ci id="S2.p2.6.m6.2.2.cmml" xref="S2.p2.6.m6.2.2">𝒱</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.2c">(\mathcal{K},\mathcal{V})</annotation></semantics></math>:</p>
</div>
<div id="S2.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.8" class="ltx_Math" alttext="(\mathcal{K},\mathcal{V})=\bigcup_{(x,y)\in(\mathcal{X},\mathcal{Y})}\{(f_{\theta}(x,y_{&lt;t}),y_{t}),\forall y_{t}\in y\}" display="block"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml"><mrow id="S2.E1.m1.8.8.3.2" xref="S2.E1.m1.8.8.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.3.2.1" xref="S2.E1.m1.8.8.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">𝒦</mi><mo id="S2.E1.m1.8.8.3.2.2" xref="S2.E1.m1.8.8.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">𝒱</mi><mo stretchy="false" id="S2.E1.m1.8.8.3.2.3" xref="S2.E1.m1.8.8.3.1.cmml">)</mo></mrow><mo rspace="0.111em" id="S2.E1.m1.8.8.2" xref="S2.E1.m1.8.8.2.cmml">=</mo><mrow id="S2.E1.m1.8.8.1" xref="S2.E1.m1.8.8.1.cmml"><munder id="S2.E1.m1.8.8.1.2" xref="S2.E1.m1.8.8.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.8.8.1.2.2" xref="S2.E1.m1.8.8.1.2.2.cmml">⋃</mo><mrow id="S2.E1.m1.4.4.4" xref="S2.E1.m1.4.4.4.cmml"><mrow id="S2.E1.m1.4.4.4.6.2" xref="S2.E1.m1.4.4.4.6.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.4.6.2.1" xref="S2.E1.m1.4.4.4.6.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">x</mi><mo id="S2.E1.m1.4.4.4.6.2.2" xref="S2.E1.m1.4.4.4.6.1.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.4.4.4.6.2.3" xref="S2.E1.m1.4.4.4.6.1.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.4.5" xref="S2.E1.m1.4.4.4.5.cmml">∈</mo><mrow id="S2.E1.m1.4.4.4.7.2" xref="S2.E1.m1.4.4.4.7.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.4.7.2.1" xref="S2.E1.m1.4.4.4.7.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml">𝒳</mi><mo id="S2.E1.m1.4.4.4.7.2.2" xref="S2.E1.m1.4.4.4.7.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.4.4" xref="S2.E1.m1.4.4.4.4.cmml">𝒴</mi><mo stretchy="false" id="S2.E1.m1.4.4.4.7.2.3" xref="S2.E1.m1.4.4.4.7.1.cmml">)</mo></mrow></mrow></munder><mrow id="S2.E1.m1.8.8.1.1.1" xref="S2.E1.m1.8.8.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.2" xref="S2.E1.m1.8.8.1.1.2.cmml">{</mo><mrow id="S2.E1.m1.8.8.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.cmml"><mrow id="S2.E1.m1.8.8.1.1.1.1.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.3.cmml"><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml">(</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">x</mi><mo id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.4" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.5" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.E1.m1.8.8.1.1.1.1.2.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S2.E1.m1.8.8.1.1.1.1.2.2.2.1" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.1.cmml">∀</mo><msub id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.2.cmml">y</mi><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.E1.m1.8.8.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.3.cmml">∈</mo><mi id="S2.E1.m1.8.8.1.1.1.1.4" xref="S2.E1.m1.8.8.1.1.1.1.4.cmml">y</mi></mrow><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.3" xref="S2.E1.m1.8.8.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8"><eq id="S2.E1.m1.8.8.2.cmml" xref="S2.E1.m1.8.8.2"></eq><interval closure="open" id="S2.E1.m1.8.8.3.1.cmml" xref="S2.E1.m1.8.8.3.2"><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝒦</ci><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝒱</ci></interval><apply id="S2.E1.m1.8.8.1.cmml" xref="S2.E1.m1.8.8.1"><apply id="S2.E1.m1.8.8.1.2.cmml" xref="S2.E1.m1.8.8.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.2.1.cmml" xref="S2.E1.m1.8.8.1.2">subscript</csymbol><union id="S2.E1.m1.8.8.1.2.2.cmml" xref="S2.E1.m1.8.8.1.2.2"></union><apply id="S2.E1.m1.4.4.4.cmml" xref="S2.E1.m1.4.4.4"><in id="S2.E1.m1.4.4.4.5.cmml" xref="S2.E1.m1.4.4.4.5"></in><interval closure="open" id="S2.E1.m1.4.4.4.6.1.cmml" xref="S2.E1.m1.4.4.4.6.2"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑥</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝑦</ci></interval><interval closure="open" id="S2.E1.m1.4.4.4.7.1.cmml" xref="S2.E1.m1.4.4.4.7.2"><ci id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3">𝒳</ci><ci id="S2.E1.m1.4.4.4.4.cmml" xref="S2.E1.m1.4.4.4.4">𝒴</ci></interval></apply></apply><set id="S2.E1.m1.8.8.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1"><apply id="S2.E1.m1.8.8.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1"><in id="S2.E1.m1.8.8.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.3"></in><list id="S2.E1.m1.8.8.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2"><interval closure="open" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2"><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝑥</ci><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply></interval><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.8.8.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.1">for-all</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.2">𝑦</ci><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></apply></list><ci id="S2.E1.m1.8.8.1.1.1.1.4.cmml" xref="S2.E1.m1.8.8.1.1.1.1.4">𝑦</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">(\mathcal{K},\mathcal{V})=\bigcup_{(x,y)\in(\mathcal{X},\mathcal{Y})}\{(f_{\theta}(x,y_{&lt;t}),y_{t}),\forall y_{t}\in y\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.4" class="ltx_p"><span id="S2.p4.4.1" class="ltx_text ltx_font_bold">Inference with kNN Retrieval</span> At the <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">t</annotation></semantics></math>-th decoding step, given the already generated words <math id="S2.p4.2.m2.1" class="ltx_Math" alttext="\hat{y}_{&lt;t}" display="inline"><semantics id="S2.p4.2.m2.1a"><msub id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><mover accent="true" id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml"><mi id="S2.p4.2.m2.1.1.2.2" xref="S2.p4.2.m2.1.1.2.2.cmml">y</mi><mo id="S2.p4.2.m2.1.1.2.1" xref="S2.p4.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml"><mi id="S2.p4.2.m2.1.1.3.2" xref="S2.p4.2.m2.1.1.3.2.cmml"></mi><mo id="S2.p4.2.m2.1.1.3.1" xref="S2.p4.2.m2.1.1.3.1.cmml">&lt;</mo><mi id="S2.p4.2.m2.1.1.3.3" xref="S2.p4.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.cmml" xref="S2.p4.2.m2.1.1">subscript</csymbol><apply id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2"><ci id="S2.p4.2.m2.1.1.2.1.cmml" xref="S2.p4.2.m2.1.1.2.1">^</ci><ci id="S2.p4.2.m2.1.1.2.2.cmml" xref="S2.p4.2.m2.1.1.2.2">𝑦</ci></apply><apply id="S2.p4.2.m2.1.1.3.cmml" xref="S2.p4.2.m2.1.1.3"><lt id="S2.p4.2.m2.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p4.2.m2.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.3.2">absent</csymbol><ci id="S2.p4.2.m2.1.1.3.3.cmml" xref="S2.p4.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\hat{y}_{&lt;t}</annotation></semantics></math>, the current context representation <math id="S2.p4.3.m3.2" class="ltx_Math" alttext="f_{\theta}(x,\hat{y}_{&lt;t})" display="inline"><semantics id="S2.p4.3.m3.2a"><mrow id="S2.p4.3.m3.2.2" xref="S2.p4.3.m3.2.2.cmml"><msub id="S2.p4.3.m3.2.2.3" xref="S2.p4.3.m3.2.2.3.cmml"><mi id="S2.p4.3.m3.2.2.3.2" xref="S2.p4.3.m3.2.2.3.2.cmml">f</mi><mi id="S2.p4.3.m3.2.2.3.3" xref="S2.p4.3.m3.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p4.3.m3.2.2.2" xref="S2.p4.3.m3.2.2.2.cmml">​</mo><mrow id="S2.p4.3.m3.2.2.1.1" xref="S2.p4.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S2.p4.3.m3.2.2.1.1.2" xref="S2.p4.3.m3.2.2.1.2.cmml">(</mo><mi id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml">x</mi><mo id="S2.p4.3.m3.2.2.1.1.3" xref="S2.p4.3.m3.2.2.1.2.cmml">,</mo><msub id="S2.p4.3.m3.2.2.1.1.1" xref="S2.p4.3.m3.2.2.1.1.1.cmml"><mover accent="true" id="S2.p4.3.m3.2.2.1.1.1.2" xref="S2.p4.3.m3.2.2.1.1.1.2.cmml"><mi id="S2.p4.3.m3.2.2.1.1.1.2.2" xref="S2.p4.3.m3.2.2.1.1.1.2.2.cmml">y</mi><mo id="S2.p4.3.m3.2.2.1.1.1.2.1" xref="S2.p4.3.m3.2.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.p4.3.m3.2.2.1.1.1.3" xref="S2.p4.3.m3.2.2.1.1.1.3.cmml"><mi id="S2.p4.3.m3.2.2.1.1.1.3.2" xref="S2.p4.3.m3.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.p4.3.m3.2.2.1.1.1.3.1" xref="S2.p4.3.m3.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.p4.3.m3.2.2.1.1.1.3.3" xref="S2.p4.3.m3.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.p4.3.m3.2.2.1.1.4" xref="S2.p4.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.2b"><apply id="S2.p4.3.m3.2.2.cmml" xref="S2.p4.3.m3.2.2"><times id="S2.p4.3.m3.2.2.2.cmml" xref="S2.p4.3.m3.2.2.2"></times><apply id="S2.p4.3.m3.2.2.3.cmml" xref="S2.p4.3.m3.2.2.3"><csymbol cd="ambiguous" id="S2.p4.3.m3.2.2.3.1.cmml" xref="S2.p4.3.m3.2.2.3">subscript</csymbol><ci id="S2.p4.3.m3.2.2.3.2.cmml" xref="S2.p4.3.m3.2.2.3.2">𝑓</ci><ci id="S2.p4.3.m3.2.2.3.3.cmml" xref="S2.p4.3.m3.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S2.p4.3.m3.2.2.1.2.cmml" xref="S2.p4.3.m3.2.2.1.1"><ci id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1">𝑥</ci><apply id="S2.p4.3.m3.2.2.1.1.1.cmml" xref="S2.p4.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.2.2.1.1.1.1.cmml" xref="S2.p4.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S2.p4.3.m3.2.2.1.1.1.2.cmml" xref="S2.p4.3.m3.2.2.1.1.1.2"><ci id="S2.p4.3.m3.2.2.1.1.1.2.1.cmml" xref="S2.p4.3.m3.2.2.1.1.1.2.1">^</ci><ci id="S2.p4.3.m3.2.2.1.1.1.2.2.cmml" xref="S2.p4.3.m3.2.2.1.1.1.2.2">𝑦</ci></apply><apply id="S2.p4.3.m3.2.2.1.1.1.3.cmml" xref="S2.p4.3.m3.2.2.1.1.1.3"><lt id="S2.p4.3.m3.2.2.1.1.1.3.1.cmml" xref="S2.p4.3.m3.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p4.3.m3.2.2.1.1.1.3.2.cmml" xref="S2.p4.3.m3.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.p4.3.m3.2.2.1.1.1.3.3.cmml" xref="S2.p4.3.m3.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.2c">f_{\theta}(x,\hat{y}_{&lt;t})</annotation></semantics></math> is leveraged to generate a retrieval distribution <math id="S2.p4.4.m4.2" class="ltx_Math" alttext="p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})" display="inline"><semantics id="S2.p4.4.m4.2a"><mrow id="S2.p4.4.m4.2.2" xref="S2.p4.4.m4.2.2.cmml"><msub id="S2.p4.4.m4.2.2.3" xref="S2.p4.4.m4.2.2.3.cmml"><mi id="S2.p4.4.m4.2.2.3.2" xref="S2.p4.4.m4.2.2.3.2.cmml">p</mi><mrow id="S2.p4.4.m4.2.2.3.3" xref="S2.p4.4.m4.2.2.3.3.cmml"><mi id="S2.p4.4.m4.2.2.3.3.2" xref="S2.p4.4.m4.2.2.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.p4.4.m4.2.2.3.3.1" xref="S2.p4.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S2.p4.4.m4.2.2.3.3.3" xref="S2.p4.4.m4.2.2.3.3.3.cmml">NN</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p4.4.m4.2.2.2" xref="S2.p4.4.m4.2.2.2.cmml">​</mo><mrow id="S2.p4.4.m4.2.2.1.1" xref="S2.p4.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.p4.4.m4.2.2.1.1.2" xref="S2.p4.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S2.p4.4.m4.2.2.1.1.1" xref="S2.p4.4.m4.2.2.1.1.1.cmml"><msub id="S2.p4.4.m4.2.2.1.1.1.3" xref="S2.p4.4.m4.2.2.1.1.1.3.cmml"><mi id="S2.p4.4.m4.2.2.1.1.1.3.2" xref="S2.p4.4.m4.2.2.1.1.1.3.2.cmml">y</mi><mi id="S2.p4.4.m4.2.2.1.1.1.3.3" xref="S2.p4.4.m4.2.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.p4.4.m4.2.2.1.1.1.2" xref="S2.p4.4.m4.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p4.4.m4.2.2.1.1.1.1.1" xref="S2.p4.4.m4.2.2.1.1.1.1.2.cmml"><mi id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml">x</mi><mo id="S2.p4.4.m4.2.2.1.1.1.1.1.2" xref="S2.p4.4.m4.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p4.4.m4.2.2.1.1.1.1.1.1" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.2" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.1" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.2" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.1" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.3" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.p4.4.m4.2.2.1.1.3" xref="S2.p4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.2b"><apply id="S2.p4.4.m4.2.2.cmml" xref="S2.p4.4.m4.2.2"><times id="S2.p4.4.m4.2.2.2.cmml" xref="S2.p4.4.m4.2.2.2"></times><apply id="S2.p4.4.m4.2.2.3.cmml" xref="S2.p4.4.m4.2.2.3"><csymbol cd="ambiguous" id="S2.p4.4.m4.2.2.3.1.cmml" xref="S2.p4.4.m4.2.2.3">subscript</csymbol><ci id="S2.p4.4.m4.2.2.3.2.cmml" xref="S2.p4.4.m4.2.2.3.2">𝑝</ci><apply id="S2.p4.4.m4.2.2.3.3.cmml" xref="S2.p4.4.m4.2.2.3.3"><times id="S2.p4.4.m4.2.2.3.3.1.cmml" xref="S2.p4.4.m4.2.2.3.3.1"></times><ci id="S2.p4.4.m4.2.2.3.3.2.cmml" xref="S2.p4.4.m4.2.2.3.3.2">𝑘</ci><ci id="S2.p4.4.m4.2.2.3.3.3.cmml" xref="S2.p4.4.m4.2.2.3.3.3">NN</ci></apply></apply><apply id="S2.p4.4.m4.2.2.1.1.1.cmml" xref="S2.p4.4.m4.2.2.1.1"><csymbol cd="latexml" id="S2.p4.4.m4.2.2.1.1.1.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.2">conditional</csymbol><apply id="S2.p4.4.m4.2.2.1.1.1.3.cmml" xref="S2.p4.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.4.m4.2.2.1.1.1.3.1.cmml" xref="S2.p4.4.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S2.p4.4.m4.2.2.1.1.1.3.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.3.2">𝑦</ci><ci id="S2.p4.4.m4.2.2.1.1.1.3.3.cmml" xref="S2.p4.4.m4.2.2.1.1.1.3.3">𝑡</ci></apply><list id="S2.p4.4.m4.2.2.1.1.1.1.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1"><ci id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1">𝑥</ci><apply id="S2.p4.4.m4.2.2.1.1.1.1.1.1.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2"><ci id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3"><lt id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.p4.4.m4.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.2c">p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})</annotation></semantics></math> over the entire vocabulary:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.7" class="ltx_Math" alttext="p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})\propto\sum_{(h_{i},v_{i})\in N_{t}}\mathbb{I}_{y_{t}=v_{i}}\mathrm{exp}(\frac{-d(h_{i},f_{\theta}(x,\hat{y}_{&lt;t}))^{2}}{T})" display="block"><semantics id="S2.E2.m1.7a"><mrow id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml"><mrow id="S2.E2.m1.7.7.1" xref="S2.E2.m1.7.7.1.cmml"><msub id="S2.E2.m1.7.7.1.3" xref="S2.E2.m1.7.7.1.3.cmml"><mi id="S2.E2.m1.7.7.1.3.2" xref="S2.E2.m1.7.7.1.3.2.cmml">p</mi><mrow id="S2.E2.m1.7.7.1.3.3" xref="S2.E2.m1.7.7.1.3.3.cmml"><mi id="S2.E2.m1.7.7.1.3.3.2" xref="S2.E2.m1.7.7.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.7.7.1.3.3.1" xref="S2.E2.m1.7.7.1.3.3.1.cmml">​</mo><mi id="S2.E2.m1.7.7.1.3.3.3" xref="S2.E2.m1.7.7.1.3.3.3.cmml">NN</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.7.7.1.2" xref="S2.E2.m1.7.7.1.2.cmml">​</mo><mrow id="S2.E2.m1.7.7.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.7.7.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.7.7.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.cmml"><msub id="S2.E2.m1.7.7.1.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.1.3.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.3.2" xref="S2.E2.m1.7.7.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E2.m1.7.7.1.1.1.1.3.3" xref="S2.E2.m1.7.7.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E2.m1.7.7.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.2.cmml">|</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml">x</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.7.7.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E2.m1.7.7.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E2.m1.7.7.2" xref="S2.E2.m1.7.7.2.cmml">∝</mo><mrow id="S2.E2.m1.7.7.3" xref="S2.E2.m1.7.7.3.cmml"><munder id="S2.E2.m1.7.7.3.1" xref="S2.E2.m1.7.7.3.1.cmml"><mo movablelimits="false" id="S2.E2.m1.7.7.3.1.2" xref="S2.E2.m1.7.7.3.1.2.cmml">∑</mo><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mrow id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.2.2.2.2.2.4" xref="S2.E2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.2.cmml">v</mi><mi id="S2.E2.m1.2.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E2.m1.2.2.2.2.2.5" xref="S2.E2.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">∈</mo><msub id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml"><mi id="S2.E2.m1.2.2.2.4.2" xref="S2.E2.m1.2.2.2.4.2.cmml">N</mi><mi id="S2.E2.m1.2.2.2.4.3" xref="S2.E2.m1.2.2.2.4.3.cmml">t</mi></msub></mrow></munder><mrow id="S2.E2.m1.7.7.3.2" xref="S2.E2.m1.7.7.3.2.cmml"><msub id="S2.E2.m1.7.7.3.2.2" xref="S2.E2.m1.7.7.3.2.2.cmml"><mi id="S2.E2.m1.7.7.3.2.2.2" xref="S2.E2.m1.7.7.3.2.2.2.cmml">𝕀</mi><mrow id="S2.E2.m1.7.7.3.2.2.3" xref="S2.E2.m1.7.7.3.2.2.3.cmml"><msub id="S2.E2.m1.7.7.3.2.2.3.2" xref="S2.E2.m1.7.7.3.2.2.3.2.cmml"><mi id="S2.E2.m1.7.7.3.2.2.3.2.2" xref="S2.E2.m1.7.7.3.2.2.3.2.2.cmml">y</mi><mi id="S2.E2.m1.7.7.3.2.2.3.2.3" xref="S2.E2.m1.7.7.3.2.2.3.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.7.7.3.2.2.3.1" xref="S2.E2.m1.7.7.3.2.2.3.1.cmml">=</mo><msub id="S2.E2.m1.7.7.3.2.2.3.3" xref="S2.E2.m1.7.7.3.2.2.3.3.cmml"><mi id="S2.E2.m1.7.7.3.2.2.3.3.2" xref="S2.E2.m1.7.7.3.2.2.3.3.2.cmml">v</mi><mi id="S2.E2.m1.7.7.3.2.2.3.3.3" xref="S2.E2.m1.7.7.3.2.2.3.3.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.7.7.3.2.1" xref="S2.E2.m1.7.7.3.2.1.cmml">​</mo><mi id="S2.E2.m1.7.7.3.2.3" xref="S2.E2.m1.7.7.3.2.3.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.7.7.3.2.1a" xref="S2.E2.m1.7.7.3.2.1.cmml">​</mo><mrow id="S2.E2.m1.7.7.3.2.4.2" xref="S2.E2.m1.5.5.cmml"><mo stretchy="false" id="S2.E2.m1.7.7.3.2.4.2.1" xref="S2.E2.m1.5.5.cmml">(</mo><mfrac id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml"><mo id="S2.E2.m1.5.5.3a" xref="S2.E2.m1.5.5.3.cmml">−</mo><mrow id="S2.E2.m1.5.5.3.3" xref="S2.E2.m1.5.5.3.3.cmml"><mi id="S2.E2.m1.5.5.3.3.4" xref="S2.E2.m1.5.5.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.3.3.3" xref="S2.E2.m1.5.5.3.3.3.cmml">​</mo><msup id="S2.E2.m1.5.5.3.3.2" xref="S2.E2.m1.5.5.3.3.2.cmml"><mrow id="S2.E2.m1.5.5.3.3.2.2.2" xref="S2.E2.m1.5.5.3.3.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.3.3.2.2.2.3" xref="S2.E2.m1.5.5.3.3.2.2.3.cmml">(</mo><msub id="S2.E2.m1.4.4.2.2.1.1.1.1" xref="S2.E2.m1.4.4.2.2.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.2.2.1.1.1.1.2" xref="S2.E2.m1.4.4.2.2.1.1.1.1.2.cmml">h</mi><mi id="S2.E2.m1.4.4.2.2.1.1.1.1.3" xref="S2.E2.m1.4.4.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.5.5.3.3.2.2.2.4" xref="S2.E2.m1.5.5.3.3.2.2.3.cmml">,</mo><mrow id="S2.E2.m1.5.5.3.3.2.2.2.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.cmml"><msub id="S2.E2.m1.5.5.3.3.2.2.2.2.3" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3.cmml"><mi id="S2.E2.m1.5.5.3.3.2.2.2.2.3.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3.2.cmml">f</mi><mi id="S2.E2.m1.5.5.3.3.2.2.2.2.3.3" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.3.3.2.2.2.2.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.2.cmml">​</mo><mrow id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.2.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">x</mi><mo id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.3" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.2.cmml">,</mo><msub id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.cmml"><mover accent="true" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.2.cmml">y</mi><mo id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.1" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.2" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.1" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.3" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.4" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.5.5.3.3.2.2.2.5" xref="S2.E2.m1.5.5.3.3.2.2.3.cmml">)</mo></mrow><mn id="S2.E2.m1.5.5.3.3.2.4" xref="S2.E2.m1.5.5.3.3.2.4.cmml">2</mn></msup></mrow></mrow><mi id="S2.E2.m1.5.5.5" xref="S2.E2.m1.5.5.5.cmml">T</mi></mfrac><mo stretchy="false" id="S2.E2.m1.7.7.3.2.4.2.2" xref="S2.E2.m1.5.5.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.7b"><apply id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7"><csymbol cd="latexml" id="S2.E2.m1.7.7.2.cmml" xref="S2.E2.m1.7.7.2">proportional-to</csymbol><apply id="S2.E2.m1.7.7.1.cmml" xref="S2.E2.m1.7.7.1"><times id="S2.E2.m1.7.7.1.2.cmml" xref="S2.E2.m1.7.7.1.2"></times><apply id="S2.E2.m1.7.7.1.3.cmml" xref="S2.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.3.1.cmml" xref="S2.E2.m1.7.7.1.3">subscript</csymbol><ci id="S2.E2.m1.7.7.1.3.2.cmml" xref="S2.E2.m1.7.7.1.3.2">𝑝</ci><apply id="S2.E2.m1.7.7.1.3.3.cmml" xref="S2.E2.m1.7.7.1.3.3"><times id="S2.E2.m1.7.7.1.3.3.1.cmml" xref="S2.E2.m1.7.7.1.3.3.1"></times><ci id="S2.E2.m1.7.7.1.3.3.2.cmml" xref="S2.E2.m1.7.7.1.3.3.2">𝑘</ci><ci id="S2.E2.m1.7.7.1.3.3.3.cmml" xref="S2.E2.m1.7.7.1.3.3.3">NN</ci></apply></apply><apply id="S2.E2.m1.7.7.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.7.7.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.2">conditional</csymbol><apply id="S2.E2.m1.7.7.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.3.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.3.2">𝑦</ci><ci id="S2.E2.m1.7.7.1.1.1.1.3.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1"><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">𝑥</ci><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2"><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3"><lt id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply><apply id="S2.E2.m1.7.7.3.cmml" xref="S2.E2.m1.7.7.3"><apply id="S2.E2.m1.7.7.3.1.cmml" xref="S2.E2.m1.7.7.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.3.1.1.cmml" xref="S2.E2.m1.7.7.3.1">subscript</csymbol><sum id="S2.E2.m1.7.7.3.1.2.cmml" xref="S2.E2.m1.7.7.3.1.2"></sum><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><in id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></in><interval closure="open" id="S2.E2.m1.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2">𝑣</ci><ci id="S2.E2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.4.1.cmml" xref="S2.E2.m1.2.2.2.4">subscript</csymbol><ci id="S2.E2.m1.2.2.2.4.2.cmml" xref="S2.E2.m1.2.2.2.4.2">𝑁</ci><ci id="S2.E2.m1.2.2.2.4.3.cmml" xref="S2.E2.m1.2.2.2.4.3">𝑡</ci></apply></apply></apply><apply id="S2.E2.m1.7.7.3.2.cmml" xref="S2.E2.m1.7.7.3.2"><times id="S2.E2.m1.7.7.3.2.1.cmml" xref="S2.E2.m1.7.7.3.2.1"></times><apply id="S2.E2.m1.7.7.3.2.2.cmml" xref="S2.E2.m1.7.7.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.3.2.2.1.cmml" xref="S2.E2.m1.7.7.3.2.2">subscript</csymbol><ci id="S2.E2.m1.7.7.3.2.2.2.cmml" xref="S2.E2.m1.7.7.3.2.2.2">𝕀</ci><apply id="S2.E2.m1.7.7.3.2.2.3.cmml" xref="S2.E2.m1.7.7.3.2.2.3"><eq id="S2.E2.m1.7.7.3.2.2.3.1.cmml" xref="S2.E2.m1.7.7.3.2.2.3.1"></eq><apply id="S2.E2.m1.7.7.3.2.2.3.2.cmml" xref="S2.E2.m1.7.7.3.2.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.3.2.2.3.2.1.cmml" xref="S2.E2.m1.7.7.3.2.2.3.2">subscript</csymbol><ci id="S2.E2.m1.7.7.3.2.2.3.2.2.cmml" xref="S2.E2.m1.7.7.3.2.2.3.2.2">𝑦</ci><ci id="S2.E2.m1.7.7.3.2.2.3.2.3.cmml" xref="S2.E2.m1.7.7.3.2.2.3.2.3">𝑡</ci></apply><apply id="S2.E2.m1.7.7.3.2.2.3.3.cmml" xref="S2.E2.m1.7.7.3.2.2.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.3.2.2.3.3.1.cmml" xref="S2.E2.m1.7.7.3.2.2.3.3">subscript</csymbol><ci id="S2.E2.m1.7.7.3.2.2.3.3.2.cmml" xref="S2.E2.m1.7.7.3.2.2.3.3.2">𝑣</ci><ci id="S2.E2.m1.7.7.3.2.2.3.3.3.cmml" xref="S2.E2.m1.7.7.3.2.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E2.m1.7.7.3.2.3.cmml" xref="S2.E2.m1.7.7.3.2.3">exp</ci><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.7.7.3.2.4.2"><divide id="S2.E2.m1.5.5.4.cmml" xref="S2.E2.m1.7.7.3.2.4.2"></divide><apply id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"><minus id="S2.E2.m1.5.5.3.4.cmml" xref="S2.E2.m1.5.5.3"></minus><apply id="S2.E2.m1.5.5.3.3.cmml" xref="S2.E2.m1.5.5.3.3"><times id="S2.E2.m1.5.5.3.3.3.cmml" xref="S2.E2.m1.5.5.3.3.3"></times><ci id="S2.E2.m1.5.5.3.3.4.cmml" xref="S2.E2.m1.5.5.3.3.4">𝑑</ci><apply id="S2.E2.m1.5.5.3.3.2.cmml" xref="S2.E2.m1.5.5.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.2.3.cmml" xref="S2.E2.m1.5.5.3.3.2">superscript</csymbol><interval closure="open" id="S2.E2.m1.5.5.3.3.2.2.3.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2"><apply id="S2.E2.m1.4.4.2.2.1.1.1.1.cmml" xref="S2.E2.m1.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.2.2.1.1.1.1.2">ℎ</ci><ci id="S2.E2.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E2.m1.5.5.3.3.2.2.2.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2"><times id="S2.E2.m1.5.5.3.3.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.2"></times><apply id="S2.E2.m1.5.5.3.3.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.2.2.2.2.3.1.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.5.5.3.3.2.2.2.2.3.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3.2">𝑓</ci><ci id="S2.E2.m1.5.5.3.3.2.2.2.2.3.3.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1"><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝑥</ci><apply id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1">subscript</csymbol><apply id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2"><ci id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.1">^</ci><ci id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3"><lt id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.3.3.2.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></interval><cn type="integer" id="S2.E2.m1.5.5.3.3.2.4.cmml" xref="S2.E2.m1.5.5.3.3.2.4">2</cn></apply></apply></apply><ci id="S2.E2.m1.5.5.5.cmml" xref="S2.E2.m1.5.5.5">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.7c">p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})\propto\sum_{(h_{i},v_{i})\in N_{t}}\mathbb{I}_{y_{t}=v_{i}}\mathrm{exp}(\frac{-d(h_{i},f_{\theta}(x,\hat{y}_{&lt;t}))^{2}}{T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.4" class="ltx_p">where the <math id="S2.p5.1.m1.1" class="ltx_math_unparsed" alttext="d(.,.)" display="inline"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1b"><mi id="S2.p5.1.m1.1.1">d</mi><mrow id="S2.p5.1.m1.1.2"><mo stretchy="false" id="S2.p5.1.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S2.p5.1.m1.1.2.2">.</mo><mo id="S2.p5.1.m1.1.2.3">,</mo><mo lspace="0em" rspace="0.167em" id="S2.p5.1.m1.1.2.4">.</mo><mo stretchy="false" id="S2.p5.1.m1.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">d(.,.)</annotation></semantics></math> stands for Euclidean distance function and <math id="S2.p5.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p5.2.m2.1a"><mi id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><ci id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">T</annotation></semantics></math> is the temperature to control the sharpness of softmax function.
The final prediction distribution enhances vanilla NMT distribution <math id="S2.p5.3.m3.1" class="ltx_Math" alttext="p_{\textrm{NMT}}" display="inline"><semantics id="S2.p5.3.m3.1a"><msub id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mi id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml">p</mi><mtext id="S2.p5.3.m3.1.1.3" xref="S2.p5.3.m3.1.1.3a.cmml">NMT</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p5.3.m3.1.1.1.cmml" xref="S2.p5.3.m3.1.1">subscript</csymbol><ci id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2">𝑝</ci><ci id="S2.p5.3.m3.1.1.3a.cmml" xref="S2.p5.3.m3.1.1.3"><mtext mathsize="70%" id="S2.p5.3.m3.1.1.3.cmml" xref="S2.p5.3.m3.1.1.3">NMT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">p_{\textrm{NMT}}</annotation></semantics></math> with the retrieval distribution <math id="S2.p5.4.m4.1" class="ltx_Math" alttext="p_{k\mathrm{NN}}" display="inline"><semantics id="S2.p5.4.m4.1a"><msub id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml"><mi id="S2.p5.4.m4.1.1.2" xref="S2.p5.4.m4.1.1.2.cmml">p</mi><mrow id="S2.p5.4.m4.1.1.3" xref="S2.p5.4.m4.1.1.3.cmml"><mi id="S2.p5.4.m4.1.1.3.2" xref="S2.p5.4.m4.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.p5.4.m4.1.1.3.1" xref="S2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.p5.4.m4.1.1.3.3" xref="S2.p5.4.m4.1.1.3.3.cmml">NN</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><apply id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.1.1.1.cmml" xref="S2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.p5.4.m4.1.1.2.cmml" xref="S2.p5.4.m4.1.1.2">𝑝</ci><apply id="S2.p5.4.m4.1.1.3.cmml" xref="S2.p5.4.m4.1.1.3"><times id="S2.p5.4.m4.1.1.3.1.cmml" xref="S2.p5.4.m4.1.1.3.1"></times><ci id="S2.p5.4.m4.1.1.3.2.cmml" xref="S2.p5.4.m4.1.1.3.2">𝑘</ci><ci id="S2.p5.4.m4.1.1.3.3.cmml" xref="S2.p5.4.m4.1.1.3.3">NN</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">p_{k\mathrm{NN}}</annotation></semantics></math>, and it is formally calculated as:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.7" class="ltx_Math" alttext="p(y_{t}|x,\hat{y}_{&lt;t})=\lambda p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})+(1-\lambda)p_{\mathrm{NMT}}(y_{t}|x,\hat{y}_{&lt;t})" display="block"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml"><mrow id="S2.E3.m1.4.4.1" xref="S2.E3.m1.4.4.1.cmml"><mi id="S2.E3.m1.4.4.1.3" xref="S2.E3.m1.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.1.2" xref="S2.E3.m1.4.4.1.2.cmml">​</mo><mrow id="S2.E3.m1.4.4.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.4.4.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.cmml"><msub id="S2.E3.m1.4.4.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E3.m1.4.4.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E3.m1.4.4.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.2.cmml">|</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">x</mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E3.m1.4.4.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E3.m1.4.4.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.5" xref="S2.E3.m1.7.7.5.cmml">=</mo><mrow id="S2.E3.m1.7.7.4" xref="S2.E3.m1.7.7.4.cmml"><mrow id="S2.E3.m1.5.5.2.1" xref="S2.E3.m1.5.5.2.1.cmml"><mi id="S2.E3.m1.5.5.2.1.3" xref="S2.E3.m1.5.5.2.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.2.1.2" xref="S2.E3.m1.5.5.2.1.2.cmml">​</mo><msub id="S2.E3.m1.5.5.2.1.4" xref="S2.E3.m1.5.5.2.1.4.cmml"><mi id="S2.E3.m1.5.5.2.1.4.2" xref="S2.E3.m1.5.5.2.1.4.2.cmml">p</mi><mrow id="S2.E3.m1.5.5.2.1.4.3" xref="S2.E3.m1.5.5.2.1.4.3.cmml"><mi id="S2.E3.m1.5.5.2.1.4.3.2" xref="S2.E3.m1.5.5.2.1.4.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.2.1.4.3.1" xref="S2.E3.m1.5.5.2.1.4.3.1.cmml">​</mo><mi id="S2.E3.m1.5.5.2.1.4.3.3" xref="S2.E3.m1.5.5.2.1.4.3.3.cmml">NN</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.2.1.2a" xref="S2.E3.m1.5.5.2.1.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.2.1.1.1" xref="S2.E3.m1.5.5.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.2.1.1.1.2" xref="S2.E3.m1.5.5.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.5.5.2.1.1.1.1" xref="S2.E3.m1.5.5.2.1.1.1.1.cmml"><msub id="S2.E3.m1.5.5.2.1.1.1.1.3" xref="S2.E3.m1.5.5.2.1.1.1.1.3.cmml"><mi id="S2.E3.m1.5.5.2.1.1.1.1.3.2" xref="S2.E3.m1.5.5.2.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E3.m1.5.5.2.1.1.1.1.3.3" xref="S2.E3.m1.5.5.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E3.m1.5.5.2.1.1.1.1.2" xref="S2.E3.m1.5.5.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.E3.m1.5.5.2.1.1.1.1.1.1" xref="S2.E3.m1.5.5.2.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">x</mi><mo id="S2.E3.m1.5.5.2.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.1" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E3.m1.5.5.2.1.1.1.3" xref="S2.E3.m1.5.5.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.4.4" xref="S2.E3.m1.7.7.4.4.cmml">+</mo><mrow id="S2.E3.m1.7.7.4.3" xref="S2.E3.m1.7.7.4.3.cmml"><mrow id="S2.E3.m1.6.6.3.2.1.1" xref="S2.E3.m1.6.6.3.2.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.6.6.3.2.1.1.2" xref="S2.E3.m1.6.6.3.2.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.6.6.3.2.1.1.1" xref="S2.E3.m1.6.6.3.2.1.1.1.cmml"><mn id="S2.E3.m1.6.6.3.2.1.1.1.2" xref="S2.E3.m1.6.6.3.2.1.1.1.2.cmml">1</mn><mo id="S2.E3.m1.6.6.3.2.1.1.1.1" xref="S2.E3.m1.6.6.3.2.1.1.1.1.cmml">−</mo><mi id="S2.E3.m1.6.6.3.2.1.1.1.3" xref="S2.E3.m1.6.6.3.2.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S2.E3.m1.6.6.3.2.1.1.3" xref="S2.E3.m1.6.6.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.7.7.4.3.3" xref="S2.E3.m1.7.7.4.3.3.cmml">​</mo><msub id="S2.E3.m1.7.7.4.3.4" xref="S2.E3.m1.7.7.4.3.4.cmml"><mi id="S2.E3.m1.7.7.4.3.4.2" xref="S2.E3.m1.7.7.4.3.4.2.cmml">p</mi><mi id="S2.E3.m1.7.7.4.3.4.3" xref="S2.E3.m1.7.7.4.3.4.3.cmml">NMT</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.7.7.4.3.3a" xref="S2.E3.m1.7.7.4.3.3.cmml">​</mo><mrow id="S2.E3.m1.7.7.4.3.2.1" xref="S2.E3.m1.7.7.4.3.2.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.7.7.4.3.2.1.2" xref="S2.E3.m1.7.7.4.3.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.7.7.4.3.2.1.1" xref="S2.E3.m1.7.7.4.3.2.1.1.cmml"><msub id="S2.E3.m1.7.7.4.3.2.1.1.3" xref="S2.E3.m1.7.7.4.3.2.1.1.3.cmml"><mi id="S2.E3.m1.7.7.4.3.2.1.1.3.2" xref="S2.E3.m1.7.7.4.3.2.1.1.3.2.cmml">y</mi><mi id="S2.E3.m1.7.7.4.3.2.1.1.3.3" xref="S2.E3.m1.7.7.4.3.2.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E3.m1.7.7.4.3.2.1.1.2" xref="S2.E3.m1.7.7.4.3.2.1.1.2.cmml">|</mo><mrow id="S2.E3.m1.7.7.4.3.2.1.1.1.1" xref="S2.E3.m1.7.7.4.3.2.1.1.1.2.cmml"><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">x</mi><mo id="S2.E3.m1.7.7.4.3.2.1.1.1.1.2" xref="S2.E3.m1.7.7.4.3.2.1.1.1.2.cmml">,</mo><msub id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.cmml"><mover accent="true" id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.2" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.1" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.1" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.3" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E3.m1.7.7.4.3.2.1.3" xref="S2.E3.m1.7.7.4.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7"><eq id="S2.E3.m1.7.7.5.cmml" xref="S2.E3.m1.7.7.5"></eq><apply id="S2.E3.m1.4.4.1.cmml" xref="S2.E3.m1.4.4.1"><times id="S2.E3.m1.4.4.1.2.cmml" xref="S2.E3.m1.4.4.1.2"></times><ci id="S2.E3.m1.4.4.1.3.cmml" xref="S2.E3.m1.4.4.1.3">𝑝</ci><apply id="S2.E3.m1.4.4.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.2">conditional</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.2">𝑦</ci><ci id="S2.E3.m1.4.4.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑥</ci><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2"><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3"><lt id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply><apply id="S2.E3.m1.7.7.4.cmml" xref="S2.E3.m1.7.7.4"><plus id="S2.E3.m1.7.7.4.4.cmml" xref="S2.E3.m1.7.7.4.4"></plus><apply id="S2.E3.m1.5.5.2.1.cmml" xref="S2.E3.m1.5.5.2.1"><times id="S2.E3.m1.5.5.2.1.2.cmml" xref="S2.E3.m1.5.5.2.1.2"></times><ci id="S2.E3.m1.5.5.2.1.3.cmml" xref="S2.E3.m1.5.5.2.1.3">𝜆</ci><apply id="S2.E3.m1.5.5.2.1.4.cmml" xref="S2.E3.m1.5.5.2.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.2.1.4.1.cmml" xref="S2.E3.m1.5.5.2.1.4">subscript</csymbol><ci id="S2.E3.m1.5.5.2.1.4.2.cmml" xref="S2.E3.m1.5.5.2.1.4.2">𝑝</ci><apply id="S2.E3.m1.5.5.2.1.4.3.cmml" xref="S2.E3.m1.5.5.2.1.4.3"><times id="S2.E3.m1.5.5.2.1.4.3.1.cmml" xref="S2.E3.m1.5.5.2.1.4.3.1"></times><ci id="S2.E3.m1.5.5.2.1.4.3.2.cmml" xref="S2.E3.m1.5.5.2.1.4.3.2">𝑘</ci><ci id="S2.E3.m1.5.5.2.1.4.3.3.cmml" xref="S2.E3.m1.5.5.2.1.4.3.3">NN</ci></apply></apply><apply id="S2.E3.m1.5.5.2.1.1.1.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.5.5.2.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.2">conditional</csymbol><apply id="S2.E3.m1.5.5.2.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.3.2">𝑦</ci><ci id="S2.E3.m1.5.5.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E3.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1"><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑥</ci><apply id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2"><ci id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3"><lt id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.5.5.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply><apply id="S2.E3.m1.7.7.4.3.cmml" xref="S2.E3.m1.7.7.4.3"><times id="S2.E3.m1.7.7.4.3.3.cmml" xref="S2.E3.m1.7.7.4.3.3"></times><apply id="S2.E3.m1.6.6.3.2.1.1.1.cmml" xref="S2.E3.m1.6.6.3.2.1.1"><minus id="S2.E3.m1.6.6.3.2.1.1.1.1.cmml" xref="S2.E3.m1.6.6.3.2.1.1.1.1"></minus><cn type="integer" id="S2.E3.m1.6.6.3.2.1.1.1.2.cmml" xref="S2.E3.m1.6.6.3.2.1.1.1.2">1</cn><ci id="S2.E3.m1.6.6.3.2.1.1.1.3.cmml" xref="S2.E3.m1.6.6.3.2.1.1.1.3">𝜆</ci></apply><apply id="S2.E3.m1.7.7.4.3.4.cmml" xref="S2.E3.m1.7.7.4.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.4.3.4.1.cmml" xref="S2.E3.m1.7.7.4.3.4">subscript</csymbol><ci id="S2.E3.m1.7.7.4.3.4.2.cmml" xref="S2.E3.m1.7.7.4.3.4.2">𝑝</ci><ci id="S2.E3.m1.7.7.4.3.4.3.cmml" xref="S2.E3.m1.7.7.4.3.4.3">NMT</ci></apply><apply id="S2.E3.m1.7.7.4.3.2.1.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1"><csymbol cd="latexml" id="S2.E3.m1.7.7.4.3.2.1.1.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.2">conditional</csymbol><apply id="S2.E3.m1.7.7.4.3.2.1.1.3.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.4.3.2.1.1.3.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.4.3.2.1.1.3.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.3.2">𝑦</ci><ci id="S2.E3.m1.7.7.4.3.2.1.1.3.3.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.3.3">𝑡</ci></apply><list id="S2.E3.m1.7.7.4.3.2.1.1.1.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1"><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑥</ci><apply id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2"><ci id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.1">^</ci><ci id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3"><lt id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.4.3.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">p(y_{t}|x,\hat{y}_{&lt;t})=\lambda p_{k\mathrm{NN}}(y_{t}|x,\hat{y}_{&lt;t})+(1-\lambda)p_{\mathrm{NMT}}(y_{t}|x,\hat{y}_{&lt;t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.p5.6" class="ltx_p"><math id="S2.p5.5.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p5.5.m1.1a"><mi id="S2.p5.5.m1.1.1" xref="S2.p5.5.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p5.5.m1.1b"><ci id="S2.p5.5.m1.1.1.cmml" xref="S2.p5.5.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m1.1c">T</annotation></semantics></math> and <math id="S2.p5.6.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.p5.6.m2.1a"><mi id="S2.p5.6.m2.1.1" xref="S2.p5.6.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.6.m2.1b"><ci id="S2.p5.6.m2.1.1.cmml" xref="S2.p5.6.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m2.1c">\lambda</annotation></semantics></math> above are tuned interpolation coefficients.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.04791/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="523" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>t-SNE result of the kNN datastore representation. A.x samples representation from the same subdialect, and B.x samples from different subdialects. Dots of different colors indicate different speaker or token clusters. </figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminary Study</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">Given the limited research on the application of kNN to ASR and speaker adaptation, we initiated a preliminary study to demonstrate the potential of kNN in ASR. Utilizing Whisper, we obtained token-level representations denoted as <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">ℎ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">h_{i}</annotation></semantics></math>. We then sampled different speaker kNN representations across three dimensions, they are subdialect, speaker and token. The t-SNE results on <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">h_{i}</annotation></semantics></math> embeddings from Whisper are illustrated in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Method ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. A.x samples derive from the same subdialect, where A.1 samples the same tokens with varying colors representing different speakers, while A.2 includes multiple speakers, with different color schemes indicating different tokens. B.x settings, on the other hand, sample from different subdialects, choosing up to 200 representations for four tokens or speakers.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The A.x samples drawn from the same subdialect exhibit considerable overlap among speakers within the same token cluster (A.1), and a clear demarcation exists between different token clusters (A.2). These results align with our expectations and benefit our kNN retrieval. It is important to note the evident sparseness of the speaker adaptation data, as reflected in token cluster A.2 (token C), as the use of fixed temperatures and weights by kNN for interpolation increases the chance of error tokens.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">B.x samples, collected from different subdialects, display overlaps between clusters in B.1 and boundaries between clusters in B.2, as anticipated. However, an unfortunate overlap is found in token C of B.2. We hypothesize that this overlap may be attributed to similar pronunciations of different tokens by speakers from diverse subdialects, in addition to data sparseness.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">The above-mentioned overlaps, which kNN classification cannot distinguish effectively, are largely related to speaker accents. Therefore, the incorporation of speaker embedding into kNN classification may prove beneficial in distinguishing between these overlaps, thereby enhancing the accuracy of our approach.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Speaker-Smoothed kNN Network</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2406.04791/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="514" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An overview of our proposed Speaker-Smoothed kNN framework</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Speaker recognition (SRE) models have been demonstrated to effectively distinguish between speakers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Speaker embeddings, derived from SRE models, have also been deployed directly for speaker adaptation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. To address the challenges posed by sparsity and error overlap identified in our preliminary study, we now incorporate x-vector, a type of speaker information, into the kNN approach.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Speaker-Smoothed kNN Network ‣ 3 Method ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> displays our process, starting with datastore construction as per Section 2. We use the SRE model to create an utterance-level x-vector, which we pair with its kNN value in a mapping relationship. Kster's work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> inspires us to design two estimators for variables <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">T</annotation></semantics></math> and <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\lambda</annotation></semantics></math> dynamically. Unlike Kster, we simplify our network settings according to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and integrate x-vector. Noting the sparsity of our speaker data, we heed findings from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, asserting networks utilizing distance and distinct token information yield better generalization results.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.13" class="ltx_p">Concretely, at the <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">t</annotation></semantics></math>-th decoding step, we first retrieve <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">K</annotation></semantics></math> neighbors from the datastore, and consider the powers of 2 as the choices of <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">k</annotation></semantics></math> for simplicity. For each neighbor <math id="S3.SS2.p3.4.m4.3" class="ltx_Math" alttext="(h_{i},v_{i},e_{i})" display="inline"><semantics id="S3.SS2.p3.4.m4.3a"><mrow id="S3.SS2.p3.4.m4.3.3.3" xref="S3.SS2.p3.4.m4.3.3.4.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.3.4" xref="S3.SS2.p3.4.m4.3.3.4.cmml">(</mo><msub id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.4.m4.3.3.3.5" xref="S3.SS2.p3.4.m4.3.3.4.cmml">,</mo><msub id="S3.SS2.p3.4.m4.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.cmml"><mi id="S3.SS2.p3.4.m4.2.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.2.cmml">v</mi><mi id="S3.SS2.p3.4.m4.2.2.2.2.3" xref="S3.SS2.p3.4.m4.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.4.m4.3.3.3.6" xref="S3.SS2.p3.4.m4.3.3.4.cmml">,</mo><msub id="S3.SS2.p3.4.m4.3.3.3.3" xref="S3.SS2.p3.4.m4.3.3.3.3.cmml"><mi id="S3.SS2.p3.4.m4.3.3.3.3.2" xref="S3.SS2.p3.4.m4.3.3.3.3.2.cmml">e</mi><mi id="S3.SS2.p3.4.m4.3.3.3.3.3" xref="S3.SS2.p3.4.m4.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.3.7" xref="S3.SS2.p3.4.m4.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.3b"><vector id="S3.SS2.p3.4.m4.3.3.4.cmml" xref="S3.SS2.p3.4.m4.3.3.3"><apply id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2">ℎ</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p3.4.m4.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2">𝑣</ci><ci id="S3.SS2.p3.4.m4.2.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p3.4.m4.3.3.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.3.3.3.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.3.3.3.3.2.cmml" xref="S3.SS2.p3.4.m4.3.3.3.3.2">𝑒</ci><ci id="S3.SS2.p3.4.m4.3.3.3.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.3c">(h_{i},v_{i},e_{i})</annotation></semantics></math>, where <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="e_{i}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">e</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑒</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">e_{i}</annotation></semantics></math> denoted the mapping x-vectors, we calculate the distance from the current context representation <math id="S3.SS2.p3.6.m6.3" class="ltx_Math" alttext="d_{i}=d(h_{i},f(x,\hat{y}_{&lt;t}))" display="inline"><semantics id="S3.SS2.p3.6.m6.3a"><mrow id="S3.SS2.p3.6.m6.3.3" xref="S3.SS2.p3.6.m6.3.3.cmml"><msub id="S3.SS2.p3.6.m6.3.3.4" xref="S3.SS2.p3.6.m6.3.3.4.cmml"><mi id="S3.SS2.p3.6.m6.3.3.4.2" xref="S3.SS2.p3.6.m6.3.3.4.2.cmml">d</mi><mi id="S3.SS2.p3.6.m6.3.3.4.3" xref="S3.SS2.p3.6.m6.3.3.4.3.cmml">i</mi></msub><mo id="S3.SS2.p3.6.m6.3.3.3" xref="S3.SS2.p3.6.m6.3.3.3.cmml">=</mo><mrow id="S3.SS2.p3.6.m6.3.3.2" xref="S3.SS2.p3.6.m6.3.3.2.cmml"><mi id="S3.SS2.p3.6.m6.3.3.2.4" xref="S3.SS2.p3.6.m6.3.3.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.6.m6.3.3.2.3" xref="S3.SS2.p3.6.m6.3.3.2.3.cmml">​</mo><mrow id="S3.SS2.p3.6.m6.3.3.2.2.2" xref="S3.SS2.p3.6.m6.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.6.m6.3.3.2.2.2.3" xref="S3.SS2.p3.6.m6.3.3.2.2.3.cmml">(</mo><msub id="S3.SS2.p3.6.m6.2.2.1.1.1.1" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p3.6.m6.2.2.1.1.1.1.2" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.6.m6.2.2.1.1.1.1.3" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.6.m6.3.3.2.2.2.4" xref="S3.SS2.p3.6.m6.3.3.2.2.3.cmml">,</mo><mrow id="S3.SS2.p3.6.m6.3.3.2.2.2.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.cmml"><mi id="S3.SS2.p3.6.m6.3.3.2.2.2.2.3" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.2.cmml">​</mo><mrow id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">x</mi><mo id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.3" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.2.cmml">,</mo><msub id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.2.cmml">y</mi><mo id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.1" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.2" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.2.cmml"></mi><mo id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.1" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.3" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.4" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.6.m6.3.3.2.2.2.5" xref="S3.SS2.p3.6.m6.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.3b"><apply id="S3.SS2.p3.6.m6.3.3.cmml" xref="S3.SS2.p3.6.m6.3.3"><eq id="S3.SS2.p3.6.m6.3.3.3.cmml" xref="S3.SS2.p3.6.m6.3.3.3"></eq><apply id="S3.SS2.p3.6.m6.3.3.4.cmml" xref="S3.SS2.p3.6.m6.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.3.3.4.1.cmml" xref="S3.SS2.p3.6.m6.3.3.4">subscript</csymbol><ci id="S3.SS2.p3.6.m6.3.3.4.2.cmml" xref="S3.SS2.p3.6.m6.3.3.4.2">𝑑</ci><ci id="S3.SS2.p3.6.m6.3.3.4.3.cmml" xref="S3.SS2.p3.6.m6.3.3.4.3">𝑖</ci></apply><apply id="S3.SS2.p3.6.m6.3.3.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2"><times id="S3.SS2.p3.6.m6.3.3.2.3.cmml" xref="S3.SS2.p3.6.m6.3.3.2.3"></times><ci id="S3.SS2.p3.6.m6.3.3.2.4.cmml" xref="S3.SS2.p3.6.m6.3.3.2.4">𝑑</ci><interval closure="open" id="S3.SS2.p3.6.m6.3.3.2.2.3.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2"><apply id="S3.SS2.p3.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1.2">ℎ</ci><ci id="S3.SS2.p3.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p3.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2"><times id="S3.SS2.p3.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.2"></times><ci id="S3.SS2.p3.6.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.3">𝑓</ci><interval closure="open" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑥</ci><apply id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2"><ci id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.1">^</ci><ci id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.2.2">𝑦</ci></apply><apply id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3"><lt id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.2">absent</csymbol><ci id="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p3.6.m6.3.3.2.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.3c">d_{i}=d(h_{i},f(x,\hat{y}_{&lt;t}))</annotation></semantics></math>, as well as the count of distinct values in top <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">i</annotation></semantics></math> neighbors <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><msub id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">c</mi><mi id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑐</ci><ci id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">c_{i}</annotation></semantics></math>.
Denote <math id="S3.SS2.p3.9.m9.3" class="ltx_Math" alttext="d=(d_{1},...,d_{K})" display="inline"><semantics id="S3.SS2.p3.9.m9.3a"><mrow id="S3.SS2.p3.9.m9.3.3" xref="S3.SS2.p3.9.m9.3.3.cmml"><mi id="S3.SS2.p3.9.m9.3.3.4" xref="S3.SS2.p3.9.m9.3.3.4.cmml">d</mi><mo id="S3.SS2.p3.9.m9.3.3.3" xref="S3.SS2.p3.9.m9.3.3.3.cmml">=</mo><mrow id="S3.SS2.p3.9.m9.3.3.2.2" xref="S3.SS2.p3.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.9.m9.3.3.2.2.3" xref="S3.SS2.p3.9.m9.3.3.2.3.cmml">(</mo><msub id="S3.SS2.p3.9.m9.2.2.1.1.1" xref="S3.SS2.p3.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.9.m9.2.2.1.1.1.2" xref="S3.SS2.p3.9.m9.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS2.p3.9.m9.2.2.1.1.1.3" xref="S3.SS2.p3.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.9.m9.3.3.2.2.4" xref="S3.SS2.p3.9.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">…</mi><mo id="S3.SS2.p3.9.m9.3.3.2.2.5" xref="S3.SS2.p3.9.m9.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p3.9.m9.3.3.2.2.2" xref="S3.SS2.p3.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS2.p3.9.m9.3.3.2.2.2.2" xref="S3.SS2.p3.9.m9.3.3.2.2.2.2.cmml">d</mi><mi id="S3.SS2.p3.9.m9.3.3.2.2.2.3" xref="S3.SS2.p3.9.m9.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS2.p3.9.m9.3.3.2.2.6" xref="S3.SS2.p3.9.m9.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.3b"><apply id="S3.SS2.p3.9.m9.3.3.cmml" xref="S3.SS2.p3.9.m9.3.3"><eq id="S3.SS2.p3.9.m9.3.3.3.cmml" xref="S3.SS2.p3.9.m9.3.3.3"></eq><ci id="S3.SS2.p3.9.m9.3.3.4.cmml" xref="S3.SS2.p3.9.m9.3.3.4">𝑑</ci><vector id="S3.SS2.p3.9.m9.3.3.2.3.cmml" xref="S3.SS2.p3.9.m9.3.3.2.2"><apply id="S3.SS2.p3.9.m9.2.2.1.1.1.cmml" xref="S3.SS2.p3.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.2.2.1.1.1.2">𝑑</ci><cn type="integer" id="S3.SS2.p3.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">…</ci><apply id="S3.SS2.p3.9.m9.3.3.2.2.2.cmml" xref="S3.SS2.p3.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.9.m9.3.3.2.2.2.2">𝑑</ci><ci id="S3.SS2.p3.9.m9.3.3.2.2.2.3.cmml" xref="S3.SS2.p3.9.m9.3.3.2.2.2.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.3c">d=(d_{1},...,d_{K})</annotation></semantics></math> as distances and <math id="S3.SS2.p3.10.m10.3" class="ltx_Math" alttext="c=(c_{1},...,c_{K})" display="inline"><semantics id="S3.SS2.p3.10.m10.3a"><mrow id="S3.SS2.p3.10.m10.3.3" xref="S3.SS2.p3.10.m10.3.3.cmml"><mi id="S3.SS2.p3.10.m10.3.3.4" xref="S3.SS2.p3.10.m10.3.3.4.cmml">c</mi><mo id="S3.SS2.p3.10.m10.3.3.3" xref="S3.SS2.p3.10.m10.3.3.3.cmml">=</mo><mrow id="S3.SS2.p3.10.m10.3.3.2.2" xref="S3.SS2.p3.10.m10.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.10.m10.3.3.2.2.3" xref="S3.SS2.p3.10.m10.3.3.2.3.cmml">(</mo><msub id="S3.SS2.p3.10.m10.2.2.1.1.1" xref="S3.SS2.p3.10.m10.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.10.m10.2.2.1.1.1.2" xref="S3.SS2.p3.10.m10.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS2.p3.10.m10.2.2.1.1.1.3" xref="S3.SS2.p3.10.m10.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.10.m10.3.3.2.2.4" xref="S3.SS2.p3.10.m10.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">…</mi><mo id="S3.SS2.p3.10.m10.3.3.2.2.5" xref="S3.SS2.p3.10.m10.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p3.10.m10.3.3.2.2.2" xref="S3.SS2.p3.10.m10.3.3.2.2.2.cmml"><mi id="S3.SS2.p3.10.m10.3.3.2.2.2.2" xref="S3.SS2.p3.10.m10.3.3.2.2.2.2.cmml">c</mi><mi id="S3.SS2.p3.10.m10.3.3.2.2.2.3" xref="S3.SS2.p3.10.m10.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS2.p3.10.m10.3.3.2.2.6" xref="S3.SS2.p3.10.m10.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.3b"><apply id="S3.SS2.p3.10.m10.3.3.cmml" xref="S3.SS2.p3.10.m10.3.3"><eq id="S3.SS2.p3.10.m10.3.3.3.cmml" xref="S3.SS2.p3.10.m10.3.3.3"></eq><ci id="S3.SS2.p3.10.m10.3.3.4.cmml" xref="S3.SS2.p3.10.m10.3.3.4">𝑐</ci><vector id="S3.SS2.p3.10.m10.3.3.2.3.cmml" xref="S3.SS2.p3.10.m10.3.3.2.2"><apply id="S3.SS2.p3.10.m10.2.2.1.1.1.cmml" xref="S3.SS2.p3.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.10.m10.2.2.1.1.1.2">𝑐</ci><cn type="integer" id="S3.SS2.p3.10.m10.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.10.m10.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">…</ci><apply id="S3.SS2.p3.10.m10.3.3.2.2.2.cmml" xref="S3.SS2.p3.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.10.m10.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.10.m10.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.10.m10.3.3.2.2.2.2">𝑐</ci><ci id="S3.SS2.p3.10.m10.3.3.2.2.2.3.cmml" xref="S3.SS2.p3.10.m10.3.3.2.2.2.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.3c">c=(c_{1},...,c_{K})</annotation></semantics></math> as counts of values for all retrieved neighbors. Finally, we use input <math id="S3.SS2.p3.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p3.11.m11.1a"><mi id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><ci id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">x</annotation></semantics></math> to generate x-vector and calculate the dot product with <math id="S3.SS2.p3.12.m12.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p3.12.m12.1a"><mi id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><ci id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">e</annotation></semantics></math>, here, denote <math id="S3.SS2.p3.13.m13.3" class="ltx_Math" alttext="s=(s_{1},...,s_{K})" display="inline"><semantics id="S3.SS2.p3.13.m13.3a"><mrow id="S3.SS2.p3.13.m13.3.3" xref="S3.SS2.p3.13.m13.3.3.cmml"><mi id="S3.SS2.p3.13.m13.3.3.4" xref="S3.SS2.p3.13.m13.3.3.4.cmml">s</mi><mo id="S3.SS2.p3.13.m13.3.3.3" xref="S3.SS2.p3.13.m13.3.3.3.cmml">=</mo><mrow id="S3.SS2.p3.13.m13.3.3.2.2" xref="S3.SS2.p3.13.m13.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.13.m13.3.3.2.2.3" xref="S3.SS2.p3.13.m13.3.3.2.3.cmml">(</mo><msub id="S3.SS2.p3.13.m13.2.2.1.1.1" xref="S3.SS2.p3.13.m13.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.13.m13.2.2.1.1.1.2" xref="S3.SS2.p3.13.m13.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS2.p3.13.m13.2.2.1.1.1.3" xref="S3.SS2.p3.13.m13.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.13.m13.3.3.2.2.4" xref="S3.SS2.p3.13.m13.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.13.m13.1.1" xref="S3.SS2.p3.13.m13.1.1.cmml">…</mi><mo id="S3.SS2.p3.13.m13.3.3.2.2.5" xref="S3.SS2.p3.13.m13.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p3.13.m13.3.3.2.2.2" xref="S3.SS2.p3.13.m13.3.3.2.2.2.cmml"><mi id="S3.SS2.p3.13.m13.3.3.2.2.2.2" xref="S3.SS2.p3.13.m13.3.3.2.2.2.2.cmml">s</mi><mi id="S3.SS2.p3.13.m13.3.3.2.2.2.3" xref="S3.SS2.p3.13.m13.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS2.p3.13.m13.3.3.2.2.6" xref="S3.SS2.p3.13.m13.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.3b"><apply id="S3.SS2.p3.13.m13.3.3.cmml" xref="S3.SS2.p3.13.m13.3.3"><eq id="S3.SS2.p3.13.m13.3.3.3.cmml" xref="S3.SS2.p3.13.m13.3.3.3"></eq><ci id="S3.SS2.p3.13.m13.3.3.4.cmml" xref="S3.SS2.p3.13.m13.3.3.4">𝑠</ci><vector id="S3.SS2.p3.13.m13.3.3.2.3.cmml" xref="S3.SS2.p3.13.m13.3.3.2.2"><apply id="S3.SS2.p3.13.m13.2.2.1.1.1.cmml" xref="S3.SS2.p3.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.13.m13.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m13.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.13.m13.2.2.1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS2.p3.13.m13.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.13.m13.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p3.13.m13.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1">…</ci><apply id="S3.SS2.p3.13.m13.3.3.2.2.2.cmml" xref="S3.SS2.p3.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.13.m13.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.13.m13.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.13.m13.3.3.2.2.2.2">𝑠</ci><ci id="S3.SS2.p3.13.m13.3.3.2.2.2.3.cmml" xref="S3.SS2.p3.13.m13.3.3.2.2.2.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.3c">s=(s_{1},...,s_{K})</annotation></semantics></math> as the x-vector similarity.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.5" class="ltx_p">For dynamic distribution temperature <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">T</annotation></semantics></math> denoted as <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="T_{s}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">T</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑇</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">T_{s}</annotation></semantics></math>, we concatenate <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">d</annotation></semantics></math> and <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">s</annotation></semantics></math> as input features to the <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">T</annotation></semantics></math> estimator network. From the preliminary study, the above operations are performed in the hope that the x-vector will help distinguish overlapping issues.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="T_{s}=\exp(\mathbf{W}_{1}[d;s]+\mathbf{b}_{1})" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msub id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mi id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml">T</mi><mi id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3.cmml">s</mi></msub><mo id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml">=</mo><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.2.cmml"><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">exp</mi><mo id="S3.E4.m1.4.4.1.1a" xref="S3.E4.m1.4.4.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.2.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><msub id="S3.E4.m1.4.4.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.cmml">𝐖</mi><mn id="S3.E4.m1.4.4.1.1.1.1.2.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.2.1" xref="S3.E4.m1.4.4.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.2.3.2" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.2.3.2.1" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml">[</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">d</mi><mo id="S3.E4.m1.4.4.1.1.1.1.2.3.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml">;</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">s</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.2.3.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.4.4.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E4.m1.4.4.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"></eq><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3">subscript</csymbol><ci id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3.2">𝑇</ci><ci id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3">𝑠</ci></apply><apply id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.1"><exp id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"></exp><apply id="S3.E4.m1.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1"><plus id="S3.E4.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"></plus><apply id="S3.E4.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2"><times id="S3.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.1"></times><apply id="S3.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2">𝐖</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2.3">1</cn></apply><list id="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑑</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑠</ci></list></apply><apply id="S3.E4.m1.4.4.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3.2">𝐛</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">T_{s}=\exp(\mathbf{W}_{1}[d;s]+\mathbf{b}_{1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.6" class="ltx_p">For dynamic <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\lambda</annotation></semantics></math> denoted as <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="\lambda_{s}" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><msub id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml"><mi id="S3.SS2.p6.2.m2.1.1.2" xref="S3.SS2.p6.2.m2.1.1.2.cmml">λ</mi><mi id="S3.SS2.p6.2.m2.1.1.3" xref="S3.SS2.p6.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p6.2.m2.1.1.2.cmml" xref="S3.SS2.p6.2.m2.1.1.2">𝜆</ci><ci id="S3.SS2.p6.2.m2.1.1.3.cmml" xref="S3.SS2.p6.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">\lambda_{s}</annotation></semantics></math>, the mixing weight <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="\lambda_{s}" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><msub id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">λ</mi><mi id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">𝜆</ci><ci id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\lambda_{s}</annotation></semantics></math> is computed by a <math id="S3.SS2.p6.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p6.4.m4.1a"><mi id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><ci id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">d</annotation></semantics></math> and <math id="S3.SS2.p6.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p6.5.m5.1a"><mi id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><ci id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">c</annotation></semantics></math> as inputs where <math id="S3.SS2.p6.6.m6.4" class="ltx_Math" alttext="[\mathbf{W}_{2};\mathbf{b}_{2};\mathbf{W}_{3};\mathbf{b}_{3}]" display="inline"><semantics id="S3.SS2.p6.6.m6.4a"><mrow id="S3.SS2.p6.6.m6.4.4.4" xref="S3.SS2.p6.6.m6.4.4.5.cmml"><mo stretchy="false" id="S3.SS2.p6.6.m6.4.4.4.5" xref="S3.SS2.p6.6.m6.4.4.5.cmml">[</mo><msub id="S3.SS2.p6.6.m6.1.1.1.1" xref="S3.SS2.p6.6.m6.1.1.1.1.cmml"><mi id="S3.SS2.p6.6.m6.1.1.1.1.2" xref="S3.SS2.p6.6.m6.1.1.1.1.2.cmml">𝐖</mi><mn id="S3.SS2.p6.6.m6.1.1.1.1.3" xref="S3.SS2.p6.6.m6.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS2.p6.6.m6.4.4.4.6" xref="S3.SS2.p6.6.m6.4.4.5.cmml">;</mo><msub id="S3.SS2.p6.6.m6.2.2.2.2" xref="S3.SS2.p6.6.m6.2.2.2.2.cmml"><mi id="S3.SS2.p6.6.m6.2.2.2.2.2" xref="S3.SS2.p6.6.m6.2.2.2.2.2.cmml">𝐛</mi><mn id="S3.SS2.p6.6.m6.2.2.2.2.3" xref="S3.SS2.p6.6.m6.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p6.6.m6.4.4.4.7" xref="S3.SS2.p6.6.m6.4.4.5.cmml">;</mo><msub id="S3.SS2.p6.6.m6.3.3.3.3" xref="S3.SS2.p6.6.m6.3.3.3.3.cmml"><mi id="S3.SS2.p6.6.m6.3.3.3.3.2" xref="S3.SS2.p6.6.m6.3.3.3.3.2.cmml">𝐖</mi><mn id="S3.SS2.p6.6.m6.3.3.3.3.3" xref="S3.SS2.p6.6.m6.3.3.3.3.3.cmml">3</mn></msub><mo id="S3.SS2.p6.6.m6.4.4.4.8" xref="S3.SS2.p6.6.m6.4.4.5.cmml">;</mo><msub id="S3.SS2.p6.6.m6.4.4.4.4" xref="S3.SS2.p6.6.m6.4.4.4.4.cmml"><mi id="S3.SS2.p6.6.m6.4.4.4.4.2" xref="S3.SS2.p6.6.m6.4.4.4.4.2.cmml">𝐛</mi><mn id="S3.SS2.p6.6.m6.4.4.4.4.3" xref="S3.SS2.p6.6.m6.4.4.4.4.3.cmml">3</mn></msub><mo stretchy="false" id="S3.SS2.p6.6.m6.4.4.4.9" xref="S3.SS2.p6.6.m6.4.4.5.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.6.m6.4b"><list id="S3.SS2.p6.6.m6.4.4.5.cmml" xref="S3.SS2.p6.6.m6.4.4.4"><apply id="S3.SS2.p6.6.m6.1.1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p6.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.p6.6.m6.1.1.1.1.2">𝐖</ci><cn type="integer" id="S3.SS2.p6.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.p6.6.m6.1.1.1.1.3">2</cn></apply><apply id="S3.SS2.p6.6.m6.2.2.2.2.cmml" xref="S3.SS2.p6.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.2.2.2.2.1.cmml" xref="S3.SS2.p6.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p6.6.m6.2.2.2.2.2.cmml" xref="S3.SS2.p6.6.m6.2.2.2.2.2">𝐛</ci><cn type="integer" id="S3.SS2.p6.6.m6.2.2.2.2.3.cmml" xref="S3.SS2.p6.6.m6.2.2.2.2.3">2</cn></apply><apply id="S3.SS2.p6.6.m6.3.3.3.3.cmml" xref="S3.SS2.p6.6.m6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.3.3.3.3.1.cmml" xref="S3.SS2.p6.6.m6.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p6.6.m6.3.3.3.3.2.cmml" xref="S3.SS2.p6.6.m6.3.3.3.3.2">𝐖</ci><cn type="integer" id="S3.SS2.p6.6.m6.3.3.3.3.3.cmml" xref="S3.SS2.p6.6.m6.3.3.3.3.3">3</cn></apply><apply id="S3.SS2.p6.6.m6.4.4.4.4.cmml" xref="S3.SS2.p6.6.m6.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.4.4.4.4.1.cmml" xref="S3.SS2.p6.6.m6.4.4.4.4">subscript</csymbol><ci id="S3.SS2.p6.6.m6.4.4.4.4.2.cmml" xref="S3.SS2.p6.6.m6.4.4.4.4.2">𝐛</ci><cn type="integer" id="S3.SS2.p6.6.m6.4.4.4.4.3.cmml" xref="S3.SS2.p6.6.m6.4.4.4.4.3">3</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.6.m6.4c">[\mathbf{W}_{2};\mathbf{b}_{2};\mathbf{W}_{3};\mathbf{b}_{3}]</annotation></semantics></math> are trainable parameters. These distance information can deal with the sparse problem from the preliminary study.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\mathbf{\lambda_{s}}=\text{sigmoid}(\mathbf{W}_{3}\text{ReLU}(\mathbf{W}_{2}[d;c]+\mathbf{b}_{2})+\mathbf{b}_{3})\\
" display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><msub id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.2" xref="S3.E5.m1.3.3.3.2.cmml">λ</mi><mi id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.3.cmml">𝐬</mi></msub><mo id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mtext id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.3.3.1.3a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml">𝐖</mi><mn id="S3.E5.m1.3.3.1.1.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mtext id="S3.E5.m1.3.3.1.1.1.1.1.4" xref="S3.E5.m1.3.3.1.1.1.1.1.4a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.2a" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mn id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml">[</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">d</mi><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml">;</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">c</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml">+</mo><msub id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E5.m1.3.3.1.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.cmml">3</mn></msub></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"></eq><apply id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.2">𝜆</ci><ci id="S3.E5.m1.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3">𝐬</ci></apply><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><times id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.2"></times><ci id="S3.E5.m1.3.3.1.3a.cmml" xref="S3.E5.m1.3.3.1.3"><mtext id="S3.E5.m1.3.3.1.3.cmml" xref="S3.E5.m1.3.3.1.3">sigmoid</mtext></ci><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><plus id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2"></plus><apply id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2">𝐖</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3.3">3</cn></apply><ci id="S3.E5.m1.3.3.1.1.1.1.1.4a.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4"><mtext id="S3.E5.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4">ReLU</mtext></ci><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1"><plus id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2"><times id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.3">2</cn></apply><list id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑑</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑐</ci></list></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝐛</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.2">𝐛</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\mathbf{\lambda_{s}}=\text{sigmoid}(\mathbf{W}_{3}\text{ReLU}(\mathbf{W}_{2}[d;c]+\mathbf{b}_{2})+\mathbf{b}_{3})\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.1" class="ltx_p">It's noteworthy that our technique, in theory, can be employed with any autoregressive E2E ASR model, including RNN-T or Conformer. Once our network has been trained, it enables hot update in the speaker datastore during testing, thereby supporting on-the-fly adaptation.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Prediction and Training</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.10" class="ltx_p">In prediction phrase, we use our Speaker-Smoothed network to generate dynamic <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="T_{s}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">T</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑇</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">T_{s}</annotation></semantics></math> and <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\lambda_{s}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">λ</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝜆</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\lambda_{s}</annotation></semantics></math> for each untranscribed token to utilize different T and <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\lambda</annotation></semantics></math>. That is to say, we replace the fixed <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">T</annotation></semantics></math> in Equation <a href="#S2.E2" title="In 2 Background ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\lambda</annotation></semantics></math> in Equation <a href="#S2.E3" title="In 2 Background ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> by <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\lambda_{s}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">λ</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝜆</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\lambda_{s}</annotation></semantics></math> and <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="T_{s}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">T</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝑇</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">T_{s}</annotation></semantics></math> varies at each predicting <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\hat{y}_{t}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msub id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mover accent="true" id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.2.2.cmml">y</mi><mo id="S3.SS3.p1.8.m8.1.1.2.1" xref="S3.SS3.p1.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2"><ci id="S3.SS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1.2.1">^</ci><ci id="S3.SS3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2.2">𝑦</ci></apply><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\hat{y}_{t}</annotation></semantics></math>. Here <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="p_{ASR}" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><msub id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">p</mi><mrow id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.p1.9.m9.1.1.3.2" xref="S3.SS3.p1.9.m9.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m9.1.1.3.1" xref="S3.SS3.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.9.m9.1.1.3.3" xref="S3.SS3.p1.9.m9.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m9.1.1.3.1a" xref="S3.SS3.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.9.m9.1.1.3.4" xref="S3.SS3.p1.9.m9.1.1.3.4.cmml">R</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝑝</ci><apply id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3"><times id="S3.SS3.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.p1.9.m9.1.1.3.1"></times><ci id="S3.SS3.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.p1.9.m9.1.1.3.2">𝐴</ci><ci id="S3.SS3.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3.3">𝑆</ci><ci id="S3.SS3.p1.9.m9.1.1.3.4.cmml" xref="S3.SS3.p1.9.m9.1.1.3.4">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">p_{ASR}</annotation></semantics></math> denotes ASR distribution and <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="p_{SS}" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><msub id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">p</mi><mrow id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml"><mi id="S3.SS3.p1.10.m10.1.1.3.2" xref="S3.SS3.p1.10.m10.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m10.1.1.3.1" xref="S3.SS3.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.10.m10.1.1.3.3" xref="S3.SS3.p1.10.m10.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">𝑝</ci><apply id="S3.SS3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3"><times id="S3.SS3.p1.10.m10.1.1.3.1.cmml" xref="S3.SS3.p1.10.m10.1.1.3.1"></times><ci id="S3.SS3.p1.10.m10.1.1.3.2.cmml" xref="S3.SS3.p1.10.m10.1.1.3.2">𝑆</ci><ci id="S3.SS3.p1.10.m10.1.1.3.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">p_{SS}</annotation></semantics></math> denotes Speaker-Smoothed kNN distribution</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.7" class="ltx_Math" alttext="p(y_{t}|x,\hat{y}_{&lt;t})=\lambda_{s}p_{ASR}(y_{t}|x,\hat{y}_{&lt;t})+(1-\lambda_{s})p_{\mathrm{SS}}(y_{t}|x,\hat{y}_{&lt;t})" display="block"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7" xref="S3.E6.m1.7.7.cmml"><mrow id="S3.E6.m1.4.4.1" xref="S3.E6.m1.4.4.1.cmml"><mi id="S3.E6.m1.4.4.1.3" xref="S3.E6.m1.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.1.2" xref="S3.E6.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.4.4.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.cmml"><msub id="S3.E6.m1.4.4.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E6.m1.4.4.1.1.1.1.3.3" xref="S3.E6.m1.4.4.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E6.m1.4.4.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.2.cmml">|</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">x</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E6.m1.4.4.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.5" xref="S3.E6.m1.7.7.5.cmml">=</mo><mrow id="S3.E6.m1.7.7.4" xref="S3.E6.m1.7.7.4.cmml"><mrow id="S3.E6.m1.5.5.2.1" xref="S3.E6.m1.5.5.2.1.cmml"><msub id="S3.E6.m1.5.5.2.1.3" xref="S3.E6.m1.5.5.2.1.3.cmml"><mi id="S3.E6.m1.5.5.2.1.3.2" xref="S3.E6.m1.5.5.2.1.3.2.cmml">λ</mi><mi id="S3.E6.m1.5.5.2.1.3.3" xref="S3.E6.m1.5.5.2.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.2.1.2" xref="S3.E6.m1.5.5.2.1.2.cmml">​</mo><msub id="S3.E6.m1.5.5.2.1.4" xref="S3.E6.m1.5.5.2.1.4.cmml"><mi id="S3.E6.m1.5.5.2.1.4.2" xref="S3.E6.m1.5.5.2.1.4.2.cmml">p</mi><mrow id="S3.E6.m1.5.5.2.1.4.3" xref="S3.E6.m1.5.5.2.1.4.3.cmml"><mi id="S3.E6.m1.5.5.2.1.4.3.2" xref="S3.E6.m1.5.5.2.1.4.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.2.1.4.3.1" xref="S3.E6.m1.5.5.2.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.2.1.4.3.3" xref="S3.E6.m1.5.5.2.1.4.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.2.1.4.3.1a" xref="S3.E6.m1.5.5.2.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.2.1.4.3.4" xref="S3.E6.m1.5.5.2.1.4.3.4.cmml">R</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.2.1.2a" xref="S3.E6.m1.5.5.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.2.1.1.1" xref="S3.E6.m1.5.5.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.2.1.1.1.2" xref="S3.E6.m1.5.5.2.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.5.5.2.1.1.1.1" xref="S3.E6.m1.5.5.2.1.1.1.1.cmml"><msub id="S3.E6.m1.5.5.2.1.1.1.1.3" xref="S3.E6.m1.5.5.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.2.1.1.1.1.3.2" xref="S3.E6.m1.5.5.2.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E6.m1.5.5.2.1.1.1.1.3.3" xref="S3.E6.m1.5.5.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E6.m1.5.5.2.1.1.1.1.2" xref="S3.E6.m1.5.5.2.1.1.1.1.2.cmml">|</mo><mrow id="S3.E6.m1.5.5.2.1.1.1.1.1.1" xref="S3.E6.m1.5.5.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">x</mi><mo id="S3.E6.m1.5.5.2.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.2.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E6.m1.5.5.2.1.1.1.3" xref="S3.E6.m1.5.5.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.4.4" xref="S3.E6.m1.7.7.4.4.cmml">+</mo><mrow id="S3.E6.m1.7.7.4.3" xref="S3.E6.m1.7.7.4.3.cmml"><mrow id="S3.E6.m1.6.6.3.2.1.1" xref="S3.E6.m1.6.6.3.2.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.3.2.1.1.2" xref="S3.E6.m1.6.6.3.2.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.6.6.3.2.1.1.1" xref="S3.E6.m1.6.6.3.2.1.1.1.cmml"><mn id="S3.E6.m1.6.6.3.2.1.1.1.2" xref="S3.E6.m1.6.6.3.2.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.6.6.3.2.1.1.1.1" xref="S3.E6.m1.6.6.3.2.1.1.1.1.cmml">−</mo><msub id="S3.E6.m1.6.6.3.2.1.1.1.3" xref="S3.E6.m1.6.6.3.2.1.1.1.3.cmml"><mi id="S3.E6.m1.6.6.3.2.1.1.1.3.2" xref="S3.E6.m1.6.6.3.2.1.1.1.3.2.cmml">λ</mi><mi id="S3.E6.m1.6.6.3.2.1.1.1.3.3" xref="S3.E6.m1.6.6.3.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.6.6.3.2.1.1.3" xref="S3.E6.m1.6.6.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.4.3.3" xref="S3.E6.m1.7.7.4.3.3.cmml">​</mo><msub id="S3.E6.m1.7.7.4.3.4" xref="S3.E6.m1.7.7.4.3.4.cmml"><mi id="S3.E6.m1.7.7.4.3.4.2" xref="S3.E6.m1.7.7.4.3.4.2.cmml">p</mi><mi id="S3.E6.m1.7.7.4.3.4.3" xref="S3.E6.m1.7.7.4.3.4.3.cmml">SS</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.4.3.3a" xref="S3.E6.m1.7.7.4.3.3.cmml">​</mo><mrow id="S3.E6.m1.7.7.4.3.2.1" xref="S3.E6.m1.7.7.4.3.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.4.3.2.1.2" xref="S3.E6.m1.7.7.4.3.2.1.1.cmml">(</mo><mrow id="S3.E6.m1.7.7.4.3.2.1.1" xref="S3.E6.m1.7.7.4.3.2.1.1.cmml"><msub id="S3.E6.m1.7.7.4.3.2.1.1.3" xref="S3.E6.m1.7.7.4.3.2.1.1.3.cmml"><mi id="S3.E6.m1.7.7.4.3.2.1.1.3.2" xref="S3.E6.m1.7.7.4.3.2.1.1.3.2.cmml">y</mi><mi id="S3.E6.m1.7.7.4.3.2.1.1.3.3" xref="S3.E6.m1.7.7.4.3.2.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E6.m1.7.7.4.3.2.1.1.2" xref="S3.E6.m1.7.7.4.3.2.1.1.2.cmml">|</mo><mrow id="S3.E6.m1.7.7.4.3.2.1.1.1.1" xref="S3.E6.m1.7.7.4.3.2.1.1.1.2.cmml"><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">x</mi><mo id="S3.E6.m1.7.7.4.3.2.1.1.1.1.2" xref="S3.E6.m1.7.7.4.3.2.1.1.1.2.cmml">,</mo><msub id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.2" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.1" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.2" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.1" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.3" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.E6.m1.7.7.4.3.2.1.3" xref="S3.E6.m1.7.7.4.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.cmml" xref="S3.E6.m1.7.7"><eq id="S3.E6.m1.7.7.5.cmml" xref="S3.E6.m1.7.7.5"></eq><apply id="S3.E6.m1.4.4.1.cmml" xref="S3.E6.m1.4.4.1"><times id="S3.E6.m1.4.4.1.2.cmml" xref="S3.E6.m1.4.4.1.2"></times><ci id="S3.E6.m1.4.4.1.3.cmml" xref="S3.E6.m1.4.4.1.3">𝑝</ci><apply id="S3.E6.m1.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.2">conditional</csymbol><apply id="S3.E6.m1.4.4.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3.2">𝑦</ci><ci id="S3.E6.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3.3">𝑡</ci></apply><list id="S3.E6.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑥</ci><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2"><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3"><lt id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply><apply id="S3.E6.m1.7.7.4.cmml" xref="S3.E6.m1.7.7.4"><plus id="S3.E6.m1.7.7.4.4.cmml" xref="S3.E6.m1.7.7.4.4"></plus><apply id="S3.E6.m1.5.5.2.1.cmml" xref="S3.E6.m1.5.5.2.1"><times id="S3.E6.m1.5.5.2.1.2.cmml" xref="S3.E6.m1.5.5.2.1.2"></times><apply id="S3.E6.m1.5.5.2.1.3.cmml" xref="S3.E6.m1.5.5.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.1.3.1.cmml" xref="S3.E6.m1.5.5.2.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.2.1.3.2.cmml" xref="S3.E6.m1.5.5.2.1.3.2">𝜆</ci><ci id="S3.E6.m1.5.5.2.1.3.3.cmml" xref="S3.E6.m1.5.5.2.1.3.3">𝑠</ci></apply><apply id="S3.E6.m1.5.5.2.1.4.cmml" xref="S3.E6.m1.5.5.2.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.1.4.1.cmml" xref="S3.E6.m1.5.5.2.1.4">subscript</csymbol><ci id="S3.E6.m1.5.5.2.1.4.2.cmml" xref="S3.E6.m1.5.5.2.1.4.2">𝑝</ci><apply id="S3.E6.m1.5.5.2.1.4.3.cmml" xref="S3.E6.m1.5.5.2.1.4.3"><times id="S3.E6.m1.5.5.2.1.4.3.1.cmml" xref="S3.E6.m1.5.5.2.1.4.3.1"></times><ci id="S3.E6.m1.5.5.2.1.4.3.2.cmml" xref="S3.E6.m1.5.5.2.1.4.3.2">𝐴</ci><ci id="S3.E6.m1.5.5.2.1.4.3.3.cmml" xref="S3.E6.m1.5.5.2.1.4.3.3">𝑆</ci><ci id="S3.E6.m1.5.5.2.1.4.3.4.cmml" xref="S3.E6.m1.5.5.2.1.4.3.4">𝑅</ci></apply></apply><apply id="S3.E6.m1.5.5.2.1.1.1.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.2.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.2">conditional</csymbol><apply id="S3.E6.m1.5.5.2.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.3.2">𝑦</ci><ci id="S3.E6.m1.5.5.2.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S3.E6.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1"><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑥</ci><apply id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2"><ci id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3"><lt id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply><apply id="S3.E6.m1.7.7.4.3.cmml" xref="S3.E6.m1.7.7.4.3"><times id="S3.E6.m1.7.7.4.3.3.cmml" xref="S3.E6.m1.7.7.4.3.3"></times><apply id="S3.E6.m1.6.6.3.2.1.1.1.cmml" xref="S3.E6.m1.6.6.3.2.1.1"><minus id="S3.E6.m1.6.6.3.2.1.1.1.1.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.6.6.3.2.1.1.1.2.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.2">1</cn><apply id="S3.E6.m1.6.6.3.2.1.1.1.3.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.3.2.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.3.2.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.3.2">𝜆</ci><ci id="S3.E6.m1.6.6.3.2.1.1.1.3.3.cmml" xref="S3.E6.m1.6.6.3.2.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S3.E6.m1.7.7.4.3.4.cmml" xref="S3.E6.m1.7.7.4.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.4.3.4.1.cmml" xref="S3.E6.m1.7.7.4.3.4">subscript</csymbol><ci id="S3.E6.m1.7.7.4.3.4.2.cmml" xref="S3.E6.m1.7.7.4.3.4.2">𝑝</ci><ci id="S3.E6.m1.7.7.4.3.4.3.cmml" xref="S3.E6.m1.7.7.4.3.4.3">SS</ci></apply><apply id="S3.E6.m1.7.7.4.3.2.1.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.4.3.2.1.1.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.2">conditional</csymbol><apply id="S3.E6.m1.7.7.4.3.2.1.1.3.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.4.3.2.1.1.3.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.4.3.2.1.1.3.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.3.2">𝑦</ci><ci id="S3.E6.m1.7.7.4.3.2.1.1.3.3.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.3.3">𝑡</ci></apply><list id="S3.E6.m1.7.7.4.3.2.1.1.1.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑥</ci><apply id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2"><ci id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.1">^</ci><ci id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3"><lt id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.7.7.4.3.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">p(y_{t}|x,\hat{y}_{&lt;t})=\lambda_{s}p_{ASR}(y_{t}|x,\hat{y}_{&lt;t})+(1-\lambda_{s})p_{\mathrm{SS}}(y_{t}|x,\hat{y}_{&lt;t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">For training, we fix the pre-trained ASR model and only optimize the Speaker-Smoothed kNN network by minimizing the cross entropy loss following Equation (<a href="#S3.E6" title="In 3.3 Prediction and Training ‣ 3 Method ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>), which could be very efficient by only utilizing hundreds of training samples.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Subdialect</span></th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.1.1.2.1" class="ltx_text" style="font-size:90%;">#Hours</span></th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.1.1.3.1" class="ltx_text" style="font-size:90%;">#Million Tokens</span></th>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<th id="S4.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.2.2.1.1" class="ltx_text" style="font-size:90%;">All-Domain</span></th>
<th id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.2.2.2.1" class="ltx_text" style="font-size:90%;">860</span></th>
<th id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.2.2.3.1" class="ltx_text" style="font-size:90%;">11</span></th>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<th id="S4.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="3"><span id="S4.T1.1.3.3.1.1" class="ltx_text" style="font-size:90%;">In-Domain</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.4.1" class="ltx_tr">
<th id="S4.T1.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.4.1.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Zhongyuan</span></th>
<td id="S4.T1.1.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.4.1.2.1" class="ltx_text" style="font-size:90%;">84</span></td>
<td id="S4.T1.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.4.1.3.1" class="ltx_text" style="font-size:90%;">1.6</span></td>
</tr>
<tr id="S4.T1.1.5.2" class="ltx_tr">
<th id="S4.T1.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.5.2.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Southwestern</span></th>
<td id="S4.T1.1.5.2.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.5.2.2.1" class="ltx_text" style="font-size:90%;">75</span></td>
<td id="S4.T1.1.5.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.5.2.3.1" class="ltx_text" style="font-size:90%;">1.4</span></td>
</tr>
<tr id="S4.T1.1.6.3" class="ltx_tr">
<th id="S4.T1.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.6.3.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ji-Lu</span></th>
<td id="S4.T1.1.6.3.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.6.3.2.1" class="ltx_text" style="font-size:90%;">59</span></td>
<td id="S4.T1.1.6.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.6.3.3.1" class="ltx_text" style="font-size:90%;">1.1</span></td>
</tr>
<tr id="S4.T1.1.7.4" class="ltx_tr">
<th id="S4.T1.1.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.7.4.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Jiang-Huai</span></th>
<td id="S4.T1.1.7.4.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.7.4.2.1" class="ltx_text" style="font-size:90%;">46</span></td>
<td id="S4.T1.1.7.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T1.1.7.4.3.1" class="ltx_text" style="font-size:90%;">0.9</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Number hours and tokens of in-domain and all-domain data collection in KeSpeech.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We leverage the Whisper-medium pre-trained model for tracking speaker mismatches. This model demonstrates impressive efficacy on Mandarin Chinese tests. A pre-trained speaker recognition model aids <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> in extracting embeddings for similarity assessments and calculating variable <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">s</annotation></semantics></math> as per Section 3.2.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">For training and kNN datastore construction, the KeSpeech <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://github.com/KeSpeech/KeSpeech" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/KeSpeech/KeSpeech</a></span></span></span> corpora is employed. We perform two categories of experiments based on datasets: (1) In-domain setting, we train exclusively with a dataset composed of a single subdialect; and (2) All-domain setting, utilizing the entire KeSpeech corpus - an open-source dataset of Mandarin and eight subdialects. We deploy phase-1 of KeSpeech, offering 895 hours of data from 34 cities across China. Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiment ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> details training data and datastore size.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">Our evaluation employs two test sets based on speaker variation: (1) Single speaker test set. For this, we utilize two open-source datasets from the MagicData <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://magichub.com/datasets" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://magichub.com/datasets</a></span></span></span>: the Sichuan and Zhengzhou corpora, each representing Southwestern and Zhongyuan Mandarin dialects, respectively. These single speaker adaptation test sets consist of 20 speakers, each providing approximately 30 minutes of speech. The test sets are allocated following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, allocating 10 minutes for adaptation and 20 minutes for testing. (2) Multi-speaker test set. Here, we leverage the entire KeSpeech test set for evaluating performance in scenarios with varying speakers.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">For nearest neighbor retrieval, we construct a FAISS index <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. We leverage inverted file system and product quantization for quick retrieval from large databases. Keys of examples are stored in fp16 format to conserve memory.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In training our Speaker-Smoothed network, the hidden size is set to 32. We directly use the KeSpeech dev set, training the network for about 4,000 steps. Our model is optimized with Adam, with a learning rate of 3e-4 and a batch size of 32.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">During inference, we set the beam search size to 5 and retain other parameters by default
for all settings. For kNN retrieval, we set top <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">k</annotation></semantics></math> as 32, <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\lambda</annotation></semantics></math> as 0.4 and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">T</annotation></semantics></math> as 1000 for all experiments.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.3.1" class="ltx_tr">
<th id="S4.T2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" rowspan="2"><span id="S4.T2.2.3.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<td id="S4.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="2"><span id="S4.T2.2.3.1.2.1" class="ltx_text" style="font-size:90%;">Single Speaker</span></td>
<td id="S4.T2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="2"><span id="S4.T2.2.3.1.3.1" class="ltx_text" style="font-size:90%;">Multi Speaker</span></td>
</tr>
<tr id="S4.T2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.3.1" class="ltx_text" style="font-size:90%;">CER</span></td>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\Delta</annotation></semantics></math></td>
<td id="S4.T2.2.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.4.1" class="ltx_text" style="font-size:90%;">CER</span></td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><math id="S4.T2.2.2.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T2.2.2.2.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\Delta</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.2.4.2" class="ltx_tr">
<th id="S4.T2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.4.2.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Baseline</span></th>
<td id="S4.T2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.4.2.2.1" class="ltx_text" style="font-size:90%;">29.17</span></td>
<td id="S4.T2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.4.2.3.1" class="ltx_text" style="font-size:90%;">NA</span></td>
<td id="S4.T2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.4.2.4.1" class="ltx_text" style="font-size:90%;">36.71</span></td>
<td id="S4.T2.2.4.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.4.2.5.1" class="ltx_text" style="font-size:90%;">NA</span></td>
</tr>
<tr id="S4.T2.2.5.3" class="ltx_tr">
<th id="S4.T2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="5"><span id="S4.T2.2.5.3.1.1" class="ltx_text" style="font-size:90%;">In-Domain Setting</span></th>
</tr>
<tr id="S4.T2.2.6.4" class="ltx_tr">
<th id="S4.T2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.6.4.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Fine-tune</span></th>
<td id="S4.T2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.6.4.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">17.29</span></td>
<td id="S4.T2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.6.4.3.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">11.88</span></td>
<td id="S4.T2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.6.4.4.1" class="ltx_text" style="font-size:90%;">52.31</span></td>
<td id="S4.T2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.6.4.5.1" class="ltx_text" style="font-size:90%;">-15.60</span></td>
</tr>
<tr id="S4.T2.2.7.5" class="ltx_tr">
<th id="S4.T2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.7.5.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">kNN</span></th>
<td id="S4.T2.2.7.5.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.7.5.2.1" class="ltx_text" style="font-size:90%;">17.92</span></td>
<td id="S4.T2.2.7.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.7.5.3.1" class="ltx_text" style="font-size:90%;">11.25</span></td>
<td id="S4.T2.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.7.5.4.1" class="ltx_text" style="font-size:90%;">47.5</span></td>
<td id="S4.T2.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.7.5.5.1" class="ltx_text" style="font-size:90%;">-10.79</span></td>
</tr>
<tr id="S4.T2.2.8.6" class="ltx_tr">
<th id="S4.T2.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.8.6.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ours</span></th>
<td id="S4.T2.2.8.6.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.8.6.2.1" class="ltx_text" style="font-size:90%;">17.74</span></td>
<td id="S4.T2.2.8.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.8.6.3.1" class="ltx_text" style="font-size:90%;">11.43</span></td>
<td id="S4.T2.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.8.6.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">19.18</span></td>
<td id="S4.T2.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.8.6.5.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">17.53</span></td>
</tr>
<tr id="S4.T2.2.9.7" class="ltx_tr">
<th id="S4.T2.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="5"><span id="S4.T2.2.9.7.1.1" class="ltx_text" style="font-size:90%;">All-Domain Setting</span></th>
</tr>
<tr id="S4.T2.2.10.8" class="ltx_tr">
<th id="S4.T2.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.10.8.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Fine-tune</span></th>
<td id="S4.T2.2.10.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.10.8.2.1" class="ltx_text" style="font-size:90%;">18.92</span></td>
<td id="S4.T2.2.10.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.10.8.3.1" class="ltx_text" style="font-size:90%;">10.25</span></td>
<td id="S4.T2.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.10.8.4.1" class="ltx_text" style="font-size:90%;">13.05</span></td>
<td id="S4.T2.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.10.8.5.1" class="ltx_text" style="font-size:90%;">23.66</span></td>
</tr>
<tr id="S4.T2.2.11.9" class="ltx_tr">
<th id="S4.T2.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.11.9.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">SAT</span></th>
<td id="S4.T2.2.11.9.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.11.9.2.1" class="ltx_text" style="font-size:90%;">18.2</span></td>
<td id="S4.T2.2.11.9.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.11.9.3.1" class="ltx_text" style="font-size:90%;">10.97</span></td>
<td id="S4.T2.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.11.9.4.1" class="ltx_text" style="font-size:90%;">14.26</span></td>
<td id="S4.T2.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.11.9.5.1" class="ltx_text" style="font-size:90%;">22.45</span></td>
</tr>
<tr id="S4.T2.2.12.10" class="ltx_tr">
<th id="S4.T2.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.12.10.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">PAT</span></th>
<td id="S4.T2.2.12.10.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.12.10.2.1" class="ltx_text" style="font-size:90%;">17.66</span></td>
<td id="S4.T2.2.12.10.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.12.10.3.1" class="ltx_text" style="font-size:90%;">11.51</span></td>
<td id="S4.T2.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.12.10.4.1" class="ltx_text" style="font-size:90%;">12.81</span></td>
<td id="S4.T2.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.12.10.5.1" class="ltx_text" style="font-size:90%;">23.90</span></td>
</tr>
<tr id="S4.T2.2.13.11" class="ltx_tr">
<th id="S4.T2.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.13.11.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">kNN</span></th>
<td id="S4.T2.2.13.11.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.13.11.2.1" class="ltx_text" style="font-size:90%;">18.11</span></td>
<td id="S4.T2.2.13.11.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.13.11.3.1" class="ltx_text" style="font-size:90%;">11.06</span></td>
<td id="S4.T2.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.13.11.4.1" class="ltx_text" style="font-size:90%;">16.47</span></td>
<td id="S4.T2.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.13.11.5.1" class="ltx_text" style="font-size:90%;">20.24</span></td>
</tr>
<tr id="S4.T2.2.14.12" class="ltx_tr">
<th id="S4.T2.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.14.12.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Ours</span></th>
<td id="S4.T2.2.14.12.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.14.12.2.1" class="ltx_text" style="font-size:90%;">17.54</span></td>
<td id="S4.T2.2.14.12.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.14.12.3.1" class="ltx_text" style="font-size:90%;">11.63</span></td>
<td id="S4.T2.2.14.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.14.12.4.1" class="ltx_text" style="font-size:90%;">12.3</span></td>
<td id="S4.T2.2.14.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.14.12.5.1" class="ltx_text" style="font-size:90%;">24.41</span></td>
</tr>
<tr id="S4.T2.2.15.13" class="ltx_tr">
<th id="S4.T2.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.15.13.1.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Fine-tune+Ours</span></th>
<td id="S4.T2.2.15.13.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.15.13.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">16.82</span></td>
<td id="S4.T2.2.15.13.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.15.13.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">12.35</span></td>
<td id="S4.T2.2.15.13.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.15.13.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">12.03</span></td>
<td id="S4.T2.2.15.13.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.15.13.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">24.68</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Main Results in two settings. <math id="S4.T2.4.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T2.4.m1.1b"><mi mathvariant="normal" id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><ci id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">\Delta</annotation></semantics></math> means the difference from baseline.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Main Results</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Implementation Details ‣ 4 Experiment ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares the proposed method with other adaptation methods in terms of CER on single and multi speakers. The Whisper baseline results showed that the CER performance was poor in both test sets, with mismatch.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">In the in-domain experiment, fine-tuning yielded optimal results for single speaker adaptation. Yet, due to catastrophic forgetting, the multi-speaker test set experienced a CER increase. The kNN method's significant CER decline on the single speaker test set denotes its effectiveness, but rise in the multi-speaker due to mismatching and inability to reject noise. Our Speaker-Smoothed kNN method, albeit slightly weaker than fine-tuning, excelled on the multi-speaker test set.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">In the All-domain experiment, fine-tuning underperformed compared to its in-domain variant on the single speaker test set. Still, the multi-speaker test set's CER significantly reduced compared to the baseline, owing to a complete match. We implemented speaker-aware training (SAT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, applicable to various ASR models, and PAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, learning speaker adaptation from the training dataset, for comparison, maintaining the same supervised settings. Both SAT and kNN fell short of fine-tuning on the multi-speaker test set. Our proposed method, however, outperformed on both single and multi-speaker test sets, enhancing further when used continuously on a fine-tuning base.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2406.04791/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Left side is the CER trend of different methods when use different top k, right side is the CER trend in different sample datastore size. Both experiment done on the multi-speaker test of all-domain setting. </figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In the all-domain experimental setting with a multi-speaker test set, as shown on the left of Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3 Main Results ‣ 4 Experiment ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the top k types of noise increase gradually as k expands, particularly for sparse data. Compared to the direct application of kNN, and Kster <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, which employ a similar smoothed network without an x-vector, performance diminishes to various extents. As displayed on the right of Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3 Main Results ‣ 4 Experiment ‣ Speaker-Smoothed kNN Speaker Adaptation for End-to-End ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, as the datastore contracts, the noise volume incrementally escalates, and our method exhibits a more gradual decline. These two experiments underscore that our Speaker-Smoothed method handles error recalls more effectively.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Inference Cost</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">The inference expense of kNN memorization retrieval, discussed in previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, may result in reduced speed as the datastore expands. This study explores this on the all-domain setting based on Whisper-medium. With a batch size of 16, we find that the average inference speed is 87.1% of that of the kNN-free method (given that the weight of the SRE model is relatively light, its consumption was disregarded). In practice, this speed reduction is acceptable as it represents a balancing act between performance and processing time. To achieve superior inference speed, we could potentially replace it with other memorization-retrieval variants <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. This is a prospect for future work.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Our research presents a novel approach to enhancing E2E speaker adaptation performance through Speaker-Smoothed kNN, notably in situations of limited adaptation data. By utilizing x-vector information, we achieve dynamic adjustment of interpolation ratios, leveraging the similarity in voice characters of training data. We attain considerable improvement, outperforming established techniques like fine-tuning and speaker-aware training in the KeSpeech and MagicData test sets. By demonstrating the compelling application of kNN in ASR speaker adaptation, we pave the way for future inquiries into this promising area.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Watanabe, T. Hori, S. Kim, J. R. Hershey, and T. Hayashi, ``Hybrid ctc/attention architecture for end-to-end speech recognition,'' <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Journal of Selected Topics in Signal Processing</em>, p. 1240–1253, Dec 2017. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.1109/jstsp.2017.2763455" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1109/jstsp.2017.2763455</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
T. N. Sainath, Y. He, B. Li, A. Narayanan, R. Pang, A. Bruguier, S. yiin Chang, W. Li, R. Alvarez, Z. Chen, C.-C. Chiu, D. Garcia, A. Gruenstein, K. Hu, M. Jin, A. Kannan, Q. Liang, I. McGraw, C. Peyser, R. Prabhavalkar, G. Pundak, D. Rybach, Y. Shangguan, Y. Sheth, T. Strohman, M. Visontai, Y. Wu, Y. Zhang, and D. Zhao, ``A streaming on-device end-to-end model surpassing server-side conventional model quality and latency,'' 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Y. Huang, G. Ye, J. Li, and Y. Gong, ``Rapid speaker adaptation for conformer transducer: Attention and bias are all you need,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Interspeech 2021</em>, Aug 2021. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.21437/interspeech.2021-1884" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.21437/interspeech.2021-1884</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
P. Swietojanski and S. Renals, ``Learning hidden unit contributions for unsupervised speaker adaptation of neural network acoustic models,'' in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2014 IEEE Spoken Language Technology Workshop (SLT)</em>, 2014, pp. 171–176.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
X. Xie, X. Liu, T. Lee, and L. Wang, ``Bayesian learning for deep neural network adaptation,'' <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em>, vol. 29, pp. 2096–2110, 2020. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:229156237" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:229156237</a>

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
H. Liao, ``Speaker adaptation of context dependent deep neural networks,'' in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">2013 IEEE International Conference on Acoustics, Speech and Signal Processing</em>, May 2013. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.1109/icassp.2013.6639212" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1109/icassp.2013.6639212</a>

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
D. Yu, K. Yao, H. Su, G. Li, and F. Seide, ``Kl-divergence regularized deep neural network adaptation for improved large vocabulary speech recognition,'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">2013 IEEE International Conference on Acoustics, Speech and Signal Processing</em>, May 2013. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.1109/icassp.2013.6639201" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1109/icassp.2013.6639201</a>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Z. Meng, Y. Gaur, J. Li, and Y. Gong, ``Speaker adaptation for attention-based end-to-end speech recognition,'' in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:202719968" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:202719968</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
K. Yang, T.-Y. Hu, J.-H. R. Chang, H. S. Koppula, and O. Tuzel, ``Text is all you need: Personalizing asr models using controllable speech synthesis,'' 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
N. Dehak, P. J. Kenny, R. Dehak, P. Dumouchel, and P. Ouellet, ``Front-end factor analysis for speaker verification,'' <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Audio, Speech, and Language Processing</em>, vol. 19, no. 4, pp. 788–798, 2011.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
D. Snyder, D. Garcia-Romero, G. Sell, D. Povey, and S. Khudanpur, ``X-vectors: Robust dnn embeddings for speaker recognition,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2018 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, Apr 2018. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.1109/icassp.2018.8461375" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1109/icassp.2018.8461375</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
F. Seide, G. Li, X. Chen, and D. Yu, ``Feature engineering in context-dependent deep neural networks for conversational speech transcription,'' in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">2011 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</em>, December 2011.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
N. Tomashenko and Y. Estève, ``Evaluation of feature-space speaker adaptation for end-to-end acoustic models,'' in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Eleventh International Conference on Language Resources and Evaluation (LREC 2018)</em>, 2018. [Online]. Available: <a target="_blank" href="https://www.aclweb.org/anthology/L18-1500" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/L18-1500</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
G. Saon, H. Soltau, D. Nahamoo, and M. Picheny, ``Speaker adaptation of neural network acoustic models using i-vectors,'' in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2013 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</em>, 2013.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Senior and I. Lopez-Moreno, ``Improving DNN speaker independence with i-vector inputs,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2014 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2014.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
K. Vesely, S. Watanabe, K. Zmolikova, M. Karafiat, L. Burget, and J. H. Cernocky, ``Sequence summarizing neural network for speaker adaptation,'' in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">2016 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2016, pp. 5315–5319.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
T. Kim, I. Song, and Y. Bengio, ``Dynamic layer normalization for adaptive neural acoustic modeling in speech recognition,'' in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">INTERSPEECH 2017 – 18<sup id="bib.bib17.1.1.1" class="ltx_sup">th</sup> Annual Conference of the International Speech Communication Association</em>, 2017. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/1707.06065" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1707.06065</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
L. Sarı, N. Moritz, T. Hori, and J. L. Roux, ``Unsupervised speaker adaptation using attention-based speaker memory for end-to-end asr,'' 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Zhao, C. Ni, C.-C. Leung, S. Joty, E. S. Chng, and B. Ma, ``Speech Transformer with Speaker Aware Persistent Memory,'' in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 1261–1265.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
U. Khandelwal, O. Levy, and D. J. et al., ``Generalization through memorization: Nearest neighbor language models,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
U. Khandelwal, A. Fan, D. Jurafsky, L. Zettlemoyer, and M. Lewis, ``Nearest neighbor machine translation,'' in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Zhou, S. Zhao, Y. Liu, W. Zeng, Y. Chen, and Y. Qin, ``Knn-ctc: Enhancing asr via retrieval of ctc pseudo labels,'' in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ICASSP 2024 - 2024 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2024, pp. 11 006–11 010.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Q. Jiang, M. Wang, J. Cao, S. Cheng, S. Huang, and L. Li, ``Learning kernel-smoothed machine translation with retrieved examples,'' 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Gu, Z. Du, S. Zhang, Q. Chen, and J. Han, ``Personality-aware Training based Speaker Adaptation for End-to-end Speech Recognition,'' in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, 2023, pp. 1249–1253.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, L. Kaiser, and I. Polosukhin, ``Attention is all you need,'' 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
D. Snyder, D. Garcia-Romero, G. Sell, D. Povey, and S. Khudanpur, ``X-vectors: Robust dnn embeddings for speaker recognition,'' in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">2018 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2018, pp. 5329–5333.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z. Bai and X.-L. Zhang, ``Speaker recognition based on deep learning: An overview,'' 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Dai, Z. Zhang, Q. Liu, Q. Cui, W. Li, Y. Du, and T. Xu, ``Simple and scalable nearest neighbor machine translation,'' in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
X. Zheng, Z. Zhang, J. Guo, S. Huang, B. Chen, W. Luo, and J. Chen, ``Adaptive nearest neighbor machine translation,'' in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ACL</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
F. Landini, J. Profant, M. Diez, and L. Burget, ``Bayesian hmm clustering of x-vector sequences (vbx) in speaker diarization: theory, implementation and analysis on standard tasks,'' <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv: Audio and Speech Processing,arXiv: Audio and Speech Processing</em>, Dec 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
J. Johnson, M. Douze, and H. Jégou, ``Billion-scale similarity search with gpus,'' <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Big Data</em>, vol. 7, no. 3, pp. 535–547, 2021. [Online]. Available: <a target="_blank" href="https://doi.org/10.1109/TBDATA.2019.2921572" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/TBDATA.2019.2921572</a>

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Du, W. Wang, Z. Zhang, B. Chen, T. Xu, J. Xie, and E. Chen, ``Non-parametric domain adaptation for end-to-end speech translation,'' in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Meng, X. Li, X. Zheng, F. Wu, X. Sun, T. Zhang, and J. Li, ``Fast nearest neighbor machine translation,'' in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Findings of ACL</em>, 2022.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.04790" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.04791" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.04791">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.04791" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.04792" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 19:43:08 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
