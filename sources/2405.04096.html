<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.04096] Speaker Characterization by means of Attention Pooling</title><meta property="og:description" content="State-of-the-art Deep Learning systems for speaker verification are commonly based on speaker embedding extractors.
These architectures are usually composed of a feature extractor front-end together with a pooling laye…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Speaker Characterization by means of Attention Pooling">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Speaker Characterization by means of Attention Pooling">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.04096">

<!--Generated on Wed Jun  5 18:09:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document" style="font-size:90%;">Speaker Characterization by means of Attention Pooling</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p"><span id="id1.id1.1" class="ltx_text" style="font-size:90%;">State-of-the-art Deep Learning systems for speaker verification are commonly based on speaker embedding extractors.
These architectures are usually composed of a feature extractor front-end together with a pooling layer to encode variable-length utterances into fixed-length speaker vectors.
The authors have recently proposed the use of a Double Multi-Head Self-Attention pooling for speaker recognition, placed between a CNN-based front-end and a set of fully connected layers.
This has shown to be an excellent approach to efficiently select the most relevant features captured by the front-end from the speech signal.
In this paper we show excellent experimental results by adapting this architecture to other different speaker characterization tasks, such as emotion recognition, sex classification and COVID-19 detection.</span></p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Index Terms</span><span id="p1.1.2" class="ltx_text" style="font-size:90%;">: multi-head self-attention, double attention, speech recognition, speaker verification, speaker characterization</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span id="S1.p1.1.1" class="ltx_text" style="font-size:90%;">Speaker Verification (SV) aims to determine whether a pair of audios corresponds to the same speaker.
Given speech signals, speaker verification systems are able to extract speaker identity patterns from the characteristics of the voice.
State-of-the-art SV systems are commonly Deep Learning (DL) approaches that encode speaker characteristics into discriminative speaker vectors (also known as speaker embeddings).
These architectures are usually trained as speaker classifiers in order to be used as speaker embedding extractors.
One of the most known speaker representations is the x-vector </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.4" class="ltx_text" style="font-size:90%;">, which has become state-of-the-art for speaker recognition.
Recent network architectures used for speaker embedding generation are composed of a front-end feature extractor, a pooling layer and a set of Fully Connected (FC) layers.
During the last years, several studies addressed different types of pooling strategies </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.7" class="ltx_text" style="font-size:90%;">.
X-vector originally uses statistical pooling </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S1.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.10" class="ltx_text" style="font-size:90%;">.
Self-attention mechanisms have been used to improve statistical pooling, such as </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S1.p1.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.13" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text" style="font-size:90%;">Some of these speaker embedding generation systems can be adapted and used to solve Speaker Characterization (SC) tasks </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S1.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.4" class="ltx_text" style="font-size:90%;">.
SC tasks are those where one or more speaker characteristics are extracted from the speech.
In the last years, DL approaches were used in order to extract speaker characteristics from speech such as emotions </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S1.p2.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.7" class="ltx_text" style="font-size:90%;">, sex </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S1.p2.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.10" class="ltx_text" style="font-size:90%;">, age </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S1.p2.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.13" class="ltx_text" style="font-size:90%;">, language </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib13" title="" class="ltx_ref">13</a><span id="S1.p2.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.16" class="ltx_text" style="font-size:90%;">, dialect </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.17.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S1.p2.1.18.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.19" class="ltx_text" style="font-size:90%;">, accent </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.20.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S1.p2.1.21.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.22" class="ltx_text" style="font-size:90%;">, health conditions </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.23.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S1.p2.1.24.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.25" class="ltx_text" style="font-size:90%;">, among others.</span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text" style="font-size:90%;">The authors have recently proposed a DL system based on a Double Multi-Head Self-Attention (DMHSA) pooling </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S1.p3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.4" class="ltx_text" style="font-size:90%;">.
Its architecture consists of a Convolutional Neural Network (CNN)-based front-end, followed by an attention-based pooling layer and a set of fully connected layers.
It has been proven to achieve excellent results in SV tasks and it is an improvement of the Multi-Head Self-Attention (MHSA) pooling method proposed in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S1.p3.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.7" class="ltx_text" style="font-size:90%;">.
Since this system is trained as a speaker classifier, it can be adapted to solve SC tasks.
In this paper we will present several applications using an adapted version of this architecture on different SC tasks, namely Speech Emotion Recognition (SER), Speaker Sex Classification and Speaker COVID-19 Detection, achieving excellent results.
We would like to mention that all Speaker COVID-19 Detection results obtained in this work are meant for exploratory purposes and should not be taken to draw any medical conclusions.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text" style="font-size:90%;">The rest of this paper is structured as follows.
Section 2 explains DMHSA pooling.
Section 3 gives the details of the DMHSA system applied to SV, with the experimental setup and results included.
Section 4 gives the details of the DMHSA system applied to SC, with several applications and their experimental setup and results included.
The concluding remarks are given in Section 5.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">2 </span>Double Multi-Head Self-Attention Pooling</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text" style="font-size:90%;">In </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S2.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p1.1.4" class="ltx_text" style="font-size:90%;">, DMHSA Pooling was proposed. It is a DL system with an attention-based pooling layer that was developed for SV.
This model is trained as a speaker classifier, with the capability of learning effective discriminative speaker embeddings.
The system architecture is illustrated in Figure </span><a href="#S2.F1" title="Figure 1 ‣ 2 Double Multi-Head Self-Attention Pooling ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S2.p1.1.5" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p"><span id="S2.p2.3.1" class="ltx_text" style="font-size:90%;">The proposed network was trained to classify variable-length speaker utterances.
The system uses as input a spectrogram of the input audio, using the log Mel Spectrogram, with 25 milliseconds length Hamming windows and 10 milliseconds window shift.
It accepts variable length input of size </span><math id="S2.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.1.m1.1a"><mi mathsize="90%" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">N</annotation></semantics></math><span id="S2.p2.3.2" class="ltx_text" style="font-size:90%;"> (in frames) and has a fixed number of Mel bands </span><math id="S2.p2.2.m2.1" class="ltx_Math" alttext="M=80" display="inline"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">M</mi><mo mathsize="90%" id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">=</mo><mn mathsize="90%" id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><eq id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1"></eq><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑀</ci><cn type="integer" id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">M=80</annotation></semantics></math><span id="S2.p2.3.3" class="ltx_text" style="font-size:90%;">.
Then, the input resulting data is of size </span><math id="S2.p2.3.m3.1" class="ltx_Math" alttext="N\text{x}80" display="inline"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi mathsize="90%" id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.p2.3.m3.1.1.1" xref="S2.p2.3.m3.1.1.1.cmml">​</mo><mtext mathsize="90%" id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3a.cmml">x</mtext><mo lspace="0em" rspace="0em" id="S2.p2.3.m3.1.1.1a" xref="S2.p2.3.m3.1.1.1.cmml">​</mo><mn mathsize="90%" id="S2.p2.3.m3.1.1.4" xref="S2.p2.3.m3.1.1.4.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><times id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1"></times><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑁</ci><ci id="S2.p2.3.m3.1.1.3a.cmml" xref="S2.p2.3.m3.1.1.3"><mtext mathsize="90%" id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">x</mtext></ci><cn type="integer" id="S2.p2.3.m3.1.1.4.cmml" xref="S2.p2.3.m3.1.1.4">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">N\text{x}80</annotation></semantics></math><span id="S2.p2.3.4" class="ltx_text" style="font-size:90%;">.
The audio features have been normalized with Cepstral Mean Normalization.</span></p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2405.04096/assets/dmha_architecture.jpg" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="646" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>DMHA architecture.</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>CNN front-end feature extractor</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.14" class="ltx_p"><span id="S2.SS1.p1.14.1" class="ltx_text" style="font-size:90%;">The feature extractor network is an adapted version of the VGG proposed in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS1.p1.14.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib18" title="" class="ltx_ref">18</a><span id="S2.SS1.p1.14.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS1.p1.14.4" class="ltx_text" style="font-size:90%;">.
It is fed with </span><math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="N\text{x}80" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">​</mo><mtext mathsize="90%" id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3a.cmml">x</mtext><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.1.1.1a" xref="S2.SS1.p1.1.m1.1.1.1.cmml">​</mo><mn mathsize="90%" id="S2.SS1.p1.1.m1.1.1.4" xref="S2.SS1.p1.1.m1.1.1.4.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><times id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></times><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S2.SS1.p1.1.m1.1.1.3a.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><mtext mathsize="90%" id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">x</mtext></ci><cn type="integer" id="S2.SS1.p1.1.m1.1.1.4.cmml" xref="S2.SS1.p1.1.m1.1.1.4">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">N\text{x}80</annotation></semantics></math><span id="S2.SS1.p1.14.5" class="ltx_text" style="font-size:90%;"> spectrograms to obtain a sequence of encoded hidden representations
This CNN comprises 4 convolutional blocks, each of which contains two contatenated convolutional layers followed by a max pooling layer.
Each convolutional layer has a set of </span><math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mn mathsize="90%" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><cn type="integer" id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">3</annotation></semantics></math><span id="S2.SS1.p1.14.6" class="ltx_text" style="font-size:90%;">x</span><math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mn mathsize="90%" id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><cn type="integer" id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">3</annotation></semantics></math><span id="S2.SS1.p1.14.7" class="ltx_text" style="font-size:90%;"> filters with a stride of 1 (a same convolution).
Each max pooling layer consists of a </span><math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mn mathsize="90%" id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><cn type="integer" id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">2</annotation></semantics></math><span id="S2.SS1.p1.14.8" class="ltx_text" style="font-size:90%;">x</span><math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mn mathsize="90%" id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><cn type="integer" id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">2</annotation></semantics></math><span id="S2.SS1.p1.14.9" class="ltx_text" style="font-size:90%;"> max pooling with a stride of 2 (and no padding).
The first convolutional block applies a set of 128 filters, the second applies 256 filters, the third applies 512 filters and the fourth applies 1024 filters.
Hence, given a spectrogram of </span><math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi mathsize="90%" id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">N</annotation></semantics></math><span id="S2.SS1.p1.14.10" class="ltx_text" style="font-size:90%;"> frames and </span><math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi mathsize="90%" id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">M</annotation></semantics></math><span id="S2.SS1.p1.14.11" class="ltx_text" style="font-size:90%;"> features, the VGG performs a down-sampling reducing its output into a tensor of </span><math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="\frac{N}{16}" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mfrac id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">N</mi><mn mathsize="90%" id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">16</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><divide id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"></divide><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">𝑁</ci><cn type="integer" id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\frac{N}{16}</annotation></semantics></math><span id="S2.SS1.p1.14.12" class="ltx_text" style="font-size:90%;">x</span><math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\frac{M}{16}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mfrac id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">M</mi><mn mathsize="90%" id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">16</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><divide id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"></divide><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝑀</ci><cn type="integer" id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\frac{M}{16}</annotation></semantics></math><span id="S2.SS1.p1.14.13" class="ltx_text" style="font-size:90%;">x</span><math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="D^{\prime}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msup id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">D</mi><mo mathsize="90%" id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">superscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝐷</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">D^{\prime}</annotation></semantics></math><span id="S2.SS1.p1.14.14" class="ltx_text" style="font-size:90%;"> dimension, where </span><math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="D^{\prime}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msup id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">D</mi><mo mathsize="90%" id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">superscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝐷</ci><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">D^{\prime}</annotation></semantics></math><span id="S2.SS1.p1.14.15" class="ltx_text" style="font-size:90%;"> is the final quantity of channels.
This tensor is reshaped into a sequence of hidden states </span><math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="h_{i}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><msub id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml"><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.2.2" xref="S2.SS1.p1.12.m12.1.1.2.2.cmml">h</mi><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.2.3" xref="S2.SS1.p1.12.m12.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.SS1.p1.12.m12.1.1.1" xref="S2.SS1.p1.12.m12.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml"><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.3.2" xref="S2.SS1.p1.12.m12.1.1.3.2.cmml">ℝ</mi><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><in id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1.1"></in><apply id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.2.1.cmml" xref="S2.SS1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.2.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2.2">ℎ</ci><ci id="S2.SS1.p1.12.m12.1.1.2.3.cmml" xref="S2.SS1.p1.12.m12.1.1.2.3">𝑖</ci></apply><apply id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2">ℝ</ci><ci id="S2.SS1.p1.12.m12.1.1.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">h_{i}\in\mathbb{R}^{D}</annotation></semantics></math><span id="S2.SS1.p1.14.16" class="ltx_text" style="font-size:90%;">, with </span><math id="S2.SS1.p1.13.m13.3" class="ltx_Math" alttext="i=1,...,\frac{N}{16}" display="inline"><semantics id="S2.SS1.p1.13.m13.3a"><mrow id="S2.SS1.p1.13.m13.3.4" xref="S2.SS1.p1.13.m13.3.4.cmml"><mi mathsize="90%" id="S2.SS1.p1.13.m13.3.4.2" xref="S2.SS1.p1.13.m13.3.4.2.cmml">i</mi><mo mathsize="90%" id="S2.SS1.p1.13.m13.3.4.1" xref="S2.SS1.p1.13.m13.3.4.1.cmml">=</mo><mrow id="S2.SS1.p1.13.m13.3.4.3.2" xref="S2.SS1.p1.13.m13.3.4.3.1.cmml"><mn mathsize="90%" id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">1</mn><mo mathsize="90%" id="S2.SS1.p1.13.m13.3.4.3.2.1" xref="S2.SS1.p1.13.m13.3.4.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS1.p1.13.m13.2.2" xref="S2.SS1.p1.13.m13.2.2.cmml">…</mi><mo mathsize="90%" id="S2.SS1.p1.13.m13.3.4.3.2.2" xref="S2.SS1.p1.13.m13.3.4.3.1.cmml">,</mo><mfrac id="S2.SS1.p1.13.m13.3.3" xref="S2.SS1.p1.13.m13.3.3.cmml"><mi mathsize="90%" id="S2.SS1.p1.13.m13.3.3.2" xref="S2.SS1.p1.13.m13.3.3.2.cmml">N</mi><mn mathsize="90%" id="S2.SS1.p1.13.m13.3.3.3" xref="S2.SS1.p1.13.m13.3.3.3.cmml">16</mn></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.3b"><apply id="S2.SS1.p1.13.m13.3.4.cmml" xref="S2.SS1.p1.13.m13.3.4"><eq id="S2.SS1.p1.13.m13.3.4.1.cmml" xref="S2.SS1.p1.13.m13.3.4.1"></eq><ci id="S2.SS1.p1.13.m13.3.4.2.cmml" xref="S2.SS1.p1.13.m13.3.4.2">𝑖</ci><list id="S2.SS1.p1.13.m13.3.4.3.1.cmml" xref="S2.SS1.p1.13.m13.3.4.3.2"><cn type="integer" id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">1</cn><ci id="S2.SS1.p1.13.m13.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2">…</ci><apply id="S2.SS1.p1.13.m13.3.3.cmml" xref="S2.SS1.p1.13.m13.3.3"><divide id="S2.SS1.p1.13.m13.3.3.1.cmml" xref="S2.SS1.p1.13.m13.3.3"></divide><ci id="S2.SS1.p1.13.m13.3.3.2.cmml" xref="S2.SS1.p1.13.m13.3.3.2">𝑁</ci><cn type="integer" id="S2.SS1.p1.13.m13.3.3.3.cmml" xref="S2.SS1.p1.13.m13.3.3.3">16</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.3c">i=1,...,\frac{N}{16}</annotation></semantics></math><span id="S2.SS1.p1.14.17" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS1.p1.14.m14.1" class="ltx_Math" alttext="D=\frac{M}{16}\text{x}D^{\prime}" display="inline"><semantics id="S2.SS1.p1.14.m14.1a"><mrow id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.14.m14.1.1.2" xref="S2.SS1.p1.14.m14.1.1.2.cmml">D</mi><mo mathsize="90%" id="S2.SS1.p1.14.m14.1.1.1" xref="S2.SS1.p1.14.m14.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.14.m14.1.1.3" xref="S2.SS1.p1.14.m14.1.1.3.cmml"><mfrac id="S2.SS1.p1.14.m14.1.1.3.2" xref="S2.SS1.p1.14.m14.1.1.3.2.cmml"><mi mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.2.2" xref="S2.SS1.p1.14.m14.1.1.3.2.2.cmml">M</mi><mn mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.2.3" xref="S2.SS1.p1.14.m14.1.1.3.2.3.cmml">16</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p1.14.m14.1.1.3.1" xref="S2.SS1.p1.14.m14.1.1.3.1.cmml">​</mo><mtext mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.3" xref="S2.SS1.p1.14.m14.1.1.3.3a.cmml">x</mtext><mo lspace="0em" rspace="0em" id="S2.SS1.p1.14.m14.1.1.3.1a" xref="S2.SS1.p1.14.m14.1.1.3.1.cmml">​</mo><msup id="S2.SS1.p1.14.m14.1.1.3.4" xref="S2.SS1.p1.14.m14.1.1.3.4.cmml"><mi mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.4.2" xref="S2.SS1.p1.14.m14.1.1.3.4.2.cmml">D</mi><mo mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.4.3" xref="S2.SS1.p1.14.m14.1.1.3.4.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><apply id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1"><eq id="S2.SS1.p1.14.m14.1.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1.1"></eq><ci id="S2.SS1.p1.14.m14.1.1.2.cmml" xref="S2.SS1.p1.14.m14.1.1.2">𝐷</ci><apply id="S2.SS1.p1.14.m14.1.1.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3"><times id="S2.SS1.p1.14.m14.1.1.3.1.cmml" xref="S2.SS1.p1.14.m14.1.1.3.1"></times><apply id="S2.SS1.p1.14.m14.1.1.3.2.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2"><divide id="S2.SS1.p1.14.m14.1.1.3.2.1.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2"></divide><ci id="S2.SS1.p1.14.m14.1.1.3.2.2.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2.2">𝑀</ci><cn type="integer" id="S2.SS1.p1.14.m14.1.1.3.2.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2.3">16</cn></apply><ci id="S2.SS1.p1.14.m14.1.1.3.3a.cmml" xref="S2.SS1.p1.14.m14.1.1.3.3"><mtext mathsize="90%" id="S2.SS1.p1.14.m14.1.1.3.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3.3">x</mtext></ci><apply id="S2.SS1.p1.14.m14.1.1.3.4.cmml" xref="S2.SS1.p1.14.m14.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.3.4.1.cmml" xref="S2.SS1.p1.14.m14.1.1.3.4">superscript</csymbol><ci id="S2.SS1.p1.14.m14.1.1.3.4.2.cmml" xref="S2.SS1.p1.14.m14.1.1.3.4.2">𝐷</ci><ci id="S2.SS1.p1.14.m14.1.1.3.4.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3.4.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">D=\frac{M}{16}\text{x}D^{\prime}</annotation></semantics></math><span id="S2.SS1.p1.14.18" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Double Multi-Head Self Attention pooling</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.8" class="ltx_p"><span id="S2.SS2.p1.8.1" class="ltx_text" style="font-size:90%;">From the feature extractor, we get a sequence of hidden states </span><math id="S2.SS2.p1.1.m1.3" class="ltx_Math" alttext="h_{1},...,h_{N/16}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS2.p1.1.m1.3a"><mrow id="S2.SS2.p1.1.m1.3.3" xref="S2.SS2.p1.1.m1.3.3.cmml"><mrow id="S2.SS2.p1.1.m1.3.3.2.2" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml"><msub id="S2.SS2.p1.1.m1.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.1.m1.2.2.1.1.1.2" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml">h</mi><mn mathsize="90%" id="S2.SS2.p1.1.m1.2.2.1.1.1.3" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS2.p1.1.m1.3.3.2.2.3" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">…</mi><mo mathsize="90%" id="S2.SS2.p1.1.m1.3.3.2.2.4" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.1.m1.3.3.2.2.2" xref="S2.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.1.m1.3.3.2.2.2.2" xref="S2.SS2.p1.1.m1.3.3.2.2.2.2.cmml">h</mi><mrow id="S2.SS2.p1.1.m1.3.3.2.2.2.3" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.1.m1.3.3.2.2.2.3.2" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.2.cmml">N</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p1.1.m1.3.3.2.2.2.3.1" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.1.cmml">/</mo><mn mathsize="90%" id="S2.SS2.p1.1.m1.3.3.2.2.2.3.3" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.3.cmml">16</mn></mrow></msub></mrow><mo mathsize="90%" id="S2.SS2.p1.1.m1.3.3.3" xref="S2.SS2.p1.1.m1.3.3.3.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.3.3.4" xref="S2.SS2.p1.1.m1.3.3.4.cmml"><mi mathsize="90%" id="S2.SS2.p1.1.m1.3.3.4.2" xref="S2.SS2.p1.1.m1.3.3.4.2.cmml">ℝ</mi><mi mathsize="90%" id="S2.SS2.p1.1.m1.3.3.4.3" xref="S2.SS2.p1.1.m1.3.3.4.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.3b"><apply id="S2.SS2.p1.1.m1.3.3.cmml" xref="S2.SS2.p1.1.m1.3.3"><in id="S2.SS2.p1.1.m1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.3.3.3"></in><list id="S2.SS2.p1.1.m1.3.3.2.3.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2"><apply id="S2.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2">ℎ</ci><cn type="integer" id="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">…</ci><apply id="S2.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.2">ℎ</ci><apply id="S2.SS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3"><divide id="S2.SS2.p1.1.m1.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.1"></divide><ci id="S2.SS2.p1.1.m1.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.1.m1.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.3">16</cn></apply></apply></list><apply id="S2.SS2.p1.1.m1.3.3.4.cmml" xref="S2.SS2.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.3.3.4.1.cmml" xref="S2.SS2.p1.1.m1.3.3.4">superscript</csymbol><ci id="S2.SS2.p1.1.m1.3.3.4.2.cmml" xref="S2.SS2.p1.1.m1.3.3.4.2">ℝ</ci><ci id="S2.SS2.p1.1.m1.3.3.4.3.cmml" xref="S2.SS2.p1.1.m1.3.3.4.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.3c">h_{1},...,h_{N/16}\in\mathbb{R}^{D}</annotation></semantics></math><span id="S2.SS2.p1.8.2" class="ltx_text" style="font-size:90%;">.
If we consider a number of </span><math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi mathsize="90%" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">K</annotation></semantics></math><span id="S2.SS2.p1.8.3" class="ltx_text" style="font-size:90%;"> heads for the MHSA pooling, we split each hidden state </span><math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">h</mi><mi mathsize="90%" id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">ℎ</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">h_{t}</annotation></semantics></math><span id="S2.SS2.p1.8.4" class="ltx_text" style="font-size:90%;"> into </span><math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mi mathsize="90%" id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">K</annotation></semantics></math><span id="S2.SS2.p1.8.5" class="ltx_text" style="font-size:90%;"> new hidden states so that </span><math id="S2.SS2.p1.5.m5.3" class="ltx_Math" alttext="h_{t}=[h_{t1},...,h_{tK}]" display="inline"><semantics id="S2.SS2.p1.5.m5.3a"><mrow id="S2.SS2.p1.5.m5.3.3" xref="S2.SS2.p1.5.m5.3.3.cmml"><msub id="S2.SS2.p1.5.m5.3.3.4" xref="S2.SS2.p1.5.m5.3.3.4.cmml"><mi mathsize="90%" id="S2.SS2.p1.5.m5.3.3.4.2" xref="S2.SS2.p1.5.m5.3.3.4.2.cmml">h</mi><mi mathsize="90%" id="S2.SS2.p1.5.m5.3.3.4.3" xref="S2.SS2.p1.5.m5.3.3.4.3.cmml">t</mi></msub><mo mathsize="90%" id="S2.SS2.p1.5.m5.3.3.3" xref="S2.SS2.p1.5.m5.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.5.m5.3.3.2.2" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.3" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p1.5.m5.2.2.1.1.1" xref="S2.SS2.p1.5.m5.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.5.m5.2.2.1.1.1.2" xref="S2.SS2.p1.5.m5.2.2.1.1.1.2.cmml">h</mi><mrow id="S2.SS2.p1.5.m5.2.2.1.1.1.3" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.5.m5.2.2.1.1.1.3.2" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.m5.2.2.1.1.1.3.1" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.1.cmml">​</mo><mn mathsize="90%" id="S2.SS2.p1.5.m5.2.2.1.1.1.3.3" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo mathsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.4" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">…</mi><mo mathsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.5" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.5.m5.3.3.2.2.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.2.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.2.cmml">h</mi><mrow id="S2.SS2.p1.5.m5.3.3.2.2.2.3" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.2.3.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.m5.3.3.2.2.2.3.1" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.2.3.3" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.3.cmml">K</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.5.m5.3.3.2.2.6" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.3b"><apply id="S2.SS2.p1.5.m5.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3"><eq id="S2.SS2.p1.5.m5.3.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3.3"></eq><apply id="S2.SS2.p1.5.m5.3.3.4.cmml" xref="S2.SS2.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.3.3.4.1.cmml" xref="S2.SS2.p1.5.m5.3.3.4">subscript</csymbol><ci id="S2.SS2.p1.5.m5.3.3.4.2.cmml" xref="S2.SS2.p1.5.m5.3.3.4.2">ℎ</ci><ci id="S2.SS2.p1.5.m5.3.3.4.3.cmml" xref="S2.SS2.p1.5.m5.3.3.4.3">𝑡</ci></apply><list id="S2.SS2.p1.5.m5.3.3.2.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2"><apply id="S2.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.2">ℎ</ci><apply id="S2.SS2.p1.5.m5.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3"><times id="S2.SS2.p1.5.m5.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.1"></times><ci id="S2.SS2.p1.5.m5.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.5.m5.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">…</ci><apply id="S2.SS2.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.2">ℎ</ci><apply id="S2.SS2.p1.5.m5.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3"><times id="S2.SS2.p1.5.m5.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.1"></times><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.2">𝑡</ci><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.3">𝐾</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.3c">h_{t}=[h_{t1},...,h_{tK}]</annotation></semantics></math><span id="S2.SS2.p1.8.6" class="ltx_text" style="font-size:90%;">, where </span><math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="h_{tj}\in\mathbb{R}^{D/K}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><msub id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.2.2" xref="S2.SS2.p1.6.m6.1.1.2.2.cmml">h</mi><mrow id="S2.SS2.p1.6.m6.1.1.2.3" xref="S2.SS2.p1.6.m6.1.1.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.2.3.2" xref="S2.SS2.p1.6.m6.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.6.m6.1.1.2.3.1" xref="S2.SS2.p1.6.m6.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.2.3.3" xref="S2.SS2.p1.6.m6.1.1.2.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="S2.SS2.p1.6.m6.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.3.2" xref="S2.SS2.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.6.m6.1.1.3.3" xref="S2.SS2.p1.6.m6.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.3.3.2" xref="S2.SS2.p1.6.m6.1.1.3.3.2.cmml">D</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p1.6.m6.1.1.3.3.1" xref="S2.SS2.p1.6.m6.1.1.3.3.1.cmml">/</mo><mi mathsize="90%" id="S2.SS2.p1.6.m6.1.1.3.3.3" xref="S2.SS2.p1.6.m6.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><in id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1"></in><apply id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.2.1.cmml" xref="S2.SS2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2.2">ℎ</ci><apply id="S2.SS2.p1.6.m6.1.1.2.3.cmml" xref="S2.SS2.p1.6.m6.1.1.2.3"><times id="S2.SS2.p1.6.m6.1.1.2.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.2.3.1"></times><ci id="S2.SS2.p1.6.m6.1.1.2.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2.3.2">𝑡</ci><ci id="S2.SS2.p1.6.m6.1.1.2.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.6.m6.1.1.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3"><divide id="S2.SS2.p1.6.m6.1.1.3.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3.1"></divide><ci id="S2.SS2.p1.6.m6.1.1.3.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3.2">𝐷</ci><ci id="S2.SS2.p1.6.m6.1.1.3.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">h_{tj}\in\mathbb{R}^{D/K}</annotation></semantics></math><span id="S2.SS2.p1.8.7" class="ltx_text" style="font-size:90%;">.
Now, for each head </span><math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mi mathsize="90%" id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">j</annotation></semantics></math><span id="S2.SS2.p1.8.8" class="ltx_text" style="font-size:90%;">, a self-attention operation is applied over the encoded sequences </span><math id="S2.SS2.p1.8.m8.3" class="ltx_Math" alttext="[h_{1j},...,h_{\frac{N}{16}j}]" display="inline"><semantics id="S2.SS2.p1.8.m8.3a"><mrow id="S2.SS2.p1.8.m8.3.3.2" xref="S2.SS2.p1.8.m8.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.8.m8.3.3.2.3" xref="S2.SS2.p1.8.m8.3.3.3.cmml">[</mo><msub id="S2.SS2.p1.8.m8.2.2.1.1" xref="S2.SS2.p1.8.m8.2.2.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.8.m8.2.2.1.1.2" xref="S2.SS2.p1.8.m8.2.2.1.1.2.cmml">h</mi><mrow id="S2.SS2.p1.8.m8.2.2.1.1.3" xref="S2.SS2.p1.8.m8.2.2.1.1.3.cmml"><mn mathsize="90%" id="S2.SS2.p1.8.m8.2.2.1.1.3.2" xref="S2.SS2.p1.8.m8.2.2.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p1.8.m8.2.2.1.1.3.1" xref="S2.SS2.p1.8.m8.2.2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.8.m8.2.2.1.1.3.3" xref="S2.SS2.p1.8.m8.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.4" xref="S2.SS2.p1.8.m8.3.3.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">…</mi><mo mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.5" xref="S2.SS2.p1.8.m8.3.3.3.cmml">,</mo><msub id="S2.SS2.p1.8.m8.3.3.2.2" xref="S2.SS2.p1.8.m8.3.3.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.2.2" xref="S2.SS2.p1.8.m8.3.3.2.2.2.cmml">h</mi><mrow id="S2.SS2.p1.8.m8.3.3.2.2.3" xref="S2.SS2.p1.8.m8.3.3.2.2.3.cmml"><mfrac id="S2.SS2.p1.8.m8.3.3.2.2.3.2" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.2.3.2.2" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2.2.cmml">N</mi><mn mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.2.3.2.3" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2.3.cmml">16</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p1.8.m8.3.3.2.2.3.1" xref="S2.SS2.p1.8.m8.3.3.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.8.m8.3.3.2.2.3.3" xref="S2.SS2.p1.8.m8.3.3.2.2.3.3.cmml">j</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.8.m8.3.3.2.6" xref="S2.SS2.p1.8.m8.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.3b"><list id="S2.SS2.p1.8.m8.3.3.3.cmml" xref="S2.SS2.p1.8.m8.3.3.2"><apply id="S2.SS2.p1.8.m8.2.2.1.1.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.2.2.1.1.1.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.2.2.1.1.2.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1.2">ℎ</ci><apply id="S2.SS2.p1.8.m8.2.2.1.1.3.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1.3"><times id="S2.SS2.p1.8.m8.2.2.1.1.3.1.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1.3.1"></times><cn type="integer" id="S2.SS2.p1.8.m8.2.2.1.1.3.2.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1.3.2">1</cn><ci id="S2.SS2.p1.8.m8.2.2.1.1.3.3.cmml" xref="S2.SS2.p1.8.m8.2.2.1.1.3.3">𝑗</ci></apply></apply><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">…</ci><apply id="S2.SS2.p1.8.m8.3.3.2.2.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.3.3.2.2.1.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.8.m8.3.3.2.2.2.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.2">ℎ</ci><apply id="S2.SS2.p1.8.m8.3.3.2.2.3.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3"><times id="S2.SS2.p1.8.m8.3.3.2.2.3.1.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.1"></times><apply id="S2.SS2.p1.8.m8.3.3.2.2.3.2.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2"><divide id="S2.SS2.p1.8.m8.3.3.2.2.3.2.1.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2"></divide><ci id="S2.SS2.p1.8.m8.3.3.2.2.3.2.2.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.8.m8.3.3.2.2.3.2.3.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.2.3">16</cn></apply><ci id="S2.SS2.p1.8.m8.3.3.2.2.3.3.cmml" xref="S2.SS2.p1.8.m8.3.3.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.3c">[h_{1j},...,h_{\frac{N}{16}j}]</annotation></semantics></math><span id="S2.SS2.p1.8.9" class="ltx_text" style="font-size:90%;">.
The weights of each head alignment are defined as:</span></p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="w_{tj}=\frac{\text{exp}\left(\frac{h_{tj}^{T}u_{j}}{\sqrt{d_{h}}}\right)}{\sum_{l=1}^{N/16}\text{exp}\left(\frac{h_{lj}^{T}u_{j}}{\sqrt{d_{h}}}\right)}" display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.3" xref="S2.E1.m1.2.3.cmml"><msub id="S2.E1.m1.2.3.2" xref="S2.E1.m1.2.3.2.cmml"><mi mathsize="90%" id="S2.E1.m1.2.3.2.2" xref="S2.E1.m1.2.3.2.2.cmml">w</mi><mrow id="S2.E1.m1.2.3.2.3" xref="S2.E1.m1.2.3.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.2.3.2.3.2" xref="S2.E1.m1.2.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.3.2.3.1" xref="S2.E1.m1.2.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E1.m1.2.3.2.3.3" xref="S2.E1.m1.2.3.2.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="S2.E1.m1.2.3.1" xref="S2.E1.m1.2.3.1.cmml">=</mo><mfrac id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mtext mathsize="90%" id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.4.2" xref="S2.E1.m1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.4.2.1" xref="S2.E1.m1.1.1.1.1.cmml">(</mo><mfrac id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><msubsup id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2.cmml">h</mi><mrow id="S2.E1.m1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.2.2.3.2" xref="S2.E1.m1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.2.3.1" xref="S2.E1.m1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.2.2.3.3" xref="S2.E1.m1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.1.2.1.cmml">​</mo><msub id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.2.3.2.cmml">u</mi><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><msqrt id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><msub id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.cmml">d</mi><mi mathsize="90%" id="S2.E1.m1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.cmml">h</mi></msub></msqrt></mfrac><mo id="S2.E1.m1.1.1.1.4.2.2" xref="S2.E1.m1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><msubsup id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.2.3.2.cmml">l</mi><mo mathsize="90%" id="S2.E1.m1.2.2.2.2.2.3.1" xref="S2.E1.m1.2.2.2.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E1.m1.2.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.3.2.cmml">N</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.E1.m1.2.2.2.2.3.1" xref="S2.E1.m1.2.2.2.2.3.1.cmml">/</mo><mn mathsize="90%" id="S2.E1.m1.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.3.3.cmml">16</mn></mrow></msubsup><mrow id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml"><mtext mathsize="90%" id="S2.E1.m1.2.2.2.3.2" xref="S2.E1.m1.2.2.2.3.2a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.3.1" xref="S2.E1.m1.2.2.2.3.1.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.3.3.2" xref="S2.E1.m1.2.2.2.1.cmml"><mo id="S2.E1.m1.2.2.2.3.3.2.1" xref="S2.E1.m1.2.2.2.1.cmml">(</mo><mfrac id="S2.E1.m1.2.2.2.1" xref="S2.E1.m1.2.2.2.1.cmml"><mrow id="S2.E1.m1.2.2.2.1.2" xref="S2.E1.m1.2.2.2.1.2.cmml"><msubsup id="S2.E1.m1.2.2.2.1.2.2" xref="S2.E1.m1.2.2.2.1.2.2.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.2.2.2" xref="S2.E1.m1.2.2.2.1.2.2.2.2.cmml">h</mi><mrow id="S2.E1.m1.2.2.2.1.2.2.2.3" xref="S2.E1.m1.2.2.2.1.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.2.2.3.2" xref="S2.E1.m1.2.2.2.1.2.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.1.2.2.2.3.1" xref="S2.E1.m1.2.2.2.1.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.2.2.3.3" xref="S2.E1.m1.2.2.2.1.2.2.2.3.3.cmml">j</mi></mrow><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.2.3" xref="S2.E1.m1.2.2.2.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.1.2.1" xref="S2.E1.m1.2.2.2.1.2.1.cmml">​</mo><msub id="S2.E1.m1.2.2.2.1.2.3" xref="S2.E1.m1.2.2.2.1.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.3.2" xref="S2.E1.m1.2.2.2.1.2.3.2.cmml">u</mi><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.2.3.3" xref="S2.E1.m1.2.2.2.1.2.3.3.cmml">j</mi></msub></mrow><msqrt id="S2.E1.m1.2.2.2.1.3" xref="S2.E1.m1.2.2.2.1.3.cmml"><msub id="S2.E1.m1.2.2.2.1.3.2" xref="S2.E1.m1.2.2.2.1.3.2.cmml"><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.3.2.2" xref="S2.E1.m1.2.2.2.1.3.2.2.cmml">d</mi><mi mathsize="90%" id="S2.E1.m1.2.2.2.1.3.2.3" xref="S2.E1.m1.2.2.2.1.3.2.3.cmml">h</mi></msub></msqrt></mfrac><mo id="S2.E1.m1.2.2.2.3.3.2.2" xref="S2.E1.m1.2.2.2.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.3.cmml" xref="S2.E1.m1.2.3"><eq id="S2.E1.m1.2.3.1.cmml" xref="S2.E1.m1.2.3.1"></eq><apply id="S2.E1.m1.2.3.2.cmml" xref="S2.E1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.3.2.1.cmml" xref="S2.E1.m1.2.3.2">subscript</csymbol><ci id="S2.E1.m1.2.3.2.2.cmml" xref="S2.E1.m1.2.3.2.2">𝑤</ci><apply id="S2.E1.m1.2.3.2.3.cmml" xref="S2.E1.m1.2.3.2.3"><times id="S2.E1.m1.2.3.2.3.1.cmml" xref="S2.E1.m1.2.3.2.3.1"></times><ci id="S2.E1.m1.2.3.2.3.2.cmml" xref="S2.E1.m1.2.3.2.3.2">𝑡</ci><ci id="S2.E1.m1.2.3.2.3.3.cmml" xref="S2.E1.m1.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><divide id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2"></divide><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.3"><mtext mathsize="90%" id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">exp</mtext></ci><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.4.2"><divide id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.4.2"></divide><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><times id="S2.E1.m1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1"></times><apply id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2">ℎ</ci><apply id="S2.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3"><times id="S2.E1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3.2">𝑡</ci><ci id="S2.E1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S2.E1.m1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.3.2">𝑢</ci><ci id="S2.E1.m1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><root id="S2.E1.m1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.3"></root><apply id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2">𝑑</ci><ci id="S2.E1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3">ℎ</ci></apply></apply></apply></apply><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><apply id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2">subscript</csymbol><sum id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2"></sum><apply id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3"><eq id="S2.E1.m1.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E1.m1.2.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.3"><divide id="S2.E1.m1.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.3.1"></divide><ci id="S2.E1.m1.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.3.2">𝑁</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.3.3">16</cn></apply></apply><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"><times id="S2.E1.m1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.3.1"></times><ci id="S2.E1.m1.2.2.2.3.2a.cmml" xref="S2.E1.m1.2.2.2.3.2"><mtext mathsize="90%" id="S2.E1.m1.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.3.2">exp</mtext></ci><apply id="S2.E1.m1.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.3.3.2"><divide id="S2.E1.m1.2.2.2.1.1.cmml" xref="S2.E1.m1.2.2.2.3.3.2"></divide><apply id="S2.E1.m1.2.2.2.1.2.cmml" xref="S2.E1.m1.2.2.2.1.2"><times id="S2.E1.m1.2.2.2.1.2.1.cmml" xref="S2.E1.m1.2.2.2.1.2.1"></times><apply id="S2.E1.m1.2.2.2.1.2.2.cmml" xref="S2.E1.m1.2.2.2.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.2.2.1.cmml" xref="S2.E1.m1.2.2.2.1.2.2">superscript</csymbol><apply id="S2.E1.m1.2.2.2.1.2.2.2.cmml" xref="S2.E1.m1.2.2.2.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.1.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.1.2.2.2.2">ℎ</ci><apply id="S2.E1.m1.2.2.2.1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.1.2.2.2.3"><times id="S2.E1.m1.2.2.2.1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.1.2.2.2.3.1"></times><ci id="S2.E1.m1.2.2.2.1.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.1.2.2.2.3.2">𝑙</ci><ci id="S2.E1.m1.2.2.2.1.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.1.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E1.m1.2.2.2.1.2.2.3.cmml" xref="S2.E1.m1.2.2.2.1.2.2.3">𝑇</ci></apply><apply id="S2.E1.m1.2.2.2.1.2.3.cmml" xref="S2.E1.m1.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.2.3.1.cmml" xref="S2.E1.m1.2.2.2.1.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.2.3.2.cmml" xref="S2.E1.m1.2.2.2.1.2.3.2">𝑢</ci><ci id="S2.E1.m1.2.2.2.1.2.3.3.cmml" xref="S2.E1.m1.2.2.2.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.2.2.2.1.3.cmml" xref="S2.E1.m1.2.2.2.1.3"><root id="S2.E1.m1.2.2.2.1.3a.cmml" xref="S2.E1.m1.2.2.2.1.3"></root><apply id="S2.E1.m1.2.2.2.1.3.2.cmml" xref="S2.E1.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.3.2.1.cmml" xref="S2.E1.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.3.2.2.cmml" xref="S2.E1.m1.2.2.2.1.3.2.2">𝑑</ci><ci id="S2.E1.m1.2.2.2.1.3.2.3.cmml" xref="S2.E1.m1.2.2.2.1.3.2.3">ℎ</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">w_{tj}=\frac{\text{exp}\left(\frac{h_{tj}^{T}u_{j}}{\sqrt{d_{h}}}\right)}{\sum_{l=1}^{N/16}\text{exp}\left(\frac{h_{lj}^{T}u_{j}}{\sqrt{d_{h}}}\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.14" class="ltx_p"><span id="S2.SS2.p1.14.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p1.9.m1.1" class="ltx_Math" alttext="w_{tj}" display="inline"><semantics id="S2.SS2.p1.9.m1.1a"><msub id="S2.SS2.p1.9.m1.1.1" xref="S2.SS2.p1.9.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.9.m1.1.1.2" xref="S2.SS2.p1.9.m1.1.1.2.cmml">w</mi><mrow id="S2.SS2.p1.9.m1.1.1.3" xref="S2.SS2.p1.9.m1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.9.m1.1.1.3.2" xref="S2.SS2.p1.9.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.m1.1.1.3.1" xref="S2.SS2.p1.9.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.9.m1.1.1.3.3" xref="S2.SS2.p1.9.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m1.1b"><apply id="S2.SS2.p1.9.m1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m1.1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.m1.1.1.2.cmml" xref="S2.SS2.p1.9.m1.1.1.2">𝑤</ci><apply id="S2.SS2.p1.9.m1.1.1.3.cmml" xref="S2.SS2.p1.9.m1.1.1.3"><times id="S2.SS2.p1.9.m1.1.1.3.1.cmml" xref="S2.SS2.p1.9.m1.1.1.3.1"></times><ci id="S2.SS2.p1.9.m1.1.1.3.2.cmml" xref="S2.SS2.p1.9.m1.1.1.3.2">𝑡</ci><ci id="S2.SS2.p1.9.m1.1.1.3.3.cmml" xref="S2.SS2.p1.9.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m1.1c">w_{tj}</annotation></semantics></math><span id="S2.SS2.p1.14.2" class="ltx_text" style="font-size:90%;"> corresponds to the attention weight of the head </span><math id="S2.SS2.p1.10.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.10.m2.1a"><mi mathsize="90%" id="S2.SS2.p1.10.m2.1.1" xref="S2.SS2.p1.10.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m2.1b"><ci id="S2.SS2.p1.10.m2.1.1.cmml" xref="S2.SS2.p1.10.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m2.1c">j</annotation></semantics></math><span id="S2.SS2.p1.14.3" class="ltx_text" style="font-size:90%;"> on the step </span><math id="S2.SS2.p1.11.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p1.11.m3.1a"><mi mathsize="90%" id="S2.SS2.p1.11.m3.1.1" xref="S2.SS2.p1.11.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m3.1b"><ci id="S2.SS2.p1.11.m3.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m3.1c">t</annotation></semantics></math><span id="S2.SS2.p1.14.4" class="ltx_text" style="font-size:90%;"> of the sequence, </span><math id="S2.SS2.p1.12.m4.1" class="ltx_Math" alttext="u_{j}\in\mathbb{R}^{D/K}" display="inline"><semantics id="S2.SS2.p1.12.m4.1a"><mrow id="S2.SS2.p1.12.m4.1.1" xref="S2.SS2.p1.12.m4.1.1.cmml"><msub id="S2.SS2.p1.12.m4.1.1.2" xref="S2.SS2.p1.12.m4.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.12.m4.1.1.2.2" xref="S2.SS2.p1.12.m4.1.1.2.2.cmml">u</mi><mi mathsize="90%" id="S2.SS2.p1.12.m4.1.1.2.3" xref="S2.SS2.p1.12.m4.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="S2.SS2.p1.12.m4.1.1.1" xref="S2.SS2.p1.12.m4.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.12.m4.1.1.3" xref="S2.SS2.p1.12.m4.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.12.m4.1.1.3.2" xref="S2.SS2.p1.12.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.12.m4.1.1.3.3" xref="S2.SS2.p1.12.m4.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.12.m4.1.1.3.3.2" xref="S2.SS2.p1.12.m4.1.1.3.3.2.cmml">D</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p1.12.m4.1.1.3.3.1" xref="S2.SS2.p1.12.m4.1.1.3.3.1.cmml">/</mo><mi mathsize="90%" id="S2.SS2.p1.12.m4.1.1.3.3.3" xref="S2.SS2.p1.12.m4.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m4.1b"><apply id="S2.SS2.p1.12.m4.1.1.cmml" xref="S2.SS2.p1.12.m4.1.1"><in id="S2.SS2.p1.12.m4.1.1.1.cmml" xref="S2.SS2.p1.12.m4.1.1.1"></in><apply id="S2.SS2.p1.12.m4.1.1.2.cmml" xref="S2.SS2.p1.12.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m4.1.1.2.1.cmml" xref="S2.SS2.p1.12.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.12.m4.1.1.2.2.cmml" xref="S2.SS2.p1.12.m4.1.1.2.2">𝑢</ci><ci id="S2.SS2.p1.12.m4.1.1.2.3.cmml" xref="S2.SS2.p1.12.m4.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p1.12.m4.1.1.3.cmml" xref="S2.SS2.p1.12.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m4.1.1.3.1.cmml" xref="S2.SS2.p1.12.m4.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.12.m4.1.1.3.2.cmml" xref="S2.SS2.p1.12.m4.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.12.m4.1.1.3.3.cmml" xref="S2.SS2.p1.12.m4.1.1.3.3"><divide id="S2.SS2.p1.12.m4.1.1.3.3.1.cmml" xref="S2.SS2.p1.12.m4.1.1.3.3.1"></divide><ci id="S2.SS2.p1.12.m4.1.1.3.3.2.cmml" xref="S2.SS2.p1.12.m4.1.1.3.3.2">𝐷</ci><ci id="S2.SS2.p1.12.m4.1.1.3.3.3.cmml" xref="S2.SS2.p1.12.m4.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m4.1c">u_{j}\in\mathbb{R}^{D/K}</annotation></semantics></math><span id="S2.SS2.p1.14.5" class="ltx_text" style="font-size:90%;"> is a trainable parameter and </span><math id="S2.SS2.p1.13.m5.1" class="ltx_Math" alttext="d_{h}" display="inline"><semantics id="S2.SS2.p1.13.m5.1a"><msub id="S2.SS2.p1.13.m5.1.1" xref="S2.SS2.p1.13.m5.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.13.m5.1.1.2" xref="S2.SS2.p1.13.m5.1.1.2.cmml">d</mi><mi mathsize="90%" id="S2.SS2.p1.13.m5.1.1.3" xref="S2.SS2.p1.13.m5.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m5.1b"><apply id="S2.SS2.p1.13.m5.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m5.1.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.13.m5.1.1.2.cmml" xref="S2.SS2.p1.13.m5.1.1.2">𝑑</ci><ci id="S2.SS2.p1.13.m5.1.1.3.cmml" xref="S2.SS2.p1.13.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m5.1c">d_{h}</annotation></semantics></math><span id="S2.SS2.p1.14.6" class="ltx_text" style="font-size:90%;"> corresponds to the hidden state dimension </span><math id="S2.SS2.p1.14.m6.1" class="ltx_Math" alttext="D/K" display="inline"><semantics id="S2.SS2.p1.14.m6.1a"><mrow id="S2.SS2.p1.14.m6.1.1" xref="S2.SS2.p1.14.m6.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.14.m6.1.1.2" xref="S2.SS2.p1.14.m6.1.1.2.cmml">D</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p1.14.m6.1.1.1" xref="S2.SS2.p1.14.m6.1.1.1.cmml">/</mo><mi mathsize="90%" id="S2.SS2.p1.14.m6.1.1.3" xref="S2.SS2.p1.14.m6.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m6.1b"><apply id="S2.SS2.p1.14.m6.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1"><divide id="S2.SS2.p1.14.m6.1.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1.1"></divide><ci id="S2.SS2.p1.14.m6.1.1.2.cmml" xref="S2.SS2.p1.14.m6.1.1.2">𝐷</ci><ci id="S2.SS2.p1.14.m6.1.1.3.cmml" xref="S2.SS2.p1.14.m6.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m6.1c">D/K</annotation></semantics></math><span id="S2.SS2.p1.14.7" class="ltx_text" style="font-size:90%;">.
We then compute a new pooled representation for each head:</span></p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="c_{j}=\sum_{t=1}^{N/16}h_{tj}^{T}w_{tj}" display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">c</mi><mi mathsize="90%" id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" rspace="0.111em" id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><munderover id="S2.E2.m1.1.1.3.1" xref="S2.E2.m1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2.m1.1.1.3.1.2.2" xref="S2.E2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.3.1.2.3" xref="S2.E2.m1.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.1.2.3.2" xref="S2.E2.m1.1.1.3.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E2.m1.1.1.3.1.2.3.1" xref="S2.E2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2.m1.1.1.3.1.2.3.3" xref="S2.E2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.E2.m1.1.1.3.1.3" xref="S2.E2.m1.1.1.3.1.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.1.3.2" xref="S2.E2.m1.1.1.3.1.3.2.cmml">N</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.E2.m1.1.1.3.1.3.1" xref="S2.E2.m1.1.1.3.1.3.1.cmml">/</mo><mn mathsize="90%" id="S2.E2.m1.1.1.3.1.3.3" xref="S2.E2.m1.1.1.3.1.3.3.cmml">16</mn></mrow></munderover><mrow id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><msubsup id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.2.2.2" xref="S2.E2.m1.1.1.3.2.2.2.2.cmml">h</mi><mrow id="S2.E2.m1.1.1.3.2.2.2.3" xref="S2.E2.m1.1.1.3.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.2.2.3.2" xref="S2.E2.m1.1.1.3.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.2.2.3.1" xref="S2.E2.m1.1.1.3.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.2.2.3.3" xref="S2.E2.m1.1.1.3.2.2.2.3.3.cmml">j</mi></mrow><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.2.3" xref="S2.E2.m1.1.1.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.1" xref="S2.E2.m1.1.1.3.2.1.cmml">​</mo><msub id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.3.2.3.2.cmml">w</mi><mrow id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.3.3.2" xref="S2.E2.m1.1.1.3.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.3.3.1" xref="S2.E2.m1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E2.m1.1.1.3.2.3.3.3" xref="S2.E2.m1.1.1.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"></eq><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝑐</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">𝑗</ci></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><apply id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.1.cmml" xref="S2.E2.m1.1.1.3.1">superscript</csymbol><apply id="S2.E2.m1.1.1.3.1.2.cmml" xref="S2.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.2.1.cmml" xref="S2.E2.m1.1.1.3.1">subscript</csymbol><sum id="S2.E2.m1.1.1.3.1.2.2.cmml" xref="S2.E2.m1.1.1.3.1.2.2"></sum><apply id="S2.E2.m1.1.1.3.1.2.3.cmml" xref="S2.E2.m1.1.1.3.1.2.3"><eq id="S2.E2.m1.1.1.3.1.2.3.1.cmml" xref="S2.E2.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E2.m1.1.1.3.1.2.3.2.cmml" xref="S2.E2.m1.1.1.3.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.3.1.2.3.3.cmml" xref="S2.E2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.3.1.3.cmml" xref="S2.E2.m1.1.1.3.1.3"><divide id="S2.E2.m1.1.1.3.1.3.1.cmml" xref="S2.E2.m1.1.1.3.1.3.1"></divide><ci id="S2.E2.m1.1.1.3.1.3.2.cmml" xref="S2.E2.m1.1.1.3.1.3.2">𝑁</ci><cn type="integer" id="S2.E2.m1.1.1.3.1.3.3.cmml" xref="S2.E2.m1.1.1.3.1.3.3">16</cn></apply></apply><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><times id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2.1"></times><apply id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.1.1.3.2.2">superscript</csymbol><apply id="S2.E2.m1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.2.2.1.cmml" xref="S2.E2.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2.2.2">ℎ</ci><apply id="S2.E2.m1.1.1.3.2.2.2.3.cmml" xref="S2.E2.m1.1.1.3.2.2.2.3"><times id="S2.E2.m1.1.1.3.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.2.2.3.1"></times><ci id="S2.E2.m1.1.1.3.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.2.2.3.2">𝑡</ci><ci id="S2.E2.m1.1.1.3.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E2.m1.1.1.3.2.2.3.cmml" xref="S2.E2.m1.1.1.3.2.2.3">𝑇</ci></apply><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2">𝑤</ci><apply id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3"><times id="S2.E2.m1.1.1.3.2.3.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3.3.1"></times><ci id="S2.E2.m1.1.1.3.2.3.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.3.2">𝑡</ci><ci id="S2.E2.m1.1.1.3.2.3.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">c_{j}=\sum_{t=1}^{N/16}h_{tj}^{T}w_{tj}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.18" class="ltx_p"><span id="S2.SS2.p1.18.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p1.15.m1.1" class="ltx_Math" alttext="c_{j}\in\mathbb{R}^{D/K}" display="inline"><semantics id="S2.SS2.p1.15.m1.1a"><mrow id="S2.SS2.p1.15.m1.1.1" xref="S2.SS2.p1.15.m1.1.1.cmml"><msub id="S2.SS2.p1.15.m1.1.1.2" xref="S2.SS2.p1.15.m1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.15.m1.1.1.2.2" xref="S2.SS2.p1.15.m1.1.1.2.2.cmml">c</mi><mi mathsize="90%" id="S2.SS2.p1.15.m1.1.1.2.3" xref="S2.SS2.p1.15.m1.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="S2.SS2.p1.15.m1.1.1.1" xref="S2.SS2.p1.15.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.15.m1.1.1.3" xref="S2.SS2.p1.15.m1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.15.m1.1.1.3.2" xref="S2.SS2.p1.15.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.15.m1.1.1.3.3" xref="S2.SS2.p1.15.m1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p1.15.m1.1.1.3.3.2" xref="S2.SS2.p1.15.m1.1.1.3.3.2.cmml">D</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p1.15.m1.1.1.3.3.1" xref="S2.SS2.p1.15.m1.1.1.3.3.1.cmml">/</mo><mi mathsize="90%" id="S2.SS2.p1.15.m1.1.1.3.3.3" xref="S2.SS2.p1.15.m1.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m1.1b"><apply id="S2.SS2.p1.15.m1.1.1.cmml" xref="S2.SS2.p1.15.m1.1.1"><in id="S2.SS2.p1.15.m1.1.1.1.cmml" xref="S2.SS2.p1.15.m1.1.1.1"></in><apply id="S2.SS2.p1.15.m1.1.1.2.cmml" xref="S2.SS2.p1.15.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m1.1.1.2.1.cmml" xref="S2.SS2.p1.15.m1.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.15.m1.1.1.2.2.cmml" xref="S2.SS2.p1.15.m1.1.1.2.2">𝑐</ci><ci id="S2.SS2.p1.15.m1.1.1.2.3.cmml" xref="S2.SS2.p1.15.m1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p1.15.m1.1.1.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m1.1.1.3.1.cmml" xref="S2.SS2.p1.15.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.15.m1.1.1.3.2.cmml" xref="S2.SS2.p1.15.m1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.15.m1.1.1.3.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3"><divide id="S2.SS2.p1.15.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.1"></divide><ci id="S2.SS2.p1.15.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.2">𝐷</ci><ci id="S2.SS2.p1.15.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m1.1c">c_{j}\in\mathbb{R}^{D/K}</annotation></semantics></math><span id="S2.SS2.p1.18.2" class="ltx_text" style="font-size:90%;"> corresponds to the utterance level representation from head j.
Each self-attention operation for the head </span><math id="S2.SS2.p1.16.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.16.m2.1a"><mi mathsize="90%" id="S2.SS2.p1.16.m2.1.1" xref="S2.SS2.p1.16.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m2.1b"><ci id="S2.SS2.p1.16.m2.1.1.cmml" xref="S2.SS2.p1.16.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m2.1c">j</annotation></semantics></math><span id="S2.SS2.p1.18.3" class="ltx_text" style="font-size:90%;"> can be understood as a dot-product attention where the keys and the values correspond to the same representation </span><math id="S2.SS2.p1.17.m3.3" class="ltx_Math" alttext="[h_{1j},...,h_{\frac{N}{16}j}]" display="inline"><semantics id="S2.SS2.p1.17.m3.3a"><mrow id="S2.SS2.p1.17.m3.3.3.2" xref="S2.SS2.p1.17.m3.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.17.m3.3.3.2.3" xref="S2.SS2.p1.17.m3.3.3.3.cmml">[</mo><msub id="S2.SS2.p1.17.m3.2.2.1.1" xref="S2.SS2.p1.17.m3.2.2.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.17.m3.2.2.1.1.2" xref="S2.SS2.p1.17.m3.2.2.1.1.2.cmml">h</mi><mrow id="S2.SS2.p1.17.m3.2.2.1.1.3" xref="S2.SS2.p1.17.m3.2.2.1.1.3.cmml"><mn mathsize="90%" id="S2.SS2.p1.17.m3.2.2.1.1.3.2" xref="S2.SS2.p1.17.m3.2.2.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p1.17.m3.2.2.1.1.3.1" xref="S2.SS2.p1.17.m3.2.2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.17.m3.2.2.1.1.3.3" xref="S2.SS2.p1.17.m3.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.4" xref="S2.SS2.p1.17.m3.3.3.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS2.p1.17.m3.1.1" xref="S2.SS2.p1.17.m3.1.1.cmml">…</mi><mo mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.5" xref="S2.SS2.p1.17.m3.3.3.3.cmml">,</mo><msub id="S2.SS2.p1.17.m3.3.3.2.2" xref="S2.SS2.p1.17.m3.3.3.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.2.2" xref="S2.SS2.p1.17.m3.3.3.2.2.2.cmml">h</mi><mrow id="S2.SS2.p1.17.m3.3.3.2.2.3" xref="S2.SS2.p1.17.m3.3.3.2.2.3.cmml"><mfrac id="S2.SS2.p1.17.m3.3.3.2.2.3.2" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2.cmml"><mi mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.2.3.2.2" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2.2.cmml">N</mi><mn mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.2.3.2.3" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2.3.cmml">16</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p1.17.m3.3.3.2.2.3.1" xref="S2.SS2.p1.17.m3.3.3.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS2.p1.17.m3.3.3.2.2.3.3" xref="S2.SS2.p1.17.m3.3.3.2.2.3.3.cmml">j</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="S2.SS2.p1.17.m3.3.3.2.6" xref="S2.SS2.p1.17.m3.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m3.3b"><list id="S2.SS2.p1.17.m3.3.3.3.cmml" xref="S2.SS2.p1.17.m3.3.3.2"><apply id="S2.SS2.p1.17.m3.2.2.1.1.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m3.2.2.1.1.1.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p1.17.m3.2.2.1.1.2.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1.2">ℎ</ci><apply id="S2.SS2.p1.17.m3.2.2.1.1.3.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1.3"><times id="S2.SS2.p1.17.m3.2.2.1.1.3.1.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1.3.1"></times><cn type="integer" id="S2.SS2.p1.17.m3.2.2.1.1.3.2.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1.3.2">1</cn><ci id="S2.SS2.p1.17.m3.2.2.1.1.3.3.cmml" xref="S2.SS2.p1.17.m3.2.2.1.1.3.3">𝑗</ci></apply></apply><ci id="S2.SS2.p1.17.m3.1.1.cmml" xref="S2.SS2.p1.17.m3.1.1">…</ci><apply id="S2.SS2.p1.17.m3.3.3.2.2.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m3.3.3.2.2.1.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.17.m3.3.3.2.2.2.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.2">ℎ</ci><apply id="S2.SS2.p1.17.m3.3.3.2.2.3.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3"><times id="S2.SS2.p1.17.m3.3.3.2.2.3.1.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.1"></times><apply id="S2.SS2.p1.17.m3.3.3.2.2.3.2.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2"><divide id="S2.SS2.p1.17.m3.3.3.2.2.3.2.1.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2"></divide><ci id="S2.SS2.p1.17.m3.3.3.2.2.3.2.2.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.17.m3.3.3.2.2.3.2.3.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.2.3">16</cn></apply><ci id="S2.SS2.p1.17.m3.3.3.2.2.3.3.cmml" xref="S2.SS2.p1.17.m3.3.3.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m3.3c">[h_{1j},...,h_{\frac{N}{16}j}]</annotation></semantics></math><span id="S2.SS2.p1.18.4" class="ltx_text" style="font-size:90%;"> and the query is only a trainable parameter </span><math id="S2.SS2.p1.18.m4.1" class="ltx_Math" alttext="u_{j}" display="inline"><semantics id="S2.SS2.p1.18.m4.1a"><msub id="S2.SS2.p1.18.m4.1.1" xref="S2.SS2.p1.18.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.18.m4.1.1.2" xref="S2.SS2.p1.18.m4.1.1.2.cmml">u</mi><mi mathsize="90%" id="S2.SS2.p1.18.m4.1.1.3" xref="S2.SS2.p1.18.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m4.1b"><apply id="S2.SS2.p1.18.m4.1.1.cmml" xref="S2.SS2.p1.18.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m4.1.1.1.cmml" xref="S2.SS2.p1.18.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.18.m4.1.1.2.cmml" xref="S2.SS2.p1.18.m4.1.1.2">𝑢</ci><ci id="S2.SS2.p1.18.m4.1.1.3.cmml" xref="S2.SS2.p1.18.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m4.1c">u_{j}</annotation></semantics></math><span id="S2.SS2.p1.18.5" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.2" class="ltx_p"><span id="S2.SS2.p2.2.1" class="ltx_text" style="font-size:90%;">Self-attention is now used to pool the set of head context vectors </span><math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑐</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">c_{i}</annotation></semantics></math><span id="S2.SS2.p2.2.2" class="ltx_text" style="font-size:90%;"> in order to obtain an overall context vector </span><math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">c</annotation></semantics></math><span id="S2.SS2.p2.2.3" class="ltx_text" style="font-size:90%;">:</span></p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.2" class="ltx_Math" alttext="w_{i}^{{}^{\prime}}=\frac{\text{exp}\left(c_{i}^{T}u^{{}^{\prime}}\right)}{\sum_{l=1}^{K}\text{exp}\left(c_{l}^{T}u^{{}^{\prime}}\right)}" display="block"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.3" xref="S2.E3.m1.2.3.cmml"><msubsup id="S2.E3.m1.2.3.2" xref="S2.E3.m1.2.3.2.cmml"><mi mathsize="90%" id="S2.E3.m1.2.3.2.2.2" xref="S2.E3.m1.2.3.2.2.2.cmml">w</mi><mi mathsize="90%" id="S2.E3.m1.2.3.2.2.3" xref="S2.E3.m1.2.3.2.2.3.cmml">i</mi><msup id="S2.E3.m1.2.3.2.3" xref="S2.E3.m1.2.3.2.3.cmml"><mi id="S2.E3.m1.2.3.2.3a" xref="S2.E3.m1.2.3.2.3.cmml"></mi><mo mathsize="90%" id="S2.E3.m1.2.3.2.3.1" xref="S2.E3.m1.2.3.2.3.1.cmml">′</mo></msup></msubsup><mo mathsize="90%" id="S2.E3.m1.2.3.1" xref="S2.E3.m1.2.3.1.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mtext mathsize="90%" id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><msubsup id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.3.2.cmml">u</mi><msup id="S2.E3.m1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.3.3a" xref="S2.E3.m1.1.1.1.1.1.1.3.3.cmml"></mi><mo mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><mo id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><msubsup id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E3.m1.2.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.3.2.cmml">l</mi><mo mathsize="90%" id="S2.E3.m1.2.2.2.2.2.3.1" xref="S2.E3.m1.2.2.2.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E3.m1.2.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml"><mtext mathsize="90%" id="S2.E3.m1.2.2.2.1.3" xref="S2.E3.m1.2.2.2.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.1.2" xref="S2.E3.m1.2.2.2.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml"><msubsup id="S2.E3.m1.2.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E3.m1.2.2.2.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.2.cmml">c</mi><mi mathsize="90%" id="S2.E3.m1.2.2.2.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml">l</mi><mi mathsize="90%" id="S2.E3.m1.2.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.1.cmml">​</mo><msup id="S2.E3.m1.2.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E3.m1.2.2.2.1.1.1.1.3.2" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2.cmml">u</mi><msup id="S2.E3.m1.2.2.2.1.1.1.1.3.3" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.1.3.3a" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3.cmml"></mi><mo mathsize="90%" id="S2.E3.m1.2.2.2.1.1.1.1.3.3.1" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><mo id="S2.E3.m1.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.3.cmml" xref="S2.E3.m1.2.3"><eq id="S2.E3.m1.2.3.1.cmml" xref="S2.E3.m1.2.3.1"></eq><apply id="S2.E3.m1.2.3.2.cmml" xref="S2.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.3.2.1.cmml" xref="S2.E3.m1.2.3.2">superscript</csymbol><apply id="S2.E3.m1.2.3.2.2.cmml" xref="S2.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.3.2.2.1.cmml" xref="S2.E3.m1.2.3.2">subscript</csymbol><ci id="S2.E3.m1.2.3.2.2.2.cmml" xref="S2.E3.m1.2.3.2.2.2">𝑤</ci><ci id="S2.E3.m1.2.3.2.2.3.cmml" xref="S2.E3.m1.2.3.2.2.3">𝑖</ci></apply><apply id="S2.E3.m1.2.3.2.3.cmml" xref="S2.E3.m1.2.3.2.3"><ci id="S2.E3.m1.2.3.2.3.1.cmml" xref="S2.E3.m1.2.3.2.3.1">′</ci></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3a.cmml" xref="S2.E3.m1.1.1.1.3"><mtext mathsize="90%" id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">exp</mtext></ci><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="S2.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.2">𝑢</ci><apply id="S2.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3"><ci id="S2.E3.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.1">′</ci></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2">subscript</csymbol><sum id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2"></sum><apply id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3"><eq id="S2.E3.m1.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E3.m1.2.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="S2.E3.m1.2.2.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1"><times id="S2.E3.m1.2.2.2.1.2.cmml" xref="S2.E3.m1.2.2.2.1.2"></times><ci id="S2.E3.m1.2.2.2.1.3a.cmml" xref="S2.E3.m1.2.2.2.1.3"><mtext mathsize="90%" id="S2.E3.m1.2.2.2.1.3.cmml" xref="S2.E3.m1.2.2.2.1.3">exp</mtext></ci><apply id="S2.E3.m1.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1"><times id="S2.E3.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1"></times><apply id="S2.E3.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.2">𝑐</ci><ci id="S2.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S2.E3.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E3.m1.2.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2">𝑢</ci><apply id="S2.E3.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3"><ci id="S2.E3.m1.2.2.2.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">w_{i}^{{}^{\prime}}=\frac{\text{exp}\left(c_{i}^{T}u^{{}^{\prime}}\right)}{\sum_{l=1}^{K}\text{exp}\left(c_{l}^{T}u^{{}^{\prime}}\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.1" class="ltx_Math" alttext="c=\sum_{t=1}^{K}c_{i}^{T}w_{i}^{{}^{\prime}}" display="block"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">c</mi><mo mathsize="90%" rspace="0.111em" id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><munderover id="S2.E4.m1.1.1.3.1" xref="S2.E4.m1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E4.m1.1.1.3.1.2.2" xref="S2.E4.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.3.1.2.3" xref="S2.E4.m1.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.3.1.2.3.2" xref="S2.E4.m1.1.1.3.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E4.m1.1.1.3.1.2.3.1" xref="S2.E4.m1.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E4.m1.1.1.3.1.2.3.3" xref="S2.E4.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E4.m1.1.1.3.1.3" xref="S2.E4.m1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml"><msubsup id="S2.E4.m1.1.1.3.2.2" xref="S2.E4.m1.1.1.3.2.2.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.3.2.2.2.2" xref="S2.E4.m1.1.1.3.2.2.2.2.cmml">c</mi><mi mathsize="90%" id="S2.E4.m1.1.1.3.2.2.2.3" xref="S2.E4.m1.1.1.3.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E4.m1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.3.2.1" xref="S2.E4.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E4.m1.1.1.3.2.3" xref="S2.E4.m1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.3.2.3.2.2" xref="S2.E4.m1.1.1.3.2.3.2.2.cmml">w</mi><mi mathsize="90%" id="S2.E4.m1.1.1.3.2.3.2.3" xref="S2.E4.m1.1.1.3.2.3.2.3.cmml">i</mi><msup id="S2.E4.m1.1.1.3.2.3.3" xref="S2.E4.m1.1.1.3.2.3.3.cmml"><mi id="S2.E4.m1.1.1.3.2.3.3a" xref="S2.E4.m1.1.1.3.2.3.3.cmml"></mi><mo mathsize="90%" id="S2.E4.m1.1.1.3.2.3.3.1" xref="S2.E4.m1.1.1.3.2.3.3.1.cmml">′</mo></msup></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><eq id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"></eq><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑐</ci><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><apply id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.1.cmml" xref="S2.E4.m1.1.1.3.1">superscript</csymbol><apply id="S2.E4.m1.1.1.3.1.2.cmml" xref="S2.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.2.1.cmml" xref="S2.E4.m1.1.1.3.1">subscript</csymbol><sum id="S2.E4.m1.1.1.3.1.2.2.cmml" xref="S2.E4.m1.1.1.3.1.2.2"></sum><apply id="S2.E4.m1.1.1.3.1.2.3.cmml" xref="S2.E4.m1.1.1.3.1.2.3"><eq id="S2.E4.m1.1.1.3.1.2.3.1.cmml" xref="S2.E4.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E4.m1.1.1.3.1.2.3.2.cmml" xref="S2.E4.m1.1.1.3.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E4.m1.1.1.3.1.2.3.3.cmml" xref="S2.E4.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.1.1.3.1.3.cmml" xref="S2.E4.m1.1.1.3.1.3">𝐾</ci></apply><apply id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2"><times id="S2.E4.m1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.1"></times><apply id="S2.E4.m1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.3.2.2">superscript</csymbol><apply id="S2.E4.m1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.2.2.1.cmml" xref="S2.E4.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.3.2.2.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2.2.2">𝑐</ci><ci id="S2.E4.m1.1.1.3.2.2.2.3.cmml" xref="S2.E4.m1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S2.E4.m1.1.1.3.2.2.3.cmml" xref="S2.E4.m1.1.1.3.2.2.3">𝑇</ci></apply><apply id="S2.E4.m1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.3.1.cmml" xref="S2.E4.m1.1.1.3.2.3">superscript</csymbol><apply id="S2.E4.m1.1.1.3.2.3.2.cmml" xref="S2.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E4.m1.1.1.3.2.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.3.2.2">𝑤</ci><ci id="S2.E4.m1.1.1.3.2.3.2.3.cmml" xref="S2.E4.m1.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S2.E4.m1.1.1.3.2.3.3.cmml" xref="S2.E4.m1.1.1.3.2.3.3"><ci id="S2.E4.m1.1.1.3.2.3.3.1.cmml" xref="S2.E4.m1.1.1.3.2.3.3.1">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">c=\sum_{t=1}^{K}c_{i}^{T}w_{i}^{{}^{\prime}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.4" class="ltx_p"><span id="S2.SS2.p2.4.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p2.3.m1.1" class="ltx_Math" alttext="w_{i}^{{}^{\prime}}" display="inline"><semantics id="S2.SS2.p2.3.m1.1a"><msubsup id="S2.SS2.p2.3.m1.1.1" xref="S2.SS2.p2.3.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.3.m1.1.1.2.2" xref="S2.SS2.p2.3.m1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="S2.SS2.p2.3.m1.1.1.2.3" xref="S2.SS2.p2.3.m1.1.1.2.3.cmml">i</mi><msup id="S2.SS2.p2.3.m1.1.1.3" xref="S2.SS2.p2.3.m1.1.1.3.cmml"><mi id="S2.SS2.p2.3.m1.1.1.3a" xref="S2.SS2.p2.3.m1.1.1.3.cmml"></mi><mo mathsize="90%" id="S2.SS2.p2.3.m1.1.1.3.1" xref="S2.SS2.p2.3.m1.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m1.1b"><apply id="S2.SS2.p2.3.m1.1.1.cmml" xref="S2.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m1.1.1.1.cmml" xref="S2.SS2.p2.3.m1.1.1">superscript</csymbol><apply id="S2.SS2.p2.3.m1.1.1.2.cmml" xref="S2.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m1.1.1.2.1.cmml" xref="S2.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m1.1.1.2.2.cmml" xref="S2.SS2.p2.3.m1.1.1.2.2">𝑤</ci><ci id="S2.SS2.p2.3.m1.1.1.2.3.cmml" xref="S2.SS2.p2.3.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.3.m1.1.1.3.cmml" xref="S2.SS2.p2.3.m1.1.1.3"><ci id="S2.SS2.p2.3.m1.1.1.3.1.cmml" xref="S2.SS2.p2.3.m1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m1.1c">w_{i}^{{}^{\prime}}</annotation></semantics></math><span id="S2.SS2.p2.4.2" class="ltx_text" style="font-size:90%;"> corresponds to the aligned weight of each head and </span><math id="S2.SS2.p2.4.m2.1" class="ltx_Math" alttext="u^{{}^{\prime}}\in\mathbb{R}^{D/K}" display="inline"><semantics id="S2.SS2.p2.4.m2.1a"><mrow id="S2.SS2.p2.4.m2.1.1" xref="S2.SS2.p2.4.m2.1.1.cmml"><msup id="S2.SS2.p2.4.m2.1.1.2" xref="S2.SS2.p2.4.m2.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p2.4.m2.1.1.2.2" xref="S2.SS2.p2.4.m2.1.1.2.2.cmml">u</mi><msup id="S2.SS2.p2.4.m2.1.1.2.3" xref="S2.SS2.p2.4.m2.1.1.2.3.cmml"><mi id="S2.SS2.p2.4.m2.1.1.2.3a" xref="S2.SS2.p2.4.m2.1.1.2.3.cmml"></mi><mo mathsize="90%" id="S2.SS2.p2.4.m2.1.1.2.3.1" xref="S2.SS2.p2.4.m2.1.1.2.3.1.cmml">′</mo></msup></msup><mo mathsize="90%" id="S2.SS2.p2.4.m2.1.1.1" xref="S2.SS2.p2.4.m2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.4.m2.1.1.3" xref="S2.SS2.p2.4.m2.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.4.m2.1.1.3.2" xref="S2.SS2.p2.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.4.m2.1.1.3.3" xref="S2.SS2.p2.4.m2.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.4.m2.1.1.3.3.2" xref="S2.SS2.p2.4.m2.1.1.3.3.2.cmml">D</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p2.4.m2.1.1.3.3.1" xref="S2.SS2.p2.4.m2.1.1.3.3.1.cmml">/</mo><mi mathsize="90%" id="S2.SS2.p2.4.m2.1.1.3.3.3" xref="S2.SS2.p2.4.m2.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m2.1b"><apply id="S2.SS2.p2.4.m2.1.1.cmml" xref="S2.SS2.p2.4.m2.1.1"><in id="S2.SS2.p2.4.m2.1.1.1.cmml" xref="S2.SS2.p2.4.m2.1.1.1"></in><apply id="S2.SS2.p2.4.m2.1.1.2.cmml" xref="S2.SS2.p2.4.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m2.1.1.2.1.cmml" xref="S2.SS2.p2.4.m2.1.1.2">superscript</csymbol><ci id="S2.SS2.p2.4.m2.1.1.2.2.cmml" xref="S2.SS2.p2.4.m2.1.1.2.2">𝑢</ci><apply id="S2.SS2.p2.4.m2.1.1.2.3.cmml" xref="S2.SS2.p2.4.m2.1.1.2.3"><ci id="S2.SS2.p2.4.m2.1.1.2.3.1.cmml" xref="S2.SS2.p2.4.m2.1.1.2.3.1">′</ci></apply></apply><apply id="S2.SS2.p2.4.m2.1.1.3.cmml" xref="S2.SS2.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m2.1.1.3.1.cmml" xref="S2.SS2.p2.4.m2.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.4.m2.1.1.3.2.cmml" xref="S2.SS2.p2.4.m2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.4.m2.1.1.3.3.cmml" xref="S2.SS2.p2.4.m2.1.1.3.3"><divide id="S2.SS2.p2.4.m2.1.1.3.3.1.cmml" xref="S2.SS2.p2.4.m2.1.1.3.3.1"></divide><ci id="S2.SS2.p2.4.m2.1.1.3.3.2.cmml" xref="S2.SS2.p2.4.m2.1.1.3.3.2">𝐷</ci><ci id="S2.SS2.p2.4.m2.1.1.3.3.3.cmml" xref="S2.SS2.p2.4.m2.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m2.1c">u^{{}^{\prime}}\in\mathbb{R}^{D/K}</annotation></semantics></math><span id="S2.SS2.p2.4.3" class="ltx_text" style="font-size:90%;"> is a trainable parameter.</span></p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text" style="font-size:90%;">With this method, each utterance context vector </span><math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi mathsize="90%" id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">c</annotation></semantics></math><span id="S2.SS2.p3.1.2" class="ltx_text" style="font-size:90%;"> is computed as a weighted average of the context vectors among heads.
This allows to capture different kinds of speaker patterns in different regions of the input and, at the same time, to weigh the relevance of each of these patterns for each utterance.</span></p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Fully-connected layers</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p"><span id="S2.SS3.p1.1.1" class="ltx_text" style="font-size:90%;">The utterance-level speaker vector obtained from the pooling layer is fed into a set of four FC layers.
Each of the first two FC layers is followed by a batch normalization and Rectified Linear Unit (ReLU) activations.
A dense layer is adopted for the third FC layer and the last FC is a SoftMax layer that corresponds to the speaker classification output layer.</span></p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p"><span id="S2.SS3.p2.1.1" class="ltx_text" style="font-size:90%;">Once the network is trained, we can extract a speaker embedding from one of the intermediate FC layers.
According to </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS3.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib19" title="" class="ltx_ref">19</a><span id="S2.SS3.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS3.p2.1.4" class="ltx_text" style="font-size:90%;">, we consider the second layer as the speaker embedding instead of the third one.
The output of this layer then corresponds to the speaker representation that will be used for the speaker verification task.</span></p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">3 </span>Speaker Verification</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text" style="font-size:90%;">The DMHSA system has been assessed in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S3.SS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.1.4" class="ltx_text" style="font-size:90%;"> by VoxCeleb dataset </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S3.SS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.1.7" class="ltx_text" style="font-size:90%;">.
VoxCeleb is a large multimedia database that contains more than one million 16kHz audio utterances for more than 6K celebrities and has two different versions with several evaluation protocols.
For </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S3.SS1.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.1.10" class="ltx_text" style="font-size:90%;"> experiments, VoxCeleb2 development partition with no augmentation has been used to train all models.
The performance of these systems has been evaluated with Vox1-Test, Vox1-E, and Vox1-H conditions.
Vox1 test only uses the test set, Vox1-E uses the whole development + test corpus and Vox1-H is restricted to audio pairs from same nationality and gender speakers.</span></p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p"><span id="S3.SS1.p2.1.1" class="ltx_text" style="font-size:90%;">DMHSA pooling has been evaluated against two self-attentive-based pooling methods: MHSA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S3.SS1.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p2.1.4" class="ltx_text" style="font-size:90%;"> and vanilla Self-Attention (which is indeed a single-head MHSA).
In order to evaluate them, only the pooling layer of the system (Figure </span><a href="#S2.F1" title="Figure 1 ‣ 2 Double Multi-Head Self-Attention Pooling ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S3.SS1.p2.1.5" class="ltx_text" style="font-size:90%;">) has been replaced without modifying any other block or parameter from the network.
The speaker embeddings used for the verification tests have been extracted from the same FC layer for each of the pooling methods.
Cosine distance has been used to compute the scores between pairs of speaker embeddings.
The number of heads for both MHSA and DMHSA pooling layer were tuned: 8, 16, and 32 heads were considered.</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Results</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p"><span id="S3.SS2.p1.2.1" class="ltx_text" style="font-size:90%;">The results of </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS2.p1.2.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S3.SS2.p1.2.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS2.p1.2.4" class="ltx_text" style="font-size:90%;"> experiments are shown in Table </span><a href="#S3.T1" title="Table 1 ‣ 3.2 Results ‣ 3 Speaker Verification ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S3.SS2.p1.2.5" class="ltx_text" style="font-size:90%;">.
Performance was evaluated using Equal Error Rate (EER).
Both Self-Attention and MHSA approaches were used as baselines, since they have been proved to outperform three previous baselines: statistical and temporal pooling based methods and an i-vector + PLDA system </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS2.p1.2.6.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S3.SS2.p1.2.7.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS2.p1.2.8" class="ltx_text" style="font-size:90%;">.
Self-Attention pooling has shown very similar results compared to MHSA approaches.
DMHSA have shown better results for all head values compared with both Self Attention and MHSA approaches.
Best performance in DMHSA based models has been achieved with 16 and 32 heads.
Within Vox1-Test protocol, the best DMHSA model (16 heads) has shown a </span><math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="6.73\%" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn mathsize="90%" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">6.73</mn><mo mathsize="90%" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">6.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">6.73\%</annotation></semantics></math><span id="S3.SS2.p1.2.9" class="ltx_text" style="font-size:90%;"> and </span><math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="5.06\%" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn mathsize="90%" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">5.06</mn><mo mathsize="90%" id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">5.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">5.06\%</annotation></semantics></math><span id="S3.SS2.p1.2.10" class="ltx_text" style="font-size:90%;"> relative improvement in terms of EER compared to Self Attention pooling and the best MHSA pooling (8 heads), respectively.</span></p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Speaker verification evaluation results on VoxCeleb 1 protocols.</figcaption>
<table id="S3.T1.21" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.21.22.1" class="ltx_tr">
<th id="S3.T1.21.22.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span id="S3.T1.21.22.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Approach</span></th>
<th id="S3.T1.21.22.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.21.22.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Heads</span></th>
<th id="S3.T1.21.22.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.21.22.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Vox1-Test EER</span></th>
<th id="S3.T1.21.22.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.21.22.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Vox1-E EER</span></th>
<th id="S3.T1.21.22.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.21.22.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Vox1-H EER</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.3.3" class="ltx_tr">
<th id="S3.T1.3.3.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T1.3.3.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.3.3.5.1" class="ltx_text" style="font-size:90%;">Self-Attention</span></th>
<td id="S3.T1.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.3.3.6.1" class="ltx_text" style="font-size:90%;">1</span></td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="3.42" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mn mathsize="90%" id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">3.42</mn><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><cn type="float" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">3.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">3.42</annotation></semantics></math></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="3.42" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mn mathsize="90%" id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">3.42</mn><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><cn type="float" id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">3.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">3.42</annotation></semantics></math></td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="4.89" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><mn mathsize="90%" id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml">4.89</mn><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><cn type="float" id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">4.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">4.89</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<th id="S3.T1.6.6.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row"></th>
<th id="S3.T1.6.6.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.6.6.5.1" class="ltx_text" style="font-size:90%;">MHSA</span></th>
<td id="S3.T1.6.6.6" class="ltx_td ltx_align_center"><span id="S3.T1.6.6.6.1" class="ltx_text" style="font-size:90%;">8</span></td>
<td id="S3.T1.4.4.1" class="ltx_td ltx_align_center"><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="3.36" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><mn mathsize="90%" id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">3.36</mn><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><cn type="float" id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">3.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">3.36</annotation></semantics></math></td>
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_center"><math id="S3.T1.5.5.2.m1.1" class="ltx_Math" alttext="3.44" display="inline"><semantics id="S3.T1.5.5.2.m1.1a"><mn mathsize="90%" id="S3.T1.5.5.2.m1.1.1" xref="S3.T1.5.5.2.m1.1.1.cmml">3.44</mn><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.m1.1b"><cn type="float" id="S3.T1.5.5.2.m1.1.1.cmml" xref="S3.T1.5.5.2.m1.1.1">3.44</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.m1.1c">3.44</annotation></semantics></math></td>
<td id="S3.T1.6.6.3" class="ltx_td ltx_align_center"><math id="S3.T1.6.6.3.m1.1" class="ltx_Math" alttext="5.04" display="inline"><semantics id="S3.T1.6.6.3.m1.1a"><mn mathsize="90%" id="S3.T1.6.6.3.m1.1.1" xref="S3.T1.6.6.3.m1.1.1.cmml">5.04</mn><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.3.m1.1b"><cn type="float" id="S3.T1.6.6.3.m1.1.1.cmml" xref="S3.T1.6.6.3.m1.1.1">5.04</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.3.m1.1c">5.04</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<th id="S3.T1.9.9.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row"></th>
<th id="S3.T1.9.9.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.9.9.5.1" class="ltx_text" style="font-size:90%;">MHSA</span></th>
<td id="S3.T1.9.9.6" class="ltx_td ltx_align_center"><span id="S3.T1.9.9.6.1" class="ltx_text" style="font-size:90%;">16</span></td>
<td id="S3.T1.7.7.1" class="ltx_td ltx_align_center"><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="3.43" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><mn mathsize="90%" id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml">3.43</mn><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><cn type="float" id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">3.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">3.43</annotation></semantics></math></td>
<td id="S3.T1.8.8.2" class="ltx_td ltx_align_center"><math id="S3.T1.8.8.2.m1.1" class="ltx_Math" alttext="3.40" display="inline"><semantics id="S3.T1.8.8.2.m1.1a"><mn mathsize="90%" id="S3.T1.8.8.2.m1.1.1" xref="S3.T1.8.8.2.m1.1.1.cmml">3.40</mn><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.2.m1.1b"><cn type="float" id="S3.T1.8.8.2.m1.1.1.cmml" xref="S3.T1.8.8.2.m1.1.1">3.40</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.2.m1.1c">3.40</annotation></semantics></math></td>
<td id="S3.T1.9.9.3" class="ltx_td ltx_align_center"><math id="S3.T1.9.9.3.m1.1" class="ltx_Math" alttext="4.90" display="inline"><semantics id="S3.T1.9.9.3.m1.1a"><mn mathsize="90%" id="S3.T1.9.9.3.m1.1.1" xref="S3.T1.9.9.3.m1.1.1.cmml">4.90</mn><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.3.m1.1b"><cn type="float" id="S3.T1.9.9.3.m1.1.1.cmml" xref="S3.T1.9.9.3.m1.1.1">4.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.3.m1.1c">4.90</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.12.12.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row"></th>
<th id="S3.T1.12.12.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.12.12.5.1" class="ltx_text" style="font-size:90%;">MHSA</span></th>
<td id="S3.T1.12.12.6" class="ltx_td ltx_align_center"><span id="S3.T1.12.12.6.1" class="ltx_text" style="font-size:90%;">32</span></td>
<td id="S3.T1.10.10.1" class="ltx_td ltx_align_center"><math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="3.64" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><mn mathsize="90%" id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">3.64</mn><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><cn type="float" id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">3.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">3.64</annotation></semantics></math></td>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_center"><math id="S3.T1.11.11.2.m1.1" class="ltx_Math" alttext="3.68" display="inline"><semantics id="S3.T1.11.11.2.m1.1a"><mn mathsize="90%" id="S3.T1.11.11.2.m1.1.1" xref="S3.T1.11.11.2.m1.1.1.cmml">3.68</mn><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.2.m1.1b"><cn type="float" id="S3.T1.11.11.2.m1.1.1.cmml" xref="S3.T1.11.11.2.m1.1.1">3.68</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.2.m1.1c">3.68</annotation></semantics></math></td>
<td id="S3.T1.12.12.3" class="ltx_td ltx_align_center"><math id="S3.T1.12.12.3.m1.1" class="ltx_Math" alttext="5.35" display="inline"><semantics id="S3.T1.12.12.3.m1.1a"><mn mathsize="90%" id="S3.T1.12.12.3.m1.1.1" xref="S3.T1.12.12.3.m1.1.1.cmml">5.35</mn><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.3.m1.1b"><cn type="float" id="S3.T1.12.12.3.m1.1.1.cmml" xref="S3.T1.12.12.3.m1.1.1">5.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.3.m1.1c">5.35</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.15.15" class="ltx_tr">
<th id="S3.T1.15.15.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row"></th>
<th id="S3.T1.15.15.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.15.15.5.1" class="ltx_text" style="font-size:90%;">DMHSA</span></th>
<td id="S3.T1.15.15.6" class="ltx_td ltx_align_center"><span id="S3.T1.15.15.6.1" class="ltx_text" style="font-size:90%;">8</span></td>
<td id="S3.T1.13.13.1" class="ltx_td ltx_align_center"><math id="S3.T1.13.13.1.m1.1" class="ltx_Math" alttext="3.27" display="inline"><semantics id="S3.T1.13.13.1.m1.1a"><mn mathsize="90%" id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml">3.27</mn><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><cn type="float" id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">3.27</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">3.27</annotation></semantics></math></td>
<td id="S3.T1.14.14.2" class="ltx_td ltx_align_center"><math id="S3.T1.14.14.2.m1.1" class="ltx_Math" alttext="3.23" display="inline"><semantics id="S3.T1.14.14.2.m1.1a"><mn mathsize="90%" id="S3.T1.14.14.2.m1.1.1" xref="S3.T1.14.14.2.m1.1.1.cmml">3.23</mn><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.2.m1.1b"><cn type="float" id="S3.T1.14.14.2.m1.1.1.cmml" xref="S3.T1.14.14.2.m1.1.1">3.23</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.2.m1.1c">3.23</annotation></semantics></math></td>
<td id="S3.T1.15.15.3" class="ltx_td ltx_align_center"><math id="S3.T1.15.15.3.m1.1" class="ltx_Math" alttext="4.69" display="inline"><semantics id="S3.T1.15.15.3.m1.1a"><mn mathsize="90%" id="S3.T1.15.15.3.m1.1.1" xref="S3.T1.15.15.3.m1.1.1.cmml">4.69</mn><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.3.m1.1b"><cn type="float" id="S3.T1.15.15.3.m1.1.1.cmml" xref="S3.T1.15.15.3.m1.1.1">4.69</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.3.m1.1c">4.69</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.18.18" class="ltx_tr">
<th id="S3.T1.18.18.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row"></th>
<th id="S3.T1.18.18.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.18.18.5.1" class="ltx_text" style="font-size:90%;">DMHSA</span></th>
<td id="S3.T1.18.18.6" class="ltx_td ltx_align_center"><span id="S3.T1.18.18.6.1" class="ltx_text" style="font-size:90%;">16</span></td>
<td id="S3.T1.16.16.1" class="ltx_td ltx_align_center"><math id="S3.T1.16.16.1.m1.1" class="ltx_Math" alttext="3.19" display="inline"><semantics id="S3.T1.16.16.1.m1.1a"><mn mathsize="90%" id="S3.T1.16.16.1.m1.1.1" xref="S3.T1.16.16.1.m1.1.1.cmml">3.19</mn><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.1.m1.1b"><cn type="float" id="S3.T1.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1">3.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.1.m1.1c">3.19</annotation></semantics></math></td>
<td id="S3.T1.17.17.2" class="ltx_td ltx_align_center"><math id="S3.T1.17.17.2.m1.1" class="ltx_Math" alttext="3.22" display="inline"><semantics id="S3.T1.17.17.2.m1.1a"><mn mathsize="90%" id="S3.T1.17.17.2.m1.1.1" xref="S3.T1.17.17.2.m1.1.1.cmml">3.22</mn><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.2.m1.1b"><cn type="float" id="S3.T1.17.17.2.m1.1.1.cmml" xref="S3.T1.17.17.2.m1.1.1">3.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.2.m1.1c">3.22</annotation></semantics></math></td>
<td id="S3.T1.18.18.3" class="ltx_td ltx_align_center"><math id="S3.T1.18.18.3.m1.1" class="ltx_Math" alttext="4.67" display="inline"><semantics id="S3.T1.18.18.3.m1.1a"><mn mathsize="90%" id="S3.T1.18.18.3.m1.1.1" xref="S3.T1.18.18.3.m1.1.1.cmml">4.67</mn><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.3.m1.1b"><cn type="float" id="S3.T1.18.18.3.m1.1.1.cmml" xref="S3.T1.18.18.3.m1.1.1">4.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.3.m1.1c">4.67</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.21.21" class="ltx_tr">
<th id="S3.T1.21.21.4" class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_bb"></th>
<th id="S3.T1.21.21.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.21.21.5.1" class="ltx_text" style="font-size:90%;">DMHSA</span></th>
<td id="S3.T1.21.21.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.21.21.6.1" class="ltx_text" style="font-size:90%;">32</span></td>
<td id="S3.T1.19.19.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.19.19.1.m1.1" class="ltx_Math" alttext="3.23" display="inline"><semantics id="S3.T1.19.19.1.m1.1a"><mn mathsize="90%" id="S3.T1.19.19.1.m1.1.1" xref="S3.T1.19.19.1.m1.1.1.cmml">3.23</mn><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.1.m1.1b"><cn type="float" id="S3.T1.19.19.1.m1.1.1.cmml" xref="S3.T1.19.19.1.m1.1.1">3.23</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.1.m1.1c">3.23</annotation></semantics></math></td>
<td id="S3.T1.20.20.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.20.20.2.m1.1" class="ltx_Math" alttext="3.18" display="inline"><semantics id="S3.T1.20.20.2.m1.1a"><mn mathsize="90%" id="S3.T1.20.20.2.m1.1.1" xref="S3.T1.20.20.2.m1.1.1.cmml">3.18</mn><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.2.m1.1b"><cn type="float" id="S3.T1.20.20.2.m1.1.1.cmml" xref="S3.T1.20.20.2.m1.1.1">3.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.2.m1.1c">3.18</annotation></semantics></math></td>
<td id="S3.T1.21.21.3" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.21.21.3.m1.1" class="ltx_Math" alttext="4.61" display="inline"><semantics id="S3.T1.21.21.3.m1.1a"><mn mathsize="90%" id="S3.T1.21.21.3.m1.1.1" xref="S3.T1.21.21.3.m1.1.1.cmml">4.61</mn><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.3.m1.1b"><cn type="float" id="S3.T1.21.21.3.m1.1.1.cmml" xref="S3.T1.21.21.3.m1.1.1">4.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.3.m1.1c">4.61</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">4 </span>Speaker characterization applications</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text" style="font-size:90%;">In this section we present several works that adapted and applied the DMHSA system to SC tasks, which are: </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S4.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.p1.1.4" class="ltx_text" style="font-size:90%;"> for SER, </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S4.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.p1.1.7" class="ltx_text" style="font-size:90%;"> for Speaker Sex Classification and </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.p1.1.10" class="ltx_text" style="font-size:90%;"> for Speaker COVID-19 Detection.</span></p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Speaker Emotion Recognition</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text" style="font-size:90%;">SER is an SC task where the goal is to recognize the emotion from speech.
Human emotion is classified using the six archetypal emotions approach, from which all emotional states can be derived </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S4.SS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.p1.1.4" class="ltx_text" style="font-size:90%;">.
These archetypal emotions are Anger, Fear, Disgust, Surprise, Joy, Sadness and an added Neutral state.
Several attempts at SER using statistical models have provided acceptable results, such as Gaussian Mixture Models (GMM) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S4.SS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.p1.1.7" class="ltx_text" style="font-size:90%;">, Hidden Markov Models (HMM) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S4.SS1.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.p1.1.10" class="ltx_text" style="font-size:90%;"> and i-vectors </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.p1.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib28" title="" class="ltx_ref">28</a><span id="S4.SS1.p1.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.p1.1.13" class="ltx_text" style="font-size:90%;">.
Over the last years, SER has really taken off with the explosion of DL techniques </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.p1.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a><span id="S4.SS1.p1.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.p1.1.16" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Experimental setup</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p"><span id="S4.SS1.SSS1.p1.1.1" class="ltx_text" style="font-size:90%;">In </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.SSS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S4.SS1.SSS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.SSS1.p1.1.4" class="ltx_text" style="font-size:90%;">, the DMHSA system was adapted to solve SER.
It was assessed by the INTERFACE dataset </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.SSS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib31" title="" class="ltx_ref">31</a><span id="S4.SS1.SSS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.SSS1.p1.1.7" class="ltx_text" style="font-size:90%;">.
This database was designed for the general study of emotional speech.
It contains recordings in four different languages: Slovenian, English, Spanish and French, distributed uniformly.
For each language, there are 170-190 sentences spoken by two different actors, one male and one female, except for Spanish where two male actors and one female are used.
Each sentence is spoken in seven different styles, for a total number of 24,197 recordings.
The styles (emotion labels) are: Anger, Sadness, Joy, Fear, Disgust, Surprise and a Neutral style with different variations depending on the language.
For the purpose of classification, all these styles were considered as one general “Neutral” style.
Therefore, </span><math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="28\%" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">28</mn><mo mathsize="90%" id="S4.SS1.SSS1.p1.1.m1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">28\%</annotation></semantics></math><span id="S4.SS1.SSS1.p1.1.8" class="ltx_text" style="font-size:90%;"> of the samples were labelled as Neutral style.
The rest of the samples are uniformly distributed between the other labels.</span></p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p"><span id="S4.SS1.SSS1.p2.1.1" class="ltx_text" style="font-size:90%;">The DMHSA model was adapted to this problem by changing the SoftMax layer to a seven units output (one for each emotion label) and by using a 3-blocks front-end feature extractor instead of the 4-blocks one proposed in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.SSS1.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S4.SS1.SSS1.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.SSS1.p2.1.4" class="ltx_text" style="font-size:90%;">.
Several models with different attention mechanisms (vanilla Self-Attention, MHSA and DMHSA) were trained: 1 for Self-Attention, 5 for MHSA and 5 for DMHSA, both with different head numbers (4, 8, 16, 32 and 64).
These models were tested against a baseline model, which architecture had a statistical pooling component instead of an attention-based one.</span></p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.8" class="ltx_p"><span id="S4.SS1.SSS1.p3.8.1" class="ltx_text" style="font-size:90%;">To train the model, the entirety of the dataset was split into three parts: </span><math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="70\%" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><mrow id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p3.1.m1.1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml">70</mn><mo mathsize="90%" id="S4.SS1.SSS1.p3.1.m1.1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">70\%</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.2" class="ltx_text" style="font-size:90%;"> train, </span><math id="S4.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.SS1.SSS1.p3.2.m2.1a"><mrow id="S4.SS1.SSS1.p3.2.m2.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p3.2.m2.1.1.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml">10</mn><mo mathsize="90%" id="S4.SS1.SSS1.p3.2.m2.1.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.2.m2.1b"><apply id="S4.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.2.m2.1c">10\%</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.3" class="ltx_text" style="font-size:90%;"> validation and </span><math id="S4.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS1.SSS1.p3.3.m3.1a"><mrow id="S4.SS1.SSS1.p3.3.m3.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p3.3.m3.1.1.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml">20</mn><mo mathsize="90%" id="S4.SS1.SSS1.p3.3.m3.1.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.3.m3.1b"><apply id="S4.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.3.m3.1c">20\%</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.4" class="ltx_text" style="font-size:90%;"> test.
The training was done with early stopping parameter equal to 5, batch size was 64 and the number of seconds of temporal window taken from the audio files in training was fixed to 1 second.
For validation and test the whole utterances have been encoded.
Adam optimizer was used, the learning rate was set to </span><math id="S4.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S4.SS1.SSS1.p3.4.m4.1a"><mn mathsize="90%" id="S4.SS1.SSS1.p3.4.m4.1.1" xref="S4.SS1.SSS1.p3.4.m4.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.4.m4.1b"><cn type="float" id="S4.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.4.m4.1c">0.0001</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.5" class="ltx_text" style="font-size:90%;"> and the weight decay parameter was set to </span><math id="S4.SS1.SSS1.p3.5.m5.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS1.SSS1.p3.5.m5.1a"><mn mathsize="90%" id="S4.SS1.SSS1.p3.5.m5.1.1" xref="S4.SS1.SSS1.p3.5.m5.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.5.m5.1b"><cn type="float" id="S4.SS1.SSS1.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.5.m5.1c">0.01</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.6" class="ltx_text" style="font-size:90%;">.
In the case of DMHSA, a head drop probability of 0.3 was fixed for 16, 32 and 64 heads, meaning that any given head had a probability of </span><math id="S4.SS1.SSS1.p3.6.m6.1" class="ltx_Math" alttext="30\%" display="inline"><semantics id="S4.SS1.SSS1.p3.6.m6.1a"><mrow id="S4.SS1.SSS1.p3.6.m6.1.1" xref="S4.SS1.SSS1.p3.6.m6.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p3.6.m6.1.1.2" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.cmml">30</mn><mo mathsize="90%" id="S4.SS1.SSS1.p3.6.m6.1.1.1" xref="S4.SS1.SSS1.p3.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.6.m6.1b"><apply id="S4.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.2">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.6.m6.1c">30\%</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.7" class="ltx_text" style="font-size:90%;"> to have its weight set to 0.
The drop probability for 4 and 8 heads was set to </span><math id="S4.SS1.SSS1.p3.7.m7.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS1.SSS1.p3.7.m7.1a"><mn mathsize="90%" id="S4.SS1.SSS1.p3.7.m7.1.1" xref="S4.SS1.SSS1.p3.7.m7.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.7.m7.1b"><cn type="float" id="S4.SS1.SSS1.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.7.m7.1c">0.01</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.8" class="ltx_text" style="font-size:90%;"> because the number of heads was too low for a </span><math id="S4.SS1.SSS1.p3.8.m8.1" class="ltx_Math" alttext="30\%" display="inline"><semantics id="S4.SS1.SSS1.p3.8.m8.1a"><mrow id="S4.SS1.SSS1.p3.8.m8.1.1" xref="S4.SS1.SSS1.p3.8.m8.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS1.p3.8.m8.1.1.2" xref="S4.SS1.SSS1.p3.8.m8.1.1.2.cmml">30</mn><mo mathsize="90%" id="S4.SS1.SSS1.p3.8.m8.1.1.1" xref="S4.SS1.SSS1.p3.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.8.m8.1b"><apply id="S4.SS1.SSS1.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1.2">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.8.m8.1c">30\%</annotation></semantics></math><span id="S4.SS1.SSS1.p3.8.9" class="ltx_text" style="font-size:90%;"> drop and caused instabilities in training.</span></p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Results</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p"><span id="S4.SS1.SSS2.p1.1.1" class="ltx_text" style="font-size:90%;">The results of </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS1.SSS2.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S4.SS1.SSS2.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS1.SSS2.p1.1.4" class="ltx_text" style="font-size:90%;"> experiments are shown in Table </span><a href="#S4.T2" title="Table 2 ‣ 4.1.2 Results ‣ 4.1 Speaker Emotion Recognition ‣ 4 Speaker characterization applications ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S4.SS1.SSS2.p1.1.5" class="ltx_text" style="font-size:90%;">.
Performance was evaluated on the test set using Accuracy.
Self-attention performed close to statistical pooling, but slightly worse.
For MHSA, the best results were obtained with 32 heads, with a relative accuracy improvement of </span><math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="1.23\%" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mrow id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.SS1.SSS2.p1.1.m1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml">1.23</mn><mo mathsize="90%" id="S4.SS1.SSS2.p1.1.m1.1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2">1.23</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">1.23\%</annotation></semantics></math><span id="S4.SS1.SSS2.p1.1.6" class="ltx_text" style="font-size:90%;"> with respect to statistical pooling.
For DMHSA, the best result was obtained again with 32 heads, but slightly worse than statistical pooling accuracy.
MHSA has effectively obtained a better pooled representation than statistical pooling by being more selective about the information contained in the embedding.
The reason for the underwhelming performance of Self-Attention could be the short 1 second temporal window used, since if the input contains more frames, more attention weights can be assigned and this could lead to a better pooled representation.
While DMHSA provides an increase in performance for SV, the compression factor that comes with the DMHSA seems to affect the model’s ability to predict emotion in this experiment (compared to MHSA which does not compress the final context vector).</span></p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>SER test results from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.5.1" class="ltx_tr">
<th id="S4.T2.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T2.4.5.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></th>
<th id="S4.T2.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.5.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.2" class="ltx_td ltx_nopad_r ltx_border_t"></td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t"><span id="S4.T2.1.1.3.1" class="ltx_text" style="font-size:90%;">MHSA 32 Heads</span></td>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="91.09\%" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2.cmml">91.09</mn><mo mathsize="90%" id="S4.T2.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">91.09</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">91.09\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.2" class="ltx_td ltx_nopad_r"></td>
<td id="S4.T2.2.2.3" class="ltx_td ltx_nopad_l ltx_align_left"><span id="S4.T2.2.2.3.1" class="ltx_text" style="font-size:90%;">Statistical Pooling</span></td>
<td id="S4.T2.2.2.1" class="ltx_td ltx_align_center"><math id="S4.T2.2.2.1.m1.1" class="ltx_Math" alttext="89.98\%" display="inline"><semantics id="S4.T2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.2.cmml">89.98</mn><mo mathsize="90%" id="S4.T2.2.2.1.m1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2">89.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">89.98\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<td id="S4.T2.3.3.2" class="ltx_td ltx_nopad_r"></td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_nopad_l ltx_align_left"><span id="S4.T2.3.3.3.1" class="ltx_text" style="font-size:90%;">DMHSA 32 Heads</span></td>
<td id="S4.T2.3.3.1" class="ltx_td ltx_align_center"><math id="S4.T2.3.3.1.m1.1" class="ltx_Math" alttext="89.87\%" display="inline"><semantics id="S4.T2.3.3.1.m1.1a"><mrow id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T2.3.3.1.m1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.2.cmml">89.87</mn><mo mathsize="90%" id="S4.T2.3.3.1.m1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.3.3.1.m1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T2.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2">89.87</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">89.87\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.4.4" class="ltx_tr">
<td id="S4.T2.4.4.2" class="ltx_td ltx_nopad_r ltx_border_bb"></td>
<td id="S4.T2.4.4.3" class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb"><span id="S4.T2.4.4.3.1" class="ltx_text" style="font-size:90%;">Self-Attention</span></td>
<td id="S4.T2.4.4.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T2.4.4.1.m1.1" class="ltx_Math" alttext="89.32\%" display="inline"><semantics id="S4.T2.4.4.1.m1.1a"><mrow id="S4.T2.4.4.1.m1.1.1" xref="S4.T2.4.4.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T2.4.4.1.m1.1.1.2" xref="S4.T2.4.4.1.m1.1.1.2.cmml">89.32</mn><mo mathsize="90%" id="S4.T2.4.4.1.m1.1.1.1" xref="S4.T2.4.4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.1b"><apply id="S4.T2.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.4.4.1.m1.1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T2.4.4.1.m1.1.1.2.cmml" xref="S4.T2.4.4.1.m1.1.1.2">89.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.1c">89.32\%</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Speaker Sex Classification</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text" style="font-size:90%;">Speaker Sex Classification is an SC task where the speaker’s sex is extracted from a voice utterance.
Over the last years, multiple investigations have tried to fully optimize Speaker Sex Classification systems’ performance using DL in order to accomplish almost perfect results </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS2.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.SS2.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS2.p1.1.4" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Experimental setup</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p"><span id="S4.SS2.SSS1.p1.1.1" class="ltx_text" style="font-size:90%;">In </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS2.SSS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S4.SS2.SSS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS2.SSS1.p1.1.4" class="ltx_text" style="font-size:90%;">, the DMHSA system was adapted to solve a speaker sex classification task.
It was assessed by the Catalan Common Voice dataset </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS2.SSS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib34" title="" class="ltx_ref">34</a><span id="S4.SS2.SSS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS2.SSS1.p1.1.7" class="ltx_text" style="font-size:90%;">.
The Catalan Common Voice dataset was created in 2018 and has seen a huge expanding thanks to the promotion it has received in the last years and the voice donations of the Catalan-speaking population.
The creation of this database and the need to adapt artificial intelligence technologies to the Catalan language, lead to the development of the AINA project </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS2.SSS1.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib35" title="" class="ltx_ref">35</a><span id="S4.SS2.SSS1.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS2.SSS1.p1.1.10" class="ltx_text" style="font-size:90%;">.
This project -promoted by the Departament de la Vicepresidència i de Polítiques Digitals i Territori of the Catalan government and the Barcelona Supercomputing Center- aims to shape speech recognition techniques to Catalan.
For sex classification, three labels are given: Male (with 385,061 samples), Female (with 117,666 samples) and Other (with 418 samples).
A significant imbalance towards the Male class can be observed.
The class under the label Other was discarded.
For this task’s experiment, as the number of samples from each class in the dataset was large enough, almost completely balanced classes were used for the training set (around 70,000 samples from each class).
Only utterances longer than 2.5 seconds were considered.</span></p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.2" class="ltx_p"><span id="S4.SS2.SSS1.p2.2.1" class="ltx_text" style="font-size:90%;">The DMHSA model was adapted to this problem by changing the SoftMax layer to a two units output (one for each sex label) and by using a 3-blocks front-end feature extractor.
The DMHSA model was trained and tested with 32 heads and two different loss functions: Cross-Entropy (CE) and Weighted Cross-Entropy (WCE).
To train the model, the entirety of the dataset was split into train, validation and test.
The training was done with early stopping parameter equal to 5, batch size was 64 and the number of seconds of temporal window taken from the audio files in training was fixed to 2.5 seconds.
Adam optimizer was used, the learning rate was set to </span><math id="S4.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mn mathsize="90%" id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><cn type="float" id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">0.0001</annotation></semantics></math><span id="S4.SS2.SSS1.p2.2.2" class="ltx_text" style="font-size:90%;"> and the weight decay parameter was set to </span><math id="S4.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mn mathsize="90%" id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><cn type="float" id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">0.001</annotation></semantics></math><span id="S4.SS2.SSS1.p2.2.3" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Results</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p"><span id="S4.SS2.SSS2.p1.1.1" class="ltx_text" style="font-size:90%;">The results of </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS2.SSS2.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S4.SS2.SSS2.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS2.SSS2.p1.1.4" class="ltx_text" style="font-size:90%;"> experiments are shown in Table </span><a href="#S4.T3" title="Table 3 ‣ 4.2.2 Results ‣ 4.2 Speaker Sex Classification ‣ 4 Speaker characterization applications ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="S4.SS2.SSS2.p1.1.5" class="ltx_text" style="font-size:90%;">.
Performance was evaluated on the test set using Accuracy and F-score.
Both DMHSA with CE and WCE performed with excellent results, above </span><math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mrow id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">95</mn><mo mathsize="90%" id="S4.SS2.SSS2.p1.1.m1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">95\%</annotation></semantics></math><span id="S4.SS2.SSS2.p1.1.6" class="ltx_text" style="font-size:90%;"> accuracy and with a 0.96 f-score.
As the classes were already almost perfectly balanced, using the WCE loss did not represent any significant improvements.</span></p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Speaker sex classification test results from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite></figcaption>
<table id="S4.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.4.5.1" class="ltx_tr">
<th id="S4.T3.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span id="S4.T3.4.5.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></th>
<th id="S4.T3.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.4.5.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Accuracy</span></th>
<th id="S4.T3.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.4.5.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F-Score</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.2.2" class="ltx_tr">
<th id="S4.T3.2.2.3" class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_t"></th>
<th id="S4.T3.2.2.4" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T3.2.2.4.1" class="ltx_text" style="font-size:90%;">DMHSA 32 heads + CE Loss</span></th>
<td id="S4.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.1.1.1.m1.1" class="ltx_Math" alttext="95.60\%" display="inline"><semantics id="S4.T3.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T3.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.m1.1.1.2.cmml">95.60</mn><mo mathsize="90%" id="S4.T3.1.1.1.m1.1.1.1" xref="S4.T3.1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.m1.1.1.2">95.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">95.60\%</annotation></semantics></math></td>
<td id="S4.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.2.2.2.m1.1" class="ltx_Math" alttext="0.96" display="inline"><semantics id="S4.T3.2.2.2.m1.1a"><mn mathsize="90%" id="S4.T3.2.2.2.m1.1.1" xref="S4.T3.2.2.2.m1.1.1.cmml">0.96</mn><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><cn type="float" id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1">0.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">0.96</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.4.4" class="ltx_tr">
<th id="S4.T3.4.4.3" class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_bb"></th>
<th id="S4.T3.4.4.4" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T3.4.4.4.1" class="ltx_text" style="font-size:90%;">DMHSA 32 heads + WCE Loss</span></th>
<td id="S4.T3.3.3.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T3.3.3.1.m1.1" class="ltx_Math" alttext="95.80\%" display="inline"><semantics id="S4.T3.3.3.1.m1.1a"><mrow id="S4.T3.3.3.1.m1.1.1" xref="S4.T3.3.3.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T3.3.3.1.m1.1.1.2" xref="S4.T3.3.3.1.m1.1.1.2.cmml">95.80</mn><mo mathsize="90%" id="S4.T3.3.3.1.m1.1.1.1" xref="S4.T3.3.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.1.m1.1b"><apply id="S4.T3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.3.3.1.m1.1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.3.3.1.m1.1.1.2.cmml" xref="S4.T3.3.3.1.m1.1.1.2">95.80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.1.m1.1c">95.80\%</annotation></semantics></math></td>
<td id="S4.T3.4.4.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T3.4.4.2.m1.1" class="ltx_Math" alttext="0.96" display="inline"><semantics id="S4.T3.4.4.2.m1.1a"><mn mathsize="90%" id="S4.T3.4.4.2.m1.1.1" xref="S4.T3.4.4.2.m1.1.1.cmml">0.96</mn><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.2.m1.1b"><cn type="float" id="S4.T3.4.4.2.m1.1.1.cmml" xref="S4.T3.4.4.2.m1.1.1">0.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.2.m1.1c">0.96</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Speaker COVID-19 Detection</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text" style="font-size:90%;">Speaker COVID-19 Detection is the SC task of determining the presence of a COVID-19 infection by analyzing the generated sounds from the respiratory system (whether cough, breathing or regular speech).
Recently, several COVID-19 detection from speech DL approaches have been developed </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS3.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a><span id="S4.SS3.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS3.p1.1.4" class="ltx_text" style="font-size:90%;">.
We would like to remind that all Speaker COVID-19 Detection results obtained in this work are meant for exploratory purposes and should not be taken to draw any medical conclusions.</span></p>
</div>
<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Experimental setup</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p"><span id="S4.SS3.SSS1.p1.1.1" class="ltx_text" style="font-size:90%;">In </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS3.SSS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.SS3.SSS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS3.SSS1.p1.1.4" class="ltx_text" style="font-size:90%;">, the DMHSA system was adapted to solve a COVID-19 detection task using cough audios.
It was assessed by the CCS dataset, which is part of the database that was used in the INTERSPEECH 2021 Computational Paralinguistics ChallengE (ComParE) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS3.SSS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib38" title="" class="ltx_ref">38</a><span id="S4.SS3.SSS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS3.SSS1.p1.1.7" class="ltx_text" style="font-size:90%;">.
This database was already split into train, validation and test sets.
There are in total 725 audios, which 158 are samples from COVID-19 positive diagnostic and 567 are negative samples.
There are 286 audios in the train set, 231 audios in the validation set and 208 audios in the test set.
The test set was cleaned and filtered in order to improve the quality of the samples.</span></p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.3" class="ltx_p"><span id="S4.SS3.SSS1.p2.3.1" class="ltx_text" style="font-size:90%;">The DMHSA model was adapted to this problem by changing the SoftMax layer to a two units output (one for each diagnostic label) and by using a 3-blocks front-end feature extractor.
Two 32-heads DMHSA models were trained using two different loss functions: CE and WCE.
The training was done with early stopping parameter equal to 50 and a batch size of 64.
Adam optimizer was used, the learning rate was set to </span><math id="S4.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mn mathsize="90%" id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><cn type="float" id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">0.0001</annotation></semantics></math><span id="S4.SS3.SSS1.p2.3.2" class="ltx_text" style="font-size:90%;"> and the weight decay parameter was set to </span><math id="S4.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS3.SSS1.p2.2.m2.1a"><mn mathsize="90%" id="S4.SS3.SSS1.p2.2.m2.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.1b"><cn type="float" id="S4.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.1c">0.001</annotation></semantics></math><span id="S4.SS3.SSS1.p2.3.3" class="ltx_text" style="font-size:90%;">.
A head drop probability of 0.3 was fixed for the heads, meaning that any given head had a probability of </span><math id="S4.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="30\%" display="inline"><semantics id="S4.SS3.SSS1.p2.3.m3.1a"><mrow id="S4.SS3.SSS1.p2.3.m3.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.cmml"><mn mathsize="90%" id="S4.SS3.SSS1.p2.3.m3.1.1.2" xref="S4.SS3.SSS1.p2.3.m3.1.1.2.cmml">30</mn><mo mathsize="90%" id="S4.SS3.SSS1.p2.3.m3.1.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.3.m3.1b"><apply id="S4.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.2">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.3.m3.1c">30\%</annotation></semantics></math><span id="S4.SS3.SSS1.p2.3.4" class="ltx_text" style="font-size:90%;"> to have its weight set to 0.</span></p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Results</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p"><span id="S4.SS3.SSS2.p1.1.1" class="ltx_text" style="font-size:90%;">The results of </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.SS3.SSS2.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.SS3.SSS2.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.SS3.SSS2.p1.1.4" class="ltx_text" style="font-size:90%;"> experiments are shown in Table </span><a href="#S4.T4" title="Table 4 ‣ 4.3.2 Results ‣ 4.3 Speaker COVID-19 Detection ‣ 4 Speaker characterization applications ‣ Speaker Characterization by means of Attention Pooling" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4</span></a><span id="S4.SS3.SSS2.p1.1.5" class="ltx_text" style="font-size:90%;">.
Performance was evaluated on the test set using Area Under the receiver operating characteristic Curve (AUC).
DMHSA with 32 heads and WCE loss performed better than DMHSA with 32 heads and CE loss, with a relative AUC improvement of </span><math id="S4.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="8.43\%" display="inline"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.SS3.SSS2.p1.1.m1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml">8.43</mn><mo mathsize="90%" id="S4.SS3.SSS2.p1.1.m1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2">8.43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">8.43\%</annotation></semantics></math><span id="S4.SS3.SSS2.p1.1.6" class="ltx_text" style="font-size:90%;">.
In this case, DMHSA with 32 heads and WCE achieved very good results, being able to detect effectively COVID-19 samples.
Because of the imbalanced classes, using the WCE loss function improved the results drastically.</span></p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>COVID-19 Detection test results from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite></figcaption>
<table id="S4.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.2.3.1" class="ltx_tr">
<th id="S4.T4.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T4.2.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></th>
<th id="S4.T4.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T4.2.3.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">AUC</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1" class="ltx_tr">
<td id="S4.T4.1.1.2" class="ltx_td ltx_nopad_r ltx_border_t"></td>
<td id="S4.T4.1.1.3" class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t"><span id="S4.T4.1.1.3.1" class="ltx_text" style="font-size:90%;">DMHSA 32 heads + CE Loss</span></td>
<td id="S4.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="83.00\%" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T4.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.m1.1.1.2.cmml">83.00</mn><mo mathsize="90%" id="S4.T4.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.m1.1.1.2">83.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">83.00\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2" class="ltx_td ltx_nopad_r ltx_border_bb"></td>
<td id="S4.T4.2.2.3" class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb"><span id="S4.T4.2.2.3.1" class="ltx_text" style="font-size:90%;">DMHSA 32 heads + WCE Loss</span></td>
<td id="S4.T4.2.2.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T4.2.2.1.m1.1" class="ltx_Math" alttext="90.00\%" display="inline"><semantics id="S4.T4.2.2.1.m1.1a"><mrow id="S4.T4.2.2.1.m1.1.1" xref="S4.T4.2.2.1.m1.1.1.cmml"><mn mathsize="90%" id="S4.T4.2.2.1.m1.1.1.2" xref="S4.T4.2.2.1.m1.1.1.2.cmml">90.00</mn><mo mathsize="90%" id="S4.T4.2.2.1.m1.1.1.1" xref="S4.T4.2.2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.1.m1.1b"><apply id="S4.T4.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.2.2.1.m1.1.1.1.cmml" xref="S4.T4.2.2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.2.2.1.m1.1.1.2.cmml" xref="S4.T4.2.2.1.m1.1.1.2">90.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.1.m1.1c">90.00\%</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text" style="font-size:90%;">In this paper we have described a Double Multi-Head Self-Attention pooling mechanism for speaker recognition.
Its architecture consists of a CNN-based front-end, followed by an attention-based pooling layer and a set of fully connected layers.
The network is trained as a speaker classifier and a bottleneck layer from these fully connected layers is used as speaker embedding.
The presented approach has been evaluated in a text-independent speaker verification task using the speaker embeddings and applying the cosine distance.
It has outperformed both vanilla Self Attention and Multi-Head Self-Attention pooling baseline methods.
It also has been adapted to solve several speaker characterization tasks, namely speaker emotion recognition, sex classification and COVID-19 detection, obtaining excellent results.</span></p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgements</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p"><span id="S6.p1.1.1" class="ltx_text" style="font-size:90%;">This work was supported by the project PID2019-107579RBI00, funded by the Spanish Ministry of Science and Innovation.</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
D. Snyder, D. Garcia-Romero, G. Sell, D. Povey, and S. Khudanpur, “X-vectors: Robust dnn embeddings for speaker recognition,” in </span><em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2018 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em><span id="bib.bib1.3.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 5329–5333.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
W. Cai, J. Chen, and M. Li, “Exploring the Encoding Layer and Loss Function in End-to-End Speaker and Language Recognition System,” in </span><em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. The Speaker and Language Recognition Workshop (Odyssey 2018)</em><span id="bib.bib2.3.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 74–81.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
W. Xie, A. Nagrani, J. S. Chung, and A. Zisserman, “Utterance-level aggregation for speaker recognition in the wild,” </span><em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICASSP 2019-2019 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em><span id="bib.bib3.3.3" class="ltx_text" style="font-size:90%;">, pp. 5791–5795, 2019.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Y. Jung, Y. Kim, H. Lim, Y. Choi, and H. Kim, “Spatial pyramid encoding with convex length normalization for text-independent speaker verification,” </span><em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint</em><span id="bib.bib4.3.3" class="ltx_text" style="font-size:90%;">, p. arXiv:1906.08333, 2019.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
D. Snyder, D. Garcia-Romero, D. Povey, and S. Khudanpur, “Deep Neural Network Embeddings for Text-Independent Speaker Verification,” in </span><em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2017</em><span id="bib.bib5.3.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 999–1003.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Y. Zhu, T. Ko, D. Snyder, B. Mak, and D. Povey, “Self-Attentive Speaker Embeddings for Text-Independent Speaker Verification,” in </span><em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2018</em><span id="bib.bib6.3.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 3573–3577.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
M. India, P. Safari, and J. Hernando, “Self Multi-Head Attention for Speaker Recognition,” in </span><em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2019</em><span id="bib.bib7.3.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 4305–4309.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
D. Snyder, D. Garcia-Romero, A. McCree, G. Sell, D. Povey, and S. Khudanpur, “Spoken Language Recognition using X-vectors,” in </span><em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. The Speaker and Language Recognition Workshop (Odyssey 2018)</em><span id="bib.bib8.3.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 105–111.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
R. Pappagari, T. Wang, J. Villalba, N. Chen, and N. Dehak, “X-vectors meet emotions: A study on dependencies between emotion and speaker recognition,” in </span><em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICASSP 2020 - 2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em><span id="bib.bib9.3.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 7169–7173.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
H. Meng, T. Yan, F. Yuan, and H. Wei, “Speech emotion recognition from 3d log-mel spectrograms with deep learning network,” </span><em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">IEEE Access</em><span id="bib.bib10.3.3" class="ltx_text" style="font-size:90%;">, vol. 7, pp. 125 868–125 881, 2019.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
A. A. Alnuaim, M. Zakariah, C. Shashidhar, W. A. Hatamleh, H. Tarazi, P. K. Shukla, and R. Ratna, “Speaker gender recognition based on deep neural networks and resnet50,” </span><em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Wireless Communications and Mobile Computing</em><span id="bib.bib11.3.3" class="ltx_text" style="font-size:90%;">, vol. 2022, pp. 1–13, Mar. 2022.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
A. Tursunov, M. Mustaqeem, J. Y. Choeh, and S. Kwon, “Age and gender recognition using a convolutional neural network with a specially designed multi-attention module through speech spectrograms,” </span><em id="bib.bib12.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Sensors</em><span id="bib.bib12.3.3" class="ltx_text" style="font-size:90%;">, vol. 21, p. 5892, Sep. 2021.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
C. Bartz, T. Herold, H. Yang, and C. Meinel, “Language identification using deep convolutional recurrent neural networks,” in </span><em id="bib.bib13.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Neural Information Processing</em><span id="bib.bib13.3.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 880–889.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
D. Wang, S. Ye, X. Hu, S. Li, and X. Xu, “An End-to-End Dialect Identification System with Transfer Learning from a Multilingual Automatic Speech Recognition Model,” in </span><em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2021</em><span id="bib.bib14.3.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 3266–3270.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
F. Weninger, Y. Sun, J. Park, D. Willett, and P. Zhan, “Deep Learning Based Mandarin Accent Identification for Accent Robust ASR,” in </span><em id="bib.bib15.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2019</em><span id="bib.bib15.3.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 510–514.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
N. Cummins, A. Baird, and B. W. Schuller, “Speech analysis for health: Current state-of-the-art and the increasing impact of deep learning,” </span><em id="bib.bib16.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Methods</em><span id="bib.bib16.3.3" class="ltx_text" style="font-size:90%;">, vol. 151, pp. 41–54, Aug. 2018.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
M. India, P. Safari, and J. Hernando, “Double multi-head attention for speaker verification,” in </span><em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICASSP 2021 - 2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em><span id="bib.bib17.3.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 6144–6148.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
T. Hori, S. Watanabe, Y. Zhang, and W. Chan, “Advances in Joint CTC-Attention Based End-to-End Speech Recognition with a Deep CNN Encoder and RNN-LM,” in </span><em id="bib.bib18.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2017</em><span id="bib.bib18.3.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 949–953.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Y. Liu, L. He, and J. Liu, “Large margin softmax loss for speaker verification,” </span><em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint</em><span id="bib.bib19.3.3" class="ltx_text" style="font-size:90%;">, p. arXiv:1904.03479, 2019.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
J. S. Chung, A. Nagrani, and A. Zisserman, “Voxceleb2: Deep speaker recognition,” in </span><em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">INTERSPEECH</em><span id="bib.bib20.3.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
A. Nagrani, J. S. Chung, and A. Zisserman, “VoxCeleb: A Large-Scale Speaker Identification Dataset,” in </span><em id="bib.bib21.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2017</em><span id="bib.bib21.3.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 2616–2620.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
D. Aromí, “Predicting emotion in speech: a deep learning approach using attention mechanisms,” Univ. Politècnica de Catalunya, B.S. Degree Thesis, 2021.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
D. Garriga, “Deep learning for speaker characterization,” Univ. Politècnica de Catalunya, B.S. Degree Thesis, 2022.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
D. Marchan, “Diseño e implementación de un sistema de deep learning para la detección de covid por la tos con aumento de datos,” Univ. Politècnica de Catalunya, B.S. Degree Thesis, 2022.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
R. Cowie and R. R. Cornelius, “Describing the emotional states that are expressed in speech,” </span><em id="bib.bib25.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Speech Communication</em><span id="bib.bib25.3.3" class="ltx_text" style="font-size:90%;">, vol. 40, no. 1, pp. 5–32, Apr. 2003.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
M. M. H. E. Ayadi, M. S. Kamel, and F. Karray, “Speech emotion recognition using gaussian mixture vector autoregressive models,” in </span><em id="bib.bib26.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2007 IEEE International Conference on Acoustics, Speech and Signal Processing - ICASSP ’07</em><span id="bib.bib26.3.3" class="ltx_text" style="font-size:90%;">, vol. 4, 2007, pp. IV–957–IV–960.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
A. Nogueiras, J. B. Mariño, A. Bonafonte, and A. Moreno, “Speech emotion recognition using hidden markov models,” in </span><em id="bib.bib27.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">EUROSPEECH 2001 - SCANDINAVIA - 7th European Conference on Speech Communication and Technology</em><span id="bib.bib27.3.3" class="ltx_text" style="font-size:90%;">, 2001, pp. 2679–2682.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
R. Xia and Y. Liu, “Using i-vector space model for emotion recognition,” in </span><em id="bib.bib28.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2012</em><span id="bib.bib28.3.3" class="ltx_text" style="font-size:90%;">, 2012, pp. 2230–2233.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
J. Kim, G. Englebienne, K. P. Truong, and V. Evers, “Towards Speech Emotion Recognition “in the Wild” Using Aggregated Corpora and Deep Multi-Task Learning,” in </span><em id="bib.bib29.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2017</em><span id="bib.bib29.3.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 1113–1117.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Y. Li, T. Zhao, and T. Kawahara, “Improved End-to-End Speech Emotion Recognition Using Self Attention Mechanism and Multitask Learning,” in </span><em id="bib.bib30.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proc. Interspeech 2019</em><span id="bib.bib30.3.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 2803–2807.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
V. Hozjan, Z. Kacic, A. Moreno, A. Bonafonte, and A. Nogueiras, “Interface databases: Design and collection of a multilingual emotional speech database,” in </span><em id="bib.bib31.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the Third International Conference on Language Resources and Evaluation (LREC’02)</em><span id="bib.bib31.3.3" class="ltx_text" style="font-size:90%;">, May 2002.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
M. Buyukyilmaz and A. O. Cibikdiken, “Voice gender recognition using deep learning,” in </span><em id="bib.bib32.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of 2016 International Conference on Modeling, Simulation and Optimization Technologies and Applications (MSOTA2016)</em><span id="bib.bib32.3.3" class="ltx_text" style="font-size:90%;">, 2016, pp. 409–411.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
F. Ertam, “An effective gender recognition approach using voice data via deeper lstm networks,” </span><em id="bib.bib33.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Applied Acoustics</em><span id="bib.bib33.3.3" class="ltx_text" style="font-size:90%;">, vol. 156, pp. 351–358, Aug. 2019.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
“Mozilla catalan common voice dataset,” Jul. 2022. [Online]. Available: https://commonvoice.mozilla.org/ca
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
“Aina: La nostra llengua és la teva veu,” Jul. 2022. [Online]. Available: https://www.projecteaina.cat
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
M. A. Nessiem, M. M. Mohamed, H. Coppock, A. Gaskell, and B. W. Schuller, “Detecting covid-19 from breathing and coughing sounds using deep neural networks,” in </span><em id="bib.bib36.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2021 IEEE 34th International Symposium on Computer-Based Medical Systems (CBMS)</em><span id="bib.bib36.3.3" class="ltx_text" style="font-size:90%;">, 06 2021, pp. 183–188.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
A. B. Nassif, I. Shahin, M. Bader, A. Hassan, and N. Werghi, “Covid-19 detection systems using deep-learning algorithms based on speech and image data,” </span><em id="bib.bib37.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Mathematics</em><span id="bib.bib37.3.3" class="ltx_text" style="font-size:90%;">, vol. 10, no. 4, p. 564, 2022.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
B. Schuller, A. Batliner, C. Bergler, and C. Mascolo, “The interspeech 2021 computational paralinguistics challenge: Covid-19 cough, covid-19 speech, escalation &amp; primates,” </span><em id="bib.bib38.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">INTERSPEECH 2021</em><span id="bib.bib38.3.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.04095" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.04096" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.04096">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.04096" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.04097" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 18:09:58 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
