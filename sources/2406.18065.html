<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.18065] On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations</title><meta property="og:description" content="For speech classification tasks, deep learning models often achieve high accuracy but exhibit shortcomings in calibration, manifesting as classifiers exhibiting overconfidence. The significance of calibration lies in i…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.18065">

<!--Generated on Fri Jul  5 17:54:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.5" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.6" class="ltx_ERROR undefined">\name</span>
<p id="p1.4" class="ltx_p">YaqianHao<sup id="p1.4.1" class="ltx_sup">†</sup>
<span id="p1.4.2" class="ltx_ERROR undefined">\name</span>ChenguangHu<sup id="p1.4.3" class="ltx_sup">†</sup>
<span id="p1.4.4" class="ltx_ERROR undefined">\name</span>YingyingGao
<span id="p1.4.5" class="ltx_ERROR undefined">\name</span>ShileiZhang<sup id="p1.4.6" class="ltx_sup">∗</sup>
<span id="p1.4.7" class="ltx_ERROR undefined">\name</span>JunlanFeng<sup id="p1.4.8" class="ltx_sup">∗</sup></p>
</div>
<h1 class="ltx_title ltx_title_document">On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">For speech classification tasks, deep learning models often achieve high accuracy but exhibit shortcomings in calibration, manifesting as classifiers exhibiting overconfidence. The significance of calibration lies in its critical role in guaranteeing the reliability of decision-making within deep learning systems. This study explores the effectiveness of Energy-Based Models (EBMs) in calibrating confidence for speech classification tasks by training a joint EBM integrating a discriminative and a generative model, thereby enhancing the classifier’s calibration and mitigating overconfidence. Experimental evaluations conducted on three speech classification tasks specifically: age, emotion, and language recognition. Our findings highlight the competitive performance of EBMs in calibrating the speech classification models. This research emphasizes the potential of EBMs in speech classification tasks, demonstrating their ability to enhance calibration without sacrificing accuracy.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Energy-based models, speech classification, confidence calibration
</div>
<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_tag ltx_tag_note">*</span>Corresponding Author.</span></span></span><span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_tag ltx_tag_note">†</span>Equal Contribution.</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Despite the impressive performance of deep learning models in speech classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, issues such as overconfidence, calibration errors, and uncertainty estimation may hinder their reliability and generalization in real-world scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Confidence calibration in these models poses a significant challenge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. For example, in speech emotion recognition (SER) systems, the inherent uncertainty in modeling emotions affects the trustworthiness of the model's predictions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
Overconfidence and underconfidence can indicate suboptimal calibration, leading to false positives or missed opportunities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. The current state of research in speech classification models often overlooks the issue of confidence calibration, resulting in a lack of reliable methods and leading to uncertainty in predictions. The current state of confidence calibration in speech classification underscores a lack of reliable methods, fostering uncertainty and mistrust in model predictions.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Undoubtedly, ensuring a well-calibrated confidence measure in a classification model is crucial for accurate predictions. Therefore, developing methodologies to adjust the predictions of a speech classification model is essential, balancing calibration with performance.
Existing techniques, like Temperature Scaling and Vector Scaling, typically rescale the posterior distributions of classifier predictions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. However, these methods need post-processing adjustments and require a persistent development set with enough samples. Alternatively, adjusting calibration during the model training process, such as using confidence regularization, offers another approach  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recently, the effectiveness of EBMs in achieving enhanced model calibration has been demonstrated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, wherein the joint training process incorporates both discriminative and generative models.
The EBMs characterize the relationship between density of input data and model energy, enabling predictions based on energy minimization. While this flexibility is advantageous, the training process of energy models involves intricate adjustments, making it a challenging endeavor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Following  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>'s work,  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> has intricately improved the training process of EBMs, substantially boosting both training efficiency and ultimate performance.
Despite their effectiveness in computer vision, EBMs' potential for calibrating speech classification models remains untapped.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we explore the effectiveness of EBMs in enhancing the calibration of speech classification models. Through experiments on three distinct speech classification tasks, we compare EBMs with traditional softmax-based models. Results reveal that EBMs achieve an average reduction of 7.787% in Expected Calibration Error (ECE) across the tasks, indicating improved calibration. Additionally, Negative Log-Likelihood (NLL) shows an average reduction of 0.172, indicating enhanced model fitting to observed data and more accurate probability predictions.
Furthermore, we compared EBMs with other calibration methods such as Temperature Scaling and Logistic Scaling, and the results demonstrate that EBMs exhibit a significantly greater reduction in overconfidence compared to these post-processing methods.
</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The key contributions of this paper are summarized as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce joint EBMs in speech classification tasks to improve calibration by modeling the energy function with a deep neural network, maintaining accuracy while enhancing reliability. This joint energy model optimizes not only for classification tasks but also learns the underlying probability distribution within the data, resulting in improved calibration observed through the model's cautious decision-making when encountering inputs deviating from the training data distribution.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We assess the performance of EBMs across three speech tasks and datasets, specifically targeting language, emotion, and age recognition. This evaluation demonstrates that EBMs can significantly reduce ECE without compromising model accuracy, and mitigate overconfidence issues in speech classification models.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct comparative analyses with other calibration methods, and explore model training dynamics and confidence distributions to address model overconfidence.
Specifically, our results show that EBMs outperform other post-processing methods in achieving effective calibration without requiring additional auxiliary datasets.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Energy-based Models</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.4" class="ltx_p">The fundamental principle underlying an EBM is to construct a function <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="E(\mathbf{x}):R^{D}\rightarrow R" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mrow id="S2.SS1.p1.1.m1.1.2.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml"><mi id="S2.SS1.p1.1.m1.1.2.2.2" xref="S2.SS1.p1.1.m1.1.2.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.1.2.2.1" xref="S2.SS1.p1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S2.SS1.p1.1.m1.1.2.2.3.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.2.3.2.1" xref="S2.SS1.p1.1.m1.1.2.2.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">𝐱</mi><mo rspace="0.278em" stretchy="false" id="S2.SS1.p1.1.m1.1.2.2.3.2.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.SS1.p1.1.m1.1.2.1" xref="S2.SS1.p1.1.m1.1.2.1.cmml">:</mo><mrow id="S2.SS1.p1.1.m1.1.2.3" xref="S2.SS1.p1.1.m1.1.2.3.cmml"><msup id="S2.SS1.p1.1.m1.1.2.3.2" xref="S2.SS1.p1.1.m1.1.2.3.2.cmml"><mi id="S2.SS1.p1.1.m1.1.2.3.2.2" xref="S2.SS1.p1.1.m1.1.2.3.2.2.cmml">R</mi><mi id="S2.SS1.p1.1.m1.1.2.3.2.3" xref="S2.SS1.p1.1.m1.1.2.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.3.1" xref="S2.SS1.p1.1.m1.1.2.3.1.cmml">→</mo><mi id="S2.SS1.p1.1.m1.1.2.3.3" xref="S2.SS1.p1.1.m1.1.2.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.2"><ci id="S2.SS1.p1.1.m1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.1">:</ci><apply id="S2.SS1.p1.1.m1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2"><times id="S2.SS1.p1.1.m1.1.2.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.2.1"></times><ci id="S2.SS1.p1.1.m1.1.2.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2.2">𝐸</ci><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐱</ci></apply><apply id="S2.SS1.p1.1.m1.1.2.3.cmml" xref="S2.SS1.p1.1.m1.1.2.3"><ci id="S2.SS1.p1.1.m1.1.2.3.1.cmml" xref="S2.SS1.p1.1.m1.1.2.3.1">→</ci><apply id="S2.SS1.p1.1.m1.1.2.3.2.cmml" xref="S2.SS1.p1.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.2.3.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.3.2">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.2.3.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.3.2.2">𝑅</ci><ci id="S2.SS1.p1.1.m1.1.2.3.2.3.cmml" xref="S2.SS1.p1.1.m1.1.2.3.2.3">𝐷</ci></apply><ci id="S2.SS1.p1.1.m1.1.2.3.3.cmml" xref="S2.SS1.p1.1.m1.1.2.3.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">E(\mathbf{x}):R^{D}\rightarrow R</annotation></semantics></math> that maps each point  in the input space to a singular, non-probabilistic scalar referred to as the energy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. This scalar, denoted by <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="E(\mathbf{x})" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.1" xref="S2.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.2" xref="S2.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><times id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></times><ci id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2">𝐸</ci><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">E(\mathbf{x})</annotation></semantics></math>, is a key component in the Gibbs distribution, allowing the derivation of a probability density <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="p(\mathbf{x})" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mi id="S2.SS1.p1.4.m4.1.2.2" xref="S2.SS1.p1.4.m4.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.2.1" xref="S2.SS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.1.2.3.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.2.1" xref="S2.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.2.2" xref="S2.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.2.cmml" xref="S2.SS1.p1.4.m4.1.2"><times id="S2.SS1.p1.4.m4.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.2.1"></times><ci id="S2.SS1.p1.4.m4.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.2.2">𝑝</ci><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">p(\mathbf{x})</annotation></semantics></math>. The relationship is formalized as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.6" class="ltx_Math" alttext="p_{\theta}(\mathbf{x})=\frac{\exp\left(-E_{\theta}(\mathbf{x})/T\right)}{Z(\theta)}," display="block"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.2" xref="S2.E1.m1.6.6.1.1.2.cmml"><msub id="S2.E1.m1.6.6.1.1.2.2" xref="S2.E1.m1.6.6.1.1.2.2.cmml"><mi id="S2.E1.m1.6.6.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.2.2.2.cmml">p</mi><mi id="S2.E1.m1.6.6.1.1.2.2.3" xref="S2.E1.m1.6.6.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.1.1.2.1" xref="S2.E1.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.1.1.2.3.2.1" xref="S2.E1.m1.6.6.1.1.2.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">𝐱</mi><mo stretchy="false" id="S2.E1.m1.6.6.1.1.2.3.2.2" xref="S2.E1.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1" xref="S2.E1.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.4.cmml"><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S2.E1.m1.3.3.3.3a" xref="S2.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.3.3.1" xref="S2.E1.m1.3.3.3.4.cmml"><mo id="S2.E1.m1.3.3.3.3.1.2" xref="S2.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S2.E1.m1.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.1.1.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1a" xref="S2.E1.m1.3.3.3.3.1.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.cmml"><mrow id="S2.E1.m1.3.3.3.3.1.1.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.2.cmml"><msub id="S2.E1.m1.3.3.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml">E</mi><mi id="S2.E1.m1.3.3.3.3.1.1.2.2.2.3" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.3.1.1.2.2.1" xref="S2.E1.m1.3.3.3.3.1.1.2.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.2.2.3.2" xref="S2.E1.m1.3.3.3.3.1.1.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.3.1.1.2.2.3.2.1" xref="S2.E1.m1.3.3.3.3.1.1.2.2.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E1.m1.3.3.3.3.1.1.2.2.3.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.1.2.1" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml">/</mo><mi id="S2.E1.m1.3.3.3.3.1.1.2.3" xref="S2.E1.m1.3.3.3.3.1.1.2.3.cmml">T</mi></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.3" xref="S2.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.4.4.4" xref="S2.E1.m1.4.4.4.cmml"><mi id="S2.E1.m1.4.4.4.3" xref="S2.E1.m1.4.4.4.3.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.4.2" xref="S2.E1.m1.4.4.4.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.4.4.2" xref="S2.E1.m1.4.4.4.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.4.4.2.1" xref="S2.E1.m1.4.4.4.cmml">(</mo><mi id="S2.E1.m1.4.4.4.1" xref="S2.E1.m1.4.4.4.1.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.4.4.4.4.2.2" xref="S2.E1.m1.4.4.4.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E1.m1.6.6.1.2" xref="S2.E1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1"><eq id="S2.E1.m1.6.6.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1"></eq><apply id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2"><times id="S2.E1.m1.6.6.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.2.1"></times><apply id="S2.E1.m1.6.6.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2">𝑝</ci><ci id="S2.E1.m1.6.6.1.1.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝐱</ci></apply><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><divide id="S2.E1.m1.4.4.5.cmml" xref="S2.E1.m1.4.4"></divide><apply id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.3"><exp id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></exp><apply id="S2.E1.m1.3.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1"><minus id="S2.E1.m1.3.3.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1"></minus><apply id="S2.E1.m1.3.3.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2"><divide id="S2.E1.m1.3.3.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.1"></divide><apply id="S2.E1.m1.3.3.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2"><times id="S2.E1.m1.3.3.3.3.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2.1"></times><apply id="S2.E1.m1.3.3.3.3.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2.2">𝐸</ci><ci id="S2.E1.m1.3.3.3.3.1.1.2.2.2.3.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.2.2.3">𝜃</ci></apply><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝐱</ci></apply><ci id="S2.E1.m1.3.3.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.3">𝑇</ci></apply></apply></apply><apply id="S2.E1.m1.4.4.4.cmml" xref="S2.E1.m1.4.4.4"><times id="S2.E1.m1.4.4.4.2.cmml" xref="S2.E1.m1.4.4.4.2"></times><ci id="S2.E1.m1.4.4.4.3.cmml" xref="S2.E1.m1.4.4.4.3">𝑍</ci><ci id="S2.E1.m1.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.1">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">p_{\theta}(\mathbf{x})=\frac{\exp\left(-E_{\theta}(\mathbf{x})/T\right)}{Z(\theta)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.8" class="ltx_p">where <math id="S2.SS1.p1.5.m1.1" class="ltx_Math" alttext="E_{\theta}(\mathbf{x})" display="inline"><semantics id="S2.SS1.p1.5.m1.1a"><mrow id="S2.SS1.p1.5.m1.1.2" xref="S2.SS1.p1.5.m1.1.2.cmml"><msub id="S2.SS1.p1.5.m1.1.2.2" xref="S2.SS1.p1.5.m1.1.2.2.cmml"><mi id="S2.SS1.p1.5.m1.1.2.2.2" xref="S2.SS1.p1.5.m1.1.2.2.2.cmml">E</mi><mi id="S2.SS1.p1.5.m1.1.2.2.3" xref="S2.SS1.p1.5.m1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.5.m1.1.2.1" xref="S2.SS1.p1.5.m1.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.5.m1.1.2.3.2" xref="S2.SS1.p1.5.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.5.m1.1.2.3.2.1" xref="S2.SS1.p1.5.m1.1.2.cmml">(</mo><mi id="S2.SS1.p1.5.m1.1.1" xref="S2.SS1.p1.5.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS1.p1.5.m1.1.2.3.2.2" xref="S2.SS1.p1.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m1.1b"><apply id="S2.SS1.p1.5.m1.1.2.cmml" xref="S2.SS1.p1.5.m1.1.2"><times id="S2.SS1.p1.5.m1.1.2.1.cmml" xref="S2.SS1.p1.5.m1.1.2.1"></times><apply id="S2.SS1.p1.5.m1.1.2.2.cmml" xref="S2.SS1.p1.5.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.1.2.2.1.cmml" xref="S2.SS1.p1.5.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.5.m1.1.2.2.2.cmml" xref="S2.SS1.p1.5.m1.1.2.2.2">𝐸</ci><ci id="S2.SS1.p1.5.m1.1.2.2.3.cmml" xref="S2.SS1.p1.5.m1.1.2.2.3">𝜃</ci></apply><ci id="S2.SS1.p1.5.m1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m1.1c">E_{\theta}(\mathbf{x})</annotation></semantics></math> representing the energy, is a nonlinear regression function parameterized by <math id="S2.SS1.p1.6.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p1.6.m2.1a"><mi id="S2.SS1.p1.6.m2.1.1" xref="S2.SS1.p1.6.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m2.1b"><ci id="S2.SS1.p1.6.m2.1.1.cmml" xref="S2.SS1.p1.6.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m2.1c">\theta</annotation></semantics></math>, <math id="S2.SS1.p1.7.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS1.p1.7.m3.1a"><mi id="S2.SS1.p1.7.m3.1.1" xref="S2.SS1.p1.7.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m3.1b"><ci id="S2.SS1.p1.7.m3.1.1.cmml" xref="S2.SS1.p1.7.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m3.1c">T</annotation></semantics></math> refers to the temperature parameter, and <math id="S2.SS1.p1.8.m4.1" class="ltx_Math" alttext="Z(\theta)" display="inline"><semantics id="S2.SS1.p1.8.m4.1a"><mrow id="S2.SS1.p1.8.m4.1.2" xref="S2.SS1.p1.8.m4.1.2.cmml"><mi id="S2.SS1.p1.8.m4.1.2.2" xref="S2.SS1.p1.8.m4.1.2.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.8.m4.1.2.1" xref="S2.SS1.p1.8.m4.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.8.m4.1.2.3.2" xref="S2.SS1.p1.8.m4.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m4.1.2.3.2.1" xref="S2.SS1.p1.8.m4.1.2.cmml">(</mo><mi id="S2.SS1.p1.8.m4.1.1" xref="S2.SS1.p1.8.m4.1.1.cmml">θ</mi><mo stretchy="false" id="S2.SS1.p1.8.m4.1.2.3.2.2" xref="S2.SS1.p1.8.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m4.1b"><apply id="S2.SS1.p1.8.m4.1.2.cmml" xref="S2.SS1.p1.8.m4.1.2"><times id="S2.SS1.p1.8.m4.1.2.1.cmml" xref="S2.SS1.p1.8.m4.1.2.1"></times><ci id="S2.SS1.p1.8.m4.1.2.2.cmml" xref="S2.SS1.p1.8.m4.1.2.2">𝑍</ci><ci id="S2.SS1.p1.8.m4.1.1.cmml" xref="S2.SS1.p1.8.m4.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m4.1c">Z(\theta)</annotation></semantics></math> signifies the normalizing constant, also known as the partition function:</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.4" class="ltx_Math" alttext="Z(\theta)=\int_{\mathbf{x}}\exp\left(-E_{\theta}(\mathbf{x})/T\right)dx." display="block"><semantics id="S2.Ex1.m1.4a"><mrow id="S2.Ex1.m1.4.4.1" xref="S2.Ex1.m1.4.4.1.1.cmml"><mrow id="S2.Ex1.m1.4.4.1.1" xref="S2.Ex1.m1.4.4.1.1.cmml"><mrow id="S2.Ex1.m1.4.4.1.1.3" xref="S2.Ex1.m1.4.4.1.1.3.cmml"><mi id="S2.Ex1.m1.4.4.1.1.3.2" xref="S2.Ex1.m1.4.4.1.1.3.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.1.3.1" xref="S2.Ex1.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S2.Ex1.m1.4.4.1.1.3.3.2" xref="S2.Ex1.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.3.3.2.1" xref="S2.Ex1.m1.4.4.1.1.3.cmml">(</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.3.3.2.2" xref="S2.Ex1.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.Ex1.m1.4.4.1.1.2" xref="S2.Ex1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.4.4.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.cmml"><msub id="S2.Ex1.m1.4.4.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.2.cmml"><mo id="S2.Ex1.m1.4.4.1.1.1.2.2" xref="S2.Ex1.m1.4.4.1.1.1.2.2.cmml">∫</mo><mi id="S2.Ex1.m1.4.4.1.1.1.2.3" xref="S2.Ex1.m1.4.4.1.1.1.2.3.cmml">𝐱</mi></msub><mrow id="S2.Ex1.m1.4.4.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.3.3" xref="S2.Ex1.m1.3.3.cmml">exp</mi><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.1a" xref="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1a" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><msub id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2.cmml">E</mi><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml">​</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.2.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S2.Ex1.m1.2.2" xref="S2.Ex1.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.2.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">/</mo><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></mrow></mrow><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.1.3.cmml"><mo rspace="0em" id="S2.Ex1.m1.4.4.1.1.1.1.3.1" xref="S2.Ex1.m1.4.4.1.1.1.1.3.1.cmml">𝑑</mo><mi id="S2.Ex1.m1.4.4.1.1.1.1.3.2" xref="S2.Ex1.m1.4.4.1.1.1.1.3.2.cmml">x</mi></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex1.m1.4.4.1.2" xref="S2.Ex1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.4b"><apply id="S2.Ex1.m1.4.4.1.1.cmml" xref="S2.Ex1.m1.4.4.1"><eq id="S2.Ex1.m1.4.4.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.2"></eq><apply id="S2.Ex1.m1.4.4.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.3"><times id="S2.Ex1.m1.4.4.1.1.3.1.cmml" xref="S2.Ex1.m1.4.4.1.1.3.1"></times><ci id="S2.Ex1.m1.4.4.1.1.3.2.cmml" xref="S2.Ex1.m1.4.4.1.1.3.2">𝑍</ci><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝜃</ci></apply><apply id="S2.Ex1.m1.4.4.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1"><apply id="S2.Ex1.m1.4.4.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.2">subscript</csymbol><int id="S2.Ex1.m1.4.4.1.1.1.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.2.2"></int><ci id="S2.Ex1.m1.4.4.1.1.1.2.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.2.3">𝐱</ci></apply><apply id="S2.Ex1.m1.4.4.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1"><times id="S2.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.2"></times><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1"><exp id="S2.Ex1.m1.3.3.cmml" xref="S2.Ex1.m1.3.3"></exp><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1"><minus id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1"></minus><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2"><divide id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.1"></divide><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2"><times id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2">𝐸</ci><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3">𝜃</ci></apply><ci id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2">𝐱</ci></apply><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply></apply></apply><apply id="S2.Ex1.m1.4.4.1.1.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.3"><csymbol cd="latexml" id="S2.Ex1.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.3.1">differential-d</csymbol><ci id="S2.Ex1.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.3.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.4c">Z(\theta)=\int_{\mathbf{x}}\exp\left(-E_{\theta}(\mathbf{x})/T\right)dx.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Energy-based Classifier</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.2" class="ltx_p">The EBM exhibits an intrinsic association with contemporary machine learning, particularly discriminative neural classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}(\mathbf{x}):\mathbb{R}^{D}\rightarrow\mathbb{R}^{K}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.2" xref="S2.SS2.p1.1.m1.1.2.cmml"><mrow id="S2.SS2.p1.1.m1.1.2.2" xref="S2.SS2.p1.1.m1.1.2.2.cmml"><msub id="S2.SS2.p1.1.m1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.2.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.2.2.2.2" xref="S2.SS2.p1.1.m1.1.2.2.2.2.cmml">f</mi><mi id="S2.SS2.p1.1.m1.1.2.2.2.3" xref="S2.SS2.p1.1.m1.1.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.2.2.1" xref="S2.SS2.p1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S2.SS2.p1.1.m1.1.2.2.3.2" xref="S2.SS2.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.1.2.2.3.2.1" xref="S2.SS2.p1.1.m1.1.2.2.cmml">(</mo><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝐱</mi><mo rspace="0.278em" stretchy="false" id="S2.SS2.p1.1.m1.1.2.2.3.2.2" xref="S2.SS2.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.SS2.p1.1.m1.1.2.1" xref="S2.SS2.p1.1.m1.1.2.1.cmml">:</mo><mrow id="S2.SS2.p1.1.m1.1.2.3" xref="S2.SS2.p1.1.m1.1.2.3.cmml"><msup id="S2.SS2.p1.1.m1.1.2.3.2" xref="S2.SS2.p1.1.m1.1.2.3.2.cmml"><mi id="S2.SS2.p1.1.m1.1.2.3.2.2" xref="S2.SS2.p1.1.m1.1.2.3.2.2.cmml">ℝ</mi><mi id="S2.SS2.p1.1.m1.1.2.3.2.3" xref="S2.SS2.p1.1.m1.1.2.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S2.SS2.p1.1.m1.1.2.3.1" xref="S2.SS2.p1.1.m1.1.2.3.1.cmml">→</mo><msup id="S2.SS2.p1.1.m1.1.2.3.3" xref="S2.SS2.p1.1.m1.1.2.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.2.3.3.2" xref="S2.SS2.p1.1.m1.1.2.3.3.2.cmml">ℝ</mi><mi id="S2.SS2.p1.1.m1.1.2.3.3.3" xref="S2.SS2.p1.1.m1.1.2.3.3.3.cmml">K</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.2"><ci id="S2.SS2.p1.1.m1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.1">:</ci><apply id="S2.SS2.p1.1.m1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.2"><times id="S2.SS2.p1.1.m1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.2.1"></times><apply id="S2.SS2.p1.1.m1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.2.2.2">𝑓</ci><ci id="S2.SS2.p1.1.m1.1.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.2.2.2.3">𝜃</ci></apply><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐱</ci></apply><apply id="S2.SS2.p1.1.m1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.2.3"><ci id="S2.SS2.p1.1.m1.1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.2.3.1">→</ci><apply id="S2.SS2.p1.1.m1.1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.2.3.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.3.2">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.2.3.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.3.2.2">ℝ</ci><ci id="S2.SS2.p1.1.m1.1.2.3.2.3.cmml" xref="S2.SS2.p1.1.m1.1.2.3.2.3">𝐷</ci></apply><apply id="S2.SS2.p1.1.m1.1.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.2.3.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.2.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.2.3.3.2">ℝ</ci><ci id="S2.SS2.p1.1.m1.1.2.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.2.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">f_{\theta}(\mathbf{x}):\mathbb{R}^{D}\rightarrow\mathbb{R}^{K}</annotation></semantics></math>. This classifier assigns logits to each class for a given input <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathbf{x}</annotation></semantics></math> using the softmax function:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.9" class="ltx_Math" alttext="p_{\theta}(y|\mathbf{x})=\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{\sum_{i}^{K}\exp(f_{\theta}(\mathbf{x})[i]/T)}," display="block"><semantics id="S2.E2.m1.9a"><mrow id="S2.E2.m1.9.9.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1.1" xref="S2.E2.m1.9.9.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.3.2.cmml">p</mi><mi id="S2.E2.m1.9.9.1.1.1.3.3" xref="S2.E2.m1.9.9.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.2" xref="S2.E2.m1.9.9.1.1.2.cmml">=</mo><mfrac id="S2.E2.m1.8.8" xref="S2.E2.m1.8.8.cmml"><mrow id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.5.cmml"><mi id="S2.E2.m1.3.3.3.3" xref="S2.E2.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E2.m1.4.4.4.4a" xref="S2.E2.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E2.m1.4.4.4.4.1" xref="S2.E2.m1.4.4.4.5.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.2" xref="S2.E2.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E2.m1.4.4.4.4.1.1" xref="S2.E2.m1.4.4.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.4.4.1.1.2" xref="S2.E2.m1.4.4.4.4.1.1.2.cmml"><msub id="S2.E2.m1.4.4.4.4.1.1.2.2" xref="S2.E2.m1.4.4.4.4.1.1.2.2.cmml"><mi id="S2.E2.m1.4.4.4.4.1.1.2.2.2" xref="S2.E2.m1.4.4.4.4.1.1.2.2.2.cmml">f</mi><mi id="S2.E2.m1.4.4.4.4.1.1.2.2.3" xref="S2.E2.m1.4.4.4.4.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.4.4.1.1.2.1" xref="S2.E2.m1.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.4.4.4.4.1.1.2.3.2" xref="S2.E2.m1.4.4.4.4.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.1.2.3.2.1" xref="S2.E2.m1.4.4.4.4.1.1.2.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.1.2.3.2.2" xref="S2.E2.m1.4.4.4.4.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.4.4.1.1.2.1a" xref="S2.E2.m1.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.4.4.4.4.1.1.2.4.2" xref="S2.E2.m1.4.4.4.4.1.1.2.4.1.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.1.2.4.2.1" xref="S2.E2.m1.4.4.4.4.1.1.2.4.1.1.cmml">[</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.1.2.4.2.2" xref="S2.E2.m1.4.4.4.4.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.4.4.4.4.1.1.1" xref="S2.E2.m1.4.4.4.4.1.1.1.cmml">/</mo><mi id="S2.E2.m1.4.4.4.4.1.1.3" xref="S2.E2.m1.4.4.4.4.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E2.m1.4.4.4.4.1.3" xref="S2.E2.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E2.m1.8.8.8" xref="S2.E2.m1.8.8.8.cmml"><msubsup id="S2.E2.m1.8.8.8.5" xref="S2.E2.m1.8.8.8.5.cmml"><mo id="S2.E2.m1.8.8.8.5.2.2" xref="S2.E2.m1.8.8.8.5.2.2.cmml">∑</mo><mi id="S2.E2.m1.8.8.8.5.2.3" xref="S2.E2.m1.8.8.8.5.2.3.cmml">i</mi><mi id="S2.E2.m1.8.8.8.5.3" xref="S2.E2.m1.8.8.8.5.3.cmml">K</mi></msubsup><mrow id="S2.E2.m1.8.8.8.4.1" xref="S2.E2.m1.8.8.8.4.2.cmml"><mi id="S2.E2.m1.7.7.7.3" xref="S2.E2.m1.7.7.7.3.cmml">exp</mi><mo id="S2.E2.m1.8.8.8.4.1a" xref="S2.E2.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="S2.E2.m1.8.8.8.4.1.1" xref="S2.E2.m1.8.8.8.4.2.cmml"><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.2" xref="S2.E2.m1.8.8.8.4.2.cmml">(</mo><mrow id="S2.E2.m1.8.8.8.4.1.1.1" xref="S2.E2.m1.8.8.8.4.1.1.1.cmml"><mrow id="S2.E2.m1.8.8.8.4.1.1.1.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.cmml"><msub id="S2.E2.m1.8.8.8.4.1.1.1.2.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2.cmml"><mi id="S2.E2.m1.8.8.8.4.1.1.1.2.2.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2.2.cmml">f</mi><mi id="S2.E2.m1.8.8.8.4.1.1.1.2.2.3" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.8.4.1.1.1.2.1" xref="S2.E2.m1.8.8.8.4.1.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.8.8.8.4.1.1.1.2.3.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.1.2.3.2.1" xref="S2.E2.m1.8.8.8.4.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.5.5.5.1" xref="S2.E2.m1.5.5.5.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.1.2.3.2.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.8.4.1.1.1.2.1a" xref="S2.E2.m1.8.8.8.4.1.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.8.8.8.4.1.1.1.2.4.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.4.1.cmml"><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.1.2.4.2.1" xref="S2.E2.m1.8.8.8.4.1.1.1.2.4.1.1.cmml">[</mo><mi id="S2.E2.m1.6.6.6.2" xref="S2.E2.m1.6.6.6.2.cmml">i</mi><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.1.2.4.2.2" xref="S2.E2.m1.8.8.8.4.1.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.8.8.8.4.1.1.1.1" xref="S2.E2.m1.8.8.8.4.1.1.1.1.cmml">/</mo><mi id="S2.E2.m1.8.8.8.4.1.1.1.3" xref="S2.E2.m1.8.8.8.4.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E2.m1.8.8.8.4.1.1.3" xref="S2.E2.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E2.m1.9.9.1.2" xref="S2.E2.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.9b"><apply id="S2.E2.m1.9.9.1.1.cmml" xref="S2.E2.m1.9.9.1"><eq id="S2.E2.m1.9.9.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.2"></eq><apply id="S2.E2.m1.9.9.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.3.2">𝑝</ci><ci id="S2.E2.m1.9.9.1.1.1.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.E2.m1.8.8.cmml" xref="S2.E2.m1.8.8"><divide id="S2.E2.m1.8.8.9.cmml" xref="S2.E2.m1.8.8"></divide><apply id="S2.E2.m1.4.4.4.5.cmml" xref="S2.E2.m1.4.4.4.4"><exp id="S2.E2.m1.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3"></exp><apply id="S2.E2.m1.4.4.4.4.1.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1"><divide id="S2.E2.m1.4.4.4.4.1.1.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.1"></divide><apply id="S2.E2.m1.4.4.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2"><times id="S2.E2.m1.4.4.4.4.1.1.2.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.1"></times><apply id="S2.E2.m1.4.4.4.4.1.1.2.2.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.4.1.1.2.2.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.4.4.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.2.2">𝑓</ci><ci id="S2.E2.m1.4.4.4.4.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝐱</ci><apply id="S2.E2.m1.4.4.4.4.1.1.2.4.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.4.2"><csymbol cd="latexml" id="S2.E2.m1.4.4.4.4.1.1.2.4.1.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑦</ci></apply></apply><ci id="S2.E2.m1.4.4.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.4.4.1.1.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.8.8.8.cmml" xref="S2.E2.m1.8.8.8"><apply id="S2.E2.m1.8.8.8.5.cmml" xref="S2.E2.m1.8.8.8.5"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.5.1.cmml" xref="S2.E2.m1.8.8.8.5">superscript</csymbol><apply id="S2.E2.m1.8.8.8.5.2.cmml" xref="S2.E2.m1.8.8.8.5"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.5.2.1.cmml" xref="S2.E2.m1.8.8.8.5">subscript</csymbol><sum id="S2.E2.m1.8.8.8.5.2.2.cmml" xref="S2.E2.m1.8.8.8.5.2.2"></sum><ci id="S2.E2.m1.8.8.8.5.2.3.cmml" xref="S2.E2.m1.8.8.8.5.2.3">𝑖</ci></apply><ci id="S2.E2.m1.8.8.8.5.3.cmml" xref="S2.E2.m1.8.8.8.5.3">𝐾</ci></apply><apply id="S2.E2.m1.8.8.8.4.2.cmml" xref="S2.E2.m1.8.8.8.4.1"><exp id="S2.E2.m1.7.7.7.3.cmml" xref="S2.E2.m1.7.7.7.3"></exp><apply id="S2.E2.m1.8.8.8.4.1.1.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1"><divide id="S2.E2.m1.8.8.8.4.1.1.1.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.1"></divide><apply id="S2.E2.m1.8.8.8.4.1.1.1.2.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2"><times id="S2.E2.m1.8.8.8.4.1.1.1.2.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.1"></times><apply id="S2.E2.m1.8.8.8.4.1.1.1.2.2.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.4.1.1.1.2.2.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2">subscript</csymbol><ci id="S2.E2.m1.8.8.8.4.1.1.1.2.2.2.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2.2">𝑓</ci><ci id="S2.E2.m1.8.8.8.4.1.1.1.2.2.3.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E2.m1.5.5.5.1.cmml" xref="S2.E2.m1.5.5.5.1">𝐱</ci><apply id="S2.E2.m1.8.8.8.4.1.1.1.2.4.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.4.2"><csymbol cd="latexml" id="S2.E2.m1.8.8.8.4.1.1.1.2.4.1.1.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.E2.m1.6.6.6.2.cmml" xref="S2.E2.m1.6.6.6.2">𝑖</ci></apply></apply><ci id="S2.E2.m1.8.8.8.4.1.1.1.3.cmml" xref="S2.E2.m1.8.8.8.4.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.9c">p_{\theta}(y|\mathbf{x})=\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{\sum_{i}^{K}\exp(f_{\theta}(\mathbf{x})[i]/T)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.5" class="ltx_p">where <math id="S2.SS2.p1.3.m1.2" class="ltx_Math" alttext="f_{\theta}(\mathbf{x})[y]" display="inline"><semantics id="S2.SS2.p1.3.m1.2a"><mrow id="S2.SS2.p1.3.m1.2.3" xref="S2.SS2.p1.3.m1.2.3.cmml"><msub id="S2.SS2.p1.3.m1.2.3.2" xref="S2.SS2.p1.3.m1.2.3.2.cmml"><mi id="S2.SS2.p1.3.m1.2.3.2.2" xref="S2.SS2.p1.3.m1.2.3.2.2.cmml">f</mi><mi id="S2.SS2.p1.3.m1.2.3.2.3" xref="S2.SS2.p1.3.m1.2.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m1.2.3.1" xref="S2.SS2.p1.3.m1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p1.3.m1.2.3.3.2" xref="S2.SS2.p1.3.m1.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.3.m1.2.3.3.2.1" xref="S2.SS2.p1.3.m1.2.3.cmml">(</mo><mi id="S2.SS2.p1.3.m1.1.1" xref="S2.SS2.p1.3.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p1.3.m1.2.3.3.2.2" xref="S2.SS2.p1.3.m1.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m1.2.3.1a" xref="S2.SS2.p1.3.m1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p1.3.m1.2.3.4.2" xref="S2.SS2.p1.3.m1.2.3.4.1.cmml"><mo stretchy="false" id="S2.SS2.p1.3.m1.2.3.4.2.1" xref="S2.SS2.p1.3.m1.2.3.4.1.1.cmml">[</mo><mi id="S2.SS2.p1.3.m1.2.2" xref="S2.SS2.p1.3.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS2.p1.3.m1.2.3.4.2.2" xref="S2.SS2.p1.3.m1.2.3.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m1.2b"><apply id="S2.SS2.p1.3.m1.2.3.cmml" xref="S2.SS2.p1.3.m1.2.3"><times id="S2.SS2.p1.3.m1.2.3.1.cmml" xref="S2.SS2.p1.3.m1.2.3.1"></times><apply id="S2.SS2.p1.3.m1.2.3.2.cmml" xref="S2.SS2.p1.3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.2.3.2.1.cmml" xref="S2.SS2.p1.3.m1.2.3.2">subscript</csymbol><ci id="S2.SS2.p1.3.m1.2.3.2.2.cmml" xref="S2.SS2.p1.3.m1.2.3.2.2">𝑓</ci><ci id="S2.SS2.p1.3.m1.2.3.2.3.cmml" xref="S2.SS2.p1.3.m1.2.3.2.3">𝜃</ci></apply><ci id="S2.SS2.p1.3.m1.1.1.cmml" xref="S2.SS2.p1.3.m1.1.1">𝐱</ci><apply id="S2.SS2.p1.3.m1.2.3.4.1.cmml" xref="S2.SS2.p1.3.m1.2.3.4.2"><csymbol cd="latexml" id="S2.SS2.p1.3.m1.2.3.4.1.1.cmml" xref="S2.SS2.p1.3.m1.2.3.4.2.1">delimited-[]</csymbol><ci id="S2.SS2.p1.3.m1.2.2.cmml" xref="S2.SS2.p1.3.m1.2.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m1.2c">f_{\theta}(\mathbf{x})[y]</annotation></semantics></math> denotes the logit associated with the <math id="S2.SS2.p1.4.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS2.p1.4.m2.1a"><mi id="S2.SS2.p1.4.m2.1.1" xref="S2.SS2.p1.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m2.1b"><ci id="S2.SS2.p1.4.m2.1.1.cmml" xref="S2.SS2.p1.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m2.1c">y</annotation></semantics></math>-th class label within the output of <math id="S2.SS2.p1.5.m3.1" class="ltx_Math" alttext="f_{\theta}(\mathbf{x})" display="inline"><semantics id="S2.SS2.p1.5.m3.1a"><mrow id="S2.SS2.p1.5.m3.1.2" xref="S2.SS2.p1.5.m3.1.2.cmml"><msub id="S2.SS2.p1.5.m3.1.2.2" xref="S2.SS2.p1.5.m3.1.2.2.cmml"><mi id="S2.SS2.p1.5.m3.1.2.2.2" xref="S2.SS2.p1.5.m3.1.2.2.2.cmml">f</mi><mi id="S2.SS2.p1.5.m3.1.2.2.3" xref="S2.SS2.p1.5.m3.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.m3.1.2.1" xref="S2.SS2.p1.5.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.5.m3.1.2.3.2" xref="S2.SS2.p1.5.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.5.m3.1.2.3.2.1" xref="S2.SS2.p1.5.m3.1.2.cmml">(</mo><mi id="S2.SS2.p1.5.m3.1.1" xref="S2.SS2.p1.5.m3.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p1.5.m3.1.2.3.2.2" xref="S2.SS2.p1.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m3.1b"><apply id="S2.SS2.p1.5.m3.1.2.cmml" xref="S2.SS2.p1.5.m3.1.2"><times id="S2.SS2.p1.5.m3.1.2.1.cmml" xref="S2.SS2.p1.5.m3.1.2.1"></times><apply id="S2.SS2.p1.5.m3.1.2.2.cmml" xref="S2.SS2.p1.5.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m3.1.2.2.1.cmml" xref="S2.SS2.p1.5.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.5.m3.1.2.2.2.cmml" xref="S2.SS2.p1.5.m3.1.2.2.2">𝑓</ci><ci id="S2.SS2.p1.5.m3.1.2.2.3.cmml" xref="S2.SS2.p1.5.m3.1.2.2.3">𝜃</ci></apply><ci id="S2.SS2.p1.5.m3.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m3.1c">f_{\theta}(\mathbf{x})</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.4" class="ltx_p">This connection allows us to view the discriminative classifier <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="f(\mathbf{x})" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mi id="S2.SS2.p2.1.m1.1.2.2" xref="S2.SS2.p2.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.2.1" xref="S2.SS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.1.m1.1.2.3.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.1.2.3.2.1" xref="S2.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p2.1.m1.1.2.3.2.2" xref="S2.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.2"><times id="S2.SS2.p2.1.m1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.1"></times><ci id="S2.SS2.p2.1.m1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2">𝑓</ci><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">f(\mathbf{x})</annotation></semantics></math> as an energy function in the EBM framework <math id="S2.SS2.p2.2.m2.4" class="ltx_Math" alttext="E_{\theta}(\mathbf{x},y)=-f_{\theta}(\mathbf{x})[y]/T" display="inline"><semantics id="S2.SS2.p2.2.m2.4a"><mrow id="S2.SS2.p2.2.m2.4.5" xref="S2.SS2.p2.2.m2.4.5.cmml"><mrow id="S2.SS2.p2.2.m2.4.5.2" xref="S2.SS2.p2.2.m2.4.5.2.cmml"><msub id="S2.SS2.p2.2.m2.4.5.2.2" xref="S2.SS2.p2.2.m2.4.5.2.2.cmml"><mi id="S2.SS2.p2.2.m2.4.5.2.2.2" xref="S2.SS2.p2.2.m2.4.5.2.2.2.cmml">E</mi><mi id="S2.SS2.p2.2.m2.4.5.2.2.3" xref="S2.SS2.p2.2.m2.4.5.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.4.5.2.1" xref="S2.SS2.p2.2.m2.4.5.2.1.cmml">​</mo><mrow id="S2.SS2.p2.2.m2.4.5.2.3.2" xref="S2.SS2.p2.2.m2.4.5.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.2.3.2.1" xref="S2.SS2.p2.2.m2.4.5.2.3.1.cmml">(</mo><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">𝐱</mi><mo id="S2.SS2.p2.2.m2.4.5.2.3.2.2" xref="S2.SS2.p2.2.m2.4.5.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.2.m2.2.2" xref="S2.SS2.p2.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.2.3.2.3" xref="S2.SS2.p2.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.2.m2.4.5.1" xref="S2.SS2.p2.2.m2.4.5.1.cmml">=</mo><mrow id="S2.SS2.p2.2.m2.4.5.3" xref="S2.SS2.p2.2.m2.4.5.3.cmml"><mo id="S2.SS2.p2.2.m2.4.5.3a" xref="S2.SS2.p2.2.m2.4.5.3.cmml">−</mo><mrow id="S2.SS2.p2.2.m2.4.5.3.2" xref="S2.SS2.p2.2.m2.4.5.3.2.cmml"><mrow id="S2.SS2.p2.2.m2.4.5.3.2.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.cmml"><msub id="S2.SS2.p2.2.m2.4.5.3.2.2.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2.cmml"><mi id="S2.SS2.p2.2.m2.4.5.3.2.2.2.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2.2.cmml">f</mi><mi id="S2.SS2.p2.2.m2.4.5.3.2.2.2.3" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.4.5.3.2.2.1" xref="S2.SS2.p2.2.m2.4.5.3.2.2.1.cmml">​</mo><mrow id="S2.SS2.p2.2.m2.4.5.3.2.2.3.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.3.2.2.3.2.1" xref="S2.SS2.p2.2.m2.4.5.3.2.2.cmml">(</mo><mi id="S2.SS2.p2.2.m2.3.3" xref="S2.SS2.p2.2.m2.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.3.2.2.3.2.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.4.5.3.2.2.1a" xref="S2.SS2.p2.2.m2.4.5.3.2.2.1.cmml">​</mo><mrow id="S2.SS2.p2.2.m2.4.5.3.2.2.4.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.4.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.3.2.2.4.2.1" xref="S2.SS2.p2.2.m2.4.5.3.2.2.4.1.1.cmml">[</mo><mi id="S2.SS2.p2.2.m2.4.4" xref="S2.SS2.p2.2.m2.4.4.cmml">y</mi><mo stretchy="false" id="S2.SS2.p2.2.m2.4.5.3.2.2.4.2.2" xref="S2.SS2.p2.2.m2.4.5.3.2.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S2.SS2.p2.2.m2.4.5.3.2.1" xref="S2.SS2.p2.2.m2.4.5.3.2.1.cmml">/</mo><mi id="S2.SS2.p2.2.m2.4.5.3.2.3" xref="S2.SS2.p2.2.m2.4.5.3.2.3.cmml">T</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.4b"><apply id="S2.SS2.p2.2.m2.4.5.cmml" xref="S2.SS2.p2.2.m2.4.5"><eq id="S2.SS2.p2.2.m2.4.5.1.cmml" xref="S2.SS2.p2.2.m2.4.5.1"></eq><apply id="S2.SS2.p2.2.m2.4.5.2.cmml" xref="S2.SS2.p2.2.m2.4.5.2"><times id="S2.SS2.p2.2.m2.4.5.2.1.cmml" xref="S2.SS2.p2.2.m2.4.5.2.1"></times><apply id="S2.SS2.p2.2.m2.4.5.2.2.cmml" xref="S2.SS2.p2.2.m2.4.5.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.4.5.2.2.1.cmml" xref="S2.SS2.p2.2.m2.4.5.2.2">subscript</csymbol><ci id="S2.SS2.p2.2.m2.4.5.2.2.2.cmml" xref="S2.SS2.p2.2.m2.4.5.2.2.2">𝐸</ci><ci id="S2.SS2.p2.2.m2.4.5.2.2.3.cmml" xref="S2.SS2.p2.2.m2.4.5.2.2.3">𝜃</ci></apply><interval closure="open" id="S2.SS2.p2.2.m2.4.5.2.3.1.cmml" xref="S2.SS2.p2.2.m2.4.5.2.3.2"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝐱</ci><ci id="S2.SS2.p2.2.m2.2.2.cmml" xref="S2.SS2.p2.2.m2.2.2">𝑦</ci></interval></apply><apply id="S2.SS2.p2.2.m2.4.5.3.cmml" xref="S2.SS2.p2.2.m2.4.5.3"><minus id="S2.SS2.p2.2.m2.4.5.3.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3"></minus><apply id="S2.SS2.p2.2.m2.4.5.3.2.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2"><divide id="S2.SS2.p2.2.m2.4.5.3.2.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.1"></divide><apply id="S2.SS2.p2.2.m2.4.5.3.2.2.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2"><times id="S2.SS2.p2.2.m2.4.5.3.2.2.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.1"></times><apply id="S2.SS2.p2.2.m2.4.5.3.2.2.2.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.4.5.3.2.2.2.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.2.m2.4.5.3.2.2.2.2.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2.2">𝑓</ci><ci id="S2.SS2.p2.2.m2.4.5.3.2.2.2.3.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.2.3">𝜃</ci></apply><ci id="S2.SS2.p2.2.m2.3.3.cmml" xref="S2.SS2.p2.2.m2.3.3">𝐱</ci><apply id="S2.SS2.p2.2.m2.4.5.3.2.2.4.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.4.2"><csymbol cd="latexml" id="S2.SS2.p2.2.m2.4.5.3.2.2.4.1.1.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.2.4.2.1">delimited-[]</csymbol><ci id="S2.SS2.p2.2.m2.4.4.cmml" xref="S2.SS2.p2.2.m2.4.4">𝑦</ci></apply></apply><ci id="S2.SS2.p2.2.m2.4.5.3.2.3.cmml" xref="S2.SS2.p2.2.m2.4.5.3.2.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.4c">E_{\theta}(\mathbf{x},y)=-f_{\theta}(\mathbf{x})[y]/T</annotation></semantics></math>. Consequently, the Helmholtz free energy function <math id="S2.SS2.p2.3.m3.2" class="ltx_Math" alttext="E(\mathbf{x};f)" display="inline"><semantics id="S2.SS2.p2.3.m3.2a"><mrow id="S2.SS2.p2.3.m3.2.3" xref="S2.SS2.p2.3.m3.2.3.cmml"><mi id="S2.SS2.p2.3.m3.2.3.2" xref="S2.SS2.p2.3.m3.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.2.3.1" xref="S2.SS2.p2.3.m3.2.3.1.cmml">​</mo><mrow id="S2.SS2.p2.3.m3.2.3.3.2" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.3.m3.2.3.3.2.1" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">𝐱</mi><mo id="S2.SS2.p2.3.m3.2.3.3.2.2" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml">;</mo><mi id="S2.SS2.p2.3.m3.2.2" xref="S2.SS2.p2.3.m3.2.2.cmml">f</mi><mo stretchy="false" id="S2.SS2.p2.3.m3.2.3.3.2.3" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.2b"><apply id="S2.SS2.p2.3.m3.2.3.cmml" xref="S2.SS2.p2.3.m3.2.3"><times id="S2.SS2.p2.3.m3.2.3.1.cmml" xref="S2.SS2.p2.3.m3.2.3.1"></times><ci id="S2.SS2.p2.3.m3.2.3.2.cmml" xref="S2.SS2.p2.3.m3.2.3.2">𝐸</ci><list id="S2.SS2.p2.3.m3.2.3.3.1.cmml" xref="S2.SS2.p2.3.m3.2.3.3.2"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝐱</ci><ci id="S2.SS2.p2.3.m3.2.2.cmml" xref="S2.SS2.p2.3.m3.2.2">𝑓</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.2c">E(\mathbf{x};f)</annotation></semantics></math> for a given data point <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{x}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">𝐱</mi><mo id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><in id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></in><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝐱</ci><apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathbf{x}\in\mathbb{R}^{D}</annotation></semantics></math> can be represented as the negative logarithm of the partition function:</p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.6" class="ltx_Math" alttext="E_{\theta}(\mathbf{x};f)=-T\cdot\log\sum_{i}^{K}\exp(f_{\theta}(\mathbf{x})[i]/T)." display="block"><semantics id="S2.Ex2.m1.6a"><mrow id="S2.Ex2.m1.6.6.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1.3" xref="S2.Ex2.m1.6.6.1.1.3.cmml"><msub id="S2.Ex2.m1.6.6.1.1.3.2" xref="S2.Ex2.m1.6.6.1.1.3.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.3.2.2" xref="S2.Ex2.m1.6.6.1.1.3.2.2.cmml">E</mi><mi id="S2.Ex2.m1.6.6.1.1.3.2.3" xref="S2.Ex2.m1.6.6.1.1.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.6.6.1.1.3.1" xref="S2.Ex2.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S2.Ex2.m1.6.6.1.1.3.3.2" xref="S2.Ex2.m1.6.6.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.3.3.2.1" xref="S2.Ex2.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml">𝐱</mi><mo id="S2.Ex2.m1.6.6.1.1.3.3.2.2" xref="S2.Ex2.m1.6.6.1.1.3.3.1.cmml">;</mo><mi id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml">f</mi><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.3.3.2.3" xref="S2.Ex2.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.6.6.1.1.2" xref="S2.Ex2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S2.Ex2.m1.6.6.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.cmml"><mo id="S2.Ex2.m1.6.6.1.1.1a" xref="S2.Ex2.m1.6.6.1.1.1.cmml">−</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1.1.1.3" xref="S2.Ex2.m1.6.6.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.6.6.1.1.1.1.3.2" xref="S2.Ex2.m1.6.6.1.1.1.1.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S2.Ex2.m1.6.6.1.1.1.1.3.1" xref="S2.Ex2.m1.6.6.1.1.1.1.3.1.cmml">⋅</mo><mi id="S2.Ex2.m1.6.6.1.1.1.1.3.3" xref="S2.Ex2.m1.6.6.1.1.1.1.3.3.cmml">log</mi></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.6.6.1.1.1.1.2" xref="S2.Ex2.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.cmml"><munderover id="S2.Ex2.m1.6.6.1.1.1.1.1.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.2.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.5.5" xref="S2.Ex2.m1.5.5.cmml">exp</mi><mo id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1a" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.2.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1a" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.2.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.1.1.cmml">[</mo><mi id="S2.Ex2.m1.4.4" xref="S2.Ex2.m1.4.4.cmml">i</mi><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex2.m1.6.6.1.2" xref="S2.Ex2.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.6b"><apply id="S2.Ex2.m1.6.6.1.1.cmml" xref="S2.Ex2.m1.6.6.1"><eq id="S2.Ex2.m1.6.6.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.2"></eq><apply id="S2.Ex2.m1.6.6.1.1.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3"><times id="S2.Ex2.m1.6.6.1.1.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.1"></times><apply id="S2.Ex2.m1.6.6.1.1.3.2.cmml" xref="S2.Ex2.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.3.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.3.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.3.2.2">𝐸</ci><ci id="S2.Ex2.m1.6.6.1.1.3.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.2.3">𝜃</ci></apply><list id="S2.Ex2.m1.6.6.1.1.3.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.2"><ci id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">𝐱</ci><ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">𝑓</ci></list></apply><apply id="S2.Ex2.m1.6.6.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1"><minus id="S2.Ex2.m1.6.6.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1"></minus><apply id="S2.Ex2.m1.6.6.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1"><times id="S2.Ex2.m1.6.6.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.2"></times><apply id="S2.Ex2.m1.6.6.1.1.1.1.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.3"><ci id="S2.Ex2.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.3.1">⋅</ci><ci id="S2.Ex2.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.3.2">𝑇</ci><log id="S2.Ex2.m1.6.6.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.3.3"></log></apply><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1"><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2">superscript</csymbol><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2">subscript</csymbol><sum id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.2"></sum><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1"><exp id="S2.Ex2.m1.5.5.cmml" xref="S2.Ex2.m1.5.5"></exp><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1"><divide id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1"></divide><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2"><times id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.3">𝜃</ci></apply><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">𝐱</ci><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.2"><csymbol cd="latexml" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">𝑖</ci></apply></apply><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.6c">E_{\theta}(\mathbf{x};f)=-T\cdot\log\sum_{i}^{K}\exp(f_{\theta}(\mathbf{x})[i]/T).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.7" class="ltx_p">Additionally, the logits from <math id="S2.SS2.p2.5.m1.1" class="ltx_Math" alttext="f(\mathbf{x})" display="inline"><semantics id="S2.SS2.p2.5.m1.1a"><mrow id="S2.SS2.p2.5.m1.1.2" xref="S2.SS2.p2.5.m1.1.2.cmml"><mi id="S2.SS2.p2.5.m1.1.2.2" xref="S2.SS2.p2.5.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.5.m1.1.2.1" xref="S2.SS2.p2.5.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.5.m1.1.2.3.2" xref="S2.SS2.p2.5.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.5.m1.1.2.3.2.1" xref="S2.SS2.p2.5.m1.1.2.cmml">(</mo><mi id="S2.SS2.p2.5.m1.1.1" xref="S2.SS2.p2.5.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p2.5.m1.1.2.3.2.2" xref="S2.SS2.p2.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m1.1b"><apply id="S2.SS2.p2.5.m1.1.2.cmml" xref="S2.SS2.p2.5.m1.1.2"><times id="S2.SS2.p2.5.m1.1.2.1.cmml" xref="S2.SS2.p2.5.m1.1.2.1"></times><ci id="S2.SS2.p2.5.m1.1.2.2.cmml" xref="S2.SS2.p2.5.m1.1.2.2">𝑓</ci><ci id="S2.SS2.p2.5.m1.1.1.cmml" xref="S2.SS2.p2.5.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m1.1c">f(\mathbf{x})</annotation></semantics></math> enable the definition of an EBM for the joint distribution of data points <math id="S2.SS2.p2.6.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p2.6.m2.1a"><mi id="S2.SS2.p2.6.m2.1.1" xref="S2.SS2.p2.6.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m2.1b"><ci id="S2.SS2.p2.6.m2.1.1.cmml" xref="S2.SS2.p2.6.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m2.1c">\mathbf{x}</annotation></semantics></math> and labels <math id="S2.SS2.p2.7.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS2.p2.7.m3.1a"><mi id="S2.SS2.p2.7.m3.1.1" xref="S2.SS2.p2.7.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m3.1b"><ci id="S2.SS2.p2.7.m3.1.1.cmml" xref="S2.SS2.p2.7.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m3.1c">y</annotation></semantics></math>:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.13" class="ltx_math_unparsed" alttext="p_{\theta}(\mathbf{x},y)=\frac{\exp(-E_{\theta}(x,y))}{\int_{x}\sum_{i}^{K}\exp(-E_{\theta}(x,y)}dx)=\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{Z(\theta)}." display="block"><semantics id="S2.E3.m1.13a"><mrow id="S2.E3.m1.13b"><msub id="S2.E3.m1.13.14"><mi id="S2.E3.m1.13.14.2">p</mi><mi id="S2.E3.m1.13.14.3">θ</mi></msub><mrow id="S2.E3.m1.13.15"><mo stretchy="false" id="S2.E3.m1.13.15.1">(</mo><mi id="S2.E3.m1.12.12">𝐱</mi><mo id="S2.E3.m1.13.15.2">,</mo><mi id="S2.E3.m1.13.13">y</mi><mo stretchy="false" id="S2.E3.m1.13.15.3">)</mo></mrow><mo id="S2.E3.m1.13.16">=</mo><mfrac id="S2.E3.m1.6.6"><mrow id="S2.E3.m1.4.4.4.4"><mi id="S2.E3.m1.3.3.3.3">exp</mi><mo id="S2.E3.m1.4.4.4.4a">⁡</mo><mrow id="S2.E3.m1.4.4.4.4.1"><mo stretchy="false" id="S2.E3.m1.4.4.4.4.1.2">(</mo><mrow id="S2.E3.m1.4.4.4.4.1.1"><mo id="S2.E3.m1.4.4.4.4.1.1a">−</mo><mrow id="S2.E3.m1.4.4.4.4.1.1.2"><msub id="S2.E3.m1.4.4.4.4.1.1.2.2"><mi id="S2.E3.m1.4.4.4.4.1.1.2.2.2">E</mi><mi id="S2.E3.m1.4.4.4.4.1.1.2.2.3">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.4.1.1.2.1">​</mo><mrow id="S2.E3.m1.4.4.4.4.1.1.2.3.2"><mo stretchy="false" id="S2.E3.m1.4.4.4.4.1.1.2.3.2.1">(</mo><mi id="S2.E3.m1.1.1.1.1">x</mi><mo id="S2.E3.m1.4.4.4.4.1.1.2.3.2.2">,</mo><mi id="S2.E3.m1.2.2.2.2">y</mi><mo stretchy="false" id="S2.E3.m1.4.4.4.4.1.1.2.3.2.3">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E3.m1.4.4.4.4.1.3">)</mo></mrow></mrow><mrow id="S2.E3.m1.6.6.6"><msub id="S2.E3.m1.6.6.6.3"><mo id="S2.E3.m1.6.6.6.3.2">∫</mo><mi id="S2.E3.m1.6.6.6.3.3">x</mi></msub><msubsup id="S2.E3.m1.6.6.6.4"><mo lspace="0.167em" id="S2.E3.m1.6.6.6.4.2.2">∑</mo><mi id="S2.E3.m1.6.6.6.4.2.3">i</mi><mi id="S2.E3.m1.6.6.6.4.3">K</mi></msubsup><mi id="S2.E3.m1.6.6.6.5">exp</mi><mrow id="S2.E3.m1.6.6.6.6"><mo stretchy="false" id="S2.E3.m1.6.6.6.6.1">(</mo><mo lspace="0em" id="S2.E3.m1.6.6.6.6.2">−</mo><msub id="S2.E3.m1.6.6.6.6.3"><mi id="S2.E3.m1.6.6.6.6.3.2">E</mi><mi id="S2.E3.m1.6.6.6.6.3.3">θ</mi></msub><mrow id="S2.E3.m1.6.6.6.6.4"><mo stretchy="false" id="S2.E3.m1.6.6.6.6.4.1">(</mo><mi id="S2.E3.m1.5.5.5.1">x</mi><mo id="S2.E3.m1.6.6.6.6.4.2">,</mo><mi id="S2.E3.m1.6.6.6.2">y</mi><mo stretchy="false" id="S2.E3.m1.6.6.6.6.4.3">)</mo></mrow></mrow></mrow></mfrac><mi id="S2.E3.m1.13.17">d</mi><mi id="S2.E3.m1.13.18">x</mi><mo stretchy="false" id="S2.E3.m1.13.19">)</mo><mo id="S2.E3.m1.13.20">=</mo><mfrac id="S2.E3.m1.11.11"><mrow id="S2.E3.m1.10.10.4.4"><mi id="S2.E3.m1.9.9.3.3">exp</mi><mo id="S2.E3.m1.10.10.4.4a">⁡</mo><mrow id="S2.E3.m1.10.10.4.4.1"><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.2">(</mo><mrow id="S2.E3.m1.10.10.4.4.1.1"><mrow id="S2.E3.m1.10.10.4.4.1.1.2"><msub id="S2.E3.m1.10.10.4.4.1.1.2.2"><mi id="S2.E3.m1.10.10.4.4.1.1.2.2.2">f</mi><mi id="S2.E3.m1.10.10.4.4.1.1.2.2.3">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.10.10.4.4.1.1.2.1">​</mo><mrow id="S2.E3.m1.10.10.4.4.1.1.2.3.2"><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.1.2.3.2.1">(</mo><mi id="S2.E3.m1.7.7.1.1">𝐱</mi><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.1.2.3.2.2">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.10.10.4.4.1.1.2.1a">​</mo><mrow id="S2.E3.m1.10.10.4.4.1.1.2.4.2"><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.1.2.4.2.1">[</mo><mi id="S2.E3.m1.8.8.2.2">y</mi><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.1.2.4.2.2">]</mo></mrow></mrow><mo id="S2.E3.m1.10.10.4.4.1.1.1">/</mo><mi id="S2.E3.m1.10.10.4.4.1.1.3">T</mi></mrow><mo stretchy="false" id="S2.E3.m1.10.10.4.4.1.3">)</mo></mrow></mrow><mrow id="S2.E3.m1.11.11.5"><mi id="S2.E3.m1.11.11.5.3">Z</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.5.2">​</mo><mrow id="S2.E3.m1.11.11.5.4.2"><mo stretchy="false" id="S2.E3.m1.11.11.5.4.2.1">(</mo><mi id="S2.E3.m1.11.11.5.1">θ</mi><mo stretchy="false" id="S2.E3.m1.11.11.5.4.2.2">)</mo></mrow></mrow></mfrac><mo lspace="0em" id="S2.E3.m1.13.21">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.13c">p_{\theta}(\mathbf{x},y)=\frac{\exp(-E_{\theta}(x,y))}{\int_{x}\sum_{i}^{K}\exp(-E_{\theta}(x,y)}dx)=\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{Z(\theta)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.9" class="ltx_p">Marginalizing over <math id="S2.SS2.p2.8.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS2.p2.8.m1.1a"><mi id="S2.SS2.p2.8.m1.1.1" xref="S2.SS2.p2.8.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m1.1b"><ci id="S2.SS2.p2.8.m1.1.1.cmml" xref="S2.SS2.p2.8.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m1.1c">y</annotation></semantics></math> provides an unnormalized density model for <math id="S2.SS2.p2.9.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p2.9.m2.1a"><mi id="S2.SS2.p2.9.m2.1.1" xref="S2.SS2.p2.9.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m2.1b"><ci id="S2.SS2.p2.9.m2.1.1.cmml" xref="S2.SS2.p2.9.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m2.1c">\mathbf{x}</annotation></semantics></math>:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.9" class="ltx_Math" alttext="p_{\theta}(\mathbf{x})=\sum_{y}p_{\theta}(\mathbf{x},y)=\sum_{y}\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{Z(\theta)}," display="block"><semantics id="S2.E4.m1.9a"><mrow id="S2.E4.m1.9.9.1" xref="S2.E4.m1.9.9.1.1.cmml"><mrow id="S2.E4.m1.9.9.1.1" xref="S2.E4.m1.9.9.1.1.cmml"><mrow id="S2.E4.m1.9.9.1.1.2" xref="S2.E4.m1.9.9.1.1.2.cmml"><msub id="S2.E4.m1.9.9.1.1.2.2" xref="S2.E4.m1.9.9.1.1.2.2.cmml"><mi id="S2.E4.m1.9.9.1.1.2.2.2" xref="S2.E4.m1.9.9.1.1.2.2.2.cmml">p</mi><mi id="S2.E4.m1.9.9.1.1.2.2.3" xref="S2.E4.m1.9.9.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.9.9.1.1.2.1" xref="S2.E4.m1.9.9.1.1.2.1.cmml">​</mo><mrow id="S2.E4.m1.9.9.1.1.2.3.2" xref="S2.E4.m1.9.9.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.9.9.1.1.2.3.2.1" xref="S2.E4.m1.9.9.1.1.2.cmml">(</mo><mi id="S2.E4.m1.6.6" xref="S2.E4.m1.6.6.cmml">𝐱</mi><mo stretchy="false" id="S2.E4.m1.9.9.1.1.2.3.2.2" xref="S2.E4.m1.9.9.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E4.m1.9.9.1.1.3" xref="S2.E4.m1.9.9.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.9.9.1.1.4" xref="S2.E4.m1.9.9.1.1.4.cmml"><munder id="S2.E4.m1.9.9.1.1.4.1" xref="S2.E4.m1.9.9.1.1.4.1.cmml"><mo movablelimits="false" id="S2.E4.m1.9.9.1.1.4.1.2" xref="S2.E4.m1.9.9.1.1.4.1.2.cmml">∑</mo><mi id="S2.E4.m1.9.9.1.1.4.1.3" xref="S2.E4.m1.9.9.1.1.4.1.3.cmml">y</mi></munder><mrow id="S2.E4.m1.9.9.1.1.4.2" xref="S2.E4.m1.9.9.1.1.4.2.cmml"><msub id="S2.E4.m1.9.9.1.1.4.2.2" xref="S2.E4.m1.9.9.1.1.4.2.2.cmml"><mi id="S2.E4.m1.9.9.1.1.4.2.2.2" xref="S2.E4.m1.9.9.1.1.4.2.2.2.cmml">p</mi><mi id="S2.E4.m1.9.9.1.1.4.2.2.3" xref="S2.E4.m1.9.9.1.1.4.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.9.9.1.1.4.2.1" xref="S2.E4.m1.9.9.1.1.4.2.1.cmml">​</mo><mrow id="S2.E4.m1.9.9.1.1.4.2.3.2" xref="S2.E4.m1.9.9.1.1.4.2.3.1.cmml"><mo stretchy="false" id="S2.E4.m1.9.9.1.1.4.2.3.2.1" xref="S2.E4.m1.9.9.1.1.4.2.3.1.cmml">(</mo><mi id="S2.E4.m1.7.7" xref="S2.E4.m1.7.7.cmml">𝐱</mi><mo id="S2.E4.m1.9.9.1.1.4.2.3.2.2" xref="S2.E4.m1.9.9.1.1.4.2.3.1.cmml">,</mo><mi id="S2.E4.m1.8.8" xref="S2.E4.m1.8.8.cmml">y</mi><mo stretchy="false" id="S2.E4.m1.9.9.1.1.4.2.3.2.3" xref="S2.E4.m1.9.9.1.1.4.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S2.E4.m1.9.9.1.1.5" xref="S2.E4.m1.9.9.1.1.5.cmml">=</mo><mrow id="S2.E4.m1.9.9.1.1.6" xref="S2.E4.m1.9.9.1.1.6.cmml"><munder id="S2.E4.m1.9.9.1.1.6.1" xref="S2.E4.m1.9.9.1.1.6.1.cmml"><mo movablelimits="false" id="S2.E4.m1.9.9.1.1.6.1.2" xref="S2.E4.m1.9.9.1.1.6.1.2.cmml">∑</mo><mi id="S2.E4.m1.9.9.1.1.6.1.3" xref="S2.E4.m1.9.9.1.1.6.1.3.cmml">y</mi></munder><mfrac id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml"><mrow id="S2.E4.m1.4.4.4.4" xref="S2.E4.m1.4.4.4.5.cmml"><mi id="S2.E4.m1.3.3.3.3" xref="S2.E4.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E4.m1.4.4.4.4a" xref="S2.E4.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E4.m1.4.4.4.4.1" xref="S2.E4.m1.4.4.4.5.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.2" xref="S2.E4.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E4.m1.4.4.4.4.1.1" xref="S2.E4.m1.4.4.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.4.4.1.1.2" xref="S2.E4.m1.4.4.4.4.1.1.2.cmml"><msub id="S2.E4.m1.4.4.4.4.1.1.2.2" xref="S2.E4.m1.4.4.4.4.1.1.2.2.cmml"><mi id="S2.E4.m1.4.4.4.4.1.1.2.2.2" xref="S2.E4.m1.4.4.4.4.1.1.2.2.2.cmml">f</mi><mi id="S2.E4.m1.4.4.4.4.1.1.2.2.3" xref="S2.E4.m1.4.4.4.4.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.4.4.1.1.2.1" xref="S2.E4.m1.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E4.m1.4.4.4.4.1.1.2.3.2" xref="S2.E4.m1.4.4.4.4.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.1.2.3.2.1" xref="S2.E4.m1.4.4.4.4.1.1.2.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.1.2.3.2.2" xref="S2.E4.m1.4.4.4.4.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.4.4.1.1.2.1a" xref="S2.E4.m1.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E4.m1.4.4.4.4.1.1.2.4.2" xref="S2.E4.m1.4.4.4.4.1.1.2.4.1.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.1.2.4.2.1" xref="S2.E4.m1.4.4.4.4.1.1.2.4.1.1.cmml">[</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.1.2.4.2.2" xref="S2.E4.m1.4.4.4.4.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.4.4.4.4.1.1.1" xref="S2.E4.m1.4.4.4.4.1.1.1.cmml">/</mo><mi id="S2.E4.m1.4.4.4.4.1.1.3" xref="S2.E4.m1.4.4.4.4.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E4.m1.4.4.4.4.1.3" xref="S2.E4.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E4.m1.5.5.5" xref="S2.E4.m1.5.5.5.cmml"><mi id="S2.E4.m1.5.5.5.3" xref="S2.E4.m1.5.5.5.3.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.5.5.5.2" xref="S2.E4.m1.5.5.5.2.cmml">​</mo><mrow id="S2.E4.m1.5.5.5.4.2" xref="S2.E4.m1.5.5.5.cmml"><mo stretchy="false" id="S2.E4.m1.5.5.5.4.2.1" xref="S2.E4.m1.5.5.5.cmml">(</mo><mi id="S2.E4.m1.5.5.5.1" xref="S2.E4.m1.5.5.5.1.cmml">θ</mi><mo stretchy="false" id="S2.E4.m1.5.5.5.4.2.2" xref="S2.E4.m1.5.5.5.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.E4.m1.9.9.1.2" xref="S2.E4.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.9b"><apply id="S2.E4.m1.9.9.1.1.cmml" xref="S2.E4.m1.9.9.1"><and id="S2.E4.m1.9.9.1.1a.cmml" xref="S2.E4.m1.9.9.1"></and><apply id="S2.E4.m1.9.9.1.1b.cmml" xref="S2.E4.m1.9.9.1"><eq id="S2.E4.m1.9.9.1.1.3.cmml" xref="S2.E4.m1.9.9.1.1.3"></eq><apply id="S2.E4.m1.9.9.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.2"><times id="S2.E4.m1.9.9.1.1.2.1.cmml" xref="S2.E4.m1.9.9.1.1.2.1"></times><apply id="S2.E4.m1.9.9.1.1.2.2.cmml" xref="S2.E4.m1.9.9.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.2.2.1.cmml" xref="S2.E4.m1.9.9.1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.9.9.1.1.2.2.2.cmml" xref="S2.E4.m1.9.9.1.1.2.2.2">𝑝</ci><ci id="S2.E4.m1.9.9.1.1.2.2.3.cmml" xref="S2.E4.m1.9.9.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E4.m1.6.6.cmml" xref="S2.E4.m1.6.6">𝐱</ci></apply><apply id="S2.E4.m1.9.9.1.1.4.cmml" xref="S2.E4.m1.9.9.1.1.4"><apply id="S2.E4.m1.9.9.1.1.4.1.cmml" xref="S2.E4.m1.9.9.1.1.4.1"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.4.1.1.cmml" xref="S2.E4.m1.9.9.1.1.4.1">subscript</csymbol><sum id="S2.E4.m1.9.9.1.1.4.1.2.cmml" xref="S2.E4.m1.9.9.1.1.4.1.2"></sum><ci id="S2.E4.m1.9.9.1.1.4.1.3.cmml" xref="S2.E4.m1.9.9.1.1.4.1.3">𝑦</ci></apply><apply id="S2.E4.m1.9.9.1.1.4.2.cmml" xref="S2.E4.m1.9.9.1.1.4.2"><times id="S2.E4.m1.9.9.1.1.4.2.1.cmml" xref="S2.E4.m1.9.9.1.1.4.2.1"></times><apply id="S2.E4.m1.9.9.1.1.4.2.2.cmml" xref="S2.E4.m1.9.9.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.4.2.2.1.cmml" xref="S2.E4.m1.9.9.1.1.4.2.2">subscript</csymbol><ci id="S2.E4.m1.9.9.1.1.4.2.2.2.cmml" xref="S2.E4.m1.9.9.1.1.4.2.2.2">𝑝</ci><ci id="S2.E4.m1.9.9.1.1.4.2.2.3.cmml" xref="S2.E4.m1.9.9.1.1.4.2.2.3">𝜃</ci></apply><interval closure="open" id="S2.E4.m1.9.9.1.1.4.2.3.1.cmml" xref="S2.E4.m1.9.9.1.1.4.2.3.2"><ci id="S2.E4.m1.7.7.cmml" xref="S2.E4.m1.7.7">𝐱</ci><ci id="S2.E4.m1.8.8.cmml" xref="S2.E4.m1.8.8">𝑦</ci></interval></apply></apply></apply><apply id="S2.E4.m1.9.9.1.1c.cmml" xref="S2.E4.m1.9.9.1"><eq id="S2.E4.m1.9.9.1.1.5.cmml" xref="S2.E4.m1.9.9.1.1.5"></eq><share href="#S2.E4.m1.9.9.1.1.4.cmml" id="S2.E4.m1.9.9.1.1d.cmml" xref="S2.E4.m1.9.9.1"></share><apply id="S2.E4.m1.9.9.1.1.6.cmml" xref="S2.E4.m1.9.9.1.1.6"><apply id="S2.E4.m1.9.9.1.1.6.1.cmml" xref="S2.E4.m1.9.9.1.1.6.1"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.6.1.1.cmml" xref="S2.E4.m1.9.9.1.1.6.1">subscript</csymbol><sum id="S2.E4.m1.9.9.1.1.6.1.2.cmml" xref="S2.E4.m1.9.9.1.1.6.1.2"></sum><ci id="S2.E4.m1.9.9.1.1.6.1.3.cmml" xref="S2.E4.m1.9.9.1.1.6.1.3">𝑦</ci></apply><apply id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5"><divide id="S2.E4.m1.5.5.6.cmml" xref="S2.E4.m1.5.5"></divide><apply id="S2.E4.m1.4.4.4.5.cmml" xref="S2.E4.m1.4.4.4.4"><exp id="S2.E4.m1.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3"></exp><apply id="S2.E4.m1.4.4.4.4.1.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1"><divide id="S2.E4.m1.4.4.4.4.1.1.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1.1"></divide><apply id="S2.E4.m1.4.4.4.4.1.1.2.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2"><times id="S2.E4.m1.4.4.4.4.1.1.2.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.1"></times><apply id="S2.E4.m1.4.4.4.4.1.1.2.2.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.4.4.1.1.2.2.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.4.4.4.4.1.1.2.2.2.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.2.2">𝑓</ci><ci id="S2.E4.m1.4.4.4.4.1.1.2.2.3.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝐱</ci><apply id="S2.E4.m1.4.4.4.4.1.1.2.4.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.4.2"><csymbol cd="latexml" id="S2.E4.m1.4.4.4.4.1.1.2.4.1.1.cmml" xref="S2.E4.m1.4.4.4.4.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑦</ci></apply></apply><ci id="S2.E4.m1.4.4.4.4.1.1.3.cmml" xref="S2.E4.m1.4.4.4.4.1.1.3">𝑇</ci></apply></apply><apply id="S2.E4.m1.5.5.5.cmml" xref="S2.E4.m1.5.5.5"><times id="S2.E4.m1.5.5.5.2.cmml" xref="S2.E4.m1.5.5.5.2"></times><ci id="S2.E4.m1.5.5.5.3.cmml" xref="S2.E4.m1.5.5.5.3">𝑍</ci><ci id="S2.E4.m1.5.5.5.1.cmml" xref="S2.E4.m1.5.5.5.1">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.9c">p_{\theta}(\mathbf{x})=\sum_{y}p_{\theta}(\mathbf{x},y)=\sum_{y}\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{Z(\theta)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.10" class="ltx_p">which is precisely the definition of EBM.
This reinterpretation underscores the intrinsic compatibility between the softmax classifier and the EBM, offering a unified perspective on their shared principles.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Optimization</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.6" class="ltx_p">We employ a joint model, integrating an energy-based classifier and a generative model, wherein the EBM is trained to learn the energy function that best captures the data distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
The objective function is as following:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.4" class="ltx_Math" alttext="\log p_{\theta}(\mathbf{x},y)=\log p_{\theta}(y|\mathbf{x})+\log p_{\theta}(\mathbf{x})," display="block"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml"><mrow id="S2.E5.m1.4.4.1.1.3.2" xref="S2.E5.m1.4.4.1.1.3.2.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2.1" xref="S2.E5.m1.4.4.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E5.m1.4.4.1.1.3.2a" xref="S2.E5.m1.4.4.1.1.3.2.cmml">⁡</mo><msub id="S2.E5.m1.4.4.1.1.3.2.2" xref="S2.E5.m1.4.4.1.1.3.2.2.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2.2.2" xref="S2.E5.m1.4.4.1.1.3.2.2.2.cmml">p</mi><mi id="S2.E5.m1.4.4.1.1.3.2.2.3" xref="S2.E5.m1.4.4.1.1.3.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.1.1.3.1" xref="S2.E5.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S2.E5.m1.4.4.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.E5.m1.4.4.1.1.3.3.2.1" xref="S2.E5.m1.4.4.1.1.3.3.1.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝐱</mi><mo id="S2.E5.m1.4.4.1.1.3.3.2.2" xref="S2.E5.m1.4.4.1.1.3.3.1.cmml">,</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.E5.m1.4.4.1.1.3.3.2.3" xref="S2.E5.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.1.1.2" xref="S2.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.4.4.1.1.1" xref="S2.E5.m1.4.4.1.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.3.1" xref="S2.E5.m1.4.4.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E5.m1.4.4.1.1.1.1.3a" xref="S2.E5.m1.4.4.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E5.m1.4.4.1.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.3.2.2" xref="S2.E5.m1.4.4.1.1.1.1.3.2.2.cmml">p</mi><mi id="S2.E5.m1.4.4.1.1.1.1.3.2.3" xref="S2.E5.m1.4.4.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S2.E5.m1.4.4.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.3.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.3.2.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.2.1" xref="S2.E5.m1.4.4.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E5.m1.4.4.1.1.1.3.2a" xref="S2.E5.m1.4.4.1.1.1.3.2.cmml">⁡</mo><msub id="S2.E5.m1.4.4.1.1.1.3.2.2" xref="S2.E5.m1.4.4.1.1.1.3.2.2.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.2.2.2" xref="S2.E5.m1.4.4.1.1.1.3.2.2.2.cmml">p</mi><mi id="S2.E5.m1.4.4.1.1.1.3.2.2.3" xref="S2.E5.m1.4.4.1.1.1.3.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.1.1.1.3.1" xref="S2.E5.m1.4.4.1.1.1.3.1.cmml">​</mo><mrow id="S2.E5.m1.4.4.1.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.1.3.cmml"><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.3.3.2.1" xref="S2.E5.m1.4.4.1.1.1.3.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.3.3.2.2" xref="S2.E5.m1.4.4.1.1.1.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.4.4.1.2" xref="S2.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><eq id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2"></eq><apply id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"><times id="S2.E5.m1.4.4.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.1"></times><apply id="S2.E5.m1.4.4.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2"><log id="S2.E5.m1.4.4.1.1.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2.1"></log><apply id="S2.E5.m1.4.4.1.1.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.2">𝑝</ci><ci id="S2.E5.m1.4.4.1.1.3.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3">𝜃</ci></apply></apply><interval closure="open" id="S2.E5.m1.4.4.1.1.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.3.2"><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝐱</ci><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝑦</ci></interval></apply><apply id="S2.E5.m1.4.4.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1"><plus id="S2.E5.m1.4.4.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.2"></plus><apply id="S2.E5.m1.4.4.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1"><times id="S2.E5.m1.4.4.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.2"></times><apply id="S2.E5.m1.4.4.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3"><log id="S2.E5.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3.1"></log><apply id="S2.E5.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3.2.2">𝑝</ci><ci id="S2.E5.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.E5.m1.4.4.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3"><times id="S2.E5.m1.4.4.1.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.1"></times><apply id="S2.E5.m1.4.4.1.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2"><log id="S2.E5.m1.4.4.1.1.1.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2.1"></log><apply id="S2.E5.m1.4.4.1.1.1.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.3.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.1.3.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2.2.2">𝑝</ci><ci id="S2.E5.m1.4.4.1.1.1.3.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2.2.3">𝜃</ci></apply></apply><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\log p_{\theta}(\mathbf{x},y)=\log p_{\theta}(y|\mathbf{x})+\log p_{\theta}(\mathbf{x}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.2" class="ltx_p">which represents the logarithm of joint distribution of data and labels.
The conditional distribution <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="p_{\theta}(y|\mathbf{x})" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><msub id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml"><mi id="S2.SS3.p1.1.m1.1.1.3.2" xref="S2.SS3.p1.1.m1.1.1.3.2.cmml">p</mi><mi id="S2.SS3.p1.1.m1.1.1.3.3" xref="S2.SS3.p1.1.m1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.1.m1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.1.m1.1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.SS3.p1.1.m1.1.1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.p1.1.m1.1.1.1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><times id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2"></times><apply id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.3.1.cmml" xref="S2.SS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.3.2.cmml" xref="S2.SS3.p1.1.m1.1.1.3.2">𝑝</ci><ci id="S2.SS3.p1.1.m1.1.1.3.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S2.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">p_{\theta}(y|\mathbf{x})</annotation></semantics></math> signifies the softmax classification model, while <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="p_{\theta}(\mathbf{x})" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mrow id="S2.SS3.p1.2.m2.1.2" xref="S2.SS3.p1.2.m2.1.2.cmml"><msub id="S2.SS3.p1.2.m2.1.2.2" xref="S2.SS3.p1.2.m2.1.2.2.cmml"><mi id="S2.SS3.p1.2.m2.1.2.2.2" xref="S2.SS3.p1.2.m2.1.2.2.2.cmml">p</mi><mi id="S2.SS3.p1.2.m2.1.2.2.3" xref="S2.SS3.p1.2.m2.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.2.m2.1.2.1" xref="S2.SS3.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS3.p1.2.m2.1.2.3.2" xref="S2.SS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.2.m2.1.2.3.2.1" xref="S2.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS3.p1.2.m2.1.2.3.2.2" xref="S2.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.2.cmml" xref="S2.SS3.p1.2.m2.1.2"><times id="S2.SS3.p1.2.m2.1.2.1.cmml" xref="S2.SS3.p1.2.m2.1.2.1"></times><apply id="S2.SS3.p1.2.m2.1.2.2.cmml" xref="S2.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.2.2.1.cmml" xref="S2.SS3.p1.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.2.2.2.cmml" xref="S2.SS3.p1.2.m2.1.2.2.2">𝑝</ci><ci id="S2.SS3.p1.2.m2.1.2.2.3.cmml" xref="S2.SS3.p1.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">p_{\theta}(\mathbf{x})</annotation></semantics></math> captures the marginal data distribution. The loss function is then aligned with the logarithm of the likelihood, as explained in the following:
<span id="S2.SS3.p1.2.1" class="ltx_text" style="font-size:80%;"></span></p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex3.m1.2" class="ltx_Math" alttext="\displaystyle\log p_{\theta}(\mathbf{x},y)" display="inline"><semantics id="S2.Ex3.m1.2a"><mrow id="S2.Ex3.m1.2.3" xref="S2.Ex3.m1.2.3.cmml"><mrow id="S2.Ex3.m1.2.3.2" xref="S2.Ex3.m1.2.3.2.cmml"><mi mathsize="80%" id="S2.Ex3.m1.2.3.2.1" xref="S2.Ex3.m1.2.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex3.m1.2.3.2a" xref="S2.Ex3.m1.2.3.2.cmml">⁡</mo><msub id="S2.Ex3.m1.2.3.2.2" xref="S2.Ex3.m1.2.3.2.2.cmml"><mi mathsize="80%" id="S2.Ex3.m1.2.3.2.2.2" xref="S2.Ex3.m1.2.3.2.2.2.cmml">p</mi><mi mathsize="80%" id="S2.Ex3.m1.2.3.2.2.3" xref="S2.Ex3.m1.2.3.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.2.3.1" xref="S2.Ex3.m1.2.3.1.cmml">​</mo><mrow id="S2.Ex3.m1.2.3.3.2" xref="S2.Ex3.m1.2.3.3.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex3.m1.2.3.3.2.1" xref="S2.Ex3.m1.2.3.3.1.cmml">(</mo><mi mathsize="80%" id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">𝐱</mi><mo mathsize="80%" id="S2.Ex3.m1.2.3.3.2.2" xref="S2.Ex3.m1.2.3.3.1.cmml">,</mo><mi mathsize="80%" id="S2.Ex3.m1.2.2" xref="S2.Ex3.m1.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.Ex3.m1.2.3.3.2.3" xref="S2.Ex3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.2b"><apply id="S2.Ex3.m1.2.3.cmml" xref="S2.Ex3.m1.2.3"><times id="S2.Ex3.m1.2.3.1.cmml" xref="S2.Ex3.m1.2.3.1"></times><apply id="S2.Ex3.m1.2.3.2.cmml" xref="S2.Ex3.m1.2.3.2"><log id="S2.Ex3.m1.2.3.2.1.cmml" xref="S2.Ex3.m1.2.3.2.1"></log><apply id="S2.Ex3.m1.2.3.2.2.cmml" xref="S2.Ex3.m1.2.3.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.3.2.2.1.cmml" xref="S2.Ex3.m1.2.3.2.2">subscript</csymbol><ci id="S2.Ex3.m1.2.3.2.2.2.cmml" xref="S2.Ex3.m1.2.3.2.2.2">𝑝</ci><ci id="S2.Ex3.m1.2.3.2.2.3.cmml" xref="S2.Ex3.m1.2.3.2.2.3">𝜃</ci></apply></apply><interval closure="open" id="S2.Ex3.m1.2.3.3.1.cmml" xref="S2.Ex3.m1.2.3.3.2"><ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">𝐱</ci><ci id="S2.Ex3.m1.2.2.cmml" xref="S2.Ex3.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.2c">\displaystyle\log p_{\theta}(\mathbf{x},y)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex3.m2.2" class="ltx_Math" alttext="\displaystyle=\log p_{\theta}(y|\mathbf{x})+\log p_{\theta}(\mathbf{x})" display="inline"><semantics id="S2.Ex3.m2.2a"><mrow id="S2.Ex3.m2.2.2" xref="S2.Ex3.m2.2.2.cmml"><mi id="S2.Ex3.m2.2.2.3" xref="S2.Ex3.m2.2.2.3.cmml"></mi><mo mathsize="80%" id="S2.Ex3.m2.2.2.2" xref="S2.Ex3.m2.2.2.2.cmml">=</mo><mrow id="S2.Ex3.m2.2.2.1" xref="S2.Ex3.m2.2.2.1.cmml"><mrow id="S2.Ex3.m2.2.2.1.1" xref="S2.Ex3.m2.2.2.1.1.cmml"><mrow id="S2.Ex3.m2.2.2.1.1.3" xref="S2.Ex3.m2.2.2.1.1.3.cmml"><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.1.3.1" xref="S2.Ex3.m2.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex3.m2.2.2.1.1.3a" xref="S2.Ex3.m2.2.2.1.1.3.cmml">⁡</mo><msub id="S2.Ex3.m2.2.2.1.1.3.2" xref="S2.Ex3.m2.2.2.1.1.3.2.cmml"><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.1.3.2.2" xref="S2.Ex3.m2.2.2.1.1.3.2.2.cmml">p</mi><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.1.3.2.3" xref="S2.Ex3.m2.2.2.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex3.m2.2.2.1.1.2" xref="S2.Ex3.m2.2.2.1.1.2.cmml">​</mo><mrow id="S2.Ex3.m2.2.2.1.1.1.1" xref="S2.Ex3.m2.2.2.1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex3.m2.2.2.1.1.1.1.2" xref="S2.Ex3.m2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m2.2.2.1.1.1.1.1" xref="S2.Ex3.m2.2.2.1.1.1.1.1.cmml"><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.1.1.1.1.2" xref="S2.Ex3.m2.2.2.1.1.1.1.1.2.cmml">y</mi><mo fence="false" mathsize="80%" id="S2.Ex3.m2.2.2.1.1.1.1.1.1" xref="S2.Ex3.m2.2.2.1.1.1.1.1.1.cmml">|</mo><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.1.1.1.1.3" xref="S2.Ex3.m2.2.2.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo maxsize="80%" minsize="80%" id="S2.Ex3.m2.2.2.1.1.1.1.3" xref="S2.Ex3.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="80%" id="S2.Ex3.m2.2.2.1.2" xref="S2.Ex3.m2.2.2.1.2.cmml">+</mo><mrow id="S2.Ex3.m2.2.2.1.3" xref="S2.Ex3.m2.2.2.1.3.cmml"><mrow id="S2.Ex3.m2.2.2.1.3.2" xref="S2.Ex3.m2.2.2.1.3.2.cmml"><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.3.2.1" xref="S2.Ex3.m2.2.2.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex3.m2.2.2.1.3.2a" xref="S2.Ex3.m2.2.2.1.3.2.cmml">⁡</mo><msub id="S2.Ex3.m2.2.2.1.3.2.2" xref="S2.Ex3.m2.2.2.1.3.2.2.cmml"><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.3.2.2.2" xref="S2.Ex3.m2.2.2.1.3.2.2.2.cmml">p</mi><mi mathsize="80%" id="S2.Ex3.m2.2.2.1.3.2.2.3" xref="S2.Ex3.m2.2.2.1.3.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex3.m2.2.2.1.3.1" xref="S2.Ex3.m2.2.2.1.3.1.cmml">​</mo><mrow id="S2.Ex3.m2.2.2.1.3.3.2" xref="S2.Ex3.m2.2.2.1.3.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex3.m2.2.2.1.3.3.2.1" xref="S2.Ex3.m2.2.2.1.3.cmml">(</mo><mi mathsize="80%" id="S2.Ex3.m2.1.1" xref="S2.Ex3.m2.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.Ex3.m2.2.2.1.3.3.2.2" xref="S2.Ex3.m2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m2.2b"><apply id="S2.Ex3.m2.2.2.cmml" xref="S2.Ex3.m2.2.2"><eq id="S2.Ex3.m2.2.2.2.cmml" xref="S2.Ex3.m2.2.2.2"></eq><csymbol cd="latexml" id="S2.Ex3.m2.2.2.3.cmml" xref="S2.Ex3.m2.2.2.3">absent</csymbol><apply id="S2.Ex3.m2.2.2.1.cmml" xref="S2.Ex3.m2.2.2.1"><plus id="S2.Ex3.m2.2.2.1.2.cmml" xref="S2.Ex3.m2.2.2.1.2"></plus><apply id="S2.Ex3.m2.2.2.1.1.cmml" xref="S2.Ex3.m2.2.2.1.1"><times id="S2.Ex3.m2.2.2.1.1.2.cmml" xref="S2.Ex3.m2.2.2.1.1.2"></times><apply id="S2.Ex3.m2.2.2.1.1.3.cmml" xref="S2.Ex3.m2.2.2.1.1.3"><log id="S2.Ex3.m2.2.2.1.1.3.1.cmml" xref="S2.Ex3.m2.2.2.1.1.3.1"></log><apply id="S2.Ex3.m2.2.2.1.1.3.2.cmml" xref="S2.Ex3.m2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.2.2.1.1.3.2.1.cmml" xref="S2.Ex3.m2.2.2.1.1.3.2">subscript</csymbol><ci id="S2.Ex3.m2.2.2.1.1.3.2.2.cmml" xref="S2.Ex3.m2.2.2.1.1.3.2.2">𝑝</ci><ci id="S2.Ex3.m2.2.2.1.1.3.2.3.cmml" xref="S2.Ex3.m2.2.2.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.Ex3.m2.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m2.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex3.m2.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex3.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex3.m2.2.2.1.1.1.1.1.2">𝑦</ci><ci id="S2.Ex3.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex3.m2.2.2.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.Ex3.m2.2.2.1.3.cmml" xref="S2.Ex3.m2.2.2.1.3"><times id="S2.Ex3.m2.2.2.1.3.1.cmml" xref="S2.Ex3.m2.2.2.1.3.1"></times><apply id="S2.Ex3.m2.2.2.1.3.2.cmml" xref="S2.Ex3.m2.2.2.1.3.2"><log id="S2.Ex3.m2.2.2.1.3.2.1.cmml" xref="S2.Ex3.m2.2.2.1.3.2.1"></log><apply id="S2.Ex3.m2.2.2.1.3.2.2.cmml" xref="S2.Ex3.m2.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.2.2.1.3.2.2.1.cmml" xref="S2.Ex3.m2.2.2.1.3.2.2">subscript</csymbol><ci id="S2.Ex3.m2.2.2.1.3.2.2.2.cmml" xref="S2.Ex3.m2.2.2.1.3.2.2.2">𝑝</ci><ci id="S2.Ex3.m2.2.2.1.3.2.2.3.cmml" xref="S2.Ex3.m2.2.2.1.3.2.2.3">𝜃</ci></apply></apply><ci id="S2.Ex3.m2.1.1.cmml" xref="S2.Ex3.m2.1.1">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m2.2c">\displaystyle=\log p_{\theta}(y|\mathbf{x})+\log p_{\theta}(\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S2.E6.m1.1a"><mo mathsize="80%" id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><eq id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6.m2.13" class="ltx_Math" alttext="\displaystyle\log\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{\sum_{i}\exp(f_{\theta}(\mathbf{x})[i]/T)}+\log\sum_{y}\frac{\exp(f_{\theta}(\mathbf{x})[y])/T}{Z_{\theta}}." display="inline"><semantics id="S2.E6.m2.13a"><mrow id="S2.E6.m2.13.13.1" xref="S2.E6.m2.13.13.1.1.cmml"><mrow id="S2.E6.m2.13.13.1.1" xref="S2.E6.m2.13.13.1.1.cmml"><mrow id="S2.E6.m2.13.13.1.1.2" xref="S2.E6.m2.13.13.1.1.2.cmml"><mi mathsize="80%" id="S2.E6.m2.13.13.1.1.2.1" xref="S2.E6.m2.13.13.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E6.m2.13.13.1.1.2a" xref="S2.E6.m2.13.13.1.1.2.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E6.m2.8.8" xref="S2.E6.m2.8.8.cmml"><mfrac id="S2.E6.m2.8.8a" xref="S2.E6.m2.8.8.cmml"><mrow id="S2.E6.m2.4.4.4.4" xref="S2.E6.m2.4.4.4.5.cmml"><mi mathsize="80%" id="S2.E6.m2.3.3.3.3" xref="S2.E6.m2.3.3.3.3.cmml">exp</mi><mo id="S2.E6.m2.4.4.4.4a" xref="S2.E6.m2.4.4.4.5.cmml">⁡</mo><mrow id="S2.E6.m2.4.4.4.4.1" xref="S2.E6.m2.4.4.4.5.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.2" xref="S2.E6.m2.4.4.4.5.cmml">(</mo><mrow id="S2.E6.m2.4.4.4.4.1.1" xref="S2.E6.m2.4.4.4.4.1.1.cmml"><mrow id="S2.E6.m2.4.4.4.4.1.1.2" xref="S2.E6.m2.4.4.4.4.1.1.2.cmml"><msub id="S2.E6.m2.4.4.4.4.1.1.2.2" xref="S2.E6.m2.4.4.4.4.1.1.2.2.cmml"><mi mathsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.2.2" xref="S2.E6.m2.4.4.4.4.1.1.2.2.2.cmml">f</mi><mi mathsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.2.3" xref="S2.E6.m2.4.4.4.4.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E6.m2.4.4.4.4.1.1.2.1" xref="S2.E6.m2.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E6.m2.4.4.4.4.1.1.2.3.2" xref="S2.E6.m2.4.4.4.4.1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.3.2.1" xref="S2.E6.m2.4.4.4.4.1.1.2.cmml">(</mo><mi mathsize="80%" id="S2.E6.m2.1.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.3.2.2" xref="S2.E6.m2.4.4.4.4.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m2.4.4.4.4.1.1.2.1a" xref="S2.E6.m2.4.4.4.4.1.1.2.1.cmml">​</mo><mrow id="S2.E6.m2.4.4.4.4.1.1.2.4.2" xref="S2.E6.m2.4.4.4.4.1.1.2.4.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.4.2.1" xref="S2.E6.m2.4.4.4.4.1.1.2.4.1.1.cmml">[</mo><mi mathsize="80%" id="S2.E6.m2.2.2.2.2" xref="S2.E6.m2.2.2.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.1.2.4.2.2" xref="S2.E6.m2.4.4.4.4.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E6.m2.4.4.4.4.1.1.1" xref="S2.E6.m2.4.4.4.4.1.1.1.cmml">/</mo><mi mathsize="80%" id="S2.E6.m2.4.4.4.4.1.1.3" xref="S2.E6.m2.4.4.4.4.1.1.3.cmml">T</mi></mrow><mo maxsize="80%" minsize="80%" id="S2.E6.m2.4.4.4.4.1.3" xref="S2.E6.m2.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E6.m2.8.8.8" xref="S2.E6.m2.8.8.8.cmml"><msub id="S2.E6.m2.8.8.8.5" xref="S2.E6.m2.8.8.8.5.cmml"><mo maxsize="80%" minsize="80%" stretchy="true" id="S2.E6.m2.8.8.8.5.2" xref="S2.E6.m2.8.8.8.5.2.cmml">∑</mo><mi mathsize="80%" id="S2.E6.m2.8.8.8.5.3" xref="S2.E6.m2.8.8.8.5.3.cmml">i</mi></msub><mrow id="S2.E6.m2.8.8.8.4.1" xref="S2.E6.m2.8.8.8.4.2.cmml"><mi mathsize="80%" id="S2.E6.m2.7.7.7.3" xref="S2.E6.m2.7.7.7.3.cmml">exp</mi><mo id="S2.E6.m2.8.8.8.4.1a" xref="S2.E6.m2.8.8.8.4.2.cmml">⁡</mo><mrow id="S2.E6.m2.8.8.8.4.1.1" xref="S2.E6.m2.8.8.8.4.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.2" xref="S2.E6.m2.8.8.8.4.2.cmml">(</mo><mrow id="S2.E6.m2.8.8.8.4.1.1.1" xref="S2.E6.m2.8.8.8.4.1.1.1.cmml"><mrow id="S2.E6.m2.8.8.8.4.1.1.1.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.cmml"><msub id="S2.E6.m2.8.8.8.4.1.1.1.2.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2.cmml"><mi mathsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.2.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2.2.cmml">f</mi><mi mathsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.2.3" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E6.m2.8.8.8.4.1.1.1.2.1" xref="S2.E6.m2.8.8.8.4.1.1.1.2.1.cmml">​</mo><mrow id="S2.E6.m2.8.8.8.4.1.1.1.2.3.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.3.2.1" xref="S2.E6.m2.8.8.8.4.1.1.1.2.cmml">(</mo><mi mathsize="80%" id="S2.E6.m2.5.5.5.1" xref="S2.E6.m2.5.5.5.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.3.2.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m2.8.8.8.4.1.1.1.2.1a" xref="S2.E6.m2.8.8.8.4.1.1.1.2.1.cmml">​</mo><mrow id="S2.E6.m2.8.8.8.4.1.1.1.2.4.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.4.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.4.2.1" xref="S2.E6.m2.8.8.8.4.1.1.1.2.4.1.1.cmml">[</mo><mi mathsize="80%" id="S2.E6.m2.6.6.6.2" xref="S2.E6.m2.6.6.6.2.cmml">i</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.2.4.2.2" xref="S2.E6.m2.8.8.8.4.1.1.1.2.4.1.1.cmml">]</mo></mrow></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E6.m2.8.8.8.4.1.1.1.1" xref="S2.E6.m2.8.8.8.4.1.1.1.1.cmml">/</mo><mi mathsize="80%" id="S2.E6.m2.8.8.8.4.1.1.1.3" xref="S2.E6.m2.8.8.8.4.1.1.1.3.cmml">T</mi></mrow><mo maxsize="80%" minsize="80%" id="S2.E6.m2.8.8.8.4.1.1.3" xref="S2.E6.m2.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo mathsize="80%" id="S2.E6.m2.13.13.1.1.1" xref="S2.E6.m2.13.13.1.1.1.cmml">+</mo><mrow id="S2.E6.m2.13.13.1.1.3" xref="S2.E6.m2.13.13.1.1.3.cmml"><mi mathsize="80%" id="S2.E6.m2.13.13.1.1.3.2" xref="S2.E6.m2.13.13.1.1.3.2.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S2.E6.m2.13.13.1.1.3.1" xref="S2.E6.m2.13.13.1.1.3.1.cmml">​</mo><mrow id="S2.E6.m2.13.13.1.1.3.3" xref="S2.E6.m2.13.13.1.1.3.3.cmml"><mstyle displaystyle="true" id="S2.E6.m2.13.13.1.1.3.3.1" xref="S2.E6.m2.13.13.1.1.3.3.1.cmml"><munder id="S2.E6.m2.13.13.1.1.3.3.1a" xref="S2.E6.m2.13.13.1.1.3.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S2.E6.m2.13.13.1.1.3.3.1.2" xref="S2.E6.m2.13.13.1.1.3.3.1.2.cmml">∑</mo><mi mathsize="80%" id="S2.E6.m2.13.13.1.1.3.3.1.3" xref="S2.E6.m2.13.13.1.1.3.3.1.3.cmml">y</mi></munder></mstyle><mstyle displaystyle="true" id="S2.E6.m2.12.12" xref="S2.E6.m2.12.12.cmml"><mfrac id="S2.E6.m2.12.12a" xref="S2.E6.m2.12.12.cmml"><mrow id="S2.E6.m2.12.12.4" xref="S2.E6.m2.12.12.4.cmml"><mrow id="S2.E6.m2.12.12.4.4.1" xref="S2.E6.m2.12.12.4.4.2.cmml"><mi mathsize="80%" id="S2.E6.m2.11.11.3.3" xref="S2.E6.m2.11.11.3.3.cmml">exp</mi><mo id="S2.E6.m2.12.12.4.4.1a" xref="S2.E6.m2.12.12.4.4.2.cmml">⁡</mo><mrow id="S2.E6.m2.12.12.4.4.1.1" xref="S2.E6.m2.12.12.4.4.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.2" xref="S2.E6.m2.12.12.4.4.2.cmml">(</mo><mrow id="S2.E6.m2.12.12.4.4.1.1.1" xref="S2.E6.m2.12.12.4.4.1.1.1.cmml"><msub id="S2.E6.m2.12.12.4.4.1.1.1.2" xref="S2.E6.m2.12.12.4.4.1.1.1.2.cmml"><mi mathsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.2.2" xref="S2.E6.m2.12.12.4.4.1.1.1.2.2.cmml">f</mi><mi mathsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.2.3" xref="S2.E6.m2.12.12.4.4.1.1.1.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E6.m2.12.12.4.4.1.1.1.1" xref="S2.E6.m2.12.12.4.4.1.1.1.1.cmml">​</mo><mrow id="S2.E6.m2.12.12.4.4.1.1.1.3.2" xref="S2.E6.m2.12.12.4.4.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.3.2.1" xref="S2.E6.m2.12.12.4.4.1.1.1.cmml">(</mo><mi mathsize="80%" id="S2.E6.m2.9.9.1.1" xref="S2.E6.m2.9.9.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.3.2.2" xref="S2.E6.m2.12.12.4.4.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m2.12.12.4.4.1.1.1.1a" xref="S2.E6.m2.12.12.4.4.1.1.1.1.cmml">​</mo><mrow id="S2.E6.m2.12.12.4.4.1.1.1.4.2" xref="S2.E6.m2.12.12.4.4.1.1.1.4.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.4.2.1" xref="S2.E6.m2.12.12.4.4.1.1.1.4.1.1.cmml">[</mo><mi mathsize="80%" id="S2.E6.m2.10.10.2.2" xref="S2.E6.m2.10.10.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.1.4.2.2" xref="S2.E6.m2.12.12.4.4.1.1.1.4.1.1.cmml">]</mo></mrow></mrow><mo maxsize="80%" minsize="80%" id="S2.E6.m2.12.12.4.4.1.1.3" xref="S2.E6.m2.12.12.4.4.2.cmml">)</mo></mrow></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E6.m2.12.12.4.5" xref="S2.E6.m2.12.12.4.5.cmml">/</mo><mi mathsize="80%" id="S2.E6.m2.12.12.4.6" xref="S2.E6.m2.12.12.4.6.cmml">T</mi></mrow><msub id="S2.E6.m2.12.12.6" xref="S2.E6.m2.12.12.6.cmml"><mi mathsize="80%" id="S2.E6.m2.12.12.6.2" xref="S2.E6.m2.12.12.6.2.cmml">Z</mi><mi mathsize="80%" id="S2.E6.m2.12.12.6.3" xref="S2.E6.m2.12.12.6.3.cmml">θ</mi></msub></mfrac></mstyle></mrow></mrow></mrow><mo lspace="0em" mathsize="80%" id="S2.E6.m2.13.13.1.2" xref="S2.E6.m2.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.13b"><apply id="S2.E6.m2.13.13.1.1.cmml" xref="S2.E6.m2.13.13.1"><plus id="S2.E6.m2.13.13.1.1.1.cmml" xref="S2.E6.m2.13.13.1.1.1"></plus><apply id="S2.E6.m2.13.13.1.1.2.cmml" xref="S2.E6.m2.13.13.1.1.2"><log id="S2.E6.m2.13.13.1.1.2.1.cmml" xref="S2.E6.m2.13.13.1.1.2.1"></log><apply id="S2.E6.m2.8.8.cmml" xref="S2.E6.m2.8.8"><divide id="S2.E6.m2.8.8.9.cmml" xref="S2.E6.m2.8.8"></divide><apply id="S2.E6.m2.4.4.4.5.cmml" xref="S2.E6.m2.4.4.4.4"><exp id="S2.E6.m2.3.3.3.3.cmml" xref="S2.E6.m2.3.3.3.3"></exp><apply id="S2.E6.m2.4.4.4.4.1.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1"><divide id="S2.E6.m2.4.4.4.4.1.1.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1.1"></divide><apply id="S2.E6.m2.4.4.4.4.1.1.2.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2"><times id="S2.E6.m2.4.4.4.4.1.1.2.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.1"></times><apply id="S2.E6.m2.4.4.4.4.1.1.2.2.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E6.m2.4.4.4.4.1.1.2.2.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.2">subscript</csymbol><ci id="S2.E6.m2.4.4.4.4.1.1.2.2.2.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.2.2">𝑓</ci><ci id="S2.E6.m2.4.4.4.4.1.1.2.2.3.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E6.m2.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1">𝐱</ci><apply id="S2.E6.m2.4.4.4.4.1.1.2.4.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.4.2"><csymbol cd="latexml" id="S2.E6.m2.4.4.4.4.1.1.2.4.1.1.cmml" xref="S2.E6.m2.4.4.4.4.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.E6.m2.2.2.2.2.cmml" xref="S2.E6.m2.2.2.2.2">𝑦</ci></apply></apply><ci id="S2.E6.m2.4.4.4.4.1.1.3.cmml" xref="S2.E6.m2.4.4.4.4.1.1.3">𝑇</ci></apply></apply><apply id="S2.E6.m2.8.8.8.cmml" xref="S2.E6.m2.8.8.8"><apply id="S2.E6.m2.8.8.8.5.cmml" xref="S2.E6.m2.8.8.8.5"><csymbol cd="ambiguous" id="S2.E6.m2.8.8.8.5.1.cmml" xref="S2.E6.m2.8.8.8.5">subscript</csymbol><sum id="S2.E6.m2.8.8.8.5.2.cmml" xref="S2.E6.m2.8.8.8.5.2"></sum><ci id="S2.E6.m2.8.8.8.5.3.cmml" xref="S2.E6.m2.8.8.8.5.3">𝑖</ci></apply><apply id="S2.E6.m2.8.8.8.4.2.cmml" xref="S2.E6.m2.8.8.8.4.1"><exp id="S2.E6.m2.7.7.7.3.cmml" xref="S2.E6.m2.7.7.7.3"></exp><apply id="S2.E6.m2.8.8.8.4.1.1.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1"><divide id="S2.E6.m2.8.8.8.4.1.1.1.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.1"></divide><apply id="S2.E6.m2.8.8.8.4.1.1.1.2.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2"><times id="S2.E6.m2.8.8.8.4.1.1.1.2.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.1"></times><apply id="S2.E6.m2.8.8.8.4.1.1.1.2.2.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E6.m2.8.8.8.4.1.1.1.2.2.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2">subscript</csymbol><ci id="S2.E6.m2.8.8.8.4.1.1.1.2.2.2.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2.2">𝑓</ci><ci id="S2.E6.m2.8.8.8.4.1.1.1.2.2.3.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.2.3">𝜃</ci></apply><ci id="S2.E6.m2.5.5.5.1.cmml" xref="S2.E6.m2.5.5.5.1">𝐱</ci><apply id="S2.E6.m2.8.8.8.4.1.1.1.2.4.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.4.2"><csymbol cd="latexml" id="S2.E6.m2.8.8.8.4.1.1.1.2.4.1.1.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.E6.m2.6.6.6.2.cmml" xref="S2.E6.m2.6.6.6.2">𝑖</ci></apply></apply><ci id="S2.E6.m2.8.8.8.4.1.1.1.3.cmml" xref="S2.E6.m2.8.8.8.4.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply><apply id="S2.E6.m2.13.13.1.1.3.cmml" xref="S2.E6.m2.13.13.1.1.3"><times id="S2.E6.m2.13.13.1.1.3.1.cmml" xref="S2.E6.m2.13.13.1.1.3.1"></times><log id="S2.E6.m2.13.13.1.1.3.2.cmml" xref="S2.E6.m2.13.13.1.1.3.2"></log><apply id="S2.E6.m2.13.13.1.1.3.3.cmml" xref="S2.E6.m2.13.13.1.1.3.3"><apply id="S2.E6.m2.13.13.1.1.3.3.1.cmml" xref="S2.E6.m2.13.13.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E6.m2.13.13.1.1.3.3.1.1.cmml" xref="S2.E6.m2.13.13.1.1.3.3.1">subscript</csymbol><sum id="S2.E6.m2.13.13.1.1.3.3.1.2.cmml" xref="S2.E6.m2.13.13.1.1.3.3.1.2"></sum><ci id="S2.E6.m2.13.13.1.1.3.3.1.3.cmml" xref="S2.E6.m2.13.13.1.1.3.3.1.3">𝑦</ci></apply><apply id="S2.E6.m2.12.12.cmml" xref="S2.E6.m2.12.12"><divide id="S2.E6.m2.12.12.5.cmml" xref="S2.E6.m2.12.12"></divide><apply id="S2.E6.m2.12.12.4.cmml" xref="S2.E6.m2.12.12.4"><divide id="S2.E6.m2.12.12.4.5.cmml" xref="S2.E6.m2.12.12.4.5"></divide><apply id="S2.E6.m2.12.12.4.4.2.cmml" xref="S2.E6.m2.12.12.4.4.1"><exp id="S2.E6.m2.11.11.3.3.cmml" xref="S2.E6.m2.11.11.3.3"></exp><apply id="S2.E6.m2.12.12.4.4.1.1.1.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1"><times id="S2.E6.m2.12.12.4.4.1.1.1.1.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.1"></times><apply id="S2.E6.m2.12.12.4.4.1.1.1.2.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m2.12.12.4.4.1.1.1.2.1.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.2">subscript</csymbol><ci id="S2.E6.m2.12.12.4.4.1.1.1.2.2.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.2.2">𝑓</ci><ci id="S2.E6.m2.12.12.4.4.1.1.1.2.3.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.2.3">𝜃</ci></apply><ci id="S2.E6.m2.9.9.1.1.cmml" xref="S2.E6.m2.9.9.1.1">𝐱</ci><apply id="S2.E6.m2.12.12.4.4.1.1.1.4.1.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.4.2"><csymbol cd="latexml" id="S2.E6.m2.12.12.4.4.1.1.1.4.1.1.cmml" xref="S2.E6.m2.12.12.4.4.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S2.E6.m2.10.10.2.2.cmml" xref="S2.E6.m2.10.10.2.2">𝑦</ci></apply></apply></apply><ci id="S2.E6.m2.12.12.4.6.cmml" xref="S2.E6.m2.12.12.4.6">𝑇</ci></apply><apply id="S2.E6.m2.12.12.6.cmml" xref="S2.E6.m2.12.12.6"><csymbol cd="ambiguous" id="S2.E6.m2.12.12.6.1.cmml" xref="S2.E6.m2.12.12.6">subscript</csymbol><ci id="S2.E6.m2.12.12.6.2.cmml" xref="S2.E6.m2.12.12.6.2">𝑍</ci><ci id="S2.E6.m2.12.12.6.3.cmml" xref="S2.E6.m2.12.12.6.3">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.13c">\displaystyle\log\frac{\exp(f_{\theta}(\mathbf{x})[y]/T)}{\sum_{i}\exp(f_{\theta}(\mathbf{x})[i]/T)}+\log\sum_{y}\frac{\exp(f_{\theta}(\mathbf{x})[y])/T}{Z_{\theta}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.7" class="ltx_p">The derivative of the first term in the Eq.(<a href="#S2.Ex3" title="2.3 Optimization ‣ 2 Method ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>) is relatively straightforward, representing the loss function for training the classifier. The derivative of the second term is:
<span id="S2.SS3.p1.7.1" class="ltx_text" style="font-size:80%;"></span></p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}\log p(\mathbf{x})" display="inline"><semantics id="S2.Ex4.m1.1a"><mrow id="S2.Ex4.m1.1.2" xref="S2.Ex4.m1.1.2.cmml"><mrow id="S2.Ex4.m1.1.2.2" xref="S2.Ex4.m1.1.2.2.cmml"><mrow id="S2.Ex4.m1.1.2.2.1" xref="S2.Ex4.m1.1.2.2.1.cmml"><msub id="S2.Ex4.m1.1.2.2.1.1" xref="S2.Ex4.m1.1.2.2.1.1.cmml"><mo mathsize="80%" id="S2.Ex4.m1.1.2.2.1.1.2" xref="S2.Ex4.m1.1.2.2.1.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.Ex4.m1.1.2.2.1.1.3" xref="S2.Ex4.m1.1.2.2.1.1.3.cmml">θ</mi></msub><mi mathsize="80%" id="S2.Ex4.m1.1.2.2.1.2" xref="S2.Ex4.m1.1.2.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.Ex4.m1.1.2.2a" xref="S2.Ex4.m1.1.2.2.cmml">⁡</mo><mi mathsize="80%" id="S2.Ex4.m1.1.2.2.2" xref="S2.Ex4.m1.1.2.2.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.1.2.1" xref="S2.Ex4.m1.1.2.1.cmml">​</mo><mrow id="S2.Ex4.m1.1.2.3.2" xref="S2.Ex4.m1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex4.m1.1.2.3.2.1" xref="S2.Ex4.m1.1.2.cmml">(</mo><mi mathsize="80%" id="S2.Ex4.m1.1.1" xref="S2.Ex4.m1.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.Ex4.m1.1.2.3.2.2" xref="S2.Ex4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.1b"><apply id="S2.Ex4.m1.1.2.cmml" xref="S2.Ex4.m1.1.2"><times id="S2.Ex4.m1.1.2.1.cmml" xref="S2.Ex4.m1.1.2.1"></times><apply id="S2.Ex4.m1.1.2.2.cmml" xref="S2.Ex4.m1.1.2.2"><apply id="S2.Ex4.m1.1.2.2.1.cmml" xref="S2.Ex4.m1.1.2.2.1"><apply id="S2.Ex4.m1.1.2.2.1.1.cmml" xref="S2.Ex4.m1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex4.m1.1.2.2.1.1.1.cmml" xref="S2.Ex4.m1.1.2.2.1.1">subscript</csymbol><ci id="S2.Ex4.m1.1.2.2.1.1.2.cmml" xref="S2.Ex4.m1.1.2.2.1.1.2">∇</ci><ci id="S2.Ex4.m1.1.2.2.1.1.3.cmml" xref="S2.Ex4.m1.1.2.2.1.1.3">𝜃</ci></apply><log id="S2.Ex4.m1.1.2.2.1.2.cmml" xref="S2.Ex4.m1.1.2.2.1.2"></log></apply><ci id="S2.Ex4.m1.1.2.2.2.cmml" xref="S2.Ex4.m1.1.2.2.2">𝑝</ci></apply><ci id="S2.Ex4.m1.1.1.cmml" xref="S2.Ex4.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.1c">\displaystyle\nabla_{\theta}\log p(\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex5.m1.4" class="ltx_Math" alttext="\displaystyle=\nabla_{\theta}\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})-\nabla_{\theta}\log Z(\theta)" display="inline"><semantics id="S2.Ex5.m1.4a"><mrow id="S2.Ex5.m1.4.5" xref="S2.Ex5.m1.4.5.cmml"><mi id="S2.Ex5.m1.4.5.2" xref="S2.Ex5.m1.4.5.2.cmml"></mi><mo mathsize="80%" id="S2.Ex5.m1.4.5.1" xref="S2.Ex5.m1.4.5.1.cmml">=</mo><mrow id="S2.Ex5.m1.4.5.3" xref="S2.Ex5.m1.4.5.3.cmml"><mrow id="S2.Ex5.m1.4.5.3.2" xref="S2.Ex5.m1.4.5.3.2.cmml"><mrow id="S2.Ex5.m1.4.5.3.2.2" xref="S2.Ex5.m1.4.5.3.2.2.cmml"><msub id="S2.Ex5.m1.4.5.3.2.2.1" xref="S2.Ex5.m1.4.5.3.2.2.1.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.Ex5.m1.4.5.3.2.2.1.2" xref="S2.Ex5.m1.4.5.3.2.2.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.2.2.1.3" xref="S2.Ex5.m1.4.5.3.2.2.1.3.cmml">θ</mi></msub><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.2.2.2" xref="S2.Ex5.m1.4.5.3.2.2.2.cmml">log</mi></mrow><mo lspace="0.167em" rspace="0em" id="S2.Ex5.m1.4.5.3.2.1" xref="S2.Ex5.m1.4.5.3.2.1.cmml">​</mo><mrow id="S2.Ex5.m1.4.5.3.2.3" xref="S2.Ex5.m1.4.5.3.2.3.cmml"><mstyle displaystyle="true" id="S2.Ex5.m1.4.5.3.2.3.1" xref="S2.Ex5.m1.4.5.3.2.3.1.cmml"><munder id="S2.Ex5.m1.4.5.3.2.3.1a" xref="S2.Ex5.m1.4.5.3.2.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S2.Ex5.m1.4.5.3.2.3.1.2" xref="S2.Ex5.m1.4.5.3.2.3.1.2.cmml">∑</mo><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.2.3.1.3" xref="S2.Ex5.m1.4.5.3.2.3.1.3.cmml">y</mi></munder></mstyle><mrow id="S2.Ex5.m1.4.5.3.2.3.2.2" xref="S2.Ex5.m1.4.5.3.2.3.2.1.cmml"><mi mathsize="80%" id="S2.Ex5.m1.3.3" xref="S2.Ex5.m1.3.3.cmml">exp</mi><mo id="S2.Ex5.m1.4.5.3.2.3.2.2a" xref="S2.Ex5.m1.4.5.3.2.3.2.1.cmml">⁡</mo><mrow id="S2.Ex5.m1.4.5.3.2.3.2.2.1" xref="S2.Ex5.m1.4.5.3.2.3.2.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.4.5.3.2.3.2.2.1.1" xref="S2.Ex5.m1.4.5.3.2.3.2.1.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex5.m1.2.2" xref="S2.Ex5.m1.2.2.cmml"><mfrac id="S2.Ex5.m1.2.2a" xref="S2.Ex5.m1.2.2.cmml"><mrow id="S2.Ex5.m1.2.2.2" xref="S2.Ex5.m1.2.2.2.cmml"><msub id="S2.Ex5.m1.2.2.2.4" xref="S2.Ex5.m1.2.2.2.4.cmml"><mi mathsize="80%" id="S2.Ex5.m1.2.2.2.4.2" xref="S2.Ex5.m1.2.2.2.4.2.cmml">f</mi><mi mathsize="80%" id="S2.Ex5.m1.2.2.2.4.3" xref="S2.Ex5.m1.2.2.2.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex5.m1.2.2.2.3" xref="S2.Ex5.m1.2.2.2.3.cmml">​</mo><mrow id="S2.Ex5.m1.2.2.2.5.2" xref="S2.Ex5.m1.2.2.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.2.2.2.5.2.1" xref="S2.Ex5.m1.2.2.2.cmml">(</mo><mi mathsize="80%" id="S2.Ex5.m1.1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.2.2.2.5.2.2" xref="S2.Ex5.m1.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex5.m1.2.2.2.3a" xref="S2.Ex5.m1.2.2.2.3.cmml">​</mo><mrow id="S2.Ex5.m1.2.2.2.6.2" xref="S2.Ex5.m1.2.2.2.6.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.2.2.2.6.2.1" xref="S2.Ex5.m1.2.2.2.6.1.1.cmml">[</mo><mi mathsize="80%" id="S2.Ex5.m1.2.2.2.2" xref="S2.Ex5.m1.2.2.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.2.2.2.6.2.2" xref="S2.Ex5.m1.2.2.2.6.1.1.cmml">]</mo></mrow></mrow><mi mathsize="80%" id="S2.Ex5.m1.2.2.4" xref="S2.Ex5.m1.2.2.4.cmml">T</mi></mfrac></mstyle><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.4.5.3.2.3.2.2.1.2" xref="S2.Ex5.m1.4.5.3.2.3.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="80%" id="S2.Ex5.m1.4.5.3.1" xref="S2.Ex5.m1.4.5.3.1.cmml">−</mo><mrow id="S2.Ex5.m1.4.5.3.3" xref="S2.Ex5.m1.4.5.3.3.cmml"><mrow id="S2.Ex5.m1.4.5.3.3.2" xref="S2.Ex5.m1.4.5.3.3.2.cmml"><mrow id="S2.Ex5.m1.4.5.3.3.2.1" xref="S2.Ex5.m1.4.5.3.3.2.1.cmml"><msub id="S2.Ex5.m1.4.5.3.3.2.1.1" xref="S2.Ex5.m1.4.5.3.3.2.1.1.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.Ex5.m1.4.5.3.3.2.1.1.2" xref="S2.Ex5.m1.4.5.3.3.2.1.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.3.2.1.1.3" xref="S2.Ex5.m1.4.5.3.3.2.1.1.3.cmml">θ</mi></msub><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.3.2.1.2" xref="S2.Ex5.m1.4.5.3.3.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.Ex5.m1.4.5.3.3.2a" xref="S2.Ex5.m1.4.5.3.3.2.cmml">⁡</mo><mi mathsize="80%" id="S2.Ex5.m1.4.5.3.3.2.2" xref="S2.Ex5.m1.4.5.3.3.2.2.cmml">Z</mi></mrow><mo lspace="0em" rspace="0em" id="S2.Ex5.m1.4.5.3.3.1" xref="S2.Ex5.m1.4.5.3.3.1.cmml">​</mo><mrow id="S2.Ex5.m1.4.5.3.3.3.2" xref="S2.Ex5.m1.4.5.3.3.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.4.5.3.3.3.2.1" xref="S2.Ex5.m1.4.5.3.3.cmml">(</mo><mi mathsize="80%" id="S2.Ex5.m1.4.4" xref="S2.Ex5.m1.4.4.cmml">θ</mi><mo maxsize="80%" minsize="80%" id="S2.Ex5.m1.4.5.3.3.3.2.2" xref="S2.Ex5.m1.4.5.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.4b"><apply id="S2.Ex5.m1.4.5.cmml" xref="S2.Ex5.m1.4.5"><eq id="S2.Ex5.m1.4.5.1.cmml" xref="S2.Ex5.m1.4.5.1"></eq><csymbol cd="latexml" id="S2.Ex5.m1.4.5.2.cmml" xref="S2.Ex5.m1.4.5.2">absent</csymbol><apply id="S2.Ex5.m1.4.5.3.cmml" xref="S2.Ex5.m1.4.5.3"><minus id="S2.Ex5.m1.4.5.3.1.cmml" xref="S2.Ex5.m1.4.5.3.1"></minus><apply id="S2.Ex5.m1.4.5.3.2.cmml" xref="S2.Ex5.m1.4.5.3.2"><times id="S2.Ex5.m1.4.5.3.2.1.cmml" xref="S2.Ex5.m1.4.5.3.2.1"></times><apply id="S2.Ex5.m1.4.5.3.2.2.cmml" xref="S2.Ex5.m1.4.5.3.2.2"><apply id="S2.Ex5.m1.4.5.3.2.2.1.cmml" xref="S2.Ex5.m1.4.5.3.2.2.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.4.5.3.2.2.1.1.cmml" xref="S2.Ex5.m1.4.5.3.2.2.1">subscript</csymbol><ci id="S2.Ex5.m1.4.5.3.2.2.1.2.cmml" xref="S2.Ex5.m1.4.5.3.2.2.1.2">∇</ci><ci id="S2.Ex5.m1.4.5.3.2.2.1.3.cmml" xref="S2.Ex5.m1.4.5.3.2.2.1.3">𝜃</ci></apply><log id="S2.Ex5.m1.4.5.3.2.2.2.cmml" xref="S2.Ex5.m1.4.5.3.2.2.2"></log></apply><apply id="S2.Ex5.m1.4.5.3.2.3.cmml" xref="S2.Ex5.m1.4.5.3.2.3"><apply id="S2.Ex5.m1.4.5.3.2.3.1.cmml" xref="S2.Ex5.m1.4.5.3.2.3.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.4.5.3.2.3.1.1.cmml" xref="S2.Ex5.m1.4.5.3.2.3.1">subscript</csymbol><sum id="S2.Ex5.m1.4.5.3.2.3.1.2.cmml" xref="S2.Ex5.m1.4.5.3.2.3.1.2"></sum><ci id="S2.Ex5.m1.4.5.3.2.3.1.3.cmml" xref="S2.Ex5.m1.4.5.3.2.3.1.3">𝑦</ci></apply><apply id="S2.Ex5.m1.4.5.3.2.3.2.1.cmml" xref="S2.Ex5.m1.4.5.3.2.3.2.2"><exp id="S2.Ex5.m1.3.3.cmml" xref="S2.Ex5.m1.3.3"></exp><apply id="S2.Ex5.m1.2.2.cmml" xref="S2.Ex5.m1.2.2"><divide id="S2.Ex5.m1.2.2.3.cmml" xref="S2.Ex5.m1.2.2"></divide><apply id="S2.Ex5.m1.2.2.2.cmml" xref="S2.Ex5.m1.2.2.2"><times id="S2.Ex5.m1.2.2.2.3.cmml" xref="S2.Ex5.m1.2.2.2.3"></times><apply id="S2.Ex5.m1.2.2.2.4.cmml" xref="S2.Ex5.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.2.4.1.cmml" xref="S2.Ex5.m1.2.2.2.4">subscript</csymbol><ci id="S2.Ex5.m1.2.2.2.4.2.cmml" xref="S2.Ex5.m1.2.2.2.4.2">𝑓</ci><ci id="S2.Ex5.m1.2.2.2.4.3.cmml" xref="S2.Ex5.m1.2.2.2.4.3">𝜃</ci></apply><ci id="S2.Ex5.m1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1">𝐱</ci><apply id="S2.Ex5.m1.2.2.2.6.1.cmml" xref="S2.Ex5.m1.2.2.2.6.2"><csymbol cd="latexml" id="S2.Ex5.m1.2.2.2.6.1.1.cmml" xref="S2.Ex5.m1.2.2.2.6.2.1">delimited-[]</csymbol><ci id="S2.Ex5.m1.2.2.2.2.cmml" xref="S2.Ex5.m1.2.2.2.2">𝑦</ci></apply></apply><ci id="S2.Ex5.m1.2.2.4.cmml" xref="S2.Ex5.m1.2.2.4">𝑇</ci></apply></apply></apply></apply><apply id="S2.Ex5.m1.4.5.3.3.cmml" xref="S2.Ex5.m1.4.5.3.3"><times id="S2.Ex5.m1.4.5.3.3.1.cmml" xref="S2.Ex5.m1.4.5.3.3.1"></times><apply id="S2.Ex5.m1.4.5.3.3.2.cmml" xref="S2.Ex5.m1.4.5.3.3.2"><apply id="S2.Ex5.m1.4.5.3.3.2.1.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1"><apply id="S2.Ex5.m1.4.5.3.3.2.1.1.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.4.5.3.3.2.1.1.1.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1.1">subscript</csymbol><ci id="S2.Ex5.m1.4.5.3.3.2.1.1.2.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1.1.2">∇</ci><ci id="S2.Ex5.m1.4.5.3.3.2.1.1.3.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1.1.3">𝜃</ci></apply><log id="S2.Ex5.m1.4.5.3.3.2.1.2.cmml" xref="S2.Ex5.m1.4.5.3.3.2.1.2"></log></apply><ci id="S2.Ex5.m1.4.5.3.3.2.2.cmml" xref="S2.Ex5.m1.4.5.3.3.2.2">𝑍</ci></apply><ci id="S2.Ex5.m1.4.4.cmml" xref="S2.Ex5.m1.4.4">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.4c">\displaystyle=\nabla_{\theta}\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})-\nabla_{\theta}\log Z(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex6.m1.8" class="ltx_Math" alttext="\displaystyle=\nabla_{\theta}\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})-\mathbb{E}_{x\sim p_{\theta}(x)}[\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})]" display="inline"><semantics id="S2.Ex6.m1.8a"><mrow id="S2.Ex6.m1.8.8" xref="S2.Ex6.m1.8.8.cmml"><mi id="S2.Ex6.m1.8.8.3" xref="S2.Ex6.m1.8.8.3.cmml"></mi><mo mathsize="80%" id="S2.Ex6.m1.8.8.2" xref="S2.Ex6.m1.8.8.2.cmml">=</mo><mrow id="S2.Ex6.m1.8.8.1" xref="S2.Ex6.m1.8.8.1.cmml"><mrow id="S2.Ex6.m1.8.8.1.3" xref="S2.Ex6.m1.8.8.1.3.cmml"><mrow id="S2.Ex6.m1.8.8.1.3.2" xref="S2.Ex6.m1.8.8.1.3.2.cmml"><msub id="S2.Ex6.m1.8.8.1.3.2.1" xref="S2.Ex6.m1.8.8.1.3.2.1.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.Ex6.m1.8.8.1.3.2.1.2" xref="S2.Ex6.m1.8.8.1.3.2.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.3.2.1.3" xref="S2.Ex6.m1.8.8.1.3.2.1.3.cmml">θ</mi></msub><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.3.2.2" xref="S2.Ex6.m1.8.8.1.3.2.2.cmml">log</mi></mrow><mo lspace="0.167em" rspace="0em" id="S2.Ex6.m1.8.8.1.3.1" xref="S2.Ex6.m1.8.8.1.3.1.cmml">​</mo><mrow id="S2.Ex6.m1.8.8.1.3.3" xref="S2.Ex6.m1.8.8.1.3.3.cmml"><mstyle displaystyle="true" id="S2.Ex6.m1.8.8.1.3.3.1" xref="S2.Ex6.m1.8.8.1.3.3.1.cmml"><munder id="S2.Ex6.m1.8.8.1.3.3.1a" xref="S2.Ex6.m1.8.8.1.3.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S2.Ex6.m1.8.8.1.3.3.1.2" xref="S2.Ex6.m1.8.8.1.3.3.1.2.cmml">∑</mo><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.3.3.1.3" xref="S2.Ex6.m1.8.8.1.3.3.1.3.cmml">y</mi></munder></mstyle><mrow id="S2.Ex6.m1.8.8.1.3.3.2.2" xref="S2.Ex6.m1.8.8.1.3.3.2.1.cmml"><mi mathsize="80%" id="S2.Ex6.m1.6.6" xref="S2.Ex6.m1.6.6.cmml">exp</mi><mo id="S2.Ex6.m1.8.8.1.3.3.2.2a" xref="S2.Ex6.m1.8.8.1.3.3.2.1.cmml">⁡</mo><mrow id="S2.Ex6.m1.8.8.1.3.3.2.2.1" xref="S2.Ex6.m1.8.8.1.3.3.2.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.3.3.2.2.1.1" xref="S2.Ex6.m1.8.8.1.3.3.2.1.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex6.m1.2.2" xref="S2.Ex6.m1.2.2.cmml"><mfrac id="S2.Ex6.m1.2.2a" xref="S2.Ex6.m1.2.2.cmml"><mrow id="S2.Ex6.m1.2.2.2" xref="S2.Ex6.m1.2.2.2.cmml"><msub id="S2.Ex6.m1.2.2.2.4" xref="S2.Ex6.m1.2.2.2.4.cmml"><mi mathsize="80%" id="S2.Ex6.m1.2.2.2.4.2" xref="S2.Ex6.m1.2.2.2.4.2.cmml">f</mi><mi mathsize="80%" id="S2.Ex6.m1.2.2.2.4.3" xref="S2.Ex6.m1.2.2.2.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.2.2.2.3" xref="S2.Ex6.m1.2.2.2.3.cmml">​</mo><mrow id="S2.Ex6.m1.2.2.2.5.2" xref="S2.Ex6.m1.2.2.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.2.2.2.5.2.1" xref="S2.Ex6.m1.2.2.2.cmml">(</mo><mi mathsize="80%" id="S2.Ex6.m1.1.1.1.1" xref="S2.Ex6.m1.1.1.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.2.2.2.5.2.2" xref="S2.Ex6.m1.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.2.2.2.3a" xref="S2.Ex6.m1.2.2.2.3.cmml">​</mo><mrow id="S2.Ex6.m1.2.2.2.6.2" xref="S2.Ex6.m1.2.2.2.6.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.2.2.2.6.2.1" xref="S2.Ex6.m1.2.2.2.6.1.1.cmml">[</mo><mi mathsize="80%" id="S2.Ex6.m1.2.2.2.2" xref="S2.Ex6.m1.2.2.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.2.2.2.6.2.2" xref="S2.Ex6.m1.2.2.2.6.1.1.cmml">]</mo></mrow></mrow><mi mathsize="80%" id="S2.Ex6.m1.2.2.4" xref="S2.Ex6.m1.2.2.4.cmml">T</mi></mfrac></mstyle><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.3.3.2.2.1.2" xref="S2.Ex6.m1.8.8.1.3.3.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="80%" id="S2.Ex6.m1.8.8.1.2" xref="S2.Ex6.m1.8.8.1.2.cmml">−</mo><mrow id="S2.Ex6.m1.8.8.1.1" xref="S2.Ex6.m1.8.8.1.1.cmml"><msub id="S2.Ex6.m1.8.8.1.1.3" xref="S2.Ex6.m1.8.8.1.1.3.cmml"><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.1.3.2" xref="S2.Ex6.m1.8.8.1.1.3.2.cmml">𝔼</mi><mrow id="S2.Ex6.m1.3.3.1" xref="S2.Ex6.m1.3.3.1.cmml"><mi mathsize="80%" id="S2.Ex6.m1.3.3.1.3" xref="S2.Ex6.m1.3.3.1.3.cmml">x</mi><mo mathsize="80%" id="S2.Ex6.m1.3.3.1.2" xref="S2.Ex6.m1.3.3.1.2.cmml">∼</mo><mrow id="S2.Ex6.m1.3.3.1.4" xref="S2.Ex6.m1.3.3.1.4.cmml"><msub id="S2.Ex6.m1.3.3.1.4.2" xref="S2.Ex6.m1.3.3.1.4.2.cmml"><mi mathsize="80%" id="S2.Ex6.m1.3.3.1.4.2.2" xref="S2.Ex6.m1.3.3.1.4.2.2.cmml">p</mi><mi mathsize="80%" id="S2.Ex6.m1.3.3.1.4.2.3" xref="S2.Ex6.m1.3.3.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.3.3.1.4.1" xref="S2.Ex6.m1.3.3.1.4.1.cmml">​</mo><mrow id="S2.Ex6.m1.3.3.1.4.3.2" xref="S2.Ex6.m1.3.3.1.4.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.3.3.1.4.3.2.1" xref="S2.Ex6.m1.3.3.1.4.cmml">(</mo><mi mathsize="80%" id="S2.Ex6.m1.3.3.1.1" xref="S2.Ex6.m1.3.3.1.1.cmml">x</mi><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.3.3.1.4.3.2.2" xref="S2.Ex6.m1.3.3.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.8.8.1.1.2" xref="S2.Ex6.m1.8.8.1.1.2.cmml">​</mo><mrow id="S2.Ex6.m1.8.8.1.1.1.1" xref="S2.Ex6.m1.8.8.1.1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.2" xref="S2.Ex6.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex6.m1.8.8.1.1.1.1.1" xref="S2.Ex6.m1.8.8.1.1.1.1.1.cmml"><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.1.2" xref="S2.Ex6.m1.8.8.1.1.1.1.1.2.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S2.Ex6.m1.8.8.1.1.1.1.1.1" xref="S2.Ex6.m1.8.8.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.Ex6.m1.8.8.1.1.1.1.1.3" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.cmml"><munder id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1a" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.2" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.2.cmml">∑</mo><mi mathsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.3" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.3.cmml">y</mi></munder></mstyle><mrow id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml"><mi mathsize="80%" id="S2.Ex6.m1.7.7" xref="S2.Ex6.m1.7.7.cmml">exp</mi><mo id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2a" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml">⁡</mo><mrow id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2.1" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2.1.1" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex6.m1.5.5" xref="S2.Ex6.m1.5.5.cmml"><mfrac id="S2.Ex6.m1.5.5a" xref="S2.Ex6.m1.5.5.cmml"><mrow id="S2.Ex6.m1.5.5.2" xref="S2.Ex6.m1.5.5.2.cmml"><msub id="S2.Ex6.m1.5.5.2.4" xref="S2.Ex6.m1.5.5.2.4.cmml"><mi mathsize="80%" id="S2.Ex6.m1.5.5.2.4.2" xref="S2.Ex6.m1.5.5.2.4.2.cmml">f</mi><mi mathsize="80%" id="S2.Ex6.m1.5.5.2.4.3" xref="S2.Ex6.m1.5.5.2.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.5.5.2.3" xref="S2.Ex6.m1.5.5.2.3.cmml">​</mo><mrow id="S2.Ex6.m1.5.5.2.5.2" xref="S2.Ex6.m1.5.5.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.5.5.2.5.2.1" xref="S2.Ex6.m1.5.5.2.cmml">(</mo><mi mathsize="80%" id="S2.Ex6.m1.4.4.1.1" xref="S2.Ex6.m1.4.4.1.1.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.5.5.2.5.2.2" xref="S2.Ex6.m1.5.5.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.5.5.2.3a" xref="S2.Ex6.m1.5.5.2.3.cmml">​</mo><mrow id="S2.Ex6.m1.5.5.2.6.2" xref="S2.Ex6.m1.5.5.2.6.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.5.5.2.6.2.1" xref="S2.Ex6.m1.5.5.2.6.1.1.cmml">[</mo><mi mathsize="80%" id="S2.Ex6.m1.5.5.2.2" xref="S2.Ex6.m1.5.5.2.2.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.5.5.2.6.2.2" xref="S2.Ex6.m1.5.5.2.6.1.1.cmml">]</mo></mrow></mrow><mi mathsize="80%" id="S2.Ex6.m1.5.5.4" xref="S2.Ex6.m1.5.5.4.cmml">T</mi></mfrac></mstyle><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2.1.2" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo maxsize="80%" minsize="80%" id="S2.Ex6.m1.8.8.1.1.1.1.3" xref="S2.Ex6.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6.m1.8b"><apply id="S2.Ex6.m1.8.8.cmml" xref="S2.Ex6.m1.8.8"><eq id="S2.Ex6.m1.8.8.2.cmml" xref="S2.Ex6.m1.8.8.2"></eq><csymbol cd="latexml" id="S2.Ex6.m1.8.8.3.cmml" xref="S2.Ex6.m1.8.8.3">absent</csymbol><apply id="S2.Ex6.m1.8.8.1.cmml" xref="S2.Ex6.m1.8.8.1"><minus id="S2.Ex6.m1.8.8.1.2.cmml" xref="S2.Ex6.m1.8.8.1.2"></minus><apply id="S2.Ex6.m1.8.8.1.3.cmml" xref="S2.Ex6.m1.8.8.1.3"><times id="S2.Ex6.m1.8.8.1.3.1.cmml" xref="S2.Ex6.m1.8.8.1.3.1"></times><apply id="S2.Ex6.m1.8.8.1.3.2.cmml" xref="S2.Ex6.m1.8.8.1.3.2"><apply id="S2.Ex6.m1.8.8.1.3.2.1.cmml" xref="S2.Ex6.m1.8.8.1.3.2.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.8.8.1.3.2.1.1.cmml" xref="S2.Ex6.m1.8.8.1.3.2.1">subscript</csymbol><ci id="S2.Ex6.m1.8.8.1.3.2.1.2.cmml" xref="S2.Ex6.m1.8.8.1.3.2.1.2">∇</ci><ci id="S2.Ex6.m1.8.8.1.3.2.1.3.cmml" xref="S2.Ex6.m1.8.8.1.3.2.1.3">𝜃</ci></apply><log id="S2.Ex6.m1.8.8.1.3.2.2.cmml" xref="S2.Ex6.m1.8.8.1.3.2.2"></log></apply><apply id="S2.Ex6.m1.8.8.1.3.3.cmml" xref="S2.Ex6.m1.8.8.1.3.3"><apply id="S2.Ex6.m1.8.8.1.3.3.1.cmml" xref="S2.Ex6.m1.8.8.1.3.3.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.8.8.1.3.3.1.1.cmml" xref="S2.Ex6.m1.8.8.1.3.3.1">subscript</csymbol><sum id="S2.Ex6.m1.8.8.1.3.3.1.2.cmml" xref="S2.Ex6.m1.8.8.1.3.3.1.2"></sum><ci id="S2.Ex6.m1.8.8.1.3.3.1.3.cmml" xref="S2.Ex6.m1.8.8.1.3.3.1.3">𝑦</ci></apply><apply id="S2.Ex6.m1.8.8.1.3.3.2.1.cmml" xref="S2.Ex6.m1.8.8.1.3.3.2.2"><exp id="S2.Ex6.m1.6.6.cmml" xref="S2.Ex6.m1.6.6"></exp><apply id="S2.Ex6.m1.2.2.cmml" xref="S2.Ex6.m1.2.2"><divide id="S2.Ex6.m1.2.2.3.cmml" xref="S2.Ex6.m1.2.2"></divide><apply id="S2.Ex6.m1.2.2.2.cmml" xref="S2.Ex6.m1.2.2.2"><times id="S2.Ex6.m1.2.2.2.3.cmml" xref="S2.Ex6.m1.2.2.2.3"></times><apply id="S2.Ex6.m1.2.2.2.4.cmml" xref="S2.Ex6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.2.4.1.cmml" xref="S2.Ex6.m1.2.2.2.4">subscript</csymbol><ci id="S2.Ex6.m1.2.2.2.4.2.cmml" xref="S2.Ex6.m1.2.2.2.4.2">𝑓</ci><ci id="S2.Ex6.m1.2.2.2.4.3.cmml" xref="S2.Ex6.m1.2.2.2.4.3">𝜃</ci></apply><ci id="S2.Ex6.m1.1.1.1.1.cmml" xref="S2.Ex6.m1.1.1.1.1">𝐱</ci><apply id="S2.Ex6.m1.2.2.2.6.1.cmml" xref="S2.Ex6.m1.2.2.2.6.2"><csymbol cd="latexml" id="S2.Ex6.m1.2.2.2.6.1.1.cmml" xref="S2.Ex6.m1.2.2.2.6.2.1">delimited-[]</csymbol><ci id="S2.Ex6.m1.2.2.2.2.cmml" xref="S2.Ex6.m1.2.2.2.2">𝑦</ci></apply></apply><ci id="S2.Ex6.m1.2.2.4.cmml" xref="S2.Ex6.m1.2.2.4">𝑇</ci></apply></apply></apply></apply><apply id="S2.Ex6.m1.8.8.1.1.cmml" xref="S2.Ex6.m1.8.8.1.1"><times id="S2.Ex6.m1.8.8.1.1.2.cmml" xref="S2.Ex6.m1.8.8.1.1.2"></times><apply id="S2.Ex6.m1.8.8.1.1.3.cmml" xref="S2.Ex6.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.8.8.1.1.3.1.cmml" xref="S2.Ex6.m1.8.8.1.1.3">subscript</csymbol><ci id="S2.Ex6.m1.8.8.1.1.3.2.cmml" xref="S2.Ex6.m1.8.8.1.1.3.2">𝔼</ci><apply id="S2.Ex6.m1.3.3.1.cmml" xref="S2.Ex6.m1.3.3.1"><csymbol cd="latexml" id="S2.Ex6.m1.3.3.1.2.cmml" xref="S2.Ex6.m1.3.3.1.2">similar-to</csymbol><ci id="S2.Ex6.m1.3.3.1.3.cmml" xref="S2.Ex6.m1.3.3.1.3">𝑥</ci><apply id="S2.Ex6.m1.3.3.1.4.cmml" xref="S2.Ex6.m1.3.3.1.4"><times id="S2.Ex6.m1.3.3.1.4.1.cmml" xref="S2.Ex6.m1.3.3.1.4.1"></times><apply id="S2.Ex6.m1.3.3.1.4.2.cmml" xref="S2.Ex6.m1.3.3.1.4.2"><csymbol cd="ambiguous" id="S2.Ex6.m1.3.3.1.4.2.1.cmml" xref="S2.Ex6.m1.3.3.1.4.2">subscript</csymbol><ci id="S2.Ex6.m1.3.3.1.4.2.2.cmml" xref="S2.Ex6.m1.3.3.1.4.2.2">𝑝</ci><ci id="S2.Ex6.m1.3.3.1.4.2.3.cmml" xref="S2.Ex6.m1.3.3.1.4.2.3">𝜃</ci></apply><ci id="S2.Ex6.m1.3.3.1.1.cmml" xref="S2.Ex6.m1.3.3.1.1">𝑥</ci></apply></apply></apply><apply id="S2.Ex6.m1.8.8.1.1.1.2.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.8.8.1.1.1.2.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex6.m1.8.8.1.1.1.1.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1"><times id="S2.Ex6.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.1"></times><log id="S2.Ex6.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.2"></log><apply id="S2.Ex6.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3"><apply id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.2.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.2"></sum><ci id="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.3.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.1.3">𝑦</ci></apply><apply id="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex6.m1.8.8.1.1.1.1.1.3.2.2"><exp id="S2.Ex6.m1.7.7.cmml" xref="S2.Ex6.m1.7.7"></exp><apply id="S2.Ex6.m1.5.5.cmml" xref="S2.Ex6.m1.5.5"><divide id="S2.Ex6.m1.5.5.3.cmml" xref="S2.Ex6.m1.5.5"></divide><apply id="S2.Ex6.m1.5.5.2.cmml" xref="S2.Ex6.m1.5.5.2"><times id="S2.Ex6.m1.5.5.2.3.cmml" xref="S2.Ex6.m1.5.5.2.3"></times><apply id="S2.Ex6.m1.5.5.2.4.cmml" xref="S2.Ex6.m1.5.5.2.4"><csymbol cd="ambiguous" id="S2.Ex6.m1.5.5.2.4.1.cmml" xref="S2.Ex6.m1.5.5.2.4">subscript</csymbol><ci id="S2.Ex6.m1.5.5.2.4.2.cmml" xref="S2.Ex6.m1.5.5.2.4.2">𝑓</ci><ci id="S2.Ex6.m1.5.5.2.4.3.cmml" xref="S2.Ex6.m1.5.5.2.4.3">𝜃</ci></apply><ci id="S2.Ex6.m1.4.4.1.1.cmml" xref="S2.Ex6.m1.4.4.1.1">𝐱</ci><apply id="S2.Ex6.m1.5.5.2.6.1.cmml" xref="S2.Ex6.m1.5.5.2.6.2"><csymbol cd="latexml" id="S2.Ex6.m1.5.5.2.6.1.1.cmml" xref="S2.Ex6.m1.5.5.2.6.2.1">delimited-[]</csymbol><ci id="S2.Ex6.m1.5.5.2.2.cmml" xref="S2.Ex6.m1.5.5.2.2">𝑦</ci></apply></apply><ci id="S2.Ex6.m1.5.5.4.cmml" xref="S2.Ex6.m1.5.5.4">𝑇</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m1.8c">\displaystyle=\nabla_{\theta}\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})-\mathbb{E}_{x\sim p_{\theta}(x)}[\log\sum_{y}\exp(\frac{f_{\theta}(\mathbf{x})[y]}{T})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E7.m1.4" class="ltx_Math" alttext="\displaystyle=-\nabla_{\theta}E_{\theta}(\mathbf{x})+\mathbb{E}_{x\sim p_{\theta}(x)}[\nabla_{\theta}E_{\theta}(\mathbf{x})]." display="inline"><semantics id="S2.E7.m1.4a"><mrow id="S2.E7.m1.4.4.1" xref="S2.E7.m1.4.4.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1" xref="S2.E7.m1.4.4.1.1.cmml"><mi id="S2.E7.m1.4.4.1.1.3" xref="S2.E7.m1.4.4.1.1.3.cmml"></mi><mo mathsize="80%" id="S2.E7.m1.4.4.1.1.2" xref="S2.E7.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.4.4.1.1.1" xref="S2.E7.m1.4.4.1.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.3.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.E7.m1.4.4.1.1.1.3a" xref="S2.E7.m1.4.4.1.1.1.3.cmml">−</mo><mrow id="S2.E7.m1.4.4.1.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.3.2.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.3.2.2" xref="S2.E7.m1.4.4.1.1.1.3.2.2.cmml"><msub id="S2.E7.m1.4.4.1.1.1.3.2.2.1" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.E7.m1.4.4.1.1.1.3.2.2.1.2" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.3.2.2.1.3" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1.3.cmml">θ</mi></msub><msub id="S2.E7.m1.4.4.1.1.1.3.2.2.2" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2.cmml"><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.3.2.2.2.2" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2.2.cmml">E</mi><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.3.2.2.2.3" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.4.4.1.1.1.3.2.1" xref="S2.E7.m1.4.4.1.1.1.3.2.1.cmml">​</mo><mrow id="S2.E7.m1.4.4.1.1.1.3.2.3.2" xref="S2.E7.m1.4.4.1.1.1.3.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.3.2.3.2.1" xref="S2.E7.m1.4.4.1.1.1.3.2.cmml">(</mo><mi mathsize="80%" id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.3.2.3.2.2" xref="S2.E7.m1.4.4.1.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo mathsize="80%" id="S2.E7.m1.4.4.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S2.E7.m1.4.4.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.cmml"><msub id="S2.E7.m1.4.4.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml"><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml"><mi mathsize="80%" id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.1.1.1.3.cmml">x</mi><mo mathsize="80%" id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E7.m1.1.1.1.4" xref="S2.E7.m1.1.1.1.4.cmml"><msub id="S2.E7.m1.1.1.1.4.2" xref="S2.E7.m1.1.1.1.4.2.cmml"><mi mathsize="80%" id="S2.E7.m1.1.1.1.4.2.2" xref="S2.E7.m1.1.1.1.4.2.2.cmml">p</mi><mi mathsize="80%" id="S2.E7.m1.1.1.1.4.2.3" xref="S2.E7.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.4.1" xref="S2.E7.m1.1.1.1.4.1.cmml">​</mo><mrow id="S2.E7.m1.1.1.1.4.3.2" xref="S2.E7.m1.1.1.1.4.cmml"><mo maxsize="80%" minsize="80%" id="S2.E7.m1.1.1.1.4.3.2.1" xref="S2.E7.m1.1.1.1.4.cmml">(</mo><mi mathsize="80%" id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">x</mi><mo maxsize="80%" minsize="80%" id="S2.E7.m1.1.1.1.4.3.2.2" xref="S2.E7.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E7.m1.4.4.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.3.cmml">θ</mi></msub><msub id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml"><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">E</mi><mi mathsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi mathsize="80%" id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml">𝐱</mi><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="80%" minsize="80%" id="S2.E7.m1.4.4.1.1.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="80%" id="S2.E7.m1.4.4.1.2" xref="S2.E7.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.4b"><apply id="S2.E7.m1.4.4.1.1.cmml" xref="S2.E7.m1.4.4.1"><eq id="S2.E7.m1.4.4.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.3">absent</csymbol><apply id="S2.E7.m1.4.4.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1"><plus id="S2.E7.m1.4.4.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.2"></plus><apply id="S2.E7.m1.4.4.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.3"><minus id="S2.E7.m1.4.4.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.3"></minus><apply id="S2.E7.m1.4.4.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2"><times id="S2.E7.m1.4.4.1.1.1.3.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.1"></times><apply id="S2.E7.m1.4.4.1.1.1.3.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2"><apply id="S2.E7.m1.4.4.1.1.1.3.2.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.3.2.2.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.3.2.2.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1.2">∇</ci><ci id="S2.E7.m1.4.4.1.1.1.3.2.2.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.1.3">𝜃</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.3.2.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.3.2.2.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.3.2.2.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2.2">𝐸</ci><ci id="S2.E7.m1.4.4.1.1.1.3.2.2.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.3.2.2.2.3">𝜃</ci></apply></apply><ci id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2">𝐱</ci></apply></apply><apply id="S2.E7.m1.4.4.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1"><times id="S2.E7.m1.4.4.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.2"></times><apply id="S2.E7.m1.4.4.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.2">𝔼</ci><apply id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.2">similar-to</csymbol><ci id="S2.E7.m1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.3">𝑥</ci><apply id="S2.E7.m1.1.1.1.4.cmml" xref="S2.E7.m1.1.1.1.4"><times id="S2.E7.m1.1.1.1.4.1.cmml" xref="S2.E7.m1.1.1.1.4.1"></times><apply id="S2.E7.m1.1.1.1.4.2.cmml" xref="S2.E7.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.4.2.1.cmml" xref="S2.E7.m1.1.1.1.4.2">subscript</csymbol><ci id="S2.E7.m1.1.1.1.4.2.2.cmml" xref="S2.E7.m1.1.1.1.4.2.2">𝑝</ci><ci id="S2.E7.m1.1.1.1.4.2.3.cmml" xref="S2.E7.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">𝑥</ci></apply></apply></apply><apply id="S2.E7.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1"><times id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1"></times><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2"><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.2">∇</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.3">𝜃</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.2">𝐸</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.3">𝜃</ci></apply></apply><ci id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.4c">\displaystyle=-\nabla_{\theta}E_{\theta}(\mathbf{x})+\mathbb{E}_{x\sim p_{\theta}(x)}[\nabla_{\theta}E_{\theta}(\mathbf{x})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.5" class="ltx_p">By employing a one-sample Monte Carlo estimate <math id="S2.SS3.p1.3.m1.1" class="ltx_Math" alttext="\nabla_{\theta}\log Z_{\theta}\sim-\nabla_{\theta}E_{\theta}(\tilde{x})" display="inline"><semantics id="S2.SS3.p1.3.m1.1a"><mrow id="S2.SS3.p1.3.m1.1.2" xref="S2.SS3.p1.3.m1.1.2.cmml"><mrow id="S2.SS3.p1.3.m1.1.2.2" xref="S2.SS3.p1.3.m1.1.2.2.cmml"><mrow id="S2.SS3.p1.3.m1.1.2.2.1" xref="S2.SS3.p1.3.m1.1.2.2.1.cmml"><msub id="S2.SS3.p1.3.m1.1.2.2.1.1" xref="S2.SS3.p1.3.m1.1.2.2.1.1.cmml"><mo id="S2.SS3.p1.3.m1.1.2.2.1.1.2" xref="S2.SS3.p1.3.m1.1.2.2.1.1.2.cmml">∇</mo><mi id="S2.SS3.p1.3.m1.1.2.2.1.1.3" xref="S2.SS3.p1.3.m1.1.2.2.1.1.3.cmml">θ</mi></msub><mi id="S2.SS3.p1.3.m1.1.2.2.1.2" xref="S2.SS3.p1.3.m1.1.2.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.SS3.p1.3.m1.1.2.2a" xref="S2.SS3.p1.3.m1.1.2.2.cmml">⁡</mo><msub id="S2.SS3.p1.3.m1.1.2.2.2" xref="S2.SS3.p1.3.m1.1.2.2.2.cmml"><mi id="S2.SS3.p1.3.m1.1.2.2.2.2" xref="S2.SS3.p1.3.m1.1.2.2.2.2.cmml">Z</mi><mi id="S2.SS3.p1.3.m1.1.2.2.2.3" xref="S2.SS3.p1.3.m1.1.2.2.2.3.cmml">θ</mi></msub></mrow><mo id="S2.SS3.p1.3.m1.1.2.1" xref="S2.SS3.p1.3.m1.1.2.1.cmml">∼</mo><mrow id="S2.SS3.p1.3.m1.1.2.3" xref="S2.SS3.p1.3.m1.1.2.3.cmml"><mo rspace="0.167em" id="S2.SS3.p1.3.m1.1.2.3a" xref="S2.SS3.p1.3.m1.1.2.3.cmml">−</mo><mrow id="S2.SS3.p1.3.m1.1.2.3.2" xref="S2.SS3.p1.3.m1.1.2.3.2.cmml"><mrow id="S2.SS3.p1.3.m1.1.2.3.2.2" xref="S2.SS3.p1.3.m1.1.2.3.2.2.cmml"><msub id="S2.SS3.p1.3.m1.1.2.3.2.2.1" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1.cmml"><mo rspace="0.167em" id="S2.SS3.p1.3.m1.1.2.3.2.2.1.2" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1.2.cmml">∇</mo><mi id="S2.SS3.p1.3.m1.1.2.3.2.2.1.3" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1.3.cmml">θ</mi></msub><msub id="S2.SS3.p1.3.m1.1.2.3.2.2.2" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2.cmml"><mi id="S2.SS3.p1.3.m1.1.2.3.2.2.2.2" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2.2.cmml">E</mi><mi id="S2.SS3.p1.3.m1.1.2.3.2.2.2.3" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m1.1.2.3.2.1" xref="S2.SS3.p1.3.m1.1.2.3.2.1.cmml">​</mo><mrow id="S2.SS3.p1.3.m1.1.2.3.2.3.2" xref="S2.SS3.p1.3.m1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m1.1.2.3.2.3.2.1" xref="S2.SS3.p1.3.m1.1.1.cmml">(</mo><mover accent="true" id="S2.SS3.p1.3.m1.1.1" xref="S2.SS3.p1.3.m1.1.1.cmml"><mi id="S2.SS3.p1.3.m1.1.1.2" xref="S2.SS3.p1.3.m1.1.1.2.cmml">x</mi><mo id="S2.SS3.p1.3.m1.1.1.1" xref="S2.SS3.p1.3.m1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S2.SS3.p1.3.m1.1.2.3.2.3.2.2" xref="S2.SS3.p1.3.m1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m1.1b"><apply id="S2.SS3.p1.3.m1.1.2.cmml" xref="S2.SS3.p1.3.m1.1.2"><csymbol cd="latexml" id="S2.SS3.p1.3.m1.1.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.1">similar-to</csymbol><apply id="S2.SS3.p1.3.m1.1.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.2"><apply id="S2.SS3.p1.3.m1.1.2.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1"><apply id="S2.SS3.p1.3.m1.1.2.2.1.1.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.2.2.1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m1.1.2.2.1.1.2.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1.1.2">∇</ci><ci id="S2.SS3.p1.3.m1.1.2.2.1.1.3.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1.1.3">𝜃</ci></apply><log id="S2.SS3.p1.3.m1.1.2.2.1.2.cmml" xref="S2.SS3.p1.3.m1.1.2.2.1.2"></log></apply><apply id="S2.SS3.p1.3.m1.1.2.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.2.2.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.3.m1.1.2.2.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.2.2.2">𝑍</ci><ci id="S2.SS3.p1.3.m1.1.2.2.2.3.cmml" xref="S2.SS3.p1.3.m1.1.2.2.2.3">𝜃</ci></apply></apply><apply id="S2.SS3.p1.3.m1.1.2.3.cmml" xref="S2.SS3.p1.3.m1.1.2.3"><minus id="S2.SS3.p1.3.m1.1.2.3.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3"></minus><apply id="S2.SS3.p1.3.m1.1.2.3.2.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2"><times id="S2.SS3.p1.3.m1.1.2.3.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.1"></times><apply id="S2.SS3.p1.3.m1.1.2.3.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2"><apply id="S2.SS3.p1.3.m1.1.2.3.2.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.2.3.2.2.1.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1">subscript</csymbol><ci id="S2.SS3.p1.3.m1.1.2.3.2.2.1.2.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1.2">∇</ci><ci id="S2.SS3.p1.3.m1.1.2.3.2.2.1.3.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.1.3">𝜃</ci></apply><apply id="S2.SS3.p1.3.m1.1.2.3.2.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.2.3.2.2.2.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.3.m1.1.2.3.2.2.2.2.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2.2">𝐸</ci><ci id="S2.SS3.p1.3.m1.1.2.3.2.2.2.3.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.2.2.3">𝜃</ci></apply></apply><apply id="S2.SS3.p1.3.m1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.2.3.2.3.2"><ci id="S2.SS3.p1.3.m1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1.1">~</ci><ci id="S2.SS3.p1.3.m1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.1.1.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m1.1c">\nabla_{\theta}\log Z_{\theta}\sim-\nabla_{\theta}E_{\theta}(\tilde{x})</annotation></semantics></math>, where <math id="S2.SS3.p1.4.m2.1" class="ltx_Math" alttext="\tilde{x}" display="inline"><semantics id="S2.SS3.p1.4.m2.1a"><mover accent="true" id="S2.SS3.p1.4.m2.1.1" xref="S2.SS3.p1.4.m2.1.1.cmml"><mi id="S2.SS3.p1.4.m2.1.1.2" xref="S2.SS3.p1.4.m2.1.1.2.cmml">x</mi><mo id="S2.SS3.p1.4.m2.1.1.1" xref="S2.SS3.p1.4.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m2.1b"><apply id="S2.SS3.p1.4.m2.1.1.cmml" xref="S2.SS3.p1.4.m2.1.1"><ci id="S2.SS3.p1.4.m2.1.1.1.cmml" xref="S2.SS3.p1.4.m2.1.1.1">~</ci><ci id="S2.SS3.p1.4.m2.1.1.2.cmml" xref="S2.SS3.p1.4.m2.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m2.1c">\tilde{x}</annotation></semantics></math> is sampled from the EBM's distribution <math id="S2.SS3.p1.5.m3.1" class="ltx_Math" alttext="p_{\theta}(x)" display="inline"><semantics id="S2.SS3.p1.5.m3.1a"><mrow id="S2.SS3.p1.5.m3.1.2" xref="S2.SS3.p1.5.m3.1.2.cmml"><msub id="S2.SS3.p1.5.m3.1.2.2" xref="S2.SS3.p1.5.m3.1.2.2.cmml"><mi id="S2.SS3.p1.5.m3.1.2.2.2" xref="S2.SS3.p1.5.m3.1.2.2.2.cmml">p</mi><mi id="S2.SS3.p1.5.m3.1.2.2.3" xref="S2.SS3.p1.5.m3.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.5.m3.1.2.1" xref="S2.SS3.p1.5.m3.1.2.1.cmml">​</mo><mrow id="S2.SS3.p1.5.m3.1.2.3.2" xref="S2.SS3.p1.5.m3.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.5.m3.1.2.3.2.1" xref="S2.SS3.p1.5.m3.1.2.cmml">(</mo><mi id="S2.SS3.p1.5.m3.1.1" xref="S2.SS3.p1.5.m3.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS3.p1.5.m3.1.2.3.2.2" xref="S2.SS3.p1.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m3.1b"><apply id="S2.SS3.p1.5.m3.1.2.cmml" xref="S2.SS3.p1.5.m3.1.2"><times id="S2.SS3.p1.5.m3.1.2.1.cmml" xref="S2.SS3.p1.5.m3.1.2.1"></times><apply id="S2.SS3.p1.5.m3.1.2.2.cmml" xref="S2.SS3.p1.5.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m3.1.2.2.1.cmml" xref="S2.SS3.p1.5.m3.1.2.2">subscript</csymbol><ci id="S2.SS3.p1.5.m3.1.2.2.2.cmml" xref="S2.SS3.p1.5.m3.1.2.2.2">𝑝</ci><ci id="S2.SS3.p1.5.m3.1.2.2.3.cmml" xref="S2.SS3.p1.5.m3.1.2.2.3">𝜃</ci></apply><ci id="S2.SS3.p1.5.m3.1.1.cmml" xref="S2.SS3.p1.5.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m3.1c">p_{\theta}(x)</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>SGLD-Based Training Method</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.5" class="ltx_p">According to Eq. (<a href="#S2.Ex4" title="2.3 Optimization ‣ 2 Method ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>), we utilize Langevin MCMC for sampling from <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="p_{\theta}(\mathbf{x})" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><mrow id="S2.SS4.p1.1.m1.1.2" xref="S2.SS4.p1.1.m1.1.2.cmml"><msub id="S2.SS4.p1.1.m1.1.2.2" xref="S2.SS4.p1.1.m1.1.2.2.cmml"><mi id="S2.SS4.p1.1.m1.1.2.2.2" xref="S2.SS4.p1.1.m1.1.2.2.2.cmml">p</mi><mi id="S2.SS4.p1.1.m1.1.2.2.3" xref="S2.SS4.p1.1.m1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.1.2.1" xref="S2.SS4.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS4.p1.1.m1.1.2.3.2" xref="S2.SS4.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS4.p1.1.m1.1.2.3.2.1" xref="S2.SS4.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS4.p1.1.m1.1.2.3.2.2" xref="S2.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.2"><times id="S2.SS4.p1.1.m1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.1.2.1"></times><apply id="S2.SS4.p1.1.m1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.2.2.1.cmml" xref="S2.SS4.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.2.2.2.cmml" xref="S2.SS4.p1.1.m1.1.2.2.2">𝑝</ci><ci id="S2.SS4.p1.1.m1.1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.1.2.2.3">𝜃</ci></apply><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">p_{\theta}(\mathbf{x})</annotation></semantics></math> to train the EBMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Stochastic Gradient Langevin Dynamics (SGLD) is a dynamic optimization algorithm that combines the principles of stochastic gradient descent with Langevin dynamics. To initiate the Langevin sampling process, we begin by drawing an initial sample <math id="S2.SS4.p1.2.m2.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">x</mi><mn id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝑥</ci><cn type="integer" id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">x_{0}</annotation></semantics></math> from a straightforward prior distribution. Subsequently, we simulate an overdamped Langevin diffusion process for <math id="S2.SS4.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS4.p1.3.m3.1a"><mi id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><ci id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">K</annotation></semantics></math> steps, employing a positive step size <math id="S2.SS4.p1.4.m4.1" class="ltx_Math" alttext="\epsilon&gt;0" display="inline"><semantics id="S2.SS4.p1.4.m4.1a"><mrow id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml"><mi id="S2.SS4.p1.4.m4.1.1.2" xref="S2.SS4.p1.4.m4.1.1.2.cmml">ϵ</mi><mo id="S2.SS4.p1.4.m4.1.1.1" xref="S2.SS4.p1.4.m4.1.1.1.cmml">&gt;</mo><mn id="S2.SS4.p1.4.m4.1.1.3" xref="S2.SS4.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><apply id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1"><gt id="S2.SS4.p1.4.m4.1.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1.1"></gt><ci id="S2.SS4.p1.4.m4.1.1.2.cmml" xref="S2.SS4.p1.4.m4.1.1.2">italic-ϵ</ci><cn type="integer" id="S2.SS4.p1.4.m4.1.1.3.cmml" xref="S2.SS4.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">\epsilon&gt;0</annotation></semantics></math>. The iteration for each step <math id="S2.SS4.p1.5.m5.4" class="ltx_Math" alttext="k=0,1,\ldots,K-1" display="inline"><semantics id="S2.SS4.p1.5.m5.4a"><mrow id="S2.SS4.p1.5.m5.4.4" xref="S2.SS4.p1.5.m5.4.4.cmml"><mi id="S2.SS4.p1.5.m5.4.4.3" xref="S2.SS4.p1.5.m5.4.4.3.cmml">k</mi><mo id="S2.SS4.p1.5.m5.4.4.2" xref="S2.SS4.p1.5.m5.4.4.2.cmml">=</mo><mrow id="S2.SS4.p1.5.m5.4.4.1.1" xref="S2.SS4.p1.5.m5.4.4.1.2.cmml"><mn id="S2.SS4.p1.5.m5.1.1" xref="S2.SS4.p1.5.m5.1.1.cmml">0</mn><mo id="S2.SS4.p1.5.m5.4.4.1.1.2" xref="S2.SS4.p1.5.m5.4.4.1.2.cmml">,</mo><mn id="S2.SS4.p1.5.m5.2.2" xref="S2.SS4.p1.5.m5.2.2.cmml">1</mn><mo id="S2.SS4.p1.5.m5.4.4.1.1.3" xref="S2.SS4.p1.5.m5.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S2.SS4.p1.5.m5.3.3" xref="S2.SS4.p1.5.m5.3.3.cmml">…</mi><mo id="S2.SS4.p1.5.m5.4.4.1.1.4" xref="S2.SS4.p1.5.m5.4.4.1.2.cmml">,</mo><mrow id="S2.SS4.p1.5.m5.4.4.1.1.1" xref="S2.SS4.p1.5.m5.4.4.1.1.1.cmml"><mi id="S2.SS4.p1.5.m5.4.4.1.1.1.2" xref="S2.SS4.p1.5.m5.4.4.1.1.1.2.cmml">K</mi><mo id="S2.SS4.p1.5.m5.4.4.1.1.1.1" xref="S2.SS4.p1.5.m5.4.4.1.1.1.1.cmml">−</mo><mn id="S2.SS4.p1.5.m5.4.4.1.1.1.3" xref="S2.SS4.p1.5.m5.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m5.4b"><apply id="S2.SS4.p1.5.m5.4.4.cmml" xref="S2.SS4.p1.5.m5.4.4"><eq id="S2.SS4.p1.5.m5.4.4.2.cmml" xref="S2.SS4.p1.5.m5.4.4.2"></eq><ci id="S2.SS4.p1.5.m5.4.4.3.cmml" xref="S2.SS4.p1.5.m5.4.4.3">𝑘</ci><list id="S2.SS4.p1.5.m5.4.4.1.2.cmml" xref="S2.SS4.p1.5.m5.4.4.1.1"><cn type="integer" id="S2.SS4.p1.5.m5.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1">0</cn><cn type="integer" id="S2.SS4.p1.5.m5.2.2.cmml" xref="S2.SS4.p1.5.m5.2.2">1</cn><ci id="S2.SS4.p1.5.m5.3.3.cmml" xref="S2.SS4.p1.5.m5.3.3">…</ci><apply id="S2.SS4.p1.5.m5.4.4.1.1.1.cmml" xref="S2.SS4.p1.5.m5.4.4.1.1.1"><minus id="S2.SS4.p1.5.m5.4.4.1.1.1.1.cmml" xref="S2.SS4.p1.5.m5.4.4.1.1.1.1"></minus><ci id="S2.SS4.p1.5.m5.4.4.1.1.1.2.cmml" xref="S2.SS4.p1.5.m5.4.4.1.1.1.2">𝐾</ci><cn type="integer" id="S2.SS4.p1.5.m5.4.4.1.1.1.3.cmml" xref="S2.SS4.p1.5.m5.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m5.4c">k=0,1,\ldots,K-1</annotation></semantics></math> is expressed as:</p>
<table id="S4.EGx3" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S2.E8">
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex7.m1.1" class="ltx_Math" alttext="\displaystyle x_{k+1}" display="inline"><semantics id="S2.Ex7.m1.1a"><msub id="S2.Ex7.m1.1.1" xref="S2.Ex7.m1.1.1.cmml"><mi id="S2.Ex7.m1.1.1.2" xref="S2.Ex7.m1.1.1.2.cmml">x</mi><mrow id="S2.Ex7.m1.1.1.3" xref="S2.Ex7.m1.1.1.3.cmml"><mi id="S2.Ex7.m1.1.1.3.2" xref="S2.Ex7.m1.1.1.3.2.cmml">k</mi><mo id="S2.Ex7.m1.1.1.3.1" xref="S2.Ex7.m1.1.1.3.1.cmml">+</mo><mn id="S2.Ex7.m1.1.1.3.3" xref="S2.Ex7.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.Ex7.m1.1b"><apply id="S2.Ex7.m1.1.1.cmml" xref="S2.Ex7.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.1.1.1.cmml" xref="S2.Ex7.m1.1.1">subscript</csymbol><ci id="S2.Ex7.m1.1.1.2.cmml" xref="S2.Ex7.m1.1.1.2">𝑥</ci><apply id="S2.Ex7.m1.1.1.3.cmml" xref="S2.Ex7.m1.1.1.3"><plus id="S2.Ex7.m1.1.1.3.1.cmml" xref="S2.Ex7.m1.1.1.3.1"></plus><ci id="S2.Ex7.m1.1.1.3.2.cmml" xref="S2.Ex7.m1.1.1.3.2">𝑘</ci><cn type="integer" id="S2.Ex7.m1.1.1.3.3.cmml" xref="S2.Ex7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m1.1c">\displaystyle x_{k+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S2.Ex7.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S2.Ex7.m2.1a"><mo id="S2.Ex7.m2.1.1" xref="S2.Ex7.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.Ex7.m2.1b"><eq id="S2.Ex7.m2.1.1.cmml" xref="S2.Ex7.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex7.m3.1" class="ltx_Math" alttext="\displaystyle x_{k}+\frac{\epsilon^{2}}{2}\nabla_{x_{k}}\log p_{\theta}(x_{k})+\epsilon z_{k}" display="inline"><semantics id="S2.Ex7.m3.1a"><mrow id="S2.Ex7.m3.1.1" xref="S2.Ex7.m3.1.1.cmml"><msub id="S2.Ex7.m3.1.1.3" xref="S2.Ex7.m3.1.1.3.cmml"><mi id="S2.Ex7.m3.1.1.3.2" xref="S2.Ex7.m3.1.1.3.2.cmml">x</mi><mi id="S2.Ex7.m3.1.1.3.3" xref="S2.Ex7.m3.1.1.3.3.cmml">k</mi></msub><mo id="S2.Ex7.m3.1.1.2" xref="S2.Ex7.m3.1.1.2.cmml">+</mo><mrow id="S2.Ex7.m3.1.1.1" xref="S2.Ex7.m3.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex7.m3.1.1.1.3" xref="S2.Ex7.m3.1.1.1.3.cmml"><mfrac id="S2.Ex7.m3.1.1.1.3a" xref="S2.Ex7.m3.1.1.1.3.cmml"><msup id="S2.Ex7.m3.1.1.1.3.2" xref="S2.Ex7.m3.1.1.1.3.2.cmml"><mi id="S2.Ex7.m3.1.1.1.3.2.2" xref="S2.Ex7.m3.1.1.1.3.2.2.cmml">ϵ</mi><mn id="S2.Ex7.m3.1.1.1.3.2.3" xref="S2.Ex7.m3.1.1.1.3.2.3.cmml">2</mn></msup><mn id="S2.Ex7.m3.1.1.1.3.3" xref="S2.Ex7.m3.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S2.Ex7.m3.1.1.1.2" xref="S2.Ex7.m3.1.1.1.2.cmml">​</mo><mrow id="S2.Ex7.m3.1.1.1.4" xref="S2.Ex7.m3.1.1.1.4.cmml"><mrow id="S2.Ex7.m3.1.1.1.4.1" xref="S2.Ex7.m3.1.1.1.4.1.cmml"><msub id="S2.Ex7.m3.1.1.1.4.1.1" xref="S2.Ex7.m3.1.1.1.4.1.1.cmml"><mo rspace="0.167em" id="S2.Ex7.m3.1.1.1.4.1.1.2" xref="S2.Ex7.m3.1.1.1.4.1.1.2.cmml">∇</mo><msub id="S2.Ex7.m3.1.1.1.4.1.1.3" xref="S2.Ex7.m3.1.1.1.4.1.1.3.cmml"><mi id="S2.Ex7.m3.1.1.1.4.1.1.3.2" xref="S2.Ex7.m3.1.1.1.4.1.1.3.2.cmml">x</mi><mi id="S2.Ex7.m3.1.1.1.4.1.1.3.3" xref="S2.Ex7.m3.1.1.1.4.1.1.3.3.cmml">k</mi></msub></msub><mi id="S2.Ex7.m3.1.1.1.4.1.2" xref="S2.Ex7.m3.1.1.1.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.Ex7.m3.1.1.1.4a" xref="S2.Ex7.m3.1.1.1.4.cmml">⁡</mo><msub id="S2.Ex7.m3.1.1.1.4.2" xref="S2.Ex7.m3.1.1.1.4.2.cmml"><mi id="S2.Ex7.m3.1.1.1.4.2.2" xref="S2.Ex7.m3.1.1.1.4.2.2.cmml">p</mi><mi id="S2.Ex7.m3.1.1.1.4.2.3" xref="S2.Ex7.m3.1.1.1.4.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex7.m3.1.1.1.2a" xref="S2.Ex7.m3.1.1.1.2.cmml">​</mo><mrow id="S2.Ex7.m3.1.1.1.1.1" xref="S2.Ex7.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex7.m3.1.1.1.1.1.2" xref="S2.Ex7.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex7.m3.1.1.1.1.1.1" xref="S2.Ex7.m3.1.1.1.1.1.1.cmml"><mi id="S2.Ex7.m3.1.1.1.1.1.1.2" xref="S2.Ex7.m3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex7.m3.1.1.1.1.1.1.3" xref="S2.Ex7.m3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.Ex7.m3.1.1.1.1.1.3" xref="S2.Ex7.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex7.m3.1.1.2a" xref="S2.Ex7.m3.1.1.2.cmml">+</mo><mrow id="S2.Ex7.m3.1.1.4" xref="S2.Ex7.m3.1.1.4.cmml"><mi id="S2.Ex7.m3.1.1.4.2" xref="S2.Ex7.m3.1.1.4.2.cmml">ϵ</mi><mo lspace="0em" rspace="0em" id="S2.Ex7.m3.1.1.4.1" xref="S2.Ex7.m3.1.1.4.1.cmml">​</mo><msub id="S2.Ex7.m3.1.1.4.3" xref="S2.Ex7.m3.1.1.4.3.cmml"><mi id="S2.Ex7.m3.1.1.4.3.2" xref="S2.Ex7.m3.1.1.4.3.2.cmml">z</mi><mi id="S2.Ex7.m3.1.1.4.3.3" xref="S2.Ex7.m3.1.1.4.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7.m3.1b"><apply id="S2.Ex7.m3.1.1.cmml" xref="S2.Ex7.m3.1.1"><plus id="S2.Ex7.m3.1.1.2.cmml" xref="S2.Ex7.m3.1.1.2"></plus><apply id="S2.Ex7.m3.1.1.3.cmml" xref="S2.Ex7.m3.1.1.3"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.3.1.cmml" xref="S2.Ex7.m3.1.1.3">subscript</csymbol><ci id="S2.Ex7.m3.1.1.3.2.cmml" xref="S2.Ex7.m3.1.1.3.2">𝑥</ci><ci id="S2.Ex7.m3.1.1.3.3.cmml" xref="S2.Ex7.m3.1.1.3.3">𝑘</ci></apply><apply id="S2.Ex7.m3.1.1.1.cmml" xref="S2.Ex7.m3.1.1.1"><times id="S2.Ex7.m3.1.1.1.2.cmml" xref="S2.Ex7.m3.1.1.1.2"></times><apply id="S2.Ex7.m3.1.1.1.3.cmml" xref="S2.Ex7.m3.1.1.1.3"><divide id="S2.Ex7.m3.1.1.1.3.1.cmml" xref="S2.Ex7.m3.1.1.1.3"></divide><apply id="S2.Ex7.m3.1.1.1.3.2.cmml" xref="S2.Ex7.m3.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.1.3.2.1.cmml" xref="S2.Ex7.m3.1.1.1.3.2">superscript</csymbol><ci id="S2.Ex7.m3.1.1.1.3.2.2.cmml" xref="S2.Ex7.m3.1.1.1.3.2.2">italic-ϵ</ci><cn type="integer" id="S2.Ex7.m3.1.1.1.3.2.3.cmml" xref="S2.Ex7.m3.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.Ex7.m3.1.1.1.3.3.cmml" xref="S2.Ex7.m3.1.1.1.3.3">2</cn></apply><apply id="S2.Ex7.m3.1.1.1.4.cmml" xref="S2.Ex7.m3.1.1.1.4"><apply id="S2.Ex7.m3.1.1.1.4.1.cmml" xref="S2.Ex7.m3.1.1.1.4.1"><apply id="S2.Ex7.m3.1.1.1.4.1.1.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.1.4.1.1.1.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1">subscript</csymbol><ci id="S2.Ex7.m3.1.1.1.4.1.1.2.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1.2">∇</ci><apply id="S2.Ex7.m3.1.1.1.4.1.1.3.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1.3"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.1.4.1.1.3.1.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1.3">subscript</csymbol><ci id="S2.Ex7.m3.1.1.1.4.1.1.3.2.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1.3.2">𝑥</ci><ci id="S2.Ex7.m3.1.1.1.4.1.1.3.3.cmml" xref="S2.Ex7.m3.1.1.1.4.1.1.3.3">𝑘</ci></apply></apply><log id="S2.Ex7.m3.1.1.1.4.1.2.cmml" xref="S2.Ex7.m3.1.1.1.4.1.2"></log></apply><apply id="S2.Ex7.m3.1.1.1.4.2.cmml" xref="S2.Ex7.m3.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.1.4.2.1.cmml" xref="S2.Ex7.m3.1.1.1.4.2">subscript</csymbol><ci id="S2.Ex7.m3.1.1.1.4.2.2.cmml" xref="S2.Ex7.m3.1.1.1.4.2.2">𝑝</ci><ci id="S2.Ex7.m3.1.1.1.4.2.3.cmml" xref="S2.Ex7.m3.1.1.1.4.2.3">𝜃</ci></apply></apply><apply id="S2.Ex7.m3.1.1.1.1.1.1.cmml" xref="S2.Ex7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex7.m3.1.1.1.1.1.1.2.cmml" xref="S2.Ex7.m3.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex7.m3.1.1.1.1.1.1.3.cmml" xref="S2.Ex7.m3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S2.Ex7.m3.1.1.4.cmml" xref="S2.Ex7.m3.1.1.4"><times id="S2.Ex7.m3.1.1.4.1.cmml" xref="S2.Ex7.m3.1.1.4.1"></times><ci id="S2.Ex7.m3.1.1.4.2.cmml" xref="S2.Ex7.m3.1.1.4.2">italic-ϵ</ci><apply id="S2.Ex7.m3.1.1.4.3.cmml" xref="S2.Ex7.m3.1.1.4.3"><csymbol cd="ambiguous" id="S2.Ex7.m3.1.1.4.3.1.cmml" xref="S2.Ex7.m3.1.1.4.3">subscript</csymbol><ci id="S2.Ex7.m3.1.1.4.3.2.cmml" xref="S2.Ex7.m3.1.1.4.3.2">𝑧</ci><ci id="S2.Ex7.m3.1.1.4.3.3.cmml" xref="S2.Ex7.m3.1.1.4.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m3.1c">\displaystyle x_{k}+\frac{\epsilon^{2}}{2}\nabla_{x_{k}}\log p_{\theta}(x_{k})+\epsilon z_{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S2.E8.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S2.E8.m1.1a"><mo id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><eq id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8.m2.1" class="ltx_Math" alttext="\displaystyle x_{k}-\frac{\epsilon^{2}}{2}\nabla_{x_{k}}E_{\theta}(x_{k})+\epsilon z_{k}," display="inline"><semantics id="S2.E8.m2.1a"><mrow id="S2.E8.m2.1.1.1" xref="S2.E8.m2.1.1.1.1.cmml"><mrow id="S2.E8.m2.1.1.1.1" xref="S2.E8.m2.1.1.1.1.cmml"><mrow id="S2.E8.m2.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.cmml"><msub id="S2.E8.m2.1.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.1.3.cmml"><mi id="S2.E8.m2.1.1.1.1.1.3.2" xref="S2.E8.m2.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E8.m2.1.1.1.1.1.3.3" xref="S2.E8.m2.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S2.E8.m2.1.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E8.m2.1.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E8.m2.1.1.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.1.1.3.cmml"><mfrac id="S2.E8.m2.1.1.1.1.1.1.3a" xref="S2.E8.m2.1.1.1.1.1.1.3.cmml"><msup id="S2.E8.m2.1.1.1.1.1.1.3.2" xref="S2.E8.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E8.m2.1.1.1.1.1.1.3.2.2" xref="S2.E8.m2.1.1.1.1.1.1.3.2.2.cmml">ϵ</mi><mn id="S2.E8.m2.1.1.1.1.1.1.3.2.3" xref="S2.E8.m2.1.1.1.1.1.1.3.2.3.cmml">2</mn></msup><mn id="S2.E8.m2.1.1.1.1.1.1.3.3" xref="S2.E8.m2.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S2.E8.m2.1.1.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E8.m2.1.1.1.1.1.1.4" xref="S2.E8.m2.1.1.1.1.1.1.4.cmml"><msub id="S2.E8.m2.1.1.1.1.1.1.4.1" xref="S2.E8.m2.1.1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S2.E8.m2.1.1.1.1.1.1.4.1.2" xref="S2.E8.m2.1.1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="S2.E8.m2.1.1.1.1.1.1.4.1.3" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3.cmml"><mi id="S2.E8.m2.1.1.1.1.1.1.4.1.3.2" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3.2.cmml">x</mi><mi id="S2.E8.m2.1.1.1.1.1.1.4.1.3.3" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3.3.cmml">k</mi></msub></msub><msub id="S2.E8.m2.1.1.1.1.1.1.4.2" xref="S2.E8.m2.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E8.m2.1.1.1.1.1.1.4.2.2" xref="S2.E8.m2.1.1.1.1.1.1.4.2.2.cmml">E</mi><mi id="S2.E8.m2.1.1.1.1.1.1.4.2.3" xref="S2.E8.m2.1.1.1.1.1.1.4.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E8.m2.1.1.1.1.1.1.2a" xref="S2.E8.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E8.m2.1.1.1.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E8.m2.1.1.1.1.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E8.m2.1.1.1.1.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E8.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E8.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E8.m2.1.1.1.1.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E8.m2.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.2.cmml">+</mo><mrow id="S2.E8.m2.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.3.cmml"><mi id="S2.E8.m2.1.1.1.1.3.2" xref="S2.E8.m2.1.1.1.1.3.2.cmml">ϵ</mi><mo lspace="0em" rspace="0em" id="S2.E8.m2.1.1.1.1.3.1" xref="S2.E8.m2.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E8.m2.1.1.1.1.3.3" xref="S2.E8.m2.1.1.1.1.3.3.cmml"><mi id="S2.E8.m2.1.1.1.1.3.3.2" xref="S2.E8.m2.1.1.1.1.3.3.2.cmml">z</mi><mi id="S2.E8.m2.1.1.1.1.3.3.3" xref="S2.E8.m2.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S2.E8.m2.1.1.1.2" xref="S2.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m2.1b"><apply id="S2.E8.m2.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1"><plus id="S2.E8.m2.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.2"></plus><apply id="S2.E8.m2.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1"><minus id="S2.E8.m2.1.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.1.2"></minus><apply id="S2.E8.m2.1.1.1.1.1.3.cmml" xref="S2.E8.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.3.1.cmml" xref="S2.E8.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.3.2.cmml" xref="S2.E8.m2.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E8.m2.1.1.1.1.1.3.3.cmml" xref="S2.E8.m2.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S2.E8.m2.1.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1"><times id="S2.E8.m2.1.1.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.2"></times><apply id="S2.E8.m2.1.1.1.1.1.1.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3"><divide id="S2.E8.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3"></divide><apply id="S2.E8.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3.2.2">italic-ϵ</ci><cn type="integer" id="S2.E8.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.E8.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.E8.m2.1.1.1.1.1.1.4.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4"><apply id="S2.E8.m2.1.1.1.1.1.1.4.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.1.4.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.1.4.1.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1.2">∇</ci><apply id="S2.E8.m2.1.1.1.1.1.1.4.1.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.1.4.1.3.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.1.4.1.3.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3.2">𝑥</ci><ci id="S2.E8.m2.1.1.1.1.1.1.4.1.3.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.1.3.3">𝑘</ci></apply></apply><apply id="S2.E8.m2.1.1.1.1.1.1.4.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.2.2">𝐸</ci><ci id="S2.E8.m2.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.4.2.3">𝜃</ci></apply></apply><apply id="S2.E8.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E8.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.E8.m2.1.1.1.1.3.cmml" xref="S2.E8.m2.1.1.1.1.3"><times id="S2.E8.m2.1.1.1.1.3.1.cmml" xref="S2.E8.m2.1.1.1.1.3.1"></times><ci id="S2.E8.m2.1.1.1.1.3.2.cmml" xref="S2.E8.m2.1.1.1.1.3.2">italic-ϵ</ci><apply id="S2.E8.m2.1.1.1.1.3.3.cmml" xref="S2.E8.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.3.3.1.cmml" xref="S2.E8.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.3.3.2.cmml" xref="S2.E8.m2.1.1.1.1.3.3.2">𝑧</ci><ci id="S2.E8.m2.1.1.1.1.3.3.3.cmml" xref="S2.E8.m2.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m2.1c">\displaystyle x_{k}-\frac{\epsilon^{2}}{2}\nabla_{x_{k}}E_{\theta}(x_{k})+\epsilon z_{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p1.12" class="ltx_p">where <math id="S2.SS4.p1.6.m1.1" class="ltx_Math" alttext="\nabla_{x_{k}}\log p_{\theta}(x_{k})" display="inline"><semantics id="S2.SS4.p1.6.m1.1a"><mrow id="S2.SS4.p1.6.m1.1.1" xref="S2.SS4.p1.6.m1.1.1.cmml"><mrow id="S2.SS4.p1.6.m1.1.1.3" xref="S2.SS4.p1.6.m1.1.1.3.cmml"><mrow id="S2.SS4.p1.6.m1.1.1.3.1" xref="S2.SS4.p1.6.m1.1.1.3.1.cmml"><msub id="S2.SS4.p1.6.m1.1.1.3.1.1" xref="S2.SS4.p1.6.m1.1.1.3.1.1.cmml"><mo id="S2.SS4.p1.6.m1.1.1.3.1.1.2" xref="S2.SS4.p1.6.m1.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.SS4.p1.6.m1.1.1.3.1.1.3" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3.cmml"><mi id="S2.SS4.p1.6.m1.1.1.3.1.1.3.2" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3.2.cmml">x</mi><mi id="S2.SS4.p1.6.m1.1.1.3.1.1.3.3" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3.3.cmml">k</mi></msub></msub><mi id="S2.SS4.p1.6.m1.1.1.3.1.2" xref="S2.SS4.p1.6.m1.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.SS4.p1.6.m1.1.1.3a" xref="S2.SS4.p1.6.m1.1.1.3.cmml">⁡</mo><msub id="S2.SS4.p1.6.m1.1.1.3.2" xref="S2.SS4.p1.6.m1.1.1.3.2.cmml"><mi id="S2.SS4.p1.6.m1.1.1.3.2.2" xref="S2.SS4.p1.6.m1.1.1.3.2.2.cmml">p</mi><mi id="S2.SS4.p1.6.m1.1.1.3.2.3" xref="S2.SS4.p1.6.m1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS4.p1.6.m1.1.1.2" xref="S2.SS4.p1.6.m1.1.1.2.cmml">​</mo><mrow id="S2.SS4.p1.6.m1.1.1.1.1" xref="S2.SS4.p1.6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.6.m1.1.1.1.1.2" xref="S2.SS4.p1.6.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS4.p1.6.m1.1.1.1.1.1" xref="S2.SS4.p1.6.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.p1.6.m1.1.1.1.1.1.2" xref="S2.SS4.p1.6.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS4.p1.6.m1.1.1.1.1.1.3" xref="S2.SS4.p1.6.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS4.p1.6.m1.1.1.1.1.3" xref="S2.SS4.p1.6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.6.m1.1b"><apply id="S2.SS4.p1.6.m1.1.1.cmml" xref="S2.SS4.p1.6.m1.1.1"><times id="S2.SS4.p1.6.m1.1.1.2.cmml" xref="S2.SS4.p1.6.m1.1.1.2"></times><apply id="S2.SS4.p1.6.m1.1.1.3.cmml" xref="S2.SS4.p1.6.m1.1.1.3"><apply id="S2.SS4.p1.6.m1.1.1.3.1.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1"><apply id="S2.SS4.p1.6.m1.1.1.3.1.1.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m1.1.1.3.1.1.1.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1">subscript</csymbol><ci id="S2.SS4.p1.6.m1.1.1.3.1.1.2.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1.2">∇</ci><apply id="S2.SS4.p1.6.m1.1.1.3.1.1.3.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m1.1.1.3.1.1.3.1.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3">subscript</csymbol><ci id="S2.SS4.p1.6.m1.1.1.3.1.1.3.2.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3.2">𝑥</ci><ci id="S2.SS4.p1.6.m1.1.1.3.1.1.3.3.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.1.3.3">𝑘</ci></apply></apply><log id="S2.SS4.p1.6.m1.1.1.3.1.2.cmml" xref="S2.SS4.p1.6.m1.1.1.3.1.2"></log></apply><apply id="S2.SS4.p1.6.m1.1.1.3.2.cmml" xref="S2.SS4.p1.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m1.1.1.3.2.1.cmml" xref="S2.SS4.p1.6.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS4.p1.6.m1.1.1.3.2.2.cmml" xref="S2.SS4.p1.6.m1.1.1.3.2.2">𝑝</ci><ci id="S2.SS4.p1.6.m1.1.1.3.2.3.cmml" xref="S2.SS4.p1.6.m1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.SS4.p1.6.m1.1.1.1.1.1.cmml" xref="S2.SS4.p1.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.6.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p1.6.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.6.m1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS4.p1.6.m1.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.6.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.6.m1.1c">\nabla_{x_{k}}\log p_{\theta}(x_{k})</annotation></semantics></math> represents the gradient of the log probability with respect to <math id="S2.SS4.p1.7.m2.1" class="ltx_Math" alttext="x_{k}" display="inline"><semantics id="S2.SS4.p1.7.m2.1a"><msub id="S2.SS4.p1.7.m2.1.1" xref="S2.SS4.p1.7.m2.1.1.cmml"><mi id="S2.SS4.p1.7.m2.1.1.2" xref="S2.SS4.p1.7.m2.1.1.2.cmml">x</mi><mi id="S2.SS4.p1.7.m2.1.1.3" xref="S2.SS4.p1.7.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.7.m2.1b"><apply id="S2.SS4.p1.7.m2.1.1.cmml" xref="S2.SS4.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.7.m2.1.1.1.cmml" xref="S2.SS4.p1.7.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.7.m2.1.1.2.cmml" xref="S2.SS4.p1.7.m2.1.1.2">𝑥</ci><ci id="S2.SS4.p1.7.m2.1.1.3.cmml" xref="S2.SS4.p1.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.7.m2.1c">x_{k}</annotation></semantics></math>, and <math id="S2.SS4.p1.8.m3.1" class="ltx_Math" alttext="z_{k}" display="inline"><semantics id="S2.SS4.p1.8.m3.1a"><msub id="S2.SS4.p1.8.m3.1.1" xref="S2.SS4.p1.8.m3.1.1.cmml"><mi id="S2.SS4.p1.8.m3.1.1.2" xref="S2.SS4.p1.8.m3.1.1.2.cmml">z</mi><mi id="S2.SS4.p1.8.m3.1.1.3" xref="S2.SS4.p1.8.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.8.m3.1b"><apply id="S2.SS4.p1.8.m3.1.1.cmml" xref="S2.SS4.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.8.m3.1.1.1.cmml" xref="S2.SS4.p1.8.m3.1.1">subscript</csymbol><ci id="S2.SS4.p1.8.m3.1.1.2.cmml" xref="S2.SS4.p1.8.m3.1.1.2">𝑧</ci><ci id="S2.SS4.p1.8.m3.1.1.3.cmml" xref="S2.SS4.p1.8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.8.m3.1c">z_{k}</annotation></semantics></math> is a random noise term. Notably, as <math id="S2.SS4.p1.9.m4.1" class="ltx_Math" alttext="\epsilon\rightarrow 0" display="inline"><semantics id="S2.SS4.p1.9.m4.1a"><mrow id="S2.SS4.p1.9.m4.1.1" xref="S2.SS4.p1.9.m4.1.1.cmml"><mi id="S2.SS4.p1.9.m4.1.1.2" xref="S2.SS4.p1.9.m4.1.1.2.cmml">ϵ</mi><mo stretchy="false" id="S2.SS4.p1.9.m4.1.1.1" xref="S2.SS4.p1.9.m4.1.1.1.cmml">→</mo><mn id="S2.SS4.p1.9.m4.1.1.3" xref="S2.SS4.p1.9.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.9.m4.1b"><apply id="S2.SS4.p1.9.m4.1.1.cmml" xref="S2.SS4.p1.9.m4.1.1"><ci id="S2.SS4.p1.9.m4.1.1.1.cmml" xref="S2.SS4.p1.9.m4.1.1.1">→</ci><ci id="S2.SS4.p1.9.m4.1.1.2.cmml" xref="S2.SS4.p1.9.m4.1.1.2">italic-ϵ</ci><cn type="integer" id="S2.SS4.p1.9.m4.1.1.3.cmml" xref="S2.SS4.p1.9.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.9.m4.1c">\epsilon\rightarrow 0</annotation></semantics></math> and <math id="S2.SS4.p1.10.m5.1" class="ltx_Math" alttext="K\rightarrow\infty" display="inline"><semantics id="S2.SS4.p1.10.m5.1a"><mrow id="S2.SS4.p1.10.m5.1.1" xref="S2.SS4.p1.10.m5.1.1.cmml"><mi id="S2.SS4.p1.10.m5.1.1.2" xref="S2.SS4.p1.10.m5.1.1.2.cmml">K</mi><mo stretchy="false" id="S2.SS4.p1.10.m5.1.1.1" xref="S2.SS4.p1.10.m5.1.1.1.cmml">→</mo><mi mathvariant="normal" id="S2.SS4.p1.10.m5.1.1.3" xref="S2.SS4.p1.10.m5.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.10.m5.1b"><apply id="S2.SS4.p1.10.m5.1.1.cmml" xref="S2.SS4.p1.10.m5.1.1"><ci id="S2.SS4.p1.10.m5.1.1.1.cmml" xref="S2.SS4.p1.10.m5.1.1.1">→</ci><ci id="S2.SS4.p1.10.m5.1.1.2.cmml" xref="S2.SS4.p1.10.m5.1.1.2">𝐾</ci><infinity id="S2.SS4.p1.10.m5.1.1.3.cmml" xref="S2.SS4.p1.10.m5.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.10.m5.1c">K\rightarrow\infty</annotation></semantics></math>, the final sample <math id="S2.SS4.p1.11.m6.1" class="ltx_Math" alttext="x_{K}" display="inline"><semantics id="S2.SS4.p1.11.m6.1a"><msub id="S2.SS4.p1.11.m6.1.1" xref="S2.SS4.p1.11.m6.1.1.cmml"><mi id="S2.SS4.p1.11.m6.1.1.2" xref="S2.SS4.p1.11.m6.1.1.2.cmml">x</mi><mi id="S2.SS4.p1.11.m6.1.1.3" xref="S2.SS4.p1.11.m6.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.11.m6.1b"><apply id="S2.SS4.p1.11.m6.1.1.cmml" xref="S2.SS4.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.11.m6.1.1.1.cmml" xref="S2.SS4.p1.11.m6.1.1">subscript</csymbol><ci id="S2.SS4.p1.11.m6.1.1.2.cmml" xref="S2.SS4.p1.11.m6.1.1.2">𝑥</ci><ci id="S2.SS4.p1.11.m6.1.1.3.cmml" xref="S2.SS4.p1.11.m6.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.11.m6.1c">x_{K}</annotation></semantics></math> converges to a distribution that matches <math id="S2.SS4.p1.12.m7.1" class="ltx_Math" alttext="p_{\theta}(x)" display="inline"><semantics id="S2.SS4.p1.12.m7.1a"><mrow id="S2.SS4.p1.12.m7.1.2" xref="S2.SS4.p1.12.m7.1.2.cmml"><msub id="S2.SS4.p1.12.m7.1.2.2" xref="S2.SS4.p1.12.m7.1.2.2.cmml"><mi id="S2.SS4.p1.12.m7.1.2.2.2" xref="S2.SS4.p1.12.m7.1.2.2.2.cmml">p</mi><mi id="S2.SS4.p1.12.m7.1.2.2.3" xref="S2.SS4.p1.12.m7.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS4.p1.12.m7.1.2.1" xref="S2.SS4.p1.12.m7.1.2.1.cmml">​</mo><mrow id="S2.SS4.p1.12.m7.1.2.3.2" xref="S2.SS4.p1.12.m7.1.2.cmml"><mo stretchy="false" id="S2.SS4.p1.12.m7.1.2.3.2.1" xref="S2.SS4.p1.12.m7.1.2.cmml">(</mo><mi id="S2.SS4.p1.12.m7.1.1" xref="S2.SS4.p1.12.m7.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS4.p1.12.m7.1.2.3.2.2" xref="S2.SS4.p1.12.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.12.m7.1b"><apply id="S2.SS4.p1.12.m7.1.2.cmml" xref="S2.SS4.p1.12.m7.1.2"><times id="S2.SS4.p1.12.m7.1.2.1.cmml" xref="S2.SS4.p1.12.m7.1.2.1"></times><apply id="S2.SS4.p1.12.m7.1.2.2.cmml" xref="S2.SS4.p1.12.m7.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.12.m7.1.2.2.1.cmml" xref="S2.SS4.p1.12.m7.1.2.2">subscript</csymbol><ci id="S2.SS4.p1.12.m7.1.2.2.2.cmml" xref="S2.SS4.p1.12.m7.1.2.2.2">𝑝</ci><ci id="S2.SS4.p1.12.m7.1.2.2.3.cmml" xref="S2.SS4.p1.12.m7.1.2.2.3">𝜃</ci></apply><ci id="S2.SS4.p1.12.m7.1.1.cmml" xref="S2.SS4.p1.12.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.12.m7.1c">p_{\theta}(x)</annotation></semantics></math> under certain regularity conditions.</p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Evaluation Metrics</h3>

<div id="S2.SS5.p1" class="ltx_para">
<p id="S2.SS5.p1.15" class="ltx_p"><span id="S2.SS5.p1.15.1" class="ltx_text ltx_font_bold">Expected Calibration Error in Classification.</span>
A calibrated classifier aligns confidence with accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. ECE quantifies calibration by binning predictions and measuring the difference between expected confidence and accuracy.
Mathematically, ECE is expressed as:</p>
<table id="S2.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1.2" class="ltx_Math" alttext="\small ECE=\sum_{b=1}^{B}\frac{\lvert B_{b}\rvert}{N}\lvert\text{acc}(B_{b})-\text{conf}(B_{b})\rvert," display="block"><semantics id="S2.E9.m1.2a"><mrow id="S2.E9.m1.2.2.1" xref="S2.E9.m1.2.2.1.1.cmml"><mrow id="S2.E9.m1.2.2.1.1" xref="S2.E9.m1.2.2.1.1.cmml"><mrow id="S2.E9.m1.2.2.1.1.3" xref="S2.E9.m1.2.2.1.1.3.cmml"><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.3.2" xref="S2.E9.m1.2.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.2.2.1.1.3.1" xref="S2.E9.m1.2.2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.3.3" xref="S2.E9.m1.2.2.1.1.3.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.2.2.1.1.3.1a" xref="S2.E9.m1.2.2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.3.4" xref="S2.E9.m1.2.2.1.1.3.4.cmml">E</mi></mrow><mo mathsize="90%" rspace="0.111em" id="S2.E9.m1.2.2.1.1.2" xref="S2.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E9.m1.2.2.1.1.1" xref="S2.E9.m1.2.2.1.1.1.cmml"><munderover id="S2.E9.m1.2.2.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E9.m1.2.2.1.1.1.2.2.2" xref="S2.E9.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E9.m1.2.2.1.1.1.2.2.3" xref="S2.E9.m1.2.2.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.2.2.3.2" xref="S2.E9.m1.2.2.1.1.1.2.2.3.2.cmml">b</mi><mo mathsize="90%" id="S2.E9.m1.2.2.1.1.1.2.2.3.1" xref="S2.E9.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E9.m1.2.2.1.1.1.2.2.3.3" xref="S2.E9.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.2.3" xref="S2.E9.m1.2.2.1.1.1.2.3.cmml">B</mi></munderover><mrow id="S2.E9.m1.2.2.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.cmml"><mfrac id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><mrow id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.E9.m1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.2.cmml">B</mi><mi mathsize="90%" id="S2.E9.m1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.3.cmml">b</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E9.m1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.2.1.cmml">|</mo></mrow><mi mathsize="90%" id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E9.m1.2.2.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mtext mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mtext mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3a.cmml">conf</mtext><mo lspace="0em" rspace="0em" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">B</mi><mi mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">b</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.3" xref="S2.E9.m1.2.2.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E9.m1.2.2.1.2" xref="S2.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.2b"><apply id="S2.E9.m1.2.2.1.1.cmml" xref="S2.E9.m1.2.2.1"><eq id="S2.E9.m1.2.2.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.2"></eq><apply id="S2.E9.m1.2.2.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.3"><times id="S2.E9.m1.2.2.1.1.3.1.cmml" xref="S2.E9.m1.2.2.1.1.3.1"></times><ci id="S2.E9.m1.2.2.1.1.3.2.cmml" xref="S2.E9.m1.2.2.1.1.3.2">𝐸</ci><ci id="S2.E9.m1.2.2.1.1.3.3.cmml" xref="S2.E9.m1.2.2.1.1.3.3">𝐶</ci><ci id="S2.E9.m1.2.2.1.1.3.4.cmml" xref="S2.E9.m1.2.2.1.1.3.4">𝐸</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1"><apply id="S2.E9.m1.2.2.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S2.E9.m1.2.2.1.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S2.E9.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.2.2.2"></sum><apply id="S2.E9.m1.2.2.1.1.1.2.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.2.2.3"><eq id="S2.E9.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S2.E9.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S2.E9.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S2.E9.m1.2.2.1.1.1.2.2.3.2">𝑏</ci><cn type="integer" id="S2.E9.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S2.E9.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E9.m1.2.2.1.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.2.3">𝐵</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1"><times id="S2.E9.m1.2.2.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.2"></times><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><divide id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1"></divide><apply id="S2.E9.m1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1"><abs id="S2.E9.m1.1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2"></abs><apply id="S2.E9.m1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.2">𝐵</ci><ci id="S2.E9.m1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.3">𝑏</ci></apply></apply><ci id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3">𝑁</ci></apply><apply id="S2.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1"><abs id="S2.E9.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.2"></abs><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1"><minus id="S2.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.3"></minus><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1"><times id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3"><mtext mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.3">acc</mtext></ci><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2"><times id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.2"></times><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3"><mtext mathsize="90%" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.3">conf</mtext></ci><apply id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2">𝐵</ci><ci id="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E9.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3">𝑏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.2c">\small ECE=\sum_{b=1}^{B}\frac{\lvert B_{b}\rvert}{N}\lvert\text{acc}(B_{b})-\text{conf}(B_{b})\rvert,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S2.SS5.p1.10" class="ltx_p">where <math id="S2.SS5.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S2.SS5.p1.1.m1.1a"><mi id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><ci id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">B</annotation></semantics></math> is the number of bins, <math id="S2.SS5.p1.2.m2.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S2.SS5.p1.2.m2.1a"><msub id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mi id="S2.SS5.p1.2.m2.1.1.2" xref="S2.SS5.p1.2.m2.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2">𝐵</ci><ci id="S2.SS5.p1.2.m2.1.1.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">B_{b}</annotation></semantics></math> represents the <math id="S2.SS5.p1.3.m3.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S2.SS5.p1.3.m3.1a"><mi id="S2.SS5.p1.3.m3.1.1" xref="S2.SS5.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m3.1b"><ci id="S2.SS5.p1.3.m3.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m3.1c">b</annotation></semantics></math>-th bin, <math id="S2.SS5.p1.4.m4.1" class="ltx_Math" alttext="\lvert B_{b}\rvert" display="inline"><semantics id="S2.SS5.p1.4.m4.1a"><mrow id="S2.SS5.p1.4.m4.1.1.1" xref="S2.SS5.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="S2.SS5.p1.4.m4.1.1.1.2" xref="S2.SS5.p1.4.m4.1.1.2.1.cmml">|</mo><msub id="S2.SS5.p1.4.m4.1.1.1.1" xref="S2.SS5.p1.4.m4.1.1.1.1.cmml"><mi id="S2.SS5.p1.4.m4.1.1.1.1.2" xref="S2.SS5.p1.4.m4.1.1.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.4.m4.1.1.1.1.3" xref="S2.SS5.p1.4.m4.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S2.SS5.p1.4.m4.1.1.1.3" xref="S2.SS5.p1.4.m4.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.4.m4.1b"><apply id="S2.SS5.p1.4.m4.1.1.2.cmml" xref="S2.SS5.p1.4.m4.1.1.1"><abs id="S2.SS5.p1.4.m4.1.1.2.1.cmml" xref="S2.SS5.p1.4.m4.1.1.1.2"></abs><apply id="S2.SS5.p1.4.m4.1.1.1.1.cmml" xref="S2.SS5.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS5.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.4.m4.1.1.1.1.2.cmml" xref="S2.SS5.p1.4.m4.1.1.1.1.2">𝐵</ci><ci id="S2.SS5.p1.4.m4.1.1.1.1.3.cmml" xref="S2.SS5.p1.4.m4.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.4.m4.1c">\lvert B_{b}\rvert</annotation></semantics></math> is the number of samples in bin <math id="S2.SS5.p1.5.m5.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S2.SS5.p1.5.m5.1a"><msub id="S2.SS5.p1.5.m5.1.1" xref="S2.SS5.p1.5.m5.1.1.cmml"><mi id="S2.SS5.p1.5.m5.1.1.2" xref="S2.SS5.p1.5.m5.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.5.m5.1.1.3" xref="S2.SS5.p1.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.5.m5.1b"><apply id="S2.SS5.p1.5.m5.1.1.cmml" xref="S2.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.1.1.1.cmml" xref="S2.SS5.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS5.p1.5.m5.1.1.2.cmml" xref="S2.SS5.p1.5.m5.1.1.2">𝐵</ci><ci id="S2.SS5.p1.5.m5.1.1.3.cmml" xref="S2.SS5.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.5.m5.1c">B_{b}</annotation></semantics></math>, <math id="S2.SS5.p1.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS5.p1.6.m6.1a"><mi id="S2.SS5.p1.6.m6.1.1" xref="S2.SS5.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.6.m6.1b"><ci id="S2.SS5.p1.6.m6.1.1.cmml" xref="S2.SS5.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.6.m6.1c">N</annotation></semantics></math> is the total number of samples, <math id="S2.SS5.p1.7.m7.1" class="ltx_Math" alttext="\text{acc}(B_{b})" display="inline"><semantics id="S2.SS5.p1.7.m7.1a"><mrow id="S2.SS5.p1.7.m7.1.1" xref="S2.SS5.p1.7.m7.1.1.cmml"><mtext id="S2.SS5.p1.7.m7.1.1.3" xref="S2.SS5.p1.7.m7.1.1.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S2.SS5.p1.7.m7.1.1.2" xref="S2.SS5.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S2.SS5.p1.7.m7.1.1.1.1" xref="S2.SS5.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS5.p1.7.m7.1.1.1.1.2" xref="S2.SS5.p1.7.m7.1.1.1.1.1.cmml">(</mo><msub id="S2.SS5.p1.7.m7.1.1.1.1.1" xref="S2.SS5.p1.7.m7.1.1.1.1.1.cmml"><mi id="S2.SS5.p1.7.m7.1.1.1.1.1.2" xref="S2.SS5.p1.7.m7.1.1.1.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.7.m7.1.1.1.1.1.3" xref="S2.SS5.p1.7.m7.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S2.SS5.p1.7.m7.1.1.1.1.3" xref="S2.SS5.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.7.m7.1b"><apply id="S2.SS5.p1.7.m7.1.1.cmml" xref="S2.SS5.p1.7.m7.1.1"><times id="S2.SS5.p1.7.m7.1.1.2.cmml" xref="S2.SS5.p1.7.m7.1.1.2"></times><ci id="S2.SS5.p1.7.m7.1.1.3a.cmml" xref="S2.SS5.p1.7.m7.1.1.3"><mtext id="S2.SS5.p1.7.m7.1.1.3.cmml" xref="S2.SS5.p1.7.m7.1.1.3">acc</mtext></ci><apply id="S2.SS5.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS5.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS5.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS5.p1.7.m7.1.1.1.1.1.2">𝐵</ci><ci id="S2.SS5.p1.7.m7.1.1.1.1.1.3.cmml" xref="S2.SS5.p1.7.m7.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.7.m7.1c">\text{acc}(B_{b})</annotation></semantics></math> is the average accuracy in bin <math id="S2.SS5.p1.8.m8.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S2.SS5.p1.8.m8.1a"><msub id="S2.SS5.p1.8.m8.1.1" xref="S2.SS5.p1.8.m8.1.1.cmml"><mi id="S2.SS5.p1.8.m8.1.1.2" xref="S2.SS5.p1.8.m8.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.8.m8.1.1.3" xref="S2.SS5.p1.8.m8.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.8.m8.1b"><apply id="S2.SS5.p1.8.m8.1.1.cmml" xref="S2.SS5.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.8.m8.1.1.1.cmml" xref="S2.SS5.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS5.p1.8.m8.1.1.2.cmml" xref="S2.SS5.p1.8.m8.1.1.2">𝐵</ci><ci id="S2.SS5.p1.8.m8.1.1.3.cmml" xref="S2.SS5.p1.8.m8.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.8.m8.1c">B_{b}</annotation></semantics></math>, and <math id="S2.SS5.p1.9.m9.1" class="ltx_Math" alttext="\text{conf}(B_{b})" display="inline"><semantics id="S2.SS5.p1.9.m9.1a"><mrow id="S2.SS5.p1.9.m9.1.1" xref="S2.SS5.p1.9.m9.1.1.cmml"><mtext id="S2.SS5.p1.9.m9.1.1.3" xref="S2.SS5.p1.9.m9.1.1.3a.cmml">conf</mtext><mo lspace="0em" rspace="0em" id="S2.SS5.p1.9.m9.1.1.2" xref="S2.SS5.p1.9.m9.1.1.2.cmml">​</mo><mrow id="S2.SS5.p1.9.m9.1.1.1.1" xref="S2.SS5.p1.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS5.p1.9.m9.1.1.1.1.2" xref="S2.SS5.p1.9.m9.1.1.1.1.1.cmml">(</mo><msub id="S2.SS5.p1.9.m9.1.1.1.1.1" xref="S2.SS5.p1.9.m9.1.1.1.1.1.cmml"><mi id="S2.SS5.p1.9.m9.1.1.1.1.1.2" xref="S2.SS5.p1.9.m9.1.1.1.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.9.m9.1.1.1.1.1.3" xref="S2.SS5.p1.9.m9.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S2.SS5.p1.9.m9.1.1.1.1.3" xref="S2.SS5.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.9.m9.1b"><apply id="S2.SS5.p1.9.m9.1.1.cmml" xref="S2.SS5.p1.9.m9.1.1"><times id="S2.SS5.p1.9.m9.1.1.2.cmml" xref="S2.SS5.p1.9.m9.1.1.2"></times><ci id="S2.SS5.p1.9.m9.1.1.3a.cmml" xref="S2.SS5.p1.9.m9.1.1.3"><mtext id="S2.SS5.p1.9.m9.1.1.3.cmml" xref="S2.SS5.p1.9.m9.1.1.3">conf</mtext></ci><apply id="S2.SS5.p1.9.m9.1.1.1.1.1.cmml" xref="S2.SS5.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS5.p1.9.m9.1.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.9.m9.1.1.1.1.1.2.cmml" xref="S2.SS5.p1.9.m9.1.1.1.1.1.2">𝐵</ci><ci id="S2.SS5.p1.9.m9.1.1.1.1.1.3.cmml" xref="S2.SS5.p1.9.m9.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.9.m9.1c">\text{conf}(B_{b})</annotation></semantics></math> is the average confidence in bin <math id="S2.SS5.p1.10.m10.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S2.SS5.p1.10.m10.1a"><msub id="S2.SS5.p1.10.m10.1.1" xref="S2.SS5.p1.10.m10.1.1.cmml"><mi id="S2.SS5.p1.10.m10.1.1.2" xref="S2.SS5.p1.10.m10.1.1.2.cmml">B</mi><mi id="S2.SS5.p1.10.m10.1.1.3" xref="S2.SS5.p1.10.m10.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.10.m10.1b"><apply id="S2.SS5.p1.10.m10.1.1.cmml" xref="S2.SS5.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.10.m10.1.1.1.cmml" xref="S2.SS5.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS5.p1.10.m10.1.1.2.cmml" xref="S2.SS5.p1.10.m10.1.1.2">𝐵</ci><ci id="S2.SS5.p1.10.m10.1.1.3.cmml" xref="S2.SS5.p1.10.m10.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.10.m10.1c">B_{b}</annotation></semantics></math>.
<br class="ltx_break"><span id="S2.SS5.p1.10.1" class="ltx_text ltx_font_bold">Negative Log-Likelihood in Classification.</span>
NLL is a key metric for assessing a classification model's calibration. It measures the agreement between predicted probabilities and actual labels by computing the logarithm of the predicted probability assigned to the true label for each sample:</p>
<table id="S2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1.3" class="ltx_Math" alttext="\text{NLL}=-\frac{1}{N}\sum_{i=1}^{N}\log(P(\hat{y_{i}})|x_{i})," display="block"><semantics id="S2.E10.m1.3a"><mrow id="S2.E10.m1.3.3.1" xref="S2.E10.m1.3.3.1.1.cmml"><mrow id="S2.E10.m1.3.3.1.1" xref="S2.E10.m1.3.3.1.1.cmml"><mtext id="S2.E10.m1.3.3.1.1.3" xref="S2.E10.m1.3.3.1.1.3a.cmml">NLL</mtext><mo id="S2.E10.m1.3.3.1.1.2" xref="S2.E10.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E10.m1.3.3.1.1.1" xref="S2.E10.m1.3.3.1.1.1.cmml"><mo id="S2.E10.m1.3.3.1.1.1a" xref="S2.E10.m1.3.3.1.1.1.cmml">−</mo><mrow id="S2.E10.m1.3.3.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.cmml"><mfrac id="S2.E10.m1.3.3.1.1.1.1.3" xref="S2.E10.m1.3.3.1.1.1.1.3.cmml"><mn id="S2.E10.m1.3.3.1.1.1.1.3.2" xref="S2.E10.m1.3.3.1.1.1.1.3.2.cmml">1</mn><mi id="S2.E10.m1.3.3.1.1.1.1.3.3" xref="S2.E10.m1.3.3.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E10.m1.3.3.1.1.1.1.2" xref="S2.E10.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S2.E10.m1.3.3.1.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.1.cmml"><munderover id="S2.E10.m1.3.3.1.1.1.1.1.2" xref="S2.E10.m1.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E10.m1.3.3.1.1.1.1.1.2.2.2" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.2" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.1" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.3" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E10.m1.3.3.1.1.1.1.1.2.3" xref="S2.E10.m1.3.3.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E10.m1.3.3.1.1.1.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E10.m1.2.2" xref="S2.E10.m1.2.2.cmml">log</mi><mo id="S2.E10.m1.3.3.1.1.1.1.1.1.1a" xref="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E10.m1.1.1.cmml"><mo stretchy="false" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.1" xref="S2.E10.m1.1.1.cmml">(</mo><mover accent="true" id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml"><msub id="S2.E10.m1.1.1.2" xref="S2.E10.m1.1.1.2.cmml"><mi id="S2.E10.m1.1.1.2.2" xref="S2.E10.m1.1.1.2.2.cmml">y</mi><mi id="S2.E10.m1.1.1.2.3" xref="S2.E10.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E10.m1.1.1.1" xref="S2.E10.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E10.m1.1.1.cmml">)</mo></mrow></mrow><mo fence="false" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E10.m1.3.3.1.2" xref="S2.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.3b"><apply id="S2.E10.m1.3.3.1.1.cmml" xref="S2.E10.m1.3.3.1"><eq id="S2.E10.m1.3.3.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.2"></eq><ci id="S2.E10.m1.3.3.1.1.3a.cmml" xref="S2.E10.m1.3.3.1.1.3"><mtext id="S2.E10.m1.3.3.1.1.3.cmml" xref="S2.E10.m1.3.3.1.1.3">NLL</mtext></ci><apply id="S2.E10.m1.3.3.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1"><minus id="S2.E10.m1.3.3.1.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.1"></minus><apply id="S2.E10.m1.3.3.1.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1"><times id="S2.E10.m1.3.3.1.1.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.2"></times><apply id="S2.E10.m1.3.3.1.1.1.1.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.3"><divide id="S2.E10.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.3"></divide><cn type="integer" id="S2.E10.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.3.2">1</cn><ci id="S2.E10.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.3.3">𝑁</ci></apply><apply id="S2.E10.m1.3.3.1.1.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1"><apply id="S2.E10.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E10.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E10.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.2"></sum><apply id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3"><eq id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E10.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1"><log id="S2.E10.m1.2.2.cmml" xref="S2.E10.m1.2.2"></log><apply id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2"><times id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑃</ci><apply id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2"><ci id="S2.E10.m1.1.1.1.cmml" xref="S2.E10.m1.1.1.1">^</ci><apply id="S2.E10.m1.1.1.2.cmml" xref="S2.E10.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.2">subscript</csymbol><ci id="S2.E10.m1.1.1.2.2.cmml" xref="S2.E10.m1.1.1.2.2">𝑦</ci><ci id="S2.E10.m1.1.1.2.3.cmml" xref="S2.E10.m1.1.1.2.3">𝑖</ci></apply></apply></apply><apply id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.3c">\text{NLL}=-\frac{1}{N}\sum_{i=1}^{N}\log(P(\hat{y_{i}})|x_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S2.SS5.p1.14" class="ltx_p">where <math id="S2.SS5.p1.11.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS5.p1.11.m1.1a"><mi id="S2.SS5.p1.11.m1.1.1" xref="S2.SS5.p1.11.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.11.m1.1b"><ci id="S2.SS5.p1.11.m1.1.1.cmml" xref="S2.SS5.p1.11.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.11.m1.1c">N</annotation></semantics></math> is the total number of samples, <math id="S2.SS5.p1.12.m2.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S2.SS5.p1.12.m2.1a"><mover accent="true" id="S2.SS5.p1.12.m2.1.1" xref="S2.SS5.p1.12.m2.1.1.cmml"><msub id="S2.SS5.p1.12.m2.1.1.2" xref="S2.SS5.p1.12.m2.1.1.2.cmml"><mi id="S2.SS5.p1.12.m2.1.1.2.2" xref="S2.SS5.p1.12.m2.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p1.12.m2.1.1.2.3" xref="S2.SS5.p1.12.m2.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS5.p1.12.m2.1.1.1" xref="S2.SS5.p1.12.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.12.m2.1b"><apply id="S2.SS5.p1.12.m2.1.1.cmml" xref="S2.SS5.p1.12.m2.1.1"><ci id="S2.SS5.p1.12.m2.1.1.1.cmml" xref="S2.SS5.p1.12.m2.1.1.1">^</ci><apply id="S2.SS5.p1.12.m2.1.1.2.cmml" xref="S2.SS5.p1.12.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p1.12.m2.1.1.2.1.cmml" xref="S2.SS5.p1.12.m2.1.1.2">subscript</csymbol><ci id="S2.SS5.p1.12.m2.1.1.2.2.cmml" xref="S2.SS5.p1.12.m2.1.1.2.2">𝑦</ci><ci id="S2.SS5.p1.12.m2.1.1.2.3.cmml" xref="S2.SS5.p1.12.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.12.m2.1c">\hat{y_{i}}</annotation></semantics></math> represents the true label of the <math id="S2.SS5.p1.13.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS5.p1.13.m3.1a"><mi id="S2.SS5.p1.13.m3.1.1" xref="S2.SS5.p1.13.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.13.m3.1b"><ci id="S2.SS5.p1.13.m3.1.1.cmml" xref="S2.SS5.p1.13.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.13.m3.1c">i</annotation></semantics></math>-th sample, and <math id="S2.SS5.p1.14.m4.1" class="ltx_Math" alttext="P(\hat{y_{i}})" display="inline"><semantics id="S2.SS5.p1.14.m4.1a"><mrow id="S2.SS5.p1.14.m4.1.2" xref="S2.SS5.p1.14.m4.1.2.cmml"><mi id="S2.SS5.p1.14.m4.1.2.2" xref="S2.SS5.p1.14.m4.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.SS5.p1.14.m4.1.2.1" xref="S2.SS5.p1.14.m4.1.2.1.cmml">​</mo><mrow id="S2.SS5.p1.14.m4.1.2.3.2" xref="S2.SS5.p1.14.m4.1.1.cmml"><mo stretchy="false" id="S2.SS5.p1.14.m4.1.2.3.2.1" xref="S2.SS5.p1.14.m4.1.1.cmml">(</mo><mover accent="true" id="S2.SS5.p1.14.m4.1.1" xref="S2.SS5.p1.14.m4.1.1.cmml"><msub id="S2.SS5.p1.14.m4.1.1.2" xref="S2.SS5.p1.14.m4.1.1.2.cmml"><mi id="S2.SS5.p1.14.m4.1.1.2.2" xref="S2.SS5.p1.14.m4.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p1.14.m4.1.1.2.3" xref="S2.SS5.p1.14.m4.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS5.p1.14.m4.1.1.1" xref="S2.SS5.p1.14.m4.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S2.SS5.p1.14.m4.1.2.3.2.2" xref="S2.SS5.p1.14.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.14.m4.1b"><apply id="S2.SS5.p1.14.m4.1.2.cmml" xref="S2.SS5.p1.14.m4.1.2"><times id="S2.SS5.p1.14.m4.1.2.1.cmml" xref="S2.SS5.p1.14.m4.1.2.1"></times><ci id="S2.SS5.p1.14.m4.1.2.2.cmml" xref="S2.SS5.p1.14.m4.1.2.2">𝑃</ci><apply id="S2.SS5.p1.14.m4.1.1.cmml" xref="S2.SS5.p1.14.m4.1.2.3.2"><ci id="S2.SS5.p1.14.m4.1.1.1.cmml" xref="S2.SS5.p1.14.m4.1.1.1">^</ci><apply id="S2.SS5.p1.14.m4.1.1.2.cmml" xref="S2.SS5.p1.14.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p1.14.m4.1.1.2.1.cmml" xref="S2.SS5.p1.14.m4.1.1.2">subscript</csymbol><ci id="S2.SS5.p1.14.m4.1.1.2.2.cmml" xref="S2.SS5.p1.14.m4.1.1.2.2">𝑦</ci><ci id="S2.SS5.p1.14.m4.1.1.2.3.cmml" xref="S2.SS5.p1.14.m4.1.1.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.14.m4.1c">P(\hat{y_{i}})</annotation></semantics></math> denotes the predicted probability associated with the true label. A lower NLL indicates better calibration, signifying that the model's predicted probabilities closely match the actual outcomes.
In this study, we concentrate on calibration performance, aiming to demonstrate that incorporating EBMs improves confidence calibration without impacting the model’s classification effectiveness. Consequently, we use accuracy as the primary metric to affirm the preservation of core classification capabilities.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Datasets</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Multiple datasets will be used in these experiments, with the speech sampled at 16 kHz. The duration of training data for each task and the data split of those datasets is listed in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Datasets ‣ 3 Experiments ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. AP17-OLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, CASIA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and VoxCeleb-Enrichment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> datasets are used in our experiments for language, emotion and the age group classification respectively.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset</figcaption>
<div id="S3.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:140.3pt;height:216.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-52.1pt,80.6pt) scale(0.573649705682484,0.573649705682484) ;">
<table id="S3.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T1.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Corpus</span></th>
<th id="S3.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T1.1.1.1.1.2.1" class="ltx_text" style="font-size:90%;">Class</span></th>
<th id="S3.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T1.1.1.1.1.3.1" class="ltx_text" style="font-size:90%;">Spk</span></th>
<th id="S3.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T1.1.1.1.1.4.1" class="ltx_text" style="font-size:90%;">Train_utt</span></th>
<th id="S3.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T1.1.1.1.1.5.1" class="ltx_text" style="font-size:90%;">Test_utt</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.1.1.2.1.2.1" class="ltx_text" style="font-size:90%;">Minors</span></th>
<td id="S3.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.2.1.3.1" class="ltx_text" style="font-size:90%;">65</span></td>
<td id="S3.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.2.1.4.1" class="ltx_text" style="font-size:90%;">251</span></td>
<td id="S3.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.2.1.5.1" class="ltx_text" style="font-size:90%;">17</span></td>
</tr>
<tr id="S3.T1.1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.3.2.1.1" class="ltx_text" style="font-size:90%;">VoxCeleb-</span></th>
<th id="S3.T1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.3.2.2.1" class="ltx_text" style="font-size:90%;">Youngs</span></th>
<td id="S3.T1.1.1.3.2.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.3.2.3.1" class="ltx_text" style="font-size:90%;">2693</span></td>
<td id="S3.T1.1.1.3.2.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.3.2.4.1" class="ltx_text" style="font-size:90%;">12988</span></td>
<td id="S3.T1.1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.3.2.5.1" class="ltx_text" style="font-size:90%;">1466</span></td>
</tr>
<tr id="S3.T1.1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">Enrichment</span></th>
<th id="S3.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.4.3.2.1" class="ltx_text" style="font-size:90%;">Middles</span></th>
<td id="S3.T1.1.1.4.3.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.4.3.3.1" class="ltx_text" style="font-size:90%;">2583</span></td>
<td id="S3.T1.1.1.4.3.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.4.3.4.1" class="ltx_text" style="font-size:90%;">18272</span></td>
<td id="S3.T1.1.1.4.3.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.4.3.5.1" class="ltx_text" style="font-size:90%;">2086</span></td>
</tr>
<tr id="S3.T1.1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.5.4.2.1" class="ltx_text" style="font-size:90%;">Seniors</span></th>
<td id="S3.T1.1.1.5.4.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.5.4.3.1" class="ltx_text" style="font-size:90%;">1260</span></td>
<td id="S3.T1.1.1.5.4.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.5.4.4.1" class="ltx_text" style="font-size:90%;">10389</span></td>
<td id="S3.T1.1.1.5.4.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.5.4.5.1" class="ltx_text" style="font-size:90%;">1087</span></td>
</tr>
<tr id="S3.T1.1.1.6.5" class="ltx_tr">
<th id="S3.T1.1.1.6.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.1.1.6.5.2.1" class="ltx_text" style="font-size:90%;">Angry</span></th>
<td id="S3.T1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.6.5.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.6.5.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.6.5.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.7.6" class="ltx_tr">
<th id="S3.T1.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.7.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.7.6.2.1" class="ltx_text" style="font-size:90%;">Fear</span></th>
<td id="S3.T1.1.1.7.6.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.7.6.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.7.6.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.7.6.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.7.6.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.7.6.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.8.7" class="ltx_tr">
<th id="S3.T1.1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.8.7.1.1" class="ltx_text" style="font-size:90%;">CASIA</span></th>
<th id="S3.T1.1.1.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.8.7.2.1" class="ltx_text" style="font-size:90%;">Happy</span></th>
<td id="S3.T1.1.1.8.7.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.8.7.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.8.7.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.8.7.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.8.7.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.8.7.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.9.8" class="ltx_tr">
<th id="S3.T1.1.1.9.8.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.9.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.9.8.2.1" class="ltx_text" style="font-size:90%;">Neutral</span></th>
<td id="S3.T1.1.1.9.8.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.9.8.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.9.8.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.9.8.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.9.8.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.9.8.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.10.9" class="ltx_tr">
<th id="S3.T1.1.1.10.9.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.10.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.10.9.2.1" class="ltx_text" style="font-size:90%;">sad</span></th>
<td id="S3.T1.1.1.10.9.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.10.9.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.10.9.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.10.9.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.10.9.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.10.9.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.11.10" class="ltx_tr">
<th id="S3.T1.1.1.11.10.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.11.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.11.10.2.1" class="ltx_text" style="font-size:90%;">surprise</span></th>
<td id="S3.T1.1.1.11.10.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.11.10.3.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S3.T1.1.1.11.10.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.11.10.4.1" class="ltx_text" style="font-size:90%;">1200</span></td>
<td id="S3.T1.1.1.11.10.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.11.10.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T1.1.1.12.11" class="ltx_tr">
<th id="S3.T1.1.1.12.11.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T1.1.1.12.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.1.1.12.11.2.1" class="ltx_text" style="font-size:90%;">Mandarin</span></th>
<td id="S3.T1.1.1.12.11.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.12.11.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.12.11.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.12.11.4.1" class="ltx_text" style="font-size:90%;">7198</span></td>
<td id="S3.T1.1.1.12.11.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.1.12.11.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.13.12" class="ltx_tr">
<th id="S3.T1.1.1.13.12.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.13.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.13.12.2.1" class="ltx_text" style="font-size:90%;">Cantonese</span></th>
<td id="S3.T1.1.1.13.12.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.13.12.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.13.12.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.13.12.4.1" class="ltx_text" style="font-size:90%;">7559</span></td>
<td id="S3.T1.1.1.13.12.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.13.12.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.14.13" class="ltx_tr">
<th id="S3.T1.1.1.14.13.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.14.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.14.13.2.1" class="ltx_text" style="font-size:90%;">Indonesian</span></th>
<td id="S3.T1.1.1.14.13.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.14.13.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.14.13.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.14.13.4.1" class="ltx_text" style="font-size:90%;">7671</span></td>
<td id="S3.T1.1.1.14.13.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.14.13.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.15.14" class="ltx_tr">
<th id="S3.T1.1.1.15.14.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.15.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.15.14.2.1" class="ltx_text" style="font-size:90%;">Japanese</span></th>
<td id="S3.T1.1.1.15.14.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.15.14.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.15.14.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.15.14.4.1" class="ltx_text" style="font-size:90%;">7662</span></td>
<td id="S3.T1.1.1.15.14.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.15.14.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.16.15" class="ltx_tr">
<th id="S3.T1.1.1.16.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.16.15.1.1" class="ltx_text" style="font-size:90%;">AP17-OLR</span></th>
<th id="S3.T1.1.1.16.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.16.15.2.1" class="ltx_text" style="font-size:90%;">Russian</span></th>
<td id="S3.T1.1.1.16.15.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.16.15.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.16.15.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.16.15.4.1" class="ltx_text" style="font-size:90%;">7190</span></td>
<td id="S3.T1.1.1.16.15.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.16.15.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.17.16" class="ltx_tr">
<th id="S3.T1.1.1.17.16.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.17.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.17.16.2.1" class="ltx_text" style="font-size:90%;">Korean</span></th>
<td id="S3.T1.1.1.17.16.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.17.16.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.17.16.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.17.16.4.1" class="ltx_text" style="font-size:90%;">7196</span></td>
<td id="S3.T1.1.1.17.16.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.17.16.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.18.17" class="ltx_tr">
<th id="S3.T1.1.1.18.17.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.18.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.18.17.2.1" class="ltx_text" style="font-size:90%;">Vietnamese</span></th>
<td id="S3.T1.1.1.18.17.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.18.17.3.1" class="ltx_text" style="font-size:90%;">24</span></td>
<td id="S3.T1.1.1.18.17.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.18.17.4.1" class="ltx_text" style="font-size:90%;">7200</span></td>
<td id="S3.T1.1.1.18.17.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.18.17.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.19.18" class="ltx_tr">
<th id="S3.T1.1.1.19.18.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.19.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.19.18.2.1" class="ltx_text" style="font-size:90%;">Kazakh</span></th>
<td id="S3.T1.1.1.19.18.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.19.18.3.1" class="ltx_text" style="font-size:90%;">86</span></td>
<td id="S3.T1.1.1.19.18.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.19.18.4.1" class="ltx_text" style="font-size:90%;">4200</span></td>
<td id="S3.T1.1.1.19.18.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.19.18.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.20.19" class="ltx_tr">
<th id="S3.T1.1.1.20.19.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S3.T1.1.1.20.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.1.20.19.2.1" class="ltx_text" style="font-size:90%;">Tibetan</span></th>
<td id="S3.T1.1.1.20.19.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.20.19.3.1" class="ltx_text" style="font-size:90%;">34</span></td>
<td id="S3.T1.1.1.20.19.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.20.19.4.1" class="ltx_text" style="font-size:90%;">11100</span></td>
<td id="S3.T1.1.1.20.19.5" class="ltx_td ltx_align_center"><span id="S3.T1.1.1.20.19.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
<tr id="S3.T1.1.1.21.20" class="ltx_tr">
<th id="S3.T1.1.1.21.20.1" class="ltx_td ltx_th ltx_th_row ltx_border_b"></th>
<th id="S3.T1.1.1.21.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b"><span id="S3.T1.1.1.21.20.2.1" class="ltx_text" style="font-size:90%;">Uyghur</span></th>
<td id="S3.T1.1.1.21.20.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.1.1.21.20.3.1" class="ltx_text" style="font-size:90%;">353</span></td>
<td id="S3.T1.1.1.21.20.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.1.1.21.20.4.1" class="ltx_text" style="font-size:90%;">5800</span></td>
<td id="S3.T1.1.1.21.20.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.1.1.21.20.5.1" class="ltx_text" style="font-size:90%;">1800</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">AP17-OLR consists of 10 different languages. The test set contains three subsets with different durations (1 second, 3 second, and full length). For speech emotion classification task, we conduct out experiments on CASIA with six emotion categories (i.e., angry, surprise, sad, fear, happy, and neutral). For the age group classification, we used the VoxCeleb Enrichment dataset to train the model. VoxCeleb Enrichment were extracted from YouTube videos, the audio clips were recorded in a variety of acoustic environments. The audios were divided into four age groups
.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental Settings</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The input features are 32-dimensional Mel Filter-Banks extracted using the librosa package <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> with a window length of 25ms and a shift of 10ms with Hamming window. Mean and variance normalization is applied during instance normalization on Mel Filter-Banks features. A 192-frame segment (320-frame for age classification) is randomly chunked from each utterance.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">All our experiments are based on the Wide-ResNet architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, featuring a width of 5, depth of 28, payload learning rate of 0.2, 50 SGLD sampling steps, and a buffer size of 10,000
.
Frame-level feature extraction is based on ResNet topology with 3 groups of residual blocks.
Then the frame-level features are fed into the average pooling layer to get utterance-level embeddings, and the final classification layer dimensions are 10, 6, and 4, respectively, for language, emotion, and age group classification.
</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.18065/assets/confidence.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="501" height="644" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Calibration results for three speech classification tasks. A smaller ECE indicates better calibration.</figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">We optimize the model with stochastic gradient descent (SGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> optimizer, the learning rate warms up to 0.1 during the first 1000 steps, and reduce the learning rate at epoch [40, 80, 120] with a decay rate of 0.2. Both softmax-based models and EBMs stick to the same training settings.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Performance analysis and discussion</h3>

<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance Comparison</figcaption>
<div id="S3.T2.13" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:198.4pt;height:84.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-70.4pt,29.9pt) scale(0.584965983823758,0.584965983823758) ;">
<table id="S3.T2.13.13" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.13.13.14.1" class="ltx_tr">
<th id="S3.T2.13.13.14.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:1.85pt;padding-bottom:1.85pt;"><span id="S3.T2.13.13.14.1.1.1" class="ltx_text ltx_font_bold">Task</span></th>
<th id="S3.T2.13.13.14.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1.85pt;padding-bottom:1.85pt;"><span id="S3.T2.13.13.14.1.2.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S3.T2.13.13.14.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1.85pt;padding-bottom:1.85pt;" colspan="3"><span id="S3.T2.13.13.14.1.3.1" class="ltx_text ltx_font_bold">Performance</span>
</th>
</tr>
<tr id="S3.T2.3.3.3" class="ltx_tr">
<th id="S3.T2.3.3.3.4" class="ltx_td ltx_th ltx_th_row" style="padding-top:1.85pt;padding-bottom:1.85pt;"></th>
<th id="S3.T2.3.3.3.5" class="ltx_td ltx_th ltx_th_column" style="padding-top:1.85pt;padding-bottom:1.85pt;"></th>
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">
<span id="S3.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">ECE(%)</span> <math id="S3.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T2.1.1.1.1.m1.1a"><mo stretchy="false" id="S3.T2.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.m1.1b"><ci id="S3.T2.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S3.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">
<span id="S3.T2.2.2.2.2.1" class="ltx_text ltx_font_bold">ACC(%)</span> <math id="S3.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T2.2.2.2.2.m1.1a"><mo stretchy="false" id="S3.T2.2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.m1.1b"><ci id="S3.T2.2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.m1.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S3.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;"><span id="S3.T2.3.3.3.3.1" class="ltx_text ltx_font_bold">NLL<math id="S3.T2.3.3.3.3.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T2.3.3.3.3.1.m1.1a"><mo stretchy="false" id="S3.T2.3.3.3.3.1.m1.1.1" xref="S3.T2.3.3.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.3.1.m1.1b"><ci id="S3.T2.3.3.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.3.1.m1.1c">\downarrow</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.13.13.15.1" class="ltx_tr">
<th id="S3.T2.13.13.15.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Age</th>
<td id="S3.T2.13.13.15.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Softmax Classifier</td>
<td id="S3.T2.13.13.15.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">16.332</td>
<td id="S3.T2.13.13.15.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">74.893</td>
<td id="S3.T2.13.13.15.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">0.956</td>
</tr>
<tr id="S3.T2.6.6.6" class="ltx_tr">
<th id="S3.T2.6.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.85pt;padding-bottom:1.85pt;">(four classes)</th>
<td id="S3.T2.6.6.6.5" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;">Energy-based Classifier</td>
<td id="S3.T2.4.4.4.1" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.4.4.4.1.m1.1" class="ltx_Math" alttext="\mathbf{3.208}" display="inline"><semantics id="S3.T2.4.4.4.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.4.4.4.1.m1.1.1" xref="S3.T2.4.4.4.1.m1.1.1.cmml">3.208</mn><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.1.m1.1b"><cn type="float" id="S3.T2.4.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.4.1.m1.1.1">3.208</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.1.m1.1c">\mathbf{3.208}</annotation></semantics></math></td>
<td id="S3.T2.5.5.5.2" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.5.5.5.2.m1.1" class="ltx_Math" alttext="\mathbf{74.960}" display="inline"><semantics id="S3.T2.5.5.5.2.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.5.5.5.2.m1.1.1" xref="S3.T2.5.5.5.2.m1.1.1.cmml">74.960</mn><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.2.m1.1b"><cn type="float" id="S3.T2.5.5.5.2.m1.1.1.cmml" xref="S3.T2.5.5.5.2.m1.1.1">74.960</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.2.m1.1c">\mathbf{74.960}</annotation></semantics></math></td>
<td id="S3.T2.6.6.6.3" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.6.6.6.3.m1.1" class="ltx_Math" alttext="\mathbf{0.596}" display="inline"><semantics id="S3.T2.6.6.6.3.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.6.6.6.3.m1.1.1" xref="S3.T2.6.6.6.3.m1.1.1.cmml">0.596</mn><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.3.m1.1b"><cn type="float" id="S3.T2.6.6.6.3.m1.1.1.cmml" xref="S3.T2.6.6.6.3.m1.1.1">0.596</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.3.m1.1c">\mathbf{0.596}</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.7.7.7" class="ltx_tr">
<th id="S3.T2.7.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Emotion</th>
<td id="S3.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Softmax Classifier</td>
<td id="S3.T2.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">8.844</td>
<td id="S3.T2.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.7.7.7.1.m1.1" class="ltx_Math" alttext="\mathbf{85.461}" display="inline"><semantics id="S3.T2.7.7.7.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.7.7.7.1.m1.1.1" xref="S3.T2.7.7.7.1.m1.1.1.cmml">85.461</mn><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.1.m1.1b"><cn type="float" id="S3.T2.7.7.7.1.m1.1.1.cmml" xref="S3.T2.7.7.7.1.m1.1.1">85.461</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.1.m1.1c">\mathbf{85.461}</annotation></semantics></math></td>
<td id="S3.T2.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">0.516</td>
</tr>
<tr id="S3.T2.9.9.9" class="ltx_tr">
<th id="S3.T2.9.9.9.3" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.85pt;padding-bottom:1.85pt;">(six classes)</th>
<td id="S3.T2.9.9.9.4" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;">Energy-based Classifier</td>
<td id="S3.T2.8.8.8.1" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.8.8.8.1.m1.1" class="ltx_Math" alttext="\mathbf{2.620}" display="inline"><semantics id="S3.T2.8.8.8.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.8.8.8.1.m1.1.1" xref="S3.T2.8.8.8.1.m1.1.1.cmml">2.620</mn><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.1.m1.1b"><cn type="float" id="S3.T2.8.8.8.1.m1.1.1.cmml" xref="S3.T2.8.8.8.1.m1.1.1">2.620</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.1.m1.1c">\mathbf{2.620}</annotation></semantics></math></td>
<td id="S3.T2.9.9.9.5" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;">84.910</td>
<td id="S3.T2.9.9.9.2" class="ltx_td ltx_align_center" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.9.9.9.2.m1.1" class="ltx_Math" alttext="\mathbf{0.381}" display="inline"><semantics id="S3.T2.9.9.9.2.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.9.9.9.2.m1.1.1" xref="S3.T2.9.9.9.2.m1.1.1.cmml">0.381</mn><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.9.2.m1.1b"><cn type="float" id="S3.T2.9.9.9.2.m1.1.1.cmml" xref="S3.T2.9.9.9.2.m1.1.1">0.381</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.9.2.m1.1c">\mathbf{0.381}</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.10.10.10" class="ltx_tr">
<th id="S3.T2.10.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Language</th>
<td id="S3.T2.10.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">Softmax Classifier</td>
<td id="S3.T2.10.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">5.314</td>
<td id="S3.T2.10.10.10.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.10.10.10.1.m1.1" class="ltx_Math" alttext="\mathbf{86.900}" display="inline"><semantics id="S3.T2.10.10.10.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.10.10.10.1.m1.1.1" xref="S3.T2.10.10.10.1.m1.1.1.cmml">86.900</mn><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.10.1.m1.1b"><cn type="float" id="S3.T2.10.10.10.1.m1.1.1.cmml" xref="S3.T2.10.10.10.1.m1.1.1">86.900</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.10.1.m1.1c">\mathbf{86.900}</annotation></semantics></math></td>
<td id="S3.T2.10.10.10.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.85pt;padding-bottom:1.85pt;">0.439</td>
</tr>
<tr id="S3.T2.13.13.13" class="ltx_tr">
<th id="S3.T2.13.13.13.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1.85pt;padding-bottom:1.85pt;">(ten classes)</th>
<td id="S3.T2.13.13.13.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1.85pt;padding-bottom:1.85pt;">Energy-based Classifier</td>
<td id="S3.T2.11.11.11.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.11.11.11.1.m1.1" class="ltx_Math" alttext="\mathbf{1.044}" display="inline"><semantics id="S3.T2.11.11.11.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.11.11.11.1.m1.1.1" xref="S3.T2.11.11.11.1.m1.1.1.cmml">1.044</mn><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.11.1.m1.1b"><cn type="float" id="S3.T2.11.11.11.1.m1.1.1.cmml" xref="S3.T2.11.11.11.1.m1.1.1">1.044</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.11.1.m1.1c">\mathbf{1.044}</annotation></semantics></math></td>
<td id="S3.T2.12.12.12.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.12.12.12.2.m1.1" class="ltx_Math" alttext="86.334" display="inline"><semantics id="S3.T2.12.12.12.2.m1.1a"><mn id="S3.T2.12.12.12.2.m1.1.1" xref="S3.T2.12.12.12.2.m1.1.1.cmml">86.334</mn><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.12.2.m1.1b"><cn type="float" id="S3.T2.12.12.12.2.m1.1.1.cmml" xref="S3.T2.12.12.12.2.m1.1.1">86.334</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.12.2.m1.1c">86.334</annotation></semantics></math></td>
<td id="S3.T2.13.13.13.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1.85pt;padding-bottom:1.85pt;"><math id="S3.T2.13.13.13.3.m1.1" class="ltx_Math" alttext="\mathbf{0.419}" display="inline"><semantics id="S3.T2.13.13.13.3.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.13.13.13.3.m1.1.1" xref="S3.T2.13.13.13.3.m1.1.1.cmml">0.419</mn><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.13.3.m1.1b"><cn type="float" id="S3.T2.13.13.13.3.m1.1.1.cmml" xref="S3.T2.13.13.13.3.m1.1.1">0.419</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.13.3.m1.1c">\mathbf{0.419}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Table <a href="#S3.T2" title="Table 2 ‣ 3.3 Performance analysis and discussion ‣ 3 Experiments ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the performance of softmax and energy-based classifiers across three classification tasks. The energy-based classifier outperform in the age classification task, achieving a higher accuracy of 74.96% and significantly improving calibration with a reduction in ECE from 16.332% to 3.208%. While the emotion classification task showed a minor accuracy drop, the EBMs exhibited substantial calibration improvement. Likewise, in the language classification task, the energy model demonstrated superior calibration with a notable reduction in ECE. These results highlight the efficacy of energy-based classifiers in enhancing calibration across diverse tasks, suggesting their potential for reliable predictions with well-calibrated uncertainty estimates.

<br class="ltx_break"><span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_bold"> Reliability diagrams.</span>
To evaluate calibration performance, reliability diagrams are utilized, visually representing the consistency between predicted probabilities and actual outcomes in Figures 1. It's evident that EBMs exhibit superior calibration, displaying smaller gaps and significantly lower ECE compared to softmax-based models across three classification scenarios. Particularly, softmax-based models in three speech tasks consistently demonstrate overconfidence, as they tend to assign excessively high probabilities to predicted classes, a common issue observed in deep learning models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Notably, the reliability diagram for language classification using EBMs closely follows the diagonal, achieving an ECE of only 1.0%, indicating nearly perfect calibration. These findings underscore that EBMs can significantly alleviate the issue of overconfidence in speech classification models, thereby achieving better calibration performance.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of ECE (%) for Different Methods</figcaption>
<div id="S3.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:181.5pt;height:66.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.0pt,11.7pt) scale(0.739140831032091,0.739140831032091) ;">
<table id="S3.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.1.1.1.1" class="ltx_tr">
<th id="S3.T3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Methods</th>
<th id="S3.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Age</th>
<th id="S3.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Emotion</th>
<th id="S3.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Language</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.1.1.2.1" class="ltx_tr">
<td id="S3.T3.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">Softmax</td>
<td id="S3.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">16.332</td>
<td id="S3.T3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">8.844</td>
<td id="S3.T3.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">5.314</td>
</tr>
<tr id="S3.T3.1.1.3.2" class="ltx_tr">
<td id="S3.T3.1.1.3.2.1" class="ltx_td ltx_align_center">Temperature Scaling</td>
<td id="S3.T3.1.1.3.2.2" class="ltx_td ltx_align_center">15.027</td>
<td id="S3.T3.1.1.3.2.3" class="ltx_td ltx_align_center">7.965</td>
<td id="S3.T3.1.1.3.2.4" class="ltx_td ltx_align_center">2.297</td>
</tr>
<tr id="S3.T3.1.1.4.3" class="ltx_tr">
<td id="S3.T3.1.1.4.3.1" class="ltx_td ltx_align_center">Logistic Scaling</td>
<td id="S3.T3.1.1.4.3.2" class="ltx_td ltx_align_center">14.282</td>
<td id="S3.T3.1.1.4.3.3" class="ltx_td ltx_align_center">6.809</td>
<td id="S3.T3.1.1.4.3.4" class="ltx_td ltx_align_center">1.463</td>
</tr>
<tr id="S3.T3.1.1.5.4" class="ltx_tr">
<td id="S3.T3.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_b">Energy(Ours)</td>
<td id="S3.T3.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T3.1.1.5.4.2.1" class="ltx_text ltx_font_bold">3.208</span></td>
<td id="S3.T3.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T3.1.1.5.4.3.1" class="ltx_text ltx_font_bold">2.620</span></td>
<td id="S3.T3.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T3.1.1.5.4.4.1" class="ltx_text ltx_font_bold">1.044</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p"><span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_bold">Comparative evaluation of other calibration methods.</span>
We conduct a comparative analysis between EBMs and two post-processing calibration methods, namely Temperature Scaling and Logistic Scaling, across three speech classification tasks. The results are summarized in Table <a href="#S3.T3" title="Table 3 ‣ 3.3 Performance analysis and discussion ‣ 3 Experiments ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> alongside ECEs. It is evident that these two post-processing calibrators provide limited improvement in model calibration. This restricted effectiveness may stem from potential disparities between the auxiliary data and the target distribution, resulting in suboptimal calibration adjustments.
In contrast, EBMs consistently demonstrate superior performance, resulting in significant reductions in the ECE, without the requirement of supplementary training data.
<br class="ltx_break"><span id="S3.SS3.p2.1.2" class="ltx_text ltx_font_bold">Why softmax-based models are poorly calibrated?</span>
As illustrated in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.3 Performance analysis and discussion ‣ 3 Experiments ‣ On Calibration of Speech Classification Models: Insights from Energy-Based Model Investigations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, softmax models prioritize optimizing accuracy over achieving minimizing NLL. This observation aligns with the findings in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which suggest that modern neural networks can overfit to NLL without overfitting accuracy.
This phenomenon indicates that while softmax models may achieve high classification accuracy, they may not necessarily provide well-calibrated probability estimates. In other words, the pursuit of higher accuracy values can sometimes come at the cost of the model's ability to accurately reflect confidence in its predictions, thereby compromising calibration quality.
In contrast, EBMs excel in reducing NLL while maintaining high accuracy. Despite slower convergence during EBM training, they achieve lower NLL and higher confidence levels.

<br class="ltx_break"><span id="S3.SS3.p2.1.3" class="ltx_text ltx_font_bold">Confidence distribution.</span> We analyze the problem of model overconfidence by visualizing the confidence distribution in Figure 3. It demonstrates a significant prevalence of excessively high confidence levels for incorrect predictions across three speech tasks, resulting in unreliable confidence estimates for softmax-based models. For example, within the confidence range of 0.9-1, the softmax-based model for age recognition yields 300 misclassified samples, whereas EBMs show only 10 misclassifications. It is noteworthy that EBMs exhibit a reduction in the confidence range of incorrect predictions across the three speech tasks, with accurate predictions predominantly falling within higher confidence intervals, leading to reliable confidence.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2406.18065/assets/acc-nll.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="534" height="592" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The evolving trends of test ACC and NLL for three speech classification tasks with respect to training epochs.</figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2406.18065/assets/dens-conf.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="538" height="596" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Confidence distributions of softmax-based model and energy-based model.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusions</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this study, we explored the effectiveness of joint EBMs in calibrating speech classification tasks. Our results show that joint EBMs optimize both the classifier and the generative model to enhance calibration by gaining profound insights into the data distribution while also serving as a regularization mechanism, effectively mitigating overfitting tendencies. These findings demonstrate that EBMs can notably generate well-calibrated predictions without compromising accuracy across diverse speech classification tasks.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Rajendran, S. K. Mathivanan, P. Jayagopal, M. Venkatasen, T. Pandi, M. Sorakaya Somanathan, M. Thangaval, and P. Mani, ``Language dialect based speech emotion recognition through deep learning techniques,'' <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Journal of Speech Technology</em>, vol. 24, pp. 625–635, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
D. Yu, J. Li, and L. Deng, ``Calibration of confidence measures in speech recognition,'' <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Audio, Speech, and Language Processing</em>, vol. 19, no. 8, pp. 2461–2473, 2011.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
C. Guo, G. Pleiss, Y. Sun, and K. Q. Weinberger, ``On calibration of modern neural networks,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2017, pp. 1321–1330.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
I. Gitman, V. Lavrukhin, A. Laptev, and B. Ginsburg, ``Confidence-based ensembles of end-to-end speech recognition models,'' in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2017, pp. 11 414–1418.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Huang, Y. Luo, Z. Zhuang, J.-G. Yu, M. He, and Y. Wang, ``Context-aware selective label smoothing for calibrating sequence recognition model,'' in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 29th ACM International Conference on Multimedia</em>, 2021, pp. 4591–4599.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
H.-C. Chou, L. Goncalves, S.-G. Leem, C.-C. Lee, and C. Busso, ``The importance of calibration: Rethinking confidence and performance of speech multi-label emotion classifiers,'' in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023 – 24<sup id="bib.bib6.1.1.1" class="ltx_sup">rd</sup> Annual Conference of the International Speech Communication Association</em>, Dublin, Ireland, Aug. 2023, p. 641–645.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
V. Kubik, A. Jemstedt, H. M. Eshratabadi, B. L. Schwartz, and F. U. Jönsson, ``The underconfidence-with-practice effect in action memory: The contribution of retrieval practice to metacognitive monitoring,'' <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Metacognition and Learning</em>, vol. 17, no. 2, pp. 375–398, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
X. Wang, H. Liu, C. Shi, and C. Yang, ``Be confident! towards trustworthy graph neural networks via confidence calibration,'' <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, vol. 34, pp. 23 768–23 779, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
D. Wang, B. Gong, and L. Wang, ``On calibrating semantic segmentation models: Analyses and an algorithm,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2023, pp. 23 652–23 662.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
G. Pereyra, G. Tucker, J. Chorowski, Ł. Kaiser, and G. Hinton, ``Regularizing neural networks by penalizing confident output distributions,'' <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1701.06548</em>, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
T. Jung, D. Kang, H. Cheng, L. Mentch, and T. Schaaf, ``Posterior calibrated training on sentence classification tasks,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</em>, 2020, pp. 2723–2730.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
W. Grathwohl, K.-C. Wang, J.-H. Jacobsen, D. Duvenaud, M. Norouzi, and K. Swersky, ``Your classifier is secretly an energy based model and you should treat it like one,'' in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Song and D. P. Kingma, ``How to train your energy-based models,'' <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.03288</em>, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
X. Yang and S. Ji, ``Jem++: Improved techniques for training jem,'' in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2021, pp. 6494–6503.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
X. Yang, Q. Su, and S. Ji, ``Towards bridging the performance gaps of joint energy-based models,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2023, pp. 15 732–15 741.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. LeCun, S. Chopra, R. Hadsell, M. Ranzato, and F. Huang, ``A tutorial on energy-based learning,'' <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Predicting structured data</em>, vol. 1, no. 0, 2006.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Z. Ou <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Energy-based models with applications to speech and language processing,'' <em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic">Foundations and Trends® in Signal Processing</em>, vol. 18, no. 1-2, pp. 1–199, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
W. Liu, X. Wang, J. Owens, and Y. Li, ``Energy-based out-of-distribution detection,'' <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 33, pp. 21 464–21 475.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. Mortier, V. Bengs, E. Hüllermeier, S. Luca, and W. Waegeman, ``On the calibration of probabilistic classifier sets,'' in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics</em>.   PMLR, 2023, pp. 8857–8870.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
D. Wang, L. Li, D. Tang, and Q. Chen, ``Ap16-ol7: A multilingual database for oriental languages and a language recognition baseline,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">2016 Asia-Pacific Signal and Information Processing Association Annual Summit and Conference (APSIPA)</em>.   IEEE, 2016, pp. 1–5.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Li, J. Tao, L. Chao, W. Bao, and Y. Liu, ``Cheavd: a chinese natural emotional audio–visual database,'' <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Journal of Ambient Intelligence and Humanized Computing</em>, vol. 8, pp. 913–924, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
K. Hechmi, T. N. Trong, V. Hautamäki, and T. Kinnunen, ``Voxceleb enrichment for age and gender recognition,'' in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</em>.   IEEE, 2021, pp. 687–693.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
B. McFee, C. Raffel, D. Liang, D. P. Ellis, M. McVicar, E. Battenberg, and O. Nieto, ``librosa: Audio and music signal analysis in python,'' in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 14th python in science conference</em>, vol. 8, 2015, pp. 18–25.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
S. Zagoruyko and N. Komodakis, ``Wide residual networks,'' <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1605.07146</em>, 2016.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
L. Bottou, ``Large-scale machine learning with stochastic gradient descent,'' in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of COMPSTAT'2010: 19th International Conference on Computational StatisticsParis France, August 22-27, 2010 Keynote, Invited and Contributed Papers</em>.   Springer, 2010, pp. 177–186.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.18064" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.18065" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.18065">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.18065" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.18066" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 17:54:00 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
