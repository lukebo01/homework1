<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.10180] Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR</title><meta property="og:description" content="Contextual biasing enables speech recognizers to transcribe important phrases in the speaker’s context, such as contact names, even if they are rare in, or absent from, the training data. Attention-based biasing is a l…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.10180">

<!--Generated on Sun May  5 22:25:35 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zelin Wu        Gan Song        Christopher Li        Pat Rondon        Zhong Meng 
<br class="ltx_break"><span id="id10.10.id1" class="ltx_text ltx_font_bold">Xavier Velez</span>        <span id="id11.11.id2" class="ltx_text ltx_font_bold">Weiran Wang</span>        <span id="id12.12.id3" class="ltx_text ltx_font_bold">Diamantino Caseiro</span>        <span id="id13.13.id4" class="ltx_text ltx_font_bold">Golan Pundak</span> 
<br class="ltx_break"><span id="id14.14.id5" class="ltx_text ltx_font_bold">Tsendsuren Munkhdalai</span>        <span id="id15.15.id6" class="ltx_text ltx_font_bold">Angad Chandorkar</span>        <span id="id16.16.id7" class="ltx_text ltx_font_bold">Rohit Prabhavalkar</span> 
<br class="ltx_break">Google LLC, USA 
<br class="ltx_break"><span id="id17.17.id8" class="ltx_text ltx_font_typewriter">{zelinwu, gansong, chriswli, rondon, zhongmeng, xavvelez}@google.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id18.id1" class="ltx_p">Contextual biasing enables speech recognizers to transcribe important phrases in the speaker’s context, such as contact names, even if they are rare in, or absent from, the training data. Attention-based biasing is a leading approach which allows for full end-to-end cotraining of the recognizer and biasing system and requires no separate inference-time components. Such biasers typically consist of a context encoder; followed by a context filter which narrows down the context to apply, improving per-step inference time; and, finally, context application via cross attention. Though much work has gone into optimizing per-frame performance, the context encoder is at least as important: recognition cannot begin before context encoding ends. Here, we
show the lightweight phrase selection pass can be moved before context encoding, resulting in a speedup of up to 16.1 times and enabling biasing to scale to 20K phrases with a maximum pre-decoding delay under 33ms. With the addition of phrase- and wordpiece-level cross-entropy losses, our technique also achieves up to a 37.5% relative WER reduction over the baseline without the losses and lightweight phrase selection pass.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.9" class="ltx_block ltx_align_bottom">
<p id="p1.9.10" class="ltx_p"><span id="p1.9.10.1" class="ltx_text ltx_font_bold">Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.9.9" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.9.9.9" class="ltx_text ltx_inline-block" style="width:0.0pt;">

<span id="p1.9.9.9.9" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.4.4.4.4.4" class="ltx_tr">
<span id="p1.4.4.4.4.4.4" class="ltx_td ltx_align_center"><span id="p1.4.4.4.4.4.4.4" class="ltx_text ltx_font_bold">Zelin Wu        Gan Song        Christopher Li        Pat Rondon        Zhong Meng</span></span></span>
<span id="p1.7.7.7.7.7" class="ltx_tr">
<span id="p1.7.7.7.7.7.3" class="ltx_td ltx_align_center"><span id="p1.7.7.7.7.7.3.1" class="ltx_text ltx_font_bold">Xavier Velez</span>        <span id="p1.7.7.7.7.7.3.2" class="ltx_text ltx_font_bold">Weiran Wang</span>        <span id="p1.7.7.7.7.7.3.3" class="ltx_text ltx_font_bold">Diamantino Caseiro</span>        <span id="p1.7.7.7.7.7.3.4" class="ltx_text ltx_font_bold">Golan Pundak</span></span></span>
<span id="p1.9.9.9.9.9" class="ltx_tr">
<span id="p1.9.9.9.9.9.2" class="ltx_td ltx_align_center"><span id="p1.9.9.9.9.9.2.1" class="ltx_text ltx_font_bold">Tsendsuren Munkhdalai</span>        <span id="p1.9.9.9.9.9.2.2" class="ltx_text ltx_font_bold">Angad Chandorkar</span>        <span id="p1.9.9.9.9.9.2.3" class="ltx_text ltx_font_bold">Rohit Prabhavalkar</span></span></span>
<span id="p1.9.9.9.9.10.1" class="ltx_tr">
<span id="p1.9.9.9.9.10.1.1" class="ltx_td ltx_align_center">Google LLC, USA</span></span>
<span id="p1.9.9.9.9.11.2" class="ltx_tr">
<span id="p1.9.9.9.9.11.2.1" class="ltx_td ltx_align_center"><span id="p1.9.9.9.9.11.2.1.1" class="ltx_text ltx_font_typewriter">{zelinwu, gansong, chriswli, rondon, zhongmeng, xavvelez}@google.com</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Automatic speech recognition (ASR) applications often succeed or fail based on their ability to recognize words that are relevant in context, but may not be common, or even present, in the training data.
For example, an assistant user may speak contact names from another language or titles of media entities which were released after the ASR system was trained, or the speaker may use domain-specific jargon, like legalese or medical terms, which are not common in the more-typical speech used for training.
ASR contextual biasing <cite class="ltx_cite ltx_citemacro_cite">Hall et al. (<a href="#bib.bib14" title="" class="ltx_ref">2015</a>); Aleksic et al. (<a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite> aims to account for this domain shift between training and inference.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Attention-based biasing <cite class="ltx_cite ltx_citemacro_cite">Pundak et al. (<a href="#bib.bib27" title="" class="ltx_ref">2018</a>)</cite>, in which the context is encoded into dense embeddings attended to during recognition, is one of the leading approaches for contextualizing end-to-end (E2E) ASR systems.
As a fully-end-to-end method, it does not require separate biasing components which must be separately trained and whose integration with the core ASR system must be optimized.
However, recognition cannot begin until the inference-time context has been encoded, and this context may consist of tens of thousands of items which may not be cached, for privacy or system design reasons or, more simply, because the context may change at any point up until the beginning of recognition.
Thus, the context encoder must be able to efficiently handle very large contexts, as delays in context encoding translate directly into user-visible delays in ASR transcription.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.2" class="ltx_p">In this work, we optimize context encoding by splitting it into two passes.
We make the simplifying assumption that our ASR system is non-causal and can access the entire audio input;
we argue that this choice is not overly restrictive, as two-pass ASR systems combining a causal ASR system to produce streaming results with a non-causal ASR system for producing the final result have become common, e.g., as in <cite class="ltx_cite ltx_citemacro_cite">Narayanan et al. (<a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>.
With the speaker’s entire audio available before context encoding begins, we can split context encoding into two phases.
First, we encode all contextual phrases with an extremely lightweight encoder, and use the resulting encodings to determine the <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">k</annotation></semantics></math> phrases that are most likely to occur in the audio.
We embed only the <math id="S1.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.2.m2.1a"><mi id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">k</annotation></semantics></math> most-likely phrases with a more powerful — but more expensive — encoder, and use the output of this “deferred” encoder for biasing.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Conventional ASR contextualization relies on discrete contextualization components like (class-based) language models (LMs) <cite class="ltx_cite ltx_citemacro_cite">Vasserman et al. (<a href="#bib.bib35" title="" class="ltx_ref">2016</a>)</cite>, combined with the base ASR system through on-the-fly LM rescoring <cite class="ltx_cite ltx_citemacro_cite">Aleksic et al. (<a href="#bib.bib1" title="" class="ltx_ref">2015</a>); Hall et al. (<a href="#bib.bib14" title="" class="ltx_ref">2015</a>); McGraw et al. (<a href="#bib.bib21" title="" class="ltx_ref">2016</a>)</cite>, shallow fusion <cite class="ltx_cite ltx_citemacro_cite">Williams et al. (<a href="#bib.bib37" title="" class="ltx_ref">2018</a>); Zhao et al. (<a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite>, or lattice rewriting <cite class="ltx_cite ltx_citemacro_cite">Serrino et al. (<a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> and contextual spelling correctors <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>); Antonova et al. (<a href="#bib.bib3" title="" class="ltx_ref">2023</a>)</cite>.
The use of discrete contextualization components requires the implementor of an ASR system to separately train the ASR and contextualization components, to separately optimize their combination, and to take care that all relevant signals, like the input audio, are forwarded from ASR to the contextualization system.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Attention-based biasing <cite class="ltx_cite ltx_citemacro_cite">Pundak et al. (<a href="#bib.bib27" title="" class="ltx_ref">2018</a>); Chang et al. (<a href="#bib.bib6" title="" class="ltx_ref">2021</a>); Munkhdalai et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite>, in which the ASR network learns to use inference-time context through attention, and thus requires no separate contextualization components and can be optimized end-to-end by standard backpropagation, has become a popular method for contextualization of end-to-end ASR models.
The core technique has spawned several distinct lines of complementary research.
There are threads of work on improving data efficiency by adapter-style training <cite class="ltx_cite ltx_citemacro_cite">Sathyendra et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite> or improving training on synthetic audio derived from text-only data <cite class="ltx_cite ltx_citemacro_cite">Naowarat et al. (<a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite>.
Work on precision improvements seeks to lower the rate of over-biasing through hierarchical or gated attention <cite class="ltx_cite ltx_citemacro_cite">Han et al. (<a href="#bib.bib15" title="" class="ltx_ref">2022</a>); Munkhdalai et al. (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>); Wu et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>); Tong et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023a</a>); Xu et al. (<a href="#bib.bib39" title="" class="ltx_ref">2023a</a>); Alexandridis et al. (<a href="#bib.bib2" title="" class="ltx_ref">2023</a>)</cite>
or through slot triggering <cite class="ltx_cite ltx_citemacro_cite">Lu et al. (<a href="#bib.bib20" title="" class="ltx_ref">2023</a>); Tong et al. (<a href="#bib.bib34" title="" class="ltx_ref">2023b</a>)</cite>;
often, such techniques can improve not only quality but also per-step inference run time <cite class="ltx_cite ltx_citemacro_cite">Munkhdalai et al. (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>); Yang et al. (<a href="#bib.bib41" title="" class="ltx_ref">2023</a>)</cite>.
Notably, Tong et al <cite class="ltx_cite ltx_citemacro_cite">Tong et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023a</a>)</cite> improve WER through an auxiliary slot-level cross-entropy loss.
We do not use slots for selecting context to bias, as we have found it possible to get high performance with hierarchical attention alone; however, in this work, we do apply a phrase-level, rather than slot-level, cross-entropy loss during training to improve WER.
Further we extend the technique to a novel wordpiece-level cross-entropy loss.
Further work aims to improve quality on biased utterances by providing the context encoder with more information than just the graphemic biasing phrases, including phoneme-level features <cite class="ltx_cite ltx_citemacro_cite">Bruguier et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>); Hu et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>); Chen et al. (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>); Pandey et al. (<a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite>, and augmenting the context encoder with semantics-aware embeddings from a pretrained BERT model <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a href="#bib.bib10" title="" class="ltx_ref">2023</a>)</cite>.
Attention-based biasing can also be complemented by shallow fusion with (contextualized) language models <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib40" title="" class="ltx_ref">2023b</a>)</cite> or combinations of language models and contextualized rescoring <cite class="ltx_cite ltx_citemacro_cite">Dingliwal et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> for further quality improvements.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">We distinguish the current work from most of the above by focusing on the inference run time of the <em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">context encoder</em> which, as noted in Section <a href="#S1" title="1 Introduction ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, is critical to the usability of contextualized ASR.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Dual-mode NAM</h3>

<figure id="S2.F1" class="ltx_figure">
<p id="S2.F1.1.1" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="S2.F1.1.1.1" class="ltx_text"><img src="/html/2404.10180/assets/x1.png" id="S2.F1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="173" height="45" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Inference with Dual-mode NAM.</figcaption>
</figure>
<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.9" class="ltx_p">Our work builds on Dual-mode NAM (Neural Associative Memory) <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite> and its shared query encoder variant from Section 3.4.2 of <cite class="ltx_cite ltx_citemacro_cite">Song et al. (<a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>, which we use as a baseline.
Dual-mode NAM computes both phrase encodings <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="E^{p}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><msup id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">E</mi><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐸</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">E^{p}</annotation></semantics></math> and wordpiece (WP) encodings <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="E^{w}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msup id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">E</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝐸</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">E^{w}</annotation></semantics></math> through a fine-grained context encoder, where <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="E^{p}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msup id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">E</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝐸</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">E^{p}</annotation></semantics></math> corresponds to the <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="cls" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.1.1a" xref="S2.SS1.p1.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS1.p1.4.m4.1.1.4" xref="S2.SS1.p1.4.m4.1.1.4.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><times id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></times><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑐</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑙</ci><ci id="S2.SS1.p1.4.m4.1.1.4.cmml" xref="S2.SS1.p1.4.m4.1.1.4">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">cls</annotation></semantics></math> embedding and <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="E^{w}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msup id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">E</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝐸</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">E^{w}</annotation></semantics></math> corresponds to the bias phrase WP embeddings of <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">Z</annotation></semantics></math>; <math id="S2.SS1.p1.7.m7.8" class="ltx_Math" alttext="Z=\{{cls;w_{n,1},...,w_{n,L}}\}^{N}_{n=1}" display="inline"><semantics id="S2.SS1.p1.7.m7.8a"><mrow id="S2.SS1.p1.7.m7.8.8" xref="S2.SS1.p1.7.m7.8.8.cmml"><mi id="S2.SS1.p1.7.m7.8.8.5" xref="S2.SS1.p1.7.m7.8.8.5.cmml">Z</mi><mo id="S2.SS1.p1.7.m7.8.8.4" xref="S2.SS1.p1.7.m7.8.8.4.cmml">=</mo><msubsup id="S2.SS1.p1.7.m7.8.8.3" xref="S2.SS1.p1.7.m7.8.8.3.cmml"><mrow id="S2.SS1.p1.7.m7.8.8.3.3.3.3" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.8.8.3.3.3.3.4" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml">{</mo><mrow id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.2" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.3" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1a" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.4" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S2.SS1.p1.7.m7.8.8.3.3.3.3.5" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml">;</mo><msub id="S2.SS1.p1.7.m7.7.7.2.2.2.2.2" xref="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.2" xref="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.2.cmml">w</mi><mrow id="S2.SS1.p1.7.m7.2.2.2.4" xref="S2.SS1.p1.7.m7.2.2.2.3.cmml"><mi id="S2.SS1.p1.7.m7.1.1.1.1" xref="S2.SS1.p1.7.m7.1.1.1.1.cmml">n</mi><mo id="S2.SS1.p1.7.m7.2.2.2.4.1" xref="S2.SS1.p1.7.m7.2.2.2.3.cmml">,</mo><mn id="S2.SS1.p1.7.m7.2.2.2.2" xref="S2.SS1.p1.7.m7.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S2.SS1.p1.7.m7.8.8.3.3.3.3.6" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.7.m7.5.5" xref="S2.SS1.p1.7.m7.5.5.cmml">…</mi><mo id="S2.SS1.p1.7.m7.8.8.3.3.3.3.7" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p1.7.m7.8.8.3.3.3.3.3" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.2" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.2.cmml">w</mi><mrow id="S2.SS1.p1.7.m7.4.4.2.4" xref="S2.SS1.p1.7.m7.4.4.2.3.cmml"><mi id="S2.SS1.p1.7.m7.3.3.1.1" xref="S2.SS1.p1.7.m7.3.3.1.1.cmml">n</mi><mo id="S2.SS1.p1.7.m7.4.4.2.4.1" xref="S2.SS1.p1.7.m7.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p1.7.m7.4.4.2.2" xref="S2.SS1.p1.7.m7.4.4.2.2.cmml">L</mi></mrow></msub><mo stretchy="false" id="S2.SS1.p1.7.m7.8.8.3.3.3.3.8" xref="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml">}</mo></mrow><mrow id="S2.SS1.p1.7.m7.8.8.3.5" xref="S2.SS1.p1.7.m7.8.8.3.5.cmml"><mi id="S2.SS1.p1.7.m7.8.8.3.5.2" xref="S2.SS1.p1.7.m7.8.8.3.5.2.cmml">n</mi><mo id="S2.SS1.p1.7.m7.8.8.3.5.1" xref="S2.SS1.p1.7.m7.8.8.3.5.1.cmml">=</mo><mn id="S2.SS1.p1.7.m7.8.8.3.5.3" xref="S2.SS1.p1.7.m7.8.8.3.5.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.7.m7.8.8.3.3.5" xref="S2.SS1.p1.7.m7.8.8.3.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.8b"><apply id="S2.SS1.p1.7.m7.8.8.cmml" xref="S2.SS1.p1.7.m7.8.8"><eq id="S2.SS1.p1.7.m7.8.8.4.cmml" xref="S2.SS1.p1.7.m7.8.8.4"></eq><ci id="S2.SS1.p1.7.m7.8.8.5.cmml" xref="S2.SS1.p1.7.m7.8.8.5">𝑍</ci><apply id="S2.SS1.p1.7.m7.8.8.3.cmml" xref="S2.SS1.p1.7.m7.8.8.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.8.8.3.4.cmml" xref="S2.SS1.p1.7.m7.8.8.3">subscript</csymbol><apply id="S2.SS1.p1.7.m7.8.8.3.3.cmml" xref="S2.SS1.p1.7.m7.8.8.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.8.8.3.3.4.cmml" xref="S2.SS1.p1.7.m7.8.8.3">superscript</csymbol><list id="S2.SS1.p1.7.m7.8.8.3.3.3.4.cmml" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3"><apply id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1"><times id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.1"></times><ci id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.2">𝑐</ci><ci id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.3">𝑙</ci><ci id="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.4.cmml" xref="S2.SS1.p1.7.m7.6.6.1.1.1.1.1.4">𝑠</ci></apply><apply id="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.7.m7.7.7.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.7.7.2.2.2.2.2.2">𝑤</ci><list id="S2.SS1.p1.7.m7.2.2.2.3.cmml" xref="S2.SS1.p1.7.m7.2.2.2.4"><ci id="S2.SS1.p1.7.m7.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1.1">𝑛</ci><cn type="integer" id="S2.SS1.p1.7.m7.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.2.2.2.2">1</cn></list></apply><ci id="S2.SS1.p1.7.m7.5.5.cmml" xref="S2.SS1.p1.7.m7.5.5">…</ci><apply id="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.cmml" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.7.m7.8.8.3.3.3.3.3.2">𝑤</ci><list id="S2.SS1.p1.7.m7.4.4.2.3.cmml" xref="S2.SS1.p1.7.m7.4.4.2.4"><ci id="S2.SS1.p1.7.m7.3.3.1.1.cmml" xref="S2.SS1.p1.7.m7.3.3.1.1">𝑛</ci><ci id="S2.SS1.p1.7.m7.4.4.2.2.cmml" xref="S2.SS1.p1.7.m7.4.4.2.2">𝐿</ci></list></apply></list><ci id="S2.SS1.p1.7.m7.8.8.3.3.5.cmml" xref="S2.SS1.p1.7.m7.8.8.3.3.5">𝑁</ci></apply><apply id="S2.SS1.p1.7.m7.8.8.3.5.cmml" xref="S2.SS1.p1.7.m7.8.8.3.5"><eq id="S2.SS1.p1.7.m7.8.8.3.5.1.cmml" xref="S2.SS1.p1.7.m7.8.8.3.5.1"></eq><ci id="S2.SS1.p1.7.m7.8.8.3.5.2.cmml" xref="S2.SS1.p1.7.m7.8.8.3.5.2">𝑛</ci><cn type="integer" id="S2.SS1.p1.7.m7.8.8.3.5.3.cmml" xref="S2.SS1.p1.7.m7.8.8.3.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.8c">Z=\{{cls;w_{n,1},...,w_{n,L}}\}^{N}_{n=1}</annotation></semantics></math>, <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">N</annotation></semantics></math> is the number of bias phrases associated with the utterance and <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">L</annotation></semantics></math> is the number of WPs per bias phrase.</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\displaystyle E^{p},E^{w}=\mathit{ContextEncoder}(Z)" display="inline"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml"><mrow id="S2.E1.m1.3.3.2.2" xref="S2.E1.m1.3.3.2.3.cmml"><msup id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">E</mi><mi id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.3.cmml">p</mi></msup><mo id="S2.E1.m1.3.3.2.2.3" xref="S2.E1.m1.3.3.2.3.cmml">,</mo><msup id="S2.E1.m1.3.3.2.2.2" xref="S2.E1.m1.3.3.2.2.2.cmml"><mi id="S2.E1.m1.3.3.2.2.2.2" xref="S2.E1.m1.3.3.2.2.2.2.cmml">E</mi><mi id="S2.E1.m1.3.3.2.2.2.3" xref="S2.E1.m1.3.3.2.2.2.3.cmml">w</mi></msup></mrow><mo id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.4" xref="S2.E1.m1.3.3.4.cmml"><mi id="S2.E1.m1.3.3.4.2" xref="S2.E1.m1.3.3.4.2.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.4.1" xref="S2.E1.m1.3.3.4.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.4.3.2" xref="S2.E1.m1.3.3.4.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.4.3.2.1" xref="S2.E1.m1.3.3.4.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">Z</mi><mo stretchy="false" id="S2.E1.m1.3.3.4.3.2.2" xref="S2.E1.m1.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"><eq id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3"></eq><list id="S2.E1.m1.3.3.2.3.cmml" xref="S2.E1.m1.3.3.2.2"><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2">𝐸</ci><ci id="S2.E1.m1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.3">𝑝</ci></apply><apply id="S2.E1.m1.3.3.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.2.2.2">superscript</csymbol><ci id="S2.E1.m1.3.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2.2">𝐸</ci><ci id="S2.E1.m1.3.3.2.2.2.3.cmml" xref="S2.E1.m1.3.3.2.2.2.3">𝑤</ci></apply></list><apply id="S2.E1.m1.3.3.4.cmml" xref="S2.E1.m1.3.3.4"><times id="S2.E1.m1.3.3.4.1.cmml" xref="S2.E1.m1.3.3.4.1"></times><ci id="S2.E1.m1.3.3.4.2.cmml" xref="S2.E1.m1.3.3.4.2">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle E^{p},E^{w}=\mathit{ContextEncoder}(Z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.5" class="ltx_p">The phrase and WP attentions are trained via sampling: The phrase and WP attention contexts <math id="S2.SS1.p2.1.m1.1" class="ltx_math_unparsed" alttext="(c^{p}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1b"><mo stretchy="false" id="S2.SS1.p2.1.m1.1.1">(</mo><msup id="S2.SS1.p2.1.m1.1.2"><mi id="S2.SS1.p2.1.m1.1.2.2">c</mi><mi id="S2.SS1.p2.1.m1.1.2.3">p</mi></msup></mrow><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">(c^{p}</annotation></semantics></math>, <math id="S2.SS1.p2.2.m2.1" class="ltx_math_unparsed" alttext="c^{w})" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1b"><msup id="S2.SS1.p2.2.m2.1.1"><mi id="S2.SS1.p2.2.m2.1.1.2">c</mi><mi id="S2.SS1.p2.2.m2.1.1.3">w</mi></msup><mo stretchy="false" id="S2.SS1.p2.2.m2.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">c^{w})</annotation></semantics></math> are added to the audio encoder features <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">x</annotation></semantics></math> with a probability of <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">p</annotation></semantics></math> and <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="1-p" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><mrow id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mn id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">1</mn><mo id="S2.SS1.p2.5.m5.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.cmml">−</mo><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><minus id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1"></minus><cn type="integer" id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">1</cn><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">1-p</annotation></semantics></math>, respectively.</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\displaystyle x^{biased}=x+\mathit{BernoulliTrial}(c^{p},c^{w},p)" display="inline"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml"><msup id="S2.E2.m1.3.3.4" xref="S2.E2.m1.3.3.4.cmml"><mi id="S2.E2.m1.3.3.4.2" xref="S2.E2.m1.3.3.4.2.cmml">x</mi><mrow id="S2.E2.m1.3.3.4.3" xref="S2.E2.m1.3.3.4.3.cmml"><mi id="S2.E2.m1.3.3.4.3.2" xref="S2.E2.m1.3.3.4.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.4.3.1" xref="S2.E2.m1.3.3.4.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.4.3.3" xref="S2.E2.m1.3.3.4.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.4.3.1a" xref="S2.E2.m1.3.3.4.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.4.3.4" xref="S2.E2.m1.3.3.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.4.3.1b" xref="S2.E2.m1.3.3.4.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.4.3.5" xref="S2.E2.m1.3.3.4.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.4.3.1c" xref="S2.E2.m1.3.3.4.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.4.3.6" xref="S2.E2.m1.3.3.4.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.4.3.1d" xref="S2.E2.m1.3.3.4.3.1.cmml">​</mo><mi id="S2.E2.m1.3.3.4.3.7" xref="S2.E2.m1.3.3.4.3.7.cmml">d</mi></mrow></msup><mo id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml">=</mo><mrow id="S2.E2.m1.3.3.2" xref="S2.E2.m1.3.3.2.cmml"><mi id="S2.E2.m1.3.3.2.4" xref="S2.E2.m1.3.3.2.4.cmml">x</mi><mo id="S2.E2.m1.3.3.2.3" xref="S2.E2.m1.3.3.2.3.cmml">+</mo><mrow id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.4" xref="S2.E2.m1.3.3.2.2.4.cmml">𝐵𝑒𝑟𝑛𝑜𝑢𝑙𝑙𝑖𝑇𝑟𝑖𝑎𝑙</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.2.2.3" xref="S2.E2.m1.3.3.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.3.3.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.2.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.3.cmml">(</mo><msup id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.2.cmml">c</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.E2.m1.3.3.2.2.2.2.4" xref="S2.E2.m1.3.3.2.2.2.3.cmml">,</mo><msup id="S2.E2.m1.3.3.2.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.2.2.cmml">c</mi><mi id="S2.E2.m1.3.3.2.2.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.2.2.3.cmml">w</mi></msup><mo id="S2.E2.m1.3.3.2.2.2.2.5" xref="S2.E2.m1.3.3.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">p</mi><mo stretchy="false" id="S2.E2.m1.3.3.2.2.2.2.6" xref="S2.E2.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3"><eq id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"></eq><apply id="S2.E2.m1.3.3.4.cmml" xref="S2.E2.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.4.1.cmml" xref="S2.E2.m1.3.3.4">superscript</csymbol><ci id="S2.E2.m1.3.3.4.2.cmml" xref="S2.E2.m1.3.3.4.2">𝑥</ci><apply id="S2.E2.m1.3.3.4.3.cmml" xref="S2.E2.m1.3.3.4.3"><times id="S2.E2.m1.3.3.4.3.1.cmml" xref="S2.E2.m1.3.3.4.3.1"></times><ci id="S2.E2.m1.3.3.4.3.2.cmml" xref="S2.E2.m1.3.3.4.3.2">𝑏</ci><ci id="S2.E2.m1.3.3.4.3.3.cmml" xref="S2.E2.m1.3.3.4.3.3">𝑖</ci><ci id="S2.E2.m1.3.3.4.3.4.cmml" xref="S2.E2.m1.3.3.4.3.4">𝑎</ci><ci id="S2.E2.m1.3.3.4.3.5.cmml" xref="S2.E2.m1.3.3.4.3.5">𝑠</ci><ci id="S2.E2.m1.3.3.4.3.6.cmml" xref="S2.E2.m1.3.3.4.3.6">𝑒</ci><ci id="S2.E2.m1.3.3.4.3.7.cmml" xref="S2.E2.m1.3.3.4.3.7">𝑑</ci></apply></apply><apply id="S2.E2.m1.3.3.2.cmml" xref="S2.E2.m1.3.3.2"><plus id="S2.E2.m1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3"></plus><ci id="S2.E2.m1.3.3.2.4.cmml" xref="S2.E2.m1.3.3.2.4">𝑥</ci><apply id="S2.E2.m1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2"><times id="S2.E2.m1.3.3.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.3"></times><ci id="S2.E2.m1.3.3.2.2.4.cmml" xref="S2.E2.m1.3.3.2.2.4">𝐵𝑒𝑟𝑛𝑜𝑢𝑙𝑙𝑖𝑇𝑟𝑖𝑎𝑙</ci><vector id="S2.E2.m1.3.3.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.2"><apply id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.2">𝑐</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E2.m1.3.3.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2">superscript</csymbol><ci id="S2.E2.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.2">𝑐</ci><ci id="S2.E2.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.3">𝑤</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑝</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\displaystyle x^{biased}=x+\mathit{BernoulliTrial}(c^{p},c^{w},p)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.5" class="ltx_p">During inference (Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Dual-mode NAM ‣ 2 Related Work ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), the model leverages the phrase-level attention logits to select per-frame top-<math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><mi id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">k</annotation></semantics></math> (<math id="S2.SS1.p3.2.m2.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S2.SS1.p3.2.m2.1a"><msup id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">k</mi><mi id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">superscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝑘</ci><ci id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">k^{p}</annotation></semantics></math>) phrases and feed their WP encodings to the WP attention, where <math id="S2.SS1.p3.3.m3.2" class="ltx_Math" alttext="q_{t,h}^{p}" display="inline"><semantics id="S2.SS1.p3.3.m3.2a"><msubsup id="S2.SS1.p3.3.m3.2.3" xref="S2.SS1.p3.3.m3.2.3.cmml"><mi id="S2.SS1.p3.3.m3.2.3.2.2" xref="S2.SS1.p3.3.m3.2.3.2.2.cmml">q</mi><mrow id="S2.SS1.p3.3.m3.2.2.2.4" xref="S2.SS1.p3.3.m3.2.2.2.3.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml">t</mi><mo id="S2.SS1.p3.3.m3.2.2.2.4.1" xref="S2.SS1.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p3.3.m3.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.cmml">h</mi></mrow><mi id="S2.SS1.p3.3.m3.2.3.3" xref="S2.SS1.p3.3.m3.2.3.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.2b"><apply id="S2.SS1.p3.3.m3.2.3.cmml" xref="S2.SS1.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.2.3.1.cmml" xref="S2.SS1.p3.3.m3.2.3">superscript</csymbol><apply id="S2.SS1.p3.3.m3.2.3.2.cmml" xref="S2.SS1.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.2.3.2.1.cmml" xref="S2.SS1.p3.3.m3.2.3">subscript</csymbol><ci id="S2.SS1.p3.3.m3.2.3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.3.2.2">𝑞</ci><list id="S2.SS1.p3.3.m3.2.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.4"><ci id="S2.SS1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1">𝑡</ci><ci id="S2.SS1.p3.3.m3.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2">ℎ</ci></list></apply><ci id="S2.SS1.p3.3.m3.2.3.3.cmml" xref="S2.SS1.p3.3.m3.2.3.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.2c">q_{t,h}^{p}</annotation></semantics></math> and <math id="S2.SS1.p3.4.m4.2" class="ltx_Math" alttext="K_{t,h}^{p}" display="inline"><semantics id="S2.SS1.p3.4.m4.2a"><msubsup id="S2.SS1.p3.4.m4.2.3" xref="S2.SS1.p3.4.m4.2.3.cmml"><mi id="S2.SS1.p3.4.m4.2.3.2.2" xref="S2.SS1.p3.4.m4.2.3.2.2.cmml">K</mi><mrow id="S2.SS1.p3.4.m4.2.2.2.4" xref="S2.SS1.p3.4.m4.2.2.2.3.cmml"><mi id="S2.SS1.p3.4.m4.1.1.1.1" xref="S2.SS1.p3.4.m4.1.1.1.1.cmml">t</mi><mo id="S2.SS1.p3.4.m4.2.2.2.4.1" xref="S2.SS1.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p3.4.m4.2.2.2.2" xref="S2.SS1.p3.4.m4.2.2.2.2.cmml">h</mi></mrow><mi id="S2.SS1.p3.4.m4.2.3.3" xref="S2.SS1.p3.4.m4.2.3.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.2b"><apply id="S2.SS1.p3.4.m4.2.3.cmml" xref="S2.SS1.p3.4.m4.2.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.2.3.1.cmml" xref="S2.SS1.p3.4.m4.2.3">superscript</csymbol><apply id="S2.SS1.p3.4.m4.2.3.2.cmml" xref="S2.SS1.p3.4.m4.2.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.2.3.2.1.cmml" xref="S2.SS1.p3.4.m4.2.3">subscript</csymbol><ci id="S2.SS1.p3.4.m4.2.3.2.2.cmml" xref="S2.SS1.p3.4.m4.2.3.2.2">𝐾</ci><list id="S2.SS1.p3.4.m4.2.2.2.3.cmml" xref="S2.SS1.p3.4.m4.2.2.2.4"><ci id="S2.SS1.p3.4.m4.1.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1.1.1">𝑡</ci><ci id="S2.SS1.p3.4.m4.2.2.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2.2.2">ℎ</ci></list></apply><ci id="S2.SS1.p3.4.m4.2.3.3.cmml" xref="S2.SS1.p3.4.m4.2.3.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.2c">K_{t,h}^{p}</annotation></semantics></math> correspond to the projected audio query and <math id="S2.SS1.p3.5.m5.1" class="ltx_Math" alttext="E^{p}" display="inline"><semantics id="S2.SS1.p3.5.m5.1a"><msup id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">E</mi><mi id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝐸</ci><ci id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">E^{p}</annotation></semantics></math> encodings.</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.6" class="ltx_Math" alttext="\displaystyle I_{t}^{p}=\mathit{TopK}(\frac{1}{H}\sum_{h=1}^{H}q_{t,h}^{p}K_{t,h}^{p},k^{p})" display="inline"><semantics id="S2.E3.m1.6a"><mrow id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><msubsup id="S2.E3.m1.6.6.4" xref="S2.E3.m1.6.6.4.cmml"><mi id="S2.E3.m1.6.6.4.2.2" xref="S2.E3.m1.6.6.4.2.2.cmml">I</mi><mi id="S2.E3.m1.6.6.4.2.3" xref="S2.E3.m1.6.6.4.2.3.cmml">t</mi><mi id="S2.E3.m1.6.6.4.3" xref="S2.E3.m1.6.6.4.3.cmml">p</mi></msubsup><mo id="S2.E3.m1.6.6.3" xref="S2.E3.m1.6.6.3.cmml">=</mo><mrow id="S2.E3.m1.6.6.2" xref="S2.E3.m1.6.6.2.cmml"><mi id="S2.E3.m1.6.6.2.4" xref="S2.E3.m1.6.6.2.4.cmml">𝑇𝑜𝑝𝐾</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.2.3" xref="S2.E3.m1.6.6.2.3.cmml">​</mo><mrow id="S2.E3.m1.6.6.2.2.2" xref="S2.E3.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S2.E3.m1.6.6.2.2.2.3" xref="S2.E3.m1.6.6.2.2.3.cmml">(</mo><mrow id="S2.E3.m1.5.5.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m1.5.5.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml"><mfrac id="S2.E3.m1.5.5.1.1.1.1.2a" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml"><mn id="S2.E3.m1.5.5.1.1.1.1.2.2" xref="S2.E3.m1.5.5.1.1.1.1.2.2.cmml">1</mn><mi id="S2.E3.m1.5.5.1.1.1.1.2.3" xref="S2.E3.m1.5.5.1.1.1.1.2.3.cmml">H</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.5.5.1.1.1.1.3.1" xref="S2.E3.m1.5.5.1.1.1.1.3.1.cmml"><munderover id="S2.E3.m1.5.5.1.1.1.1.3.1a" xref="S2.E3.m1.5.5.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E3.m1.5.5.1.1.1.1.3.1.2.2" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.2" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.2.cmml">h</mi><mo id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.1" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.3" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.5.5.1.1.1.1.3.1.3" xref="S2.E3.m1.5.5.1.1.1.1.3.1.3.cmml">H</mi></munderover></mstyle><mrow id="S2.E3.m1.5.5.1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.1.1.3.2.cmml"><msubsup id="S2.E3.m1.5.5.1.1.1.1.3.2.2" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.2" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.2.cmml">q</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">t</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">h</mi></mrow><mi id="S2.E3.m1.5.5.1.1.1.1.3.2.2.3" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2.3.cmml">p</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.1.1.3.2.1" xref="S2.E3.m1.5.5.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E3.m1.5.5.1.1.1.1.3.2.3" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.2" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.2.cmml">K</mi><mrow id="S2.E3.m1.4.4.2.4" xref="S2.E3.m1.4.4.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml">t</mi><mo id="S2.E3.m1.4.4.2.4.1" xref="S2.E3.m1.4.4.2.3.cmml">,</mo><mi id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.2.cmml">h</mi></mrow><mi id="S2.E3.m1.5.5.1.1.1.1.3.2.3.3" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3.3.cmml">p</mi></msubsup></mrow></mrow></mrow><mo id="S2.E3.m1.6.6.2.2.2.4" xref="S2.E3.m1.6.6.2.2.3.cmml">,</mo><msup id="S2.E3.m1.6.6.2.2.2.2" xref="S2.E3.m1.6.6.2.2.2.2.cmml"><mi id="S2.E3.m1.6.6.2.2.2.2.2" xref="S2.E3.m1.6.6.2.2.2.2.2.cmml">k</mi><mi id="S2.E3.m1.6.6.2.2.2.2.3" xref="S2.E3.m1.6.6.2.2.2.2.3.cmml">p</mi></msup><mo stretchy="false" id="S2.E3.m1.6.6.2.2.2.5" xref="S2.E3.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.6b"><apply id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"><eq id="S2.E3.m1.6.6.3.cmml" xref="S2.E3.m1.6.6.3"></eq><apply id="S2.E3.m1.6.6.4.cmml" xref="S2.E3.m1.6.6.4"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.1.cmml" xref="S2.E3.m1.6.6.4">superscript</csymbol><apply id="S2.E3.m1.6.6.4.2.cmml" xref="S2.E3.m1.6.6.4"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.2.1.cmml" xref="S2.E3.m1.6.6.4">subscript</csymbol><ci id="S2.E3.m1.6.6.4.2.2.cmml" xref="S2.E3.m1.6.6.4.2.2">𝐼</ci><ci id="S2.E3.m1.6.6.4.2.3.cmml" xref="S2.E3.m1.6.6.4.2.3">𝑡</ci></apply><ci id="S2.E3.m1.6.6.4.3.cmml" xref="S2.E3.m1.6.6.4.3">𝑝</ci></apply><apply id="S2.E3.m1.6.6.2.cmml" xref="S2.E3.m1.6.6.2"><times id="S2.E3.m1.6.6.2.3.cmml" xref="S2.E3.m1.6.6.2.3"></times><ci id="S2.E3.m1.6.6.2.4.cmml" xref="S2.E3.m1.6.6.2.4">𝑇𝑜𝑝𝐾</ci><interval closure="open" id="S2.E3.m1.6.6.2.2.3.cmml" xref="S2.E3.m1.6.6.2.2.2"><apply id="S2.E3.m1.5.5.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1"><times id="S2.E3.m1.5.5.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1"></times><apply id="S2.E3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2"><divide id="S2.E3.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2"></divide><cn type="integer" id="S2.E3.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2.2">1</cn><ci id="S2.E3.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2.3">𝐻</ci></apply><apply id="S2.E3.m1.5.5.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3"><apply id="S2.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.1.1.3.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E3.m1.5.5.1.1.1.1.3.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.2"></sum><apply id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3"><eq id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.2">ℎ</ci><cn type="integer" id="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.5.5.1.1.1.1.3.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.1.3">𝐻</ci></apply><apply id="S2.E3.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2"><times id="S2.E3.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.1"></times><apply id="S2.E3.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2.2.2">𝑞</ci><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑡</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">ℎ</ci></list></apply><ci id="S2.E3.m1.5.5.1.1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.2.3">𝑝</ci></apply><apply id="S2.E3.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3.2.2">𝐾</ci><list id="S2.E3.m1.4.4.2.3.cmml" xref="S2.E3.m1.4.4.2.4"><ci id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1">𝑡</ci><ci id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2">ℎ</ci></list></apply><ci id="S2.E3.m1.5.5.1.1.1.1.3.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2.3.3">𝑝</ci></apply></apply></apply></apply><apply id="S2.E3.m1.6.6.2.2.2.2.cmml" xref="S2.E3.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.2.2.2.2.1.cmml" xref="S2.E3.m1.6.6.2.2.2.2">superscript</csymbol><ci id="S2.E3.m1.6.6.2.2.2.2.2.cmml" xref="S2.E3.m1.6.6.2.2.2.2.2">𝑘</ci><ci id="S2.E3.m1.6.6.2.2.2.2.3.cmml" xref="S2.E3.m1.6.6.2.2.2.2.3">𝑝</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.6c">\displaystyle I_{t}^{p}=\mathit{TopK}(\frac{1}{H}\sum_{h=1}^{H}q_{t,h}^{p}K_{t,h}^{p},k^{p})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Unlike conventional approaches that uniformly encode all bias phrases beforehand, Deferred NAM (Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Methods ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) utilizes a lightweight phrase encoder and retrieval process to select the top-k relevant phrases, before invoking the fine-grained context encoder and WP attention at inference. Additionally, Deferred NAM employs cross-entropy losses with its phrase and WP attentions, further boosting WER performance. This design achieves both minimal latency as well as excellent recognition quality.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<p id="S3.F2.1.1" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="S3.F2.1.1.1" class="ltx_text"><img src="/html/2404.10180/assets/x2.png" id="S3.F2.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="186" height="45" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Inference with Deferred NAM.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Lightweight phrase encoder</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.7" class="ltx_p">We adopted <cite class="ltx_cite ltx_citemacro_citet">Iyyer et al. (<a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite>’s Deep Averaging Network (DAN) as a lightweight encoder to produce phrase encodings <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="E^{p}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><msup id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml">E</mi><mi id="S3.SS1.p1.1.m1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.3.cmml">p</mi></msup><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.1.m1.1.1.3.3.1" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2">𝐸</ci><ci id="S3.SS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">E^{p}\in\mathbb{R}^{N\times d}</annotation></semantics></math>, where the WP embeddings <math id="S3.SS1.p1.2.m2.7" class="ltx_Math" alttext="W=\{{w_{n,1},...,w_{n,L}}\}^{N}_{n=1}" display="inline"><semantics id="S3.SS1.p1.2.m2.7a"><mrow id="S3.SS1.p1.2.m2.7.7" xref="S3.SS1.p1.2.m2.7.7.cmml"><mi id="S3.SS1.p1.2.m2.7.7.4" xref="S3.SS1.p1.2.m2.7.7.4.cmml">W</mi><mo id="S3.SS1.p1.2.m2.7.7.3" xref="S3.SS1.p1.2.m2.7.7.3.cmml">=</mo><msubsup id="S3.SS1.p1.2.m2.7.7.2" xref="S3.SS1.p1.2.m2.7.7.2.cmml"><mrow id="S3.SS1.p1.2.m2.7.7.2.2.2.2" xref="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.7.7.2.2.2.2.3" xref="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.2.m2.6.6.1.1.1.1.1" xref="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.2.cmml">w</mi><mrow id="S3.SS1.p1.2.m2.2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">n</mi><mo id="S3.SS1.p1.2.m2.2.2.2.4.1" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><mn id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.2.m2.7.7.2.2.2.2.4" xref="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml">…</mi><mo id="S3.SS1.p1.2.m2.7.7.2.2.2.2.5" xref="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.7.7.2.2.2.2.2" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.2.cmml">w</mi><mrow id="S3.SS1.p1.2.m2.4.4.2.4" xref="S3.SS1.p1.2.m2.4.4.2.3.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.cmml">n</mi><mo id="S3.SS1.p1.2.m2.4.4.2.4.1" xref="S3.SS1.p1.2.m2.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.4.4.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.cmml">L</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.7.7.2.2.2.2.6" xref="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.p1.2.m2.7.7.2.4" xref="S3.SS1.p1.2.m2.7.7.2.4.cmml"><mi id="S3.SS1.p1.2.m2.7.7.2.4.2" xref="S3.SS1.p1.2.m2.7.7.2.4.2.cmml">n</mi><mo id="S3.SS1.p1.2.m2.7.7.2.4.1" xref="S3.SS1.p1.2.m2.7.7.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.2.m2.7.7.2.4.3" xref="S3.SS1.p1.2.m2.7.7.2.4.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.2.m2.7.7.2.2.4" xref="S3.SS1.p1.2.m2.7.7.2.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.7b"><apply id="S3.SS1.p1.2.m2.7.7.cmml" xref="S3.SS1.p1.2.m2.7.7"><eq id="S3.SS1.p1.2.m2.7.7.3.cmml" xref="S3.SS1.p1.2.m2.7.7.3"></eq><ci id="S3.SS1.p1.2.m2.7.7.4.cmml" xref="S3.SS1.p1.2.m2.7.7.4">𝑊</ci><apply id="S3.SS1.p1.2.m2.7.7.2.cmml" xref="S3.SS1.p1.2.m2.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.7.7.2.3.cmml" xref="S3.SS1.p1.2.m2.7.7.2">subscript</csymbol><apply id="S3.SS1.p1.2.m2.7.7.2.2.cmml" xref="S3.SS1.p1.2.m2.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.7.7.2.2.3.cmml" xref="S3.SS1.p1.2.m2.7.7.2">superscript</csymbol><set id="S3.SS1.p1.2.m2.7.7.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2"><apply id="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.6.6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.6.6.1.1.1.1.1.2">𝑤</ci><list id="S3.SS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.4"><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑛</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2">1</cn></list></apply><ci id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5">…</ci><apply id="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.7.7.2.2.2.2.2.2">𝑤</ci><list id="S3.SS1.p1.2.m2.4.4.2.3.cmml" xref="S3.SS1.p1.2.m2.4.4.2.4"><ci id="S3.SS1.p1.2.m2.3.3.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1">𝑛</ci><ci id="S3.SS1.p1.2.m2.4.4.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2">𝐿</ci></list></apply></set><ci id="S3.SS1.p1.2.m2.7.7.2.2.4.cmml" xref="S3.SS1.p1.2.m2.7.7.2.2.4">𝑁</ci></apply><apply id="S3.SS1.p1.2.m2.7.7.2.4.cmml" xref="S3.SS1.p1.2.m2.7.7.2.4"><eq id="S3.SS1.p1.2.m2.7.7.2.4.1.cmml" xref="S3.SS1.p1.2.m2.7.7.2.4.1"></eq><ci id="S3.SS1.p1.2.m2.7.7.2.4.2.cmml" xref="S3.SS1.p1.2.m2.7.7.2.4.2">𝑛</ci><cn type="integer" id="S3.SS1.p1.2.m2.7.7.2.4.3.cmml" xref="S3.SS1.p1.2.m2.7.7.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.7c">W=\{{w_{n,1},...,w_{n,L}}\}^{N}_{n=1}</annotation></semantics></math> are averaged over the <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">L</annotation></semantics></math> axis and then encoded by a feed-forward network with TANH activation, and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">d</annotation></semantics></math> is the WP embedding/encoding dimension. We applied stop gradient (<math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\bot" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mo id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">⊥</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">bottom</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\bot</annotation></semantics></math>) to prevent <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="LightPhraseEncoder" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1a" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.4" xref="S3.SS1.p1.6.m6.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1b" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.5" xref="S3.SS1.p1.6.m6.1.1.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1c" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.6" xref="S3.SS1.p1.6.m6.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1d" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.7" xref="S3.SS1.p1.6.m6.1.1.7.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1e" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.8" xref="S3.SS1.p1.6.m6.1.1.8.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1f" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.9" xref="S3.SS1.p1.6.m6.1.1.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1g" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.10" xref="S3.SS1.p1.6.m6.1.1.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1h" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.11" xref="S3.SS1.p1.6.m6.1.1.11.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1i" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.12" xref="S3.SS1.p1.6.m6.1.1.12.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1j" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.13" xref="S3.SS1.p1.6.m6.1.1.13.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1k" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.14" xref="S3.SS1.p1.6.m6.1.1.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1l" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.15" xref="S3.SS1.p1.6.m6.1.1.15.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1m" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.16" xref="S3.SS1.p1.6.m6.1.1.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1n" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.17" xref="S3.SS1.p1.6.m6.1.1.17.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1o" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.18" xref="S3.SS1.p1.6.m6.1.1.18.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1p" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.19" xref="S3.SS1.p1.6.m6.1.1.19.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><times id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></times><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐿</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑖</ci><ci id="S3.SS1.p1.6.m6.1.1.4.cmml" xref="S3.SS1.p1.6.m6.1.1.4">𝑔</ci><ci id="S3.SS1.p1.6.m6.1.1.5.cmml" xref="S3.SS1.p1.6.m6.1.1.5">ℎ</ci><ci id="S3.SS1.p1.6.m6.1.1.6.cmml" xref="S3.SS1.p1.6.m6.1.1.6">𝑡</ci><ci id="S3.SS1.p1.6.m6.1.1.7.cmml" xref="S3.SS1.p1.6.m6.1.1.7">𝑃</ci><ci id="S3.SS1.p1.6.m6.1.1.8.cmml" xref="S3.SS1.p1.6.m6.1.1.8">ℎ</ci><ci id="S3.SS1.p1.6.m6.1.1.9.cmml" xref="S3.SS1.p1.6.m6.1.1.9">𝑟</ci><ci id="S3.SS1.p1.6.m6.1.1.10.cmml" xref="S3.SS1.p1.6.m6.1.1.10">𝑎</ci><ci id="S3.SS1.p1.6.m6.1.1.11.cmml" xref="S3.SS1.p1.6.m6.1.1.11">𝑠</ci><ci id="S3.SS1.p1.6.m6.1.1.12.cmml" xref="S3.SS1.p1.6.m6.1.1.12">𝑒</ci><ci id="S3.SS1.p1.6.m6.1.1.13.cmml" xref="S3.SS1.p1.6.m6.1.1.13">𝐸</ci><ci id="S3.SS1.p1.6.m6.1.1.14.cmml" xref="S3.SS1.p1.6.m6.1.1.14">𝑛</ci><ci id="S3.SS1.p1.6.m6.1.1.15.cmml" xref="S3.SS1.p1.6.m6.1.1.15">𝑐</ci><ci id="S3.SS1.p1.6.m6.1.1.16.cmml" xref="S3.SS1.p1.6.m6.1.1.16">𝑜</ci><ci id="S3.SS1.p1.6.m6.1.1.17.cmml" xref="S3.SS1.p1.6.m6.1.1.17">𝑑</ci><ci id="S3.SS1.p1.6.m6.1.1.18.cmml" xref="S3.SS1.p1.6.m6.1.1.18">𝑒</ci><ci id="S3.SS1.p1.6.m6.1.1.19.cmml" xref="S3.SS1.p1.6.m6.1.1.19">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">LightPhraseEncoder</annotation></semantics></math> from interfering with <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathit{ContextEncoder}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathit{ContextEncoder}</annotation></semantics></math> learning of the WP embeddings, which resulted in faster biasing WER convergence.</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle E^{p}=\mathit{LightPhraseEncoder}(\bot(W))" display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><msup id="S3.E4.m1.2.2.3" xref="S3.E4.m1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.3.2" xref="S3.E4.m1.2.2.3.2.cmml">E</mi><mi id="S3.E4.m1.2.2.3.3" xref="S3.E4.m1.2.2.3.3.cmml">p</mi></msup><mo id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.cmml"><mi id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.2.2.1.3.cmml">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1a" xref="S3.E4.m1.2.2.1.1.1.1.cmml">⊥</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.2.2.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">W</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><eq id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"></eq><apply id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.3">superscript</csymbol><ci id="S3.E4.m1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.3.2">𝐸</ci><ci id="S3.E4.m1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.3.3">𝑝</ci></apply><apply id="S3.E4.m1.2.2.1.cmml" xref="S3.E4.m1.2.2.1"><times id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.2"></times><ci id="S3.E4.m1.2.2.1.3.cmml" xref="S3.E4.m1.2.2.1.3">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">bottom</csymbol><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle E^{p}=\mathit{LightPhraseEncoder}(\bot(W))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Cross-entropy guided phrase attention</h3>

<figure id="algorithm1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.12.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> NO_BIAS-augmented multi-head attention logits with mean-max pooling: <math id="algorithm1.2.m1.2" class="ltx_Math" alttext="f(q,k)" display="inline"><semantics id="algorithm1.2.m1.2b"><mrow id="algorithm1.2.m1.2.3" xref="algorithm1.2.m1.2.3.cmml"><mi id="algorithm1.2.m1.2.3.2" xref="algorithm1.2.m1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="algorithm1.2.m1.2.3.1" xref="algorithm1.2.m1.2.3.1.cmml">​</mo><mrow id="algorithm1.2.m1.2.3.3.2" xref="algorithm1.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="algorithm1.2.m1.2.3.3.2.1" xref="algorithm1.2.m1.2.3.3.1.cmml">(</mo><mi id="algorithm1.2.m1.1.1" xref="algorithm1.2.m1.1.1.cmml">q</mi><mo id="algorithm1.2.m1.2.3.3.2.2" xref="algorithm1.2.m1.2.3.3.1.cmml">,</mo><mi id="algorithm1.2.m1.2.2" xref="algorithm1.2.m1.2.2.cmml">k</mi><mo stretchy="false" id="algorithm1.2.m1.2.3.3.2.3" xref="algorithm1.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.m1.2c"><apply id="algorithm1.2.m1.2.3.cmml" xref="algorithm1.2.m1.2.3"><times id="algorithm1.2.m1.2.3.1.cmml" xref="algorithm1.2.m1.2.3.1"></times><ci id="algorithm1.2.m1.2.3.2.cmml" xref="algorithm1.2.m1.2.3.2">𝑓</ci><interval closure="open" id="algorithm1.2.m1.2.3.3.1.cmml" xref="algorithm1.2.m1.2.3.3.2"><ci id="algorithm1.2.m1.1.1.cmml" xref="algorithm1.2.m1.1.1">𝑞</ci><ci id="algorithm1.2.m1.2.2.cmml" xref="algorithm1.2.m1.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.m1.2d">f(q,k)</annotation></semantics></math></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm1.5" class="ltx_p ltx_figure_panel"><span id="algorithm1.5.1" class="ltx_text ltx_font_bold">Inputs:</span> Query <math id="algorithm1.3.m1.1" class="ltx_Math" alttext="q\in\mathbb{R}^{T\times d_{q}}" display="inline"><semantics id="algorithm1.3.m1.1a"><mrow id="algorithm1.3.m1.1.1" xref="algorithm1.3.m1.1.1.cmml"><mi id="algorithm1.3.m1.1.1.2" xref="algorithm1.3.m1.1.1.2.cmml">q</mi><mo id="algorithm1.3.m1.1.1.1" xref="algorithm1.3.m1.1.1.1.cmml">∈</mo><msup id="algorithm1.3.m1.1.1.3" xref="algorithm1.3.m1.1.1.3.cmml"><mi id="algorithm1.3.m1.1.1.3.2" xref="algorithm1.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.3.m1.1.1.3.3" xref="algorithm1.3.m1.1.1.3.3.cmml"><mi id="algorithm1.3.m1.1.1.3.3.2" xref="algorithm1.3.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.3.m1.1.1.3.3.1" xref="algorithm1.3.m1.1.1.3.3.1.cmml">×</mo><msub id="algorithm1.3.m1.1.1.3.3.3" xref="algorithm1.3.m1.1.1.3.3.3.cmml"><mi id="algorithm1.3.m1.1.1.3.3.3.2" xref="algorithm1.3.m1.1.1.3.3.3.2.cmml">d</mi><mi id="algorithm1.3.m1.1.1.3.3.3.3" xref="algorithm1.3.m1.1.1.3.3.3.3.cmml">q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.m1.1b"><apply id="algorithm1.3.m1.1.1.cmml" xref="algorithm1.3.m1.1.1"><in id="algorithm1.3.m1.1.1.1.cmml" xref="algorithm1.3.m1.1.1.1"></in><ci id="algorithm1.3.m1.1.1.2.cmml" xref="algorithm1.3.m1.1.1.2">𝑞</ci><apply id="algorithm1.3.m1.1.1.3.cmml" xref="algorithm1.3.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.3.m1.1.1.3.1.cmml" xref="algorithm1.3.m1.1.1.3">superscript</csymbol><ci id="algorithm1.3.m1.1.1.3.2.cmml" xref="algorithm1.3.m1.1.1.3.2">ℝ</ci><apply id="algorithm1.3.m1.1.1.3.3.cmml" xref="algorithm1.3.m1.1.1.3.3"><times id="algorithm1.3.m1.1.1.3.3.1.cmml" xref="algorithm1.3.m1.1.1.3.3.1"></times><ci id="algorithm1.3.m1.1.1.3.3.2.cmml" xref="algorithm1.3.m1.1.1.3.3.2">𝑇</ci><apply id="algorithm1.3.m1.1.1.3.3.3.cmml" xref="algorithm1.3.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.3.m1.1.1.3.3.3.1.cmml" xref="algorithm1.3.m1.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.3.m1.1.1.3.3.3.2.cmml" xref="algorithm1.3.m1.1.1.3.3.3.2">𝑑</ci><ci id="algorithm1.3.m1.1.1.3.3.3.3.cmml" xref="algorithm1.3.m1.1.1.3.3.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.m1.1c">q\in\mathbb{R}^{T\times d_{q}}</annotation></semantics></math>, key <math id="algorithm1.4.m2.1" class="ltx_Math" alttext="k\in\mathbb{R}^{S\times d_{k}}" display="inline"><semantics id="algorithm1.4.m2.1a"><mrow id="algorithm1.4.m2.1.1" xref="algorithm1.4.m2.1.1.cmml"><mi id="algorithm1.4.m2.1.1.2" xref="algorithm1.4.m2.1.1.2.cmml">k</mi><mo id="algorithm1.4.m2.1.1.1" xref="algorithm1.4.m2.1.1.1.cmml">∈</mo><msup id="algorithm1.4.m2.1.1.3" xref="algorithm1.4.m2.1.1.3.cmml"><mi id="algorithm1.4.m2.1.1.3.2" xref="algorithm1.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.4.m2.1.1.3.3" xref="algorithm1.4.m2.1.1.3.3.cmml"><mi id="algorithm1.4.m2.1.1.3.3.2" xref="algorithm1.4.m2.1.1.3.3.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.4.m2.1.1.3.3.1" xref="algorithm1.4.m2.1.1.3.3.1.cmml">×</mo><msub id="algorithm1.4.m2.1.1.3.3.3" xref="algorithm1.4.m2.1.1.3.3.3.cmml"><mi id="algorithm1.4.m2.1.1.3.3.3.2" xref="algorithm1.4.m2.1.1.3.3.3.2.cmml">d</mi><mi id="algorithm1.4.m2.1.1.3.3.3.3" xref="algorithm1.4.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.m2.1b"><apply id="algorithm1.4.m2.1.1.cmml" xref="algorithm1.4.m2.1.1"><in id="algorithm1.4.m2.1.1.1.cmml" xref="algorithm1.4.m2.1.1.1"></in><ci id="algorithm1.4.m2.1.1.2.cmml" xref="algorithm1.4.m2.1.1.2">𝑘</ci><apply id="algorithm1.4.m2.1.1.3.cmml" xref="algorithm1.4.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.4.m2.1.1.3.1.cmml" xref="algorithm1.4.m2.1.1.3">superscript</csymbol><ci id="algorithm1.4.m2.1.1.3.2.cmml" xref="algorithm1.4.m2.1.1.3.2">ℝ</ci><apply id="algorithm1.4.m2.1.1.3.3.cmml" xref="algorithm1.4.m2.1.1.3.3"><times id="algorithm1.4.m2.1.1.3.3.1.cmml" xref="algorithm1.4.m2.1.1.3.3.1"></times><ci id="algorithm1.4.m2.1.1.3.3.2.cmml" xref="algorithm1.4.m2.1.1.3.3.2">𝑆</ci><apply id="algorithm1.4.m2.1.1.3.3.3.cmml" xref="algorithm1.4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.4.m2.1.1.3.3.3.1.cmml" xref="algorithm1.4.m2.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.4.m2.1.1.3.3.3.2.cmml" xref="algorithm1.4.m2.1.1.3.3.3.2">𝑑</ci><ci id="algorithm1.4.m2.1.1.3.3.3.3.cmml" xref="algorithm1.4.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.m2.1c">k\in\mathbb{R}^{S\times d_{k}}</annotation></semantics></math> 
<br class="ltx_break"><span id="algorithm1.5.2" class="ltx_text ltx_font_bold">Outputs:</span> Mean-max pooled logits <math id="algorithm1.5.m3.1" class="ltx_Math" alttext="z\in\mathbb{R}^{(1+S)}" display="inline"><semantics id="algorithm1.5.m3.1a"><mrow id="algorithm1.5.m3.1.2" xref="algorithm1.5.m3.1.2.cmml"><mi id="algorithm1.5.m3.1.2.2" xref="algorithm1.5.m3.1.2.2.cmml">z</mi><mo id="algorithm1.5.m3.1.2.1" xref="algorithm1.5.m3.1.2.1.cmml">∈</mo><msup id="algorithm1.5.m3.1.2.3" xref="algorithm1.5.m3.1.2.3.cmml"><mi id="algorithm1.5.m3.1.2.3.2" xref="algorithm1.5.m3.1.2.3.2.cmml">ℝ</mi><mrow id="algorithm1.5.m3.1.1.1.1" xref="algorithm1.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.5.m3.1.1.1.1.2" xref="algorithm1.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.5.m3.1.1.1.1.1" xref="algorithm1.5.m3.1.1.1.1.1.cmml"><mn id="algorithm1.5.m3.1.1.1.1.1.2" xref="algorithm1.5.m3.1.1.1.1.1.2.cmml">1</mn><mo id="algorithm1.5.m3.1.1.1.1.1.1" xref="algorithm1.5.m3.1.1.1.1.1.1.cmml">+</mo><mi id="algorithm1.5.m3.1.1.1.1.1.3" xref="algorithm1.5.m3.1.1.1.1.1.3.cmml">S</mi></mrow><mo stretchy="false" id="algorithm1.5.m3.1.1.1.1.3" xref="algorithm1.5.m3.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.m3.1b"><apply id="algorithm1.5.m3.1.2.cmml" xref="algorithm1.5.m3.1.2"><in id="algorithm1.5.m3.1.2.1.cmml" xref="algorithm1.5.m3.1.2.1"></in><ci id="algorithm1.5.m3.1.2.2.cmml" xref="algorithm1.5.m3.1.2.2">𝑧</ci><apply id="algorithm1.5.m3.1.2.3.cmml" xref="algorithm1.5.m3.1.2.3"><csymbol cd="ambiguous" id="algorithm1.5.m3.1.2.3.1.cmml" xref="algorithm1.5.m3.1.2.3">superscript</csymbol><ci id="algorithm1.5.m3.1.2.3.2.cmml" xref="algorithm1.5.m3.1.2.3.2">ℝ</ci><apply id="algorithm1.5.m3.1.1.1.1.1.cmml" xref="algorithm1.5.m3.1.1.1.1"><plus id="algorithm1.5.m3.1.1.1.1.1.1.cmml" xref="algorithm1.5.m3.1.1.1.1.1.1"></plus><cn type="integer" id="algorithm1.5.m3.1.1.1.1.1.2.cmml" xref="algorithm1.5.m3.1.1.1.1.1.2">1</cn><ci id="algorithm1.5.m3.1.1.1.1.1.3.cmml" xref="algorithm1.5.m3.1.1.1.1.1.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.m3.1c">z\in\mathbb{R}^{(1+S)}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_eqnarray ltx_figure_panel ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\displaystyle q_{t,h}^{{}^{\prime}}=q_{t}\Theta_{h}^{Q},k_{h}^{{}^{\prime}}=[\Theta_{h}^{NB};k\Theta_{h}^{K}]" display="inline"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.3.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><msubsup id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml">q</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">t</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">h</mi></mrow><msup id="S3.E5.m1.3.3.1.1.2.3" xref="S3.E5.m1.3.3.1.1.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1.2.3a" xref="S3.E5.m1.3.3.1.1.2.3.cmml"></mi><mo id="S3.E5.m1.3.3.1.1.2.3.1" xref="S3.E5.m1.3.3.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml"><msub id="S3.E5.m1.3.3.1.1.3.2" xref="S3.E5.m1.3.3.1.1.3.2.cmml"><mi id="S3.E5.m1.3.3.1.1.3.2.2" xref="S3.E5.m1.3.3.1.1.3.2.2.cmml">q</mi><mi id="S3.E5.m1.3.3.1.1.3.2.3" xref="S3.E5.m1.3.3.1.1.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.3.1" xref="S3.E5.m1.3.3.1.1.3.1.cmml">​</mo><msubsup id="S3.E5.m1.3.3.1.1.3.3" xref="S3.E5.m1.3.3.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.E5.m1.3.3.1.1.3.3.2.2" xref="S3.E5.m1.3.3.1.1.3.3.2.2.cmml">Θ</mi><mi id="S3.E5.m1.3.3.1.1.3.3.2.3" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml">h</mi><mi id="S3.E5.m1.3.3.1.1.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.cmml">Q</mi></msubsup></mrow></mrow><mo id="S3.E5.m1.4.4.2.3" xref="S3.E5.m1.4.4.3a.cmml">,</mo><mrow id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml"><msubsup id="S3.E5.m1.4.4.2.2.4" xref="S3.E5.m1.4.4.2.2.4.cmml"><mi id="S3.E5.m1.4.4.2.2.4.2.2" xref="S3.E5.m1.4.4.2.2.4.2.2.cmml">k</mi><mi id="S3.E5.m1.4.4.2.2.4.2.3" xref="S3.E5.m1.4.4.2.2.4.2.3.cmml">h</mi><msup id="S3.E5.m1.4.4.2.2.4.3" xref="S3.E5.m1.4.4.2.2.4.3.cmml"><mi id="S3.E5.m1.4.4.2.2.4.3a" xref="S3.E5.m1.4.4.2.2.4.3.cmml"></mi><mo id="S3.E5.m1.4.4.2.2.4.3.1" xref="S3.E5.m1.4.4.2.2.4.3.1.cmml">′</mo></msup></msubsup><mo id="S3.E5.m1.4.4.2.2.3" xref="S3.E5.m1.4.4.2.2.3.cmml">=</mo><mrow id="S3.E5.m1.4.4.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.2.2.2.2.3" xref="S3.E5.m1.4.4.2.2.2.3.cmml">[</mo><msubsup id="S3.E5.m1.4.4.2.2.1.1.1" xref="S3.E5.m1.4.4.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.E5.m1.4.4.2.2.1.1.1.2.2" xref="S3.E5.m1.4.4.2.2.1.1.1.2.2.cmml">Θ</mi><mi id="S3.E5.m1.4.4.2.2.1.1.1.2.3" xref="S3.E5.m1.4.4.2.2.1.1.1.2.3.cmml">h</mi><mrow id="S3.E5.m1.4.4.2.2.1.1.1.3" xref="S3.E5.m1.4.4.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.4.4.2.2.1.1.1.3.2" xref="S3.E5.m1.4.4.2.2.1.1.1.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.2.2.1.1.1.3.1" xref="S3.E5.m1.4.4.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.4.4.2.2.1.1.1.3.3" xref="S3.E5.m1.4.4.2.2.1.1.1.3.3.cmml">B</mi></mrow></msubsup><mo id="S3.E5.m1.4.4.2.2.2.2.4" xref="S3.E5.m1.4.4.2.2.2.3.cmml">;</mo><mrow id="S3.E5.m1.4.4.2.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.2.cmml"><mi id="S3.E5.m1.4.4.2.2.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.2.2.2.2.2.1" xref="S3.E5.m1.4.4.2.2.2.2.2.1.cmml">​</mo><msubsup id="S3.E5.m1.4.4.2.2.2.2.2.3" xref="S3.E5.m1.4.4.2.2.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E5.m1.4.4.2.2.2.2.2.3.2.2" xref="S3.E5.m1.4.4.2.2.2.2.2.3.2.2.cmml">Θ</mi><mi id="S3.E5.m1.4.4.2.2.2.2.2.3.2.3" xref="S3.E5.m1.4.4.2.2.2.2.2.3.2.3.cmml">h</mi><mi id="S3.E5.m1.4.4.2.2.2.2.2.3.3" xref="S3.E5.m1.4.4.2.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo stretchy="false" id="S3.E5.m1.4.4.2.2.2.2.5" xref="S3.E5.m1.4.4.2.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3a.cmml" xref="S3.E5.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><eq id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"></eq><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2">𝑞</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑡</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">ℎ</ci></list></apply><apply id="S3.E5.m1.3.3.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.3"><ci id="S3.E5.m1.3.3.1.1.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.2.3.1">′</ci></apply></apply><apply id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3"><times id="S3.E5.m1.3.3.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.1"></times><apply id="S3.E5.m1.3.3.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.2.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2">𝑞</ci><ci id="S3.E5.m1.3.3.1.1.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E5.m1.3.3.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3">superscript</csymbol><apply id="S3.E5.m1.3.3.1.1.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.2">Θ</ci><ci id="S3.E5.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.3">ℎ</ci></apply><ci id="S3.E5.m1.3.3.1.1.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3">𝑄</ci></apply></apply></apply><apply id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2"><eq id="S3.E5.m1.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3"></eq><apply id="S3.E5.m1.4.4.2.2.4.cmml" xref="S3.E5.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.4.1.cmml" xref="S3.E5.m1.4.4.2.2.4">superscript</csymbol><apply id="S3.E5.m1.4.4.2.2.4.2.cmml" xref="S3.E5.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.4.2.1.cmml" xref="S3.E5.m1.4.4.2.2.4">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2.4.2.2">𝑘</ci><ci id="S3.E5.m1.4.4.2.2.4.2.3.cmml" xref="S3.E5.m1.4.4.2.2.4.2.3">ℎ</ci></apply><apply id="S3.E5.m1.4.4.2.2.4.3.cmml" xref="S3.E5.m1.4.4.2.2.4.3"><ci id="S3.E5.m1.4.4.2.2.4.3.1.cmml" xref="S3.E5.m1.4.4.2.2.4.3.1">′</ci></apply></apply><list id="S3.E5.m1.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.2"><apply id="S3.E5.m1.4.4.2.2.1.1.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1">superscript</csymbol><apply id="S3.E5.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.2.2">Θ</ci><ci id="S3.E5.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E5.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.3"><times id="S3.E5.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.3.1"></times><ci id="S3.E5.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.3.2">𝑁</ci><ci id="S3.E5.m1.4.4.2.2.1.1.1.3.3.cmml" xref="S3.E5.m1.4.4.2.2.1.1.1.3.3">𝐵</ci></apply></apply><apply id="S3.E5.m1.4.4.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2"><times id="S3.E5.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.1"></times><ci id="S3.E5.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.2">𝑘</ci><apply id="S3.E5.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E5.m1.4.4.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.2.2.3.2.1.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.2.2.2.3.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3.2.2">Θ</ci><ci id="S3.E5.m1.4.4.2.2.2.2.2.3.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3.2.3">ℎ</ci></apply><ci id="S3.E5.m1.4.4.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.3.3">𝐾</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\displaystyle q_{t,h}^{{}^{\prime}}=q_{t}\Theta_{h}^{Q},k_{h}^{{}^{\prime}}=[\Theta_{h}^{NB};k\Theta_{h}^{K}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\displaystyle z_{t}=\frac{1}{H}\sum_{h=1}^{H}\frac{q_{t,h}^{{}^{\prime}}(k_{h}^{{}^{\prime}})^{\top}}{\sqrt{d_{h}}}" display="inline"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.4" xref="S3.E6.m1.3.4.cmml"><msub id="S3.E6.m1.3.4.2" xref="S3.E6.m1.3.4.2.cmml"><mi id="S3.E6.m1.3.4.2.2" xref="S3.E6.m1.3.4.2.2.cmml">z</mi><mi id="S3.E6.m1.3.4.2.3" xref="S3.E6.m1.3.4.2.3.cmml">t</mi></msub><mo id="S3.E6.m1.3.4.1" xref="S3.E6.m1.3.4.1.cmml">=</mo><mrow id="S3.E6.m1.3.4.3" xref="S3.E6.m1.3.4.3.cmml"><mstyle displaystyle="true" id="S3.E6.m1.3.4.3.2" xref="S3.E6.m1.3.4.3.2.cmml"><mfrac id="S3.E6.m1.3.4.3.2a" xref="S3.E6.m1.3.4.3.2.cmml"><mn id="S3.E6.m1.3.4.3.2.2" xref="S3.E6.m1.3.4.3.2.2.cmml">1</mn><mi id="S3.E6.m1.3.4.3.2.3" xref="S3.E6.m1.3.4.3.2.3.cmml">H</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.4.3.1" xref="S3.E6.m1.3.4.3.1.cmml">​</mo><mrow id="S3.E6.m1.3.4.3.3" xref="S3.E6.m1.3.4.3.3.cmml"><mstyle displaystyle="true" id="S3.E6.m1.3.4.3.3.1" xref="S3.E6.m1.3.4.3.3.1.cmml"><munderover id="S3.E6.m1.3.4.3.3.1a" xref="S3.E6.m1.3.4.3.3.1.cmml"><mo movablelimits="false" id="S3.E6.m1.3.4.3.3.1.2.2" xref="S3.E6.m1.3.4.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.4.3.3.1.2.3" xref="S3.E6.m1.3.4.3.3.1.2.3.cmml"><mi id="S3.E6.m1.3.4.3.3.1.2.3.2" xref="S3.E6.m1.3.4.3.3.1.2.3.2.cmml">h</mi><mo id="S3.E6.m1.3.4.3.3.1.2.3.1" xref="S3.E6.m1.3.4.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.4.3.3.1.2.3.3" xref="S3.E6.m1.3.4.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.4.3.3.1.3" xref="S3.E6.m1.3.4.3.3.1.3.cmml">H</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mfrac id="S3.E6.m1.3.3a" xref="S3.E6.m1.3.3.cmml"><mrow id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><msubsup id="S3.E6.m1.3.3.3.5" xref="S3.E6.m1.3.3.3.5.cmml"><mi id="S3.E6.m1.3.3.3.5.2.2" xref="S3.E6.m1.3.3.3.5.2.2.cmml">q</mi><mrow id="S3.E6.m1.2.2.2.2.2.4" xref="S3.E6.m1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">t</mi><mo id="S3.E6.m1.2.2.2.2.2.4.1" xref="S3.E6.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">h</mi></mrow><msup id="S3.E6.m1.3.3.3.5.3" xref="S3.E6.m1.3.3.3.5.3.cmml"><mi id="S3.E6.m1.3.3.3.5.3a" xref="S3.E6.m1.3.3.3.5.3.cmml"></mi><mo id="S3.E6.m1.3.3.3.5.3.1" xref="S3.E6.m1.3.3.3.5.3.1.cmml">′</mo></msup></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.4" xref="S3.E6.m1.3.3.3.4.cmml">​</mo><msup id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml"><mrow id="S3.E6.m1.3.3.3.3.1.1" xref="S3.E6.m1.3.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.3.3.1.1.2" xref="S3.E6.m1.3.3.3.3.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.3.3.3.3.1.1.1" xref="S3.E6.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E6.m1.3.3.3.3.1.1.1.2.2" xref="S3.E6.m1.3.3.3.3.1.1.1.2.2.cmml">k</mi><mi id="S3.E6.m1.3.3.3.3.1.1.1.2.3" xref="S3.E6.m1.3.3.3.3.1.1.1.2.3.cmml">h</mi><msup id="S3.E6.m1.3.3.3.3.1.1.1.3" xref="S3.E6.m1.3.3.3.3.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.3.3.1.1.1.3a" xref="S3.E6.m1.3.3.3.3.1.1.1.3.cmml"></mi><mo id="S3.E6.m1.3.3.3.3.1.1.1.3.1" xref="S3.E6.m1.3.3.3.3.1.1.1.3.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.3.3.1.1.3" xref="S3.E6.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.cmml">⊤</mo></msup></mrow><msqrt id="S3.E6.m1.3.3.5" xref="S3.E6.m1.3.3.5.cmml"><msub id="S3.E6.m1.3.3.5.2" xref="S3.E6.m1.3.3.5.2.cmml"><mi id="S3.E6.m1.3.3.5.2.2" xref="S3.E6.m1.3.3.5.2.2.cmml">d</mi><mi id="S3.E6.m1.3.3.5.2.3" xref="S3.E6.m1.3.3.5.2.3.cmml">h</mi></msub></msqrt></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.4.cmml" xref="S3.E6.m1.3.4"><eq id="S3.E6.m1.3.4.1.cmml" xref="S3.E6.m1.3.4.1"></eq><apply id="S3.E6.m1.3.4.2.cmml" xref="S3.E6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.4.2.1.cmml" xref="S3.E6.m1.3.4.2">subscript</csymbol><ci id="S3.E6.m1.3.4.2.2.cmml" xref="S3.E6.m1.3.4.2.2">𝑧</ci><ci id="S3.E6.m1.3.4.2.3.cmml" xref="S3.E6.m1.3.4.2.3">𝑡</ci></apply><apply id="S3.E6.m1.3.4.3.cmml" xref="S3.E6.m1.3.4.3"><times id="S3.E6.m1.3.4.3.1.cmml" xref="S3.E6.m1.3.4.3.1"></times><apply id="S3.E6.m1.3.4.3.2.cmml" xref="S3.E6.m1.3.4.3.2"><divide id="S3.E6.m1.3.4.3.2.1.cmml" xref="S3.E6.m1.3.4.3.2"></divide><cn type="integer" id="S3.E6.m1.3.4.3.2.2.cmml" xref="S3.E6.m1.3.4.3.2.2">1</cn><ci id="S3.E6.m1.3.4.3.2.3.cmml" xref="S3.E6.m1.3.4.3.2.3">𝐻</ci></apply><apply id="S3.E6.m1.3.4.3.3.cmml" xref="S3.E6.m1.3.4.3.3"><apply id="S3.E6.m1.3.4.3.3.1.cmml" xref="S3.E6.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.4.3.3.1.1.cmml" xref="S3.E6.m1.3.4.3.3.1">superscript</csymbol><apply id="S3.E6.m1.3.4.3.3.1.2.cmml" xref="S3.E6.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.4.3.3.1.2.1.cmml" xref="S3.E6.m1.3.4.3.3.1">subscript</csymbol><sum id="S3.E6.m1.3.4.3.3.1.2.2.cmml" xref="S3.E6.m1.3.4.3.3.1.2.2"></sum><apply id="S3.E6.m1.3.4.3.3.1.2.3.cmml" xref="S3.E6.m1.3.4.3.3.1.2.3"><eq id="S3.E6.m1.3.4.3.3.1.2.3.1.cmml" xref="S3.E6.m1.3.4.3.3.1.2.3.1"></eq><ci id="S3.E6.m1.3.4.3.3.1.2.3.2.cmml" xref="S3.E6.m1.3.4.3.3.1.2.3.2">ℎ</ci><cn type="integer" id="S3.E6.m1.3.4.3.3.1.2.3.3.cmml" xref="S3.E6.m1.3.4.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.3.4.3.3.1.3.cmml" xref="S3.E6.m1.3.4.3.3.1.3">𝐻</ci></apply><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><divide id="S3.E6.m1.3.3.4.cmml" xref="S3.E6.m1.3.3"></divide><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><times id="S3.E6.m1.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.4"></times><apply id="S3.E6.m1.3.3.3.5.cmml" xref="S3.E6.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.5.1.cmml" xref="S3.E6.m1.3.3.3.5">superscript</csymbol><apply id="S3.E6.m1.3.3.3.5.2.cmml" xref="S3.E6.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.5.2.1.cmml" xref="S3.E6.m1.3.3.3.5">subscript</csymbol><ci id="S3.E6.m1.3.3.3.5.2.2.cmml" xref="S3.E6.m1.3.3.3.5.2.2">𝑞</ci><list id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑡</ci><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">ℎ</ci></list></apply><apply id="S3.E6.m1.3.3.3.5.3.cmml" xref="S3.E6.m1.3.3.3.5.3"><ci id="S3.E6.m1.3.3.3.5.3.1.cmml" xref="S3.E6.m1.3.3.3.5.3.1">′</ci></apply></apply><apply id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3">superscript</csymbol><apply id="S3.E6.m1.3.3.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.2.2">𝑘</ci><ci id="S3.E6.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E6.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.3"><ci id="S3.E6.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.3.1">′</ci></apply></apply><csymbol cd="latexml" id="S3.E6.m1.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3">top</csymbol></apply></apply><apply id="S3.E6.m1.3.3.5.cmml" xref="S3.E6.m1.3.3.5"><root id="S3.E6.m1.3.3.5a.cmml" xref="S3.E6.m1.3.3.5"></root><apply id="S3.E6.m1.3.3.5.2.cmml" xref="S3.E6.m1.3.3.5.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.5.2.1.cmml" xref="S3.E6.m1.3.3.5.2">subscript</csymbol><ci id="S3.E6.m1.3.3.5.2.2.cmml" xref="S3.E6.m1.3.3.5.2.2">𝑑</ci><ci id="S3.E6.m1.3.3.5.2.3.cmml" xref="S3.E6.m1.3.3.5.2.3">ℎ</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle z_{t}=\frac{1}{H}\sum_{h=1}^{H}\frac{q_{t,h}^{{}^{\prime}}(k_{h}^{{}^{\prime}})^{\top}}{\sqrt{d_{h}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle z=\max_{t=1}^{T}z_{t}" display="inline"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">z</mi><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><munderover id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml"><mi id="S3.E7.m1.1.1.3.1.2.2" xref="S3.E7.m1.1.1.3.1.2.2.cmml">max</mi><mrow id="S3.E7.m1.1.1.3.1.2.3" xref="S3.E7.m1.1.1.3.1.2.3.cmml"><mi id="S3.E7.m1.1.1.3.1.2.3.2" xref="S3.E7.m1.1.1.3.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.1.1.3.1.2.3.1" xref="S3.E7.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.1.1.3.1.2.3.3" xref="S3.E7.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.1.1.3.1.3" xref="S3.E7.m1.1.1.3.1.3.cmml">T</mi></munderover><mo lspace="0.167em" id="S3.E7.m1.1.1.3a" xref="S3.E7.m1.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">z</mi><mi id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></eq><ci id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">𝑧</ci><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><apply id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.1.cmml" xref="S3.E7.m1.1.1.3.1">superscript</csymbol><apply id="S3.E7.m1.1.1.3.1.2.cmml" xref="S3.E7.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.2.1.cmml" xref="S3.E7.m1.1.1.3.1">subscript</csymbol><max id="S3.E7.m1.1.1.3.1.2.2.cmml" xref="S3.E7.m1.1.1.3.1.2.2"></max><apply id="S3.E7.m1.1.1.3.1.2.3.cmml" xref="S3.E7.m1.1.1.3.1.2.3"><eq id="S3.E7.m1.1.1.3.1.2.3.1.cmml" xref="S3.E7.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E7.m1.1.1.3.1.2.3.2.cmml" xref="S3.E7.m1.1.1.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.1.1.3.1.2.3.3.cmml" xref="S3.E7.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.3.1.3.cmml" xref="S3.E7.m1.1.1.3.1.3">𝑇</ci></apply><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝑧</ci><ci id="S3.E7.m1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle z=\max_{t=1}^{T}z_{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm1.10" class="ltx_p ltx_figure_panel">The trainable parameters are <math id="algorithm1.6.m1.1" class="ltx_Math" alttext="\Theta_{h}^{Q}\in\mathbb{R}^{d_{q}\times d_{h}}" display="inline"><semantics id="algorithm1.6.m1.1a"><mrow id="algorithm1.6.m1.1.1" xref="algorithm1.6.m1.1.1.cmml"><msubsup id="algorithm1.6.m1.1.1.2" xref="algorithm1.6.m1.1.1.2.cmml"><mi mathvariant="normal" id="algorithm1.6.m1.1.1.2.2.2" xref="algorithm1.6.m1.1.1.2.2.2.cmml">Θ</mi><mi id="algorithm1.6.m1.1.1.2.2.3" xref="algorithm1.6.m1.1.1.2.2.3.cmml">h</mi><mi id="algorithm1.6.m1.1.1.2.3" xref="algorithm1.6.m1.1.1.2.3.cmml">Q</mi></msubsup><mo id="algorithm1.6.m1.1.1.1" xref="algorithm1.6.m1.1.1.1.cmml">∈</mo><msup id="algorithm1.6.m1.1.1.3" xref="algorithm1.6.m1.1.1.3.cmml"><mi id="algorithm1.6.m1.1.1.3.2" xref="algorithm1.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.6.m1.1.1.3.3" xref="algorithm1.6.m1.1.1.3.3.cmml"><msub id="algorithm1.6.m1.1.1.3.3.2" xref="algorithm1.6.m1.1.1.3.3.2.cmml"><mi id="algorithm1.6.m1.1.1.3.3.2.2" xref="algorithm1.6.m1.1.1.3.3.2.2.cmml">d</mi><mi id="algorithm1.6.m1.1.1.3.3.2.3" xref="algorithm1.6.m1.1.1.3.3.2.3.cmml">q</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algorithm1.6.m1.1.1.3.3.1" xref="algorithm1.6.m1.1.1.3.3.1.cmml">×</mo><msub id="algorithm1.6.m1.1.1.3.3.3" xref="algorithm1.6.m1.1.1.3.3.3.cmml"><mi id="algorithm1.6.m1.1.1.3.3.3.2" xref="algorithm1.6.m1.1.1.3.3.3.2.cmml">d</mi><mi id="algorithm1.6.m1.1.1.3.3.3.3" xref="algorithm1.6.m1.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.m1.1b"><apply id="algorithm1.6.m1.1.1.cmml" xref="algorithm1.6.m1.1.1"><in id="algorithm1.6.m1.1.1.1.cmml" xref="algorithm1.6.m1.1.1.1"></in><apply id="algorithm1.6.m1.1.1.2.cmml" xref="algorithm1.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.6.m1.1.1.2.1.cmml" xref="algorithm1.6.m1.1.1.2">superscript</csymbol><apply id="algorithm1.6.m1.1.1.2.2.cmml" xref="algorithm1.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.6.m1.1.1.2.2.1.cmml" xref="algorithm1.6.m1.1.1.2">subscript</csymbol><ci id="algorithm1.6.m1.1.1.2.2.2.cmml" xref="algorithm1.6.m1.1.1.2.2.2">Θ</ci><ci id="algorithm1.6.m1.1.1.2.2.3.cmml" xref="algorithm1.6.m1.1.1.2.2.3">ℎ</ci></apply><ci id="algorithm1.6.m1.1.1.2.3.cmml" xref="algorithm1.6.m1.1.1.2.3">𝑄</ci></apply><apply id="algorithm1.6.m1.1.1.3.cmml" xref="algorithm1.6.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.6.m1.1.1.3.1.cmml" xref="algorithm1.6.m1.1.1.3">superscript</csymbol><ci id="algorithm1.6.m1.1.1.3.2.cmml" xref="algorithm1.6.m1.1.1.3.2">ℝ</ci><apply id="algorithm1.6.m1.1.1.3.3.cmml" xref="algorithm1.6.m1.1.1.3.3"><times id="algorithm1.6.m1.1.1.3.3.1.cmml" xref="algorithm1.6.m1.1.1.3.3.1"></times><apply id="algorithm1.6.m1.1.1.3.3.2.cmml" xref="algorithm1.6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.6.m1.1.1.3.3.2.1.cmml" xref="algorithm1.6.m1.1.1.3.3.2">subscript</csymbol><ci id="algorithm1.6.m1.1.1.3.3.2.2.cmml" xref="algorithm1.6.m1.1.1.3.3.2.2">𝑑</ci><ci id="algorithm1.6.m1.1.1.3.3.2.3.cmml" xref="algorithm1.6.m1.1.1.3.3.2.3">𝑞</ci></apply><apply id="algorithm1.6.m1.1.1.3.3.3.cmml" xref="algorithm1.6.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.6.m1.1.1.3.3.3.1.cmml" xref="algorithm1.6.m1.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.6.m1.1.1.3.3.3.2.cmml" xref="algorithm1.6.m1.1.1.3.3.3.2">𝑑</ci><ci id="algorithm1.6.m1.1.1.3.3.3.3.cmml" xref="algorithm1.6.m1.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.m1.1c">\Theta_{h}^{Q}\in\mathbb{R}^{d_{q}\times d_{h}}</annotation></semantics></math>, <math id="algorithm1.7.m2.1" class="ltx_Math" alttext="\Theta_{h}^{K}\in\mathbb{R}^{d_{k}\times d_{h}}" display="inline"><semantics id="algorithm1.7.m2.1a"><mrow id="algorithm1.7.m2.1.1" xref="algorithm1.7.m2.1.1.cmml"><msubsup id="algorithm1.7.m2.1.1.2" xref="algorithm1.7.m2.1.1.2.cmml"><mi mathvariant="normal" id="algorithm1.7.m2.1.1.2.2.2" xref="algorithm1.7.m2.1.1.2.2.2.cmml">Θ</mi><mi id="algorithm1.7.m2.1.1.2.2.3" xref="algorithm1.7.m2.1.1.2.2.3.cmml">h</mi><mi id="algorithm1.7.m2.1.1.2.3" xref="algorithm1.7.m2.1.1.2.3.cmml">K</mi></msubsup><mo id="algorithm1.7.m2.1.1.1" xref="algorithm1.7.m2.1.1.1.cmml">∈</mo><msup id="algorithm1.7.m2.1.1.3" xref="algorithm1.7.m2.1.1.3.cmml"><mi id="algorithm1.7.m2.1.1.3.2" xref="algorithm1.7.m2.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.7.m2.1.1.3.3" xref="algorithm1.7.m2.1.1.3.3.cmml"><msub id="algorithm1.7.m2.1.1.3.3.2" xref="algorithm1.7.m2.1.1.3.3.2.cmml"><mi id="algorithm1.7.m2.1.1.3.3.2.2" xref="algorithm1.7.m2.1.1.3.3.2.2.cmml">d</mi><mi id="algorithm1.7.m2.1.1.3.3.2.3" xref="algorithm1.7.m2.1.1.3.3.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algorithm1.7.m2.1.1.3.3.1" xref="algorithm1.7.m2.1.1.3.3.1.cmml">×</mo><msub id="algorithm1.7.m2.1.1.3.3.3" xref="algorithm1.7.m2.1.1.3.3.3.cmml"><mi id="algorithm1.7.m2.1.1.3.3.3.2" xref="algorithm1.7.m2.1.1.3.3.3.2.cmml">d</mi><mi id="algorithm1.7.m2.1.1.3.3.3.3" xref="algorithm1.7.m2.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.m2.1b"><apply id="algorithm1.7.m2.1.1.cmml" xref="algorithm1.7.m2.1.1"><in id="algorithm1.7.m2.1.1.1.cmml" xref="algorithm1.7.m2.1.1.1"></in><apply id="algorithm1.7.m2.1.1.2.cmml" xref="algorithm1.7.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.7.m2.1.1.2.1.cmml" xref="algorithm1.7.m2.1.1.2">superscript</csymbol><apply id="algorithm1.7.m2.1.1.2.2.cmml" xref="algorithm1.7.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.7.m2.1.1.2.2.1.cmml" xref="algorithm1.7.m2.1.1.2">subscript</csymbol><ci id="algorithm1.7.m2.1.1.2.2.2.cmml" xref="algorithm1.7.m2.1.1.2.2.2">Θ</ci><ci id="algorithm1.7.m2.1.1.2.2.3.cmml" xref="algorithm1.7.m2.1.1.2.2.3">ℎ</ci></apply><ci id="algorithm1.7.m2.1.1.2.3.cmml" xref="algorithm1.7.m2.1.1.2.3">𝐾</ci></apply><apply id="algorithm1.7.m2.1.1.3.cmml" xref="algorithm1.7.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.7.m2.1.1.3.1.cmml" xref="algorithm1.7.m2.1.1.3">superscript</csymbol><ci id="algorithm1.7.m2.1.1.3.2.cmml" xref="algorithm1.7.m2.1.1.3.2">ℝ</ci><apply id="algorithm1.7.m2.1.1.3.3.cmml" xref="algorithm1.7.m2.1.1.3.3"><times id="algorithm1.7.m2.1.1.3.3.1.cmml" xref="algorithm1.7.m2.1.1.3.3.1"></times><apply id="algorithm1.7.m2.1.1.3.3.2.cmml" xref="algorithm1.7.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.7.m2.1.1.3.3.2.1.cmml" xref="algorithm1.7.m2.1.1.3.3.2">subscript</csymbol><ci id="algorithm1.7.m2.1.1.3.3.2.2.cmml" xref="algorithm1.7.m2.1.1.3.3.2.2">𝑑</ci><ci id="algorithm1.7.m2.1.1.3.3.2.3.cmml" xref="algorithm1.7.m2.1.1.3.3.2.3">𝑘</ci></apply><apply id="algorithm1.7.m2.1.1.3.3.3.cmml" xref="algorithm1.7.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.7.m2.1.1.3.3.3.1.cmml" xref="algorithm1.7.m2.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.7.m2.1.1.3.3.3.2.cmml" xref="algorithm1.7.m2.1.1.3.3.3.2">𝑑</ci><ci id="algorithm1.7.m2.1.1.3.3.3.3.cmml" xref="algorithm1.7.m2.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.m2.1c">\Theta_{h}^{K}\in\mathbb{R}^{d_{k}\times d_{h}}</annotation></semantics></math>, <math id="algorithm1.8.m3.1" class="ltx_Math" alttext="\Theta_{h}^{NB}\in\mathbb{R}^{d_{h}}" display="inline"><semantics id="algorithm1.8.m3.1a"><mrow id="algorithm1.8.m3.1.1" xref="algorithm1.8.m3.1.1.cmml"><msubsup id="algorithm1.8.m3.1.1.2" xref="algorithm1.8.m3.1.1.2.cmml"><mi mathvariant="normal" id="algorithm1.8.m3.1.1.2.2.2" xref="algorithm1.8.m3.1.1.2.2.2.cmml">Θ</mi><mi id="algorithm1.8.m3.1.1.2.2.3" xref="algorithm1.8.m3.1.1.2.2.3.cmml">h</mi><mrow id="algorithm1.8.m3.1.1.2.3" xref="algorithm1.8.m3.1.1.2.3.cmml"><mi id="algorithm1.8.m3.1.1.2.3.2" xref="algorithm1.8.m3.1.1.2.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="algorithm1.8.m3.1.1.2.3.1" xref="algorithm1.8.m3.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.8.m3.1.1.2.3.3" xref="algorithm1.8.m3.1.1.2.3.3.cmml">B</mi></mrow></msubsup><mo id="algorithm1.8.m3.1.1.1" xref="algorithm1.8.m3.1.1.1.cmml">∈</mo><msup id="algorithm1.8.m3.1.1.3" xref="algorithm1.8.m3.1.1.3.cmml"><mi id="algorithm1.8.m3.1.1.3.2" xref="algorithm1.8.m3.1.1.3.2.cmml">ℝ</mi><msub id="algorithm1.8.m3.1.1.3.3" xref="algorithm1.8.m3.1.1.3.3.cmml"><mi id="algorithm1.8.m3.1.1.3.3.2" xref="algorithm1.8.m3.1.1.3.3.2.cmml">d</mi><mi id="algorithm1.8.m3.1.1.3.3.3" xref="algorithm1.8.m3.1.1.3.3.3.cmml">h</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.m3.1b"><apply id="algorithm1.8.m3.1.1.cmml" xref="algorithm1.8.m3.1.1"><in id="algorithm1.8.m3.1.1.1.cmml" xref="algorithm1.8.m3.1.1.1"></in><apply id="algorithm1.8.m3.1.1.2.cmml" xref="algorithm1.8.m3.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.m3.1.1.2.1.cmml" xref="algorithm1.8.m3.1.1.2">superscript</csymbol><apply id="algorithm1.8.m3.1.1.2.2.cmml" xref="algorithm1.8.m3.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.m3.1.1.2.2.1.cmml" xref="algorithm1.8.m3.1.1.2">subscript</csymbol><ci id="algorithm1.8.m3.1.1.2.2.2.cmml" xref="algorithm1.8.m3.1.1.2.2.2">Θ</ci><ci id="algorithm1.8.m3.1.1.2.2.3.cmml" xref="algorithm1.8.m3.1.1.2.2.3">ℎ</ci></apply><apply id="algorithm1.8.m3.1.1.2.3.cmml" xref="algorithm1.8.m3.1.1.2.3"><times id="algorithm1.8.m3.1.1.2.3.1.cmml" xref="algorithm1.8.m3.1.1.2.3.1"></times><ci id="algorithm1.8.m3.1.1.2.3.2.cmml" xref="algorithm1.8.m3.1.1.2.3.2">𝑁</ci><ci id="algorithm1.8.m3.1.1.2.3.3.cmml" xref="algorithm1.8.m3.1.1.2.3.3">𝐵</ci></apply></apply><apply id="algorithm1.8.m3.1.1.3.cmml" xref="algorithm1.8.m3.1.1.3"><csymbol cd="ambiguous" id="algorithm1.8.m3.1.1.3.1.cmml" xref="algorithm1.8.m3.1.1.3">superscript</csymbol><ci id="algorithm1.8.m3.1.1.3.2.cmml" xref="algorithm1.8.m3.1.1.3.2">ℝ</ci><apply id="algorithm1.8.m3.1.1.3.3.cmml" xref="algorithm1.8.m3.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.8.m3.1.1.3.3.1.cmml" xref="algorithm1.8.m3.1.1.3.3">subscript</csymbol><ci id="algorithm1.8.m3.1.1.3.3.2.cmml" xref="algorithm1.8.m3.1.1.3.3.2">𝑑</ci><ci id="algorithm1.8.m3.1.1.3.3.3.cmml" xref="algorithm1.8.m3.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.m3.1c">\Theta_{h}^{NB}\in\mathbb{R}^{d_{h}}</annotation></semantics></math> (NO_BIAS token), where <math id="algorithm1.9.m4.1" class="ltx_math_unparsed" alttext="t\in[1..T]" display="inline"><semantics id="algorithm1.9.m4.1a"><mrow id="algorithm1.9.m4.1b"><mi id="algorithm1.9.m4.1.1">t</mi><mo id="algorithm1.9.m4.1.2">∈</mo><mrow id="algorithm1.9.m4.1.3"><mo stretchy="false" id="algorithm1.9.m4.1.3.1">[</mo><mn id="algorithm1.9.m4.1.3.2">1</mn><mo lspace="0em" rspace="0.0835em" id="algorithm1.9.m4.1.3.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algorithm1.9.m4.1.3.4">.</mo><mi id="algorithm1.9.m4.1.3.5">T</mi><mo stretchy="false" id="algorithm1.9.m4.1.3.6">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.9.m4.1c">t\in[1..T]</annotation></semantics></math> denotes the time index and <math id="algorithm1.10.m5.1" class="ltx_math_unparsed" alttext="h\in[1..H]" display="inline"><semantics id="algorithm1.10.m5.1a"><mrow id="algorithm1.10.m5.1b"><mi id="algorithm1.10.m5.1.1">h</mi><mo id="algorithm1.10.m5.1.2">∈</mo><mrow id="algorithm1.10.m5.1.3"><mo stretchy="false" id="algorithm1.10.m5.1.3.1">[</mo><mn id="algorithm1.10.m5.1.3.2">1</mn><mo lspace="0em" rspace="0.0835em" id="algorithm1.10.m5.1.3.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algorithm1.10.m5.1.3.4">.</mo><mi id="algorithm1.10.m5.1.3.5">H</mi><mo stretchy="false" id="algorithm1.10.m5.1.3.6">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.10.m5.1c">h\in[1..H]</annotation></semantics></math> denotes the attention head index.</p>
</div>
</div>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">As discussed in Section 5 of  <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite>, one limitation is that the phrase/WP attentions are trained on fewer examples due to sampling (equation <a href="#S2.E2" title="In 2.1 Dual-mode NAM ‣ 2 Related Work ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Another limitation is that the retrieval capability (equation <a href="#S2.E3" title="In 2.1 Dual-mode NAM ‣ 2 Related Work ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is indirectly learned by the ASR loss. We address such limitations by learning the retrieval capability with an explicit loss.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">In phrase attention, the relevance between audio query <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="x^{q}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">x^{q}</annotation></semantics></math> and bias phrases <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="E^{p}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">E</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐸</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">E^{p}</annotation></semantics></math> is computed via Algorithm <a href="#algorithm1" title="Algorithm 1 ‣ 3.2 Cross-entropy guided phrase attention ‣ 3 Methods ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The mean-max pooled logits are then used to compute the softmax cross-entropy loss:</p>
<table id="S6.EGx6" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle z^{p}" display="inline"><semantics id="S3.E8.m1.1a"><msup id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">z</mi><mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1">superscript</csymbol><ci id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2">𝑧</ci><ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle z^{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E8.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E8.m2.1a"><mo id="S3.E8.m2.1.1" xref="S3.E8.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><eq id="S3.E8.m2.1.1.cmml" xref="S3.E8.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m3.2" class="ltx_Math" alttext="\displaystyle f(x^{q},E^{p})" display="inline"><semantics id="S3.E8.m3.2a"><mrow id="S3.E8.m3.2.2" xref="S3.E8.m3.2.2.cmml"><mi id="S3.E8.m3.2.2.4" xref="S3.E8.m3.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E8.m3.2.2.3" xref="S3.E8.m3.2.2.3.cmml">​</mo><mrow id="S3.E8.m3.2.2.2.2" xref="S3.E8.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E8.m3.2.2.2.2.3" xref="S3.E8.m3.2.2.2.3.cmml">(</mo><msup id="S3.E8.m3.1.1.1.1.1" xref="S3.E8.m3.1.1.1.1.1.cmml"><mi id="S3.E8.m3.1.1.1.1.1.2" xref="S3.E8.m3.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E8.m3.1.1.1.1.1.3" xref="S3.E8.m3.1.1.1.1.1.3.cmml">q</mi></msup><mo id="S3.E8.m3.2.2.2.2.4" xref="S3.E8.m3.2.2.2.3.cmml">,</mo><msup id="S3.E8.m3.2.2.2.2.2" xref="S3.E8.m3.2.2.2.2.2.cmml"><mi id="S3.E8.m3.2.2.2.2.2.2" xref="S3.E8.m3.2.2.2.2.2.2.cmml">E</mi><mi id="S3.E8.m3.2.2.2.2.2.3" xref="S3.E8.m3.2.2.2.2.2.3.cmml">p</mi></msup><mo stretchy="false" id="S3.E8.m3.2.2.2.2.5" xref="S3.E8.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m3.2b"><apply id="S3.E8.m3.2.2.cmml" xref="S3.E8.m3.2.2"><times id="S3.E8.m3.2.2.3.cmml" xref="S3.E8.m3.2.2.3"></times><ci id="S3.E8.m3.2.2.4.cmml" xref="S3.E8.m3.2.2.4">𝑓</ci><interval closure="open" id="S3.E8.m3.2.2.2.3.cmml" xref="S3.E8.m3.2.2.2.2"><apply id="S3.E8.m3.1.1.1.1.1.cmml" xref="S3.E8.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m3.1.1.1.1.1.1.cmml" xref="S3.E8.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m3.1.1.1.1.1.2.cmml" xref="S3.E8.m3.1.1.1.1.1.2">𝑥</ci><ci id="S3.E8.m3.1.1.1.1.1.3.cmml" xref="S3.E8.m3.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E8.m3.2.2.2.2.2.cmml" xref="S3.E8.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m3.2.2.2.2.2.1.cmml" xref="S3.E8.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.E8.m3.2.2.2.2.2.2.cmml" xref="S3.E8.m3.2.2.2.2.2.2">𝐸</ci><ci id="S3.E8.m3.2.2.2.2.2.3.cmml" xref="S3.E8.m3.2.2.2.2.2.3">𝑝</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m3.2c">\displaystyle f(x^{q},E^{p})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{p}" display="inline"><semantics id="S3.E9.m1.1a"><msub id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">ℒ</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2">ℒ</ci><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathcal{L}_{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E9.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E9.m2.1a"><mo id="S3.E9.m2.1.1" xref="S3.E9.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E9.m2.1b"><eq id="S3.E9.m2.1.1.cmml" xref="S3.E9.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m3.2" class="ltx_Math" alttext="\displaystyle L\_SCE(z^{p},labels)" display="inline"><semantics id="S3.E9.m3.2a"><mrow id="S3.E9.m3.2.2" xref="S3.E9.m3.2.2.cmml"><mi id="S3.E9.m3.2.2.4" xref="S3.E9.m3.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.3" xref="S3.E9.m3.2.2.3.cmml">​</mo><mi mathvariant="normal" id="S3.E9.m3.2.2.5" xref="S3.E9.m3.2.2.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.3a" xref="S3.E9.m3.2.2.3.cmml">​</mo><mi id="S3.E9.m3.2.2.6" xref="S3.E9.m3.2.2.6.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.3b" xref="S3.E9.m3.2.2.3.cmml">​</mo><mi id="S3.E9.m3.2.2.7" xref="S3.E9.m3.2.2.7.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.3c" xref="S3.E9.m3.2.2.3.cmml">​</mo><mi id="S3.E9.m3.2.2.8" xref="S3.E9.m3.2.2.8.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.3d" xref="S3.E9.m3.2.2.3.cmml">​</mo><mrow id="S3.E9.m3.2.2.2.2" xref="S3.E9.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E9.m3.2.2.2.2.3" xref="S3.E9.m3.2.2.2.3.cmml">(</mo><msup id="S3.E9.m3.1.1.1.1.1" xref="S3.E9.m3.1.1.1.1.1.cmml"><mi id="S3.E9.m3.1.1.1.1.1.2" xref="S3.E9.m3.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E9.m3.1.1.1.1.1.3" xref="S3.E9.m3.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S3.E9.m3.2.2.2.2.4" xref="S3.E9.m3.2.2.2.3.cmml">,</mo><mrow id="S3.E9.m3.2.2.2.2.2" xref="S3.E9.m3.2.2.2.2.2.cmml"><mi id="S3.E9.m3.2.2.2.2.2.2" xref="S3.E9.m3.2.2.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.2.2.2.1" xref="S3.E9.m3.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E9.m3.2.2.2.2.2.3" xref="S3.E9.m3.2.2.2.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.2.2.2.1a" xref="S3.E9.m3.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E9.m3.2.2.2.2.2.4" xref="S3.E9.m3.2.2.2.2.2.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.2.2.2.1b" xref="S3.E9.m3.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E9.m3.2.2.2.2.2.5" xref="S3.E9.m3.2.2.2.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.2.2.2.1c" xref="S3.E9.m3.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E9.m3.2.2.2.2.2.6" xref="S3.E9.m3.2.2.2.2.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m3.2.2.2.2.2.1d" xref="S3.E9.m3.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E9.m3.2.2.2.2.2.7" xref="S3.E9.m3.2.2.2.2.2.7.cmml">s</mi></mrow><mo stretchy="false" id="S3.E9.m3.2.2.2.2.5" xref="S3.E9.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m3.2b"><apply id="S3.E9.m3.2.2.cmml" xref="S3.E9.m3.2.2"><times id="S3.E9.m3.2.2.3.cmml" xref="S3.E9.m3.2.2.3"></times><ci id="S3.E9.m3.2.2.4.cmml" xref="S3.E9.m3.2.2.4">𝐿</ci><ci id="S3.E9.m3.2.2.5.cmml" xref="S3.E9.m3.2.2.5">_</ci><ci id="S3.E9.m3.2.2.6.cmml" xref="S3.E9.m3.2.2.6">𝑆</ci><ci id="S3.E9.m3.2.2.7.cmml" xref="S3.E9.m3.2.2.7">𝐶</ci><ci id="S3.E9.m3.2.2.8.cmml" xref="S3.E9.m3.2.2.8">𝐸</ci><interval closure="open" id="S3.E9.m3.2.2.2.3.cmml" xref="S3.E9.m3.2.2.2.2"><apply id="S3.E9.m3.1.1.1.1.1.cmml" xref="S3.E9.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m3.1.1.1.1.1.1.cmml" xref="S3.E9.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.E9.m3.1.1.1.1.1.2.cmml" xref="S3.E9.m3.1.1.1.1.1.2">𝑧</ci><ci id="S3.E9.m3.1.1.1.1.1.3.cmml" xref="S3.E9.m3.1.1.1.1.1.3">𝑝</ci></apply><apply id="S3.E9.m3.2.2.2.2.2.cmml" xref="S3.E9.m3.2.2.2.2.2"><times id="S3.E9.m3.2.2.2.2.2.1.cmml" xref="S3.E9.m3.2.2.2.2.2.1"></times><ci id="S3.E9.m3.2.2.2.2.2.2.cmml" xref="S3.E9.m3.2.2.2.2.2.2">𝑙</ci><ci id="S3.E9.m3.2.2.2.2.2.3.cmml" xref="S3.E9.m3.2.2.2.2.2.3">𝑎</ci><ci id="S3.E9.m3.2.2.2.2.2.4.cmml" xref="S3.E9.m3.2.2.2.2.2.4">𝑏</ci><ci id="S3.E9.m3.2.2.2.2.2.5.cmml" xref="S3.E9.m3.2.2.2.2.2.5">𝑒</ci><ci id="S3.E9.m3.2.2.2.2.2.6.cmml" xref="S3.E9.m3.2.2.2.2.2.6">𝑙</ci><ci id="S3.E9.m3.2.2.2.2.2.7.cmml" xref="S3.E9.m3.2.2.2.2.2.7">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m3.2c">\displaystyle L\_SCE(z^{p},labels)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.3" class="ltx_p">where <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="labels\in\mathbb{R}^{1+N}" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><mrow id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mrow id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2.2" xref="S3.SS2.p2.3.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m1.1.1.2.1" xref="S3.SS2.p2.3.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.3.m1.1.1.2.3" xref="S3.SS2.p2.3.m1.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m1.1.1.2.1a" xref="S3.SS2.p2.3.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.3.m1.1.1.2.4" xref="S3.SS2.p2.3.m1.1.1.2.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m1.1.1.2.1b" xref="S3.SS2.p2.3.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.3.m1.1.1.2.5" xref="S3.SS2.p2.3.m1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m1.1.1.2.1c" xref="S3.SS2.p2.3.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.3.m1.1.1.2.6" xref="S3.SS2.p2.3.m1.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m1.1.1.2.1d" xref="S3.SS2.p2.3.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.3.m1.1.1.2.7" xref="S3.SS2.p2.3.m1.1.1.2.7.cmml">s</mi></mrow><mo id="S3.SS2.p2.3.m1.1.1.1" xref="S3.SS2.p2.3.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml"><mi id="S3.SS2.p2.3.m1.1.1.3.2" xref="S3.SS2.p2.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.3.m1.1.1.3.3" xref="S3.SS2.p2.3.m1.1.1.3.3.cmml"><mn id="S3.SS2.p2.3.m1.1.1.3.3.2" xref="S3.SS2.p2.3.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.p2.3.m1.1.1.3.3.1" xref="S3.SS2.p2.3.m1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.p2.3.m1.1.1.3.3.3" xref="S3.SS2.p2.3.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><in id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1.1"></in><apply id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2"><times id="S3.SS2.p2.3.m1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m1.1.1.2.1"></times><ci id="S3.SS2.p2.3.m1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2.2">𝑙</ci><ci id="S3.SS2.p2.3.m1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m1.1.1.2.3">𝑎</ci><ci id="S3.SS2.p2.3.m1.1.1.2.4.cmml" xref="S3.SS2.p2.3.m1.1.1.2.4">𝑏</ci><ci id="S3.SS2.p2.3.m1.1.1.2.5.cmml" xref="S3.SS2.p2.3.m1.1.1.2.5">𝑒</ci><ci id="S3.SS2.p2.3.m1.1.1.2.6.cmml" xref="S3.SS2.p2.3.m1.1.1.2.6">𝑙</ci><ci id="S3.SS2.p2.3.m1.1.1.2.7.cmml" xref="S3.SS2.p2.3.m1.1.1.2.7">𝑠</ci></apply><apply id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.3.1.cmml" xref="S3.SS2.p2.3.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.3.2.cmml" xref="S3.SS2.p2.3.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.3.m1.1.1.3.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3.3"><plus id="S3.SS2.p2.3.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.3.m1.1.1.3.3.1"></plus><cn type="integer" id="S3.SS2.p2.3.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.3.m1.1.1.3.3.2">1</cn><ci id="S3.SS2.p2.3.m1.1.1.3.3.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">labels\in\mathbb{R}^{1+N}</annotation></semantics></math> corresponds to a probability distribution of the bias labels, with the leading “1” being the NO_BIAS token. During training, a bias phrase is marked as a correct label if it’s a longest substring of the transcript truth; the NO_BIAS token is marked as the correct label if none of the bias phrases is a substring of the transcript truth.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">At inference, the global top <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">k</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑘</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">k^{p}</annotation></semantics></math> phrases are used to invoke the context encoder and WP attention.</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_math_unparsed" alttext="I^{p}_{global}=TopK(z^{p}_{[2:]},k^{p})" display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2"><msubsup id="S3.E10.m1.2.2.4"><mi id="S3.E10.m1.2.2.4.2.2">I</mi><mrow id="S3.E10.m1.2.2.4.3"><mi id="S3.E10.m1.2.2.4.3.2">g</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.4.3.1">​</mo><mi id="S3.E10.m1.2.2.4.3.3">l</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.4.3.1a">​</mo><mi id="S3.E10.m1.2.2.4.3.4">o</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.4.3.1b">​</mo><mi id="S3.E10.m1.2.2.4.3.5">b</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.4.3.1c">​</mo><mi id="S3.E10.m1.2.2.4.3.6">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.4.3.1d">​</mo><mi id="S3.E10.m1.2.2.4.3.7">l</mi></mrow><mi id="S3.E10.m1.2.2.4.2.3">p</mi></msubsup><mo id="S3.E10.m1.2.2.3">=</mo><mrow id="S3.E10.m1.2.2.2"><mi id="S3.E10.m1.2.2.2.4">T</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.3">​</mo><mi id="S3.E10.m1.2.2.2.5">o</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.3a">​</mo><mi id="S3.E10.m1.2.2.2.6">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.3b">​</mo><mi id="S3.E10.m1.2.2.2.7">K</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.3c">​</mo><mrow id="S3.E10.m1.2.2.2.2.2"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.3">(</mo><msubsup id="S3.E10.m1.1.1.1.1.1.1"><mi id="S3.E10.m1.1.1.1.1.1.1.2.2">z</mi><mrow id="S3.E10.m1.1.1.1.1.1.1.3"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.3.1">[</mo><mn id="S3.E10.m1.1.1.1.1.1.1.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.E10.m1.1.1.1.1.1.1.3.3">:</mo><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.3.4">]</mo></mrow><mi id="S3.E10.m1.1.1.1.1.1.1.2.3">p</mi></msubsup><mo id="S3.E10.m1.2.2.2.2.2.4">,</mo><msup id="S3.E10.m1.2.2.2.2.2.2"><mi id="S3.E10.m1.2.2.2.2.2.2.2">k</mi><mi id="S3.E10.m1.2.2.2.2.2.2.3">p</mi></msup><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.5">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E10.m1.2b">I^{p}_{global}=TopK(z^{p}_{[2:]},k^{p})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Deferred context encoder</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">By offloading phrase encoding to a dedicated lightweight encoder, the context encoder can exclusively focus on generating fine-grained WP encodings for utilization by the WP attention. While the context encoder is trained on the same set of bias phrases <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">W</annotation></semantics></math> as the phrase encoder, during inference, only the top-<math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">k</annotation></semantics></math> phrases identified through the phrase attention mechanism require encoding.</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.1" class="ltx_Math" alttext="E^{w}=\mathit{ContextEncoder}(W)" display="block"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.2" xref="S3.E11.m1.1.2.cmml"><msup id="S3.E11.m1.1.2.2" xref="S3.E11.m1.1.2.2.cmml"><mi id="S3.E11.m1.1.2.2.2" xref="S3.E11.m1.1.2.2.2.cmml">E</mi><mi id="S3.E11.m1.1.2.2.3" xref="S3.E11.m1.1.2.2.3.cmml">w</mi></msup><mo id="S3.E11.m1.1.2.1" xref="S3.E11.m1.1.2.1.cmml">=</mo><mrow id="S3.E11.m1.1.2.3" xref="S3.E11.m1.1.2.3.cmml"><mi id="S3.E11.m1.1.2.3.2" xref="S3.E11.m1.1.2.3.2.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.2.3.1" xref="S3.E11.m1.1.2.3.1.cmml">​</mo><mrow id="S3.E11.m1.1.2.3.3.2" xref="S3.E11.m1.1.2.3.cmml"><mo stretchy="false" id="S3.E11.m1.1.2.3.3.2.1" xref="S3.E11.m1.1.2.3.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">W</mi><mo stretchy="false" id="S3.E11.m1.1.2.3.3.2.2" xref="S3.E11.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.2.cmml" xref="S3.E11.m1.1.2"><eq id="S3.E11.m1.1.2.1.cmml" xref="S3.E11.m1.1.2.1"></eq><apply id="S3.E11.m1.1.2.2.cmml" xref="S3.E11.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.2.2.1.cmml" xref="S3.E11.m1.1.2.2">superscript</csymbol><ci id="S3.E11.m1.1.2.2.2.cmml" xref="S3.E11.m1.1.2.2.2">𝐸</ci><ci id="S3.E11.m1.1.2.2.3.cmml" xref="S3.E11.m1.1.2.2.3">𝑤</ci></apply><apply id="S3.E11.m1.1.2.3.cmml" xref="S3.E11.m1.1.2.3"><times id="S3.E11.m1.1.2.3.1.cmml" xref="S3.E11.m1.1.2.3.1"></times><ci id="S3.E11.m1.1.2.3.2.cmml" xref="S3.E11.m1.1.2.3.2">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">E^{w}=\mathit{ContextEncoder}(W)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.6" class="ltx_p">Where <math id="S3.SS3.p1.3.m1.7" class="ltx_Math" alttext="E^{w}=\{e_{n,1},...,e_{n,L}\}_{n=1}^{N}\in\mathbb{R}^{N\times L\times d}" display="inline"><semantics id="S3.SS3.p1.3.m1.7a"><mrow id="S3.SS3.p1.3.m1.7.7" xref="S3.SS3.p1.3.m1.7.7.cmml"><msup id="S3.SS3.p1.3.m1.7.7.4" xref="S3.SS3.p1.3.m1.7.7.4.cmml"><mi id="S3.SS3.p1.3.m1.7.7.4.2" xref="S3.SS3.p1.3.m1.7.7.4.2.cmml">E</mi><mi id="S3.SS3.p1.3.m1.7.7.4.3" xref="S3.SS3.p1.3.m1.7.7.4.3.cmml">w</mi></msup><mo id="S3.SS3.p1.3.m1.7.7.5" xref="S3.SS3.p1.3.m1.7.7.5.cmml">=</mo><msubsup id="S3.SS3.p1.3.m1.7.7.2" xref="S3.SS3.p1.3.m1.7.7.2.cmml"><mrow id="S3.SS3.p1.3.m1.7.7.2.2.2.2" xref="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m1.7.7.2.2.2.2.3" xref="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml">{</mo><msub id="S3.SS3.p1.3.m1.6.6.1.1.1.1.1" xref="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.2" xref="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.2.cmml">e</mi><mrow id="S3.SS3.p1.3.m1.2.2.2.4" xref="S3.SS3.p1.3.m1.2.2.2.3.cmml"><mi id="S3.SS3.p1.3.m1.1.1.1.1" xref="S3.SS3.p1.3.m1.1.1.1.1.cmml">n</mi><mo id="S3.SS3.p1.3.m1.2.2.2.4.1" xref="S3.SS3.p1.3.m1.2.2.2.3.cmml">,</mo><mn id="S3.SS3.p1.3.m1.2.2.2.2" xref="S3.SS3.p1.3.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.3.m1.7.7.2.2.2.2.4" xref="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.3.m1.5.5" xref="S3.SS3.p1.3.m1.5.5.cmml">…</mi><mo id="S3.SS3.p1.3.m1.7.7.2.2.2.2.5" xref="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.3.m1.7.7.2.2.2.2.2" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.2" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.2.cmml">e</mi><mrow id="S3.SS3.p1.3.m1.4.4.2.4" xref="S3.SS3.p1.3.m1.4.4.2.3.cmml"><mi id="S3.SS3.p1.3.m1.3.3.1.1" xref="S3.SS3.p1.3.m1.3.3.1.1.cmml">n</mi><mo id="S3.SS3.p1.3.m1.4.4.2.4.1" xref="S3.SS3.p1.3.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p1.3.m1.4.4.2.2" xref="S3.SS3.p1.3.m1.4.4.2.2.cmml">L</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.3.m1.7.7.2.2.2.2.6" xref="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS3.p1.3.m1.7.7.2.2.4" xref="S3.SS3.p1.3.m1.7.7.2.2.4.cmml"><mi id="S3.SS3.p1.3.m1.7.7.2.2.4.2" xref="S3.SS3.p1.3.m1.7.7.2.2.4.2.cmml">n</mi><mo id="S3.SS3.p1.3.m1.7.7.2.2.4.1" xref="S3.SS3.p1.3.m1.7.7.2.2.4.1.cmml">=</mo><mn id="S3.SS3.p1.3.m1.7.7.2.2.4.3" xref="S3.SS3.p1.3.m1.7.7.2.2.4.3.cmml">1</mn></mrow><mi id="S3.SS3.p1.3.m1.7.7.2.4" xref="S3.SS3.p1.3.m1.7.7.2.4.cmml">N</mi></msubsup><mo id="S3.SS3.p1.3.m1.7.7.6" xref="S3.SS3.p1.3.m1.7.7.6.cmml">∈</mo><msup id="S3.SS3.p1.3.m1.7.7.7" xref="S3.SS3.p1.3.m1.7.7.7.cmml"><mi id="S3.SS3.p1.3.m1.7.7.7.2" xref="S3.SS3.p1.3.m1.7.7.7.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.3.m1.7.7.7.3" xref="S3.SS3.p1.3.m1.7.7.7.3.cmml"><mi id="S3.SS3.p1.3.m1.7.7.7.3.2" xref="S3.SS3.p1.3.m1.7.7.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.3.m1.7.7.7.3.1" xref="S3.SS3.p1.3.m1.7.7.7.3.1.cmml">×</mo><mi id="S3.SS3.p1.3.m1.7.7.7.3.3" xref="S3.SS3.p1.3.m1.7.7.7.3.3.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.3.m1.7.7.7.3.1a" xref="S3.SS3.p1.3.m1.7.7.7.3.1.cmml">×</mo><mi id="S3.SS3.p1.3.m1.7.7.7.3.4" xref="S3.SS3.p1.3.m1.7.7.7.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m1.7b"><apply id="S3.SS3.p1.3.m1.7.7.cmml" xref="S3.SS3.p1.3.m1.7.7"><and id="S3.SS3.p1.3.m1.7.7a.cmml" xref="S3.SS3.p1.3.m1.7.7"></and><apply id="S3.SS3.p1.3.m1.7.7b.cmml" xref="S3.SS3.p1.3.m1.7.7"><eq id="S3.SS3.p1.3.m1.7.7.5.cmml" xref="S3.SS3.p1.3.m1.7.7.5"></eq><apply id="S3.SS3.p1.3.m1.7.7.4.cmml" xref="S3.SS3.p1.3.m1.7.7.4"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.7.7.4.1.cmml" xref="S3.SS3.p1.3.m1.7.7.4">superscript</csymbol><ci id="S3.SS3.p1.3.m1.7.7.4.2.cmml" xref="S3.SS3.p1.3.m1.7.7.4.2">𝐸</ci><ci id="S3.SS3.p1.3.m1.7.7.4.3.cmml" xref="S3.SS3.p1.3.m1.7.7.4.3">𝑤</ci></apply><apply id="S3.SS3.p1.3.m1.7.7.2.cmml" xref="S3.SS3.p1.3.m1.7.7.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.7.7.2.3.cmml" xref="S3.SS3.p1.3.m1.7.7.2">superscript</csymbol><apply id="S3.SS3.p1.3.m1.7.7.2.2.cmml" xref="S3.SS3.p1.3.m1.7.7.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.7.7.2.2.3.cmml" xref="S3.SS3.p1.3.m1.7.7.2">subscript</csymbol><set id="S3.SS3.p1.3.m1.7.7.2.2.2.3.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2"><apply id="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m1.6.6.1.1.1.1.1.2">𝑒</ci><list id="S3.SS3.p1.3.m1.2.2.2.3.cmml" xref="S3.SS3.p1.3.m1.2.2.2.4"><ci id="S3.SS3.p1.3.m1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m1.1.1.1.1">𝑛</ci><cn type="integer" id="S3.SS3.p1.3.m1.2.2.2.2.cmml" xref="S3.SS3.p1.3.m1.2.2.2.2">1</cn></list></apply><ci id="S3.SS3.p1.3.m1.5.5.cmml" xref="S3.SS3.p1.3.m1.5.5">…</ci><apply id="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.2.2.2.2">𝑒</ci><list id="S3.SS3.p1.3.m1.4.4.2.3.cmml" xref="S3.SS3.p1.3.m1.4.4.2.4"><ci id="S3.SS3.p1.3.m1.3.3.1.1.cmml" xref="S3.SS3.p1.3.m1.3.3.1.1">𝑛</ci><ci id="S3.SS3.p1.3.m1.4.4.2.2.cmml" xref="S3.SS3.p1.3.m1.4.4.2.2">𝐿</ci></list></apply></set><apply id="S3.SS3.p1.3.m1.7.7.2.2.4.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.4"><eq id="S3.SS3.p1.3.m1.7.7.2.2.4.1.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.4.1"></eq><ci id="S3.SS3.p1.3.m1.7.7.2.2.4.2.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.4.2">𝑛</ci><cn type="integer" id="S3.SS3.p1.3.m1.7.7.2.2.4.3.cmml" xref="S3.SS3.p1.3.m1.7.7.2.2.4.3">1</cn></apply></apply><ci id="S3.SS3.p1.3.m1.7.7.2.4.cmml" xref="S3.SS3.p1.3.m1.7.7.2.4">𝑁</ci></apply></apply><apply id="S3.SS3.p1.3.m1.7.7c.cmml" xref="S3.SS3.p1.3.m1.7.7"><in id="S3.SS3.p1.3.m1.7.7.6.cmml" xref="S3.SS3.p1.3.m1.7.7.6"></in><share href="#S3.SS3.p1.3.m1.7.7.2.cmml" id="S3.SS3.p1.3.m1.7.7d.cmml" xref="S3.SS3.p1.3.m1.7.7"></share><apply id="S3.SS3.p1.3.m1.7.7.7.cmml" xref="S3.SS3.p1.3.m1.7.7.7"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m1.7.7.7.1.cmml" xref="S3.SS3.p1.3.m1.7.7.7">superscript</csymbol><ci id="S3.SS3.p1.3.m1.7.7.7.2.cmml" xref="S3.SS3.p1.3.m1.7.7.7.2">ℝ</ci><apply id="S3.SS3.p1.3.m1.7.7.7.3.cmml" xref="S3.SS3.p1.3.m1.7.7.7.3"><times id="S3.SS3.p1.3.m1.7.7.7.3.1.cmml" xref="S3.SS3.p1.3.m1.7.7.7.3.1"></times><ci id="S3.SS3.p1.3.m1.7.7.7.3.2.cmml" xref="S3.SS3.p1.3.m1.7.7.7.3.2">𝑁</ci><ci id="S3.SS3.p1.3.m1.7.7.7.3.3.cmml" xref="S3.SS3.p1.3.m1.7.7.7.3.3">𝐿</ci><ci id="S3.SS3.p1.3.m1.7.7.7.3.4.cmml" xref="S3.SS3.p1.3.m1.7.7.7.3.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m1.7c">E^{w}=\{e_{n,1},...,e_{n,L}\}_{n=1}^{N}\in\mathbb{R}^{N\times L\times d}</annotation></semantics></math> represents WP encodings, such that <math id="S3.SS3.p1.4.m2.2" class="ltx_Math" alttext="e_{i,j}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS3.p1.4.m2.2a"><mrow id="S3.SS3.p1.4.m2.2.3" xref="S3.SS3.p1.4.m2.2.3.cmml"><msub id="S3.SS3.p1.4.m2.2.3.2" xref="S3.SS3.p1.4.m2.2.3.2.cmml"><mi id="S3.SS3.p1.4.m2.2.3.2.2" xref="S3.SS3.p1.4.m2.2.3.2.2.cmml">e</mi><mrow id="S3.SS3.p1.4.m2.2.2.2.4" xref="S3.SS3.p1.4.m2.2.2.2.3.cmml"><mi id="S3.SS3.p1.4.m2.1.1.1.1" xref="S3.SS3.p1.4.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.4.m2.2.2.2.4.1" xref="S3.SS3.p1.4.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.4.m2.2.2.2.2" xref="S3.SS3.p1.4.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS3.p1.4.m2.2.3.1" xref="S3.SS3.p1.4.m2.2.3.1.cmml">∈</mo><msup id="S3.SS3.p1.4.m2.2.3.3" xref="S3.SS3.p1.4.m2.2.3.3.cmml"><mi id="S3.SS3.p1.4.m2.2.3.3.2" xref="S3.SS3.p1.4.m2.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.p1.4.m2.2.3.3.3" xref="S3.SS3.p1.4.m2.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m2.2b"><apply id="S3.SS3.p1.4.m2.2.3.cmml" xref="S3.SS3.p1.4.m2.2.3"><in id="S3.SS3.p1.4.m2.2.3.1.cmml" xref="S3.SS3.p1.4.m2.2.3.1"></in><apply id="S3.SS3.p1.4.m2.2.3.2.cmml" xref="S3.SS3.p1.4.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m2.2.3.2.1.cmml" xref="S3.SS3.p1.4.m2.2.3.2">subscript</csymbol><ci id="S3.SS3.p1.4.m2.2.3.2.2.cmml" xref="S3.SS3.p1.4.m2.2.3.2.2">𝑒</ci><list id="S3.SS3.p1.4.m2.2.2.2.3.cmml" xref="S3.SS3.p1.4.m2.2.2.2.4"><ci id="S3.SS3.p1.4.m2.1.1.1.1.cmml" xref="S3.SS3.p1.4.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.4.m2.2.2.2.2.cmml" xref="S3.SS3.p1.4.m2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS3.p1.4.m2.2.3.3.cmml" xref="S3.SS3.p1.4.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m2.2.3.3.1.cmml" xref="S3.SS3.p1.4.m2.2.3.3">superscript</csymbol><ci id="S3.SS3.p1.4.m2.2.3.3.2.cmml" xref="S3.SS3.p1.4.m2.2.3.3.2">ℝ</ci><ci id="S3.SS3.p1.4.m2.2.3.3.3.cmml" xref="S3.SS3.p1.4.m2.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m2.2c">e_{i,j}\in\mathbb{R}^{d}</annotation></semantics></math> represents the <math id="S3.SS3.p1.5.m3.1" class="ltx_Math" alttext="i^{\text{th}}" display="inline"><semantics id="S3.SS3.p1.5.m3.1a"><msup id="S3.SS3.p1.5.m3.1.1" xref="S3.SS3.p1.5.m3.1.1.cmml"><mi id="S3.SS3.p1.5.m3.1.1.2" xref="S3.SS3.p1.5.m3.1.1.2.cmml">i</mi><mtext id="S3.SS3.p1.5.m3.1.1.3" xref="S3.SS3.p1.5.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m3.1b"><apply id="S3.SS3.p1.5.m3.1.1.cmml" xref="S3.SS3.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m3.1.1.1.cmml" xref="S3.SS3.p1.5.m3.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m3.1.1.2.cmml" xref="S3.SS3.p1.5.m3.1.1.2">𝑖</ci><ci id="S3.SS3.p1.5.m3.1.1.3a.cmml" xref="S3.SS3.p1.5.m3.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.5.m3.1.1.3.cmml" xref="S3.SS3.p1.5.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m3.1c">i^{\text{th}}</annotation></semantics></math> phrase candidate’s wordpiece encoding at position <math id="S3.SS3.p1.6.m4.3" class="ltx_Math" alttext="j\in\{1,...,L\}" display="inline"><semantics id="S3.SS3.p1.6.m4.3a"><mrow id="S3.SS3.p1.6.m4.3.4" xref="S3.SS3.p1.6.m4.3.4.cmml"><mi id="S3.SS3.p1.6.m4.3.4.2" xref="S3.SS3.p1.6.m4.3.4.2.cmml">j</mi><mo id="S3.SS3.p1.6.m4.3.4.1" xref="S3.SS3.p1.6.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS3.p1.6.m4.3.4.3.2" xref="S3.SS3.p1.6.m4.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m4.3.4.3.2.1" xref="S3.SS3.p1.6.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS3.p1.6.m4.1.1" xref="S3.SS3.p1.6.m4.1.1.cmml">1</mn><mo id="S3.SS3.p1.6.m4.3.4.3.2.2" xref="S3.SS3.p1.6.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.6.m4.2.2" xref="S3.SS3.p1.6.m4.2.2.cmml">…</mi><mo id="S3.SS3.p1.6.m4.3.4.3.2.3" xref="S3.SS3.p1.6.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p1.6.m4.3.3" xref="S3.SS3.p1.6.m4.3.3.cmml">L</mi><mo stretchy="false" id="S3.SS3.p1.6.m4.3.4.3.2.4" xref="S3.SS3.p1.6.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m4.3b"><apply id="S3.SS3.p1.6.m4.3.4.cmml" xref="S3.SS3.p1.6.m4.3.4"><in id="S3.SS3.p1.6.m4.3.4.1.cmml" xref="S3.SS3.p1.6.m4.3.4.1"></in><ci id="S3.SS3.p1.6.m4.3.4.2.cmml" xref="S3.SS3.p1.6.m4.3.4.2">𝑗</ci><set id="S3.SS3.p1.6.m4.3.4.3.1.cmml" xref="S3.SS3.p1.6.m4.3.4.3.2"><cn type="integer" id="S3.SS3.p1.6.m4.1.1.cmml" xref="S3.SS3.p1.6.m4.1.1">1</cn><ci id="S3.SS3.p1.6.m4.2.2.cmml" xref="S3.SS3.p1.6.m4.2.2">…</ci><ci id="S3.SS3.p1.6.m4.3.3.cmml" xref="S3.SS3.p1.6.m4.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m4.3c">j\in\{1,...,L\}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Cross-entropy guided WP attention</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">After that, the standard NAM WP attention biasing context <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="c^{w}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msup id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑐</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">c^{w}</annotation></semantics></math> is computed and added to the acoustic encoder feature for contextualization.</p>
<table id="S6.EGx7" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.1" class="ltx_Math" alttext="\displaystyle c^{w}" display="inline"><semantics id="S3.E12.m1.1a"><msup id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mi id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">c</mi><mi id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1">superscript</csymbol><ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">𝑐</ci><ci id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle c^{w}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E12.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E12.m2.1a"><mo id="S3.E12.m2.1.1" xref="S3.E12.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E12.m2.1b"><eq id="S3.E12.m2.1.1.cmml" xref="S3.E12.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12.m3.2" class="ltx_Math" alttext="\displaystyle\mathit{WPAttention}(x^{q},E^{w})" display="inline"><semantics id="S3.E12.m3.2a"><mrow id="S3.E12.m3.2.2" xref="S3.E12.m3.2.2.cmml"><mi id="S3.E12.m3.2.2.4" xref="S3.E12.m3.2.2.4.cmml">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><mo lspace="0em" rspace="0em" id="S3.E12.m3.2.2.3" xref="S3.E12.m3.2.2.3.cmml">​</mo><mrow id="S3.E12.m3.2.2.2.2" xref="S3.E12.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E12.m3.2.2.2.2.3" xref="S3.E12.m3.2.2.2.3.cmml">(</mo><msup id="S3.E12.m3.1.1.1.1.1" xref="S3.E12.m3.1.1.1.1.1.cmml"><mi id="S3.E12.m3.1.1.1.1.1.2" xref="S3.E12.m3.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E12.m3.1.1.1.1.1.3" xref="S3.E12.m3.1.1.1.1.1.3.cmml">q</mi></msup><mo id="S3.E12.m3.2.2.2.2.4" xref="S3.E12.m3.2.2.2.3.cmml">,</mo><msup id="S3.E12.m3.2.2.2.2.2" xref="S3.E12.m3.2.2.2.2.2.cmml"><mi id="S3.E12.m3.2.2.2.2.2.2" xref="S3.E12.m3.2.2.2.2.2.2.cmml">E</mi><mi id="S3.E12.m3.2.2.2.2.2.3" xref="S3.E12.m3.2.2.2.2.2.3.cmml">w</mi></msup><mo stretchy="false" id="S3.E12.m3.2.2.2.2.5" xref="S3.E12.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m3.2b"><apply id="S3.E12.m3.2.2.cmml" xref="S3.E12.m3.2.2"><times id="S3.E12.m3.2.2.3.cmml" xref="S3.E12.m3.2.2.3"></times><ci id="S3.E12.m3.2.2.4.cmml" xref="S3.E12.m3.2.2.4">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci><interval closure="open" id="S3.E12.m3.2.2.2.3.cmml" xref="S3.E12.m3.2.2.2.2"><apply id="S3.E12.m3.1.1.1.1.1.cmml" xref="S3.E12.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m3.1.1.1.1.1.1.cmml" xref="S3.E12.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m3.1.1.1.1.1.2.cmml" xref="S3.E12.m3.1.1.1.1.1.2">𝑥</ci><ci id="S3.E12.m3.1.1.1.1.1.3.cmml" xref="S3.E12.m3.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E12.m3.2.2.2.2.2.cmml" xref="S3.E12.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m3.2.2.2.2.2.1.cmml" xref="S3.E12.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.E12.m3.2.2.2.2.2.2.cmml" xref="S3.E12.m3.2.2.2.2.2.2">𝐸</ci><ci id="S3.E12.m3.2.2.2.2.2.3.cmml" xref="S3.E12.m3.2.2.2.2.2.3">𝑤</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m3.2c">\displaystyle\mathit{WPAttention}(x^{q},E^{w})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\displaystyle x^{biased}" display="inline"><semantics id="S3.E13.m1.1a"><msup id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">x</mi><mrow id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml"><mi id="S3.E13.m1.1.1.3.2" xref="S3.E13.m1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.1" xref="S3.E13.m1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.3" xref="S3.E13.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.1a" xref="S3.E13.m1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.4" xref="S3.E13.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.1b" xref="S3.E13.m1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.5" xref="S3.E13.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.1c" xref="S3.E13.m1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.6" xref="S3.E13.m1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.1d" xref="S3.E13.m1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.7" xref="S3.E13.m1.1.1.3.7.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1">superscript</csymbol><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">𝑥</ci><apply id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3"><times id="S3.E13.m1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.3.1"></times><ci id="S3.E13.m1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.3.2">𝑏</ci><ci id="S3.E13.m1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.3.3">𝑖</ci><ci id="S3.E13.m1.1.1.3.4.cmml" xref="S3.E13.m1.1.1.3.4">𝑎</ci><ci id="S3.E13.m1.1.1.3.5.cmml" xref="S3.E13.m1.1.1.3.5">𝑠</ci><ci id="S3.E13.m1.1.1.3.6.cmml" xref="S3.E13.m1.1.1.3.6">𝑒</ci><ci id="S3.E13.m1.1.1.3.7.cmml" xref="S3.E13.m1.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle x^{biased}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E13.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E13.m2.1a"><mo id="S3.E13.m2.1.1" xref="S3.E13.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E13.m2.1b"><eq id="S3.E13.m2.1.1.cmml" xref="S3.E13.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13.m3.1" class="ltx_Math" alttext="\displaystyle x+c^{w}" display="inline"><semantics id="S3.E13.m3.1a"><mrow id="S3.E13.m3.1.1" xref="S3.E13.m3.1.1.cmml"><mi id="S3.E13.m3.1.1.2" xref="S3.E13.m3.1.1.2.cmml">x</mi><mo id="S3.E13.m3.1.1.1" xref="S3.E13.m3.1.1.1.cmml">+</mo><msup id="S3.E13.m3.1.1.3" xref="S3.E13.m3.1.1.3.cmml"><mi id="S3.E13.m3.1.1.3.2" xref="S3.E13.m3.1.1.3.2.cmml">c</mi><mi id="S3.E13.m3.1.1.3.3" xref="S3.E13.m3.1.1.3.3.cmml">w</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m3.1b"><apply id="S3.E13.m3.1.1.cmml" xref="S3.E13.m3.1.1"><plus id="S3.E13.m3.1.1.1.cmml" xref="S3.E13.m3.1.1.1"></plus><ci id="S3.E13.m3.1.1.2.cmml" xref="S3.E13.m3.1.1.2">𝑥</ci><apply id="S3.E13.m3.1.1.3.cmml" xref="S3.E13.m3.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m3.1.1.3.1.cmml" xref="S3.E13.m3.1.1.3">superscript</csymbol><ci id="S3.E13.m3.1.1.3.2.cmml" xref="S3.E13.m3.1.1.3.2">𝑐</ci><ci id="S3.E13.m3.1.1.3.3.cmml" xref="S3.E13.m3.1.1.3.3">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m3.1c">\displaystyle x+c^{w}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.2" class="ltx_p">We further augment the <math id="S3.SS4.p1.2.m1.1" class="ltx_Math" alttext="\mathit{WPAttention}" display="inline"><semantics id="S3.SS4.p1.2.m1.1a"><mi id="S3.SS4.p1.2.m1.1.1" xref="S3.SS4.p1.2.m1.1.1.cmml">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m1.1b"><ci id="S3.SS4.p1.2.m1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m1.1c">\mathit{WPAttention}</annotation></semantics></math> with a cross-entropy training loss to boost the likelihood scores of the relevant WPs. Similar to the phrase attention, we first compute the mean-max pooled logits for the WP tokens using Algorithm <a href="#algorithm1" title="Algorithm 1 ‣ 3.2 Cross-entropy guided phrase attention ‣ 3 Methods ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>:</p>
<table id="S6.EGx8" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.2" class="ltx_Math" alttext="\displaystyle z^{w}=f(x^{q},E^{w})\in\mathbb{R}^{1+NL}" display="inline"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2.2" xref="S3.E14.m1.2.2.cmml"><msup id="S3.E14.m1.2.2.4" xref="S3.E14.m1.2.2.4.cmml"><mi id="S3.E14.m1.2.2.4.2" xref="S3.E14.m1.2.2.4.2.cmml">z</mi><mi id="S3.E14.m1.2.2.4.3" xref="S3.E14.m1.2.2.4.3.cmml">w</mi></msup><mo id="S3.E14.m1.2.2.5" xref="S3.E14.m1.2.2.5.cmml">=</mo><mrow id="S3.E14.m1.2.2.2" xref="S3.E14.m1.2.2.2.cmml"><mi id="S3.E14.m1.2.2.2.4" xref="S3.E14.m1.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.2.3" xref="S3.E14.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E14.m1.2.2.2.2.2" xref="S3.E14.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E14.m1.2.2.2.2.2.3" xref="S3.E14.m1.2.2.2.2.3.cmml">(</mo><msup id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E14.m1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.cmml">q</mi></msup><mo id="S3.E14.m1.2.2.2.2.2.4" xref="S3.E14.m1.2.2.2.2.3.cmml">,</mo><msup id="S3.E14.m1.2.2.2.2.2.2" xref="S3.E14.m1.2.2.2.2.2.2.cmml"><mi id="S3.E14.m1.2.2.2.2.2.2.2" xref="S3.E14.m1.2.2.2.2.2.2.2.cmml">E</mi><mi id="S3.E14.m1.2.2.2.2.2.2.3" xref="S3.E14.m1.2.2.2.2.2.2.3.cmml">w</mi></msup><mo stretchy="false" id="S3.E14.m1.2.2.2.2.2.5" xref="S3.E14.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.2.2.6" xref="S3.E14.m1.2.2.6.cmml">∈</mo><msup id="S3.E14.m1.2.2.7" xref="S3.E14.m1.2.2.7.cmml"><mi id="S3.E14.m1.2.2.7.2" xref="S3.E14.m1.2.2.7.2.cmml">ℝ</mi><mrow id="S3.E14.m1.2.2.7.3" xref="S3.E14.m1.2.2.7.3.cmml"><mn id="S3.E14.m1.2.2.7.3.2" xref="S3.E14.m1.2.2.7.3.2.cmml">1</mn><mo id="S3.E14.m1.2.2.7.3.1" xref="S3.E14.m1.2.2.7.3.1.cmml">+</mo><mrow id="S3.E14.m1.2.2.7.3.3" xref="S3.E14.m1.2.2.7.3.3.cmml"><mi id="S3.E14.m1.2.2.7.3.3.2" xref="S3.E14.m1.2.2.7.3.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.7.3.3.1" xref="S3.E14.m1.2.2.7.3.3.1.cmml">​</mo><mi id="S3.E14.m1.2.2.7.3.3.3" xref="S3.E14.m1.2.2.7.3.3.3.cmml">L</mi></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.2b"><apply id="S3.E14.m1.2.2.cmml" xref="S3.E14.m1.2.2"><and id="S3.E14.m1.2.2a.cmml" xref="S3.E14.m1.2.2"></and><apply id="S3.E14.m1.2.2b.cmml" xref="S3.E14.m1.2.2"><eq id="S3.E14.m1.2.2.5.cmml" xref="S3.E14.m1.2.2.5"></eq><apply id="S3.E14.m1.2.2.4.cmml" xref="S3.E14.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.4.1.cmml" xref="S3.E14.m1.2.2.4">superscript</csymbol><ci id="S3.E14.m1.2.2.4.2.cmml" xref="S3.E14.m1.2.2.4.2">𝑧</ci><ci id="S3.E14.m1.2.2.4.3.cmml" xref="S3.E14.m1.2.2.4.3">𝑤</ci></apply><apply id="S3.E14.m1.2.2.2.cmml" xref="S3.E14.m1.2.2.2"><times id="S3.E14.m1.2.2.2.3.cmml" xref="S3.E14.m1.2.2.2.3"></times><ci id="S3.E14.m1.2.2.2.4.cmml" xref="S3.E14.m1.2.2.2.4">𝑓</ci><interval closure="open" id="S3.E14.m1.2.2.2.2.3.cmml" xref="S3.E14.m1.2.2.2.2.2"><apply id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E14.m1.2.2.2.2.2.2.cmml" xref="S3.E14.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E14.m1.2.2.2.2.2.2.2.cmml" xref="S3.E14.m1.2.2.2.2.2.2.2">𝐸</ci><ci id="S3.E14.m1.2.2.2.2.2.2.3.cmml" xref="S3.E14.m1.2.2.2.2.2.2.3">𝑤</ci></apply></interval></apply></apply><apply id="S3.E14.m1.2.2c.cmml" xref="S3.E14.m1.2.2"><in id="S3.E14.m1.2.2.6.cmml" xref="S3.E14.m1.2.2.6"></in><share href="#S3.E14.m1.2.2.2.cmml" id="S3.E14.m1.2.2d.cmml" xref="S3.E14.m1.2.2"></share><apply id="S3.E14.m1.2.2.7.cmml" xref="S3.E14.m1.2.2.7"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.7.1.cmml" xref="S3.E14.m1.2.2.7">superscript</csymbol><ci id="S3.E14.m1.2.2.7.2.cmml" xref="S3.E14.m1.2.2.7.2">ℝ</ci><apply id="S3.E14.m1.2.2.7.3.cmml" xref="S3.E14.m1.2.2.7.3"><plus id="S3.E14.m1.2.2.7.3.1.cmml" xref="S3.E14.m1.2.2.7.3.1"></plus><cn type="integer" id="S3.E14.m1.2.2.7.3.2.cmml" xref="S3.E14.m1.2.2.7.3.2">1</cn><apply id="S3.E14.m1.2.2.7.3.3.cmml" xref="S3.E14.m1.2.2.7.3.3"><times id="S3.E14.m1.2.2.7.3.3.1.cmml" xref="S3.E14.m1.2.2.7.3.3.1"></times><ci id="S3.E14.m1.2.2.7.3.3.2.cmml" xref="S3.E14.m1.2.2.7.3.3.2">𝑁</ci><ci id="S3.E14.m1.2.2.7.3.3.3.cmml" xref="S3.E14.m1.2.2.7.3.3.3">𝐿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\displaystyle z^{w}=f(x^{q},E^{w})\in\mathbb{R}^{1+NL}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.3" class="ltx_p">Secondly, the per-phrase average WP logits <math id="S3.SS4.p1.3.m1.1" class="ltx_math_unparsed" alttext="\overline{z^{w}_{[2:]}}" display="inline"><semantics id="S3.SS4.p1.3.m1.1a"><mover accent="true" id="S3.SS4.p1.3.m1.1.1"><msubsup id="S3.SS4.p1.3.m1.1.1.2"><mi id="S3.SS4.p1.3.m1.1.1.2.2.2">z</mi><mrow id="S3.SS4.p1.3.m1.1.1.2.3"><mo stretchy="false" id="S3.SS4.p1.3.m1.1.1.2.3.1">[</mo><mn id="S3.SS4.p1.3.m1.1.1.2.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.SS4.p1.3.m1.1.1.2.3.3">:</mo><mo stretchy="false" id="S3.SS4.p1.3.m1.1.1.2.3.4">]</mo></mrow><mi id="S3.SS4.p1.3.m1.1.1.2.2.3">w</mi></msubsup><mo id="S3.SS4.p1.3.m1.1.1.1">¯</mo></mover><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m1.1b">\overline{z^{w}_{[2:]}}</annotation></semantics></math> are computed, i.e., by summing the logits of each phrase and then dividing by the phrase’s effective sequence length, ignoring padding tokens.</p>
<table id="S6.EGx9" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\overline{z^{w}_{[2:]}}=\mathit{PerPhraseAvg}(z^{w}_{[2:]})\in\mathbb{R}^{N}" display="inline"><semantics id="S3.E15.m1.1a"><mrow id="S3.E15.m1.1.1"><mover accent="true" id="S3.E15.m1.1.1.3"><msubsup id="S3.E15.m1.1.1.3.2"><mi id="S3.E15.m1.1.1.3.2.2.2">z</mi><mrow id="S3.E15.m1.1.1.3.2.3"><mo stretchy="false" id="S3.E15.m1.1.1.3.2.3.1">[</mo><mn id="S3.E15.m1.1.1.3.2.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.E15.m1.1.1.3.2.3.3">:</mo><mo stretchy="false" id="S3.E15.m1.1.1.3.2.3.4">]</mo></mrow><mi id="S3.E15.m1.1.1.3.2.2.3">w</mi></msubsup><mo id="S3.E15.m1.1.1.3.1">¯</mo></mover><mo id="S3.E15.m1.1.1.4">=</mo><mrow id="S3.E15.m1.1.1.1"><mi id="S3.E15.m1.1.1.1.3">𝑃𝑒𝑟𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑣𝑔</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.2">​</mo><mrow id="S3.E15.m1.1.1.1.1.1"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.2">(</mo><msubsup id="S3.E15.m1.1.1.1.1.1.1"><mi id="S3.E15.m1.1.1.1.1.1.1.2.2">z</mi><mrow id="S3.E15.m1.1.1.1.1.1.1.3"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.3.1">[</mo><mn id="S3.E15.m1.1.1.1.1.1.1.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.1.3.3">:</mo><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.3.4">]</mo></mrow><mi id="S3.E15.m1.1.1.1.1.1.1.2.3">w</mi></msubsup><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S3.E15.m1.1.1.5">∈</mo><msup id="S3.E15.m1.1.1.6"><mi id="S3.E15.m1.1.1.6.2">ℝ</mi><mi id="S3.E15.m1.1.1.6.3">N</mi></msup></mrow><annotation encoding="application/x-tex" id="S3.E15.m1.1b">\displaystyle\overline{z^{w}_{[2:]}}=\mathit{PerPhraseAvg}(z^{w}_{[2:]})\in\mathbb{R}^{N}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.6" class="ltx_p">Thirdly, the NO_BIAS logit <math id="S3.SS4.p1.4.m1.1" class="ltx_Math" alttext="z^{w}_{[1:2]}" display="inline"><semantics id="S3.SS4.p1.4.m1.1a"><msubsup id="S3.SS4.p1.4.m1.1.2" xref="S3.SS4.p1.4.m1.1.2.cmml"><mi id="S3.SS4.p1.4.m1.1.2.2.2" xref="S3.SS4.p1.4.m1.1.2.2.2.cmml">z</mi><mrow id="S3.SS4.p1.4.m1.1.1.1.1" xref="S3.SS4.p1.4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.4.m1.1.1.1.1.2" xref="S3.SS4.p1.4.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS4.p1.4.m1.1.1.1.1.1" xref="S3.SS4.p1.4.m1.1.1.1.1.1.cmml"><mn id="S3.SS4.p1.4.m1.1.1.1.1.1.2" xref="S3.SS4.p1.4.m1.1.1.1.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS4.p1.4.m1.1.1.1.1.1.1" xref="S3.SS4.p1.4.m1.1.1.1.1.1.1.cmml">:</mo><mn id="S3.SS4.p1.4.m1.1.1.1.1.1.3" xref="S3.SS4.p1.4.m1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S3.SS4.p1.4.m1.1.1.1.1.3" xref="S3.SS4.p1.4.m1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.SS4.p1.4.m1.1.2.2.3" xref="S3.SS4.p1.4.m1.1.2.2.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m1.1b"><apply id="S3.SS4.p1.4.m1.1.2.cmml" xref="S3.SS4.p1.4.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m1.1.2.1.cmml" xref="S3.SS4.p1.4.m1.1.2">subscript</csymbol><apply id="S3.SS4.p1.4.m1.1.2.2.cmml" xref="S3.SS4.p1.4.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m1.1.2.2.1.cmml" xref="S3.SS4.p1.4.m1.1.2">superscript</csymbol><ci id="S3.SS4.p1.4.m1.1.2.2.2.cmml" xref="S3.SS4.p1.4.m1.1.2.2.2">𝑧</ci><ci id="S3.SS4.p1.4.m1.1.2.2.3.cmml" xref="S3.SS4.p1.4.m1.1.2.2.3">𝑤</ci></apply><apply id="S3.SS4.p1.4.m1.1.1.1.2.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p1.4.m1.1.1.1.2.1.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.p1.4.m1.1.1.1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1.1"><ci id="S3.SS4.p1.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1.1.1">:</ci><cn type="integer" id="S3.SS4.p1.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1.1.2">1</cn><cn type="integer" id="S3.SS4.p1.4.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.4.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m1.1c">z^{w}_{[1:2]}</annotation></semantics></math> is concatenated with the per-phrase average WP logits <math id="S3.SS4.p1.5.m2.1" class="ltx_math_unparsed" alttext="\overline{z^{w}_{[2:]}}" display="inline"><semantics id="S3.SS4.p1.5.m2.1a"><mover accent="true" id="S3.SS4.p1.5.m2.1.1"><msubsup id="S3.SS4.p1.5.m2.1.1.2"><mi id="S3.SS4.p1.5.m2.1.1.2.2.2">z</mi><mrow id="S3.SS4.p1.5.m2.1.1.2.3"><mo stretchy="false" id="S3.SS4.p1.5.m2.1.1.2.3.1">[</mo><mn id="S3.SS4.p1.5.m2.1.1.2.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.SS4.p1.5.m2.1.1.2.3.3">:</mo><mo stretchy="false" id="S3.SS4.p1.5.m2.1.1.2.3.4">]</mo></mrow><mi id="S3.SS4.p1.5.m2.1.1.2.2.3">w</mi></msubsup><mo id="S3.SS4.p1.5.m2.1.1.1">¯</mo></mover><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m2.1b">\overline{z^{w}_{[2:]}}</annotation></semantics></math> to form <math id="S3.SS4.p1.6.m3.1" class="ltx_Math" alttext="\overline{z^{w}}" display="inline"><semantics id="S3.SS4.p1.6.m3.1a"><mover accent="true" id="S3.SS4.p1.6.m3.1.1" xref="S3.SS4.p1.6.m3.1.1.cmml"><msup id="S3.SS4.p1.6.m3.1.1.2" xref="S3.SS4.p1.6.m3.1.1.2.cmml"><mi id="S3.SS4.p1.6.m3.1.1.2.2" xref="S3.SS4.p1.6.m3.1.1.2.2.cmml">z</mi><mi id="S3.SS4.p1.6.m3.1.1.2.3" xref="S3.SS4.p1.6.m3.1.1.2.3.cmml">w</mi></msup><mo id="S3.SS4.p1.6.m3.1.1.1" xref="S3.SS4.p1.6.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m3.1b"><apply id="S3.SS4.p1.6.m3.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1"><ci id="S3.SS4.p1.6.m3.1.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1.1">¯</ci><apply id="S3.SS4.p1.6.m3.1.1.2.cmml" xref="S3.SS4.p1.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m3.1.1.2.1.cmml" xref="S3.SS4.p1.6.m3.1.1.2">superscript</csymbol><ci id="S3.SS4.p1.6.m3.1.1.2.2.cmml" xref="S3.SS4.p1.6.m3.1.1.2.2">𝑧</ci><ci id="S3.SS4.p1.6.m3.1.1.2.3.cmml" xref="S3.SS4.p1.6.m3.1.1.2.3">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m3.1c">\overline{z^{w}}</annotation></semantics></math> for calculating the cross-entropy loss.</p>
<table id="S6.EGx10" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16.m1.3" class="ltx_math_unparsed" alttext="\displaystyle\overline{z^{w}}=[z^{w}_{[1:2]};\overline{z^{w}_{[2:]}}]\in\mathbb{R}^{1+N}" display="inline"><semantics id="S3.E16.m1.3a"><mrow id="S3.E16.m1.3.3"><mover accent="true" id="S3.E16.m1.3.3.3"><msup id="S3.E16.m1.3.3.3.2"><mi id="S3.E16.m1.3.3.3.2.2">z</mi><mi id="S3.E16.m1.3.3.3.2.3">w</mi></msup><mo id="S3.E16.m1.3.3.3.1">¯</mo></mover><mo id="S3.E16.m1.3.3.4">=</mo><mrow id="S3.E16.m1.3.3.1.1"><mo stretchy="false" id="S3.E16.m1.3.3.1.1.2">[</mo><msubsup id="S3.E16.m1.3.3.1.1.1"><mi id="S3.E16.m1.3.3.1.1.1.2.2">z</mi><mrow id="S3.E16.m1.1.1.1.1"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.2">[</mo><mrow id="S3.E16.m1.1.1.1.1.1"><mn id="S3.E16.m1.1.1.1.1.1.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E16.m1.1.1.1.1.1.1">:</mo><mn id="S3.E16.m1.1.1.1.1.1.3">2</mn></mrow><mo stretchy="false" id="S3.E16.m1.1.1.1.1.3">]</mo></mrow><mi id="S3.E16.m1.3.3.1.1.1.2.3">w</mi></msubsup><mo id="S3.E16.m1.3.3.1.1.3">;</mo><mover accent="true" id="S3.E16.m1.2.2"><msubsup id="S3.E16.m1.2.2.2"><mi id="S3.E16.m1.2.2.2.2.2">z</mi><mrow id="S3.E16.m1.2.2.2.3"><mo stretchy="false" id="S3.E16.m1.2.2.2.3.1">[</mo><mn id="S3.E16.m1.2.2.2.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S3.E16.m1.2.2.2.3.3">:</mo><mo stretchy="false" id="S3.E16.m1.2.2.2.3.4">]</mo></mrow><mi id="S3.E16.m1.2.2.2.2.3">w</mi></msubsup><mo id="S3.E16.m1.2.2.1">¯</mo></mover><mo stretchy="false" id="S3.E16.m1.3.3.1.1.4">]</mo></mrow><mo id="S3.E16.m1.3.3.5">∈</mo><msup id="S3.E16.m1.3.3.6"><mi id="S3.E16.m1.3.3.6.2">ℝ</mi><mrow id="S3.E16.m1.3.3.6.3"><mn id="S3.E16.m1.3.3.6.3.2">1</mn><mo id="S3.E16.m1.3.3.6.3.1">+</mo><mi id="S3.E16.m1.3.3.6.3.3">N</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.E16.m1.3b">\displaystyle\overline{z^{w}}=[z^{w}_{[1:2]};\overline{z^{w}_{[2:]}}]\in\mathbb{R}^{1+N}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{w}=L\_SCE(\overline{z^{w}},labels)" display="inline"><semantics id="S3.E17.m1.2a"><mrow id="S3.E17.m1.2.2" xref="S3.E17.m1.2.2.cmml"><msub id="S3.E17.m1.2.2.3" xref="S3.E17.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m1.2.2.3.2" xref="S3.E17.m1.2.2.3.2.cmml">ℒ</mi><mi id="S3.E17.m1.2.2.3.3" xref="S3.E17.m1.2.2.3.3.cmml">w</mi></msub><mo id="S3.E17.m1.2.2.2" xref="S3.E17.m1.2.2.2.cmml">=</mo><mrow id="S3.E17.m1.2.2.1" xref="S3.E17.m1.2.2.1.cmml"><mi id="S3.E17.m1.2.2.1.3" xref="S3.E17.m1.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.2" xref="S3.E17.m1.2.2.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.E17.m1.2.2.1.4" xref="S3.E17.m1.2.2.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.2a" xref="S3.E17.m1.2.2.1.2.cmml">​</mo><mi id="S3.E17.m1.2.2.1.5" xref="S3.E17.m1.2.2.1.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.2b" xref="S3.E17.m1.2.2.1.2.cmml">​</mo><mi id="S3.E17.m1.2.2.1.6" xref="S3.E17.m1.2.2.1.6.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.2c" xref="S3.E17.m1.2.2.1.2.cmml">​</mo><mi id="S3.E17.m1.2.2.1.7" xref="S3.E17.m1.2.2.1.7.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.2d" xref="S3.E17.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E17.m1.2.2.1.1.1" xref="S3.E17.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.2" xref="S3.E17.m1.2.2.1.1.2.cmml">(</mo><mover accent="true" id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><msup id="S3.E17.m1.1.1.2" xref="S3.E17.m1.1.1.2.cmml"><mi id="S3.E17.m1.1.1.2.2" xref="S3.E17.m1.1.1.2.2.cmml">z</mi><mi id="S3.E17.m1.1.1.2.3" xref="S3.E17.m1.1.1.2.3.cmml">w</mi></msup><mo id="S3.E17.m1.1.1.1" xref="S3.E17.m1.1.1.1.cmml">¯</mo></mover><mo id="S3.E17.m1.2.2.1.1.1.3" xref="S3.E17.m1.2.2.1.1.2.cmml">,</mo><mrow id="S3.E17.m1.2.2.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1a" xref="S3.E17.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.4" xref="S3.E17.m1.2.2.1.1.1.1.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1b" xref="S3.E17.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.5" xref="S3.E17.m1.2.2.1.1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1c" xref="S3.E17.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.6" xref="S3.E17.m1.2.2.1.1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1d" xref="S3.E17.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.7" xref="S3.E17.m1.2.2.1.1.1.1.7.cmml">s</mi></mrow><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.4" xref="S3.E17.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.2b"><apply id="S3.E17.m1.2.2.cmml" xref="S3.E17.m1.2.2"><eq id="S3.E17.m1.2.2.2.cmml" xref="S3.E17.m1.2.2.2"></eq><apply id="S3.E17.m1.2.2.3.cmml" xref="S3.E17.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.3.1.cmml" xref="S3.E17.m1.2.2.3">subscript</csymbol><ci id="S3.E17.m1.2.2.3.2.cmml" xref="S3.E17.m1.2.2.3.2">ℒ</ci><ci id="S3.E17.m1.2.2.3.3.cmml" xref="S3.E17.m1.2.2.3.3">𝑤</ci></apply><apply id="S3.E17.m1.2.2.1.cmml" xref="S3.E17.m1.2.2.1"><times id="S3.E17.m1.2.2.1.2.cmml" xref="S3.E17.m1.2.2.1.2"></times><ci id="S3.E17.m1.2.2.1.3.cmml" xref="S3.E17.m1.2.2.1.3">𝐿</ci><ci id="S3.E17.m1.2.2.1.4.cmml" xref="S3.E17.m1.2.2.1.4">_</ci><ci id="S3.E17.m1.2.2.1.5.cmml" xref="S3.E17.m1.2.2.1.5">𝑆</ci><ci id="S3.E17.m1.2.2.1.6.cmml" xref="S3.E17.m1.2.2.1.6">𝐶</ci><ci id="S3.E17.m1.2.2.1.7.cmml" xref="S3.E17.m1.2.2.1.7">𝐸</ci><interval closure="open" id="S3.E17.m1.2.2.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1"><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"><ci id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1.1">¯</ci><apply id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.1.cmml" xref="S3.E17.m1.1.1.2">superscript</csymbol><ci id="S3.E17.m1.1.1.2.2.cmml" xref="S3.E17.m1.1.1.2.2">𝑧</ci><ci id="S3.E17.m1.1.1.2.3.cmml" xref="S3.E17.m1.1.1.2.3">𝑤</ci></apply></apply><apply id="S3.E17.m1.2.2.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1"><times id="S3.E17.m1.2.2.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1"></times><ci id="S3.E17.m1.2.2.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.2">𝑙</ci><ci id="S3.E17.m1.2.2.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.3">𝑎</ci><ci id="S3.E17.m1.2.2.1.1.1.1.4.cmml" xref="S3.E17.m1.2.2.1.1.1.1.4">𝑏</ci><ci id="S3.E17.m1.2.2.1.1.1.1.5.cmml" xref="S3.E17.m1.2.2.1.1.1.1.5">𝑒</ci><ci id="S3.E17.m1.2.2.1.1.1.1.6.cmml" xref="S3.E17.m1.2.2.1.1.1.1.6">𝑙</ci><ci id="S3.E17.m1.2.2.1.1.1.1.7.cmml" xref="S3.E17.m1.2.2.1.1.1.1.7">𝑠</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.2c">\displaystyle\mathcal{L}_{w}=L\_SCE(\overline{z^{w}},labels)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.7" class="ltx_p">Finally, the total loss is a weighted sum of the ASR, phrase- and WP-level cross-entropy losses.</p>
<table id="S6.EGx11" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E18.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{total}=\mathcal{L}_{asr}+\lambda_{p}\mathcal{L}_{p}+\lambda_{w}\mathcal{L}_{w}" display="inline"><semantics id="S3.E18.m1.1a"><mrow id="S3.E18.m1.1.1" xref="S3.E18.m1.1.1.cmml"><msub id="S3.E18.m1.1.1.2" xref="S3.E18.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m1.1.1.2.2" xref="S3.E18.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E18.m1.1.1.2.3" xref="S3.E18.m1.1.1.2.3.cmml"><mi id="S3.E18.m1.1.1.2.3.2" xref="S3.E18.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.2.3.1" xref="S3.E18.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.2.3.3" xref="S3.E18.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.2.3.1a" xref="S3.E18.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.2.3.4" xref="S3.E18.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.2.3.1b" xref="S3.E18.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.2.3.5" xref="S3.E18.m1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.2.3.1c" xref="S3.E18.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.2.3.6" xref="S3.E18.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E18.m1.1.1.1" xref="S3.E18.m1.1.1.1.cmml">=</mo><mrow id="S3.E18.m1.1.1.3" xref="S3.E18.m1.1.1.3.cmml"><msub id="S3.E18.m1.1.1.3.2" xref="S3.E18.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m1.1.1.3.2.2" xref="S3.E18.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E18.m1.1.1.3.2.3" xref="S3.E18.m1.1.1.3.2.3.cmml"><mi id="S3.E18.m1.1.1.3.2.3.2" xref="S3.E18.m1.1.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.2.3.1" xref="S3.E18.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.3.2.3.3" xref="S3.E18.m1.1.1.3.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.2.3.1a" xref="S3.E18.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E18.m1.1.1.3.2.3.4" xref="S3.E18.m1.1.1.3.2.3.4.cmml">r</mi></mrow></msub><mo id="S3.E18.m1.1.1.3.1" xref="S3.E18.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E18.m1.1.1.3.3" xref="S3.E18.m1.1.1.3.3.cmml"><msub id="S3.E18.m1.1.1.3.3.2" xref="S3.E18.m1.1.1.3.3.2.cmml"><mi id="S3.E18.m1.1.1.3.3.2.2" xref="S3.E18.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="S3.E18.m1.1.1.3.3.2.3" xref="S3.E18.m1.1.1.3.3.2.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.3.1" xref="S3.E18.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.E18.m1.1.1.3.3.3" xref="S3.E18.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m1.1.1.3.3.3.2" xref="S3.E18.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S3.E18.m1.1.1.3.3.3.3" xref="S3.E18.m1.1.1.3.3.3.3.cmml">p</mi></msub></mrow><mo id="S3.E18.m1.1.1.3.1a" xref="S3.E18.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E18.m1.1.1.3.4" xref="S3.E18.m1.1.1.3.4.cmml"><msub id="S3.E18.m1.1.1.3.4.2" xref="S3.E18.m1.1.1.3.4.2.cmml"><mi id="S3.E18.m1.1.1.3.4.2.2" xref="S3.E18.m1.1.1.3.4.2.2.cmml">λ</mi><mi id="S3.E18.m1.1.1.3.4.2.3" xref="S3.E18.m1.1.1.3.4.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.4.1" xref="S3.E18.m1.1.1.3.4.1.cmml">​</mo><msub id="S3.E18.m1.1.1.3.4.3" xref="S3.E18.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m1.1.1.3.4.3.2" xref="S3.E18.m1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S3.E18.m1.1.1.3.4.3.3" xref="S3.E18.m1.1.1.3.4.3.3.cmml">w</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.1b"><apply id="S3.E18.m1.1.1.cmml" xref="S3.E18.m1.1.1"><eq id="S3.E18.m1.1.1.1.cmml" xref="S3.E18.m1.1.1.1"></eq><apply id="S3.E18.m1.1.1.2.cmml" xref="S3.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.2.1.cmml" xref="S3.E18.m1.1.1.2">subscript</csymbol><ci id="S3.E18.m1.1.1.2.2.cmml" xref="S3.E18.m1.1.1.2.2">ℒ</ci><apply id="S3.E18.m1.1.1.2.3.cmml" xref="S3.E18.m1.1.1.2.3"><times id="S3.E18.m1.1.1.2.3.1.cmml" xref="S3.E18.m1.1.1.2.3.1"></times><ci id="S3.E18.m1.1.1.2.3.2.cmml" xref="S3.E18.m1.1.1.2.3.2">𝑡</ci><ci id="S3.E18.m1.1.1.2.3.3.cmml" xref="S3.E18.m1.1.1.2.3.3">𝑜</ci><ci id="S3.E18.m1.1.1.2.3.4.cmml" xref="S3.E18.m1.1.1.2.3.4">𝑡</ci><ci id="S3.E18.m1.1.1.2.3.5.cmml" xref="S3.E18.m1.1.1.2.3.5">𝑎</ci><ci id="S3.E18.m1.1.1.2.3.6.cmml" xref="S3.E18.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E18.m1.1.1.3.cmml" xref="S3.E18.m1.1.1.3"><plus id="S3.E18.m1.1.1.3.1.cmml" xref="S3.E18.m1.1.1.3.1"></plus><apply id="S3.E18.m1.1.1.3.2.cmml" xref="S3.E18.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.2.1.cmml" xref="S3.E18.m1.1.1.3.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.2.2.cmml" xref="S3.E18.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E18.m1.1.1.3.2.3.cmml" xref="S3.E18.m1.1.1.3.2.3"><times id="S3.E18.m1.1.1.3.2.3.1.cmml" xref="S3.E18.m1.1.1.3.2.3.1"></times><ci id="S3.E18.m1.1.1.3.2.3.2.cmml" xref="S3.E18.m1.1.1.3.2.3.2">𝑎</ci><ci id="S3.E18.m1.1.1.3.2.3.3.cmml" xref="S3.E18.m1.1.1.3.2.3.3">𝑠</ci><ci id="S3.E18.m1.1.1.3.2.3.4.cmml" xref="S3.E18.m1.1.1.3.2.3.4">𝑟</ci></apply></apply><apply id="S3.E18.m1.1.1.3.3.cmml" xref="S3.E18.m1.1.1.3.3"><times id="S3.E18.m1.1.1.3.3.1.cmml" xref="S3.E18.m1.1.1.3.3.1"></times><apply id="S3.E18.m1.1.1.3.3.2.cmml" xref="S3.E18.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.3.2.1.cmml" xref="S3.E18.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.3.2.2.cmml" xref="S3.E18.m1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E18.m1.1.1.3.3.2.3.cmml" xref="S3.E18.m1.1.1.3.3.2.3">𝑝</ci></apply><apply id="S3.E18.m1.1.1.3.3.3.cmml" xref="S3.E18.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.3.3.1.cmml" xref="S3.E18.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E18.m1.1.1.3.3.3.2.cmml" xref="S3.E18.m1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E18.m1.1.1.3.3.3.3.cmml" xref="S3.E18.m1.1.1.3.3.3.3">𝑝</ci></apply></apply><apply id="S3.E18.m1.1.1.3.4.cmml" xref="S3.E18.m1.1.1.3.4"><times id="S3.E18.m1.1.1.3.4.1.cmml" xref="S3.E18.m1.1.1.3.4.1"></times><apply id="S3.E18.m1.1.1.3.4.2.cmml" xref="S3.E18.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.4.2.1.cmml" xref="S3.E18.m1.1.1.3.4.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.4.2.2.cmml" xref="S3.E18.m1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E18.m1.1.1.3.4.2.3.cmml" xref="S3.E18.m1.1.1.3.4.2.3">𝑤</ci></apply><apply id="S3.E18.m1.1.1.3.4.3.cmml" xref="S3.E18.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.4.3.1.cmml" xref="S3.E18.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E18.m1.1.1.3.4.3.2.cmml" xref="S3.E18.m1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E18.m1.1.1.3.4.3.3.cmml" xref="S3.E18.m1.1.1.3.4.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.1c">\displaystyle\mathcal{L}_{total}=\mathcal{L}_{asr}+\lambda_{p}\mathcal{L}_{p}+\lambda_{w}\mathcal{L}_{w}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment setup</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Data sets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">All data sets used aligned with the Privacy Principles and AI Principles in <cite class="ltx_cite ltx_citemacro_cite">Google (<a href="#bib.bib11" title="" class="ltx_ref">2010</a>, <a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite>. The ASR training data contains 520M anonymized English voice search utterances, totaling 490K hours of speech with an average of 3.4 seconds per utterance. A small percentage of the utterances are human-transcribed and the rest are machine-transcribed by a teacher ASR model <cite class="ltx_cite ltx_citemacro_cite">Hwang et al. (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>. We evaluate our system on the same multi-context biasing corpora described in Section 3.2.2 of <cite class="ltx_cite ltx_citemacro_cite">Munkhdalai et al. (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite>. The corpora consist of three sets: <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">WO_PREFIX</span>: 1.3K utterances matching prefix-less patterns from $APPS, $CONTACTS, and $SONGS categories (denoted ACS). <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_bold">W_PREFIX</span>: 2.6K utterances matching prefixed patterns such as “open $APPS”, “call $CONTACTS”, “play $SONGS”. <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_bold">ANTI</span>: 1K utterances simulating general voice assistant queries. Each utterance is assigned up to 3K ACS bias entities. The WO_PREFIX and W_PREFIX sets measure in-context performance, where one of the entities appears in the transcript truth; the ANTI set measures anti-context performance, where the utterances are assigned distractor entities only.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Model architecture</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">Our RNN-T ASR encoder architecture mimics that of Google’s Universal Speech Model (USM) <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite>.
We use the 128-dimensional log Mel-filterbank energies (extracted from 32ms window and 10ms shift) as the frontend features, which are fed to two 2D-convolution layers, each with strides <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="(2,2)" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.3.2" xref="S4.SS2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.2.3.2.1" xref="S4.SS2.p1.1.m1.2.3.1.cmml">(</mo><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">2</mn><mo id="S4.SS2.p1.1.m1.2.3.2.2" xref="S4.SS2.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml">2</mn><mo stretchy="false" id="S4.SS2.p1.1.m1.2.3.2.3" xref="S4.SS2.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><interval closure="open" id="S4.SS2.p1.1.m1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3.2"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">2</cn><cn type="integer" id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2">2</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">(2,2)</annotation></semantics></math>; the resulting feature sequence becomes the input to a stack of 16 Conformer layers <cite class="ltx_cite ltx_citemacro_cite">Gulati et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>.
Each conformer layer has 8 attention heads with a total dimension of 1536, and the intermediate dimension of the FFNs is 4 times the attention dimension, yielding a total of 870M parameters in the encoder. The Conformer blocks use local self-attention with a large attention span, and the encoder output has a large enough receptive field to cover the entire utterance. We apply funnel pooling <cite class="ltx_cite ltx_citemacro_cite">Dai et al. (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> at the 5th to 7th conformer layers, each with a reduction rate of 2. As a result, the encoder output sequence has a low frame rate of 320ms. The model uses a <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="|V|^{2}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msup id="S4.SS2.p1.2.m2.1.2" xref="S4.SS2.p1.2.m2.1.2.cmml"><mrow id="S4.SS2.p1.2.m2.1.2.2.2" xref="S4.SS2.p1.2.m2.1.2.2.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.1.2.2.2.1" xref="S4.SS2.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">V</mi><mo stretchy="false" id="S4.SS2.p1.2.m2.1.2.2.2.2" xref="S4.SS2.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mn id="S4.SS2.p1.2.m2.1.2.3" xref="S4.SS2.p1.2.m2.1.2.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.2.cmml" xref="S4.SS2.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.2">superscript</csymbol><apply id="S4.SS2.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.p1.2.m2.1.2.2.2"><abs id="S4.SS2.p1.2.m2.1.2.2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.2.2.2.1"></abs><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑉</ci></apply><cn type="integer" id="S4.SS2.p1.2.m2.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">|V|^{2}</annotation></semantics></math> embedding decoder <cite class="ltx_cite ltx_citemacro_cite">Botros et al. (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>, i.e., the prediction network computes LM features based on two previous non-blank tokens. The output vocabulary size consists of 4096 lowercase wordpieces.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<p id="S4.F3.1.1" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="S4.F3.1.1.1" class="ltx_text"><img src="/html/2404.10180/assets/x3.png" id="S4.F3.1.1.1.g1" class="ltx_graphics ltx_img_square" width="122" height="122" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Non-streaming RNN-T + NAM module. </figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">Both baseline and experiment NAM modules are placed in between 8th and 9th Conformer layer as shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Model architecture ‣ 4 Experiment setup ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In accordance with <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite>, bias phrases are sampled from reference transcripts during training; the bias strength <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\lambda=0.6" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">λ</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝜆</ci><cn type="float" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\lambda=0.6</annotation></semantics></math> is introduced at inference: <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="x^{biased}=x+\lambda c^{w}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><msup id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">x</mi><mrow id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.3.2" xref="S4.SS2.p2.2.m2.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2.3.1" xref="S4.SS2.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.2.3.3" xref="S4.SS2.p2.2.m2.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2.3.1a" xref="S4.SS2.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.2.3.4" xref="S4.SS2.p2.2.m2.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2.3.1b" xref="S4.SS2.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.2.3.5" xref="S4.SS2.p2.2.m2.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2.3.1c" xref="S4.SS2.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.2.3.6" xref="S4.SS2.p2.2.m2.1.1.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2.3.1d" xref="S4.SS2.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.2.3.7" xref="S4.SS2.p2.2.m2.1.1.2.3.7.cmml">d</mi></mrow></msup><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">x</mi><mo id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">+</mo><mrow id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.3.1" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">​</mo><msup id="S4.SS2.p2.2.m2.1.1.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.3.2.cmml">c</mi><mi id="S4.SS2.p2.2.m2.1.1.3.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.cmml">w</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝑥</ci><apply id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3"><times id="S4.SS2.p2.2.m2.1.1.2.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.2.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.2">𝑏</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.3">𝑖</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.4">𝑎</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.5.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.5">𝑠</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.6.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.6">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.7.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3.7">𝑑</ci></apply></apply><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><plus id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></plus><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑥</ci><apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"><times id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">𝜆</ci><apply id="S4.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.2">𝑐</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">x^{biased}=x+\lambda c^{w}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The models are developed using the open-source Lingvo toolkit <cite class="ltx_cite ltx_citemacro_cite">Shen et al. (<a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite>, trained on 16x16 cloud TPU v3 <cite class="ltx_cite ltx_citemacro_cite">Jouppi et al. (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> with a global batch size of 4096 for 240K steps (3 days). All parameters are randomly initialized and optimized by the Adafactor optimizer <cite class="ltx_cite ltx_citemacro_cite">Shazeer and Stern (<a href="#bib.bib30" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Baseline: Dual-mode NAM</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We configured dual-mode NAM B1, B2 modules to be the WER, latency baseline of Deferred NAM.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.4" class="ltx_p">The B1 module has 100.8M parameters, with <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathit{QueryEncoder}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">𝑄𝑢𝑒𝑟𝑦𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑄𝑢𝑒𝑟𝑦𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mathit{QueryEncoder}</annotation></semantics></math> (89.8M): a 2L Conformer with a model dimension of 1536, hidden dimensions of [6144, 3072] for the internal feed-forward layers; <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathit{ContextEncoder}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mathit{ContextEncoder}</annotation></semantics></math> (4M): 3L Conformer (3M) with a model, hidden dimension of 256, 512 and the WP embedding table (1M) with a vocab size of 4096. <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mathit{PhraseAttention}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\mathit{PhraseAttention}</annotation></semantics></math>/<math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathit{WPAttention}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\mathit{WPAttention}</annotation></semantics></math> (5.5M each): 8 heads with a per-head dimension of 192.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.2" class="ltx_p">The B2 module is similar to B1 except that <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathit{ContextEncoder}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mathit{ContextEncoder}</annotation></semantics></math> contains 1L Conformer (1M) instead of 3L. In Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Baseline: Dual-mode NAM ‣ 4 Experiment setup ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we show that reducing the context encoder from 3L to 1L for a premature latency optimization would negatively impact the in-context WERs by up to 26.8% relative (<math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="3.0\rightarrow 4.1" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mn id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">3.0</mn><mo stretchy="false" id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">→</mo><mn id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">4.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><ci id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1">→</ci><cn type="float" id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">3.0</cn><cn type="float" id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">4.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">3.0\rightarrow 4.1</annotation></semantics></math>).</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Expt</th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.3.1.1.2.1" class="ltx_text ltx_font_bold">B1</span></th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">B2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<th id="S4.T1.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">ANTI</th>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_right ltx_border_t">2.3</td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_right ltx_border_t">1.9</td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr">
<th id="S4.T1.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">WO_PREFIX</th>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_right"><span id="S4.T1.3.3.2.2.1" class="ltx_text ltx_font_bold">3.0</span></td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_right">4.1</td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr">
<th id="S4.T1.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">W_PREFIX</th>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S4.T1.3.4.3.2.1" class="ltx_text ltx_font_bold">2.4</span></td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_right ltx_border_bb">2.9</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dual-mode NAM average WERs at <math id="S4.T1.2.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S4.T1.2.m1.1b"><msup id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml"><mi id="S4.T1.2.m1.1.1.2" xref="S4.T1.2.m1.1.1.2.cmml">k</mi><mi id="S4.T1.2.m1.1.1.3" xref="S4.T1.2.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><apply id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.m1.1.1.1.cmml" xref="S4.T1.2.m1.1.1">superscript</csymbol><ci id="S4.T1.2.m1.1.1.2.cmml" xref="S4.T1.2.m1.1.1.2">𝑘</ci><ci id="S4.T1.2.m1.1.1.3.cmml" xref="S4.T1.2.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">k^{p}</annotation></semantics></math>=32, computed by averaging over scenarios where (150, 300, 600, 1.5K, 3K) bias entities are provided per utterance.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Experiment: Deferred NAM</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.3" class="ltx_p">We explore variants D1–D3 to study the impact of each proposed training loss. When compared to B1, Deferred NAM adds a <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathit{LightPhraseEncoder}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mathit{LightPhraseEncoder}</annotation></semantics></math>: a 4L DAN phrase encoder (788K parameters) with TANH activation, a model, hidden dimension of 256; the <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathit{PhraseAttention}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\mathit{PhraseAttention}</annotation></semantics></math> (2.8M parameters) contains only parameters as described in Algorithm <a href="#algorithm1" title="Algorithm 1 ‣ 3.2 Cross-entropy guided phrase attention ‣ 3 Methods ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>; the <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathit{ContextEncoder}" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\mathit{ContextEncoder}</annotation></semantics></math> consists of only a 1L Conformer (1M) identical to B2, which we found is sufficient to outperform the WERs of B1 (3L).</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I1.ix1.1.1.1" class="ltx_text ltx_font_bold">D1</span></span> 
<div id="S4.I1.ix1.p1" class="ltx_para">
<p id="S4.I1.ix1.p1.2" class="ltx_p">The model learns retrieval capability via equation <a href="#S2.E2" title="In 2.1 Dual-mode NAM ‣ 2 Related Work ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where <math id="S4.I1.ix1.p1.1.m1.1" class="ltx_Math" alttext="p=0.3" display="inline"><semantics id="S4.I1.ix1.p1.1.m1.1a"><mrow id="S4.I1.ix1.p1.1.m1.1.1" xref="S4.I1.ix1.p1.1.m1.1.1.cmml"><mi id="S4.I1.ix1.p1.1.m1.1.1.2" xref="S4.I1.ix1.p1.1.m1.1.1.2.cmml">p</mi><mo id="S4.I1.ix1.p1.1.m1.1.1.1" xref="S4.I1.ix1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.I1.ix1.p1.1.m1.1.1.3" xref="S4.I1.ix1.p1.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.ix1.p1.1.m1.1b"><apply id="S4.I1.ix1.p1.1.m1.1.1.cmml" xref="S4.I1.ix1.p1.1.m1.1.1"><eq id="S4.I1.ix1.p1.1.m1.1.1.1.cmml" xref="S4.I1.ix1.p1.1.m1.1.1.1"></eq><ci id="S4.I1.ix1.p1.1.m1.1.1.2.cmml" xref="S4.I1.ix1.p1.1.m1.1.1.2">𝑝</ci><cn type="float" id="S4.I1.ix1.p1.1.m1.1.1.3.cmml" xref="S4.I1.ix1.p1.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.ix1.p1.1.m1.1c">p=0.3</annotation></semantics></math> and <math id="S4.I1.ix1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{total}=\mathcal{L}_{asr}" display="inline"><semantics id="S4.I1.ix1.p1.2.m2.1a"><mrow id="S4.I1.ix1.p1.2.m2.1.1" xref="S4.I1.ix1.p1.2.m2.1.1.cmml"><msub id="S4.I1.ix1.p1.2.m2.1.1.2" xref="S4.I1.ix1.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix1.p1.2.m2.1.1.2.2" xref="S4.I1.ix1.p1.2.m2.1.1.2.2.cmml">ℒ</mi><mrow id="S4.I1.ix1.p1.2.m2.1.1.2.3" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.cmml"><mi id="S4.I1.ix1.p1.2.m2.1.1.2.3.2" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.2.3.1" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.2.3.3" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.2.3.1a" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.2.3.4" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.2.3.1b" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.2.3.5" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.2.3.1c" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.2.3.6" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S4.I1.ix1.p1.2.m2.1.1.1" xref="S4.I1.ix1.p1.2.m2.1.1.1.cmml">=</mo><msub id="S4.I1.ix1.p1.2.m2.1.1.3" xref="S4.I1.ix1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix1.p1.2.m2.1.1.3.2" xref="S4.I1.ix1.p1.2.m2.1.1.3.2.cmml">ℒ</mi><mrow id="S4.I1.ix1.p1.2.m2.1.1.3.3" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.cmml"><mi id="S4.I1.ix1.p1.2.m2.1.1.3.3.2" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.3.3.1" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.3.3.3" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix1.p1.2.m2.1.1.3.3.1a" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.I1.ix1.p1.2.m2.1.1.3.3.4" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.ix1.p1.2.m2.1b"><apply id="S4.I1.ix1.p1.2.m2.1.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1"><eq id="S4.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.1"></eq><apply id="S4.I1.ix1.p1.2.m2.1.1.2.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.ix1.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.I1.ix1.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.2">ℒ</ci><apply id="S4.I1.ix1.p1.2.m2.1.1.2.3.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3"><times id="S4.I1.ix1.p1.2.m2.1.1.2.3.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.1"></times><ci id="S4.I1.ix1.p1.2.m2.1.1.2.3.2.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.2">𝑡</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.2.3.3.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.3">𝑜</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.2.3.4.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.4">𝑡</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.2.3.5.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.5">𝑎</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.2.3.6.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S4.I1.ix1.p1.2.m2.1.1.3.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.I1.ix1.p1.2.m2.1.1.3.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.I1.ix1.p1.2.m2.1.1.3.2.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.2">ℒ</ci><apply id="S4.I1.ix1.p1.2.m2.1.1.3.3.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.3"><times id="S4.I1.ix1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.1"></times><ci id="S4.I1.ix1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.2">𝑎</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.3.3.3.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.3">𝑠</ci><ci id="S4.I1.ix1.p1.2.m2.1.1.3.3.4.cmml" xref="S4.I1.ix1.p1.2.m2.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.ix1.p1.2.m2.1c">\mathcal{L}_{total}=\mathcal{L}_{asr}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I1.ix2.1.1.1" class="ltx_text ltx_font_bold">D2</span></span> 
<div id="S4.I1.ix2.p1" class="ltx_para">
<p id="S4.I1.ix2.p1.1" class="ltx_p">The model learns retrieval capability through cross-entropy guided phrase attention (CE-PA): <math id="S4.I1.ix2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{total}=\mathcal{L}_{asr}+0.1\mathcal{L}_{p}" display="inline"><semantics id="S4.I1.ix2.p1.1.m1.1a"><mrow id="S4.I1.ix2.p1.1.m1.1.1" xref="S4.I1.ix2.p1.1.m1.1.1.cmml"><msub id="S4.I1.ix2.p1.1.m1.1.1.2" xref="S4.I1.ix2.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix2.p1.1.m1.1.1.2.2" xref="S4.I1.ix2.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.I1.ix2.p1.1.m1.1.1.2.3" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.cmml"><mi id="S4.I1.ix2.p1.1.m1.1.1.2.3.2" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.2.3.1" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.2.3.3" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.2.3.1a" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.2.3.4" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.2.3.1b" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.2.3.5" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.2.3.1c" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.2.3.6" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S4.I1.ix2.p1.1.m1.1.1.1" xref="S4.I1.ix2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.I1.ix2.p1.1.m1.1.1.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.cmml"><msub id="S4.I1.ix2.p1.1.m1.1.1.3.2" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix2.p1.1.m1.1.1.3.2.2" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.I1.ix2.p1.1.m1.1.1.3.2.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.cmml"><mi id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.2" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1a" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.4" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.4.cmml">r</mi></mrow></msub><mo id="S4.I1.ix2.p1.1.m1.1.1.3.1" xref="S4.I1.ix2.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.I1.ix2.p1.1.m1.1.1.3.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.cmml"><mn id="S4.I1.ix2.p1.1.m1.1.1.3.3.2" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.2.cmml">0.1</mn><mo lspace="0em" rspace="0em" id="S4.I1.ix2.p1.1.m1.1.1.3.3.1" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.1.cmml">​</mo><msub id="S4.I1.ix2.p1.1.m1.1.1.3.3.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.2" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.3" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.ix2.p1.1.m1.1b"><apply id="S4.I1.ix2.p1.1.m1.1.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1"><eq id="S4.I1.ix2.p1.1.m1.1.1.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.1"></eq><apply id="S4.I1.ix2.p1.1.m1.1.1.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.ix2.p1.1.m1.1.1.2.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.I1.ix2.p1.1.m1.1.1.2.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.2">ℒ</ci><apply id="S4.I1.ix2.p1.1.m1.1.1.2.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3"><times id="S4.I1.ix2.p1.1.m1.1.1.2.3.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.1"></times><ci id="S4.I1.ix2.p1.1.m1.1.1.2.3.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.2.3.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.2.3.4.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.4">𝑡</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.2.3.5.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.5">𝑎</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.2.3.6.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S4.I1.ix2.p1.1.m1.1.1.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3"><plus id="S4.I1.ix2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.1"></plus><apply id="S4.I1.ix2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.ix2.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.I1.ix2.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.2">ℒ</ci><apply id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3"><times id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.1"></times><ci id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.2">𝑎</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.3">𝑠</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.3.2.3.4.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.2.3.4">𝑟</ci></apply></apply><apply id="S4.I1.ix2.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3"><times id="S4.I1.ix2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.1"></times><cn type="float" id="S4.I1.ix2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.2">0.1</cn><apply id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3.2">ℒ</ci><ci id="S4.I1.ix2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S4.I1.ix2.p1.1.m1.1.1.3.3.3.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.ix2.p1.1.m1.1c">\mathcal{L}_{total}=\mathcal{L}_{asr}+0.1\mathcal{L}_{p}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I1.ix3.1.1.1" class="ltx_text ltx_font_bold">D3</span></span> 
<div id="S4.I1.ix3.p1" class="ltx_para">
<p id="S4.I1.ix3.p1.1" class="ltx_p">D2 with cross-entropy guided WP attention (CE-WA): <math id="S4.I1.ix3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{total}=\mathcal{L}_{asr}+0.1\mathcal{L}_{p}+0.1\mathcal{L}_{w}" display="inline"><semantics id="S4.I1.ix3.p1.1.m1.1a"><mrow id="S4.I1.ix3.p1.1.m1.1.1" xref="S4.I1.ix3.p1.1.m1.1.1.cmml"><msub id="S4.I1.ix3.p1.1.m1.1.1.2" xref="S4.I1.ix3.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix3.p1.1.m1.1.1.2.2" xref="S4.I1.ix3.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.I1.ix3.p1.1.m1.1.1.2.3" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.cmml"><mi id="S4.I1.ix3.p1.1.m1.1.1.2.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.2.3.1" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.2.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.2.3.1a" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.2.3.4" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.2.3.1b" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.2.3.5" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.2.3.1c" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.2.3.6" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S4.I1.ix3.p1.1.m1.1.1.1" xref="S4.I1.ix3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.I1.ix3.p1.1.m1.1.1.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.cmml"><msub id="S4.I1.ix3.p1.1.m1.1.1.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix3.p1.1.m1.1.1.3.2.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.I1.ix3.p1.1.m1.1.1.3.2.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.cmml"><mi id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1a" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.4" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.4.cmml">r</mi></mrow></msub><mo id="S4.I1.ix3.p1.1.m1.1.1.3.1" xref="S4.I1.ix3.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.I1.ix3.p1.1.m1.1.1.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.cmml"><mn id="S4.I1.ix3.p1.1.m1.1.1.3.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.2.cmml">0.1</mn><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.3.3.1" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.1.cmml">​</mo><msub id="S4.I1.ix3.p1.1.m1.1.1.3.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3.3.cmml">p</mi></msub></mrow><mo id="S4.I1.ix3.p1.1.m1.1.1.3.1a" xref="S4.I1.ix3.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.I1.ix3.p1.1.m1.1.1.3.4" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.cmml"><mn id="S4.I1.ix3.p1.1.m1.1.1.3.4.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.2.cmml">0.1</mn><mo lspace="0em" rspace="0em" id="S4.I1.ix3.p1.1.m1.1.1.3.4.1" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.1.cmml">​</mo><msub id="S4.I1.ix3.p1.1.m1.1.1.3.4.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.2" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.3" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3.3.cmml">w</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.ix3.p1.1.m1.1b"><apply id="S4.I1.ix3.p1.1.m1.1.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1"><eq id="S4.I1.ix3.p1.1.m1.1.1.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.1"></eq><apply id="S4.I1.ix3.p1.1.m1.1.1.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.ix3.p1.1.m1.1.1.2.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.I1.ix3.p1.1.m1.1.1.2.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.2">ℒ</ci><apply id="S4.I1.ix3.p1.1.m1.1.1.2.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3"><times id="S4.I1.ix3.p1.1.m1.1.1.2.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.1"></times><ci id="S4.I1.ix3.p1.1.m1.1.1.2.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.2.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.2.3.4.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.4">𝑡</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.2.3.5.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.5">𝑎</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.2.3.6.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S4.I1.ix3.p1.1.m1.1.1.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3"><plus id="S4.I1.ix3.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.1"></plus><apply id="S4.I1.ix3.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.ix3.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.I1.ix3.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.2">ℒ</ci><apply id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3"><times id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.1"></times><ci id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.2">𝑎</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.3">𝑠</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.3.2.3.4.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.2.3.4">𝑟</ci></apply></apply><apply id="S4.I1.ix3.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3"><times id="S4.I1.ix3.p1.1.m1.1.1.3.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.1"></times><cn type="float" id="S4.I1.ix3.p1.1.m1.1.1.3.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.2">0.1</cn><apply id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3.2">ℒ</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.3.3.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.3.3.3">𝑝</ci></apply></apply><apply id="S4.I1.ix3.p1.1.m1.1.1.3.4.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4"><times id="S4.I1.ix3.p1.1.m1.1.1.3.4.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.1"></times><cn type="float" id="S4.I1.ix3.p1.1.m1.1.1.3.4.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.2">0.1</cn><apply id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.1.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3">subscript</csymbol><ci id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.2.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3.2">ℒ</ci><ci id="S4.I1.ix3.p1.1.m1.1.1.3.4.3.3.cmml" xref="S4.I1.ix3.p1.1.m1.1.1.3.4.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.ix3.p1.1.m1.1c">\mathcal{L}_{total}=\mathcal{L}_{asr}+0.1\mathcal{L}_{p}+0.1\mathcal{L}_{w}</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Quality</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.5" class="ltx_p">As shown in Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Quality ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the base Deferred NAM (D1) already outperforms the best Dual-mode NAM (B1)’s average WERs by up to 20.8% relative (<math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="2.4\rightarrow 1.9" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">2.4</mn><mo stretchy="false" id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">→</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">1.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><ci id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">→</ci><cn type="float" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">2.4</cn><cn type="float" id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">1.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">2.4\rightarrow 1.9</annotation></semantics></math>), while using fewer parameters in total. By augmenting the model with the CE-PA loss, D2 improves over D1 by up to 11.5% relative (<math id="S5.SS1.p1.2.m2.1" class="ltx_math_unparsed" alttext="2.6\rightarrow 2.3)" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1b"><mn id="S5.SS1.p1.2.m2.1.1">2.6</mn><mo stretchy="false" id="S5.SS1.p1.2.m2.1.2">→</mo><mn id="S5.SS1.p1.2.m2.1.3">2.3</mn><mo stretchy="false" id="S5.SS1.p1.2.m2.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">2.6\rightarrow 2.3)</annotation></semantics></math>. With addition of CE-WA loss, D3 improves over D2 by 16.7% relative (<math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="1.8\rightarrow 1.5" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">1.8</mn><mo stretchy="false" id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">→</mo><mn id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><ci id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1">→</ci><cn type="float" id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">1.8</cn><cn type="float" id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">1.8\rightarrow 1.5</annotation></semantics></math>). As a result, the best Deferred NAM (D3) improves over the best Dual-mode NAM (B1) by up to 37.5% relative (<math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="2.4\rightarrow 1.5" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mn id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">2.4</mn><mo stretchy="false" id="S5.SS1.p1.4.m4.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.cmml">→</mo><mn id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><ci id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1">→</ci><cn type="float" id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">2.4</cn><cn type="float" id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">2.4\rightarrow 1.5</annotation></semantics></math>) on in-context recognition, and 21.7% on anti-context recognition (<math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="2.3\rightarrow 1.8" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mrow id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mn id="S5.SS1.p1.5.m5.1.1.2" xref="S5.SS1.p1.5.m5.1.1.2.cmml">2.3</mn><mo stretchy="false" id="S5.SS1.p1.5.m5.1.1.1" xref="S5.SS1.p1.5.m5.1.1.1.cmml">→</mo><mn id="S5.SS1.p1.5.m5.1.1.3" xref="S5.SS1.p1.5.m5.1.1.3.cmml">1.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><ci id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1.1">→</ci><cn type="float" id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2">2.3</cn><cn type="float" id="S5.SS1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3">1.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">2.3\rightarrow 1.8</annotation></semantics></math>).</p>
</div>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.3.1.1" class="ltx_tr">
<th id="S5.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Expt</th>
<th id="S5.T2.3.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">B1</th>
<th id="S5.T2.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D1</th>
<th id="S5.T2.3.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D2</th>
<th id="S5.T2.3.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.2.1" class="ltx_tr">
<th id="S5.T2.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">ANTI</th>
<td id="S5.T2.3.2.1.2" class="ltx_td ltx_align_right ltx_border_t">2.3</td>
<td id="S5.T2.3.2.1.3" class="ltx_td ltx_align_right ltx_border_t">1.9</td>
<td id="S5.T2.3.2.1.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T2.3.2.1.4.1" class="ltx_text ltx_font_bold">1.8</span></td>
<td id="S5.T2.3.2.1.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T2.3.2.1.5.1" class="ltx_text ltx_font_bold">1.8</span></td>
</tr>
<tr id="S5.T2.3.3.2" class="ltx_tr">
<th id="S5.T2.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">WO_PREFIX</th>
<td id="S5.T2.3.3.2.2" class="ltx_td ltx_align_right">3.0</td>
<td id="S5.T2.3.3.2.3" class="ltx_td ltx_align_right">2.6</td>
<td id="S5.T2.3.3.2.4" class="ltx_td ltx_align_right">2.3</td>
<td id="S5.T2.3.3.2.5" class="ltx_td ltx_align_right"><span id="S5.T2.3.3.2.5.1" class="ltx_text ltx_font_bold">2.0</span></td>
</tr>
<tr id="S5.T2.3.4.3" class="ltx_tr">
<th id="S5.T2.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">W_PREFIX</th>
<td id="S5.T2.3.4.3.2" class="ltx_td ltx_align_right ltx_border_bb">2.4</td>
<td id="S5.T2.3.4.3.3" class="ltx_td ltx_align_right ltx_border_bb">1.9</td>
<td id="S5.T2.3.4.3.4" class="ltx_td ltx_align_right ltx_border_bb">1.8</td>
<td id="S5.T2.3.4.3.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T2.3.4.3.5.1" class="ltx_text ltx_font_bold">1.5</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Average WERs (# entities = 0 excluded) at <math id="S5.T2.2.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S5.T2.2.m1.1b"><msup id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml"><mi id="S5.T2.2.m1.1.1.2" xref="S5.T2.2.m1.1.1.2.cmml">k</mi><mi id="S5.T2.2.m1.1.1.3" xref="S5.T2.2.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c"><apply id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.2.m1.1.1.1.cmml" xref="S5.T2.2.m1.1.1">superscript</csymbol><ci id="S5.T2.2.m1.1.1.2.cmml" xref="S5.T2.2.m1.1.1.2">𝑘</ci><ci id="S5.T2.2.m1.1.1.3.cmml" xref="S5.T2.2.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">k^{p}</annotation></semantics></math>=32 comparing Dual-mode (B1) and Deferred NAM (D1–D3). WER breakdown is shown in Table <a href="#S5.T3" title="Table 3 ‣ 5.1 Quality ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.3.1.1" class="ltx_tr">
<th id="S5.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Expt</th>
<th id="S5.T3.3.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">#</th>
<th id="S5.T3.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">B1</th>
<th id="S5.T3.3.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D1</th>
<th id="S5.T3.3.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D2</th>
<th id="S5.T3.3.1.1.6" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.3.2.1" class="ltx_tr">
<th id="S5.T3.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="6"><span id="S5.T3.3.2.1.1.1" class="ltx_text">ANTI</span></th>
<th id="S5.T3.3.2.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">0</th>
<th id="S5.T3.3.2.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.2.1.3.1" class="ltx_text ltx_font_bold">1.4</span></th>
<td id="S5.T3.3.2.1.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.3.2.1.4.1" class="ltx_text ltx_font_bold">1.4</span></td>
<td id="S5.T3.3.2.1.5" class="ltx_td ltx_align_right ltx_border_t">1.5</td>
<td id="S5.T3.3.2.1.6" class="ltx_td ltx_align_right ltx_border_t">1.6</td>
</tr>
<tr id="S5.T3.3.3.2" class="ltx_tr">
<th id="S5.T3.3.3.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">150</th>
<th id="S5.T3.3.3.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.7</th>
<td id="S5.T3.3.3.2.3" class="ltx_td ltx_align_right">1.6</td>
<td id="S5.T3.3.3.2.4" class="ltx_td ltx_align_right"><span id="S5.T3.3.3.2.4.1" class="ltx_text ltx_font_bold">1.5</span></td>
<td id="S5.T3.3.3.2.5" class="ltx_td ltx_align_right">1.7</td>
</tr>
<tr id="S5.T3.3.4.3" class="ltx_tr">
<th id="S5.T3.3.4.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">300</th>
<th id="S5.T3.3.4.3.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.0</th>
<td id="S5.T3.3.4.3.3" class="ltx_td ltx_align_right"><span id="S5.T3.3.4.3.3.1" class="ltx_text ltx_font_bold">1.6</span></td>
<td id="S5.T3.3.4.3.4" class="ltx_td ltx_align_right"><span id="S5.T3.3.4.3.4.1" class="ltx_text ltx_font_bold">1.6</span></td>
<td id="S5.T3.3.4.3.5" class="ltx_td ltx_align_right">1.8</td>
</tr>
<tr id="S5.T3.3.5.4" class="ltx_tr">
<th id="S5.T3.3.5.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">600</th>
<th id="S5.T3.3.5.4.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.4</th>
<td id="S5.T3.3.5.4.3" class="ltx_td ltx_align_right">2.0</td>
<td id="S5.T3.3.5.4.4" class="ltx_td ltx_align_right"><span id="S5.T3.3.5.4.4.1" class="ltx_text ltx_font_bold">1.7</span></td>
<td id="S5.T3.3.5.4.5" class="ltx_td ltx_align_right">1.9</td>
</tr>
<tr id="S5.T3.3.6.5" class="ltx_tr">
<th id="S5.T3.3.6.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.5K</th>
<th id="S5.T3.3.6.5.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.6</th>
<td id="S5.T3.3.6.5.3" class="ltx_td ltx_align_right"><span id="S5.T3.3.6.5.3.1" class="ltx_text ltx_font_bold">1.9</span></td>
<td id="S5.T3.3.6.5.4" class="ltx_td ltx_align_right"><span id="S5.T3.3.6.5.4.1" class="ltx_text ltx_font_bold">1.9</span></td>
<td id="S5.T3.3.6.5.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.6.5.5.1" class="ltx_text ltx_font_bold">1.9</span></td>
</tr>
<tr id="S5.T3.3.7.6" class="ltx_tr">
<th id="S5.T3.3.7.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">3K</th>
<th id="S5.T3.3.7.6.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.9</th>
<td id="S5.T3.3.7.6.3" class="ltx_td ltx_align_right">2.2</td>
<td id="S5.T3.3.7.6.4" class="ltx_td ltx_align_right">2.3</td>
<td id="S5.T3.3.7.6.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.7.6.5.1" class="ltx_text ltx_font_bold">1.9</span></td>
</tr>
<tr id="S5.T3.3.8.7" class="ltx_tr">
<th id="S5.T3.3.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T3.3.8.7.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">0</th>
<th id="S5.T3.3.8.7.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.8.7.3.1" class="ltx_text ltx_font_bold">21.1</span></th>
<td id="S5.T3.3.8.7.4" class="ltx_td ltx_align_right ltx_border_t">21.6</td>
<td id="S5.T3.3.8.7.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.3.8.7.5.1" class="ltx_text ltx_font_bold">21.1</span></td>
<td id="S5.T3.3.8.7.6" class="ltx_td ltx_align_right ltx_border_t">21.3</td>
</tr>
<tr id="S5.T3.3.9.8" class="ltx_tr">
<th id="S5.T3.3.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.3.9.8.1.1" class="ltx_text">WO_</span></th>
<th id="S5.T3.3.9.8.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">150</th>
<th id="S5.T3.3.9.8.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.8</th>
<td id="S5.T3.3.9.8.4" class="ltx_td ltx_align_right">2.0</td>
<td id="S5.T3.3.9.8.5" class="ltx_td ltx_align_right">1.8</td>
<td id="S5.T3.3.9.8.6" class="ltx_td ltx_align_right"><span id="S5.T3.3.9.8.6.1" class="ltx_text ltx_font_bold">1.6</span></td>
</tr>
<tr id="S5.T3.3.10.9" class="ltx_tr">
<th id="S5.T3.3.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="3"><span id="S5.T3.3.10.9.1.1" class="ltx_text">PREFIX</span></th>
<th id="S5.T3.3.10.9.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">300</th>
<th id="S5.T3.3.10.9.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.0</th>
<td id="S5.T3.3.10.9.4" class="ltx_td ltx_align_right">2.0</td>
<td id="S5.T3.3.10.9.5" class="ltx_td ltx_align_right">2.0</td>
<td id="S5.T3.3.10.9.6" class="ltx_td ltx_align_right"><span id="S5.T3.3.10.9.6.1" class="ltx_text ltx_font_bold">1.7</span></td>
</tr>
<tr id="S5.T3.3.11.10" class="ltx_tr">
<th id="S5.T3.3.11.10.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">600</th>
<th id="S5.T3.3.11.10.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.7</th>
<td id="S5.T3.3.11.10.3" class="ltx_td ltx_align_right">2.3</td>
<td id="S5.T3.3.11.10.4" class="ltx_td ltx_align_right">2.3</td>
<td id="S5.T3.3.11.10.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.11.10.5.1" class="ltx_text ltx_font_bold">1.8</span></td>
</tr>
<tr id="S5.T3.3.12.11" class="ltx_tr">
<th id="S5.T3.3.12.11.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.5K</th>
<th id="S5.T3.3.12.11.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">3.4</th>
<td id="S5.T3.3.12.11.3" class="ltx_td ltx_align_right">3.1</td>
<td id="S5.T3.3.12.11.4" class="ltx_td ltx_align_right">2.4</td>
<td id="S5.T3.3.12.11.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.12.11.5.1" class="ltx_text ltx_font_bold">2.3</span></td>
</tr>
<tr id="S5.T3.3.13.12" class="ltx_tr">
<th id="S5.T3.3.13.12.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T3.3.13.12.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">3K</th>
<th id="S5.T3.3.13.12.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">4.9</th>
<td id="S5.T3.3.13.12.4" class="ltx_td ltx_align_right">3.5</td>
<td id="S5.T3.3.13.12.5" class="ltx_td ltx_align_right">3.1</td>
<td id="S5.T3.3.13.12.6" class="ltx_td ltx_align_right"><span id="S5.T3.3.13.12.6.1" class="ltx_text ltx_font_bold">2.7</span></td>
</tr>
<tr id="S5.T3.3.14.13" class="ltx_tr">
<th id="S5.T3.3.14.13.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T3.3.14.13.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">0</th>
<th id="S5.T3.3.14.13.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">9.8</th>
<td id="S5.T3.3.14.13.4" class="ltx_td ltx_align_right ltx_border_t">9.9</td>
<td id="S5.T3.3.14.13.5" class="ltx_td ltx_align_right ltx_border_t">10.0</td>
<td id="S5.T3.3.14.13.6" class="ltx_td ltx_align_right ltx_border_t">9.9</td>
</tr>
<tr id="S5.T3.3.15.14" class="ltx_tr">
<th id="S5.T3.3.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.3.15.14.1.1" class="ltx_text">W_</span></th>
<th id="S5.T3.3.15.14.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">150</th>
<th id="S5.T3.3.15.14.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.5</th>
<td id="S5.T3.3.15.14.4" class="ltx_td ltx_align_right">1.6</td>
<td id="S5.T3.3.15.14.5" class="ltx_td ltx_align_right">1.5</td>
<td id="S5.T3.3.15.14.6" class="ltx_td ltx_align_right"><span id="S5.T3.3.15.14.6.1" class="ltx_text ltx_font_bold">1.3</span></td>
</tr>
<tr id="S5.T3.3.16.15" class="ltx_tr">
<th id="S5.T3.3.16.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="3"><span id="S5.T3.3.16.15.1.1" class="ltx_text">PREFIX</span></th>
<th id="S5.T3.3.16.15.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">300</th>
<th id="S5.T3.3.16.15.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.8</th>
<td id="S5.T3.3.16.15.4" class="ltx_td ltx_align_right">1.6</td>
<td id="S5.T3.3.16.15.5" class="ltx_td ltx_align_right">1.6</td>
<td id="S5.T3.3.16.15.6" class="ltx_td ltx_align_right"><span id="S5.T3.3.16.15.6.1" class="ltx_text ltx_font_bold">1.4</span></td>
</tr>
<tr id="S5.T3.3.17.16" class="ltx_tr">
<th id="S5.T3.3.17.16.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">600</th>
<th id="S5.T3.3.17.16.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.1</th>
<td id="S5.T3.3.17.16.3" class="ltx_td ltx_align_right">1.8</td>
<td id="S5.T3.3.17.16.4" class="ltx_td ltx_align_right">1.7</td>
<td id="S5.T3.3.17.16.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.17.16.5.1" class="ltx_text ltx_font_bold">1.5</span></td>
</tr>
<tr id="S5.T3.3.18.17" class="ltx_tr">
<th id="S5.T3.3.18.17.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">1.5K</th>
<th id="S5.T3.3.18.17.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">2.8</th>
<td id="S5.T3.3.18.17.3" class="ltx_td ltx_align_right">2.1</td>
<td id="S5.T3.3.18.17.4" class="ltx_td ltx_align_right">1.8</td>
<td id="S5.T3.3.18.17.5" class="ltx_td ltx_align_right"><span id="S5.T3.3.18.17.5.1" class="ltx_text ltx_font_bold">1.6</span></td>
</tr>
<tr id="S5.T3.3.19.18" class="ltx_tr">
<th id="S5.T3.3.19.18.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb"></th>
<th id="S5.T3.3.19.18.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r">3K</th>
<th id="S5.T3.3.19.18.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r">3.6</th>
<td id="S5.T3.3.19.18.4" class="ltx_td ltx_align_right ltx_border_bb">2.3</td>
<td id="S5.T3.3.19.18.5" class="ltx_td ltx_align_right ltx_border_bb">2.2</td>
<td id="S5.T3.3.19.18.6" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T3.3.19.18.6.1" class="ltx_text ltx_font_bold">1.9</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Detailed WER breakdown at <math id="S5.T3.2.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S5.T3.2.m1.1b"><msup id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml"><mi id="S5.T3.2.m1.1.1.2" xref="S5.T3.2.m1.1.1.2.cmml">k</mi><mi id="S5.T3.2.m1.1.1.3" xref="S5.T3.2.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><apply id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.m1.1.1.1.cmml" xref="S5.T3.2.m1.1.1">superscript</csymbol><ci id="S5.T3.2.m1.1.1.2.cmml" xref="S5.T3.2.m1.1.1.2">𝑘</ci><ci id="S5.T3.2.m1.1.1.3.cmml" xref="S5.T3.2.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">k^{p}</annotation></semantics></math>=32 on the best Dual-mode (B1) and Deferred NAM (D1–D3), where each utterance is assigned up to 3K bias entities.</figcaption>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.4" class="ltx_p">We also show Deferred NAM’s 1st pass retrieval recall performance in Table <a href="#S5.T4" title="Table 4 ‣ 5.1 Quality ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Interestingly, although there are sizable retrieval performance increases at smaller <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="k^{p}\leq 5" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><msup id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml"><mi id="S5.SS1.p2.1.m1.1.1.2.2" xref="S5.SS1.p2.1.m1.1.1.2.2.cmml">k</mi><mi id="S5.SS1.p2.1.m1.1.1.2.3" xref="S5.SS1.p2.1.m1.1.1.2.3.cmml">p</mi></msup><mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">≤</mo><mn id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><leq id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></leq><apply id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.2.1.cmml" xref="S5.SS1.p2.1.m1.1.1.2">superscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.2.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2.2">𝑘</ci><ci id="S5.SS1.p2.1.m1.1.1.2.3.cmml" xref="S5.SS1.p2.1.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">k^{p}\leq 5</annotation></semantics></math> from D1 to D2 (up to 25.6% relative, e.g., <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="69.2\rightarrow 86.9" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mn id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">69.2</mn><mo stretchy="false" id="S5.SS1.p2.2.m2.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.cmml">→</mo><mn id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml">86.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><ci id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1">→</ci><cn type="float" id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2">69.2</cn><cn type="float" id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3">86.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">69.2\rightarrow 86.9</annotation></semantics></math>), D1’s recall performance at <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="k^{p}=32" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mrow id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><msup id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2.2" xref="S5.SS1.p2.3.m3.1.1.2.2.cmml">k</mi><mi id="S5.SS1.p2.3.m3.1.1.2.3" xref="S5.SS1.p2.3.m3.1.1.2.3.cmml">p</mi></msup><mo id="S5.SS1.p2.3.m3.1.1.1" xref="S5.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><eq id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1.1"></eq><apply id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.2.1.cmml" xref="S5.SS1.p2.3.m3.1.1.2">superscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2.2">𝑘</ci><ci id="S5.SS1.p2.3.m3.1.1.2.3.cmml" xref="S5.SS1.p2.3.m3.1.1.2.3">𝑝</ci></apply><cn type="integer" id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">k^{p}=32</annotation></semantics></math> (where the WERs are evaluated at) is already quite high and left little room for further improvement (up to 2.3% relative, e.g., <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="97.4\rightarrow 99.6" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mn id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">97.4</mn><mo stretchy="false" id="S5.SS1.p2.4.m4.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.cmml">→</mo><mn id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">99.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><ci id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1">→</ci><cn type="float" id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2">97.4</cn><cn type="float" id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">99.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">97.4\rightarrow 99.6</annotation></semantics></math>). On the other hand, D3’s retrieval performance is more in line with D2, as expected.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">Given the slightly-improved or similar recall performance at <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="k^{p}=32" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><msup id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2.2" xref="S5.SS1.p3.1.m1.1.1.2.2.cmml">k</mi><mi id="S5.SS1.p3.1.m1.1.1.2.3" xref="S5.SS1.p3.1.m1.1.1.2.3.cmml">p</mi></msup><mo id="S5.SS1.p3.1.m1.1.1.1" xref="S5.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><eq id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1"></eq><apply id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.2.1.cmml" xref="S5.SS1.p3.1.m1.1.1.2">superscript</csymbol><ci id="S5.SS1.p3.1.m1.1.1.2.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2.2">𝑘</ci><ci id="S5.SS1.p3.1.m1.1.1.2.3.cmml" xref="S5.SS1.p3.1.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">k^{p}=32</annotation></semantics></math>, we attribute D2’s WER improvement over D1 to better-regulated audio/text embeddings (due to CE-PA) and increased data exposure of the 2nd-pass contextualization, i.e., D2 has full training data exposure while D1’s phrase and WP attentions are only trained 30% and 70% of the time, respectively, due to sampling. D3’s WER improvement over D2 is more obvious as the CE-WA loss is directly applied to the WP attention.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.1.1" class="ltx_tr">
<th id="S5.T4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Expt</th>
<th id="S5.T4.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><math id="S5.T4.1.1.1.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S5.T4.1.1.1.m1.1a"><msup id="S5.T4.1.1.1.m1.1.1" xref="S5.T4.1.1.1.m1.1.1.cmml"><mi id="S5.T4.1.1.1.m1.1.1.2" xref="S5.T4.1.1.1.m1.1.1.2.cmml">k</mi><mi id="S5.T4.1.1.1.m1.1.1.3" xref="S5.T4.1.1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><apply id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.1.1.1.m1.1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">superscript</csymbol><ci id="S5.T4.1.1.1.m1.1.1.2.cmml" xref="S5.T4.1.1.1.m1.1.1.2">𝑘</ci><ci id="S5.T4.1.1.1.m1.1.1.3.cmml" xref="S5.T4.1.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">k^{p}</annotation></semantics></math></th>
<th id="S5.T4.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D1</th>
<th id="S5.T4.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D2</th>
<th id="S5.T4.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">D3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.1.2.1" class="ltx_tr">
<th id="S5.T4.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T4.1.2.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">1</th>
<td id="S5.T4.1.2.1.3" class="ltx_td ltx_align_right ltx_border_t">73.0</td>
<td id="S5.T4.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">91.5</td>
<td id="S5.T4.1.2.1.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T4.1.2.1.5.1" class="ltx_text ltx_font_bold">93.4</span></td>
</tr>
<tr id="S5.T4.1.3.2" class="ltx_tr">
<th id="S5.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">WO_PREFIX</th>
<th id="S5.T4.1.3.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">5</th>
<td id="S5.T4.1.3.2.3" class="ltx_td ltx_align_right">92.8</td>
<td id="S5.T4.1.3.2.4" class="ltx_td ltx_align_right">98.7</td>
<td id="S5.T4.1.3.2.5" class="ltx_td ltx_align_right"><span id="S5.T4.1.3.2.5.1" class="ltx_text ltx_font_bold">98.9</span></td>
</tr>
<tr id="S5.T4.1.4.3" class="ltx_tr">
<th id="S5.T4.1.4.3.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T4.1.4.3.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">32</th>
<td id="S5.T4.1.4.3.3" class="ltx_td ltx_align_right">98.9</td>
<td id="S5.T4.1.4.3.4" class="ltx_td ltx_align_right"><span id="S5.T4.1.4.3.4.1" class="ltx_text ltx_font_bold">99.7</span></td>
<td id="S5.T4.1.4.3.5" class="ltx_td ltx_align_right"><span id="S5.T4.1.4.3.5.1" class="ltx_text ltx_font_bold">99.7</span></td>
</tr>
<tr id="S5.T4.1.5.4" class="ltx_tr">
<th id="S5.T4.1.5.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T4.1.5.4.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t">1</th>
<td id="S5.T4.1.5.4.3" class="ltx_td ltx_align_right ltx_border_t">69.2</td>
<td id="S5.T4.1.5.4.4" class="ltx_td ltx_align_right ltx_border_t">86.9</td>
<td id="S5.T4.1.5.4.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T4.1.5.4.5.1" class="ltx_text ltx_font_bold">87.9</span></td>
</tr>
<tr id="S5.T4.1.6.5" class="ltx_tr">
<th id="S5.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">W_PREFIX</th>
<th id="S5.T4.1.6.5.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r">5</th>
<td id="S5.T4.1.6.5.3" class="ltx_td ltx_align_right">89.8</td>
<td id="S5.T4.1.6.5.4" class="ltx_td ltx_align_right"><span id="S5.T4.1.6.5.4.1" class="ltx_text ltx_font_bold">98.0</span></td>
<td id="S5.T4.1.6.5.5" class="ltx_td ltx_align_right">97.7</td>
</tr>
<tr id="S5.T4.1.7.6" class="ltx_tr">
<th id="S5.T4.1.7.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb"></th>
<th id="S5.T4.1.7.6.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r">32</th>
<td id="S5.T4.1.7.6.3" class="ltx_td ltx_align_right ltx_border_bb">97.4</td>
<td id="S5.T4.1.7.6.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T4.1.7.6.4.1" class="ltx_text ltx_font_bold">99.6</span></td>
<td id="S5.T4.1.7.6.5" class="ltx_td ltx_align_right ltx_border_bb">99.5</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Retrieval recall performance of D1–D3 by <math id="S5.T4.3.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S5.T4.3.m1.1b"><msup id="S5.T4.3.m1.1.1" xref="S5.T4.3.m1.1.1.cmml"><mi id="S5.T4.3.m1.1.1.2" xref="S5.T4.3.m1.1.1.2.cmml">k</mi><mi id="S5.T4.3.m1.1.1.3" xref="S5.T4.3.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T4.3.m1.1c"><apply id="S5.T4.3.m1.1.1.cmml" xref="S5.T4.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.3.m1.1.1.1.cmml" xref="S5.T4.3.m1.1.1">superscript</csymbol><ci id="S5.T4.3.m1.1.1.2.cmml" xref="S5.T4.3.m1.1.1.2">𝑘</ci><ci id="S5.T4.3.m1.1.1.3.cmml" xref="S5.T4.3.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.m1.1d">k^{p}</annotation></semantics></math> for in-context test-sets at 3K bias entities per utterance.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Inference latency</h3>

<figure id="S5.T5" class="ltx_table">
<table id="S5.T5.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.5.6.1" class="ltx_tr">
<th id="S5.T5.5.6.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<td id="S5.T5.5.6.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"># phrases</td>
</tr>
<tr id="S5.T5.5.7.2" class="ltx_tr">
<th id="S5.T5.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Deferred NAM latency (ms)</th>
<td id="S5.T5.5.7.2.2" class="ltx_td ltx_align_right">3K</td>
<td id="S5.T5.5.7.2.3" class="ltx_td ltx_align_right">20K</td>
</tr>
<tr id="S5.T5.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S5.T5.1.1.1.m1.1" class="ltx_Math" alttext="\mathit{QueryEncoder}" display="inline"><semantics id="S5.T5.1.1.1.m1.1a"><mi id="S5.T5.1.1.1.m1.1.1" xref="S5.T5.1.1.1.m1.1.1.cmml">𝑄𝑢𝑒𝑟𝑦𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.m1.1b"><ci id="S5.T5.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.m1.1.1">𝑄𝑢𝑒𝑟𝑦𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.m1.1c">\mathit{QueryEncoder}</annotation></semantics></math></th>
<td id="S5.T5.1.1.2" class="ltx_td ltx_align_right ltx_border_t">2.3</td>
<td id="S5.T5.1.1.3" class="ltx_td ltx_align_right ltx_border_t">2.3</td>
</tr>
<tr id="S5.T5.2.2" class="ltx_tr">
<th id="S5.T5.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="S5.T5.2.2.1.m1.1" class="ltx_Math" alttext="\mathit{LightPhraseEncoder}" display="inline"><semantics id="S5.T5.2.2.1.m1.1a"><mi id="S5.T5.2.2.1.m1.1.1" xref="S5.T5.2.2.1.m1.1.1.cmml">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.1.m1.1b"><ci id="S5.T5.2.2.1.m1.1.1.cmml" xref="S5.T5.2.2.1.m1.1.1">𝐿𝑖𝑔ℎ𝑡𝑃ℎ𝑟𝑎𝑠𝑒𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.1.m1.1c">\mathit{LightPhraseEncoder}</annotation></semantics></math></th>
<td id="S5.T5.2.2.2" class="ltx_td ltx_align_right">3.5</td>
<td id="S5.T5.2.2.3" class="ltx_td ltx_align_right">22.8</td>
</tr>
<tr id="S5.T5.3.3" class="ltx_tr">
<th id="S5.T5.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="S5.T5.3.3.1.m1.1" class="ltx_Math" alttext="\mathit{PhraseAttention}" display="inline"><semantics id="S5.T5.3.3.1.m1.1a"><mi id="S5.T5.3.3.1.m1.1.1" xref="S5.T5.3.3.1.m1.1.1.cmml">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.1.m1.1b"><ci id="S5.T5.3.3.1.m1.1.1.cmml" xref="S5.T5.3.3.1.m1.1.1">𝑃ℎ𝑟𝑎𝑠𝑒𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.1.m1.1c">\mathit{PhraseAttention}</annotation></semantics></math></th>
<td id="S5.T5.3.3.2" class="ltx_td ltx_align_right">0.9</td>
<td id="S5.T5.3.3.3" class="ltx_td ltx_align_right">5.2</td>
</tr>
<tr id="S5.T5.4.4" class="ltx_tr">
<th id="S5.T5.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="S5.T5.4.4.1.m1.1" class="ltx_Math" alttext="\mathit{ContextEncoder}" display="inline"><semantics id="S5.T5.4.4.1.m1.1a"><mi id="S5.T5.4.4.1.m1.1.1" xref="S5.T5.4.4.1.m1.1.1.cmml">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</mi><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.1.m1.1b"><ci id="S5.T5.4.4.1.m1.1.1.cmml" xref="S5.T5.4.4.1.m1.1.1">𝐶𝑜𝑛𝑡𝑒𝑥𝑡𝐸𝑛𝑐𝑜𝑑𝑒𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.1.m1.1c">\mathit{ContextEncoder}</annotation></semantics></math></th>
<td id="S5.T5.4.4.2" class="ltx_td ltx_align_right">1.3</td>
<td id="S5.T5.4.4.3" class="ltx_td ltx_align_right">1.3</td>
</tr>
<tr id="S5.T5.5.5" class="ltx_tr">
<th id="S5.T5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="S5.T5.5.5.1.m1.1" class="ltx_Math" alttext="\mathit{WPAttention}" display="inline"><semantics id="S5.T5.5.5.1.m1.1a"><mi id="S5.T5.5.5.1.m1.1.1" xref="S5.T5.5.5.1.m1.1.1.cmml">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</mi><annotation-xml encoding="MathML-Content" id="S5.T5.5.5.1.m1.1b"><ci id="S5.T5.5.5.1.m1.1.1.cmml" xref="S5.T5.5.5.1.m1.1.1">𝑊𝑃𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.5.1.m1.1c">\mathit{WPAttention}</annotation></semantics></math></th>
<td id="S5.T5.5.5.2" class="ltx_td ltx_align_right">0.7</td>
<td id="S5.T5.5.5.3" class="ltx_td ltx_align_right">0.7</td>
</tr>
<tr id="S5.T5.5.8.3" class="ltx_tr">
<th id="S5.T5.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">Total</th>
<td id="S5.T5.5.8.3.2" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">8.7</td>
<td id="S5.T5.5.8.3.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">32.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Latency of Deferred NAM (D3), at <math id="S5.T5.7.m1.1" class="ltx_Math" alttext="k^{p}" display="inline"><semantics id="S5.T5.7.m1.1b"><msup id="S5.T5.7.m1.1.1" xref="S5.T5.7.m1.1.1.cmml"><mi id="S5.T5.7.m1.1.1.2" xref="S5.T5.7.m1.1.1.2.cmml">k</mi><mi id="S5.T5.7.m1.1.1.3" xref="S5.T5.7.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T5.7.m1.1c"><apply id="S5.T5.7.m1.1.1.cmml" xref="S5.T5.7.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.7.m1.1.1.1.cmml" xref="S5.T5.7.m1.1.1">superscript</csymbol><ci id="S5.T5.7.m1.1.1.2.cmml" xref="S5.T5.7.m1.1.1.2">𝑘</ci><ci id="S5.T5.7.m1.1.1.3.cmml" xref="S5.T5.7.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.7.m1.1d">k^{p}</annotation></semantics></math>=32.</figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">The ASR is benchmarked on 1x1 cloud TPU V3 at bfloat16, with batch size (number of utterances) 8; each utterance has 512 time steps (15.36s of audio), and each bias phrase has a length of 16 WPs. As shown in Table <a href="#S5.T5" title="Table 5 ‣ 5.2 Inference latency ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the total latency of Deferred NAM at processing 3K and 20K bias phrases is only 8.7ms and 32.3ms, respectively. On the other hand, encoding all bias phrases up front (Dual-mode NAM) is significantly slower, i.e., B1’s 3L Conformer context encoder latency alone is 214ms and 1549ms; B2’s 1L Conformer context encoder latency alone is at 72ms and 520ms. Overall, Deferred NAM provides a speedup of at least 8.3X and 16.1X over Dual-mode NAM’s best-case latency scenario (B2), and surpasses the best-case quality scenario (B1), as discussed in Section <a href="#S5.SS1" title="5.1 Quality ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Exploration: NO_BIAS filter</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">We investigated gating the WP attention with the phrase-level NO_BIAS token, where a bias phrase is deemed “active” if its per-frame logit is higher than that of the NO_BIAS token (<math id="S5.SS3.p1.1.m1.1" class="ltx_math_unparsed" alttext="z^{p}_{t}[1:2]" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1b"><msubsup id="S5.SS3.p1.1.m1.1.1"><mi id="S5.SS3.p1.1.m1.1.1.2.2">z</mi><mi id="S5.SS3.p1.1.m1.1.1.3">t</mi><mi id="S5.SS3.p1.1.m1.1.1.2.3">p</mi></msubsup><mrow id="S5.SS3.p1.1.m1.1.2"><mo stretchy="false" id="S5.SS3.p1.1.m1.1.2.1">[</mo><mn id="S5.SS3.p1.1.m1.1.2.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S5.SS3.p1.1.m1.1.2.3">:</mo><mn id="S5.SS3.p1.1.m1.1.2.4">2</mn><mo stretchy="false" id="S5.SS3.p1.1.m1.1.2.5">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">z^{p}_{t}[1:2]</annotation></semantics></math>) at any frame. Method 1 (M1) filters inactive phrases before WP attention (equation <a href="#S5.E20" title="In 5.3 Exploration: NO_BIAS filter ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">20</span></a>). However, with fewer WPs to attend to, the remaining ones receive higher attention probabilities.
This could degrade anti-context WERs if the accuracy of the NO_BIAS token is not sufficiently high, i.e., under condition <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">m</annotation></semantics></math>, only 43.6% of utterances are deemed inactive for D3 at ANTI (3K). Therefore, we explored Method 2 (M2), which zeroes out the WP attention <em id="S5.SS3.p1.2.1" class="ltx_emph ltx_font_italic">values</em> of inactive phrases, leaving the probabilities of the WP <em id="S5.SS3.p1.2.2" class="ltx_emph ltx_font_italic">keys</em> unaffected (equation <a href="#S5.E21" title="In 5.3 Exploration: NO_BIAS filter ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">21</span></a>).</p>
<table id="S6.EGx12" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S5.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E19.m1.1" class="ltx_math_unparsed" alttext="\displaystyle m=\vee_{t=1}^{T}(z^{p}_{t}[2:]&gt;z^{p}_{t}[1:2])\in\mathbb{R}^{N}" display="inline"><semantics id="S5.E19.m1.1a"><mrow id="S5.E19.m1.1b"><mi id="S5.E19.m1.1.1">m</mi><mo rspace="0em" id="S5.E19.m1.1.2">=</mo><msubsup id="S5.E19.m1.1.3"><mo lspace="0em" id="S5.E19.m1.1.3.2.2">∨</mo><mrow id="S5.E19.m1.1.3.2.3"><mi id="S5.E19.m1.1.3.2.3.2">t</mi><mo id="S5.E19.m1.1.3.2.3.1">=</mo><mn id="S5.E19.m1.1.3.2.3.3">1</mn></mrow><mi id="S5.E19.m1.1.3.3">T</mi></msubsup><mrow id="S5.E19.m1.1.4"><mo stretchy="false" id="S5.E19.m1.1.4.1">(</mo><msubsup id="S5.E19.m1.1.4.2"><mi id="S5.E19.m1.1.4.2.2.2">z</mi><mi id="S5.E19.m1.1.4.2.3">t</mi><mi id="S5.E19.m1.1.4.2.2.3">p</mi></msubsup><mrow id="S5.E19.m1.1.4.3"><mo stretchy="false" id="S5.E19.m1.1.4.3.1">[</mo><mn id="S5.E19.m1.1.4.3.2">2</mn><mo lspace="0.278em" rspace="0em" id="S5.E19.m1.1.4.3.3">:</mo><mo stretchy="false" id="S5.E19.m1.1.4.3.4">]</mo></mrow><mo id="S5.E19.m1.1.4.4">&gt;</mo><msubsup id="S5.E19.m1.1.4.5"><mi id="S5.E19.m1.1.4.5.2.2">z</mi><mi id="S5.E19.m1.1.4.5.3">t</mi><mi id="S5.E19.m1.1.4.5.2.3">p</mi></msubsup><mrow id="S5.E19.m1.1.4.6"><mo stretchy="false" id="S5.E19.m1.1.4.6.1">[</mo><mn id="S5.E19.m1.1.4.6.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S5.E19.m1.1.4.6.3">:</mo><mn id="S5.E19.m1.1.4.6.4">2</mn><mo stretchy="false" id="S5.E19.m1.1.4.6.5">]</mo></mrow><mo stretchy="false" id="S5.E19.m1.1.4.7">)</mo></mrow><mo id="S5.E19.m1.1.5">∈</mo><msup id="S5.E19.m1.1.6"><mi id="S5.E19.m1.1.6.2">ℝ</mi><mi id="S5.E19.m1.1.6.3">N</mi></msup></mrow><annotation encoding="application/x-tex" id="S5.E19.m1.1c">\displaystyle m=\vee_{t=1}^{T}(z^{p}_{t}[2:]&gt;z^{p}_{t}[1:2])\in\mathbb{R}^{N}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="S5.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E20.m1.3" class="ltx_Math" alttext="\displaystyle Method~{}1:(I^{p}_{global})^{\prime}=Filter(I^{p}_{global},m)" display="inline"><semantics id="S5.E20.m1.3a"><mrow id="S5.E20.m1.3.3" xref="S5.E20.m1.3.3.cmml"><mrow id="S5.E20.m1.3.3.4" xref="S5.E20.m1.3.3.4.cmml"><mi id="S5.E20.m1.3.3.4.2" xref="S5.E20.m1.3.3.4.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.4.1" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mi id="S5.E20.m1.3.3.4.3" xref="S5.E20.m1.3.3.4.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.4.1a" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mi id="S5.E20.m1.3.3.4.4" xref="S5.E20.m1.3.3.4.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.4.1b" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mi id="S5.E20.m1.3.3.4.5" xref="S5.E20.m1.3.3.4.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.4.1c" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mi id="S5.E20.m1.3.3.4.6" xref="S5.E20.m1.3.3.4.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.4.1d" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mi id="S5.E20.m1.3.3.4.7" xref="S5.E20.m1.3.3.4.7.cmml">d</mi><mo lspace="0.330em" rspace="0em" id="S5.E20.m1.3.3.4.1e" xref="S5.E20.m1.3.3.4.1.cmml">​</mo><mn id="S5.E20.m1.3.3.4.8" xref="S5.E20.m1.3.3.4.8.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S5.E20.m1.3.3.3" xref="S5.E20.m1.3.3.3.cmml">:</mo><mrow id="S5.E20.m1.3.3.2" xref="S5.E20.m1.3.3.2.cmml"><msup id="S5.E20.m1.2.2.1.1" xref="S5.E20.m1.2.2.1.1.cmml"><mrow id="S5.E20.m1.2.2.1.1.1.1" xref="S5.E20.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E20.m1.2.2.1.1.1.1.2" xref="S5.E20.m1.2.2.1.1.1.1.1.cmml">(</mo><msubsup id="S5.E20.m1.2.2.1.1.1.1.1" xref="S5.E20.m1.2.2.1.1.1.1.1.cmml"><mi id="S5.E20.m1.2.2.1.1.1.1.1.2.2" xref="S5.E20.m1.2.2.1.1.1.1.1.2.2.cmml">I</mi><mrow id="S5.E20.m1.2.2.1.1.1.1.1.3" xref="S5.E20.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.2" xref="S5.E20.m1.2.2.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.2.2.1.1.1.1.1.3.1" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.3" xref="S5.E20.m1.2.2.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.2.2.1.1.1.1.1.3.1a" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.4" xref="S5.E20.m1.2.2.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.2.2.1.1.1.1.1.3.1b" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.5" xref="S5.E20.m1.2.2.1.1.1.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.2.2.1.1.1.1.1.3.1c" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.6" xref="S5.E20.m1.2.2.1.1.1.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.2.2.1.1.1.1.1.3.1d" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.2.2.1.1.1.1.1.3.7" xref="S5.E20.m1.2.2.1.1.1.1.1.3.7.cmml">l</mi></mrow><mi id="S5.E20.m1.2.2.1.1.1.1.1.2.3" xref="S5.E20.m1.2.2.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo stretchy="false" id="S5.E20.m1.2.2.1.1.1.1.3" xref="S5.E20.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E20.m1.2.2.1.1.3" xref="S5.E20.m1.2.2.1.1.3.cmml">′</mo></msup><mo id="S5.E20.m1.3.3.2.3" xref="S5.E20.m1.3.3.2.3.cmml">=</mo><mrow id="S5.E20.m1.3.3.2.2" xref="S5.E20.m1.3.3.2.2.cmml"><mi id="S5.E20.m1.3.3.2.2.3" xref="S5.E20.m1.3.3.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.4" xref="S5.E20.m1.3.3.2.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2a" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.5" xref="S5.E20.m1.3.3.2.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2b" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.6" xref="S5.E20.m1.3.3.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2c" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.7" xref="S5.E20.m1.3.3.2.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2d" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.8" xref="S5.E20.m1.3.3.2.2.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.2e" xref="S5.E20.m1.3.3.2.2.2.cmml">​</mo><mrow id="S5.E20.m1.3.3.2.2.1.1" xref="S5.E20.m1.3.3.2.2.1.2.cmml"><mo stretchy="false" id="S5.E20.m1.3.3.2.2.1.1.2" xref="S5.E20.m1.3.3.2.2.1.2.cmml">(</mo><msubsup id="S5.E20.m1.3.3.2.2.1.1.1" xref="S5.E20.m1.3.3.2.2.1.1.1.cmml"><mi id="S5.E20.m1.3.3.2.2.1.1.1.2.2" xref="S5.E20.m1.3.3.2.2.1.1.1.2.2.cmml">I</mi><mrow id="S5.E20.m1.3.3.2.2.1.1.1.3" xref="S5.E20.m1.3.3.2.2.1.1.1.3.cmml"><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.2" xref="S5.E20.m1.3.3.2.2.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.1.1.1.3.1" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.3" xref="S5.E20.m1.3.3.2.2.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.1.1.1.3.1a" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.4" xref="S5.E20.m1.3.3.2.2.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.1.1.1.3.1b" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.5" xref="S5.E20.m1.3.3.2.2.1.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.1.1.1.3.1c" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.6" xref="S5.E20.m1.3.3.2.2.1.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E20.m1.3.3.2.2.1.1.1.3.1d" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.E20.m1.3.3.2.2.1.1.1.3.7" xref="S5.E20.m1.3.3.2.2.1.1.1.3.7.cmml">l</mi></mrow><mi id="S5.E20.m1.3.3.2.2.1.1.1.2.3" xref="S5.E20.m1.3.3.2.2.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S5.E20.m1.3.3.2.2.1.1.3" xref="S5.E20.m1.3.3.2.2.1.2.cmml">,</mo><mi id="S5.E20.m1.1.1" xref="S5.E20.m1.1.1.cmml">m</mi><mo stretchy="false" id="S5.E20.m1.3.3.2.2.1.1.4" xref="S5.E20.m1.3.3.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E20.m1.3b"><apply id="S5.E20.m1.3.3.cmml" xref="S5.E20.m1.3.3"><ci id="S5.E20.m1.3.3.3.cmml" xref="S5.E20.m1.3.3.3">:</ci><apply id="S5.E20.m1.3.3.4.cmml" xref="S5.E20.m1.3.3.4"><times id="S5.E20.m1.3.3.4.1.cmml" xref="S5.E20.m1.3.3.4.1"></times><ci id="S5.E20.m1.3.3.4.2.cmml" xref="S5.E20.m1.3.3.4.2">𝑀</ci><ci id="S5.E20.m1.3.3.4.3.cmml" xref="S5.E20.m1.3.3.4.3">𝑒</ci><ci id="S5.E20.m1.3.3.4.4.cmml" xref="S5.E20.m1.3.3.4.4">𝑡</ci><ci id="S5.E20.m1.3.3.4.5.cmml" xref="S5.E20.m1.3.3.4.5">ℎ</ci><ci id="S5.E20.m1.3.3.4.6.cmml" xref="S5.E20.m1.3.3.4.6">𝑜</ci><ci id="S5.E20.m1.3.3.4.7.cmml" xref="S5.E20.m1.3.3.4.7">𝑑</ci><cn type="integer" id="S5.E20.m1.3.3.4.8.cmml" xref="S5.E20.m1.3.3.4.8">1</cn></apply><apply id="S5.E20.m1.3.3.2.cmml" xref="S5.E20.m1.3.3.2"><eq id="S5.E20.m1.3.3.2.3.cmml" xref="S5.E20.m1.3.3.2.3"></eq><apply id="S5.E20.m1.2.2.1.1.cmml" xref="S5.E20.m1.2.2.1.1"><csymbol cd="ambiguous" id="S5.E20.m1.2.2.1.1.2.cmml" xref="S5.E20.m1.2.2.1.1">superscript</csymbol><apply id="S5.E20.m1.2.2.1.1.1.1.1.cmml" xref="S5.E20.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.E20.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E20.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S5.E20.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.E20.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.E20.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S5.E20.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S5.E20.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.2.2">𝐼</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S5.E20.m1.2.2.1.1.1.1.1.3.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3"><times id="S5.E20.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.2">𝑔</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.3">𝑙</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.4.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.4">𝑜</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.5.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.5">𝑏</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.6.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.6">𝑎</ci><ci id="S5.E20.m1.2.2.1.1.1.1.1.3.7.cmml" xref="S5.E20.m1.2.2.1.1.1.1.1.3.7">𝑙</ci></apply></apply><ci id="S5.E20.m1.2.2.1.1.3.cmml" xref="S5.E20.m1.2.2.1.1.3">′</ci></apply><apply id="S5.E20.m1.3.3.2.2.cmml" xref="S5.E20.m1.3.3.2.2"><times id="S5.E20.m1.3.3.2.2.2.cmml" xref="S5.E20.m1.3.3.2.2.2"></times><ci id="S5.E20.m1.3.3.2.2.3.cmml" xref="S5.E20.m1.3.3.2.2.3">𝐹</ci><ci id="S5.E20.m1.3.3.2.2.4.cmml" xref="S5.E20.m1.3.3.2.2.4">𝑖</ci><ci id="S5.E20.m1.3.3.2.2.5.cmml" xref="S5.E20.m1.3.3.2.2.5">𝑙</ci><ci id="S5.E20.m1.3.3.2.2.6.cmml" xref="S5.E20.m1.3.3.2.2.6">𝑡</ci><ci id="S5.E20.m1.3.3.2.2.7.cmml" xref="S5.E20.m1.3.3.2.2.7">𝑒</ci><ci id="S5.E20.m1.3.3.2.2.8.cmml" xref="S5.E20.m1.3.3.2.2.8">𝑟</ci><interval closure="open" id="S5.E20.m1.3.3.2.2.1.2.cmml" xref="S5.E20.m1.3.3.2.2.1.1"><apply id="S5.E20.m1.3.3.2.2.1.1.1.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.E20.m1.3.3.2.2.1.1.1.1.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1">subscript</csymbol><apply id="S5.E20.m1.3.3.2.2.1.1.1.2.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.E20.m1.3.3.2.2.1.1.1.2.1.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1">superscript</csymbol><ci id="S5.E20.m1.3.3.2.2.1.1.1.2.2.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.2.2">𝐼</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.2.3.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.2.3">𝑝</ci></apply><apply id="S5.E20.m1.3.3.2.2.1.1.1.3.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3"><times id="S5.E20.m1.3.3.2.2.1.1.1.3.1.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.1"></times><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.2.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.2">𝑔</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.3.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.3">𝑙</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.4.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.4">𝑜</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.5.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.5">𝑏</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.6.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.6">𝑎</ci><ci id="S5.E20.m1.3.3.2.2.1.1.1.3.7.cmml" xref="S5.E20.m1.3.3.2.2.1.1.1.3.7">𝑙</ci></apply></apply><ci id="S5.E20.m1.1.1.cmml" xref="S5.E20.m1.1.1">𝑚</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E20.m1.3c">\displaystyle Method~{}1:(I^{p}_{global})^{\prime}=Filter(I^{p}_{global},m)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="S5.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E21.m1.3" class="ltx_Math" alttext="\displaystyle Method~{}2:(v^{w})^{\prime}=v^{w}_{i,j}\Theta^{V}\circ m_{i}" display="inline"><semantics id="S5.E21.m1.3a"><mrow id="S5.E21.m1.3.3" xref="S5.E21.m1.3.3.cmml"><mrow id="S5.E21.m1.3.3.3" xref="S5.E21.m1.3.3.3.cmml"><mi id="S5.E21.m1.3.3.3.2" xref="S5.E21.m1.3.3.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.3.1" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mi id="S5.E21.m1.3.3.3.3" xref="S5.E21.m1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.3.1a" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mi id="S5.E21.m1.3.3.3.4" xref="S5.E21.m1.3.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.3.1b" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mi id="S5.E21.m1.3.3.3.5" xref="S5.E21.m1.3.3.3.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.3.1c" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mi id="S5.E21.m1.3.3.3.6" xref="S5.E21.m1.3.3.3.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.3.1d" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mi id="S5.E21.m1.3.3.3.7" xref="S5.E21.m1.3.3.3.7.cmml">d</mi><mo lspace="0.330em" rspace="0em" id="S5.E21.m1.3.3.3.1e" xref="S5.E21.m1.3.3.3.1.cmml">​</mo><mn id="S5.E21.m1.3.3.3.8" xref="S5.E21.m1.3.3.3.8.cmml">2</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S5.E21.m1.3.3.2" xref="S5.E21.m1.3.3.2.cmml">:</mo><mrow id="S5.E21.m1.3.3.1" xref="S5.E21.m1.3.3.1.cmml"><msup id="S5.E21.m1.3.3.1.1" xref="S5.E21.m1.3.3.1.1.cmml"><mrow id="S5.E21.m1.3.3.1.1.1.1" xref="S5.E21.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E21.m1.3.3.1.1.1.1.2" xref="S5.E21.m1.3.3.1.1.1.1.1.cmml">(</mo><msup id="S5.E21.m1.3.3.1.1.1.1.1" xref="S5.E21.m1.3.3.1.1.1.1.1.cmml"><mi id="S5.E21.m1.3.3.1.1.1.1.1.2" xref="S5.E21.m1.3.3.1.1.1.1.1.2.cmml">v</mi><mi id="S5.E21.m1.3.3.1.1.1.1.1.3" xref="S5.E21.m1.3.3.1.1.1.1.1.3.cmml">w</mi></msup><mo stretchy="false" id="S5.E21.m1.3.3.1.1.1.1.3" xref="S5.E21.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E21.m1.3.3.1.1.3" xref="S5.E21.m1.3.3.1.1.3.cmml">′</mo></msup><mo id="S5.E21.m1.3.3.1.2" xref="S5.E21.m1.3.3.1.2.cmml">=</mo><mrow id="S5.E21.m1.3.3.1.3" xref="S5.E21.m1.3.3.1.3.cmml"><mrow id="S5.E21.m1.3.3.1.3.2" xref="S5.E21.m1.3.3.1.3.2.cmml"><msubsup id="S5.E21.m1.3.3.1.3.2.2" xref="S5.E21.m1.3.3.1.3.2.2.cmml"><mi id="S5.E21.m1.3.3.1.3.2.2.2.2" xref="S5.E21.m1.3.3.1.3.2.2.2.2.cmml">v</mi><mrow id="S5.E21.m1.2.2.2.4" xref="S5.E21.m1.2.2.2.3.cmml"><mi id="S5.E21.m1.1.1.1.1" xref="S5.E21.m1.1.1.1.1.cmml">i</mi><mo id="S5.E21.m1.2.2.2.4.1" xref="S5.E21.m1.2.2.2.3.cmml">,</mo><mi id="S5.E21.m1.2.2.2.2" xref="S5.E21.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S5.E21.m1.3.3.1.3.2.2.2.3" xref="S5.E21.m1.3.3.1.3.2.2.2.3.cmml">w</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.E21.m1.3.3.1.3.2.1" xref="S5.E21.m1.3.3.1.3.2.1.cmml">​</mo><msup id="S5.E21.m1.3.3.1.3.2.3" xref="S5.E21.m1.3.3.1.3.2.3.cmml"><mi mathvariant="normal" id="S5.E21.m1.3.3.1.3.2.3.2" xref="S5.E21.m1.3.3.1.3.2.3.2.cmml">Θ</mi><mi id="S5.E21.m1.3.3.1.3.2.3.3" xref="S5.E21.m1.3.3.1.3.2.3.3.cmml">V</mi></msup></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.E21.m1.3.3.1.3.1" xref="S5.E21.m1.3.3.1.3.1.cmml">∘</mo><msub id="S5.E21.m1.3.3.1.3.3" xref="S5.E21.m1.3.3.1.3.3.cmml"><mi id="S5.E21.m1.3.3.1.3.3.2" xref="S5.E21.m1.3.3.1.3.3.2.cmml">m</mi><mi id="S5.E21.m1.3.3.1.3.3.3" xref="S5.E21.m1.3.3.1.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E21.m1.3b"><apply id="S5.E21.m1.3.3.cmml" xref="S5.E21.m1.3.3"><ci id="S5.E21.m1.3.3.2.cmml" xref="S5.E21.m1.3.3.2">:</ci><apply id="S5.E21.m1.3.3.3.cmml" xref="S5.E21.m1.3.3.3"><times id="S5.E21.m1.3.3.3.1.cmml" xref="S5.E21.m1.3.3.3.1"></times><ci id="S5.E21.m1.3.3.3.2.cmml" xref="S5.E21.m1.3.3.3.2">𝑀</ci><ci id="S5.E21.m1.3.3.3.3.cmml" xref="S5.E21.m1.3.3.3.3">𝑒</ci><ci id="S5.E21.m1.3.3.3.4.cmml" xref="S5.E21.m1.3.3.3.4">𝑡</ci><ci id="S5.E21.m1.3.3.3.5.cmml" xref="S5.E21.m1.3.3.3.5">ℎ</ci><ci id="S5.E21.m1.3.3.3.6.cmml" xref="S5.E21.m1.3.3.3.6">𝑜</ci><ci id="S5.E21.m1.3.3.3.7.cmml" xref="S5.E21.m1.3.3.3.7">𝑑</ci><cn type="integer" id="S5.E21.m1.3.3.3.8.cmml" xref="S5.E21.m1.3.3.3.8">2</cn></apply><apply id="S5.E21.m1.3.3.1.cmml" xref="S5.E21.m1.3.3.1"><eq id="S5.E21.m1.3.3.1.2.cmml" xref="S5.E21.m1.3.3.1.2"></eq><apply id="S5.E21.m1.3.3.1.1.cmml" xref="S5.E21.m1.3.3.1.1"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.1.2.cmml" xref="S5.E21.m1.3.3.1.1">superscript</csymbol><apply id="S5.E21.m1.3.3.1.1.1.1.1.cmml" xref="S5.E21.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.E21.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S5.E21.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.E21.m1.3.3.1.1.1.1.1.2">𝑣</ci><ci id="S5.E21.m1.3.3.1.1.1.1.1.3.cmml" xref="S5.E21.m1.3.3.1.1.1.1.1.3">𝑤</ci></apply><ci id="S5.E21.m1.3.3.1.1.3.cmml" xref="S5.E21.m1.3.3.1.1.3">′</ci></apply><apply id="S5.E21.m1.3.3.1.3.cmml" xref="S5.E21.m1.3.3.1.3"><compose id="S5.E21.m1.3.3.1.3.1.cmml" xref="S5.E21.m1.3.3.1.3.1"></compose><apply id="S5.E21.m1.3.3.1.3.2.cmml" xref="S5.E21.m1.3.3.1.3.2"><times id="S5.E21.m1.3.3.1.3.2.1.cmml" xref="S5.E21.m1.3.3.1.3.2.1"></times><apply id="S5.E21.m1.3.3.1.3.2.2.cmml" xref="S5.E21.m1.3.3.1.3.2.2"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.3.2.2.1.cmml" xref="S5.E21.m1.3.3.1.3.2.2">subscript</csymbol><apply id="S5.E21.m1.3.3.1.3.2.2.2.cmml" xref="S5.E21.m1.3.3.1.3.2.2"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.3.2.2.2.1.cmml" xref="S5.E21.m1.3.3.1.3.2.2">superscript</csymbol><ci id="S5.E21.m1.3.3.1.3.2.2.2.2.cmml" xref="S5.E21.m1.3.3.1.3.2.2.2.2">𝑣</ci><ci id="S5.E21.m1.3.3.1.3.2.2.2.3.cmml" xref="S5.E21.m1.3.3.1.3.2.2.2.3">𝑤</ci></apply><list id="S5.E21.m1.2.2.2.3.cmml" xref="S5.E21.m1.2.2.2.4"><ci id="S5.E21.m1.1.1.1.1.cmml" xref="S5.E21.m1.1.1.1.1">𝑖</ci><ci id="S5.E21.m1.2.2.2.2.cmml" xref="S5.E21.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S5.E21.m1.3.3.1.3.2.3.cmml" xref="S5.E21.m1.3.3.1.3.2.3"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.3.2.3.1.cmml" xref="S5.E21.m1.3.3.1.3.2.3">superscript</csymbol><ci id="S5.E21.m1.3.3.1.3.2.3.2.cmml" xref="S5.E21.m1.3.3.1.3.2.3.2">Θ</ci><ci id="S5.E21.m1.3.3.1.3.2.3.3.cmml" xref="S5.E21.m1.3.3.1.3.2.3.3">𝑉</ci></apply></apply><apply id="S5.E21.m1.3.3.1.3.3.cmml" xref="S5.E21.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S5.E21.m1.3.3.1.3.3.1.cmml" xref="S5.E21.m1.3.3.1.3.3">subscript</csymbol><ci id="S5.E21.m1.3.3.1.3.3.2.cmml" xref="S5.E21.m1.3.3.1.3.3.2">𝑚</ci><ci id="S5.E21.m1.3.3.1.3.3.3.cmml" xref="S5.E21.m1.3.3.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E21.m1.3c">\displaystyle Method~{}2:(v^{w})^{\prime}=v^{w}_{i,j}\Theta^{V}\circ m_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p id="S5.SS3.p1.6" class="ltx_p"><math id="S5.SS3.p1.3.m1.2" class="ltx_Math" alttext="v^{w}_{i,j}" display="inline"><semantics id="S5.SS3.p1.3.m1.2a"><msubsup id="S5.SS3.p1.3.m1.2.3" xref="S5.SS3.p1.3.m1.2.3.cmml"><mi id="S5.SS3.p1.3.m1.2.3.2.2" xref="S5.SS3.p1.3.m1.2.3.2.2.cmml">v</mi><mrow id="S5.SS3.p1.3.m1.2.2.2.4" xref="S5.SS3.p1.3.m1.2.2.2.3.cmml"><mi id="S5.SS3.p1.3.m1.1.1.1.1" xref="S5.SS3.p1.3.m1.1.1.1.1.cmml">i</mi><mo id="S5.SS3.p1.3.m1.2.2.2.4.1" xref="S5.SS3.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p1.3.m1.2.2.2.2" xref="S5.SS3.p1.3.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S5.SS3.p1.3.m1.2.3.2.3" xref="S5.SS3.p1.3.m1.2.3.2.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m1.2b"><apply id="S5.SS3.p1.3.m1.2.3.cmml" xref="S5.SS3.p1.3.m1.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m1.2.3.1.cmml" xref="S5.SS3.p1.3.m1.2.3">subscript</csymbol><apply id="S5.SS3.p1.3.m1.2.3.2.cmml" xref="S5.SS3.p1.3.m1.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m1.2.3.2.1.cmml" xref="S5.SS3.p1.3.m1.2.3">superscript</csymbol><ci id="S5.SS3.p1.3.m1.2.3.2.2.cmml" xref="S5.SS3.p1.3.m1.2.3.2.2">𝑣</ci><ci id="S5.SS3.p1.3.m1.2.3.2.3.cmml" xref="S5.SS3.p1.3.m1.2.3.2.3">𝑤</ci></apply><list id="S5.SS3.p1.3.m1.2.2.2.3.cmml" xref="S5.SS3.p1.3.m1.2.2.2.4"><ci id="S5.SS3.p1.3.m1.1.1.1.1.cmml" xref="S5.SS3.p1.3.m1.1.1.1.1">𝑖</ci><ci id="S5.SS3.p1.3.m1.2.2.2.2.cmml" xref="S5.SS3.p1.3.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m1.2c">v^{w}_{i,j}</annotation></semantics></math>: The attention value of <math id="S5.SS3.p1.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS3.p1.4.m2.1a"><mi id="S5.SS3.p1.4.m2.1.1" xref="S5.SS3.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m2.1b"><ci id="S5.SS3.p1.4.m2.1.1.cmml" xref="S5.SS3.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m2.1c">i</annotation></semantics></math>-th phrase at <math id="S5.SS3.p1.5.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.SS3.p1.5.m3.1a"><mi id="S5.SS3.p1.5.m3.1.1" xref="S5.SS3.p1.5.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m3.1b"><ci id="S5.SS3.p1.5.m3.1.1.cmml" xref="S5.SS3.p1.5.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m3.1c">j</annotation></semantics></math>-th WP; <math id="S5.SS3.p1.6.m4.1" class="ltx_Math" alttext="\Theta^{V}" display="inline"><semantics id="S5.SS3.p1.6.m4.1a"><msup id="S5.SS3.p1.6.m4.1.1" xref="S5.SS3.p1.6.m4.1.1.cmml"><mi mathvariant="normal" id="S5.SS3.p1.6.m4.1.1.2" xref="S5.SS3.p1.6.m4.1.1.2.cmml">Θ</mi><mi id="S5.SS3.p1.6.m4.1.1.3" xref="S5.SS3.p1.6.m4.1.1.3.cmml">V</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m4.1b"><apply id="S5.SS3.p1.6.m4.1.1.cmml" xref="S5.SS3.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m4.1.1.1.cmml" xref="S5.SS3.p1.6.m4.1.1">superscript</csymbol><ci id="S5.SS3.p1.6.m4.1.1.2.cmml" xref="S5.SS3.p1.6.m4.1.1.2">Θ</ci><ci id="S5.SS3.p1.6.m4.1.1.3.cmml" xref="S5.SS3.p1.6.m4.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m4.1c">\Theta^{V}</annotation></semantics></math>: The value projection matrix of WP attention.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<table id="S5.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.1.1.1" class="ltx_tr">
<th id="S5.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt">Expt</th>
<th id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">D1</th>
<th id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">D3</th>
</tr>
<tr id="S5.T6.1.2.2" class="ltx_tr">
<th id="S5.T6.1.2.2.1" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S5.T6.1.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column">N/A</th>
<th id="S5.T6.1.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_r">M1</th>
<th id="S5.T6.1.2.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column">N/A</th>
<th id="S5.T6.1.2.2.5" class="ltx_td ltx_align_right ltx_th ltx_th_column">M1</th>
<th id="S5.T6.1.2.2.6" class="ltx_td ltx_align_right ltx_th ltx_th_column">M2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.1.3.1" class="ltx_tr">
<td id="S5.T6.1.3.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ANTI</td>
<td id="S5.T6.1.3.1.2" class="ltx_td ltx_align_right ltx_border_t">1.9</td>
<td id="S5.T6.1.3.1.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t"><span id="S5.T6.1.3.1.3.1" class="ltx_text ltx_font_bold">1.4</span></td>
<td id="S5.T6.1.3.1.4" class="ltx_td ltx_align_right ltx_border_t">1.8</td>
<td id="S5.T6.1.3.1.5" class="ltx_td ltx_align_right ltx_border_t">1.9</td>
<td id="S5.T6.1.3.1.6" class="ltx_td ltx_align_right ltx_border_t">1.7</td>
</tr>
<tr id="S5.T6.1.4.2" class="ltx_tr">
<td id="S5.T6.1.4.2.1" class="ltx_td ltx_align_left ltx_border_r">WO_PREFIX</td>
<td id="S5.T6.1.4.2.2" class="ltx_td ltx_align_right">2.6</td>
<td id="S5.T6.1.4.2.3" class="ltx_td ltx_align_right ltx_border_r">12.9</td>
<td id="S5.T6.1.4.2.4" class="ltx_td ltx_align_right">2.0</td>
<td id="S5.T6.1.4.2.5" class="ltx_td ltx_align_right"><span id="S5.T6.1.4.2.5.1" class="ltx_text ltx_font_bold">1.8</span></td>
<td id="S5.T6.1.4.2.6" class="ltx_td ltx_align_right">2.1</td>
</tr>
<tr id="S5.T6.1.5.3" class="ltx_tr">
<td id="S5.T6.1.5.3.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">W_PREFIX</td>
<td id="S5.T6.1.5.3.2" class="ltx_td ltx_align_right ltx_border_bb">1.9</td>
<td id="S5.T6.1.5.3.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">8.3</td>
<td id="S5.T6.1.5.3.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T6.1.5.3.4.1" class="ltx_text ltx_font_bold">1.5</span></td>
<td id="S5.T6.1.5.3.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S5.T6.1.5.3.5.1" class="ltx_text ltx_font_bold">1.5</span></td>
<td id="S5.T6.1.5.3.6" class="ltx_td ltx_align_right ltx_border_bb">1.6</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Average WERs (# entities = 0 excluded) for Deferred NAM (D1 &amp; D3) with NO_BIAS filtering.</figcaption>
</figure>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.5" class="ltx_p">Table <a href="#S5.T6" title="Table 6 ‣ 5.3 Exploration: NO_BIAS filter ‣ 5 Results ‣ Deferred NAM: Low-latency Top-K Context Injection via Deferred Context Encoding for Non-Streaming ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows Deferred NAM’s (D3) ability to use the phrase-level NO_BIAS token in inference. D3-M1 shows a relative improvement of up to 10% (<math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="2\rightarrow 1.8" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mn id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">2</mn><mo stretchy="false" id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">→</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">1.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><ci id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1">→</ci><cn type="integer" id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">2</cn><cn type="float" id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">1.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">2\rightarrow 1.8</annotation></semantics></math>) in in-context WERs, with a relative anti-context decline of 5.6% (<math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="1.8\rightarrow 1.9" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">1.8</mn><mo stretchy="false" id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">→</mo><mn id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">1.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><ci id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1">→</ci><cn type="float" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">1.8</cn><cn type="float" id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">1.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">1.8\rightarrow 1.9</annotation></semantics></math>). Conversely, D3-M2 shows a relative improvement of 5.6% (<math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="1.8\rightarrow 1.7" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mn id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">1.8</mn><mo stretchy="false" id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml">→</mo><mn id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">1.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><ci id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1">→</ci><cn type="float" id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">1.8</cn><cn type="float" id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">1.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">1.8\rightarrow 1.7</annotation></semantics></math>) in anti-context WERs with a relative increase of up to 6.7% (<math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="1.5\rightarrow 1.6" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mn id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">1.5</mn><mo stretchy="false" id="S5.SS3.p2.4.m4.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.cmml">→</mo><mn id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">1.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><ci id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1">→</ci><cn type="float" id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">1.5</cn><cn type="float" id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3">1.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">1.5\rightarrow 1.6</annotation></semantics></math>) in in-context WERs. Notably, the NO_BIAS token’s logit dominates in D1 (similar to Dual-mode NAM <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite>) due to the lack of supervised training (i.e., CE-PA), leading to a substantial relative increase of up to 396.2% (<math id="S5.SS3.p2.5.m5.1" class="ltx_Math" alttext="2.6\rightarrow 12.9" display="inline"><semantics id="S5.SS3.p2.5.m5.1a"><mrow id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><mn id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml">2.6</mn><mo stretchy="false" id="S5.SS3.p2.5.m5.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.cmml">→</mo><mn id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">12.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><ci id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1">→</ci><cn type="float" id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2">2.6</cn><cn type="float" id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">12.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">2.6\rightarrow 12.9</annotation></semantics></math>) in in-context WERs.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We proposed a low-latency attention-based contextual ASR system, augmented with phrase- and WP-level cross-entropy losses, which can handle thousands of bias phrases within milliseconds while achieving up to 37.5% relative average WER reduction. This demonstrates the potential for enhancing ASR in real-world applications requiring fast and accurate contextual speech recognition.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aleksic et al. (2015)</span>
<span class="ltx_bibblock">
Petar Aleksic, Mohammadreza Ghodsi, Assaf Michaely, Cyril Allauzen, Keith Hall,
Brian Roark, David Rybach, and Pedro Moreno. 2015.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2015-177" title="" class="ltx_ref ltx_href">Bringing
contextual information to google speech recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2015</em>, pages 468–472.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alexandridis et al. (2023)</span>
<span class="ltx_bibblock">
Anastasios Alexandridis, Kanthashree Mysore Sathyendra, Grant P. Strimel,
Feng-Ju Chang, Ariya Rastrow, Nathan Susanj, and Athanasios Mouchtaris. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP49357.2023.10095322" title="" class="ltx_ref ltx_href">Gated
Contextual Adapters For Selective Contextual Biasing In Neural Transducers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antonova et al. (2023)</span>
<span class="ltx_bibblock">
Alexandra Antonova, Evelina Bakhturina, and Boris Ginsburg. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-768" title="" class="ltx_ref ltx_href">SpellMapper:
A non-autoregressive neural spellchecker for ASR customization with candidate
retrieval based on n-gram mappings</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 1404–1408.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Botros et al. (2021)</span>
<span class="ltx_bibblock">
Rami Botros, Tara N. Sainath, Robert David, Emmanuel Guzman, Wei Li, and
Yanzhang He. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2021-212" title="" class="ltx_ref ltx_href">Tied &amp;
Reduced RNN-T Decoder</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2021</em>, pages 4563–4567.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bruguier et al. (2019)</span>
<span class="ltx_bibblock">
Antoine Bruguier, Rohit Prabhavalkar, Golan Pundak, and Tara N. Sainath. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP.2019.8682441" title="" class="ltx_ref ltx_href">Phoebe:
Pronunciation-aware Contextualization for End-to-end Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ICASSP 2019 - 2019 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 6171–6175.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al. (2021)</span>
<span class="ltx_bibblock">
Feng-Ju Chang, Jing Liu, Martin Radfar, Athanasios Mouchtaris, Maurizio
Omologo, Ariya Rastrow, and Siegfried Kunzmann. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ASRU51503.2021.9687895" title="" class="ltx_ref ltx_href">Context-Aware Transformer Transducer for Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Automatic Speech Recognition and Understanding
Workshop (ASRU)</em>, pages 503–510.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Zhehuai Chen, Mahaveer Jain, Yongqiang Wang, Michael L. Seltzer, and Christian
Fuegen. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2019-1434" title="" class="ltx_ref ltx_href">Joint
Grapheme and Phoneme Embeddings for Contextual End-to-End ASR</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, pages 3490–3494.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2020)</span>
<span class="ltx_bibblock">
Zihang Dai, Guokun Lai, Yiming Yang, and Quoc V. Le. 2020.

</span>
<span class="ltx_bibblock">Funnel-transformer: filtering out sequential redundancy for efficient
language processing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International Conference on Neural
Information Processing Systems</em>, NIPS ’20, Red Hook, NY, USA. Curran
Associates Inc.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dingliwal et al. (2023)</span>
<span class="ltx_bibblock">
Saket Dingliwal, Monica Sunkara, Srikanth Ronanki, Jeff Farris, Katrin
Kirchhoff, and Sravan Bodapati. 2023.

</span>
<span class="ltx_bibblock">Personalization of CTC speech recognition models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">2022 IEEE Spoken Language Technology Workshop (SLT)</em>,
pages 302–309.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2023)</span>
<span class="ltx_bibblock">
Xuandi Fu, Kanthashree Mysore Sathyendra, Ankur Gandhe, Jing Liu, Grant P.
Strimel, Ross McGowan, and Athanasios Mouchtaris. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP49357.2023.10094808" title="" class="ltx_ref ltx_href">Robust
Acoustic And Semantic Contextual Biasing In Neural Transducers For Speech
Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Google (2010)</span>
<span class="ltx_bibblock">
Google. 2010.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://googleblog.blogspot.com/2010/01/googles-privacy-principles.html" title="" class="ltx_ref ltx_href">Google’s Privacy Principles</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Google (2023)</span>
<span class="ltx_bibblock">
Google. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://ai.google/principles/" title="" class="ltx_ref ltx_href">Artificial Intelligence at
Google: Our Principles</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulati et al. (2020)</span>
<span class="ltx_bibblock">
Anmol Gulati, James Qin, Chung-Cheng Chiu, Niki Parmar, Yu Zhang, Jiahui Yu,
Wei Han, Shibo Wang, Zhengdong Zhang, Yonghui Wu, and Ruoming Pang. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2020-3015" title="" class="ltx_ref ltx_href">Conformer:
Convolution-augmented Transformer for Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, pages 5036–5040.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hall et al. (2015)</span>
<span class="ltx_bibblock">
Keith Hall, Eunjoon Cho, Cyril Allauzen, Françoise Beaufays, Noah Coccaro,
Kaisuke Nakajima, Michael Riley, Brian Roark, David Rybach, and Linda Zhang.
2015.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2015-340" title="" class="ltx_ref ltx_href">Composition-based on-the-fly rescoring for salient n-gram biasing</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2015</em>, pages 1418–1422.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2022)</span>
<span class="ltx_bibblock">
Minglun Han, Linhao Dong, Zhenlin Liang, Meng Cai, Shiyu Zhou, Zejun Ma, and
Bo Xu. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP43922.2022.9747101" title="" class="ltx_ref ltx_href">Improving
End-to-End Contextual Speech Recognition with Fine-Grained Contextual
Knowledge Selection</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICASSP 2022 - 2022 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 8532–8536.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2019)</span>
<span class="ltx_bibblock">
Ke Hu, Antoine Bruguier, Tara N. Sainath, Rohit Prabhavalkar, and Golan Pundak.
2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2019-1868" title="" class="ltx_ref ltx_href">Phoneme-Based Contextualization for Cross-Lingual Speech Recognition in
End-to-End Models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, pages 2155–2159.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hwang et al. (2022)</span>
<span class="ltx_bibblock">
Dongseong Hwang, Khe Chai Sim, Zhouyuan Huo, and Trevor Strohman. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2022-11034" title="" class="ltx_ref ltx_href">Pseudo
Label Is Better Than Human Label</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2022</em>, pages 1421–1425.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Iyyer et al. (2015)</span>
<span class="ltx_bibblock">
Mohit Iyyer, Varun Manjunatha, Jordan Boyd-Graber, and Hal Daumé III. 2015.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.3115/v1/P15-1162" title="" class="ltx_ref ltx_href">Deep unordered
composition rivals syntactic methods for text classification</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 53rd Annual Meeting of the Association
for Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</em>, pages 1681–1691,
Beijing, China. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jouppi et al. (2020)</span>
<span class="ltx_bibblock">
Norman P. Jouppi, Doe Hyun Yoon, George Kurian, Sheng Li, Nishant Patil, James
Laudon, Cliff Young, and David Patterson. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1145/3360307" title="" class="ltx_ref ltx_href">A Domain-Specific
Supercomputer for Training Deep Neural Networks</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Commun. ACM</em>, 63(7):67–78.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2023)</span>
<span class="ltx_bibblock">
Yiting Lu, Philip Harding, Kanthashree Mysore Sathyendra, Sibo Tong, Xuandi
Fu, Jing Liu, Feng-Ju Chang, Simon Wiesler, and Grant P. Strimel. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-1010" title="" class="ltx_ref ltx_href">Model-Internal Slot-triggered Biasing for Domain Expansion in Neural
Transducer ASR Models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 1324–1328.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McGraw et al. (2016)</span>
<span class="ltx_bibblock">
Ian McGraw, Rohit Prabhavalkar, Raziel Alvarez, Montse Gonzalez Arenas,
Kanishka Rao, David Rybach, Ouais Alsharif, Haşim Sak, Alexander Gruenstein,
Françoise Beaufays, and Carolina Parada. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP.2016.7472820" title="" class="ltx_ref ltx_href">Personalized
speech recognition on mobile devices</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2016 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>, pages 5955–5959.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et al. (2022)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, Khe Chai Sim, Angad Chandorkar, Fan Gao, Mason Chua,
Trevor Strohman, and Françoise Beaufays. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP43922.2022.9747726" title="" class="ltx_ref ltx_href">Fast
Contextual Adaptation with Neural Associative Memory for On-Device
Personalized Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ICASSP 2022 - 2022 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 6632–6636.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et al. (2023)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, Zelin Wu, Golan Pundak, Khe Chai Sim, Jiayang Li, Pat
Rondon, and Tara N. Sainath. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/SLT54892.2023.10023323" title="" class="ltx_ref ltx_href">NAM+:
Towards Scalable End-to-End Contextual Biasing for Adaptive ASR</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2022 IEEE Spoken Language Technology Workshop (SLT)</em>, pages
190–196.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naowarat et al. (2023)</span>
<span class="ltx_bibblock">
Burin Naowarat, Philip Harding, Pasquale D’Alterio, Sibo Tong, and Bashar
Awwad Shiekh Hasan. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-720" title="" class="ltx_ref ltx_href">Effective
Training of Attention-based Contextual Biasing Adapters with Synthetic Audio
for Personalised ASR</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 1264–1268.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayanan et al. (2021)</span>
<span class="ltx_bibblock">
Arun Narayanan, Tara N. Sainath, Ruoming Pang, Jiahui Yu, Chung-Cheng Chiu,
Rohit Prabhavalkar, Ehsan Variani, and Trevor Strohman. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP39728.2021.9414607" title="" class="ltx_ref ltx_href">Cascaded
Encoders for Unifying Streaming and Non-Streaming ASR</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ICASSP 2021 - 2021 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 5629–5633.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pandey et al. (2023)</span>
<span class="ltx_bibblock">
Rahul Pandey, Roger Ren, Qi Luo, Jing Liu, Ariya Rastrow, Ankur Gandhe, Denis
Filimonov, Grant Strimel, Andreas Stolcke, and Ivan Bulyko. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP49357.2023.10096062" title="" class="ltx_ref ltx_href">Procter:
Pronunciation-Aware Contextual Adapter For Personalized Speech Recognition In
Neural Transducers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pundak et al. (2018)</span>
<span class="ltx_bibblock">
Golan Pundak, Tara N. Sainath, Rohit Prabhavalkar, Anjuli Kannan, and Ding
Zhao. 2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/SLT.2018.8639034" title="" class="ltx_ref ltx_href">Deep Context:
End-to-end Contextual Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">2018 IEEE Spoken Language Technology Workshop (SLT)</em>, pages
418–425.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sathyendra et al. (2022)</span>
<span class="ltx_bibblock">
Kanthashree Mysore Sathyendra, Thejaswi Muniyappa, Feng-Ju Chang, Jing Liu,
Jinru Su, Grant P. Strimel, Athanasios Mouchtaris, and Siegfried Kunzmann.
2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP43922.2022.9746126" title="" class="ltx_ref ltx_href">Contextual
adapters for personalized speech recognition in neural transducers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">ICASSP 2022 - 2022 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 8537–8541.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Serrino et al. (2019)</span>
<span class="ltx_bibblock">
Jack Serrino, Leonid Velikovich, Petar Aleksic, and Cyril Allauzen. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2019-2962" title="" class="ltx_ref ltx_href">Contextual
Recovery of Out-of-Lattice Named Entities in Automatic Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, pages 3830–3834.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer and Stern (2018)</span>
<span class="ltx_bibblock">
Noam Shazeer and Mitchell Stern. 2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.mlr.press/v80/shazeer18a.html" title="" class="ltx_ref ltx_href">Adafactor:
Adaptive learning rates with sublinear memory cost</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 35th International Conference on Machine
Learning</em>, volume 80 of <em id="bib.bib30.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>,
pages 4596–4604. PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2019)</span>
<span class="ltx_bibblock">
Jonathan Shen, Patrick Nguyen, Yonghui Wu, Zhifeng Chen, et al. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1902.08295" title="" class="ltx_ref ltx_href">Lingvo: a Modular and
Scalable Framework for Sequence-to-Sequence Modeling</a>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2023)</span>
<span class="ltx_bibblock">
Gan Song, Zelin Wu, Golan Pundak, Angad Chandorkar, Kandarp Joshi, Xavier
Velez, Diamantino Caseiro, Ben Haynor, Weiran Wang, Nikhil Siddhartha, Pat
Rondon, and Khe Chai Sim. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ASRU57964.2023.10389637" title="" class="ltx_ref ltx_href">Contextual
Spelling Correction with Large Language Models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding
Workshop (ASRU)</em>, pages 1–8.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tong et al. (2023a)</span>
<span class="ltx_bibblock">
Sibo Tong, Philip Harding, and Simon Wiesler. 2023a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ASRU57964.2023.10389675" title="" class="ltx_ref ltx_href">Hierarchical Attention-Based Contextual Biasing For Personalized Speech
Recognition Using Neural Transducers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding
Workshop (ASRU)</em>, pages 1–8.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tong et al. (2023b)</span>
<span class="ltx_bibblock">
Sibo Tong, Philip Harding, and Simon Wiesler. 2023b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP49357.2023.10096677" title="" class="ltx_ref ltx_href">Slot-Triggered Contextual Biasing For Personalized Speech Recognition Using
Neural Transducers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vasserman et al. (2016)</span>
<span class="ltx_bibblock">
Lucy Vasserman, Ben Haynor, and Petar Aleksic. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/SLT.2016.7846301" title="" class="ltx_ref ltx_href">Contextual language
model adaptation using dynamic classes</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">2016 IEEE Spoken Language Technology Workshop (SLT)</em>, pages
441–446.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Xiaoqiang Wang, Yanqing Liu, Sheng Zhao, and Jinyu Li. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2021-379" title="" class="ltx_ref ltx_href">A
Light-Weight Contextual Spelling Correction Model for Customizing
Transducer-Based Speech Recognition Systems</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2021</em>, pages 1982–1986.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2018)</span>
<span class="ltx_bibblock">
Ian Williams, Anjuli Kannan, Petar Aleksic, David Rybach, and Tara Sainath.
2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2018-2416" title="" class="ltx_ref ltx_href">Contextual
Speech Recognition in End-to-end Neural Network Systems Using Beam Search</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2018</em>, pages 2227–2231.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Zelin Wu, Tsendsuren Munkhdalai, Pat Rondon, Golan Pundak, Khe Chai Sim, and
Christopher Li. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-1124" title="" class="ltx_ref ltx_href">Dual-Mode
NAM: Effective Top-K Context Injection for End-to-End ASR</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 221–225.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023a)</span>
<span class="ltx_bibblock">
Tianyi Xu, Zhanheng Yang, Kaixun Huang, Pengcheng Guo, Ao Zhang, Biao Li,
Changru Chen, Chao Li, and Lei Xie. 2023a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-884" title="" class="ltx_ref ltx_href">Adaptive
Contextual Biasing for Transducer Based Streaming Speech Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 1668–1672.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023b)</span>
<span class="ltx_bibblock">
Yaoxun Xu, Baiji Liu, Qiaochu Huang, Xingchen Song, Zhiyong Wu, Shiyin Kang,
and Helen Meng. 2023b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP49357.2023.10095469" title="" class="ltx_ref ltx_href">CB-Conformer: Contextual Biasing Conformer for Biased Word Recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Zhanheng Yang, Sining Sun, Xiong Wang, Yike Zhang, Long Ma, and Lei Xie. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2023-1171" title="" class="ltx_ref ltx_href">Two Stage
Contextual Word Filtering for Context Bias in Unified Streaming and
Non-streaming Transducer</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proc. INTERSPEECH 2023</em>, pages 3257–3261.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Yu Zhang, Wei Han, James Qin, Yongqiang Wang, Ankur Bapna, Zhehuai Chen, Nanxin
Chen, Bo Li, Vera Axelrod, Gary Wang, et al. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2303.01037" title="" class="ltx_ref ltx_href">Google USM: Scaling
Automatic Speech Recognition Beyond 100 Languages</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2019)</span>
<span class="ltx_bibblock">
Ding Zhao, Tara N. Sainath, David Rybach, Pat Rondon, Deepti Bhatia, Bo Li, and
Ruoming Pang. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2019-1209" title="" class="ltx_ref ltx_href">Shallow-Fusion End-to-End Contextual Biasing</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, pages 1418–1422.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.10179" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.10180" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.10180">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.10180" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.10181" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 22:25:35 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
