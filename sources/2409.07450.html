<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.07450] VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos</title><meta property="og:description" content="We present a framework for learning to generate background music from video inputs.
Unlike existing works that rely on symbolic musical annotations, which are limited in quantity and diversity, our method leverages lar…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.07450">

<!--Generated on Sat Oct  5 20:48:18 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id8.id1" class="ltx_text ltx_font_smallcaps">VMAs</span>: Video-to-Music Generation via 
<br class="ltx_break">Semantic Alignment in Web Music Videos</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yan-Bo Lin<sup id="id9.8.id1" class="ltx_sup"><span id="id9.8.id1.1" class="ltx_text ltx_font_italic">1</span></sup>  Yu Tian<sup id="id10.9.id2" class="ltx_sup"><span id="id10.9.id2.1" class="ltx_text ltx_font_italic">2</span></sup>  Linjie Yang<sup id="id11.10.id3" class="ltx_sup"><span id="id11.10.id3.1" class="ltx_text ltx_font_italic">2</span></sup>  Gedas Bertasius<sup id="id12.11.id4" class="ltx_sup"><span id="id12.11.id4.1" class="ltx_text ltx_font_italic">1</span></sup>  Heng Wang<sup id="id13.12.id5" class="ltx_sup"><span id="id13.12.id5.1" class="ltx_text ltx_font_italic">2</span></sup>

<br class="ltx_break"><sup id="id14.13.id6" class="ltx_sup"><span id="id14.13.id6.1" class="ltx_text ltx_font_italic">1</span></sup>UNC Chapel Hill <sup id="id15.14.id7" class="ltx_sup"><span id="id15.14.id7.1" class="ltx_text ltx_font_italic">2</span></sup>ByteDance Inc.

<br class="ltx_break"><span id="id16.15.id8" class="ltx_text ltx_font_typewriter">{yblin,gedas}@cs.unc.edu</span>

<br class="ltx_break"><span id="id17.16.id9" class="ltx_text ltx_font_typewriter">{yutian.yt,linjie.yang, heng.wang}@bytedance.com</span>
</span><span class="ltx_author_notes">Work done during an internship at ByteDance Inc.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id18.id1" class="ltx_p">We present a framework for learning to generate background music from video inputs.
Unlike existing works that rely on symbolic musical annotations, which are limited in quantity and diversity, our method leverages large-scale web videos accompanied by background music. This enables our model to learn to generate realistic and diverse music.
To accomplish this goal, we develop a generative video-music Transformer with a novel semantic video-music alignment scheme. Our model uses a joint autoregressive and contrastive learning objective, which encourages the generation of music aligned with high-level video content. We also introduce a novel video-beat alignment scheme to match the generated music beats with the low-level motions in the video. Lastly, to capture fine-grained visual cues in a video needed for realistic background music generation, we introduce a new temporal video encoder architecture, allowing us to efficiently process videos consisting of many densely sampled frames.
We train our framework on our newly curated DISCO-MV dataset, consisting of 2.2M video-music samples, which is orders of magnitude larger than any prior datasets used for video music generation. Our method outperforms existing approaches on the DISCO-MV and MusicCaps datasets according to various music generation evaluation metrics, including human evaluation.
Results are available at <a target="_blank" href="https://genjib.github.io/project_page/VMAs/index.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://genjib.github.io/project_page/VMAs/index.html</a></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Enabled by modern technology, most people can create their own videos via platforms like TikTok, Instagram, and others. However, creating engaging videos often requires matching the video with the right background music, which is challenging and demands lots of time and expertise. In particular, adding background music to the video often involves a costly search for suitable music and aligning the patterns of pre-produced music with the particular video events. Nevertheless, a well-incorporated music soundtrack can significantly enhance the video viewing experience and make the video more engaging.
Thus, to reduce the manual effort for content creators, the last several years have witnessed an increased demand for automatic video background music generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S1.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S1.T1.4.2" class="ltx_text" style="font-size:90%;">
<span id="S1.T1.4.2.1" class="ltx_text ltx_font_bold">Comparison of different video-to-music generation datasets.</span> Our newly curated DISCO-MV dataset is orders of magnitude larger than the previous YouTube-8M subset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and SymMV <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> datasets, commonly used for music-to-video generation. Compared to other music generation datasets, our DISCO-MV is filtered to exclude videos with little visual variance and remove the vocals for improved background music quality. Since DISCO-MV is built from the existing publicly available datasets, it will be available under the same CC-BY-4.0 license.
</span></figcaption>
<div id="S1.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:491.9pt;height:94.7pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.4pt,0.8pt) scale(0.982360315587357,0.982360315587357) ;">
<table id="S1.T1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S1.T1.5.1.1" class="ltx_tr">
<td id="S1.T1.5.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Dataset</td>
<td id="S1.T1.5.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">SymMV</td>
<td id="S1.T1.5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S1.T1.5.1.1.3.1" class="ltx_text"></span> <span id="S1.T1.5.1.1.3.2" class="ltx_text">
<span id="S1.T1.5.1.1.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S1.T1.5.1.1.3.2.1.1" class="ltx_tr">
<span id="S1.T1.5.1.1.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">YT-8M Subset</span></span>
</span></span><span id="S1.T1.5.1.1.3.3" class="ltx_text"></span></td>
<td id="S1.T1.5.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">DISCO-10M</td>
<td id="S1.T1.5.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">DISCO-MV</td>
</tr>
<tr id="S1.T1.5.1.2" class="ltx_tr">
<td id="S1.T1.5.1.2.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Number of Videos</td>
<td id="S1.T1.5.1.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">1.1K</td>
<td id="S1.T1.5.1.2.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">110K</td>
<td id="S1.T1.5.1.2.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">15.3M</td>
<td id="S1.T1.5.1.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">2.2M</td>
</tr>
<tr id="S1.T1.5.1.3" class="ltx_tr">
<td id="S1.T1.5.1.3.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Avg. Frame Similarity Within Video</td>
<td id="S1.T1.5.1.3.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.64</td>
<td id="S1.T1.5.1.3.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.66</td>
<td id="S1.T1.5.1.3.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.91</td>
<td id="S1.T1.5.1.3.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.61</td>
</tr>
<tr id="S1.T1.5.1.4" class="ltx_tr">
<td id="S1.T1.5.1.4.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Vocals Removed?</td>
<td id="S1.T1.5.1.4.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">N/A<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>SymMV is in the MIDI format without vocal tracks.</span></span></span>
</td>
<td id="S1.T1.5.1.4.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S1.T1.5.1.4.3.1" class="ltx_text" style="color:#FF0000;">✘</span></td>
<td id="S1.T1.5.1.4.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S1.T1.5.1.4.4.1" class="ltx_text" style="color:#FF0000;">✘</span></td>
<td id="S1.T1.5.1.4.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S1.T1.5.1.4.5.1" class="ltx_text" style="color:#006B3D;">✔</span></td>
</tr>
<tr id="S1.T1.5.1.5" class="ltx_tr">
<td id="S1.T1.5.1.5.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">License</td>
<td id="S1.T1.5.1.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">CC BY-NC-SA 4.0</td>
<td id="S1.T1.5.1.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">CC-BY-4.0</td>
<td id="S1.T1.5.1.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">CC-BY-4.0</td>
<td id="S1.T1.5.1.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">CC-BY-4.0</td>
</tr>
</table>
</span></div>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Most prior video-based music generation approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> use symbolic music annotations (e.g., MIDI), which store manually transcribed musical data in a digital format.
However, relying on such symbolic annotations for video-to-music generation is typically suboptimal for several reasons.
First, due to the limited expressivity of symbolic annotations, music generation methods trained on such data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> cannot capture subtle nuances in music soundtracks such as timbre variations, articulation, and the expressiveness of live performances.
Moreover, the fidelity of the generated music is largely contingent upon the quality of a sound synthesizer or a MIDI playback engine, which may not adequately reflect the full depth and complexity of the actual instruments.
Lastly, the small scale and limited genre diversity of MIDI annotations typically lead to poor generalization.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address these issues, we propose to use a large collection of freely accessible internet videos that can provide rich supervision for learning an effective video-to-music generation model spanning many music genres.
Several recent methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> have explored using Web videos for music generation. However, these methods are typically trained on small-scale datasets that span narrow domains (e.g., dancing videos). Instead, to leverage the scale and diversity of Web music videos, we develop a video-music generation framework, dubbed <span id="S1.p3.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span>. Our approach leverages a generative video-music Transformer augmented with a novel <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">V</span>ideo-<span id="S1.p3.1.3" class="ltx_text ltx_font_bold">M</span>usic <span id="S1.p3.1.4" class="ltx_text ltx_font_bold">A</span>lignment <span id="S1.p3.1.5" class="ltx_text ltx_font_bold">S</span>cheme (<span id="S1.p3.1.6" class="ltx_text ltx_font_smallcaps">VMAs</span>). We train our model using joint autoregressive and contrastive learning objectives. The generative objective focuses on realistic music generation, while the contrastive objective encourages alignment between generated music and <span id="S1.p3.1.7" class="ltx_text ltx_font_italic">high-level</span> video content (e.g., the genre of a video). We also introduce a novel video-beat alignment scheme that guides the generated music to be in harmony with <span id="S1.p3.1.8" class="ltx_text ltx_font_italic">low-level</span> visual cues, such as scene transitions or dynamic human motions.
Lastly, unlike existing video-music generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> that use video encoders optimized for coarse spatial recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, we develop an efficient video encoder that can process videos with many densely sampled frames to capture fine-grained temporal cues needed for accurate music generation.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We train our method on our newly curated DISCO-MV dataset, which consists of 2.2M video-music videos spanning 47,000 hours.
Compared to prior video-based music generation approaches, our method generates superior-quality music on the MusicCaps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and DISCO-MV test sets. We also conduct human evaluations and show that human subjects consistently prefer our generated music to music generated by previous methods on both music quality and music-video alignment.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Text-Conditioned Audio and Music Generation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The emergence of powerful text models has led to a number of text-to-audio <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and text-to-music generation models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>. Several recent models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> use a neural audio codec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> first to convert a continuous audio signal into discrete tokens, and then train their conditional music generation model from textual prompts. Additionally, the recent diffusion-based audio and music generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> convert raw audio into a spectrogram via a Short-Time Fourier Transform (STFT), and then use diffusion networks to predict a spectrogram from textual prompts.
Despite the impressive progress of text-to-music generation models, text prompts can only provide high-level music characteristics such as genre and emotion, making it difficult to align the generated music with fine-grained video content.
Instead, our work addresses this issue by generating music directly from the videos.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Video-to-Music Generation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Many methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> have tackled the general problem of video-to-audio generation in the recent years.
Building on this work, recent video-to-music generation methods have been designed to produce musical accompaniments for instrument performance in the video <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, to generate music that matches human motion/dance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, and also to synthesize background music for silent videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
Most of these prior video-to-music generation approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> are trained using symbolic music annotations (e.g., MIDI and ABC), which is often suboptimal because of the limited expressivity, diversity, and scale of such annotations.
Another line of relevant work involves music generation from dance videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. However, as with symbolic music annotations, these methods are typically constrained by small and narrow training datasets. The recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> tries to address these issues by using Internet videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> to learn to generate music. However, this method also uses a small number of videos for training, leading to poor generalization. Instead, we propose a video-to-music generation framework, <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span>, that uses a novel video-music alignment scheme to match the generated music with the high-level and low-level visual cues, leading to vivid and realistic music generation. Furthermore, unlike all prior approaches, our proposed framework leverages orders of magnitude more videos, which is shown to be beneficial for both generation quality and video-music alignment.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2409.07450/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="146" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.5.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F1.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Our Video-to-Music Generation Framework.<span id="S2.F1.6.2.1" class="ltx_text ltx_font_medium"> Our video-to-music generation framework consists of three main components: 1) an efficient video encoder for capturing fine-grained temporal cues from many densely sampled video frames, 2) an autoregressive music decoder for generating output audio tokens, and 3) a novel video-music alignment scheme that integrates a contrastive training objective and a novel video-beat alignment scheme, ensuring that the generated music exhibits <span id="S2.F1.6.2.1.1" class="ltx_text ltx_font_italic">high-level</span> and <span id="S2.F1.6.2.1.2" class="ltx_text ltx_font_italic">low-level</span> alignment with the video content.
</span></span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The DISCO-MV Dataset</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Prior video-to-music generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> use relatively small training datasets, which limits their generalization. Instead, we believe that large-scale training data is the first requirement of building a highly performant video-to-music generation framework. Since the Web contains many freely available videos accompanied by music soundtracks, we aim to use such Web-based videos as a rich supervisory signal for training a large-scale video-to-music generation model. Using large-scale Web-based video-music data is also advantageous since the music soundtracks in Web videos are diverse and span various musical genres, enabling generalization to various scenarios.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">To develop an expansive video-to-music generation dataset, we investigate using the recently introduced DISCO-10M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> dataset, which was created for music research and contains 15M videos collected via Spotify’s artist graph <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
The videos in DISCO-10M were collected by matching the metadata for artists’ top tracks with the corresponding YouTube videos. Upon our preliminary analysis, we found that many videos in DISCO-10M have poor video-music correspondence, i.e., many of the videos consist of a single frame replicated over several minutes or hours or have very little visual variation, which makes them unsuitable for learning a high-quality video-to-music generation model.
To address this issue, we developed an automatic framework to remove such unsuitable videos. Specifically, for each video, we computed pairwise frame similarities within a video and only kept videos with an intra-video frame similarity below a certain threshold (i.e., 0.7).
</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">We also found that most videos in DISCO-10M contain music soundtracks with vocals, which is suboptimal for training video-to-music generation models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
To obtain training soundtracks with instrumental sounds only, we used Demucs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> for vocal removal. Empirically, we found that we could successfully remove vocal sounds from approximately 95% of the music soundtracks.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p">Ultimately, this led to 2.2M filtered videos from the original DISCO-10M dataset, which we also combined with 81K video-music samples from YouTube-8M. Our newly curated video-music generation dataset, DISCO-MV, contains 2.28M video-music samples spanning 47,000 hours. Furthermore, we also manually selected <math id="S3.p4.1.m1.2" class="ltx_Math" alttext="1,120" display="inline"><semantics id="S3.p4.1.m1.2a"><mrow id="S3.p4.1.m1.2.3.2" xref="S3.p4.1.m1.2.3.1.cmml"><mn id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">1</mn><mo id="S3.p4.1.m1.2.3.2.1" xref="S3.p4.1.m1.2.3.1.cmml">,</mo><mn id="S3.p4.1.m1.2.2" xref="S3.p4.1.m1.2.2.cmml">120</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.2b"><list id="S3.p4.1.m1.2.3.1.cmml" xref="S3.p4.1.m1.2.3.2"><cn type="integer" id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">1</cn><cn type="integer" id="S3.p4.1.m1.2.2.cmml" xref="S3.p4.1.m1.2.2">120</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.2c">1,120</annotation></semantics></math> and <math id="S3.p4.2.m2.2" class="ltx_Math" alttext="1,086" display="inline"><semantics id="S3.p4.2.m2.2a"><mrow id="S3.p4.2.m2.2.3.2" xref="S3.p4.2.m2.2.3.1.cmml"><mn id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">1</mn><mo id="S3.p4.2.m2.2.3.2.1" xref="S3.p4.2.m2.2.3.1.cmml">,</mo><mn id="S3.p4.2.m2.2.2" xref="S3.p4.2.m2.2.2.cmml">086</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.2b"><list id="S3.p4.2.m2.2.3.1.cmml" xref="S3.p4.2.m2.2.3.2"><cn type="integer" id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">1</cn><cn type="integer" id="S3.p4.2.m2.2.2.cmml" xref="S3.p4.2.m2.2.2">086</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.2c">1,086</annotation></semantics></math> videos with high-quality video-music correspondence to be used for validation and testing. In Table <a href="#S1.T1" title="Table 1 ‣ 1 Introduction ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we compare various characteristics of previously used video-music generation datasets. Our DISCO-MV is <span id="S3.p4.3.1" class="ltx_text ltx_font_bold">2000<math id="S3.p4.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p4.3.1.m1.1a"><mo id="S3.p4.3.1.m1.1.1" xref="S3.p4.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p4.3.1.m1.1b"><times id="S3.p4.3.1.m1.1.1.cmml" xref="S3.p4.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.1.m1.1c">\times</annotation></semantics></math></span> larger than prior symbolic music annotation datasets such as SymMV. Furthermore, DISCO-MV has a much smaller average frame similarity than YouTube-8M-Music and DISCO-10M, demonstrating that our dataset features videos with rich visual content. Lastly, we note that since DISCO-MV is built using the publicly available video-music datasets (i.e., YouTube-8M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and DISCO-10M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>), both of which are covered by the CC-BY-4.0 license, DISCO-MV will be available under this same license.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Technical Approach</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we present our generative video-music framework. As illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.2 Video-to-Music Generation ‣ 2 Related Work ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our method is composed of three main components: 1) an efficient video encoder, 2) an autoregressive music decoder, and 3) a video-music alignment scheme that integrates a contrastive training objective and a novel video-beat alignment scheme for <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">high-level</span> and <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">low-level</span> video-music alignment, respectively. Below, we describe the details of each of these components.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Audio and Video Inputs</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.7" class="ltx_p"><span id="S4.SS1.p1.7.1" class="ltx_text ltx_font_bold">Audio Inputs.</span> Given a raw music waveform associated with the video, we first compute audio representation <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{X}^{(0)}_{a}\in\mathbb{R}^{t_{a}\times d}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><msubsup id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.2.2.cmml">𝐗</mi><mi id="S4.SS1.p1.1.m1.1.2.2.3" xref="S4.SS1.p1.1.m1.1.2.2.3.cmml">a</mi><mrow id="S4.SS1.p1.1.m1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.2.2.cmml">(</mo><mn id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">∈</mo><msup id="S4.SS1.p1.1.m1.1.2.3" xref="S4.SS1.p1.1.m1.1.2.3.cmml"><mi id="S4.SS1.p1.1.m1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.1.m1.1.2.3.3" xref="S4.SS1.p1.1.m1.1.2.3.3.cmml"><msub id="S4.SS1.p1.1.m1.1.2.3.3.2" xref="S4.SS1.p1.1.m1.1.2.3.3.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.3.3.2.2" xref="S4.SS1.p1.1.m1.1.2.3.3.2.2.cmml">t</mi><mi id="S4.SS1.p1.1.m1.1.2.3.3.2.3" xref="S4.SS1.p1.1.m1.1.2.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.1.m1.1.2.3.3.1" xref="S4.SS1.p1.1.m1.1.2.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.1.m1.1.2.3.3.3" xref="S4.SS1.p1.1.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><in id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></in><apply id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2">subscript</csymbol><apply id="S4.SS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2.2">𝐗</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">0</cn></apply><ci id="S4.SS1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.2.2.3">𝑎</ci></apply><apply id="S4.SS1.p1.1.m1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.3.2.cmml" xref="S4.SS1.p1.1.m1.1.2.3.2">ℝ</ci><apply id="S4.SS1.p1.1.m1.1.2.3.3.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3"><times id="S4.SS1.p1.1.m1.1.2.3.3.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.1"></times><apply id="S4.SS1.p1.1.m1.1.2.3.3.2.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.3.3.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.3.3.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.2.2">𝑡</ci><ci id="S4.SS1.p1.1.m1.1.2.3.3.2.3.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.2.3">𝑎</ci></apply><ci id="S4.SS1.p1.1.m1.1.2.3.3.3.cmml" xref="S4.SS1.p1.1.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathbf{X}^{(0)}_{a}\in\mathbb{R}^{t_{a}\times d}</annotation></semantics></math>, where the superscript <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="(0)" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2.2"><mo stretchy="false" id="S4.SS1.p1.2.m2.1.2.2.1">(</mo><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS1.p1.2.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">(0)</annotation></semantics></math> indicates that this feature tensor will be used as an input to the first layer of our music decoder, while <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="t_{a}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">t</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑡</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">t_{a}</annotation></semantics></math> denotes the number of timesteps related to audio length.
Following MusicGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, we use EnCodec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, a state-of-the-art convolutional encoder-decoder framework, to transform continuous audio streams into a series of discrete tokens.
This procedure transforms the raw music waveform into the above-described quantized music tokens <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{X}^{(0)}_{a}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msubsup id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2.2" xref="S4.SS1.p1.4.m4.1.2.2.2.cmml">𝐗</mi><mi id="S4.SS1.p1.4.m4.1.2.3" xref="S4.SS1.p1.4.m4.1.2.3.cmml">a</mi><mrow id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.1.1.1.3.1" xref="S4.SS1.p1.4.m4.1.2.cmml">(</mo><mn id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS1.p1.4.m4.1.1.1.3.2" xref="S4.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2">subscript</csymbol><apply id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.2.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2.2">𝐗</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">0</cn></apply><ci id="S4.SS1.p1.4.m4.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\mathbf{X}^{(0)}_{a}</annotation></semantics></math> associated with discrete labels, denoted by <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{Y}\in\mathbb{R}^{t_{a}\times c}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">𝐘</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml"><msub id="S4.SS1.p1.5.m5.1.1.3.3.2" xref="S4.SS1.p1.5.m5.1.1.3.3.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.3.3.2.2" xref="S4.SS1.p1.5.m5.1.1.3.3.2.2.cmml">t</mi><mi id="S4.SS1.p1.5.m5.1.1.3.3.2.3" xref="S4.SS1.p1.5.m5.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.5.m5.1.1.3.3.1" xref="S4.SS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.5.m5.1.1.3.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><in id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></in><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝐘</ci><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3"><times id="S4.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.1"></times><apply id="S4.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.3.3.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.3.3.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.2.2">𝑡</ci><ci id="S4.SS1.p1.5.m5.1.1.3.3.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.2.3">𝑎</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathbf{Y}\in\mathbb{R}^{t_{a}\times c}</annotation></semantics></math> with <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">c</annotation></semantics></math> discrete categories. Each category represents a specific range of audio frequencies.
These discrete audio labels <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\mathbf{Y}</annotation></semantics></math> will be used as a supervisory signal for our video-to-music generation model.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.4" class="ltx_p"><span id="S4.SS1.p2.4.1" class="ltx_text ltx_font_bold">Video Inputs.</span> We consider video clips <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{V}\in\mathbb{R}^{t_{v}\times H\times W\times 3}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">𝐕</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml"><msub id="S4.SS1.p2.1.m1.1.1.3.3.2" xref="S4.SS1.p2.1.m1.1.1.3.3.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.3.2.2" xref="S4.SS1.p2.1.m1.1.1.3.3.2.2.cmml">t</mi><mi id="S4.SS1.p2.1.m1.1.1.3.3.2.3" xref="S4.SS1.p2.1.m1.1.1.3.3.2.3.cmml">v</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.3.3.1" xref="S4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.3.3.1a" xref="S4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3.4" xref="S4.SS1.p2.1.m1.1.1.3.3.4.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.3.3.1b" xref="S4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.p2.1.m1.1.1.3.3.5" xref="S4.SS1.p2.1.m1.1.1.3.3.5.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><in id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></in><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝐕</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3"><times id="S4.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.1"></times><apply id="S4.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.3.3.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.3.3.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2.2">𝑡</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2.3">𝑣</ci></apply><ci id="S4.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.3">𝐻</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.4.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.4">𝑊</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.3.5.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.5">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathbf{V}\in\mathbb{R}^{t_{v}\times H\times W\times 3}</annotation></semantics></math>, each containing <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">t</mi><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑡</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">t_{v}</annotation></semantics></math> RGB frames with height <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">H</annotation></semantics></math> and width <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">W</annotation></semantics></math>. We sample these frames uniformly from the entire input video. The video inputs are aligned with the corresponding audio segments.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.66.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.67.2" class="ltx_text" style="font-size:90%;">
<span id="S4.T2.67.2.1" class="ltx_text ltx_font_bold">Our Efficient Video Encoder Architecture.</span> We modify the original Hiera architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> to efficiently process videos consisting of many frames sampled at a high FPS rate. Specifically, we increase the strides of Q-Pooling layers to reduce spatial dimension in the early layers of the network while maintaining the temporal dimension throughout the network. Processing video frames at high temporal granularity allows our model to extract much more fine-grained temporal video cues than the original Hiera model needed for effective music generation.
</span></figcaption>
<div id="S4.T2.63" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:269.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.4pt,4.7pt) scale(0.966583654927237,0.966583654927237) ;">
<table id="S4.T2.63.63" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.4.4.4" class="ltx_tr">
<td id="S4.T2.4.4.4.5" class="ltx_td"></td>
<td id="S4.T2.4.4.4.6" class="ltx_td ltx_align_center" colspan="2">Architecture Details</td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center" colspan="2">
<span id="S4.T2.4.4.4.4.5" class="ltx_text"></span> <span id="S4.T2.4.4.4.4.4" class="ltx_text">
<span id="S4.T2.4.4.4.4.4.4" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.4.4.4.4.4.4.4" class="ltx_tr">
<span id="S4.T2.4.4.4.4.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center">Output Sizes <math id="S4.T2.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T2.1.1.1.1.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.1.1.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.1.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.1.1.1.m1.1c">T</annotation></semantics></math><math id="S4.T2.2.2.2.2.2.2.2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.2.2.2.2.2.2.2.2.m2.1a"><mo id="S4.T2.2.2.2.2.2.2.2.2.m2.1.1" xref="S4.T2.2.2.2.2.2.2.2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.2.2.2.2.m2.1b"><times id="S4.T2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S4.T2.2.2.2.2.2.2.2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.2.2.2.2.m2.1c">\times</annotation></semantics></math><math id="S4.T2.3.3.3.3.3.3.3.3.m3.1" class="ltx_Math" alttext="S^{2}" display="inline"><semantics id="S4.T2.3.3.3.3.3.3.3.3.m3.1a"><msup id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.cmml"><mi id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.2" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.2.cmml">S</mi><mn id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.3" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.3.3.3.3.m3.1b"><apply id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.cmml" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.1.cmml" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1">superscript</csymbol><ci id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.2.cmml" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.2">𝑆</ci><cn type="integer" id="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.3.cmml" xref="S4.T2.3.3.3.3.3.3.3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.3.3.3.3.m3.1c">S^{2}</annotation></semantics></math><math id="S4.T2.4.4.4.4.4.4.4.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.4.4.4.4.4.4.4.4.m4.1a"><mo id="S4.T2.4.4.4.4.4.4.4.4.m4.1.1" xref="S4.T2.4.4.4.4.4.4.4.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.4.4.4.4.m4.1b"><times id="S4.T2.4.4.4.4.4.4.4.4.m4.1.1.cmml" xref="S4.T2.4.4.4.4.4.4.4.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.4.4.4.4.m4.1c">\times</annotation></semantics></math>D</span></span>
</span></span><span id="S4.T2.4.4.4.4.6" class="ltx_text"></span></td>
</tr>
<tr id="S4.T2.63.63.64" class="ltx_tr">
<td id="S4.T2.63.63.64.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Stage</td>
<td id="S4.T2.63.63.64.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="S4.T2.63.63.64.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Ours</td>
<td id="S4.T2.63.63.64.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="S4.T2.63.63.64.5" class="ltx_td ltx_align_center ltx_border_t">Ours</td>
</tr>
<tr id="S4.T2.7.7.7" class="ltx_tr">
<td id="S4.T2.7.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Video Input</td>
<td id="S4.T2.7.7.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">N/A</td>
<td id="S4.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2">96<math id="S4.T2.5.5.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.5.5.5.1.m1.1a"><mo id="S4.T2.5.5.5.1.m1.1.1" xref="S4.T2.5.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.1.m1.1b"><times id="S4.T2.5.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.1.m1.1c">\times</annotation></semantics></math>3<math id="S4.T2.6.6.6.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.6.6.6.2.m2.1a"><mo id="S4.T2.6.6.6.2.m2.1.1" xref="S4.T2.6.6.6.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.2.m2.1b"><times id="S4.T2.6.6.6.2.m2.1.1.cmml" xref="S4.T2.6.6.6.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.2.m2.1c">\times</annotation></semantics></math>224<math id="S4.T2.7.7.7.3.m3.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.7.7.7.3.m3.1a"><msup id="S4.T2.7.7.7.3.m3.1.1" xref="S4.T2.7.7.7.3.m3.1.1.cmml"><mi id="S4.T2.7.7.7.3.m3.1.1a" xref="S4.T2.7.7.7.3.m3.1.1.cmml"></mi><mtext id="S4.T2.7.7.7.3.m3.1.1.1" xref="S4.T2.7.7.7.3.m3.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.3.m3.1b"><apply id="S4.T2.7.7.7.3.m3.1.1.cmml" xref="S4.T2.7.7.7.3.m3.1.1"><ci id="S4.T2.7.7.7.3.m3.1.1.1a.cmml" xref="S4.T2.7.7.7.3.m3.1.1.1"><mtext mathsize="70%" id="S4.T2.7.7.7.3.m3.1.1.1.cmml" xref="S4.T2.7.7.7.3.m3.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.3.m3.1c">{}^{\text{2}}</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.15.15.15" class="ltx_tr">
<td id="S4.T2.15.15.15.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.15.15.15.9.1" class="ltx_text">3D Conv</span></td>
<td id="S4.T2.9.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">3<math id="S4.T2.8.8.8.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.8.8.8.1.m1.1a"><mo id="S4.T2.8.8.8.1.m1.1.1" xref="S4.T2.8.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.1.m1.1b"><times id="S4.T2.8.8.8.1.m1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.1.m1.1c">\times</annotation></semantics></math>7<math id="S4.T2.9.9.9.2.m2.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.9.9.9.2.m2.1a"><msup id="S4.T2.9.9.9.2.m2.1.1" xref="S4.T2.9.9.9.2.m2.1.1.cmml"><mi id="S4.T2.9.9.9.2.m2.1.1a" xref="S4.T2.9.9.9.2.m2.1.1.cmml"></mi><mtext id="S4.T2.9.9.9.2.m2.1.1.1" xref="S4.T2.9.9.9.2.m2.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.2.m2.1b"><apply id="S4.T2.9.9.9.2.m2.1.1.cmml" xref="S4.T2.9.9.9.2.m2.1.1"><ci id="S4.T2.9.9.9.2.m2.1.1.1a.cmml" xref="S4.T2.9.9.9.2.m2.1.1.1"><mtext mathsize="70%" id="S4.T2.9.9.9.2.m2.1.1.1.cmml" xref="S4.T2.9.9.9.2.m2.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.2.m2.1c">{}^{\text{2}}</annotation></semantics></math>
</td>
<td id="S4.T2.12.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.12.12.12.5.3" class="ltx_text">48<math id="S4.T2.10.10.10.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.10.10.10.3.1.m1.1a"><mo id="S4.T2.10.10.10.3.1.m1.1.1" xref="S4.T2.10.10.10.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.3.1.m1.1b"><times id="S4.T2.10.10.10.3.1.m1.1.1.cmml" xref="S4.T2.10.10.10.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.3.1.m1.1c">\times</annotation></semantics></math>56<math id="S4.T2.11.11.11.4.2.m2.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.11.11.11.4.2.m2.1a"><msup id="S4.T2.11.11.11.4.2.m2.1.1" xref="S4.T2.11.11.11.4.2.m2.1.1.cmml"><mi id="S4.T2.11.11.11.4.2.m2.1.1a" xref="S4.T2.11.11.11.4.2.m2.1.1.cmml"></mi><mtext id="S4.T2.11.11.11.4.2.m2.1.1.1" xref="S4.T2.11.11.11.4.2.m2.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.4.2.m2.1b"><apply id="S4.T2.11.11.11.4.2.m2.1.1.cmml" xref="S4.T2.11.11.11.4.2.m2.1.1"><ci id="S4.T2.11.11.11.4.2.m2.1.1.1a.cmml" xref="S4.T2.11.11.11.4.2.m2.1.1.1"><mtext mathsize="70%" id="S4.T2.11.11.11.4.2.m2.1.1.1.cmml" xref="S4.T2.11.11.11.4.2.m2.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.4.2.m2.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.12.12.12.5.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.12.12.12.5.3.m3.1a"><mo id="S4.T2.12.12.12.5.3.m3.1.1" xref="S4.T2.12.12.12.5.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.5.3.m3.1b"><times id="S4.T2.12.12.12.5.3.m3.1.1.cmml" xref="S4.T2.12.12.12.5.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.5.3.m3.1c">\times</annotation></semantics></math>96</span></td>
<td id="S4.T2.15.15.15.8" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S4.T2.15.15.15.8.3" class="ltx_text">48<math id="S4.T2.13.13.13.6.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.13.13.13.6.1.m1.1a"><mo id="S4.T2.13.13.13.6.1.m1.1.1" xref="S4.T2.13.13.13.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.6.1.m1.1b"><times id="S4.T2.13.13.13.6.1.m1.1.1.cmml" xref="S4.T2.13.13.13.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.6.1.m1.1c">\times</annotation></semantics></math>56<math id="S4.T2.14.14.14.7.2.m2.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.14.14.14.7.2.m2.1a"><msup id="S4.T2.14.14.14.7.2.m2.1.1" xref="S4.T2.14.14.14.7.2.m2.1.1.cmml"><mi id="S4.T2.14.14.14.7.2.m2.1.1a" xref="S4.T2.14.14.14.7.2.m2.1.1.cmml"></mi><mtext id="S4.T2.14.14.14.7.2.m2.1.1.1" xref="S4.T2.14.14.14.7.2.m2.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.7.2.m2.1b"><apply id="S4.T2.14.14.14.7.2.m2.1.1.cmml" xref="S4.T2.14.14.14.7.2.m2.1.1"><ci id="S4.T2.14.14.14.7.2.m2.1.1.1a.cmml" xref="S4.T2.14.14.14.7.2.m2.1.1.1"><mtext mathsize="70%" id="S4.T2.14.14.14.7.2.m2.1.1.1.cmml" xref="S4.T2.14.14.14.7.2.m2.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.7.2.m2.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.15.15.15.8.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.15.15.15.8.3.m3.1a"><mo id="S4.T2.15.15.15.8.3.m3.1.1" xref="S4.T2.15.15.15.8.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.8.3.m3.1b"><times id="S4.T2.15.15.15.8.3.m3.1.1.cmml" xref="S4.T2.15.15.15.8.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.8.3.m3.1c">\times</annotation></semantics></math>96</span></td>
</tr>
<tr id="S4.T2.17.17.17" class="ltx_tr">
<td id="S4.T2.17.17.17.2" class="ltx_td ltx_align_center ltx_border_r" colspan="2">stride 2 <math id="S4.T2.16.16.16.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.16.16.16.1.m1.1a"><mo id="S4.T2.16.16.16.1.m1.1.1" xref="S4.T2.16.16.16.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.16.1.m1.1b"><times id="S4.T2.16.16.16.1.m1.1.1.cmml" xref="S4.T2.16.16.16.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.16.1.m1.1c">\times</annotation></semantics></math> 4<math id="S4.T2.17.17.17.2.m2.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.17.17.17.2.m2.1a"><msup id="S4.T2.17.17.17.2.m2.1.1" xref="S4.T2.17.17.17.2.m2.1.1.cmml"><mi id="S4.T2.17.17.17.2.m2.1.1a" xref="S4.T2.17.17.17.2.m2.1.1.cmml"></mi><mtext id="S4.T2.17.17.17.2.m2.1.1.1" xref="S4.T2.17.17.17.2.m2.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.17.2.m2.1b"><apply id="S4.T2.17.17.17.2.m2.1.1.cmml" xref="S4.T2.17.17.17.2.m2.1.1"><ci id="S4.T2.17.17.17.2.m2.1.1.1a.cmml" xref="S4.T2.17.17.17.2.m2.1.1.1"><mtext mathsize="70%" id="S4.T2.17.17.17.2.m2.1.1.1.cmml" xref="S4.T2.17.17.17.2.m2.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.17.2.m2.1c">{}^{\text{2}}</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.19.19.19" class="ltx_tr">
<td id="S4.T2.19.19.19.2" class="ltx_td ltx_align_center ltx_border_r" colspan="2">padding 1<math id="S4.T2.18.18.18.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.18.18.18.1.m1.1a"><mo id="S4.T2.18.18.18.1.m1.1.1" xref="S4.T2.18.18.18.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.18.1.m1.1b"><times id="S4.T2.18.18.18.1.m1.1.1.cmml" xref="S4.T2.18.18.18.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.18.1.m1.1c">\times</annotation></semantics></math> 3<math id="S4.T2.19.19.19.2.m2.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.19.19.19.2.m2.1a"><msup id="S4.T2.19.19.19.2.m2.1.1" xref="S4.T2.19.19.19.2.m2.1.1.cmml"><mi id="S4.T2.19.19.19.2.m2.1.1a" xref="S4.T2.19.19.19.2.m2.1.1.cmml"></mi><mtext id="S4.T2.19.19.19.2.m2.1.1.1" xref="S4.T2.19.19.19.2.m2.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.19.2.m2.1b"><apply id="S4.T2.19.19.19.2.m2.1.1.cmml" xref="S4.T2.19.19.19.2.m2.1.1"><ci id="S4.T2.19.19.19.2.m2.1.1.1a.cmml" xref="S4.T2.19.19.19.2.m2.1.1.1"><mtext mathsize="70%" id="S4.T2.19.19.19.2.m2.1.1.1.cmml" xref="S4.T2.19.19.19.2.m2.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.19.2.m2.1c">{}^{\text{2}}</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.30.30.30" class="ltx_tr">
<td id="S4.T2.20.20.20.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T2.20.20.20.1.2" class="ltx_text"></span> <span id="S4.T2.20.20.20.1.1" class="ltx_text">
<span id="S4.T2.20.20.20.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.20.20.20.1.1.1.2" class="ltx_tr">
<span id="S4.T2.20.20.20.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Pooling Strides</span></span>
<span id="S4.T2.20.20.20.1.1.1.1" class="ltx_tr">
<span id="S4.T2.20.20.20.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">at <math id="S4.T2.20.20.20.1.1.1.1.1.m1.1" class="ltx_Math" alttext="2^{nd}" display="inline"><semantics id="S4.T2.20.20.20.1.1.1.1.1.m1.1a"><msup id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.2" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.2.cmml">2</mn><mrow id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.2" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.1" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.3" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.20.1.1.1.1.1.m1.1b"><apply id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.2">2</cn><apply id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3"><times id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.2">𝑛</ci><ci id="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.20.20.20.1.1.1.1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.20.1.1.1.1.1.m1.1c">2^{nd}</annotation></semantics></math></span></span>
</span></span><span id="S4.T2.20.20.20.1.3" class="ltx_text"></span></td>
<td id="S4.T2.22.22.22.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.21.21.21.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.21.21.21.2.m1.1a"><mo id="S4.T2.21.21.21.2.m1.1.1" xref="S4.T2.21.21.21.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.21.2.m1.1b"><times id="S4.T2.21.21.21.2.m1.1.1.cmml" xref="S4.T2.21.21.21.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.21.2.m1.1c">\times</annotation></semantics></math><span id="S4.T2.22.22.22.3.1" class="ltx_text ltx_font_bold" style="color:#0000FF;">2<math id="S4.T2.22.22.22.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.22.22.22.3.1.m1.1a"><mo mathcolor="#000000" id="S4.T2.22.22.22.3.1.m1.1.1" xref="S4.T2.22.22.22.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.22.3.1.m1.1b"><times id="S4.T2.22.22.22.3.1.m1.1.1.cmml" xref="S4.T2.22.22.22.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.22.3.1.m1.1c">\times</annotation></semantics></math>2</span>
</td>
<td id="S4.T2.24.24.24.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.23.23.23.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.23.23.23.4.m1.1a"><mo id="S4.T2.23.23.23.4.m1.1.1" xref="S4.T2.23.23.23.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.23.23.23.4.m1.1b"><times id="S4.T2.23.23.23.4.m1.1.1.cmml" xref="S4.T2.23.23.23.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.23.23.4.m1.1c">\times</annotation></semantics></math><span id="S4.T2.24.24.24.5.1" class="ltx_text ltx_font_bold" style="color:#FF00FF;">4<math id="S4.T2.24.24.24.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.24.24.24.5.1.m1.1a"><mo mathcolor="#000000" id="S4.T2.24.24.24.5.1.m1.1.1" xref="S4.T2.24.24.24.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.24.24.24.5.1.m1.1b"><times id="S4.T2.24.24.24.5.1.m1.1.1.cmml" xref="S4.T2.24.24.24.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.24.24.5.1.m1.1c">\times</annotation></semantics></math>4</span>
</td>
<td id="S4.T2.27.27.27.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48<math id="S4.T2.25.25.25.6.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.25.25.25.6.m1.1a"><mo id="S4.T2.25.25.25.6.m1.1.1" xref="S4.T2.25.25.25.6.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.25.25.25.6.m1.1b"><times id="S4.T2.25.25.25.6.m1.1.1.cmml" xref="S4.T2.25.25.25.6.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.25.25.6.m1.1c">\times</annotation></semantics></math><span id="S4.T2.27.27.27.8.2" class="ltx_text ltx_font_bold" style="color:#0000FF;">28<math id="S4.T2.26.26.26.7.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.26.26.26.7.1.m1.1a"><msup id="S4.T2.26.26.26.7.1.m1.1.1" xref="S4.T2.26.26.26.7.1.m1.1.1.cmml"><mi id="S4.T2.26.26.26.7.1.m1.1.1a" xref="S4.T2.26.26.26.7.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.26.26.26.7.1.m1.1.1.1" xref="S4.T2.26.26.26.7.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.26.26.26.7.1.m1.1b"><apply id="S4.T2.26.26.26.7.1.m1.1.1.cmml" xref="S4.T2.26.26.26.7.1.m1.1.1"><ci id="S4.T2.26.26.26.7.1.m1.1.1.1a.cmml" xref="S4.T2.26.26.26.7.1.m1.1.1.1"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.T2.26.26.26.7.1.m1.1.1.1.cmml" xref="S4.T2.26.26.26.7.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.26.26.26.7.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.27.27.27.8.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.27.27.27.8.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.27.27.27.8.2.m2.1.1" xref="S4.T2.27.27.27.8.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.27.27.27.8.2.m2.1b"><times id="S4.T2.27.27.27.8.2.m2.1.1.cmml" xref="S4.T2.27.27.27.8.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.27.27.27.8.2.m2.1c">\times</annotation></semantics></math></span>192</td>
<td id="S4.T2.30.30.30.11" class="ltx_td ltx_align_center ltx_border_t">48<math id="S4.T2.28.28.28.9.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.28.28.28.9.m1.1a"><mo id="S4.T2.28.28.28.9.m1.1.1" xref="S4.T2.28.28.28.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.28.28.28.9.m1.1b"><times id="S4.T2.28.28.28.9.m1.1.1.cmml" xref="S4.T2.28.28.28.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.28.28.28.9.m1.1c">\times</annotation></semantics></math><span id="S4.T2.30.30.30.11.2" class="ltx_text ltx_font_bold" style="color:#FF00FF;">14<math id="S4.T2.29.29.29.10.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.29.29.29.10.1.m1.1a"><msup id="S4.T2.29.29.29.10.1.m1.1.1" xref="S4.T2.29.29.29.10.1.m1.1.1.cmml"><mi id="S4.T2.29.29.29.10.1.m1.1.1a" xref="S4.T2.29.29.29.10.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.29.29.29.10.1.m1.1.1.1" xref="S4.T2.29.29.29.10.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.29.29.29.10.1.m1.1b"><apply id="S4.T2.29.29.29.10.1.m1.1.1.cmml" xref="S4.T2.29.29.29.10.1.m1.1.1"><ci id="S4.T2.29.29.29.10.1.m1.1.1.1a.cmml" xref="S4.T2.29.29.29.10.1.m1.1.1.1"><mtext mathcolor="#FF00FF" mathsize="70%" id="S4.T2.29.29.29.10.1.m1.1.1.1.cmml" xref="S4.T2.29.29.29.10.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.29.29.29.10.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.30.30.30.11.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.30.30.30.11.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.30.30.30.11.2.m2.1.1" xref="S4.T2.30.30.30.11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.30.30.30.11.2.m2.1b"><times id="S4.T2.30.30.30.11.2.m2.1.1.cmml" xref="S4.T2.30.30.30.11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.30.30.30.11.2.m2.1c">\times</annotation></semantics></math></span>192</td>
</tr>
<tr id="S4.T2.41.41.41" class="ltx_tr">
<td id="S4.T2.31.31.31.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T2.31.31.31.1.2" class="ltx_text"></span> <span id="S4.T2.31.31.31.1.1" class="ltx_text">
<span id="S4.T2.31.31.31.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.31.31.31.1.1.1.2" class="ltx_tr">
<span id="S4.T2.31.31.31.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Pooling Strides</span></span>
<span id="S4.T2.31.31.31.1.1.1.1" class="ltx_tr">
<span id="S4.T2.31.31.31.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">at <math id="S4.T2.31.31.31.1.1.1.1.1.m1.1" class="ltx_Math" alttext="5^{th}" display="inline"><semantics id="S4.T2.31.31.31.1.1.1.1.1.m1.1a"><msup id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.2" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.2.cmml">5</mn><mrow id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.2" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.1" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.3" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.31.31.31.1.1.1.1.1.m1.1b"><apply id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.2">5</cn><apply id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3"><times id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.31.31.31.1.1.1.1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.31.31.31.1.1.1.1.1.m1.1c">5^{th}</annotation></semantics></math></span></span>
</span></span><span id="S4.T2.31.31.31.1.3" class="ltx_text"></span></td>
<td id="S4.T2.33.33.33.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.32.32.32.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.32.32.32.2.m1.1a"><mo id="S4.T2.32.32.32.2.m1.1.1" xref="S4.T2.32.32.32.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.32.32.32.2.m1.1b"><times id="S4.T2.32.32.32.2.m1.1.1.cmml" xref="S4.T2.32.32.32.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.32.32.32.2.m1.1c">\times</annotation></semantics></math><span id="S4.T2.33.33.33.3.1" class="ltx_text ltx_font_bold" style="color:#0000FF;">2<math id="S4.T2.33.33.33.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.33.33.33.3.1.m1.1a"><mo mathcolor="#000000" id="S4.T2.33.33.33.3.1.m1.1.1" xref="S4.T2.33.33.33.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.33.33.33.3.1.m1.1b"><times id="S4.T2.33.33.33.3.1.m1.1.1.cmml" xref="S4.T2.33.33.33.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.33.33.33.3.1.m1.1c">\times</annotation></semantics></math>2</span>
</td>
<td id="S4.T2.35.35.35.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.34.34.34.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.34.34.34.4.m1.1a"><mo id="S4.T2.34.34.34.4.m1.1.1" xref="S4.T2.34.34.34.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.34.34.34.4.m1.1b"><times id="S4.T2.34.34.34.4.m1.1.1.cmml" xref="S4.T2.34.34.34.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.34.34.34.4.m1.1c">\times</annotation></semantics></math><span id="S4.T2.35.35.35.5.1" class="ltx_text ltx_font_bold" style="color:#FF00FF;">7<math id="S4.T2.35.35.35.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.35.35.35.5.1.m1.1a"><mo mathcolor="#000000" id="S4.T2.35.35.35.5.1.m1.1.1" xref="S4.T2.35.35.35.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.35.35.35.5.1.m1.1b"><times id="S4.T2.35.35.35.5.1.m1.1.1.cmml" xref="S4.T2.35.35.35.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.35.35.35.5.1.m1.1c">\times</annotation></semantics></math>7</span>
</td>
<td id="S4.T2.38.38.38.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48<math id="S4.T2.36.36.36.6.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.36.36.36.6.m1.1a"><mo id="S4.T2.36.36.36.6.m1.1.1" xref="S4.T2.36.36.36.6.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.36.36.36.6.m1.1b"><times id="S4.T2.36.36.36.6.m1.1.1.cmml" xref="S4.T2.36.36.36.6.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.36.36.36.6.m1.1c">\times</annotation></semantics></math><span id="S4.T2.38.38.38.8.2" class="ltx_text ltx_font_bold" style="color:#0000FF;">14<math id="S4.T2.37.37.37.7.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.37.37.37.7.1.m1.1a"><msup id="S4.T2.37.37.37.7.1.m1.1.1" xref="S4.T2.37.37.37.7.1.m1.1.1.cmml"><mi id="S4.T2.37.37.37.7.1.m1.1.1a" xref="S4.T2.37.37.37.7.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.37.37.37.7.1.m1.1.1.1" xref="S4.T2.37.37.37.7.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.37.37.37.7.1.m1.1b"><apply id="S4.T2.37.37.37.7.1.m1.1.1.cmml" xref="S4.T2.37.37.37.7.1.m1.1.1"><ci id="S4.T2.37.37.37.7.1.m1.1.1.1a.cmml" xref="S4.T2.37.37.37.7.1.m1.1.1.1"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.T2.37.37.37.7.1.m1.1.1.1.cmml" xref="S4.T2.37.37.37.7.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.37.37.37.7.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.38.38.38.8.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.38.38.38.8.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.38.38.38.8.2.m2.1.1" xref="S4.T2.38.38.38.8.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.38.38.38.8.2.m2.1b"><times id="S4.T2.38.38.38.8.2.m2.1.1.cmml" xref="S4.T2.38.38.38.8.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.38.38.38.8.2.m2.1c">\times</annotation></semantics></math></span>384</td>
<td id="S4.T2.41.41.41.11" class="ltx_td ltx_align_center ltx_border_t">48<math id="S4.T2.39.39.39.9.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.39.39.39.9.m1.1a"><mo id="S4.T2.39.39.39.9.m1.1.1" xref="S4.T2.39.39.39.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.39.39.39.9.m1.1b"><times id="S4.T2.39.39.39.9.m1.1.1.cmml" xref="S4.T2.39.39.39.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.39.39.39.9.m1.1c">\times</annotation></semantics></math><span id="S4.T2.41.41.41.11.2" class="ltx_text ltx_font_bold" style="color:#FF00FF;">2<math id="S4.T2.40.40.40.10.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.40.40.40.10.1.m1.1a"><msup id="S4.T2.40.40.40.10.1.m1.1.1" xref="S4.T2.40.40.40.10.1.m1.1.1.cmml"><mi id="S4.T2.40.40.40.10.1.m1.1.1a" xref="S4.T2.40.40.40.10.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.40.40.40.10.1.m1.1.1.1" xref="S4.T2.40.40.40.10.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.40.40.40.10.1.m1.1b"><apply id="S4.T2.40.40.40.10.1.m1.1.1.cmml" xref="S4.T2.40.40.40.10.1.m1.1.1"><ci id="S4.T2.40.40.40.10.1.m1.1.1.1a.cmml" xref="S4.T2.40.40.40.10.1.m1.1.1.1"><mtext mathcolor="#FF00FF" mathsize="70%" id="S4.T2.40.40.40.10.1.m1.1.1.1.cmml" xref="S4.T2.40.40.40.10.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.40.40.40.10.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.41.41.41.11.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.41.41.41.11.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.41.41.41.11.2.m2.1.1" xref="S4.T2.41.41.41.11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.41.41.41.11.2.m2.1b"><times id="S4.T2.41.41.41.11.2.m2.1.1.cmml" xref="S4.T2.41.41.41.11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.41.41.41.11.2.m2.1c">\times</annotation></semantics></math></span>384</td>
</tr>
<tr id="S4.T2.52.52.52" class="ltx_tr">
<td id="S4.T2.42.42.42.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T2.42.42.42.1.2" class="ltx_text"></span> <span id="S4.T2.42.42.42.1.1" class="ltx_text">
<span id="S4.T2.42.42.42.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.42.42.42.1.1.1.2" class="ltx_tr">
<span id="S4.T2.42.42.42.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Pooling Strides</span></span>
<span id="S4.T2.42.42.42.1.1.1.1" class="ltx_tr">
<span id="S4.T2.42.42.42.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">at <math id="S4.T2.42.42.42.1.1.1.1.1.m1.1" class="ltx_Math" alttext="21^{st}" display="inline"><semantics id="S4.T2.42.42.42.1.1.1.1.1.m1.1a"><msup id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.2" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.2.cmml">21</mn><mrow id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.2" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.1" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.3" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.42.42.42.1.1.1.1.1.m1.1b"><apply id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.2">21</cn><apply id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3"><times id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.42.42.42.1.1.1.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.42.42.42.1.1.1.1.1.m1.1c">21^{st}</annotation></semantics></math></span></span>
</span></span><span id="S4.T2.42.42.42.1.3" class="ltx_text"></span></td>
<td id="S4.T2.44.44.44.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.43.43.43.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.43.43.43.2.m1.1a"><mo id="S4.T2.43.43.43.2.m1.1.1" xref="S4.T2.43.43.43.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.43.43.43.2.m1.1b"><times id="S4.T2.43.43.43.2.m1.1.1.cmml" xref="S4.T2.43.43.43.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.43.43.43.2.m1.1c">\times</annotation></semantics></math>2<math id="S4.T2.44.44.44.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.44.44.44.3.m2.1a"><mo id="S4.T2.44.44.44.3.m2.1.1" xref="S4.T2.44.44.44.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.44.44.44.3.m2.1b"><times id="S4.T2.44.44.44.3.m2.1.1.cmml" xref="S4.T2.44.44.44.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.44.44.44.3.m2.1c">\times</annotation></semantics></math>2</td>
<td id="S4.T2.46.46.46.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1<math id="S4.T2.45.45.45.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.45.45.45.4.m1.1a"><mo id="S4.T2.45.45.45.4.m1.1.1" xref="S4.T2.45.45.45.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.45.45.45.4.m1.1b"><times id="S4.T2.45.45.45.4.m1.1.1.cmml" xref="S4.T2.45.45.45.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.45.45.45.4.m1.1c">\times</annotation></semantics></math>2<math id="S4.T2.46.46.46.5.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.46.46.46.5.m2.1a"><mo id="S4.T2.46.46.46.5.m2.1.1" xref="S4.T2.46.46.46.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.46.46.46.5.m2.1b"><times id="S4.T2.46.46.46.5.m2.1.1.cmml" xref="S4.T2.46.46.46.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.46.46.46.5.m2.1c">\times</annotation></semantics></math>2</td>
<td id="S4.T2.49.49.49.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48<math id="S4.T2.47.47.47.6.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.47.47.47.6.m1.1a"><mo id="S4.T2.47.47.47.6.m1.1.1" xref="S4.T2.47.47.47.6.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.47.47.47.6.m1.1b"><times id="S4.T2.47.47.47.6.m1.1.1.cmml" xref="S4.T2.47.47.47.6.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.47.47.47.6.m1.1c">\times</annotation></semantics></math><span id="S4.T2.49.49.49.8.2" class="ltx_text ltx_font_bold" style="color:#0000FF;">7<math id="S4.T2.48.48.48.7.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.48.48.48.7.1.m1.1a"><msup id="S4.T2.48.48.48.7.1.m1.1.1" xref="S4.T2.48.48.48.7.1.m1.1.1.cmml"><mi id="S4.T2.48.48.48.7.1.m1.1.1a" xref="S4.T2.48.48.48.7.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.48.48.48.7.1.m1.1.1.1" xref="S4.T2.48.48.48.7.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.48.48.48.7.1.m1.1b"><apply id="S4.T2.48.48.48.7.1.m1.1.1.cmml" xref="S4.T2.48.48.48.7.1.m1.1.1"><ci id="S4.T2.48.48.48.7.1.m1.1.1.1a.cmml" xref="S4.T2.48.48.48.7.1.m1.1.1.1"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.T2.48.48.48.7.1.m1.1.1.1.cmml" xref="S4.T2.48.48.48.7.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.48.48.48.7.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.49.49.49.8.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.49.49.49.8.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.49.49.49.8.2.m2.1.1" xref="S4.T2.49.49.49.8.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.49.49.49.8.2.m2.1b"><times id="S4.T2.49.49.49.8.2.m2.1.1.cmml" xref="S4.T2.49.49.49.8.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.49.49.49.8.2.m2.1c">\times</annotation></semantics></math></span>768</td>
<td id="S4.T2.52.52.52.11" class="ltx_td ltx_align_center ltx_border_t">48<math id="S4.T2.50.50.50.9.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.50.50.50.9.m1.1a"><mo id="S4.T2.50.50.50.9.m1.1.1" xref="S4.T2.50.50.50.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.50.50.50.9.m1.1b"><times id="S4.T2.50.50.50.9.m1.1.1.cmml" xref="S4.T2.50.50.50.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.50.50.50.9.m1.1c">\times</annotation></semantics></math><span id="S4.T2.52.52.52.11.2" class="ltx_text ltx_font_bold" style="color:#FF00FF;">1<math id="S4.T2.51.51.51.10.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.51.51.51.10.1.m1.1a"><msup id="S4.T2.51.51.51.10.1.m1.1.1" xref="S4.T2.51.51.51.10.1.m1.1.1.cmml"><mi id="S4.T2.51.51.51.10.1.m1.1.1a" xref="S4.T2.51.51.51.10.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.51.51.51.10.1.m1.1.1.1" xref="S4.T2.51.51.51.10.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.51.51.51.10.1.m1.1b"><apply id="S4.T2.51.51.51.10.1.m1.1.1.cmml" xref="S4.T2.51.51.51.10.1.m1.1.1"><ci id="S4.T2.51.51.51.10.1.m1.1.1.1a.cmml" xref="S4.T2.51.51.51.10.1.m1.1.1.1"><mtext mathcolor="#FF00FF" mathsize="70%" id="S4.T2.51.51.51.10.1.m1.1.1.1.cmml" xref="S4.T2.51.51.51.10.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.51.51.51.10.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.52.52.52.11.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.52.52.52.11.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.52.52.52.11.2.m2.1.1" xref="S4.T2.52.52.52.11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.52.52.52.11.2.m2.1b"><times id="S4.T2.52.52.52.11.2.m2.1.1.cmml" xref="S4.T2.52.52.52.11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.52.52.52.11.2.m2.1c">\times</annotation></semantics></math></span>768</td>
</tr>
<tr id="S4.T2.63.63.63" class="ltx_tr">
<td id="S4.T2.53.53.53.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">
<span id="S4.T2.53.53.53.1.2" class="ltx_text"></span> <span id="S4.T2.53.53.53.1.1" class="ltx_text">
<span id="S4.T2.53.53.53.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.53.53.53.1.1.1.2" class="ltx_tr">
<span id="S4.T2.53.53.53.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Pooling Strides</span></span>
<span id="S4.T2.53.53.53.1.1.1.1" class="ltx_tr">
<span id="S4.T2.53.53.53.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">at <math id="S4.T2.53.53.53.1.1.1.1.1.m1.1" class="ltx_Math" alttext="24^{th}" display="inline"><semantics id="S4.T2.53.53.53.1.1.1.1.1.m1.1a"><msup id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.2" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.2.cmml">24</mn><mrow id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.2" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.1" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.3" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.53.53.53.1.1.1.1.1.m1.1b"><apply id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.2">24</cn><apply id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3"><times id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.53.53.53.1.1.1.1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.53.53.53.1.1.1.1.1.m1.1c">24^{th}</annotation></semantics></math></span></span>
</span></span><span id="S4.T2.53.53.53.1.3" class="ltx_text"></span></td>
<td id="S4.T2.55.55.55.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">1<math id="S4.T2.54.54.54.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.54.54.54.2.m1.1a"><mo id="S4.T2.54.54.54.2.m1.1.1" xref="S4.T2.54.54.54.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.54.54.54.2.m1.1b"><times id="S4.T2.54.54.54.2.m1.1.1.cmml" xref="S4.T2.54.54.54.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.54.54.54.2.m1.1c">\times</annotation></semantics></math>1<math id="S4.T2.55.55.55.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.55.55.55.3.m2.1a"><mo id="S4.T2.55.55.55.3.m2.1.1" xref="S4.T2.55.55.55.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.55.55.55.3.m2.1b"><times id="S4.T2.55.55.55.3.m2.1.1.cmml" xref="S4.T2.55.55.55.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.55.55.55.3.m2.1c">\times</annotation></semantics></math>1</td>
<td id="S4.T2.57.57.57.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">1<math id="S4.T2.56.56.56.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.56.56.56.4.m1.1a"><mo id="S4.T2.56.56.56.4.m1.1.1" xref="S4.T2.56.56.56.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.56.56.56.4.m1.1b"><times id="S4.T2.56.56.56.4.m1.1.1.cmml" xref="S4.T2.56.56.56.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.56.56.56.4.m1.1c">\times</annotation></semantics></math>1<math id="S4.T2.57.57.57.5.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.57.57.57.5.m2.1a"><mo id="S4.T2.57.57.57.5.m2.1.1" xref="S4.T2.57.57.57.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.57.57.57.5.m2.1b"><times id="S4.T2.57.57.57.5.m2.1.1.cmml" xref="S4.T2.57.57.57.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.57.57.57.5.m2.1c">\times</annotation></semantics></math>1</td>
<td id="S4.T2.60.60.60.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">48<math id="S4.T2.58.58.58.6.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.58.58.58.6.m1.1a"><mo id="S4.T2.58.58.58.6.m1.1.1" xref="S4.T2.58.58.58.6.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.58.58.58.6.m1.1b"><times id="S4.T2.58.58.58.6.m1.1.1.cmml" xref="S4.T2.58.58.58.6.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.58.58.58.6.m1.1c">\times</annotation></semantics></math><span id="S4.T2.60.60.60.8.2" class="ltx_text ltx_font_bold" style="color:#0000FF;">7<math id="S4.T2.59.59.59.7.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.59.59.59.7.1.m1.1a"><msup id="S4.T2.59.59.59.7.1.m1.1.1" xref="S4.T2.59.59.59.7.1.m1.1.1.cmml"><mi id="S4.T2.59.59.59.7.1.m1.1.1a" xref="S4.T2.59.59.59.7.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.59.59.59.7.1.m1.1.1.1" xref="S4.T2.59.59.59.7.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.59.59.59.7.1.m1.1b"><apply id="S4.T2.59.59.59.7.1.m1.1.1.cmml" xref="S4.T2.59.59.59.7.1.m1.1.1"><ci id="S4.T2.59.59.59.7.1.m1.1.1.1a.cmml" xref="S4.T2.59.59.59.7.1.m1.1.1.1"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.T2.59.59.59.7.1.m1.1.1.1.cmml" xref="S4.T2.59.59.59.7.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.59.59.59.7.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.60.60.60.8.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.60.60.60.8.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.60.60.60.8.2.m2.1.1" xref="S4.T2.60.60.60.8.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.60.60.60.8.2.m2.1b"><times id="S4.T2.60.60.60.8.2.m2.1.1.cmml" xref="S4.T2.60.60.60.8.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.60.60.60.8.2.m2.1c">\times</annotation></semantics></math></span>768</td>
<td id="S4.T2.63.63.63.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">48<math id="S4.T2.61.61.61.9.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.61.61.61.9.m1.1a"><mo id="S4.T2.61.61.61.9.m1.1.1" xref="S4.T2.61.61.61.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.61.61.61.9.m1.1b"><times id="S4.T2.61.61.61.9.m1.1.1.cmml" xref="S4.T2.61.61.61.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.61.61.61.9.m1.1c">\times</annotation></semantics></math><span id="S4.T2.63.63.63.11.2" class="ltx_text ltx_font_bold" style="color:#FF00FF;">1<math id="S4.T2.62.62.62.10.1.m1.1" class="ltx_Math" alttext="{}^{\text{2}}" display="inline"><semantics id="S4.T2.62.62.62.10.1.m1.1a"><msup id="S4.T2.62.62.62.10.1.m1.1.1" xref="S4.T2.62.62.62.10.1.m1.1.1.cmml"><mi id="S4.T2.62.62.62.10.1.m1.1.1a" xref="S4.T2.62.62.62.10.1.m1.1.1.cmml"></mi><mtext mathcolor="#000000" id="S4.T2.62.62.62.10.1.m1.1.1.1" xref="S4.T2.62.62.62.10.1.m1.1.1.1a.cmml">2</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.T2.62.62.62.10.1.m1.1b"><apply id="S4.T2.62.62.62.10.1.m1.1.1.cmml" xref="S4.T2.62.62.62.10.1.m1.1.1"><ci id="S4.T2.62.62.62.10.1.m1.1.1.1a.cmml" xref="S4.T2.62.62.62.10.1.m1.1.1.1"><mtext mathcolor="#FF00FF" mathsize="70%" id="S4.T2.62.62.62.10.1.m1.1.1.1.cmml" xref="S4.T2.62.62.62.10.1.m1.1.1.1">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.62.62.62.10.1.m1.1c">{}^{\text{2}}</annotation></semantics></math><math id="S4.T2.63.63.63.11.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.63.63.63.11.2.m2.1a"><mo mathcolor="#000000" id="S4.T2.63.63.63.11.2.m2.1.1" xref="S4.T2.63.63.63.11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.63.63.63.11.2.m2.1b"><times id="S4.T2.63.63.63.11.2.m2.1.1.cmml" xref="S4.T2.63.63.63.11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.63.63.63.11.2.m2.1c">\times</annotation></semantics></math></span>768</td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Efficient Video Encoder</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Given an input video <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{V}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathbf{V}</annotation></semantics></math>, we aim to compute a video representation that could be used for video-to-music generation.
Building on the developments in the video recognition domain, we use Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which demonstrated strong results on various video recognition tasks.
While the original Hiera model was designed to operate on sparsely sampled video frames for coarse video recognition tasks, video-to-music generation requires fine-grained temporal information for accurate video-music alignment in time, such as matching music beats with the active motions in the video. To enable this capability, we modify the original Hiera architecture to allow it to efficiently process videos consisting of a much larger number of frames (i.e., 96) sampled at a high FPS rate (i.e., 9.6). </p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.11" class="ltx_p">Specifically, as depicted in Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Audio and Video Inputs ‣ 4 Technical Approach ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we first use a 3D convolution with a <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="[3\times 7\times 7]" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.1.cmml">[</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.3.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.1.1.1a" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.1.1.4" xref="S4.SS2.p2.1.m1.1.1.1.1.4.cmml">7</mn></mrow><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.2">3</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.3">7</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.1.1.4.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.4">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">[3\times 7\times 7]</annotation></semantics></math> kernel and a <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="[2\times 4\times 4]" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.1.cmml">[</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.3.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1.1.1a" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.1.1.4" xref="S4.SS2.p2.2.m2.1.1.1.1.4.cmml">4</mn></mrow><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2">2</cn><cn type="integer" id="S4.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.3">4</cn><cn type="integer" id="S4.SS2.p2.2.m2.1.1.1.1.4.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.4">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">[2\times 4\times 4]</annotation></semantics></math> patch stride to obtain the visual tokens.
Afterward, the original Hiera model performs three spatial downsampling operations, denoted as Q-Pooling, after the following transformer blocks: <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="2^{nd}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">2</mn><mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.3.1" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">2</cn><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><times id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">2^{nd}</annotation></semantics></math>, <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="5^{th}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msup id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">5</mn><mrow id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">5</cn><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><times id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3.1"></times><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">𝑡</ci><ci id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">5^{th}</annotation></semantics></math>, and <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="21^{st}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msup id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mn id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">21</mn><mrow id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">21</cn><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><times id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3.1"></times><ci id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">𝑠</ci><ci id="S4.SS2.p2.5.m5.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">21^{st}</annotation></semantics></math>.
To improve the efficiency of processing many frames sampled at high FPS, we increase the spatial downsampling rate of the first and second Q-Pooling layers from 2 to 4 and 2 to 7, respectively. This leads to feature tensors with a significantly reduced spatial resolution of <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mn id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><times id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></times><cn type="integer" id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">2</cn><cn type="integer" id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">2\times 2</annotation></semantics></math> in the third stage and <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mn id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><times id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1"></times><cn type="integer" id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">1</cn><cn type="integer" id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">1\times 1</annotation></semantics></math> in the final stage (assuming a <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mrow id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mn id="S4.SS2.p2.8.m8.1.1.2" xref="S4.SS2.p2.8.m8.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.8.m8.1.1.1" xref="S4.SS2.p2.8.m8.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.8.m8.1.1.3" xref="S4.SS2.p2.8.m8.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><times id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1"></times><cn type="integer" id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2">224</cn><cn type="integer" id="S4.SS2.p2.8.m8.1.1.3.cmml" xref="S4.SS2.p2.8.m8.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">224\times 224</annotation></semantics></math> input size).
We then directly obtain the final video representations <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{X}_{v}\in\mathbb{R}^{t_{v}/2\times d}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mrow id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><msub id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2.2" xref="S4.SS2.p2.9.m9.1.1.2.2.cmml">𝐗</mi><mi id="S4.SS2.p2.9.m9.1.1.2.3" xref="S4.SS2.p2.9.m9.1.1.2.3.cmml">v</mi></msub><mo id="S4.SS2.p2.9.m9.1.1.1" xref="S4.SS2.p2.9.m9.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.2" xref="S4.SS2.p2.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.9.m9.1.1.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.cmml"><mrow id="S4.SS2.p2.9.m9.1.1.3.3.2" xref="S4.SS2.p2.9.m9.1.1.3.3.2.cmml"><msub id="S4.SS2.p2.9.m9.1.1.3.3.2.2" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.3.2.2.2" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2.2.cmml">t</mi><mi id="S4.SS2.p2.9.m9.1.1.3.3.2.2.3" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2.3.cmml">v</mi></msub><mo id="S4.SS2.p2.9.m9.1.1.3.3.2.1" xref="S4.SS2.p2.9.m9.1.1.3.3.2.1.cmml">/</mo><mn id="S4.SS2.p2.9.m9.1.1.3.3.2.3" xref="S4.SS2.p2.9.m9.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.9.m9.1.1.3.3.1" xref="S4.SS2.p2.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p2.9.m9.1.1.3.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><in id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1.1"></in><apply id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.2.1.cmml" xref="S4.SS2.p2.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2.2">𝐗</ci><ci id="S4.SS2.p2.9.m9.1.1.2.3.cmml" xref="S4.SS2.p2.9.m9.1.1.2.3">𝑣</ci></apply><apply id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.9.m9.1.1.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3"><times id="S4.SS2.p2.9.m9.1.1.3.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.1"></times><apply id="S4.SS2.p2.9.m9.1.1.3.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2"><divide id="S4.SS2.p2.9.m9.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.1"></divide><apply id="S4.SS2.p2.9.m9.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.3.3.2.2.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.3.3.2.2.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2.2">𝑡</ci><ci id="S4.SS2.p2.9.m9.1.1.3.3.2.2.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.2.3">𝑣</ci></apply><cn type="integer" id="S4.SS2.p2.9.m9.1.1.3.3.2.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2.3">2</cn></apply><ci id="S4.SS2.p2.9.m9.1.1.3.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\mathbf{X}_{v}\in\mathbb{R}^{t_{v}/2\times d}</annotation></semantics></math>, where <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><msub id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml"><mi id="S4.SS2.p2.10.m10.1.1.2" xref="S4.SS2.p2.10.m10.1.1.2.cmml">t</mi><mi id="S4.SS2.p2.10.m10.1.1.3" xref="S4.SS2.p2.10.m10.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><apply id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.1.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m10.1.1.2.cmml" xref="S4.SS2.p2.10.m10.1.1.2">𝑡</ci><ci id="S4.SS2.p2.10.m10.1.1.3.cmml" xref="S4.SS2.p2.10.m10.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">t_{v}</annotation></semantics></math> and <math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mi id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><ci id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">d</annotation></semantics></math> represents the number of video frames and a channel dimension, respectively. These simple architecture modifications (see Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Audio and Video Inputs ‣ 4 Technical Approach ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) allow our video encoder to maintain high temporal resolution to capture fine-grained temporal video cues.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Autoregressive Music Generation</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p">We now describe our autoregressive music decoder that uses the video features <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\textbf{X}_{v}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2a.cmml">X</mtext><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2a.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">X</mtext></ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\textbf{X}_{v}</annotation></semantics></math> and quantized music tokens <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{X}^{(0)}_{a}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msubsup id="S4.SS3.p1.2.m2.1.2" xref="S4.SS3.p1.2.m2.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.2.2.2" xref="S4.SS3.p1.2.m2.1.2.2.2.cmml">𝐗</mi><mi id="S4.SS3.p1.2.m2.1.2.3" xref="S4.SS3.p1.2.m2.1.2.3.cmml">a</mi><mrow id="S4.SS3.p1.2.m2.1.1.1.3" xref="S4.SS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.1" xref="S4.SS3.p1.2.m2.1.2.cmml">(</mo><mn id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.2" xref="S4.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.2.cmml" xref="S4.SS3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2">subscript</csymbol><apply id="S4.SS3.p1.2.m2.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.2.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.2.2.2.cmml" xref="S4.SS3.p1.2.m2.1.2.2.2">𝐗</ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1">0</cn></apply><ci id="S4.SS3.p1.2.m2.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.2.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathbf{X}^{(0)}_{a}</annotation></semantics></math> for music generation. Specifically, as our autoregressive music decoder, we adopt a standard transformer architecture with <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">L</annotation></semantics></math> layers of alternating multi-head and causal attention blocks.
We feed the previously computed video features <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{X}_{v}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">𝐗</mi><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝐗</ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mathbf{X}_{v}</annotation></semantics></math> into every multi-head attention as contextual features for autoregressive music generation.
The operations in our decoder can be written as:</p>
<table id="S4.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{F}^{(\ell)}" display="inline"><semantics id="S4.E1X.2.1.1.m1.1a"><msup id="S4.E1X.2.1.1.m1.1.2" xref="S4.E1X.2.1.1.m1.1.2.cmml"><mi id="S4.E1X.2.1.1.m1.1.2.2" xref="S4.E1X.2.1.1.m1.1.2.2.cmml">𝐅</mi><mrow id="S4.E1X.2.1.1.m1.1.1.1.3" xref="S4.E1X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.E1X.2.1.1.m1.1.1.1.3.1" xref="S4.E1X.2.1.1.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.E1X.2.1.1.m1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.E1X.2.1.1.m1.1.1.1.3.2" xref="S4.E1X.2.1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.E1X.2.1.1.m1.1b"><apply id="S4.E1X.2.1.1.m1.1.2.cmml" xref="S4.E1X.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.E1X.2.1.1.m1.1.2.1.cmml" xref="S4.E1X.2.1.1.m1.1.2">superscript</csymbol><ci id="S4.E1X.2.1.1.m1.1.2.2.cmml" xref="S4.E1X.2.1.1.m1.1.2.2">𝐅</ci><ci id="S4.E1X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1X.2.1.1.m1.1c">\displaystyle\mathbf{F}^{(\ell)}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E1X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=\mathrm{CA}(\mathbf{X}_{a}^{(\ell-1)},\mathbf{X}_{a}^{(\ell-1)},\mathbf{X}_{a}^{(\ell-1)})+\mathbf{X}_{a}^{(\ell-1)}," display="inline"><semantics id="S4.E1X.3.2.2.m1.5a"><mrow id="S4.E1X.3.2.2.m1.5.5.1" xref="S4.E1X.3.2.2.m1.5.5.1.1.cmml"><mrow id="S4.E1X.3.2.2.m1.5.5.1.1" xref="S4.E1X.3.2.2.m1.5.5.1.1.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.5" xref="S4.E1X.3.2.2.m1.5.5.1.1.5.cmml"></mi><mo id="S4.E1X.3.2.2.m1.5.5.1.1.4" xref="S4.E1X.3.2.2.m1.5.5.1.1.4.cmml">=</mo><mrow id="S4.E1X.3.2.2.m1.5.5.1.1.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.cmml"><mrow id="S4.E1X.3.2.2.m1.5.5.1.1.3.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.5" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.5.cmml">CA</mi><mo lspace="0em" rspace="0em" id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.4" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.4.cmml">​</mo><mrow id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml"><mo stretchy="false" id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.4" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml">(</mo><msubsup id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mi id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">a</mi><mrow id="S4.E1X.3.2.2.m1.1.1.1.1" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1X.3.2.2.m1.1.1.1.1.2" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1X.3.2.2.m1.1.1.1.1.1" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E1X.3.2.2.m1.1.1.1.1.1.2" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.2.cmml">ℓ</mi><mo id="S4.E1X.3.2.2.m1.1.1.1.1.1.1" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E1X.3.2.2.m1.1.1.1.1.1.3" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E1X.3.2.2.m1.1.1.1.1.3" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.5" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml">,</mo><msubsup id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.3.cmml">a</mi><mrow id="S4.E1X.3.2.2.m1.2.2.1.1" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E1X.3.2.2.m1.2.2.1.1.2" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E1X.3.2.2.m1.2.2.1.1.1" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S4.E1X.3.2.2.m1.2.2.1.1.1.2" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.2.cmml">ℓ</mi><mo id="S4.E1X.3.2.2.m1.2.2.1.1.1.1" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E1X.3.2.2.m1.2.2.1.1.1.3" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E1X.3.2.2.m1.2.2.1.1.3" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.6" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml">,</mo><msubsup id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.2.cmml">𝐗</mi><mi id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.3.cmml">a</mi><mrow id="S4.E1X.3.2.2.m1.3.3.1.1" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.E1X.3.2.2.m1.3.3.1.1.2" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E1X.3.2.2.m1.3.3.1.1.1" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S4.E1X.3.2.2.m1.3.3.1.1.1.2" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">ℓ</mi><mo id="S4.E1X.3.2.2.m1.3.3.1.1.1.1" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E1X.3.2.2.m1.3.3.1.1.1.3" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E1X.3.2.2.m1.3.3.1.1.3" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.7" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E1X.3.2.2.m1.5.5.1.1.3.4" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.4.cmml">+</mo><msubsup id="S4.E1X.3.2.2.m1.5.5.1.1.3.5" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5.cmml"><mi id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.2.cmml">𝐗</mi><mi id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.3" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.3.cmml">a</mi><mrow id="S4.E1X.3.2.2.m1.4.4.1.1" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S4.E1X.3.2.2.m1.4.4.1.1.2" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.cmml">(</mo><mrow id="S4.E1X.3.2.2.m1.4.4.1.1.1" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.cmml"><mi mathvariant="normal" id="S4.E1X.3.2.2.m1.4.4.1.1.1.2" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.2.cmml">ℓ</mi><mo id="S4.E1X.3.2.2.m1.4.4.1.1.1.1" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S4.E1X.3.2.2.m1.4.4.1.1.1.3" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E1X.3.2.2.m1.4.4.1.1.3" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.E1X.3.2.2.m1.5.5.1.2" xref="S4.E1X.3.2.2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1X.3.2.2.m1.5b"><apply id="S4.E1X.3.2.2.m1.5.5.1.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1"><eq id="S4.E1X.3.2.2.m1.5.5.1.1.4.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.4"></eq><csymbol cd="latexml" id="S4.E1X.3.2.2.m1.5.5.1.1.5.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.5">absent</csymbol><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3"><plus id="S4.E1X.3.2.2.m1.5.5.1.1.3.4.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.4"></plus><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3"><times id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.4.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.4"></times><ci id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.5.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.5">CA</ci><vector id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.4.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3"><apply id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.2">𝐗</ci><ci id="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S4.E1X.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.1.1.1.1"><minus id="S4.E1X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.1"></minus><ci id="S4.E1X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.2">ℓ</ci><cn type="integer" id="S4.E1X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E1X.3.2.2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2">superscript</csymbol><apply id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.2">𝐗</ci><ci id="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.2.3">𝑎</ci></apply><apply id="S4.E1X.3.2.2.m1.2.2.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.2.2.1.1"><minus id="S4.E1X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.1"></minus><ci id="S4.E1X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.2">ℓ</ci><cn type="integer" id="S4.E1X.3.2.2.m1.2.2.1.1.1.3.cmml" xref="S4.E1X.3.2.2.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3">superscript</csymbol><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3">subscript</csymbol><ci id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.2">𝐗</ci><ci id="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.3.3.3.3.2.3">𝑎</ci></apply><apply id="S4.E1X.3.2.2.m1.3.3.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.3.3.1.1"><minus id="S4.E1X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.1"></minus><ci id="S4.E1X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.2">ℓ</ci><cn type="integer" id="S4.E1X.3.2.2.m1.3.3.1.1.1.3.cmml" xref="S4.E1X.3.2.2.m1.3.3.1.1.1.3">1</cn></apply></apply></vector></apply><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5">superscript</csymbol><apply id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5"><csymbol cd="ambiguous" id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.1.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5">subscript</csymbol><ci id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.2.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.2">𝐗</ci><ci id="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.3.cmml" xref="S4.E1X.3.2.2.m1.5.5.1.1.3.5.2.3">𝑎</ci></apply><apply id="S4.E1X.3.2.2.m1.4.4.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.4.4.1.1"><minus id="S4.E1X.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.1"></minus><ci id="S4.E1X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.2">ℓ</ci><cn type="integer" id="S4.E1X.3.2.2.m1.4.4.1.1.1.3.cmml" xref="S4.E1X.3.2.2.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1X.3.2.2.m1.5c">\displaystyle=\mathrm{CA}(\mathbf{X}_{a}^{(\ell-1)},\mathbf{X}_{a}^{(\ell-1)},\mathbf{X}_{a}^{(\ell-1)})+\mathbf{X}_{a}^{(\ell-1)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S4.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{X}_{a}^{(\ell)}" display="inline"><semantics id="S4.E1Xa.2.1.1.m1.1a"><msubsup id="S4.E1Xa.2.1.1.m1.1.2" xref="S4.E1Xa.2.1.1.m1.1.2.cmml"><mi id="S4.E1Xa.2.1.1.m1.1.2.2.2" xref="S4.E1Xa.2.1.1.m1.1.2.2.2.cmml">𝐗</mi><mi id="S4.E1Xa.2.1.1.m1.1.2.2.3" xref="S4.E1Xa.2.1.1.m1.1.2.2.3.cmml">a</mi><mrow id="S4.E1Xa.2.1.1.m1.1.1.1.3" xref="S4.E1Xa.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.E1Xa.2.1.1.m1.1.1.1.3.1" xref="S4.E1Xa.2.1.1.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.E1Xa.2.1.1.m1.1.1.1.1" xref="S4.E1Xa.2.1.1.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.E1Xa.2.1.1.m1.1.1.1.3.2" xref="S4.E1Xa.2.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E1Xa.2.1.1.m1.1b"><apply id="S4.E1Xa.2.1.1.m1.1.2.cmml" xref="S4.E1Xa.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.E1Xa.2.1.1.m1.1.2.1.cmml" xref="S4.E1Xa.2.1.1.m1.1.2">superscript</csymbol><apply id="S4.E1Xa.2.1.1.m1.1.2.2.cmml" xref="S4.E1Xa.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.E1Xa.2.1.1.m1.1.2.2.1.cmml" xref="S4.E1Xa.2.1.1.m1.1.2">subscript</csymbol><ci id="S4.E1Xa.2.1.1.m1.1.2.2.2.cmml" xref="S4.E1Xa.2.1.1.m1.1.2.2.2">𝐗</ci><ci id="S4.E1Xa.2.1.1.m1.1.2.2.3.cmml" xref="S4.E1Xa.2.1.1.m1.1.2.2.3">𝑎</ci></apply><ci id="S4.E1Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E1Xa.2.1.1.m1.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1Xa.2.1.1.m1.1c">\displaystyle\mathbf{X}_{a}^{(\ell)}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E1Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\mathrm{MHA}(\mathbf{F}^{(\ell)},\mathbf{X}_{v},\mathbf{X}_{v})+\mathbf{F}^{(\ell)}," display="inline"><semantics id="S4.E1Xa.3.2.2.m1.3a"><mrow id="S4.E1Xa.3.2.2.m1.3.3.1" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="S4.E1Xa.3.2.2.m1.3.3.1.1" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.5" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.5.cmml"></mi><mo id="S4.E1Xa.3.2.2.m1.3.3.1.1.4" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E1Xa.3.2.2.m1.3.3.1.1.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.cmml"><mrow id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.5" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.5.cmml">MHA</mi><mo lspace="0em" rspace="0em" id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.4" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.4.cmml">​</mo><mrow id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml"><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.4" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml">(</mo><msup id="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mrow id="S4.E1Xa.3.2.2.m1.1.1.1.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.1.1.1.3.1" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi mathvariant="normal" id="S4.E1Xa.3.2.2.m1.1.1.1.1" xref="S4.E1Xa.3.2.2.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.1.1.1.3.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.5" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml">,</mo><msub id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐗</mi><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.3.cmml">v</mi></msub><mo id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.6" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml">,</mo><msub id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.2.cmml">𝐗</mi><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.3.cmml">v</mi></msub><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.7" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.4" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.4.cmml">+</mo><msup id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.cmml"><mi id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.2.cmml">𝐅</mi><mrow id="S4.E1Xa.3.2.2.m1.2.2.1.3" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.cmml"><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.2.2.1.3.1" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.cmml">(</mo><mi mathvariant="normal" id="S4.E1Xa.3.2.2.m1.2.2.1.1" xref="S4.E1Xa.3.2.2.m1.2.2.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.E1Xa.3.2.2.m1.2.2.1.3.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S4.E1Xa.3.2.2.m1.3.3.1.2" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1Xa.3.2.2.m1.3b"><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1"><eq id="S4.E1Xa.3.2.2.m1.3.3.1.1.4.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.4"></eq><csymbol cd="latexml" id="S4.E1Xa.3.2.2.m1.3.3.1.1.5.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.5">absent</csymbol><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3"><plus id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.4.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.4"></plus><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3"><times id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.4.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.4"></times><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.5.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.5">MHA</ci><vector id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.4.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3"><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2">𝐅</ci><ci id="S4.E1Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E1Xa.3.2.2.m1.1.1.1.1">ℓ</ci></apply><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.2">𝐗</ci><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.3">𝑣</ci></apply><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3">subscript</csymbol><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.2.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.2">𝐗</ci><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.3.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.3">𝑣</ci></apply></vector></apply><apply id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.1.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5">superscript</csymbol><ci id="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.2.cmml" xref="S4.E1Xa.3.2.2.m1.3.3.1.1.3.5.2">𝐅</ci><ci id="S4.E1Xa.3.2.2.m1.2.2.1.1.cmml" xref="S4.E1Xa.3.2.2.m1.2.2.1.1">ℓ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1Xa.3.2.2.m1.3c">\displaystyle=\mathrm{MHA}(\mathbf{F}^{(\ell)},\mathbf{X}_{v},\mathbf{X}_{v})+\mathbf{F}^{(\ell)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS3.p1.13" class="ltx_p">where <math id="S4.SS3.p1.5.m1.1" class="ltx_math_unparsed" alttext="\mathrm{CA}(.)" display="inline"><semantics id="S4.SS3.p1.5.m1.1a"><mrow id="S4.SS3.p1.5.m1.1b"><mi id="S4.SS3.p1.5.m1.1.1">CA</mi><mrow id="S4.SS3.p1.5.m1.1.2"><mo stretchy="false" id="S4.SS3.p1.5.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS3.p1.5.m1.1.2.2">.</mo><mo stretchy="false" id="S4.SS3.p1.5.m1.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m1.1c">\mathrm{CA}(.)</annotation></semantics></math> and <math id="S4.SS3.p1.6.m2.1" class="ltx_math_unparsed" alttext="\mathrm{MHA}(.)" display="inline"><semantics id="S4.SS3.p1.6.m2.1a"><mrow id="S4.SS3.p1.6.m2.1b"><mi id="S4.SS3.p1.6.m2.1.1">MHA</mi><mrow id="S4.SS3.p1.6.m2.1.2"><mo stretchy="false" id="S4.SS3.p1.6.m2.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS3.p1.6.m2.1.2.2">.</mo><mo stretchy="false" id="S4.SS3.p1.6.m2.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m2.1c">\mathrm{MHA}(.)</annotation></semantics></math> are standard causal and multi-head attention blocks, and <math id="S4.SS3.p1.7.m3.1" class="ltx_Math" alttext="\mathbf{F}^{(\ell)}\in\mathbb{R}^{t_{a}\times d}" display="inline"><semantics id="S4.SS3.p1.7.m3.1a"><mrow id="S4.SS3.p1.7.m3.1.2" xref="S4.SS3.p1.7.m3.1.2.cmml"><msup id="S4.SS3.p1.7.m3.1.2.2" xref="S4.SS3.p1.7.m3.1.2.2.cmml"><mi id="S4.SS3.p1.7.m3.1.2.2.2" xref="S4.SS3.p1.7.m3.1.2.2.2.cmml">𝐅</mi><mrow id="S4.SS3.p1.7.m3.1.1.1.3" xref="S4.SS3.p1.7.m3.1.2.2.cmml"><mo stretchy="false" id="S4.SS3.p1.7.m3.1.1.1.3.1" xref="S4.SS3.p1.7.m3.1.2.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS3.p1.7.m3.1.1.1.1" xref="S4.SS3.p1.7.m3.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.SS3.p1.7.m3.1.1.1.3.2" xref="S4.SS3.p1.7.m3.1.2.2.cmml">)</mo></mrow></msup><mo id="S4.SS3.p1.7.m3.1.2.1" xref="S4.SS3.p1.7.m3.1.2.1.cmml">∈</mo><msup id="S4.SS3.p1.7.m3.1.2.3" xref="S4.SS3.p1.7.m3.1.2.3.cmml"><mi id="S4.SS3.p1.7.m3.1.2.3.2" xref="S4.SS3.p1.7.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.7.m3.1.2.3.3" xref="S4.SS3.p1.7.m3.1.2.3.3.cmml"><msub id="S4.SS3.p1.7.m3.1.2.3.3.2" xref="S4.SS3.p1.7.m3.1.2.3.3.2.cmml"><mi id="S4.SS3.p1.7.m3.1.2.3.3.2.2" xref="S4.SS3.p1.7.m3.1.2.3.3.2.2.cmml">t</mi><mi id="S4.SS3.p1.7.m3.1.2.3.3.2.3" xref="S4.SS3.p1.7.m3.1.2.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.7.m3.1.2.3.3.1" xref="S4.SS3.p1.7.m3.1.2.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.7.m3.1.2.3.3.3" xref="S4.SS3.p1.7.m3.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m3.1b"><apply id="S4.SS3.p1.7.m3.1.2.cmml" xref="S4.SS3.p1.7.m3.1.2"><in id="S4.SS3.p1.7.m3.1.2.1.cmml" xref="S4.SS3.p1.7.m3.1.2.1"></in><apply id="S4.SS3.p1.7.m3.1.2.2.cmml" xref="S4.SS3.p1.7.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m3.1.2.2.1.cmml" xref="S4.SS3.p1.7.m3.1.2.2">superscript</csymbol><ci id="S4.SS3.p1.7.m3.1.2.2.2.cmml" xref="S4.SS3.p1.7.m3.1.2.2.2">𝐅</ci><ci id="S4.SS3.p1.7.m3.1.1.1.1.cmml" xref="S4.SS3.p1.7.m3.1.1.1.1">ℓ</ci></apply><apply id="S4.SS3.p1.7.m3.1.2.3.cmml" xref="S4.SS3.p1.7.m3.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m3.1.2.3.1.cmml" xref="S4.SS3.p1.7.m3.1.2.3">superscript</csymbol><ci id="S4.SS3.p1.7.m3.1.2.3.2.cmml" xref="S4.SS3.p1.7.m3.1.2.3.2">ℝ</ci><apply id="S4.SS3.p1.7.m3.1.2.3.3.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3"><times id="S4.SS3.p1.7.m3.1.2.3.3.1.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.1"></times><apply id="S4.SS3.p1.7.m3.1.2.3.3.2.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m3.1.2.3.3.2.1.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.2">subscript</csymbol><ci id="S4.SS3.p1.7.m3.1.2.3.3.2.2.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.2.2">𝑡</ci><ci id="S4.SS3.p1.7.m3.1.2.3.3.2.3.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.2.3">𝑎</ci></apply><ci id="S4.SS3.p1.7.m3.1.2.3.3.3.cmml" xref="S4.SS3.p1.7.m3.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m3.1c">\mathbf{F}^{(\ell)}\in\mathbb{R}^{t_{a}\times d}</annotation></semantics></math> is an intermediate music representation computed from music tokens <math id="S4.SS3.p1.8.m4.1" class="ltx_Math" alttext="\mathbf{X}^{(\ell-1)}_{a}" display="inline"><semantics id="S4.SS3.p1.8.m4.1a"><msubsup id="S4.SS3.p1.8.m4.1.2" xref="S4.SS3.p1.8.m4.1.2.cmml"><mi id="S4.SS3.p1.8.m4.1.2.2.2" xref="S4.SS3.p1.8.m4.1.2.2.2.cmml">𝐗</mi><mi id="S4.SS3.p1.8.m4.1.2.3" xref="S4.SS3.p1.8.m4.1.2.3.cmml">a</mi><mrow id="S4.SS3.p1.8.m4.1.1.1.1" xref="S4.SS3.p1.8.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.8.m4.1.1.1.1.2" xref="S4.SS3.p1.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.8.m4.1.1.1.1.1" xref="S4.SS3.p1.8.m4.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.8.m4.1.1.1.1.1.2" xref="S4.SS3.p1.8.m4.1.1.1.1.1.2.cmml">ℓ</mi><mo id="S4.SS3.p1.8.m4.1.1.1.1.1.1" xref="S4.SS3.p1.8.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS3.p1.8.m4.1.1.1.1.1.3" xref="S4.SS3.p1.8.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS3.p1.8.m4.1.1.1.1.3" xref="S4.SS3.p1.8.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m4.1b"><apply id="S4.SS3.p1.8.m4.1.2.cmml" xref="S4.SS3.p1.8.m4.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m4.1.2.1.cmml" xref="S4.SS3.p1.8.m4.1.2">subscript</csymbol><apply id="S4.SS3.p1.8.m4.1.2.2.cmml" xref="S4.SS3.p1.8.m4.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m4.1.2.2.1.cmml" xref="S4.SS3.p1.8.m4.1.2">superscript</csymbol><ci id="S4.SS3.p1.8.m4.1.2.2.2.cmml" xref="S4.SS3.p1.8.m4.1.2.2.2">𝐗</ci><apply id="S4.SS3.p1.8.m4.1.1.1.1.1.cmml" xref="S4.SS3.p1.8.m4.1.1.1.1"><minus id="S4.SS3.p1.8.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.8.m4.1.1.1.1.1.1"></minus><ci id="S4.SS3.p1.8.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.8.m4.1.1.1.1.1.2">ℓ</ci><cn type="integer" id="S4.SS3.p1.8.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.8.m4.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS3.p1.8.m4.1.2.3.cmml" xref="S4.SS3.p1.8.m4.1.2.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m4.1c">\mathbf{X}^{(\ell-1)}_{a}</annotation></semantics></math>. The new music token representation <math id="S4.SS3.p1.9.m5.1" class="ltx_Math" alttext="\mathbf{X}_{a}^{(\ell)}" display="inline"><semantics id="S4.SS3.p1.9.m5.1a"><msubsup id="S4.SS3.p1.9.m5.1.2" xref="S4.SS3.p1.9.m5.1.2.cmml"><mi id="S4.SS3.p1.9.m5.1.2.2.2" xref="S4.SS3.p1.9.m5.1.2.2.2.cmml">𝐗</mi><mi id="S4.SS3.p1.9.m5.1.2.2.3" xref="S4.SS3.p1.9.m5.1.2.2.3.cmml">a</mi><mrow id="S4.SS3.p1.9.m5.1.1.1.3" xref="S4.SS3.p1.9.m5.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.9.m5.1.1.1.3.1" xref="S4.SS3.p1.9.m5.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS3.p1.9.m5.1.1.1.1" xref="S4.SS3.p1.9.m5.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.SS3.p1.9.m5.1.1.1.3.2" xref="S4.SS3.p1.9.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m5.1b"><apply id="S4.SS3.p1.9.m5.1.2.cmml" xref="S4.SS3.p1.9.m5.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m5.1.2.1.cmml" xref="S4.SS3.p1.9.m5.1.2">superscript</csymbol><apply id="S4.SS3.p1.9.m5.1.2.2.cmml" xref="S4.SS3.p1.9.m5.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m5.1.2.2.1.cmml" xref="S4.SS3.p1.9.m5.1.2">subscript</csymbol><ci id="S4.SS3.p1.9.m5.1.2.2.2.cmml" xref="S4.SS3.p1.9.m5.1.2.2.2">𝐗</ci><ci id="S4.SS3.p1.9.m5.1.2.2.3.cmml" xref="S4.SS3.p1.9.m5.1.2.2.3">𝑎</ci></apply><ci id="S4.SS3.p1.9.m5.1.1.1.1.cmml" xref="S4.SS3.p1.9.m5.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m5.1c">\mathbf{X}_{a}^{(\ell)}</annotation></semantics></math> at layer <math id="S4.SS3.p1.10.m6.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S4.SS3.p1.10.m6.1a"><mi mathvariant="normal" id="S4.SS3.p1.10.m6.1.1" xref="S4.SS3.p1.10.m6.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m6.1b"><ci id="S4.SS3.p1.10.m6.1.1.cmml" xref="S4.SS3.p1.10.m6.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m6.1c">\ell</annotation></semantics></math> is then computed using a multi-head self-attention that uses the intermediate music representation <math id="S4.SS3.p1.11.m7.1" class="ltx_Math" alttext="\mathbf{F}^{(\ell)}" display="inline"><semantics id="S4.SS3.p1.11.m7.1a"><msup id="S4.SS3.p1.11.m7.1.2" xref="S4.SS3.p1.11.m7.1.2.cmml"><mi id="S4.SS3.p1.11.m7.1.2.2" xref="S4.SS3.p1.11.m7.1.2.2.cmml">𝐅</mi><mrow id="S4.SS3.p1.11.m7.1.1.1.3" xref="S4.SS3.p1.11.m7.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.11.m7.1.1.1.3.1" xref="S4.SS3.p1.11.m7.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS3.p1.11.m7.1.1.1.1" xref="S4.SS3.p1.11.m7.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S4.SS3.p1.11.m7.1.1.1.3.2" xref="S4.SS3.p1.11.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m7.1b"><apply id="S4.SS3.p1.11.m7.1.2.cmml" xref="S4.SS3.p1.11.m7.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m7.1.2.1.cmml" xref="S4.SS3.p1.11.m7.1.2">superscript</csymbol><ci id="S4.SS3.p1.11.m7.1.2.2.cmml" xref="S4.SS3.p1.11.m7.1.2.2">𝐅</ci><ci id="S4.SS3.p1.11.m7.1.1.1.1.cmml" xref="S4.SS3.p1.11.m7.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m7.1c">\mathbf{F}^{(\ell)}</annotation></semantics></math> as query, and video features <math id="S4.SS3.p1.12.m8.1" class="ltx_Math" alttext="\mathbf{X}_{v}" display="inline"><semantics id="S4.SS3.p1.12.m8.1a"><msub id="S4.SS3.p1.12.m8.1.1" xref="S4.SS3.p1.12.m8.1.1.cmml"><mi id="S4.SS3.p1.12.m8.1.1.2" xref="S4.SS3.p1.12.m8.1.1.2.cmml">𝐗</mi><mi id="S4.SS3.p1.12.m8.1.1.3" xref="S4.SS3.p1.12.m8.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m8.1b"><apply id="S4.SS3.p1.12.m8.1.1.cmml" xref="S4.SS3.p1.12.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m8.1.1.1.cmml" xref="S4.SS3.p1.12.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.12.m8.1.1.2.cmml" xref="S4.SS3.p1.12.m8.1.1.2">𝐗</ci><ci id="S4.SS3.p1.12.m8.1.1.3.cmml" xref="S4.SS3.p1.12.m8.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m8.1c">\mathbf{X}_{v}</annotation></semantics></math> as keys and values.
The final music output <math id="S4.SS3.p1.13.m9.1" class="ltx_Math" alttext="\mathbf{\hat{Y}}\in\mathbb{R}^{t_{a}\times c}" display="inline"><semantics id="S4.SS3.p1.13.m9.1a"><mrow id="S4.SS3.p1.13.m9.1.1" xref="S4.SS3.p1.13.m9.1.1.cmml"><mover accent="true" id="S4.SS3.p1.13.m9.1.1.2" xref="S4.SS3.p1.13.m9.1.1.2.cmml"><mi id="S4.SS3.p1.13.m9.1.1.2.2" xref="S4.SS3.p1.13.m9.1.1.2.2.cmml">𝐘</mi><mo id="S4.SS3.p1.13.m9.1.1.2.1" xref="S4.SS3.p1.13.m9.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS3.p1.13.m9.1.1.1" xref="S4.SS3.p1.13.m9.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.13.m9.1.1.3" xref="S4.SS3.p1.13.m9.1.1.3.cmml"><mi id="S4.SS3.p1.13.m9.1.1.3.2" xref="S4.SS3.p1.13.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.13.m9.1.1.3.3" xref="S4.SS3.p1.13.m9.1.1.3.3.cmml"><msub id="S4.SS3.p1.13.m9.1.1.3.3.2" xref="S4.SS3.p1.13.m9.1.1.3.3.2.cmml"><mi id="S4.SS3.p1.13.m9.1.1.3.3.2.2" xref="S4.SS3.p1.13.m9.1.1.3.3.2.2.cmml">t</mi><mi id="S4.SS3.p1.13.m9.1.1.3.3.2.3" xref="S4.SS3.p1.13.m9.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.13.m9.1.1.3.3.1" xref="S4.SS3.p1.13.m9.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.13.m9.1.1.3.3.3" xref="S4.SS3.p1.13.m9.1.1.3.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m9.1b"><apply id="S4.SS3.p1.13.m9.1.1.cmml" xref="S4.SS3.p1.13.m9.1.1"><in id="S4.SS3.p1.13.m9.1.1.1.cmml" xref="S4.SS3.p1.13.m9.1.1.1"></in><apply id="S4.SS3.p1.13.m9.1.1.2.cmml" xref="S4.SS3.p1.13.m9.1.1.2"><ci id="S4.SS3.p1.13.m9.1.1.2.1.cmml" xref="S4.SS3.p1.13.m9.1.1.2.1">^</ci><ci id="S4.SS3.p1.13.m9.1.1.2.2.cmml" xref="S4.SS3.p1.13.m9.1.1.2.2">𝐘</ci></apply><apply id="S4.SS3.p1.13.m9.1.1.3.cmml" xref="S4.SS3.p1.13.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m9.1.1.3.1.cmml" xref="S4.SS3.p1.13.m9.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.13.m9.1.1.3.2.cmml" xref="S4.SS3.p1.13.m9.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.13.m9.1.1.3.3.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3"><times id="S4.SS3.p1.13.m9.1.1.3.3.1.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.1"></times><apply id="S4.SS3.p1.13.m9.1.1.3.3.2.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m9.1.1.3.3.2.1.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.2">subscript</csymbol><ci id="S4.SS3.p1.13.m9.1.1.3.3.2.2.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.2.2">𝑡</ci><ci id="S4.SS3.p1.13.m9.1.1.3.3.2.3.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.2.3">𝑎</ci></apply><ci id="S4.SS3.p1.13.m9.1.1.3.3.3.cmml" xref="S4.SS3.p1.13.m9.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m9.1c">\mathbf{\hat{Y}}\in\mathbb{R}^{t_{a}\times c}</annotation></semantics></math> is predicted via an MLP layer attached to the last decoder layer.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2409.07450/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Video-Beat Alignment Scheme.<span id="S4.F2.4.2.1" class="ltx_text ltx_font_medium">
Our proposed alignment scheme allows us to detect moments in the video where music beats align with low-level visual cues such as dynamic human motions or scene transitions. We use Onset Detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and Optical Flow to identify such aligned video-beat moments. This information is then used to supervise our video-music generation model such that it would produce music aligned with low-level dynamic visual content.</span></span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Semantic Video-Music Alignment</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To improve the alignment between generated music and video, we incorporate the following two strategies into our framework: (1) a global video-music contrastive objective, which guides the music to match the <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_italic">high-level</span> video cues (e.g., genre, style, etc.),
and (2) a fine-grained video-beat alignment scheme, designed to generate music beats that match the <span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_italic">low-level</span> video cues such as scene transitions or dynamic human motions. We describe each of these schemes below.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.9" class="ltx_p"><span id="S4.SS4.p2.9.1" class="ltx_text ltx_font_bold">Global Video-Music Contrastive Objective.</span>
To implement our contrastive video-music matching objective, we use the video representation <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{X}_{v}" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><msub id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">𝐗</mi><mi id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝐗</ci><ci id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\mathbf{X}_{v}</annotation></semantics></math> and compute the music features as <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{M}=\mathbf{\hat{Y}}\mathbf{E}" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">𝐌</mi><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml"><mover accent="true" id="S4.SS4.p2.2.m2.1.1.3.2" xref="S4.SS4.p2.2.m2.1.1.3.2.cmml"><mi id="S4.SS4.p2.2.m2.1.1.3.2.2" xref="S4.SS4.p2.2.m2.1.1.3.2.2.cmml">𝐘</mi><mo id="S4.SS4.p2.2.m2.1.1.3.2.1" xref="S4.SS4.p2.2.m2.1.1.3.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.1.1.3.1" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.2.m2.1.1.3.3" xref="S4.SS4.p2.2.m2.1.1.3.3.cmml">𝐄</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><eq id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></eq><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝐌</ci><apply id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3"><times id="S4.SS4.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.1.1.3.1"></times><apply id="S4.SS4.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.p2.2.m2.1.1.3.2"><ci id="S4.SS4.p2.2.m2.1.1.3.2.1.cmml" xref="S4.SS4.p2.2.m2.1.1.3.2.1">^</ci><ci id="S4.SS4.p2.2.m2.1.1.3.2.2.cmml" xref="S4.SS4.p2.2.m2.1.1.3.2.2">𝐘</ci></apply><ci id="S4.SS4.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3.3">𝐄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">\mathbf{M}=\mathbf{\hat{Y}}\mathbf{E}</annotation></semantics></math>, where <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{\hat{Y}}\in\mathbb{R}^{t_{a}\times c}" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mrow id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mover accent="true" id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2.2" xref="S4.SS4.p2.3.m3.1.1.2.2.cmml">𝐘</mi><mo id="S4.SS4.p2.3.m3.1.1.2.1" xref="S4.SS4.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS4.p2.3.m3.1.1.1" xref="S4.SS4.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml"><mi id="S4.SS4.p2.3.m3.1.1.3.2" xref="S4.SS4.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.p2.3.m3.1.1.3.3" xref="S4.SS4.p2.3.m3.1.1.3.3.cmml"><msub id="S4.SS4.p2.3.m3.1.1.3.3.2" xref="S4.SS4.p2.3.m3.1.1.3.3.2.cmml"><mi id="S4.SS4.p2.3.m3.1.1.3.3.2.2" xref="S4.SS4.p2.3.m3.1.1.3.3.2.2.cmml">t</mi><mi id="S4.SS4.p2.3.m3.1.1.3.3.2.3" xref="S4.SS4.p2.3.m3.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p2.3.m3.1.1.3.3.1" xref="S4.SS4.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.p2.3.m3.1.1.3.3.3" xref="S4.SS4.p2.3.m3.1.1.3.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><in id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1"></in><apply id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2"><ci id="S4.SS4.p2.3.m3.1.1.2.1.cmml" xref="S4.SS4.p2.3.m3.1.1.2.1">^</ci><ci id="S4.SS4.p2.3.m3.1.1.2.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2.2">𝐘</ci></apply><apply id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.3.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.3.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS4.p2.3.m3.1.1.3.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3"><times id="S4.SS4.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.1"></times><apply id="S4.SS4.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.3.3.2.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.2.2">𝑡</ci><ci id="S4.SS4.p2.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.2.3">𝑎</ci></apply><ci id="S4.SS4.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">\mathbf{\hat{Y}}\in\mathbb{R}^{t_{a}\times c}</annotation></semantics></math> is the output from our music decoder, and <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{c\times d}" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mrow id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml"><mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">𝐄</mi><mo id="S4.SS4.p2.4.m4.1.1.1" xref="S4.SS4.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml"><mi id="S4.SS4.p2.4.m4.1.1.3.2" xref="S4.SS4.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.p2.4.m4.1.1.3.3" xref="S4.SS4.p2.4.m4.1.1.3.3.cmml"><mi id="S4.SS4.p2.4.m4.1.1.3.3.2" xref="S4.SS4.p2.4.m4.1.1.3.3.2.cmml">c</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p2.4.m4.1.1.3.3.1" xref="S4.SS4.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.p2.4.m4.1.1.3.3.3" xref="S4.SS4.p2.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1"><in id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1.1"></in><ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">𝐄</ci><apply id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m4.1.1.3.1.cmml" xref="S4.SS4.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS4.p2.4.m4.1.1.3.2.cmml" xref="S4.SS4.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS4.p2.4.m4.1.1.3.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3.3"><times id="S4.SS4.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS4.p2.4.m4.1.1.3.3.1"></times><ci id="S4.SS4.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS4.p2.4.m4.1.1.3.3.2">𝑐</ci><ci id="S4.SS4.p2.4.m4.1.1.3.3.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">\mathbf{E}\in\mathbb{R}^{c\times d}</annotation></semantics></math> is the embedding matrix from the EnCodec model. Conceptually, this operation allows us to map the discrete predicted audio categories <math id="S4.SS4.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{\hat{Y}}" display="inline"><semantics id="S4.SS4.p2.5.m5.1a"><mover accent="true" id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml"><mi id="S4.SS4.p2.5.m5.1.1.2" xref="S4.SS4.p2.5.m5.1.1.2.cmml">𝐘</mi><mo id="S4.SS4.p2.5.m5.1.1.1" xref="S4.SS4.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><apply id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1"><ci id="S4.SS4.p2.5.m5.1.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1.1">^</ci><ci id="S4.SS4.p2.5.m5.1.1.2.cmml" xref="S4.SS4.p2.5.m5.1.1.2">𝐘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">\mathbf{\hat{Y}}</annotation></semantics></math> into higher-dimensional music embeddings for more effective contrastive matching.
To obtain an aggregated video representation <math id="S4.SS4.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{\bar{X}}_{v}\in\mathbb{R}^{d}" display="inline"><semantics id="S4.SS4.p2.6.m6.1a"><mrow id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml"><msub id="S4.SS4.p2.6.m6.1.1.2" xref="S4.SS4.p2.6.m6.1.1.2.cmml"><mover accent="true" id="S4.SS4.p2.6.m6.1.1.2.2" xref="S4.SS4.p2.6.m6.1.1.2.2.cmml"><mi id="S4.SS4.p2.6.m6.1.1.2.2.2" xref="S4.SS4.p2.6.m6.1.1.2.2.2.cmml">𝐗</mi><mo id="S4.SS4.p2.6.m6.1.1.2.2.1" xref="S4.SS4.p2.6.m6.1.1.2.2.1.cmml">¯</mo></mover><mi id="S4.SS4.p2.6.m6.1.1.2.3" xref="S4.SS4.p2.6.m6.1.1.2.3.cmml">v</mi></msub><mo id="S4.SS4.p2.6.m6.1.1.1" xref="S4.SS4.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS4.p2.6.m6.1.1.3" xref="S4.SS4.p2.6.m6.1.1.3.cmml"><mi id="S4.SS4.p2.6.m6.1.1.3.2" xref="S4.SS4.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS4.p2.6.m6.1.1.3.3" xref="S4.SS4.p2.6.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><apply id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1"><in id="S4.SS4.p2.6.m6.1.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1.1"></in><apply id="S4.SS4.p2.6.m6.1.1.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m6.1.1.2.1.cmml" xref="S4.SS4.p2.6.m6.1.1.2">subscript</csymbol><apply id="S4.SS4.p2.6.m6.1.1.2.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2.2"><ci id="S4.SS4.p2.6.m6.1.1.2.2.1.cmml" xref="S4.SS4.p2.6.m6.1.1.2.2.1">¯</ci><ci id="S4.SS4.p2.6.m6.1.1.2.2.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2.2.2">𝐗</ci></apply><ci id="S4.SS4.p2.6.m6.1.1.2.3.cmml" xref="S4.SS4.p2.6.m6.1.1.2.3">𝑣</ci></apply><apply id="S4.SS4.p2.6.m6.1.1.3.cmml" xref="S4.SS4.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m6.1.1.3.1.cmml" xref="S4.SS4.p2.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS4.p2.6.m6.1.1.3.2.cmml" xref="S4.SS4.p2.6.m6.1.1.3.2">ℝ</ci><ci id="S4.SS4.p2.6.m6.1.1.3.3.cmml" xref="S4.SS4.p2.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">\mathbf{\bar{X}}_{v}\in\mathbb{R}^{d}</annotation></semantics></math>, we apply temporal mean pooling on the video features <math id="S4.SS4.p2.7.m7.1" class="ltx_Math" alttext="\textbf{X}_{v}" display="inline"><semantics id="S4.SS4.p2.7.m7.1a"><msub id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.7.m7.1.1.2" xref="S4.SS4.p2.7.m7.1.1.2a.cmml">X</mtext><mi id="S4.SS4.p2.7.m7.1.1.3" xref="S4.SS4.p2.7.m7.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><apply id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.7.m7.1.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p2.7.m7.1.1.2a.cmml" xref="S4.SS4.p2.7.m7.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.7.m7.1.1.2.cmml" xref="S4.SS4.p2.7.m7.1.1.2">X</mtext></ci><ci id="S4.SS4.p2.7.m7.1.1.3.cmml" xref="S4.SS4.p2.7.m7.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">\textbf{X}_{v}</annotation></semantics></math>.
We also apply mean pooling on the music features <math id="S4.SS4.p2.8.m8.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S4.SS4.p2.8.m8.1a"><mi id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><ci id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">\mathbf{M}</annotation></semantics></math> to generate an aggregated music representation <math id="S4.SS4.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{\bar{M}}\in\mathbb{R}^{d}" display="inline"><semantics id="S4.SS4.p2.9.m9.1a"><mrow id="S4.SS4.p2.9.m9.1.1" xref="S4.SS4.p2.9.m9.1.1.cmml"><mover accent="true" id="S4.SS4.p2.9.m9.1.1.2" xref="S4.SS4.p2.9.m9.1.1.2.cmml"><mi id="S4.SS4.p2.9.m9.1.1.2.2" xref="S4.SS4.p2.9.m9.1.1.2.2.cmml">𝐌</mi><mo id="S4.SS4.p2.9.m9.1.1.2.1" xref="S4.SS4.p2.9.m9.1.1.2.1.cmml">¯</mo></mover><mo id="S4.SS4.p2.9.m9.1.1.1" xref="S4.SS4.p2.9.m9.1.1.1.cmml">∈</mo><msup id="S4.SS4.p2.9.m9.1.1.3" xref="S4.SS4.p2.9.m9.1.1.3.cmml"><mi id="S4.SS4.p2.9.m9.1.1.3.2" xref="S4.SS4.p2.9.m9.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS4.p2.9.m9.1.1.3.3" xref="S4.SS4.p2.9.m9.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m9.1b"><apply id="S4.SS4.p2.9.m9.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1"><in id="S4.SS4.p2.9.m9.1.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1.1"></in><apply id="S4.SS4.p2.9.m9.1.1.2.cmml" xref="S4.SS4.p2.9.m9.1.1.2"><ci id="S4.SS4.p2.9.m9.1.1.2.1.cmml" xref="S4.SS4.p2.9.m9.1.1.2.1">¯</ci><ci id="S4.SS4.p2.9.m9.1.1.2.2.cmml" xref="S4.SS4.p2.9.m9.1.1.2.2">𝐌</ci></apply><apply id="S4.SS4.p2.9.m9.1.1.3.cmml" xref="S4.SS4.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.9.m9.1.1.3.1.cmml" xref="S4.SS4.p2.9.m9.1.1.3">superscript</csymbol><ci id="S4.SS4.p2.9.m9.1.1.3.2.cmml" xref="S4.SS4.p2.9.m9.1.1.3.2">ℝ</ci><ci id="S4.SS4.p2.9.m9.1.1.3.3.cmml" xref="S4.SS4.p2.9.m9.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.9.m9.1c">\mathbf{\bar{M}}\in\mathbb{R}^{d}</annotation></semantics></math>. Then, the video-music contrastive objective is written as:</p>
<table id="S4.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2X.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{c}=-\frac{1}{B}\sum_{i=1}^{B}{\rm log}\frac{{\mathrm{e}xp}(\mathrm{g}(\mathbf{\bar{X}}_{v}(i),\mathbf{\bar{M}}(i)))}{\sum_{j=1}^{B}{\mathrm{e}xp}(\mathrm{g}(\mathbf{\bar{X}}_{v}(i),\mathbf{\bar{M}}(j)))}," display="inline"><semantics id="S4.E2X.2.1.1.m1.7a"><mrow id="S4.E2X.2.1.1.m1.7.7.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.cmml"><mrow id="S4.E2X.2.1.1.m1.7.7.1.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.cmml"><msub id="S4.E2X.2.1.1.m1.7.7.1.1.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2X.2.1.1.m1.7.7.1.1.2.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.2.2.cmml">ℒ</mi><mi id="S4.E2X.2.1.1.m1.7.7.1.1.2.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.2.3.cmml">c</mi></msub><mo id="S4.E2X.2.1.1.m1.7.7.1.1.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.1.cmml">=</mo><mrow id="S4.E2X.2.1.1.m1.7.7.1.1.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.cmml"><mo id="S4.E2X.2.1.1.m1.7.7.1.1.3a" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.cmml">−</mo><mrow id="S4.E2X.2.1.1.m1.7.7.1.1.3.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.cmml"><mstyle displaystyle="true" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.cmml"><mfrac id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2a" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.cmml"><mn id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.2.cmml">1</mn><mi id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.3.cmml">B</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.cmml"><munderover id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1a" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.cmml"><mo movablelimits="false" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.2.cmml">i</mi><mo id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.3" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.3.cmml">B</mi></munderover></mstyle><mrow id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.cmml"><mi id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.2.cmml">log</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.1" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.1.cmml">​</mo><mstyle displaystyle="true" id="S4.E2X.2.1.1.m1.6.6" xref="S4.E2X.2.1.1.m1.6.6.cmml"><mfrac id="S4.E2X.2.1.1.m1.6.6a" xref="S4.E2X.2.1.1.m1.6.6.cmml"><mrow id="S4.E2X.2.1.1.m1.3.3.3" xref="S4.E2X.2.1.1.m1.3.3.3.cmml"><mi mathvariant="normal" id="S4.E2X.2.1.1.m1.3.3.3.5" xref="S4.E2X.2.1.1.m1.3.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.4" xref="S4.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S4.E2X.2.1.1.m1.3.3.3.6" xref="S4.E2X.2.1.1.m1.3.3.3.6.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.4a" xref="S4.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S4.E2X.2.1.1.m1.3.3.3.7" xref="S4.E2X.2.1.1.m1.3.3.3.7.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.4b" xref="S4.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.cmml"><mi mathvariant="normal" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.4" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.3.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.3.cmml">(</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.cmml"><msub id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.cmml"><mi id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml">𝐗</mi><mo id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.1.cmml">¯</mo></mover><mi id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.3.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.3.2.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mi id="S4.E2X.2.1.1.m1.1.1.1.1" xref="S4.E2X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.3.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.4" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.3.cmml">,</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.cmml"><mover accent="true" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.2.cmml">𝐌</mi><mo id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.3.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.3.2.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.cmml">(</mo><mi id="S4.E2X.2.1.1.m1.2.2.2.2" xref="S4.E2X.2.1.1.m1.2.2.2.2.cmml">i</mi><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.3.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.5" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2X.2.1.1.m1.3.3.3.3.1.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E2X.2.1.1.m1.6.6.6" xref="S4.E2X.2.1.1.m1.6.6.6.cmml"><msubsup id="S4.E2X.2.1.1.m1.6.6.6.4" xref="S4.E2X.2.1.1.m1.6.6.6.4.cmml"><mo id="S4.E2X.2.1.1.m1.6.6.6.4.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.4.2.3" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.2" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.2.cmml">j</mi><mo id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.1" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.3" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><mi id="S4.E2X.2.1.1.m1.6.6.6.4.3" xref="S4.E2X.2.1.1.m1.6.6.6.4.3.cmml">B</mi></msubsup><mrow id="S4.E2X.2.1.1.m1.6.6.6.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.cmml"><mi mathvariant="normal" id="S4.E2X.2.1.1.m1.6.6.6.3.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.2.cmml">​</mo><mi id="S4.E2X.2.1.1.m1.6.6.6.3.4" xref="S4.E2X.2.1.1.m1.6.6.6.3.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.2a" xref="S4.E2X.2.1.1.m1.6.6.6.3.2.cmml">​</mo><mi id="S4.E2X.2.1.1.m1.6.6.6.3.5" xref="S4.E2X.2.1.1.m1.6.6.6.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.2b" xref="S4.E2X.2.1.1.m1.6.6.6.3.2.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.cmml">(</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.4" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.3.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.3.cmml">(</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.cmml"><msub id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.2.cmml">𝐗</mi><mo id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.1.cmml">¯</mo></mover><mi id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.3.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.3.2.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E2X.2.1.1.m1.4.4.4.1" xref="S4.E2X.2.1.1.m1.4.4.4.1.cmml">i</mi><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.3.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.4" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.3.cmml">,</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.cmml"><mover accent="true" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml"><mi id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml">𝐌</mi><mo id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.3.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.3.2.1" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.cmml">(</mo><mi id="S4.E2X.2.1.1.m1.5.5.5.2" xref="S4.E2X.2.1.1.m1.5.5.5.2.cmml">j</mi><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.3.2.2" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.5" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.3" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo id="S4.E2X.2.1.1.m1.7.7.1.2" xref="S4.E2X.2.1.1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2X.2.1.1.m1.7b"><apply id="S4.E2X.2.1.1.m1.7.7.1.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1"><eq id="S4.E2X.2.1.1.m1.7.7.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.1"></eq><apply id="S4.E2X.2.1.1.m1.7.7.1.1.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.7.7.1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.2">subscript</csymbol><ci id="S4.E2X.2.1.1.m1.7.7.1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.2.2">ℒ</ci><ci id="S4.E2X.2.1.1.m1.7.7.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.2.3">𝑐</ci></apply><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3"><minus id="S4.E2X.2.1.1.m1.7.7.1.1.3.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3"></minus><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2"><times id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.1"></times><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2"><divide id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2"></divide><cn type="integer" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.2">1</cn><ci id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.2.3">𝐵</ci></apply><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3"><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1">superscript</csymbol><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1">subscript</csymbol><sum id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.2"></sum><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3"><eq id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.1"></eq><ci id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.3.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.1.3">𝐵</ci></apply><apply id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2"><times id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.1.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.1"></times><ci id="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.2.cmml" xref="S4.E2X.2.1.1.m1.7.7.1.1.3.2.3.2.2">log</ci><apply id="S4.E2X.2.1.1.m1.6.6.cmml" xref="S4.E2X.2.1.1.m1.6.6"><divide id="S4.E2X.2.1.1.m1.6.6.7.cmml" xref="S4.E2X.2.1.1.m1.6.6"></divide><apply id="S4.E2X.2.1.1.m1.3.3.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3"><times id="S4.E2X.2.1.1.m1.3.3.3.4.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.4"></times><ci id="S4.E2X.2.1.1.m1.3.3.3.5.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.5">e</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.6.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.6">𝑥</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.7.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.7">𝑝</ci><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1"><times id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.3"></times><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.4.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.4">g</ci><interval closure="open" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2"><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1"><times id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1"></times><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2"><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.1">¯</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.2.2">𝐗</ci></apply><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S4.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2"><times id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.1"></times><apply id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2"><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.1">¯</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.1.1.2.2.2.2.2">𝐌</ci></apply><ci id="S4.E2X.2.1.1.m1.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2">𝑖</ci></apply></interval></apply></apply><apply id="S4.E2X.2.1.1.m1.6.6.6.cmml" xref="S4.E2X.2.1.1.m1.6.6.6"><apply id="S4.E2X.2.1.1.m1.6.6.6.4.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.6.6.6.4.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4">superscript</csymbol><apply id="S4.E2X.2.1.1.m1.6.6.6.4.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.6.6.6.4.2.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4">subscript</csymbol><sum id="S4.E2X.2.1.1.m1.6.6.6.4.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.2"></sum><apply id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3"><eq id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.1"></eq><ci id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.2">𝑗</ci><cn type="integer" id="S4.E2X.2.1.1.m1.6.6.6.4.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.2.3.3">1</cn></apply></apply><ci id="S4.E2X.2.1.1.m1.6.6.6.4.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.4.3">𝐵</ci></apply><apply id="S4.E2X.2.1.1.m1.6.6.6.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3"><times id="S4.E2X.2.1.1.m1.6.6.6.3.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.2"></times><ci id="S4.E2X.2.1.1.m1.6.6.6.3.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.3">e</ci><ci id="S4.E2X.2.1.1.m1.6.6.6.3.4.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.4">𝑥</ci><ci id="S4.E2X.2.1.1.m1.6.6.6.3.5.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.5">𝑝</ci><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1"><times id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.3"></times><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.4.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.4">g</ci><interval closure="open" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2"><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1"><times id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.1"></times><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2"><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.1">¯</ci><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.2.2">𝐗</ci></apply><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S4.E2X.2.1.1.m1.4.4.4.1.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.1">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2"><times id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.1"></times><apply id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2"><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.1">¯</ci><ci id="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.6.6.6.3.1.1.1.2.2.2.2.2">𝐌</ci></apply><ci id="S4.E2X.2.1.1.m1.5.5.5.2.cmml" xref="S4.E2X.2.1.1.m1.5.5.5.2">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.2.1.1.m1.7c">\displaystyle\mathcal{L}_{c}=-\frac{1}{B}\sum_{i=1}^{B}{\rm log}\frac{{\mathrm{e}xp}(\mathrm{g}(\mathbf{\bar{X}}_{v}(i),\mathbf{\bar{M}}(i)))}{\sum_{j=1}^{B}{\mathrm{e}xp}(\mathrm{g}(\mathbf{\bar{X}}_{v}(i),\mathbf{\bar{M}}(j)))},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.2" class="ltx_p">where <math id="S4.SS4.p3.1.m1.2" class="ltx_Math" alttext="\mathrm{g}(\mathbf{x},\mathbf{y})" display="inline"><semantics id="S4.SS4.p3.1.m1.2a"><mrow id="S4.SS4.p3.1.m1.2.3" xref="S4.SS4.p3.1.m1.2.3.cmml"><mi mathvariant="normal" id="S4.SS4.p3.1.m1.2.3.2" xref="S4.SS4.p3.1.m1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.2.3.1" xref="S4.SS4.p3.1.m1.2.3.1.cmml">​</mo><mrow id="S4.SS4.p3.1.m1.2.3.3.2" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.p3.1.m1.2.3.3.2.1" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">𝐱</mi><mo id="S4.SS4.p3.1.m1.2.3.3.2.2" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS4.p3.1.m1.2.2" xref="S4.SS4.p3.1.m1.2.2.cmml">𝐲</mi><mo stretchy="false" id="S4.SS4.p3.1.m1.2.3.3.2.3" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.2b"><apply id="S4.SS4.p3.1.m1.2.3.cmml" xref="S4.SS4.p3.1.m1.2.3"><times id="S4.SS4.p3.1.m1.2.3.1.cmml" xref="S4.SS4.p3.1.m1.2.3.1"></times><ci id="S4.SS4.p3.1.m1.2.3.2.cmml" xref="S4.SS4.p3.1.m1.2.3.2">g</ci><interval closure="open" id="S4.SS4.p3.1.m1.2.3.3.1.cmml" xref="S4.SS4.p3.1.m1.2.3.3.2"><ci id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">𝐱</ci><ci id="S4.SS4.p3.1.m1.2.2.cmml" xref="S4.SS4.p3.1.m1.2.2">𝐲</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.2c">\mathrm{g}(\mathbf{x},\mathbf{y})</annotation></semantics></math> is the standard cosine similarity function and <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">B</annotation></semantics></math> is the batch size.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.10.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.11.2" class="ltx_text" style="font-size:90%;">
<span id="S4.T3.11.2.1" class="ltx_text ltx_font_bold">Comparison with the State-of-the-Art.</span> We evaluate all methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> on MusicCaps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and DISCO-MV using FAD, KL, and Music-Video Alignment (MV Align) metrics.
Since V2Meow’s <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> code and pretrained models are unavailable, we only report their FAD results on MusicCaps.
Our <span id="S4.T3.11.2.2" class="ltx_text ltx_font_smallcaps">VMAs</span> outperforms all prior approaches in all evaluation metrics on all datasets.
</span></figcaption>
<div id="S4.T3.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:372.6pt;height:139.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-86.3pt,32.2pt) scale(0.683436814199581,0.683436814199581) ;">
<table id="S4.T3.6.6" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.6.6.7" class="ltx_tr">
<td id="S4.T3.6.6.7.1" class="ltx_td ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;"></td>
<td id="S4.T3.6.6.7.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="3"><span id="S4.T3.6.6.7.2.1" class="ltx_text" style="font-size:80%;">MusicCaps Test Set</span></td>
<td id="S4.T3.6.6.7.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="3"><span id="S4.T3.6.6.7.3.1" class="ltx_text" style="font-size:80%;">DISCO-MV</span></td>
</tr>
<tr id="S4.T3.6.6.6" class="ltx_tr">
<td id="S4.T3.6.6.6.7" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Method</td>
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">FAD <math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">KL <math id="S4.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.2.2.2.2.m1.1a"><mo stretchy="false" id="S4.T3.2.2.2.2.m1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S4.T3.3.3.3.3.1" class="ltx_text"></span> <span id="S4.T3.3.3.3.3.2" class="ltx_text">
<span id="S4.T3.3.3.3.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.3.3.3.3.2.1.1" class="ltx_tr">
<span id="S4.T3.3.3.3.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">MV Align</span></span>
</span></span> <span id="S4.T3.3.3.3.3.3" class="ltx_text"></span><math id="S4.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo stretchy="false" id="S4.T3.3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="S4.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">FAD <math id="S4.T3.4.4.4.4.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.4.4.4.4.m1.1a"><mo stretchy="false" id="S4.T3.4.4.4.4.m1.1.1" xref="S4.T3.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m1.1b"><ci id="S4.T3.4.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S4.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">KL <math id="S4.T3.5.5.5.5.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.5.5.5.5.m1.1a"><mo stretchy="false" id="S4.T3.5.5.5.5.m1.1.1" xref="S4.T3.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.m1.1b"><ci id="S4.T3.5.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S4.T3.6.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S4.T3.6.6.6.6.1" class="ltx_text"></span> <span id="S4.T3.6.6.6.6.2" class="ltx_text">
<span id="S4.T3.6.6.6.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.6.6.6.6.2.1.1" class="ltx_tr">
<span id="S4.T3.6.6.6.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">MV Align</span></span>
</span></span> <span id="S4.T3.6.6.6.6.3" class="ltx_text"></span><math id="S4.T3.6.6.6.6.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.6.6.6.6.m1.1a"><mo stretchy="false" id="S4.T3.6.6.6.6.m1.1.1" xref="S4.T3.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.6.m1.1b"><ci id="S4.T3.6.6.6.6.m1.1.1.cmml" xref="S4.T3.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.6.m1.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T3.6.6.8" class="ltx_tr">
<td id="S4.T3.6.6.8.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="7"><span id="S4.T3.6.6.8.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Symbolic Music</span></td>
</tr>
<tr id="S4.T3.6.6.9" class="ltx_tr">
<td id="S4.T3.6.6.9.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">CMT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</td>
<td id="S4.T3.6.6.9.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">16.2</td>
<td id="S4.T3.6.6.9.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.42</td>
<td id="S4.T3.6.6.9.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.18</td>
<td id="S4.T3.6.6.9.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">3.70</td>
<td id="S4.T3.6.6.9.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.82</td>
<td id="S4.T3.6.6.9.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.34</td>
</tr>
<tr id="S4.T3.6.6.10" class="ltx_tr">
<td id="S4.T3.6.6.10.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Video2Music <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</td>
<td id="S4.T3.6.6.10.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">24.7</td>
<td id="S4.T3.6.6.10.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.35</td>
<td id="S4.T3.6.6.10.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.19</td>
<td id="S4.T3.6.6.10.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">4.36</td>
<td id="S4.T3.6.6.10.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.93</td>
<td id="S4.T3.6.6.10.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.29</td>
</tr>
<tr id="S4.T3.6.6.11" class="ltx_tr">
<td id="S4.T3.6.6.11.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="7"><span id="S4.T3.6.6.11.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Waveform Music</span></td>
</tr>
<tr id="S4.T3.6.6.12" class="ltx_tr">
<td id="S4.T3.6.6.12.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">VidMusicGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S4.T3.6.6.12.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">6.91</td>
<td id="S4.T3.6.6.12.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.26</td>
<td id="S4.T3.6.6.12.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.17</td>
<td id="S4.T3.6.6.12.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">2.93</td>
<td id="S4.T3.6.6.12.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.60</td>
<td id="S4.T3.6.6.12.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.25</td>
</tr>
<tr id="S4.T3.6.6.13" class="ltx_tr">
<td id="S4.T3.6.6.13.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Vid2MLDM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T3.6.6.13.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">8.99</td>
<td id="S4.T3.6.6.13.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.15</td>
<td id="S4.T3.6.6.13.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.20</td>
<td id="S4.T3.6.6.13.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">3.21</td>
<td id="S4.T3.6.6.13.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.41</td>
<td id="S4.T3.6.6.13.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.32</td>
</tr>
<tr id="S4.T3.6.6.14" class="ltx_tr">
<td id="S4.T3.6.6.14.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">V2Meow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T3.6.6.14.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">4.62</td>
<td id="S4.T3.6.6.14.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">-</td>
<td id="S4.T3.6.6.14.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">-</td>
<td id="S4.T3.6.6.14.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">-</td>
<td id="S4.T3.6.6.14.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">-</td>
<td id="S4.T3.6.6.14.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">-</td>
</tr>
<tr id="S4.T3.6.6.15" class="ltx_tr">
<td id="S4.T3.6.6.15.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="7"><span id="S4.T3.6.6.15.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Waveform Music</span></td>
</tr>
<tr id="S4.T3.6.6.16" class="ltx_tr">
<td id="S4.T3.6.6.16.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S4.T3.6.6.16.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> (Ours)</td>
<td id="S4.T3.6.6.16.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.2.1" class="ltx_text ltx_font_bold">4.07</span></td>
<td id="S4.T3.6.6.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.3.1" class="ltx_text ltx_font_bold">1.09</span></td>
<td id="S4.T3.6.6.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.4.1" class="ltx_text ltx_font_bold">0.22</span></td>
<td id="S4.T3.6.6.16.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.5.1" class="ltx_text ltx_font_bold">2.38</span></td>
<td id="S4.T3.6.6.16.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.6.1" class="ltx_text ltx_font_bold">1.34</span></td>
<td id="S4.T3.6.6.16.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T3.6.6.16.7.1" class="ltx_text ltx_font_bold">0.35</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S4.SS4.p4" class="ltx_para ltx_noindent">
<p id="S4.SS4.p4.14" class="ltx_p"><span id="S4.SS4.p4.14.1" class="ltx_text ltx_font_bold">Video-Beat Alignment Scheme.</span>
Compared to the high-level contrastive video-music matching objective above, our video-beat alignment scheme encourages low-level alignment between generated music and video dynamics (e.g., scene transitions, rhythmic human motions, etc.).
Our proposed video-beat alignment scheme (shown in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.3 Autoregressive Music Generation ‣ 4 Technical Approach ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) consists of several steps. First, we detect the music beats via off-the-shelf onset detection algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
Formally, we denote the detected music beats as <math id="S4.SS4.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{P}_{a}\in\mathbb{R}^{t_{a}}" display="inline"><semantics id="S4.SS4.p4.1.m1.1a"><mrow id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml"><msub id="S4.SS4.p4.1.m1.1.1.2" xref="S4.SS4.p4.1.m1.1.1.2.cmml"><mi id="S4.SS4.p4.1.m1.1.1.2.2" xref="S4.SS4.p4.1.m1.1.1.2.2.cmml">𝐏</mi><mi id="S4.SS4.p4.1.m1.1.1.2.3" xref="S4.SS4.p4.1.m1.1.1.2.3.cmml">a</mi></msub><mo id="S4.SS4.p4.1.m1.1.1.1" xref="S4.SS4.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.p4.1.m1.1.1.3" xref="S4.SS4.p4.1.m1.1.1.3.cmml"><mi id="S4.SS4.p4.1.m1.1.1.3.2" xref="S4.SS4.p4.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS4.p4.1.m1.1.1.3.3" xref="S4.SS4.p4.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.p4.1.m1.1.1.3.3.2" xref="S4.SS4.p4.1.m1.1.1.3.3.2.cmml">t</mi><mi id="S4.SS4.p4.1.m1.1.1.3.3.3" xref="S4.SS4.p4.1.m1.1.1.3.3.3.cmml">a</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><apply id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1"><in id="S4.SS4.p4.1.m1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1.1"></in><apply id="S4.SS4.p4.1.m1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.1.1.2.2">𝐏</ci><ci id="S4.SS4.p4.1.m1.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.1.1.2.3">𝑎</ci></apply><apply id="S4.SS4.p4.1.m1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.3.2.cmml" xref="S4.SS4.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS4.p4.1.m1.1.1.3.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.3.3.2.cmml" xref="S4.SS4.p4.1.m1.1.1.3.3.2">𝑡</ci><ci id="S4.SS4.p4.1.m1.1.1.3.3.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">\mathbf{P}_{a}\in\mathbb{R}^{t_{a}}</annotation></semantics></math>, where <math id="S4.SS4.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{P}_{a}[t]" display="inline"><semantics id="S4.SS4.p4.2.m2.1a"><mrow id="S4.SS4.p4.2.m2.1.2" xref="S4.SS4.p4.2.m2.1.2.cmml"><msub id="S4.SS4.p4.2.m2.1.2.2" xref="S4.SS4.p4.2.m2.1.2.2.cmml"><mi id="S4.SS4.p4.2.m2.1.2.2.2" xref="S4.SS4.p4.2.m2.1.2.2.2.cmml">𝐏</mi><mi id="S4.SS4.p4.2.m2.1.2.2.3" xref="S4.SS4.p4.2.m2.1.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p4.2.m2.1.2.1" xref="S4.SS4.p4.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS4.p4.2.m2.1.2.3.2" xref="S4.SS4.p4.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p4.2.m2.1.2.3.2.1" xref="S4.SS4.p4.2.m2.1.2.3.1.1.cmml">[</mo><mi id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS4.p4.2.m2.1.2.3.2.2" xref="S4.SS4.p4.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b"><apply id="S4.SS4.p4.2.m2.1.2.cmml" xref="S4.SS4.p4.2.m2.1.2"><times id="S4.SS4.p4.2.m2.1.2.1.cmml" xref="S4.SS4.p4.2.m2.1.2.1"></times><apply id="S4.SS4.p4.2.m2.1.2.2.cmml" xref="S4.SS4.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.1.2.2.1.cmml" xref="S4.SS4.p4.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS4.p4.2.m2.1.2.2.2.cmml" xref="S4.SS4.p4.2.m2.1.2.2.2">𝐏</ci><ci id="S4.SS4.p4.2.m2.1.2.2.3.cmml" xref="S4.SS4.p4.2.m2.1.2.2.3">𝑎</ci></apply><apply id="S4.SS4.p4.2.m2.1.2.3.1.cmml" xref="S4.SS4.p4.2.m2.1.2.3.2"><csymbol cd="latexml" id="S4.SS4.p4.2.m2.1.2.3.1.1.cmml" xref="S4.SS4.p4.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">\mathbf{P}_{a}[t]</annotation></semantics></math> is set to <math id="S4.SS4.p4.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS4.p4.3.m3.1a"><mn id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b"><cn type="integer" id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">1</annotation></semantics></math> if a music beat was detected at timestep <math id="S4.SS4.p4.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS4.p4.4.m4.1a"><mi id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b"><ci id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">t</annotation></semantics></math>; otherwise, it is set to <math id="S4.SS4.p4.5.m5.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS4.p4.5.m5.1a"><mn id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b"><cn type="integer" id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">0</cn></annotation-xml></semantics></math>.
Afterward, we identify ”video beats” by examining the magnitude of optical flow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> computed for all consecutive video frames in the video. We then spatially average the optical flow magnitudes across all pixels to compute the optical flow magnitude for each frame pair and store these values in <math id="S4.SS4.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{O}\in\mathbb{R}^{t_{a}}" display="inline"><semantics id="S4.SS4.p4.6.m6.1a"><mrow id="S4.SS4.p4.6.m6.1.1" xref="S4.SS4.p4.6.m6.1.1.cmml"><mi id="S4.SS4.p4.6.m6.1.1.2" xref="S4.SS4.p4.6.m6.1.1.2.cmml">𝐎</mi><mo id="S4.SS4.p4.6.m6.1.1.1" xref="S4.SS4.p4.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS4.p4.6.m6.1.1.3" xref="S4.SS4.p4.6.m6.1.1.3.cmml"><mi id="S4.SS4.p4.6.m6.1.1.3.2" xref="S4.SS4.p4.6.m6.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS4.p4.6.m6.1.1.3.3" xref="S4.SS4.p4.6.m6.1.1.3.3.cmml"><mi id="S4.SS4.p4.6.m6.1.1.3.3.2" xref="S4.SS4.p4.6.m6.1.1.3.3.2.cmml">t</mi><mi id="S4.SS4.p4.6.m6.1.1.3.3.3" xref="S4.SS4.p4.6.m6.1.1.3.3.3.cmml">a</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.6.m6.1b"><apply id="S4.SS4.p4.6.m6.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1"><in id="S4.SS4.p4.6.m6.1.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1.1"></in><ci id="S4.SS4.p4.6.m6.1.1.2.cmml" xref="S4.SS4.p4.6.m6.1.1.2">𝐎</ci><apply id="S4.SS4.p4.6.m6.1.1.3.cmml" xref="S4.SS4.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.1.1.3.1.cmml" xref="S4.SS4.p4.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS4.p4.6.m6.1.1.3.2.cmml" xref="S4.SS4.p4.6.m6.1.1.3.2">ℝ</ci><apply id="S4.SS4.p4.6.m6.1.1.3.3.cmml" xref="S4.SS4.p4.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.1.1.3.3.1.cmml" xref="S4.SS4.p4.6.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS4.p4.6.m6.1.1.3.3.2.cmml" xref="S4.SS4.p4.6.m6.1.1.3.3.2">𝑡</ci><ci id="S4.SS4.p4.6.m6.1.1.3.3.3.cmml" xref="S4.SS4.p4.6.m6.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.6.m6.1c">\mathbf{O}\in\mathbb{R}^{t_{a}}</annotation></semantics></math> that is linearly interpolated to match the dimension of the music beats <math id="S4.SS4.p4.7.m7.1" class="ltx_Math" alttext="\mathbf{P}_{a}" display="inline"><semantics id="S4.SS4.p4.7.m7.1a"><msub id="S4.SS4.p4.7.m7.1.1" xref="S4.SS4.p4.7.m7.1.1.cmml"><mi id="S4.SS4.p4.7.m7.1.1.2" xref="S4.SS4.p4.7.m7.1.1.2.cmml">𝐏</mi><mi id="S4.SS4.p4.7.m7.1.1.3" xref="S4.SS4.p4.7.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.7.m7.1b"><apply id="S4.SS4.p4.7.m7.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.7.m7.1.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p4.7.m7.1.1.2.cmml" xref="S4.SS4.p4.7.m7.1.1.2">𝐏</ci><ci id="S4.SS4.p4.7.m7.1.1.3.cmml" xref="S4.SS4.p4.7.m7.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.7.m7.1c">\mathbf{P}_{a}</annotation></semantics></math>.
Afterward, to obtain “video beats” <math id="S4.SS4.p4.8.m8.1" class="ltx_Math" alttext="\mathbf{P}_{v}\in\mathbb{R}^{t_{a}}" display="inline"><semantics id="S4.SS4.p4.8.m8.1a"><mrow id="S4.SS4.p4.8.m8.1.1" xref="S4.SS4.p4.8.m8.1.1.cmml"><msub id="S4.SS4.p4.8.m8.1.1.2" xref="S4.SS4.p4.8.m8.1.1.2.cmml"><mi id="S4.SS4.p4.8.m8.1.1.2.2" xref="S4.SS4.p4.8.m8.1.1.2.2.cmml">𝐏</mi><mi id="S4.SS4.p4.8.m8.1.1.2.3" xref="S4.SS4.p4.8.m8.1.1.2.3.cmml">v</mi></msub><mo id="S4.SS4.p4.8.m8.1.1.1" xref="S4.SS4.p4.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS4.p4.8.m8.1.1.3" xref="S4.SS4.p4.8.m8.1.1.3.cmml"><mi id="S4.SS4.p4.8.m8.1.1.3.2" xref="S4.SS4.p4.8.m8.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS4.p4.8.m8.1.1.3.3" xref="S4.SS4.p4.8.m8.1.1.3.3.cmml"><mi id="S4.SS4.p4.8.m8.1.1.3.3.2" xref="S4.SS4.p4.8.m8.1.1.3.3.2.cmml">t</mi><mi id="S4.SS4.p4.8.m8.1.1.3.3.3" xref="S4.SS4.p4.8.m8.1.1.3.3.3.cmml">a</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.8.m8.1b"><apply id="S4.SS4.p4.8.m8.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1"><in id="S4.SS4.p4.8.m8.1.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1.1"></in><apply id="S4.SS4.p4.8.m8.1.1.2.cmml" xref="S4.SS4.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.8.m8.1.1.2.1.cmml" xref="S4.SS4.p4.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS4.p4.8.m8.1.1.2.2.cmml" xref="S4.SS4.p4.8.m8.1.1.2.2">𝐏</ci><ci id="S4.SS4.p4.8.m8.1.1.2.3.cmml" xref="S4.SS4.p4.8.m8.1.1.2.3">𝑣</ci></apply><apply id="S4.SS4.p4.8.m8.1.1.3.cmml" xref="S4.SS4.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.8.m8.1.1.3.1.cmml" xref="S4.SS4.p4.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS4.p4.8.m8.1.1.3.2.cmml" xref="S4.SS4.p4.8.m8.1.1.3.2">ℝ</ci><apply id="S4.SS4.p4.8.m8.1.1.3.3.cmml" xref="S4.SS4.p4.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p4.8.m8.1.1.3.3.1.cmml" xref="S4.SS4.p4.8.m8.1.1.3.3">subscript</csymbol><ci id="S4.SS4.p4.8.m8.1.1.3.3.2.cmml" xref="S4.SS4.p4.8.m8.1.1.3.3.2">𝑡</ci><ci id="S4.SS4.p4.8.m8.1.1.3.3.3.cmml" xref="S4.SS4.p4.8.m8.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.8.m8.1c">\mathbf{P}_{v}\in\mathbb{R}^{t_{a}}</annotation></semantics></math>, we set <math id="S4.SS4.p4.9.m9.1" class="ltx_Math" alttext="\mathbf{P}_{v}[t]" display="inline"><semantics id="S4.SS4.p4.9.m9.1a"><mrow id="S4.SS4.p4.9.m9.1.2" xref="S4.SS4.p4.9.m9.1.2.cmml"><msub id="S4.SS4.p4.9.m9.1.2.2" xref="S4.SS4.p4.9.m9.1.2.2.cmml"><mi id="S4.SS4.p4.9.m9.1.2.2.2" xref="S4.SS4.p4.9.m9.1.2.2.2.cmml">𝐏</mi><mi id="S4.SS4.p4.9.m9.1.2.2.3" xref="S4.SS4.p4.9.m9.1.2.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p4.9.m9.1.2.1" xref="S4.SS4.p4.9.m9.1.2.1.cmml">​</mo><mrow id="S4.SS4.p4.9.m9.1.2.3.2" xref="S4.SS4.p4.9.m9.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p4.9.m9.1.2.3.2.1" xref="S4.SS4.p4.9.m9.1.2.3.1.1.cmml">[</mo><mi id="S4.SS4.p4.9.m9.1.1" xref="S4.SS4.p4.9.m9.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS4.p4.9.m9.1.2.3.2.2" xref="S4.SS4.p4.9.m9.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.9.m9.1b"><apply id="S4.SS4.p4.9.m9.1.2.cmml" xref="S4.SS4.p4.9.m9.1.2"><times id="S4.SS4.p4.9.m9.1.2.1.cmml" xref="S4.SS4.p4.9.m9.1.2.1"></times><apply id="S4.SS4.p4.9.m9.1.2.2.cmml" xref="S4.SS4.p4.9.m9.1.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.1.2.2.1.cmml" xref="S4.SS4.p4.9.m9.1.2.2">subscript</csymbol><ci id="S4.SS4.p4.9.m9.1.2.2.2.cmml" xref="S4.SS4.p4.9.m9.1.2.2.2">𝐏</ci><ci id="S4.SS4.p4.9.m9.1.2.2.3.cmml" xref="S4.SS4.p4.9.m9.1.2.2.3">𝑣</ci></apply><apply id="S4.SS4.p4.9.m9.1.2.3.1.cmml" xref="S4.SS4.p4.9.m9.1.2.3.2"><csymbol cd="latexml" id="S4.SS4.p4.9.m9.1.2.3.1.1.cmml" xref="S4.SS4.p4.9.m9.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.p4.9.m9.1.1.cmml" xref="S4.SS4.p4.9.m9.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.9.m9.1c">\mathbf{P}_{v}[t]</annotation></semantics></math> for each timestep <math id="S4.SS4.p4.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS4.p4.10.m10.1a"><mi id="S4.SS4.p4.10.m10.1.1" xref="S4.SS4.p4.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.10.m10.1b"><ci id="S4.SS4.p4.10.m10.1.1.cmml" xref="S4.SS4.p4.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.10.m10.1c">t</annotation></semantics></math> to 1 when <math id="S4.SS4.p4.11.m11.1" class="ltx_Math" alttext="\mathbf{O}[t]" display="inline"><semantics id="S4.SS4.p4.11.m11.1a"><mrow id="S4.SS4.p4.11.m11.1.2" xref="S4.SS4.p4.11.m11.1.2.cmml"><mi id="S4.SS4.p4.11.m11.1.2.2" xref="S4.SS4.p4.11.m11.1.2.2.cmml">𝐎</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p4.11.m11.1.2.1" xref="S4.SS4.p4.11.m11.1.2.1.cmml">​</mo><mrow id="S4.SS4.p4.11.m11.1.2.3.2" xref="S4.SS4.p4.11.m11.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p4.11.m11.1.2.3.2.1" xref="S4.SS4.p4.11.m11.1.2.3.1.1.cmml">[</mo><mi id="S4.SS4.p4.11.m11.1.1" xref="S4.SS4.p4.11.m11.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS4.p4.11.m11.1.2.3.2.2" xref="S4.SS4.p4.11.m11.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.11.m11.1b"><apply id="S4.SS4.p4.11.m11.1.2.cmml" xref="S4.SS4.p4.11.m11.1.2"><times id="S4.SS4.p4.11.m11.1.2.1.cmml" xref="S4.SS4.p4.11.m11.1.2.1"></times><ci id="S4.SS4.p4.11.m11.1.2.2.cmml" xref="S4.SS4.p4.11.m11.1.2.2">𝐎</ci><apply id="S4.SS4.p4.11.m11.1.2.3.1.cmml" xref="S4.SS4.p4.11.m11.1.2.3.2"><csymbol cd="latexml" id="S4.SS4.p4.11.m11.1.2.3.1.1.cmml" xref="S4.SS4.p4.11.m11.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.p4.11.m11.1.1.cmml" xref="S4.SS4.p4.11.m11.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.11.m11.1c">\mathbf{O}[t]</annotation></semantics></math> is the maximum in a temporal window of <math id="S4.SS4.p4.12.m12.1" class="ltx_math_unparsed" alttext="\mathbf{O}[t-\delta:t+\delta]" display="inline"><semantics id="S4.SS4.p4.12.m12.1a"><mrow id="S4.SS4.p4.12.m12.1b"><mi id="S4.SS4.p4.12.m12.1.1">𝐎</mi><mrow id="S4.SS4.p4.12.m12.1.2"><mo stretchy="false" id="S4.SS4.p4.12.m12.1.2.1">[</mo><mi id="S4.SS4.p4.12.m12.1.2.2">t</mi><mo id="S4.SS4.p4.12.m12.1.2.3">−</mo><mi id="S4.SS4.p4.12.m12.1.2.4">δ</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS4.p4.12.m12.1.2.5">:</mo><mi id="S4.SS4.p4.12.m12.1.2.6">t</mi><mo id="S4.SS4.p4.12.m12.1.2.7">+</mo><mi id="S4.SS4.p4.12.m12.1.2.8">δ</mi><mo stretchy="false" id="S4.SS4.p4.12.m12.1.2.9">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS4.p4.12.m12.1c">\mathbf{O}[t-\delta:t+\delta]</annotation></semantics></math>, otherwise <math id="S4.SS4.p4.13.m13.1" class="ltx_Math" alttext="\mathbf{P}_{v}[t]=0" display="inline"><semantics id="S4.SS4.p4.13.m13.1a"><mrow id="S4.SS4.p4.13.m13.1.2" xref="S4.SS4.p4.13.m13.1.2.cmml"><mrow id="S4.SS4.p4.13.m13.1.2.2" xref="S4.SS4.p4.13.m13.1.2.2.cmml"><msub id="S4.SS4.p4.13.m13.1.2.2.2" xref="S4.SS4.p4.13.m13.1.2.2.2.cmml"><mi id="S4.SS4.p4.13.m13.1.2.2.2.2" xref="S4.SS4.p4.13.m13.1.2.2.2.2.cmml">𝐏</mi><mi id="S4.SS4.p4.13.m13.1.2.2.2.3" xref="S4.SS4.p4.13.m13.1.2.2.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p4.13.m13.1.2.2.1" xref="S4.SS4.p4.13.m13.1.2.2.1.cmml">​</mo><mrow id="S4.SS4.p4.13.m13.1.2.2.3.2" xref="S4.SS4.p4.13.m13.1.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p4.13.m13.1.2.2.3.2.1" xref="S4.SS4.p4.13.m13.1.2.2.3.1.1.cmml">[</mo><mi id="S4.SS4.p4.13.m13.1.1" xref="S4.SS4.p4.13.m13.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS4.p4.13.m13.1.2.2.3.2.2" xref="S4.SS4.p4.13.m13.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.SS4.p4.13.m13.1.2.1" xref="S4.SS4.p4.13.m13.1.2.1.cmml">=</mo><mn id="S4.SS4.p4.13.m13.1.2.3" xref="S4.SS4.p4.13.m13.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.13.m13.1b"><apply id="S4.SS4.p4.13.m13.1.2.cmml" xref="S4.SS4.p4.13.m13.1.2"><eq id="S4.SS4.p4.13.m13.1.2.1.cmml" xref="S4.SS4.p4.13.m13.1.2.1"></eq><apply id="S4.SS4.p4.13.m13.1.2.2.cmml" xref="S4.SS4.p4.13.m13.1.2.2"><times id="S4.SS4.p4.13.m13.1.2.2.1.cmml" xref="S4.SS4.p4.13.m13.1.2.2.1"></times><apply id="S4.SS4.p4.13.m13.1.2.2.2.cmml" xref="S4.SS4.p4.13.m13.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.13.m13.1.2.2.2.1.cmml" xref="S4.SS4.p4.13.m13.1.2.2.2">subscript</csymbol><ci id="S4.SS4.p4.13.m13.1.2.2.2.2.cmml" xref="S4.SS4.p4.13.m13.1.2.2.2.2">𝐏</ci><ci id="S4.SS4.p4.13.m13.1.2.2.2.3.cmml" xref="S4.SS4.p4.13.m13.1.2.2.2.3">𝑣</ci></apply><apply id="S4.SS4.p4.13.m13.1.2.2.3.1.cmml" xref="S4.SS4.p4.13.m13.1.2.2.3.2"><csymbol cd="latexml" id="S4.SS4.p4.13.m13.1.2.2.3.1.1.cmml" xref="S4.SS4.p4.13.m13.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.p4.13.m13.1.1.cmml" xref="S4.SS4.p4.13.m13.1.1">𝑡</ci></apply></apply><cn type="integer" id="S4.SS4.p4.13.m13.1.2.3.cmml" xref="S4.SS4.p4.13.m13.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.13.m13.1c">\mathbf{P}_{v}[t]=0</annotation></semantics></math>. Here, <math id="S4.SS4.p4.14.m14.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S4.SS4.p4.14.m14.1a"><mi id="S4.SS4.p4.14.m14.1.1" xref="S4.SS4.p4.14.m14.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.14.m14.1b"><ci id="S4.SS4.p4.14.m14.1.1.cmml" xref="S4.SS4.p4.14.m14.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.14.m14.1c">\delta</annotation></semantics></math> serves as a hyperparameter for controlling the size of a local temporal window, which determines the granularity of actions we aim to capture.
Conceptually, we aim to capture the timesteps corresponding to large optical flow values since they likely depict the dynamic video moments (e.g., human motions, scene changes, etc.).
Finally, we compute the overlap between the detected music and video beats as:</p>
<table id="S4.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{P}_{av}[i]=\begin{cases}1&amp;\text{if}\hskip 3.00003pt\mathbf{P}_{v}[i]=1\hskip 3.00003pt\text{and}\hskip 3.00003pt\sum_{j=-\delta}^{\delta}\mathbf{P}_{a}[i+j]&gt;0\\
\alpha&amp;\text{else}\hskip 3.00003pt.\\
\end{cases}" display="inline"><semantics id="S4.E3X.2.1.1.m1.1a"><mrow id="S4.E3X.2.1.1.m1.1.2" xref="S4.E3X.2.1.1.m1.1.2.cmml"><mrow id="S4.E3X.2.1.1.m1.1.2.2" xref="S4.E3X.2.1.1.m1.1.2.2.cmml"><msub id="S4.E3X.2.1.1.m1.1.2.2.2" xref="S4.E3X.2.1.1.m1.1.2.2.2.cmml"><mi id="S4.E3X.2.1.1.m1.1.2.2.2.2" xref="S4.E3X.2.1.1.m1.1.2.2.2.2.cmml">𝐏</mi><mrow id="S4.E3X.2.1.1.m1.1.2.2.2.3" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.1.2.2.2.3.2" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E3X.2.1.1.m1.1.2.2.2.3.1" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.E3X.2.1.1.m1.1.2.2.2.3.3" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.3.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E3X.2.1.1.m1.1.2.2.1" xref="S4.E3X.2.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S4.E3X.2.1.1.m1.1.2.2.3.2" xref="S4.E3X.2.1.1.m1.1.2.2.3.1.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.1.2.2.3.2.1" xref="S4.E3X.2.1.1.m1.1.2.2.3.1.1.cmml">[</mo><mi id="S4.E3X.2.1.1.m1.1.1" xref="S4.E3X.2.1.1.m1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3X.2.1.1.m1.1.2.2.3.2.2" xref="S4.E3X.2.1.1.m1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E3X.2.1.1.m1.1.2.1" xref="S4.E3X.2.1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.E3.m1.4.4.4.4.4.4a" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mo id="S4.E3.m1.4.4.4.4.4.4a.5" xref="S4.E3X.2.1.1.m1.1.2.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E3.m1.4.4.4.4.4.4.4a" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mtr id="S4.E3.m1.4.4.4.4.4.4.4aa" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4.4.4.4.4ab" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.mf" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4.4.4.4.4ac" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml"><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml"><mtext id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2a.cmml">if</mtext><mo lspace="0.300em" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml">​</mo><msub id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.2.cmml">𝐏</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1a" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.1.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.2.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.1.1.cmml">[</mo><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.1.cmml">i</mi><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.5" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml">=</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml"><mn id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml">1</mn><mo lspace="0.300em" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml">​</mo><mtext id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4a.cmml">and</mtext><mo lspace="0.467em" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2a" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml"><msubsup id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.cmml"><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.2.cmml">j</mi><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.1.cmml">=</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.cmml"><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3a" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.cmml">−</mo><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.2.cmml">δ</mi></mrow></mrow><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.3.cmml">δ</mi></msubsup><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.cmml"><msub id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.2.cmml">𝐏</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.2.1.cmml">[</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.3.cmml">j</mi></mrow><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.6" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml">&gt;</mo><mn id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.7" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.7.cmml">0</mn></mrow></mtd></mtr><mtr id="S4.E3.m1.4.4.4.4.4.4.4ad" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4.4.4.4.4ae" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mi id="S4.E3.m1.3.3.3.3.3.3.3.3.1.1.mf" xref="S4.E3.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml">α</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4.4.4.4.4af" xref="S4.E3X.2.1.1.m1.1.2.3.1.cmml"><mrow id="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.3" xref="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1a.cmml"><mtext id="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1" xref="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1.cmml">else</mtext><mo lspace="0.300em" id="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.3.1" xref="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1a.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.1b"><apply id="S4.E3X.2.1.1.m1.1.2.cmml" xref="S4.E3X.2.1.1.m1.1.2"><eq id="S4.E3X.2.1.1.m1.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.1"></eq><apply id="S4.E3X.2.1.1.m1.1.2.2.cmml" xref="S4.E3X.2.1.1.m1.1.2.2"><times id="S4.E3X.2.1.1.m1.1.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.1"></times><apply id="S4.E3X.2.1.1.m1.1.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.1.2.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.1.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2.2">𝐏</ci><apply id="S4.E3X.2.1.1.m1.1.2.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2.3"><times id="S4.E3X.2.1.1.m1.1.2.2.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.1"></times><ci id="S4.E3X.2.1.1.m1.1.2.2.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.2">𝑎</ci><ci id="S4.E3X.2.1.1.m1.1.2.2.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.2.3.3">𝑣</ci></apply></apply><apply id="S4.E3X.2.1.1.m1.1.2.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.3.2"><csymbol cd="latexml" id="S4.E3X.2.1.1.m1.1.2.2.3.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S4.E3X.2.1.1.m1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1">𝑖</ci></apply></apply><apply id="S4.E3X.2.1.1.m1.1.2.3.1.cmml" xref="S4.E3.m1.4.4.4.4.4.4a"><csymbol cd="latexml" id="S4.E3X.2.1.1.m1.1.2.3.1.1.cmml" xref="S4.E3.m1.4.4.4.4.4.4a.5">cases</csymbol><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.mf">1</cn><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf"><and id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mfa.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf"></and><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mfb.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf"><eq id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.5"></eq><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4"><times id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1"></times><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2a.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2"><mtext id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2">if</mtext></ci><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.2">𝐏</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.3">𝑣</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.2"><csymbol cd="latexml" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.2.1">delimited-[]</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.1">𝑖</ci></apply></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2"><times id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2"></times><cn type="integer" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3">1</cn><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4a.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4"><mtext id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4">and</mtext></ci><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1"><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2">superscript</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2">subscript</csymbol><sum id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.2"></sum><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3"><eq id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.1"></eq><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.2">𝑗</ci><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3"><minus id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3"></minus><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.2.3.3.2">𝛿</ci></apply></apply></apply><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.2.3">𝛿</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1"><times id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.2"></times><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.2">𝐏</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.3.3">𝑎</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1"><plus id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.1"></plus><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.2">𝑖</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mfc.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf"><gt id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.6"></gt><share href="#S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mfd.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf"></share><cn type="integer" id="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.7.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.1.mf.7">0</cn></apply></apply><ci id="S4.E3.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3.1.1.mf">𝛼</ci><ci id="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1a.cmml" xref="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.3"><mtext id="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1.cmml" xref="S4.E3.m1.4.4.4.4.4.4.4.4.2.1.mf.1">else</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.1c">\displaystyle\mathbf{P}_{av}[i]=\begin{cases}1&amp;\text{if}\hskip 3.00003pt\mathbf{P}_{v}[i]=1\hskip 3.00003pt\text{and}\hskip 3.00003pt\sum_{j=-\delta}^{\delta}\mathbf{P}_{a}[i+j]&gt;0\\
\alpha&amp;\text{else}\hskip 3.00003pt.\\
\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS4.p5" class="ltx_para">
<p id="S4.SS4.p5.4" class="ltx_p">Intuitively, the formulation above computes the overlapping video-music beats by checking whether the video beats <math id="S4.SS4.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{P}_{v}[i]" display="inline"><semantics id="S4.SS4.p5.1.m1.1a"><mrow id="S4.SS4.p5.1.m1.1.2" xref="S4.SS4.p5.1.m1.1.2.cmml"><msub id="S4.SS4.p5.1.m1.1.2.2" xref="S4.SS4.p5.1.m1.1.2.2.cmml"><mi id="S4.SS4.p5.1.m1.1.2.2.2" xref="S4.SS4.p5.1.m1.1.2.2.2.cmml">𝐏</mi><mi id="S4.SS4.p5.1.m1.1.2.2.3" xref="S4.SS4.p5.1.m1.1.2.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p5.1.m1.1.2.1" xref="S4.SS4.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS4.p5.1.m1.1.2.3.2" xref="S4.SS4.p5.1.m1.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p5.1.m1.1.2.3.2.1" xref="S4.SS4.p5.1.m1.1.2.3.1.1.cmml">[</mo><mi id="S4.SS4.p5.1.m1.1.1" xref="S4.SS4.p5.1.m1.1.1.cmml">i</mi><mo stretchy="false" id="S4.SS4.p5.1.m1.1.2.3.2.2" xref="S4.SS4.p5.1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.1.m1.1b"><apply id="S4.SS4.p5.1.m1.1.2.cmml" xref="S4.SS4.p5.1.m1.1.2"><times id="S4.SS4.p5.1.m1.1.2.1.cmml" xref="S4.SS4.p5.1.m1.1.2.1"></times><apply id="S4.SS4.p5.1.m1.1.2.2.cmml" xref="S4.SS4.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS4.p5.1.m1.1.2.2.1.cmml" xref="S4.SS4.p5.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS4.p5.1.m1.1.2.2.2.cmml" xref="S4.SS4.p5.1.m1.1.2.2.2">𝐏</ci><ci id="S4.SS4.p5.1.m1.1.2.2.3.cmml" xref="S4.SS4.p5.1.m1.1.2.2.3">𝑣</ci></apply><apply id="S4.SS4.p5.1.m1.1.2.3.1.cmml" xref="S4.SS4.p5.1.m1.1.2.3.2"><csymbol cd="latexml" id="S4.SS4.p5.1.m1.1.2.3.1.1.cmml" xref="S4.SS4.p5.1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.p5.1.m1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.1.m1.1c">\mathbf{P}_{v}[i]</annotation></semantics></math> match the music beats in a window <math id="S4.SS4.p5.2.m2.1" class="ltx_math_unparsed" alttext="\mathbf{P}_{a}[i-\delta:i+\delta]" display="inline"><semantics id="S4.SS4.p5.2.m2.1a"><mrow id="S4.SS4.p5.2.m2.1b"><msub id="S4.SS4.p5.2.m2.1.1"><mi id="S4.SS4.p5.2.m2.1.1.2">𝐏</mi><mi id="S4.SS4.p5.2.m2.1.1.3">a</mi></msub><mrow id="S4.SS4.p5.2.m2.1.2"><mo stretchy="false" id="S4.SS4.p5.2.m2.1.2.1">[</mo><mi id="S4.SS4.p5.2.m2.1.2.2">i</mi><mo id="S4.SS4.p5.2.m2.1.2.3">−</mo><mi id="S4.SS4.p5.2.m2.1.2.4">δ</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS4.p5.2.m2.1.2.5">:</mo><mi id="S4.SS4.p5.2.m2.1.2.6">i</mi><mo id="S4.SS4.p5.2.m2.1.2.7">+</mo><mi id="S4.SS4.p5.2.m2.1.2.8">δ</mi><mo stretchy="false" id="S4.SS4.p5.2.m2.1.2.9">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS4.p5.2.m2.1c">\mathbf{P}_{a}[i-\delta:i+\delta]</annotation></semantics></math>.
We also introduce a hyperparameter <math id="S4.SS4.p5.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS4.p5.3.m3.1a"><mi id="S4.SS4.p5.3.m3.1.1" xref="S4.SS4.p5.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.3.m3.1b"><ci id="S4.SS4.p5.3.m3.1.1.cmml" xref="S4.SS4.p5.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.3.m3.1c">\alpha</annotation></semantics></math> to prevent disproportionately de-emphasizing timesteps without the detected video-music beats during training. The detected video-music beats <math id="S4.SS4.p5.4.m4.1" class="ltx_Math" alttext="\mathbf{P}_{av}" display="inline"><semantics id="S4.SS4.p5.4.m4.1a"><msub id="S4.SS4.p5.4.m4.1.1" xref="S4.SS4.p5.4.m4.1.1.cmml"><mi id="S4.SS4.p5.4.m4.1.1.2" xref="S4.SS4.p5.4.m4.1.1.2.cmml">𝐏</mi><mrow id="S4.SS4.p5.4.m4.1.1.3" xref="S4.SS4.p5.4.m4.1.1.3.cmml"><mi id="S4.SS4.p5.4.m4.1.1.3.2" xref="S4.SS4.p5.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p5.4.m4.1.1.3.1" xref="S4.SS4.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p5.4.m4.1.1.3.3" xref="S4.SS4.p5.4.m4.1.1.3.3.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.4.m4.1b"><apply id="S4.SS4.p5.4.m4.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p5.4.m4.1.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p5.4.m4.1.1.2.cmml" xref="S4.SS4.p5.4.m4.1.1.2">𝐏</ci><apply id="S4.SS4.p5.4.m4.1.1.3.cmml" xref="S4.SS4.p5.4.m4.1.1.3"><times id="S4.SS4.p5.4.m4.1.1.3.1.cmml" xref="S4.SS4.p5.4.m4.1.1.3.1"></times><ci id="S4.SS4.p5.4.m4.1.1.3.2.cmml" xref="S4.SS4.p5.4.m4.1.1.3.2">𝑎</ci><ci id="S4.SS4.p5.4.m4.1.1.3.3.cmml" xref="S4.SS4.p5.4.m4.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.4.m4.1c">\mathbf{P}_{av}</annotation></semantics></math> are then incorporated into our autoregressive generation objective:</p>
</div>
<div id="S4.SS4.p6" class="ltx_para">
<table id="S4.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{g}=-\sum^{c}_{i=1}\mathbf{P}_{av}\mathbf{Y}_{i}\log(\hat{\mathbf{Y}}_{i})," display="inline"><semantics id="S4.E4X.2.1.1.m1.2a"><mrow id="S4.E4X.2.1.1.m1.2.2.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S4.E4X.2.1.1.m1.2.2.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml"><msub id="S4.E4X.2.1.1.m1.2.2.1.1.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4X.2.1.1.m1.2.2.1.1.3.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.3.2.cmml">ℒ</mi><mi id="S4.E4X.2.1.1.m1.2.2.1.1.3.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.3.3.cmml">g</mi></msub><mo id="S4.E4X.2.1.1.m1.2.2.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.cmml"><mo id="S4.E4X.2.1.1.m1.2.2.1.1.1a" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.cmml">−</mo><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.cmml"><munderover id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2a" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.3.cmml">c</mi></munderover></mstyle><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.cmml"><msub id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml">𝐏</mi><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.3.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">​</mo><msub id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.2.cmml">𝐘</mi><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2a" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S4.E4X.2.1.1.m1.1.1" xref="S4.E4X.2.1.1.m1.1.1.cmml">log</mi><mo id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1a" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐘</mi><mo id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4X.2.1.1.m1.2.2.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.2b"><apply id="S4.E4X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1"><eq id="S4.E4X.2.1.1.m1.2.2.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.2"></eq><apply id="S4.E4X.2.1.1.m1.2.2.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.3.2">ℒ</ci><ci id="S4.E4X.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.3.3">𝑔</ci></apply><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1"><minus id="S4.E4X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1"></minus><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1"><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2">subscript</csymbol><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2">superscript</csymbol><sum id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.2"></sum><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.2.3">𝑐</ci></apply><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3"><eq id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.1"></eq><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1"><times id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.2"></times><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.2">𝐏</ci><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3"><times id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.3.3.3">𝑣</ci></apply></apply><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.2">𝐘</ci><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1"><log id="S4.E4X.2.1.1.m1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1"></log><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐘</ci></apply><ci id="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.2c">\displaystyle\mathcal{L}_{g}=-\sum^{c}_{i=1}\mathbf{P}_{av}\mathbf{Y}_{i}\log(\hat{\mathbf{Y}}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS4.p7" class="ltx_para">
<p id="S4.SS4.p7.7" class="ltx_p">where <math id="S4.SS4.p7.1.m1.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S4.SS4.p7.1.m1.1a"><mi id="S4.SS4.p7.1.m1.1.1" xref="S4.SS4.p7.1.m1.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.1.m1.1b"><ci id="S4.SS4.p7.1.m1.1.1.cmml" xref="S4.SS4.p7.1.m1.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.1.m1.1c">\mathbf{Y}</annotation></semantics></math> and <math id="S4.SS4.p7.2.m2.1" class="ltx_Math" alttext="\hat{\mathbf{Y}}" display="inline"><semantics id="S4.SS4.p7.2.m2.1a"><mover accent="true" id="S4.SS4.p7.2.m2.1.1" xref="S4.SS4.p7.2.m2.1.1.cmml"><mi id="S4.SS4.p7.2.m2.1.1.2" xref="S4.SS4.p7.2.m2.1.1.2.cmml">𝐘</mi><mo id="S4.SS4.p7.2.m2.1.1.1" xref="S4.SS4.p7.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.2.m2.1b"><apply id="S4.SS4.p7.2.m2.1.1.cmml" xref="S4.SS4.p7.2.m2.1.1"><ci id="S4.SS4.p7.2.m2.1.1.1.cmml" xref="S4.SS4.p7.2.m2.1.1.1">^</ci><ci id="S4.SS4.p7.2.m2.1.1.2.cmml" xref="S4.SS4.p7.2.m2.1.1.2">𝐘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.2.m2.1c">\hat{\mathbf{Y}}</annotation></semantics></math> are the ground truth and predicted audio tokens, respectively.
Intuitively, the detected video-music beats <math id="S4.SS4.p7.3.m3.1" class="ltx_Math" alttext="\mathbf{P}_{av}" display="inline"><semantics id="S4.SS4.p7.3.m3.1a"><msub id="S4.SS4.p7.3.m3.1.1" xref="S4.SS4.p7.3.m3.1.1.cmml"><mi id="S4.SS4.p7.3.m3.1.1.2" xref="S4.SS4.p7.3.m3.1.1.2.cmml">𝐏</mi><mrow id="S4.SS4.p7.3.m3.1.1.3" xref="S4.SS4.p7.3.m3.1.1.3.cmml"><mi id="S4.SS4.p7.3.m3.1.1.3.2" xref="S4.SS4.p7.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p7.3.m3.1.1.3.1" xref="S4.SS4.p7.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p7.3.m3.1.1.3.3" xref="S4.SS4.p7.3.m3.1.1.3.3.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.3.m3.1b"><apply id="S4.SS4.p7.3.m3.1.1.cmml" xref="S4.SS4.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p7.3.m3.1.1.1.cmml" xref="S4.SS4.p7.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p7.3.m3.1.1.2.cmml" xref="S4.SS4.p7.3.m3.1.1.2">𝐏</ci><apply id="S4.SS4.p7.3.m3.1.1.3.cmml" xref="S4.SS4.p7.3.m3.1.1.3"><times id="S4.SS4.p7.3.m3.1.1.3.1.cmml" xref="S4.SS4.p7.3.m3.1.1.3.1"></times><ci id="S4.SS4.p7.3.m3.1.1.3.2.cmml" xref="S4.SS4.p7.3.m3.1.1.3.2">𝑎</ci><ci id="S4.SS4.p7.3.m3.1.1.3.3.cmml" xref="S4.SS4.p7.3.m3.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.3.m3.1c">\mathbf{P}_{av}</annotation></semantics></math> are used as importance weights to guide our model to generate music beats aligned with low-level visual content.
Note that if all values in <math id="S4.SS4.p7.4.m4.1" class="ltx_Math" alttext="\mathbf{P}_{av}" display="inline"><semantics id="S4.SS4.p7.4.m4.1a"><msub id="S4.SS4.p7.4.m4.1.1" xref="S4.SS4.p7.4.m4.1.1.cmml"><mi id="S4.SS4.p7.4.m4.1.1.2" xref="S4.SS4.p7.4.m4.1.1.2.cmml">𝐏</mi><mrow id="S4.SS4.p7.4.m4.1.1.3" xref="S4.SS4.p7.4.m4.1.1.3.cmml"><mi id="S4.SS4.p7.4.m4.1.1.3.2" xref="S4.SS4.p7.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p7.4.m4.1.1.3.1" xref="S4.SS4.p7.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p7.4.m4.1.1.3.3" xref="S4.SS4.p7.4.m4.1.1.3.3.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.4.m4.1b"><apply id="S4.SS4.p7.4.m4.1.1.cmml" xref="S4.SS4.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p7.4.m4.1.1.1.cmml" xref="S4.SS4.p7.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p7.4.m4.1.1.2.cmml" xref="S4.SS4.p7.4.m4.1.1.2">𝐏</ci><apply id="S4.SS4.p7.4.m4.1.1.3.cmml" xref="S4.SS4.p7.4.m4.1.1.3"><times id="S4.SS4.p7.4.m4.1.1.3.1.cmml" xref="S4.SS4.p7.4.m4.1.1.3.1"></times><ci id="S4.SS4.p7.4.m4.1.1.3.2.cmml" xref="S4.SS4.p7.4.m4.1.1.3.2">𝑎</ci><ci id="S4.SS4.p7.4.m4.1.1.3.3.cmml" xref="S4.SS4.p7.4.m4.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.4.m4.1c">\mathbf{P}_{av}</annotation></semantics></math> are set to <math id="S4.SS4.p7.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS4.p7.5.m5.1a"><mn id="S4.SS4.p7.5.m5.1.1" xref="S4.SS4.p7.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.5.m5.1b"><cn type="integer" id="S4.SS4.p7.5.m5.1.1.cmml" xref="S4.SS4.p7.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.5.m5.1c">1</annotation></semantics></math>, the Eq. <a href="#S4.E4" title="Equation 4 ‣ 4.4 Semantic Video-Music Alignment ‣ 4 Technical Approach ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> represents the standard (i.e., uniformly weighted) autoregressive objective.
Our overall training objective is <math id="S4.SS4.p7.6.m6.1" class="ltx_Math" alttext="\mathcal{L}=\beta\mathcal{L}_{c}+\mathcal{L}_{g}" display="inline"><semantics id="S4.SS4.p7.6.m6.1a"><mrow id="S4.SS4.p7.6.m6.1.1" xref="S4.SS4.p7.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p7.6.m6.1.1.2" xref="S4.SS4.p7.6.m6.1.1.2.cmml">ℒ</mi><mo id="S4.SS4.p7.6.m6.1.1.1" xref="S4.SS4.p7.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS4.p7.6.m6.1.1.3" xref="S4.SS4.p7.6.m6.1.1.3.cmml"><mrow id="S4.SS4.p7.6.m6.1.1.3.2" xref="S4.SS4.p7.6.m6.1.1.3.2.cmml"><mi id="S4.SS4.p7.6.m6.1.1.3.2.2" xref="S4.SS4.p7.6.m6.1.1.3.2.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p7.6.m6.1.1.3.2.1" xref="S4.SS4.p7.6.m6.1.1.3.2.1.cmml">​</mo><msub id="S4.SS4.p7.6.m6.1.1.3.2.3" xref="S4.SS4.p7.6.m6.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p7.6.m6.1.1.3.2.3.2" xref="S4.SS4.p7.6.m6.1.1.3.2.3.2.cmml">ℒ</mi><mi id="S4.SS4.p7.6.m6.1.1.3.2.3.3" xref="S4.SS4.p7.6.m6.1.1.3.2.3.3.cmml">c</mi></msub></mrow><mo id="S4.SS4.p7.6.m6.1.1.3.1" xref="S4.SS4.p7.6.m6.1.1.3.1.cmml">+</mo><msub id="S4.SS4.p7.6.m6.1.1.3.3" xref="S4.SS4.p7.6.m6.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p7.6.m6.1.1.3.3.2" xref="S4.SS4.p7.6.m6.1.1.3.3.2.cmml">ℒ</mi><mi id="S4.SS4.p7.6.m6.1.1.3.3.3" xref="S4.SS4.p7.6.m6.1.1.3.3.3.cmml">g</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.6.m6.1b"><apply id="S4.SS4.p7.6.m6.1.1.cmml" xref="S4.SS4.p7.6.m6.1.1"><eq id="S4.SS4.p7.6.m6.1.1.1.cmml" xref="S4.SS4.p7.6.m6.1.1.1"></eq><ci id="S4.SS4.p7.6.m6.1.1.2.cmml" xref="S4.SS4.p7.6.m6.1.1.2">ℒ</ci><apply id="S4.SS4.p7.6.m6.1.1.3.cmml" xref="S4.SS4.p7.6.m6.1.1.3"><plus id="S4.SS4.p7.6.m6.1.1.3.1.cmml" xref="S4.SS4.p7.6.m6.1.1.3.1"></plus><apply id="S4.SS4.p7.6.m6.1.1.3.2.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2"><times id="S4.SS4.p7.6.m6.1.1.3.2.1.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.1"></times><ci id="S4.SS4.p7.6.m6.1.1.3.2.2.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.2">𝛽</ci><apply id="S4.SS4.p7.6.m6.1.1.3.2.3.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS4.p7.6.m6.1.1.3.2.3.1.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.3">subscript</csymbol><ci id="S4.SS4.p7.6.m6.1.1.3.2.3.2.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.3.2">ℒ</ci><ci id="S4.SS4.p7.6.m6.1.1.3.2.3.3.cmml" xref="S4.SS4.p7.6.m6.1.1.3.2.3.3">𝑐</ci></apply></apply><apply id="S4.SS4.p7.6.m6.1.1.3.3.cmml" xref="S4.SS4.p7.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p7.6.m6.1.1.3.3.1.cmml" xref="S4.SS4.p7.6.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS4.p7.6.m6.1.1.3.3.2.cmml" xref="S4.SS4.p7.6.m6.1.1.3.3.2">ℒ</ci><ci id="S4.SS4.p7.6.m6.1.1.3.3.3.cmml" xref="S4.SS4.p7.6.m6.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.6.m6.1c">\mathcal{L}=\beta\mathcal{L}_{c}+\mathcal{L}_{g}</annotation></semantics></math>, where <math id="S4.SS4.p7.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p7.7.m7.1a"><mi id="S4.SS4.p7.7.m7.1.1" xref="S4.SS4.p7.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p7.7.m7.1b"><ci id="S4.SS4.p7.7.m7.1.1.cmml" xref="S4.SS4.p7.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p7.7.m7.1c">\beta</annotation></semantics></math> is a balancing term between the contrastive and autoregressive terms.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Setup</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Downstream Datasets</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We train our approach on the DISCO-MV training set and evaluate on two video-music datasets test sets: MusicCaps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and our DISCO-MV, which we describe below.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">MusicCaps</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> evaluation set contains <math id="S5.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="2,858" display="inline"><semantics id="S5.I1.i1.p1.1.m1.2a"><mrow id="S5.I1.i1.p1.1.m1.2.3.2" xref="S5.I1.i1.p1.1.m1.2.3.1.cmml"><mn id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml">2</mn><mo id="S5.I1.i1.p1.1.m1.2.3.2.1" xref="S5.I1.i1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S5.I1.i1.p1.1.m1.2.2" xref="S5.I1.i1.p1.1.m1.2.2.cmml">858</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.2b"><list id="S5.I1.i1.p1.1.m1.2.3.1.cmml" xref="S5.I1.i1.p1.1.m1.2.3.2"><cn type="integer" id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1">2</cn><cn type="integer" id="S5.I1.i1.p1.1.m1.2.2.cmml" xref="S5.I1.i1.p1.1.m1.2.2">858</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.2c">2,858</annotation></semantics></math> ten-second music video samples from YouTube paired with captions written by professional musicians.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.2" class="ltx_p"><span id="S5.I1.i2.p1.2.1" class="ltx_text ltx_font_bold">DISCO-MV</span> is our newly curated dataset designed for video-to-music generation. We manually selected <math id="S5.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="1,120" display="inline"><semantics id="S5.I1.i2.p1.1.m1.2a"><mrow id="S5.I1.i2.p1.1.m1.2.3.2" xref="S5.I1.i2.p1.1.m1.2.3.1.cmml"><mn id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">1</mn><mo id="S5.I1.i2.p1.1.m1.2.3.2.1" xref="S5.I1.i2.p1.1.m1.2.3.1.cmml">,</mo><mn id="S5.I1.i2.p1.1.m1.2.2" xref="S5.I1.i2.p1.1.m1.2.2.cmml">120</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.2b"><list id="S5.I1.i2.p1.1.m1.2.3.1.cmml" xref="S5.I1.i2.p1.1.m1.2.3.2"><cn type="integer" id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1">1</cn><cn type="integer" id="S5.I1.i2.p1.1.m1.2.2.cmml" xref="S5.I1.i2.p1.1.m1.2.2">120</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.2c">1,120</annotation></semantics></math> videos for validation and <math id="S5.I1.i2.p1.2.m2.2" class="ltx_Math" alttext="1,086" display="inline"><semantics id="S5.I1.i2.p1.2.m2.2a"><mrow id="S5.I1.i2.p1.2.m2.2.3.2" xref="S5.I1.i2.p1.2.m2.2.3.1.cmml"><mn id="S5.I1.i2.p1.2.m2.1.1" xref="S5.I1.i2.p1.2.m2.1.1.cmml">1</mn><mo id="S5.I1.i2.p1.2.m2.2.3.2.1" xref="S5.I1.i2.p1.2.m2.2.3.1.cmml">,</mo><mn id="S5.I1.i2.p1.2.m2.2.2" xref="S5.I1.i2.p1.2.m2.2.2.cmml">086</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.2.m2.2b"><list id="S5.I1.i2.p1.2.m2.2.3.1.cmml" xref="S5.I1.i2.p1.2.m2.2.3.2"><cn type="integer" id="S5.I1.i2.p1.2.m2.1.1.cmml" xref="S5.I1.i2.p1.2.m2.1.1">1</cn><cn type="integer" id="S5.I1.i2.p1.2.m2.2.2.cmml" xref="S5.I1.i2.p1.2.m2.2.2">086</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.2.m2.2c">1,086</annotation></semantics></math> for testing, ensuring high-quality video-music correspondence in each set.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation Metrics</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, we use a variety of metrics to evaluate our generated music samples:</p>
<ul id="S5.I2" class="ltx_itemize">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i1.p1" class="ltx_para">
<p id="S5.I2.i1.p1.1" class="ltx_p"><span id="S5.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">Fréchet Audio Distance (FAD)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> computes the distance between the distribution of the generated music and the reference music in the pretrained VGGish <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> feature space.</p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i2.p1" class="ltx_para">
<p id="S5.I2.i2.p1.1" class="ltx_p"><span id="S5.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">KL Divergence (KL)</span> uses a music genre tagging model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> pretrained on the Million Song dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> to measure the divergence of output distributions w.r.t the reference music.</p>
</div>
</li>
<li id="S5.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i3.p1" class="ltx_para">
<p id="S5.I2.i3.p1.1" class="ltx_p"><span id="S5.I2.i3.p1.1.1" class="ltx_text ltx_font_bold">Music-Video Alignment (MV Align)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> focuses on assessing the synchronization between music beats and visual dynamics in the video.</p>
</div>
</li>
<li id="S5.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i4.p1" class="ltx_para">
<p id="S5.I2.i4.p1.1" class="ltx_p"><span id="S5.I2.i4.p1.1.1" class="ltx_text ltx_font_bold">Human Evaluation</span> asks the subjects to select the video-music samples they prefer based on 1) the overall music generation quality and 2) the alignment between the generated music and its corresponding video.
Specifically, given a pair of video-music samples, where the video is the same but the music is generated by two different methods, the human raters are asked to select their preferred video-music sample based on the following prompts: 1) <span id="S5.I2.i4.p1.1.2" class="ltx_text ltx_font_italic">Which music video has higher overall quality music?</span> and 2) <span id="S5.I2.i4.p1.1.3" class="ltx_text ltx_font_italic">Which music video has better synchronization between music and visual content?</span>
For each question, the subjects can choose one of the two methods or the third option “Cannot tell.”
Each subject conducts 10 evaluations for a given pair of methods. The videos for each trial are randomly selected. The methods are unknown to the raters.
We compare our <span id="S5.I2.i4.p1.1.4" class="ltx_text ltx_font_smallcaps">VMAs</span> method to 4 competing approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. The performance is reported as the average human preference rate for each method.
We conduct our human study with 200 subjects on Amazon Mechanical Turk.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2409.07450/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Human Evaluation.<span id="S5.F3.5.2.1" class="ltx_text ltx_font_medium"> We conduct human evaluation to compare our <span id="S5.F3.5.2.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> method against several recent video-music generation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. We present the results as average human preference ratings for 1) the overall music generation quality and 2) the alignment between generated music and the corresponding video content. Each comparison is conducted between a pair of methods. The methods are unknown to the human raters.
Our results indicate that human subjects consistently prefer music-video samples with music generated by our method.
</span></span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Baselines</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We evaluate our model against the following recent video-music generation baselines.</p>
<ul id="S5.I3" class="ltx_itemize">
<li id="S5.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i1.p1" class="ltx_para">
<p id="S5.I3.i1.p1.1" class="ltx_p"><span id="S5.I3.i1.p1.1.1" class="ltx_text ltx_font_bold">Controllable Music Transformer (CMT)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Given a video, this approach produces symbolic music outputs that are used for music generation.
Since this method relies on symbolic music annotations for training, it is not trainable on DISCO-MV.
Thus, we use the publicly available pretrained checkpoint to generate music on our two evaluation datasets.</p>
</div>
</li>
<li id="S5.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i2.p1" class="ltx_para">
<p id="S5.I3.i2.p1.1" class="ltx_p"><span id="S5.I3.i2.p1.1.1" class="ltx_text ltx_font_bold">Video2Music</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Like CMT, Video2Music leverages semantic, motion, and emotional features to predict symbolic music outputs.
Since it cannot be trained on raw music videos, we generated music by directly applying the pretrained model to the testing videos.</p>
</div>
</li>
<li id="S5.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i3.p1" class="ltx_para">
<p id="S5.I3.i3.p1.1" class="ltx_p"><span id="S5.I3.i3.p1.1.1" class="ltx_text ltx_font_bold">VidMusicGen</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. We extend the text-to-music generation model MusicGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> to video by using a pretrained music video captioning model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> to produce textual video descriptions, which are then fed to the pretrained MusicGen model for music generation.</p>
</div>
</li>
<li id="S5.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i4.p1" class="ltx_para">
<p id="S5.I3.i4.p1.1" class="ltx_p"><span id="S5.I3.i4.p1.1.1" class="ltx_text ltx_font_bold">Vid2MLDM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. We adopt the pretrained text-to-music diffusion model, Tango <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, for our video-to-music generation task by replacing its text encoder with our video encoder.
We then train Vid2MLDM using the same training and testing splits as our model.</p>
</div>
</li>
<li id="S5.I3.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i5.p1" class="ltx_para">
<p id="S5.I3.i5.p1.1" class="ltx_p"><span id="S5.I3.i5.p1.1.1" class="ltx_text ltx_font_bold">V2Meow</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. This method uses sparsely sampled video frames as inputs for video-to-music generation. It was trained on a subset of YouTube-8M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Due to the unavailability of source code or pretrained checkpoints, we directly report the results from their paper.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Results and Analysis</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Comparison with the State-of-the-Art</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">In Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Semantic Video-Music Alignment ‣ 4 Technical Approach ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we present the results of our <span id="S6.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> method on the MusicCaps and DISCO-MV datasets. Our method outperforms all prior approaches in all evaluation metrics on all datasets, indicating the superiority of our proposed method compared to the existing video-to-music generation approaches. We also make several other interesting observations.
First, we note that the symbolic music generation approaches, CMT and Video2Music, obtain inferior results compared to other approaches (including ours). This confirms our earlier hypothesis that the approaches relying on symbolic annotations suffer from small amounts of training data and limited diversity in the annotations.
Second, we demonstrate that our autoregressive approach achieves better results than the diffusion-based Vid2MLDM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> in all metrics on all datasets.
Third, we show that our model outperforms the state-of-the-art V2Meow on MusicCaps. Since V2Meow’s source code has not been publicly released, we can only perform comparisons using the results reported in their paper.
For a fair comparison with V2Meow, in Table <a href="#S6.T4" title="Table 4 ‣ 6.1 Comparison with the State-of-the-Art ‣ 6 Results and Analysis ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we also include the variant of our <span id="S6.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">VMAs</span> model trained using the same data as V2Meow.
Our results indicate that our <span id="S6.SS1.p1.1.3" class="ltx_text ltx_font_smallcaps">VMAs</span> surpasses V2Meow even when both methods are trained on the same data. This indicates the effectiveness of our architecture design and also the importance of our video-music alignment training schemes.
We also observe that by using our DISCO-MV dataset, we can improve our model’s performance substantially, thus demonstrating the importance of our large-scale dataset.</p>
</div>
<figure id="S6.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T4.6.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S6.T4.7.2" class="ltx_text" style="font-size:90%;">
<span id="S6.T4.7.2.1" class="ltx_text ltx_font_bold">Comparison to V2Meow Using the Same Training Data.</span> For a fair comparison with V2Meow, we include the variant of our <span id="S6.T4.7.2.2" class="ltx_text ltx_font_smallcaps">VMAs</span> model trained using the same data as V2Meow. Both methods are evaluated on MusicCaps using the FAD and KL Div. computed via Leaf classifer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>. </span></figcaption>
<div id="S6.T4.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:243.5pt;height:48.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-73.2pt,14.5pt) scale(0.624400211744875,0.624400211744875) ;">
<table id="S6.T4.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S6.T4.2.2.2" class="ltx_tr">
<td id="S6.T4.2.2.2.3" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Method</td>
<td id="S6.T4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T4.2.2.2.4.1" class="ltx_text"></span> <span id="S6.T4.2.2.2.4.2" class="ltx_text">
<span id="S6.T4.2.2.2.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T4.2.2.2.4.2.1.1" class="ltx_tr">
<span id="S6.T4.2.2.2.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Training Dataset</span></span>
</span></span><span id="S6.T4.2.2.2.4.3" class="ltx_text"></span></td>
<td id="S6.T4.2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">#Videos</td>
<td id="S6.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">FAD <math id="S6.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T4.1.1.1.1.m1.1a"><mo stretchy="false" id="S6.T4.1.1.1.1.m1.1.1" xref="S6.T4.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T4.1.1.1.1.m1.1b"><ci id="S6.T4.1.1.1.1.m1.1.1.cmml" xref="S6.T4.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S6.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">KL. <math id="S6.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T4.2.2.2.2.m1.1a"><mo stretchy="false" id="S6.T4.2.2.2.2.m1.1.1" xref="S6.T4.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T4.2.2.2.2.m1.1b"><ci id="S6.T4.2.2.2.2.m1.1.1.cmml" xref="S6.T4.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
</tr>
<tr id="S6.T4.2.2.3" class="ltx_tr">
<td id="S6.T4.2.2.3.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">V2Meow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S6.T4.2.2.3.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">MV100K</td>
<td id="S6.T4.2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">100K</td>
<td id="S6.T4.2.2.3.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">4.62</td>
<td id="S6.T4.2.2.3.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">1.22</td>
</tr>
<tr id="S6.T4.2.2.4" class="ltx_tr">
<td id="S6.T4.2.2.4.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T4.2.2.4.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> (Ours)</td>
<td id="S6.T4.2.2.4.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">MV100K</td>
<td id="S6.T4.2.2.4.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">100K</td>
<td id="S6.T4.2.2.4.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">4.51</td>
<td id="S6.T4.2.2.4.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.15</td>
</tr>
<tr id="S6.T4.2.2.5" class="ltx_tr">
<td id="S6.T4.2.2.5.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T4.2.2.5.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> (Ours)</td>
<td id="S6.T4.2.2.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">DISCO-MV</td>
<td id="S6.T4.2.2.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">2.2M</td>
<td id="S6.T4.2.2.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T4.2.2.5.4.1" class="ltx_text ltx_font_bold">4.07</span></td>
<td id="S6.T4.2.2.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T4.2.2.5.5.1" class="ltx_text ltx_font_bold">1.10</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p"><span id="S6.SS1.p2.1.1" class="ltx_text ltx_font_bold">Human Evaluation.</span> In Figure <a href="#S5.F3" title="Figure 3 ‣ 5.2 Evaluation Metrics ‣ 5 Experimental Setup ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we report the results of our human evaluation. We use two metrics: 1) overall music generation quality
and 2) alignment between generated music and the corresponding video content.
These results are presented as human preference rates, quantifying the percentage that the subjects favor our method over a competing method. All comparisons are made between a pair of methods, e.g., our <span id="S6.SS1.p2.1.2" class="ltx_text ltx_font_smallcaps">VMAs</span> vs. CMT, Video2Music, VidMusicGen, and Vid2MLDM.
From the results in Figure <a href="#S5.F3" title="Figure 3 ‣ 5.2 Evaluation Metrics ‣ 5 Experimental Setup ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe that human subjects consistently prefer our method to all the other methods according to both evaluation metrics.
Specifically, on average, our method is preferred over <span id="S6.SS1.p2.1.3" class="ltx_text ltx_font_bold">70%</span> of the time for overall music generation quality and <span id="S6.SS1.p2.1.4" class="ltx_text ltx_font_bold">67%</span> for the metric measuring the alignment between generated music and the corresponding video content.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Ablation Studies</h3>

<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S6.T5.6.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S6.T5.7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Effectiveness of Video-Music Alignment Schemes.<span id="S6.T5.7.2.1" class="ltx_text ltx_font_medium">
Here, we study the impact of our two video-music alignment schemes: 1) video-music contrastive objective and 2) video-beat alignment.
We observe that using both alignment schemes allows us to obtain the best performance in FAD, KL, and MV Alignment metrics on DISCO-MV.
</span></span></figcaption>
<div id="S6.T5.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:243.5pt;height:62pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-19.7pt,5.0pt) scale(0.860458411588068,0.860458411588068) ;">
<table id="S6.T5.3.3" class="ltx_tabular ltx_align_middle">
<tr id="S6.T5.3.3.3" class="ltx_tr">
<td id="S6.T5.3.3.3.4" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Configuration</td>
<td id="S6.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">FAD <math id="S6.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T5.1.1.1.1.m1.1a"><mo stretchy="false" id="S6.T5.1.1.1.1.m1.1.1" xref="S6.T5.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T5.1.1.1.1.m1.1b"><ci id="S6.T5.1.1.1.1.m1.1.1.cmml" xref="S6.T5.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S6.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">KL <math id="S6.T5.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T5.2.2.2.2.m1.1a"><mo stretchy="false" id="S6.T5.2.2.2.2.m1.1.1" xref="S6.T5.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T5.2.2.2.2.m1.1b"><ci id="S6.T5.2.2.2.2.m1.1.1.cmml" xref="S6.T5.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S6.T5.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">MV Align <math id="S6.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S6.T5.3.3.3.3.m1.1a"><mo stretchy="false" id="S6.T5.3.3.3.3.m1.1.1" xref="S6.T5.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T5.3.3.3.3.m1.1b"><ci id="S6.T5.3.3.3.3.m1.1.1.cmml" xref="S6.T5.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.3.3.3.3.m1.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="S6.T5.3.3.4" class="ltx_tr">
<td id="S6.T5.3.3.4.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">Autoregressive Baseline</td>
<td id="S6.T5.3.3.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">2.75</td>
<td id="S6.T5.3.3.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">1.40</td>
<td id="S6.T5.3.3.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">0.243</td>
</tr>
<tr id="S6.T5.3.3.5" class="ltx_tr">
<td id="S6.T5.3.3.5.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">+ Video-Music Contrastive</td>
<td id="S6.T5.3.3.5.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">2.40</td>
<td id="S6.T5.3.3.5.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T5.3.3.5.3.1" class="ltx_text ltx_font_bold">1.34</span></td>
<td id="S6.T5.3.3.5.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.251</td>
</tr>
<tr id="S6.T5.3.3.6" class="ltx_tr">
<td id="S6.T5.3.3.6.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">+ Video-Beat Alignment</td>
<td id="S6.T5.3.3.6.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T5.3.3.6.2.1" class="ltx_text ltx_font_bold">2.38</span></td>
<td id="S6.T5.3.3.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T5.3.3.6.3.1" class="ltx_text ltx_font_bold">1.34</span></td>
<td id="S6.T5.3.3.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T5.3.3.6.4.1" class="ltx_text ltx_font_bold">0.352</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p"><span id="S6.SS2.p1.1.1" class="ltx_text ltx_font_bold">Importance of Video-Music Alignment.</span> In Table <a href="#S6.T5" title="Table 5 ‣ 6.2 Ablation Studies ‣ 6 Results and Analysis ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we evaluate the importance of our two video-music alignment schemes: 1) video-music contrastive objective and 2) video-beat alignment scheme.
Based on these results, we observe that the contrastive video-music matching objective produces a significant improvement in FAD (from <span id="S6.SS2.p1.1.2" class="ltx_text ltx_font_bold">2.75</span> to <span id="S6.SS2.p1.1.3" class="ltx_text ltx_font_bold">2.40</span>) and a significant improvement in KL (from <span id="S6.SS2.p1.1.4" class="ltx_text ltx_font_bold">1.40</span> to <span id="S6.SS2.p1.1.5" class="ltx_text ltx_font_bold">1.34</span>) metrics.
Furthermore, our proposed video-beat alignment scheme significantly improves the music-video alignment metric (<span id="S6.SS2.p1.1.6" class="ltx_text ltx_font_bold">+0.109</span>).
By integrating these two complementary video-music alignment schemes, our model achieves optimal performance according to all three metrics.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p"><span id="S6.SS2.p2.1.1" class="ltx_text ltx_font_bold">Comparison to Other Video Encoders.</span> In Table <a href="#S6.T6" title="Table 6 ‣ 6.2 Ablation Studies ‣ 6 Results and Analysis ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we compare our efficient video encoder with CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> on DISCO-MV. All comparisons are done by incorporating each encoder into our video-to-music generation pipeline. Despite using a larger number of video frames (i.e., 96 vs. 16), our video encoder is more computationally efficient than either CLIP or Hiera (i.e., <span id="S6.SS2.p2.1.2" class="ltx_text ltx_font_bold">130.7</span> vs. <span id="S6.SS2.p2.1.3" class="ltx_text ltx_font_bold">140.2</span> and <span id="S6.SS2.p2.1.4" class="ltx_text ltx_font_bold">281.6</span> in GFLOPs) and it achieves better music generation results.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p"><span id="S6.SS2.p3.1.1" class="ltx_text ltx_font_bold">Impact of Training Data Size.</span>
We next study the performance of our model when training it with different fractions of DISCO-MV data (i.e., 10%, 25%, 50%, 100%). We report the FAD results on MusicCaps and DISCO-MV test sets.
On both datasets, we observe a consistent improvement with an increasing amount of training data (i.e., MusicCaps: <span id="S6.SS2.p3.1.2" class="ltx_text ltx_font_bold">4.7</span>, <span id="S6.SS2.p3.1.3" class="ltx_text ltx_font_bold">4.4</span>, <span id="S6.SS2.p3.1.4" class="ltx_text ltx_font_bold">4.3</span>, <span id="S6.SS2.p3.1.5" class="ltx_text ltx_font_bold">4.1</span> and DISCO-MV: <span id="S6.SS2.p3.1.6" class="ltx_text ltx_font_bold">3.2</span>, <span id="S6.SS2.p3.1.7" class="ltx_text ltx_font_bold">2.9</span>, <span id="S6.SS2.p3.1.8" class="ltx_text ltx_font_bold">2.7</span>, <span id="S6.SS2.p3.1.9" class="ltx_text ltx_font_bold">2.4</span>), indicating the importance of large-scale training data for music generation. More results are shown in Appendix.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.1" class="ltx_p"><span id="S6.SS2.p4.1.1" class="ltx_text ltx_font_bold">Imapct of Data Cleaning.</span>
We next study the importance of our data cleaning protocol, which removes videos from DISCO-10M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> with high intra-frame similarity (i.e., videos with low visual variance). We train two variants of <span id="S6.SS2.p4.1.2" class="ltx_text ltx_font_smallcaps">VMAs</span> : 1) a variant trained on the full unfiltered DISCO-10M dataset vs. 2) a variant trained on our filtered DISCO-MV dataset.
We report that training <span id="S6.SS2.p4.1.3" class="ltx_text ltx_font_smallcaps">VMAs</span> on the full DISCO-10M only achieves an FAD of <span id="S6.SS2.p4.1.4" class="ltx_text ltx_font_bold">4.52</span>, a KL of <span id="S6.SS2.p4.1.5" class="ltx_text ltx_font_bold">2.11</span>, and an MV-Align score of <span id="S6.SS2.p4.1.6" class="ltx_text ltx_font_bold">0.18</span>.
In contrast, training <span id="S6.SS2.p4.1.7" class="ltx_text ltx_font_smallcaps">VMAs</span> on our filtered DISCO-MV leads to a substantially improved performance across all metrics, achieving FAD of <span id="S6.SS2.p4.1.8" class="ltx_text ltx_font_bold">2.38</span>, a KL of <span id="S6.SS2.p4.1.9" class="ltx_text ltx_font_bold">1.34</span>, and an MV-Align score of <span id="S6.SS2.p4.1.10" class="ltx_text ltx_font_bold">0.35</span>.
The results suggest that filtering the noisy videos in DISCO-10M is necessary for better video-to-music generation performance.</p>
</div>
<figure id="S6.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T6.7.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S6.T6.8.2" class="ltx_text" style="font-size:90%;">
<span id="S6.T6.8.2.1" class="ltx_text ltx_font_bold">Comparison to Other Video Encoders.</span>
We compare the effectiveness of our proposed video encoder architecture to several existing video encoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for the video-to-music generation task. We evaluate the results on the DISCO-MV dataset using FAD, KL, and MV Align metrics. Based on these results, we observe that our proposed video encoder architecture is not only more efficient but also leads to higher-quality music generation, justifying our model design.
</span></figcaption>
<div id="S6.T6.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:243.5pt;height:59pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.9pt,18.2pt) scale(0.618954546738223,0.618954546738223) ;">
<table id="S6.T6.4.4" class="ltx_tabular ltx_align_middle">
<tr id="S6.T6.4.4.4" class="ltx_tr">
<td id="S6.T6.4.4.4.5" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T6.4.4.4.5.1" class="ltx_text"></span> <span id="S6.T6.4.4.4.5.2" class="ltx_text">
<span id="S6.T6.4.4.4.5.2.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T6.4.4.4.5.2.1.1" class="ltx_tr">
<span id="S6.T6.4.4.4.5.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Video</span></span>
<span id="S6.T6.4.4.4.5.2.1.2" class="ltx_tr">
<span id="S6.T6.4.4.4.5.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Encoder</span></span>
</span></span><span id="S6.T6.4.4.4.5.3" class="ltx_text"></span></td>
<td id="S6.T6.4.4.4.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">#Frames</td>
<td id="S6.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">FAD<math id="S6.T6.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T6.1.1.1.1.m1.1a"><mo stretchy="false" id="S6.T6.1.1.1.1.m1.1.1" xref="S6.T6.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T6.1.1.1.1.m1.1b"><ci id="S6.T6.1.1.1.1.m1.1.1.cmml" xref="S6.T6.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S6.T6.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">KL <math id="S6.T6.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T6.2.2.2.2.m1.1a"><mo stretchy="false" id="S6.T6.2.2.2.2.m1.1.1" xref="S6.T6.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T6.2.2.2.2.m1.1b"><ci id="S6.T6.2.2.2.2.m1.1.1.cmml" xref="S6.T6.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="S6.T6.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T6.3.3.3.3.1" class="ltx_text"></span> <span id="S6.T6.3.3.3.3.2" class="ltx_text">
<span id="S6.T6.3.3.3.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T6.3.3.3.3.2.1.1" class="ltx_tr">
<span id="S6.T6.3.3.3.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">MV</span></span>
<span id="S6.T6.3.3.3.3.2.1.2" class="ltx_tr">
<span id="S6.T6.3.3.3.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Align</span></span>
</span></span> <span id="S6.T6.3.3.3.3.3" class="ltx_text"></span> <math id="S6.T6.3.3.3.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S6.T6.3.3.3.3.m1.1a"><mo stretchy="false" id="S6.T6.3.3.3.3.m1.1.1" xref="S6.T6.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T6.3.3.3.3.m1.1b"><ci id="S6.T6.3.3.3.3.m1.1.1.cmml" xref="S6.T6.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.3.3.3.3.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="S6.T6.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<span id="S6.T6.4.4.4.4.2" class="ltx_text"></span> <span id="S6.T6.4.4.4.4.1" class="ltx_text">
<span id="S6.T6.4.4.4.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T6.4.4.4.4.1.1.1" class="ltx_tr">
<span id="S6.T6.4.4.4.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">GFLOPS <math id="S6.T6.4.4.4.4.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S6.T6.4.4.4.4.1.1.1.1.m1.1a"><mo stretchy="false" id="S6.T6.4.4.4.4.1.1.1.1.m1.1.1" xref="S6.T6.4.4.4.4.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T6.4.4.4.4.1.1.1.1.m1.1b"><ci id="S6.T6.4.4.4.4.1.1.1.1.m1.1.1.cmml" xref="S6.T6.4.4.4.4.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.4.4.4.4.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></span>
</span></span><span id="S6.T6.4.4.4.4.3" class="ltx_text"></span></td>
</tr>
<tr id="S6.T6.4.4.5" class="ltx_tr">
<td id="S6.T6.4.4.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S6.T6.4.4.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">16</td>
<td id="S6.T6.4.4.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">2.61</td>
<td id="S6.T6.4.4.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">1.41</td>
<td id="S6.T6.4.4.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">0.274</td>
<td id="S6.T6.4.4.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">281.6</td>
</tr>
<tr id="S6.T6.4.4.6" class="ltx_tr">
<td id="S6.T6.4.4.6.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;">Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="S6.T6.4.4.6.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">16</td>
<td id="S6.T6.4.4.6.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">2.58</td>
<td id="S6.T6.4.4.6.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">1.41</td>
<td id="S6.T6.4.4.6.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">0.316</td>
<td id="S6.T6.4.4.6.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">140.2</td>
</tr>
<tr id="S6.T6.4.4.7" class="ltx_tr">
<td id="S6.T6.4.4.7.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">Ours</td>
<td id="S6.T6.4.4.7.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">96</td>
<td id="S6.T6.4.4.7.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T6.4.4.7.3.1" class="ltx_text ltx_font_bold">2.38</span></td>
<td id="S6.T6.4.4.7.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T6.4.4.7.4.1" class="ltx_text ltx_font_bold">1.34</span></td>
<td id="S6.T6.4.4.7.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T6.4.4.7.5.1" class="ltx_text ltx_font_bold">0.342</span></td>
<td id="S6.T6.4.4.7.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S6.T6.4.4.7.6.1" class="ltx_text ltx_font_bold">130.7</span></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S6.F4" class="ltx_figure"><img src="/html/2409.07450/assets/x4.png" id="S6.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="226" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S6.F4.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Human Evaluation.<span id="S6.F4.4.2.1" class="ltx_text ltx_font_medium"> Human raters are asked to select the generated music that best aligns with a given video and the best music quality. We report the average human preference rate for each method. Note that all samples are present in a random order.
</span></span></figcaption>
</figure>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion and Conclusions</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we presented a large-scale video-music generation framework that leverages our newly curated DISCO-MV dataset, which is orders of magnitude larger than any existing video-music datasets.
Our proposed framework leverages a novel video-music alignment scheme consisting of 1) contrastive video-music matching and 2) video-beat alignment objectives to align the generated music with the high-level (e.g., genre) and low-level (e.g., scene transitions) visual cues in the video.
Furthermore, to effectively learn fine-grained visual cues from long, densely sampled video inputs, we designed a new video encoder, which we showed to be both more effective and more efficient than the existing encoders for the video-music generation task.
In the future, we will extend our framework to other video-music modeling problems such as video-music style transfer, video-music editing, and video-music retrieval. We will also investigate a joint video-and-text-to-music generation architecture that provides users with more control when generating music.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We thank Feng Cheng, Md Mohaiminul Islam, Ce Zhang, and Yue Yang for their helpful discussions. This work was supported by the Sony Faculty Innovation Award, Laboratory for Analytic Sciences via NC State University, ONR Award N00014-23-1-2356.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix Overview</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">Our appendix consists of:</p>
</div>
<div id="A1.p2" class="ltx_para">
<ol id="A1.I1" class="ltx_enumerate">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">Implementation Details.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">Human Evaluation Details.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">Music Genre Analysis of DISCO-MV</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p">Additional Quantitative Results.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="A1.I1.i5.p1" class="ltx_para">
<p id="A1.I1.i5.p1.1" class="ltx_p">Qualitative Results.</p>
</div>
</li>
<li id="A1.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span> 
<div id="A1.I1.i6.p1" class="ltx_para">
<p id="A1.I1.i6.p1.1" class="ltx_p">A Supplementary Video.</p>
</div>
</li>
</ol>
</div>
<figure id="A1.F5" class="ltx_figure"><img src="/html/2409.07450/assets/x5.png" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="378" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A1.F5.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Music Genre Distribution.<span id="A1.F5.4.2.1" class="ltx_text ltx_font_medium"> We present the GTZAN genres <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> for the DISCO-MV dataset. Genres are assigned to each soundtrack based on the maximum cosine similarity between its sound embedding and the corresponding genre (text) embedding.
</span></span></figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.7" class="ltx_p"><span id="A2.p1.7.1" class="ltx_text ltx_font_bold">Audio Tokenization Model and Patterns.</span>
To transform a continuous <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A2.p1.1.m1.1a"><mn id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><cn type="integer" id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">32</annotation></semantics></math> kHz audio into discrete audio tokens, we leverage the pretrained EnCodec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> with a stride of <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="640" display="inline"><semantics id="A2.p1.2.m2.1a"><mn id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">640</mn><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><cn type="integer" id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">640</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">640</annotation></semantics></math>,
resulting in a frame rate of <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A2.p1.3.m3.1a"><mn id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><cn type="integer" id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">50</annotation></semantics></math> Hz and an initial hidden feature size of <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A2.p1.4.m4.1a"><mn id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><cn type="integer" id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">64</annotation></semantics></math>.
The embeddings are quantized using a Residual Vector Quantization (RVQ) with four quantizers, each having a codebook size of <math id="A2.p1.5.m5.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="A2.p1.5.m5.1a"><mn id="A2.p1.5.m5.1.1" xref="A2.p1.5.m5.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="A2.p1.5.m5.1b"><cn type="integer" id="A2.p1.5.m5.1.1.cmml" xref="A2.p1.5.m5.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m5.1c">2048</annotation></semantics></math>.
As for the codebook pattern, we adopt the delay interleaving pattern <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> to translate <math id="A2.p1.6.m6.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A2.p1.6.m6.1a"><mn id="A2.p1.6.m6.1.1" xref="A2.p1.6.m6.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.p1.6.m6.1b"><cn type="integer" id="A2.p1.6.m6.1.1.cmml" xref="A2.p1.6.m6.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m6.1c">10</annotation></semantics></math> seconds of audio into <math id="A2.p1.7.m7.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A2.p1.7.m7.1a"><mn id="A2.p1.7.m7.1.1" xref="A2.p1.7.m7.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A2.p1.7.m7.1b"><cn type="integer" id="A2.p1.7.m7.1.1.cmml" xref="A2.p1.7.m7.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.7.m7.1c">500</annotation></semantics></math> autoregressive steps (audio tokens).</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.19" class="ltx_p"><span id="A2.p2.19.1" class="ltx_text ltx_font_bold">Efficient Video Encoder.</span>
Given an input video, we extract frames at a <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="9.6" display="inline"><semantics id="A2.p2.1.m1.1a"><mn id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">9.6</mn><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><cn type="float" id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">9.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">9.6</annotation></semantics></math> FPS rate, resulting in a total of <math id="A2.p2.2.m2.1" class="ltx_Math" alttext="96" display="inline"><semantics id="A2.p2.2.m2.1a"><mn id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml">96</mn><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><cn type="integer" id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1">96</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">96</annotation></semantics></math> video frames with a resolution of <math id="A2.p2.3.m3.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mn id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.3.m3.1.1.1" xref="A2.p2.3.m3.1.1.1.cmml">×</mo><mn id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><times id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></times><cn type="integer" id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">224</cn><cn type="integer" id="A2.p2.3.m3.1.1.3.cmml" xref="A2.p2.3.m3.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">224\times 224</annotation></semantics></math> for a <math id="A2.p2.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A2.p2.4.m4.1a"><mn id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><cn type="integer" id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">10</annotation></semantics></math>-second clip.
We utilize the pretrained Hiera-Base model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which consists of <math id="A2.p2.5.m5.1" class="ltx_Math" alttext="24" display="inline"><semantics id="A2.p2.5.m5.1a"><mn id="A2.p2.5.m5.1.1" xref="A2.p2.5.m5.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A2.p2.5.m5.1b"><cn type="integer" id="A2.p2.5.m5.1.1.cmml" xref="A2.p2.5.m5.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.5.m5.1c">24</annotation></semantics></math> layers and performs downsampling three times through pooling.
These <math id="A2.p2.6.m6.1" class="ltx_Math" alttext="96" display="inline"><semantics id="A2.p2.6.m6.1a"><mn id="A2.p2.6.m6.1.1" xref="A2.p2.6.m6.1.1.cmml">96</mn><annotation-xml encoding="MathML-Content" id="A2.p2.6.m6.1b"><cn type="integer" id="A2.p2.6.m6.1.1.cmml" xref="A2.p2.6.m6.1.1">96</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.6.m6.1c">96</annotation></semantics></math> video frames are initially processed by a 3D CNN with a <math id="A2.p2.7.m7.1" class="ltx_Math" alttext="[3\times 7\times 7]" display="inline"><semantics id="A2.p2.7.m7.1a"><mrow id="A2.p2.7.m7.1.1.1" xref="A2.p2.7.m7.1.1.2.cmml"><mo stretchy="false" id="A2.p2.7.m7.1.1.1.2" xref="A2.p2.7.m7.1.1.2.1.cmml">[</mo><mrow id="A2.p2.7.m7.1.1.1.1" xref="A2.p2.7.m7.1.1.1.1.cmml"><mn id="A2.p2.7.m7.1.1.1.1.2" xref="A2.p2.7.m7.1.1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.7.m7.1.1.1.1.1" xref="A2.p2.7.m7.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.7.m7.1.1.1.1.3" xref="A2.p2.7.m7.1.1.1.1.3.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.7.m7.1.1.1.1.1a" xref="A2.p2.7.m7.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.7.m7.1.1.1.1.4" xref="A2.p2.7.m7.1.1.1.1.4.cmml">7</mn></mrow><mo stretchy="false" id="A2.p2.7.m7.1.1.1.3" xref="A2.p2.7.m7.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.7.m7.1b"><apply id="A2.p2.7.m7.1.1.2.cmml" xref="A2.p2.7.m7.1.1.1"><csymbol cd="latexml" id="A2.p2.7.m7.1.1.2.1.cmml" xref="A2.p2.7.m7.1.1.1.2">delimited-[]</csymbol><apply id="A2.p2.7.m7.1.1.1.1.cmml" xref="A2.p2.7.m7.1.1.1.1"><times id="A2.p2.7.m7.1.1.1.1.1.cmml" xref="A2.p2.7.m7.1.1.1.1.1"></times><cn type="integer" id="A2.p2.7.m7.1.1.1.1.2.cmml" xref="A2.p2.7.m7.1.1.1.1.2">3</cn><cn type="integer" id="A2.p2.7.m7.1.1.1.1.3.cmml" xref="A2.p2.7.m7.1.1.1.1.3">7</cn><cn type="integer" id="A2.p2.7.m7.1.1.1.1.4.cmml" xref="A2.p2.7.m7.1.1.1.1.4">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.7.m7.1c">[3\times 7\times 7]</annotation></semantics></math> kernel, a <math id="A2.p2.8.m8.1" class="ltx_Math" alttext="[2\times 4\times 4]" display="inline"><semantics id="A2.p2.8.m8.1a"><mrow id="A2.p2.8.m8.1.1.1" xref="A2.p2.8.m8.1.1.2.cmml"><mo stretchy="false" id="A2.p2.8.m8.1.1.1.2" xref="A2.p2.8.m8.1.1.2.1.cmml">[</mo><mrow id="A2.p2.8.m8.1.1.1.1" xref="A2.p2.8.m8.1.1.1.1.cmml"><mn id="A2.p2.8.m8.1.1.1.1.2" xref="A2.p2.8.m8.1.1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.8.m8.1.1.1.1.1" xref="A2.p2.8.m8.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.8.m8.1.1.1.1.3" xref="A2.p2.8.m8.1.1.1.1.3.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.8.m8.1.1.1.1.1a" xref="A2.p2.8.m8.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.8.m8.1.1.1.1.4" xref="A2.p2.8.m8.1.1.1.1.4.cmml">4</mn></mrow><mo stretchy="false" id="A2.p2.8.m8.1.1.1.3" xref="A2.p2.8.m8.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.8.m8.1b"><apply id="A2.p2.8.m8.1.1.2.cmml" xref="A2.p2.8.m8.1.1.1"><csymbol cd="latexml" id="A2.p2.8.m8.1.1.2.1.cmml" xref="A2.p2.8.m8.1.1.1.2">delimited-[]</csymbol><apply id="A2.p2.8.m8.1.1.1.1.cmml" xref="A2.p2.8.m8.1.1.1.1"><times id="A2.p2.8.m8.1.1.1.1.1.cmml" xref="A2.p2.8.m8.1.1.1.1.1"></times><cn type="integer" id="A2.p2.8.m8.1.1.1.1.2.cmml" xref="A2.p2.8.m8.1.1.1.1.2">2</cn><cn type="integer" id="A2.p2.8.m8.1.1.1.1.3.cmml" xref="A2.p2.8.m8.1.1.1.1.3">4</cn><cn type="integer" id="A2.p2.8.m8.1.1.1.1.4.cmml" xref="A2.p2.8.m8.1.1.1.1.4">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.8.m8.1c">[2\times 4\times 4]</annotation></semantics></math> stride, and a <math id="A2.p2.9.m9.1" class="ltx_Math" alttext="[1\times 3\times 3]" display="inline"><semantics id="A2.p2.9.m9.1a"><mrow id="A2.p2.9.m9.1.1.1" xref="A2.p2.9.m9.1.1.2.cmml"><mo stretchy="false" id="A2.p2.9.m9.1.1.1.2" xref="A2.p2.9.m9.1.1.2.1.cmml">[</mo><mrow id="A2.p2.9.m9.1.1.1.1" xref="A2.p2.9.m9.1.1.1.1.cmml"><mn id="A2.p2.9.m9.1.1.1.1.2" xref="A2.p2.9.m9.1.1.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.9.m9.1.1.1.1.1" xref="A2.p2.9.m9.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.9.m9.1.1.1.1.3" xref="A2.p2.9.m9.1.1.1.1.3.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.9.m9.1.1.1.1.1a" xref="A2.p2.9.m9.1.1.1.1.1.cmml">×</mo><mn id="A2.p2.9.m9.1.1.1.1.4" xref="A2.p2.9.m9.1.1.1.1.4.cmml">3</mn></mrow><mo stretchy="false" id="A2.p2.9.m9.1.1.1.3" xref="A2.p2.9.m9.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.9.m9.1b"><apply id="A2.p2.9.m9.1.1.2.cmml" xref="A2.p2.9.m9.1.1.1"><csymbol cd="latexml" id="A2.p2.9.m9.1.1.2.1.cmml" xref="A2.p2.9.m9.1.1.1.2">delimited-[]</csymbol><apply id="A2.p2.9.m9.1.1.1.1.cmml" xref="A2.p2.9.m9.1.1.1.1"><times id="A2.p2.9.m9.1.1.1.1.1.cmml" xref="A2.p2.9.m9.1.1.1.1.1"></times><cn type="integer" id="A2.p2.9.m9.1.1.1.1.2.cmml" xref="A2.p2.9.m9.1.1.1.1.2">1</cn><cn type="integer" id="A2.p2.9.m9.1.1.1.1.3.cmml" xref="A2.p2.9.m9.1.1.1.1.3">3</cn><cn type="integer" id="A2.p2.9.m9.1.1.1.1.4.cmml" xref="A2.p2.9.m9.1.1.1.1.4">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.9.m9.1c">[1\times 3\times 3]</annotation></semantics></math> padding for video tokenization.
Subsequently, we adjust the original spatial downsampling method in Hiera, namely Q-Pooling, which utilizes the same size of pooling kernels and strides.
The Q-Pooling kernel sizes for the first and second downsampling stages are increased from <math id="A2.p2.10.m10.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A2.p2.10.m10.1a"><mn id="A2.p2.10.m10.1.1" xref="A2.p2.10.m10.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A2.p2.10.m10.1b"><cn type="integer" id="A2.p2.10.m10.1.1.cmml" xref="A2.p2.10.m10.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.10.m10.1c">2</annotation></semantics></math> to <math id="A2.p2.11.m11.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A2.p2.11.m11.1a"><mn id="A2.p2.11.m11.1.1" xref="A2.p2.11.m11.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A2.p2.11.m11.1b"><cn type="integer" id="A2.p2.11.m11.1.1.cmml" xref="A2.p2.11.m11.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.11.m11.1c">4</annotation></semantics></math> (at the <math id="A2.p2.12.m12.1" class="ltx_Math" alttext="2^{\text{nd}}" display="inline"><semantics id="A2.p2.12.m12.1a"><msup id="A2.p2.12.m12.1.1" xref="A2.p2.12.m12.1.1.cmml"><mn id="A2.p2.12.m12.1.1.2" xref="A2.p2.12.m12.1.1.2.cmml">2</mn><mtext id="A2.p2.12.m12.1.1.3" xref="A2.p2.12.m12.1.1.3a.cmml">nd</mtext></msup><annotation-xml encoding="MathML-Content" id="A2.p2.12.m12.1b"><apply id="A2.p2.12.m12.1.1.cmml" xref="A2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="A2.p2.12.m12.1.1.1.cmml" xref="A2.p2.12.m12.1.1">superscript</csymbol><cn type="integer" id="A2.p2.12.m12.1.1.2.cmml" xref="A2.p2.12.m12.1.1.2">2</cn><ci id="A2.p2.12.m12.1.1.3a.cmml" xref="A2.p2.12.m12.1.1.3"><mtext mathsize="70%" id="A2.p2.12.m12.1.1.3.cmml" xref="A2.p2.12.m12.1.1.3">nd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.12.m12.1c">2^{\text{nd}}</annotation></semantics></math> layer) and from <math id="A2.p2.13.m13.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A2.p2.13.m13.1a"><mn id="A2.p2.13.m13.1.1" xref="A2.p2.13.m13.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A2.p2.13.m13.1b"><cn type="integer" id="A2.p2.13.m13.1.1.cmml" xref="A2.p2.13.m13.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.13.m13.1c">2</annotation></semantics></math> to <math id="A2.p2.14.m14.1" class="ltx_Math" alttext="7" display="inline"><semantics id="A2.p2.14.m14.1a"><mn id="A2.p2.14.m14.1.1" xref="A2.p2.14.m14.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="A2.p2.14.m14.1b"><cn type="integer" id="A2.p2.14.m14.1.1.cmml" xref="A2.p2.14.m14.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.14.m14.1c">7</annotation></semantics></math> (at the <math id="A2.p2.15.m15.1" class="ltx_Math" alttext="5^{\text{th}}" display="inline"><semantics id="A2.p2.15.m15.1a"><msup id="A2.p2.15.m15.1.1" xref="A2.p2.15.m15.1.1.cmml"><mn id="A2.p2.15.m15.1.1.2" xref="A2.p2.15.m15.1.1.2.cmml">5</mn><mtext id="A2.p2.15.m15.1.1.3" xref="A2.p2.15.m15.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="A2.p2.15.m15.1b"><apply id="A2.p2.15.m15.1.1.cmml" xref="A2.p2.15.m15.1.1"><csymbol cd="ambiguous" id="A2.p2.15.m15.1.1.1.cmml" xref="A2.p2.15.m15.1.1">superscript</csymbol><cn type="integer" id="A2.p2.15.m15.1.1.2.cmml" xref="A2.p2.15.m15.1.1.2">5</cn><ci id="A2.p2.15.m15.1.1.3a.cmml" xref="A2.p2.15.m15.1.1.3"><mtext mathsize="70%" id="A2.p2.15.m15.1.1.3.cmml" xref="A2.p2.15.m15.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.15.m15.1c">5^{\text{th}}</annotation></semantics></math> layer), respectively.
For the third downsampling stage, the Q-Pooling kernel size is maintained at <math id="A2.p2.16.m16.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="A2.p2.16.m16.1a"><mrow id="A2.p2.16.m16.1.1" xref="A2.p2.16.m16.1.1.cmml"><mn id="A2.p2.16.m16.1.1.2" xref="A2.p2.16.m16.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.16.m16.1.1.1" xref="A2.p2.16.m16.1.1.1.cmml">×</mo><mn id="A2.p2.16.m16.1.1.3" xref="A2.p2.16.m16.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.16.m16.1b"><apply id="A2.p2.16.m16.1.1.cmml" xref="A2.p2.16.m16.1.1"><times id="A2.p2.16.m16.1.1.1.cmml" xref="A2.p2.16.m16.1.1.1"></times><cn type="integer" id="A2.p2.16.m16.1.1.2.cmml" xref="A2.p2.16.m16.1.1.2">2</cn><cn type="integer" id="A2.p2.16.m16.1.1.3.cmml" xref="A2.p2.16.m16.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.16.m16.1c">2\times 2</annotation></semantics></math>, implemented at the <math id="A2.p2.17.m17.1" class="ltx_Math" alttext="21^{\text{st}}" display="inline"><semantics id="A2.p2.17.m17.1a"><msup id="A2.p2.17.m17.1.1" xref="A2.p2.17.m17.1.1.cmml"><mn id="A2.p2.17.m17.1.1.2" xref="A2.p2.17.m17.1.1.2.cmml">21</mn><mtext id="A2.p2.17.m17.1.1.3" xref="A2.p2.17.m17.1.1.3a.cmml">st</mtext></msup><annotation-xml encoding="MathML-Content" id="A2.p2.17.m17.1b"><apply id="A2.p2.17.m17.1.1.cmml" xref="A2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="A2.p2.17.m17.1.1.1.cmml" xref="A2.p2.17.m17.1.1">superscript</csymbol><cn type="integer" id="A2.p2.17.m17.1.1.2.cmml" xref="A2.p2.17.m17.1.1.2">21</cn><ci id="A2.p2.17.m17.1.1.3a.cmml" xref="A2.p2.17.m17.1.1.3"><mtext mathsize="70%" id="A2.p2.17.m17.1.1.3.cmml" xref="A2.p2.17.m17.1.1.3">st</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.17.m17.1c">21^{\text{st}}</annotation></semantics></math> layer.
At the <math id="A2.p2.18.m18.1" class="ltx_Math" alttext="24^{\text{th}}" display="inline"><semantics id="A2.p2.18.m18.1a"><msup id="A2.p2.18.m18.1.1" xref="A2.p2.18.m18.1.1.cmml"><mn id="A2.p2.18.m18.1.1.2" xref="A2.p2.18.m18.1.1.2.cmml">24</mn><mtext id="A2.p2.18.m18.1.1.3" xref="A2.p2.18.m18.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="A2.p2.18.m18.1b"><apply id="A2.p2.18.m18.1.1.cmml" xref="A2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="A2.p2.18.m18.1.1.1.cmml" xref="A2.p2.18.m18.1.1">superscript</csymbol><cn type="integer" id="A2.p2.18.m18.1.1.2.cmml" xref="A2.p2.18.m18.1.1.2">24</cn><ci id="A2.p2.18.m18.1.1.3a.cmml" xref="A2.p2.18.m18.1.1.3"><mtext mathsize="70%" id="A2.p2.18.m18.1.1.3.cmml" xref="A2.p2.18.m18.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.18.m18.1c">24^{\text{th}}</annotation></semantics></math> layer, the final layer, the model only increases the channel dimension through the liner projection, yielding video representations of dimension <math id="A2.p2.19.m19.1" class="ltx_Math" alttext="48\times 1\times 1\times 768" display="inline"><semantics id="A2.p2.19.m19.1a"><mrow id="A2.p2.19.m19.1.1" xref="A2.p2.19.m19.1.1.cmml"><mn id="A2.p2.19.m19.1.1.2" xref="A2.p2.19.m19.1.1.2.cmml">48</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.19.m19.1.1.1" xref="A2.p2.19.m19.1.1.1.cmml">×</mo><mn id="A2.p2.19.m19.1.1.3" xref="A2.p2.19.m19.1.1.3.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.19.m19.1.1.1a" xref="A2.p2.19.m19.1.1.1.cmml">×</mo><mn id="A2.p2.19.m19.1.1.4" xref="A2.p2.19.m19.1.1.4.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.19.m19.1.1.1b" xref="A2.p2.19.m19.1.1.1.cmml">×</mo><mn id="A2.p2.19.m19.1.1.5" xref="A2.p2.19.m19.1.1.5.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.19.m19.1b"><apply id="A2.p2.19.m19.1.1.cmml" xref="A2.p2.19.m19.1.1"><times id="A2.p2.19.m19.1.1.1.cmml" xref="A2.p2.19.m19.1.1.1"></times><cn type="integer" id="A2.p2.19.m19.1.1.2.cmml" xref="A2.p2.19.m19.1.1.2">48</cn><cn type="integer" id="A2.p2.19.m19.1.1.3.cmml" xref="A2.p2.19.m19.1.1.3">1</cn><cn type="integer" id="A2.p2.19.m19.1.1.4.cmml" xref="A2.p2.19.m19.1.1.4">1</cn><cn type="integer" id="A2.p2.19.m19.1.1.5.cmml" xref="A2.p2.19.m19.1.1.5">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.19.m19.1c">48\times 1\times 1\times 768</annotation></semantics></math>.</p>
</div>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2409.07450/assets/x6.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="237" height="180" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F6.5.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="A2.F6.6.2" class="ltx_text" style="font-size:90%;">
<span id="A2.F6.6.2.1" class="ltx_text ltx_font_bold">Impact of the Training Data Size.</span> We train our method with increasing subsets of DISCO-MV and then evaluate on MusicCaps (<span id="A2.F6.6.2.2" class="ltx_text ltx_font_bold" style="color:#FF0000;">Red</span>) and DISCO-MV (<span id="A2.F6.6.2.3" class="ltx_text ltx_font_bold" style="color:#0000FF;">Blue</span>) using FAD metric (the lower the better). Our results illustrate that the size of video-music training data has a significant impact on the generated music quality. These results justify our approach of using Web videos for scaling our video-music training data.
</span></figcaption>
</figure>
<figure id="A2.F7" class="ltx_figure"><img src="/html/2409.07450/assets/x7.png" id="A2.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="237" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F7.6.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A2.F7.7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Impact of the Training Data Size.<span id="A2.F7.7.2.1" class="ltx_text ltx_font_medium"> We train <span id="A2.F7.7.2.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span> with increasing subsets of DISCO-MV and then report the Music-Video Alignment (MV Align) metric on MusicCaps (</span><span id="A2.F7.7.2.2" class="ltx_text" style="color:#FF0000;">Red</span><span id="A2.F7.7.2.3" class="ltx_text ltx_font_medium">) and DISCO-MV (</span><span id="A2.F7.7.2.4" class="ltx_text" style="color:#0000FF;">Blue</span><span id="A2.F7.7.2.5" class="ltx_text ltx_font_medium">).
</span></span></figcaption>
</figure>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.3" class="ltx_p"><span id="A2.p3.3.1" class="ltx_text ltx_font_bold">Autoregressive Audio Decoder.</span>
We adopt the autoregressive transformer models of pretrained MusicGen-medium <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> as our autoregressive audio decoder.
The decoder consists of <math id="A2.p3.1.m1.1" class="ltx_Math" alttext="48" display="inline"><semantics id="A2.p3.1.m1.1a"><mn id="A2.p3.1.m1.1.1" xref="A2.p3.1.m1.1.1.cmml">48</mn><annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.1b"><cn type="integer" id="A2.p3.1.m1.1.1.cmml" xref="A2.p3.1.m1.1.1">48</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.1.m1.1c">48</annotation></semantics></math> transformer layers in a feature dimension of <math id="A2.p3.2.m2.1" class="ltx_Math" alttext="1536" display="inline"><semantics id="A2.p3.2.m2.1a"><mn id="A2.p3.2.m2.1.1" xref="A2.p3.2.m2.1.1.cmml">1536</mn><annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.1b"><cn type="integer" id="A2.p3.2.m2.1.1.cmml" xref="A2.p3.2.m2.1.1">1536</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.2.m2.1c">1536</annotation></semantics></math> with <math id="A2.p3.3.m3.1" class="ltx_Math" alttext="24" display="inline"><semantics id="A2.p3.3.m3.1a"><mn id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.1b"><cn type="integer" id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.3.m3.1c">24</annotation></semantics></math> standard causal and multi-head attention blocks.</p>
</div>
<figure id="A2.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A2.T7.5.1.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="A2.T7.6.2" class="ltx_text" style="font-size:90%;">
<span id="A2.T7.6.2.1" class="ltx_text ltx_font_bold">Video-to-Music Retrieval Results.</span> We conduct a comparison of our designed efficient video encoder with existing video encoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for video-to-music retrieval. Our efficient video encoder is generalizable to the video-to-music retrieval task.
</span></figcaption>
<div id="A2.T7.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:372.6pt;height:58.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-60.9pt,9.5pt) scale(0.753667603879863,0.753667603879863) ;">
<table id="A2.T7.2.2" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.2.2.2" class="ltx_tr">
<td id="A2.T7.2.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">Method</td>
<td id="A2.T7.2.2.2.4" class="ltx_td ltx_align_center ltx_border_tt">
<span id="A2.T7.2.2.2.4.1" class="ltx_text"></span> <span id="A2.T7.2.2.2.4.2" class="ltx_text">
<span id="A2.T7.2.2.2.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T7.2.2.2.4.2.1.1" class="ltx_tr">
<span id="A2.T7.2.2.2.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Video Encoder</span></span>
</span></span><span id="A2.T7.2.2.2.4.3" class="ltx_text"></span></td>
<td id="A2.T7.2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt">#Frames</td>
<td id="A2.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">
<span id="A2.T7.1.1.1.1.2" class="ltx_text"></span> <span id="A2.T7.1.1.1.1.1" class="ltx_text">
<span id="A2.T7.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T7.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A2.T7.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">V2M R@1 <math id="A2.T7.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A2.T7.1.1.1.1.1.1.1.1.m1.1a"><mo stretchy="false" id="A2.T7.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.T7.1.1.1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.1.1.1.1.1.m1.1b"><ci id="A2.T7.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A2.T7.1.1.1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.1.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span></span>
</span></span><span id="A2.T7.1.1.1.1.3" class="ltx_text"></span></td>
<td id="A2.T7.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt">
<span id="A2.T7.2.2.2.2.2" class="ltx_text"></span> <span id="A2.T7.2.2.2.2.1" class="ltx_text">
<span id="A2.T7.2.2.2.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T7.2.2.2.2.1.1.1" class="ltx_tr">
<span id="A2.T7.2.2.2.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">V2M R@10 <math id="A2.T7.2.2.2.2.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A2.T7.2.2.2.2.1.1.1.1.m1.1a"><mo stretchy="false" id="A2.T7.2.2.2.2.1.1.1.1.m1.1.1" xref="A2.T7.2.2.2.2.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A2.T7.2.2.2.2.1.1.1.1.m1.1b"><ci id="A2.T7.2.2.2.2.1.1.1.1.m1.1.1.cmml" xref="A2.T7.2.2.2.2.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.2.2.2.2.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span></span>
</span></span><span id="A2.T7.2.2.2.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A2.T7.2.2.3" class="ltx_tr">
<td id="A2.T7.2.2.3.1" class="ltx_td ltx_align_left ltx_border_tt" rowspan="2"><span id="A2.T7.2.2.3.1.1" class="ltx_text">MVPt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite></span></td>
<td id="A2.T7.2.2.3.2" class="ltx_td ltx_align_center ltx_border_tt">CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="A2.T7.2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt">16</td>
<td id="A2.T7.2.2.3.4" class="ltx_td ltx_align_center ltx_border_tt">4.2</td>
<td id="A2.T7.2.2.3.5" class="ltx_td ltx_align_center ltx_border_tt">17.3</td>
</tr>
<tr id="A2.T7.2.2.4" class="ltx_tr">
<td id="A2.T7.2.2.4.1" class="ltx_td ltx_align_center">Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="A2.T7.2.2.4.2" class="ltx_td ltx_align_center">16</td>
<td id="A2.T7.2.2.4.3" class="ltx_td ltx_align_center">4.8</td>
<td id="A2.T7.2.2.4.4" class="ltx_td ltx_align_center">18.1</td>
</tr>
<tr id="A2.T7.2.2.5" class="ltx_tr">
<td id="A2.T7.2.2.5.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="A2.T7.2.2.5.1.1" class="ltx_text ltx_font_smallcaps">VMAs</span></td>
<td id="A2.T7.2.2.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T7.2.2.5.2.1" class="ltx_text ltx_font_smallcaps">VMAs</span></td>
<td id="A2.T7.2.2.5.3" class="ltx_td ltx_align_center ltx_border_bb">96</td>
<td id="A2.T7.2.2.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T7.2.2.5.4.1" class="ltx_text ltx_font_bold">6.3</span></td>
<td id="A2.T7.2.2.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T7.2.2.5.5.1" class="ltx_text ltx_font_bold">26.7</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="A2.p4" class="ltx_para ltx_noindent">
<p id="A2.p4.8" class="ltx_p"><span id="A2.p4.8.1" class="ltx_text ltx_font_bold">Optimiazation.</span>
We train <span id="A2.p4.8.2" class="ltx_text ltx_font_smallcaps">VMAs</span> on <math id="A2.p4.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A2.p4.1.m1.1a"><mn id="A2.p4.1.m1.1.1" xref="A2.p4.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.p4.1.m1.1b"><cn type="integer" id="A2.p4.1.m1.1.1.cmml" xref="A2.p4.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.1.m1.1c">10</annotation></semantics></math>-second video clips from DISCO-MV using the AdamW optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> with a batch size of <math id="A2.p4.2.m2.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A2.p4.2.m2.1a"><mn id="A2.p4.2.m2.1.1" xref="A2.p4.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A2.p4.2.m2.1b"><cn type="integer" id="A2.p4.2.m2.1.1.cmml" xref="A2.p4.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.2.m2.1c">8</annotation></semantics></math> on each GPU.
The training takes approximately four days using 32 NVIDIA GPUs across 4 nodes. Each node is equipped with 8 GPUs, 92 CPUs, and 1000G of memory.
We utilize D-Adaptation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> to select the overall learning rate automatically.
A cosine learning rate schedule with a warmup of <math id="A2.p4.3.m3.1" class="ltx_Math" alttext="4000" display="inline"><semantics id="A2.p4.3.m3.1a"><mn id="A2.p4.3.m3.1.1" xref="A2.p4.3.m3.1.1.cmml">4000</mn><annotation-xml encoding="MathML-Content" id="A2.p4.3.m3.1b"><cn type="integer" id="A2.p4.3.m3.1.1.cmml" xref="A2.p4.3.m3.1.1">4000</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.3.m3.1c">4000</annotation></semantics></math> steps is deployed alongside an exponential moving average with a decay of <math id="A2.p4.4.m4.1" class="ltx_Math" alttext="0.99" display="inline"><semantics id="A2.p4.4.m4.1a"><mn id="A2.p4.4.m4.1.1" xref="A2.p4.4.m4.1.1.cmml">0.99</mn><annotation-xml encoding="MathML-Content" id="A2.p4.4.m4.1b"><cn type="float" id="A2.p4.4.m4.1.1.cmml" xref="A2.p4.4.m4.1.1">0.99</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.4.m4.1c">0.99</annotation></semantics></math>.
We set <math id="A2.p4.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p4.5.m5.1a"><mi id="A2.p4.5.m5.1.1" xref="A2.p4.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p4.5.m5.1b"><ci id="A2.p4.5.m5.1.1.cmml" xref="A2.p4.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.5.m5.1c">\alpha</annotation></semantics></math> in eq(3) to <math id="A2.p4.6.m6.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="A2.p4.6.m6.1a"><mn id="A2.p4.6.m6.1.1" xref="A2.p4.6.m6.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="A2.p4.6.m6.1b"><cn type="float" id="A2.p4.6.m6.1.1.cmml" xref="A2.p4.6.m6.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.6.m6.1c">0.05</annotation></semantics></math> and <math id="A2.p4.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A2.p4.7.m7.1a"><mi id="A2.p4.7.m7.1.1" xref="A2.p4.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.p4.7.m7.1b"><ci id="A2.p4.7.m7.1.1.cmml" xref="A2.p4.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.7.m7.1c">\beta</annotation></semantics></math> in the main draft to <math id="A2.p4.8.m8.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="A2.p4.8.m8.1a"><mn id="A2.p4.8.m8.1.1" xref="A2.p4.8.m8.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="A2.p4.8.m8.1b"><cn type="float" id="A2.p4.8.m8.1.1.cmml" xref="A2.p4.8.m8.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.8.m8.1c">0.25</annotation></semantics></math>.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Human Evaluation Details</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">As depicted in Figure <a href="#S6.F4" title="Figure 4 ‣ 6.2 Ablation Studies ‣ 6 Results and Analysis ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, given a pair of video-music samples with the same video but different music generated by two methods, human raters are asked to choose their preferred video-music sample based on the following prompts: 1) <span id="A3.p1.1.1" class="ltx_text ltx_font_italic">Which music do you think has the better music quality?</span> and 2) <span id="A3.p1.1.2" class="ltx_text ltx_font_italic"> Which background music has better synchronization between music beats and visual dynamics?”</span>
For each question, the subjects can choose one of the two methods or the third option ”Cannot tell.”
We collected approximately 200 subjects in the human evaluation by presenting results from a random method against <span id="A3.p1.1.3" class="ltx_text ltx_font_smallcaps">VMAs</span>.
In each survey, Each conducts 10 evaluations randomly selected among 50 evaluations.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Music Genre Analysis of DISCO-MV</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">Following the setup in DISCO-10M <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we implement zero-shot music genre classification for DISCO-MV by utilizing pretrained CLAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> embeddings extracted from 10-second music clips.
Genre classification is conducted through genre-specific prompts (”This audio is a &lt;genre&gt; song”) and identifying the genre via top-1 cosine similarity in a shared latent space for each music clip.
In Figure <a href="#A1.F5" title="Figure 5 ‣ Appendix A Appendix Overview ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we report the GTZAN genre distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> of our DISCO-MV dataset.
Jazz and disco genres are predominant while ensuring a wide range of musical diversity.
However, we note that the blues genre has few samples in DISCO-MV due to the limited number of blues music in the original DISCO-10M dataset.</p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Quantitative Results</h2>

<div id="A5.p1" class="ltx_para ltx_noindent">
<p id="A5.p1.1" class="ltx_p"><span id="A5.p1.1.1" class="ltx_text ltx_font_bold">Impact of Training Data Size.</span> Similar to our analysis in the main draft, in Figure <a href="#A2.F6" title="Figure 6 ‣ Appendix B Implementation Details ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and Figure <a href="#A2.F7" title="Figure 7 ‣ Appendix B Implementation Details ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we visualize our model’s performance on DISCO-MV as the training data increases in the FAD and Music-Video Alignment (MV Align) metrics, respectively. We observe consistent improvement in both metrics when the DISCO-MV data size increases.
Despite the Vid2MLDM model not accounting for low-level music-video beat synchronization, its performance improves with more training data.
These additional results confirm that our large-scale DISCO-MV can improve music-video beat alignment as well as music quality with larger training data scales.
</p>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p"><span id="A5.p2.1.1" class="ltx_text ltx_font_bold">Video-Music Retrieval Task.</span>
To evaluate our approach’s generalization capability, in Table <a href="#A2.T7" title="Table 7 ‣ Appendix B Implementation Details ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we also compare <span id="A5.p2.1.2" class="ltx_text ltx_font_smallcaps">VMAs</span> against MVPt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> for the video-to-music retrieval tasks on DISCO-MV.
Following the pipeline and size evaluation set of video-to-music retrieval framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, we randomly sample 2,000 videos in the DISCO-MV test set and extracted music and video representations using our trained model on video-to-music generation task.
We used these feature representations for the video-to-music retrieval task and measured performance using the standard Recall@1 and Recall@10 metrics.
For a fair comparison, we implement MVPt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> using CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and Hiera <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> as the video encoders and train it under the same conditions as <span id="A5.p2.1.3" class="ltx_text ltx_font_smallcaps">VMAs</span>.
These results indicate that <span id="A5.p2.1.4" class="ltx_text ltx_font_smallcaps">VMAs</span> is more accurate and generalizes better compared to MVPt (i.e., <span id="A5.p2.1.5" class="ltx_text ltx_font_bold">26.7</span> vs. <span id="A5.p2.1.6" class="ltx_text ltx_font_bold">18.1</span> and <span id="A5.p2.1.7" class="ltx_text ltx_font_bold">17.3</span> R@10) on the video-to-music task.</p>
</div>
<figure id="A5.F8" class="ltx_figure"><img src="/html/2409.07450/assets/x8.png" id="A5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="260" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="A5.F8.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Qualitative Video-to-Music Generation Results.<span id="A5.F8.4.2.1" class="ltx_text ltx_font_medium">
Here, we illustrate qualitative music generation results for a given silent video input. The generated music sample is visualized as a spectrogram.
We compare the results of our model with CMT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, Video2Music <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>), VidMusicGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and Vid2MLDM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
We note that most prior video-to-music generation approaches produce music beats of uniform intensity. In contrast, our model generates music beats that align well with dynamic video content, i.e., significant movements when a surfer changes direction during a sharp turn in this particular example.
</span></span></figcaption>
</figure>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Qualitative Results</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p">In Figure <a href="#A5.F8" title="Figure 8 ‣ Appendix E Additional Quantitative Results ‣ VMAs: Video-to-Music Generation via Semantic Alignment in Web Music Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we visualize our generated music results as a 2D spectrogram. We also include the results of the following video-to-music generation methods: CMT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, Video2Music <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, VidMusicGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and Vid2MLDM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. All results are obtained using the same video input shown at the top of the Figure.</p>
</div>
<div id="A6.p2" class="ltx_para">
<p id="A6.p2.1" class="ltx_p">Based on these results, we observe that symbolic music generation methods(i.e., CMT and Video2Music) often generate music with uniform music beat patterns, which is suboptimal as the music fails to match the temporal dynamics of the video content.
Furthermore, the existing waveform methods (i.e., VidMusicGen and Vid2MLDM) struggle to generate music consistently synchronized with dynamic low-level video events.In comparison, the music beats generated by our model (highlighted in red boxes) have higher intensity when a surfer in the video performs a dramatic turn. This demonstrates that our model generates music that reflects the pace and magnitude of the actions occurring in the video. </p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Sami Abu-El-Haija, Nisarg Kothari, Joonseok Lee, Paul Natsev, George Toderici, Balakrishnan Varadarajan, and Sudheendra Vijayanarasimhan.

</span>
<span class="ltx_bibblock">Youtube-8m: A large-scale video classification benchmark.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Andrea Agostinelli, Timo I Denk, Zalán Borsos, Jesse Engel, Mauro Verzetti, Antoine Caillon, Qingqing Huang, Aren Jansen, Adam Roberts, Marco Tagliasacchi, et al.

</span>
<span class="ltx_bibblock">Musiclm: Generating music from text.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Juan Pablo Bello, Laurent Daudet, Samer Abdallah, Chris Duxbury, Mike Davies, and Mark B Sandler.

</span>
<span class="ltx_bibblock">A tutorial on onset detection in music signals.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">TASLP</span>, 2005.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Thierry Bertin-Mahieux, Daniel P.W. Ellis, Brian Whitman, and Paul Lamere.

</span>
<span class="ltx_bibblock">The million song dataset.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">ISMIR</span>, 2011.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Zalán Borsos, Raphaël Marinier, Damien Vincent, Eugene Kharitonov, Olivier Pietquin, Matt Sharifi, Dominik Roblek, Olivier Teboul, David Grangier, Marco Tagliasacchi, et al.

</span>
<span class="ltx_bibblock">Audiolm: a language modeling approach to audio generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">TASLP</span>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Zalán Borsos, Matt Sharifi, Damien Vincent, Eugene Kharitonov, Neil Zeghidour, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">Soundstorm: Efficient parallel audio generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Joao Carreira and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Quo vadis, action recognition? a new model and the kinetics dataset.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Kan Chen, Chuanxi Zhang, Chen Fang, Zhaowen Wang, Trung Bui, and Ram Nevatia.

</span>
<span class="ltx_bibblock">Visually indicated sound generation by perceptually optimized classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">ECCVW</span>, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Peihao Chen, Yang Zhang, Mingkui Tan, Hongdong Xiao, Deng Huang, and Chuang Gan.

</span>
<span class="ltx_bibblock">Generating visually aligned sound from videos.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">TIP</span>, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Ziyang Chen, Daniel Geng, and Andrew Owens.

</span>
<span class="ltx_bibblock">Images that sound: Composing images and sounds on a single canvas.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2024.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Jade Copet, Felix Kreuk, Itai Gat, Tal Remez, David Kant, Gabriel Synnaeve, Yossi Adi, and Alexandre Défossez.

</span>
<span class="ltx_bibblock">Simple and controllable music generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Aaron Defazio and Konstantin Mishchenko.

</span>
<span class="ltx_bibblock">Learning-rate-free learning by d-adaptation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Alexandre Défossez, Jade Copet, Gabriel Synnaeve, and Yossi Adi.

</span>
<span class="ltx_bibblock">High fidelity neural audio compression.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">TMLR</span>, 2023.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Shangzhe Di, Zeren Jiang, Si Liu, Zhaokai Wang, Leyan Zhu, Zexin He, Hongming Liu, and Shuicheng Yan.

</span>
<span class="ltx_bibblock">Video background music generation with controllable music transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">ACM MM</span>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Yuexi Du, Ziyang Chen, Justin Salamon, Bryan Russell, and Andrew Owens.

</span>
<span class="ltx_bibblock">Conditional generation of audio from video via foley analogies.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Zach Evans, CJ Carr, Josiah Taylor, Scott H Hawley, and Jordi Pons.

</span>
<span class="ltx_bibblock">Fast timing-conditioned latent audio diffusion.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Chuang Gan, Deng Huang, Peihao Chen, Joshua B Tenenbaum, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Foley music: Learning to generate music from videos.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Deepanway Ghosal, Navonil Majumder, Ambuj Mehrish, and Soujanya Poria.

</span>
<span class="ltx_bibblock">Text-to-audio generation using instruction guided latent diffusion model.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">ACM MM</span>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Shawn Hershey, Sourish Chaudhuri, Daniel PW Ellis, Jort F Gemmeke, Aren Jansen, R Channing Moore, Manoj Plakal, Devin Platt, Rif A Saurous, Bryan Seybold, et al.

</span>
<span class="ltx_bibblock">Cnn architectures for large-scale audio classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">ICASSP</span>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Qingqing Huang, Daniel S Park, Tao Wang, Timo I Denk, Andy Ly, Nanxin Chen, Zhengdong Zhang, Zhishuai Zhang, Jiahui Yu, Christian Frank, et al.

</span>
<span class="ltx_bibblock">Noise2music: Text-conditioned music generation with diffusion models.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Rongjie Huang, Jiawei Huang, Dongchao Yang, Yi Ren, Luping Liu, Mingze Li, Zhenhui Ye, Jinglin Liu, Xiang Yin, and Zhou Zhao.

</span>
<span class="ltx_bibblock">Make-an-audio: Text-to-audio generation with prompt-enhanced diffusion models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Vladimir Iashin and Esa Rahtu.

</span>
<span class="ltx_bibblock">Taming visually guided sound generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">BMVC</span>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Jaeyong Kang, Soujanya Poria, and Dorien Herremans.

</span>
<span class="ltx_bibblock">Video2music: Suitable music generation from videos using an affective multimodal transformer model.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Kevin Kilgour, Mauricio Zuluaga, Dominik Roblek, and Matthew Sharifi.

</span>
<span class="ltx_bibblock">Fr<math id="bib.bib25.1.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="bib.bib25.1.m1.1a"><mo id="bib.bib25.1.m1.1.1" xref="bib.bib25.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="bib.bib25.1.m1.1b"><ci id="bib.bib25.1.m1.1.1.cmml" xref="bib.bib25.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib25.1.m1.1c">\backslash</annotation></semantics></math>’echet audio distance: A metric for evaluating music enhancement algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
A Sophia Koepke, Olivia Wiles, Yael Moses, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Sight to sound: An end-to-end approach for visual piano transcription.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">ICASSP</span>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Felix Kreuk, Gabriel Synnaeve, Adam Polyak, Uriel Singer, Alexandre Défossez, Jade Copet, Devi Parikh, Yaniv Taigman, and Yossi Adi.

</span>
<span class="ltx_bibblock">Audiogen: Textually guided audio generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Max WY Lam, Qiao Tian, Tang Li, Zongyu Yin, Siyuan Feng, Ming Tu, Yuliang Ji, Rui Xia, Mingbo Ma, Xuchen Song, et al.

</span>
<span class="ltx_bibblock">Efficient neural music generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Luca Lanzendörfer, Florian Grötschla, Emil Funke, and Roger Wattenhofer.

</span>
<span class="ltx_bibblock">Disco-10m: A large-scale music dataset.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Hsin-Ying Lee, Xiaodong Yang, Ming-Yu Liu, Ting-Chun Wang, Yu-Ding Lu, Ming-Hsuan Yang, and Jan Kautz.

</span>
<span class="ltx_bibblock">Dancing to music.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Haohe Liu, Zehua Chen, Yi Yuan, Xinhao Mei, Xubo Liu, Danilo Mandic, Wenwu Wang, and Mark D Plumbley.

</span>
<span class="ltx_bibblock">Audioldm: Text-to-audio generation with latent diffusion models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Haohe Liu, Qiao Tian, Yi Yuan, Xubo Liu, Xinhao Mei, Qiuqiang Kong, Yuping Wang, Wenwu Wang, Yuxuan Wang, and Mark D Plumbley.

</span>
<span class="ltx_bibblock">Audioldm 2: Learning holistic audio generation with self-supervised pretraining.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Simian Luo, Chuanhao Yan, Chenxu Hu, and Hang Zhao.

</span>
<span class="ltx_bibblock">Diff-foley: Synchronized video-to-audio synthesis with latent diffusion models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2023.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Xinhao Mei, Varun Nagaraja, Gael Le Lan, Zhaoheng Ni, Ernie Chang, Yangyang Shi, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Foleygen: Visually-guided audio generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Andrew Owens, Phillip Isola, Josh McDermott, Antonio Torralba, Edward H Adelson, and William T Freeman.

</span>
<span class="ltx_bibblock">Visually indicated sounds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Simon Rouard, Francisco Massa, and Alexandre Défossez.

</span>
<span class="ltx_bibblock">Hybrid transformers for music source separation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">ICASSP</span>, 2023.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Chaitanya Ryali, Yuan-Ting Hu, Daniel Bolya, Chen Wei, Haoqi Fan, Po-Yao Huang, Vaibhav Aggarwal, Arkabandhu Chowdhury, Omid Poursaeed, Judy Hoffman, et al.

</span>
<span class="ltx_bibblock">Hiera: A hierarchical vision transformer without the bells-and-whistles.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2023.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Flavio Schneider, Ojasv Kamal, Zhijing Jin, and Bernhard Schölkopf.

</span>
<span class="ltx_bibblock">Moûsai: Text-to-music generation with long-context latent diffusion.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Eli Shlizerman, Lucio Dery, Hayden Schoen, and Ira Kemelmacher-Shlizerman.

</span>
<span class="ltx_bibblock">Audio to body dynamics.

</span>
<span class="ltx_bibblock">In <span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2018.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Spotify.

</span>
<span class="ltx_bibblock">How ”fans also like” works.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Kun Su, Judith Yue Li, Qingqing Huang, Dima Kuzmin, Joonseok Lee, Chris Donahue, Fei Sha, Aren Jansen, Yu Wang, Mauro Verzetti, et al.

</span>
<span class="ltx_bibblock">V2meow: Meowing to the visual beat via music generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2024.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Kun Su, Xiulong Liu, and Eli Shlizerman.

</span>
<span class="ltx_bibblock">Audeo: Audio generation for a silent performance video.

</span>
<span class="ltx_bibblock">In <span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Kun Su, Kaizhi Qian, Eli Shlizerman, Antonio Torralba, and Chuang Gan.

</span>
<span class="ltx_bibblock">Physics-driven diffusion models for impact sound synthesis from videos.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2023.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Dídac Surís, Carl Vondrick, Bryan Russell, and Justin Salamon.

</span>
<span class="ltx_bibblock">It’s time for artistic correspondence in music and video.

</span>
<span class="ltx_bibblock">In <span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Zineng Tang, Ziyi Yang, Mahmoud Khademi, Yang Liu, Chenguang Zhu, and Mohit Bansal.

</span>
<span class="ltx_bibblock">Codi-2: In-context, interleaved, and interactive any-to-any generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Zineng Tang, Ziyi Yang, Chenguang Zhu, Michael Zeng, and Mohit Bansal.

</span>
<span class="ltx_bibblock">Any-to-any generation via composable diffusion.

</span>
<span class="ltx_bibblock">In <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Zachary Teed and Jia Deng.

</span>
<span class="ltx_bibblock">Raft: Recurrent all-pairs field transforms for optical flow.

</span>
<span class="ltx_bibblock">In <span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2020.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
George Tzanetakis and Perry Cook.

</span>
<span class="ltx_bibblock">Musical genre classification of audio signals.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">TASLP</span>, 2002.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Apoorv Vyas, Bowen Shi, Matthew Le, Andros Tjandra, Yi-Chiao Wu, Baishan Guo, Jiemin Zhang, Xinyue Zhang, Robert Adkins, William Ngan, et al.

</span>
<span class="ltx_bibblock">Audiobox: Unified audio generation with natural language prompts.

</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2023.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Caelen Wang.

</span>
<span class="ltx_bibblock">Timesformer-gpt2 video captioning.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Minz Won, Keunwoo Choi, and Xavier Serra.

</span>
<span class="ltx_bibblock">Semi-supervised music tagging transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">ISMIR</span>, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Yusong Wu, Ke Chen, Tianyu Zhang, Yuchen Hui, Taylor Berg-Kirkpatrick, and Shlomo Dubnov.

</span>
<span class="ltx_bibblock">Large-scale contrastive language-audio pretraining with feature fusion and keyword-to-caption augmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib54.1.1" class="ltx_text ltx_font_italic">ICASSP</span>, 2023.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Dongchao Yang, Jianwei Yu, Helin Wang, Wen Wang, Chao Weng, Yuexian Zou, and Dong Yu.

</span>
<span class="ltx_bibblock">Diffsound: Discrete diffusion model for text-to-sound generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text ltx_font_italic">TASLP</span>, 2023.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Guy Yariv, Itai Gat, Sagie Benaim, Lior Wolf, Idan Schwartz, and Yossi Adi.

</span>
<span class="ltx_bibblock">Diverse and aligned audio-to-video generation via text-to-video model adaptation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib56.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2024.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Jiahui Yu, Xin Li, Jing Yu Koh, Han Zhang, Ruoming Pang, James Qin, Alexander Ku, Yuanzhong Xu, Jason Baldridge, and Yonghui Wu.

</span>
<span class="ltx_bibblock">Vector-quantized image modeling with improved vqgan.

</span>
<span class="ltx_bibblock">In <span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Jiashuo Yu, Yaohui Wang, Xinyuan Chen, Xiao Sun, and Yu Qiao.

</span>
<span class="ltx_bibblock">Long-term rhythmic video soundtracker.

</span>
<span class="ltx_bibblock">In <span id="bib.bib58.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2023.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">Soundstream: An end-to-end neural audio codec.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">TASLP</span>, 2021.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Neil Zeghidour, Olivier Teboul, Félix de Chaumont Quitry, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">Leaf: A learnable frontend for audio classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">arXiv Preprint</span>, 2021.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Yipin Zhou, Zhaowen Wang, Chen Fang, Trung Bui, and Tamara L Berg.

</span>
<span class="ltx_bibblock">Visual to sound: Generating natural sound for videos in the wild.

</span>
<span class="ltx_bibblock">In <span id="bib.bib61.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2018.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Ye Zhu, Kyle Olszewski, Yu Wu, Panos Achlioptas, Menglei Chai, Yan Yan, and Sergey Tulyakov.

</span>
<span class="ltx_bibblock">Quantized gan for complex music generation from dance videos.

</span>
<span class="ltx_bibblock">In <span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2022.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Ye Zhu, Yu Wu, Kyle Olszewski, Jian Ren, Sergey Tulyakov, and Yan Yan.

</span>
<span class="ltx_bibblock">Discrete contrastive diffusion for cross-modal music and image generation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib63.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2023.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Wenlin Zhuang, Congyi Wang, Jinxiang Chai, Yangang Wang, Ming Shao, and Siyu Xia.

</span>
<span class="ltx_bibblock">Music2dance: Dancenet for music-driven dance generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text ltx_font_italic">TOMM</span>, 2022.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Le Zhuo, Zhaokai Wang, Baisen Wang, Yue Liao, Chenxi Bao, Stanley Peng, Songhao Han, Aixi Zhang, Fei Fang, and Si Liu.

</span>
<span class="ltx_bibblock">Video background music generation: Dataset, method and evaluation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib65.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2023.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Alon Ziv, Itai Gat, Gael Le Lan, Tal Remez, Felix Kreuk, Alexandre Défossez, Jade Copet, Gabriel Synnaeve, and Yossi Adi.

</span>
<span class="ltx_bibblock">Masked audio generation using a single non-autoregressive transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib66.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.07449" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.07450" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.07450">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.07450" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.07451" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 20:48:18 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
