<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.14259] Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition</title><meta property="og:description" content="We introduce “Generative Fusion Decoding” (GFD), a novel shallow fusion framework, utilized to integrate Large Language Models (LLMs) into multi-modal text recognition systems such as automatic speech recognition (ASR)…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.14259">

<!--Generated on Wed Jun  5 17:24:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Let’s Fuse Step by Step: 
<br class="ltx_break">A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chan-Jan Hsu<sup id="id11.11.id1" class="ltx_sup"><span id="id11.11.id1.1" class="ltx_text ltx_font_italic">1∗</span></sup>  Yi-Chang Chen<sup id="id12.12.id2" class="ltx_sup"><span id="id12.12.id2.1" class="ltx_text ltx_font_italic">1∗</span></sup>  Feng-Ting Liao<sup id="id13.13.id3" class="ltx_sup">1</sup> 
<br class="ltx_break"><span id="id4.4.1" class="ltx_text ltx_font_bold">Pei-Chen Ho<sup id="id4.4.1.1" class="ltx_sup"><span id="id4.4.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">2</span></sup></span>  <span id="id5.5.2" class="ltx_text ltx_font_bold">Yu-Hsiang Wang<sup id="id5.5.2.1" class="ltx_sup"><span id="id5.5.2.1.1" class="ltx_text ltx_font_medium ltx_font_italic">2</span></sup></span>  <span id="id6.6.3" class="ltx_text ltx_font_bold">Po-Chun Hsu<sup id="id6.6.3.1" class="ltx_sup"><span id="id6.6.3.1.1" class="ltx_text ltx_font_medium">1</span></sup></span>  <span id="id7.7.4" class="ltx_text ltx_font_bold">Da-shan Shiu<sup id="id7.7.4.1" class="ltx_sup"><span id="id7.7.4.1.1" class="ltx_text ltx_font_medium">1</span></sup></span> 
<br class="ltx_break">
<br class="ltx_break"><sup id="id14.14.id4" class="ltx_sup">∗</sup>Equal contribution  <sup id="id15.15.id5" class="ltx_sup">1</sup>MediaTek Research  <sup id="id16.16.id6" class="ltx_sup">2</sup>Internship at MediaTek Research 
<br class="ltx_break"><span id="id17.17.id7" class="ltx_text ltx_font_typewriter">{chan.hsu, yi-chang.chen, ft.liao, pochun.hsu, ds.shiu}@mtkresearch.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id18.id1" class="ltx_p">We introduce “Generative Fusion Decoding” (GFD), a novel shallow fusion framework, utilized to integrate Large Language Models (LLMs) into multi-modal text recognition systems such as automatic speech recognition (ASR) and optical character recognition (OCR). We derive the formulas necessary to enable GFD to operate across mismatched token spaces of different models by mapping text token space to byte token space, enabling seamless fusion during the decoding process. The framework is plug-and-play, compatible with various auto-regressive models, and does not require re-training for feature alignment, thus overcoming limitations of previous fusion techniques. We highlight three main advantages of GFD: First, by simplifying the complexity of aligning different model sample spaces, GFD allows LLMs to correct errors in tandem with the recognition model, reducing computation latencies. Second, the in-context learning ability of LLMs is fully capitalized by GFD, increasing robustness in long-form speech recognition and instruction aware speech recognition. Third, GFD enables fusing recognition models deficient in Chinese text recognition with LLMs extensively trained on Chinese. Our evaluation demonstrates that GFD significantly improves performance in ASR and OCR tasks, with ASR reaching state-of-the-art in the NTUML2021 benchmark. GFD provides a significant step forward in model integration, offering a unified solution that could be widely applicable to leveraging existing pre-trained models through step by step fusion. <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Code is available at <a target="_blank" href="https://github.com/mtkresearch/generative-fusion-decoding" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/mtkresearch/generative-fusion-decoding</a></span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">In recent years, integrating Large Language Models (LLMs) into multi-modal systems has emerged as a frontier, offering substantial advancements in applications such as automatic speech recognition (ASR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, visual question answering (VQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, and generalist agent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. The robust language model capabilities that the LLM offers make it an ideal candidate for integration with other models, many of which are “undertrained” in the textual domain, compared to trillions of tokens consumed by the LLMs. Obtaining sufficient quality paired data and training resources in a huge endeavor for text recognition systems such as automatic speech recognition (ASR) and optical character recognition (OCR).</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">The integration of heterogeneous models has been explored extensively in ASR literature, as exemplified by strategies such as shallow fusion, late fusion, mid fusion, and early fusion. Works in shallow fusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> interpolates text recognition outputs with LM outputs at each step of beam search. Late fusion approaches typically engage LLMs to score the initial sentence generated by the recognition model. The scores are then utilized for fusing with recognition probabilities for joint transcription <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, for re-ranking the the constrained set of hypothesis as work in re-scoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, for generating new hypothesis options through Generative Error Correction (GER) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Notably, methods in mid-fusion propose fusing models through model attentions to integrate LLM into the decoding process of the recognition model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and work in early-fusion has proposed concatenating speech embeddings or image embeddings along with LLM embedings as inputs to the LLM for ASR and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, the aforementioned fusion methods bear several challenges. The early fusion techniques are often limited by a low correction rate due to the restricted range of available choices for re-evaluation. Mid-fusion discards the whisper decoder, which has been shown to have denoising ability<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Additionally, late fusion with GER may lead to hallucination due to the LLM as the LLM generation is devoid of auditory inputs. Due to the requirements for shallow and late fusion to align output spaces, and the need for mid and early fusions to involve joint training with additional paired data, prevent an LLM from being used as is with existing text-recognition models without proper feature alignment through trainings.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2405.14259/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="157" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.10.1" class="ltx_text ltx_font_bold">The GFD integrated framework.</span> The framework aims to integrate pre-trained text-recognition models with LLMs to augment the recognition capabilities. However, direct fusion is impeded by the discrepancy in token spaces between the two model types. To overcome this obstacle, GFD is introduced, which converts the token space into a byte space, thereby facilitating incremental fusion. Equations <a href="#S3.E7" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and <a href="#S3.E8" title="In 3.2 Fusing text-recognition models with LLM ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> are employed to compute the fusion probability, enabling a stepwise fusion process. The symbols <math id="S1.F1.5.m1.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{TR}}" display="inline"><semantics id="S1.F1.5.m1.1b"><msup id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.5.m1.1.1.2" xref="S1.F1.5.m1.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S1.F1.5.m1.1.1.3" xref="S1.F1.5.m1.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><apply id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m1.1.1.1.cmml" xref="S1.F1.5.m1.1.1">superscript</csymbol><ci id="S1.F1.5.m1.1.1.2.cmml" xref="S1.F1.5.m1.1.1.2">𝒵</ci><ci id="S1.F1.5.m1.1.1.3a.cmml" xref="S1.F1.5.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S1.F1.5.m1.1.1.3.cmml" xref="S1.F1.5.m1.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">\mathcal{Z}^{\texttt{TR}}</annotation></semantics></math> and <math id="S1.F1.6.m2.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{LM}}" display="inline"><semantics id="S1.F1.6.m2.1b"><msup id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.6.m2.1.1.2" xref="S1.F1.6.m2.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S1.F1.6.m2.1.1.3" xref="S1.F1.6.m2.1.1.3a.cmml">LM</mtext></msup><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><apply id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m2.1.1.1.cmml" xref="S1.F1.6.m2.1.1">superscript</csymbol><ci id="S1.F1.6.m2.1.1.2.cmml" xref="S1.F1.6.m2.1.1.2">𝒵</ci><ci id="S1.F1.6.m2.1.1.3a.cmml" xref="S1.F1.6.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S1.F1.6.m2.1.1.3.cmml" xref="S1.F1.6.m2.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">\mathcal{Z}^{\texttt{LM}}</annotation></semantics></math> denote the contextual information pertinent to the text-recognition models and the language models, respectively. Notably, <math id="S1.F1.7.m3.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{TR}}" display="inline"><semantics id="S1.F1.7.m3.1b"><msup id="S1.F1.7.m3.1.1" xref="S1.F1.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.7.m3.1.1.2" xref="S1.F1.7.m3.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S1.F1.7.m3.1.1.3" xref="S1.F1.7.m3.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.1c"><apply id="S1.F1.7.m3.1.1.cmml" xref="S1.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.1.cmml" xref="S1.F1.7.m3.1.1">superscript</csymbol><ci id="S1.F1.7.m3.1.1.2.cmml" xref="S1.F1.7.m3.1.1.2">𝒵</ci><ci id="S1.F1.7.m3.1.1.3a.cmml" xref="S1.F1.7.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S1.F1.7.m3.1.1.3.cmml" xref="S1.F1.7.m3.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.1d">\mathcal{Z}^{\texttt{TR}}</annotation></semantics></math> may correspond to either an audio input for ASR or a text image for OCR, whereas <math id="S1.F1.8.m4.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{LM}}" display="inline"><semantics id="S1.F1.8.m4.1b"><msup id="S1.F1.8.m4.1.1" xref="S1.F1.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.8.m4.1.1.2" xref="S1.F1.8.m4.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S1.F1.8.m4.1.1.3" xref="S1.F1.8.m4.1.1.3a.cmml">LM</mtext></msup><annotation-xml encoding="MathML-Content" id="S1.F1.8.m4.1c"><apply id="S1.F1.8.m4.1.1.cmml" xref="S1.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m4.1.1.1.cmml" xref="S1.F1.8.m4.1.1">superscript</csymbol><ci id="S1.F1.8.m4.1.1.2.cmml" xref="S1.F1.8.m4.1.1.2">𝒵</ci><ci id="S1.F1.8.m4.1.1.3a.cmml" xref="S1.F1.8.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S1.F1.8.m4.1.1.3.cmml" xref="S1.F1.8.m4.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m4.1d">\mathcal{Z}^{\texttt{LM}}</annotation></semantics></math> typically represents a textual prompt.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">To address the aforementioned challenges, we introduce a novel shallow fusion framework, termed “Generative Fusion Decoding” (GFD). GFD resolves the token space mismatch between models by bridging heterogeneous spaces through the expected score values of plausible sequences and mapping text token space to byte token space. This allows GFD to seamlessly fuse LLMs with text recognition models during the decoding process. Our unified framework is plug-and-play, applicable to text recognition tasks such as ASR and OCR, and compatible with diverse auto-regressive text recognition models as well as language models. We highlight three main advantages of GFD. First, GFD addresses key limitation of previous fusion techniques — namely the complexity of aligning different model sample spaces via re-training associated with prior deep integration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> or two-pass <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> strategies. It allows LLMs to participate in the sampling process as conventional shallow fusion, providing real-time correction of errors generated by the text recognition model, thereby extending the influence of LLMs beyond the complete outputs of the recognition model. Secondly, as modern LLMs are trained on trillions of multilingual text tokens <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, generally around 3 orders of magnitude more than end-to-end ASR or OCR models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, LLMs in GFD can be seen as a strong scoring model in the step by step decoding that improves the multi-lingual outputs of ASR and OCR systems. Lastly, because of the in-context learning ability of LLMs, the GFD fusion system with LLMs and ASR can readily leverage domain information as prompts effectively for domain adaptation similarly to prior work through re-scoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> or instruction tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">To evaluate the efficacy of our algorithm, we implemented the GFD for ASR and OCR tasks. In the ASR task, we evaluated on the conventional ASR task as shown in Section <a href="#S4.SS2" title="4.2 Conventional speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> for English and Chinese audios. The evaluation of Chinese ASR is motivated by existing literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, which indicates a performance outlier in Chinese compared to other languages despite abundant paired-training data. We hypothesized that LLMs could enhance Chinese ASR by offering additional scoring to differentiate between semantically distinct but homophonous words. Furthermore, we demonstrate that ASR with GFD can improve recognition for long-form audio through leveraging the long-context ability of LLMs (Section <a href="#S4.SS3" title="4.3 Long-form speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>); for context-aware recognition for rare words and domain tags via in-context learning capabilities of LLMs (Section <a href="#S4.SS4" title="4.4 Context-aware speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>). Lastly, application to the OCR task, particularly targeting long text OCR for historical documents, demonstrates that OCR with GFD can significantly improve recognition accuracy (Section <a href="#S4.SS5" title="4.5 Optical Character Recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.5</span></a>).</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Model fusion</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Training a multi-objective model from scratch is often costly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Consequently, researchers have pivoted towards combining existing models with different modalities to improve accuracy without the prohibitive costs of building new systems from the ground up.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">Model fusion developed in the field of ASR provides a plausible path for combining existing trained models. The technique have evolved significantly in recent years, encompassing a variety of approaches designed to integrate different models to enhance performance. Shallow fusion or late fusion, often employed in ASR, combines end-to-end ASR models with external language models at the decoding level, improving recognition accuracy without altering the underlying ASR architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. However, due to the heterogeneous sample spaces of models, the prerequisite of shallow and late fusion requires aligning sample spaces of model distributions, enabled through fine-tuning a projection module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Late fusion training methods may suffer from modality laziness problem in tasks where uni-modal priors are meaningful <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Work in re-scoring N-best hypothesis from the first pass inference with an external language model has been shown effective in reducing recognition errors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. However, the method prunes the correct prefix early on away from N-best list and requires a second pass in the decoding process.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p">Alternatively, deep fusion integrates models at the level of hidden feature, requiring fine-tuning models to fuse deep features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Cross-modal fusion, similar to deep fusion, integrates pre-trained end-to-end ASR model with LLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> or vision model with LLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> via learning a joint representation with large amount of extra paired audio-text or image-text data.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.1" class="ltx_p">Our newly proposed approach—GFD—decodes in homogeneous sequence element space with byte strings, and therefore relaxes the alignment of sample spaces of distributions without any model training. Without pre-training or fine-tuning, we ensure that the individual pre-trained model performance is guaranteed on their respective task, and is not influenced by volatility of further training.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Contextual conditioning</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Auto-regressive LLMs have exhibited capabilities in in-context learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, instruction following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, and knowledge synthesis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Such capabilities have been applied to solving domain adaptation in speech recognition for rare words or out-of-domain context through contextual biasing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and prompting fine-tuned models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. With GFD, such problem setting can be tackled by leveraging a performant LLM as is through prompting without further fine-tuning.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Chinese ASR</h3>

<div id="S2.SS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS3.p1.1" class="ltx_p">One of the most significant challenges in developing ASR systems for the Chinese language stems from its highly homophonous nature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Unlike English, where there is a larger variety of phonemes and a relatively consistent correspondence between spelling and sound, Chinese relies on a limited set of tones and syllables to represent thousands of characters. Consequently, Chinese ASR systems must not only accurately capture the tonal nuances but also analyze the linguistic context to disambiguate these homophones. This requires sophisticated LMs that can effectively leverage contextual clues to predict the intended characters. The integration of LLMs has shown promise in addressing these challenges <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. GFD is also expected to enhance the performance of Chinese ASR by utilizing the contextual conditioning capabilities of LLMs.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Generative fusion decoding</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.3" class="ltx_p">For conditional text generation models, the sequence with the highest probability during inference is found using the following formula:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\{T_{s}\}^{*}=\underset{\{T_{s}\}}{\mathrm{arg\,max}}\log\mathbb{P}(\{T_{s}\},\mathcal{Z})," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">{</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><munder accentunder="true" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mrow id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.2.2" xref="S3.E1.m1.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E1.m1.1.1.2.1" xref="S3.E1.m1.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.1.1.2.3" xref="S3.E1.m1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">{</mo><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml">}</mo></mrow></munder><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E1.m1.3.3.1.1.2.3a" xref="S3.E1.m1.3.3.1.1.2.3.cmml">⁡</mo><mi id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2a" xref="S3.E1.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.cmml">{</mo><msub id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">T</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒵</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1">superscript</csymbol><set id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">𝑠</ci></apply></set><times id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"></times></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"></times><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><set id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑇</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑠</ci></apply></set><apply id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"><times id="S3.E1.m1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.2.1"></times><ci id="S3.E1.m1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.2.2">arg</ci><ci id="S3.E1.m1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.2.3">max</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"><log id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.1"></log><ci id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">ℙ</ci></apply><interval closure="open" id="S3.E1.m1.3.3.1.1.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1"><set id="S3.E1.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2">𝑇</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒵</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\{T_{s}\}^{*}=\underset{\{T_{s}\}}{\mathrm{arg\,max}}\log\mathbb{P}(\{T_{s}\},\mathcal{Z}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.2" class="ltx_p">where <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\{T_{s}\}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">T</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><set id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1"><apply id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2">𝑇</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\{T_{s}\}</annotation></semantics></math> represents the sequence of tokens generated by the model, and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{Z}</annotation></semantics></math> represents the given context or conditioning information, such as audio for speech recognition models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, images for vision-language-models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, and prompts for typical language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">Auto-regressive generation is one approach to realize conditional text generation. In this approach, the auto-regressive model is conditioned on the previously generated tokens to generate the next token sequentially. Therefore, the probability <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\log\mathbb{P}(\{T_{s}\}|\mathcal{Z})" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS1.p2.1.m1.1.1.3a" xref="S3.SS1.p2.1.m1.1.1.3.cmml">⁡</mo><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo fence="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml">𝒵</mi></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></times><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><log id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></log><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℙ</ci></apply><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">conditional</csymbol><set id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1"><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">𝒵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\log\mathbb{P}(\{T_{s}\}|\mathcal{Z})</annotation></semantics></math> is typically decomposed using the chain rule of probability, as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\log\mathbb{P}(\{T_{s}\},\mathcal{Z})=\sum_{s=1}^{S}\log\mathbb{P}(T_{s}\mid T_{&lt;s},\mathcal{Z})," display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.3.3.1.1.1.3a" xref="S3.E2.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S3.E2.m1.3.3.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝒵</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.4" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><munderover id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E2.m1.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.3.2" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.E2.m1.3.3.1.1.2.2.2.3.1" xref="S3.E2.m1.3.3.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.1.1.2.2.2.3.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.3.3.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml">S</mi></munderover><mrow id="S3.E2.m1.3.3.1.1.2.1" xref="S3.E2.m1.3.3.1.1.2.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.2.1.3" xref="S3.E2.m1.3.3.1.1.2.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.3.1" xref="S3.E2.m1.3.3.1.1.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.3.3.1.1.2.1.3a" xref="S3.E2.m1.3.3.1.1.2.1.3.cmml">⁡</mo><mi id="S3.E2.m1.3.3.1.1.2.1.3.2" xref="S3.E2.m1.3.3.1.1.2.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.1.2" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">T</mi><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.2.cmml">∣</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">T</mi><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝒵</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"></eq><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2"></times><apply id="S3.E2.m1.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3"><log id="S3.E2.m1.3.3.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.3.1"></log><ci id="S3.E2.m1.3.3.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.3.2">ℙ</ci></apply><interval closure="open" id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><set id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝒵</ci></interval></apply><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><apply id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3"><eq id="S3.E2.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2">𝑠</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3">𝑆</ci></apply><apply id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1"><times id="S3.E2.m1.3.3.1.1.2.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.2"></times><apply id="S3.E2.m1.3.3.1.1.2.1.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.3"><log id="S3.E2.m1.3.3.1.1.2.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.3.1"></log><ci id="S3.E2.m1.3.3.1.1.2.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.3.2">ℙ</ci></apply><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.2">conditional</csymbol><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.2">𝑇</ci><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.3">𝑠</ci></apply><list id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1"><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">𝑇</ci><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3"><lt id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝒵</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\log\mathbb{P}(\{T_{s}\},\mathcal{Z})=\sum_{s=1}^{S}\log\mathbb{P}(T_{s}\mid T_{&lt;s},\mathcal{Z}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">where <math id="S3.SS1.p2.2.m1.1" class="ltx_Math" alttext="T_{s}" display="inline"><semantics id="S3.SS1.p2.2.m1.1a"><msub id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml"><mi id="S3.SS1.p2.2.m1.1.1.2" xref="S3.SS1.p2.2.m1.1.1.2.cmml">T</mi><mi id="S3.SS1.p2.2.m1.1.1.3" xref="S3.SS1.p2.2.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><apply id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m1.1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m1.1.1.2.cmml" xref="S3.SS1.p2.2.m1.1.1.2">𝑇</ci><ci id="S3.SS1.p2.2.m1.1.1.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">T_{s}</annotation></semantics></math> is the token at position <math id="S3.SS1.p2.3.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS1.p2.3.m2.1a"><mi id="S3.SS1.p2.3.m2.1.1" xref="S3.SS1.p2.3.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m2.1b"><ci id="S3.SS1.p2.3.m2.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m2.1c">s</annotation></semantics></math> in the sequence, and <math id="S3.SS1.p2.4.m3.1" class="ltx_Math" alttext="T_{&lt;s}" display="inline"><semantics id="S3.SS1.p2.4.m3.1a"><msub id="S3.SS1.p2.4.m3.1.1" xref="S3.SS1.p2.4.m3.1.1.cmml"><mi id="S3.SS1.p2.4.m3.1.1.2" xref="S3.SS1.p2.4.m3.1.1.2.cmml">T</mi><mrow id="S3.SS1.p2.4.m3.1.1.3" xref="S3.SS1.p2.4.m3.1.1.3.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.2" xref="S3.SS1.p2.4.m3.1.1.3.2.cmml"></mi><mo id="S3.SS1.p2.4.m3.1.1.3.1" xref="S3.SS1.p2.4.m3.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p2.4.m3.1.1.3.3" xref="S3.SS1.p2.4.m3.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m3.1b"><apply id="S3.SS1.p2.4.m3.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.2.cmml" xref="S3.SS1.p2.4.m3.1.1.2">𝑇</ci><apply id="S3.SS1.p2.4.m3.1.1.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3"><lt id="S3.SS1.p2.4.m3.1.1.3.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p2.4.m3.1.1.3.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.2">absent</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m3.1c">T_{&lt;s}</annotation></semantics></math> represents all the tokens preceding position <math id="S3.SS1.p2.5.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS1.p2.5.m4.1a"><mi id="S3.SS1.p2.5.m4.1.1" xref="S3.SS1.p2.5.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m4.1b"><ci id="S3.SS1.p2.5.m4.1.1.cmml" xref="S3.SS1.p2.5.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m4.1c">s</annotation></semantics></math>. In real-world applications, it is impracticable to enumerate all possible token sequences, so beam search is typically used as an approximation method.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.8" class="ltx_p">In the setting of shallow fusion, we attempt to let multiple models jointly determine the sequence, as shown in the following formula rewrote from Equation (<a href="#S3.E1" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>):</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\{T_{s}^{\texttt{fuse}}\}^{*}" display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><msup id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3X.2.1.1.m1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2.3.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S3.E3X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1">superscript</csymbol><set id="S3.E3X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1"><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.3">fuse</mtext></ci></apply></set><times id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle\{T_{s}^{\texttt{fuse}}\}^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\underset{\{T_{s}^{\texttt{fuse}}\}}{\mathrm{arg\,max}}\sum_{m}\lambda_{m}\log\mathbb{P}_{m}(\{T_{s}^{(m)}\}=\{T_{s}^{\texttt{fuse}}\},\mathcal{Z}^{(m)})" display="inline"><semantics id="S3.E3X.3.2.2.m1.4a"><mrow id="S3.E3X.3.2.2.m1.4.4" xref="S3.E3X.3.2.2.m1.4.4.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.3" xref="S3.E3X.3.2.2.m1.4.4.3.cmml"></mi><mo id="S3.E3X.3.2.2.m1.4.4.2" xref="S3.E3X.3.2.2.m1.4.4.2.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1" xref="S3.E3X.3.2.2.m1.4.4.1.cmml"><munder accentunder="true" id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.1.1.2" xref="S3.E3X.3.2.2.m1.1.1.2.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.2.2" xref="S3.E3X.3.2.2.m1.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E3X.3.2.2.m1.1.1.2.1" xref="S3.E3X.3.2.2.m1.1.1.2.1.cmml">​</mo><mi id="S3.E3X.3.2.2.m1.1.1.2.3" xref="S3.E3X.3.2.2.m1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E3X.3.2.2.m1.1.1.1.1" xref="S3.E3X.3.2.2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3X.3.2.2.m1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.2.3.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S3.E3X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E3X.3.2.2.m1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.1.1.1.2.cmml">}</mo></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.4.4.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.cmml"><munder id="S3.E3X.3.2.2.m1.4.4.1.1.2a" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.cmml"><mo movablelimits="false" id="S3.E3X.3.2.2.m1.4.4.1.1.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.2.cmml">∑</mo><mi id="S3.E3X.3.2.2.m1.4.4.1.1.2.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.3.cmml">m</mi></munder></mstyle><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.cmml"><msub id="S3.E3X.3.2.2.m1.4.4.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3.2.cmml">λ</mi><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3.3.cmml">m</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.4" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.4a" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.cmml">⁡</mo><msub id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.2.cmml">ℙ</mi><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.3.cmml">m</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.2a" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><mrow id="S3.E3X.3.2.2.m1.2.2.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.2.2.1.3.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.2.2.1.1" xref="S3.E3X.3.2.2.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E3X.3.2.2.m1.2.2.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.4" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml">{</mo><msubsup id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">T</mi><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml">}</mo></mrow><mo id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml">,</mo><msup id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml">𝒵</mi><mrow id="S3.E3X.3.2.2.m1.3.3.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.3.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.3.3.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.cmml">m</mi><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml">)</mo></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.4b"><apply id="S3.E3X.3.2.2.m1.4.4.cmml" xref="S3.E3X.3.2.2.m1.4.4"><eq id="S3.E3X.3.2.2.m1.4.4.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.4.4.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.3">absent</csymbol><apply id="S3.E3X.3.2.2.m1.4.4.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1"><times id="S3.E3X.3.2.2.m1.4.4.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.2"></times><apply id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1"><set id="S3.E3X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.E3X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E3X.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.3">fuse</mtext></ci></apply></set><apply id="S3.E3X.3.2.2.m1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.2"><times id="S3.E3X.3.2.2.m1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.1"></times><ci id="S3.E3X.3.2.2.m1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.2">arg</ci><ci id="S3.E3X.3.2.2.m1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.3">max</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1"><apply id="S3.E3X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.2">subscript</csymbol><sum id="S3.E3X.3.2.2.m1.4.4.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.2"></sum><ci id="S3.E3X.3.2.2.m1.4.4.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.2.3">𝑚</ci></apply><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1"><times id="S3.E3X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.2"></times><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3.2">𝜆</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4"><log id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.1"></log><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.2">ℙ</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.4.2.3">𝑚</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1"><eq id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.4"></eq><set id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E3X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.1.1">𝑚</ci></apply></set><list id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2"><set id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1"><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑇</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3a.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.3">fuse</mtext></ci></apply></set><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2">𝒵</ci><ci id="S3.E3X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1">𝑚</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.4c">\displaystyle=\underset{\{T_{s}^{\texttt{fuse}}\}}{\mathrm{arg\,max}}\sum_{m}\lambda_{m}\log\mathbb{P}_{m}(\{T_{s}^{(m)}\}=\{T_{s}^{\texttt{fuse}}\},\mathcal{Z}^{(m)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p3.7" class="ltx_p">where <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\{T_{s}^{\texttt{fuse}}\}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">{</mo><msubsup id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml">T</mi><mi id="S3.SS1.p3.1.m1.1.1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.1.m1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><set id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1"><apply id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.1.1.3a.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3">fuse</mtext></ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\{T_{s}^{\texttt{fuse}}\}</annotation></semantics></math> represents the fused sequence of tokens generated by combining the outputs of multiple models, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\lambda_{m}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">λ</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝜆</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\lambda_{m}</annotation></semantics></math> is a weighting factor for the <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">m</annotation></semantics></math>-th model, <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="p_{m}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑝</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">p_{m}</annotation></semantics></math> denotes the probability distribution of the <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">m</annotation></semantics></math>-th model and <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{Z}^{(m)}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><msup id="S3.SS1.p3.6.m6.1.2" xref="S3.SS1.p3.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.6.m6.1.2.2" xref="S3.SS1.p3.6.m6.1.2.2.cmml">𝒵</mi><mrow id="S3.SS1.p3.6.m6.1.1.1.3" xref="S3.SS1.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.1" xref="S3.SS1.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p3.6.m6.1.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.2" xref="S3.SS1.p3.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.2.cmml" xref="S3.SS1.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.2">superscript</csymbol><ci id="S3.SS1.p3.6.m6.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.2.2">𝒵</ci><ci id="S3.SS1.p3.6.m6.1.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\mathcal{Z}^{(m)}</annotation></semantics></math> represents the context or conditioning information specific to the <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">m</annotation></semantics></math>-th model.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.1" class="ltx_p">When the sample spaces of models are the same, Equations (<a href="#S3.E3" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and (<a href="#S3.E2" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) can be combined to realize incremental fusion. If the models have different sample spaces due to a mismatch in token spaces, there is no simple way to achieve incremental fusion. One alternative method to approximate Equation (<a href="#S3.E3" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is to fuse at the level of the fully generated results from each model. Nevertheless, in practice, fusion at the level of fully generated results poses the problem of an enormous search space because different conditioning variables <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{Z}^{(m)}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msup id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.2.2" xref="S3.SS1.p4.1.m1.1.2.2.cmml">𝒵</mi><mrow id="S3.SS1.p4.1.m1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2">𝒵</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathcal{Z}^{(m)}</annotation></semantics></math> may produce vastly different results.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">To address these challenges, we have introduced a probability transformation, denoted as <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{M}^{(m)}" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><msup id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2.cmml">ℳ</mi><mrow id="S3.SS1.p5.1.m1.1.1.1.3" xref="S3.SS1.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.1.m1.1.1.1.3.1" xref="S3.SS1.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p5.1.m1.1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2">superscript</csymbol><ci id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2">ℳ</ci><ci id="S3.SS1.p5.1.m1.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\mathcal{M}^{(m)}</annotation></semantics></math>, that converts token-level representations into byte-level representations:</p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{M}^{(m)}:\mathbb{P}_{m}(\{T_{s}\},\mathcal{Z}^{(m)})\longrightarrow\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})," display="inline"><semantics id="S3.E4X.2.1.1.m1.4a"><mrow id="S3.E4X.2.1.1.m1.4.4.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.4.4.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml"><msup id="S3.E4X.2.1.1.m1.4.4.1.1.6" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.2.1.1.m1.4.4.1.1.6.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.2.cmml">ℳ</mi><mrow id="S3.E4X.2.1.1.m1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.1.1.1.3.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.cmml">(</mo><mi id="S3.E4X.2.1.1.m1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E4X.2.1.1.m1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.cmml">)</mo></mrow></msup><mo lspace="0.278em" rspace="0.278em" id="S3.E4X.2.1.1.m1.4.4.1.1.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.5.cmml">:</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.cmml"><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.cmml"><msub id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.2.cmml">ℙ</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">,</mo><msup id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml">𝒵</mi><mrow id="S3.E4X.2.1.1.m1.2.2.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.3.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E4X.2.1.1.m1.2.2.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.4.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.5.cmml">⟶</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.4.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.cmml"><msub id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.2.cmml">ℙ</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.3.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.3.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.2.cmml">{</mo><msub id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml">B</mi><mi id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.4" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.3.cmml">,</mo><msup id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.2.cmml">𝒵</mi><mrow id="S3.E4X.2.1.1.m1.3.3.1.3" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.3.3.1.3.1" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.cmml">(</mo><mi id="S3.E4X.2.1.1.m1.3.3.1.1" xref="S3.E4X.2.1.1.m1.3.3.1.1.cmml">m</mi><mo stretchy="false" id="S3.E4X.2.1.1.m1.3.3.1.3.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.5" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4X.2.1.1.m1.4.4.1.2" xref="S3.E4X.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.4b"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1"><ci id="S3.E4X.2.1.1.m1.4.4.1.1.5.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.5">:</ci><apply id="S3.E4X.2.1.1.m1.4.4.1.1.6.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.6"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.6.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.6">superscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.6.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.6.2">ℳ</ci><ci id="S3.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1">𝑚</ci></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4"><ci id="S3.E4X.2.1.1.m1.4.4.1.1.4.5.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.5">⟶</ci><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2"><times id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.3"></times><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.2">ℙ</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.4.3">𝑚</ci></apply><interval closure="open" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2"><set id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><apply id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2">𝒵</ci><ci id="S3.E4X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1">𝑚</ci></apply></interval></apply><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4"><times id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.3"></times><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.2">ℙ</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.4.3">𝑚</ci></apply><interval closure="open" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2"><set id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1"><apply id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.2">𝐵</ci><ci id="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.3.3.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2">superscript</csymbol><ci id="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.1.1.4.4.2.2.2.2">𝒵</ci><ci id="S3.E4X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E4X.2.1.1.m1.3.3.1.1">𝑚</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.4c">\displaystyle\mathcal{M}^{(m)}:\mathbb{P}_{m}(\{T_{s}\},\mathcal{Z}^{(m)})\longrightarrow\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p5.3" class="ltx_p">where <math id="S3.SS1.p5.2.m1.1" class="ltx_Math" alttext="\{B_{l}\}" display="inline"><semantics id="S3.SS1.p5.2.m1.1a"><mrow id="S3.SS1.p5.2.m1.1.1.1" xref="S3.SS1.p5.2.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.2.m1.1.1.1.2" xref="S3.SS1.p5.2.m1.1.1.2.cmml">{</mo><msub id="S3.SS1.p5.2.m1.1.1.1.1" xref="S3.SS1.p5.2.m1.1.1.1.1.cmml"><mi id="S3.SS1.p5.2.m1.1.1.1.1.2" xref="S3.SS1.p5.2.m1.1.1.1.1.2.cmml">B</mi><mi id="S3.SS1.p5.2.m1.1.1.1.1.3" xref="S3.SS1.p5.2.m1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p5.2.m1.1.1.1.3" xref="S3.SS1.p5.2.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m1.1b"><set id="S3.SS1.p5.2.m1.1.1.2.cmml" xref="S3.SS1.p5.2.m1.1.1.1"><apply id="S3.SS1.p5.2.m1.1.1.1.1.cmml" xref="S3.SS1.p5.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m1.1.1.1.1.1.cmml" xref="S3.SS1.p5.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m1.1.1.1.1.2.cmml" xref="S3.SS1.p5.2.m1.1.1.1.1.2">𝐵</ci><ci id="S3.SS1.p5.2.m1.1.1.1.1.3.cmml" xref="S3.SS1.p5.2.m1.1.1.1.1.3">𝑙</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m1.1c">\{B_{l}\}</annotation></semantics></math> represents the sequence of bytes after the transformation, and <math id="S3.SS1.p5.3.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p5.3.m2.1a"><mi id="S3.SS1.p5.3.m2.1.1" xref="S3.SS1.p5.3.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m2.1b"><ci id="S3.SS1.p5.3.m2.1.1.cmml" xref="S3.SS1.p5.3.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m2.1c">l</annotation></semantics></math> denotes the position in the byte sequence. This transformation allows for a unified representation across different models, facilitating the fusion process even when the original token spaces differ. The byte-level fusion can then be performed using a similar approach to Equation (<a href="#S3.E3" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), but with the byte-level probabilities:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\{B_{l}^{\texttt{fuse}}\}^{*}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><msup id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.E5X.2.1.1.m1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2.2.cmml">B</mi><mi id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2.3.cmml">l</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E5X.2.1.1.m1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1">superscript</csymbol><set id="S3.E5X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1"><apply id="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2.2">𝐵</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.3a.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.3">fuse</mtext></ci></apply></set><times id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\{B_{l}^{\texttt{fuse}}\}^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\underset{\{B_{l}^{\texttt{fuse}}\}}{\mathrm{arg\,max}}\sum_{m}\lambda_{m}\log\mathbb{P}_{m}(\{B_{l}\}=\{B_{l}^{\texttt{fuse}}\},\mathcal{Z}^{(m)})." display="inline"><semantics id="S3.E5X.3.2.2.m1.3a"><mrow id="S3.E5X.3.2.2.m1.3.3.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.3.3.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.3.3.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.cmml"><munder accentunder="true" id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.2.1" xref="S3.E5X.3.2.2.m1.1.1.2.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml">B</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml">l</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">}</mo></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.3.3.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.cmml"><munder id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2a" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml">m</mi></munder></mstyle><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml">λ</mi><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml">m</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4a" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.cmml">⁡</mo><msub id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.2.cmml">ℙ</mi><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.3.cmml">m</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2a" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml">{</mo><msubsup id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">B</mi><mi id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml">l</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3a.cmml">fuse</mtext></msubsup><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml">}</mo></mrow><mo id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">,</mo><msup id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝒵</mi><mrow id="S3.E5X.3.2.2.m1.2.2.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.2.2.1.3.1" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.2.2.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.2.2.1.3.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">)</mo></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5X.3.2.2.m1.3.3.1.2" xref="S3.E5X.3.2.2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.3b"><apply id="S3.E5X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1"><eq id="S3.E5X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1"><times id="S3.E5X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"><set id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2">𝐵</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3">fuse</mtext></ci></apply></set><apply id="S3.E5X.3.2.2.m1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.2"><times id="S3.E5X.3.2.2.m1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.2.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.2.2">arg</ci><ci id="S3.E5X.3.2.2.m1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.2.3">max</ci></apply></apply><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1"><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.2"></sum><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.2">𝜆</ci><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4"><log id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.1"></log><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.2">ℙ</ci><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.4.2.3">𝑚</ci></apply></apply><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1"><eq id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.4"></eq><set id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></set><list id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2"><set id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1"><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2">𝐵</ci><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3a.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.3">fuse</mtext></ci></apply></set><apply id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.2">𝒵</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1">𝑚</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.3c">\displaystyle=\underset{\{B_{l}^{\texttt{fuse}}\}}{\mathrm{arg\,max}}\sum_{m}\lambda_{m}\log\mathbb{P}_{m}(\{B_{l}\}=\{B_{l}^{\texttt{fuse}}\},\mathcal{Z}^{(m)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p5.7" class="ltx_p">To operationalize the probability transformation <math id="S3.SS1.p5.4.m1.1" class="ltx_Math" alttext="\mathcal{M}^{(m)}" display="inline"><semantics id="S3.SS1.p5.4.m1.1a"><msup id="S3.SS1.p5.4.m1.1.2" xref="S3.SS1.p5.4.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.4.m1.1.2.2" xref="S3.SS1.p5.4.m1.1.2.2.cmml">ℳ</mi><mrow id="S3.SS1.p5.4.m1.1.1.1.3" xref="S3.SS1.p5.4.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.4.m1.1.1.1.3.1" xref="S3.SS1.p5.4.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.4.m1.1.1.1.1" xref="S3.SS1.p5.4.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p5.4.m1.1.1.1.3.2" xref="S3.SS1.p5.4.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m1.1b"><apply id="S3.SS1.p5.4.m1.1.2.cmml" xref="S3.SS1.p5.4.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m1.1.2.1.cmml" xref="S3.SS1.p5.4.m1.1.2">superscript</csymbol><ci id="S3.SS1.p5.4.m1.1.2.2.cmml" xref="S3.SS1.p5.4.m1.1.2.2">ℳ</ci><ci id="S3.SS1.p5.4.m1.1.1.1.1.cmml" xref="S3.SS1.p5.4.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m1.1c">\mathcal{M}^{(m)}</annotation></semantics></math>, we define a mapping from the token-level probabilities to the byte-level probabilities. This mapping takes into account the prefix relationship between the token sequence and the byte sequence. Specifically, we express the byte-level probability <math id="S3.SS1.p5.5.m2.3" class="ltx_Math" alttext="\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})" display="inline"><semantics id="S3.SS1.p5.5.m2.3a"><mrow id="S3.SS1.p5.5.m2.3.3" xref="S3.SS1.p5.5.m2.3.3.cmml"><msub id="S3.SS1.p5.5.m2.3.3.4" xref="S3.SS1.p5.5.m2.3.3.4.cmml"><mi id="S3.SS1.p5.5.m2.3.3.4.2" xref="S3.SS1.p5.5.m2.3.3.4.2.cmml">ℙ</mi><mi id="S3.SS1.p5.5.m2.3.3.4.3" xref="S3.SS1.p5.5.m2.3.3.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p5.5.m2.3.3.3" xref="S3.SS1.p5.5.m2.3.3.3.cmml">​</mo><mrow id="S3.SS1.p5.5.m2.3.3.2.2" xref="S3.SS1.p5.5.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p5.5.m2.3.3.2.2.3" xref="S3.SS1.p5.5.m2.3.3.2.3.cmml">(</mo><mrow id="S3.SS1.p5.5.m2.2.2.1.1.1.1" xref="S3.SS1.p5.5.m2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.5.m2.2.2.1.1.1.1.2" xref="S3.SS1.p5.5.m2.2.2.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.2" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.2.cmml">B</mi><mi id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.3" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p5.5.m2.2.2.1.1.1.1.3" xref="S3.SS1.p5.5.m2.2.2.1.1.1.2.cmml">}</mo></mrow><mo id="S3.SS1.p5.5.m2.3.3.2.2.4" xref="S3.SS1.p5.5.m2.3.3.2.3.cmml">,</mo><msup id="S3.SS1.p5.5.m2.3.3.2.2.2" xref="S3.SS1.p5.5.m2.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.5.m2.3.3.2.2.2.2" xref="S3.SS1.p5.5.m2.3.3.2.2.2.2.cmml">𝒵</mi><mrow id="S3.SS1.p5.5.m2.1.1.1.3" xref="S3.SS1.p5.5.m2.3.3.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p5.5.m2.1.1.1.3.1" xref="S3.SS1.p5.5.m2.3.3.2.2.2.cmml">(</mo><mi id="S3.SS1.p5.5.m2.1.1.1.1" xref="S3.SS1.p5.5.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p5.5.m2.1.1.1.3.2" xref="S3.SS1.p5.5.m2.3.3.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS1.p5.5.m2.3.3.2.2.5" xref="S3.SS1.p5.5.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m2.3b"><apply id="S3.SS1.p5.5.m2.3.3.cmml" xref="S3.SS1.p5.5.m2.3.3"><times id="S3.SS1.p5.5.m2.3.3.3.cmml" xref="S3.SS1.p5.5.m2.3.3.3"></times><apply id="S3.SS1.p5.5.m2.3.3.4.cmml" xref="S3.SS1.p5.5.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m2.3.3.4.1.cmml" xref="S3.SS1.p5.5.m2.3.3.4">subscript</csymbol><ci id="S3.SS1.p5.5.m2.3.3.4.2.cmml" xref="S3.SS1.p5.5.m2.3.3.4.2">ℙ</ci><ci id="S3.SS1.p5.5.m2.3.3.4.3.cmml" xref="S3.SS1.p5.5.m2.3.3.4.3">𝑚</ci></apply><interval closure="open" id="S3.SS1.p5.5.m2.3.3.2.3.cmml" xref="S3.SS1.p5.5.m2.3.3.2.2"><set id="S3.SS1.p5.5.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1"><apply id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.2">𝐵</ci><ci id="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.5.m2.2.2.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.SS1.p5.5.m2.3.3.2.2.2.cmml" xref="S3.SS1.p5.5.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p5.5.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.p5.5.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p5.5.m2.3.3.2.2.2.2">𝒵</ci><ci id="S3.SS1.p5.5.m2.1.1.1.1.cmml" xref="S3.SS1.p5.5.m2.1.1.1.1">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m2.3c">\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})</annotation></semantics></math> as a sum over all possible token sequences that share a common prefix with the byte sequence <math id="S3.SS1.p5.6.m3.1" class="ltx_Math" alttext="\{B_{l}\}" display="inline"><semantics id="S3.SS1.p5.6.m3.1a"><mrow id="S3.SS1.p5.6.m3.1.1.1" xref="S3.SS1.p5.6.m3.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.6.m3.1.1.1.2" xref="S3.SS1.p5.6.m3.1.1.2.cmml">{</mo><msub id="S3.SS1.p5.6.m3.1.1.1.1" xref="S3.SS1.p5.6.m3.1.1.1.1.cmml"><mi id="S3.SS1.p5.6.m3.1.1.1.1.2" xref="S3.SS1.p5.6.m3.1.1.1.1.2.cmml">B</mi><mi id="S3.SS1.p5.6.m3.1.1.1.1.3" xref="S3.SS1.p5.6.m3.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p5.6.m3.1.1.1.3" xref="S3.SS1.p5.6.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m3.1b"><set id="S3.SS1.p5.6.m3.1.1.2.cmml" xref="S3.SS1.p5.6.m3.1.1.1"><apply id="S3.SS1.p5.6.m3.1.1.1.1.cmml" xref="S3.SS1.p5.6.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m3.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.6.m3.1.1.1.1.2.cmml" xref="S3.SS1.p5.6.m3.1.1.1.1.2">𝐵</ci><ci id="S3.SS1.p5.6.m3.1.1.1.1.3.cmml" xref="S3.SS1.p5.6.m3.1.1.1.1.3">𝑙</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m3.1c">\{B_{l}\}</annotation></semantics></math>. The probability of each token sequence is computed as the product of the conditional probabilities of each token given the preceding tokens and the context <math id="S3.SS1.p5.7.m4.1" class="ltx_Math" alttext="\mathcal{Z}^{(m)}" display="inline"><semantics id="S3.SS1.p5.7.m4.1a"><msup id="S3.SS1.p5.7.m4.1.2" xref="S3.SS1.p5.7.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.7.m4.1.2.2" xref="S3.SS1.p5.7.m4.1.2.2.cmml">𝒵</mi><mrow id="S3.SS1.p5.7.m4.1.1.1.3" xref="S3.SS1.p5.7.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.7.m4.1.1.1.3.1" xref="S3.SS1.p5.7.m4.1.2.cmml">(</mo><mi id="S3.SS1.p5.7.m4.1.1.1.1" xref="S3.SS1.p5.7.m4.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p5.7.m4.1.1.1.3.2" xref="S3.SS1.p5.7.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m4.1b"><apply id="S3.SS1.p5.7.m4.1.2.cmml" xref="S3.SS1.p5.7.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m4.1.2.1.cmml" xref="S3.SS1.p5.7.m4.1.2">superscript</csymbol><ci id="S3.SS1.p5.7.m4.1.2.2.cmml" xref="S3.SS1.p5.7.m4.1.2.2">𝒵</ci><ci id="S3.SS1.p5.7.m4.1.1.1.1.cmml" xref="S3.SS1.p5.7.m4.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m4.1c">\mathcal{Z}^{(m)}</annotation></semantics></math>. This relationship is formalized in the following equation:</p>
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.6" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})=\sum_{\{B_{l}\}}\biggr{[}\prod_{s}\mathbb{P}_{m}(T_{s}^{(m)}\mid T_{&lt;s}^{(m)},\mathcal{Z}^{(m)})\biggr{]}_{\{T_{s}\}}\times\mathbb{1}\bigl{(}\{T_{s}\}\texttt{.prefix}=\{B_{l}\}\bigl{)}," display="inline"><semantics id="S3.E6X.2.1.1.m1.6a"><mrow id="S3.E6X.2.1.1.m1.6b"><mrow id="S3.E6X.2.1.1.m1.6.7"><msub id="S3.E6X.2.1.1.m1.6.7.1"><mi id="S3.E6X.2.1.1.m1.6.7.1.2">ℙ</mi><mi id="S3.E6X.2.1.1.m1.6.7.1.3">m</mi></msub><mrow id="S3.E6X.2.1.1.m1.6.7.2"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.7.2.1">(</mo><mrow id="S3.E6X.2.1.1.m1.6.7.2.2"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.7.2.2.1">{</mo><msub id="S3.E6X.2.1.1.m1.6.7.2.2.2"><mi id="S3.E6X.2.1.1.m1.6.7.2.2.2.2">B</mi><mi id="S3.E6X.2.1.1.m1.6.7.2.2.2.3">l</mi></msub><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.7.2.2.3">}</mo></mrow><mo id="S3.E6X.2.1.1.m1.6.7.2.3">,</mo><msup id="S3.E6X.2.1.1.m1.6.7.2.4"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.2.1.1.m1.6.7.2.4.2">𝒵</mi><mrow id="S3.E6X.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E6X.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E6X.2.1.1.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E6X.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.7.2.5">)</mo></mrow><mo id="S3.E6X.2.1.1.m1.6.7.3">=</mo><mstyle displaystyle="true" id="S3.E6X.2.1.1.m1.6.7.4"><munder id="S3.E6X.2.1.1.m1.6.7.4a"><mo movablelimits="false" id="S3.E6X.2.1.1.m1.6.7.4.2">∑</mo><mrow id="S3.E6X.2.1.1.m1.2.2.1.1"><mo stretchy="false" id="S3.E6X.2.1.1.m1.2.2.1.1.2">{</mo><msub id="S3.E6X.2.1.1.m1.2.2.1.1.1"><mi id="S3.E6X.2.1.1.m1.2.2.1.1.1.2">B</mi><mi id="S3.E6X.2.1.1.m1.2.2.1.1.1.3">l</mi></msub><mo stretchy="false" id="S3.E6X.2.1.1.m1.2.2.1.1.3">}</mo></mrow></munder></mstyle><mo lspace="0em" mathsize="210%" rspace="0em" id="S3.E6X.2.1.1.m1.6.7.5">[</mo></mrow><mstyle displaystyle="true" id="S3.E6X.2.1.1.m1.6.8"><munder id="S3.E6X.2.1.1.m1.6.8a"><mo movablelimits="false" id="S3.E6X.2.1.1.m1.6.8.2">∏</mo><mi id="S3.E6X.2.1.1.m1.6.8.3">s</mi></munder></mstyle><msub id="S3.E6X.2.1.1.m1.6.9"><mi id="S3.E6X.2.1.1.m1.6.9.2">ℙ</mi><mi id="S3.E6X.2.1.1.m1.6.9.3">m</mi></msub><mrow id="S3.E6X.2.1.1.m1.6.10"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.10.1">(</mo><msubsup id="S3.E6X.2.1.1.m1.6.10.2"><mi id="S3.E6X.2.1.1.m1.6.10.2.2.2">T</mi><mi id="S3.E6X.2.1.1.m1.6.10.2.2.3">s</mi><mrow id="S3.E6X.2.1.1.m1.3.3.1.3"><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.3.1">(</mo><mi id="S3.E6X.2.1.1.m1.3.3.1.1">m</mi><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.3.2">)</mo></mrow></msubsup><mo lspace="0em" rspace="0.167em" id="S3.E6X.2.1.1.m1.6.10.3">∣</mo><msubsup id="S3.E6X.2.1.1.m1.6.10.4"><mi id="S3.E6X.2.1.1.m1.6.10.4.2.2">T</mi><mrow id="S3.E6X.2.1.1.m1.6.10.4.2.3"><mi id="S3.E6X.2.1.1.m1.6.10.4.2.3.2"></mi><mo id="S3.E6X.2.1.1.m1.6.10.4.2.3.1">&lt;</mo><mi id="S3.E6X.2.1.1.m1.6.10.4.2.3.3">s</mi></mrow><mrow id="S3.E6X.2.1.1.m1.4.4.1.3"><mo stretchy="false" id="S3.E6X.2.1.1.m1.4.4.1.3.1">(</mo><mi id="S3.E6X.2.1.1.m1.4.4.1.1">m</mi><mo stretchy="false" id="S3.E6X.2.1.1.m1.4.4.1.3.2">)</mo></mrow></msubsup><mo id="S3.E6X.2.1.1.m1.6.10.5">,</mo><msup id="S3.E6X.2.1.1.m1.6.10.6"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.2.1.1.m1.6.10.6.2">𝒵</mi><mrow id="S3.E6X.2.1.1.m1.5.5.1.3"><mo stretchy="false" id="S3.E6X.2.1.1.m1.5.5.1.3.1">(</mo><mi id="S3.E6X.2.1.1.m1.5.5.1.1">m</mi><mo stretchy="false" id="S3.E6X.2.1.1.m1.5.5.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.10.7">)</mo></mrow><mo maxsize="210%" minsize="210%" id="S3.E6X.2.1.1.m1.6.11">]</mo><msub id="S3.E6X.2.1.1.m1.6.6"><mi id="S3.E6X.2.1.1.m1.6.6a"></mi><mrow id="S3.E6X.2.1.1.m1.6.6.1.1"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.6.1.1.2">{</mo><msub id="S3.E6X.2.1.1.m1.6.6.1.1.1"><mi id="S3.E6X.2.1.1.m1.6.6.1.1.1.2">T</mi><mi id="S3.E6X.2.1.1.m1.6.6.1.1.1.3">s</mi></msub><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.6.1.1.3">}</mo></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6X.2.1.1.m1.6.12">×</mo><mn id="S3.E6X.2.1.1.m1.6.13">𝟙</mn><mo maxsize="120%" minsize="120%" id="S3.E6X.2.1.1.m1.6.14">(</mo><mrow id="S3.E6X.2.1.1.m1.6.15"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.15.1">{</mo><msub id="S3.E6X.2.1.1.m1.6.15.2"><mi id="S3.E6X.2.1.1.m1.6.15.2.2">T</mi><mi id="S3.E6X.2.1.1.m1.6.15.2.3">s</mi></msub><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.15.3">}</mo></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E6X.2.1.1.m1.6.16">.prefix</mtext><mo id="S3.E6X.2.1.1.m1.6.17">=</mo><mrow id="S3.E6X.2.1.1.m1.6.18"><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.18.1">{</mo><msub id="S3.E6X.2.1.1.m1.6.18.2"><mi id="S3.E6X.2.1.1.m1.6.18.2.2">B</mi><mi id="S3.E6X.2.1.1.m1.6.18.2.3">l</mi></msub><mo stretchy="false" id="S3.E6X.2.1.1.m1.6.18.3">}</mo></mrow><mrow id="S3.E6X.2.1.1.m1.6.19"><mo lspace="0em" mathsize="120%" rspace="0em" id="S3.E6X.2.1.1.m1.6.19.1">)</mo><mo id="S3.E6X.2.1.1.m1.6.19.2">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.6c">\displaystyle\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})=\sum_{\{B_{l}\}}\biggr{[}\prod_{s}\mathbb{P}_{m}(T_{s}^{(m)}\mid T_{&lt;s}^{(m)},\mathcal{Z}^{(m)})\biggr{]}_{\{T_{s}\}}\times\mathbb{1}\bigl{(}\{T_{s}\}\texttt{.prefix}=\{B_{l}\}\bigl{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p5.12" class="ltx_p">where <span id="S3.SS1.p5.12.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">.prefix</span> is a function that maps a token sequence to its corresponding byte sequence prefix, and <math id="S3.SS1.p5.9.m2.1" class="ltx_Math" alttext="\mathbb{1}" display="inline"><semantics id="S3.SS1.p5.9.m2.1a"><mn id="S3.SS1.p5.9.m2.1.1" xref="S3.SS1.p5.9.m2.1.1.cmml">𝟙</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.9.m2.1b"><cn type="integer" id="S3.SS1.p5.9.m2.1.1.cmml" xref="S3.SS1.p5.9.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.9.m2.1c">\mathbb{1}</annotation></semantics></math> is the indicator function that is 1 if the token sequence has the specified byte sequence as a prefix and 0 otherwise. The indicator function ensures that only those token sequences that can be mapped to the given byte sequence contribute to the byte-level probability. In Equation (<a href="#S3.E6" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>), the complexity remains high at <math id="S3.SS1.p5.10.m3.1" class="ltx_Math" alttext="\mathcal{O}(V^{S})" display="inline"><semantics id="S3.SS1.p5.10.m3.1a"><mrow id="S3.SS1.p5.10.m3.1.1" xref="S3.SS1.p5.10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.10.m3.1.1.3" xref="S3.SS1.p5.10.m3.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.10.m3.1.1.2" xref="S3.SS1.p5.10.m3.1.1.2.cmml">​</mo><mrow id="S3.SS1.p5.10.m3.1.1.1.1" xref="S3.SS1.p5.10.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p5.10.m3.1.1.1.1.2" xref="S3.SS1.p5.10.m3.1.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p5.10.m3.1.1.1.1.1" xref="S3.SS1.p5.10.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.10.m3.1.1.1.1.1.2" xref="S3.SS1.p5.10.m3.1.1.1.1.1.2.cmml">V</mi><mi id="S3.SS1.p5.10.m3.1.1.1.1.1.3" xref="S3.SS1.p5.10.m3.1.1.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="S3.SS1.p5.10.m3.1.1.1.1.3" xref="S3.SS1.p5.10.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.10.m3.1b"><apply id="S3.SS1.p5.10.m3.1.1.cmml" xref="S3.SS1.p5.10.m3.1.1"><times id="S3.SS1.p5.10.m3.1.1.2.cmml" xref="S3.SS1.p5.10.m3.1.1.2"></times><ci id="S3.SS1.p5.10.m3.1.1.3.cmml" xref="S3.SS1.p5.10.m3.1.1.3">𝒪</ci><apply id="S3.SS1.p5.10.m3.1.1.1.1.1.cmml" xref="S3.SS1.p5.10.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.10.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.10.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p5.10.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.10.m3.1.1.1.1.1.2">𝑉</ci><ci id="S3.SS1.p5.10.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.10.m3.1.1.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.10.m3.1c">\mathcal{O}(V^{S})</annotation></semantics></math>, where <math id="S3.SS1.p5.11.m4.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p5.11.m4.1a"><mi id="S3.SS1.p5.11.m4.1.1" xref="S3.SS1.p5.11.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.11.m4.1b"><ci id="S3.SS1.p5.11.m4.1.1.cmml" xref="S3.SS1.p5.11.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.11.m4.1c">V</annotation></semantics></math> represents the vocabulary size of tokens and <math id="S3.SS1.p5.12.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p5.12.m5.1a"><mi id="S3.SS1.p5.12.m5.1.1" xref="S3.SS1.p5.12.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.12.m5.1b"><ci id="S3.SS1.p5.12.m5.1.1.cmml" xref="S3.SS1.p5.12.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.12.m5.1c">S</annotation></semantics></math> is the sequence length, for identifying token sequences that match the specified criteria of the indicator.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2405.14259/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="117" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.6.1" class="ltx_text ltx_font_bold">Example of the main sequence and alternative tokens.</span> Assume that the byte sequence is "abcdefghijk". The main token sequence is the tokenization result of the byte sequence and is denoted as <math id="S3.F2.3.m1.1" class="ltx_Math" alttext="\{\hat{T}_{s}\}" display="inline"><semantics id="S3.F2.3.m1.1b"><mrow id="S3.F2.3.m1.1.1.1" xref="S3.F2.3.m1.1.1.2.cmml"><mo stretchy="false" id="S3.F2.3.m1.1.1.1.2" xref="S3.F2.3.m1.1.1.2.cmml">{</mo><msub id="S3.F2.3.m1.1.1.1.1" xref="S3.F2.3.m1.1.1.1.1.cmml"><mover accent="true" id="S3.F2.3.m1.1.1.1.1.2" xref="S3.F2.3.m1.1.1.1.1.2.cmml"><mi id="S3.F2.3.m1.1.1.1.1.2.2" xref="S3.F2.3.m1.1.1.1.1.2.2.cmml">T</mi><mo id="S3.F2.3.m1.1.1.1.1.2.1" xref="S3.F2.3.m1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.F2.3.m1.1.1.1.1.3" xref="S3.F2.3.m1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.F2.3.m1.1.1.1.3" xref="S3.F2.3.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.m1.1c"><set id="S3.F2.3.m1.1.1.2.cmml" xref="S3.F2.3.m1.1.1.1"><apply id="S3.F2.3.m1.1.1.1.1.cmml" xref="S3.F2.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.3.m1.1.1.1.1.1.cmml" xref="S3.F2.3.m1.1.1.1.1">subscript</csymbol><apply id="S3.F2.3.m1.1.1.1.1.2.cmml" xref="S3.F2.3.m1.1.1.1.1.2"><ci id="S3.F2.3.m1.1.1.1.1.2.1.cmml" xref="S3.F2.3.m1.1.1.1.1.2.1">^</ci><ci id="S3.F2.3.m1.1.1.1.1.2.2.cmml" xref="S3.F2.3.m1.1.1.1.1.2.2">𝑇</ci></apply><ci id="S3.F2.3.m1.1.1.1.1.3.cmml" xref="S3.F2.3.m1.1.1.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.m1.1d">\{\hat{T}_{s}\}</annotation></semantics></math>. The alternative tokens are denoted as <math id="S3.F2.4.m2.1" class="ltx_Math" alttext="T^{\prime}_{i}" display="inline"><semantics id="S3.F2.4.m2.1b"><msubsup id="S3.F2.4.m2.1.1" xref="S3.F2.4.m2.1.1.cmml"><mi id="S3.F2.4.m2.1.1.2.2" xref="S3.F2.4.m2.1.1.2.2.cmml">T</mi><mi id="S3.F2.4.m2.1.1.3" xref="S3.F2.4.m2.1.1.3.cmml">i</mi><mo id="S3.F2.4.m2.1.1.2.3" xref="S3.F2.4.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.F2.4.m2.1c"><apply id="S3.F2.4.m2.1.1.cmml" xref="S3.F2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.4.m2.1.1.1.cmml" xref="S3.F2.4.m2.1.1">subscript</csymbol><apply id="S3.F2.4.m2.1.1.2.cmml" xref="S3.F2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.4.m2.1.1.2.1.cmml" xref="S3.F2.4.m2.1.1">superscript</csymbol><ci id="S3.F2.4.m2.1.1.2.2.cmml" xref="S3.F2.4.m2.1.1.2.2">𝑇</ci><ci id="S3.F2.4.m2.1.1.2.3.cmml" xref="S3.F2.4.m2.1.1.2.3">′</ci></apply><ci id="S3.F2.4.m2.1.1.3.cmml" xref="S3.F2.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m2.1d">T^{\prime}_{i}</annotation></semantics></math>.</figcaption>
</figure>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.5" class="ltx_p">To reduce complexity, we posit that the main token sequence and its branching alternatives, as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, dominate the probability contribution, where the main token sequence is produced by applying model tokenization on the byte string and the alternative tokens are essentially look-aheads for potential main tokens that may emerge as the decoding progresses. The significance of the main token sequence is justified by its alignment with the model’s inputs during the original pretraining phase; any other slicing method is penalized in terms of probability due to its lack of representation in the training data. Based on this assumption, we can narrow down the search for token sequences that meet the criteria of <math id="S3.SS1.p6.1.m1.2" class="ltx_Math" alttext="\{T_{s}\}\texttt{.prefix}=\{B_{l}\}" display="inline"><semantics id="S3.SS1.p6.1.m1.2a"><mrow id="S3.SS1.p6.1.m1.2.2" xref="S3.SS1.p6.1.m1.2.2.cmml"><mrow id="S3.SS1.p6.1.m1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p6.1.m1.1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.1.m1.1.1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p6.1.m1.1.1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.SS1.p6.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p6.1.m1.1.1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p6.1.m1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.2.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p6.1.m1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.1.3a.cmml">.prefix</mtext></mrow><mo id="S3.SS1.p6.1.m1.2.2.3" xref="S3.SS1.p6.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p6.1.m1.2.2.2.1" xref="S3.SS1.p6.1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p6.1.m1.2.2.2.1.2" xref="S3.SS1.p6.1.m1.2.2.2.2.cmml">{</mo><msub id="S3.SS1.p6.1.m1.2.2.2.1.1" xref="S3.SS1.p6.1.m1.2.2.2.1.1.cmml"><mi id="S3.SS1.p6.1.m1.2.2.2.1.1.2" xref="S3.SS1.p6.1.m1.2.2.2.1.1.2.cmml">B</mi><mi id="S3.SS1.p6.1.m1.2.2.2.1.1.3" xref="S3.SS1.p6.1.m1.2.2.2.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p6.1.m1.2.2.2.1.3" xref="S3.SS1.p6.1.m1.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.2b"><apply id="S3.SS1.p6.1.m1.2.2.cmml" xref="S3.SS1.p6.1.m1.2.2"><eq id="S3.SS1.p6.1.m1.2.2.3.cmml" xref="S3.SS1.p6.1.m1.2.2.3"></eq><apply id="S3.SS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1"><times id="S3.SS1.p6.1.m1.1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.2"></times><set id="S3.SS1.p6.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1"><apply id="S3.SS1.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="S3.SS1.p6.1.m1.1.1.1.3a.cmml" xref="S3.SS1.p6.1.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p6.1.m1.1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.3">.prefix</mtext></ci></apply><set id="S3.SS1.p6.1.m1.2.2.2.2.cmml" xref="S3.SS1.p6.1.m1.2.2.2.1"><apply id="S3.SS1.p6.1.m1.2.2.2.1.1.cmml" xref="S3.SS1.p6.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS1.p6.1.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p6.1.m1.2.2.2.1.1.2.cmml" xref="S3.SS1.p6.1.m1.2.2.2.1.1.2">𝐵</ci><ci id="S3.SS1.p6.1.m1.2.2.2.1.1.3.cmml" xref="S3.SS1.p6.1.m1.2.2.2.1.1.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.2c">\{T_{s}\}\texttt{.prefix}=\{B_{l}\}</annotation></semantics></math> to only the main token sequence and its branching alternative tokens. We define the main token sequence as <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="\{\hat{T}_{s}\}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><mrow id="S3.SS1.p6.2.m2.1.1.1" xref="S3.SS1.p6.2.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.2.m2.1.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">{</mo><msub id="S3.SS1.p6.2.m2.1.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p6.2.m2.1.1.1.1.2" xref="S3.SS1.p6.2.m2.1.1.1.1.2.cmml"><mi id="S3.SS1.p6.2.m2.1.1.1.1.2.2" xref="S3.SS1.p6.2.m2.1.1.1.1.2.2.cmml">T</mi><mo id="S3.SS1.p6.2.m2.1.1.1.1.2.1" xref="S3.SS1.p6.2.m2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p6.2.m2.1.1.1.1.3" xref="S3.SS1.p6.2.m2.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p6.2.m2.1.1.1.3" xref="S3.SS1.p6.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><set id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1"><apply id="S3.SS1.p6.2.m2.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p6.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.2"><ci id="S3.SS1.p6.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.2.1">^</ci><ci id="S3.SS1.p6.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.2.2">𝑇</ci></apply><ci id="S3.SS1.p6.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\{\hat{T}_{s}\}</annotation></semantics></math>. Given this simplification, we can approximate the byte-level probability <math id="S3.SS1.p6.3.m3.3" class="ltx_Math" alttext="\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})" display="inline"><semantics id="S3.SS1.p6.3.m3.3a"><mrow id="S3.SS1.p6.3.m3.3.3" xref="S3.SS1.p6.3.m3.3.3.cmml"><msub id="S3.SS1.p6.3.m3.3.3.4" xref="S3.SS1.p6.3.m3.3.3.4.cmml"><mi id="S3.SS1.p6.3.m3.3.3.4.2" xref="S3.SS1.p6.3.m3.3.3.4.2.cmml">ℙ</mi><mi id="S3.SS1.p6.3.m3.3.3.4.3" xref="S3.SS1.p6.3.m3.3.3.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p6.3.m3.3.3.3" xref="S3.SS1.p6.3.m3.3.3.3.cmml">​</mo><mrow id="S3.SS1.p6.3.m3.3.3.2.2" xref="S3.SS1.p6.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p6.3.m3.3.3.2.2.3" xref="S3.SS1.p6.3.m3.3.3.2.3.cmml">(</mo><mrow id="S3.SS1.p6.3.m3.2.2.1.1.1.1" xref="S3.SS1.p6.3.m3.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.p6.3.m3.2.2.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.2.cmml">B</mi><mi id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p6.3.m3.2.2.1.1.1.1.3" xref="S3.SS1.p6.3.m3.2.2.1.1.1.2.cmml">}</mo></mrow><mo id="S3.SS1.p6.3.m3.3.3.2.2.4" xref="S3.SS1.p6.3.m3.3.3.2.3.cmml">,</mo><msup id="S3.SS1.p6.3.m3.3.3.2.2.2" xref="S3.SS1.p6.3.m3.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.3.m3.3.3.2.2.2.2" xref="S3.SS1.p6.3.m3.3.3.2.2.2.2.cmml">𝒵</mi><mrow id="S3.SS1.p6.3.m3.1.1.1.3" xref="S3.SS1.p6.3.m3.3.3.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p6.3.m3.1.1.1.3.1" xref="S3.SS1.p6.3.m3.3.3.2.2.2.cmml">(</mo><mi id="S3.SS1.p6.3.m3.1.1.1.1" xref="S3.SS1.p6.3.m3.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p6.3.m3.1.1.1.3.2" xref="S3.SS1.p6.3.m3.3.3.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS1.p6.3.m3.3.3.2.2.5" xref="S3.SS1.p6.3.m3.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.3b"><apply id="S3.SS1.p6.3.m3.3.3.cmml" xref="S3.SS1.p6.3.m3.3.3"><times id="S3.SS1.p6.3.m3.3.3.3.cmml" xref="S3.SS1.p6.3.m3.3.3.3"></times><apply id="S3.SS1.p6.3.m3.3.3.4.cmml" xref="S3.SS1.p6.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.3.3.4.1.cmml" xref="S3.SS1.p6.3.m3.3.3.4">subscript</csymbol><ci id="S3.SS1.p6.3.m3.3.3.4.2.cmml" xref="S3.SS1.p6.3.m3.3.3.4.2">ℙ</ci><ci id="S3.SS1.p6.3.m3.3.3.4.3.cmml" xref="S3.SS1.p6.3.m3.3.3.4.3">𝑚</ci></apply><interval closure="open" id="S3.SS1.p6.3.m3.3.3.2.3.cmml" xref="S3.SS1.p6.3.m3.3.3.2.2"><set id="S3.SS1.p6.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1"><apply id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.2">𝐵</ci><ci id="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.3.m3.2.2.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.SS1.p6.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p6.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p6.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.p6.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p6.3.m3.3.3.2.2.2.2">𝒵</ci><ci id="S3.SS1.p6.3.m3.1.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1.1.1">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.3c">\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})</annotation></semantics></math> by considering only the main token sequence and its immediate alternatives that share the same prefix with the byte sequence <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="\{B_{l}\}" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><mrow id="S3.SS1.p6.4.m4.1.1.1" xref="S3.SS1.p6.4.m4.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.4.m4.1.1.1.2" xref="S3.SS1.p6.4.m4.1.1.2.cmml">{</mo><msub id="S3.SS1.p6.4.m4.1.1.1.1" xref="S3.SS1.p6.4.m4.1.1.1.1.cmml"><mi id="S3.SS1.p6.4.m4.1.1.1.1.2" xref="S3.SS1.p6.4.m4.1.1.1.1.2.cmml">B</mi><mi id="S3.SS1.p6.4.m4.1.1.1.1.3" xref="S3.SS1.p6.4.m4.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p6.4.m4.1.1.1.3" xref="S3.SS1.p6.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><set id="S3.SS1.p6.4.m4.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.1"><apply id="S3.SS1.p6.4.m4.1.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.1.1.2">𝐵</ci><ci id="S3.SS1.p6.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p6.4.m4.1.1.1.1.3">𝑙</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">\{B_{l}\}</annotation></semantics></math>. This approximation significantly reduces the computational complexity to <math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{O}(V\times S)" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><mrow id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.5.m5.1.1.3" xref="S3.SS1.p6.5.m5.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p6.5.m5.1.1.2" xref="S3.SS1.p6.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS1.p6.5.m5.1.1.1.1" xref="S3.SS1.p6.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p6.5.m5.1.1.1.1.2" xref="S3.SS1.p6.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p6.5.m5.1.1.1.1.1" xref="S3.SS1.p6.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.5.m5.1.1.1.1.1.2" xref="S3.SS1.p6.5.m5.1.1.1.1.1.2.cmml">V</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.5.m5.1.1.1.1.1.1" xref="S3.SS1.p6.5.m5.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS1.p6.5.m5.1.1.1.1.1.3" xref="S3.SS1.p6.5.m5.1.1.1.1.1.3.cmml">S</mi></mrow><mo stretchy="false" id="S3.SS1.p6.5.m5.1.1.1.1.3" xref="S3.SS1.p6.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"><times id="S3.SS1.p6.5.m5.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2"></times><ci id="S3.SS1.p6.5.m5.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3">𝒪</ci><apply id="S3.SS1.p6.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1.1.1"><times id="S3.SS1.p6.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1.1.1.1.1"></times><ci id="S3.SS1.p6.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.1.1.1.2">𝑉</ci><ci id="S3.SS1.p6.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">\mathcal{O}(V\times S)</annotation></semantics></math> and is expressed in the following equation:</p>
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})\approx" display="inline"><semantics id="S3.E7X.2.1.1.m1.3a"><mrow id="S3.E7X.2.1.1.m1.3.3" xref="S3.E7X.2.1.1.m1.3.3.cmml"><mrow id="S3.E7X.2.1.1.m1.3.3.2" xref="S3.E7X.2.1.1.m1.3.3.2.cmml"><msub id="S3.E7X.2.1.1.m1.3.3.2.4" xref="S3.E7X.2.1.1.m1.3.3.2.4.cmml"><mi id="S3.E7X.2.1.1.m1.3.3.2.4.2" xref="S3.E7X.2.1.1.m1.3.3.2.4.2.cmml">ℙ</mi><mi id="S3.E7X.2.1.1.m1.3.3.2.4.3" xref="S3.E7X.2.1.1.m1.3.3.2.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7X.2.1.1.m1.3.3.2.3" xref="S3.E7X.2.1.1.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E7X.2.1.1.m1.3.3.2.2.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.E7X.2.1.1.m1.3.3.2.2.2.3" xref="S3.E7X.2.1.1.m1.3.3.2.2.3.cmml">(</mo><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2.cmml">{</mo><msub id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">B</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E7X.2.1.1.m1.3.3.2.2.2.4" xref="S3.E7X.2.1.1.m1.3.3.2.2.3.cmml">,</mo><msup id="S3.E7X.2.1.1.m1.3.3.2.2.2.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.3.3.2.2.2.2.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.2.cmml">𝒵</mi><mrow id="S3.E7X.2.1.1.m1.1.1.1.3" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.cmml"><mo stretchy="false" id="S3.E7X.2.1.1.m1.1.1.1.3.1" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.cmml">(</mo><mi id="S3.E7X.2.1.1.m1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E7X.2.1.1.m1.1.1.1.3.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E7X.2.1.1.m1.3.3.2.2.2.5" xref="S3.E7X.2.1.1.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7X.2.1.1.m1.3.3.3" xref="S3.E7X.2.1.1.m1.3.3.3.cmml">≈</mo><mi id="S3.E7X.2.1.1.m1.3.3.4" xref="S3.E7X.2.1.1.m1.3.3.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.3b"><apply id="S3.E7X.2.1.1.m1.3.3.cmml" xref="S3.E7X.2.1.1.m1.3.3"><approx id="S3.E7X.2.1.1.m1.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.3"></approx><apply id="S3.E7X.2.1.1.m1.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2"><times id="S3.E7X.2.1.1.m1.3.3.2.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.3"></times><apply id="S3.E7X.2.1.1.m1.3.3.2.4.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.3.3.2.4.1.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.4">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.3.3.2.4.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.4.2">ℙ</ci><ci id="S3.E7X.2.1.1.m1.3.3.2.4.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.4.3">𝑚</ci></apply><interval closure="open" id="S3.E7X.2.1.1.m1.3.3.2.2.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.2"><set id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1"><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝐵</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.E7X.2.1.1.m1.3.3.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.2.2.2">𝒵</ci><ci id="S3.E7X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1">𝑚</ci></apply></interval></apply><csymbol cd="latexml" id="S3.E7X.2.1.1.m1.3.3.4.cmml" xref="S3.E7X.2.1.1.m1.3.3.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.3c">\displaystyle\mathbb{P}_{m}(\{B_{l}\},\mathcal{Z}^{(m)})\approx</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\texttt{~{}}\mathbb{P}_{m}(\hat{T}_{1}\mid\hat{T}_{&lt;1},\mathcal{Z}^{(m)})\times\bigl{[}" display="inline"><semantics id="S3.E7X.3.2.2.m1.1a"><mrow id="S3.E7X.3.2.2.m1.1b"><mtext class="ltx_mathvariant_monospace" id="S3.E7X.3.2.2.m1.1.2"> </mtext><msub id="S3.E7X.3.2.2.m1.1.3"><mi id="S3.E7X.3.2.2.m1.1.3.2">ℙ</mi><mi id="S3.E7X.3.2.2.m1.1.3.3">m</mi></msub><mrow id="S3.E7X.3.2.2.m1.1.4"><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.4.1">(</mo><msub id="S3.E7X.3.2.2.m1.1.4.2"><mover accent="true" id="S3.E7X.3.2.2.m1.1.4.2.2"><mi id="S3.E7X.3.2.2.m1.1.4.2.2.2">T</mi><mo id="S3.E7X.3.2.2.m1.1.4.2.2.1">^</mo></mover><mn id="S3.E7X.3.2.2.m1.1.4.2.3">1</mn></msub><mo lspace="0em" rspace="0.167em" id="S3.E7X.3.2.2.m1.1.4.3">∣</mo><msub id="S3.E7X.3.2.2.m1.1.4.4"><mover accent="true" id="S3.E7X.3.2.2.m1.1.4.4.2"><mi id="S3.E7X.3.2.2.m1.1.4.4.2.2">T</mi><mo id="S3.E7X.3.2.2.m1.1.4.4.2.1">^</mo></mover><mrow id="S3.E7X.3.2.2.m1.1.4.4.3"><mi id="S3.E7X.3.2.2.m1.1.4.4.3.2"></mi><mo id="S3.E7X.3.2.2.m1.1.4.4.3.1">&lt;</mo><mn id="S3.E7X.3.2.2.m1.1.4.4.3.3">1</mn></mrow></msub><mo id="S3.E7X.3.2.2.m1.1.4.5">,</mo><msup id="S3.E7X.3.2.2.m1.1.4.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.1.4.6.2">𝒵</mi><mrow id="S3.E7X.3.2.2.m1.1.1.1.3"><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.1.1.3.1">(</mo><mi id="S3.E7X.3.2.2.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.1.1.3.2">)</mo></mrow></msup><mo rspace="0.055em" stretchy="false" id="S3.E7X.3.2.2.m1.1.4.7">)</mo></mrow><mo rspace="0.222em" id="S3.E7X.3.2.2.m1.1.5">×</mo><mo maxsize="120%" minsize="120%" id="S3.E7X.3.2.2.m1.1.6">[</mo></mrow><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.1c">\displaystyle\texttt{~{}}\mathbb{P}_{m}(\hat{T}_{1}\mid\hat{T}_{&lt;1},\mathcal{Z}^{(m)})\times\bigl{[}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="8" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\texttt{~{}~{}~{}}\mathbb{P}_{m}(\hat{T}_{2}\mid\hat{T}_{&lt;2},\mathcal{Z}^{(m)})\times\bigl{[}" display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><mrow id="S3.E7Xa.2.1.1.m1.1b"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xa.2.1.1.m1.1.2"> </mtext><msub id="S3.E7Xa.2.1.1.m1.1.3"><mi id="S3.E7Xa.2.1.1.m1.1.3.2">ℙ</mi><mi id="S3.E7Xa.2.1.1.m1.1.3.3">m</mi></msub><mrow id="S3.E7Xa.2.1.1.m1.1.4"><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.4.1">(</mo><msub id="S3.E7Xa.2.1.1.m1.1.4.2"><mover accent="true" id="S3.E7Xa.2.1.1.m1.1.4.2.2"><mi id="S3.E7Xa.2.1.1.m1.1.4.2.2.2">T</mi><mo id="S3.E7Xa.2.1.1.m1.1.4.2.2.1">^</mo></mover><mn id="S3.E7Xa.2.1.1.m1.1.4.2.3">2</mn></msub><mo lspace="0em" rspace="0.167em" id="S3.E7Xa.2.1.1.m1.1.4.3">∣</mo><msub id="S3.E7Xa.2.1.1.m1.1.4.4"><mover accent="true" id="S3.E7Xa.2.1.1.m1.1.4.4.2"><mi id="S3.E7Xa.2.1.1.m1.1.4.4.2.2">T</mi><mo id="S3.E7Xa.2.1.1.m1.1.4.4.2.1">^</mo></mover><mrow id="S3.E7Xa.2.1.1.m1.1.4.4.3"><mi id="S3.E7Xa.2.1.1.m1.1.4.4.3.2"></mi><mo id="S3.E7Xa.2.1.1.m1.1.4.4.3.1">&lt;</mo><mn id="S3.E7Xa.2.1.1.m1.1.4.4.3.3">2</mn></mrow></msub><mo id="S3.E7Xa.2.1.1.m1.1.4.5">,</mo><msup id="S3.E7Xa.2.1.1.m1.1.4.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.2.1.1.m1.1.4.6.2">𝒵</mi><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msup><mo rspace="0.055em" stretchy="false" id="S3.E7Xa.2.1.1.m1.1.4.7">)</mo></mrow><mo rspace="0.222em" id="S3.E7Xa.2.1.1.m1.1.5">×</mo><mo maxsize="120%" minsize="120%" id="S3.E7Xa.2.1.1.m1.1.6">[</mo></mrow><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle\texttt{~{}~{}~{}}\mathbb{P}_{m}(\hat{T}_{2}\mid\hat{T}_{&lt;2},\mathcal{Z}^{(m)})\times\bigl{[}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}..." display="inline"><semantics id="S3.E7Xb.2.1.1.m1.1a"><mrow id="S3.E7Xb.2.1.1.m1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xb.2.1.1.m1.1.1.2" xref="S3.E7Xb.2.1.1.m1.1.1.2a.cmml"> </mtext><mo lspace="0em" rspace="0em" id="S3.E7Xb.2.1.1.m1.1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7Xb.2.1.1.m1.1.1.3" xref="S3.E7Xb.2.1.1.m1.1.1.3.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xb.2.1.1.m1.1b"><apply id="S3.E7Xb.2.1.1.m1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1"><times id="S3.E7Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1"></times><ci id="S3.E7Xb.2.1.1.m1.1.1.2a.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.2"> </mtext></ci><ci id="S3.E7Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.3">…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xb.2.1.1.m1.1c">\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}...</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xc.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}\mathbb{P}_{m}(\hat{T}_{S}\mid\hat{T}_{&lt;S},\mathcal{Z}^{(m)})" display="inline"><semantics id="S3.E7Xc.2.1.1.m1.2a"><mrow id="S3.E7Xc.2.1.1.m1.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xc.2.1.1.m1.2.2.3" xref="S3.E7Xc.2.1.1.m1.2.2.3a.cmml"> </mtext><mo lspace="0em" rspace="0em" id="S3.E7Xc.2.1.1.m1.2.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.2.cmml">​</mo><msub id="S3.E7Xc.2.1.1.m1.2.2.4" xref="S3.E7Xc.2.1.1.m1.2.2.4.cmml"><mi id="S3.E7Xc.2.1.1.m1.2.2.4.2" xref="S3.E7Xc.2.1.1.m1.2.2.4.2.cmml">ℙ</mi><mi id="S3.E7Xc.2.1.1.m1.2.2.4.3" xref="S3.E7Xc.2.1.1.m1.2.2.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7Xc.2.1.1.m1.2.2.2a" xref="S3.E7Xc.2.1.1.m1.2.2.2.cmml">​</mo><mrow id="S3.E7Xc.2.1.1.m1.2.2.1.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7Xc.2.1.1.m1.2.2.1.1.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E7Xc.2.1.1.m1.2.2.1.1.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.cmml"><msub id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.cmml"><mover accent="true" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.cmml"><mi id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.2.cmml">T</mi><mo id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.3.cmml">S</mi></msub><mo id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.3.cmml">∣</mo><mrow id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.3.cmml"><msub id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">T</mi><mo id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">S</mi></mrow></msub><mo id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.3.cmml">,</mo><msup id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.2.cmml">𝒵</mi><mrow id="S3.E7Xc.2.1.1.m1.1.1.1.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E7Xc.2.1.1.m1.1.1.1.3.1" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E7Xc.2.1.1.m1.1.1.1.1" xref="S3.E7Xc.2.1.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E7Xc.2.1.1.m1.1.1.1.3.2" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.cmml">)</mo></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.E7Xc.2.1.1.m1.2.2.1.1.3" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xc.2.1.1.m1.2b"><apply id="S3.E7Xc.2.1.1.m1.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2"><times id="S3.E7Xc.2.1.1.m1.2.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.2"></times><ci id="S3.E7Xc.2.1.1.m1.2.2.3a.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xc.2.1.1.m1.2.2.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.3"> </mtext></ci><apply id="S3.E7Xc.2.1.1.m1.2.2.4.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E7Xc.2.1.1.m1.2.2.4.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S3.E7Xc.2.1.1.m1.2.2.4.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.4.2">ℙ</ci><ci id="S3.E7Xc.2.1.1.m1.2.2.4.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.4.3">𝑚</ci></apply><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.3">conditional</csymbol><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4">subscript</csymbol><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2"><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.1">^</ci><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.2.2">𝑇</ci></apply><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.4.3">𝑆</ci></apply><list id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2"><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2"><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.2">𝑇</ci></apply><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3"><lt id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑆</ci></apply></apply><apply id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.1.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.2.cmml" xref="S3.E7Xc.2.1.1.m1.2.2.1.1.1.2.2.2.2">𝒵</ci><ci id="S3.E7Xc.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7Xc.2.1.1.m1.1.1.1.1">𝑚</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xc.2.1.1.m1.2c">\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}\mathbb{P}_{m}(\hat{T}_{S}\mid\hat{T}_{&lt;S},\mathcal{Z}^{(m)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xd.2.1.1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;S},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;S},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)}" display="inline"><semantics id="S3.E7Xd.2.1.1.m1.2a"><mrow id="S3.E7Xd.2.1.1.m1.2b"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xd.2.1.1.m1.2.3"> </mtext><mo id="S3.E7Xd.2.1.1.m1.2.4">+</mo><mstyle displaystyle="true" id="S3.E7Xd.2.1.1.m1.2.5"><munder id="S3.E7Xd.2.1.1.m1.2.5a"><mo movablelimits="false" id="S3.E7Xd.2.1.1.m1.2.5.2">∑</mo><mi id="S3.E7Xd.2.1.1.m1.2.5.3">t</mi></munder></mstyle><msub id="S3.E7Xd.2.1.1.m1.2.6"><mi id="S3.E7Xd.2.1.1.m1.2.6.2">ℙ</mi><mi id="S3.E7Xd.2.1.1.m1.2.6.3">m</mi></msub><mrow id="S3.E7Xd.2.1.1.m1.2.7"><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.2.7.1">(</mo><mi id="S3.E7Xd.2.1.1.m1.2.7.2">t</mi><mo lspace="0em" rspace="0.167em" id="S3.E7Xd.2.1.1.m1.2.7.3">∣</mo><msub id="S3.E7Xd.2.1.1.m1.2.7.4"><mover accent="true" id="S3.E7Xd.2.1.1.m1.2.7.4.2"><mi id="S3.E7Xd.2.1.1.m1.2.7.4.2.2">T</mi><mo id="S3.E7Xd.2.1.1.m1.2.7.4.2.1">^</mo></mover><mrow id="S3.E7Xd.2.1.1.m1.2.7.4.3"><mi id="S3.E7Xd.2.1.1.m1.2.7.4.3.2"></mi><mo id="S3.E7Xd.2.1.1.m1.2.7.4.3.1">&lt;</mo><mi id="S3.E7Xd.2.1.1.m1.2.7.4.3.3">S</mi></mrow></msub><mo id="S3.E7Xd.2.1.1.m1.2.7.5">,</mo><msup id="S3.E7Xd.2.1.1.m1.2.7.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xd.2.1.1.m1.2.7.6.2">𝒵</mi><mrow id="S3.E7Xd.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E7Xd.2.1.1.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msup><mo rspace="0.055em" stretchy="false" id="S3.E7Xd.2.1.1.m1.2.7.7">)</mo></mrow><mo rspace="0.222em" id="S3.E7Xd.2.1.1.m1.2.8">⋅</mo><mn id="S3.E7Xd.2.1.1.m1.2.9">𝟙</mn><mrow id="S3.E7Xd.2.1.1.m1.2.10"><mo maxsize="120%" minsize="120%" id="S3.E7Xd.2.1.1.m1.2.10.1">(</mo><mrow id="S3.E7Xd.2.1.1.m1.2.10.2"><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.2.10.2.1">{</mo><msub id="S3.E7Xd.2.1.1.m1.2.10.2.2"><mover accent="true" id="S3.E7Xd.2.1.1.m1.2.10.2.2.2"><mi id="S3.E7Xd.2.1.1.m1.2.10.2.2.2.2">T</mi><mo id="S3.E7Xd.2.1.1.m1.2.10.2.2.2.1">^</mo></mover><mrow id="S3.E7Xd.2.1.1.m1.2.10.2.2.3"><mi id="S3.E7Xd.2.1.1.m1.2.10.2.2.3.2"></mi><mo id="S3.E7Xd.2.1.1.m1.2.10.2.2.3.1">&lt;</mo><mi id="S3.E7Xd.2.1.1.m1.2.10.2.2.3.3">S</mi></mrow></msub><mo id="S3.E7Xd.2.1.1.m1.2.10.2.3">,</mo><mi id="S3.E7Xd.2.1.1.m1.2.2">t</mi><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.2.10.2.4">}</mo></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E7Xd.2.1.1.m1.2.10.3">.prefix</mtext><mo id="S3.E7Xd.2.1.1.m1.2.10.4">=</mo><mrow id="S3.E7Xd.2.1.1.m1.2.10.5"><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.2.10.5.1">{</mo><msub id="S3.E7Xd.2.1.1.m1.2.10.5.2"><mi id="S3.E7Xd.2.1.1.m1.2.10.5.2.2">B</mi><mi id="S3.E7Xd.2.1.1.m1.2.10.5.2.3">l</mi></msub><mo stretchy="false" id="S3.E7Xd.2.1.1.m1.2.10.5.3">}</mo></mrow><mo lspace="0em" mathsize="120%" id="S3.E7Xd.2.1.1.m1.2.10.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7Xd.2.1.1.m1.2c">\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;S},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;S},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xe" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xe.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}..." display="inline"><semantics id="S3.E7Xe.2.1.1.m1.1a"><mrow id="S3.E7Xe.2.1.1.m1.1.1" xref="S3.E7Xe.2.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xe.2.1.1.m1.1.1.2" xref="S3.E7Xe.2.1.1.m1.1.1.2a.cmml"> </mtext><mo lspace="0em" rspace="0em" id="S3.E7Xe.2.1.1.m1.1.1.1" xref="S3.E7Xe.2.1.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7Xe.2.1.1.m1.1.1.3" xref="S3.E7Xe.2.1.1.m1.1.1.3.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xe.2.1.1.m1.1b"><apply id="S3.E7Xe.2.1.1.m1.1.1.cmml" xref="S3.E7Xe.2.1.1.m1.1.1"><times id="S3.E7Xe.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xe.2.1.1.m1.1.1.1"></times><ci id="S3.E7Xe.2.1.1.m1.1.1.2a.cmml" xref="S3.E7Xe.2.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xe.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xe.2.1.1.m1.1.1.2"> </mtext></ci><ci id="S3.E7Xe.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xe.2.1.1.m1.1.1.3">…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xe.2.1.1.m1.1c">\displaystyle\texttt{~{}~{}~{}~{}~{}~{}~{}}...</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xf" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xf.2.1.1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\texttt{~{}~{}~{}}\bigl{]}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;2},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;2},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)}" display="inline"><semantics id="S3.E7Xf.2.1.1.m1.2a"><mrow id="S3.E7Xf.2.1.1.m1.2b"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xf.2.1.1.m1.2.3"> </mtext><mrow id="S3.E7Xf.2.1.1.m1.2.4"><mo lspace="0em" mathsize="120%" rspace="0em" id="S3.E7Xf.2.1.1.m1.2.4.1">]</mo><mo lspace="0em" id="S3.E7Xf.2.1.1.m1.2.4.2">+</mo><mstyle displaystyle="true" id="S3.E7Xf.2.1.1.m1.2.4.3"><munder id="S3.E7Xf.2.1.1.m1.2.4.3a"><mo movablelimits="false" id="S3.E7Xf.2.1.1.m1.2.4.3.2">∑</mo><mi id="S3.E7Xf.2.1.1.m1.2.4.3.3">t</mi></munder></mstyle><msub id="S3.E7Xf.2.1.1.m1.2.4.4"><mi id="S3.E7Xf.2.1.1.m1.2.4.4.2">ℙ</mi><mi id="S3.E7Xf.2.1.1.m1.2.4.4.3">m</mi></msub><mrow id="S3.E7Xf.2.1.1.m1.2.4.5"><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.5.1">(</mo><mi id="S3.E7Xf.2.1.1.m1.2.4.5.2">t</mi><mo lspace="0em" rspace="0.167em" id="S3.E7Xf.2.1.1.m1.2.4.5.3">∣</mo><msub id="S3.E7Xf.2.1.1.m1.2.4.5.4"><mover accent="true" id="S3.E7Xf.2.1.1.m1.2.4.5.4.2"><mi id="S3.E7Xf.2.1.1.m1.2.4.5.4.2.2">T</mi><mo id="S3.E7Xf.2.1.1.m1.2.4.5.4.2.1">^</mo></mover><mrow id="S3.E7Xf.2.1.1.m1.2.4.5.4.3"><mi id="S3.E7Xf.2.1.1.m1.2.4.5.4.3.2"></mi><mo id="S3.E7Xf.2.1.1.m1.2.4.5.4.3.1">&lt;</mo><mn id="S3.E7Xf.2.1.1.m1.2.4.5.4.3.3">2</mn></mrow></msub><mo id="S3.E7Xf.2.1.1.m1.2.4.5.5">,</mo><msup id="S3.E7Xf.2.1.1.m1.2.4.5.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xf.2.1.1.m1.2.4.5.6.2">𝒵</mi><mrow id="S3.E7Xf.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E7Xf.2.1.1.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msup><mo rspace="0.055em" stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.5.7">)</mo></mrow><mo rspace="0.222em" id="S3.E7Xf.2.1.1.m1.2.4.6">⋅</mo><mn id="S3.E7Xf.2.1.1.m1.2.4.7">𝟙</mn><mrow id="S3.E7Xf.2.1.1.m1.2.4.8"><mo maxsize="120%" minsize="120%" id="S3.E7Xf.2.1.1.m1.2.4.8.1">(</mo><mrow id="S3.E7Xf.2.1.1.m1.2.4.8.2"><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.8.2.1">{</mo><msub id="S3.E7Xf.2.1.1.m1.2.4.8.2.2"><mover accent="true" id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.2"><mi id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.2.2">T</mi><mo id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.2.1">^</mo></mover><mrow id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.3"><mi id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.3.2"></mi><mo id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.3.1">&lt;</mo><mn id="S3.E7Xf.2.1.1.m1.2.4.8.2.2.3.3">2</mn></mrow></msub><mo id="S3.E7Xf.2.1.1.m1.2.4.8.2.3">,</mo><mi id="S3.E7Xf.2.1.1.m1.2.2">t</mi><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.8.2.4">}</mo></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E7Xf.2.1.1.m1.2.4.8.3">.prefix</mtext><mo id="S3.E7Xf.2.1.1.m1.2.4.8.4">=</mo><mrow id="S3.E7Xf.2.1.1.m1.2.4.8.5"><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.8.5.1">{</mo><msub id="S3.E7Xf.2.1.1.m1.2.4.8.5.2"><mi id="S3.E7Xf.2.1.1.m1.2.4.8.5.2.2">B</mi><mi id="S3.E7Xf.2.1.1.m1.2.4.8.5.2.3">l</mi></msub><mo stretchy="false" id="S3.E7Xf.2.1.1.m1.2.4.8.5.3">}</mo></mrow><mo lspace="0em" mathsize="120%" id="S3.E7Xf.2.1.1.m1.2.4.8.6">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7Xf.2.1.1.m1.2c">\displaystyle\texttt{~{}~{}~{}}\bigl{]}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;2},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;2},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xg" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xg.2.1.1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\texttt{~{}}\bigl{]}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;1},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;1},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)}," display="inline"><semantics id="S3.E7Xg.2.1.1.m1.2a"><mrow id="S3.E7Xg.2.1.1.m1.2b"><mtext class="ltx_mathvariant_monospace" id="S3.E7Xg.2.1.1.m1.2.3"> </mtext><mrow id="S3.E7Xg.2.1.1.m1.2.4"><mo lspace="0em" mathsize="120%" rspace="0em" id="S3.E7Xg.2.1.1.m1.2.4.1">]</mo><mo lspace="0em" id="S3.E7Xg.2.1.1.m1.2.4.2">+</mo><mstyle displaystyle="true" id="S3.E7Xg.2.1.1.m1.2.4.3"><munder id="S3.E7Xg.2.1.1.m1.2.4.3a"><mo movablelimits="false" id="S3.E7Xg.2.1.1.m1.2.4.3.2">∑</mo><mi id="S3.E7Xg.2.1.1.m1.2.4.3.3">t</mi></munder></mstyle><msub id="S3.E7Xg.2.1.1.m1.2.4.4"><mi id="S3.E7Xg.2.1.1.m1.2.4.4.2">ℙ</mi><mi id="S3.E7Xg.2.1.1.m1.2.4.4.3">m</mi></msub><mrow id="S3.E7Xg.2.1.1.m1.2.4.5"><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.5.1">(</mo><mi id="S3.E7Xg.2.1.1.m1.2.4.5.2">t</mi><mo lspace="0em" rspace="0.167em" id="S3.E7Xg.2.1.1.m1.2.4.5.3">∣</mo><msub id="S3.E7Xg.2.1.1.m1.2.4.5.4"><mover accent="true" id="S3.E7Xg.2.1.1.m1.2.4.5.4.2"><mi id="S3.E7Xg.2.1.1.m1.2.4.5.4.2.2">T</mi><mo id="S3.E7Xg.2.1.1.m1.2.4.5.4.2.1">^</mo></mover><mrow id="S3.E7Xg.2.1.1.m1.2.4.5.4.3"><mi id="S3.E7Xg.2.1.1.m1.2.4.5.4.3.2"></mi><mo id="S3.E7Xg.2.1.1.m1.2.4.5.4.3.1">&lt;</mo><mn id="S3.E7Xg.2.1.1.m1.2.4.5.4.3.3">1</mn></mrow></msub><mo id="S3.E7Xg.2.1.1.m1.2.4.5.5">,</mo><msup id="S3.E7Xg.2.1.1.m1.2.4.5.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xg.2.1.1.m1.2.4.5.6.2">𝒵</mi><mrow id="S3.E7Xg.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E7Xg.2.1.1.m1.1.1.1.1">m</mi><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msup><mo rspace="0.055em" stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.5.7">)</mo></mrow><mo rspace="0.222em" id="S3.E7Xg.2.1.1.m1.2.4.6">⋅</mo><mn id="S3.E7Xg.2.1.1.m1.2.4.7">𝟙</mn><mrow id="S3.E7Xg.2.1.1.m1.2.4.8"><mo maxsize="120%" minsize="120%" id="S3.E7Xg.2.1.1.m1.2.4.8.1">(</mo><mrow id="S3.E7Xg.2.1.1.m1.2.4.8.2"><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.8.2.1">{</mo><msub id="S3.E7Xg.2.1.1.m1.2.4.8.2.2"><mover accent="true" id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.2"><mi id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.2.2">T</mi><mo id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.2.1">^</mo></mover><mrow id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.3"><mi id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.3.2"></mi><mo id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.3.1">&lt;</mo><mn id="S3.E7Xg.2.1.1.m1.2.4.8.2.2.3.3">1</mn></mrow></msub><mo id="S3.E7Xg.2.1.1.m1.2.4.8.2.3">,</mo><mi id="S3.E7Xg.2.1.1.m1.2.2">t</mi><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.8.2.4">}</mo></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E7Xg.2.1.1.m1.2.4.8.3">.prefix</mtext><mo id="S3.E7Xg.2.1.1.m1.2.4.8.4">=</mo><mrow id="S3.E7Xg.2.1.1.m1.2.4.8.5"><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.8.5.1">{</mo><msub id="S3.E7Xg.2.1.1.m1.2.4.8.5.2"><mi id="S3.E7Xg.2.1.1.m1.2.4.8.5.2.2">B</mi><mi id="S3.E7Xg.2.1.1.m1.2.4.8.5.2.3">l</mi></msub><mo stretchy="false" id="S3.E7Xg.2.1.1.m1.2.4.8.5.3">}</mo></mrow><mrow id="S3.E7Xg.2.1.1.m1.2.4.8.6"><mo lspace="0em" mathsize="120%" rspace="0em" id="S3.E7Xg.2.1.1.m1.2.4.8.6.1">)</mo><mo id="S3.E7Xg.2.1.1.m1.2.4.8.6.2">,</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7Xg.2.1.1.m1.2c">\displaystyle\texttt{~{}}\bigl{]}+\sum_{t}\mathbb{P}_{m}(t\mid\hat{T}_{&lt;1},\mathcal{Z}^{(m)})\cdot\mathbb{1}\bigl{(}\{\hat{T}_{&lt;1},t\}\texttt{.prefix}=\{B_{l}\}\bigl{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p6.8" class="ltx_p">where <math id="S3.SS1.p6.6.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p6.6.m1.1a"><mi id="S3.SS1.p6.6.m1.1.1" xref="S3.SS1.p6.6.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m1.1b"><ci id="S3.SS1.p6.6.m1.1.1.cmml" xref="S3.SS1.p6.6.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m1.1c">t</annotation></semantics></math> represents an alternative token that could follow the sequence <math id="S3.SS1.p6.7.m2.1" class="ltx_Math" alttext="\hat{T}_{&lt;s}" display="inline"><semantics id="S3.SS1.p6.7.m2.1a"><msub id="S3.SS1.p6.7.m2.1.1" xref="S3.SS1.p6.7.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p6.7.m2.1.1.2" xref="S3.SS1.p6.7.m2.1.1.2.cmml"><mi id="S3.SS1.p6.7.m2.1.1.2.2" xref="S3.SS1.p6.7.m2.1.1.2.2.cmml">T</mi><mo id="S3.SS1.p6.7.m2.1.1.2.1" xref="S3.SS1.p6.7.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p6.7.m2.1.1.3" xref="S3.SS1.p6.7.m2.1.1.3.cmml"><mi id="S3.SS1.p6.7.m2.1.1.3.2" xref="S3.SS1.p6.7.m2.1.1.3.2.cmml"></mi><mo id="S3.SS1.p6.7.m2.1.1.3.1" xref="S3.SS1.p6.7.m2.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p6.7.m2.1.1.3.3" xref="S3.SS1.p6.7.m2.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m2.1b"><apply id="S3.SS1.p6.7.m2.1.1.cmml" xref="S3.SS1.p6.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.7.m2.1.1.1.cmml" xref="S3.SS1.p6.7.m2.1.1">subscript</csymbol><apply id="S3.SS1.p6.7.m2.1.1.2.cmml" xref="S3.SS1.p6.7.m2.1.1.2"><ci id="S3.SS1.p6.7.m2.1.1.2.1.cmml" xref="S3.SS1.p6.7.m2.1.1.2.1">^</ci><ci id="S3.SS1.p6.7.m2.1.1.2.2.cmml" xref="S3.SS1.p6.7.m2.1.1.2.2">𝑇</ci></apply><apply id="S3.SS1.p6.7.m2.1.1.3.cmml" xref="S3.SS1.p6.7.m2.1.1.3"><lt id="S3.SS1.p6.7.m2.1.1.3.1.cmml" xref="S3.SS1.p6.7.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p6.7.m2.1.1.3.2.cmml" xref="S3.SS1.p6.7.m2.1.1.3.2">absent</csymbol><ci id="S3.SS1.p6.7.m2.1.1.3.3.cmml" xref="S3.SS1.p6.7.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m2.1c">\hat{T}_{&lt;s}</annotation></semantics></math> and meet the criteria of <math id="S3.SS1.p6.8.m3.2" class="ltx_Math" alttext="\{T_{s}\}\texttt{.prefix}=\{B_{l}\}" display="inline"><semantics id="S3.SS1.p6.8.m3.2a"><mrow id="S3.SS1.p6.8.m3.2.2" xref="S3.SS1.p6.8.m3.2.2.cmml"><mrow id="S3.SS1.p6.8.m3.1.1.1" xref="S3.SS1.p6.8.m3.1.1.1.cmml"><mrow id="S3.SS1.p6.8.m3.1.1.1.1.1" xref="S3.SS1.p6.8.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.8.m3.1.1.1.1.1.2" xref="S3.SS1.p6.8.m3.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p6.8.m3.1.1.1.1.1.1" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.8.m3.1.1.1.1.1.1.2" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1.2.cmml">T</mi><mi id="S3.SS1.p6.8.m3.1.1.1.1.1.1.3" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p6.8.m3.1.1.1.1.1.3" xref="S3.SS1.p6.8.m3.1.1.1.1.2.cmml">}</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p6.8.m3.1.1.1.2" xref="S3.SS1.p6.8.m3.1.1.1.2.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p6.8.m3.1.1.1.3" xref="S3.SS1.p6.8.m3.1.1.1.3a.cmml">.prefix</mtext></mrow><mo id="S3.SS1.p6.8.m3.2.2.3" xref="S3.SS1.p6.8.m3.2.2.3.cmml">=</mo><mrow id="S3.SS1.p6.8.m3.2.2.2.1" xref="S3.SS1.p6.8.m3.2.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p6.8.m3.2.2.2.1.2" xref="S3.SS1.p6.8.m3.2.2.2.2.cmml">{</mo><msub id="S3.SS1.p6.8.m3.2.2.2.1.1" xref="S3.SS1.p6.8.m3.2.2.2.1.1.cmml"><mi id="S3.SS1.p6.8.m3.2.2.2.1.1.2" xref="S3.SS1.p6.8.m3.2.2.2.1.1.2.cmml">B</mi><mi id="S3.SS1.p6.8.m3.2.2.2.1.1.3" xref="S3.SS1.p6.8.m3.2.2.2.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p6.8.m3.2.2.2.1.3" xref="S3.SS1.p6.8.m3.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.8.m3.2b"><apply id="S3.SS1.p6.8.m3.2.2.cmml" xref="S3.SS1.p6.8.m3.2.2"><eq id="S3.SS1.p6.8.m3.2.2.3.cmml" xref="S3.SS1.p6.8.m3.2.2.3"></eq><apply id="S3.SS1.p6.8.m3.1.1.1.cmml" xref="S3.SS1.p6.8.m3.1.1.1"><times id="S3.SS1.p6.8.m3.1.1.1.2.cmml" xref="S3.SS1.p6.8.m3.1.1.1.2"></times><set id="S3.SS1.p6.8.m3.1.1.1.1.2.cmml" xref="S3.SS1.p6.8.m3.1.1.1.1.1"><apply id="S3.SS1.p6.8.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.8.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1.2">𝑇</ci><ci id="S3.SS1.p6.8.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.8.m3.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="S3.SS1.p6.8.m3.1.1.1.3a.cmml" xref="S3.SS1.p6.8.m3.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p6.8.m3.1.1.1.3.cmml" xref="S3.SS1.p6.8.m3.1.1.1.3">.prefix</mtext></ci></apply><set id="S3.SS1.p6.8.m3.2.2.2.2.cmml" xref="S3.SS1.p6.8.m3.2.2.2.1"><apply id="S3.SS1.p6.8.m3.2.2.2.1.1.cmml" xref="S3.SS1.p6.8.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m3.2.2.2.1.1.1.cmml" xref="S3.SS1.p6.8.m3.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p6.8.m3.2.2.2.1.1.2.cmml" xref="S3.SS1.p6.8.m3.2.2.2.1.1.2">𝐵</ci><ci id="S3.SS1.p6.8.m3.2.2.2.1.1.3.cmml" xref="S3.SS1.p6.8.m3.2.2.2.1.1.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.8.m3.2c">\{T_{s}\}\texttt{.prefix}=\{B_{l}\}</annotation></semantics></math>. Eventually, substituting Equation (<a href="#S3.E7" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) into (<a href="#S3.E5" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) can realize generative fusion decoding (GFD).</p>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.1" class="ltx_p">In summary, our proposed method for conditional text generation, GFD, through late fusion and byte-level probability transformation offers a novel way to integrate the outputs of multiple models with different token spaces. By transforming token-level probabilities to byte-level probabilities and focusing on the most probable token sequences, we can efficiently fuse model outputs.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Fusing text-recognition models with LLM</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">To evaluate the efficacy of our algorithm, we implemented GFD for ASR and OCR tasks. This is achieved by fusing pre-trained text-recognition models with LLMs to enhance recognition capability. In such scenarios, the proposed tokens of ASR and OCR model are conditioned on a modal signal <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{TR}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒵</ci><ci id="S3.SS2.p1.1.m1.1.1.3a.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{Z}^{\texttt{TR}}</annotation></semantics></math> while that of the LLM is not. Therefore, the same next-byte probability estimation from the LLM and text recognition model might stem from different token choices. Although the difference would converge eventually as the sequence rolls out, given limited beams in the beam search process, the potential overestimation of implausible words due to scores contributed by LLM spikes the probabilities of common word-leading bytes such as ’t’ and ’r’, and produces locally unstable rankings that may result in false eliminations of correct beams in decoding steps. In response to this challenge, we have adopted text recognition models (ASR and OCR) to propose the next byte/token, while employing LLMs to provide delayed corrective feedback on past tokens. The fusion decoding methodology we have adopted, derived from Equation (<a href="#S3.E5" title="In 3.1 Generative fusion decoding ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), is delineated in the following formula:</p>
<table id="S3.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8X.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\{B_{1},..,B_{t}\}^{*}=\underset{\{B_{1},..,B_{t}\}}{\mathrm{arg\,max}}\bigl{[}(1-r)\cdot\log\mathbb{P}^{\texttt{TR}}(\{B_{1},..,B_{t}\},\mathcal{Z}^{\texttt{TR}})" display="inline"><semantics id="S3.E8X.2.1.1.m1.1a"><mrow id="S3.E8X.2.1.1.m1.1b"><msup id="S3.E8X.2.1.1.m1.1.1"><mrow id="S3.E8X.2.1.1.m1.1.1.2"><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.1.2.1">{</mo><msub id="S3.E8X.2.1.1.m1.1.1.2.2"><mi id="S3.E8X.2.1.1.m1.1.1.2.2.2">B</mi><mn id="S3.E8X.2.1.1.m1.1.1.2.2.3">1</mn></msub><mo id="S3.E8X.2.1.1.m1.1.1.2.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.E8X.2.1.1.m1.1.1.2.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.E8X.2.1.1.m1.1.1.2.5">.</mo><mo id="S3.E8X.2.1.1.m1.1.1.2.6">,</mo><msub id="S3.E8X.2.1.1.m1.1.1.2.7"><mi id="S3.E8X.2.1.1.m1.1.1.2.7.2">B</mi><mi id="S3.E8X.2.1.1.m1.1.1.2.7.3">t</mi></msub><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.1.2.8">}</mo></mrow><mo id="S3.E8X.2.1.1.m1.1.1.3">∗</mo></msup><mo id="S3.E8X.2.1.1.m1.1.2">=</mo><munder accentunder="true" id="S3.E8X.2.1.1.m1.1.3"><mrow id="S3.E8X.2.1.1.m1.1.3.2"><mi id="S3.E8X.2.1.1.m1.1.3.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E8X.2.1.1.m1.1.3.2.1">​</mo><mi id="S3.E8X.2.1.1.m1.1.3.2.3">max</mi></mrow><mrow id="S3.E8X.2.1.1.m1.1.3.1"><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.3.1.1">{</mo><msub id="S3.E8X.2.1.1.m1.1.3.1.2"><mi id="S3.E8X.2.1.1.m1.1.3.1.2.2">B</mi><mn id="S3.E8X.2.1.1.m1.1.3.1.2.3">1</mn></msub><mo id="S3.E8X.2.1.1.m1.1.3.1.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.E8X.2.1.1.m1.1.3.1.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.E8X.2.1.1.m1.1.3.1.5">.</mo><mo id="S3.E8X.2.1.1.m1.1.3.1.6">,</mo><msub id="S3.E8X.2.1.1.m1.1.3.1.7"><mi id="S3.E8X.2.1.1.m1.1.3.1.7.2">B</mi><mi id="S3.E8X.2.1.1.m1.1.3.1.7.3">t</mi></msub><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.3.1.8">}</mo></mrow></munder><mrow id="S3.E8X.2.1.1.m1.1.4"><mo maxsize="120%" minsize="120%" id="S3.E8X.2.1.1.m1.1.4.1">[</mo><mrow id="S3.E8X.2.1.1.m1.1.4.2"><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.4.2.1">(</mo><mn id="S3.E8X.2.1.1.m1.1.4.2.2">1</mn><mo id="S3.E8X.2.1.1.m1.1.4.2.3">−</mo><mi id="S3.E8X.2.1.1.m1.1.4.2.4">r</mi><mo rspace="0.055em" stretchy="false" id="S3.E8X.2.1.1.m1.1.4.2.5">)</mo></mrow><mo rspace="0.222em" id="S3.E8X.2.1.1.m1.1.4.3">⋅</mo><mi id="S3.E8X.2.1.1.m1.1.4.4">log</mi><msup id="S3.E8X.2.1.1.m1.1.4.5"><mi id="S3.E8X.2.1.1.m1.1.4.5.2">ℙ</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8X.2.1.1.m1.1.4.5.3">TR</mtext></msup><mrow id="S3.E8X.2.1.1.m1.1.4.6"><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.4.6.1">(</mo><mrow id="S3.E8X.2.1.1.m1.1.4.6.2"><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.4.6.2.1">{</mo><msub id="S3.E8X.2.1.1.m1.1.4.6.2.2"><mi id="S3.E8X.2.1.1.m1.1.4.6.2.2.2">B</mi><mn id="S3.E8X.2.1.1.m1.1.4.6.2.2.3">1</mn></msub><mo id="S3.E8X.2.1.1.m1.1.4.6.2.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.E8X.2.1.1.m1.1.4.6.2.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.E8X.2.1.1.m1.1.4.6.2.5">.</mo><mo id="S3.E8X.2.1.1.m1.1.4.6.2.6">,</mo><msub id="S3.E8X.2.1.1.m1.1.4.6.2.7"><mi id="S3.E8X.2.1.1.m1.1.4.6.2.7.2">B</mi><mi id="S3.E8X.2.1.1.m1.1.4.6.2.7.3">t</mi></msub><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.4.6.2.8">}</mo></mrow><mo id="S3.E8X.2.1.1.m1.1.4.6.3">,</mo><msup id="S3.E8X.2.1.1.m1.1.4.6.4"><mi class="ltx_font_mathcaligraphic" id="S3.E8X.2.1.1.m1.1.4.6.4.2">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8X.2.1.1.m1.1.4.6.4.3">TR</mtext></msup><mo stretchy="false" id="S3.E8X.2.1.1.m1.1.4.6.5">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.1c">\displaystyle\{B_{1},..,B_{t}\}^{*}=\underset{\{B_{1},..,B_{t}\}}{\mathrm{arg\,max}}\bigl{[}(1-r)\cdot\log\mathbb{P}^{\texttt{TR}}(\{B_{1},..,B_{t}\},\mathcal{Z}^{\texttt{TR}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr id="S3.E8Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8Xa.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle+r\cdot\log\mathbb{P}^{\texttt{LM}}(\{B_{1},..,B_{t-k}\},\mathcal{Z}^{\texttt{LM}})\bigl{]}," display="inline"><semantics id="S3.E8Xa.2.1.1.m1.1a"><mrow id="S3.E8Xa.2.1.1.m1.1b"><mo id="S3.E8Xa.2.1.1.m1.1.1">+</mo><mi id="S3.E8Xa.2.1.1.m1.1.2">r</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E8Xa.2.1.1.m1.1.3">⋅</mo><mi id="S3.E8Xa.2.1.1.m1.1.4">log</mi><msup id="S3.E8Xa.2.1.1.m1.1.5"><mi id="S3.E8Xa.2.1.1.m1.1.5.2">ℙ</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8Xa.2.1.1.m1.1.5.3">LM</mtext></msup><mrow id="S3.E8Xa.2.1.1.m1.1.6"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.6.1">(</mo><mrow id="S3.E8Xa.2.1.1.m1.1.6.2"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.6.2.1">{</mo><msub id="S3.E8Xa.2.1.1.m1.1.6.2.2"><mi id="S3.E8Xa.2.1.1.m1.1.6.2.2.2">B</mi><mn id="S3.E8Xa.2.1.1.m1.1.6.2.2.3">1</mn></msub><mo id="S3.E8Xa.2.1.1.m1.1.6.2.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.E8Xa.2.1.1.m1.1.6.2.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.E8Xa.2.1.1.m1.1.6.2.5">.</mo><mo id="S3.E8Xa.2.1.1.m1.1.6.2.6">,</mo><msub id="S3.E8Xa.2.1.1.m1.1.6.2.7"><mi id="S3.E8Xa.2.1.1.m1.1.6.2.7.2">B</mi><mrow id="S3.E8Xa.2.1.1.m1.1.6.2.7.3"><mi id="S3.E8Xa.2.1.1.m1.1.6.2.7.3.2">t</mi><mo id="S3.E8Xa.2.1.1.m1.1.6.2.7.3.1">−</mo><mi id="S3.E8Xa.2.1.1.m1.1.6.2.7.3.3">k</mi></mrow></msub><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.6.2.8">}</mo></mrow><mo id="S3.E8Xa.2.1.1.m1.1.6.3">,</mo><msup id="S3.E8Xa.2.1.1.m1.1.6.4"><mi class="ltx_font_mathcaligraphic" id="S3.E8Xa.2.1.1.m1.1.6.4.2">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8Xa.2.1.1.m1.1.6.4.3">LM</mtext></msup><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.6.5">)</mo></mrow><mrow id="S3.E8Xa.2.1.1.m1.1.7"><mo lspace="0em" mathsize="120%" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.7.1">]</mo><mo id="S3.E8Xa.2.1.1.m1.1.7.2">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.1c">\displaystyle+r\cdot\log\mathbb{P}^{\texttt{LM}}(\{B_{1},..,B_{t-k}\},\mathcal{Z}^{\texttt{LM}})\bigl{]},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p1.11" class="ltx_p">where <math id="S3.SS2.p1.2.m1.3" class="ltx_Math" alttext="\{B_{1},\ldots,B_{t}\}^{*}" display="inline"><semantics id="S3.SS2.p1.2.m1.3a"><msup id="S3.SS2.p1.2.m1.3.3" xref="S3.SS2.p1.2.m1.3.3.cmml"><mrow id="S3.SS2.p1.2.m1.3.3.2.2" xref="S3.SS2.p1.2.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m1.3.3.2.2.3" xref="S3.SS2.p1.2.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p1.2.m1.2.2.1.1.1" xref="S3.SS2.p1.2.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m1.2.2.1.1.1.2" xref="S3.SS2.p1.2.m1.2.2.1.1.1.2.cmml">B</mi><mn id="S3.SS2.p1.2.m1.2.2.1.1.1.3" xref="S3.SS2.p1.2.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m1.3.3.2.2.4" xref="S3.SS2.p1.2.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m1.3.3.2.2.5" xref="S3.SS2.p1.2.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.2.m1.3.3.2.2.2" xref="S3.SS2.p1.2.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.2.m1.3.3.2.2.2.2" xref="S3.SS2.p1.2.m1.3.3.2.2.2.2.cmml">B</mi><mi id="S3.SS2.p1.2.m1.3.3.2.2.2.3" xref="S3.SS2.p1.2.m1.3.3.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m1.3.3.2.2.6" xref="S3.SS2.p1.2.m1.3.3.2.3.cmml">}</mo></mrow><mo id="S3.SS2.p1.2.m1.3.3.4" xref="S3.SS2.p1.2.m1.3.3.4.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.3b"><apply id="S3.SS2.p1.2.m1.3.3.cmml" xref="S3.SS2.p1.2.m1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.3.3.3.cmml" xref="S3.SS2.p1.2.m1.3.3">superscript</csymbol><set id="S3.SS2.p1.2.m1.3.3.2.3.cmml" xref="S3.SS2.p1.2.m1.3.3.2.2"><apply id="S3.SS2.p1.2.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m1.2.2.1.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.p1.2.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1">…</ci><apply id="S3.SS2.p1.2.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m1.3.3.2.2.2.2">𝐵</ci><ci id="S3.SS2.p1.2.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.2.m1.3.3.2.2.2.3">𝑡</ci></apply></set><times id="S3.SS2.p1.2.m1.3.3.4.cmml" xref="S3.SS2.p1.2.m1.3.3.4"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.3c">\{B_{1},\ldots,B_{t}\}^{*}</annotation></semantics></math> represents the optimal sequence of bytes up to and including position <math id="S3.SS2.p1.3.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.3.m2.1a"><mi id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><ci id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">t</annotation></semantics></math>, <math id="S3.SS2.p1.4.m3.1" class="ltx_Math" alttext="p^{\texttt{TR}}" display="inline"><semantics id="S3.SS2.p1.4.m3.1a"><msup id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml"><mi id="S3.SS2.p1.4.m3.1.1.2" xref="S3.SS2.p1.4.m3.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.4.m3.1.1.3" xref="S3.SS2.p1.4.m3.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><apply id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.1.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m3.1.1.2.cmml" xref="S3.SS2.p1.4.m3.1.1.2">𝑝</ci><ci id="S3.SS2.p1.4.m3.1.1.3a.cmml" xref="S3.SS2.p1.4.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.4.m3.1.1.3.cmml" xref="S3.SS2.p1.4.m3.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">p^{\texttt{TR}}</annotation></semantics></math> and <math id="S3.SS2.p1.5.m4.1" class="ltx_Math" alttext="p^{\texttt{LM}}" display="inline"><semantics id="S3.SS2.p1.5.m4.1a"><msup id="S3.SS2.p1.5.m4.1.1" xref="S3.SS2.p1.5.m4.1.1.cmml"><mi id="S3.SS2.p1.5.m4.1.1.2" xref="S3.SS2.p1.5.m4.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.5.m4.1.1.3" xref="S3.SS2.p1.5.m4.1.1.3a.cmml">LM</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m4.1b"><apply id="S3.SS2.p1.5.m4.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m4.1.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m4.1.1.2.cmml" xref="S3.SS2.p1.5.m4.1.1.2">𝑝</ci><ci id="S3.SS2.p1.5.m4.1.1.3a.cmml" xref="S3.SS2.p1.5.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.5.m4.1.1.3.cmml" xref="S3.SS2.p1.5.m4.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m4.1c">p^{\texttt{LM}}</annotation></semantics></math> are the probability distributions of the text-recognition models and the language models, respectively, <math id="S3.SS2.p1.6.m5.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{TR}}" display="inline"><semantics id="S3.SS2.p1.6.m5.1a"><msup id="S3.SS2.p1.6.m5.1.1" xref="S3.SS2.p1.6.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m5.1.1.2" xref="S3.SS2.p1.6.m5.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.6.m5.1.1.3" xref="S3.SS2.p1.6.m5.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m5.1b"><apply id="S3.SS2.p1.6.m5.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.1.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m5.1.1.2.cmml" xref="S3.SS2.p1.6.m5.1.1.2">𝒵</ci><ci id="S3.SS2.p1.6.m5.1.1.3a.cmml" xref="S3.SS2.p1.6.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.6.m5.1.1.3.cmml" xref="S3.SS2.p1.6.m5.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m5.1c">\mathcal{Z}^{\texttt{TR}}</annotation></semantics></math> and <math id="S3.SS2.p1.7.m6.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{LM}}" display="inline"><semantics id="S3.SS2.p1.7.m6.1a"><msup id="S3.SS2.p1.7.m6.1.1" xref="S3.SS2.p1.7.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m6.1.1.2" xref="S3.SS2.p1.7.m6.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.7.m6.1.1.3" xref="S3.SS2.p1.7.m6.1.1.3a.cmml">LM</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m6.1b"><apply id="S3.SS2.p1.7.m6.1.1.cmml" xref="S3.SS2.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m6.1.1.1.cmml" xref="S3.SS2.p1.7.m6.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m6.1.1.2.cmml" xref="S3.SS2.p1.7.m6.1.1.2">𝒵</ci><ci id="S3.SS2.p1.7.m6.1.1.3a.cmml" xref="S3.SS2.p1.7.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.7.m6.1.1.3.cmml" xref="S3.SS2.p1.7.m6.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m6.1c">\mathcal{Z}^{\texttt{LM}}</annotation></semantics></math> are the contextual information for the text-recognition and language models, respectively, <math id="S3.SS2.p1.8.m7.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.p1.8.m7.1a"><mi id="S3.SS2.p1.8.m7.1.1" xref="S3.SS2.p1.8.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m7.1b"><ci id="S3.SS2.p1.8.m7.1.1.cmml" xref="S3.SS2.p1.8.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m7.1c">r</annotation></semantics></math> is a weighting factor that balances the influence of the text-recognition models and the language models, and <math id="S3.SS2.p1.9.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.9.m8.1a"><mi id="S3.SS2.p1.9.m8.1.1" xref="S3.SS2.p1.9.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m8.1b"><ci id="S3.SS2.p1.9.m8.1.1.cmml" xref="S3.SS2.p1.9.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m8.1c">k</annotation></semantics></math> depends on the length of the byte/token proposal. As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <math id="S3.SS2.p1.10.m9.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{TR}}" display="inline"><semantics id="S3.SS2.p1.10.m9.1a"><msup id="S3.SS2.p1.10.m9.1.1" xref="S3.SS2.p1.10.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m9.1.1.2" xref="S3.SS2.p1.10.m9.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.10.m9.1.1.3" xref="S3.SS2.p1.10.m9.1.1.3a.cmml">TR</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m9.1b"><apply id="S3.SS2.p1.10.m9.1.1.cmml" xref="S3.SS2.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m9.1.1.1.cmml" xref="S3.SS2.p1.10.m9.1.1">superscript</csymbol><ci id="S3.SS2.p1.10.m9.1.1.2.cmml" xref="S3.SS2.p1.10.m9.1.1.2">𝒵</ci><ci id="S3.SS2.p1.10.m9.1.1.3a.cmml" xref="S3.SS2.p1.10.m9.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.10.m9.1.1.3.cmml" xref="S3.SS2.p1.10.m9.1.1.3">TR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m9.1c">\mathcal{Z}^{\texttt{TR}}</annotation></semantics></math> can be either an audio or a text image, and <math id="S3.SS2.p1.11.m10.1" class="ltx_Math" alttext="\mathcal{Z}^{\texttt{LM}}" display="inline"><semantics id="S3.SS2.p1.11.m10.1a"><msup id="S3.SS2.p1.11.m10.1.1" xref="S3.SS2.p1.11.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m10.1.1.2" xref="S3.SS2.p1.11.m10.1.1.2.cmml">𝒵</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.11.m10.1.1.3" xref="S3.SS2.p1.11.m10.1.1.3a.cmml">LM</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m10.1b"><apply id="S3.SS2.p1.11.m10.1.1.cmml" xref="S3.SS2.p1.11.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m10.1.1.1.cmml" xref="S3.SS2.p1.11.m10.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m10.1.1.2.cmml" xref="S3.SS2.p1.11.m10.1.1.2">𝒵</ci><ci id="S3.SS2.p1.11.m10.1.1.3a.cmml" xref="S3.SS2.p1.11.m10.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.11.m10.1.1.3.cmml" xref="S3.SS2.p1.11.m10.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m10.1c">\mathcal{Z}^{\texttt{LM}}</annotation></semantics></math> can be a prompt.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">We evaluate the application of GFD to ASR and OCR tasks. For ASR task, we benchmark datasets in English, Chinese, and Cantonese. The deliberate choice of Chinese and Cantonese is due to that the languages are homophonous and tonal, challenging for ASR systems. This complexity is corroborated by the Fleurs experiment in Whisper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, where the Chinese word error rate is well above the regressed word error rate in comparison to evaluations in other language at the same amount of pre-training data. Of all tested languages in Whisper, it is the only large-scale language (&gt; 10k hours audio) with such a phenomenon. For OCR, we benchmark image dataset containing long sequence of text as we hypothesize that LLM provide semantic information to an OCR model of recognizing long text sequences.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.2" class="ltx_p">In terms of the evaluated models, we choose Whisper-large-v2 as the ASR model for greedy and beam search. For our proposed GFD, we use Mistral <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> for English datasets and Breeze <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> for Chinese and Cantonese datasets. We term the GFD fused model with Whisper and Mistral as GFD-ASR-EN; that with Whisper and Mistral as GFD-ASR-ZH. In addition, we benchmark GER, based on task-activating prompting method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, with Mistral-Instruct and Breeze-Instruct models without finetuning. We include two oracle word error rates following previous work<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, where the N-Best Oracle <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="o_{nb}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">o</mi><mrow id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1.3.1" xref="S4.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑜</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><times id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">𝑛</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">o_{nb}</annotation></semantics></math> denotes the error rate calculated with the best candidate in the N-best list, and the Compositional Oracle <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="o_{cp}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">o</mi><mrow id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.p2.2.m2.1.1.3.2" xref="S4.SS1.p2.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.1.1.3.1" xref="S4.SS1.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.2.m2.1.1.3.3" xref="S4.SS1.p2.2.m2.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑜</ci><apply id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3"><times id="S4.SS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3.1"></times><ci id="S4.SS1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.p2.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">o_{cp}</annotation></semantics></math> is the best achievable word error rate using all tokens N-best the list. As to OCR, we utilize TrOCR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, a pre-trained OCR model, and denote the fused model GFD-OCR.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p">We benchmark models on various datasets, including Librispeech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, Medical <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, ATCO2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, Fleurs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, NTUML2021<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, and FormosaSpeech <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://huggingface.co/datasets/MediaTek-Research/formosaspeech" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://huggingface.co/datasets/MediaTek-Research/formosaspeech</a></span></span></span> for ASR; NAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> for OCR. <span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Librispeech</span> is a collection of corpus from audiobooks with subsets Clean and Other. The Librispeech-Noise is its noised variant, featuring various signal-to-noise ratios, ideally for testing ASR system’s robustness to noise. <span id="S4.SS1.p3.1.2" class="ltx_text ltx_font_bold">Medical</span> dataset contains 8.5 hours of medical conversations with associated symptom tags to each audio-text pairs. <span id="S4.SS1.p3.1.3" class="ltx_text ltx_font_bold">ATCO2</span> contains audios of air traffic control communication and accompanied meta-information of airports. <span id="S4.SS1.p3.1.4" class="ltx_text ltx_font_bold">Fleurs</span> is a multilingual speech corpus. We deliberately choose Cantonese subset for evaluation as the language is homophonous and tonal. <span id="S4.SS1.p3.1.5" class="ltx_text ltx_font_bold">NTUML2021</span> corpus consists of lecture recordings from the “Machine Learning” course at National Taiwan University in 2021, with corresponding transcriptions and English translations labeled by over 20 bilingual native Chinese speakers. <span id="S4.SS1.p3.1.6" class="ltx_text ltx_font_bold">FormosaSpeech</span> corpus includes Chinese recordings of Taiwanese accents amassing up to 6.4 hours of audio-text pairs. <span id="S4.SS1.p3.1.7" class="ltx_text ltx_font_bold">NAF</span> consists of images from U.S national archives with labelled bounding boxes and annotations, ideal for evaluating OCR performance.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p">For all ASR experiments, we report word error rate (WER) for evaluations on English datasets, and mix error rate (MER) for that on Chinese datasets. For OCR experiments, we report character error rate (CER) and exact match (EM). For exact match, we require that the recognized texts fully matches the ground truth. All GFD fused models can be run on a single A6000 GPU. We fix <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="r=0.2" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">r</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝑟</ci><cn type="float" id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">r=0.2</annotation></semantics></math> in Equation <a href="#S3.E8" title="In 3.2 Fusing text-recognition models with LLM ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> for all our experiments; number of beams equaling 5 and 10 for ASR and OCR experiments, respectively.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Conventional speech recognition</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">We first verify the efficacy of GFD in conventional speech recognition setting and report results in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Conventional speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We notice that beam search improves consistently upon greedy search, and use beam search as the baseline. We found that GFD moderately improves on the Medical and Fleurs-HK dataset. In the more challenging NTUML2021, we obtained a state-of-the-art 8.83 mixed error rate, surpassing prior work<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> and even the oracle N-Best score. This improvement is mostly preserved even when we narrow the target space to only consider English terms in the dataset (Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Conventional speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), making GFD-ASR an elegant solution for code-switched ASR. Examples in the Appendix show that improvement can be attributed to the LLM correcting grammatical mistakes and domain terminologies. Performance across Librispeech reveals that GFD improves most on moderate noise conditions but diminishes when the noise is too large <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="(S/R=-5)" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml">S</mi><mo id="S4.SS2.p1.1.m1.1.1.1.1.2.1" xref="S4.SS2.p1.1.m1.1.1.1.1.2.1.cmml">/</mo><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml"><mo id="S4.SS2.p1.1.m1.1.1.1.1.3a" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml">−</mo><mn id="S4.SS2.p1.1.m1.1.1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.3.2.cmml">5</mn></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2"><divide id="S4.SS2.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.1"></divide><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2">𝑆</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3">𝑅</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3"><minus id="S4.SS2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3"></minus><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">(S/R=-5)</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p">In addition, we do not find improvements in the GER setting using non-GER-specific instruct models, consistent with previous work<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. As we already patched malformatted outputs with the best beam result, this increase of error rate is mostly attributed to LLM hallucinations, including incorrect deletions. We therefore posit that GFD is more robust for incorporating off-the-shelf LLMs on the ASR task than GER.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results on conventional speech recognition.</figcaption>
<div id="S4.T1.8" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:219.3pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.5pt,7.8pt) scale(0.933260847104961,0.933260847104961) ;">
<table id="S4.T1.8.8" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.8.8.9.1" class="ltx_tr">
<th id="S4.T1.8.8.9.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S4.T1.8.8.9.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T1.8.8.9.1.2.1" class="ltx_text ltx_font_bold">Whisper</span></td>
<td id="S4.T1.8.8.9.1.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt"><span id="S4.T1.8.8.9.1.3.1" class="ltx_text ltx_font_bold">GER</span></td>
<td id="S4.T1.8.8.9.1.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt"><span id="S4.T1.8.8.9.1.4.1" class="ltx_text ltx_font_bold">GFD-ASR-EN</span></td>
<td id="S4.T1.8.8.9.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T1.8.8.9.1.5.1" class="ltx_text ltx_font_bold">Oracle</span></td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.2.2.2.3.1" class="ltx_text ltx_font_bold">EN dataset</span></th>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Greedy</td>
<td id="S4.T1.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5-beams (Baseline)</td>
<td id="S4.T1.2.2.2.6" class="ltx_td ltx_border_r"></td>
<td id="S4.T1.2.2.2.7" class="ltx_td ltx_border_r"></td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\text{O}_{\text{nb}}" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><msub id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mtext id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2a.cmml">O</mtext><mtext id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3a.cmml">nb</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T1.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2"><mtext id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">O</mtext></ci><ci id="S4.T1.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.T1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3">nb</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\text{O}_{\text{nb}}</annotation></semantics></math></td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\text{O}_{\text{cp}}" display="inline"><semantics id="S4.T1.2.2.2.2.m1.1a"><msub id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml"><mtext id="S4.T1.2.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.2.m1.1.1.2a.cmml">O</mtext><mtext id="S4.T1.2.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.2.m1.1.1.3a.cmml">cp</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1">subscript</csymbol><ci id="S4.T1.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2"><mtext id="S4.T1.2.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2">O</mtext></ci><ci id="S4.T1.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T1.2.2.2.2.m1.1.1.3"><mtext mathsize="70%" id="S4.T1.2.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.2.m1.1.1.3">cp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\text{O}_{\text{cp}}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.8.8.10.2" class="ltx_tr">
<th id="S4.T1.8.8.10.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Librispeech-Clean</th>
<td id="S4.T1.8.8.10.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.30</td>
<td id="S4.T1.8.8.10.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.8.8.10.2.3.1" class="ltx_text ltx_font_bold">2.28</span></td>
<td id="S4.T1.8.8.10.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.21</td>
<td id="S4.T1.8.8.10.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.29</td>
<td id="S4.T1.8.8.10.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.91</td>
<td id="S4.T1.8.8.10.2.7" class="ltx_td ltx_align_center ltx_border_t">1.63</td>
</tr>
<tr id="S4.T1.8.8.11.3" class="ltx_tr">
<th id="S4.T1.8.8.11.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Librispeech-Other</th>
<td id="S4.T1.8.8.11.3.2" class="ltx_td ltx_align_center ltx_border_r">5.23</td>
<td id="S4.T1.8.8.11.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.8.8.11.3.3.1" class="ltx_text ltx_font_bold">4.97</span></td>
<td id="S4.T1.8.8.11.3.4" class="ltx_td ltx_align_center ltx_border_r">6.57</td>
<td id="S4.T1.8.8.11.3.5" class="ltx_td ltx_align_center ltx_border_r">4.99</td>
<td id="S4.T1.8.8.11.3.6" class="ltx_td ltx_align_center ltx_border_r">4.20</td>
<td id="S4.T1.8.8.11.3.7" class="ltx_td ltx_align_center">3.43</td>
</tr>
<tr id="S4.T1.8.8.12.4" class="ltx_tr">
<th id="S4.T1.8.8.12.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Medical</th>
<td id="S4.T1.8.8.12.4.2" class="ltx_td ltx_align_center ltx_border_r">7.30</td>
<td id="S4.T1.8.8.12.4.3" class="ltx_td ltx_align_center ltx_border_r">7.22</td>
<td id="S4.T1.8.8.12.4.4" class="ltx_td ltx_align_center ltx_border_r">7.49</td>
<td id="S4.T1.8.8.12.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.8.8.12.4.5.1" class="ltx_text ltx_font_bold">6.74</span></td>
<td id="S4.T1.8.8.12.4.6" class="ltx_td ltx_align_center ltx_border_r">6.17</td>
<td id="S4.T1.8.8.12.4.7" class="ltx_td ltx_align_center">5.05</td>
</tr>
<tr id="S4.T1.3.3.3" class="ltx_tr">
<th id="S4.T1.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Librispeech-Noise (<math id="S4.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="S/R=10" display="inline"><semantics id="S4.T1.3.3.3.1.m1.1a"><mrow id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml"><mrow id="S4.T1.3.3.3.1.m1.1.1.2" xref="S4.T1.3.3.3.1.m1.1.1.2.cmml"><mi id="S4.T1.3.3.3.1.m1.1.1.2.2" xref="S4.T1.3.3.3.1.m1.1.1.2.2.cmml">S</mi><mo id="S4.T1.3.3.3.1.m1.1.1.2.1" xref="S4.T1.3.3.3.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.T1.3.3.3.1.m1.1.1.2.3" xref="S4.T1.3.3.3.1.m1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.T1.3.3.3.1.m1.1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.3.3.3.1.m1.1.1.3" xref="S4.T1.3.3.3.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><apply id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1"><eq id="S4.T1.3.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1.1"></eq><apply id="S4.T1.3.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.3.1.m1.1.1.2"><divide id="S4.T1.3.3.3.1.m1.1.1.2.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1.2.1"></divide><ci id="S4.T1.3.3.3.1.m1.1.1.2.2.cmml" xref="S4.T1.3.3.3.1.m1.1.1.2.2">𝑆</ci><ci id="S4.T1.3.3.3.1.m1.1.1.2.3.cmml" xref="S4.T1.3.3.3.1.m1.1.1.2.3">𝑅</ci></apply><cn type="integer" id="S4.T1.3.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.3.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">S/R=10</annotation></semantics></math>)</th>
<td id="S4.T1.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.50</td>
<td id="S4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.12</td>
<td id="S4.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.05</td>
<td id="S4.T1.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.3.3.3.5.1" class="ltx_text ltx_font_bold">3.02</span></td>
<td id="S4.T1.3.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.32</td>
<td id="S4.T1.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">1.94</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Librispeech-Noise (<math id="S4.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="S/R=5" display="inline"><semantics id="S4.T1.4.4.4.1.m1.1a"><mrow id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml"><mrow id="S4.T1.4.4.4.1.m1.1.1.2" xref="S4.T1.4.4.4.1.m1.1.1.2.cmml"><mi id="S4.T1.4.4.4.1.m1.1.1.2.2" xref="S4.T1.4.4.4.1.m1.1.1.2.2.cmml">S</mi><mo id="S4.T1.4.4.4.1.m1.1.1.2.1" xref="S4.T1.4.4.4.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.T1.4.4.4.1.m1.1.1.2.3" xref="S4.T1.4.4.4.1.m1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.T1.4.4.4.1.m1.1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.4.4.4.1.m1.1.1.3" xref="S4.T1.4.4.4.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><apply id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1"><eq id="S4.T1.4.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1.1"></eq><apply id="S4.T1.4.4.4.1.m1.1.1.2.cmml" xref="S4.T1.4.4.4.1.m1.1.1.2"><divide id="S4.T1.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1.2.1"></divide><ci id="S4.T1.4.4.4.1.m1.1.1.2.2.cmml" xref="S4.T1.4.4.4.1.m1.1.1.2.2">𝑆</ci><ci id="S4.T1.4.4.4.1.m1.1.1.2.3.cmml" xref="S4.T1.4.4.4.1.m1.1.1.2.3">𝑅</ci></apply><cn type="integer" id="S4.T1.4.4.4.1.m1.1.1.3.cmml" xref="S4.T1.4.4.4.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">S/R=5</annotation></semantics></math>)</th>
<td id="S4.T1.4.4.4.2" class="ltx_td ltx_align_center ltx_border_r">5.67</td>
<td id="S4.T1.4.4.4.3" class="ltx_td ltx_align_center ltx_border_r">5.25</td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_border_r">6.00</td>
<td id="S4.T1.4.4.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.4.4.4.5.1" class="ltx_text ltx_font_bold">4.96</span></td>
<td id="S4.T1.4.4.4.6" class="ltx_td ltx_align_center ltx_border_r">4.10</td>
<td id="S4.T1.4.4.4.7" class="ltx_td ltx_align_center">3.28</td>
</tr>
<tr id="S4.T1.5.5.5" class="ltx_tr">
<th id="S4.T1.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Librispeech-Noise (<math id="S4.T1.5.5.5.1.m1.1" class="ltx_Math" alttext="S/R=0" display="inline"><semantics id="S4.T1.5.5.5.1.m1.1a"><mrow id="S4.T1.5.5.5.1.m1.1.1" xref="S4.T1.5.5.5.1.m1.1.1.cmml"><mrow id="S4.T1.5.5.5.1.m1.1.1.2" xref="S4.T1.5.5.5.1.m1.1.1.2.cmml"><mi id="S4.T1.5.5.5.1.m1.1.1.2.2" xref="S4.T1.5.5.5.1.m1.1.1.2.2.cmml">S</mi><mo id="S4.T1.5.5.5.1.m1.1.1.2.1" xref="S4.T1.5.5.5.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.T1.5.5.5.1.m1.1.1.2.3" xref="S4.T1.5.5.5.1.m1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.T1.5.5.5.1.m1.1.1.1" xref="S4.T1.5.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.5.5.5.1.m1.1.1.3" xref="S4.T1.5.5.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.m1.1b"><apply id="S4.T1.5.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1"><eq id="S4.T1.5.5.5.1.m1.1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1.1"></eq><apply id="S4.T1.5.5.5.1.m1.1.1.2.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2"><divide id="S4.T1.5.5.5.1.m1.1.1.2.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2.1"></divide><ci id="S4.T1.5.5.5.1.m1.1.1.2.2.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2.2">𝑆</ci><ci id="S4.T1.5.5.5.1.m1.1.1.2.3.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2.3">𝑅</ci></apply><cn type="integer" id="S4.T1.5.5.5.1.m1.1.1.3.cmml" xref="S4.T1.5.5.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.m1.1c">S/R=0</annotation></semantics></math>)</th>
<td id="S4.T1.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r">15.23</td>
<td id="S4.T1.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r">13.54</td>
<td id="S4.T1.5.5.5.4" class="ltx_td ltx_align_center ltx_border_r">14.44</td>
<td id="S4.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.5.5.5.1" class="ltx_text ltx_font_bold">13.27</span></td>
<td id="S4.T1.5.5.5.6" class="ltx_td ltx_align_center ltx_border_r">11.66</td>
<td id="S4.T1.5.5.5.7" class="ltx_td ltx_align_center">9.04</td>
</tr>
<tr id="S4.T1.6.6.6" class="ltx_tr">
<th id="S4.T1.6.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Librispeech-Noise (<math id="S4.T1.6.6.6.1.m1.1" class="ltx_Math" alttext="S/R=-5" display="inline"><semantics id="S4.T1.6.6.6.1.m1.1a"><mrow id="S4.T1.6.6.6.1.m1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.cmml"><mrow id="S4.T1.6.6.6.1.m1.1.1.2" xref="S4.T1.6.6.6.1.m1.1.1.2.cmml"><mi id="S4.T1.6.6.6.1.m1.1.1.2.2" xref="S4.T1.6.6.6.1.m1.1.1.2.2.cmml">S</mi><mo id="S4.T1.6.6.6.1.m1.1.1.2.1" xref="S4.T1.6.6.6.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.T1.6.6.6.1.m1.1.1.2.3" xref="S4.T1.6.6.6.1.m1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.T1.6.6.6.1.m1.1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.6.6.6.1.m1.1.1.3" xref="S4.T1.6.6.6.1.m1.1.1.3.cmml"><mo id="S4.T1.6.6.6.1.m1.1.1.3a" xref="S4.T1.6.6.6.1.m1.1.1.3.cmml">−</mo><mn id="S4.T1.6.6.6.1.m1.1.1.3.2" xref="S4.T1.6.6.6.1.m1.1.1.3.2.cmml">5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.m1.1b"><apply id="S4.T1.6.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1"><eq id="S4.T1.6.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1.1"></eq><apply id="S4.T1.6.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2"><divide id="S4.T1.6.6.6.1.m1.1.1.2.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2.1"></divide><ci id="S4.T1.6.6.6.1.m1.1.1.2.2.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2.2">𝑆</ci><ci id="S4.T1.6.6.6.1.m1.1.1.2.3.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2.3">𝑅</ci></apply><apply id="S4.T1.6.6.6.1.m1.1.1.3.cmml" xref="S4.T1.6.6.6.1.m1.1.1.3"><minus id="S4.T1.6.6.6.1.m1.1.1.3.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1.3"></minus><cn type="integer" id="S4.T1.6.6.6.1.m1.1.1.3.2.cmml" xref="S4.T1.6.6.6.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.m1.1c">S/R=-5</annotation></semantics></math>)</th>
<td id="S4.T1.6.6.6.2" class="ltx_td ltx_align_center ltx_border_r">49.09</td>
<td id="S4.T1.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r">47.05</td>
<td id="S4.T1.6.6.6.4" class="ltx_td ltx_align_center ltx_border_r">47.35</td>
<td id="S4.T1.6.6.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.6.6.6.5.1" class="ltx_text ltx_font_bold">46.98</span></td>
<td id="S4.T1.6.6.6.6" class="ltx_td ltx_align_center ltx_border_r">43.62</td>
<td id="S4.T1.6.6.6.7" class="ltx_td ltx_align_center">33.19</td>
</tr>
<tr id="S4.T1.8.8.13.5" class="ltx_tr">
<th id="S4.T1.8.8.13.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S4.T1.8.8.13.5.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.8.8.13.5.2.1" class="ltx_text ltx_font_bold">Whisper</span></td>
<td id="S4.T1.8.8.13.5.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.8.8.13.5.3.1" class="ltx_text ltx_font_bold">GER</span></td>
<td id="S4.T1.8.8.13.5.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.8.8.13.5.4.1" class="ltx_text ltx_font_bold">GFD-ASR-ZH</span></td>
<td id="S4.T1.8.8.13.5.5" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.8.8.13.5.5.1" class="ltx_text ltx_font_bold">Oracle</span></td>
</tr>
<tr id="S4.T1.8.8.8" class="ltx_tr">
<th id="S4.T1.8.8.8.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.8.8.8.3.1" class="ltx_text ltx_font_bold">ZH or HK dataset</span></th>
<td id="S4.T1.8.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Greedy</td>
<td id="S4.T1.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5-beams (Baseline)</td>
<td id="S4.T1.8.8.8.6" class="ltx_td ltx_border_r"></td>
<td id="S4.T1.8.8.8.7" class="ltx_td ltx_border_r"></td>
<td id="S4.T1.7.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T1.7.7.7.1.m1.1" class="ltx_Math" alttext="\text{O}_{\text{nb}}" display="inline"><semantics id="S4.T1.7.7.7.1.m1.1a"><msub id="S4.T1.7.7.7.1.m1.1.1" xref="S4.T1.7.7.7.1.m1.1.1.cmml"><mtext id="S4.T1.7.7.7.1.m1.1.1.2" xref="S4.T1.7.7.7.1.m1.1.1.2a.cmml">O</mtext><mtext id="S4.T1.7.7.7.1.m1.1.1.3" xref="S4.T1.7.7.7.1.m1.1.1.3a.cmml">nb</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.m1.1b"><apply id="S4.T1.7.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1">subscript</csymbol><ci id="S4.T1.7.7.7.1.m1.1.1.2a.cmml" xref="S4.T1.7.7.7.1.m1.1.1.2"><mtext id="S4.T1.7.7.7.1.m1.1.1.2.cmml" xref="S4.T1.7.7.7.1.m1.1.1.2">O</mtext></ci><ci id="S4.T1.7.7.7.1.m1.1.1.3a.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3"><mtext mathsize="70%" id="S4.T1.7.7.7.1.m1.1.1.3.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3">nb</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.m1.1c">\text{O}_{\text{nb}}</annotation></semantics></math></td>
<td id="S4.T1.8.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.8.8.8.2.m1.1" class="ltx_Math" alttext="\text{O}_{\text{cp}}" display="inline"><semantics id="S4.T1.8.8.8.2.m1.1a"><msub id="S4.T1.8.8.8.2.m1.1.1" xref="S4.T1.8.8.8.2.m1.1.1.cmml"><mtext id="S4.T1.8.8.8.2.m1.1.1.2" xref="S4.T1.8.8.8.2.m1.1.1.2a.cmml">O</mtext><mtext id="S4.T1.8.8.8.2.m1.1.1.3" xref="S4.T1.8.8.8.2.m1.1.1.3a.cmml">cp</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.2.m1.1b"><apply id="S4.T1.8.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.8.2.m1.1.1.1.cmml" xref="S4.T1.8.8.8.2.m1.1.1">subscript</csymbol><ci id="S4.T1.8.8.8.2.m1.1.1.2a.cmml" xref="S4.T1.8.8.8.2.m1.1.1.2"><mtext id="S4.T1.8.8.8.2.m1.1.1.2.cmml" xref="S4.T1.8.8.8.2.m1.1.1.2">O</mtext></ci><ci id="S4.T1.8.8.8.2.m1.1.1.3a.cmml" xref="S4.T1.8.8.8.2.m1.1.1.3"><mtext mathsize="70%" id="S4.T1.8.8.8.2.m1.1.1.3.cmml" xref="S4.T1.8.8.8.2.m1.1.1.3">cp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.2.m1.1c">\text{O}_{\text{cp}}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.8.8.14.6" class="ltx_tr">
<th id="S4.T1.8.8.14.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Fleurs-HK (Cantonese)</th>
<td id="S4.T1.8.8.14.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.49</td>
<td id="S4.T1.8.8.14.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.88</td>
<td id="S4.T1.8.8.14.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.33</td>
<td id="S4.T1.8.8.14.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.8.8.14.6.5.1" class="ltx_text ltx_font_bold">6.23</span></td>
<td id="S4.T1.8.8.14.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.58</td>
<td id="S4.T1.8.8.14.6.7" class="ltx_td ltx_align_center ltx_border_t">4.58</td>
</tr>
<tr id="S4.T1.8.8.15.7" class="ltx_tr">
<th id="S4.T1.8.8.15.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">NTUML2021</th>
<td id="S4.T1.8.8.15.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">11.11</td>
<td id="S4.T1.8.8.15.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">9.97</td>
<td id="S4.T1.8.8.15.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">9.87</td>
<td id="S4.T1.8.8.15.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T1.8.8.15.7.5.1" class="ltx_text ltx_font_bold">8.83</span></td>
<td id="S4.T1.8.8.15.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">8.88</td>
<td id="S4.T1.8.8.15.7.7" class="ltx_td ltx_align_center ltx_border_bb">4.54</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">NTUML2021</td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">FormosaSpeech</td>
</tr>
<tr id="S4.T2.1.2.2" class="ltx_tr">
<th id="S4.T2.1.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Full</td>
<td id="S4.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">English</td>
<td id="S4.T2.1.2.2.4" class="ltx_td ltx_nopad_r"></td>
</tr>
<tr id="S4.T2.1.3.3" class="ltx_tr">
<th id="S4.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Whisper (short)</th>
<td id="S4.T2.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">9.97</td>
<td id="S4.T2.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">15.21</td>
<td id="S4.T2.1.3.3.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S4.T2.1.4.4" class="ltx_tr">
<th id="S4.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SICL (short) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<td id="S4.T2.1.4.4.2" class="ltx_td ltx_align_center">9.5</td>
<td id="S4.T2.1.4.4.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center">-</td>
</tr>
<tr id="S4.T2.1.5.5" class="ltx_tr">
<th id="S4.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">GFD-ASR-ZH (short)</th>
<td id="S4.T2.1.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.2.1" class="ltx_text ltx_font_bold">8.83</span></td>
<td id="S4.T2.1.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.3.1" class="ltx_text ltx_font_bold">13.51</span></td>
<td id="S4.T2.1.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center">-</td>
</tr>
<tr id="S4.T2.1.6.6" class="ltx_tr">
<th id="S4.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Whisper (long)</th>
<td id="S4.T2.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">8.40</td>
<td id="S4.T2.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t">11.56</td>
<td id="S4.T2.1.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">27.41</td>
</tr>
<tr id="S4.T2.1.7.7" class="ltx_tr">
<th id="S4.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">GFD-ASR-ZH (long)</th>
<td id="S4.T2.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.7.7.2.1" class="ltx_text ltx_font_bold">8.18</span></td>
<td id="S4.T2.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.7.7.3.1" class="ltx_text ltx_font_bold">11.43</span></td>
<td id="S4.T2.1.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S4.T2.1.7.7.4.1" class="ltx_text ltx_font_bold">26.72</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison results on long-form and short-form.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Long-form speech recognition</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">As LLMs are capable in attending to long context of sequence and possess multilingual capabilities, we posit that GFD-ASR-ZH can improve on long-form audio transcription. We therefore evaluate the long-form transcription performance on NTUML2021 and FormosaSpeech. In constrast to the short-form evaluations in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Conventional speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> in NTUML2021, we prepend all previous transcription from contiguous clips in the same lecture as prompts for both ASR and LLM to realize long form transcriptions, but truncate it when necessary for whisper due to context length limitations. In the setting of evaluations on contiguous short clips, GFD-ASR-ZH (long) consistently outperforms Whisper (long) in both NTUML2021 and FormosaSpeech, demonstrating that the long-context capability of LLM can be effectively utilized through GFD.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Context-aware speech recognition</h3>

<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results on context-aware ASR task. We set num beams=5 across all our experiments.</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" colspan="2">Prompt</th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">ATCO2</th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Librispeech</th>
<th id="S4.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FormosaSpeech</th>
<th id="S4.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Medical</th>
</tr>
<tr id="S4.T3.1.2.2" class="ltx_tr">
<th id="S4.T3.1.2.2.1" class="ltx_td ltx_th ltx_th_column ltx_th_row"></th>
<th id="S4.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">ASR</th>
<th id="S4.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">LLM</th>
<th id="S4.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Norm</th>
<th id="S4.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Raw</th>
<th id="S4.T3.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Clean</th>
<th id="S4.T3.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Other</th>
<th id="S4.T3.1.2.2.8" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S4.T3.1.2.2.9" class="ltx_td ltx_nopad_r ltx_th ltx_th_column"></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.3.1" class="ltx_tr">
<th id="S4.T3.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Whisper</th>
<th id="S4.T3.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">No</th>
<th id="S4.T3.1.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">-</th>
<td id="S4.T3.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">47.70</td>
<td id="S4.T3.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">66.44</td>
<td id="S4.T3.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">2.28</td>
<td id="S4.T3.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">4.97</td>
<td id="S4.T3.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t">27.42</td>
<td id="S4.T3.1.3.1.9" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">7.22</td>
</tr>
<tr id="S4.T3.1.4.2" class="ltx_tr">
<th id="S4.T3.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Whisper</th>
<th id="S4.T3.1.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">Yes</th>
<th id="S4.T3.1.4.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">-</th>
<td id="S4.T3.1.4.2.4" class="ltx_td ltx_align_center">31.34</td>
<td id="S4.T3.1.4.2.5" class="ltx_td ltx_align_center">42.37</td>
<td id="S4.T3.1.4.2.6" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.4.2.7" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.4.2.8" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.4.2.9" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.1.4.2.9.1" class="ltx_text ltx_font_bold">6.24</span></td>
</tr>
<tr id="S4.T3.1.5.3" class="ltx_tr">
<th id="S4.T3.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Clairaudience<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</th>
<th id="S4.T3.1.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">Yes</th>
<th id="S4.T3.1.5.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">-</th>
<td id="S4.T3.1.5.3.4" class="ltx_td ltx_align_center">28.77</td>
<td id="S4.T3.1.5.3.5" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.3.6" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.3.7" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.3.8" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.3.9" class="ltx_td ltx_nopad_r ltx_align_center">6.54</td>
</tr>
<tr id="S4.T3.1.6.4" class="ltx_tr">
<th id="S4.T3.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">GFD-ASR-EN</th>
<th id="S4.T3.1.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">No</th>
<th id="S4.T3.1.6.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Yes</th>
<td id="S4.T3.1.6.4.4" class="ltx_td ltx_align_center">38.75</td>
<td id="S4.T3.1.6.4.5" class="ltx_td ltx_align_center">52.24</td>
<td id="S4.T3.1.6.4.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.4.6.1" class="ltx_text ltx_font_bold">2.20</span></td>
<td id="S4.T3.1.6.4.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.4.7.1" class="ltx_text ltx_font_bold">4.61</span></td>
<td id="S4.T3.1.6.4.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.4.8.1" class="ltx_text ltx_font_bold">26.29</span></td>
<td id="S4.T3.1.6.4.9" class="ltx_td ltx_nopad_r ltx_align_center">6.62</td>
</tr>
<tr id="S4.T3.1.7.5" class="ltx_tr">
<th id="S4.T3.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">GFD-ASR-EN</th>
<th id="S4.T3.1.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">Yes</th>
<th id="S4.T3.1.7.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">Yes</th>
<td id="S4.T3.1.7.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.7.5.4.1" class="ltx_text ltx_font_bold">25.79</span></td>
<td id="S4.T3.1.7.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.7.5.5.1" class="ltx_text ltx_font_bold">32.46</span></td>
<td id="S4.T3.1.7.5.6" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S4.T3.1.7.5.7" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S4.T3.1.7.5.8" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S4.T3.1.7.5.9" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">6.26</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">In context-aware speech recognition, we aim to investigate the capability of the fusion model in leveraging contextual information, which is highly desired in real-life contexts, where the incoming speech is expected to be bounded by domain, contain certain specific words, or follow a certain transcribing format. We utilize prompting with ASR model and the LLM model (in the GFD setting) to condition on these external hints, in three following settings.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_italic">Domain and Rare Word Prompting:</span> We tested domain-conditioned ASR on the Medical dataset, where the symptom tags are provided along with the speech content. Results show that our GFD method with LLM prompting improves on GFD without prompting, showing prompt sensitiveness of the LLM in the GFD system. However, we did not find further improvement upon whisper prompting, compared to double-prompted GFD. For verifying rare word prompting capabilities, we used the augmented Librispeech and FormosaSpeech dataset, where a target rare word is mixed with 100 other distractors for each data point <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. For the FormosaSpeech Dataset, we created the rare words with ChatGPT, and generate distractors with a similar approach using the training set. At this scale of distractors, it is unrealistic to prompt on Whisper, as the remaining context length is often insufficient for ASR decoding. By prompting on the LLM using GFD, we demonstrated up to 6% WERR over non-prompting methods on the Librispeech dataset, and 1.6% WERR on the FormosaSpeech Dataset.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_italic">Instruction Aware Prompting:</span> We evaluated formatted speech recognition on the ATCO2 dataset, a dataset on air traffic control communications, which has strict regulations on call signs and transcribe formats. By incorporating a LLM, we are able to prompt it with over 4000 words of guidelines from an enitre instruction manual<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap4_section_2.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap4_section_2.html</a></span></span></span>. a possibility not present with Whisper. For Whisper prompting, we include all special call signs and three example sentences extracted from the manual, where we leave details in the Appendix. Results in Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Context-aware speech recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>shows that GFD with ASR and LLM prompting obtains best results with a WERR of 17.7% compared with Whisper in the normalized (ATCO2-Norm) setting, even outperforming Clairaudience<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, a fine-tuned prompt conditioning model. We also reported scores without word conversion normalization (ATCO2-Raw), from observations that standard normalization can excessively correct errors that conflicts with the transcribing guidelines. In this setting, our gains are even larger, showing instruction following abilites of the GFD system.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Optical Character Recognition</h3>

<figure id="S4.T4" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation on OCR task</figcaption>
<table id="S4.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.2.2" class="ltx_tr">
<th id="S4.T4.2.2.3" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CER <math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mo stretchy="false" id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Exact Match <math id="S4.T4.2.2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.2.2.2.m1.1a"><mo stretchy="false" id="S4.T4.2.2.2.m1.1.1" xref="S4.T4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.m1.1b"><ci id="S4.T4.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.m1.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.2.3.1" class="ltx_tr">
<th id="S4.T4.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">TrOCR</th>
<td id="S4.T4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">12.02</td>
<td id="S4.T4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">24.14</td>
</tr>
<tr id="S4.T4.2.4.2" class="ltx_tr">
<th id="S4.T4.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">GFD-OCR</th>
<td id="S4.T4.2.4.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.4.2.2.1" class="ltx_text ltx_font_bold">10.55</span></td>
<td id="S4.T4.2.4.2.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.4.2.3.1" class="ltx_text ltx_font_bold">33.33</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS5.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.p1.1" class="ltx_p">We demonstrate that GFD can be applied to fusing end-to-end OCR model with LLMs, using TrOCR and Mistral <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. We experiment the fusion model on a dataset extracted from National Archive Forms dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, denoted NAF-Long. The NAF-Long dataset consists of images with text sequences having character lengths between 100 and 200, equivalent to around 25 to 50 text tokens. In Table <a href="#S4.T4" title="Table 4 ‣ 4.5 Optical Character Recognition ‣ 4 Experiment ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we show that fusing LLM to the OCR model significantly improves the OCR results by 16.7 % in character error rate reduction and 38.07 % in exact match improvement.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.7" class="ltx_p"><span id="S5.p1.7.1" class="ltx_text ltx_font_bold">Further comparisons with GER.</span> The GFD algorithm relates to GER in that both algorithms perform the selection of output sequences with beam decoding. However, they differ in compute execution and the diversity of sample sequences. First, in GFD, the LLM works in parallel with the ASR decoder, and thus the computation of per step inference can be executed asynchronously with a load bounded by <math id="S5.p1.1.m1.3" class="ltx_Math" alttext="\mathcal{O}(Z)+\mathcal{O}(k\cdot\max(S_{ASR},{S_{LLM}}))" display="inline"><semantics id="S5.p1.1.m1.3a"><mrow id="S5.p1.1.m1.3.3" xref="S5.p1.1.m1.3.3.cmml"><mrow id="S5.p1.1.m1.3.3.3" xref="S5.p1.1.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.1.m1.3.3.3.2" xref="S5.p1.1.m1.3.3.3.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.3.1" xref="S5.p1.1.m1.3.3.3.1.cmml">​</mo><mrow id="S5.p1.1.m1.3.3.3.3.2" xref="S5.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S5.p1.1.m1.3.3.3.3.2.1" xref="S5.p1.1.m1.3.3.3.cmml">(</mo><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">Z</mi><mo stretchy="false" id="S5.p1.1.m1.3.3.3.3.2.2" xref="S5.p1.1.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S5.p1.1.m1.3.3.2" xref="S5.p1.1.m1.3.3.2.cmml">+</mo><mrow id="S5.p1.1.m1.3.3.1" xref="S5.p1.1.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.1.m1.3.3.1.3" xref="S5.p1.1.m1.3.3.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.1.2" xref="S5.p1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S5.p1.1.m1.3.3.1.1.1" xref="S5.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S5.p1.1.m1.3.3.1.1.1.2" xref="S5.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S5.p1.1.m1.3.3.1.1.1.1" xref="S5.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S5.p1.1.m1.3.3.1.1.1.1.4" xref="S5.p1.1.m1.3.3.1.1.1.1.4.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S5.p1.1.m1.3.3.1.1.1.1.3" xref="S5.p1.1.m1.3.3.1.1.1.1.3.cmml">⋅</mo><mrow id="S5.p1.1.m1.3.3.1.1.1.1.2.2" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S5.p1.1.m1.2.2" xref="S5.p1.1.m1.2.2.cmml">max</mi><mo id="S5.p1.1.m1.3.3.1.1.1.1.2.2a" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.3" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml">(</mo><msub id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">S</mi><mrow id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1a" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.4" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml">R</mi></mrow></msub><mo id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.4" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.2" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">S</mi><mrow id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.cmml"><mi id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.2" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.3" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1a" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.4" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.5" xref="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S5.p1.1.m1.3.3.1.1.1.3" xref="S5.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.3b"><apply id="S5.p1.1.m1.3.3.cmml" xref="S5.p1.1.m1.3.3"><plus id="S5.p1.1.m1.3.3.2.cmml" xref="S5.p1.1.m1.3.3.2"></plus><apply id="S5.p1.1.m1.3.3.3.cmml" xref="S5.p1.1.m1.3.3.3"><times id="S5.p1.1.m1.3.3.3.1.cmml" xref="S5.p1.1.m1.3.3.3.1"></times><ci id="S5.p1.1.m1.3.3.3.2.cmml" xref="S5.p1.1.m1.3.3.3.2">𝒪</ci><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝑍</ci></apply><apply id="S5.p1.1.m1.3.3.1.cmml" xref="S5.p1.1.m1.3.3.1"><times id="S5.p1.1.m1.3.3.1.2.cmml" xref="S5.p1.1.m1.3.3.1.2"></times><ci id="S5.p1.1.m1.3.3.1.3.cmml" xref="S5.p1.1.m1.3.3.1.3">𝒪</ci><apply id="S5.p1.1.m1.3.3.1.1.1.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1"><ci id="S5.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.3">⋅</ci><ci id="S5.p1.1.m1.3.3.1.1.1.1.4.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.4">𝑘</ci><apply id="S5.p1.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2"><max id="S5.p1.1.m1.2.2.cmml" xref="S5.p1.1.m1.2.2"></max><apply id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑆</ci><apply id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1"></times><ci id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝐴</ci><ci id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑆</ci><ci id="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.4.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.1.1.1.1.3.4">𝑅</ci></apply></apply><apply id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.2">𝑆</ci><apply id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3"><times id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.1"></times><ci id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.2.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.2">𝐿</ci><ci id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.3.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.3">𝐿</ci><ci id="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.4.cmml" xref="S5.p1.1.m1.3.3.1.1.1.1.2.2.2.2.3.4">𝑀</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.3c">\mathcal{O}(Z)+\mathcal{O}(k\cdot\max(S_{ASR},{S_{LLM}}))</annotation></semantics></math>, where <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S5.p1.2.m2.1a"><mi id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><ci id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">Z</annotation></semantics></math> denotes the size of speech encoding, <math id="S5.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.p1.3.m3.1a"><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">k</annotation></semantics></math> is the beam size, and <math id="S5.p1.4.m4.1" class="ltx_Math" alttext="S_{ASR}" display="inline"><semantics id="S5.p1.4.m4.1a"><msub id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml"><mi id="S5.p1.4.m4.1.1.2" xref="S5.p1.4.m4.1.1.2.cmml">S</mi><mrow id="S5.p1.4.m4.1.1.3" xref="S5.p1.4.m4.1.1.3.cmml"><mi id="S5.p1.4.m4.1.1.3.2" xref="S5.p1.4.m4.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.p1.4.m4.1.1.3.1" xref="S5.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.p1.4.m4.1.1.3.3" xref="S5.p1.4.m4.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.p1.4.m4.1.1.3.1a" xref="S5.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.p1.4.m4.1.1.3.4" xref="S5.p1.4.m4.1.1.3.4.cmml">R</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.1b"><apply id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p1.4.m4.1.1.1.cmml" xref="S5.p1.4.m4.1.1">subscript</csymbol><ci id="S5.p1.4.m4.1.1.2.cmml" xref="S5.p1.4.m4.1.1.2">𝑆</ci><apply id="S5.p1.4.m4.1.1.3.cmml" xref="S5.p1.4.m4.1.1.3"><times id="S5.p1.4.m4.1.1.3.1.cmml" xref="S5.p1.4.m4.1.1.3.1"></times><ci id="S5.p1.4.m4.1.1.3.2.cmml" xref="S5.p1.4.m4.1.1.3.2">𝐴</ci><ci id="S5.p1.4.m4.1.1.3.3.cmml" xref="S5.p1.4.m4.1.1.3.3">𝑆</ci><ci id="S5.p1.4.m4.1.1.3.4.cmml" xref="S5.p1.4.m4.1.1.3.4">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.1c">S_{ASR}</annotation></semantics></math> and <math id="S5.p1.5.m5.1" class="ltx_Math" alttext="S_{LLM}" display="inline"><semantics id="S5.p1.5.m5.1a"><msub id="S5.p1.5.m5.1.1" xref="S5.p1.5.m5.1.1.cmml"><mi id="S5.p1.5.m5.1.1.2" xref="S5.p1.5.m5.1.1.2.cmml">S</mi><mrow id="S5.p1.5.m5.1.1.3" xref="S5.p1.5.m5.1.1.3.cmml"><mi id="S5.p1.5.m5.1.1.3.2" xref="S5.p1.5.m5.1.1.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.5.m5.1.1.3.1" xref="S5.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.p1.5.m5.1.1.3.3" xref="S5.p1.5.m5.1.1.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.5.m5.1.1.3.1a" xref="S5.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.p1.5.m5.1.1.3.4" xref="S5.p1.5.m5.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.5.m5.1b"><apply id="S5.p1.5.m5.1.1.cmml" xref="S5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p1.5.m5.1.1.1.cmml" xref="S5.p1.5.m5.1.1">subscript</csymbol><ci id="S5.p1.5.m5.1.1.2.cmml" xref="S5.p1.5.m5.1.1.2">𝑆</ci><apply id="S5.p1.5.m5.1.1.3.cmml" xref="S5.p1.5.m5.1.1.3"><times id="S5.p1.5.m5.1.1.3.1.cmml" xref="S5.p1.5.m5.1.1.3.1"></times><ci id="S5.p1.5.m5.1.1.3.2.cmml" xref="S5.p1.5.m5.1.1.3.2">𝐿</ci><ci id="S5.p1.5.m5.1.1.3.3.cmml" xref="S5.p1.5.m5.1.1.3.3">𝐿</ci><ci id="S5.p1.5.m5.1.1.3.4.cmml" xref="S5.p1.5.m5.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.5.m5.1c">S_{LLM}</annotation></semantics></math> are ASR and LLM decoding lengths, respectively. The LLM decoding complexity expression matches that of Section <a href="#S3.SS2" title="3.2 Fusing text-recognition models with LLM ‣ 3 Method ‣ Let’s Fuse Step by Step: A Generative Fusion Decoding Algorithm with LLMs for Multi-modal Text Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, treating the vocabulary size as a constant in this dicussion. In contrast, GER operates sequentially, requiring the completion of beam decoding with ASR prior to a correction with LLM. This means the execution time of GER is bounded by <math id="S5.p1.6.m6.3" class="ltx_Math" alttext="\mathcal{O}(Z)+\mathcal{O}((k+1)\cdot S_{LLM})+\mathcal{O}(k\cdot S_{ASR})" display="inline"><semantics id="S5.p1.6.m6.3a"><mrow id="S5.p1.6.m6.3.3" xref="S5.p1.6.m6.3.3.cmml"><mrow id="S5.p1.6.m6.3.3.4" xref="S5.p1.6.m6.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.6.m6.3.3.4.2" xref="S5.p1.6.m6.3.3.4.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.3.3.4.1" xref="S5.p1.6.m6.3.3.4.1.cmml">​</mo><mrow id="S5.p1.6.m6.3.3.4.3.2" xref="S5.p1.6.m6.3.3.4.cmml"><mo stretchy="false" id="S5.p1.6.m6.3.3.4.3.2.1" xref="S5.p1.6.m6.3.3.4.cmml">(</mo><mi id="S5.p1.6.m6.1.1" xref="S5.p1.6.m6.1.1.cmml">Z</mi><mo stretchy="false" id="S5.p1.6.m6.3.3.4.3.2.2" xref="S5.p1.6.m6.3.3.4.cmml">)</mo></mrow></mrow><mo id="S5.p1.6.m6.3.3.3" xref="S5.p1.6.m6.3.3.3.cmml">+</mo><mrow id="S5.p1.6.m6.2.2.1" xref="S5.p1.6.m6.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.6.m6.2.2.1.3" xref="S5.p1.6.m6.2.2.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.2.2.1.2" xref="S5.p1.6.m6.2.2.1.2.cmml">​</mo><mrow id="S5.p1.6.m6.2.2.1.1.1" xref="S5.p1.6.m6.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S5.p1.6.m6.2.2.1.1.1.2" xref="S5.p1.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S5.p1.6.m6.2.2.1.1.1.1" xref="S5.p1.6.m6.2.2.1.1.1.1.cmml"><mrow id="S5.p1.6.m6.2.2.1.1.1.1.1.1" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p1.6.m6.2.2.1.1.1.1.1.1.2" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">k</mi><mo id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.1" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S5.p1.6.m6.2.2.1.1.1.1.1.1.3" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S5.p1.6.m6.2.2.1.1.1.1.2" xref="S5.p1.6.m6.2.2.1.1.1.1.2.cmml">⋅</mo><msub id="S5.p1.6.m6.2.2.1.1.1.1.3" xref="S5.p1.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S5.p1.6.m6.2.2.1.1.1.1.3.2" xref="S5.p1.6.m6.2.2.1.1.1.1.3.2.cmml">S</mi><mrow id="S5.p1.6.m6.2.2.1.1.1.1.3.3" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.cmml"><mi id="S5.p1.6.m6.2.2.1.1.1.1.3.3.2" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.2.2.1.1.1.1.3.3.1" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.p1.6.m6.2.2.1.1.1.1.3.3.3" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.2.2.1.1.1.1.3.3.1a" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.p1.6.m6.2.2.1.1.1.1.3.3.4" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.4.cmml">M</mi></mrow></msub></mrow><mo stretchy="false" id="S5.p1.6.m6.2.2.1.1.1.3" xref="S5.p1.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.p1.6.m6.3.3.3a" xref="S5.p1.6.m6.3.3.3.cmml">+</mo><mrow id="S5.p1.6.m6.3.3.2" xref="S5.p1.6.m6.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.6.m6.3.3.2.3" xref="S5.p1.6.m6.3.3.2.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.3.3.2.2" xref="S5.p1.6.m6.3.3.2.2.cmml">​</mo><mrow id="S5.p1.6.m6.3.3.2.1.1" xref="S5.p1.6.m6.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S5.p1.6.m6.3.3.2.1.1.2" xref="S5.p1.6.m6.3.3.2.1.1.1.cmml">(</mo><mrow id="S5.p1.6.m6.3.3.2.1.1.1" xref="S5.p1.6.m6.3.3.2.1.1.1.cmml"><mi id="S5.p1.6.m6.3.3.2.1.1.1.2" xref="S5.p1.6.m6.3.3.2.1.1.1.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S5.p1.6.m6.3.3.2.1.1.1.1" xref="S5.p1.6.m6.3.3.2.1.1.1.1.cmml">⋅</mo><msub id="S5.p1.6.m6.3.3.2.1.1.1.3" xref="S5.p1.6.m6.3.3.2.1.1.1.3.cmml"><mi id="S5.p1.6.m6.3.3.2.1.1.1.3.2" xref="S5.p1.6.m6.3.3.2.1.1.1.3.2.cmml">S</mi><mrow id="S5.p1.6.m6.3.3.2.1.1.1.3.3" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.cmml"><mi id="S5.p1.6.m6.3.3.2.1.1.1.3.3.2" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.3.3.2.1.1.1.3.3.1" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.1.cmml">​</mo><mi id="S5.p1.6.m6.3.3.2.1.1.1.3.3.3" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.3.3.2.1.1.1.3.3.1a" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.1.cmml">​</mo><mi id="S5.p1.6.m6.3.3.2.1.1.1.3.3.4" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.4.cmml">R</mi></mrow></msub></mrow><mo stretchy="false" id="S5.p1.6.m6.3.3.2.1.1.3" xref="S5.p1.6.m6.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.6.m6.3b"><apply id="S5.p1.6.m6.3.3.cmml" xref="S5.p1.6.m6.3.3"><plus id="S5.p1.6.m6.3.3.3.cmml" xref="S5.p1.6.m6.3.3.3"></plus><apply id="S5.p1.6.m6.3.3.4.cmml" xref="S5.p1.6.m6.3.3.4"><times id="S5.p1.6.m6.3.3.4.1.cmml" xref="S5.p1.6.m6.3.3.4.1"></times><ci id="S5.p1.6.m6.3.3.4.2.cmml" xref="S5.p1.6.m6.3.3.4.2">𝒪</ci><ci id="S5.p1.6.m6.1.1.cmml" xref="S5.p1.6.m6.1.1">𝑍</ci></apply><apply id="S5.p1.6.m6.2.2.1.cmml" xref="S5.p1.6.m6.2.2.1"><times id="S5.p1.6.m6.2.2.1.2.cmml" xref="S5.p1.6.m6.2.2.1.2"></times><ci id="S5.p1.6.m6.2.2.1.3.cmml" xref="S5.p1.6.m6.2.2.1.3">𝒪</ci><apply id="S5.p1.6.m6.2.2.1.1.1.1.cmml" xref="S5.p1.6.m6.2.2.1.1.1"><ci id="S5.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.2">⋅</ci><apply id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1"><plus id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.1"></plus><ci id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S5.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.p1.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3">subscript</csymbol><ci id="S5.p1.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.2">𝑆</ci><apply id="S5.p1.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3"><times id="S5.p1.6.m6.2.2.1.1.1.1.3.3.1.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.1"></times><ci id="S5.p1.6.m6.2.2.1.1.1.1.3.3.2.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.2">𝐿</ci><ci id="S5.p1.6.m6.2.2.1.1.1.1.3.3.3.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.3">𝐿</ci><ci id="S5.p1.6.m6.2.2.1.1.1.1.3.3.4.cmml" xref="S5.p1.6.m6.2.2.1.1.1.1.3.3.4">𝑀</ci></apply></apply></apply></apply><apply id="S5.p1.6.m6.3.3.2.cmml" xref="S5.p1.6.m6.3.3.2"><times id="S5.p1.6.m6.3.3.2.2.cmml" xref="S5.p1.6.m6.3.3.2.2"></times><ci id="S5.p1.6.m6.3.3.2.3.cmml" xref="S5.p1.6.m6.3.3.2.3">𝒪</ci><apply id="S5.p1.6.m6.3.3.2.1.1.1.cmml" xref="S5.p1.6.m6.3.3.2.1.1"><ci id="S5.p1.6.m6.3.3.2.1.1.1.1.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.1">⋅</ci><ci id="S5.p1.6.m6.3.3.2.1.1.1.2.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.2">𝑘</ci><apply id="S5.p1.6.m6.3.3.2.1.1.1.3.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.p1.6.m6.3.3.2.1.1.1.3.1.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3">subscript</csymbol><ci id="S5.p1.6.m6.3.3.2.1.1.1.3.2.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.2">𝑆</ci><apply id="S5.p1.6.m6.3.3.2.1.1.1.3.3.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3"><times id="S5.p1.6.m6.3.3.2.1.1.1.3.3.1.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.1"></times><ci id="S5.p1.6.m6.3.3.2.1.1.1.3.3.2.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.2">𝐴</ci><ci id="S5.p1.6.m6.3.3.2.1.1.1.3.3.3.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.3">𝑆</ci><ci id="S5.p1.6.m6.3.3.2.1.1.1.3.3.4.cmml" xref="S5.p1.6.m6.3.3.2.1.1.1.3.3.4">𝑅</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.6.m6.3c">\mathcal{O}(Z)+\mathcal{O}((k+1)\cdot S_{LLM})+\mathcal{O}(k\cdot S_{ASR})</annotation></semantics></math>, where the additional <math id="S5.p1.7.m7.1" class="ltx_Math" alttext="O(S_{LLM})" display="inline"><semantics id="S5.p1.7.m7.1a"><mrow id="S5.p1.7.m7.1.1" xref="S5.p1.7.m7.1.1.cmml"><mi id="S5.p1.7.m7.1.1.3" xref="S5.p1.7.m7.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S5.p1.7.m7.1.1.2" xref="S5.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S5.p1.7.m7.1.1.1.1" xref="S5.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p1.7.m7.1.1.1.1.2" xref="S5.p1.7.m7.1.1.1.1.1.cmml">(</mo><msub id="S5.p1.7.m7.1.1.1.1.1" xref="S5.p1.7.m7.1.1.1.1.1.cmml"><mi id="S5.p1.7.m7.1.1.1.1.1.2" xref="S5.p1.7.m7.1.1.1.1.1.2.cmml">S</mi><mrow id="S5.p1.7.m7.1.1.1.1.1.3" xref="S5.p1.7.m7.1.1.1.1.1.3.cmml"><mi id="S5.p1.7.m7.1.1.1.1.1.3.2" xref="S5.p1.7.m7.1.1.1.1.1.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.7.m7.1.1.1.1.1.3.1" xref="S5.p1.7.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.p1.7.m7.1.1.1.1.1.3.3" xref="S5.p1.7.m7.1.1.1.1.1.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.p1.7.m7.1.1.1.1.1.3.1a" xref="S5.p1.7.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.p1.7.m7.1.1.1.1.1.3.4" xref="S5.p1.7.m7.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S5.p1.7.m7.1.1.1.1.3" xref="S5.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.7.m7.1b"><apply id="S5.p1.7.m7.1.1.cmml" xref="S5.p1.7.m7.1.1"><times id="S5.p1.7.m7.1.1.2.cmml" xref="S5.p1.7.m7.1.1.2"></times><ci id="S5.p1.7.m7.1.1.3.cmml" xref="S5.p1.7.m7.1.1.3">𝑂</ci><apply id="S5.p1.7.m7.1.1.1.1.1.cmml" xref="S5.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S5.p1.7.m7.1.1.1.1.1.1.cmml" xref="S5.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S5.p1.7.m7.1.1.1.1.1.2.cmml" xref="S5.p1.7.m7.1.1.1.1.1.2">𝑆</ci><apply id="S5.p1.7.m7.1.1.1.1.1.3.cmml" xref="S5.p1.7.m7.1.1.1.1.1.3"><times id="S5.p1.7.m7.1.1.1.1.1.3.1.cmml" xref="S5.p1.7.m7.1.1.1.1.1.3.1"></times><ci id="S5.p1.7.m7.1.1.1.1.1.3.2.cmml" xref="S5.p1.7.m7.1.1.1.1.1.3.2">𝐿</ci><ci id="S5.p1.7.m7.1.1.1.1.1.3.3.cmml" xref="S5.p1.7.m7.1.1.1.1.1.3.3">𝐿</ci><ci id="S5.p1.7.m7.1.1.1.1.1.3.4.cmml" xref="S5.p1.7.m7.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.7.m7.1c">O(S_{LLM})</annotation></semantics></math> comes from LLM decoding. Secondly, in GFD, the searched token space attended by the LLM is at least n_beams * sequence length, whereas in GER, the top-k cutoff of the ASR step does not promote diversity between the candidates, which limits the LLM search space. Aside from these differences, GFD and GER are methodologically orthogonal, allowing for their combination in the pursuit of further improvement.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Limitations.</span> Despite promsing results, we identified three cases where GFD is most susceptible to failure, which is an exciting future direction. We categorize them into ASR errors and LLM errors.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">ASR proposed errors: When ASR proposes a candidate with high probability that deviates from the phonetic constraint, the LLM may falsely pickup the sequence, inducing an error. There are two main types - semantically activated tokens and time delayed activated tokens. Semantically activated tokens are tokens that are encoded in similar output embedding space due to semantic similarity. We found that these errors are much more
common in Chinese and identified some pairs from a top-k analysis of a decoding sequence, e.g., ’剛’ and’才’, ’做(什麼)’ and ’幹(什麼)’ . Time delay activated tokens are proposed tokens that are targets at a later step, where selecting them effectively skips some intermediate tokens. We observe that these tokens are much more likely to be present at the start of the sequence.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p">LLM probability estimation errors: LLM probability estimates are generally aligned with the logical coherence of a sequence. However, a major discrepancy arises with repeating sequences. Due to the in-context learning abilities of LLMs, they tend to significantly overestimate the likelihood of ever-repeating sequences. This could lead to mode collapse during the entire decoding process.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">The Generative Fusion Decoding (GFD) framework represents a leap forward in fusing auto-regressive text models from heterogeneous token spaces. Our experiments confirm GFD’s effectiveness, particularly in ASR tasks. For tonal languages like Chinese, it achieves a mixed error rate of 8.83% on the NTUML2021 dataset, surpassing previous benchmarks. In context-aware recognition, GFD demonstrated its prowess by a 17.7% Word Error Rate Reduction (WERR) on the ATCO2 dataset when utilizing prompts to both ASR and LLM . For OCR tasks, GFD’s fusion with LLMs resulted in a notable 38.06% improvement in exact matches on the NAF-Long dataset, underscoring the framework’s ability to enhance recognition of long text sequences. These experimental outcomes highlight GFD’s robustness and adaptability, showcasing its generality to leverage the extensive training and contextual understanding of LLMs to improve text recognition across various domains and challenges. We hope that our framework will motivate further research into more fusion techniques that better leverages the existing capabilties of the pre-trained models.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jean-Baptiste Alayrac, Jeff Donahue, Pauline Luc, Antoine Miech, Iain Barr, Yana Hasson, Karel Lenc, Arthur Mensch, Katie Millican, Malcolm Reynolds, Roman Ring, Eliza Rutherford, Serkan Cabi, Tengda Han, Zhitao Gong, Sina Samangooei, Marianne Monteiro, Jacob Menick, Sebastian Borgeaud, Andrew Brock, Aida Nematzadeh, Sahand Sharifzadeh, Mikolaj Binkowski, Ricardo Barreira, Oriol Vinyals, Andrew Zisserman, and Karen Simonyan.

</span>
<span class="ltx_bibblock">Flamingo: a Visual Language Model for Few-Shot Learning, November 2022.

</span>
<span class="ltx_bibblock">arXiv:2204.14198 [cs].

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Ankur Bapna, Colin Cherry, Yu Zhang, Ye Jia, Melvin Johnson, Yong Cheng, Simran Khanuja, Jason Riesa, and Alexis Conneau.

</span>
<span class="ltx_bibblock">mSLAM: Massively multilingual joint pre-training for speech and text, February 2022.

</span>
<span class="ltx_bibblock">arXiv:2202.01374 [cs].

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Ankur Bapna, Yu-an Chung, Nan Wu, Anmol Gulati, Ye Jia, Jonathan H. Clark, Melvin Johnson, Jason Riesa, Alexis Conneau, and Yu Zhang.

</span>
<span class="ltx_bibblock">SLAM: A Unified Encoder for Speech and Language Modeling via Speech-Text Joint Pre-Training, October 2021.

</span>
<span class="ltx_bibblock">arXiv:2110.10329 [cs].

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv</span>, (NeurIPS), 2020.

</span>
<span class="ltx_bibblock">arXiv: 2005.14165.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chen Chen, Yuchen Hu, Chao-Han Huck Yang, Sabato Macro Siniscalchi, Pin-Yu Chen, and Eng Siong Chng.

</span>
<span class="ltx_bibblock">HyPoradise: An Open Baseline for Generative Speech Recognition with Large Language Models, October 2023.

</span>
<span class="ltx_bibblock">arXiv:2309.15701 [cs, eess].

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chen Chen, Ruizhe Li, Yuchen Hu, Sabato Marco Siniscalchi, Pin-Yu Chen, Ensiong Chng, and Chao-Han Huck Yang.

</span>
<span class="ltx_bibblock">It’s Never Too Late: Fusing Acoustic Information into Large Language Models for Automatic Speech Recognition, February 2024.

</span>
<span class="ltx_bibblock">arXiv:2402.05457 [cs, eess].

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Xi Chen, Xiao Wang, Soravit Changpinyo, A. J. Piergiovanni, Piotr Padlewski, Daniel Salz, Sebastian Goodman, Adam Grycner, Basil Mustafa, Lucas Beyer, Alexander Kolesnikov, Joan Puigcerver, Nan Ding, Keran Rong, Hassan Akbari, Gaurav Mishra, Linting Xue, Ashish Thapliyal, James Bradbury, Weicheng Kuo, Mojtaba Seyedhosseini, Chao Jia, Burcu Karagol Ayan, Carlos Riquelme, Andreas Steiner, Anelia Angelova, Xiaohua Zhai, Neil Houlsby, and Radu Soricut.

</span>
<span class="ltx_bibblock">PaLI: A Jointly-Scaled Multilingual Language-Image Model, September 2022.

</span>
<span class="ltx_bibblock">arXiv:2209.06794 [cs].

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Yi-Chang Chen, Yu-Chuan Chang, Yen-Cheng Chang, and Yi-Ren Yeh.

</span>
<span class="ltx_bibblock">g2pW: A Conditional Weighted Softmax BERT for Polyphone Disambiguation in Mandarin, August 2022.

</span>
<span class="ltx_bibblock">arXiv:2203.10430 [cs, eess].

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Yi-Chang Chen, Chun-Yen Cheng, Chien-An Chen, Ming-Chieh Sung, and Yi-Ren Yeh.

</span>
<span class="ltx_bibblock">Integrated Semantic and Phonetic Post-correction for Chinese Speech Recognition, November 2021.

</span>
<span class="ltx_bibblock">arXiv:2111.08400 [cs, eess].

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Chhavi Choudhury, Ankur Gandhe, Xiaohan Ding, and Ivan Bulyko.

</span>
<span class="ltx_bibblock">A Likelihood Ratio based Domain Adaptation Method for E2E Models, January 2022.

</span>
<span class="ltx_bibblock">arXiv:2201.03655 [cs].

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
HoLam Chung, Junan Li, Pengfei Liu1, Wai-Kim Leung, Xixin Wu, and Helen Meng.

</span>
<span class="ltx_bibblock">Improving Rare Words Recognition through Homophone Extension and Unified Writing for Low-resource Cantonese Speech Recognition, February 2023.

</span>
<span class="ltx_bibblock">arXiv:2302.00836 [cs, eess].

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Alexis Conneau, Min Ma, Simran Khanuja, Yu Zhang, Vera Axelrod, Siddharth Dalmia, Jason Riesa, Clara Rivera, and Ankur Bapna.

</span>
<span class="ltx_bibblock">FLEURS: Few-shot Learning Evaluation of Universal Representations of Speech, May 2022.

</span>
<span class="ltx_bibblock">arXiv:2205.12446 [cs, eess].

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Brian Davis, Bryan Morse, Scott Cohen, Brian Price, and Chris Tensmeyer.

</span>
<span class="ltx_bibblock">Deep Visual Template-Free Form Parsing, September 2019.

</span>
<span class="ltx_bibblock">arXiv:1909.02576 [cs].

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Saket Dingliwal, Ashish Shenoy, Sravan Bodapati, Ankur Gandhe, Ravi Teja Gadde, and Katrin Kirchhoff.

</span>
<span class="ltx_bibblock">Domain Prompts: Towards memory and compute efficient domain adaptation of ASR systems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Interspeech 2022</span>, pages 684–688. ISCA, September 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Danny Driess, Fei Xia, Mehdi S. M. Sajjadi, Corey Lynch, Aakanksha Chowdhery, Brian Ichter, Ayzaan Wahid, Jonathan Tompson, Quan Vuong, Tianhe Yu, Wenlong Huang, Yevgen Chebotar, Pierre Sermanet, Daniel Duckworth, Sergey Levine, Vincent Vanhoucke, Karol Hausman, Marc Toussaint, Klaus Greff, Andy Zeng, Igor Mordatch, and Pete Florence.

</span>
<span class="ltx_bibblock">PaLM-E: An Embodied Multimodal Language Model, March 2023.

</span>
<span class="ltx_bibblock">arXiv:2303.03378 [cs].

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Chenzhuang Du, Jiaye Teng, Tingle Li, Yichen Liu, Tianyuan Yuan, Yue Wang, Yang Yuan, and Hang Zhao.

</span>
<span class="ltx_bibblock">On Uni-Modal Feature Learning in Supervised Multi-Modal Learning, June 2023.

</span>
<span class="ltx_bibblock">arXiv:2305.01233 [cs].

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Yassir Fathullah, Chunyang Wu, Egor Lakomkin, Junteng Jia, Yuan Shangguan, Ke Li, Jinxi Guo, Wenhan Xiong, Jay Mahadeokar, Ozlem Kalinli, Christian Fuegen, and Mike Seltzer.

</span>
<span class="ltx_bibblock">Prompting Large Language Models with Speech Recognition Abilities, July 2023.

</span>
<span class="ltx_bibblock">arXiv:2307.11795 [cs, eess].

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Figure Eight Inc.

</span>
<span class="ltx_bibblock">Medical Speech, Transcription, and Intent, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Yuan Gong, Sameer Khurana, Leonid Karlinsky, and James Glass.

</span>
<span class="ltx_bibblock">Whisper-at: Noise-robust automatic speech recognizers are also strong general audio event taggers.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2307.03183</span>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Caglar Gulcehre, Orhan Firat, Kelvin Xu, Kyunghyun Cho, Loic Barrault, Huei-Chi Lin, Fethi Bougares, Holger Schwenk, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">On Using Monolingual Corpora in Neural Machine Translation, June 2015.

</span>
<span class="ltx_bibblock">arXiv:1503.03535 [cs].

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kyu J. Han, Ramon Prieto, Kaixing Wu, and Tao Ma.

</span>
<span class="ltx_bibblock">State-of-the-Art Speech Recognition Using Multi-Stream Self-Attention With Dilated 1D Convolutions, October 2019.

</span>
<span class="ltx_bibblock">arXiv:1910.00716 [cs, eess].

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Chan-Jan Hsu, Chang-Le Liu, Feng-Ting Liao, Po-Chun Hsu, Yi-Chang Chen, and Da-Shan Shiu.

</span>
<span class="ltx_bibblock">Breeze-7B Technical Report, April 2024.

</span>
<span class="ltx_bibblock">arXiv:2403.02712 [cs].

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Ke Hu, Tara N. Sainath, Ruoming Pang, and Rohit Prabhavalkar.

</span>
<span class="ltx_bibblock">Deliberation Model Based Two-Pass End-to-End Speech Recognition, March 2020.

</span>
<span class="ltx_bibblock">arXiv:2003.07962 [cs, eess].

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Yuchen Hu, Chen Chen, Chao-Han Huck Yang, Ruizhe Li, Chao Zhang, Pin-Yu Chen, and EnSiong Chng.

</span>
<span class="ltx_bibblock">Large Language Models are Efficient Learners of Noise-Robust Speech Recognition, January 2024.

</span>
<span class="ltx_bibblock">arXiv:2401.10446 [cs, eess].

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
W. Ronny Huang, Cyril Allauzen, Tongzhou Chen, Kilol Gupta, Ke Hu, James Qin, Yu Zhang, Yongqiang Wang, Shuo-Yiin Chang, and Tara N. Sainath.

</span>
<span class="ltx_bibblock">Multilingual and Fully Non-Autoregressive ASR with Large Language Model Fusion: A Comprehensive Study, January 2024.

</span>
<span class="ltx_bibblock">arXiv:2401.12789 [cs, eess].

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Albert Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, Lélio Renard Lavaud, Marie-Anne Lachaux, Pierre Stock, Teven Le Scao, Thibaut Lavril, Thomas Wang, Timothée Lacroix, and William El Sayed.

</span>
<span class="ltx_bibblock">Mistral 7B, October 2023.

</span>
<span class="ltx_bibblock">arXiv:2310.06825 [cs].

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Anjuli Kannan, Yonghui Wu, Patrick Nguyen, Tara N. Sainath, Zhifeng Chen, and Rohit Prabhavalkar.

</span>
<span class="ltx_bibblock">An analysis of incorporating an external language model into a sequence-to-sequence model, December 2017.

</span>
<span class="ltx_bibblock">arXiv:1712.01996 [cs, eess].

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Duc Le, Mahaveer Jain, Gil Keren, Suyoun Kim, Yangyang Shi, Jay Mahadeokar, Julian Chan, Yuan Shangguan, Christian Fuegen, Ozlem Kalinli, Yatharth Saraf, and Michael L. Seltzer.

</span>
<span class="ltx_bibblock">Contextualized Streaming End-to-End Speech Recognition with Trie-Based Deep Biasing and Shallow Fusion, June 2021.

</span>
<span class="ltx_bibblock">arXiv:2104.02194 [cs, eess].

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yue-Shi Lee.

</span>
<span class="ltx_bibblock">Task adaptation in stochastic language model for Chinese homophone disambiguation.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">ACM Transactions on Asian Language Information Processing</span>, 2(1):49–62, March 2003.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Yue-Shi Lee and Hsin-Hsi Chen.

</span>
<span class="ltx_bibblock">Applying repair processing in Chinese homophone disambiguation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Proceedings of the fifth conference on Applied natural language processing</span>, ANLC ’97, pages 57–63, USA, March 1997. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Yichong Leng, Xu Tan, Wenjie Liu, Kaitao Song, Rui Wang, Xiang-Yang Li, Tao Qin, Edward Lin, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">SoftCorrect: Error Correction with Soft Detection for Automatic Speech Recognition, December 2023.

</span>
<span class="ltx_bibblock">arXiv:2212.01039 [cs, eess].

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Minghao Li, Tengchao Lv, Jingye Chen, Lei Cui, Yijuan Lu, Dinei Florencio, Cha Zhang, Zhoujun Li, and Furu Wei.

</span>
<span class="ltx_bibblock">TrOCR: Transformer-based Optical Character Recognition with Pre-trained Models, September 2022.

</span>
<span class="ltx_bibblock">arXiv:2109.10282 [cs].

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Yuang Li, Yu Wu, Jinyu Li, and Shujie Liu.

</span>
<span class="ltx_bibblock">Prompting Large Language Models for Zero-Shot Domain Adaptation in Speech Recognition, June 2023.

</span>
<span class="ltx_bibblock">arXiv:2306.16007 [cs, eess].

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Yuang Li, Jiawei Yu, Yanqing Zhao, Min Zhang, Mengxin Ren, Xiaofeng Zhao, Xiaosong Qiao, Chang Su, Miaomiao Ma, and Hao Yang.

</span>
<span class="ltx_bibblock">Using Large Language Model for End-to-End Chinese ASR and NER, January 2024.

</span>
<span class="ltx_bibblock">arXiv:2401.11382 [cs].

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Feng-Ting Liao, Yung-Chieh Chan, Yi-Chang Chen, Chan-Jan Hsu, and Da-shan Shiu.

</span>
<span class="ltx_bibblock">Zero-shot Domain-sensitive Speech Recognition with Prompt-conditioning Fine-tuning, October 2023.

</span>
<span class="ltx_bibblock">arXiv:2307.10274 [cs, eess].

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee.

</span>
<span class="ltx_bibblock">Visual Instruction Tuning, December 2023.

</span>
<span class="ltx_bibblock">arXiv:2304.08485 [cs].

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yuliang Liu, Zhang Li, Biao Yang, Chunyuan Li, Xucheng Yin, Cheng-lin Liu, Lianwen Jin, and Xiang Bai.

</span>
<span class="ltx_bibblock">On the Hidden Mystery of OCR in Large Multimodal Models, January 2024.

</span>
<span class="ltx_bibblock">arXiv:2305.07895 [cs].

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback, March 2022.

</span>
<span class="ltx_bibblock">arXiv:2203.02155 [cs].

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Learning Transferable Visual Models From Natural Language Supervision.

</span>
<span class="ltx_bibblock">page 48.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Tao Xu, Greg Brockman, Christine McLeavey, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Robust Speech Recognition via Large-Scale Weak Supervision, December 2022.

</span>
<span class="ltx_bibblock">arXiv:2212.04356 [cs, eess].

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Srijith Radhakrishnan, Chao-Han Huck Yang, Sumeer Ahmad Khan, Rohit Kumar, Narsis A. Kiani, David Gomez-Cabrero, and Jesper N. Tegner.

</span>
<span class="ltx_bibblock">Whispering LLaMA: A Cross-Modal Generative Error Correction Framework for Speech Recognition, October 2023.

</span>
<span class="ltx_bibblock">arXiv:2310.06434 [cs, eess].

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Scott Reed, Konrad Zolna, Emilio Parisotto, Sergio Gomez Colmenarejo, Alexander Novikov, Gabriel Barth-Maron, Mai Gimenez, Yury Sulsky, Jackie Kay, Jost Tobias Springenberg, Tom Eccles, Jake Bruce, Ali Razavi, Ashley Edwards, Nicolas Heess, Yutian Chen, Raia Hadsell, Oriol Vinyals, Mahyar Bordbar, and Nando de Freitas.

</span>
<span class="ltx_bibblock">A Generalist Agent, May 2022.

</span>
<span class="ltx_bibblock">arXiv:2205.06175 [cs].

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Tara N. Sainath, Ruoming Pang, David Rybach, Yanzhang He, Rohit Prabhavalkar, Wei Li, Mirkó Visontai, Qiao Liang, Trevor Strohman, Yonghui Wu, Ian McGraw, and Chung-Cheng Chiu.

</span>
<span class="ltx_bibblock">Two-Pass End-to-End Speech Recognition, August 2019.

</span>
<span class="ltx_bibblock">arXiv:1908.10992 [cs, eess].

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeff Wu, Daniel M. Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize from human feedback, February 2022.

</span>
<span class="ltx_bibblock">arXiv:2009.01325 [cs].

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Igor Szoke, Santosh Kesiraju, Ondrej Novotny, Martin Kocour, Karel Vesely, and Jan "Honza" Cernocky.

</span>
<span class="ltx_bibblock">Detecting English Speech in the Air Traffic Control Voice Communication, April 2021.

</span>
<span class="ltx_bibblock">arXiv:2104.02332 [eess].

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Liyan Xu, Yile Gu, Jari Kolehmainen, Haidar Khan, Ankur Gandhe, Ariya Rastrow, Andreas Stolcke, and Ivan Bulyko.

</span>
<span class="ltx_bibblock">RescoreBERT: Discriminative Speech Recognition Rescoring with BERT.

</span>
<span class="ltx_bibblock">In <span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">ICASSP 2022 - 2022 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</span>, pages 6117–6121, May 2022.

</span>
<span class="ltx_bibblock">arXiv:2202.01094 [cs, eess].

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Chao-Han Huck Yang, Yile Gu, Yi-Chieh Liu, Shalini Ghosh, Ivan Bulyko, and Andreas Stolcke.

</span>
<span class="ltx_bibblock">Generative Speech Recognition Error Correction with Large Language Models and Task-Activating Prompting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</span>, pages 1–8, December 2023.

</span>
<span class="ltx_bibblock">arXiv:2309.15649 [cs, eess].

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Chao-Han Huck Yang, Yile Gu, Yi-Chieh Liu, Shalini Ghosh, Ivan Bulyko, and Andreas Stolcke.

</span>
<span class="ltx_bibblock">Generative speech recognition error correction with large language models and task-activating prompting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</span>. IEEE, December 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Chih-Kai Yang, Kuan-Po Huang, Ke-Han Lu, Chun-Yi Kuan, Chi-Yuan Hsiao, and Hung-yi Lee.

</span>
<span class="ltx_bibblock">Investigating Zero-Shot Generalizability on Mandarin-English Code-Switched ASR and Speech-to-text Translation of Recent Foundation Models with Self-Supervision and Weak Supervision, December 2023.

</span>
<span class="ltx_bibblock">arXiv:2401.00273 [cs, eess].

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Sherry Yang, Ofir Nachum, Yilun Du, Jason Wei, Pieter Abbeel, and Dale Schuurmans.

</span>
<span class="ltx_bibblock">Foundation Models for Decision Making: Problems, Methods, and Opportunities, March 2023.

</span>
<span class="ltx_bibblock">arXiv:2303.04129 [cs].

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Yu Yu, Chao-Han Huck Yang, Jari Kolehmainen, Prashanth G. Shivakumar, Yile Gu, Sungho Ryu, Roger Ren, Qi Luo, Aditya Gourav, I.-Fan Chen, Yi-Chieh Liu, Tuan Dinh, Ankur Gandhe, Denis Filimonov, Shalini Ghosh, Andreas Stolcke, Ariya Rastow, and Ivan Bulyko.

</span>
<span class="ltx_bibblock">Low-rank Adaptation of Large Language Model Rescoring for Parameter-Efficient Speech Recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</span>, pages 1–8, December 2023.

</span>
<span class="ltx_bibblock">arXiv:2309.15223 [cs, eess].

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Qingyang Zhang, Haitao Wu, Changqing Zhang, Qinghua Hu, Huazhu Fu, Joey Tianyi Zhou, and Xi Peng.

</span>
<span class="ltx_bibblock">Provable Dynamic Fusion for Low-Quality Multimodal Data, June 2023.

</span>
<span class="ltx_bibblock">arXiv:2306.02050 [cs].

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.14258" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.14259" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.14259">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.14259" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.14260" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 17:24:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
