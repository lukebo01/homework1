<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.13344] Contextualized Automatic Speech Recognition with Dynamic Vocabulary</title><meta property="og:description" content="Deep biasing (DB) improves the performance of end-to-end automatic speech recognition (E2E-ASR) for rare words or contextual phrases using a bias list. However, most existing methods treat bias phrases as sequences of …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Contextualized Automatic Speech Recognition with Dynamic Vocabulary">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Contextualized Automatic Speech Recognition with Dynamic Vocabulary">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.13344">

<!--Generated on Wed Jun  5 18:58:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">[affiliation=1]YuiSudo
<span id="p1.3.1" class="ltx_ERROR undefined">\name</span>[affiliation=1]YosukeFukumoto
<span id="p1.3.2" class="ltx_ERROR undefined">\name</span>[affiliation=1]MuhammadShakeel
<span id="p1.3.3" class="ltx_ERROR undefined">\name</span>[affiliation=2]YifanPeng
<span id="p1.3.4" class="ltx_ERROR undefined">\name</span>[affiliation=2]ShinjiWatanabe</p>
</div>
<h1 class="ltx_title ltx_title_document">Contextualized Automatic Speech Recognition with Dynamic Vocabulary</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Deep biasing (DB) improves the performance of end-to-end automatic speech recognition (E2E-ASR) for rare words or contextual phrases using a bias list. However, most existing methods treat bias phrases as sequences of subwords in a predefined static vocabulary, which can result in ineffective learning of the dependencies between subwords. More advanced techniques address this problem by incorporating additional text data, which increases the overall workload. This paper proposes a dynamic vocabulary where phrase-level bias tokens can be added during the inference phase. Each bias token represents an entire bias phrase within a single token, thereby eliminating the need to learn the dependencies between the subwords within the bias phrases. This method can be applied to various architectures because it only extends the embedding and output layers in common E2E-ASR architectures. Experimental results demonstrate that the proposed method improves the performance of bias phrases on English and Japanese datasets.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>speech recognition, contextualization, biasing, dynamic vocabulary
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">End-to-end automatic speech recognition (E2E-ASR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>methods convert acoustic feature sequences directly to token sequences without requiring the components used in conventional ASR systems, e.g., acoustic models and language models (LM).
Various E2E-ASR methods have been proposed, including connectionist temporal classification (CTC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, recurrent neural network transducer (RNN-T) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and their hybrids <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
However, the effectiveness of E2E-ASR models is strongly dependent on the context of the training data, which can result in performance inconsistencies for specific user contexts.
However, retraining models for every possible context is infeasible, which highlights the need for a method that allows users and developers to contextualize the model efficiently without additional training process.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To address the challenge of contextualization in ASR, a common strategy is shallow fusion with an external LM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>,
which frequently involves using a weighted finite state transducer (WFST) to create a specialized in-class LM that improves the recognition of the target named entities.
In addition, neural LM fusion methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> attempt to improve accuracy by integrating an external neural LM with an E2E-ASR system. This integration involves rescoring the output hypotheses of the E2E-ASR model; however, integrating an external LM requires additional training, which increases the overall complexity.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Deep biasing (DB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> provides an efficient strategy for contextualizing E2E-ASR models without additional retraining processes. This approach uses an editable list of phrases, referred to as a bias list, to tailor the E2E-ASR model to specific contexts.
A key feature of many DB techniques is the use of a cross-attention layer to ensure accurate recognition of bias phrases.
To improve the effectiveness of this layer, previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> have introduced an auxiliary loss function specifically for bias phrase detection. This function facilitates the optimization of the parameters of the cross-attention layer through multitask learning.
However, these modules are tightly integrated into individual architectures, making their application to other architectures complex, and multitask learning requires multiple experimental training phases to fine-tune the learning weights, which is a time-consuming process.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In addition, most existing techniques process bias phrases as sequences of subwords in a predefined static vocabulary, which can lead to inadequate learning of the dependencies between the subwords, especially for rare phrases. For example, the personal name ``<span id="S1.p4.1.1" class="ltx_text ltx_font_italic">Nelly</span>'' might be segmented into a subword sequence, e.g., ``<span id="S1.p4.1.2" class="ltx_text ltx_font_italic">N</span>'', ``<span id="S1.p4.1.3" class="ltx_text ltx_font_italic">el</span>'', ``<span id="S1.p4.1.4" class="ltx_text ltx_font_italic">ly</span>''. However, this approach frequently fails to capture the dependencies between these subwords. To address this problem, prefix tree-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> have been proposed to efficiently organize bias phrases with common prefixes into a tree structure to manage large bias lists effectively. This tree structure is relatively lightweight to create; however, it requires additional processing.
Advanced strategies have incorporated additional text data during training to improve the handling of large bias lists.
For example, previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> have demonstrated significant performance improvements in terms of bias phrase recognition by training an LM or text encoder using additional text data.
However, this technique can increase the workload considerably, and in some cases the acquisition of additional data may be infeasible.
Other attempts have been proposed to improve contextualization using extra information, such as phonemes for the bias phrases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, named entity tags <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, and synthesized speech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>; however, these strategies also increase the workload.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">This paper proposes a simple but effective deep biasing method by introducing a dynamic vocabulary where phrase-level bias tokens can be added during the inference phase.
Each bias token represents an entire bias phrase within a single token, thereby bypassing the complex process of learning subword dependencies within the bias phrases.
This approach allows for effective biasing without relying on additional resources such as text data and tree structures, unlike the previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
In addition, the proposed bias tokens are integrated seamlessly with the conventional tokens in the embedding and output layers, which eliminates the need for auxiliary losses, unlike the previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.
Furthermore, unlike the previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, the proposed method can be applied to various architectures because it only extends the embedding and output layers of the common E2E-ASR models.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>End-to-end ASR</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">This section describes an attention-based E2E-ASR system, which is extended to the proposed method.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Audio encoder</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.5" class="ltx_p">The audio encoder comprises two convolutional layers, a linear projection layer, and <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="M_{\text{a}}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">M</mi><mtext id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3a.cmml">a</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝑀</ci><ci id="S2.SS1.p1.1.m1.1.1.3a.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">a</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">M_{\text{a}}</annotation></semantics></math> Conformer blocks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
The Conformer encoder transforms an audio feature sequence <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{X}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\bm{X}</annotation></semantics></math> to a <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">T</annotation></semantics></math> length hidden state vector sequence <math id="S2.SS1.p1.4.m4.3" class="ltx_Math" alttext="\bm{H}=[\bm{h}_{1},...,\bm{h}_{T}]\in\mathbb{R}^{d\times T}" display="inline"><semantics id="S2.SS1.p1.4.m4.3a"><mrow id="S2.SS1.p1.4.m4.3.3" xref="S2.SS1.p1.4.m4.3.3.cmml"><mi id="S2.SS1.p1.4.m4.3.3.4" xref="S2.SS1.p1.4.m4.3.3.4.cmml">𝑯</mi><mo id="S2.SS1.p1.4.m4.3.3.5" xref="S2.SS1.p1.4.m4.3.3.5.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.3.3.2.2" xref="S2.SS1.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.3.3.2.2.3" xref="S2.SS1.p1.4.m4.3.3.2.3.cmml">[</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">𝒉</mi><mn id="S2.SS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.4.m4.3.3.2.2.4" xref="S2.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p1.4.m4.3.3.2.2.5" xref="S2.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS1.p1.4.m4.3.3.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.4.m4.3.3.2.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml">𝒉</mi><mi id="S2.SS1.p1.4.m4.3.3.2.2.2.3" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.3.3.2.2.6" xref="S2.SS1.p1.4.m4.3.3.2.3.cmml">]</mo></mrow><mo id="S2.SS1.p1.4.m4.3.3.6" xref="S2.SS1.p1.4.m4.3.3.6.cmml">∈</mo><msup id="S2.SS1.p1.4.m4.3.3.7" xref="S2.SS1.p1.4.m4.3.3.7.cmml"><mi id="S2.SS1.p1.4.m4.3.3.7.2" xref="S2.SS1.p1.4.m4.3.3.7.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.4.m4.3.3.7.3" xref="S2.SS1.p1.4.m4.3.3.7.3.cmml"><mi id="S2.SS1.p1.4.m4.3.3.7.3.2" xref="S2.SS1.p1.4.m4.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p1.4.m4.3.3.7.3.1" xref="S2.SS1.p1.4.m4.3.3.7.3.1.cmml">×</mo><mi id="S2.SS1.p1.4.m4.3.3.7.3.3" xref="S2.SS1.p1.4.m4.3.3.7.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.3b"><apply id="S2.SS1.p1.4.m4.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3"><and id="S2.SS1.p1.4.m4.3.3a.cmml" xref="S2.SS1.p1.4.m4.3.3"></and><apply id="S2.SS1.p1.4.m4.3.3b.cmml" xref="S2.SS1.p1.4.m4.3.3"><eq id="S2.SS1.p1.4.m4.3.3.5.cmml" xref="S2.SS1.p1.4.m4.3.3.5"></eq><ci id="S2.SS1.p1.4.m4.3.3.4.cmml" xref="S2.SS1.p1.4.m4.3.3.4">𝑯</ci><list id="S2.SS1.p1.4.m4.3.3.2.3.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2"><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2">𝒉</ci><cn type="integer" id="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">…</ci><apply id="S2.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2">𝒉</ci><ci id="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3">𝑇</ci></apply></list></apply><apply id="S2.SS1.p1.4.m4.3.3c.cmml" xref="S2.SS1.p1.4.m4.3.3"><in id="S2.SS1.p1.4.m4.3.3.6.cmml" xref="S2.SS1.p1.4.m4.3.3.6"></in><share href="#S2.SS1.p1.4.m4.3.3.2.cmml" id="S2.SS1.p1.4.m4.3.3d.cmml" xref="S2.SS1.p1.4.m4.3.3"></share><apply id="S2.SS1.p1.4.m4.3.3.7.cmml" xref="S2.SS1.p1.4.m4.3.3.7"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.7.1.cmml" xref="S2.SS1.p1.4.m4.3.3.7">superscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.7.2.cmml" xref="S2.SS1.p1.4.m4.3.3.7.2">ℝ</ci><apply id="S2.SS1.p1.4.m4.3.3.7.3.cmml" xref="S2.SS1.p1.4.m4.3.3.7.3"><times id="S2.SS1.p1.4.m4.3.3.7.3.1.cmml" xref="S2.SS1.p1.4.m4.3.3.7.3.1"></times><ci id="S2.SS1.p1.4.m4.3.3.7.3.2.cmml" xref="S2.SS1.p1.4.m4.3.3.7.3.2">𝑑</ci><ci id="S2.SS1.p1.4.m4.3.3.7.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3.7.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.3c">\bm{H}=[\bm{h}_{1},...,\bm{h}_{T}]\in\mathbb{R}^{d\times T}</annotation></semantics></math> where <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">d</annotation></semantics></math> represents the dimension:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\bm{H}=\mathrm{AudioEnc}(\bm{X})." display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml">𝑯</mi><mo id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml"><mi id="S2.E1.m1.2.2.1.1.3.2" xref="S2.E1.m1.2.2.1.1.3.2.cmml">AudioEnc</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.3.1" xref="S2.E1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.3.3.2" xref="S2.E1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.3.3.2.1" xref="S2.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝑿</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.1.3.3.2.2" xref="S2.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"></eq><ci id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2">𝑯</ci><apply id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"><times id="S2.E1.m1.2.2.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.3.1"></times><ci id="S2.E1.m1.2.2.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.3.2">AudioEnc</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\bm{H}=\mathrm{AudioEnc}(\bm{X}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Decoder</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.3" class="ltx_p">Given <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\bm{H}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\bm{H}</annotation></semantics></math> generated by the audio encoder in Eq. (<a href="#S2.E1" title="In 2.1 Audio encoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and the previously estimated token sequence <math id="S2.SS2.p1.2.m2.3" class="ltx_Math" alttext="y_{0:s-1}=[y_{0},...,y_{s-1}]" display="inline"><semantics id="S2.SS2.p1.2.m2.3a"><mrow id="S2.SS2.p1.2.m2.3.3" xref="S2.SS2.p1.2.m2.3.3.cmml"><msub id="S2.SS2.p1.2.m2.3.3.4" xref="S2.SS2.p1.2.m2.3.3.4.cmml"><mi id="S2.SS2.p1.2.m2.3.3.4.2" xref="S2.SS2.p1.2.m2.3.3.4.2.cmml">y</mi><mrow id="S2.SS2.p1.2.m2.3.3.4.3" xref="S2.SS2.p1.2.m2.3.3.4.3.cmml"><mn id="S2.SS2.p1.2.m2.3.3.4.3.2" xref="S2.SS2.p1.2.m2.3.3.4.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p1.2.m2.3.3.4.3.1" xref="S2.SS2.p1.2.m2.3.3.4.3.1.cmml">:</mo><mrow id="S2.SS2.p1.2.m2.3.3.4.3.3" xref="S2.SS2.p1.2.m2.3.3.4.3.3.cmml"><mi id="S2.SS2.p1.2.m2.3.3.4.3.3.2" xref="S2.SS2.p1.2.m2.3.3.4.3.3.2.cmml">s</mi><mo id="S2.SS2.p1.2.m2.3.3.4.3.3.1" xref="S2.SS2.p1.2.m2.3.3.4.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.2.m2.3.3.4.3.3.3" xref="S2.SS2.p1.2.m2.3.3.4.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.SS2.p1.2.m2.3.3.3" xref="S2.SS2.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.2.m2.3.3.2.2" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.2.m2.3.3.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p1.2.m2.2.2.1.1.1" xref="S2.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.2.2.1.1.1.2" xref="S2.SS2.p1.2.m2.2.2.1.1.1.2.cmml">y</mi><mn id="S2.SS2.p1.2.m2.2.2.1.1.1.3" xref="S2.SS2.p1.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p1.2.m2.3.3.2.2.4" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS2.p1.2.m2.3.3.2.2.5" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.2.m2.3.3.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml">y</mi><mrow id="S2.SS2.p1.2.m2.3.3.2.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.3.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.2.cmml">s</mi><mo id="S2.SS2.p1.2.m2.3.3.2.2.2.3.1" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.2.m2.3.3.2.2.2.3.3" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS2.p1.2.m2.3.3.2.2.6" xref="S2.SS2.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.3b"><apply id="S2.SS2.p1.2.m2.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3"><eq id="S2.SS2.p1.2.m2.3.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3.3"></eq><apply id="S2.SS2.p1.2.m2.3.3.4.cmml" xref="S2.SS2.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.4.1.cmml" xref="S2.SS2.p1.2.m2.3.3.4">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.4.2.cmml" xref="S2.SS2.p1.2.m2.3.3.4.2">𝑦</ci><apply id="S2.SS2.p1.2.m2.3.3.4.3.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3"><ci id="S2.SS2.p1.2.m2.3.3.4.3.1.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.1">:</ci><cn type="integer" id="S2.SS2.p1.2.m2.3.3.4.3.2.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.2">0</cn><apply id="S2.SS2.p1.2.m2.3.3.4.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.3"><minus id="S2.SS2.p1.2.m2.3.3.4.3.3.1.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.3.1"></minus><ci id="S2.SS2.p1.2.m2.3.3.4.3.3.2.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.2.m2.3.3.4.3.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3.3.3">1</cn></apply></apply></apply><list id="S2.SS2.p1.2.m2.3.3.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2"><apply id="S2.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.3">0</cn></apply><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">…</ci><apply id="S2.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2">𝑦</ci><apply id="S2.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3"><minus id="S2.SS2.p1.2.m2.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.1"></minus><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.2.m2.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.3c">y_{0:s-1}=[y_{0},...,y_{s-1}]</annotation></semantics></math>,
the decoder estimates the next token <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="y_{s}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">y</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑦</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">y_{s}</annotation></semantics></math> recursively as follows:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="P(y_{s}|y_{0:s-1},\bm{X})=\mathrm{Decoder}(y_{0:s-1},\bm{H})," display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝑿</mi></mrow></mrow><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.2.3" xref="S2.E2.m1.3.3.1.1.2.3.cmml">Decoder</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.2.2" xref="S2.E2.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.2.1.1" xref="S2.E2.m1.3.3.1.1.2.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.1.1.2" xref="S2.E2.m1.3.3.1.1.2.1.2.cmml">(</mo><msub id="S2.E2.m1.3.3.1.1.2.1.1.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.2.1.1.1.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.2.cmml">y</mi><mrow id="S2.E2.m1.3.3.1.1.2.1.1.1.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.cmml"><mn id="S2.E2.m1.3.3.1.1.2.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.3.3.1.1.2.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.1.cmml">:</mo><mrow id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.cmml"><mi id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E2.m1.3.3.1.1.2.1.1.3" xref="S2.E2.m1.3.3.1.1.2.1.2.cmml">,</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">𝑯</mi><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.1.1.4" xref="S2.E2.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"></eq><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><ci id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3">𝑃</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">0</cn><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑿</ci></list></apply></apply><apply id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"><times id="S2.E2.m1.3.3.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2"></times><ci id="S2.E2.m1.3.3.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.3">Decoder</ci><interval closure="open" id="S2.E2.m1.3.3.1.1.2.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1"><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.2">𝑦</ci><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3"><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.1">:</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.2">0</cn><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3"><minus id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.1"></minus><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝑯</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">P(y_{s}|y_{0:s-1},\bm{X})=\mathrm{Decoder}(y_{0:s-1},\bm{H}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.14" class="ltx_p">where <math id="S2.SS2.p1.4.m1.1" class="ltx_Math" alttext="y_{s}" display="inline"><semantics id="S2.SS2.p1.4.m1.1a"><msub id="S2.SS2.p1.4.m1.1.1" xref="S2.SS2.p1.4.m1.1.1.cmml"><mi id="S2.SS2.p1.4.m1.1.1.2" xref="S2.SS2.p1.4.m1.1.1.2.cmml">y</mi><mi id="S2.SS2.p1.4.m1.1.1.3" xref="S2.SS2.p1.4.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m1.1b"><apply id="S2.SS2.p1.4.m1.1.1.cmml" xref="S2.SS2.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m1.1.1.1.cmml" xref="S2.SS2.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m1.1.1.2.cmml" xref="S2.SS2.p1.4.m1.1.1.2">𝑦</ci><ci id="S2.SS2.p1.4.m1.1.1.3.cmml" xref="S2.SS2.p1.4.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m1.1c">y_{s}</annotation></semantics></math> is the <math id="S2.SS2.p1.5.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.5.m2.1a"><mi id="S2.SS2.p1.5.m2.1.1" xref="S2.SS2.p1.5.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m2.1b"><ci id="S2.SS2.p1.5.m2.1.1.cmml" xref="S2.SS2.p1.5.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m2.1c">s</annotation></semantics></math>-th subword-level token in the pre-defined static vocabulary <math id="S2.SS2.p1.6.m3.1" class="ltx_Math" alttext="\mathcal{V}^{\text{n}}" display="inline"><semantics id="S2.SS2.p1.6.m3.1a"><msup id="S2.SS2.p1.6.m3.1.1" xref="S2.SS2.p1.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.m3.1.1.2" xref="S2.SS2.p1.6.m3.1.1.2.cmml">𝒱</mi><mtext id="S2.SS2.p1.6.m3.1.1.3" xref="S2.SS2.p1.6.m3.1.1.3a.cmml">n</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m3.1b"><apply id="S2.SS2.p1.6.m3.1.1.cmml" xref="S2.SS2.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m3.1.1.1.cmml" xref="S2.SS2.p1.6.m3.1.1">superscript</csymbol><ci id="S2.SS2.p1.6.m3.1.1.2.cmml" xref="S2.SS2.p1.6.m3.1.1.2">𝒱</ci><ci id="S2.SS2.p1.6.m3.1.1.3a.cmml" xref="S2.SS2.p1.6.m3.1.1.3"><mtext mathsize="70%" id="S2.SS2.p1.6.m3.1.1.3.cmml" xref="S2.SS2.p1.6.m3.1.1.3">n</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m3.1c">\mathcal{V}^{\text{n}}</annotation></semantics></math> of size <math id="S2.SS2.p1.7.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p1.7.m4.1a"><mi id="S2.SS2.p1.7.m4.1.1" xref="S2.SS2.p1.7.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m4.1b"><ci id="S2.SS2.p1.7.m4.1.1.cmml" xref="S2.SS2.p1.7.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m4.1c">K</annotation></semantics></math> (<math id="S2.SS2.p1.8.m5.1" class="ltx_Math" alttext="y_{s}\in\mathcal{V}^{\text{n}}" display="inline"><semantics id="S2.SS2.p1.8.m5.1a"><mrow id="S2.SS2.p1.8.m5.1.1" xref="S2.SS2.p1.8.m5.1.1.cmml"><msub id="S2.SS2.p1.8.m5.1.1.2" xref="S2.SS2.p1.8.m5.1.1.2.cmml"><mi id="S2.SS2.p1.8.m5.1.1.2.2" xref="S2.SS2.p1.8.m5.1.1.2.2.cmml">y</mi><mi id="S2.SS2.p1.8.m5.1.1.2.3" xref="S2.SS2.p1.8.m5.1.1.2.3.cmml">s</mi></msub><mo id="S2.SS2.p1.8.m5.1.1.1" xref="S2.SS2.p1.8.m5.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.8.m5.1.1.3" xref="S2.SS2.p1.8.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m5.1.1.3.2" xref="S2.SS2.p1.8.m5.1.1.3.2.cmml">𝒱</mi><mtext id="S2.SS2.p1.8.m5.1.1.3.3" xref="S2.SS2.p1.8.m5.1.1.3.3a.cmml">n</mtext></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m5.1b"><apply id="S2.SS2.p1.8.m5.1.1.cmml" xref="S2.SS2.p1.8.m5.1.1"><in id="S2.SS2.p1.8.m5.1.1.1.cmml" xref="S2.SS2.p1.8.m5.1.1.1"></in><apply id="S2.SS2.p1.8.m5.1.1.2.cmml" xref="S2.SS2.p1.8.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m5.1.1.2.1.cmml" xref="S2.SS2.p1.8.m5.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.8.m5.1.1.2.2.cmml" xref="S2.SS2.p1.8.m5.1.1.2.2">𝑦</ci><ci id="S2.SS2.p1.8.m5.1.1.2.3.cmml" xref="S2.SS2.p1.8.m5.1.1.2.3">𝑠</ci></apply><apply id="S2.SS2.p1.8.m5.1.1.3.cmml" xref="S2.SS2.p1.8.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m5.1.1.3.1.cmml" xref="S2.SS2.p1.8.m5.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.8.m5.1.1.3.2.cmml" xref="S2.SS2.p1.8.m5.1.1.3.2">𝒱</ci><ci id="S2.SS2.p1.8.m5.1.1.3.3a.cmml" xref="S2.SS2.p1.8.m5.1.1.3.3"><mtext mathsize="70%" id="S2.SS2.p1.8.m5.1.1.3.3.cmml" xref="S2.SS2.p1.8.m5.1.1.3.3">n</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m5.1c">y_{s}\in\mathcal{V}^{\text{n}}</annotation></semantics></math>).
Here, <math id="S2.SS2.p1.9.m6.1" class="ltx_Math" alttext="y_{0}" display="inline"><semantics id="S2.SS2.p1.9.m6.1a"><msub id="S2.SS2.p1.9.m6.1.1" xref="S2.SS2.p1.9.m6.1.1.cmml"><mi id="S2.SS2.p1.9.m6.1.1.2" xref="S2.SS2.p1.9.m6.1.1.2.cmml">y</mi><mn id="S2.SS2.p1.9.m6.1.1.3" xref="S2.SS2.p1.9.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m6.1b"><apply id="S2.SS2.p1.9.m6.1.1.cmml" xref="S2.SS2.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m6.1.1.1.cmml" xref="S2.SS2.p1.9.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.m6.1.1.2.cmml" xref="S2.SS2.p1.9.m6.1.1.2">𝑦</ci><cn type="integer" id="S2.SS2.p1.9.m6.1.1.3.cmml" xref="S2.SS2.p1.9.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m6.1c">y_{0}</annotation></semantics></math> represents the <math id="S2.SS2.p1.10.m7.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S2.SS2.p1.10.m7.1a"><mo id="S2.SS2.p1.10.m7.1.1" xref="S2.SS2.p1.10.m7.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m7.1b"><lt id="S2.SS2.p1.10.m7.1.1.cmml" xref="S2.SS2.p1.10.m7.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m7.1c">&lt;</annotation></semantics></math>sos<math id="S2.SS2.p1.11.m8.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S2.SS2.p1.11.m8.1a"><mo id="S2.SS2.p1.11.m8.1.1" xref="S2.SS2.p1.11.m8.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m8.1b"><gt id="S2.SS2.p1.11.m8.1.1.cmml" xref="S2.SS2.p1.11.m8.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m8.1c">&gt;</annotation></semantics></math> token.
Specifically, the decoder comprises an embedding layer, <math id="S2.SS2.p1.12.m9.1" class="ltx_Math" alttext="M_{d}" display="inline"><semantics id="S2.SS2.p1.12.m9.1a"><msub id="S2.SS2.p1.12.m9.1.1" xref="S2.SS2.p1.12.m9.1.1.cmml"><mi id="S2.SS2.p1.12.m9.1.1.2" xref="S2.SS2.p1.12.m9.1.1.2.cmml">M</mi><mi id="S2.SS2.p1.12.m9.1.1.3" xref="S2.SS2.p1.12.m9.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m9.1b"><apply id="S2.SS2.p1.12.m9.1.1.cmml" xref="S2.SS2.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m9.1.1.1.cmml" xref="S2.SS2.p1.12.m9.1.1">subscript</csymbol><ci id="S2.SS2.p1.12.m9.1.1.2.cmml" xref="S2.SS2.p1.12.m9.1.1.2">𝑀</ci><ci id="S2.SS2.p1.12.m9.1.1.3.cmml" xref="S2.SS2.p1.12.m9.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m9.1c">M_{d}</annotation></semantics></math> transformer blocks, and an output layer.
First, the embedding layer with positional encoding converts the input token sequence <math id="S2.SS2.p1.13.m10.1" class="ltx_Math" alttext="y_{0:s-1}" display="inline"><semantics id="S2.SS2.p1.13.m10.1a"><msub id="S2.SS2.p1.13.m10.1.1" xref="S2.SS2.p1.13.m10.1.1.cmml"><mi id="S2.SS2.p1.13.m10.1.1.2" xref="S2.SS2.p1.13.m10.1.1.2.cmml">y</mi><mrow id="S2.SS2.p1.13.m10.1.1.3" xref="S2.SS2.p1.13.m10.1.1.3.cmml"><mn id="S2.SS2.p1.13.m10.1.1.3.2" xref="S2.SS2.p1.13.m10.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p1.13.m10.1.1.3.1" xref="S2.SS2.p1.13.m10.1.1.3.1.cmml">:</mo><mrow id="S2.SS2.p1.13.m10.1.1.3.3" xref="S2.SS2.p1.13.m10.1.1.3.3.cmml"><mi id="S2.SS2.p1.13.m10.1.1.3.3.2" xref="S2.SS2.p1.13.m10.1.1.3.3.2.cmml">s</mi><mo id="S2.SS2.p1.13.m10.1.1.3.3.1" xref="S2.SS2.p1.13.m10.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.13.m10.1.1.3.3.3" xref="S2.SS2.p1.13.m10.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m10.1b"><apply id="S2.SS2.p1.13.m10.1.1.cmml" xref="S2.SS2.p1.13.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m10.1.1.1.cmml" xref="S2.SS2.p1.13.m10.1.1">subscript</csymbol><ci id="S2.SS2.p1.13.m10.1.1.2.cmml" xref="S2.SS2.p1.13.m10.1.1.2">𝑦</ci><apply id="S2.SS2.p1.13.m10.1.1.3.cmml" xref="S2.SS2.p1.13.m10.1.1.3"><ci id="S2.SS2.p1.13.m10.1.1.3.1.cmml" xref="S2.SS2.p1.13.m10.1.1.3.1">:</ci><cn type="integer" id="S2.SS2.p1.13.m10.1.1.3.2.cmml" xref="S2.SS2.p1.13.m10.1.1.3.2">0</cn><apply id="S2.SS2.p1.13.m10.1.1.3.3.cmml" xref="S2.SS2.p1.13.m10.1.1.3.3"><minus id="S2.SS2.p1.13.m10.1.1.3.3.1.cmml" xref="S2.SS2.p1.13.m10.1.1.3.3.1"></minus><ci id="S2.SS2.p1.13.m10.1.1.3.3.2.cmml" xref="S2.SS2.p1.13.m10.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.13.m10.1.1.3.3.3.cmml" xref="S2.SS2.p1.13.m10.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m10.1c">y_{0:s-1}</annotation></semantics></math> to an embedding vector sequence <math id="S2.SS2.p1.14.m11.3" class="ltx_Math" alttext="\bm{E}_{0:s-1}=[\bm{e}_{0},...,\bm{e}_{s-1}]\in\mathbb{R}^{d\times s}" display="inline"><semantics id="S2.SS2.p1.14.m11.3a"><mrow id="S2.SS2.p1.14.m11.3.3" xref="S2.SS2.p1.14.m11.3.3.cmml"><msub id="S2.SS2.p1.14.m11.3.3.4" xref="S2.SS2.p1.14.m11.3.3.4.cmml"><mi id="S2.SS2.p1.14.m11.3.3.4.2" xref="S2.SS2.p1.14.m11.3.3.4.2.cmml">𝑬</mi><mrow id="S2.SS2.p1.14.m11.3.3.4.3" xref="S2.SS2.p1.14.m11.3.3.4.3.cmml"><mn id="S2.SS2.p1.14.m11.3.3.4.3.2" xref="S2.SS2.p1.14.m11.3.3.4.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p1.14.m11.3.3.4.3.1" xref="S2.SS2.p1.14.m11.3.3.4.3.1.cmml">:</mo><mrow id="S2.SS2.p1.14.m11.3.3.4.3.3" xref="S2.SS2.p1.14.m11.3.3.4.3.3.cmml"><mi id="S2.SS2.p1.14.m11.3.3.4.3.3.2" xref="S2.SS2.p1.14.m11.3.3.4.3.3.2.cmml">s</mi><mo id="S2.SS2.p1.14.m11.3.3.4.3.3.1" xref="S2.SS2.p1.14.m11.3.3.4.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.14.m11.3.3.4.3.3.3" xref="S2.SS2.p1.14.m11.3.3.4.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.SS2.p1.14.m11.3.3.5" xref="S2.SS2.p1.14.m11.3.3.5.cmml">=</mo><mrow id="S2.SS2.p1.14.m11.3.3.2.2" xref="S2.SS2.p1.14.m11.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.14.m11.3.3.2.2.3" xref="S2.SS2.p1.14.m11.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p1.14.m11.2.2.1.1.1" xref="S2.SS2.p1.14.m11.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.14.m11.2.2.1.1.1.2" xref="S2.SS2.p1.14.m11.2.2.1.1.1.2.cmml">𝒆</mi><mn id="S2.SS2.p1.14.m11.2.2.1.1.1.3" xref="S2.SS2.p1.14.m11.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p1.14.m11.3.3.2.2.4" xref="S2.SS2.p1.14.m11.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.14.m11.1.1" xref="S2.SS2.p1.14.m11.1.1.cmml">…</mi><mo id="S2.SS2.p1.14.m11.3.3.2.2.5" xref="S2.SS2.p1.14.m11.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.14.m11.3.3.2.2.2" xref="S2.SS2.p1.14.m11.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.14.m11.3.3.2.2.2.2" xref="S2.SS2.p1.14.m11.3.3.2.2.2.2.cmml">𝒆</mi><mrow id="S2.SS2.p1.14.m11.3.3.2.2.2.3" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p1.14.m11.3.3.2.2.2.3.2" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.2.cmml">s</mi><mo id="S2.SS2.p1.14.m11.3.3.2.2.2.3.1" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.14.m11.3.3.2.2.2.3.3" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS2.p1.14.m11.3.3.2.2.6" xref="S2.SS2.p1.14.m11.3.3.2.3.cmml">]</mo></mrow><mo id="S2.SS2.p1.14.m11.3.3.6" xref="S2.SS2.p1.14.m11.3.3.6.cmml">∈</mo><msup id="S2.SS2.p1.14.m11.3.3.7" xref="S2.SS2.p1.14.m11.3.3.7.cmml"><mi id="S2.SS2.p1.14.m11.3.3.7.2" xref="S2.SS2.p1.14.m11.3.3.7.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.14.m11.3.3.7.3" xref="S2.SS2.p1.14.m11.3.3.7.3.cmml"><mi id="S2.SS2.p1.14.m11.3.3.7.3.2" xref="S2.SS2.p1.14.m11.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p1.14.m11.3.3.7.3.1" xref="S2.SS2.p1.14.m11.3.3.7.3.1.cmml">×</mo><mi id="S2.SS2.p1.14.m11.3.3.7.3.3" xref="S2.SS2.p1.14.m11.3.3.7.3.3.cmml">s</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m11.3b"><apply id="S2.SS2.p1.14.m11.3.3.cmml" xref="S2.SS2.p1.14.m11.3.3"><and id="S2.SS2.p1.14.m11.3.3a.cmml" xref="S2.SS2.p1.14.m11.3.3"></and><apply id="S2.SS2.p1.14.m11.3.3b.cmml" xref="S2.SS2.p1.14.m11.3.3"><eq id="S2.SS2.p1.14.m11.3.3.5.cmml" xref="S2.SS2.p1.14.m11.3.3.5"></eq><apply id="S2.SS2.p1.14.m11.3.3.4.cmml" xref="S2.SS2.p1.14.m11.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m11.3.3.4.1.cmml" xref="S2.SS2.p1.14.m11.3.3.4">subscript</csymbol><ci id="S2.SS2.p1.14.m11.3.3.4.2.cmml" xref="S2.SS2.p1.14.m11.3.3.4.2">𝑬</ci><apply id="S2.SS2.p1.14.m11.3.3.4.3.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3"><ci id="S2.SS2.p1.14.m11.3.3.4.3.1.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.1">:</ci><cn type="integer" id="S2.SS2.p1.14.m11.3.3.4.3.2.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.2">0</cn><apply id="S2.SS2.p1.14.m11.3.3.4.3.3.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.3"><minus id="S2.SS2.p1.14.m11.3.3.4.3.3.1.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.3.1"></minus><ci id="S2.SS2.p1.14.m11.3.3.4.3.3.2.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.14.m11.3.3.4.3.3.3.cmml" xref="S2.SS2.p1.14.m11.3.3.4.3.3.3">1</cn></apply></apply></apply><list id="S2.SS2.p1.14.m11.3.3.2.3.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2"><apply id="S2.SS2.p1.14.m11.2.2.1.1.1.cmml" xref="S2.SS2.p1.14.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m11.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.14.m11.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.14.m11.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.14.m11.2.2.1.1.1.2">𝒆</ci><cn type="integer" id="S2.SS2.p1.14.m11.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.14.m11.2.2.1.1.1.3">0</cn></apply><ci id="S2.SS2.p1.14.m11.1.1.cmml" xref="S2.SS2.p1.14.m11.1.1">…</ci><apply id="S2.SS2.p1.14.m11.3.3.2.2.2.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m11.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.14.m11.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2.2">𝒆</ci><apply id="S2.SS2.p1.14.m11.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3"><minus id="S2.SS2.p1.14.m11.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.1"></minus><ci id="S2.SS2.p1.14.m11.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.14.m11.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.14.m11.3.3.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S2.SS2.p1.14.m11.3.3c.cmml" xref="S2.SS2.p1.14.m11.3.3"><in id="S2.SS2.p1.14.m11.3.3.6.cmml" xref="S2.SS2.p1.14.m11.3.3.6"></in><share href="#S2.SS2.p1.14.m11.3.3.2.cmml" id="S2.SS2.p1.14.m11.3.3d.cmml" xref="S2.SS2.p1.14.m11.3.3"></share><apply id="S2.SS2.p1.14.m11.3.3.7.cmml" xref="S2.SS2.p1.14.m11.3.3.7"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m11.3.3.7.1.cmml" xref="S2.SS2.p1.14.m11.3.3.7">superscript</csymbol><ci id="S2.SS2.p1.14.m11.3.3.7.2.cmml" xref="S2.SS2.p1.14.m11.3.3.7.2">ℝ</ci><apply id="S2.SS2.p1.14.m11.3.3.7.3.cmml" xref="S2.SS2.p1.14.m11.3.3.7.3"><times id="S2.SS2.p1.14.m11.3.3.7.3.1.cmml" xref="S2.SS2.p1.14.m11.3.3.7.3.1"></times><ci id="S2.SS2.p1.14.m11.3.3.7.3.2.cmml" xref="S2.SS2.p1.14.m11.3.3.7.3.2">𝑑</ci><ci id="S2.SS2.p1.14.m11.3.3.7.3.3.cmml" xref="S2.SS2.p1.14.m11.3.3.7.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m11.3c">\bm{E}_{0:s-1}=[\bm{e}_{0},...,\bm{e}_{s-1}]\in\mathbb{R}^{d\times s}</annotation></semantics></math> as follows:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\bm{E}_{0:s-1}=\mathrm{Embedding}(y_{0:s-1})." display="block"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">𝑬</mi><mrow id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mn id="S2.E3.m1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E3.m1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.1.cmml">:</mo><mrow id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.3.2.cmml">s</mi><mo id="S2.E3.m1.1.1.1.1.3.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.3.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">Embedding</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"></eq><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑬</ci><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><ci id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2">0</cn><apply id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3"><minus id="S2.E3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.1"></minus><ci id="S2.E3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.2">𝑠</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">Embedding</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3"><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2">0</cn><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\bm{E}_{0:s-1}=\mathrm{Embedding}(y_{0:s-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.18" class="ltx_p">Then, <math id="S2.SS2.p1.15.m1.1" class="ltx_Math" alttext="\bm{E}_{0:s-1}" display="inline"><semantics id="S2.SS2.p1.15.m1.1a"><msub id="S2.SS2.p1.15.m1.1.1" xref="S2.SS2.p1.15.m1.1.1.cmml"><mi id="S2.SS2.p1.15.m1.1.1.2" xref="S2.SS2.p1.15.m1.1.1.2.cmml">𝑬</mi><mrow id="S2.SS2.p1.15.m1.1.1.3" xref="S2.SS2.p1.15.m1.1.1.3.cmml"><mn id="S2.SS2.p1.15.m1.1.1.3.2" xref="S2.SS2.p1.15.m1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p1.15.m1.1.1.3.1" xref="S2.SS2.p1.15.m1.1.1.3.1.cmml">:</mo><mrow id="S2.SS2.p1.15.m1.1.1.3.3" xref="S2.SS2.p1.15.m1.1.1.3.3.cmml"><mi id="S2.SS2.p1.15.m1.1.1.3.3.2" xref="S2.SS2.p1.15.m1.1.1.3.3.2.cmml">s</mi><mo id="S2.SS2.p1.15.m1.1.1.3.3.1" xref="S2.SS2.p1.15.m1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.15.m1.1.1.3.3.3" xref="S2.SS2.p1.15.m1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m1.1b"><apply id="S2.SS2.p1.15.m1.1.1.cmml" xref="S2.SS2.p1.15.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m1.1.1.1.cmml" xref="S2.SS2.p1.15.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.15.m1.1.1.2.cmml" xref="S2.SS2.p1.15.m1.1.1.2">𝑬</ci><apply id="S2.SS2.p1.15.m1.1.1.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3"><ci id="S2.SS2.p1.15.m1.1.1.3.1.cmml" xref="S2.SS2.p1.15.m1.1.1.3.1">:</ci><cn type="integer" id="S2.SS2.p1.15.m1.1.1.3.2.cmml" xref="S2.SS2.p1.15.m1.1.1.3.2">0</cn><apply id="S2.SS2.p1.15.m1.1.1.3.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3"><minus id="S2.SS2.p1.15.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.1"></minus><ci id="S2.SS2.p1.15.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.15.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.15.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m1.1c">\bm{E}_{0:s-1}</annotation></semantics></math> is input to the <math id="S2.SS2.p1.16.m2.1" class="ltx_Math" alttext="M_{d}" display="inline"><semantics id="S2.SS2.p1.16.m2.1a"><msub id="S2.SS2.p1.16.m2.1.1" xref="S2.SS2.p1.16.m2.1.1.cmml"><mi id="S2.SS2.p1.16.m2.1.1.2" xref="S2.SS2.p1.16.m2.1.1.2.cmml">M</mi><mi id="S2.SS2.p1.16.m2.1.1.3" xref="S2.SS2.p1.16.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m2.1b"><apply id="S2.SS2.p1.16.m2.1.1.cmml" xref="S2.SS2.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.16.m2.1.1.1.cmml" xref="S2.SS2.p1.16.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.16.m2.1.1.2.cmml" xref="S2.SS2.p1.16.m2.1.1.2">𝑀</ci><ci id="S2.SS2.p1.16.m2.1.1.3.cmml" xref="S2.SS2.p1.16.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m2.1c">M_{d}</annotation></semantics></math> transformer blocks with the hidden state vectors <math id="S2.SS2.p1.17.m3.1" class="ltx_Math" alttext="\bm{H}" display="inline"><semantics id="S2.SS2.p1.17.m3.1a"><mi id="S2.SS2.p1.17.m3.1.1" xref="S2.SS2.p1.17.m3.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m3.1b"><ci id="S2.SS2.p1.17.m3.1.1.cmml" xref="S2.SS2.p1.17.m3.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m3.1c">\bm{H}</annotation></semantics></math> in Eq. (<a href="#S2.E1" title="In 2.1 Audio encoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to generate a hidden state vector <math id="S2.SS2.p1.18.m4.1" class="ltx_Math" alttext="\bm{u}_{s}" display="inline"><semantics id="S2.SS2.p1.18.m4.1a"><msub id="S2.SS2.p1.18.m4.1.1" xref="S2.SS2.p1.18.m4.1.1.cmml"><mi id="S2.SS2.p1.18.m4.1.1.2" xref="S2.SS2.p1.18.m4.1.1.2.cmml">𝒖</mi><mi id="S2.SS2.p1.18.m4.1.1.3" xref="S2.SS2.p1.18.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m4.1b"><apply id="S2.SS2.p1.18.m4.1.1.cmml" xref="S2.SS2.p1.18.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m4.1.1.1.cmml" xref="S2.SS2.p1.18.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.18.m4.1.1.2.cmml" xref="S2.SS2.p1.18.m4.1.1.2">𝒖</ci><ci id="S2.SS2.p1.18.m4.1.1.3.cmml" xref="S2.SS2.p1.18.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m4.1c">\bm{u}_{s}</annotation></semantics></math> as follows:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\bm{u}_{s}=\mathrm{Transformer}(\bm{E}_{0:s-1},\bm{H})," display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml">𝒖</mi><mi id="S2.E4.m1.2.2.1.1.3.3" xref="S2.E4.m1.2.2.1.1.3.3.cmml">s</mi></msub><mo id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml">Transformer</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml">𝑬</mi><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S2.E4.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E4.m1.2.2.1.1.1.1.1.1.3.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝑯</mi><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.4" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2"></eq><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2">𝒖</ci><ci id="S2.E4.m1.2.2.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3">𝑠</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3">Transformer</ci><interval closure="open" id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2">𝑬</ci><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3"><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.2">0</cn><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3"><minus id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝑯</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\bm{u}_{s}=\mathrm{Transformer}(\bm{E}_{0:s-1},\bm{H}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.19" class="ltx_p">Subsequently, a token-wise score <math id="S2.SS2.p1.19.m1.3" class="ltx_Math" alttext="\bm{\alpha}^{\text{n}}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K}]" display="inline"><semantics id="S2.SS2.p1.19.m1.3a"><mrow id="S2.SS2.p1.19.m1.3.3" xref="S2.SS2.p1.19.m1.3.3.cmml"><msup id="S2.SS2.p1.19.m1.3.3.4" xref="S2.SS2.p1.19.m1.3.3.4.cmml"><mi id="S2.SS2.p1.19.m1.3.3.4.2" xref="S2.SS2.p1.19.m1.3.3.4.2.cmml">𝜶</mi><mtext id="S2.SS2.p1.19.m1.3.3.4.3" xref="S2.SS2.p1.19.m1.3.3.4.3a.cmml">n</mtext></msup><mo id="S2.SS2.p1.19.m1.3.3.3" xref="S2.SS2.p1.19.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.19.m1.3.3.2.2" xref="S2.SS2.p1.19.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.19.m1.3.3.2.2.3" xref="S2.SS2.p1.19.m1.3.3.2.3.cmml">[</mo><msubsup id="S2.SS2.p1.19.m1.2.2.1.1.1" xref="S2.SS2.p1.19.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.19.m1.2.2.1.1.1.2.2" xref="S2.SS2.p1.19.m1.2.2.1.1.1.2.2.cmml">α</mi><mn id="S2.SS2.p1.19.m1.2.2.1.1.1.3" xref="S2.SS2.p1.19.m1.2.2.1.1.1.3.cmml">1</mn><mtext id="S2.SS2.p1.19.m1.2.2.1.1.1.2.3" xref="S2.SS2.p1.19.m1.2.2.1.1.1.2.3a.cmml">n</mtext></msubsup><mo id="S2.SS2.p1.19.m1.3.3.2.2.4" xref="S2.SS2.p1.19.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.19.m1.1.1" xref="S2.SS2.p1.19.m1.1.1.cmml">…</mi><mo id="S2.SS2.p1.19.m1.3.3.2.2.5" xref="S2.SS2.p1.19.m1.3.3.2.3.cmml">,</mo><msubsup id="S2.SS2.p1.19.m1.3.3.2.2.2" xref="S2.SS2.p1.19.m1.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.19.m1.3.3.2.2.2.2.2" xref="S2.SS2.p1.19.m1.3.3.2.2.2.2.2.cmml">α</mi><mi id="S2.SS2.p1.19.m1.3.3.2.2.2.3" xref="S2.SS2.p1.19.m1.3.3.2.2.2.3.cmml">K</mi><mtext id="S2.SS2.p1.19.m1.3.3.2.2.2.2.3" xref="S2.SS2.p1.19.m1.3.3.2.2.2.2.3a.cmml">n</mtext></msubsup><mo stretchy="false" id="S2.SS2.p1.19.m1.3.3.2.2.6" xref="S2.SS2.p1.19.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m1.3b"><apply id="S2.SS2.p1.19.m1.3.3.cmml" xref="S2.SS2.p1.19.m1.3.3"><eq id="S2.SS2.p1.19.m1.3.3.3.cmml" xref="S2.SS2.p1.19.m1.3.3.3"></eq><apply id="S2.SS2.p1.19.m1.3.3.4.cmml" xref="S2.SS2.p1.19.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m1.3.3.4.1.cmml" xref="S2.SS2.p1.19.m1.3.3.4">superscript</csymbol><ci id="S2.SS2.p1.19.m1.3.3.4.2.cmml" xref="S2.SS2.p1.19.m1.3.3.4.2">𝜶</ci><ci id="S2.SS2.p1.19.m1.3.3.4.3a.cmml" xref="S2.SS2.p1.19.m1.3.3.4.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m1.3.3.4.3.cmml" xref="S2.SS2.p1.19.m1.3.3.4.3">n</mtext></ci></apply><list id="S2.SS2.p1.19.m1.3.3.2.3.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2"><apply id="S2.SS2.p1.19.m1.2.2.1.1.1.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.p1.19.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.19.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1.2.2">𝛼</ci><ci id="S2.SS2.p1.19.m1.2.2.1.1.1.2.3a.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1.2.3">n</mtext></ci></apply><cn type="integer" id="S2.SS2.p1.19.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.19.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.19.m1.1.1.cmml" xref="S2.SS2.p1.19.m1.1.1">…</ci><apply id="S2.SS2.p1.19.m1.3.3.2.2.2.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2">subscript</csymbol><apply id="S2.SS2.p1.19.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.19.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2.2.2">𝛼</ci><ci id="S2.SS2.p1.19.m1.3.3.2.2.2.2.3a.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2.2.3">n</mtext></ci></apply><ci id="S2.SS2.p1.19.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.19.m1.3.3.2.2.2.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m1.3c">\bm{\alpha}^{\text{n}}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K}]</annotation></semantics></math> and corresponding probability are calculated as follows:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\bm{\alpha}^{\text{n}}=\mathrm{Linear}(\bm{u}_{s})," display="block"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><msup id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.3.2.cmml">𝜶</mi><mtext id="S2.E5.m1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.3.3a.cmml">n</mtext></msup><mo id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml">𝒖</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2"></eq><apply id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.3.2">𝜶</ci><ci id="S2.E5.m1.1.1.1.1.3.3a.cmml" xref="S2.E5.m1.1.1.1.1.3.3"><mtext mathsize="70%" id="S2.E5.m1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.3.3">n</mtext></ci></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3">Linear</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2">𝒖</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\bm{\alpha}^{\text{n}}=\mathrm{Linear}(\bm{u}_{s}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.2" class="ltx_Math" alttext="P\left(y_{s}\mid\bm{y}_{0:s-1},\bm{X}\right)=\mathrm{Softmax}(\bm{\alpha}^{\text{n}})," display="block"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">𝑿</mi></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.3" xref="S2.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E6.m1.2.2.1.1.2" xref="S2.E6.m1.2.2.1.1.2.cmml"><mi id="S2.E6.m1.2.2.1.1.2.3" xref="S2.E6.m1.2.2.1.1.2.3.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.1.1.2.2" xref="S2.E6.m1.2.2.1.1.2.2.cmml">​</mo><mrow id="S2.E6.m1.2.2.1.1.2.1.1" xref="S2.E6.m1.2.2.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.2.2.1.1.2.1.1.2" xref="S2.E6.m1.2.2.1.1.2.1.1.1.cmml">(</mo><msup id="S2.E6.m1.2.2.1.1.2.1.1.1" xref="S2.E6.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.2.1.1.1.2" xref="S2.E6.m1.2.2.1.1.2.1.1.1.2.cmml">𝜶</mi><mtext id="S2.E6.m1.2.2.1.1.2.1.1.1.3" xref="S2.E6.m1.2.2.1.1.2.1.1.1.3a.cmml">n</mtext></msup><mo stretchy="false" id="S2.E6.m1.2.2.1.1.2.1.1.3" xref="S2.E6.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.1.1.cmml" xref="S2.E6.m1.2.2.1"><eq id="S2.E6.m1.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3"></eq><apply id="S2.E6.m1.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><times id="S2.E6.m1.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.2"></times><ci id="S2.E6.m1.2.2.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.3">𝑃</ci><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1"><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝒚</ci><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">0</cn><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝑿</ci></list></apply></apply><apply id="S2.E6.m1.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2"><times id="S2.E6.m1.2.2.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.2.2"></times><ci id="S2.E6.m1.2.2.1.1.2.3.cmml" xref="S2.E6.m1.2.2.1.1.2.3">Softmax</ci><apply id="S2.E6.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1">superscript</csymbol><ci id="S2.E6.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1.2">𝜶</ci><ci id="S2.E6.m1.2.2.1.1.2.1.1.1.3a.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1.3"><mtext mathsize="70%" id="S2.E6.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1.3">n</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">P\left(y_{s}\mid\bm{y}_{0:s-1},\bm{X}\right)=\mathrm{Softmax}(\bm{\alpha}^{\text{n}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.21" class="ltx_p">By repeating these processes recursively, the posterior probability is formulated as follows:</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.2" class="ltx_Math" alttext="P(y_{0:S}\mid\bm{X})=\prod_{s=1}^{S}P\left(y_{s}\mid y_{0:s-1},\bm{X}\right)," display="block"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2.1" xref="S2.E7.m1.2.2.1.1.cmml"><mrow id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.1.cmml"><mrow id="S2.E7.m1.2.2.1.1.1" xref="S2.E7.m1.2.2.1.1.1.cmml"><mi id="S2.E7.m1.2.2.1.1.1.3" xref="S2.E7.m1.2.2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.2.2.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.1.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.1.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.2.2.1.1.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.1" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">S</mi></mrow></msub><mo id="S2.E7.m1.2.2.1.1.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E7.m1.2.2.1.1.1.1.1.1.3" xref="S2.E7.m1.2.2.1.1.1.1.1.1.3.cmml">𝑿</mi></mrow><mo stretchy="false" id="S2.E7.m1.2.2.1.1.1.1.1.3" xref="S2.E7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E7.m1.2.2.1.1.3" xref="S2.E7.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E7.m1.2.2.1.1.2" xref="S2.E7.m1.2.2.1.1.2.cmml"><munderover id="S2.E7.m1.2.2.1.1.2.2" xref="S2.E7.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S2.E7.m1.2.2.1.1.2.2.2.2" xref="S2.E7.m1.2.2.1.1.2.2.2.2.cmml">∏</mo><mrow id="S2.E7.m1.2.2.1.1.2.2.2.3" xref="S2.E7.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S2.E7.m1.2.2.1.1.2.2.2.3.2" xref="S2.E7.m1.2.2.1.1.2.2.2.3.2.cmml">s</mi><mo id="S2.E7.m1.2.2.1.1.2.2.2.3.1" xref="S2.E7.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S2.E7.m1.2.2.1.1.2.2.2.3.3" xref="S2.E7.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E7.m1.2.2.1.1.2.2.3" xref="S2.E7.m1.2.2.1.1.2.2.3.cmml">S</mi></munderover><mrow id="S2.E7.m1.2.2.1.1.2.1" xref="S2.E7.m1.2.2.1.1.2.1.cmml"><mi id="S2.E7.m1.2.2.1.1.2.1.3" xref="S2.E7.m1.2.2.1.1.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.1.1.2.1.2" xref="S2.E7.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S2.E7.m1.2.2.1.1.2.1.1.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S2.E7.m1.2.2.1.1.2.1.1.1.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.1.1.2.1.1.1.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S2.E7.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><msub id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml">𝑿</mi></mrow></mrow><mo id="S2.E7.m1.2.2.1.1.2.1.1.1.3" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E7.m1.2.2.1.2" xref="S2.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.1.1.cmml" xref="S2.E7.m1.2.2.1"><eq id="S2.E7.m1.2.2.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.3"></eq><apply id="S2.E7.m1.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1"><times id="S2.E7.m1.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.1.2"></times><ci id="S2.E7.m1.2.2.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.1.3">𝑃</ci><apply id="S2.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3"><ci id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.2">0</cn><ci id="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.2.3.3">𝑆</ci></apply></apply><ci id="S2.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.1.3">𝑿</ci></apply></apply><apply id="S2.E7.m1.2.2.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2"><apply id="S2.E7.m1.2.2.1.1.2.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S2.E7.m1.2.2.1.1.2.2.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.E7.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2.2.2">product</csymbol><apply id="S2.E7.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.1.1.2.2.2.3"><eq id="S2.E7.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S2.E7.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2.2.3.2">𝑠</ci><cn type="integer" id="S2.E7.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E7.m1.2.2.1.1.2.2.3.cmml" xref="S2.E7.m1.2.2.1.1.2.2.3">𝑆</ci></apply><apply id="S2.E7.m1.2.2.1.1.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1"><times id="S2.E7.m1.2.2.1.1.2.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.2"></times><ci id="S2.E7.m1.2.2.1.1.2.1.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.3">𝑃</ci><apply id="S2.E7.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.2">conditional</csymbol><apply id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.2">𝑦</ci><ci id="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.3.3">𝑠</ci></apply><list id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1"><apply id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3"><ci id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2">0</cn><apply id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3"><minus id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1">𝑿</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">P(y_{0:S}\mid\bm{X})=\prod_{s=1}^{S}P\left(y_{s}\mid y_{0:s-1},\bm{X}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.20" class="ltx_p">where <math id="S2.SS2.p1.20.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.SS2.p1.20.m1.1a"><mi id="S2.SS2.p1.20.m1.1.1" xref="S2.SS2.p1.20.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m1.1b"><ci id="S2.SS2.p1.20.m1.1.1.cmml" xref="S2.SS2.p1.20.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m1.1c">S</annotation></semantics></math> is the total number of tokens.
Model parameters are optimized by minimizing the negative log-likelihood described as follows:
</p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.1" class="ltx_Math" alttext="L=-\log P(y_{0:S}\mid\bm{X})." display="block"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mi id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml">L</mi><mo id="S2.E8.m1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S2.E8.m1.1.1.1.1.1a" xref="S2.E8.m1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E8.m1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E8.m1.1.1.1.1.1.1.3a" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E8.m1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E8.m1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">S</mi></mrow></msub><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝑿</mi></mrow><mo stretchy="false" id="S2.E8.m1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E8.m1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><eq id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2"></eq><ci id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3">𝐿</ci><apply id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"><minus id="S2.E8.m1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1"></minus><apply id="S2.E8.m1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2"></times><apply id="S2.E8.m1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3"><log id="S2.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.1"></log><ci id="S2.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3"><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2">0</cn><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑆</ci></apply></apply><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3">𝑿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">L=-\log P(y_{0:S}\mid\bm{X}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.22" class="ltx_p">The embedding and output layers are extended to the proposed biasing method in Section <a href="#S3.SS2" title="3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the overall architecture of the proposed method, which comprises the audio encoder, bias encoder, and decoder with extended embedding and output layers. These components are described in the following subsections.</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<div id="S3.F1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:216.8pt;">
<img src="/html/2405.13344/assets/figures/overview.png" id="S3.F1.1.g1" class="ltx_graphics ltx_img_landscape" width="509" height="386" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.4.2" class="ltx_text" style="font-size:90%;">Overall architecture of the proposed method, including the audio encoder, bias encoder, and bias decoder with extended embedding and output layers.</span></figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Bias encoder</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.17" class="ltx_p">Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, the bias encoder comprises an embedding layer, <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="M_{\text{e}}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">M</mi><mtext id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3a.cmml">e</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑀</ci><ci id="S3.SS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">M_{\text{e}}</annotation></semantics></math> transformer blocks, a mean pooling layer, and a bias list <math id="S3.SS1.p1.2.m2.1" class="ltx_math_unparsed" alttext="B=\{b_{1},\cdots,b_{N}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1b"><mi id="S3.SS1.p1.2.m2.1.2">B</mi><mo id="S3.SS1.p1.2.m2.1.3">=</mo><mrow id="S3.SS1.p1.2.m2.1.4"><mo stretchy="false" id="S3.SS1.p1.2.m2.1.4.1">{</mo><msub id="S3.SS1.p1.2.m2.1.4.2"><mi id="S3.SS1.p1.2.m2.1.4.2.2">b</mi><mn id="S3.SS1.p1.2.m2.1.4.2.3">1</mn></msub><mo id="S3.SS1.p1.2.m2.1.4.3">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1">⋯</mi><mo id="S3.SS1.p1.2.m2.1.4.4">,</mo><msub id="S3.SS1.p1.2.m2.1.4.5"><mi id="S3.SS1.p1.2.m2.1.4.5.2">b</mi><mi id="S3.SS1.p1.2.m2.1.4.5.3">N</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">B=\{b_{1},\cdots,b_{N}</annotation></semantics></math>}, where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="b_{n}\in\mathcal{V}^{\text{n}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">n</mi></msub><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">𝒱</mi><mtext id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3a.cmml">n</mtext></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑏</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝒱</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3a.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><mtext mathsize="70%" id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">n</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">b_{n}\in\mathcal{V}^{\text{n}}</annotation></semantics></math> is the <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">I</annotation></semantics></math>-lengnth subword token sequence of the <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n</annotation></semantics></math>-th bias phrase (e.g., [<math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mo id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><lt id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">&lt;</annotation></semantics></math><span id="S3.SS1.p1.7.1" class="ltx_text ltx_font_italic">N<math id="S3.SS1.p1.7.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS1.p1.7.1.m1.1a"><mo id="S3.SS1.p1.7.1.m1.1.1" xref="S3.SS1.p1.7.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.1.m1.1b"><gt id="S3.SS1.p1.7.1.m1.1.1.cmml" xref="S3.SS1.p1.7.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.1.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS1.p1.8.m7.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p1.8.m7.1a"><mo id="S3.SS1.p1.8.m7.1.1" xref="S3.SS1.p1.8.m7.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m7.1b"><lt id="S3.SS1.p1.8.m7.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m7.1c">&lt;</annotation></semantics></math><span id="S3.SS1.p1.9.2" class="ltx_text ltx_font_italic">el<math id="S3.SS1.p1.9.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS1.p1.9.2.m1.1a"><mo id="S3.SS1.p1.9.2.m1.1.1" xref="S3.SS1.p1.9.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.2.m1.1b"><gt id="S3.SS1.p1.9.2.m1.1.1.cmml" xref="S3.SS1.p1.9.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.2.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS1.p1.10.m8.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p1.10.m8.1a"><mo id="S3.SS1.p1.10.m8.1.1" xref="S3.SS1.p1.10.m8.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m8.1b"><lt id="S3.SS1.p1.10.m8.1.1.cmml" xref="S3.SS1.p1.10.m8.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m8.1c">&lt;</annotation></semantics></math><span id="S3.SS1.p1.11.3" class="ltx_text ltx_font_italic">ly<math id="S3.SS1.p1.11.3.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS1.p1.11.3.m1.1a"><mo id="S3.SS1.p1.11.3.m1.1.1" xref="S3.SS1.p1.11.3.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.3.m1.1b"><gt id="S3.SS1.p1.11.3.m1.1.1.cmml" xref="S3.SS1.p1.11.3.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.3.m1.1c">&gt;</annotation></semantics></math></span>]).
After converting the bias list <math id="S3.SS1.p1.12.m9.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p1.12.m9.1a"><mi id="S3.SS1.p1.12.m9.1.1" xref="S3.SS1.p1.12.m9.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m9.1b"><ci id="S3.SS1.p1.12.m9.1.1.cmml" xref="S3.SS1.p1.12.m9.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m9.1c">B</annotation></semantics></math> into a matrix <math id="S3.SS1.p1.13.m10.1" class="ltx_Math" alttext="\bm{B}\in\mathbb{R}^{I_{\text{max}}\times N}" display="inline"><semantics id="S3.SS1.p1.13.m10.1a"><mrow id="S3.SS1.p1.13.m10.1.1" xref="S3.SS1.p1.13.m10.1.1.cmml"><mi id="S3.SS1.p1.13.m10.1.1.2" xref="S3.SS1.p1.13.m10.1.1.2.cmml">𝑩</mi><mo id="S3.SS1.p1.13.m10.1.1.1" xref="S3.SS1.p1.13.m10.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.13.m10.1.1.3" xref="S3.SS1.p1.13.m10.1.1.3.cmml"><mi id="S3.SS1.p1.13.m10.1.1.3.2" xref="S3.SS1.p1.13.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.13.m10.1.1.3.3" xref="S3.SS1.p1.13.m10.1.1.3.3.cmml"><msub id="S3.SS1.p1.13.m10.1.1.3.3.2" xref="S3.SS1.p1.13.m10.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.13.m10.1.1.3.3.2.2" xref="S3.SS1.p1.13.m10.1.1.3.3.2.2.cmml">I</mi><mtext id="S3.SS1.p1.13.m10.1.1.3.3.2.3" xref="S3.SS1.p1.13.m10.1.1.3.3.2.3a.cmml">max</mtext></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.13.m10.1.1.3.3.1" xref="S3.SS1.p1.13.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.13.m10.1.1.3.3.3" xref="S3.SS1.p1.13.m10.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m10.1b"><apply id="S3.SS1.p1.13.m10.1.1.cmml" xref="S3.SS1.p1.13.m10.1.1"><in id="S3.SS1.p1.13.m10.1.1.1.cmml" xref="S3.SS1.p1.13.m10.1.1.1"></in><ci id="S3.SS1.p1.13.m10.1.1.2.cmml" xref="S3.SS1.p1.13.m10.1.1.2">𝑩</ci><apply id="S3.SS1.p1.13.m10.1.1.3.cmml" xref="S3.SS1.p1.13.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m10.1.1.3.1.cmml" xref="S3.SS1.p1.13.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.13.m10.1.1.3.2.cmml" xref="S3.SS1.p1.13.m10.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.13.m10.1.1.3.3.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3"><times id="S3.SS1.p1.13.m10.1.1.3.3.1.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.1"></times><apply id="S3.SS1.p1.13.m10.1.1.3.3.2.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m10.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.13.m10.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.2.2">𝐼</ci><ci id="S3.SS1.p1.13.m10.1.1.3.3.2.3a.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.2.3"><mtext mathsize="50%" id="S3.SS1.p1.13.m10.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.2.3">max</mtext></ci></apply><ci id="S3.SS1.p1.13.m10.1.1.3.3.3.cmml" xref="S3.SS1.p1.13.m10.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m10.1c">\bm{B}\in\mathbb{R}^{I_{\text{max}}\times N}</annotation></semantics></math> through zero padding based on the maximum token length <math id="S3.SS1.p1.14.m11.1" class="ltx_Math" alttext="I_{\text{max}}" display="inline"><semantics id="S3.SS1.p1.14.m11.1a"><msub id="S3.SS1.p1.14.m11.1.1" xref="S3.SS1.p1.14.m11.1.1.cmml"><mi id="S3.SS1.p1.14.m11.1.1.2" xref="S3.SS1.p1.14.m11.1.1.2.cmml">I</mi><mtext id="S3.SS1.p1.14.m11.1.1.3" xref="S3.SS1.p1.14.m11.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m11.1b"><apply id="S3.SS1.p1.14.m11.1.1.cmml" xref="S3.SS1.p1.14.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m11.1.1.1.cmml" xref="S3.SS1.p1.14.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m11.1.1.2.cmml" xref="S3.SS1.p1.14.m11.1.1.2">𝐼</ci><ci id="S3.SS1.p1.14.m11.1.1.3a.cmml" xref="S3.SS1.p1.14.m11.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.14.m11.1.1.3.cmml" xref="S3.SS1.p1.14.m11.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m11.1c">I_{\text{max}}</annotation></semantics></math> in <math id="S3.SS1.p1.15.m12.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p1.15.m12.1a"><mi id="S3.SS1.p1.15.m12.1.1" xref="S3.SS1.p1.15.m12.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m12.1b"><ci id="S3.SS1.p1.15.m12.1.1.cmml" xref="S3.SS1.p1.15.m12.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m12.1c">B</annotation></semantics></math>, the embedding layer and the <math id="S3.SS1.p1.16.m13.1" class="ltx_Math" alttext="M_{\text{e}}" display="inline"><semantics id="S3.SS1.p1.16.m13.1a"><msub id="S3.SS1.p1.16.m13.1.1" xref="S3.SS1.p1.16.m13.1.1.cmml"><mi id="S3.SS1.p1.16.m13.1.1.2" xref="S3.SS1.p1.16.m13.1.1.2.cmml">M</mi><mtext id="S3.SS1.p1.16.m13.1.1.3" xref="S3.SS1.p1.16.m13.1.1.3a.cmml">e</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m13.1b"><apply id="S3.SS1.p1.16.m13.1.1.cmml" xref="S3.SS1.p1.16.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m13.1.1.1.cmml" xref="S3.SS1.p1.16.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m13.1.1.2.cmml" xref="S3.SS1.p1.16.m13.1.1.2">𝑀</ci><ci id="S3.SS1.p1.16.m13.1.1.3a.cmml" xref="S3.SS1.p1.16.m13.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.16.m13.1.1.3.cmml" xref="S3.SS1.p1.16.m13.1.1.3">e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m13.1c">M_{\text{e}}</annotation></semantics></math> transformer blocks extract the high level representation <math id="S3.SS1.p1.17.m14.1" class="ltx_Math" alttext="\bm{G}\in\mathbb{R}^{d\times I_{\text{max}}\times N}" display="inline"><semantics id="S3.SS1.p1.17.m14.1a"><mrow id="S3.SS1.p1.17.m14.1.1" xref="S3.SS1.p1.17.m14.1.1.cmml"><mi id="S3.SS1.p1.17.m14.1.1.2" xref="S3.SS1.p1.17.m14.1.1.2.cmml">𝑮</mi><mo id="S3.SS1.p1.17.m14.1.1.1" xref="S3.SS1.p1.17.m14.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.17.m14.1.1.3" xref="S3.SS1.p1.17.m14.1.1.3.cmml"><mi id="S3.SS1.p1.17.m14.1.1.3.2" xref="S3.SS1.p1.17.m14.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.17.m14.1.1.3.3" xref="S3.SS1.p1.17.m14.1.1.3.3.cmml"><mi id="S3.SS1.p1.17.m14.1.1.3.3.2" xref="S3.SS1.p1.17.m14.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.17.m14.1.1.3.3.1" xref="S3.SS1.p1.17.m14.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.17.m14.1.1.3.3.3" xref="S3.SS1.p1.17.m14.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.17.m14.1.1.3.3.3.2" xref="S3.SS1.p1.17.m14.1.1.3.3.3.2.cmml">I</mi><mtext id="S3.SS1.p1.17.m14.1.1.3.3.3.3" xref="S3.SS1.p1.17.m14.1.1.3.3.3.3a.cmml">max</mtext></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.17.m14.1.1.3.3.1a" xref="S3.SS1.p1.17.m14.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.17.m14.1.1.3.3.4" xref="S3.SS1.p1.17.m14.1.1.3.3.4.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m14.1b"><apply id="S3.SS1.p1.17.m14.1.1.cmml" xref="S3.SS1.p1.17.m14.1.1"><in id="S3.SS1.p1.17.m14.1.1.1.cmml" xref="S3.SS1.p1.17.m14.1.1.1"></in><ci id="S3.SS1.p1.17.m14.1.1.2.cmml" xref="S3.SS1.p1.17.m14.1.1.2">𝑮</ci><apply id="S3.SS1.p1.17.m14.1.1.3.cmml" xref="S3.SS1.p1.17.m14.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m14.1.1.3.1.cmml" xref="S3.SS1.p1.17.m14.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.17.m14.1.1.3.2.cmml" xref="S3.SS1.p1.17.m14.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.17.m14.1.1.3.3.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3"><times id="S3.SS1.p1.17.m14.1.1.3.3.1.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.1"></times><ci id="S3.SS1.p1.17.m14.1.1.3.3.2.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.2">𝑑</ci><apply id="S3.SS1.p1.17.m14.1.1.3.3.3.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m14.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.17.m14.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.3.2">𝐼</ci><ci id="S3.SS1.p1.17.m14.1.1.3.3.3.3a.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.3.3"><mtext mathsize="50%" id="S3.SS1.p1.17.m14.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.3.3">max</mtext></ci></apply><ci id="S3.SS1.p1.17.m14.1.1.3.3.4.cmml" xref="S3.SS1.p1.17.m14.1.1.3.3.4">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m14.1c">\bm{G}\in\mathbb{R}^{d\times I_{\text{max}}\times N}</annotation></semantics></math> as follows:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.2" class="ltx_Math" alttext="\bm{G}=\mathrm{TransformerEnc}(\mathrm{Embedding}(\bm{B}))." display="block"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.3" xref="S3.E9.m1.2.2.1.1.3.cmml">𝑮</mi><mo id="S3.E9.m1.2.2.1.1.2" xref="S3.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.3.cmml">TransformerEnc</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml">Embedding</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">𝑩</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1"><eq id="S3.E9.m1.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2"></eq><ci id="S3.E9.m1.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.3">𝑮</ci><apply id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"><times id="S3.E9.m1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2"></times><ci id="S3.E9.m1.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3">TransformerEnc</ci><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1"><times id="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1"></times><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2">Embedding</ci><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝑩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\bm{G}=\mathrm{TransformerEnc}(\mathrm{Embedding}(\bm{B})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.18" class="ltx_p">Then, a mean pooling layer extracts phrase-level embedding vectors <math id="S3.SS1.p1.18.m1.3" class="ltx_Math" alttext="\bm{V}=[\bm{v}_{1},\cdots,\bm{v}_{N}]\in\mathbb{R}^{d\times N}" display="inline"><semantics id="S3.SS1.p1.18.m1.3a"><mrow id="S3.SS1.p1.18.m1.3.3" xref="S3.SS1.p1.18.m1.3.3.cmml"><mi id="S3.SS1.p1.18.m1.3.3.4" xref="S3.SS1.p1.18.m1.3.3.4.cmml">𝑽</mi><mo id="S3.SS1.p1.18.m1.3.3.5" xref="S3.SS1.p1.18.m1.3.3.5.cmml">=</mo><mrow id="S3.SS1.p1.18.m1.3.3.2.2" xref="S3.SS1.p1.18.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.18.m1.3.3.2.2.3" xref="S3.SS1.p1.18.m1.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p1.18.m1.2.2.1.1.1" xref="S3.SS1.p1.18.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.18.m1.2.2.1.1.1.2" xref="S3.SS1.p1.18.m1.2.2.1.1.1.2.cmml">𝒗</mi><mn id="S3.SS1.p1.18.m1.2.2.1.1.1.3" xref="S3.SS1.p1.18.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.18.m1.3.3.2.2.4" xref="S3.SS1.p1.18.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.18.m1.1.1" xref="S3.SS1.p1.18.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.18.m1.3.3.2.2.5" xref="S3.SS1.p1.18.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.18.m1.3.3.2.2.2" xref="S3.SS1.p1.18.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.18.m1.3.3.2.2.2.2" xref="S3.SS1.p1.18.m1.3.3.2.2.2.2.cmml">𝒗</mi><mi id="S3.SS1.p1.18.m1.3.3.2.2.2.3" xref="S3.SS1.p1.18.m1.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p1.18.m1.3.3.2.2.6" xref="S3.SS1.p1.18.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS1.p1.18.m1.3.3.6" xref="S3.SS1.p1.18.m1.3.3.6.cmml">∈</mo><msup id="S3.SS1.p1.18.m1.3.3.7" xref="S3.SS1.p1.18.m1.3.3.7.cmml"><mi id="S3.SS1.p1.18.m1.3.3.7.2" xref="S3.SS1.p1.18.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.18.m1.3.3.7.3" xref="S3.SS1.p1.18.m1.3.3.7.3.cmml"><mi id="S3.SS1.p1.18.m1.3.3.7.3.2" xref="S3.SS1.p1.18.m1.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.18.m1.3.3.7.3.1" xref="S3.SS1.p1.18.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.SS1.p1.18.m1.3.3.7.3.3" xref="S3.SS1.p1.18.m1.3.3.7.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m1.3b"><apply id="S3.SS1.p1.18.m1.3.3.cmml" xref="S3.SS1.p1.18.m1.3.3"><and id="S3.SS1.p1.18.m1.3.3a.cmml" xref="S3.SS1.p1.18.m1.3.3"></and><apply id="S3.SS1.p1.18.m1.3.3b.cmml" xref="S3.SS1.p1.18.m1.3.3"><eq id="S3.SS1.p1.18.m1.3.3.5.cmml" xref="S3.SS1.p1.18.m1.3.3.5"></eq><ci id="S3.SS1.p1.18.m1.3.3.4.cmml" xref="S3.SS1.p1.18.m1.3.3.4">𝑽</ci><list id="S3.SS1.p1.18.m1.3.3.2.3.cmml" xref="S3.SS1.p1.18.m1.3.3.2.2"><apply id="S3.SS1.p1.18.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.18.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.18.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.18.m1.2.2.1.1.1.2">𝒗</ci><cn type="integer" id="S3.SS1.p1.18.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.18.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.18.m1.1.1.cmml" xref="S3.SS1.p1.18.m1.1.1">⋯</ci><apply id="S3.SS1.p1.18.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.18.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.18.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.18.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.18.m1.3.3.2.2.2.2">𝒗</ci><ci id="S3.SS1.p1.18.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.18.m1.3.3.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S3.SS1.p1.18.m1.3.3c.cmml" xref="S3.SS1.p1.18.m1.3.3"><in id="S3.SS1.p1.18.m1.3.3.6.cmml" xref="S3.SS1.p1.18.m1.3.3.6"></in><share href="#S3.SS1.p1.18.m1.3.3.2.cmml" id="S3.SS1.p1.18.m1.3.3d.cmml" xref="S3.SS1.p1.18.m1.3.3"></share><apply id="S3.SS1.p1.18.m1.3.3.7.cmml" xref="S3.SS1.p1.18.m1.3.3.7"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m1.3.3.7.1.cmml" xref="S3.SS1.p1.18.m1.3.3.7">superscript</csymbol><ci id="S3.SS1.p1.18.m1.3.3.7.2.cmml" xref="S3.SS1.p1.18.m1.3.3.7.2">ℝ</ci><apply id="S3.SS1.p1.18.m1.3.3.7.3.cmml" xref="S3.SS1.p1.18.m1.3.3.7.3"><times id="S3.SS1.p1.18.m1.3.3.7.3.1.cmml" xref="S3.SS1.p1.18.m1.3.3.7.3.1"></times><ci id="S3.SS1.p1.18.m1.3.3.7.3.2.cmml" xref="S3.SS1.p1.18.m1.3.3.7.3.2">𝑑</ci><ci id="S3.SS1.p1.18.m1.3.3.7.3.3.cmml" xref="S3.SS1.p1.18.m1.3.3.7.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m1.3c">\bm{V}=[\bm{v}_{1},\cdots,\bm{v}_{N}]\in\mathbb{R}^{d\times N}</annotation></semantics></math> as follows:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\bm{V}=\mathrm{MeanPool}(\bm{G})." display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml">𝑽</mi><mo id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.2" xref="S3.E10.m1.2.2.1.1.3.2.cmml">MeanPool</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.1" xref="S3.E10.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.3.3.2" xref="S3.E10.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.3.3.2.1" xref="S3.E10.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">𝑮</mi><mo stretchy="false" id="S3.E10.m1.2.2.1.1.3.3.2.2" xref="S3.E10.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"></eq><ci id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2">𝑽</ci><apply id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3"><times id="S3.E10.m1.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1"></times><ci id="S3.E10.m1.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.2">MeanPool</ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\bm{V}=\mathrm{MeanPool}(\bm{G}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Bias decoder with dynamic vocabulary</h3>

<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.13344/assets/figures/embedding.png" id="S3.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="517" height="356" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Embedding layer</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.13344/assets/figures/output.png" id="S3.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="462" height="342" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">Output layer</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Extended embedding and output layers. (a) If the input token is a dynamic bias token, the corresponding phrase-level bias embedding <math id="S3.F2.3.1.m1.1" class="ltx_Math" alttext="\bm{v}_{n}" display="inline"><semantics id="S3.F2.3.1.m1.1b"><msub id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml"><mi id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2.cmml">𝒗</mi><mi id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1">subscript</csymbol><ci id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2">𝒗</ci><ci id="S3.F2.3.1.m1.1.1.3.cmml" xref="S3.F2.3.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">\bm{v}_{n}</annotation></semantics></math> is extracted. (b) The bias phrase score <math id="S3.F2.4.2.m2.1" class="ltx_Math" alttext="\bm{\alpha}^{\text{b}}" display="inline"><semantics id="S3.F2.4.2.m2.1b"><msup id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml"><mi id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2.cmml">𝜶</mi><mtext id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3a.cmml">b</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1">superscript</csymbol><ci id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2">𝜶</ci><ci id="S3.F2.4.2.m2.1.1.3a.cmml" xref="S3.F2.4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.F2.4.2.m2.1.1.3.cmml" xref="S3.F2.4.2.m2.1.1.3">b</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">\bm{\alpha}^{\text{b}}</annotation></semantics></math> is calculated using the inner product.</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">To avoid the complexity of learning dependencies within the bias phrases,
we introduce a dynamic vocabulary <math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="\mathcal{V}^{\text{b}}=\{&lt;b_{1}&gt;,\cdots,&lt;b_{N}&gt;\}" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml"><msup id="S3.SS2.p1.1.m1.3.3.4" xref="S3.SS2.p1.1.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.3.4.2" xref="S3.SS2.p1.1.m1.3.3.4.2.cmml">𝒱</mi><mtext id="S3.SS2.p1.1.m1.3.3.4.3" xref="S3.SS2.p1.1.m1.3.3.4.3a.cmml">b</mtext></msup><mo id="S3.SS2.p1.1.m1.3.3.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">{</mo><mrow id="S3.SS2.p1.1.m1.2.2.1.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml">&lt;</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.2.cmml">b</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo fence="true" lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml">&gt;</mo></mrow><mo id="S3.SS2.p1.1.m1.3.3.2.2.4" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS2.p1.1.m1.3.3.2.2.5" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mrow id="S3.SS2.p1.1.m1.3.3.2.2.2.1" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml">&lt;</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.2.cmml">b</mi><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.3.cmml">N</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml">&gt;</mo></mrow><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.2.6" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><apply id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3"><eq id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3"></eq><apply id="S3.SS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.4.1.cmml" xref="S3.SS2.p1.1.m1.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.4.2.cmml" xref="S3.SS2.p1.1.m1.3.3.4.2">𝒱</ci><ci id="S3.SS2.p1.1.m1.3.3.4.3a.cmml" xref="S3.SS2.p1.1.m1.3.3.4.3"><mtext mathsize="70%" id="S3.SS2.p1.1.m1.3.3.4.3.cmml" xref="S3.SS2.p1.1.m1.3.3.4.3">b</mtext></ci></apply><set id="S3.SS2.p1.1.m1.3.3.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.2">expectation</csymbol><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.2">𝑏</ci><cn type="integer" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">⋯</ci><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.2">expectation</csymbol><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.2">𝑏</ci><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.1.1.3">𝑁</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">\mathcal{V}^{\text{b}}=\{&lt;b_{1}&gt;,\cdots,&lt;b_{N}&gt;\}</annotation></semantics></math> where the phrase-level bias tokens represent the bias phrases with the single entities for the <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">N</annotation></semantics></math> bias phrases in the bias list <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\bm{B}</annotation></semantics></math>.
Unlike Eq. (<a href="#S2.E2" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), the bias decoder estimates the next token <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="y^{\prime}_{s}\in\{\mathcal{V}^{\text{n}}\cup\mathcal{V}^{\text{b}}\}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msubsup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2.2" xref="S3.SS2.p1.4.m4.1.1.3.2.2.cmml">y</mi><mi id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">s</mi><mo id="S3.SS2.p1.4.m4.1.1.3.2.3" xref="S3.SS2.p1.4.m4.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">∈</mo><mrow id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.cmml"><msup id="S3.SS2.p1.4.m4.1.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml">𝒱</mi><mtext id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3a.cmml">n</mtext></msup><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.cmml">∪</mo><msup id="S3.SS2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml">𝒱</mi><mtext id="S3.SS2.p1.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.3a.cmml">b</mtext></msup></mrow><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"></in><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.2">𝑦</ci><ci id="S3.SS2.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3">′</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">𝑠</ci></apply><set id="S3.SS2.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1"><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"><union id="S3.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1"></union><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2">𝒱</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3">n</mtext></ci></apply><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.2">𝒱</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.3.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.SS2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.3">b</mtext></ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">y^{\prime}_{s}\in\{\mathcal{V}^{\text{n}}\cup\mathcal{V}^{\text{b}}\}</annotation></semantics></math> given <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\bm{H}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\bm{H}</annotation></semantics></math>, <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\bm{V}</annotation></semantics></math> in Eqs. (<a href="#S2.E1" title="In 2.1 Audio encoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and (<a href="#S3.E10" title="In 3.1 Bias encoder ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), and <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="y^{\prime}_{0:s-1}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msubsup id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">y</mi><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mn id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">:</mo><mrow id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.3.2" xref="S3.SS2.p1.7.m7.1.1.3.3.2.cmml">s</mi><mo id="S3.SS2.p1.7.m7.1.1.3.3.1" xref="S3.SS2.p1.7.m7.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.p1.7.m7.1.1.3.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝑦</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3">′</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><ci id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1">:</ci><cn type="integer" id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">0</cn><apply id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3"><minus id="S3.SS2.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.1"></minus><ci id="S3.SS2.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">y^{\prime}_{0:s-1}</annotation></semantics></math> as follows:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.5" class="ltx_Math" alttext="P(y^{\prime}_{s}|y^{\prime}_{0:s-1},\bm{X},\bm{B})=\mathrm{BiasDecoder}(y^{\prime}_{0:s-1},\bm{H},\bm{V})." display="block"><semantics id="S3.E11.m1.5a"><mrow id="S3.E11.m1.5.5.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1.1" xref="S3.E11.m1.5.5.1.1.1.cmml"><mi id="S3.E11.m1.5.5.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.5.5.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.5.5.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E11.m1.5.5.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.3.cmml">s</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo fence="false" id="S3.E11.m1.5.5.1.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝑿</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">𝑩</mi></mrow></mrow><mo stretchy="false" id="S3.E11.m1.5.5.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.3" xref="S3.E11.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E11.m1.5.5.1.1.2" xref="S3.E11.m1.5.5.1.1.2.cmml"><mi id="S3.E11.m1.5.5.1.1.2.3" xref="S3.E11.m1.5.5.1.1.2.3.cmml">BiasDecoder</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.5.5.1.1.2.2" xref="S3.E11.m1.5.5.1.1.2.2.cmml">​</mo><mrow id="S3.E11.m1.5.5.1.1.2.1.1" xref="S3.E11.m1.5.5.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.5.5.1.1.2.1.1.2" xref="S3.E11.m1.5.5.1.1.2.1.2.cmml">(</mo><msubsup id="S3.E11.m1.5.5.1.1.2.1.1.1" xref="S3.E11.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S3.E11.m1.5.5.1.1.2.1.1.1.2.2" xref="S3.E11.m1.5.5.1.1.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.E11.m1.5.5.1.1.2.1.1.1.3" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.cmml"><mn id="S3.E11.m1.5.5.1.1.2.1.1.1.3.2" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E11.m1.5.5.1.1.2.1.1.1.3.1" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.1.cmml">:</mo><mrow id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.cmml"><mi id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.2" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.1" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.3" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.2.1.1.1.2.3" xref="S3.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E11.m1.5.5.1.1.2.1.1.3" xref="S3.E11.m1.5.5.1.1.2.1.2.cmml">,</mo><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">𝑯</mi><mo id="S3.E11.m1.5.5.1.1.2.1.1.4" xref="S3.E11.m1.5.5.1.1.2.1.2.cmml">,</mo><mi id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml">𝑽</mi><mo stretchy="false" id="S3.E11.m1.5.5.1.1.2.1.1.5" xref="S3.E11.m1.5.5.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m1.5.5.1.2" xref="S3.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.5b"><apply id="S3.E11.m1.5.5.1.1.cmml" xref="S3.E11.m1.5.5.1"><eq id="S3.E11.m1.5.5.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.3"></eq><apply id="S3.E11.m1.5.5.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1"><times id="S3.E11.m1.5.5.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.2"></times><ci id="S3.E11.m1.5.5.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.3">𝑃</ci><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1"><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">0</cn><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑿</ci><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝑩</ci></list></apply></apply><apply id="S3.E11.m1.5.5.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.2"><times id="S3.E11.m1.5.5.1.1.2.2.cmml" xref="S3.E11.m1.5.5.1.1.2.2"></times><ci id="S3.E11.m1.5.5.1.1.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.3">BiasDecoder</ci><vector id="S3.E11.m1.5.5.1.1.2.1.2.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1"><apply id="S3.E11.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1">subscript</csymbol><apply id="S3.E11.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1">superscript</csymbol><ci id="S3.E11.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.2.2">𝑦</ci><ci id="S3.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.2.3">′</ci></apply><apply id="S3.E11.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3"><ci id="S3.E11.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.1">:</ci><cn type="integer" id="S3.E11.m1.5.5.1.1.2.1.1.1.3.2.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.2">0</cn><apply id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3"><minus id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.1.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.1"></minus><ci id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.2.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.3.cmml" xref="S3.E11.m1.5.5.1.1.2.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3">𝑯</ci><ci id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4">𝑽</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.5c">P(y^{\prime}_{s}|y^{\prime}_{0:s-1},\bm{X},\bm{B})=\mathrm{BiasDecoder}(y^{\prime}_{0:s-1},\bm{H},\bm{V}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.15" class="ltx_p">For example, if a bias phrase ``<span id="S3.SS2.p1.15.5" class="ltx_text ltx_font_italic">Nelly</span>'' exists in the bias list, the bias decoder outputs the corresponding bias token [<math id="S3.SS2.p1.8.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS2.p1.8.m1.1a"><mo id="S3.SS2.p1.8.m1.1.1" xref="S3.SS2.p1.8.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m1.1b"><lt id="S3.SS2.p1.8.m1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m1.1c">&lt;</annotation></semantics></math><span id="S3.SS2.p1.9.1" class="ltx_text ltx_font_bold ltx_font_italic">Nelly<math id="S3.SS2.p1.9.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS2.p1.9.1.m1.1a"><mo id="S3.SS2.p1.9.1.m1.1.1" xref="S3.SS2.p1.9.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.1.m1.1b"><gt id="S3.SS2.p1.9.1.m1.1.1.cmml" xref="S3.SS2.p1.9.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.1.m1.1c">&gt;</annotation></semantics></math></span>] rather than the normal token sequence [<math id="S3.SS2.p1.10.m2.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS2.p1.10.m2.1a"><mo id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><lt id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">&lt;</annotation></semantics></math><span id="S3.SS2.p1.11.2" class="ltx_text ltx_font_italic">N<math id="S3.SS2.p1.11.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS2.p1.11.2.m1.1a"><mo id="S3.SS2.p1.11.2.m1.1.1" xref="S3.SS2.p1.11.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.2.m1.1b"><gt id="S3.SS2.p1.11.2.m1.1.1.cmml" xref="S3.SS2.p1.11.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.2.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS2.p1.12.m3.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS2.p1.12.m3.1a"><mo id="S3.SS2.p1.12.m3.1.1" xref="S3.SS2.p1.12.m3.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m3.1b"><lt id="S3.SS2.p1.12.m3.1.1.cmml" xref="S3.SS2.p1.12.m3.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m3.1c">&lt;</annotation></semantics></math><span id="S3.SS2.p1.13.3" class="ltx_text ltx_font_italic">el<math id="S3.SS2.p1.13.3.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS2.p1.13.3.m1.1a"><mo id="S3.SS2.p1.13.3.m1.1.1" xref="S3.SS2.p1.13.3.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.3.m1.1b"><gt id="S3.SS2.p1.13.3.m1.1.1.cmml" xref="S3.SS2.p1.13.3.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.3.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS2.p1.14.m4.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS2.p1.14.m4.1a"><mo id="S3.SS2.p1.14.m4.1.1" xref="S3.SS2.p1.14.m4.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m4.1b"><lt id="S3.SS2.p1.14.m4.1.1.cmml" xref="S3.SS2.p1.14.m4.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m4.1c">&lt;</annotation></semantics></math><span id="S3.SS2.p1.15.4" class="ltx_text ltx_font_italic">ly<math id="S3.SS2.p1.15.4.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS2.p1.15.4.m1.1a"><mo id="S3.SS2.p1.15.4.m1.1.1" xref="S3.SS2.p1.15.4.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.4.m1.1b"><gt id="S3.SS2.p1.15.4.m1.1.1.cmml" xref="S3.SS2.p1.15.4.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.4.m1.1c">&gt;</annotation></semantics></math></span>].</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.6" class="ltx_p">The bias decoder comprises an extended embedding layer, <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="M_{d}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">M_{d}</annotation></semantics></math> transformer blocks, and an extended output layer.
First, the input token sequence <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="y^{\prime}_{0:s-1}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msubsup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">y</mi><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mn id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p2.2.m2.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">:</mo><mrow id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.3.2" xref="S3.SS2.p2.2.m2.1.1.3.3.2.cmml">s</mi><mo id="S3.SS2.p2.2.m2.1.1.3.3.1" xref="S3.SS2.p2.2.m2.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.p2.2.m2.1.1.3.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">′</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><ci id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.1">:</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">0</cn><apply id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3"><minus id="S3.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.1"></minus><ci id="S3.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">y^{\prime}_{0:s-1}</annotation></semantics></math> is converted to the embedding vector sequence <math id="S3.SS2.p2.3.m3.3" class="ltx_Math" alttext="\bm{E}^{\prime}_{0:s-1}=[\bm{e}^{\prime}_{0},...,\bm{e}^{\prime}_{s-1}]\in\mathbb{R}^{d\times s}" display="inline"><semantics id="S3.SS2.p2.3.m3.3a"><mrow id="S3.SS2.p2.3.m3.3.3" xref="S3.SS2.p2.3.m3.3.3.cmml"><msubsup id="S3.SS2.p2.3.m3.3.3.4" xref="S3.SS2.p2.3.m3.3.3.4.cmml"><mi id="S3.SS2.p2.3.m3.3.3.4.2.2" xref="S3.SS2.p2.3.m3.3.3.4.2.2.cmml">𝑬</mi><mrow id="S3.SS2.p2.3.m3.3.3.4.3" xref="S3.SS2.p2.3.m3.3.3.4.3.cmml"><mn id="S3.SS2.p2.3.m3.3.3.4.3.2" xref="S3.SS2.p2.3.m3.3.3.4.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p2.3.m3.3.3.4.3.1" xref="S3.SS2.p2.3.m3.3.3.4.3.1.cmml">:</mo><mrow id="S3.SS2.p2.3.m3.3.3.4.3.3" xref="S3.SS2.p2.3.m3.3.3.4.3.3.cmml"><mi id="S3.SS2.p2.3.m3.3.3.4.3.3.2" xref="S3.SS2.p2.3.m3.3.3.4.3.3.2.cmml">s</mi><mo id="S3.SS2.p2.3.m3.3.3.4.3.3.1" xref="S3.SS2.p2.3.m3.3.3.4.3.3.1.cmml">−</mo><mn id="S3.SS2.p2.3.m3.3.3.4.3.3.3" xref="S3.SS2.p2.3.m3.3.3.4.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS2.p2.3.m3.3.3.4.2.3" xref="S3.SS2.p2.3.m3.3.3.4.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.p2.3.m3.3.3.5" xref="S3.SS2.p2.3.m3.3.3.5.cmml">=</mo><mrow id="S3.SS2.p2.3.m3.3.3.2.2" xref="S3.SS2.p2.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.3.3.2.2.3" xref="S3.SS2.p2.3.m3.3.3.2.3.cmml">[</mo><msubsup id="S3.SS2.p2.3.m3.2.2.1.1.1" xref="S3.SS2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.2.2.1.1.1.2.2" xref="S3.SS2.p2.3.m3.2.2.1.1.1.2.2.cmml">𝒆</mi><mn id="S3.SS2.p2.3.m3.2.2.1.1.1.3" xref="S3.SS2.p2.3.m3.2.2.1.1.1.3.cmml">0</mn><mo id="S3.SS2.p2.3.m3.2.2.1.1.1.2.3" xref="S3.SS2.p2.3.m3.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.p2.3.m3.3.3.2.2.4" xref="S3.SS2.p2.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p2.3.m3.3.3.2.2.5" xref="S3.SS2.p2.3.m3.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.3.m3.3.3.2.2.2" xref="S3.SS2.p2.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.3.3.2.2.2.2.2" xref="S3.SS2.p2.3.m3.3.3.2.2.2.2.2.cmml">𝒆</mi><mrow id="S3.SS2.p2.3.m3.3.3.2.2.2.3" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p2.3.m3.3.3.2.2.2.3.2" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.2.cmml">s</mi><mo id="S3.SS2.p2.3.m3.3.3.2.2.2.3.1" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p2.3.m3.3.3.2.2.2.3.3" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.3.m3.3.3.2.2.2.2.3" xref="S3.SS2.p2.3.m3.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.SS2.p2.3.m3.3.3.2.2.6" xref="S3.SS2.p2.3.m3.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p2.3.m3.3.3.6" xref="S3.SS2.p2.3.m3.3.3.6.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.3.3.7" xref="S3.SS2.p2.3.m3.3.3.7.cmml"><mi id="S3.SS2.p2.3.m3.3.3.7.2" xref="S3.SS2.p2.3.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.3.m3.3.3.7.3" xref="S3.SS2.p2.3.m3.3.3.7.3.cmml"><mi id="S3.SS2.p2.3.m3.3.3.7.3.2" xref="S3.SS2.p2.3.m3.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.3.m3.3.3.7.3.1" xref="S3.SS2.p2.3.m3.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.p2.3.m3.3.3.7.3.3" xref="S3.SS2.p2.3.m3.3.3.7.3.3.cmml">s</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.3b"><apply id="S3.SS2.p2.3.m3.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3"><and id="S3.SS2.p2.3.m3.3.3a.cmml" xref="S3.SS2.p2.3.m3.3.3"></and><apply id="S3.SS2.p2.3.m3.3.3b.cmml" xref="S3.SS2.p2.3.m3.3.3"><eq id="S3.SS2.p2.3.m3.3.3.5.cmml" xref="S3.SS2.p2.3.m3.3.3.5"></eq><apply id="S3.SS2.p2.3.m3.3.3.4.cmml" xref="S3.SS2.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.4.1.cmml" xref="S3.SS2.p2.3.m3.3.3.4">subscript</csymbol><apply id="S3.SS2.p2.3.m3.3.3.4.2.cmml" xref="S3.SS2.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.4.2.1.cmml" xref="S3.SS2.p2.3.m3.3.3.4">superscript</csymbol><ci id="S3.SS2.p2.3.m3.3.3.4.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.4.2.2">𝑬</ci><ci id="S3.SS2.p2.3.m3.3.3.4.2.3.cmml" xref="S3.SS2.p2.3.m3.3.3.4.2.3">′</ci></apply><apply id="S3.SS2.p2.3.m3.3.3.4.3.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3"><ci id="S3.SS2.p2.3.m3.3.3.4.3.1.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.1">:</ci><cn type="integer" id="S3.SS2.p2.3.m3.3.3.4.3.2.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.2">0</cn><apply id="S3.SS2.p2.3.m3.3.3.4.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.3"><minus id="S3.SS2.p2.3.m3.3.3.4.3.3.1.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.3.1"></minus><ci id="S3.SS2.p2.3.m3.3.3.4.3.3.2.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p2.3.m3.3.3.4.3.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3.4.3.3.3">1</cn></apply></apply></apply><list id="S3.SS2.p2.3.m3.3.3.2.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2"><apply id="S3.SS2.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1.2.2">𝒆</ci><ci id="S3.SS2.p2.3.m3.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1.2.3">′</ci></apply><cn type="integer" id="S3.SS2.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.1.3">0</cn></apply><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">…</ci><apply id="S3.SS2.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.2.2">𝒆</ci><ci id="S3.SS2.p2.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.2.3">′</ci></apply><apply id="S3.SS2.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3"><minus id="S3.SS2.p2.3.m3.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.1"></minus><ci id="S3.SS2.p2.3.m3.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p2.3.m3.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.SS2.p2.3.m3.3.3c.cmml" xref="S3.SS2.p2.3.m3.3.3"><in id="S3.SS2.p2.3.m3.3.3.6.cmml" xref="S3.SS2.p2.3.m3.3.3.6"></in><share href="#S3.SS2.p2.3.m3.3.3.2.cmml" id="S3.SS2.p2.3.m3.3.3d.cmml" xref="S3.SS2.p2.3.m3.3.3"></share><apply id="S3.SS2.p2.3.m3.3.3.7.cmml" xref="S3.SS2.p2.3.m3.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.7.1.cmml" xref="S3.SS2.p2.3.m3.3.3.7">superscript</csymbol><ci id="S3.SS2.p2.3.m3.3.3.7.2.cmml" xref="S3.SS2.p2.3.m3.3.3.7.2">ℝ</ci><apply id="S3.SS2.p2.3.m3.3.3.7.3.cmml" xref="S3.SS2.p2.3.m3.3.3.7.3"><times id="S3.SS2.p2.3.m3.3.3.7.3.1.cmml" xref="S3.SS2.p2.3.m3.3.3.7.3.1"></times><ci id="S3.SS2.p2.3.m3.3.3.7.3.2.cmml" xref="S3.SS2.p2.3.m3.3.3.7.3.2">𝑑</ci><ci id="S3.SS2.p2.3.m3.3.3.7.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3.7.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.3c">\bm{E}^{\prime}_{0:s-1}=[\bm{e}^{\prime}_{0},...,\bm{e}^{\prime}_{s-1}]\in\mathbb{R}^{d\times s}</annotation></semantics></math>.
Unlike Eq. (<a href="#S2.E3" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), if the input token <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="y^{\prime}_{s-1}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msubsup id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.cmml">y</mi><mrow id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.4.m4.1.1.2.3" xref="S3.SS2.p2.4.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3">′</ci></apply><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><minus id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.1"></minus><ci id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">y^{\prime}_{s-1}</annotation></semantics></math> is a bias token, the corresponding bias embedding <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\bm{v}_{n}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">𝒗</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝒗</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\bm{v}_{n}</annotation></semantics></math> is extracted from <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\bm{V}</annotation></semantics></math> (Figure <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>), otherwise, the embedding layer is used with a linear layer as follows:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.4" class="ltx_Math" alttext="\bm{e}^{\prime}_{s-1}=\begin{cases}\mathrm{Linear}(\mathrm{Extract}(\bm{V},y^{\prime}_{s-1}))&amp;(y^{\prime}_{s-1}\in\mathcal{V}^{\text{b}})\\
\mathrm{Linear}(\mathrm{Embedding}(y^{\prime}_{s-1}))&amp;(y^{\prime}_{s-1}\in\mathcal{V}^{\text{n}}).\end{cases}" display="block"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4.5" xref="S3.E12.m1.4.5.cmml"><msubsup id="S3.E12.m1.4.5.2" xref="S3.E12.m1.4.5.2.cmml"><mi id="S3.E12.m1.4.5.2.2.2" xref="S3.E12.m1.4.5.2.2.2.cmml">𝒆</mi><mrow id="S3.E12.m1.4.5.2.3" xref="S3.E12.m1.4.5.2.3.cmml"><mi id="S3.E12.m1.4.5.2.3.2" xref="S3.E12.m1.4.5.2.3.2.cmml">s</mi><mo id="S3.E12.m1.4.5.2.3.1" xref="S3.E12.m1.4.5.2.3.1.cmml">−</mo><mn id="S3.E12.m1.4.5.2.3.3" xref="S3.E12.m1.4.5.2.3.3.cmml">1</mn></mrow><mo id="S3.E12.m1.4.5.2.2.3" xref="S3.E12.m1.4.5.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.4.5.1" xref="S3.E12.m1.4.5.1.cmml">=</mo><mrow id="S3.E12.m1.4.4" xref="S3.E12.m1.4.5.3.1.cmml"><mo id="S3.E12.m1.4.4.5" xref="S3.E12.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E12.m1.4.4.4" xref="S3.E12.m1.4.5.3.1.cmml"><mtr id="S3.E12.m1.4.4.4a" xref="S3.E12.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4b" xref="S3.E12.m1.4.5.3.1.cmml"><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.4" xref="S3.E12.m1.1.1.1.1.1.1.4.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.2.1" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.2.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.2.1.1" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.2.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.3.cmml">Extract</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.2.cmml">(</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.cmml">𝑽</mi><mo id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.2.cmml">,</mo><msubsup id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.1" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.4" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.2.1.3" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4c" xref="S3.E12.m1.4.5.3.1.cmml"><mrow id="S3.E12.m1.2.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.2.2.2.1.1.2" xref="S3.E12.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.2.2.2.2.2.1.1.1" xref="S3.E12.m1.2.2.2.2.2.1.1.1.cmml"><msubsup id="S3.E12.m1.2.2.2.2.2.1.1.1.2" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.2" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.2" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.2.cmml">s</mi><mo id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.1" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.2.2.2.2.2.1.1.1.1" xref="S3.E12.m1.2.2.2.2.2.1.1.1.1.cmml">∈</mo><msup id="S3.E12.m1.2.2.2.2.2.1.1.1.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.2.2.2.2.2.1.1.1.3.2" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝒱</mi><mtext id="S3.E12.m1.2.2.2.2.2.1.1.1.3.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.3a.cmml">b</mtext></msup></mrow><mo stretchy="false" id="S3.E12.m1.2.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mtd></mtr><mtr id="S3.E12.m1.4.4.4d" xref="S3.E12.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4e" xref="S3.E12.m1.4.5.3.1.cmml"><mrow id="S3.E12.m1.3.3.3.3.1.1" xref="S3.E12.m1.3.3.3.3.1.1.cmml"><mi id="S3.E12.m1.3.3.3.3.1.1.3" xref="S3.E12.m1.3.3.3.3.1.1.3.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.3.3.1.1.2" xref="S3.E12.m1.3.3.3.3.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.3.3.3.3.1.1.1.1" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.3.3.1.1.1.1.2" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.3.3.3.3.1.1.1.1.1" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.3.cmml">Embedding</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.1" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E12.m1.3.3.3.3.1.1.1.1.3" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4f" xref="S3.E12.m1.4.5.3.1.cmml"><mrow id="S3.E12.m1.4.4.4.4.2.1.1" xref="S3.E12.m1.4.5.3.1.cmml"><mrow id="S3.E12.m1.4.4.4.4.2.1.1.1.1" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.2" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.cmml"><msubsup id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.2" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.2" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.1" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.1" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.1.cmml">∈</mo><msup id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.2" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.2.cmml">𝒱</mi><mtext id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3a.cmml">n</mtext></msup></mrow><mo stretchy="false" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.3" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" id="S3.E12.m1.4.4.4.4.2.1.1.2" xref="S3.E12.m1.4.5.3.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.4b"><apply id="S3.E12.m1.4.5.cmml" xref="S3.E12.m1.4.5"><eq id="S3.E12.m1.4.5.1.cmml" xref="S3.E12.m1.4.5.1"></eq><apply id="S3.E12.m1.4.5.2.cmml" xref="S3.E12.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.5.2.1.cmml" xref="S3.E12.m1.4.5.2">subscript</csymbol><apply id="S3.E12.m1.4.5.2.2.cmml" xref="S3.E12.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.5.2.2.1.cmml" xref="S3.E12.m1.4.5.2">superscript</csymbol><ci id="S3.E12.m1.4.5.2.2.2.cmml" xref="S3.E12.m1.4.5.2.2.2">𝒆</ci><ci id="S3.E12.m1.4.5.2.2.3.cmml" xref="S3.E12.m1.4.5.2.2.3">′</ci></apply><apply id="S3.E12.m1.4.5.2.3.cmml" xref="S3.E12.m1.4.5.2.3"><minus id="S3.E12.m1.4.5.2.3.1.cmml" xref="S3.E12.m1.4.5.2.3.1"></minus><ci id="S3.E12.m1.4.5.2.3.2.cmml" xref="S3.E12.m1.4.5.2.3.2">𝑠</ci><cn type="integer" id="S3.E12.m1.4.5.2.3.3.cmml" xref="S3.E12.m1.4.5.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.4.5.3.1.cmml" xref="S3.E12.m1.4.4"><csymbol cd="latexml" id="S3.E12.m1.4.5.3.1.1.cmml" xref="S3.E12.m1.4.4.5">cases</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3"></times><ci id="S3.E12.m1.1.1.1.1.1.1.4.cmml" xref="S3.E12.m1.1.1.1.1.1.1.4">Linear</ci><apply id="S3.E12.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1"><times id="S3.E12.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.2"></times><ci id="S3.E12.m1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.3">Extract</ci><interval closure="open" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1"><ci id="S3.E12.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1">𝑽</ci><apply id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3"><minus id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.2">𝑠</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.1.1.1.1.1.3.3">1</cn></apply></apply></interval></apply></apply><apply id="S3.E12.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1"><in id="S3.E12.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.1"></in><apply id="S3.E12.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.2">𝑦</ci><ci id="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.2.3">′</ci></apply><apply id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3"><minus id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.1"></minus><ci id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E12.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.2">𝒱</ci><ci id="S3.E12.m1.2.2.2.2.2.1.1.1.3.3a.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.3"><mtext mathsize="70%" id="S3.E12.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E12.m1.2.2.2.2.2.1.1.1.3.3">b</mtext></ci></apply></apply><apply id="S3.E12.m1.3.3.3.3.1.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1"><times id="S3.E12.m1.3.3.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.3.3.1.1.2"></times><ci id="S3.E12.m1.3.3.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.3.3.1.1.3">Linear</ci><apply id="S3.E12.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1"><times id="S3.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.2"></times><ci id="S3.E12.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.3">Embedding</ci><apply id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3"><minus id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.2">𝑠</ci><cn type="integer" id="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1"><in id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.1"></in><apply id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.2.3">′</ci></apply><apply id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3"><minus id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.1"></minus><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.2">𝒱</ci><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3a.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.1.3.3">n</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.4c">\bm{e}^{\prime}_{s-1}=\begin{cases}\mathrm{Linear}(\mathrm{Extract}(\bm{V},y^{\prime}_{s-1}))&amp;(y^{\prime}_{s-1}\in\mathcal{V}^{\text{b}})\\
\mathrm{Linear}(\mathrm{Embedding}(y^{\prime}_{s-1}))&amp;(y^{\prime}_{s-1}\in\mathcal{V}^{\text{n}}).\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.11" class="ltx_p">Then, the <math id="S3.SS2.p2.7.m1.1" class="ltx_Math" alttext="M_{d}" display="inline"><semantics id="S3.SS2.p2.7.m1.1a"><msub id="S3.SS2.p2.7.m1.1.1" xref="S3.SS2.p2.7.m1.1.1.cmml"><mi id="S3.SS2.p2.7.m1.1.1.2" xref="S3.SS2.p2.7.m1.1.1.2.cmml">M</mi><mi id="S3.SS2.p2.7.m1.1.1.3" xref="S3.SS2.p2.7.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m1.1b"><apply id="S3.SS2.p2.7.m1.1.1.cmml" xref="S3.SS2.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m1.1.1.1.cmml" xref="S3.SS2.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m1.1.1.2.cmml" xref="S3.SS2.p2.7.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p2.7.m1.1.1.3.cmml" xref="S3.SS2.p2.7.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m1.1c">M_{d}</annotation></semantics></math> transformer blocks convert <math id="S3.SS2.p2.8.m2.1" class="ltx_Math" alttext="\bm{E}^{\prime}_{0:s-1}" display="inline"><semantics id="S3.SS2.p2.8.m2.1a"><msubsup id="S3.SS2.p2.8.m2.1.1" xref="S3.SS2.p2.8.m2.1.1.cmml"><mi id="S3.SS2.p2.8.m2.1.1.2.2" xref="S3.SS2.p2.8.m2.1.1.2.2.cmml">𝑬</mi><mrow id="S3.SS2.p2.8.m2.1.1.3" xref="S3.SS2.p2.8.m2.1.1.3.cmml"><mn id="S3.SS2.p2.8.m2.1.1.3.2" xref="S3.SS2.p2.8.m2.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p2.8.m2.1.1.3.1" xref="S3.SS2.p2.8.m2.1.1.3.1.cmml">:</mo><mrow id="S3.SS2.p2.8.m2.1.1.3.3" xref="S3.SS2.p2.8.m2.1.1.3.3.cmml"><mi id="S3.SS2.p2.8.m2.1.1.3.3.2" xref="S3.SS2.p2.8.m2.1.1.3.3.2.cmml">s</mi><mo id="S3.SS2.p2.8.m2.1.1.3.3.1" xref="S3.SS2.p2.8.m2.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.p2.8.m2.1.1.3.3.3" xref="S3.SS2.p2.8.m2.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.SS2.p2.8.m2.1.1.2.3" xref="S3.SS2.p2.8.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m2.1b"><apply id="S3.SS2.p2.8.m2.1.1.cmml" xref="S3.SS2.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m2.1.1.1.cmml" xref="S3.SS2.p2.8.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.8.m2.1.1.2.cmml" xref="S3.SS2.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m2.1.1.2.1.cmml" xref="S3.SS2.p2.8.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.8.m2.1.1.2.2.cmml" xref="S3.SS2.p2.8.m2.1.1.2.2">𝑬</ci><ci id="S3.SS2.p2.8.m2.1.1.2.3.cmml" xref="S3.SS2.p2.8.m2.1.1.2.3">′</ci></apply><apply id="S3.SS2.p2.8.m2.1.1.3.cmml" xref="S3.SS2.p2.8.m2.1.1.3"><ci id="S3.SS2.p2.8.m2.1.1.3.1.cmml" xref="S3.SS2.p2.8.m2.1.1.3.1">:</ci><cn type="integer" id="S3.SS2.p2.8.m2.1.1.3.2.cmml" xref="S3.SS2.p2.8.m2.1.1.3.2">0</cn><apply id="S3.SS2.p2.8.m2.1.1.3.3.cmml" xref="S3.SS2.p2.8.m2.1.1.3.3"><minus id="S3.SS2.p2.8.m2.1.1.3.3.1.cmml" xref="S3.SS2.p2.8.m2.1.1.3.3.1"></minus><ci id="S3.SS2.p2.8.m2.1.1.3.3.2.cmml" xref="S3.SS2.p2.8.m2.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.SS2.p2.8.m2.1.1.3.3.3.cmml" xref="S3.SS2.p2.8.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m2.1c">\bm{E}^{\prime}_{0:s-1}</annotation></semantics></math> to the hidden state vector <math id="S3.SS2.p2.9.m3.1" class="ltx_Math" alttext="\bm{u}^{\prime}_{s}" display="inline"><semantics id="S3.SS2.p2.9.m3.1a"><msubsup id="S3.SS2.p2.9.m3.1.1" xref="S3.SS2.p2.9.m3.1.1.cmml"><mi id="S3.SS2.p2.9.m3.1.1.2.2" xref="S3.SS2.p2.9.m3.1.1.2.2.cmml">𝒖</mi><mi id="S3.SS2.p2.9.m3.1.1.3" xref="S3.SS2.p2.9.m3.1.1.3.cmml">s</mi><mo id="S3.SS2.p2.9.m3.1.1.2.3" xref="S3.SS2.p2.9.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m3.1b"><apply id="S3.SS2.p2.9.m3.1.1.cmml" xref="S3.SS2.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m3.1.1.1.cmml" xref="S3.SS2.p2.9.m3.1.1">subscript</csymbol><apply id="S3.SS2.p2.9.m3.1.1.2.cmml" xref="S3.SS2.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m3.1.1.2.1.cmml" xref="S3.SS2.p2.9.m3.1.1">superscript</csymbol><ci id="S3.SS2.p2.9.m3.1.1.2.2.cmml" xref="S3.SS2.p2.9.m3.1.1.2.2">𝒖</ci><ci id="S3.SS2.p2.9.m3.1.1.2.3.cmml" xref="S3.SS2.p2.9.m3.1.1.2.3">′</ci></apply><ci id="S3.SS2.p2.9.m3.1.1.3.cmml" xref="S3.SS2.p2.9.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m3.1c">\bm{u}^{\prime}_{s}</annotation></semantics></math> as in Eq. (<a href="#S2.E4" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
In addition to the normal token score <math id="S3.SS2.p2.10.m4.1" class="ltx_Math" alttext="\bm{\alpha}^{\text{n}}" display="inline"><semantics id="S3.SS2.p2.10.m4.1a"><msup id="S3.SS2.p2.10.m4.1.1" xref="S3.SS2.p2.10.m4.1.1.cmml"><mi id="S3.SS2.p2.10.m4.1.1.2" xref="S3.SS2.p2.10.m4.1.1.2.cmml">𝜶</mi><mtext id="S3.SS2.p2.10.m4.1.1.3" xref="S3.SS2.p2.10.m4.1.1.3a.cmml">n</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m4.1b"><apply id="S3.SS2.p2.10.m4.1.1.cmml" xref="S3.SS2.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m4.1.1.1.cmml" xref="S3.SS2.p2.10.m4.1.1">superscript</csymbol><ci id="S3.SS2.p2.10.m4.1.1.2.cmml" xref="S3.SS2.p2.10.m4.1.1.2">𝜶</ci><ci id="S3.SS2.p2.10.m4.1.1.3a.cmml" xref="S3.SS2.p2.10.m4.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.10.m4.1.1.3.cmml" xref="S3.SS2.p2.10.m4.1.1.3">n</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m4.1c">\bm{\alpha}^{\text{n}}</annotation></semantics></math> in Eq. (<a href="#S2.E5" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), the bias token score <math id="S3.SS2.p2.11.m5.3" class="ltx_Math" alttext="\bm{\alpha}^{\text{b}}=[\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]" display="inline"><semantics id="S3.SS2.p2.11.m5.3a"><mrow id="S3.SS2.p2.11.m5.3.3" xref="S3.SS2.p2.11.m5.3.3.cmml"><msup id="S3.SS2.p2.11.m5.3.3.4" xref="S3.SS2.p2.11.m5.3.3.4.cmml"><mi id="S3.SS2.p2.11.m5.3.3.4.2" xref="S3.SS2.p2.11.m5.3.3.4.2.cmml">𝜶</mi><mtext id="S3.SS2.p2.11.m5.3.3.4.3" xref="S3.SS2.p2.11.m5.3.3.4.3a.cmml">b</mtext></msup><mo id="S3.SS2.p2.11.m5.3.3.3" xref="S3.SS2.p2.11.m5.3.3.3.cmml">=</mo><mrow id="S3.SS2.p2.11.m5.3.3.2.2" xref="S3.SS2.p2.11.m5.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.11.m5.3.3.2.2.3" xref="S3.SS2.p2.11.m5.3.3.2.3.cmml">[</mo><msubsup id="S3.SS2.p2.11.m5.2.2.1.1.1" xref="S3.SS2.p2.11.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.11.m5.2.2.1.1.1.2.2" xref="S3.SS2.p2.11.m5.2.2.1.1.1.2.2.cmml">α</mi><mn id="S3.SS2.p2.11.m5.2.2.1.1.1.3" xref="S3.SS2.p2.11.m5.2.2.1.1.1.3.cmml">1</mn><mtext id="S3.SS2.p2.11.m5.2.2.1.1.1.2.3" xref="S3.SS2.p2.11.m5.2.2.1.1.1.2.3a.cmml">b</mtext></msubsup><mo id="S3.SS2.p2.11.m5.3.3.2.2.4" xref="S3.SS2.p2.11.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.11.m5.1.1" xref="S3.SS2.p2.11.m5.1.1.cmml">…</mi><mo id="S3.SS2.p2.11.m5.3.3.2.2.5" xref="S3.SS2.p2.11.m5.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.11.m5.3.3.2.2.2" xref="S3.SS2.p2.11.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.p2.11.m5.3.3.2.2.2.2.2" xref="S3.SS2.p2.11.m5.3.3.2.2.2.2.2.cmml">α</mi><mi id="S3.SS2.p2.11.m5.3.3.2.2.2.3" xref="S3.SS2.p2.11.m5.3.3.2.2.2.3.cmml">N</mi><mtext id="S3.SS2.p2.11.m5.3.3.2.2.2.2.3" xref="S3.SS2.p2.11.m5.3.3.2.2.2.2.3a.cmml">b</mtext></msubsup><mo stretchy="false" id="S3.SS2.p2.11.m5.3.3.2.2.6" xref="S3.SS2.p2.11.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m5.3b"><apply id="S3.SS2.p2.11.m5.3.3.cmml" xref="S3.SS2.p2.11.m5.3.3"><eq id="S3.SS2.p2.11.m5.3.3.3.cmml" xref="S3.SS2.p2.11.m5.3.3.3"></eq><apply id="S3.SS2.p2.11.m5.3.3.4.cmml" xref="S3.SS2.p2.11.m5.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m5.3.3.4.1.cmml" xref="S3.SS2.p2.11.m5.3.3.4">superscript</csymbol><ci id="S3.SS2.p2.11.m5.3.3.4.2.cmml" xref="S3.SS2.p2.11.m5.3.3.4.2">𝜶</ci><ci id="S3.SS2.p2.11.m5.3.3.4.3a.cmml" xref="S3.SS2.p2.11.m5.3.3.4.3"><mtext mathsize="70%" id="S3.SS2.p2.11.m5.3.3.4.3.cmml" xref="S3.SS2.p2.11.m5.3.3.4.3">b</mtext></ci></apply><list id="S3.SS2.p2.11.m5.3.3.2.3.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2"><apply id="S3.SS2.p2.11.m5.2.2.1.1.1.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.11.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.11.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1.2.2">𝛼</ci><ci id="S3.SS2.p2.11.m5.2.2.1.1.1.2.3a.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S3.SS2.p2.11.m5.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1.2.3">b</mtext></ci></apply><cn type="integer" id="S3.SS2.p2.11.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.11.m5.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p2.11.m5.1.1.cmml" xref="S3.SS2.p2.11.m5.1.1">…</ci><apply id="S3.SS2.p2.11.m5.3.3.2.2.2.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.11.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m5.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.11.m5.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2.2.2">𝛼</ci><ci id="S3.SS2.p2.11.m5.3.3.2.2.2.2.3a.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S3.SS2.p2.11.m5.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2.2.3">b</mtext></ci></apply><ci id="S3.SS2.p2.11.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.p2.11.m5.3.3.2.2.2.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m5.3c">\bm{\alpha}^{\text{b}}=[\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]</annotation></semantics></math> is calculated using an inner product with linear layers (Figure <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>):</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.3" class="ltx_Math" alttext="\bm{\alpha}^{\text{b}}=\frac{\mathrm{Linear}(\bm{u}^{\prime}_{s})\mathrm{Linear}(\bm{V}^{T})}{\sqrt{d}}." display="block"><semantics id="S3.E13.m1.3a"><mrow id="S3.E13.m1.3.3.1" xref="S3.E13.m1.3.3.1.1.cmml"><mrow id="S3.E13.m1.3.3.1.1" xref="S3.E13.m1.3.3.1.1.cmml"><msup id="S3.E13.m1.3.3.1.1.2" xref="S3.E13.m1.3.3.1.1.2.cmml"><mi id="S3.E13.m1.3.3.1.1.2.2" xref="S3.E13.m1.3.3.1.1.2.2.cmml">𝜶</mi><mtext id="S3.E13.m1.3.3.1.1.2.3" xref="S3.E13.m1.3.3.1.1.2.3a.cmml">b</mtext></msup><mo id="S3.E13.m1.3.3.1.1.1" xref="S3.E13.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml"><mrow id="S3.E13.m1.2.2.2" xref="S3.E13.m1.2.2.2.cmml"><mi id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.4.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.2.3" xref="S3.E13.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.2.2.cmml">𝒖</mi><mi id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S3.E13.m1.1.1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.2.3a" xref="S3.E13.m1.2.2.2.3.cmml">​</mo><mi id="S3.E13.m1.2.2.2.5" xref="S3.E13.m1.2.2.2.5.cmml">Linear</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.2.3b" xref="S3.E13.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E13.m1.2.2.2.2.1" xref="S3.E13.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.2.2.1.2" xref="S3.E13.m1.2.2.2.2.1.1.cmml">(</mo><msup id="S3.E13.m1.2.2.2.2.1.1" xref="S3.E13.m1.2.2.2.2.1.1.cmml"><mi id="S3.E13.m1.2.2.2.2.1.1.2" xref="S3.E13.m1.2.2.2.2.1.1.2.cmml">𝑽</mi><mi id="S3.E13.m1.2.2.2.2.1.1.3" xref="S3.E13.m1.2.2.2.2.1.1.3.cmml">T</mi></msup><mo stretchy="false" id="S3.E13.m1.2.2.2.2.1.3" xref="S3.E13.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><msqrt id="S3.E13.m1.2.2.4" xref="S3.E13.m1.2.2.4.cmml"><mi id="S3.E13.m1.2.2.4.2" xref="S3.E13.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac></mrow><mo lspace="0em" id="S3.E13.m1.3.3.1.2" xref="S3.E13.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.3b"><apply id="S3.E13.m1.3.3.1.1.cmml" xref="S3.E13.m1.3.3.1"><eq id="S3.E13.m1.3.3.1.1.1.cmml" xref="S3.E13.m1.3.3.1.1.1"></eq><apply id="S3.E13.m1.3.3.1.1.2.cmml" xref="S3.E13.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.3.3.1.1.2.1.cmml" xref="S3.E13.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E13.m1.3.3.1.1.2.2.cmml" xref="S3.E13.m1.3.3.1.1.2.2">𝜶</ci><ci id="S3.E13.m1.3.3.1.1.2.3a.cmml" xref="S3.E13.m1.3.3.1.1.2.3"><mtext mathsize="70%" id="S3.E13.m1.3.3.1.1.2.3.cmml" xref="S3.E13.m1.3.3.1.1.2.3">b</mtext></ci></apply><apply id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2"><divide id="S3.E13.m1.2.2.3.cmml" xref="S3.E13.m1.2.2"></divide><apply id="S3.E13.m1.2.2.2.cmml" xref="S3.E13.m1.2.2.2"><times id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.3"></times><ci id="S3.E13.m1.2.2.2.4.cmml" xref="S3.E13.m1.2.2.2.4">Linear</ci><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2">𝒖</ci><ci id="S3.E13.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S3.E13.m1.2.2.2.5.cmml" xref="S3.E13.m1.2.2.2.5">Linear</ci><apply id="S3.E13.m1.2.2.2.2.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E13.m1.2.2.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2">𝑽</ci><ci id="S3.E13.m1.2.2.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3">𝑇</ci></apply></apply><apply id="S3.E13.m1.2.2.4.cmml" xref="S3.E13.m1.2.2.4"><root id="S3.E13.m1.2.2.4a.cmml" xref="S3.E13.m1.2.2.4"></root><ci id="S3.E13.m1.2.2.4.2.cmml" xref="S3.E13.m1.2.2.4.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.3c">\bm{\alpha}^{\text{b}}=\frac{\mathrm{Linear}(\bm{u}^{\prime}_{s})\mathrm{Linear}(\bm{V}^{T})}{\sqrt{d}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.14" class="ltx_p">After <math id="S3.SS2.p2.12.m1.1" class="ltx_Math" alttext="\bm{\alpha}^{\text{b}}" display="inline"><semantics id="S3.SS2.p2.12.m1.1a"><msup id="S3.SS2.p2.12.m1.1.1" xref="S3.SS2.p2.12.m1.1.1.cmml"><mi id="S3.SS2.p2.12.m1.1.1.2" xref="S3.SS2.p2.12.m1.1.1.2.cmml">𝜶</mi><mtext id="S3.SS2.p2.12.m1.1.1.3" xref="S3.SS2.p2.12.m1.1.1.3a.cmml">b</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m1.1b"><apply id="S3.SS2.p2.12.m1.1.1.cmml" xref="S3.SS2.p2.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m1.1.1.1.cmml" xref="S3.SS2.p2.12.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.12.m1.1.1.2.cmml" xref="S3.SS2.p2.12.m1.1.1.2">𝜶</ci><ci id="S3.SS2.p2.12.m1.1.1.3a.cmml" xref="S3.SS2.p2.12.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.12.m1.1.1.3.cmml" xref="S3.SS2.p2.12.m1.1.1.3">b</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m1.1c">\bm{\alpha}^{\text{b}}</annotation></semantics></math> is concatenated with <math id="S3.SS2.p2.13.m2.1" class="ltx_Math" alttext="\bm{\alpha}^{\text{n}}" display="inline"><semantics id="S3.SS2.p2.13.m2.1a"><msup id="S3.SS2.p2.13.m2.1.1" xref="S3.SS2.p2.13.m2.1.1.cmml"><mi id="S3.SS2.p2.13.m2.1.1.2" xref="S3.SS2.p2.13.m2.1.1.2.cmml">𝜶</mi><mtext id="S3.SS2.p2.13.m2.1.1.3" xref="S3.SS2.p2.13.m2.1.1.3a.cmml">n</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m2.1b"><apply id="S3.SS2.p2.13.m2.1.1.cmml" xref="S3.SS2.p2.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m2.1.1.1.cmml" xref="S3.SS2.p2.13.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.13.m2.1.1.2.cmml" xref="S3.SS2.p2.13.m2.1.1.2">𝜶</ci><ci id="S3.SS2.p2.13.m2.1.1.3a.cmml" xref="S3.SS2.p2.13.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.13.m2.1.1.3.cmml" xref="S3.SS2.p2.13.m2.1.1.3">n</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m2.1c">\bm{\alpha}^{\text{n}}</annotation></semantics></math>, resulting in <math id="S3.SS2.p2.14.m3.6" class="ltx_Math" alttext="\bm{\alpha}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K},\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]" display="inline"><semantics id="S3.SS2.p2.14.m3.6a"><mrow id="S3.SS2.p2.14.m3.6.6" xref="S3.SS2.p2.14.m3.6.6.cmml"><mi id="S3.SS2.p2.14.m3.6.6.6" xref="S3.SS2.p2.14.m3.6.6.6.cmml">𝜶</mi><mo id="S3.SS2.p2.14.m3.6.6.5" xref="S3.SS2.p2.14.m3.6.6.5.cmml">=</mo><mrow id="S3.SS2.p2.14.m3.6.6.4.4" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml"><mo stretchy="false" id="S3.SS2.p2.14.m3.6.6.4.4.5" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">[</mo><msubsup id="S3.SS2.p2.14.m3.3.3.1.1.1" xref="S3.SS2.p2.14.m3.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.14.m3.3.3.1.1.1.2.2" xref="S3.SS2.p2.14.m3.3.3.1.1.1.2.2.cmml">α</mi><mn id="S3.SS2.p2.14.m3.3.3.1.1.1.3" xref="S3.SS2.p2.14.m3.3.3.1.1.1.3.cmml">1</mn><mtext id="S3.SS2.p2.14.m3.3.3.1.1.1.2.3" xref="S3.SS2.p2.14.m3.3.3.1.1.1.2.3a.cmml">n</mtext></msubsup><mo id="S3.SS2.p2.14.m3.6.6.4.4.6" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.14.m3.1.1" xref="S3.SS2.p2.14.m3.1.1.cmml">…</mi><mo id="S3.SS2.p2.14.m3.6.6.4.4.7" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS2.p2.14.m3.4.4.2.2.2" xref="S3.SS2.p2.14.m3.4.4.2.2.2.cmml"><mi id="S3.SS2.p2.14.m3.4.4.2.2.2.2.2" xref="S3.SS2.p2.14.m3.4.4.2.2.2.2.2.cmml">α</mi><mi id="S3.SS2.p2.14.m3.4.4.2.2.2.3" xref="S3.SS2.p2.14.m3.4.4.2.2.2.3.cmml">K</mi><mtext id="S3.SS2.p2.14.m3.4.4.2.2.2.2.3" xref="S3.SS2.p2.14.m3.4.4.2.2.2.2.3a.cmml">n</mtext></msubsup><mo id="S3.SS2.p2.14.m3.6.6.4.4.8" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS2.p2.14.m3.5.5.3.3.3" xref="S3.SS2.p2.14.m3.5.5.3.3.3.cmml"><mi id="S3.SS2.p2.14.m3.5.5.3.3.3.2.2" xref="S3.SS2.p2.14.m3.5.5.3.3.3.2.2.cmml">α</mi><mn id="S3.SS2.p2.14.m3.5.5.3.3.3.3" xref="S3.SS2.p2.14.m3.5.5.3.3.3.3.cmml">1</mn><mtext id="S3.SS2.p2.14.m3.5.5.3.3.3.2.3" xref="S3.SS2.p2.14.m3.5.5.3.3.3.2.3a.cmml">b</mtext></msubsup><mo id="S3.SS2.p2.14.m3.6.6.4.4.9" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.14.m3.2.2" xref="S3.SS2.p2.14.m3.2.2.cmml">…</mi><mo id="S3.SS2.p2.14.m3.6.6.4.4.10" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS2.p2.14.m3.6.6.4.4.4" xref="S3.SS2.p2.14.m3.6.6.4.4.4.cmml"><mi id="S3.SS2.p2.14.m3.6.6.4.4.4.2.2" xref="S3.SS2.p2.14.m3.6.6.4.4.4.2.2.cmml">α</mi><mi id="S3.SS2.p2.14.m3.6.6.4.4.4.3" xref="S3.SS2.p2.14.m3.6.6.4.4.4.3.cmml">N</mi><mtext id="S3.SS2.p2.14.m3.6.6.4.4.4.2.3" xref="S3.SS2.p2.14.m3.6.6.4.4.4.2.3a.cmml">b</mtext></msubsup><mo stretchy="false" id="S3.SS2.p2.14.m3.6.6.4.4.11" xref="S3.SS2.p2.14.m3.6.6.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m3.6b"><apply id="S3.SS2.p2.14.m3.6.6.cmml" xref="S3.SS2.p2.14.m3.6.6"><eq id="S3.SS2.p2.14.m3.6.6.5.cmml" xref="S3.SS2.p2.14.m3.6.6.5"></eq><ci id="S3.SS2.p2.14.m3.6.6.6.cmml" xref="S3.SS2.p2.14.m3.6.6.6">𝜶</ci><list id="S3.SS2.p2.14.m3.6.6.4.5.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4"><apply id="S3.SS2.p2.14.m3.3.3.1.1.1.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.14.m3.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.14.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1.2.2">𝛼</ci><ci id="S3.SS2.p2.14.m3.3.3.1.1.1.2.3a.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1.2.3"><mtext mathsize="70%" id="S3.SS2.p2.14.m3.3.3.1.1.1.2.3.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1.2.3">n</mtext></ci></apply><cn type="integer" id="S3.SS2.p2.14.m3.3.3.1.1.1.3.cmml" xref="S3.SS2.p2.14.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS2.p2.14.m3.1.1.cmml" xref="S3.SS2.p2.14.m3.1.1">…</ci><apply id="S3.SS2.p2.14.m3.4.4.2.2.2.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.4.4.2.2.2.1.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.14.m3.4.4.2.2.2.2.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.4.4.2.2.2.2.1.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.14.m3.4.4.2.2.2.2.2.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2.2.2">𝛼</ci><ci id="S3.SS2.p2.14.m3.4.4.2.2.2.2.3a.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2.2.3"><mtext mathsize="70%" id="S3.SS2.p2.14.m3.4.4.2.2.2.2.3.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2.2.3">n</mtext></ci></apply><ci id="S3.SS2.p2.14.m3.4.4.2.2.2.3.cmml" xref="S3.SS2.p2.14.m3.4.4.2.2.2.3">𝐾</ci></apply><apply id="S3.SS2.p2.14.m3.5.5.3.3.3.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.5.5.3.3.3.1.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3">subscript</csymbol><apply id="S3.SS2.p2.14.m3.5.5.3.3.3.2.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.5.5.3.3.3.2.1.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3">superscript</csymbol><ci id="S3.SS2.p2.14.m3.5.5.3.3.3.2.2.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3.2.2">𝛼</ci><ci id="S3.SS2.p2.14.m3.5.5.3.3.3.2.3a.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3.2.3"><mtext mathsize="70%" id="S3.SS2.p2.14.m3.5.5.3.3.3.2.3.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3.2.3">b</mtext></ci></apply><cn type="integer" id="S3.SS2.p2.14.m3.5.5.3.3.3.3.cmml" xref="S3.SS2.p2.14.m3.5.5.3.3.3.3">1</cn></apply><ci id="S3.SS2.p2.14.m3.2.2.cmml" xref="S3.SS2.p2.14.m3.2.2">…</ci><apply id="S3.SS2.p2.14.m3.6.6.4.4.4.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.6.6.4.4.4.1.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4">subscript</csymbol><apply id="S3.SS2.p2.14.m3.6.6.4.4.4.2.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m3.6.6.4.4.4.2.1.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4">superscript</csymbol><ci id="S3.SS2.p2.14.m3.6.6.4.4.4.2.2.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4.2.2">𝛼</ci><ci id="S3.SS2.p2.14.m3.6.6.4.4.4.2.3a.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4.2.3"><mtext mathsize="70%" id="S3.SS2.p2.14.m3.6.6.4.4.4.2.3.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4.2.3">b</mtext></ci></apply><ci id="S3.SS2.p2.14.m3.6.6.4.4.4.3.cmml" xref="S3.SS2.p2.14.m3.6.6.4.4.4.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m3.6c">\bm{\alpha}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K},\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]</annotation></semantics></math>, the softmax function calculates the token-wise probability, including the bias token, as follows:</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.3" class="ltx_Math" alttext="P\left(y^{\prime}_{s}\mid y^{\prime}_{0:s-1},\bm{X},\bm{B}\right)=\mathrm{Softmax}(\mathrm{Concat}(\bm{\alpha}^{\text{n}},\bm{\alpha}^{\text{b}}))." display="block"><semantics id="S3.E14.m1.3a"><mrow id="S3.E14.m1.3.3.1" xref="S3.E14.m1.3.3.1.1.cmml"><mrow id="S3.E14.m1.3.3.1.1" xref="S3.E14.m1.3.3.1.1.cmml"><mrow id="S3.E14.m1.3.3.1.1.1" xref="S3.E14.m1.3.3.1.1.1.cmml"><mi id="S3.E14.m1.3.3.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.3.3.1.1.1.2" xref="S3.E14.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.3.3.1.1.1.1.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E14.m1.3.3.1.1.1.1.1.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.3.3.1.1.1.1.1.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.cmml"><msubsup id="S3.E14.m1.3.3.1.1.1.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.3.cmml">s</mi><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">𝑿</mi><mo id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E14.m1.2.2" xref="S3.E14.m1.2.2.cmml">𝑩</mi></mrow></mrow><mo id="S3.E14.m1.3.3.1.1.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.3.3.1.1.3" xref="S3.E14.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E14.m1.3.3.1.1.2" xref="S3.E14.m1.3.3.1.1.2.cmml"><mi id="S3.E14.m1.3.3.1.1.2.3" xref="S3.E14.m1.3.3.1.1.2.3.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.3.3.1.1.2.2" xref="S3.E14.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E14.m1.3.3.1.1.2.1.1" xref="S3.E14.m1.3.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.3.3.1.1.2.1.1.2" xref="S3.E14.m1.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.3.3.1.1.2.1.1.1" xref="S3.E14.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S3.E14.m1.3.3.1.1.2.1.1.1.4" xref="S3.E14.m1.3.3.1.1.2.1.1.1.4.cmml">Concat</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.3.3.1.1.2.1.1.1.3" xref="S3.E14.m1.3.3.1.1.2.1.1.1.3.cmml">​</mo><mrow id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.3" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.3.cmml">(</mo><msup id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml">𝜶</mi><mtext id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3a.cmml">n</mtext></msup><mo id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.4" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.3.cmml">,</mo><msup id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.cmml"><mi id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.2" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml">𝜶</mi><mtext id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3a.cmml">b</mtext></msup><mo stretchy="false" id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.5" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.3.3.1.1.2.1.1.3" xref="S3.E14.m1.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E14.m1.3.3.1.2" xref="S3.E14.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.3b"><apply id="S3.E14.m1.3.3.1.1.cmml" xref="S3.E14.m1.3.3.1"><eq id="S3.E14.m1.3.3.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.3"></eq><apply id="S3.E14.m1.3.3.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.1"><times id="S3.E14.m1.3.3.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.1.2"></times><ci id="S3.E14.m1.3.3.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.1.3">𝑃</ci><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E14.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">0</cn><apply id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">𝑿</ci><ci id="S3.E14.m1.2.2.cmml" xref="S3.E14.m1.2.2">𝑩</ci></list></apply></apply><apply id="S3.E14.m1.3.3.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.2"><times id="S3.E14.m1.3.3.1.1.2.2.cmml" xref="S3.E14.m1.3.3.1.1.2.2"></times><ci id="S3.E14.m1.3.3.1.1.2.3.cmml" xref="S3.E14.m1.3.3.1.1.2.3">Softmax</ci><apply id="S3.E14.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1"><times id="S3.E14.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.3"></times><ci id="S3.E14.m1.3.3.1.1.2.1.1.1.4.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.4">Concat</ci><interval closure="open" id="S3.E14.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2"><apply id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.2">𝜶</ci><ci id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.1.1.1.3">n</mtext></ci></apply><apply id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.2">𝜶</ci><ci id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3a.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3"><mtext mathsize="70%" id="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E14.m1.3.3.1.1.2.1.1.1.2.2.2.3">b</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.3c">P\left(y^{\prime}_{s}\mid y^{\prime}_{0:s-1},\bm{X},\bm{B}\right)=\mathrm{Softmax}(\mathrm{Concat}(\bm{\alpha}^{\text{n}},\bm{\alpha}^{\text{b}})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.17" class="ltx_p">Similar to Eqs. (<a href="#S2.E7" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and (<a href="#S2.E8" title="In 2.2 Decoder ‣ 2 End-to-end ASR ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), the posterior probability and the loss function are formulated as follows:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.5" class="ltx_Math" alttext="P(y^{\prime}_{0:S^{\prime}}\mid\bm{X},\bm{B})=\prod_{s=1}^{S^{\prime}}P\left(y^{\prime}_{s}\mid y^{\prime}_{0:s-1},\bm{X},\bm{B}\right)," display="block"><semantics id="S3.E15.m1.5a"><mrow id="S3.E15.m1.5.5.1" xref="S3.E15.m1.5.5.1.1.cmml"><mrow id="S3.E15.m1.5.5.1.1" xref="S3.E15.m1.5.5.1.1.cmml"><mrow id="S3.E15.m1.5.5.1.1.1" xref="S3.E15.m1.5.5.1.1.1.cmml"><mi id="S3.E15.m1.5.5.1.1.1.3" xref="S3.E15.m1.5.5.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.5.5.1.1.1.2" xref="S3.E15.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.5.5.1.1.1.1.1" xref="S3.E15.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.5.5.1.1.1.1.1.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.5.5.1.1.1.1.1.1" xref="S3.E15.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E15.m1.5.5.1.1.1.1.1.1.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.1" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">:</mo><msup id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.2.cmml">S</mi><mo id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.3" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.3.cmml">′</mo></msup></mrow><mo id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E15.m1.5.5.1.1.1.1.1.1.1" xref="S3.E15.m1.5.5.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="S3.E15.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E15.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">𝑿</mi><mo id="S3.E15.m1.5.5.1.1.1.1.1.1.3.2.1" xref="S3.E15.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml">𝑩</mi></mrow></mrow><mo stretchy="false" id="S3.E15.m1.5.5.1.1.1.1.1.3" xref="S3.E15.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E15.m1.5.5.1.1.3" xref="S3.E15.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E15.m1.5.5.1.1.2" xref="S3.E15.m1.5.5.1.1.2.cmml"><munderover id="S3.E15.m1.5.5.1.1.2.2" xref="S3.E15.m1.5.5.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E15.m1.5.5.1.1.2.2.2.2" xref="S3.E15.m1.5.5.1.1.2.2.2.2.cmml">∏</mo><mrow id="S3.E15.m1.5.5.1.1.2.2.2.3" xref="S3.E15.m1.5.5.1.1.2.2.2.3.cmml"><mi id="S3.E15.m1.5.5.1.1.2.2.2.3.2" xref="S3.E15.m1.5.5.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.E15.m1.5.5.1.1.2.2.2.3.1" xref="S3.E15.m1.5.5.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E15.m1.5.5.1.1.2.2.2.3.3" xref="S3.E15.m1.5.5.1.1.2.2.2.3.3.cmml">1</mn></mrow><msup id="S3.E15.m1.5.5.1.1.2.2.3" xref="S3.E15.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E15.m1.5.5.1.1.2.2.3.2" xref="S3.E15.m1.5.5.1.1.2.2.3.2.cmml">S</mi><mo id="S3.E15.m1.5.5.1.1.2.2.3.3" xref="S3.E15.m1.5.5.1.1.2.2.3.3.cmml">′</mo></msup></munderover><mrow id="S3.E15.m1.5.5.1.1.2.1" xref="S3.E15.m1.5.5.1.1.2.1.cmml"><mi id="S3.E15.m1.5.5.1.1.2.1.3" xref="S3.E15.m1.5.5.1.1.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.5.5.1.1.2.1.2" xref="S3.E15.m1.5.5.1.1.2.1.2.cmml">​</mo><mrow id="S3.E15.m1.5.5.1.1.2.1.1.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.5.5.1.1.2.1.1.1.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.cmml"><msubsup id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.3.cmml">s</mi><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.2.cmml">∣</mo><mrow id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><msubsup id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.1" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E15.m1.3.3" xref="S3.E15.m1.3.3.cmml">𝑿</mi><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E15.m1.4.4" xref="S3.E15.m1.4.4.cmml">𝑩</mi></mrow></mrow><mo id="S3.E15.m1.5.5.1.1.2.1.1.1.3" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.5.5.1.2" xref="S3.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.5b"><apply id="S3.E15.m1.5.5.1.1.cmml" xref="S3.E15.m1.5.5.1"><eq id="S3.E15.m1.5.5.1.1.3.cmml" xref="S3.E15.m1.5.5.1.1.3"></eq><apply id="S3.E15.m1.5.5.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.1"><times id="S3.E15.m1.5.5.1.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.1.2"></times><ci id="S3.E15.m1.5.5.1.1.1.3.cmml" xref="S3.E15.m1.5.5.1.1.1.3">𝑃</ci><apply id="S3.E15.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E15.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.2.3">′</ci></apply><apply id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3"><ci id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.2">0</cn><apply id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.2">𝑆</ci><ci id="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.2.3.3.3">′</ci></apply></apply></apply><list id="S3.E15.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.5.5.1.1.1.1.1.1.3.2"><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝑿</ci><ci id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2">𝑩</ci></list></apply></apply><apply id="S3.E15.m1.5.5.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.2"><apply id="S3.E15.m1.5.5.1.1.2.2.cmml" xref="S3.E15.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.2.1.cmml" xref="S3.E15.m1.5.5.1.1.2.2">superscript</csymbol><apply id="S3.E15.m1.5.5.1.1.2.2.2.cmml" xref="S3.E15.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E15.m1.5.5.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E15.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E15.m1.5.5.1.1.2.2.2.2">product</csymbol><apply id="S3.E15.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E15.m1.5.5.1.1.2.2.2.3"><eq id="S3.E15.m1.5.5.1.1.2.2.2.3.1.cmml" xref="S3.E15.m1.5.5.1.1.2.2.2.3.1"></eq><ci id="S3.E15.m1.5.5.1.1.2.2.2.3.2.cmml" xref="S3.E15.m1.5.5.1.1.2.2.2.3.2">𝑠</ci><cn type="integer" id="S3.E15.m1.5.5.1.1.2.2.2.3.3.cmml" xref="S3.E15.m1.5.5.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E15.m1.5.5.1.1.2.2.3.cmml" xref="S3.E15.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E15.m1.5.5.1.1.2.2.3">superscript</csymbol><ci id="S3.E15.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E15.m1.5.5.1.1.2.2.3.2">𝑆</ci><ci id="S3.E15.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E15.m1.5.5.1.1.2.2.3.3">′</ci></apply></apply><apply id="S3.E15.m1.5.5.1.1.2.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1"><times id="S3.E15.m1.5.5.1.1.2.1.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.2"></times><ci id="S3.E15.m1.5.5.1.1.2.1.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.3">𝑃</ci><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.2">conditional</csymbol><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3">superscript</csymbol><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.3.3">𝑠</ci></apply><list id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1"><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3"><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2">0</cn><apply id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3"><minus id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E15.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E15.m1.3.3.cmml" xref="S3.E15.m1.3.3">𝑿</ci><ci id="S3.E15.m1.4.4.cmml" xref="S3.E15.m1.4.4">𝑩</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.5c">P(y^{\prime}_{0:S^{\prime}}\mid\bm{X},\bm{B})=\prod_{s=1}^{S^{\prime}}P\left(y^{\prime}_{s}\mid y^{\prime}_{0:s-1},\bm{X},\bm{B}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.3" class="ltx_Math" alttext="L^{\prime}=-\log P(y^{\prime}_{0:S^{\prime}}\mid\bm{X},\bm{B})." display="block"><semantics id="S3.E16.m1.3a"><mrow id="S3.E16.m1.3.3.1" xref="S3.E16.m1.3.3.1.1.cmml"><mrow id="S3.E16.m1.3.3.1.1" xref="S3.E16.m1.3.3.1.1.cmml"><msup id="S3.E16.m1.3.3.1.1.3" xref="S3.E16.m1.3.3.1.1.3.cmml"><mi id="S3.E16.m1.3.3.1.1.3.2" xref="S3.E16.m1.3.3.1.1.3.2.cmml">L</mi><mo id="S3.E16.m1.3.3.1.1.3.3" xref="S3.E16.m1.3.3.1.1.3.3.cmml">′</mo></msup><mo id="S3.E16.m1.3.3.1.1.2" xref="S3.E16.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.3.3.1.1.1" xref="S3.E16.m1.3.3.1.1.1.cmml"><mo rspace="0.167em" id="S3.E16.m1.3.3.1.1.1a" xref="S3.E16.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E16.m1.3.3.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E16.m1.3.3.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.3.1" xref="S3.E16.m1.3.3.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E16.m1.3.3.1.1.1.1.3a" xref="S3.E16.m1.3.3.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E16.m1.3.3.1.1.1.1.3.2" xref="S3.E16.m1.3.3.1.1.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m1.3.3.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.3.3.1.1.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><msup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml">S</mi><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml">′</mo></msup></mrow><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml">𝑿</mi><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E16.m1.2.2" xref="S3.E16.m1.2.2.cmml">𝑩</mi></mrow></mrow><mo stretchy="false" id="S3.E16.m1.3.3.1.1.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E16.m1.3.3.1.2" xref="S3.E16.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.3b"><apply id="S3.E16.m1.3.3.1.1.cmml" xref="S3.E16.m1.3.3.1"><eq id="S3.E16.m1.3.3.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.2"></eq><apply id="S3.E16.m1.3.3.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.3.1.cmml" xref="S3.E16.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.3.2.cmml" xref="S3.E16.m1.3.3.1.1.3.2">𝐿</ci><ci id="S3.E16.m1.3.3.1.1.3.3.cmml" xref="S3.E16.m1.3.3.1.1.3.3">′</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1"><minus id="S3.E16.m1.3.3.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1"></minus><apply id="S3.E16.m1.3.3.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1"><times id="S3.E16.m1.3.3.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2"></times><apply id="S3.E16.m1.3.3.1.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.3"><log id="S3.E16.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.3.1"></log><ci id="S3.E16.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.3.2">𝑃</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.2.3">′</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3"><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.2">0</cn><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.2">𝑆</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.2.3.3.3">′</ci></apply></apply></apply><list id="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.3.2"><ci id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1">𝑿</ci><ci id="S3.E16.m1.2.2.cmml" xref="S3.E16.m1.2.2">𝑩</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.3c">L^{\prime}=-\log P(y^{\prime}_{0:S^{\prime}}\mid\bm{X},\bm{B}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.16" class="ltx_p">where <math id="S3.SS2.p2.15.m1.1" class="ltx_Math" alttext="S^{\prime}" display="inline"><semantics id="S3.SS2.p2.15.m1.1a"><msup id="S3.SS2.p2.15.m1.1.1" xref="S3.SS2.p2.15.m1.1.1.cmml"><mi id="S3.SS2.p2.15.m1.1.1.2" xref="S3.SS2.p2.15.m1.1.1.2.cmml">S</mi><mo id="S3.SS2.p2.15.m1.1.1.3" xref="S3.SS2.p2.15.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m1.1b"><apply id="S3.SS2.p2.15.m1.1.1.cmml" xref="S3.SS2.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m1.1.1.1.cmml" xref="S3.SS2.p2.15.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.15.m1.1.1.2.cmml" xref="S3.SS2.p2.15.m1.1.1.2">𝑆</ci><ci id="S3.SS2.p2.15.m1.1.1.3.cmml" xref="S3.SS2.p2.15.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m1.1c">S^{\prime}</annotation></semantics></math> represents the total number of tokens based on the proposed bias tokens, respectively.
Note that Eqs. (<a href="#S3.E13" title="In 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>) and (<a href="#S3.E14" title="In 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) are flexible to the bias list size <math id="S3.SS2.p2.16.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p2.16.m2.1a"><mi id="S3.SS2.p2.16.m2.1.1" xref="S3.SS2.p2.16.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m2.1b"><ci id="S3.SS2.p2.16.m2.1.1.cmml" xref="S3.SS2.p2.16.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m2.1c">N</annotation></semantics></math>, and the proposed method is optimized using Eq. (<a href="#S3.E16" title="In 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>) without auxiliary losses.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">The proposed method can be applied to other E2E-ASR architectures, such as CTC, RNN-T, and their hybrids, including streaming systems and multilingual systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, because the proposed method only extends the embedding and output layers in addition to the bias encoder (Figure  <a href="#S3.F3" title="Figure 3 ‣ 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.13344/assets/figures/ctc.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="358" height="426" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">CTC-based biasing</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.13344/assets/figures/transducer.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="597" height="457" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">RNN-T-based biasing</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Various architectures utilized in the proposed method.</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Training</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.26" class="ltx_p">During the training phase, a bias list <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\bm{B}</annotation></semantics></math> is created randomly from the reference transcriptions for each batch, where <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="N_{\text{utt}}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">N</mi><mtext id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3a.cmml">utt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.p1.2.m2.1.1.3a.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">utt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N_{\text{utt}}</annotation></semantics></math> bias phrases are selected per utterance, each has <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">I</annotation></semantics></math> tokens in length.
This process yields a total of <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">N</annotation></semantics></math> bias phrases calculated as <math id="S3.SS3.p1.5.m5.1" class="ltx_math_unparsed" alttext="N_{\text{utt}}\times" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1b"><msub id="S3.SS3.p1.5.m5.1.1"><mi id="S3.SS3.p1.5.m5.1.1.2">N</mi><mtext id="S3.SS3.p1.5.m5.1.1.3">utt</mtext></msub><mo lspace="0.222em" id="S3.SS3.p1.5.m5.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">N_{\text{utt}}\times</annotation></semantics></math> batch size.
Once the bias list <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\bm{B}</annotation></semantics></math> is defined, the corresponding reference transcriptions are replaced with the bias tokens.
For example, if ``<math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mo id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><lt id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.8.1" class="ltx_text ltx_font_italic">N<math id="S3.SS3.p1.8.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.8.1.m1.1a"><mo id="S3.SS3.p1.8.1.m1.1.1" xref="S3.SS3.p1.8.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.1.m1.1b"><gt id="S3.SS3.p1.8.1.m1.1.1.cmml" xref="S3.SS3.p1.8.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.1.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.9.m8.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.9.m8.1a"><mo id="S3.SS3.p1.9.m8.1.1" xref="S3.SS3.p1.9.m8.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m8.1b"><lt id="S3.SS3.p1.9.m8.1.1.cmml" xref="S3.SS3.p1.9.m8.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m8.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.10.2" class="ltx_text ltx_font_italic">el<math id="S3.SS3.p1.10.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.10.2.m1.1a"><mo id="S3.SS3.p1.10.2.m1.1.1" xref="S3.SS3.p1.10.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.2.m1.1b"><gt id="S3.SS3.p1.10.2.m1.1.1.cmml" xref="S3.SS3.p1.10.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.2.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.11.m9.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.11.m9.1a"><mo id="S3.SS3.p1.11.m9.1.1" xref="S3.SS3.p1.11.m9.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m9.1b"><lt id="S3.SS3.p1.11.m9.1.1.cmml" xref="S3.SS3.p1.11.m9.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m9.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.12.3" class="ltx_text ltx_font_italic">ly<math id="S3.SS3.p1.12.3.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.12.3.m1.1a"><mo id="S3.SS3.p1.12.3.m1.1.1" xref="S3.SS3.p1.12.3.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.3.m1.1b"><gt id="S3.SS3.p1.12.3.m1.1.1.cmml" xref="S3.SS3.p1.12.3.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.3.m1.1c">&gt;</annotation></semantics></math></span>'' is extracted from the complete utterance <math id="S3.SS3.p1.13.m10.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS3.p1.13.m10.1a"><mi id="S3.SS3.p1.13.m10.1.1" xref="S3.SS3.p1.13.m10.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m10.1b"><ci id="S3.SS3.p1.13.m10.1.1.cmml" xref="S3.SS3.p1.13.m10.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m10.1c">y</annotation></semantics></math> = [<math id="S3.SS3.p1.14.m11.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.14.m11.1a"><mo id="S3.SS3.p1.14.m11.1.1" xref="S3.SS3.p1.14.m11.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m11.1b"><lt id="S3.SS3.p1.14.m11.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m11.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.15.4" class="ltx_text ltx_font_italic">Hi<math id="S3.SS3.p1.15.4.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.15.4.m1.1a"><mo id="S3.SS3.p1.15.4.m1.1.1" xref="S3.SS3.p1.15.4.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.4.m1.1b"><gt id="S3.SS3.p1.15.4.m1.1.1.cmml" xref="S3.SS3.p1.15.4.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.4.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.16.m12.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.16.m12.1a"><mo id="S3.SS3.p1.16.m12.1.1" xref="S3.SS3.p1.16.m12.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m12.1b"><lt id="S3.SS3.p1.16.m12.1.1.cmml" xref="S3.SS3.p1.16.m12.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m12.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.17.5" class="ltx_text ltx_font_italic">N<math id="S3.SS3.p1.17.5.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.17.5.m1.1a"><mo id="S3.SS3.p1.17.5.m1.1.1" xref="S3.SS3.p1.17.5.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.5.m1.1b"><gt id="S3.SS3.p1.17.5.m1.1.1.cmml" xref="S3.SS3.p1.17.5.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.5.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.18.m13.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.18.m13.1a"><mo id="S3.SS3.p1.18.m13.1.1" xref="S3.SS3.p1.18.m13.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m13.1b"><lt id="S3.SS3.p1.18.m13.1.1.cmml" xref="S3.SS3.p1.18.m13.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m13.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.19.6" class="ltx_text ltx_font_italic">el<math id="S3.SS3.p1.19.6.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.19.6.m1.1a"><mo id="S3.SS3.p1.19.6.m1.1.1" xref="S3.SS3.p1.19.6.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.6.m1.1b"><gt id="S3.SS3.p1.19.6.m1.1.1.cmml" xref="S3.SS3.p1.19.6.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.6.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.20.m14.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.20.m14.1a"><mo id="S3.SS3.p1.20.m14.1.1" xref="S3.SS3.p1.20.m14.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m14.1b"><lt id="S3.SS3.p1.20.m14.1.1.cmml" xref="S3.SS3.p1.20.m14.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m14.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.21.7" class="ltx_text ltx_font_italic">ly<math id="S3.SS3.p1.21.7.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.21.7.m1.1a"><mo id="S3.SS3.p1.21.7.m1.1.1" xref="S3.SS3.p1.21.7.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.21.7.m1.1b"><gt id="S3.SS3.p1.21.7.m1.1.1.cmml" xref="S3.SS3.p1.21.7.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.21.7.m1.1c">&gt;</annotation></semantics></math></span>], the reference transcription is modified to <math id="S3.SS3.p1.22.m15.1" class="ltx_Math" alttext="y^{\prime}" display="inline"><semantics id="S3.SS3.p1.22.m15.1a"><msup id="S3.SS3.p1.22.m15.1.1" xref="S3.SS3.p1.22.m15.1.1.cmml"><mi id="S3.SS3.p1.22.m15.1.1.2" xref="S3.SS3.p1.22.m15.1.1.2.cmml">y</mi><mo id="S3.SS3.p1.22.m15.1.1.3" xref="S3.SS3.p1.22.m15.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.22.m15.1b"><apply id="S3.SS3.p1.22.m15.1.1.cmml" xref="S3.SS3.p1.22.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m15.1.1.1.cmml" xref="S3.SS3.p1.22.m15.1.1">superscript</csymbol><ci id="S3.SS3.p1.22.m15.1.1.2.cmml" xref="S3.SS3.p1.22.m15.1.1.2">𝑦</ci><ci id="S3.SS3.p1.22.m15.1.1.3.cmml" xref="S3.SS3.p1.22.m15.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.22.m15.1c">y^{\prime}</annotation></semantics></math> = [<math id="S3.SS3.p1.23.m16.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.23.m16.1a"><mo id="S3.SS3.p1.23.m16.1.1" xref="S3.SS3.p1.23.m16.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.23.m16.1b"><lt id="S3.SS3.p1.23.m16.1.1.cmml" xref="S3.SS3.p1.23.m16.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.23.m16.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.24.8" class="ltx_text ltx_font_italic">Hi<math id="S3.SS3.p1.24.8.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.24.8.m1.1a"><mo id="S3.SS3.p1.24.8.m1.1.1" xref="S3.SS3.p1.24.8.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.24.8.m1.1b"><gt id="S3.SS3.p1.24.8.m1.1.1.cmml" xref="S3.SS3.p1.24.8.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.24.8.m1.1c">&gt;</annotation></semantics></math></span>, <math id="S3.SS3.p1.25.m17.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS3.p1.25.m17.1a"><mo id="S3.SS3.p1.25.m17.1.1" xref="S3.SS3.p1.25.m17.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.25.m17.1b"><lt id="S3.SS3.p1.25.m17.1.1.cmml" xref="S3.SS3.p1.25.m17.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.25.m17.1c">&lt;</annotation></semantics></math><span id="S3.SS3.p1.26.9" class="ltx_text ltx_font_bold ltx_font_italic">Nelly<math id="S3.SS3.p1.26.9.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.p1.26.9.m1.1a"><mo id="S3.SS3.p1.26.9.m1.1.1" xref="S3.SS3.p1.26.9.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.26.9.m1.1b"><gt id="S3.SS3.p1.26.9.m1.1.1.cmml" xref="S3.SS3.p1.26.9.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.26.9.m1.1c">&gt;</annotation></semantics></math></span>].</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Bias weight during inference</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.5" class="ltx_p">Considering practicality, we introduce a bias weight to Eq. (<a href="#S3.E14" title="In 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) to avoid over/under-biasing during inference as follows:</p>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E17.m1.6" class="ltx_Math" alttext="\mathrm{WeightSoftmax}_{i}(\bm{\alpha},\bm{w})=\frac{w_{i}\mathrm{exp}(\alpha_{i})}{\sum_{j=1}^{(K+N)}w_{j}\mathrm{exp}(\alpha_{j})}," display="block"><semantics id="S3.E17.m1.6a"><mrow id="S3.E17.m1.6.6.1" xref="S3.E17.m1.6.6.1.1.cmml"><mrow id="S3.E17.m1.6.6.1.1" xref="S3.E17.m1.6.6.1.1.cmml"><mrow id="S3.E17.m1.6.6.1.1.2" xref="S3.E17.m1.6.6.1.1.2.cmml"><msub id="S3.E17.m1.6.6.1.1.2.2" xref="S3.E17.m1.6.6.1.1.2.2.cmml"><mi id="S3.E17.m1.6.6.1.1.2.2.2" xref="S3.E17.m1.6.6.1.1.2.2.2.cmml">WeightSoftmax</mi><mi id="S3.E17.m1.6.6.1.1.2.2.3" xref="S3.E17.m1.6.6.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E17.m1.6.6.1.1.2.1" xref="S3.E17.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S3.E17.m1.6.6.1.1.2.3.2" xref="S3.E17.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E17.m1.6.6.1.1.2.3.2.1" xref="S3.E17.m1.6.6.1.1.2.3.1.cmml">(</mo><mi id="S3.E17.m1.4.4" xref="S3.E17.m1.4.4.cmml">𝜶</mi><mo id="S3.E17.m1.6.6.1.1.2.3.2.2" xref="S3.E17.m1.6.6.1.1.2.3.1.cmml">,</mo><mi id="S3.E17.m1.5.5" xref="S3.E17.m1.5.5.cmml">𝒘</mi><mo stretchy="false" id="S3.E17.m1.6.6.1.1.2.3.2.3" xref="S3.E17.m1.6.6.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.6.6.1.1.1" xref="S3.E17.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S3.E17.m1.3.3" xref="S3.E17.m1.3.3.cmml"><mrow id="S3.E17.m1.1.1.1" xref="S3.E17.m1.1.1.1.cmml"><msub id="S3.E17.m1.1.1.1.3" xref="S3.E17.m1.1.1.1.3.cmml"><mi id="S3.E17.m1.1.1.1.3.2" xref="S3.E17.m1.1.1.1.3.2.cmml">w</mi><mi id="S3.E17.m1.1.1.1.3.3" xref="S3.E17.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.1.1.2" xref="S3.E17.m1.1.1.1.2.cmml">​</mo><mi id="S3.E17.m1.1.1.1.4" xref="S3.E17.m1.1.1.1.4.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.1.1.2a" xref="S3.E17.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E17.m1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.1.1.1.1.1.2" xref="S3.E17.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E17.m1.1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.1.1.1.1.1.1.2" xref="S3.E17.m1.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.E17.m1.1.1.1.1.1.1.3" xref="S3.E17.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E17.m1.1.1.1.1.1.3" xref="S3.E17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E17.m1.3.3.3" xref="S3.E17.m1.3.3.3.cmml"><msubsup id="S3.E17.m1.3.3.3.3" xref="S3.E17.m1.3.3.3.3.cmml"><mo id="S3.E17.m1.3.3.3.3.2.2" xref="S3.E17.m1.3.3.3.3.2.2.cmml">∑</mo><mrow id="S3.E17.m1.3.3.3.3.2.3" xref="S3.E17.m1.3.3.3.3.2.3.cmml"><mi id="S3.E17.m1.3.3.3.3.2.3.2" xref="S3.E17.m1.3.3.3.3.2.3.2.cmml">j</mi><mo id="S3.E17.m1.3.3.3.3.2.3.1" xref="S3.E17.m1.3.3.3.3.2.3.1.cmml">=</mo><mn id="S3.E17.m1.3.3.3.3.2.3.3" xref="S3.E17.m1.3.3.3.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E17.m1.2.2.2.1.1.1" xref="S3.E17.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.2.1.1.1.2" xref="S3.E17.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.2.2.2.1.1.1.1" xref="S3.E17.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E17.m1.2.2.2.1.1.1.1.2" xref="S3.E17.m1.2.2.2.1.1.1.1.2.cmml">K</mi><mo id="S3.E17.m1.2.2.2.1.1.1.1.1" xref="S3.E17.m1.2.2.2.1.1.1.1.1.cmml">+</mo><mi id="S3.E17.m1.2.2.2.1.1.1.1.3" xref="S3.E17.m1.2.2.2.1.1.1.1.3.cmml">N</mi></mrow><mo stretchy="false" id="S3.E17.m1.2.2.2.1.1.1.3" xref="S3.E17.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mrow id="S3.E17.m1.3.3.3.2" xref="S3.E17.m1.3.3.3.2.cmml"><msub id="S3.E17.m1.3.3.3.2.3" xref="S3.E17.m1.3.3.3.2.3.cmml"><mi id="S3.E17.m1.3.3.3.2.3.2" xref="S3.E17.m1.3.3.3.2.3.2.cmml">w</mi><mi id="S3.E17.m1.3.3.3.2.3.3" xref="S3.E17.m1.3.3.3.2.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E17.m1.3.3.3.2.2" xref="S3.E17.m1.3.3.3.2.2.cmml">​</mo><mi id="S3.E17.m1.3.3.3.2.4" xref="S3.E17.m1.3.3.3.2.4.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.3.3.3.2.2a" xref="S3.E17.m1.3.3.3.2.2.cmml">​</mo><mrow id="S3.E17.m1.3.3.3.2.1.1" xref="S3.E17.m1.3.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.3.3.3.2.1.1.2" xref="S3.E17.m1.3.3.3.2.1.1.1.cmml">(</mo><msub id="S3.E17.m1.3.3.3.2.1.1.1" xref="S3.E17.m1.3.3.3.2.1.1.1.cmml"><mi id="S3.E17.m1.3.3.3.2.1.1.1.2" xref="S3.E17.m1.3.3.3.2.1.1.1.2.cmml">α</mi><mi id="S3.E17.m1.3.3.3.2.1.1.1.3" xref="S3.E17.m1.3.3.3.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E17.m1.3.3.3.2.1.1.3" xref="S3.E17.m1.3.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E17.m1.6.6.1.2" xref="S3.E17.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.6b"><apply id="S3.E17.m1.6.6.1.1.cmml" xref="S3.E17.m1.6.6.1"><eq id="S3.E17.m1.6.6.1.1.1.cmml" xref="S3.E17.m1.6.6.1.1.1"></eq><apply id="S3.E17.m1.6.6.1.1.2.cmml" xref="S3.E17.m1.6.6.1.1.2"><times id="S3.E17.m1.6.6.1.1.2.1.cmml" xref="S3.E17.m1.6.6.1.1.2.1"></times><apply id="S3.E17.m1.6.6.1.1.2.2.cmml" xref="S3.E17.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.6.6.1.1.2.2.1.cmml" xref="S3.E17.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S3.E17.m1.6.6.1.1.2.2.2.cmml" xref="S3.E17.m1.6.6.1.1.2.2.2">WeightSoftmax</ci><ci id="S3.E17.m1.6.6.1.1.2.2.3.cmml" xref="S3.E17.m1.6.6.1.1.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.E17.m1.6.6.1.1.2.3.1.cmml" xref="S3.E17.m1.6.6.1.1.2.3.2"><ci id="S3.E17.m1.4.4.cmml" xref="S3.E17.m1.4.4">𝜶</ci><ci id="S3.E17.m1.5.5.cmml" xref="S3.E17.m1.5.5">𝒘</ci></interval></apply><apply id="S3.E17.m1.3.3.cmml" xref="S3.E17.m1.3.3"><divide id="S3.E17.m1.3.3.4.cmml" xref="S3.E17.m1.3.3"></divide><apply id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1.1"><times id="S3.E17.m1.1.1.1.2.cmml" xref="S3.E17.m1.1.1.1.2"></times><apply id="S3.E17.m1.1.1.1.3.cmml" xref="S3.E17.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.3.1.cmml" xref="S3.E17.m1.1.1.1.3">subscript</csymbol><ci id="S3.E17.m1.1.1.1.3.2.cmml" xref="S3.E17.m1.1.1.1.3.2">𝑤</ci><ci id="S3.E17.m1.1.1.1.3.3.cmml" xref="S3.E17.m1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E17.m1.1.1.1.4.cmml" xref="S3.E17.m1.1.1.1.4">exp</ci><apply id="S3.E17.m1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E17.m1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.E17.m1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E17.m1.3.3.3.cmml" xref="S3.E17.m1.3.3.3"><apply id="S3.E17.m1.3.3.3.3.cmml" xref="S3.E17.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.3.3.1.cmml" xref="S3.E17.m1.3.3.3.3">superscript</csymbol><apply id="S3.E17.m1.3.3.3.3.2.cmml" xref="S3.E17.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.3.3.2.1.cmml" xref="S3.E17.m1.3.3.3.3">subscript</csymbol><sum id="S3.E17.m1.3.3.3.3.2.2.cmml" xref="S3.E17.m1.3.3.3.3.2.2"></sum><apply id="S3.E17.m1.3.3.3.3.2.3.cmml" xref="S3.E17.m1.3.3.3.3.2.3"><eq id="S3.E17.m1.3.3.3.3.2.3.1.cmml" xref="S3.E17.m1.3.3.3.3.2.3.1"></eq><ci id="S3.E17.m1.3.3.3.3.2.3.2.cmml" xref="S3.E17.m1.3.3.3.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E17.m1.3.3.3.3.2.3.3.cmml" xref="S3.E17.m1.3.3.3.3.2.3.3">1</cn></apply></apply><apply id="S3.E17.m1.2.2.2.1.1.1.1.cmml" xref="S3.E17.m1.2.2.2.1.1.1"><plus id="S3.E17.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.2.1.1.1.1.1"></plus><ci id="S3.E17.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.2.1.1.1.1.2">𝐾</ci><ci id="S3.E17.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.2.1.1.1.1.3">𝑁</ci></apply></apply><apply id="S3.E17.m1.3.3.3.2.cmml" xref="S3.E17.m1.3.3.3.2"><times id="S3.E17.m1.3.3.3.2.2.cmml" xref="S3.E17.m1.3.3.3.2.2"></times><apply id="S3.E17.m1.3.3.3.2.3.cmml" xref="S3.E17.m1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.3.2.3.1.cmml" xref="S3.E17.m1.3.3.3.2.3">subscript</csymbol><ci id="S3.E17.m1.3.3.3.2.3.2.cmml" xref="S3.E17.m1.3.3.3.2.3.2">𝑤</ci><ci id="S3.E17.m1.3.3.3.2.3.3.cmml" xref="S3.E17.m1.3.3.3.2.3.3">𝑗</ci></apply><ci id="S3.E17.m1.3.3.3.2.4.cmml" xref="S3.E17.m1.3.3.3.2.4">exp</ci><apply id="S3.E17.m1.3.3.3.2.1.1.1.cmml" xref="S3.E17.m1.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.3.2.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.2.1.1">subscript</csymbol><ci id="S3.E17.m1.3.3.3.2.1.1.1.2.cmml" xref="S3.E17.m1.3.3.3.2.1.1.1.2">𝛼</ci><ci id="S3.E17.m1.3.3.3.2.1.1.1.3.cmml" xref="S3.E17.m1.3.3.3.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.6c">\mathrm{WeightSoftmax}_{i}(\bm{\alpha},\bm{w})=\frac{w_{i}\mathrm{exp}(\alpha_{i})}{\sum_{j=1}^{(K+N)}w_{j}\mathrm{exp}(\alpha_{j})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.4" class="ltx_p">where <math id="S3.SS4.p1.1.m1.1" class="ltx_math_unparsed" alttext="\bm{w}=[w_{1}....,w_{(K+N)}]" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1b"><mi id="S3.SS4.p1.1.m1.1.2">𝒘</mi><mo id="S3.SS4.p1.1.m1.1.3">=</mo><mrow id="S3.SS4.p1.1.m1.1.4"><mo stretchy="false" id="S3.SS4.p1.1.m1.1.4.1">[</mo><msub id="S3.SS4.p1.1.m1.1.4.2"><mi id="S3.SS4.p1.1.m1.1.4.2.2">w</mi><mn id="S3.SS4.p1.1.m1.1.4.2.3">1</mn></msub><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.4.3">…</mi><mo lspace="0em" rspace="0.167em" id="S3.SS4.p1.1.m1.1.4.4">.</mo><mo id="S3.SS4.p1.1.m1.1.4.5">,</mo><msub id="S3.SS4.p1.1.m1.1.4.6"><mi id="S3.SS4.p1.1.m1.1.4.6.2">w</mi><mrow id="S3.SS4.p1.1.m1.1.1.1.1"><mo stretchy="false" id="S3.SS4.p1.1.m1.1.1.1.1.2">(</mo><mrow id="S3.SS4.p1.1.m1.1.1.1.1.1"><mi id="S3.SS4.p1.1.m1.1.1.1.1.1.2">K</mi><mo id="S3.SS4.p1.1.m1.1.1.1.1.1.1">+</mo><mi id="S3.SS4.p1.1.m1.1.1.1.1.1.3">N</mi></mrow><mo stretchy="false" id="S3.SS4.p1.1.m1.1.1.1.1.3">)</mo></mrow></msub><mo stretchy="false" id="S3.SS4.p1.1.m1.1.4.7">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\bm{w}=[w_{1}....,w_{(K+N)}]</annotation></semantics></math> and <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">i</annotation></semantics></math> represent a weight vector and its index for <math id="S3.SS4.p1.3.m3.6" class="ltx_Math" alttext="\bm{\alpha}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K},\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]" display="inline"><semantics id="S3.SS4.p1.3.m3.6a"><mrow id="S3.SS4.p1.3.m3.6.6" xref="S3.SS4.p1.3.m3.6.6.cmml"><mi id="S3.SS4.p1.3.m3.6.6.6" xref="S3.SS4.p1.3.m3.6.6.6.cmml">𝜶</mi><mo id="S3.SS4.p1.3.m3.6.6.5" xref="S3.SS4.p1.3.m3.6.6.5.cmml">=</mo><mrow id="S3.SS4.p1.3.m3.6.6.4.4" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml"><mo stretchy="false" id="S3.SS4.p1.3.m3.6.6.4.4.5" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">[</mo><msubsup id="S3.SS4.p1.3.m3.3.3.1.1.1" xref="S3.SS4.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS4.p1.3.m3.3.3.1.1.1.2.2" xref="S3.SS4.p1.3.m3.3.3.1.1.1.2.2.cmml">α</mi><mn id="S3.SS4.p1.3.m3.3.3.1.1.1.3" xref="S3.SS4.p1.3.m3.3.3.1.1.1.3.cmml">1</mn><mtext id="S3.SS4.p1.3.m3.3.3.1.1.1.2.3" xref="S3.SS4.p1.3.m3.3.3.1.1.1.2.3a.cmml">n</mtext></msubsup><mo id="S3.SS4.p1.3.m3.6.6.4.4.6" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS4.p1.3.m3.6.6.4.4.7" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS4.p1.3.m3.4.4.2.2.2" xref="S3.SS4.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.SS4.p1.3.m3.4.4.2.2.2.2.2" xref="S3.SS4.p1.3.m3.4.4.2.2.2.2.2.cmml">α</mi><mi id="S3.SS4.p1.3.m3.4.4.2.2.2.3" xref="S3.SS4.p1.3.m3.4.4.2.2.2.3.cmml">K</mi><mtext id="S3.SS4.p1.3.m3.4.4.2.2.2.2.3" xref="S3.SS4.p1.3.m3.4.4.2.2.2.2.3a.cmml">n</mtext></msubsup><mo id="S3.SS4.p1.3.m3.6.6.4.4.8" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS4.p1.3.m3.5.5.3.3.3" xref="S3.SS4.p1.3.m3.5.5.3.3.3.cmml"><mi id="S3.SS4.p1.3.m3.5.5.3.3.3.2.2" xref="S3.SS4.p1.3.m3.5.5.3.3.3.2.2.cmml">α</mi><mn id="S3.SS4.p1.3.m3.5.5.3.3.3.3" xref="S3.SS4.p1.3.m3.5.5.3.3.3.3.cmml">1</mn><mtext id="S3.SS4.p1.3.m3.5.5.3.3.3.2.3" xref="S3.SS4.p1.3.m3.5.5.3.3.3.2.3a.cmml">b</mtext></msubsup><mo id="S3.SS4.p1.3.m3.6.6.4.4.9" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.3.m3.2.2" xref="S3.SS4.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS4.p1.3.m3.6.6.4.4.10" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">,</mo><msubsup id="S3.SS4.p1.3.m3.6.6.4.4.4" xref="S3.SS4.p1.3.m3.6.6.4.4.4.cmml"><mi id="S3.SS4.p1.3.m3.6.6.4.4.4.2.2" xref="S3.SS4.p1.3.m3.6.6.4.4.4.2.2.cmml">α</mi><mi id="S3.SS4.p1.3.m3.6.6.4.4.4.3" xref="S3.SS4.p1.3.m3.6.6.4.4.4.3.cmml">N</mi><mtext id="S3.SS4.p1.3.m3.6.6.4.4.4.2.3" xref="S3.SS4.p1.3.m3.6.6.4.4.4.2.3a.cmml">b</mtext></msubsup><mo stretchy="false" id="S3.SS4.p1.3.m3.6.6.4.4.11" xref="S3.SS4.p1.3.m3.6.6.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.6b"><apply id="S3.SS4.p1.3.m3.6.6.cmml" xref="S3.SS4.p1.3.m3.6.6"><eq id="S3.SS4.p1.3.m3.6.6.5.cmml" xref="S3.SS4.p1.3.m3.6.6.5"></eq><ci id="S3.SS4.p1.3.m3.6.6.6.cmml" xref="S3.SS4.p1.3.m3.6.6.6">𝜶</ci><list id="S3.SS4.p1.3.m3.6.6.4.5.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4"><apply id="S3.SS4.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1">subscript</csymbol><apply id="S3.SS4.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1">superscript</csymbol><ci id="S3.SS4.p1.3.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1.2.2">𝛼</ci><ci id="S3.SS4.p1.3.m3.3.3.1.1.1.2.3a.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1.2.3"><mtext mathsize="70%" id="S3.SS4.p1.3.m3.3.3.1.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1.2.3">n</mtext></ci></apply><cn type="integer" id="S3.SS4.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS4.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">…</ci><apply id="S3.SS4.p1.3.m3.4.4.2.2.2.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2">subscript</csymbol><apply id="S3.SS4.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.4.4.2.2.2.2.1.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2">superscript</csymbol><ci id="S3.SS4.p1.3.m3.4.4.2.2.2.2.2.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2.2.2">𝛼</ci><ci id="S3.SS4.p1.3.m3.4.4.2.2.2.2.3a.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2.2.3"><mtext mathsize="70%" id="S3.SS4.p1.3.m3.4.4.2.2.2.2.3.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2.2.3">n</mtext></ci></apply><ci id="S3.SS4.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.SS4.p1.3.m3.4.4.2.2.2.3">𝐾</ci></apply><apply id="S3.SS4.p1.3.m3.5.5.3.3.3.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.5.5.3.3.3.1.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3">subscript</csymbol><apply id="S3.SS4.p1.3.m3.5.5.3.3.3.2.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.5.5.3.3.3.2.1.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3">superscript</csymbol><ci id="S3.SS4.p1.3.m3.5.5.3.3.3.2.2.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3.2.2">𝛼</ci><ci id="S3.SS4.p1.3.m3.5.5.3.3.3.2.3a.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3.2.3"><mtext mathsize="70%" id="S3.SS4.p1.3.m3.5.5.3.3.3.2.3.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3.2.3">b</mtext></ci></apply><cn type="integer" id="S3.SS4.p1.3.m3.5.5.3.3.3.3.cmml" xref="S3.SS4.p1.3.m3.5.5.3.3.3.3">1</cn></apply><ci id="S3.SS4.p1.3.m3.2.2.cmml" xref="S3.SS4.p1.3.m3.2.2">…</ci><apply id="S3.SS4.p1.3.m3.6.6.4.4.4.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.6.6.4.4.4.1.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4">subscript</csymbol><apply id="S3.SS4.p1.3.m3.6.6.4.4.4.2.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.6.6.4.4.4.2.1.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4">superscript</csymbol><ci id="S3.SS4.p1.3.m3.6.6.4.4.4.2.2.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4.2.2">𝛼</ci><ci id="S3.SS4.p1.3.m3.6.6.4.4.4.2.3a.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4.2.3"><mtext mathsize="70%" id="S3.SS4.p1.3.m3.6.6.4.4.4.2.3.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4.2.3">b</mtext></ci></apply><ci id="S3.SS4.p1.3.m3.6.6.4.4.4.3.cmml" xref="S3.SS4.p1.3.m3.6.6.4.4.4.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.6c">\bm{\alpha}=[\alpha^{\text{n}}_{1},...,\alpha^{\text{n}}_{K},\alpha^{\text{b}}_{1},...,\alpha^{\text{b}}_{N}]</annotation></semantics></math>, respectively.
The same bias weight <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mu</annotation></semantics></math> is applied to bias tokens as follows:</p>
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E18.m1.4" class="ltx_Math" alttext="w_{i}=\begin{cases}1.0&amp;(i\leqq K)\\
\mu&amp;(i&gt;K).\end{cases}" display="block"><semantics id="S3.E18.m1.4a"><mrow id="S3.E18.m1.4.5" xref="S3.E18.m1.4.5.cmml"><msub id="S3.E18.m1.4.5.2" xref="S3.E18.m1.4.5.2.cmml"><mi id="S3.E18.m1.4.5.2.2" xref="S3.E18.m1.4.5.2.2.cmml">w</mi><mi id="S3.E18.m1.4.5.2.3" xref="S3.E18.m1.4.5.2.3.cmml">i</mi></msub><mo id="S3.E18.m1.4.5.1" xref="S3.E18.m1.4.5.1.cmml">=</mo><mrow id="S3.E18.m1.4.4" xref="S3.E18.m1.4.5.3.1.cmml"><mo id="S3.E18.m1.4.4.5" xref="S3.E18.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E18.m1.4.4.4" xref="S3.E18.m1.4.5.3.1.cmml"><mtr id="S3.E18.m1.4.4.4a" xref="S3.E18.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4b" xref="S3.E18.m1.4.5.3.1.cmml"><mn id="S3.E18.m1.1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.cmml">1.0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4c" xref="S3.E18.m1.4.5.3.1.cmml"><mrow id="S3.E18.m1.2.2.2.2.2.1.1" xref="S3.E18.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.2.2.2.2.2.1.1.2" xref="S3.E18.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E18.m1.2.2.2.2.2.1.1.1" xref="S3.E18.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E18.m1.2.2.2.2.2.1.1.1.2" xref="S3.E18.m1.2.2.2.2.2.1.1.1.2.cmml">i</mi><mo id="S3.E18.m1.2.2.2.2.2.1.1.1.1" xref="S3.E18.m1.2.2.2.2.2.1.1.1.1.cmml">≦</mo><mi id="S3.E18.m1.2.2.2.2.2.1.1.1.3" xref="S3.E18.m1.2.2.2.2.2.1.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="S3.E18.m1.2.2.2.2.2.1.1.3" xref="S3.E18.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mtd></mtr><mtr id="S3.E18.m1.4.4.4d" xref="S3.E18.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4e" xref="S3.E18.m1.4.5.3.1.cmml"><mi id="S3.E18.m1.3.3.3.3.1.1" xref="S3.E18.m1.3.3.3.3.1.1.cmml">μ</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4f" xref="S3.E18.m1.4.5.3.1.cmml"><mrow id="S3.E18.m1.4.4.4.4.2.1.1" xref="S3.E18.m1.4.5.3.1.cmml"><mrow id="S3.E18.m1.4.4.4.4.2.1.1.1.1" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.4.4.4.4.2.1.1.1.1.2" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.cmml"><mi id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.2" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.1" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.1.cmml">&gt;</mo><mi id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.3" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="S3.E18.m1.4.4.4.4.2.1.1.1.1.3" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" id="S3.E18.m1.4.4.4.4.2.1.1.2" xref="S3.E18.m1.4.5.3.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.4b"><apply id="S3.E18.m1.4.5.cmml" xref="S3.E18.m1.4.5"><eq id="S3.E18.m1.4.5.1.cmml" xref="S3.E18.m1.4.5.1"></eq><apply id="S3.E18.m1.4.5.2.cmml" xref="S3.E18.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E18.m1.4.5.2.1.cmml" xref="S3.E18.m1.4.5.2">subscript</csymbol><ci id="S3.E18.m1.4.5.2.2.cmml" xref="S3.E18.m1.4.5.2.2">𝑤</ci><ci id="S3.E18.m1.4.5.2.3.cmml" xref="S3.E18.m1.4.5.2.3">𝑖</ci></apply><apply id="S3.E18.m1.4.5.3.1.cmml" xref="S3.E18.m1.4.4"><csymbol cd="latexml" id="S3.E18.m1.4.5.3.1.1.cmml" xref="S3.E18.m1.4.4.5">cases</csymbol><cn type="float" id="S3.E18.m1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1">1.0</cn><apply id="S3.E18.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E18.m1.2.2.2.2.2.1.1"><leq id="S3.E18.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E18.m1.2.2.2.2.2.1.1.1.1"></leq><ci id="S3.E18.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E18.m1.2.2.2.2.2.1.1.1.2">𝑖</ci><ci id="S3.E18.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E18.m1.2.2.2.2.2.1.1.1.3">𝐾</ci></apply><ci id="S3.E18.m1.3.3.3.3.1.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1">𝜇</ci><apply id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1"><gt id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.1"></gt><ci id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.2">𝑖</ci><ci id="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.3.cmml" xref="S3.E18.m1.4.4.4.4.2.1.1.1.1.1.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.4c">w_{i}=\begin{cases}1.0&amp;(i\leqq K)\\
\mu&amp;(i&gt;K).\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.5" class="ltx_p">To demonstrate the adaptability of the proposed method, we applied it to offline CTC/attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and streaming RNN-T models.
The input features are 80-dimensional Mel filterbanks with a window size of 512 samples and a hop length of 160 samples. Then, SpecAugment
is applied.
The audio encoder comprises two convolutional layers with a stride of two and a 256-dimensional linear projection layer followed by 12 conformer layers with 1024 linear units and layer normalization.
For the streaming RNN-T, the audio encoder is processed blockwisely <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> with the block size and look ahead of 800 and 320 ms, respectively.
The bias encoder has six transformer blocks with 1024 linear units.
Regarding the bias decoder, the offline CTC/attention model has six transformer blocks with 2048 linear units, and the streaming RNN-T model has a single long short-term memory layer with a hidden size of 256 and a linear layer of 320 joint sizes for prediction and joint networks.
The attention layers in the audio encoder, the bias encoder, and the bias decoder are four-multihead attentions with a dimension <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">d</annotation></semantics></math> of 256.
The offline CTC/attention and streaming RNN-T models have 40.58 M and 31.38 M parameters, respectively, including the bias encoders.
The bias weight <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mu</annotation></semantics></math> (Section <a href="#S3.SS4" title="3.4 Bias weight during inference ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>) is set to 0.8 (this is discussed further in Section <a href="#S4.SS4" title="4.4 Effect of the bias weight during inference ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>).
During training, a bias list <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\bm{B}</annotation></semantics></math> is created randomly for each batch with <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="N_{\text{utt}}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">N</mi><mtext id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3a.cmml">utt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑁</ci><ci id="S4.SS1.p1.4.m4.1.1.3a.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><mtext mathsize="70%" id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">utt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">N_{\text{utt}}</annotation></semantics></math> = [2 - 10] and <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">I</annotation></semantics></math> = [2 - 10] (Section <a href="#S3.SS3" title="3.3 Training ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>). The proposed models are trained 150 epochs at a learning rate of 0.0025/0.002
for the CTC/attention-based and RNN-T-based systems, respectively.
</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The Librispeech-960 corpus <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> is used to evaluate the proposed method using ESPnet as the E2E-ASR toolkit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>.
The proposed method is evaluated in terms of word error rate (WER), bias phrase WER (B-WER), and unbiased phrase WER (U-WER) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Note that insertion errors are counted toward the B-WER if the inserted phrases are present in the bias list; otherwise, insertion errors are counted toward the U-WER.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.7.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.8.2" class="ltx_text" style="font-size:90%;">WER results of <span id="S4.T1.8.2.1" class="ltx_text ltx_font_bold">offline CTC/attention-based</span> systems obtained on Librispeech-960 (U-WER/B-WER). </span></figcaption>
<div id="S4.T1.4.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:424.9pt;height:120.8pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-105.9pt,29.9pt) scale(0.667452580460897,0.667452580460897) ;">
<table id="S4.T1.4.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.4.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="S4.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">
<math id="S4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">N</annotation></semantics></math> = 0 (no-bias)</td>
<td id="S4.T1.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">
<math id="S4.T1.2.2.2.2.2.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.2.2.2.2.2.m1.1a"><mi id="S4.T1.2.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.2.m1.1c">N</annotation></semantics></math> = 100</td>
<td id="S4.T1.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">
<math id="S4.T1.3.3.3.3.3.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.3.3.3.3.3.m1.1a"><mi id="S4.T1.3.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.3.m1.1b"><ci id="S4.T1.3.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.3.m1.1c">N</annotation></semantics></math> = 500</td>
<td id="S4.T1.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t" colspan="2">
<math id="S4.T1.4.4.4.4.4.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.4.4.4.4.4.m1.1a"><mi id="S4.T1.4.4.4.4.4.m1.1.1" xref="S4.T1.4.4.4.4.4.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.4.m1.1b"><ci id="S4.T1.4.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.4.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.4.m1.1c">N</annotation></semantics></math> = 1000</td>
</tr>
<tr id="S4.T1.4.4.4.5.1" class="ltx_tr">
<th id="S4.T1.4.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Model</th>
<td id="S4.T1.4.4.4.5.1.2" class="ltx_td ltx_align_center">test-clean</td>
<td id="S4.T1.4.4.4.5.1.3" class="ltx_td ltx_align_center ltx_border_r">test-other</td>
<td id="S4.T1.4.4.4.5.1.4" class="ltx_td ltx_align_center">test-clean</td>
<td id="S4.T1.4.4.4.5.1.5" class="ltx_td ltx_align_center ltx_border_r">test-other</td>
<td id="S4.T1.4.4.4.5.1.6" class="ltx_td ltx_align_center">test-clean</td>
<td id="S4.T1.4.4.4.5.1.7" class="ltx_td ltx_align_center ltx_border_r">test-other</td>
<td id="S4.T1.4.4.4.5.1.8" class="ltx_td ltx_align_center">test-clean</td>
<td id="S4.T1.4.4.4.5.1.9" class="ltx_td ltx_align_center">test-other</td>
</tr>
<tr id="S4.T1.4.4.4.6.2" class="ltx_tr">
<th id="S4.T1.4.4.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S4.T1.4.4.4.6.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.6.2.2.1" class="ltx_text ltx_font_bold">2.57</span></td>
<td id="S4.T1.4.4.4.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.4.4.4.6.2.3.1" class="ltx_text ltx_font_bold">5.98</span></td>
<td id="S4.T1.4.4.4.6.2.4" class="ltx_td ltx_align_center ltx_border_t">2.57</td>
<td id="S4.T1.4.4.4.6.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.98</td>
<td id="S4.T1.4.4.4.6.2.6" class="ltx_td ltx_align_center ltx_border_t">2.57</td>
<td id="S4.T1.4.4.4.6.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.98</td>
<td id="S4.T1.4.4.4.6.2.8" class="ltx_td ltx_align_center ltx_border_t">2.57</td>
<td id="S4.T1.4.4.4.6.2.9" class="ltx_td ltx_align_center ltx_border_t">5.98</td>
</tr>
<tr id="S4.T1.4.4.4.7.3" class="ltx_tr">
<th id="S4.T1.4.4.4.7.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">(CTC/attention)</th>
<td id="S4.T1.4.4.4.7.3.2" class="ltx_td ltx_align_center">(<span id="S4.T1.4.4.4.7.3.2.1" class="ltx_text ltx_font_bold">1.5</span>/<span id="S4.T1.4.4.4.7.3.2.2" class="ltx_text ltx_font_bold">10.9</span>)</td>
<td id="S4.T1.4.4.4.7.3.3" class="ltx_td ltx_align_center ltx_border_r">(<span id="S4.T1.4.4.4.7.3.3.1" class="ltx_text ltx_font_bold">4.0</span>/<span id="S4.T1.4.4.4.7.3.3.2" class="ltx_text ltx_font_bold">23.1</span>)</td>
<td id="S4.T1.4.4.4.7.3.4" class="ltx_td ltx_align_center">(<span id="S4.T1.4.4.4.7.3.4.1" class="ltx_text ltx_font_bold">1.5</span>/10.9)</td>
<td id="S4.T1.4.4.4.7.3.5" class="ltx_td ltx_align_center ltx_border_r">(<span id="S4.T1.4.4.4.7.3.5.1" class="ltx_text ltx_font_bold">4.0</span>/23.1)</td>
<td id="S4.T1.4.4.4.7.3.6" class="ltx_td ltx_align_center">(<span id="S4.T1.4.4.4.7.3.6.1" class="ltx_text ltx_font_bold">1.5</span>/10.9)</td>
<td id="S4.T1.4.4.4.7.3.7" class="ltx_td ltx_align_center ltx_border_r">(<span id="S4.T1.4.4.4.7.3.7.1" class="ltx_text ltx_font_bold">4.0</span>/23.1)</td>
<td id="S4.T1.4.4.4.7.3.8" class="ltx_td ltx_align_center">(<span id="S4.T1.4.4.4.7.3.8.1" class="ltx_text ltx_font_bold">1.5</span>/10.9)</td>
<td id="S4.T1.4.4.4.7.3.9" class="ltx_td ltx_align_center">(<span id="S4.T1.4.4.4.7.3.9.1" class="ltx_text ltx_font_bold">4.0</span>/23.1)</td>
</tr>
<tr id="S4.T1.4.4.4.8.4" class="ltx_tr">
<th id="S4.T1.4.4.4.8.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">CPPNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</th>
<td id="S4.T1.4.4.4.8.4.2" class="ltx_td ltx_align_center ltx_border_t">4.29</td>
<td id="S4.T1.4.4.4.8.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.16</td>
<td id="S4.T1.4.4.4.8.4.4" class="ltx_td ltx_align_center ltx_border_t">3.40</td>
<td id="S4.T1.4.4.4.8.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.77</td>
<td id="S4.T1.4.4.4.8.4.6" class="ltx_td ltx_align_center ltx_border_t">3.68</td>
<td id="S4.T1.4.4.4.8.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.31</td>
<td id="S4.T1.4.4.4.8.4.8" class="ltx_td ltx_align_center ltx_border_t">3.81</td>
<td id="S4.T1.4.4.4.8.4.9" class="ltx_td ltx_align_center ltx_border_t">8.75</td>
</tr>
<tr id="S4.T1.4.4.4.9.5" class="ltx_tr">
<th id="S4.T1.4.4.4.9.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S4.T1.4.4.4.9.5.2" class="ltx_td ltx_align_center">(2.6/18.3)</td>
<td id="S4.T1.4.4.4.9.5.3" class="ltx_td ltx_align_center ltx_border_r">(5.9/37.5)</td>
<td id="S4.T1.4.4.4.9.5.4" class="ltx_td ltx_align_center">(2.6/10.4)</td>
<td id="S4.T1.4.4.4.9.5.5" class="ltx_td ltx_align_center ltx_border_r">(6.0/23.0)</td>
<td id="S4.T1.4.4.4.9.5.6" class="ltx_td ltx_align_center">(2.8/10.9)</td>
<td id="S4.T1.4.4.4.9.5.7" class="ltx_td ltx_align_center ltx_border_r">(6.5/24.3)</td>
<td id="S4.T1.4.4.4.9.5.8" class="ltx_td ltx_align_center">(2.9/11.4)</td>
<td id="S4.T1.4.4.4.9.5.9" class="ltx_td ltx_align_center">(6.9/25.3)</td>
</tr>
<tr id="S4.T1.4.4.4.10.6" class="ltx_tr">
<th id="S4.T1.4.4.4.10.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Attention-based DB</th>
<td id="S4.T1.4.4.4.10.6.2" class="ltx_td ltx_align_center ltx_border_t">5.05</td>
<td id="S4.T1.4.4.4.10.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.81</td>
<td id="S4.T1.4.4.4.10.6.4" class="ltx_td ltx_align_center ltx_border_t">2.75</td>
<td id="S4.T1.4.4.4.10.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.60</td>
<td id="S4.T1.4.4.4.10.6.6" class="ltx_td ltx_align_center ltx_border_t">3.21</td>
<td id="S4.T1.4.4.4.10.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.28</td>
<td id="S4.T1.4.4.4.10.6.8" class="ltx_td ltx_align_center ltx_border_t">3.47</td>
<td id="S4.T1.4.4.4.10.6.9" class="ltx_td ltx_align_center ltx_border_t">7.34</td>
</tr>
<tr id="S4.T1.4.4.4.11.7" class="ltx_tr">
<th id="S4.T1.4.4.4.11.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">+ BPB beam search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S4.T1.4.4.4.11.7.2" class="ltx_td ltx_align_center">(3.9/14.1)</td>
<td id="S4.T1.4.4.4.11.7.3" class="ltx_td ltx_align_center ltx_border_r">(6.6/27.9)</td>
<td id="S4.T1.4.4.4.11.7.4" class="ltx_td ltx_align_center">(2.3/6.0)</td>
<td id="S4.T1.4.4.4.11.7.5" class="ltx_td ltx_align_center ltx_border_r">(4.9/12.0)</td>
<td id="S4.T1.4.4.4.11.7.6" class="ltx_td ltx_align_center">(2.7/7.0)</td>
<td id="S4.T1.4.4.4.11.7.7" class="ltx_td ltx_align_center ltx_border_r">(5.5/13.5)</td>
<td id="S4.T1.4.4.4.11.7.8" class="ltx_td ltx_align_center">(3.0/7.7)</td>
<td id="S4.T1.4.4.4.11.7.9" class="ltx_td ltx_align_center">(6.4/15.8)</td>
</tr>
<tr id="S4.T1.4.4.4.12.8" class="ltx_tr">
<th id="S4.T1.4.4.4.12.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Proposed</th>
<td id="S4.T1.4.4.4.12.8.2" class="ltx_td ltx_align_center ltx_border_t">3.16</td>
<td id="S4.T1.4.4.4.12.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.95</td>
<td id="S4.T1.4.4.4.12.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.12.8.4.1" class="ltx_text ltx_font_bold">1.80</span></td>
<td id="S4.T1.4.4.4.12.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.4.4.4.12.8.5.1" class="ltx_text ltx_font_bold">4.63</span></td>
<td id="S4.T1.4.4.4.12.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.12.8.6.1" class="ltx_text ltx_font_bold">1.92</span></td>
<td id="S4.T1.4.4.4.12.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.4.4.4.12.8.7.1" class="ltx_text ltx_font_bold">4.81</span></td>
<td id="S4.T1.4.4.4.12.8.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.12.8.8.1" class="ltx_text ltx_font_bold">2.01</span></td>
<td id="S4.T1.4.4.4.12.8.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.12.8.9.1" class="ltx_text ltx_font_bold">4.97</span></td>
</tr>
<tr id="S4.T1.4.4.4.13.9" class="ltx_tr">
<th id="S4.T1.4.4.4.13.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_r"></th>
<td id="S4.T1.4.4.4.13.9.2" class="ltx_td ltx_align_center ltx_border_b">(1.9/13.8)</td>
<td id="S4.T1.4.4.4.13.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">(4.6/27.5)</td>
<td id="S4.T1.4.4.4.13.9.4" class="ltx_td ltx_align_center ltx_border_b">(1.7/<span id="S4.T1.4.4.4.13.9.4.1" class="ltx_text ltx_font_bold">2.9</span>)</td>
<td id="S4.T1.4.4.4.13.9.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">(4.3/<span id="S4.T1.4.4.4.13.9.5.1" class="ltx_text ltx_font_bold">7.1</span>)</td>
<td id="S4.T1.4.4.4.13.9.6" class="ltx_td ltx_align_center ltx_border_b">(1.8/<span id="S4.T1.4.4.4.13.9.6.1" class="ltx_text ltx_font_bold">3.1</span>)</td>
<td id="S4.T1.4.4.4.13.9.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">(4.5/<span id="S4.T1.4.4.4.13.9.7.1" class="ltx_text ltx_font_bold">7.9</span>)</td>
<td id="S4.T1.4.4.4.13.9.8" class="ltx_td ltx_align_center ltx_border_b">(1.9/<span id="S4.T1.4.4.4.13.9.8.1" class="ltx_text ltx_font_bold">3.3</span>)</td>
<td id="S4.T1.4.4.4.13.9.9" class="ltx_td ltx_align_center ltx_border_b">(4.6/<span id="S4.T1.4.4.4.13.9.9.1" class="ltx_text ltx_font_bold">8.5</span>)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results on offline CTC/attention-based system</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental setup ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the results of the offline CTC/attention-based systems obtained on the Librispeech-960 dataset for different bias list sizes <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">N</annotation></semantics></math>.
With a bias list size <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="N&gt;0" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><gt id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></gt><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">N&gt;0</annotation></semantics></math>, the proposed method improves the B-WER considerably despite a small increase in the U-WER, which results in a substantial improvement in the overall WER.
While the B-WER and U-WER tend to deteriorate with larger <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">N</annotation></semantics></math>, the proposed method remains superior to other DB techniques across all bias list sizes. Although the proposed method does not perform as well as the baseline when <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="N=0" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">N</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑁</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">N=0</annotation></semantics></math>, this is not considered a particularly limiting drawback considering that users typically register important keywords in the bias list.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Analysis of proposed bias token</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.6" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.3 Analysis of proposed bias token ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows an example of the cumulative log probability described in Eq. (<a href="#S3.E15" title="In 3.2 Bias decoder with dynamic vocabulary ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>), where the blue and red lines indicate the results obtained <span id="S4.SS3.p1.6.4" class="ltx_text ltx_font_italic">with</span> and <span id="S4.SS3.p1.6.5" class="ltx_text ltx_font_italic">without</span> the proposed bias tokens.
Without the use of dynamic tokens, the model struggles to capture the relationships between the subwords, which results in significantly lower scores for each subword.
Conversely, the proposed method assigns high scores to the bias token (<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mo id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><lt id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">&lt;</annotation></semantics></math><span id="S4.SS3.p1.2.1" class="ltx_text ltx_font_bold ltx_font_italic">Nelly<math id="S4.SS3.p1.2.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS3.p1.2.1.m1.1a"><mo id="S4.SS3.p1.2.1.m1.1.1" xref="S4.SS3.p1.2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.1.m1.1b"><gt id="S4.SS3.p1.2.1.m1.1.1.cmml" xref="S4.SS3.p1.2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.1.m1.1c">&gt;</annotation></semantics></math></span>), resulting in a better B-WER (Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental setup ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Interestingly, the log probabilities before and after the bias token (<math id="S4.SS3.p1.3.m2.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS3.p1.3.m2.1a"><mo id="S4.SS3.p1.3.m2.1.1" xref="S4.SS3.p1.3.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m2.1b"><lt id="S4.SS3.p1.3.m2.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m2.1c">&lt;</annotation></semantics></math><span id="S4.SS3.p1.4.2" class="ltx_text ltx_font_italic">fresh<math id="S4.SS3.p1.4.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS3.p1.4.2.m1.1a"><mo id="S4.SS3.p1.4.2.m1.1.1" xref="S4.SS3.p1.4.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.2.m1.1b"><gt id="S4.SS3.p1.4.2.m1.1.1.cmml" xref="S4.SS3.p1.4.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.2.m1.1c">&gt;</annotation></semantics></math></span> and <math id="S4.SS3.p1.5.m3.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS3.p1.5.m3.1a"><mo id="S4.SS3.p1.5.m3.1.1" xref="S4.SS3.p1.5.m3.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m3.1b"><lt id="S4.SS3.p1.5.m3.1.1.cmml" xref="S4.SS3.p1.5.m3.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m3.1c">&lt;</annotation></semantics></math><span id="S4.SS3.p1.6.3" class="ltx_text ltx_font_italic">is<math id="S4.SS3.p1.6.3.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS3.p1.6.3.m1.1a"><mo id="S4.SS3.p1.6.3.m1.1.1" xref="S4.SS3.p1.6.3.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.3.m1.1b"><gt id="S4.SS3.p1.6.3.m1.1.1.cmml" xref="S4.SS3.p1.6.3.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.3.m1.1c">&gt;</annotation></semantics></math></span>) remain stable, which indicates that the proposed method maintains the context successfully throughout the entire token sequence.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div id="S4.F4.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:212.5pt;">
<img src="/html/2405.13344/assets/figures/prob.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="419" height="220" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.4.2" class="ltx_text" style="font-size:90%;">Example of cumulative log probability</span></figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div id="S4.F5.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:212.5pt;">
<img src="/html/2405.13344/assets/figures/weight.png" id="S4.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="419" height="238" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.5.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.1" class="ltx_text" style="font-size:90%;">Effect of the bias weight <math id="S4.F5.3.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F5.3.1.m1.1b"><mi id="S4.F5.3.1.m1.1.1" xref="S4.F5.3.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F5.3.1.m1.1c"><ci id="S4.F5.3.1.m1.1.1.cmml" xref="S4.F5.3.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.3.1.m1.1d">\mu</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Effect of the bias weight during inference</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.4" class="ltx_p">Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Analysis of proposed bias token ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the effect of the bias weights <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mu</annotation></semantics></math> (Section <a href="#S3.SS4" title="3.4 Bias weight during inference ‣ 3 Proposed method ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>) on the WER, U-WER, and B-WER results when the bias list size <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">N</annotation></semantics></math> = 2000.
Increasing the bias weights <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\mu</annotation></semantics></math> improves the B-WER but deteriorates U-WER due to its tendency to overbias.
Under this experimental condition, there is a slight tendency to overbias when no bias weights are introduced; thus, when <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mu=0.8" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">μ</mi><mo id="S4.SS4.p1.4.m4.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><eq id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1"></eq><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝜇</ci><cn type="float" id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\mu=0.8</annotation></semantics></math>, over-bias can be suppressed.
The degree to which the model should be biased depends on the target user domain; thus, we believe that this mechanism to adjust the bias weights easily during inference is effective.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Validation on Japanese dataset</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.2" class="ltx_p">We also validate the proposed method on a Japanese dataset containing the Corpus of Spontaneous Japanese (581 h) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, 181 hours of Japanese speech in the database developed by the Advanced Telecommunications Research Institute International <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, and 93 hours of Japanese speech data, including meeting and morning assembly scenarios with the attention-based system described in Section <a href="#S4.SS1" title="4.1 Experimental setup ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>.
Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Validation on Japanese dataset ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results obtained when <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">N</annotation></semantics></math> = 203 technical terms are registered in the bias list <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\bm{B}</annotation></semantics></math>. The proposed method improves the B-CER significantly with a slight degradation in U-CER, thereby resulting in the best overall CER.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Experimental results obtained on Japanese dataset.</span></figcaption>
<div id="S4.T2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:81.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(19.6pt,-4.6pt) scale(1.12761046452512,1.12761046452512) ;">
<table id="S4.T2.4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.1.1.1" class="ltx_tr">
<th id="S4.T2.4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Model</th>
<th id="S4.T2.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">CER</th>
<th id="S4.T2.4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">U-CER</th>
<th id="S4.T2.4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">B-CER</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.1.2.1" class="ltx_tr">
<th id="S4.T2.4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S4.T2.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">9.85</td>
<td id="S4.T2.4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.1.2.1.3.1" class="ltx_text ltx_font_bold">8.17</span></td>
<td id="S4.T2.4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">21.76</td>
</tr>
<tr id="S4.T2.4.1.3.2" class="ltx_tr">
<th id="S4.T2.4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">BPB beam search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S4.T2.4.1.3.2.2" class="ltx_td ltx_align_center">9.67</td>
<td id="S4.T2.4.1.3.2.3" class="ltx_td ltx_align_center">9.20</td>
<td id="S4.T2.4.1.3.2.4" class="ltx_td ltx_align_center">13.16</td>
</tr>
<tr id="S4.T2.4.1.4.3" class="ltx_tr">
<th id="S4.T2.4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">Proposed</th>
<td id="S4.T2.4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.1.4.3.2.1" class="ltx_text ltx_font_bold">9.03</span></td>
<td id="S4.T2.4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b">8.93</td>
<td id="S4.T2.4.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.1.4.3.4.1" class="ltx_text ltx_font_bold">9.73</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Validation on streaming RNN-T-based system</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.6 Validation on streaming RNN-T-based system ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results of the streaming RNN-T-based system with a bias list of size <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">N</annotation></semantics></math> = 100.
Consistent with the results from the offline CTC/attention-based system (Tabel <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental setup ‣ 4 Experiment ‣ Contextualized Automatic Speech Recognition with Dynamic Vocabulary" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), the proposed method significantly improves the B-WER compared to the conventional DB method without relying on additional information such as phonemes, while maintaining a comparable overall WER to conventional DB approaches (A1-2 vs. A3).
Furthermore, the conventional DB method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> significantly improves the B-WER using additional text data (A1-2 vs. B1-2), whereas the proposed method achieves similar B-WER without using such additional data (A3 vs. B1-2).</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.3.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.4.2" class="ltx_text" style="font-size:90%;">WER results of <span id="S4.T3.4.2.1" class="ltx_text ltx_font_bold">streaming RNN-T-based</span> systems on Librispeech-960 test-clean. </span></figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:127.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.9pt,-0.6pt) scale(1.00880796935619,1.00880796935619) ;">
<table id="S4.T3.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.5.1.1.1" class="ltx_tr">
<th id="S4.T3.5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">ID</th>
<th id="S4.T3.5.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Model</th>
<td id="S4.T3.5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Text data</td>
<td id="S4.T3.5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">WER/B-WER</td>
</tr>
<tr id="S4.T3.5.1.2.2" class="ltx_tr">
<th id="S4.T3.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">A0</th>
<th id="S4.T3.5.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Baseline (RNN-T)</th>
<td id="S4.T3.5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.1.2.2.3.1" class="ltx_text ltx_font_bold">None</span></td>
<td id="S4.T3.5.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">3.7 / 14.1</td>
</tr>
<tr id="S4.T3.5.1.3.3" class="ltx_tr">
<th id="S4.T3.5.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">A1</th>
<th id="S4.T3.5.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Trie-based DB + WFST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T3.5.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.1.3.3.3.1" class="ltx_text ltx_font_bold">None</span></td>
<td id="S4.T3.5.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">2.8 / 7.4</td>
</tr>
<tr id="S4.T3.5.1.4.4" class="ltx_tr">
<th id="S4.T3.5.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">A2</th>
<th id="S4.T3.5.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Phoneme-based DB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<td id="S4.T3.5.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.1.4.4.3.1" class="ltx_text ltx_font_bold">None</span></td>
<td id="S4.T3.5.1.4.4.4" class="ltx_td ltx_align_center">
<span id="S4.T3.5.1.4.4.4.1" class="ltx_text ltx_font_bold">2.6</span> / 6.8</td>
</tr>
<tr id="S4.T3.5.1.5.5" class="ltx_tr">
<th id="S4.T3.5.1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">A3</th>
<th id="S4.T3.5.1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S4.T3.5.1.5.5.2.1" class="ltx_text ltx_font_bold">Proposed</span></th>
<td id="S4.T3.5.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.1.5.5.3.1" class="ltx_text ltx_font_bold">None</span></td>
<td id="S4.T3.5.1.5.5.4" class="ltx_td ltx_align_center">
<span id="S4.T3.5.1.5.5.4.1" class="ltx_text ltx_font_bold">2.6</span> / <span id="S4.T3.5.1.5.5.4.2" class="ltx_text ltx_font_bold">3.1</span>
</td>
</tr>
<tr id="S4.T3.5.1.6.6" class="ltx_tr">
<th id="S4.T3.5.1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">B1</th>
<th id="S4.T3.5.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">A1 + NNLM* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T3.5.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">*810M words</td>
<td id="S4.T3.5.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T3.5.1.6.6.4.1" class="ltx_text ltx_font_bold">2.0</span> / 5.7</td>
</tr>
<tr id="S4.T3.5.1.7.7" class="ltx_tr">
<th id="S4.T3.5.1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">B2</th>
<th id="S4.T3.5.1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">A2 + USTR* + WFST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<td id="S4.T3.5.1.7.7.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">*810M words</td>
<td id="S4.T3.5.1.7.7.4" class="ltx_td ltx_align_center ltx_border_b">2.1 / <span id="S4.T3.5.1.7.7.4.1" class="ltx_text ltx_font_bold">2.0</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we present a simple but effective deep biasing method that introduces a dynamic vocabulary where the phrase-level dynamic bias tokens with the single entities.
To enhance the usability of the proposed method, we introduce a bias weight to adjust the bias intensity during inference.
The experimental results obtained by applying the proposed method to an offline CTC/attention-based system and a streaming RNN-T-based system demonstrate that it significantly improves bias phrase recognition on English and Japanese datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
R. Prabhavalkar <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``End-to-end speech recognition: A survey,'' <em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em>, vol. 32, pp. 325–351, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Graves, S. Fernández, F. Gomez, and J. Schmidhuber, ``Connectionist temporal classification: Labelling unsegmented sequence data with recurrent neural networks,'' in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proc. ICML</em>, 2006, pp. 369–376.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Graves and N. Jaitly, ``Towards end-to-end speech recognition with recurrent neural networks,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. ICML</em>, 2014, pp. 1764–1772.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Graves, ``Sequence transduction with recurrent neural networks,'' in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proc. ICML</em>, 2012.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Gulati <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Conformer: Convolution-augmented transformer for speech recognition,'' in <em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020, pp. 5036–5040.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. K. Chorowski, D. Bahdanau, D. Serdyuk, K. Cho, and Y. Bengio, ``Attention-based models for speech recognition,'' <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 28, 2015.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
W. Chan, N. Jaitly, Q. Le, and O. Vinyals, ``Listen, attend and spell: A neural network for large vocabulary conversational speech recognition,'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2016, pp. 4960–4964.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Watanabe, T. Hori, S. Kim, J. R. Hershey, and T. Hayashi, ``Hybrid ctc/attention architecture for end-to-end speech recognition,'' <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Journal of Selected Topics in Signal Processing</em>, vol. 11, no. 8, pp. 1240–1253, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
K. Hu, T. N. Sainath, R. Pang, and R. Prabhavalkar, ``Deliberation model based two-pass end-to-end speech recognition,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2020, pp. 7799–7803.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Sudo, M. Shakeel, B. Yan, J. Shi, and S. Watanabe, ``4D ASR: Joint modeling of CTC, attention, transducer, and mask-predict decoders,'' in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023, pp. 3312–3316.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Peng <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Reproducing whisper-style training using an open-source toolkit and publicly available data,'' in <em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic">Proc. ASRU</em>, 2023, pp. 1–8.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
R. Huang, O. Abdel-Hamid, X. Li, and G. Evermann, ``Class lm and word mapping for contextual biasing in end-to-end asr,'' in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020, pp. 4348–4351.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
I. Williams, A. Kannan, P. Aleksic, D. Rybach, and T. Sainath, ``Contextual speech recognition in end-to-end neural network systems using beam search,'' in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. Kannan <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``An analysis of incorporating an external language model into a sequence-to-sequence model,'' in <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2018, pp. 5824–5828.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Sriram, H. Jun, S. Satheesh, and A. Coates, ``Cold fusion: training seq2seq models together with language models,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2018, pp. 387–391.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
G. Pundak, T. N. Sainath, R. Prabhavalkar, A. Kannan, and D. Zhao, ``Deep context: End-to-end contextual speech recognition,'' in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc. SLT</em>, 2018, pp. 418–425.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Jain, G. Keren, J. Mahadeokar, and Y. Saraf, ``Contextual rnn-t for open domain asr,'' in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020, pp. 11–15.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
K. Huang <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Contextualized End-to-End Speech Recognition with Contextual Phrase Prediction Network,'' in <em id="bib.bib18.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023, pp. 4933–4937.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M. Han <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Improving end-to-end contextual speech recognition with fine-grained contextual knowledge selection,'' in <em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2022, pp. 491–495.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C. Huber, J. Hussain, S. Stüker, and A. Waibel, ``Instant one-shot word-learning for context-specific neural sequence-to-sequence speech recognition,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proc. ASRU</em>, 2021, pp. 1–7.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
S. Zhou, Z. Li, Y. Hong, M. Zhang, Z. Wang, and B. Huai, ``Copyne: Better contextual asr by copying named entities,'' <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.12839</em>, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Sudo, M. Shakeel, Y. Fukumoto, Y. Peng, and S. Watanabe, ``Contextualized automatic speech recognition with attention-based bias phrase boosted beam search,'' in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2024, pp. 10 896–10 900.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
S. Dingliwal, M. Sunkara, S. Ronanki, J. Farris, K. Kirchhoff, and S. Bodapati, ``Personalization of ctc speech recognition models,'' in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proc. SLT</em>, 2023, pp. 302–309.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
G. Sun, C. Zhang, and P. C. Woodland, ``Tree-constrained pointer generator for end-to-end contextual speech recognition,'' in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. ASRU</em>, 2021, pp. 780–787.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
D. Le, Jain <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Contextualized streaming end-to-end speech recognition with trie-based deep biasing and shallow fusion,'' in <em id="bib.bib25.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021, pp. 1772–1776.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
J. Qiu, L. Huang, B. Li, J. Zhang, L. Lu, and Z. Ma, ``Improving large-scale deep biasing with phoneme features and text-only data in streaming transducer,'' in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proc. ASRU</em>, 2023, pp. 1–8.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
A. Bruguier, R. Prabhavalkar, G. Pundak, and T. N. Sainath, ``Phoebe: Pronunciation-aware contextualization for end-to-end speech recognition,'' in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2019, pp. 6171–6175.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Chen, M. Jain, Y. Wang, M. L. Seltzer, and C. Fuegen, ``Joint grapheme and phoneme embeddings for contextual end-to-end asr.'' in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2019, pp. 3490–3494.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
H. Futami, E. Tsunoo, Y. Kashiwagi, H. Ogawa, S. Arora, and S. Watanabe, ``Phoneme-aware encoding for prefix-tree-based contextual asr,'' in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2024.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Sudo, K. Hata, and K. Nakadai, ``Retraining-free customized asr for enharmonic words based on a named-entity-aware model and phoneme similarity estimation,'' in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023, pp. 3312–3316.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
X. Wang <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Towards contextual spelling correction for customization of end-to-end speech recognition systems,'' <em id="bib.bib31.2.2" class="ltx_emph ltx_font_italic">IEEE Trans. Audio, Speech, Lang. Process.</em>, vol. 30, pp. 3089–3097, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
X. Wang, Y. Liu, J. Li, and S. Zhao, ``Improving contextual spelling correction by external acoustics attention and semantic aware data augmentation,'' in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Sudo, S. Muhammad, Y. Peng, and S. Watanabe, ``Time-synchronous one-pass Beam Search for Parallel Online and Offline Transducers with Dynamic Block Training,'' in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023, pp. 4479–4483.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
E. Tsunoo, H. Futami, Y. Kashiwagi, S. Arora, and S. Watanabe, ``Integration of Frame- and Label-synchronous Beam Search for Streaming Encoder-decoder Speech Recognition,'' in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023, pp. 1369–1373.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, T. Xu, G. Brockman, C. McLeavey, and I. Sutskever, ``Robust speech recognition via large-scale weak supervision,'' in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proc. ICML</em>, 2023, pp. 28 492–28 518.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Y. Peng <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Owsm v3.1: Better and faster open whisper-style speech models based on e-branchformer,'' <em id="bib.bib36.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.16658</em>, 2024.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. Peng, Y. Sudo, M. Shakeel, and S. Watanabe, ``Owsm-ctc: An open encoder-only speech foundation model for speech recognition, translation, and language identification,'' <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.12654</em>, 2024.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
E. Tsunoo, Y. Kashiwagi, T. Kumakura, and S. Watanabe, ``Transformer ASR with contextual block processing,'' in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proc. ASRU</em>, 2019, pp. 427–433.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
V. Panayotov <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Librispeech: an asr corpus based on public domain audio books,'' in <em id="bib.bib39.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2015, pp. 5206–5210.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
S. Watanabe <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``ESPnet: End-to-end speech processing toolkit,'' in <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2018, pp. 2207–2211.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
K. Maekawa, ``Corpus of spontaneous Japanese: Its design and evaluation,'' in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">ISCA &amp; IEEE Workshop on Spontaneous Speech Processing and Recognition</em>, 2003.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
A. Kurematsu <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Atr japanese speech database as a tool of speech recognition and synthesis,'' <em id="bib.bib42.2.2" class="ltx_emph ltx_font_italic">Speech Communication</em>, vol. 9, no. 4, pp. 357–363, 1990.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.13343" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.13344" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.13344">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.13344" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.13345" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 18:58:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
