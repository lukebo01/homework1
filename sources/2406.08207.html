<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.08207] Transformer-based Model for ASR N-Best Rescoring and Rewriting</title><meta property="og:description" content="Voice assistants increasingly use on-device Automatic Speech Recognition (ASR) to ensure speed and privacy. However, due to resource constraints on the device, queries pertaining to complex information domains often re…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Transformer-based Model for ASR N-Best Rescoring and Rewriting">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Transformer-based Model for ASR N-Best Rescoring and Rewriting">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.08207">

<!--Generated on Fri Jul  5 23:24:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">Iwen E. Kang, Christophe Van Gysel, Man-Hung Siu



</p>
</div>
<h1 class="ltx_title ltx_title_document">Transformer-based Model for ASR N-Best Rescoring and Rewriting</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Voice assistants increasingly use on-device Automatic Speech Recognition (ASR) to ensure speed and privacy. However, due to resource constraints on the device, queries pertaining to complex information domains often require further processing by a search engine. For such applications, we propose a novel Transformer based model capable of rescoring and rewriting, by exploring full context of the N-best hypotheses in parallel. We also propose a new discriminative sequence training objective that can work well for both rescore and rewrite tasks.
We show that our Rescore+Rewrite model outperforms the Rescore-only baseline, and achieves up to an average <math id="id1.1.m1.1" class="ltx_Math" alttext="8.6" display="inline"><semantics id="id1.1.m1.1a"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">8.6</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn type="float" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">8.6</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">8.6</annotation></semantics></math>% relative Word Error Rate (WER) reduction over the ASR system by itself.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>N-best deliberation, transformers, speech recognition, voice assistants
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">ASR converts user spoken audio into word sequences and often represents the word sequence as a ranked list of N hypotheses, known as the N-best list. The top hypothesis (1-best) is used as the recognized input for downstream tasks. To ensure speed and privacy, we can implement the ASR recognizer as an on-device component, keeping user-spoken audio within the device. On device ASR imposes constraints on model size that still works well for personal tasks like ``call mom'' or ``set alarm'', however, it can be sub-optimal for entity-rich queries in knowledge domains <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, such as ``play Yesterday by Beatles''. Given these knowledge queries are eventually processed in the server <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, ASR can also be improved downstream by either re-ranking the N-best hypotheses, i.e., ``rescoring'', or overriding the 1-best with its predicted corrections, i.e., ``rewriting''.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Conventional N-best rescoring often involves re-ranking based on a per hypothesis ``score'' computed individually <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. This approach typically interpolates with ASR acoustic scores for the second-pass rescoring. An interesting alternative is to explore the entire N-best list as input context for rescoring, and rewriting 1-best by leveraging joint N-best information.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Using a transformer model for N-best rescoring has been proposed by others. <cite class="ltx_cite ltx_citemacro_citet">Guo et al. [<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> proposed an LSTM-based Spell-Correction (SC) model to use N-best text data for error corrections.
<cite class="ltx_cite ltx_citemacro_citet">Hrinchuk et al. [<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed a vanilla Transformer model that operates similarly to neural machine translation (NMT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, specifically focused on rewriting without rescoring.
<cite class="ltx_cite ltx_citemacro_citet">Xu et al. [<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> trained a BERT-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> rescoring model with Minimum Word Error Rate (MWER) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> loss. <cite class="ltx_cite ltx_citemacro_citet">Pandey et al. [<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> proposed a rescoring model with attention to lattices.
<cite class="ltx_cite ltx_citemacro_citet">Hu et al. [<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposed a Transformer-based rescoring model, which achieves better accuracy and latency than their previous LSTM-based counterpart <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Their ``Transformer Deliberation Rescorer'' model attends to both encoded audio and text hypotheses.
<cite class="ltx_cite ltx_citemacro_citet">Variani et al. [<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> proposed an N-best rescoring method using acoustic representations as inputs for optimizing ASR interpolation weights, and showed that Oracle Prediction, an edit-distance based adaptive weight optimization method, outperforms the non-adaptive weights.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Contrary to the related work above, which focused exclusively on either rescoring or rewriting task, in this paper, we propose a model capable of both rescoring and rewriting ASR hypotheses. This new model takes the full context of the N-best hypotheses in parallel.
Our proposed <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">Transformer Rescore Attention</span> (TRA) model is illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.2 Transformer Rescore Attention (TRA) Model ‣ 2 Models ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We also propose a new discriminative sequence training objective, <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">Matching Query Similarity Distribution</span> (MQSD), that can work well with cross-entropy based training to perform both rescore and rewrite tasks.
Our work is different from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>: a) Their model requires acoustic representations as inputs, while our model does NOT. Our TRA can operate as a standalone model outside of on-device ASR, the acoustic representations never leaves the device hence preserving privacy. b) Our MQSD performs effectively for both rescoring/rewriting tasks, whereas their Oracle Prediction is solely utilized to train a model for optimizing adaptive weight interpolations.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We show that: (1) our TRA model trained with MQSD works well for both rescore and rewrite tasks; (2) As a standalone model, our Rescore+Rewrite model outperforms the Rescore-only baseline model; (3) As an external LM model for ASR weights interpolation, our TRA model also outperforms the 4-gram LM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Models</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In certain cases, due to privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> or design limitations, the on-device ASR acoustic embeddings may not be available to downstream tasks that operate in the cloud. For example, the on-device encoder state has a length proportional to the audio, and hence, may result in a payload that would incur too much latency to transmit over the network.
Hence, we choose to simplify the “Transformer Deliberation Rescorer” <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> by removing acoustic components from the model, and re-implement it as our baseline ``N-best Transformer Rescorer'' (TR) model.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Transformer Rescorer (TR) Model</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.14" class="ltx_p">Our baseline TR model is trained using a combined cross-entropy and MWER loss function. The MWER tries to minimize the expected number of word errors over the N-best hypotheses expressed in this equation:</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.6" class="ltx_Math" alttext="L_{MWER}(x,y^{*})=\sum\limits_{y_{i}\in B\left(x,N\right)}p\left(y_{i}|x\right)\cdot\left(W\left(y_{i},y^{*}\right)-E_{N}\right)" display="block"><semantics id="S2.Ex1.m1.6a"><mrow id="S2.Ex1.m1.6.6" xref="S2.Ex1.m1.6.6.cmml"><mrow id="S2.Ex1.m1.4.4.1" xref="S2.Ex1.m1.4.4.1.cmml"><msub id="S2.Ex1.m1.4.4.1.3" xref="S2.Ex1.m1.4.4.1.3.cmml"><mi id="S2.Ex1.m1.4.4.1.3.2" xref="S2.Ex1.m1.4.4.1.3.2.cmml">L</mi><mrow id="S2.Ex1.m1.4.4.1.3.3" xref="S2.Ex1.m1.4.4.1.3.3.cmml"><mi id="S2.Ex1.m1.4.4.1.3.3.2" xref="S2.Ex1.m1.4.4.1.3.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.3.3.1" xref="S2.Ex1.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S2.Ex1.m1.4.4.1.3.3.3" xref="S2.Ex1.m1.4.4.1.3.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.3.3.1a" xref="S2.Ex1.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S2.Ex1.m1.4.4.1.3.3.4" xref="S2.Ex1.m1.4.4.1.3.3.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.3.3.1b" xref="S2.Ex1.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S2.Ex1.m1.4.4.1.3.3.5" xref="S2.Ex1.m1.4.4.1.3.3.5.cmml">R</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.4.4.1.2" xref="S2.Ex1.m1.4.4.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.4.4.1.1.1" xref="S2.Ex1.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.Ex1.m1.3.3" xref="S2.Ex1.m1.3.3.cmml">x</mi><mo id="S2.Ex1.m1.4.4.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.2.cmml">,</mo><msup id="S2.Ex1.m1.4.4.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.cmml"><mi id="S2.Ex1.m1.4.4.1.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml">y</mi><mo id="S2.Ex1.m1.4.4.1.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.Ex1.m1.4.4.1.1.1.4" xref="S2.Ex1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.Ex1.m1.6.6.4" xref="S2.Ex1.m1.6.6.4.cmml">=</mo><mrow id="S2.Ex1.m1.6.6.3" xref="S2.Ex1.m1.6.6.3.cmml"><munder id="S2.Ex1.m1.6.6.3.3" xref="S2.Ex1.m1.6.6.3.3.cmml"><mo movablelimits="false" id="S2.Ex1.m1.6.6.3.3.2" xref="S2.Ex1.m1.6.6.3.3.2.cmml">∑</mo><mrow id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.2.cmml"><msub id="S2.Ex1.m1.2.2.2.4" xref="S2.Ex1.m1.2.2.2.4.cmml"><mi id="S2.Ex1.m1.2.2.2.4.2" xref="S2.Ex1.m1.2.2.2.4.2.cmml">y</mi><mi id="S2.Ex1.m1.2.2.2.4.3" xref="S2.Ex1.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.2.2.2.3" xref="S2.Ex1.m1.2.2.2.3.cmml">∈</mo><mrow id="S2.Ex1.m1.2.2.2.5" xref="S2.Ex1.m1.2.2.2.5.cmml"><mi id="S2.Ex1.m1.2.2.2.5.2" xref="S2.Ex1.m1.2.2.2.5.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.2.5.1" xref="S2.Ex1.m1.2.2.2.5.1.cmml">​</mo><mrow id="S2.Ex1.m1.2.2.2.5.3.2" xref="S2.Ex1.m1.2.2.2.5.3.1.cmml"><mo id="S2.Ex1.m1.2.2.2.5.3.2.1" xref="S2.Ex1.m1.2.2.2.5.3.1.cmml">(</mo><mi id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml">x</mi><mo id="S2.Ex1.m1.2.2.2.5.3.2.2" xref="S2.Ex1.m1.2.2.2.5.3.1.cmml">,</mo><mi id="S2.Ex1.m1.2.2.2.2" xref="S2.Ex1.m1.2.2.2.2.cmml">N</mi><mo id="S2.Ex1.m1.2.2.2.5.3.2.3" xref="S2.Ex1.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S2.Ex1.m1.6.6.3.2" xref="S2.Ex1.m1.6.6.3.2.cmml"><mrow id="S2.Ex1.m1.5.5.2.1.1" xref="S2.Ex1.m1.5.5.2.1.1.cmml"><mi id="S2.Ex1.m1.5.5.2.1.1.3" xref="S2.Ex1.m1.5.5.2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.5.5.2.1.1.2" xref="S2.Ex1.m1.5.5.2.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.5.5.2.1.1.1.1" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.5.5.2.1.1.1.1.2" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.5.5.2.1.1.1.1.1" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.2" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.3" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex1.m1.5.5.2.1.1.1.1.1.1" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.5.5.2.1.1.1.1.1.3" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo rspace="0.055em" id="S2.Ex1.m1.5.5.2.1.1.1.1.3" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S2.Ex1.m1.6.6.3.2.3" xref="S2.Ex1.m1.6.6.3.2.3.cmml">⋅</mo><mrow id="S2.Ex1.m1.6.6.3.2.2.1" xref="S2.Ex1.m1.6.6.3.2.2.1.1.cmml"><mo id="S2.Ex1.m1.6.6.3.2.2.1.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.3.2.2.1.1" xref="S2.Ex1.m1.6.6.3.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.6.6.3.2.2.1.1.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.cmml"><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.2.4" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.4.cmml">W</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.3.2.2.1.1.2.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.3.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.3.cmml"><mo id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.3.cmml">(</mo><msub id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.4" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.3.cmml">,</mo><msup id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.cmml"><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.2.cmml">y</mi><mo id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.3.cmml">∗</mo></msup><mo id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.5" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.6.6.3.2.2.1.1.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.3.cmml">−</mo><msub id="S2.Ex1.m1.6.6.3.2.2.1.1.4" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4.cmml"><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.4.2" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4.2.cmml">E</mi><mi id="S2.Ex1.m1.6.6.3.2.2.1.1.4.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4.3.cmml">N</mi></msub></mrow><mo id="S2.Ex1.m1.6.6.3.2.2.1.3" xref="S2.Ex1.m1.6.6.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.6b"><apply id="S2.Ex1.m1.6.6.cmml" xref="S2.Ex1.m1.6.6"><eq id="S2.Ex1.m1.6.6.4.cmml" xref="S2.Ex1.m1.6.6.4"></eq><apply id="S2.Ex1.m1.4.4.1.cmml" xref="S2.Ex1.m1.4.4.1"><times id="S2.Ex1.m1.4.4.1.2.cmml" xref="S2.Ex1.m1.4.4.1.2"></times><apply id="S2.Ex1.m1.4.4.1.3.cmml" xref="S2.Ex1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.3.1.cmml" xref="S2.Ex1.m1.4.4.1.3">subscript</csymbol><ci id="S2.Ex1.m1.4.4.1.3.2.cmml" xref="S2.Ex1.m1.4.4.1.3.2">𝐿</ci><apply id="S2.Ex1.m1.4.4.1.3.3.cmml" xref="S2.Ex1.m1.4.4.1.3.3"><times id="S2.Ex1.m1.4.4.1.3.3.1.cmml" xref="S2.Ex1.m1.4.4.1.3.3.1"></times><ci id="S2.Ex1.m1.4.4.1.3.3.2.cmml" xref="S2.Ex1.m1.4.4.1.3.3.2">𝑀</ci><ci id="S2.Ex1.m1.4.4.1.3.3.3.cmml" xref="S2.Ex1.m1.4.4.1.3.3.3">𝑊</ci><ci id="S2.Ex1.m1.4.4.1.3.3.4.cmml" xref="S2.Ex1.m1.4.4.1.3.3.4">𝐸</ci><ci id="S2.Ex1.m1.4.4.1.3.3.5.cmml" xref="S2.Ex1.m1.4.4.1.3.3.5">𝑅</ci></apply></apply><interval closure="open" id="S2.Ex1.m1.4.4.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1"><ci id="S2.Ex1.m1.3.3.cmml" xref="S2.Ex1.m1.3.3">𝑥</ci><apply id="S2.Ex1.m1.4.4.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S2.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.2">𝑦</ci><times id="S2.Ex1.m1.4.4.1.1.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.3"></times></apply></interval></apply><apply id="S2.Ex1.m1.6.6.3.cmml" xref="S2.Ex1.m1.6.6.3"><apply id="S2.Ex1.m1.6.6.3.3.cmml" xref="S2.Ex1.m1.6.6.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.3.3.1.cmml" xref="S2.Ex1.m1.6.6.3.3">subscript</csymbol><sum id="S2.Ex1.m1.6.6.3.3.2.cmml" xref="S2.Ex1.m1.6.6.3.3.2"></sum><apply id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2"><in id="S2.Ex1.m1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.3"></in><apply id="S2.Ex1.m1.2.2.2.4.cmml" xref="S2.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.4.1.cmml" xref="S2.Ex1.m1.2.2.2.4">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.4.2.cmml" xref="S2.Ex1.m1.2.2.2.4.2">𝑦</ci><ci id="S2.Ex1.m1.2.2.2.4.3.cmml" xref="S2.Ex1.m1.2.2.2.4.3">𝑖</ci></apply><apply id="S2.Ex1.m1.2.2.2.5.cmml" xref="S2.Ex1.m1.2.2.2.5"><times id="S2.Ex1.m1.2.2.2.5.1.cmml" xref="S2.Ex1.m1.2.2.2.5.1"></times><ci id="S2.Ex1.m1.2.2.2.5.2.cmml" xref="S2.Ex1.m1.2.2.2.5.2">𝐵</ci><interval closure="open" id="S2.Ex1.m1.2.2.2.5.3.1.cmml" xref="S2.Ex1.m1.2.2.2.5.3.2"><ci id="S2.Ex1.m1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1">𝑥</ci><ci id="S2.Ex1.m1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2">𝑁</ci></interval></apply></apply></apply><apply id="S2.Ex1.m1.6.6.3.2.cmml" xref="S2.Ex1.m1.6.6.3.2"><ci id="S2.Ex1.m1.6.6.3.2.3.cmml" xref="S2.Ex1.m1.6.6.3.2.3">⋅</ci><apply id="S2.Ex1.m1.5.5.2.1.1.cmml" xref="S2.Ex1.m1.5.5.2.1.1"><times id="S2.Ex1.m1.5.5.2.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.1.1.2"></times><ci id="S2.Ex1.m1.5.5.2.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.1.1.3">𝑝</ci><apply id="S2.Ex1.m1.5.5.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.5.5.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.Ex1.m1.5.5.2.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex1.m1.6.6.3.2.2.1.1.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1"><minus id="S2.Ex1.m1.6.6.3.2.2.1.1.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.3"></minus><apply id="S2.Ex1.m1.6.6.3.2.2.1.1.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2"><times id="S2.Ex1.m1.6.6.3.2.2.1.1.2.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.3"></times><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.2.4.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.4">𝑊</ci><interval closure="open" id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2"><apply id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.2">𝑦</ci><times id="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.2.2.2.2.3"></times></apply></interval></apply><apply id="S2.Ex1.m1.6.6.3.2.2.1.1.4.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.3.2.2.1.1.4.1.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4">subscript</csymbol><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.4.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4.2">𝐸</ci><ci id="S2.Ex1.m1.6.6.3.2.2.1.1.4.3.cmml" xref="S2.Ex1.m1.6.6.3.2.2.1.1.4.3">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.6c">L_{MWER}(x,y^{*})=\sum\limits_{y_{i}\in B\left(x,N\right)}p\left(y_{i}|x\right)\cdot\left(W\left(y_{i},y^{*}\right)-E_{N}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.13" class="ltx_p">where <math id="S2.SS1.p1.1.m1.5" class="ltx_Math" alttext="B(x,N)=\{y_{1},...,y_{N}\}" display="inline"><semantics id="S2.SS1.p1.1.m1.5a"><mrow id="S2.SS1.p1.1.m1.5.5" xref="S2.SS1.p1.1.m1.5.5.cmml"><mrow id="S2.SS1.p1.1.m1.5.5.4" xref="S2.SS1.p1.1.m1.5.5.4.cmml"><mi id="S2.SS1.p1.1.m1.5.5.4.2" xref="S2.SS1.p1.1.m1.5.5.4.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.5.5.4.1" xref="S2.SS1.p1.1.m1.5.5.4.1.cmml">​</mo><mrow id="S2.SS1.p1.1.m1.5.5.4.3.2" xref="S2.SS1.p1.1.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.5.5.4.3.2.1" xref="S2.SS1.p1.1.m1.5.5.4.3.1.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.p1.1.m1.5.5.4.3.2.2" xref="S2.SS1.p1.1.m1.5.5.4.3.1.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" xref="S2.SS1.p1.1.m1.2.2.cmml">N</mi><mo stretchy="false" id="S2.SS1.p1.1.m1.5.5.4.3.2.3" xref="S2.SS1.p1.1.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.1.m1.5.5.3" xref="S2.SS1.p1.1.m1.5.5.3.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.5.5.2.2" xref="S2.SS1.p1.1.m1.5.5.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.5.5.2.2.3" xref="S2.SS1.p1.1.m1.5.5.2.3.cmml">{</mo><msub id="S2.SS1.p1.1.m1.4.4.1.1.1" xref="S2.SS1.p1.1.m1.4.4.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.4.4.1.1.1.2" xref="S2.SS1.p1.1.m1.4.4.1.1.1.2.cmml">y</mi><mn id="S2.SS1.p1.1.m1.4.4.1.1.1.3" xref="S2.SS1.p1.1.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.5.5.2.2.4" xref="S2.SS1.p1.1.m1.5.5.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.1.m1.3.3" xref="S2.SS1.p1.1.m1.3.3.cmml">…</mi><mo id="S2.SS1.p1.1.m1.5.5.2.2.5" xref="S2.SS1.p1.1.m1.5.5.2.3.cmml">,</mo><msub id="S2.SS1.p1.1.m1.5.5.2.2.2" xref="S2.SS1.p1.1.m1.5.5.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.5.5.2.2.2.2" xref="S2.SS1.p1.1.m1.5.5.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.1.m1.5.5.2.2.2.3" xref="S2.SS1.p1.1.m1.5.5.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.SS1.p1.1.m1.5.5.2.2.6" xref="S2.SS1.p1.1.m1.5.5.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.5b"><apply id="S2.SS1.p1.1.m1.5.5.cmml" xref="S2.SS1.p1.1.m1.5.5"><eq id="S2.SS1.p1.1.m1.5.5.3.cmml" xref="S2.SS1.p1.1.m1.5.5.3"></eq><apply id="S2.SS1.p1.1.m1.5.5.4.cmml" xref="S2.SS1.p1.1.m1.5.5.4"><times id="S2.SS1.p1.1.m1.5.5.4.1.cmml" xref="S2.SS1.p1.1.m1.5.5.4.1"></times><ci id="S2.SS1.p1.1.m1.5.5.4.2.cmml" xref="S2.SS1.p1.1.m1.5.5.4.2">𝐵</ci><interval closure="open" id="S2.SS1.p1.1.m1.5.5.4.3.1.cmml" xref="S2.SS1.p1.1.m1.5.5.4.3.2"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑥</ci><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">𝑁</ci></interval></apply><set id="S2.SS1.p1.1.m1.5.5.2.3.cmml" xref="S2.SS1.p1.1.m1.5.5.2.2"><apply id="S2.SS1.p1.1.m1.4.4.1.1.1.cmml" xref="S2.SS1.p1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.4.4.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS1.p1.1.m1.4.4.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.4.4.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.1.m1.3.3.cmml" xref="S2.SS1.p1.1.m1.3.3">…</ci><apply id="S2.SS1.p1.1.m1.5.5.2.2.2.cmml" xref="S2.SS1.p1.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.5.5.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.5.5.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.5.5.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.1.m1.5.5.2.2.2.3.cmml" xref="S2.SS1.p1.1.m1.5.5.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.5c">B(x,N)=\{y_{1},...,y_{N}\}</annotation></semantics></math> is the set of N-best hypotheses for the input query <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">x</annotation></semantics></math>, <math id="S2.SS1.p1.3.m3.2" class="ltx_Math" alttext="W(y_{i},y^{*})" display="inline"><semantics id="S2.SS1.p1.3.m3.2a"><mrow id="S2.SS1.p1.3.m3.2.2" xref="S2.SS1.p1.3.m3.2.2.cmml"><mi id="S2.SS1.p1.3.m3.2.2.4" xref="S2.SS1.p1.3.m3.2.2.4.cmml">W</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.2.2.3" xref="S2.SS1.p1.3.m3.2.2.3.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.2.2.2.2.3" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">(</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.3.m3.2.2.2.2.4" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><msup id="S2.SS1.p1.3.m3.2.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.2.2.cmml">y</mi><mo id="S2.SS1.p1.3.m3.2.2.2.2.2.3" xref="S2.SS1.p1.3.m3.2.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.SS1.p1.3.m3.2.2.2.2.5" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.2b"><apply id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2"><times id="S2.SS1.p1.3.m3.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.3"></times><ci id="S2.SS1.p1.3.m3.2.2.4.cmml" xref="S2.SS1.p1.3.m3.2.2.4">𝑊</ci><interval closure="open" id="S2.SS1.p1.3.m3.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2"><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2.2">𝑦</ci><times id="S2.SS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2.3"></times></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.2c">W(y_{i},y^{*})</annotation></semantics></math> is the number of word errors in a hypothesis <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑦</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">y_{i}</annotation></semantics></math> relative to the ground-truth sequence <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="y^{*}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msup id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">y</mi><mo id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝑦</ci><times id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">y^{*}</annotation></semantics></math>, <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="p(y_{i}|x)" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.6.m6.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.6.m6.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.6.m6.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.6.m6.1.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.2.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.2.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p1.6.m6.1.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.SS1.p1.6.m6.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><times id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2"></times><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑝</ci><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">p(y_{i}|x)</annotation></semantics></math> is the normalized probability for hypothesis <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝑦</ci><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">y_{i}</annotation></semantics></math> given input query <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">x</annotation></semantics></math> such that <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\sum_{y_{i}}p(y_{i}|x)=1" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mrow id="S2.SS1.p1.9.m9.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.cmml"><msub id="S2.SS1.p1.9.m9.1.1.1.2" xref="S2.SS1.p1.9.m9.1.1.1.2.cmml"><mo id="S2.SS1.p1.9.m9.1.1.1.2.2" xref="S2.SS1.p1.9.m9.1.1.1.2.2.cmml">∑</mo><msub id="S2.SS1.p1.9.m9.1.1.1.2.3" xref="S2.SS1.p1.9.m9.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.9.m9.1.1.1.2.3.2" xref="S2.SS1.p1.9.m9.1.1.1.2.3.2.cmml">y</mi><mi id="S2.SS1.p1.9.m9.1.1.1.2.3.3" xref="S2.SS1.p1.9.m9.1.1.1.2.3.3.cmml">i</mi></msub></msub><mrow id="S2.SS1.p1.9.m9.1.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.1.1.3" xref="S2.SS1.p1.9.m9.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.9.m9.1.1.1.1.2" xref="S2.SS1.p1.9.m9.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.9.m9.1.1.1.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.9.m9.1.1.1.1.1.1.2" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.SS1.p1.9.m9.1.1.1.1.1.1.3" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">=</mo><mn id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><eq id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2"></eq><apply id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1"><apply id="S2.SS1.p1.9.m9.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2">subscript</csymbol><sum id="S2.SS1.p1.9.m9.1.1.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2.2"></sum><apply id="S2.SS1.p1.9.m9.1.1.1.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.1.2.3.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2.3.2">𝑦</ci><ci id="S2.SS1.p1.9.m9.1.1.1.2.3.3.cmml" xref="S2.SS1.p1.9.m9.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p1.9.m9.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1"><times id="S2.SS1.p1.9.m9.1.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.2"></times><ci id="S2.SS1.p1.9.m9.1.1.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.3">𝑝</ci><apply id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><cn type="integer" id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\sum_{y_{i}}p(y_{i}|x)=1</annotation></semantics></math>, <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="E_{N}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">E</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝐸</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">E_{N}</annotation></semantics></math> is the averaged word errors over the N-best hypotheses.
This MWER loss is added to the Transformer per-token cross-entropy loss <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="L_{ce}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msub id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">L</mi><mrow id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml"><mi id="S2.SS1.p1.11.m11.1.1.3.2" xref="S2.SS1.p1.11.m11.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.11.m11.1.1.3.1" xref="S2.SS1.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.SS1.p1.11.m11.1.1.3.3" xref="S2.SS1.p1.11.m11.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝐿</ci><apply id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3"><times id="S2.SS1.p1.11.m11.1.1.3.1.cmml" xref="S2.SS1.p1.11.m11.1.1.3.1"></times><ci id="S2.SS1.p1.11.m11.1.1.3.2.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2">𝑐</ci><ci id="S2.SS1.p1.11.m11.1.1.3.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">L_{ce}</annotation></semantics></math> (see equation 3 in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>) with an interpolation hyper-parameter <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">\alpha</annotation></semantics></math> as the combined loss: <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="L=L_{MWER}+\alpha L_{ce}" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><mrow id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml"><mi id="S2.SS1.p1.13.m13.1.1.2" xref="S2.SS1.p1.13.m13.1.1.2.cmml">L</mi><mo id="S2.SS1.p1.13.m13.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.13.m13.1.1.3" xref="S2.SS1.p1.13.m13.1.1.3.cmml"><msub id="S2.SS1.p1.13.m13.1.1.3.2" xref="S2.SS1.p1.13.m13.1.1.3.2.cmml"><mi id="S2.SS1.p1.13.m13.1.1.3.2.2" xref="S2.SS1.p1.13.m13.1.1.3.2.2.cmml">L</mi><mrow id="S2.SS1.p1.13.m13.1.1.3.2.3" xref="S2.SS1.p1.13.m13.1.1.3.2.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.3.2.3.2" xref="S2.SS1.p1.13.m13.1.1.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.1.1.3.2.3.1" xref="S2.SS1.p1.13.m13.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS1.p1.13.m13.1.1.3.2.3.3" xref="S2.SS1.p1.13.m13.1.1.3.2.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.1.1.3.2.3.1a" xref="S2.SS1.p1.13.m13.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS1.p1.13.m13.1.1.3.2.3.4" xref="S2.SS1.p1.13.m13.1.1.3.2.3.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.1.1.3.2.3.1b" xref="S2.SS1.p1.13.m13.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS1.p1.13.m13.1.1.3.2.3.5" xref="S2.SS1.p1.13.m13.1.1.3.2.3.5.cmml">R</mi></mrow></msub><mo id="S2.SS1.p1.13.m13.1.1.3.1" xref="S2.SS1.p1.13.m13.1.1.3.1.cmml">+</mo><mrow id="S2.SS1.p1.13.m13.1.1.3.3" xref="S2.SS1.p1.13.m13.1.1.3.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.3.3.2" xref="S2.SS1.p1.13.m13.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.1.1.3.3.1" xref="S2.SS1.p1.13.m13.1.1.3.3.1.cmml">​</mo><msub id="S2.SS1.p1.13.m13.1.1.3.3.3" xref="S2.SS1.p1.13.m13.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.3.3.3.2" xref="S2.SS1.p1.13.m13.1.1.3.3.3.2.cmml">L</mi><mrow id="S2.SS1.p1.13.m13.1.1.3.3.3.3" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.3.3.3.3.2" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.1.1.3.3.3.3.1" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p1.13.m13.1.1.3.3.3.3.3" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><apply id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1"><eq id="S2.SS1.p1.13.m13.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1"></eq><ci id="S2.SS1.p1.13.m13.1.1.2.cmml" xref="S2.SS1.p1.13.m13.1.1.2">𝐿</ci><apply id="S2.SS1.p1.13.m13.1.1.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3"><plus id="S2.SS1.p1.13.m13.1.1.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.1"></plus><apply id="S2.SS1.p1.13.m13.1.1.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.3.2.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.13.m13.1.1.3.2.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.2">𝐿</ci><apply id="S2.SS1.p1.13.m13.1.1.3.2.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3"><times id="S2.SS1.p1.13.m13.1.1.3.2.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3.1"></times><ci id="S2.SS1.p1.13.m13.1.1.3.2.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3.2">𝑀</ci><ci id="S2.SS1.p1.13.m13.1.1.3.2.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3.3">𝑊</ci><ci id="S2.SS1.p1.13.m13.1.1.3.2.3.4.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3.4">𝐸</ci><ci id="S2.SS1.p1.13.m13.1.1.3.2.3.5.cmml" xref="S2.SS1.p1.13.m13.1.1.3.2.3.5">𝑅</ci></apply></apply><apply id="S2.SS1.p1.13.m13.1.1.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3"><times id="S2.SS1.p1.13.m13.1.1.3.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.1"></times><ci id="S2.SS1.p1.13.m13.1.1.3.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.2">𝛼</ci><apply id="S2.SS1.p1.13.m13.1.1.3.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.13.m13.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3.2">𝐿</ci><apply id="S2.SS1.p1.13.m13.1.1.3.3.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3"><times id="S2.SS1.p1.13.m13.1.1.3.3.3.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.1"></times><ci id="S2.SS1.p1.13.m13.1.1.3.3.3.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.2">𝑐</ci><ci id="S2.SS1.p1.13.m13.1.1.3.3.3.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3.3.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">L=L_{MWER}+\alpha L_{ce}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">At inference time, the normalized probability for each N-best hypothesis is generated in teacher-forcing mode <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, i.e., the Transformer's decoder is used to process each hypothesis (without beam-search) to generate its sequence loss. This loss can be converted into a probability using the <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="sigmoid" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1a" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.4" xref="S2.SS1.p2.1.m1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1b" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.5" xref="S2.SS1.p2.1.m1.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1c" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.6" xref="S2.SS1.p2.1.m1.1.1.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1d" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.7" xref="S2.SS1.p2.1.m1.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.1e" xref="S2.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.1.m1.1.1.8" xref="S2.SS1.p2.1.m1.1.1.8.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><times id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1"></times><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝑠</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝑖</ci><ci id="S2.SS1.p2.1.m1.1.1.4.cmml" xref="S2.SS1.p2.1.m1.1.1.4">𝑔</ci><ci id="S2.SS1.p2.1.m1.1.1.5.cmml" xref="S2.SS1.p2.1.m1.1.1.5">𝑚</ci><ci id="S2.SS1.p2.1.m1.1.1.6.cmml" xref="S2.SS1.p2.1.m1.1.1.6">𝑜</ci><ci id="S2.SS1.p2.1.m1.1.1.7.cmml" xref="S2.SS1.p2.1.m1.1.1.7">𝑖</ci><ci id="S2.SS1.p2.1.m1.1.1.8.cmml" xref="S2.SS1.p2.1.m1.1.1.8">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">sigmoid</annotation></semantics></math> function, and then re-normalized over the probability sum of the N-best hypotheses.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Transformer Rescore Attention (TRA) Model</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">We propose a <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">Transformer Rescore Attention</span> (TRA) model by enhancing the TR baseline model with a <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">Rescore-Attention Layer</span>, see Figure <a href="#S2.F1" title="Figure 1 ‣ 2.2 Transformer Rescore Attention (TRA) Model ‣ 2 Models ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2406.08207/assets/resources/TRA_model.jpeg" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="309" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Transformer Rescore Attention (TRA) model. During training: the <span id="S2.F1.6.1" class="ltx_text ltx_font_italic">Target</span>, N-best and <span id="S2.F1.7.2" class="ltx_text ltx_font_italic">query similarity scores</span> are fed to TRA, the <span id="S2.F1.8.3" class="ltx_text ltx_font_italic">Target</span> sequence is shifted right as input for the decoder stack to compute per-token cross-entropy loss, the <span id="S2.F1.9.4" class="ltx_text ltx_font_italic">query similarity scores</span> are used as input against the N-best predicted scores to compute <span id="S2.F1.10.5" class="ltx_text ltx_font_italic">MQSD</span> loss. At inference time: the predicted ``Target'' is used to compute the N-best predicted scores for rescoring, the predicted output text can also be used to override the 1-best if its sequence loss exceeds a threshold.</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.16" class="ltx_p">The input of the model is a list of N-best hypotheses <math id="S2.SS2.p2.1.m1.3" class="ltx_Math" alttext="\{y_{1},...,y_{N}\}" display="inline"><semantics id="S2.SS2.p2.1.m1.3a"><mrow id="S2.SS2.p2.1.m1.3.3.2" xref="S2.SS2.p2.1.m1.3.3.3.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.2.3" xref="S2.SS2.p2.1.m1.3.3.3.cmml">{</mo><msub id="S2.SS2.p2.1.m1.2.2.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.2.cmml">y</mi><mn id="S2.SS2.p2.1.m1.2.2.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.1.m1.3.3.2.4" xref="S2.SS2.p2.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p2.1.m1.3.3.2.5" xref="S2.SS2.p2.1.m1.3.3.3.cmml">,</mo><msub id="S2.SS2.p2.1.m1.3.3.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.cmml"><mi id="S2.SS2.p2.1.m1.3.3.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.cmml">y</mi><mi id="S2.SS2.p2.1.m1.3.3.2.2.3" xref="S2.SS2.p2.1.m1.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.2.6" xref="S2.SS2.p2.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.3b"><set id="S2.SS2.p2.1.m1.3.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3.2"><apply id="S2.SS2.p2.1.m1.2.2.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.2">𝑦</ci><cn type="integer" id="S2.SS2.p2.1.m1.2.2.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">…</ci><apply id="S2.SS2.p2.1.m1.3.3.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.2.2.1.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2">𝑦</ci><ci id="S2.SS2.p2.1.m1.3.3.2.2.3.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.3c">\{y_{1},...,y_{N}\}</annotation></semantics></math> from the ASR recognizer. Each hypothesis <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">y</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑦</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">y_{i}</annotation></semantics></math> is tokenized into a sequence of subword tokens. The Transformer encoder and decoder stacks are similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. The <span id="S2.SS2.p2.16.1" class="ltx_text ltx_font_italic">embedding_layer</span> maps each hypothesis <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">y</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝑦</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">y_{i}</annotation></semantics></math> to a high dimensional hidden embedding space <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="h_{i}\in R^{l\times d}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><msub id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2.2" xref="S2.SS2.p2.4.m4.1.1.2.2.cmml">h</mi><mi id="S2.SS2.p2.4.m4.1.1.2.3" xref="S2.SS2.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.cmml">R</mi><mrow id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.3.2" xref="S2.SS2.p2.4.m4.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m4.1.1.3.3.1" xref="S2.SS2.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.3.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><in id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></in><apply id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2.2">ℎ</ci><ci id="S2.SS2.p2.4.m4.1.1.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2">𝑅</ci><apply id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3"><times id="S2.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.1"></times><ci id="S2.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.2">𝑙</ci><ci id="S2.SS2.p2.4.m4.1.1.3.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">h_{i}\in R^{l\times d}</annotation></semantics></math>, where <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">l</annotation></semantics></math> is the input sequence length and <math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><mi id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">d</annotation></semantics></math> is the dimension of the hidden space.
Each hypothesis from the same input query is padded to the same sequence length, and input sequences of the same N-best list size are grouped into the same batch during model training.
The <span id="S2.SS2.p2.16.2" class="ltx_text ltx_font_italic">Context Aggregator</span> concatenates the N-best hypotheses along the sequence-length dimension, denoted as <math id="S2.SS2.p2.7.m7.3" class="ltx_Math" alttext="\left[h_{1};...;h_{N}\right]" display="inline"><semantics id="S2.SS2.p2.7.m7.3a"><mrow id="S2.SS2.p2.7.m7.3.3.2" xref="S2.SS2.p2.7.m7.3.3.3.cmml"><mo id="S2.SS2.p2.7.m7.3.3.2.3" xref="S2.SS2.p2.7.m7.3.3.3.cmml">[</mo><msub id="S2.SS2.p2.7.m7.2.2.1.1" xref="S2.SS2.p2.7.m7.2.2.1.1.cmml"><mi id="S2.SS2.p2.7.m7.2.2.1.1.2" xref="S2.SS2.p2.7.m7.2.2.1.1.2.cmml">h</mi><mn id="S2.SS2.p2.7.m7.2.2.1.1.3" xref="S2.SS2.p2.7.m7.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.7.m7.3.3.2.4" xref="S2.SS2.p2.7.m7.3.3.3.cmml">;</mo><mi mathvariant="normal" id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">…</mi><mo id="S2.SS2.p2.7.m7.3.3.2.5" xref="S2.SS2.p2.7.m7.3.3.3.cmml">;</mo><msub id="S2.SS2.p2.7.m7.3.3.2.2" xref="S2.SS2.p2.7.m7.3.3.2.2.cmml"><mi id="S2.SS2.p2.7.m7.3.3.2.2.2" xref="S2.SS2.p2.7.m7.3.3.2.2.2.cmml">h</mi><mi id="S2.SS2.p2.7.m7.3.3.2.2.3" xref="S2.SS2.p2.7.m7.3.3.2.2.3.cmml">N</mi></msub><mo id="S2.SS2.p2.7.m7.3.3.2.6" xref="S2.SS2.p2.7.m7.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.3b"><list id="S2.SS2.p2.7.m7.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.2"><apply id="S2.SS2.p2.7.m7.2.2.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.1.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.2.2.1.1.2.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1.2">ℎ</ci><cn type="integer" id="S2.SS2.p2.7.m7.2.2.1.1.3.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">…</ci><apply id="S2.SS2.p2.7.m7.3.3.2.2.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.2.2.1.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.7.m7.3.3.2.2.2.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.2">ℎ</ci><ci id="S2.SS2.p2.7.m7.3.3.2.2.3.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.3c">\left[h_{1};...;h_{N}\right]</annotation></semantics></math> with a concatenated sequence length <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="l_{N}=N*l" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><mrow id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><msub id="S2.SS2.p2.8.m8.1.1.2" xref="S2.SS2.p2.8.m8.1.1.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.2.2" xref="S2.SS2.p2.8.m8.1.1.2.2.cmml">l</mi><mi id="S2.SS2.p2.8.m8.1.1.2.3" xref="S2.SS2.p2.8.m8.1.1.2.3.cmml">N</mi></msub><mo id="S2.SS2.p2.8.m8.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.cmml">=</mo><mrow id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml"><mi id="S2.SS2.p2.8.m8.1.1.3.2" xref="S2.SS2.p2.8.m8.1.1.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.8.m8.1.1.3.1" xref="S2.SS2.p2.8.m8.1.1.3.1.cmml">∗</mo><mi id="S2.SS2.p2.8.m8.1.1.3.3" xref="S2.SS2.p2.8.m8.1.1.3.3.cmml">l</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><eq id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1"></eq><apply id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2.2">𝑙</ci><ci id="S2.SS2.p2.8.m8.1.1.2.3.cmml" xref="S2.SS2.p2.8.m8.1.1.2.3">𝑁</ci></apply><apply id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3"><times id="S2.SS2.p2.8.m8.1.1.3.1.cmml" xref="S2.SS2.p2.8.m8.1.1.3.1"></times><ci id="S2.SS2.p2.8.m8.1.1.3.2.cmml" xref="S2.SS2.p2.8.m8.1.1.3.2">𝑁</ci><ci id="S2.SS2.p2.8.m8.1.1.3.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">l_{N}=N*l</annotation></semantics></math>.
The concatenated N-best hidden vector <math id="S2.SS2.p2.9.m9.3" class="ltx_Math" alttext="H=\left[h_{1};...;h_{N}\right]" display="inline"><semantics id="S2.SS2.p2.9.m9.3a"><mrow id="S2.SS2.p2.9.m9.3.3" xref="S2.SS2.p2.9.m9.3.3.cmml"><mi id="S2.SS2.p2.9.m9.3.3.4" xref="S2.SS2.p2.9.m9.3.3.4.cmml">H</mi><mo id="S2.SS2.p2.9.m9.3.3.3" xref="S2.SS2.p2.9.m9.3.3.3.cmml">=</mo><mrow id="S2.SS2.p2.9.m9.3.3.2.2" xref="S2.SS2.p2.9.m9.3.3.2.3.cmml"><mo id="S2.SS2.p2.9.m9.3.3.2.2.3" xref="S2.SS2.p2.9.m9.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p2.9.m9.2.2.1.1.1" xref="S2.SS2.p2.9.m9.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.9.m9.2.2.1.1.1.2" xref="S2.SS2.p2.9.m9.2.2.1.1.1.2.cmml">h</mi><mn id="S2.SS2.p2.9.m9.2.2.1.1.1.3" xref="S2.SS2.p2.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.9.m9.3.3.2.2.4" xref="S2.SS2.p2.9.m9.3.3.2.3.cmml">;</mo><mi mathvariant="normal" id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml">…</mi><mo id="S2.SS2.p2.9.m9.3.3.2.2.5" xref="S2.SS2.p2.9.m9.3.3.2.3.cmml">;</mo><msub id="S2.SS2.p2.9.m9.3.3.2.2.2" xref="S2.SS2.p2.9.m9.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.9.m9.3.3.2.2.2.2" xref="S2.SS2.p2.9.m9.3.3.2.2.2.2.cmml">h</mi><mi id="S2.SS2.p2.9.m9.3.3.2.2.2.3" xref="S2.SS2.p2.9.m9.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S2.SS2.p2.9.m9.3.3.2.2.6" xref="S2.SS2.p2.9.m9.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.3b"><apply id="S2.SS2.p2.9.m9.3.3.cmml" xref="S2.SS2.p2.9.m9.3.3"><eq id="S2.SS2.p2.9.m9.3.3.3.cmml" xref="S2.SS2.p2.9.m9.3.3.3"></eq><ci id="S2.SS2.p2.9.m9.3.3.4.cmml" xref="S2.SS2.p2.9.m9.3.3.4">𝐻</ci><list id="S2.SS2.p2.9.m9.3.3.2.3.cmml" xref="S2.SS2.p2.9.m9.3.3.2.2"><apply id="S2.SS2.p2.9.m9.2.2.1.1.1.cmml" xref="S2.SS2.p2.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m9.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.9.m9.2.2.1.1.1.2">ℎ</ci><cn type="integer" id="S2.SS2.p2.9.m9.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">…</ci><apply id="S2.SS2.p2.9.m9.3.3.2.2.2.cmml" xref="S2.SS2.p2.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.9.m9.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.9.m9.3.3.2.2.2.2">ℎ</ci><ci id="S2.SS2.p2.9.m9.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.9.m9.3.3.2.2.2.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.3c">H=\left[h_{1};...;h_{N}\right]</annotation></semantics></math> is fed to the Transformer’s encoder stack to generate the N-best encoded vector <math id="S2.SS2.p2.10.m10.3" class="ltx_Math" alttext="H^{w}=\left[h^{w}_{1};...;h^{w}_{N}\right]\in R^{l_{N}\times d}" display="inline"><semantics id="S2.SS2.p2.10.m10.3a"><mrow id="S2.SS2.p2.10.m10.3.3" xref="S2.SS2.p2.10.m10.3.3.cmml"><msup id="S2.SS2.p2.10.m10.3.3.4" xref="S2.SS2.p2.10.m10.3.3.4.cmml"><mi id="S2.SS2.p2.10.m10.3.3.4.2" xref="S2.SS2.p2.10.m10.3.3.4.2.cmml">H</mi><mi id="S2.SS2.p2.10.m10.3.3.4.3" xref="S2.SS2.p2.10.m10.3.3.4.3.cmml">w</mi></msup><mo id="S2.SS2.p2.10.m10.3.3.5" xref="S2.SS2.p2.10.m10.3.3.5.cmml">=</mo><mrow id="S2.SS2.p2.10.m10.3.3.2.2" xref="S2.SS2.p2.10.m10.3.3.2.3.cmml"><mo id="S2.SS2.p2.10.m10.3.3.2.2.3" xref="S2.SS2.p2.10.m10.3.3.2.3.cmml">[</mo><msubsup id="S2.SS2.p2.10.m10.2.2.1.1.1" xref="S2.SS2.p2.10.m10.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.10.m10.2.2.1.1.1.2.2" xref="S2.SS2.p2.10.m10.2.2.1.1.1.2.2.cmml">h</mi><mn id="S2.SS2.p2.10.m10.2.2.1.1.1.3" xref="S2.SS2.p2.10.m10.2.2.1.1.1.3.cmml">1</mn><mi id="S2.SS2.p2.10.m10.2.2.1.1.1.2.3" xref="S2.SS2.p2.10.m10.2.2.1.1.1.2.3.cmml">w</mi></msubsup><mo id="S2.SS2.p2.10.m10.3.3.2.2.4" xref="S2.SS2.p2.10.m10.3.3.2.3.cmml">;</mo><mi mathvariant="normal" id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">…</mi><mo id="S2.SS2.p2.10.m10.3.3.2.2.5" xref="S2.SS2.p2.10.m10.3.3.2.3.cmml">;</mo><msubsup id="S2.SS2.p2.10.m10.3.3.2.2.2" xref="S2.SS2.p2.10.m10.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.10.m10.3.3.2.2.2.2.2" xref="S2.SS2.p2.10.m10.3.3.2.2.2.2.2.cmml">h</mi><mi id="S2.SS2.p2.10.m10.3.3.2.2.2.3" xref="S2.SS2.p2.10.m10.3.3.2.2.2.3.cmml">N</mi><mi id="S2.SS2.p2.10.m10.3.3.2.2.2.2.3" xref="S2.SS2.p2.10.m10.3.3.2.2.2.2.3.cmml">w</mi></msubsup><mo id="S2.SS2.p2.10.m10.3.3.2.2.6" xref="S2.SS2.p2.10.m10.3.3.2.3.cmml">]</mo></mrow><mo id="S2.SS2.p2.10.m10.3.3.6" xref="S2.SS2.p2.10.m10.3.3.6.cmml">∈</mo><msup id="S2.SS2.p2.10.m10.3.3.7" xref="S2.SS2.p2.10.m10.3.3.7.cmml"><mi id="S2.SS2.p2.10.m10.3.3.7.2" xref="S2.SS2.p2.10.m10.3.3.7.2.cmml">R</mi><mrow id="S2.SS2.p2.10.m10.3.3.7.3" xref="S2.SS2.p2.10.m10.3.3.7.3.cmml"><msub id="S2.SS2.p2.10.m10.3.3.7.3.2" xref="S2.SS2.p2.10.m10.3.3.7.3.2.cmml"><mi id="S2.SS2.p2.10.m10.3.3.7.3.2.2" xref="S2.SS2.p2.10.m10.3.3.7.3.2.2.cmml">l</mi><mi id="S2.SS2.p2.10.m10.3.3.7.3.2.3" xref="S2.SS2.p2.10.m10.3.3.7.3.2.3.cmml">N</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.10.m10.3.3.7.3.1" xref="S2.SS2.p2.10.m10.3.3.7.3.1.cmml">×</mo><mi id="S2.SS2.p2.10.m10.3.3.7.3.3" xref="S2.SS2.p2.10.m10.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.3b"><apply id="S2.SS2.p2.10.m10.3.3.cmml" xref="S2.SS2.p2.10.m10.3.3"><and id="S2.SS2.p2.10.m10.3.3a.cmml" xref="S2.SS2.p2.10.m10.3.3"></and><apply id="S2.SS2.p2.10.m10.3.3b.cmml" xref="S2.SS2.p2.10.m10.3.3"><eq id="S2.SS2.p2.10.m10.3.3.5.cmml" xref="S2.SS2.p2.10.m10.3.3.5"></eq><apply id="S2.SS2.p2.10.m10.3.3.4.cmml" xref="S2.SS2.p2.10.m10.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.4.1.cmml" xref="S2.SS2.p2.10.m10.3.3.4">superscript</csymbol><ci id="S2.SS2.p2.10.m10.3.3.4.2.cmml" xref="S2.SS2.p2.10.m10.3.3.4.2">𝐻</ci><ci id="S2.SS2.p2.10.m10.3.3.4.3.cmml" xref="S2.SS2.p2.10.m10.3.3.4.3">𝑤</ci></apply><list id="S2.SS2.p2.10.m10.3.3.2.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2"><apply id="S2.SS2.p2.10.m10.2.2.1.1.1.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.p2.10.m10.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.10.m10.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1.2.2">ℎ</ci><ci id="S2.SS2.p2.10.m10.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1.2.3">𝑤</ci></apply><cn type="integer" id="S2.SS2.p2.10.m10.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">…</ci><apply id="S2.SS2.p2.10.m10.3.3.2.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2">subscript</csymbol><apply id="S2.SS2.p2.10.m10.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.10.m10.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2.2.2">ℎ</ci><ci id="S2.SS2.p2.10.m10.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2.2.3">𝑤</ci></apply><ci id="S2.SS2.p2.10.m10.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S2.SS2.p2.10.m10.3.3c.cmml" xref="S2.SS2.p2.10.m10.3.3"><in id="S2.SS2.p2.10.m10.3.3.6.cmml" xref="S2.SS2.p2.10.m10.3.3.6"></in><share href="#S2.SS2.p2.10.m10.3.3.2.cmml" id="S2.SS2.p2.10.m10.3.3d.cmml" xref="S2.SS2.p2.10.m10.3.3"></share><apply id="S2.SS2.p2.10.m10.3.3.7.cmml" xref="S2.SS2.p2.10.m10.3.3.7"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.7.1.cmml" xref="S2.SS2.p2.10.m10.3.3.7">superscript</csymbol><ci id="S2.SS2.p2.10.m10.3.3.7.2.cmml" xref="S2.SS2.p2.10.m10.3.3.7.2">𝑅</ci><apply id="S2.SS2.p2.10.m10.3.3.7.3.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3"><times id="S2.SS2.p2.10.m10.3.3.7.3.1.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.1"></times><apply id="S2.SS2.p2.10.m10.3.3.7.3.2.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.7.3.2.1.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.2">subscript</csymbol><ci id="S2.SS2.p2.10.m10.3.3.7.3.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.2.2">𝑙</ci><ci id="S2.SS2.p2.10.m10.3.3.7.3.2.3.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.2.3">𝑁</ci></apply><ci id="S2.SS2.p2.10.m10.3.3.7.3.3.cmml" xref="S2.SS2.p2.10.m10.3.3.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.3c">H^{w}=\left[h^{w}_{1};...;h^{w}_{N}\right]\in R^{l_{N}\times d}</annotation></semantics></math>, which in turn is fed to the Transformer’s decoder stack to generate the cross-attention <math id="S2.SS2.p2.11.m11.1" class="ltx_Math" alttext="A^{\hat{w}}" display="inline"><semantics id="S2.SS2.p2.11.m11.1a"><msup id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml">A</mi><mover accent="true" id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3.cmml"><mi id="S2.SS2.p2.11.m11.1.1.3.2" xref="S2.SS2.p2.11.m11.1.1.3.2.cmml">w</mi><mo id="S2.SS2.p2.11.m11.1.1.3.1" xref="S2.SS2.p2.11.m11.1.1.3.1.cmml">^</mo></mover></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1">superscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2">𝐴</ci><apply id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3"><ci id="S2.SS2.p2.11.m11.1.1.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3.1">^</ci><ci id="S2.SS2.p2.11.m11.1.1.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">A^{\hat{w}}</annotation></semantics></math> between the decoder’s self-attention output <math id="S2.SS2.p2.12.m12.1" class="ltx_Math" alttext="H^{\hat{w}}" display="inline"><semantics id="S2.SS2.p2.12.m12.1a"><msup id="S2.SS2.p2.12.m12.1.1" xref="S2.SS2.p2.12.m12.1.1.cmml"><mi id="S2.SS2.p2.12.m12.1.1.2" xref="S2.SS2.p2.12.m12.1.1.2.cmml">H</mi><mover accent="true" id="S2.SS2.p2.12.m12.1.1.3" xref="S2.SS2.p2.12.m12.1.1.3.cmml"><mi id="S2.SS2.p2.12.m12.1.1.3.2" xref="S2.SS2.p2.12.m12.1.1.3.2.cmml">w</mi><mo id="S2.SS2.p2.12.m12.1.1.3.1" xref="S2.SS2.p2.12.m12.1.1.3.1.cmml">^</mo></mover></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m12.1b"><apply id="S2.SS2.p2.12.m12.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.12.m12.1.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1">superscript</csymbol><ci id="S2.SS2.p2.12.m12.1.1.2.cmml" xref="S2.SS2.p2.12.m12.1.1.2">𝐻</ci><apply id="S2.SS2.p2.12.m12.1.1.3.cmml" xref="S2.SS2.p2.12.m12.1.1.3"><ci id="S2.SS2.p2.12.m12.1.1.3.1.cmml" xref="S2.SS2.p2.12.m12.1.1.3.1">^</ci><ci id="S2.SS2.p2.12.m12.1.1.3.2.cmml" xref="S2.SS2.p2.12.m12.1.1.3.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.1c">H^{\hat{w}}</annotation></semantics></math> and the N-best encoder output <math id="S2.SS2.p2.13.m13.1" class="ltx_Math" alttext="H^{w}" display="inline"><semantics id="S2.SS2.p2.13.m13.1a"><msup id="S2.SS2.p2.13.m13.1.1" xref="S2.SS2.p2.13.m13.1.1.cmml"><mi id="S2.SS2.p2.13.m13.1.1.2" xref="S2.SS2.p2.13.m13.1.1.2.cmml">H</mi><mi id="S2.SS2.p2.13.m13.1.1.3" xref="S2.SS2.p2.13.m13.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m13.1b"><apply id="S2.SS2.p2.13.m13.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.13.m13.1.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1">superscript</csymbol><ci id="S2.SS2.p2.13.m13.1.1.2.cmml" xref="S2.SS2.p2.13.m13.1.1.2">𝐻</ci><ci id="S2.SS2.p2.13.m13.1.1.3.cmml" xref="S2.SS2.p2.13.m13.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m13.1c">H^{w}</annotation></semantics></math>.
Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, this cross-attentions <math id="S2.SS2.p2.14.m14.1" class="ltx_Math" alttext="A^{\hat{w}}" display="inline"><semantics id="S2.SS2.p2.14.m14.1a"><msup id="S2.SS2.p2.14.m14.1.1" xref="S2.SS2.p2.14.m14.1.1.cmml"><mi id="S2.SS2.p2.14.m14.1.1.2" xref="S2.SS2.p2.14.m14.1.1.2.cmml">A</mi><mover accent="true" id="S2.SS2.p2.14.m14.1.1.3" xref="S2.SS2.p2.14.m14.1.1.3.cmml"><mi id="S2.SS2.p2.14.m14.1.1.3.2" xref="S2.SS2.p2.14.m14.1.1.3.2.cmml">w</mi><mo id="S2.SS2.p2.14.m14.1.1.3.1" xref="S2.SS2.p2.14.m14.1.1.3.1.cmml">^</mo></mover></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m14.1b"><apply id="S2.SS2.p2.14.m14.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1">superscript</csymbol><ci id="S2.SS2.p2.14.m14.1.1.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2">𝐴</ci><apply id="S2.SS2.p2.14.m14.1.1.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3"><ci id="S2.SS2.p2.14.m14.1.1.3.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3.1">^</ci><ci id="S2.SS2.p2.14.m14.1.1.3.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m14.1c">A^{\hat{w}}</annotation></semantics></math> is normalized and fed to a <span id="S2.SS2.p2.16.3" class="ltx_text ltx_font_italic">Feed-Forward</span> layer followed by a <span id="S2.SS2.p2.16.4" class="ltx_text ltx_font_italic">Linear</span> layer, then, a <span id="S2.SS2.p2.16.5" class="ltx_text ltx_font_italic">Softmax</span> layer to predict the next target token over a set of vocabulary, until it reaches a special end-of-sequence token <span id="S2.SS2.p2.16.6" class="ltx_text ltx_font_italic">eos</span>. We denote the predicted target sequence as <math id="S2.SS2.p2.15.m15.3" class="ltx_Math" alttext="\hat{w}=\{\hat{w_{1}},...,\hat{w_{t}}\}" display="inline"><semantics id="S2.SS2.p2.15.m15.3a"><mrow id="S2.SS2.p2.15.m15.3.4" xref="S2.SS2.p2.15.m15.3.4.cmml"><mover accent="true" id="S2.SS2.p2.15.m15.3.4.2" xref="S2.SS2.p2.15.m15.3.4.2.cmml"><mi id="S2.SS2.p2.15.m15.3.4.2.2" xref="S2.SS2.p2.15.m15.3.4.2.2.cmml">w</mi><mo id="S2.SS2.p2.15.m15.3.4.2.1" xref="S2.SS2.p2.15.m15.3.4.2.1.cmml">^</mo></mover><mo id="S2.SS2.p2.15.m15.3.4.1" xref="S2.SS2.p2.15.m15.3.4.1.cmml">=</mo><mrow id="S2.SS2.p2.15.m15.3.4.3.2" xref="S2.SS2.p2.15.m15.3.4.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.15.m15.3.4.3.2.1" xref="S2.SS2.p2.15.m15.3.4.3.1.cmml">{</mo><mover accent="true" id="S2.SS2.p2.15.m15.1.1" xref="S2.SS2.p2.15.m15.1.1.cmml"><msub id="S2.SS2.p2.15.m15.1.1.2" xref="S2.SS2.p2.15.m15.1.1.2.cmml"><mi id="S2.SS2.p2.15.m15.1.1.2.2" xref="S2.SS2.p2.15.m15.1.1.2.2.cmml">w</mi><mn id="S2.SS2.p2.15.m15.1.1.2.3" xref="S2.SS2.p2.15.m15.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS2.p2.15.m15.1.1.1" xref="S2.SS2.p2.15.m15.1.1.1.cmml">^</mo></mover><mo id="S2.SS2.p2.15.m15.3.4.3.2.2" xref="S2.SS2.p2.15.m15.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.15.m15.2.2" xref="S2.SS2.p2.15.m15.2.2.cmml">…</mi><mo id="S2.SS2.p2.15.m15.3.4.3.2.3" xref="S2.SS2.p2.15.m15.3.4.3.1.cmml">,</mo><mover accent="true" id="S2.SS2.p2.15.m15.3.3" xref="S2.SS2.p2.15.m15.3.3.cmml"><msub id="S2.SS2.p2.15.m15.3.3.2" xref="S2.SS2.p2.15.m15.3.3.2.cmml"><mi id="S2.SS2.p2.15.m15.3.3.2.2" xref="S2.SS2.p2.15.m15.3.3.2.2.cmml">w</mi><mi id="S2.SS2.p2.15.m15.3.3.2.3" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml">t</mi></msub><mo id="S2.SS2.p2.15.m15.3.3.1" xref="S2.SS2.p2.15.m15.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S2.SS2.p2.15.m15.3.4.3.2.4" xref="S2.SS2.p2.15.m15.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.15.m15.3b"><apply id="S2.SS2.p2.15.m15.3.4.cmml" xref="S2.SS2.p2.15.m15.3.4"><eq id="S2.SS2.p2.15.m15.3.4.1.cmml" xref="S2.SS2.p2.15.m15.3.4.1"></eq><apply id="S2.SS2.p2.15.m15.3.4.2.cmml" xref="S2.SS2.p2.15.m15.3.4.2"><ci id="S2.SS2.p2.15.m15.3.4.2.1.cmml" xref="S2.SS2.p2.15.m15.3.4.2.1">^</ci><ci id="S2.SS2.p2.15.m15.3.4.2.2.cmml" xref="S2.SS2.p2.15.m15.3.4.2.2">𝑤</ci></apply><set id="S2.SS2.p2.15.m15.3.4.3.1.cmml" xref="S2.SS2.p2.15.m15.3.4.3.2"><apply id="S2.SS2.p2.15.m15.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1"><ci id="S2.SS2.p2.15.m15.1.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1.1">^</ci><apply id="S2.SS2.p2.15.m15.1.1.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2">𝑤</ci><cn type="integer" id="S2.SS2.p2.15.m15.1.1.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3">1</cn></apply></apply><ci id="S2.SS2.p2.15.m15.2.2.cmml" xref="S2.SS2.p2.15.m15.2.2">…</ci><apply id="S2.SS2.p2.15.m15.3.3.cmml" xref="S2.SS2.p2.15.m15.3.3"><ci id="S2.SS2.p2.15.m15.3.3.1.cmml" xref="S2.SS2.p2.15.m15.3.3.1">^</ci><apply id="S2.SS2.p2.15.m15.3.3.2.cmml" xref="S2.SS2.p2.15.m15.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.3.3.2.1.cmml" xref="S2.SS2.p2.15.m15.3.3.2">subscript</csymbol><ci id="S2.SS2.p2.15.m15.3.3.2.2.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2">𝑤</ci><ci id="S2.SS2.p2.15.m15.3.3.2.3.cmml" xref="S2.SS2.p2.15.m15.3.3.2.3">𝑡</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.15.m15.3c">\hat{w}=\{\hat{w_{1}},...,\hat{w_{t}}\}</annotation></semantics></math>, and the target sequence length as <math id="S2.SS2.p2.16.m16.1" class="ltx_Math" alttext="|\hat{w}|" display="inline"><semantics id="S2.SS2.p2.16.m16.1a"><mrow id="S2.SS2.p2.16.m16.1.2.2" xref="S2.SS2.p2.16.m16.1.2.1.cmml"><mo stretchy="false" id="S2.SS2.p2.16.m16.1.2.2.1" xref="S2.SS2.p2.16.m16.1.2.1.1.cmml">|</mo><mover accent="true" id="S2.SS2.p2.16.m16.1.1" xref="S2.SS2.p2.16.m16.1.1.cmml"><mi id="S2.SS2.p2.16.m16.1.1.2" xref="S2.SS2.p2.16.m16.1.1.2.cmml">w</mi><mo id="S2.SS2.p2.16.m16.1.1.1" xref="S2.SS2.p2.16.m16.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S2.SS2.p2.16.m16.1.2.2.2" xref="S2.SS2.p2.16.m16.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.16.m16.1b"><apply id="S2.SS2.p2.16.m16.1.2.1.cmml" xref="S2.SS2.p2.16.m16.1.2.2"><abs id="S2.SS2.p2.16.m16.1.2.1.1.cmml" xref="S2.SS2.p2.16.m16.1.2.2.1"></abs><apply id="S2.SS2.p2.16.m16.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1"><ci id="S2.SS2.p2.16.m16.1.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1.1">^</ci><ci id="S2.SS2.p2.16.m16.1.1.2.cmml" xref="S2.SS2.p2.16.m16.1.1.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.16.m16.1c">|\hat{w}|</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Rescore Attention Layer</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.5" class="ltx_p">This layer takes two inputs: the target embedding’s output <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="H^{t}\in R^{|\hat{w}|\times d}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.2" xref="S2.SS3.p1.1.m1.1.2.cmml"><msup id="S2.SS3.p1.1.m1.1.2.2" xref="S2.SS3.p1.1.m1.1.2.2.cmml"><mi id="S2.SS3.p1.1.m1.1.2.2.2" xref="S2.SS3.p1.1.m1.1.2.2.2.cmml">H</mi><mi id="S2.SS3.p1.1.m1.1.2.2.3" xref="S2.SS3.p1.1.m1.1.2.2.3.cmml">t</mi></msup><mo id="S2.SS3.p1.1.m1.1.2.1" xref="S2.SS3.p1.1.m1.1.2.1.cmml">∈</mo><msup id="S2.SS3.p1.1.m1.1.2.3" xref="S2.SS3.p1.1.m1.1.2.3.cmml"><mi id="S2.SS3.p1.1.m1.1.2.3.2" xref="S2.SS3.p1.1.m1.1.2.3.2.cmml">R</mi><mrow id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml"><mrow id="S2.SS3.p1.1.m1.1.1.1.3.2" xref="S2.SS3.p1.1.m1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.3.2.1" xref="S2.SS3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo><mover accent="true" id="S2.SS3.p1.1.m1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.1.2.cmml">w</mi><mo id="S2.SS3.p1.1.m1.1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml">^</mo></mover><mo rspace="0.055em" stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.3.2.2" xref="S2.SS3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S2.SS3.p1.1.m1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.2.cmml">×</mo><mi id="S2.SS3.p1.1.m1.1.1.1.4" xref="S2.SS3.p1.1.m1.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.2"><in id="S2.SS3.p1.1.m1.1.2.1.cmml" xref="S2.SS3.p1.1.m1.1.2.1"></in><apply id="S2.SS3.p1.1.m1.1.2.2.cmml" xref="S2.SS3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.2.2.1.cmml" xref="S2.SS3.p1.1.m1.1.2.2">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.2.2.2.cmml" xref="S2.SS3.p1.1.m1.1.2.2.2">𝐻</ci><ci id="S2.SS3.p1.1.m1.1.2.2.3.cmml" xref="S2.SS3.p1.1.m1.1.2.2.3">𝑡</ci></apply><apply id="S2.SS3.p1.1.m1.1.2.3.cmml" xref="S2.SS3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.2.3.1.cmml" xref="S2.SS3.p1.1.m1.1.2.3">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.2.3.2.cmml" xref="S2.SS3.p1.1.m1.1.2.3.2">𝑅</ci><apply id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1"><times id="S2.SS3.p1.1.m1.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.1.2"></times><apply id="S2.SS3.p1.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.3.2"><abs id="S2.SS3.p1.1.m1.1.1.1.3.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.3.2.1"></abs><apply id="S2.SS3.p1.1.m1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1"><ci id="S2.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1">^</ci><ci id="S2.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.2">𝑤</ci></apply></apply><ci id="S2.SS3.p1.1.m1.1.1.1.4.cmml" xref="S2.SS3.p1.1.m1.1.1.1.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">H^{t}\in R^{|\hat{w}|\times d}</annotation></semantics></math> and the N-best encoded vector <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="H^{w}" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><msup id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">H</mi><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝐻</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">H^{w}</annotation></semantics></math>. We first compute the N-best rescore cross-attention <math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="A_{n}^{w}" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><msubsup id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2.2" xref="S2.SS3.p1.3.m3.1.1.2.2.cmml">A</mi><mi id="S2.SS3.p1.3.m3.1.1.2.3" xref="S2.SS3.p1.3.m3.1.1.2.3.cmml">n</mi><mi id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.2.1.cmml" xref="S2.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.1.2.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2.2">𝐴</ci><ci id="S2.SS3.p1.3.m3.1.1.2.3.cmml" xref="S2.SS3.p1.3.m3.1.1.2.3">𝑛</ci></apply><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">A_{n}^{w}</annotation></semantics></math> between <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="H^{w}" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><msup id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.2" xref="S2.SS3.p1.4.m4.1.1.2.cmml">H</mi><mi id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2">𝐻</ci><ci id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">H^{w}</annotation></semantics></math> and the target’s encoded output <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="H^{t}" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><msup id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml"><mi id="S2.SS3.p1.5.m5.1.1.2" xref="S2.SS3.p1.5.m5.1.1.2.cmml">H</mi><mi id="S2.SS3.p1.5.m5.1.1.3" xref="S2.SS3.p1.5.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2">𝐻</ci><ci id="S2.SS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">H^{t}</annotation></semantics></math> by:</p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.3" class="ltx_Math" alttext="A_{n}^{w}=\text{Softmax}\left(\frac{\left(H^{w}Q_{r}^{w}\right)\left(H^{t}K_{r}^{w}\right)^{T}}{\sqrt{d}}\right)\left(H^{t}V_{r}^{w}\right)" display="block"><semantics id="S2.Ex2.m1.3a"><mrow id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml"><msubsup id="S2.Ex2.m1.3.3.3" xref="S2.Ex2.m1.3.3.3.cmml"><mi id="S2.Ex2.m1.3.3.3.2.2" xref="S2.Ex2.m1.3.3.3.2.2.cmml">A</mi><mi id="S2.Ex2.m1.3.3.3.2.3" xref="S2.Ex2.m1.3.3.3.2.3.cmml">n</mi><mi id="S2.Ex2.m1.3.3.3.3" xref="S2.Ex2.m1.3.3.3.3.cmml">w</mi></msubsup><mo id="S2.Ex2.m1.3.3.2" xref="S2.Ex2.m1.3.3.2.cmml">=</mo><mrow id="S2.Ex2.m1.3.3.1" xref="S2.Ex2.m1.3.3.1.cmml"><mtext id="S2.Ex2.m1.3.3.1.3" xref="S2.Ex2.m1.3.3.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.1.2" xref="S2.Ex2.m1.3.3.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.1.4.2" xref="S2.Ex2.m1.2.2.cmml"><mo id="S2.Ex2.m1.3.3.1.4.2.1" xref="S2.Ex2.m1.2.2.cmml">(</mo><mfrac id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml"><mrow id="S2.Ex2.m1.2.2.2" xref="S2.Ex2.m1.2.2.2.cmml"><mrow id="S2.Ex2.m1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml"><mo id="S2.Ex2.m1.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml"><msup id="S2.Ex2.m1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.cmml">H</mi><mi id="S2.Ex2.m1.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.1.1.1.1.1.1.2.3.cmml">w</mi></msup><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S2.Ex2.m1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.2.2" xref="S2.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml">Q</mi><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.2.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.2.3.cmml">r</mi><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.cmml">w</mi></msubsup></mrow><mo id="S2.Ex2.m1.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.2.2.2.3" xref="S2.Ex2.m1.2.2.2.3.cmml">​</mo><msup id="S2.Ex2.m1.2.2.2.2" xref="S2.Ex2.m1.2.2.2.2.cmml"><mrow id="S2.Ex2.m1.2.2.2.2.1.1" xref="S2.Ex2.m1.2.2.2.2.1.1.1.cmml"><mo id="S2.Ex2.m1.2.2.2.2.1.1.2" xref="S2.Ex2.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.2.2.2.2.1.1.1" xref="S2.Ex2.m1.2.2.2.2.1.1.1.cmml"><msup id="S2.Ex2.m1.2.2.2.2.1.1.1.2" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S2.Ex2.m1.2.2.2.2.1.1.1.2.2" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2.2.cmml">H</mi><mi id="S2.Ex2.m1.2.2.2.2.1.1.1.2.3" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.2.2.2.2.1.1.1.1" xref="S2.Ex2.m1.2.2.2.2.1.1.1.1.cmml">​</mo><msubsup id="S2.Ex2.m1.2.2.2.2.1.1.1.3" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.2" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.2.cmml">K</mi><mi id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.3" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.3.cmml">r</mi><mi id="S2.Ex2.m1.2.2.2.2.1.1.1.3.3" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.3.cmml">w</mi></msubsup></mrow><mo id="S2.Ex2.m1.2.2.2.2.1.1.3" xref="S2.Ex2.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.Ex2.m1.2.2.2.2.3" xref="S2.Ex2.m1.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="S2.Ex2.m1.2.2.4" xref="S2.Ex2.m1.2.2.4.cmml"><mi id="S2.Ex2.m1.2.2.4.2" xref="S2.Ex2.m1.2.2.4.2.cmml">d</mi></msqrt></mfrac><mo id="S2.Ex2.m1.3.3.1.4.2.2" xref="S2.Ex2.m1.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.1.2a" xref="S2.Ex2.m1.3.3.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml"><mo id="S2.Ex2.m1.3.3.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.3.3.1.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml"><msup id="S2.Ex2.m1.3.3.1.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.3.3.1.1.1.1.2.2" xref="S2.Ex2.m1.3.3.1.1.1.1.2.2.cmml">H</mi><mi id="S2.Ex2.m1.3.3.1.1.1.1.2.3" xref="S2.Ex2.m1.3.3.1.1.1.1.2.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.1.1.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.1.cmml">​</mo><msubsup id="S2.Ex2.m1.3.3.1.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.3.3.1.1.1.1.3.2.2" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2.2.cmml">V</mi><mi id="S2.Ex2.m1.3.3.1.1.1.1.3.2.3" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2.3.cmml">r</mi><mi id="S2.Ex2.m1.3.3.1.1.1.1.3.3" xref="S2.Ex2.m1.3.3.1.1.1.1.3.3.cmml">w</mi></msubsup></mrow><mo id="S2.Ex2.m1.3.3.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.3b"><apply id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3"><eq id="S2.Ex2.m1.3.3.2.cmml" xref="S2.Ex2.m1.3.3.2"></eq><apply id="S2.Ex2.m1.3.3.3.cmml" xref="S2.Ex2.m1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.3.1.cmml" xref="S2.Ex2.m1.3.3.3">superscript</csymbol><apply id="S2.Ex2.m1.3.3.3.2.cmml" xref="S2.Ex2.m1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.3.2.1.cmml" xref="S2.Ex2.m1.3.3.3">subscript</csymbol><ci id="S2.Ex2.m1.3.3.3.2.2.cmml" xref="S2.Ex2.m1.3.3.3.2.2">𝐴</ci><ci id="S2.Ex2.m1.3.3.3.2.3.cmml" xref="S2.Ex2.m1.3.3.3.2.3">𝑛</ci></apply><ci id="S2.Ex2.m1.3.3.3.3.cmml" xref="S2.Ex2.m1.3.3.3.3">𝑤</ci></apply><apply id="S2.Ex2.m1.3.3.1.cmml" xref="S2.Ex2.m1.3.3.1"><times id="S2.Ex2.m1.3.3.1.2.cmml" xref="S2.Ex2.m1.3.3.1.2"></times><ci id="S2.Ex2.m1.3.3.1.3a.cmml" xref="S2.Ex2.m1.3.3.1.3"><mtext id="S2.Ex2.m1.3.3.1.3.cmml" xref="S2.Ex2.m1.3.3.1.3">Softmax</mtext></ci><apply id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.3.3.1.4.2"><divide id="S2.Ex2.m1.2.2.3.cmml" xref="S2.Ex2.m1.3.3.1.4.2"></divide><apply id="S2.Ex2.m1.2.2.2.cmml" xref="S2.Ex2.m1.2.2.2"><times id="S2.Ex2.m1.2.2.2.3.cmml" xref="S2.Ex2.m1.2.2.2.3"></times><apply id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1"><times id="S2.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.1"></times><apply id="S2.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2">𝐻</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.3">𝑤</ci></apply><apply id="S2.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.2.2">𝑄</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply><apply id="S2.Ex2.m1.2.2.2.2.cmml" xref="S2.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.2.2.2.2">superscript</csymbol><apply id="S2.Ex2.m1.2.2.2.2.1.1.1.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1"><times id="S2.Ex2.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.1"></times><apply id="S2.Ex2.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S2.Ex2.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2.2">𝐻</ci><ci id="S2.Ex2.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="S2.Ex2.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.2">𝐾</ci><ci id="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.2.3">𝑟</ci></apply><ci id="S2.Ex2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.Ex2.m1.2.2.2.2.1.1.1.3.3">𝑤</ci></apply></apply><ci id="S2.Ex2.m1.2.2.2.2.3.cmml" xref="S2.Ex2.m1.2.2.2.2.3">𝑇</ci></apply></apply><apply id="S2.Ex2.m1.2.2.4.cmml" xref="S2.Ex2.m1.2.2.4"><root id="S2.Ex2.m1.2.2.4a.cmml" xref="S2.Ex2.m1.2.2.4"></root><ci id="S2.Ex2.m1.2.2.4.2.cmml" xref="S2.Ex2.m1.2.2.4.2">𝑑</ci></apply></apply><apply id="S2.Ex2.m1.3.3.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1"><times id="S2.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1"></times><apply id="S2.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="S2.Ex2.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.2.2">𝐻</ci><ci id="S2.Ex2.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3">superscript</csymbol><apply id="S2.Ex2.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2.2">𝑉</ci><ci id="S2.Ex2.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S2.Ex2.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.3c">A_{n}^{w}=\text{Softmax}\left(\frac{\left(H^{w}Q_{r}^{w}\right)\left(H^{t}K_{r}^{w}\right)^{T}}{\sqrt{d}}\right)\left(H^{t}V_{r}^{w}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.23" class="ltx_p">where <math id="S2.SS3.p1.6.m1.1" class="ltx_Math" alttext="Q_{r}^{w}" display="inline"><semantics id="S2.SS3.p1.6.m1.1a"><msubsup id="S2.SS3.p1.6.m1.1.1" xref="S2.SS3.p1.6.m1.1.1.cmml"><mi id="S2.SS3.p1.6.m1.1.1.2.2" xref="S2.SS3.p1.6.m1.1.1.2.2.cmml">Q</mi><mi id="S2.SS3.p1.6.m1.1.1.2.3" xref="S2.SS3.p1.6.m1.1.1.2.3.cmml">r</mi><mi id="S2.SS3.p1.6.m1.1.1.3" xref="S2.SS3.p1.6.m1.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m1.1b"><apply id="S2.SS3.p1.6.m1.1.1.cmml" xref="S2.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m1.1.1.1.cmml" xref="S2.SS3.p1.6.m1.1.1">superscript</csymbol><apply id="S2.SS3.p1.6.m1.1.1.2.cmml" xref="S2.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m1.1.1.2.1.cmml" xref="S2.SS3.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.6.m1.1.1.2.2.cmml" xref="S2.SS3.p1.6.m1.1.1.2.2">𝑄</ci><ci id="S2.SS3.p1.6.m1.1.1.2.3.cmml" xref="S2.SS3.p1.6.m1.1.1.2.3">𝑟</ci></apply><ci id="S2.SS3.p1.6.m1.1.1.3.cmml" xref="S2.SS3.p1.6.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m1.1c">Q_{r}^{w}</annotation></semantics></math>, <math id="S2.SS3.p1.7.m2.1" class="ltx_Math" alttext="K_{r}^{w}" display="inline"><semantics id="S2.SS3.p1.7.m2.1a"><msubsup id="S2.SS3.p1.7.m2.1.1" xref="S2.SS3.p1.7.m2.1.1.cmml"><mi id="S2.SS3.p1.7.m2.1.1.2.2" xref="S2.SS3.p1.7.m2.1.1.2.2.cmml">K</mi><mi id="S2.SS3.p1.7.m2.1.1.2.3" xref="S2.SS3.p1.7.m2.1.1.2.3.cmml">r</mi><mi id="S2.SS3.p1.7.m2.1.1.3" xref="S2.SS3.p1.7.m2.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m2.1b"><apply id="S2.SS3.p1.7.m2.1.1.cmml" xref="S2.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m2.1.1.1.cmml" xref="S2.SS3.p1.7.m2.1.1">superscript</csymbol><apply id="S2.SS3.p1.7.m2.1.1.2.cmml" xref="S2.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m2.1.1.2.1.cmml" xref="S2.SS3.p1.7.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.7.m2.1.1.2.2.cmml" xref="S2.SS3.p1.7.m2.1.1.2.2">𝐾</ci><ci id="S2.SS3.p1.7.m2.1.1.2.3.cmml" xref="S2.SS3.p1.7.m2.1.1.2.3">𝑟</ci></apply><ci id="S2.SS3.p1.7.m2.1.1.3.cmml" xref="S2.SS3.p1.7.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m2.1c">K_{r}^{w}</annotation></semantics></math>, <math id="S2.SS3.p1.8.m3.1" class="ltx_Math" alttext="V_{r}^{w}\in R^{d\times d}" display="inline"><semantics id="S2.SS3.p1.8.m3.1a"><mrow id="S2.SS3.p1.8.m3.1.1" xref="S2.SS3.p1.8.m3.1.1.cmml"><msubsup id="S2.SS3.p1.8.m3.1.1.2" xref="S2.SS3.p1.8.m3.1.1.2.cmml"><mi id="S2.SS3.p1.8.m3.1.1.2.2.2" xref="S2.SS3.p1.8.m3.1.1.2.2.2.cmml">V</mi><mi id="S2.SS3.p1.8.m3.1.1.2.2.3" xref="S2.SS3.p1.8.m3.1.1.2.2.3.cmml">r</mi><mi id="S2.SS3.p1.8.m3.1.1.2.3" xref="S2.SS3.p1.8.m3.1.1.2.3.cmml">w</mi></msubsup><mo id="S2.SS3.p1.8.m3.1.1.1" xref="S2.SS3.p1.8.m3.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.8.m3.1.1.3" xref="S2.SS3.p1.8.m3.1.1.3.cmml"><mi id="S2.SS3.p1.8.m3.1.1.3.2" xref="S2.SS3.p1.8.m3.1.1.3.2.cmml">R</mi><mrow id="S2.SS3.p1.8.m3.1.1.3.3" xref="S2.SS3.p1.8.m3.1.1.3.3.cmml"><mi id="S2.SS3.p1.8.m3.1.1.3.3.2" xref="S2.SS3.p1.8.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p1.8.m3.1.1.3.3.1" xref="S2.SS3.p1.8.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.p1.8.m3.1.1.3.3.3" xref="S2.SS3.p1.8.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m3.1b"><apply id="S2.SS3.p1.8.m3.1.1.cmml" xref="S2.SS3.p1.8.m3.1.1"><in id="S2.SS3.p1.8.m3.1.1.1.cmml" xref="S2.SS3.p1.8.m3.1.1.1"></in><apply id="S2.SS3.p1.8.m3.1.1.2.cmml" xref="S2.SS3.p1.8.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.8.m3.1.1.2.1.cmml" xref="S2.SS3.p1.8.m3.1.1.2">superscript</csymbol><apply id="S2.SS3.p1.8.m3.1.1.2.2.cmml" xref="S2.SS3.p1.8.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.8.m3.1.1.2.2.1.cmml" xref="S2.SS3.p1.8.m3.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.8.m3.1.1.2.2.2.cmml" xref="S2.SS3.p1.8.m3.1.1.2.2.2">𝑉</ci><ci id="S2.SS3.p1.8.m3.1.1.2.2.3.cmml" xref="S2.SS3.p1.8.m3.1.1.2.2.3">𝑟</ci></apply><ci id="S2.SS3.p1.8.m3.1.1.2.3.cmml" xref="S2.SS3.p1.8.m3.1.1.2.3">𝑤</ci></apply><apply id="S2.SS3.p1.8.m3.1.1.3.cmml" xref="S2.SS3.p1.8.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.8.m3.1.1.3.1.cmml" xref="S2.SS3.p1.8.m3.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.8.m3.1.1.3.2.cmml" xref="S2.SS3.p1.8.m3.1.1.3.2">𝑅</ci><apply id="S2.SS3.p1.8.m3.1.1.3.3.cmml" xref="S2.SS3.p1.8.m3.1.1.3.3"><times id="S2.SS3.p1.8.m3.1.1.3.3.1.cmml" xref="S2.SS3.p1.8.m3.1.1.3.3.1"></times><ci id="S2.SS3.p1.8.m3.1.1.3.3.2.cmml" xref="S2.SS3.p1.8.m3.1.1.3.3.2">𝑑</ci><ci id="S2.SS3.p1.8.m3.1.1.3.3.3.cmml" xref="S2.SS3.p1.8.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m3.1c">V_{r}^{w}\in R^{d\times d}</annotation></semantics></math> are the parameters of the <span id="S2.SS3.p1.23.2" class="ltx_text ltx_font_italic">Rescore-Attention Layer</span>.
This N-best rescore cross-attention <math id="S2.SS3.p1.9.m4.1" class="ltx_Math" alttext="A_{n}^{w}" display="inline"><semantics id="S2.SS3.p1.9.m4.1a"><msubsup id="S2.SS3.p1.9.m4.1.1" xref="S2.SS3.p1.9.m4.1.1.cmml"><mi id="S2.SS3.p1.9.m4.1.1.2.2" xref="S2.SS3.p1.9.m4.1.1.2.2.cmml">A</mi><mi id="S2.SS3.p1.9.m4.1.1.2.3" xref="S2.SS3.p1.9.m4.1.1.2.3.cmml">n</mi><mi id="S2.SS3.p1.9.m4.1.1.3" xref="S2.SS3.p1.9.m4.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m4.1b"><apply id="S2.SS3.p1.9.m4.1.1.cmml" xref="S2.SS3.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m4.1.1.1.cmml" xref="S2.SS3.p1.9.m4.1.1">superscript</csymbol><apply id="S2.SS3.p1.9.m4.1.1.2.cmml" xref="S2.SS3.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m4.1.1.2.1.cmml" xref="S2.SS3.p1.9.m4.1.1">subscript</csymbol><ci id="S2.SS3.p1.9.m4.1.1.2.2.cmml" xref="S2.SS3.p1.9.m4.1.1.2.2">𝐴</ci><ci id="S2.SS3.p1.9.m4.1.1.2.3.cmml" xref="S2.SS3.p1.9.m4.1.1.2.3">𝑛</ci></apply><ci id="S2.SS3.p1.9.m4.1.1.3.cmml" xref="S2.SS3.p1.9.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m4.1c">A_{n}^{w}</annotation></semantics></math> <math id="S2.SS3.p1.10.m5.1" class="ltx_Math" alttext="\in R^{l_{N}\times d}" display="inline"><semantics id="S2.SS3.p1.10.m5.1a"><mrow id="S2.SS3.p1.10.m5.1.1" xref="S2.SS3.p1.10.m5.1.1.cmml"><mi id="S2.SS3.p1.10.m5.1.1.2" xref="S2.SS3.p1.10.m5.1.1.2.cmml"></mi><mo id="S2.SS3.p1.10.m5.1.1.1" xref="S2.SS3.p1.10.m5.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.10.m5.1.1.3" xref="S2.SS3.p1.10.m5.1.1.3.cmml"><mi id="S2.SS3.p1.10.m5.1.1.3.2" xref="S2.SS3.p1.10.m5.1.1.3.2.cmml">R</mi><mrow id="S2.SS3.p1.10.m5.1.1.3.3" xref="S2.SS3.p1.10.m5.1.1.3.3.cmml"><msub id="S2.SS3.p1.10.m5.1.1.3.3.2" xref="S2.SS3.p1.10.m5.1.1.3.3.2.cmml"><mi id="S2.SS3.p1.10.m5.1.1.3.3.2.2" xref="S2.SS3.p1.10.m5.1.1.3.3.2.2.cmml">l</mi><mi id="S2.SS3.p1.10.m5.1.1.3.3.2.3" xref="S2.SS3.p1.10.m5.1.1.3.3.2.3.cmml">N</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p1.10.m5.1.1.3.3.1" xref="S2.SS3.p1.10.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.p1.10.m5.1.1.3.3.3" xref="S2.SS3.p1.10.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m5.1b"><apply id="S2.SS3.p1.10.m5.1.1.cmml" xref="S2.SS3.p1.10.m5.1.1"><in id="S2.SS3.p1.10.m5.1.1.1.cmml" xref="S2.SS3.p1.10.m5.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.p1.10.m5.1.1.2.cmml" xref="S2.SS3.p1.10.m5.1.1.2">absent</csymbol><apply id="S2.SS3.p1.10.m5.1.1.3.cmml" xref="S2.SS3.p1.10.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m5.1.1.3.1.cmml" xref="S2.SS3.p1.10.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.10.m5.1.1.3.2.cmml" xref="S2.SS3.p1.10.m5.1.1.3.2">𝑅</ci><apply id="S2.SS3.p1.10.m5.1.1.3.3.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3"><times id="S2.SS3.p1.10.m5.1.1.3.3.1.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.1"></times><apply id="S2.SS3.p1.10.m5.1.1.3.3.2.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m5.1.1.3.3.2.1.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.2">subscript</csymbol><ci id="S2.SS3.p1.10.m5.1.1.3.3.2.2.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.2.2">𝑙</ci><ci id="S2.SS3.p1.10.m5.1.1.3.3.2.3.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.2.3">𝑁</ci></apply><ci id="S2.SS3.p1.10.m5.1.1.3.3.3.cmml" xref="S2.SS3.p1.10.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.10.m5.1c">\in R^{l_{N}\times d}</annotation></semantics></math> provides a high-dimensional similarity measurement for each N-best hypothesis against the target sequence in different embedding subspaces via Multi-Head Attentions (MHA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. This N-best rescore cross-attention is a concatenation of N attention blocks, i.e., <math id="S2.SS3.p1.11.m6.3" class="ltx_Math" alttext="A_{n}^{w}=\left[A^{w}_{n_{1}};...;A^{w}_{n_{N}}\right]\in R^{l_{N}\times d}" display="inline"><semantics id="S2.SS3.p1.11.m6.3a"><mrow id="S2.SS3.p1.11.m6.3.3" xref="S2.SS3.p1.11.m6.3.3.cmml"><msubsup id="S2.SS3.p1.11.m6.3.3.4" xref="S2.SS3.p1.11.m6.3.3.4.cmml"><mi id="S2.SS3.p1.11.m6.3.3.4.2.2" xref="S2.SS3.p1.11.m6.3.3.4.2.2.cmml">A</mi><mi id="S2.SS3.p1.11.m6.3.3.4.2.3" xref="S2.SS3.p1.11.m6.3.3.4.2.3.cmml">n</mi><mi id="S2.SS3.p1.11.m6.3.3.4.3" xref="S2.SS3.p1.11.m6.3.3.4.3.cmml">w</mi></msubsup><mo id="S2.SS3.p1.11.m6.3.3.5" xref="S2.SS3.p1.11.m6.3.3.5.cmml">=</mo><mrow id="S2.SS3.p1.11.m6.3.3.2.2" xref="S2.SS3.p1.11.m6.3.3.2.3.cmml"><mo id="S2.SS3.p1.11.m6.3.3.2.2.3" xref="S2.SS3.p1.11.m6.3.3.2.3.cmml">[</mo><msubsup id="S2.SS3.p1.11.m6.2.2.1.1.1" xref="S2.SS3.p1.11.m6.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.11.m6.2.2.1.1.1.2.2" xref="S2.SS3.p1.11.m6.2.2.1.1.1.2.2.cmml">A</mi><msub id="S2.SS3.p1.11.m6.2.2.1.1.1.3" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p1.11.m6.2.2.1.1.1.3.2" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3.2.cmml">n</mi><mn id="S2.SS3.p1.11.m6.2.2.1.1.1.3.3" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3.3.cmml">1</mn></msub><mi id="S2.SS3.p1.11.m6.2.2.1.1.1.2.3" xref="S2.SS3.p1.11.m6.2.2.1.1.1.2.3.cmml">w</mi></msubsup><mo id="S2.SS3.p1.11.m6.3.3.2.2.4" xref="S2.SS3.p1.11.m6.3.3.2.3.cmml">;</mo><mi mathvariant="normal" id="S2.SS3.p1.11.m6.1.1" xref="S2.SS3.p1.11.m6.1.1.cmml">…</mi><mo id="S2.SS3.p1.11.m6.3.3.2.2.5" xref="S2.SS3.p1.11.m6.3.3.2.3.cmml">;</mo><msubsup id="S2.SS3.p1.11.m6.3.3.2.2.2" xref="S2.SS3.p1.11.m6.3.3.2.2.2.cmml"><mi id="S2.SS3.p1.11.m6.3.3.2.2.2.2.2" xref="S2.SS3.p1.11.m6.3.3.2.2.2.2.2.cmml">A</mi><msub id="S2.SS3.p1.11.m6.3.3.2.2.2.3" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3.cmml"><mi id="S2.SS3.p1.11.m6.3.3.2.2.2.3.2" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3.2.cmml">n</mi><mi id="S2.SS3.p1.11.m6.3.3.2.2.2.3.3" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3.3.cmml">N</mi></msub><mi id="S2.SS3.p1.11.m6.3.3.2.2.2.2.3" xref="S2.SS3.p1.11.m6.3.3.2.2.2.2.3.cmml">w</mi></msubsup><mo id="S2.SS3.p1.11.m6.3.3.2.2.6" xref="S2.SS3.p1.11.m6.3.3.2.3.cmml">]</mo></mrow><mo id="S2.SS3.p1.11.m6.3.3.6" xref="S2.SS3.p1.11.m6.3.3.6.cmml">∈</mo><msup id="S2.SS3.p1.11.m6.3.3.7" xref="S2.SS3.p1.11.m6.3.3.7.cmml"><mi id="S2.SS3.p1.11.m6.3.3.7.2" xref="S2.SS3.p1.11.m6.3.3.7.2.cmml">R</mi><mrow id="S2.SS3.p1.11.m6.3.3.7.3" xref="S2.SS3.p1.11.m6.3.3.7.3.cmml"><msub id="S2.SS3.p1.11.m6.3.3.7.3.2" xref="S2.SS3.p1.11.m6.3.3.7.3.2.cmml"><mi id="S2.SS3.p1.11.m6.3.3.7.3.2.2" xref="S2.SS3.p1.11.m6.3.3.7.3.2.2.cmml">l</mi><mi id="S2.SS3.p1.11.m6.3.3.7.3.2.3" xref="S2.SS3.p1.11.m6.3.3.7.3.2.3.cmml">N</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p1.11.m6.3.3.7.3.1" xref="S2.SS3.p1.11.m6.3.3.7.3.1.cmml">×</mo><mi id="S2.SS3.p1.11.m6.3.3.7.3.3" xref="S2.SS3.p1.11.m6.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m6.3b"><apply id="S2.SS3.p1.11.m6.3.3.cmml" xref="S2.SS3.p1.11.m6.3.3"><and id="S2.SS3.p1.11.m6.3.3a.cmml" xref="S2.SS3.p1.11.m6.3.3"></and><apply id="S2.SS3.p1.11.m6.3.3b.cmml" xref="S2.SS3.p1.11.m6.3.3"><eq id="S2.SS3.p1.11.m6.3.3.5.cmml" xref="S2.SS3.p1.11.m6.3.3.5"></eq><apply id="S2.SS3.p1.11.m6.3.3.4.cmml" xref="S2.SS3.p1.11.m6.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.4.1.cmml" xref="S2.SS3.p1.11.m6.3.3.4">superscript</csymbol><apply id="S2.SS3.p1.11.m6.3.3.4.2.cmml" xref="S2.SS3.p1.11.m6.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.4.2.1.cmml" xref="S2.SS3.p1.11.m6.3.3.4">subscript</csymbol><ci id="S2.SS3.p1.11.m6.3.3.4.2.2.cmml" xref="S2.SS3.p1.11.m6.3.3.4.2.2">𝐴</ci><ci id="S2.SS3.p1.11.m6.3.3.4.2.3.cmml" xref="S2.SS3.p1.11.m6.3.3.4.2.3">𝑛</ci></apply><ci id="S2.SS3.p1.11.m6.3.3.4.3.cmml" xref="S2.SS3.p1.11.m6.3.3.4.3">𝑤</ci></apply><list id="S2.SS3.p1.11.m6.3.3.2.3.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2"><apply id="S2.SS3.p1.11.m6.2.2.1.1.1.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1">subscript</csymbol><apply id="S2.SS3.p1.11.m6.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1">superscript</csymbol><ci id="S2.SS3.p1.11.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.2.2">𝐴</ci><ci id="S2.SS3.p1.11.m6.2.2.1.1.1.2.3.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.2.3">𝑤</ci></apply><apply id="S2.SS3.p1.11.m6.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.11.m6.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.SS3.p1.11.m6.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p1.11.m6.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p1.11.m6.1.1.cmml" xref="S2.SS3.p1.11.m6.1.1">…</ci><apply id="S2.SS3.p1.11.m6.3.3.2.2.2.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.p1.11.m6.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2">superscript</csymbol><ci id="S2.SS3.p1.11.m6.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.2.2">𝐴</ci><ci id="S2.SS3.p1.11.m6.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.2.3">𝑤</ci></apply><apply id="S2.SS3.p1.11.m6.3.3.2.2.2.3.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.2.2.2.3.1.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.11.m6.3.3.2.2.2.3.2.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3.2">𝑛</ci><ci id="S2.SS3.p1.11.m6.3.3.2.2.2.3.3.cmml" xref="S2.SS3.p1.11.m6.3.3.2.2.2.3.3">𝑁</ci></apply></apply></list></apply><apply id="S2.SS3.p1.11.m6.3.3c.cmml" xref="S2.SS3.p1.11.m6.3.3"><in id="S2.SS3.p1.11.m6.3.3.6.cmml" xref="S2.SS3.p1.11.m6.3.3.6"></in><share href="#S2.SS3.p1.11.m6.3.3.2.cmml" id="S2.SS3.p1.11.m6.3.3d.cmml" xref="S2.SS3.p1.11.m6.3.3"></share><apply id="S2.SS3.p1.11.m6.3.3.7.cmml" xref="S2.SS3.p1.11.m6.3.3.7"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.7.1.cmml" xref="S2.SS3.p1.11.m6.3.3.7">superscript</csymbol><ci id="S2.SS3.p1.11.m6.3.3.7.2.cmml" xref="S2.SS3.p1.11.m6.3.3.7.2">𝑅</ci><apply id="S2.SS3.p1.11.m6.3.3.7.3.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3"><times id="S2.SS3.p1.11.m6.3.3.7.3.1.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.1"></times><apply id="S2.SS3.p1.11.m6.3.3.7.3.2.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m6.3.3.7.3.2.1.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.2">subscript</csymbol><ci id="S2.SS3.p1.11.m6.3.3.7.3.2.2.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.2.2">𝑙</ci><ci id="S2.SS3.p1.11.m6.3.3.7.3.2.3.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.2.3">𝑁</ci></apply><ci id="S2.SS3.p1.11.m6.3.3.7.3.3.cmml" xref="S2.SS3.p1.11.m6.3.3.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.11.m6.3c">A_{n}^{w}=\left[A^{w}_{n_{1}};...;A^{w}_{n_{N}}\right]\in R^{l_{N}\times d}</annotation></semantics></math>, indexed by <math id="S2.SS3.p1.12.m7.3" class="ltx_Math" alttext="i=1,...,N" display="inline"><semantics id="S2.SS3.p1.12.m7.3a"><mrow id="S2.SS3.p1.12.m7.3.4" xref="S2.SS3.p1.12.m7.3.4.cmml"><mi id="S2.SS3.p1.12.m7.3.4.2" xref="S2.SS3.p1.12.m7.3.4.2.cmml">i</mi><mo id="S2.SS3.p1.12.m7.3.4.1" xref="S2.SS3.p1.12.m7.3.4.1.cmml">=</mo><mrow id="S2.SS3.p1.12.m7.3.4.3.2" xref="S2.SS3.p1.12.m7.3.4.3.1.cmml"><mn id="S2.SS3.p1.12.m7.1.1" xref="S2.SS3.p1.12.m7.1.1.cmml">1</mn><mo id="S2.SS3.p1.12.m7.3.4.3.2.1" xref="S2.SS3.p1.12.m7.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS3.p1.12.m7.2.2" xref="S2.SS3.p1.12.m7.2.2.cmml">…</mi><mo id="S2.SS3.p1.12.m7.3.4.3.2.2" xref="S2.SS3.p1.12.m7.3.4.3.1.cmml">,</mo><mi id="S2.SS3.p1.12.m7.3.3" xref="S2.SS3.p1.12.m7.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.12.m7.3b"><apply id="S2.SS3.p1.12.m7.3.4.cmml" xref="S2.SS3.p1.12.m7.3.4"><eq id="S2.SS3.p1.12.m7.3.4.1.cmml" xref="S2.SS3.p1.12.m7.3.4.1"></eq><ci id="S2.SS3.p1.12.m7.3.4.2.cmml" xref="S2.SS3.p1.12.m7.3.4.2">𝑖</ci><list id="S2.SS3.p1.12.m7.3.4.3.1.cmml" xref="S2.SS3.p1.12.m7.3.4.3.2"><cn type="integer" id="S2.SS3.p1.12.m7.1.1.cmml" xref="S2.SS3.p1.12.m7.1.1">1</cn><ci id="S2.SS3.p1.12.m7.2.2.cmml" xref="S2.SS3.p1.12.m7.2.2">…</ci><ci id="S2.SS3.p1.12.m7.3.3.cmml" xref="S2.SS3.p1.12.m7.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.12.m7.3c">i=1,...,N</annotation></semantics></math>, where each attention block <math id="S2.SS3.p1.13.m8.1" class="ltx_Math" alttext="A_{n_{i}}^{w}\in R^{l\times d}" display="inline"><semantics id="S2.SS3.p1.13.m8.1a"><mrow id="S2.SS3.p1.13.m8.1.1" xref="S2.SS3.p1.13.m8.1.1.cmml"><msubsup id="S2.SS3.p1.13.m8.1.1.2" xref="S2.SS3.p1.13.m8.1.1.2.cmml"><mi id="S2.SS3.p1.13.m8.1.1.2.2.2" xref="S2.SS3.p1.13.m8.1.1.2.2.2.cmml">A</mi><msub id="S2.SS3.p1.13.m8.1.1.2.2.3" xref="S2.SS3.p1.13.m8.1.1.2.2.3.cmml"><mi id="S2.SS3.p1.13.m8.1.1.2.2.3.2" xref="S2.SS3.p1.13.m8.1.1.2.2.3.2.cmml">n</mi><mi id="S2.SS3.p1.13.m8.1.1.2.2.3.3" xref="S2.SS3.p1.13.m8.1.1.2.2.3.3.cmml">i</mi></msub><mi id="S2.SS3.p1.13.m8.1.1.2.3" xref="S2.SS3.p1.13.m8.1.1.2.3.cmml">w</mi></msubsup><mo id="S2.SS3.p1.13.m8.1.1.1" xref="S2.SS3.p1.13.m8.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.13.m8.1.1.3" xref="S2.SS3.p1.13.m8.1.1.3.cmml"><mi id="S2.SS3.p1.13.m8.1.1.3.2" xref="S2.SS3.p1.13.m8.1.1.3.2.cmml">R</mi><mrow id="S2.SS3.p1.13.m8.1.1.3.3" xref="S2.SS3.p1.13.m8.1.1.3.3.cmml"><mi id="S2.SS3.p1.13.m8.1.1.3.3.2" xref="S2.SS3.p1.13.m8.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.p1.13.m8.1.1.3.3.1" xref="S2.SS3.p1.13.m8.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.p1.13.m8.1.1.3.3.3" xref="S2.SS3.p1.13.m8.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.13.m8.1b"><apply id="S2.SS3.p1.13.m8.1.1.cmml" xref="S2.SS3.p1.13.m8.1.1"><in id="S2.SS3.p1.13.m8.1.1.1.cmml" xref="S2.SS3.p1.13.m8.1.1.1"></in><apply id="S2.SS3.p1.13.m8.1.1.2.cmml" xref="S2.SS3.p1.13.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m8.1.1.2.1.cmml" xref="S2.SS3.p1.13.m8.1.1.2">superscript</csymbol><apply id="S2.SS3.p1.13.m8.1.1.2.2.cmml" xref="S2.SS3.p1.13.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m8.1.1.2.2.1.cmml" xref="S2.SS3.p1.13.m8.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.13.m8.1.1.2.2.2.cmml" xref="S2.SS3.p1.13.m8.1.1.2.2.2">𝐴</ci><apply id="S2.SS3.p1.13.m8.1.1.2.2.3.cmml" xref="S2.SS3.p1.13.m8.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m8.1.1.2.2.3.1.cmml" xref="S2.SS3.p1.13.m8.1.1.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.13.m8.1.1.2.2.3.2.cmml" xref="S2.SS3.p1.13.m8.1.1.2.2.3.2">𝑛</ci><ci id="S2.SS3.p1.13.m8.1.1.2.2.3.3.cmml" xref="S2.SS3.p1.13.m8.1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S2.SS3.p1.13.m8.1.1.2.3.cmml" xref="S2.SS3.p1.13.m8.1.1.2.3">𝑤</ci></apply><apply id="S2.SS3.p1.13.m8.1.1.3.cmml" xref="S2.SS3.p1.13.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m8.1.1.3.1.cmml" xref="S2.SS3.p1.13.m8.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.13.m8.1.1.3.2.cmml" xref="S2.SS3.p1.13.m8.1.1.3.2">𝑅</ci><apply id="S2.SS3.p1.13.m8.1.1.3.3.cmml" xref="S2.SS3.p1.13.m8.1.1.3.3"><times id="S2.SS3.p1.13.m8.1.1.3.3.1.cmml" xref="S2.SS3.p1.13.m8.1.1.3.3.1"></times><ci id="S2.SS3.p1.13.m8.1.1.3.3.2.cmml" xref="S2.SS3.p1.13.m8.1.1.3.3.2">𝑙</ci><ci id="S2.SS3.p1.13.m8.1.1.3.3.3.cmml" xref="S2.SS3.p1.13.m8.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.13.m8.1c">A_{n_{i}}^{w}\in R^{l\times d}</annotation></semantics></math> is the <math id="S2.SS3.p1.14.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p1.14.m9.1a"><mi id="S2.SS3.p1.14.m9.1.1" xref="S2.SS3.p1.14.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.14.m9.1b"><ci id="S2.SS3.p1.14.m9.1.1.cmml" xref="S2.SS3.p1.14.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.14.m9.1c">i</annotation></semantics></math>-th partition of of <math id="S2.SS3.p1.15.m10.1" class="ltx_Math" alttext="A_{n}^{w}" display="inline"><semantics id="S2.SS3.p1.15.m10.1a"><msubsup id="S2.SS3.p1.15.m10.1.1" xref="S2.SS3.p1.15.m10.1.1.cmml"><mi id="S2.SS3.p1.15.m10.1.1.2.2" xref="S2.SS3.p1.15.m10.1.1.2.2.cmml">A</mi><mi id="S2.SS3.p1.15.m10.1.1.2.3" xref="S2.SS3.p1.15.m10.1.1.2.3.cmml">n</mi><mi id="S2.SS3.p1.15.m10.1.1.3" xref="S2.SS3.p1.15.m10.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.15.m10.1b"><apply id="S2.SS3.p1.15.m10.1.1.cmml" xref="S2.SS3.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.15.m10.1.1.1.cmml" xref="S2.SS3.p1.15.m10.1.1">superscript</csymbol><apply id="S2.SS3.p1.15.m10.1.1.2.cmml" xref="S2.SS3.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.15.m10.1.1.2.1.cmml" xref="S2.SS3.p1.15.m10.1.1">subscript</csymbol><ci id="S2.SS3.p1.15.m10.1.1.2.2.cmml" xref="S2.SS3.p1.15.m10.1.1.2.2">𝐴</ci><ci id="S2.SS3.p1.15.m10.1.1.2.3.cmml" xref="S2.SS3.p1.15.m10.1.1.2.3">𝑛</ci></apply><ci id="S2.SS3.p1.15.m10.1.1.3.cmml" xref="S2.SS3.p1.15.m10.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.15.m10.1c">A_{n}^{w}</annotation></semantics></math> in the sequence-length dimension with length <math id="S2.SS3.p1.16.m11.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS3.p1.16.m11.1a"><mi id="S2.SS3.p1.16.m11.1.1" xref="S2.SS3.p1.16.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.16.m11.1b"><ci id="S2.SS3.p1.16.m11.1.1.cmml" xref="S2.SS3.p1.16.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.16.m11.1c">l</annotation></semantics></math>.
The output of this MHA layer is normalized and then fed to a reduce sum function <span id="S2.SS3.p1.17.1" class="ltx_text ltx_font_italic">reduce(<math id="S2.SS3.p1.17.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="S2.SS3.p1.17.1.m1.1a"><mo id="S2.SS3.p1.17.1.m1.1.1" xref="S2.SS3.p1.17.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.17.1.m1.1b"><ci id="S2.SS3.p1.17.1.m1.1.1.cmml" xref="S2.SS3.p1.17.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.17.1.m1.1c">\cdot</annotation></semantics></math>)</span>, reduce by summing along the sequence-length dimension <math id="S2.SS3.p1.18.m12.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS3.p1.18.m12.1a"><mi id="S2.SS3.p1.18.m12.1.1" xref="S2.SS3.p1.18.m12.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.18.m12.1b"><ci id="S2.SS3.p1.18.m12.1.1.cmml" xref="S2.SS3.p1.18.m12.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.18.m12.1c">l</annotation></semantics></math>, denoted by <math id="S2.SS3.p1.19.m13.5" class="ltx_Math" alttext="\sum_{l}(X_{l,\cdot}\in R^{l\times\cdot})" display="inline"><semantics id="S2.SS3.p1.19.m13.5a"><mrow id="S2.SS3.p1.19.m13.5.5" xref="S2.SS3.p1.19.m13.5.5.cmml"><msub id="S2.SS3.p1.19.m13.5.5.2" xref="S2.SS3.p1.19.m13.5.5.2.cmml"><mo id="S2.SS3.p1.19.m13.5.5.2.2" xref="S2.SS3.p1.19.m13.5.5.2.2.cmml">∑</mo><mi id="S2.SS3.p1.19.m13.5.5.2.3" xref="S2.SS3.p1.19.m13.5.5.2.3.cmml">l</mi></msub><mrow id="S2.SS3.p1.19.m13.5.5.1.1" xref="S2.SS3.p1.19.m13.5.5.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S2.SS3.p1.19.m13.5.5.1.1.2" xref="S2.SS3.p1.19.m13.5.5.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.19.m13.5.5.1.1.1" xref="S2.SS3.p1.19.m13.5.5.1.1.1.cmml"><msub id="S2.SS3.p1.19.m13.5.5.1.1.1.2" xref="S2.SS3.p1.19.m13.5.5.1.1.1.2.cmml"><mi id="S2.SS3.p1.19.m13.5.5.1.1.1.2.2" xref="S2.SS3.p1.19.m13.5.5.1.1.1.2.2.cmml">X</mi><mrow id="S2.SS3.p1.19.m13.2.2.2.4" xref="S2.SS3.p1.19.m13.2.2.2.3.cmml"><mi id="S2.SS3.p1.19.m13.1.1.1.1" xref="S2.SS3.p1.19.m13.1.1.1.1.cmml">l</mi><mo rspace="0em" id="S2.SS3.p1.19.m13.2.2.2.4.1" xref="S2.SS3.p1.19.m13.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S2.SS3.p1.19.m13.2.2.2.2" xref="S2.SS3.p1.19.m13.2.2.2.2.cmml">⋅</mo></mrow></msub><mo id="S2.SS3.p1.19.m13.5.5.1.1.1.1" xref="S2.SS3.p1.19.m13.5.5.1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.19.m13.5.5.1.1.1.3" xref="S2.SS3.p1.19.m13.5.5.1.1.1.3.cmml"><mi id="S2.SS3.p1.19.m13.5.5.1.1.1.3.2" xref="S2.SS3.p1.19.m13.5.5.1.1.1.3.2.cmml">R</mi><mrow id="S2.SS3.p1.19.m13.4.4.2.2" xref="S2.SS3.p1.19.m13.4.4.2.3.cmml"><mi id="S2.SS3.p1.19.m13.3.3.1.1" xref="S2.SS3.p1.19.m13.3.3.1.1.cmml">l</mi><mo id="S2.SS3.p1.19.m13.4.4.2.2.2" xref="S2.SS3.p1.19.m13.4.4.2.3.cmml">⁣</mo><mrow id="S2.SS3.p1.19.m13.4.4.2.2.1" xref="S2.SS3.p1.19.m13.4.4.2.2.1.cmml"><mi id="S2.SS3.p1.19.m13.4.4.2.2.1.2" xref="S2.SS3.p1.19.m13.4.4.2.2.1.2.cmml"></mi><mo lspace="0.222em" rspace="0em" id="S2.SS3.p1.19.m13.4.4.2.2.1.1" xref="S2.SS3.p1.19.m13.4.4.2.2.1.1.cmml">×</mo><mo lspace="0em" id="S2.SS3.p1.19.m13.4.4.2.2.1.3" xref="S2.SS3.p1.19.m13.4.4.2.2.1.3.cmml">⋅</mo></mrow></mrow></msup></mrow><mo stretchy="false" id="S2.SS3.p1.19.m13.5.5.1.1.3" xref="S2.SS3.p1.19.m13.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.19.m13.5b"><apply id="S2.SS3.p1.19.m13.5.5.cmml" xref="S2.SS3.p1.19.m13.5.5"><apply id="S2.SS3.p1.19.m13.5.5.2.cmml" xref="S2.SS3.p1.19.m13.5.5.2"><csymbol cd="ambiguous" id="S2.SS3.p1.19.m13.5.5.2.1.cmml" xref="S2.SS3.p1.19.m13.5.5.2">subscript</csymbol><sum id="S2.SS3.p1.19.m13.5.5.2.2.cmml" xref="S2.SS3.p1.19.m13.5.5.2.2"></sum><ci id="S2.SS3.p1.19.m13.5.5.2.3.cmml" xref="S2.SS3.p1.19.m13.5.5.2.3">𝑙</ci></apply><apply id="S2.SS3.p1.19.m13.5.5.1.1.1.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1"><in id="S2.SS3.p1.19.m13.5.5.1.1.1.1.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.1"></in><apply id="S2.SS3.p1.19.m13.5.5.1.1.1.2.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.19.m13.5.5.1.1.1.2.1.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.19.m13.5.5.1.1.1.2.2.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.2.2">𝑋</ci><list id="S2.SS3.p1.19.m13.2.2.2.3.cmml" xref="S2.SS3.p1.19.m13.2.2.2.4"><ci id="S2.SS3.p1.19.m13.1.1.1.1.cmml" xref="S2.SS3.p1.19.m13.1.1.1.1">𝑙</ci><ci id="S2.SS3.p1.19.m13.2.2.2.2.cmml" xref="S2.SS3.p1.19.m13.2.2.2.2">⋅</ci></list></apply><apply id="S2.SS3.p1.19.m13.5.5.1.1.1.3.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.19.m13.5.5.1.1.1.3.1.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.19.m13.5.5.1.1.1.3.2.cmml" xref="S2.SS3.p1.19.m13.5.5.1.1.1.3.2">𝑅</ci><list id="S2.SS3.p1.19.m13.4.4.2.3.cmml" xref="S2.SS3.p1.19.m13.4.4.2.2"><ci id="S2.SS3.p1.19.m13.3.3.1.1.cmml" xref="S2.SS3.p1.19.m13.3.3.1.1">𝑙</ci><apply id="S2.SS3.p1.19.m13.4.4.2.2.1.cmml" xref="S2.SS3.p1.19.m13.4.4.2.2.1"><times id="S2.SS3.p1.19.m13.4.4.2.2.1.1.cmml" xref="S2.SS3.p1.19.m13.4.4.2.2.1.1"></times><csymbol cd="latexml" id="S2.SS3.p1.19.m13.4.4.2.2.1.2.cmml" xref="S2.SS3.p1.19.m13.4.4.2.2.1.2">absent</csymbol><ci id="S2.SS3.p1.19.m13.4.4.2.2.1.3.cmml" xref="S2.SS3.p1.19.m13.4.4.2.2.1.3">⋅</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.19.m13.5c">\sum_{l}(X_{l,\cdot}\in R^{l\times\cdot})</annotation></semantics></math>. The same reduce function is applied to the target sequence. Finally, a scalar <math id="S2.SS3.p1.20.m14.1" class="ltx_Math" alttext="\hat{s}_{i}" display="inline"><semantics id="S2.SS3.p1.20.m14.1a"><msub id="S2.SS3.p1.20.m14.1.1" xref="S2.SS3.p1.20.m14.1.1.cmml"><mover accent="true" id="S2.SS3.p1.20.m14.1.1.2" xref="S2.SS3.p1.20.m14.1.1.2.cmml"><mi id="S2.SS3.p1.20.m14.1.1.2.2" xref="S2.SS3.p1.20.m14.1.1.2.2.cmml">s</mi><mo id="S2.SS3.p1.20.m14.1.1.2.1" xref="S2.SS3.p1.20.m14.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p1.20.m14.1.1.3" xref="S2.SS3.p1.20.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.20.m14.1b"><apply id="S2.SS3.p1.20.m14.1.1.cmml" xref="S2.SS3.p1.20.m14.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.20.m14.1.1.1.cmml" xref="S2.SS3.p1.20.m14.1.1">subscript</csymbol><apply id="S2.SS3.p1.20.m14.1.1.2.cmml" xref="S2.SS3.p1.20.m14.1.1.2"><ci id="S2.SS3.p1.20.m14.1.1.2.1.cmml" xref="S2.SS3.p1.20.m14.1.1.2.1">^</ci><ci id="S2.SS3.p1.20.m14.1.1.2.2.cmml" xref="S2.SS3.p1.20.m14.1.1.2.2">𝑠</ci></apply><ci id="S2.SS3.p1.20.m14.1.1.3.cmml" xref="S2.SS3.p1.20.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.20.m14.1c">\hat{s}_{i}</annotation></semantics></math> for each N-best hypothesis <math id="S2.SS3.p1.21.m15.3" class="ltx_Math" alttext="\{\hat{s}_{1},...,\hat{s}_{N}\}" display="inline"><semantics id="S2.SS3.p1.21.m15.3a"><mrow id="S2.SS3.p1.21.m15.3.3.2" xref="S2.SS3.p1.21.m15.3.3.3.cmml"><mo stretchy="false" id="S2.SS3.p1.21.m15.3.3.2.3" xref="S2.SS3.p1.21.m15.3.3.3.cmml">{</mo><msub id="S2.SS3.p1.21.m15.2.2.1.1" xref="S2.SS3.p1.21.m15.2.2.1.1.cmml"><mover accent="true" id="S2.SS3.p1.21.m15.2.2.1.1.2" xref="S2.SS3.p1.21.m15.2.2.1.1.2.cmml"><mi id="S2.SS3.p1.21.m15.2.2.1.1.2.2" xref="S2.SS3.p1.21.m15.2.2.1.1.2.2.cmml">s</mi><mo id="S2.SS3.p1.21.m15.2.2.1.1.2.1" xref="S2.SS3.p1.21.m15.2.2.1.1.2.1.cmml">^</mo></mover><mn id="S2.SS3.p1.21.m15.2.2.1.1.3" xref="S2.SS3.p1.21.m15.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p1.21.m15.3.3.2.4" xref="S2.SS3.p1.21.m15.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS3.p1.21.m15.1.1" xref="S2.SS3.p1.21.m15.1.1.cmml">…</mi><mo id="S2.SS3.p1.21.m15.3.3.2.5" xref="S2.SS3.p1.21.m15.3.3.3.cmml">,</mo><msub id="S2.SS3.p1.21.m15.3.3.2.2" xref="S2.SS3.p1.21.m15.3.3.2.2.cmml"><mover accent="true" id="S2.SS3.p1.21.m15.3.3.2.2.2" xref="S2.SS3.p1.21.m15.3.3.2.2.2.cmml"><mi id="S2.SS3.p1.21.m15.3.3.2.2.2.2" xref="S2.SS3.p1.21.m15.3.3.2.2.2.2.cmml">s</mi><mo id="S2.SS3.p1.21.m15.3.3.2.2.2.1" xref="S2.SS3.p1.21.m15.3.3.2.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.p1.21.m15.3.3.2.2.3" xref="S2.SS3.p1.21.m15.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.SS3.p1.21.m15.3.3.2.6" xref="S2.SS3.p1.21.m15.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.21.m15.3b"><set id="S2.SS3.p1.21.m15.3.3.3.cmml" xref="S2.SS3.p1.21.m15.3.3.2"><apply id="S2.SS3.p1.21.m15.2.2.1.1.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.21.m15.2.2.1.1.1.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1">subscript</csymbol><apply id="S2.SS3.p1.21.m15.2.2.1.1.2.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1.2"><ci id="S2.SS3.p1.21.m15.2.2.1.1.2.1.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1.2.1">^</ci><ci id="S2.SS3.p1.21.m15.2.2.1.1.2.2.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1.2.2">𝑠</ci></apply><cn type="integer" id="S2.SS3.p1.21.m15.2.2.1.1.3.cmml" xref="S2.SS3.p1.21.m15.2.2.1.1.3">1</cn></apply><ci id="S2.SS3.p1.21.m15.1.1.cmml" xref="S2.SS3.p1.21.m15.1.1">…</ci><apply id="S2.SS3.p1.21.m15.3.3.2.2.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.21.m15.3.3.2.2.1.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2">subscript</csymbol><apply id="S2.SS3.p1.21.m15.3.3.2.2.2.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2.2"><ci id="S2.SS3.p1.21.m15.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2.2.1">^</ci><ci id="S2.SS3.p1.21.m15.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2.2.2">𝑠</ci></apply><ci id="S2.SS3.p1.21.m15.3.3.2.2.3.cmml" xref="S2.SS3.p1.21.m15.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.21.m15.3c">\{\hat{s}_{1},...,\hat{s}_{N}\}</annotation></semantics></math> can be computed using <math id="S2.SS3.p1.22.m16.1" class="ltx_Math" alttext="dot(\cdot)" display="inline"><semantics id="S2.SS3.p1.22.m16.1a"><mrow id="S2.SS3.p1.22.m16.1.2" xref="S2.SS3.p1.22.m16.1.2.cmml"><mi id="S2.SS3.p1.22.m16.1.2.2" xref="S2.SS3.p1.22.m16.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.22.m16.1.2.1" xref="S2.SS3.p1.22.m16.1.2.1.cmml">​</mo><mi id="S2.SS3.p1.22.m16.1.2.3" xref="S2.SS3.p1.22.m16.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.22.m16.1.2.1a" xref="S2.SS3.p1.22.m16.1.2.1.cmml">​</mo><mi id="S2.SS3.p1.22.m16.1.2.4" xref="S2.SS3.p1.22.m16.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.22.m16.1.2.1b" xref="S2.SS3.p1.22.m16.1.2.1.cmml">​</mo><mrow id="S2.SS3.p1.22.m16.1.2.5.2" xref="S2.SS3.p1.22.m16.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.22.m16.1.2.5.2.1" xref="S2.SS3.p1.22.m16.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p1.22.m16.1.1" xref="S2.SS3.p1.22.m16.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS3.p1.22.m16.1.2.5.2.2" xref="S2.SS3.p1.22.m16.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.22.m16.1b"><apply id="S2.SS3.p1.22.m16.1.2.cmml" xref="S2.SS3.p1.22.m16.1.2"><times id="S2.SS3.p1.22.m16.1.2.1.cmml" xref="S2.SS3.p1.22.m16.1.2.1"></times><ci id="S2.SS3.p1.22.m16.1.2.2.cmml" xref="S2.SS3.p1.22.m16.1.2.2">𝑑</ci><ci id="S2.SS3.p1.22.m16.1.2.3.cmml" xref="S2.SS3.p1.22.m16.1.2.3">𝑜</ci><ci id="S2.SS3.p1.22.m16.1.2.4.cmml" xref="S2.SS3.p1.22.m16.1.2.4">𝑡</ci><ci id="S2.SS3.p1.22.m16.1.1.cmml" xref="S2.SS3.p1.22.m16.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.22.m16.1c">dot(\cdot)</annotation></semantics></math> products and <span id="S2.SS3.p1.23.3" class="ltx_text ltx_font_italic">sigmoid</span> function <math id="S2.SS3.p1.23.m17.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S2.SS3.p1.23.m17.1a"><mi id="S2.SS3.p1.23.m17.1.1" xref="S2.SS3.p1.23.m17.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.23.m17.1b"><ci id="S2.SS3.p1.23.m17.1.1.cmml" xref="S2.SS3.p1.23.m17.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.23.m17.1c">\sigma</annotation></semantics></math> by:</p>
<table id="S2.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex3.m1.5" class="ltx_Math" alttext="\hat{s}_{i}=\sigma\left(\sum_{l}(H^{t})_{l,\cdot}\cdot\sum_{l}\left(A^{w}_{n_{i}}\right)_{l,\cdot}\right)." display="block"><semantics id="S2.Ex3.m1.5a"><mrow id="S2.Ex3.m1.5.5.1" xref="S2.Ex3.m1.5.5.1.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1" xref="S2.Ex3.m1.5.5.1.1.cmml"><msub id="S2.Ex3.m1.5.5.1.1.3" xref="S2.Ex3.m1.5.5.1.1.3.cmml"><mover accent="true" id="S2.Ex3.m1.5.5.1.1.3.2" xref="S2.Ex3.m1.5.5.1.1.3.2.cmml"><mi id="S2.Ex3.m1.5.5.1.1.3.2.2" xref="S2.Ex3.m1.5.5.1.1.3.2.2.cmml">s</mi><mo id="S2.Ex3.m1.5.5.1.1.3.2.1" xref="S2.Ex3.m1.5.5.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.Ex3.m1.5.5.1.1.3.3" xref="S2.Ex3.m1.5.5.1.1.3.3.cmml">i</mi></msub><mo id="S2.Ex3.m1.5.5.1.1.2" xref="S2.Ex3.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.Ex3.m1.5.5.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.cmml"><mi id="S2.Ex3.m1.5.5.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.5.5.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.cmml"><munder id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.3.cmml">l</mi></munder><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.cmml"><msub id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">H</mi><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo rspace="0.055em" stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S2.Ex3.m1.2.2.2.4" xref="S2.Ex3.m1.2.2.2.3.cmml"><mi id="S2.Ex3.m1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.cmml">l</mi><mo rspace="0em" id="S2.Ex3.m1.2.2.2.4.1" xref="S2.Ex3.m1.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S2.Ex3.m1.2.2.2.2" xref="S2.Ex3.m1.2.2.2.2.cmml">⋅</mo></mrow></msub><mo rspace="0.055em" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.3.cmml">⋅</mo><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.cmml"><munder id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">l</mi></munder><msub id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><msubsup id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">A</mi><msub id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">n</mi><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mi id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml">w</mi></msubsup><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S2.Ex3.m1.4.4.2.4" xref="S2.Ex3.m1.4.4.2.3.cmml"><mi id="S2.Ex3.m1.3.3.1.1" xref="S2.Ex3.m1.3.3.1.1.cmml">l</mi><mo rspace="0em" id="S2.Ex3.m1.4.4.2.4.1" xref="S2.Ex3.m1.4.4.2.3.cmml">,</mo><mo lspace="0em" id="S2.Ex3.m1.4.4.2.2" xref="S2.Ex3.m1.4.4.2.2.cmml">⋅</mo></mrow></msub></mrow></mrow></mrow><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex3.m1.5.5.1.2" xref="S2.Ex3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.5b"><apply id="S2.Ex3.m1.5.5.1.1.cmml" xref="S2.Ex3.m1.5.5.1"><eq id="S2.Ex3.m1.5.5.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2"></eq><apply id="S2.Ex3.m1.5.5.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.3.1.cmml" xref="S2.Ex3.m1.5.5.1.1.3">subscript</csymbol><apply id="S2.Ex3.m1.5.5.1.1.3.2.cmml" xref="S2.Ex3.m1.5.5.1.1.3.2"><ci id="S2.Ex3.m1.5.5.1.1.3.2.1.cmml" xref="S2.Ex3.m1.5.5.1.1.3.2.1">^</ci><ci id="S2.Ex3.m1.5.5.1.1.3.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.3.2.2">𝑠</ci></apply><ci id="S2.Ex3.m1.5.5.1.1.3.3.cmml" xref="S2.Ex3.m1.5.5.1.1.3.3">𝑖</ci></apply><apply id="S2.Ex3.m1.5.5.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1"><times id="S2.Ex3.m1.5.5.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.2"></times><ci id="S2.Ex3.m1.5.5.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.3">𝜎</ci><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1"><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><sum id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.2"></sum><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2"><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.3">⋅</ci><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝐻</ci><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><list id="S2.Ex3.m1.2.2.2.3.cmml" xref="S2.Ex3.m1.2.2.2.4"><ci id="S2.Ex3.m1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1">𝑙</ci><ci id="S2.Ex3.m1.2.2.2.2.cmml" xref="S2.Ex3.m1.2.2.2.2">⋅</ci></list></apply><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2"><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2">subscript</csymbol><sum id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.2"></sum><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1">subscript</csymbol><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1">subscript</csymbol><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1">superscript</csymbol><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.2">𝐴</ci><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.2.3">𝑤</ci></apply><apply id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.2">𝑛</ci><ci id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply><list id="S2.Ex3.m1.4.4.2.3.cmml" xref="S2.Ex3.m1.4.4.2.4"><ci id="S2.Ex3.m1.3.3.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1">𝑙</ci><ci id="S2.Ex3.m1.4.4.2.2.cmml" xref="S2.Ex3.m1.4.4.2.2">⋅</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.5c">\hat{s}_{i}=\sigma\left(\sum_{l}(H^{t})_{l,\cdot}\cdot\sum_{l}\left(A^{w}_{n_{i}}\right)_{l,\cdot}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Matching Query Similarity Distribution (MQSD) Loss</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">We propose an alternative to the MWER loss function that can work well with cross-entropy (CE) based training for models to perform both rescore and rewrite tasks.
The <span id="S2.SS4.p1.1.1" class="ltx_text ltx_font_italic">Matching Query Similarity Distribution</span> (MQSD) loss is the cross-entropy loss of predicted scores over N-best hypotheses, denoted by <math id="S2.SS4.p1.1.m1.2" class="ltx_Math" alttext="L_{MQSD}(x,y^{*})" display="inline"><semantics id="S2.SS4.p1.1.m1.2a"><mrow id="S2.SS4.p1.1.m1.2.2" xref="S2.SS4.p1.1.m1.2.2.cmml"><msub id="S2.SS4.p1.1.m1.2.2.3" xref="S2.SS4.p1.1.m1.2.2.3.cmml"><mi id="S2.SS4.p1.1.m1.2.2.3.2" xref="S2.SS4.p1.1.m1.2.2.3.2.cmml">L</mi><mrow id="S2.SS4.p1.1.m1.2.2.3.3" xref="S2.SS4.p1.1.m1.2.2.3.3.cmml"><mi id="S2.SS4.p1.1.m1.2.2.3.3.2" xref="S2.SS4.p1.1.m1.2.2.3.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.2.2.3.3.1" xref="S2.SS4.p1.1.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.SS4.p1.1.m1.2.2.3.3.3" xref="S2.SS4.p1.1.m1.2.2.3.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.2.2.3.3.1a" xref="S2.SS4.p1.1.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.SS4.p1.1.m1.2.2.3.3.4" xref="S2.SS4.p1.1.m1.2.2.3.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.2.2.3.3.1b" xref="S2.SS4.p1.1.m1.2.2.3.3.1.cmml">​</mo><mi id="S2.SS4.p1.1.m1.2.2.3.3.5" xref="S2.SS4.p1.1.m1.2.2.3.3.5.cmml">D</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.2.2.2" xref="S2.SS4.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S2.SS4.p1.1.m1.2.2.1.1" xref="S2.SS4.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS4.p1.1.m1.2.2.1.1.2" xref="S2.SS4.p1.1.m1.2.2.1.2.cmml">(</mo><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">x</mi><mo id="S2.SS4.p1.1.m1.2.2.1.1.3" xref="S2.SS4.p1.1.m1.2.2.1.2.cmml">,</mo><msup id="S2.SS4.p1.1.m1.2.2.1.1.1" xref="S2.SS4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.2.2.1.1.1.2" xref="S2.SS4.p1.1.m1.2.2.1.1.1.2.cmml">y</mi><mo id="S2.SS4.p1.1.m1.2.2.1.1.1.3" xref="S2.SS4.p1.1.m1.2.2.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.SS4.p1.1.m1.2.2.1.1.4" xref="S2.SS4.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.2b"><apply id="S2.SS4.p1.1.m1.2.2.cmml" xref="S2.SS4.p1.1.m1.2.2"><times id="S2.SS4.p1.1.m1.2.2.2.cmml" xref="S2.SS4.p1.1.m1.2.2.2"></times><apply id="S2.SS4.p1.1.m1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.2.2.3.1.cmml" xref="S2.SS4.p1.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS4.p1.1.m1.2.2.3.2.cmml" xref="S2.SS4.p1.1.m1.2.2.3.2">𝐿</ci><apply id="S2.SS4.p1.1.m1.2.2.3.3.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3"><times id="S2.SS4.p1.1.m1.2.2.3.3.1.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3.1"></times><ci id="S2.SS4.p1.1.m1.2.2.3.3.2.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3.2">𝑀</ci><ci id="S2.SS4.p1.1.m1.2.2.3.3.3.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3.3">𝑄</ci><ci id="S2.SS4.p1.1.m1.2.2.3.3.4.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3.4">𝑆</ci><ci id="S2.SS4.p1.1.m1.2.2.3.3.5.cmml" xref="S2.SS4.p1.1.m1.2.2.3.3.5">𝐷</ci></apply></apply><interval closure="open" id="S2.SS4.p1.1.m1.2.2.1.2.cmml" xref="S2.SS4.p1.1.m1.2.2.1.1"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝑥</ci><apply id="S2.SS4.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS4.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.2.2.1.1.1.2">𝑦</ci><times id="S2.SS4.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.2.2.1.1.1.3"></times></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.2c">L_{MQSD}(x,y^{*})</annotation></semantics></math> as:</p>
<table id="S2.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex4.m1.4" class="ltx_Math" alttext="-\sum\limits_{y_{i}\in B(x,N)}\left(\text{Softmax}\left(s_{i}\right)\cdot\log\left(\text{Softmax}\left(\hat{s}_{i}\right)\right)\right)" display="block"><semantics id="S2.Ex4.m1.4a"><mrow id="S2.Ex4.m1.4.4" xref="S2.Ex4.m1.4.4.cmml"><mo id="S2.Ex4.m1.4.4a" xref="S2.Ex4.m1.4.4.cmml">−</mo><mrow id="S2.Ex4.m1.4.4.1" xref="S2.Ex4.m1.4.4.1.cmml"><munder id="S2.Ex4.m1.4.4.1.2" xref="S2.Ex4.m1.4.4.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.Ex4.m1.4.4.1.2.2" xref="S2.Ex4.m1.4.4.1.2.2.cmml">∑</mo><mrow id="S2.Ex4.m1.2.2.2" xref="S2.Ex4.m1.2.2.2.cmml"><msub id="S2.Ex4.m1.2.2.2.4" xref="S2.Ex4.m1.2.2.2.4.cmml"><mi id="S2.Ex4.m1.2.2.2.4.2" xref="S2.Ex4.m1.2.2.2.4.2.cmml">y</mi><mi id="S2.Ex4.m1.2.2.2.4.3" xref="S2.Ex4.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="S2.Ex4.m1.2.2.2.3" xref="S2.Ex4.m1.2.2.2.3.cmml">∈</mo><mrow id="S2.Ex4.m1.2.2.2.5" xref="S2.Ex4.m1.2.2.2.5.cmml"><mi id="S2.Ex4.m1.2.2.2.5.2" xref="S2.Ex4.m1.2.2.2.5.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.2.2.2.5.1" xref="S2.Ex4.m1.2.2.2.5.1.cmml">​</mo><mrow id="S2.Ex4.m1.2.2.2.5.3.2" xref="S2.Ex4.m1.2.2.2.5.3.1.cmml"><mo stretchy="false" id="S2.Ex4.m1.2.2.2.5.3.2.1" xref="S2.Ex4.m1.2.2.2.5.3.1.cmml">(</mo><mi id="S2.Ex4.m1.1.1.1.1" xref="S2.Ex4.m1.1.1.1.1.cmml">x</mi><mo id="S2.Ex4.m1.2.2.2.5.3.2.2" xref="S2.Ex4.m1.2.2.2.5.3.1.cmml">,</mo><mi id="S2.Ex4.m1.2.2.2.2" xref="S2.Ex4.m1.2.2.2.2.cmml">N</mi><mo stretchy="false" id="S2.Ex4.m1.2.2.2.5.3.2.3" xref="S2.Ex4.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S2.Ex4.m1.4.4.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.cmml"><mo id="S2.Ex4.m1.4.4.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.cmml"><mrow id="S2.Ex4.m1.4.4.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.cmml"><mtext id="S2.Ex4.m1.4.4.1.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.4.4.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S2.Ex4.m1.4.4.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.3.cmml">⋅</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.2.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml"><mi id="S2.Ex4.m1.3.3" xref="S2.Ex4.m1.3.3.cmml">log</mi><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1a" xref="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml"><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml">(</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.cmml"><mtext id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.1" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex4.m1.4.4.1.1.1.3" xref="S2.Ex4.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.4b"><apply id="S2.Ex4.m1.4.4.cmml" xref="S2.Ex4.m1.4.4"><minus id="S2.Ex4.m1.4.4.2.cmml" xref="S2.Ex4.m1.4.4"></minus><apply id="S2.Ex4.m1.4.4.1.cmml" xref="S2.Ex4.m1.4.4.1"><apply id="S2.Ex4.m1.4.4.1.2.cmml" xref="S2.Ex4.m1.4.4.1.2"><csymbol cd="ambiguous" id="S2.Ex4.m1.4.4.1.2.1.cmml" xref="S2.Ex4.m1.4.4.1.2">subscript</csymbol><sum id="S2.Ex4.m1.4.4.1.2.2.cmml" xref="S2.Ex4.m1.4.4.1.2.2"></sum><apply id="S2.Ex4.m1.2.2.2.cmml" xref="S2.Ex4.m1.2.2.2"><in id="S2.Ex4.m1.2.2.2.3.cmml" xref="S2.Ex4.m1.2.2.2.3"></in><apply id="S2.Ex4.m1.2.2.2.4.cmml" xref="S2.Ex4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.2.4.1.cmml" xref="S2.Ex4.m1.2.2.2.4">subscript</csymbol><ci id="S2.Ex4.m1.2.2.2.4.2.cmml" xref="S2.Ex4.m1.2.2.2.4.2">𝑦</ci><ci id="S2.Ex4.m1.2.2.2.4.3.cmml" xref="S2.Ex4.m1.2.2.2.4.3">𝑖</ci></apply><apply id="S2.Ex4.m1.2.2.2.5.cmml" xref="S2.Ex4.m1.2.2.2.5"><times id="S2.Ex4.m1.2.2.2.5.1.cmml" xref="S2.Ex4.m1.2.2.2.5.1"></times><ci id="S2.Ex4.m1.2.2.2.5.2.cmml" xref="S2.Ex4.m1.2.2.2.5.2">𝐵</ci><interval closure="open" id="S2.Ex4.m1.2.2.2.5.3.1.cmml" xref="S2.Ex4.m1.2.2.2.5.3.2"><ci id="S2.Ex4.m1.1.1.1.1.cmml" xref="S2.Ex4.m1.1.1.1.1">𝑥</ci><ci id="S2.Ex4.m1.2.2.2.2.cmml" xref="S2.Ex4.m1.2.2.2.2">𝑁</ci></interval></apply></apply></apply><apply id="S2.Ex4.m1.4.4.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1"><ci id="S2.Ex4.m1.4.4.1.1.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.3">⋅</ci><apply id="S2.Ex4.m1.4.4.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1"><times id="S2.Ex4.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.2"></times><ci id="S2.Ex4.m1.4.4.1.1.1.1.1.3a.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3"><mtext id="S2.Ex4.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.Ex4.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1"><log id="S2.Ex4.m1.3.3.cmml" xref="S2.Ex4.m1.3.3"></log><apply id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1"><times id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.2"></times><ci id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3a.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3"><mtext id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.3">Softmax</mtext></ci><apply id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2"><ci id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.1">^</ci><ci id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.4c">-\sum\limits_{y_{i}\in B(x,N)}\left(\text{Softmax}\left(s_{i}\right)\cdot\log\left(\text{Softmax}\left(\hat{s}_{i}\right)\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS4.p1.10" class="ltx_p">where <math id="S2.SS4.p1.2.m1.5" class="ltx_Math" alttext="B(x,N)=\{y_{1},...,y_{N}\}" display="inline"><semantics id="S2.SS4.p1.2.m1.5a"><mrow id="S2.SS4.p1.2.m1.5.5" xref="S2.SS4.p1.2.m1.5.5.cmml"><mrow id="S2.SS4.p1.2.m1.5.5.4" xref="S2.SS4.p1.2.m1.5.5.4.cmml"><mi id="S2.SS4.p1.2.m1.5.5.4.2" xref="S2.SS4.p1.2.m1.5.5.4.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.2.m1.5.5.4.1" xref="S2.SS4.p1.2.m1.5.5.4.1.cmml">​</mo><mrow id="S2.SS4.p1.2.m1.5.5.4.3.2" xref="S2.SS4.p1.2.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="S2.SS4.p1.2.m1.5.5.4.3.2.1" xref="S2.SS4.p1.2.m1.5.5.4.3.1.cmml">(</mo><mi id="S2.SS4.p1.2.m1.1.1" xref="S2.SS4.p1.2.m1.1.1.cmml">x</mi><mo id="S2.SS4.p1.2.m1.5.5.4.3.2.2" xref="S2.SS4.p1.2.m1.5.5.4.3.1.cmml">,</mo><mi id="S2.SS4.p1.2.m1.2.2" xref="S2.SS4.p1.2.m1.2.2.cmml">N</mi><mo stretchy="false" id="S2.SS4.p1.2.m1.5.5.4.3.2.3" xref="S2.SS4.p1.2.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p1.2.m1.5.5.3" xref="S2.SS4.p1.2.m1.5.5.3.cmml">=</mo><mrow id="S2.SS4.p1.2.m1.5.5.2.2" xref="S2.SS4.p1.2.m1.5.5.2.3.cmml"><mo stretchy="false" id="S2.SS4.p1.2.m1.5.5.2.2.3" xref="S2.SS4.p1.2.m1.5.5.2.3.cmml">{</mo><msub id="S2.SS4.p1.2.m1.4.4.1.1.1" xref="S2.SS4.p1.2.m1.4.4.1.1.1.cmml"><mi id="S2.SS4.p1.2.m1.4.4.1.1.1.2" xref="S2.SS4.p1.2.m1.4.4.1.1.1.2.cmml">y</mi><mn id="S2.SS4.p1.2.m1.4.4.1.1.1.3" xref="S2.SS4.p1.2.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS4.p1.2.m1.5.5.2.2.4" xref="S2.SS4.p1.2.m1.5.5.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS4.p1.2.m1.3.3" xref="S2.SS4.p1.2.m1.3.3.cmml">…</mi><mo id="S2.SS4.p1.2.m1.5.5.2.2.5" xref="S2.SS4.p1.2.m1.5.5.2.3.cmml">,</mo><msub id="S2.SS4.p1.2.m1.5.5.2.2.2" xref="S2.SS4.p1.2.m1.5.5.2.2.2.cmml"><mi id="S2.SS4.p1.2.m1.5.5.2.2.2.2" xref="S2.SS4.p1.2.m1.5.5.2.2.2.2.cmml">y</mi><mi id="S2.SS4.p1.2.m1.5.5.2.2.2.3" xref="S2.SS4.p1.2.m1.5.5.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.SS4.p1.2.m1.5.5.2.2.6" xref="S2.SS4.p1.2.m1.5.5.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m1.5b"><apply id="S2.SS4.p1.2.m1.5.5.cmml" xref="S2.SS4.p1.2.m1.5.5"><eq id="S2.SS4.p1.2.m1.5.5.3.cmml" xref="S2.SS4.p1.2.m1.5.5.3"></eq><apply id="S2.SS4.p1.2.m1.5.5.4.cmml" xref="S2.SS4.p1.2.m1.5.5.4"><times id="S2.SS4.p1.2.m1.5.5.4.1.cmml" xref="S2.SS4.p1.2.m1.5.5.4.1"></times><ci id="S2.SS4.p1.2.m1.5.5.4.2.cmml" xref="S2.SS4.p1.2.m1.5.5.4.2">𝐵</ci><interval closure="open" id="S2.SS4.p1.2.m1.5.5.4.3.1.cmml" xref="S2.SS4.p1.2.m1.5.5.4.3.2"><ci id="S2.SS4.p1.2.m1.1.1.cmml" xref="S2.SS4.p1.2.m1.1.1">𝑥</ci><ci id="S2.SS4.p1.2.m1.2.2.cmml" xref="S2.SS4.p1.2.m1.2.2">𝑁</ci></interval></apply><set id="S2.SS4.p1.2.m1.5.5.2.3.cmml" xref="S2.SS4.p1.2.m1.5.5.2.2"><apply id="S2.SS4.p1.2.m1.4.4.1.1.1.cmml" xref="S2.SS4.p1.2.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m1.4.4.1.1.1.1.cmml" xref="S2.SS4.p1.2.m1.4.4.1.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m1.4.4.1.1.1.2.cmml" xref="S2.SS4.p1.2.m1.4.4.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS4.p1.2.m1.4.4.1.1.1.3.cmml" xref="S2.SS4.p1.2.m1.4.4.1.1.1.3">1</cn></apply><ci id="S2.SS4.p1.2.m1.3.3.cmml" xref="S2.SS4.p1.2.m1.3.3">…</ci><apply id="S2.SS4.p1.2.m1.5.5.2.2.2.cmml" xref="S2.SS4.p1.2.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m1.5.5.2.2.2.1.cmml" xref="S2.SS4.p1.2.m1.5.5.2.2.2">subscript</csymbol><ci id="S2.SS4.p1.2.m1.5.5.2.2.2.2.cmml" xref="S2.SS4.p1.2.m1.5.5.2.2.2.2">𝑦</ci><ci id="S2.SS4.p1.2.m1.5.5.2.2.2.3.cmml" xref="S2.SS4.p1.2.m1.5.5.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m1.5c">B(x,N)=\{y_{1},...,y_{N}\}</annotation></semantics></math> is the set of N-best hypotheses for the input query <math id="S2.SS4.p1.3.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS4.p1.3.m2.1a"><mi id="S2.SS4.p1.3.m2.1.1" xref="S2.SS4.p1.3.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m2.1b"><ci id="S2.SS4.p1.3.m2.1.1.cmml" xref="S2.SS4.p1.3.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m2.1c">x</annotation></semantics></math>; <math id="S2.SS4.p1.4.m3.1" class="ltx_Math" alttext="s_{i}=(1-wer(y_{i},y^{*}))^{2}" display="inline"><semantics id="S2.SS4.p1.4.m3.1a"><mrow id="S2.SS4.p1.4.m3.1.1" xref="S2.SS4.p1.4.m3.1.1.cmml"><msub id="S2.SS4.p1.4.m3.1.1.3" xref="S2.SS4.p1.4.m3.1.1.3.cmml"><mi id="S2.SS4.p1.4.m3.1.1.3.2" xref="S2.SS4.p1.4.m3.1.1.3.2.cmml">s</mi><mi id="S2.SS4.p1.4.m3.1.1.3.3" xref="S2.SS4.p1.4.m3.1.1.3.3.cmml">i</mi></msub><mo id="S2.SS4.p1.4.m3.1.1.2" xref="S2.SS4.p1.4.m3.1.1.2.cmml">=</mo><msup id="S2.SS4.p1.4.m3.1.1.1" xref="S2.SS4.p1.4.m3.1.1.1.cmml"><mrow id="S2.SS4.p1.4.m3.1.1.1.1.1" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.4.m3.1.1.1.1.1.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p1.4.m3.1.1.1.1.1.1" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.cmml"><mn id="S2.SS4.p1.4.m3.1.1.1.1.1.1.4" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.4.cmml">1</mn><mo id="S2.SS4.p1.4.m3.1.1.1.1.1.1.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.cmml"><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.4" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3.cmml">​</mo><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.5" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3a" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3.cmml">​</mo><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.6" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3b" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.4" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.2" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mo id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.5" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.SS4.p1.4.m3.1.1.1.1.1.3" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS4.p1.4.m3.1.1.1.3" xref="S2.SS4.p1.4.m3.1.1.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m3.1b"><apply id="S2.SS4.p1.4.m3.1.1.cmml" xref="S2.SS4.p1.4.m3.1.1"><eq id="S2.SS4.p1.4.m3.1.1.2.cmml" xref="S2.SS4.p1.4.m3.1.1.2"></eq><apply id="S2.SS4.p1.4.m3.1.1.3.cmml" xref="S2.SS4.p1.4.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m3.1.1.3.1.cmml" xref="S2.SS4.p1.4.m3.1.1.3">subscript</csymbol><ci id="S2.SS4.p1.4.m3.1.1.3.2.cmml" xref="S2.SS4.p1.4.m3.1.1.3.2">𝑠</ci><ci id="S2.SS4.p1.4.m3.1.1.3.3.cmml" xref="S2.SS4.p1.4.m3.1.1.3.3">𝑖</ci></apply><apply id="S2.SS4.p1.4.m3.1.1.1.cmml" xref="S2.SS4.p1.4.m3.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m3.1.1.1.2.cmml" xref="S2.SS4.p1.4.m3.1.1.1">superscript</csymbol><apply id="S2.SS4.p1.4.m3.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1"><minus id="S2.SS4.p1.4.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.3"></minus><cn type="integer" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.4.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.4">1</cn><apply id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2"><times id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.3"></times><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.4.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.4">𝑤</ci><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.5.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.5">𝑒</ci><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.6.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.6">𝑟</ci><interval closure="open" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2"><apply id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><times id="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.1.1.1.2.2.2.2.3"></times></apply></interval></apply></apply><cn type="integer" id="S2.SS4.p1.4.m3.1.1.1.3.cmml" xref="S2.SS4.p1.4.m3.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m3.1c">s_{i}=(1-wer(y_{i},y^{*}))^{2}</annotation></semantics></math> is the <span id="S2.SS4.p1.10.1" class="ltx_text ltx_font_italic">query similarity score</span> for hypothesis <math id="S2.SS4.p1.5.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS4.p1.5.m4.1a"><msub id="S2.SS4.p1.5.m4.1.1" xref="S2.SS4.p1.5.m4.1.1.cmml"><mi id="S2.SS4.p1.5.m4.1.1.2" xref="S2.SS4.p1.5.m4.1.1.2.cmml">y</mi><mi id="S2.SS4.p1.5.m4.1.1.3" xref="S2.SS4.p1.5.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m4.1b"><apply id="S2.SS4.p1.5.m4.1.1.cmml" xref="S2.SS4.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.5.m4.1.1.1.cmml" xref="S2.SS4.p1.5.m4.1.1">subscript</csymbol><ci id="S2.SS4.p1.5.m4.1.1.2.cmml" xref="S2.SS4.p1.5.m4.1.1.2">𝑦</ci><ci id="S2.SS4.p1.5.m4.1.1.3.cmml" xref="S2.SS4.p1.5.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m4.1c">y_{i}</annotation></semantics></math>, <math id="S2.SS4.p1.6.m5.2" class="ltx_Math" alttext="wer(y_{i},y^{*})" display="inline"><semantics id="S2.SS4.p1.6.m5.2a"><mrow id="S2.SS4.p1.6.m5.2.2" xref="S2.SS4.p1.6.m5.2.2.cmml"><mi id="S2.SS4.p1.6.m5.2.2.4" xref="S2.SS4.p1.6.m5.2.2.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.6.m5.2.2.3" xref="S2.SS4.p1.6.m5.2.2.3.cmml">​</mo><mi id="S2.SS4.p1.6.m5.2.2.5" xref="S2.SS4.p1.6.m5.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.6.m5.2.2.3a" xref="S2.SS4.p1.6.m5.2.2.3.cmml">​</mo><mi id="S2.SS4.p1.6.m5.2.2.6" xref="S2.SS4.p1.6.m5.2.2.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.6.m5.2.2.3b" xref="S2.SS4.p1.6.m5.2.2.3.cmml">​</mo><mrow id="S2.SS4.p1.6.m5.2.2.2.2" xref="S2.SS4.p1.6.m5.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS4.p1.6.m5.2.2.2.2.3" xref="S2.SS4.p1.6.m5.2.2.2.3.cmml">(</mo><msub id="S2.SS4.p1.6.m5.1.1.1.1.1" xref="S2.SS4.p1.6.m5.1.1.1.1.1.cmml"><mi id="S2.SS4.p1.6.m5.1.1.1.1.1.2" xref="S2.SS4.p1.6.m5.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS4.p1.6.m5.1.1.1.1.1.3" xref="S2.SS4.p1.6.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.p1.6.m5.2.2.2.2.4" xref="S2.SS4.p1.6.m5.2.2.2.3.cmml">,</mo><msup id="S2.SS4.p1.6.m5.2.2.2.2.2" xref="S2.SS4.p1.6.m5.2.2.2.2.2.cmml"><mi id="S2.SS4.p1.6.m5.2.2.2.2.2.2" xref="S2.SS4.p1.6.m5.2.2.2.2.2.2.cmml">y</mi><mo id="S2.SS4.p1.6.m5.2.2.2.2.2.3" xref="S2.SS4.p1.6.m5.2.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.SS4.p1.6.m5.2.2.2.2.5" xref="S2.SS4.p1.6.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.6.m5.2b"><apply id="S2.SS4.p1.6.m5.2.2.cmml" xref="S2.SS4.p1.6.m5.2.2"><times id="S2.SS4.p1.6.m5.2.2.3.cmml" xref="S2.SS4.p1.6.m5.2.2.3"></times><ci id="S2.SS4.p1.6.m5.2.2.4.cmml" xref="S2.SS4.p1.6.m5.2.2.4">𝑤</ci><ci id="S2.SS4.p1.6.m5.2.2.5.cmml" xref="S2.SS4.p1.6.m5.2.2.5">𝑒</ci><ci id="S2.SS4.p1.6.m5.2.2.6.cmml" xref="S2.SS4.p1.6.m5.2.2.6">𝑟</ci><interval closure="open" id="S2.SS4.p1.6.m5.2.2.2.3.cmml" xref="S2.SS4.p1.6.m5.2.2.2.2"><apply id="S2.SS4.p1.6.m5.1.1.1.1.1.cmml" xref="S2.SS4.p1.6.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m5.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.6.m5.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p1.6.m5.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.6.m5.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS4.p1.6.m5.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.6.m5.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS4.p1.6.m5.2.2.2.2.2.cmml" xref="S2.SS4.p1.6.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m5.2.2.2.2.2.1.cmml" xref="S2.SS4.p1.6.m5.2.2.2.2.2">superscript</csymbol><ci id="S2.SS4.p1.6.m5.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.6.m5.2.2.2.2.2.2">𝑦</ci><times id="S2.SS4.p1.6.m5.2.2.2.2.2.3.cmml" xref="S2.SS4.p1.6.m5.2.2.2.2.2.3"></times></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.6.m5.2c">wer(y_{i},y^{*})</annotation></semantics></math> is the word error rate of hypothesis <math id="S2.SS4.p1.7.m6.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS4.p1.7.m6.1a"><msub id="S2.SS4.p1.7.m6.1.1" xref="S2.SS4.p1.7.m6.1.1.cmml"><mi id="S2.SS4.p1.7.m6.1.1.2" xref="S2.SS4.p1.7.m6.1.1.2.cmml">y</mi><mi id="S2.SS4.p1.7.m6.1.1.3" xref="S2.SS4.p1.7.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.7.m6.1b"><apply id="S2.SS4.p1.7.m6.1.1.cmml" xref="S2.SS4.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.7.m6.1.1.1.cmml" xref="S2.SS4.p1.7.m6.1.1">subscript</csymbol><ci id="S2.SS4.p1.7.m6.1.1.2.cmml" xref="S2.SS4.p1.7.m6.1.1.2">𝑦</ci><ci id="S2.SS4.p1.7.m6.1.1.3.cmml" xref="S2.SS4.p1.7.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.7.m6.1c">y_{i}</annotation></semantics></math> relative to the ground-truth sequence <math id="S2.SS4.p1.8.m7.1" class="ltx_Math" alttext="y^{*}" display="inline"><semantics id="S2.SS4.p1.8.m7.1a"><msup id="S2.SS4.p1.8.m7.1.1" xref="S2.SS4.p1.8.m7.1.1.cmml"><mi id="S2.SS4.p1.8.m7.1.1.2" xref="S2.SS4.p1.8.m7.1.1.2.cmml">y</mi><mo id="S2.SS4.p1.8.m7.1.1.3" xref="S2.SS4.p1.8.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.8.m7.1b"><apply id="S2.SS4.p1.8.m7.1.1.cmml" xref="S2.SS4.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.8.m7.1.1.1.cmml" xref="S2.SS4.p1.8.m7.1.1">superscript</csymbol><ci id="S2.SS4.p1.8.m7.1.1.2.cmml" xref="S2.SS4.p1.8.m7.1.1.2">𝑦</ci><times id="S2.SS4.p1.8.m7.1.1.3.cmml" xref="S2.SS4.p1.8.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.8.m7.1c">y^{*}</annotation></semantics></math>, capped at 1.0; <math id="S2.SS4.p1.9.m8.1" class="ltx_Math" alttext="\hat{s}_{i}" display="inline"><semantics id="S2.SS4.p1.9.m8.1a"><msub id="S2.SS4.p1.9.m8.1.1" xref="S2.SS4.p1.9.m8.1.1.cmml"><mover accent="true" id="S2.SS4.p1.9.m8.1.1.2" xref="S2.SS4.p1.9.m8.1.1.2.cmml"><mi id="S2.SS4.p1.9.m8.1.1.2.2" xref="S2.SS4.p1.9.m8.1.1.2.2.cmml">s</mi><mo id="S2.SS4.p1.9.m8.1.1.2.1" xref="S2.SS4.p1.9.m8.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS4.p1.9.m8.1.1.3" xref="S2.SS4.p1.9.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.9.m8.1b"><apply id="S2.SS4.p1.9.m8.1.1.cmml" xref="S2.SS4.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.9.m8.1.1.1.cmml" xref="S2.SS4.p1.9.m8.1.1">subscript</csymbol><apply id="S2.SS4.p1.9.m8.1.1.2.cmml" xref="S2.SS4.p1.9.m8.1.1.2"><ci id="S2.SS4.p1.9.m8.1.1.2.1.cmml" xref="S2.SS4.p1.9.m8.1.1.2.1">^</ci><ci id="S2.SS4.p1.9.m8.1.1.2.2.cmml" xref="S2.SS4.p1.9.m8.1.1.2.2">𝑠</ci></apply><ci id="S2.SS4.p1.9.m8.1.1.3.cmml" xref="S2.SS4.p1.9.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.9.m8.1c">\hat{s}_{i}</annotation></semantics></math> is the predicted query similarity score for hypothesis <math id="S2.SS4.p1.10.m9.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS4.p1.10.m9.1a"><msub id="S2.SS4.p1.10.m9.1.1" xref="S2.SS4.p1.10.m9.1.1.cmml"><mi id="S2.SS4.p1.10.m9.1.1.2" xref="S2.SS4.p1.10.m9.1.1.2.cmml">y</mi><mi id="S2.SS4.p1.10.m9.1.1.3" xref="S2.SS4.p1.10.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.10.m9.1b"><apply id="S2.SS4.p1.10.m9.1.1.cmml" xref="S2.SS4.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.10.m9.1.1.1.cmml" xref="S2.SS4.p1.10.m9.1.1">subscript</csymbol><ci id="S2.SS4.p1.10.m9.1.1.2.cmml" xref="S2.SS4.p1.10.m9.1.1.2">𝑦</ci><ci id="S2.SS4.p1.10.m9.1.1.3.cmml" xref="S2.SS4.p1.10.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.10.m9.1c">y_{i}</annotation></semantics></math>.
The <span id="S2.SS4.p1.10.2" class="ltx_text ltx_font_italic">query similarity score</span> is a similarity indicator between an N-best hypothesis and the target query. The score is in the range [0, 1], where higher score means higher similarity in edit distance and lower word error rate.
Our MQSD loss is different from MWER: The MWER training minimizes the expected word errors over the N-best hypotheses through normalized N-best probabilities, while the goal of MQSD loss is to mimic the N-best <span id="S2.SS4.p1.10.3" class="ltx_text ltx_font_italic">query similarity scores</span> distribution in the ground-truth through predicted scores.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.4" class="ltx_p">We train TRA model with a combined objective: minimizing the Transformer’s cross-entropy loss <math id="S2.SS4.p2.1.m1.1" class="ltx_Math" alttext="L_{ce}" display="inline"><semantics id="S2.SS4.p2.1.m1.1a"><msub id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">L</mi><mrow id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.1.m1.1.1.3.1" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS4.p2.1.m1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">𝐿</ci><apply id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3"><times id="S2.SS4.p2.1.m1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.3.1"></times><ci id="S2.SS4.p2.1.m1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.3.2">𝑐</ci><ci id="S2.SS4.p2.1.m1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">L_{ce}</annotation></semantics></math> for the target token sequence and the cross-entropy loss <math id="S2.SS4.p2.2.m2.1" class="ltx_Math" alttext="L_{MQSD}" display="inline"><semantics id="S2.SS4.p2.2.m2.1a"><msub id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml"><mi id="S2.SS4.p2.2.m2.1.1.2" xref="S2.SS4.p2.2.m2.1.1.2.cmml">L</mi><mrow id="S2.SS4.p2.2.m2.1.1.3" xref="S2.SS4.p2.2.m2.1.1.3.cmml"><mi id="S2.SS4.p2.2.m2.1.1.3.2" xref="S2.SS4.p2.2.m2.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.2.m2.1.1.3.1" xref="S2.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS4.p2.2.m2.1.1.3.3" xref="S2.SS4.p2.2.m2.1.1.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.2.m2.1.1.3.1a" xref="S2.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS4.p2.2.m2.1.1.3.4" xref="S2.SS4.p2.2.m2.1.1.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.2.m2.1.1.3.1b" xref="S2.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS4.p2.2.m2.1.1.3.5" xref="S2.SS4.p2.2.m2.1.1.3.5.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><apply id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.1.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p2.2.m2.1.1.2.cmml" xref="S2.SS4.p2.2.m2.1.1.2">𝐿</ci><apply id="S2.SS4.p2.2.m2.1.1.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3"><times id="S2.SS4.p2.2.m2.1.1.3.1.cmml" xref="S2.SS4.p2.2.m2.1.1.3.1"></times><ci id="S2.SS4.p2.2.m2.1.1.3.2.cmml" xref="S2.SS4.p2.2.m2.1.1.3.2">𝑀</ci><ci id="S2.SS4.p2.2.m2.1.1.3.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3.3">𝑄</ci><ci id="S2.SS4.p2.2.m2.1.1.3.4.cmml" xref="S2.SS4.p2.2.m2.1.1.3.4">𝑆</ci><ci id="S2.SS4.p2.2.m2.1.1.3.5.cmml" xref="S2.SS4.p2.2.m2.1.1.3.5">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">L_{MQSD}</annotation></semantics></math> for the N-best scores, with a hyper-parameter <math id="S2.SS4.p2.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS4.p2.3.m3.1a"><mi id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><ci id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">\lambda</annotation></semantics></math> for interpolation: <math id="S2.SS4.p2.4.m4.1" class="ltx_Math" alttext="L=L_{MQSD}+\lambda L_{ce}" display="inline"><semantics id="S2.SS4.p2.4.m4.1a"><mrow id="S2.SS4.p2.4.m4.1.1" xref="S2.SS4.p2.4.m4.1.1.cmml"><mi id="S2.SS4.p2.4.m4.1.1.2" xref="S2.SS4.p2.4.m4.1.1.2.cmml">L</mi><mo id="S2.SS4.p2.4.m4.1.1.1" xref="S2.SS4.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S2.SS4.p2.4.m4.1.1.3" xref="S2.SS4.p2.4.m4.1.1.3.cmml"><msub id="S2.SS4.p2.4.m4.1.1.3.2" xref="S2.SS4.p2.4.m4.1.1.3.2.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.2.2" xref="S2.SS4.p2.4.m4.1.1.3.2.2.cmml">L</mi><mrow id="S2.SS4.p2.4.m4.1.1.3.2.3" xref="S2.SS4.p2.4.m4.1.1.3.2.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.2.3.2" xref="S2.SS4.p2.4.m4.1.1.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.4.m4.1.1.3.2.3.1" xref="S2.SS4.p2.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS4.p2.4.m4.1.1.3.2.3.3" xref="S2.SS4.p2.4.m4.1.1.3.2.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.4.m4.1.1.3.2.3.1a" xref="S2.SS4.p2.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS4.p2.4.m4.1.1.3.2.3.4" xref="S2.SS4.p2.4.m4.1.1.3.2.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.4.m4.1.1.3.2.3.1b" xref="S2.SS4.p2.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS4.p2.4.m4.1.1.3.2.3.5" xref="S2.SS4.p2.4.m4.1.1.3.2.3.5.cmml">D</mi></mrow></msub><mo id="S2.SS4.p2.4.m4.1.1.3.1" xref="S2.SS4.p2.4.m4.1.1.3.1.cmml">+</mo><mrow id="S2.SS4.p2.4.m4.1.1.3.3" xref="S2.SS4.p2.4.m4.1.1.3.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.3.2" xref="S2.SS4.p2.4.m4.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.4.m4.1.1.3.3.1" xref="S2.SS4.p2.4.m4.1.1.3.3.1.cmml">​</mo><msub id="S2.SS4.p2.4.m4.1.1.3.3.3" xref="S2.SS4.p2.4.m4.1.1.3.3.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.3.3.2" xref="S2.SS4.p2.4.m4.1.1.3.3.3.2.cmml">L</mi><mrow id="S2.SS4.p2.4.m4.1.1.3.3.3.3" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.3.3.3.2" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.4.m4.1.1.3.3.3.3.1" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS4.p2.4.m4.1.1.3.3.3.3.3" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.1b"><apply id="S2.SS4.p2.4.m4.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1"><eq id="S2.SS4.p2.4.m4.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1"></eq><ci id="S2.SS4.p2.4.m4.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.2">𝐿</ci><apply id="S2.SS4.p2.4.m4.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3"><plus id="S2.SS4.p2.4.m4.1.1.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.1"></plus><apply id="S2.SS4.p2.4.m4.1.1.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.3.2.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS4.p2.4.m4.1.1.3.2.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.2">𝐿</ci><apply id="S2.SS4.p2.4.m4.1.1.3.2.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3"><times id="S2.SS4.p2.4.m4.1.1.3.2.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3.1"></times><ci id="S2.SS4.p2.4.m4.1.1.3.2.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3.2">𝑀</ci><ci id="S2.SS4.p2.4.m4.1.1.3.2.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3.3">𝑄</ci><ci id="S2.SS4.p2.4.m4.1.1.3.2.3.4.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3.4">𝑆</ci><ci id="S2.SS4.p2.4.m4.1.1.3.2.3.5.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2.3.5">𝐷</ci></apply></apply><apply id="S2.SS4.p2.4.m4.1.1.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3"><times id="S2.SS4.p2.4.m4.1.1.3.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.1"></times><ci id="S2.SS4.p2.4.m4.1.1.3.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.2">𝜆</ci><apply id="S2.SS4.p2.4.m4.1.1.3.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.3.3.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S2.SS4.p2.4.m4.1.1.3.3.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3.2">𝐿</ci><apply id="S2.SS4.p2.4.m4.1.1.3.3.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3"><times id="S2.SS4.p2.4.m4.1.1.3.3.3.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.1"></times><ci id="S2.SS4.p2.4.m4.1.1.3.3.3.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.2">𝑐</ci><ci id="S2.SS4.p2.4.m4.1.1.3.3.3.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.1c">L=L_{MQSD}+\lambda L_{ce}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experimental Setup</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>ASR system</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our on-device ASR system uses a word-piece Conformer following <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> with wordpiece ouptuts and an external word-based LM trained with a large text corpus. Our decoder uses a similar strategy to <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> with an additional rescoring step <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. All of our experiments operate on top of the N-best (with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N\leq 10" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">≤</mo><mn id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><leq id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></leq><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N\leq 10</annotation></semantics></math>) list generated by the ASR system.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Training and evaluation data</h3>

<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Training data</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">We train domain expert models by mixing a large (95%) <span id="S3.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_italic">synthetic</span> in-domain (music) training set with a small (5%) all-domain <span id="S3.SS2.SSS1.p1.1.2" class="ltx_text ltx_font_italic">annotated</span> training set. The 1.8M annotated queries are sampled anonymously from opted-in Voice Assistant (VA) queries across all domains and consist of text/audio pairs.
The 36M synthetic queries are obtained by enumerating in-domain entity data feeds with query templates, similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
While the 4-gram LM (§<a href="#S3.SS3.SSS2" title="3.3.2 4-gram LM with Katz back-off ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>) is trained directly on the query texts, the Transformer models (§<a href="#S3.SS3.SSS1" title="3.3.1 Transformers ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>) require ASR N-bests lists for training. We obtain N-best lists by decoding audio using our ASR system (§<a href="#S3.SS1" title="3.1 ASR system ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). For the 36M synthetic queries, we generate audio using Text-to-Speech (TTS).</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Evaluation sets</h4>

<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Overview of the evaluation sets.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Collection</span></th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Sub-set</span></th>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.1.1.3.1" class="ltx_text ltx_font_bold"># queries</span></td>
<td id="S3.T1.1.1.1.4" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">avg. query length</span></td>
</tr>
<tr id="S3.T1.1.2.2" class="ltx_tr">
<th id="S3.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" rowspan="2"><span id="S3.T1.1.2.2.1.1" class="ltx_text">VA-2022</span></th>
<th id="S3.T1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">All</th>
<td id="S3.T1.1.2.2.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.2.2.3.1" class="ltx_text ltx_number">8,035</span></td>
<td id="S3.T1.1.2.2.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.8</td>
</tr>
<tr id="S3.T1.1.3.3" class="ltx_tr">
<th id="S3.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">Music</th>
<td id="S3.T1.1.3.3.2" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.3.3.2.1" class="ltx_text ltx_number">975</span></td>
<td id="S3.T1.1.3.3.3" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.1</td>
</tr>
<tr id="S3.T1.1.4.4" class="ltx_tr">
<th id="S3.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" rowspan="2"><span id="S3.T1.1.4.4.1.1" class="ltx_text">VA-2023</span></th>
<th id="S3.T1.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">All</th>
<td id="S3.T1.1.4.4.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.4.4.3.1" class="ltx_text ltx_number">11,998</span></td>
<td id="S3.T1.1.4.4.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">6.0</td>
</tr>
<tr id="S3.T1.1.5.5" class="ltx_tr">
<th id="S3.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">Music</th>
<td id="S3.T1.1.5.5.2" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S3.T1.1.5.5.2.1" class="ltx_text ltx_number">1,100</span></td>
<td id="S3.T1.1.5.5.3" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.9</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">We evaluate our models on randomly sampled, representative, and anonymized VA queries sampled across two years (2022 and 2023) where we compare across the entire population and the sub-population corresponding to music queries. Table <a href="#S3.T1" title="Table 1 ‣ 3.2.2 Evaluation sets ‣ 3.2 Training and evaluation data ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows an overview of our evaluation sets.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Rescoring/rewriting methods under comparison</h3>

<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Transformers</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">We use a 16k vocabulary SentencePiece (SP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> to tokenize text input into a sequence of subword tokens. The SP model was trained on all queries in our training set (§<a href="#S3.SS2.SSS1" title="3.2.1 Training data ‣ 3.2 Training and evaluation data ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>). Both TR and TRA models have 4 layers in the encoder stack, and 1 layer in the decoding stack, with MHA with 8 heads, hidden layers dimension 512, and 2048 units in the feed-forward layer for a total of 25M model parameters. The TRA model has an additional 1M parameters in the <span id="S3.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_italic">Rescore Attention Layer</span> which includes an 8-headed MHA.</p>
</div>
<div id="S3.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p2.4" class="ltx_p"><span id="S3.SS3.SSS1.p2.4.1" class="ltx_text ltx_font_bold">Training schedule.</span> Both TR and TRA models are trained up to 300,000 steps on an 8-GPUs machine, with batch size as large as possible (up to 30,000 tokens) per replica. We adopt an early-stopping criteria on a development-set (dev-set) to avoid over-fitting, the dev-set is a small split (about 1%) from the annotated training set, and is evaluated every 5,000 steps. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, we use the same parameters for Adam optimizer and custom learning rate schedule, except with a lager value of 8000 for <span id="S3.SS3.SSS1.p2.4.2" class="ltx_text ltx_font_italic">warmup_steps</span>. We also use the same dropout ratio 0.1 for both Attention and ReLu layer.
The baseline TR model is trained using the combined MWER objective <math id="S3.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="L=L_{MWER}+\alpha L_{ce}" display="inline"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><mrow id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS1.p2.1.m1.1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml"><msub id="S3.SS3.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.2.cmml">L</mi><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1a" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.4" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1b" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.5" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.5.cmml">R</mi></mrow></msub><mo id="S3.SS3.SSS1.p2.1.m1.1.1.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.1.cmml">+</mo><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.2.cmml">L</mi><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><apply id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1"><eq id="S3.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1"></eq><ci id="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3"><plus id="S3.SS3.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.1"></plus><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3"><times id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.1"></times><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.2">𝑀</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.3">𝑊</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.4.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.4">𝐸</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.5.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.3.5">𝑅</ci></apply></apply><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3"><times id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2">𝛼</ci><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3"><times id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.1"></times><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.2">𝑐</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">L=L_{MWER}+\alpha L_{ce}</annotation></semantics></math>,
following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> we set <math id="S3.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><mrow id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml">α</mi><mo id="S3.SS3.SSS1.p2.2.m2.1.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.p2.2.m2.1.1.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><apply id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><eq id="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.1"></eq><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2">𝛼</ci><cn type="float" id="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">\alpha=0.01</annotation></semantics></math> in our experiments.
Similarly, our TRA model is trained using the combined MQSD objective:
<math id="S3.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="L=L_{MQSD}+\lambda L_{ce}" display="inline"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><mrow id="S3.SS3.SSS1.p2.3.m3.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml">L</mi><mo id="S3.SS3.SSS1.p2.3.m3.1.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml"><msub id="S3.SS3.SSS1.p2.3.m3.1.1.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.2.cmml">L</mi><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1a" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.4" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1b" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.5" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.5.cmml">D</mi></mrow></msub><mo id="S3.SS3.SSS1.p2.3.m3.1.1.3.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.1.cmml">+</mo><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.2.cmml">L</mi><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><apply id="S3.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1"><eq id="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1"></eq><ci id="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3"><plus id="S3.SS3.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.1"></plus><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3"><times id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.1"></times><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.2">𝑀</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.3">𝑄</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.4.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.4">𝑆</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.5.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.2.3.5">𝐷</ci></apply></apply><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3"><times id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.2">𝜆</ci><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.2">𝐿</ci><apply id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3"><times id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.1"></times><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.2">𝑐</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.3.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">L=L_{MQSD}+\lambda L_{ce}</annotation></semantics></math>. We set <math id="S3.SS3.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\lambda=0.01" display="inline"><semantics id="S3.SS3.SSS1.p2.4.m4.1a"><mrow id="S3.SS3.SSS1.p2.4.m4.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p2.4.m4.1.1.2" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml">λ</mi><mo id="S3.SS3.SSS1.p2.4.m4.1.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.p2.4.m4.1.1.3" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.4.m4.1b"><apply id="S3.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1"><eq id="S3.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.1"></eq><ci id="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2">𝜆</ci><cn type="float" id="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.4.m4.1c">\lambda=0.01</annotation></semantics></math> in our experiments.</p>
</div>
<div id="S3.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p3.9" class="ltx_p"><span id="S3.SS3.SSS1.p3.9.1" class="ltx_text ltx_font_bold">Hyper-parameters.</span> 

There are 2 tunable parameters in our TRA model: 1. <math id="S3.SS3.SSS1.p3.1.m1.1" class="ltx_Math" alttext="threshold_{R}" display="inline"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><mrow id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.1.m1.1.1.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.3" xref="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1a" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.4" xref="S3.SS3.SSS1.p3.1.m1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1b" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.5" xref="S3.SS3.SSS1.p3.1.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1c" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.6" xref="S3.SS3.SSS1.p3.1.m1.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1d" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.7" xref="S3.SS3.SSS1.p3.1.m1.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1e" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.8" xref="S3.SS3.SSS1.p3.1.m1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1f" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.1.m1.1.1.9" xref="S3.SS3.SSS1.p3.1.m1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.1.m1.1.1.1g" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS1.p3.1.m1.1.1.10" xref="S3.SS3.SSS1.p3.1.m1.1.1.10.cmml"><mi id="S3.SS3.SSS1.p3.1.m1.1.1.10.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.10.2.cmml">d</mi><mi id="S3.SS3.SSS1.p3.1.m1.1.1.10.3" xref="S3.SS3.SSS1.p3.1.m1.1.1.10.3.cmml">R</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><apply id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1"><times id="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.1"></times><ci id="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2">𝑡</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.3">ℎ</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.4.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.4">𝑟</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.5.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.5">𝑒</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.6.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.6">𝑠</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.7.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.7">ℎ</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.8.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.8">𝑜</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.9.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.9">𝑙</ci><apply id="S3.SS3.SSS1.p3.1.m1.1.1.10.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.10"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.1.1.10.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.10">subscript</csymbol><ci id="S3.SS3.SSS1.p3.1.m1.1.1.10.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.10.2">𝑑</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.10.3.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.10.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">threshold_{R}</annotation></semantics></math>, which triggers N-best rescoring only when the model's confidence score (log-probability) surpasses this threshold; 2. <math id="S3.SS3.SSS1.p3.2.m2.1" class="ltx_Math" alttext="threshold_{W}" display="inline"><semantics id="S3.SS3.SSS1.p3.2.m2.1a"><mrow id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p3.2.m2.1.1.2" xref="S3.SS3.SSS1.p3.2.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.3" xref="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1a" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.4" xref="S3.SS3.SSS1.p3.2.m2.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1b" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.5" xref="S3.SS3.SSS1.p3.2.m2.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1c" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.6" xref="S3.SS3.SSS1.p3.2.m2.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1d" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.7" xref="S3.SS3.SSS1.p3.2.m2.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1e" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.8" xref="S3.SS3.SSS1.p3.2.m2.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1f" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.2.m2.1.1.9" xref="S3.SS3.SSS1.p3.2.m2.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.2.m2.1.1.1g" xref="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS1.p3.2.m2.1.1.10" xref="S3.SS3.SSS1.p3.2.m2.1.1.10.cmml"><mi id="S3.SS3.SSS1.p3.2.m2.1.1.10.2" xref="S3.SS3.SSS1.p3.2.m2.1.1.10.2.cmml">d</mi><mi id="S3.SS3.SSS1.p3.2.m2.1.1.10.3" xref="S3.SS3.SSS1.p3.2.m2.1.1.10.3.cmml">W</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.2.m2.1b"><apply id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1"><times id="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.1"></times><ci id="S3.SS3.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.2">𝑡</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.3">ℎ</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.4.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.4">𝑟</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.5.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.5">𝑒</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.6.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.6">𝑠</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.7.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.7">ℎ</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.8.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.8">𝑜</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.9.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.9">𝑙</ci><apply id="S3.SS3.SSS1.p3.2.m2.1.1.10.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.10"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.2.m2.1.1.10.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.10">subscript</csymbol><ci id="S3.SS3.SSS1.p3.2.m2.1.1.10.2.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.10.2">𝑑</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.10.3.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.10.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">threshold_{W}</annotation></semantics></math>, which dictates the conditions under which to rewrite the 1-best with the model's predicted text, applied when its sequence loss exceeds this threshold.
The thresholds are optimized by performing a grid-search over a range of possible values on a held-out dev-set, such that we have the lowest WER on in-domain dev-set while WER on the all-domain dev-set is not degraded. We searched for the best <math id="S3.SS3.SSS1.p3.3.m3.1" class="ltx_Math" alttext="threshold_{R}" display="inline"><semantics id="S3.SS3.SSS1.p3.3.m3.1a"><mrow id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p3.3.m3.1.1.2" xref="S3.SS3.SSS1.p3.3.m3.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.3" xref="S3.SS3.SSS1.p3.3.m3.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1a" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.4" xref="S3.SS3.SSS1.p3.3.m3.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1b" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.5" xref="S3.SS3.SSS1.p3.3.m3.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1c" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.6" xref="S3.SS3.SSS1.p3.3.m3.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1d" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.7" xref="S3.SS3.SSS1.p3.3.m3.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1e" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.8" xref="S3.SS3.SSS1.p3.3.m3.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1f" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.3.m3.1.1.9" xref="S3.SS3.SSS1.p3.3.m3.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.3.m3.1.1.1g" xref="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS1.p3.3.m3.1.1.10" xref="S3.SS3.SSS1.p3.3.m3.1.1.10.cmml"><mi id="S3.SS3.SSS1.p3.3.m3.1.1.10.2" xref="S3.SS3.SSS1.p3.3.m3.1.1.10.2.cmml">d</mi><mi id="S3.SS3.SSS1.p3.3.m3.1.1.10.3" xref="S3.SS3.SSS1.p3.3.m3.1.1.10.3.cmml">R</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.3.m3.1b"><apply id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1"><times id="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.1"></times><ci id="S3.SS3.SSS1.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.2">𝑡</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.3">ℎ</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.4.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.4">𝑟</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.5.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.5">𝑒</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.6.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.6">𝑠</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.7.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.7">ℎ</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.8.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.8">𝑜</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.9.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.9">𝑙</ci><apply id="S3.SS3.SSS1.p3.3.m3.1.1.10.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.10"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.3.m3.1.1.10.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.10">subscript</csymbol><ci id="S3.SS3.SSS1.p3.3.m3.1.1.10.2.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.10.2">𝑑</ci><ci id="S3.SS3.SSS1.p3.3.m3.1.1.10.3.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1.10.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">threshold_{R}</annotation></semantics></math> first and then constraint the search for <math id="S3.SS3.SSS1.p3.4.m4.1" class="ltx_Math" alttext="threshold_{W}" display="inline"><semantics id="S3.SS3.SSS1.p3.4.m4.1a"><mrow id="S3.SS3.SSS1.p3.4.m4.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.1.1.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1a" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.4" xref="S3.SS3.SSS1.p3.4.m4.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1b" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.5" xref="S3.SS3.SSS1.p3.4.m4.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1c" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.6" xref="S3.SS3.SSS1.p3.4.m4.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1d" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.7" xref="S3.SS3.SSS1.p3.4.m4.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1e" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.8" xref="S3.SS3.SSS1.p3.4.m4.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1f" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1.9" xref="S3.SS3.SSS1.p3.4.m4.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.4.m4.1.1.1g" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS1.p3.4.m4.1.1.10" xref="S3.SS3.SSS1.p3.4.m4.1.1.10.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.1.1.10.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.10.2.cmml">d</mi><mi id="S3.SS3.SSS1.p3.4.m4.1.1.10.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.10.3.cmml">W</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.4.m4.1b"><apply id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1"><times id="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.1"></times><ci id="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2">𝑡</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3">ℎ</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.4.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.4">𝑟</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.5.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.5">𝑒</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.6.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.6">𝑠</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.7.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.7">ℎ</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.8.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.8">𝑜</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.9.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.9">𝑙</ci><apply id="S3.SS3.SSS1.p3.4.m4.1.1.10.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.10"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.4.m4.1.1.10.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.10">subscript</csymbol><ci id="S3.SS3.SSS1.p3.4.m4.1.1.10.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.10.2">𝑑</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.10.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.10.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.1c">threshold_{W}</annotation></semantics></math> <math id="S3.SS3.SSS1.p3.5.m5.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS3.SSS1.p3.5.m5.1a"><mo id="S3.SS3.SSS1.p3.5.m5.1.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.5.m5.1b"><gt id="S3.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.5.m5.1c">&gt;</annotation></semantics></math> <math id="S3.SS3.SSS1.p3.6.m6.1" class="ltx_Math" alttext="threshold_{R}" display="inline"><semantics id="S3.SS3.SSS1.p3.6.m6.1a"><mrow id="S3.SS3.SSS1.p3.6.m6.1.1" xref="S3.SS3.SSS1.p3.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.p3.6.m6.1.1.2" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.3" xref="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1a" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.4" xref="S3.SS3.SSS1.p3.6.m6.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1b" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.5" xref="S3.SS3.SSS1.p3.6.m6.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1c" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.6" xref="S3.SS3.SSS1.p3.6.m6.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1d" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.7" xref="S3.SS3.SSS1.p3.6.m6.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1e" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.8" xref="S3.SS3.SSS1.p3.6.m6.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1f" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p3.6.m6.1.1.9" xref="S3.SS3.SSS1.p3.6.m6.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p3.6.m6.1.1.1g" xref="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS1.p3.6.m6.1.1.10" xref="S3.SS3.SSS1.p3.6.m6.1.1.10.cmml"><mi id="S3.SS3.SSS1.p3.6.m6.1.1.10.2" xref="S3.SS3.SSS1.p3.6.m6.1.1.10.2.cmml">d</mi><mi id="S3.SS3.SSS1.p3.6.m6.1.1.10.3" xref="S3.SS3.SSS1.p3.6.m6.1.1.10.3.cmml">R</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.6.m6.1b"><apply id="S3.SS3.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1"><times id="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.1"></times><ci id="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.2">𝑡</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.3">ℎ</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.4.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.4">𝑟</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.5.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.5">𝑒</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.6.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.6">𝑠</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.7.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.7">ℎ</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.8.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.8">𝑜</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.9.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.9">𝑙</ci><apply id="S3.SS3.SSS1.p3.6.m6.1.1.10.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.10"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.10.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.10">subscript</csymbol><ci id="S3.SS3.SSS1.p3.6.m6.1.1.10.2.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.10.2">𝑑</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.10.3.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.10.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.6.m6.1c">threshold_{R}</annotation></semantics></math>.
Following this approach we set <math id="S3.SS3.SSS1.p3.7.m7.1" class="ltx_Math" alttext="\text{threshold}_{R}{}=-1.0" display="inline"><semantics id="S3.SS3.SSS1.p3.7.m7.1a"><mrow id="S3.SS3.SSS1.p3.7.m7.1.1" xref="S3.SS3.SSS1.p3.7.m7.1.1.cmml"><msub id="S3.SS3.SSS1.p3.7.m7.1.1.2" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.cmml"><mtext id="S3.SS3.SSS1.p3.7.m7.1.1.2.2" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.2a.cmml">threshold</mtext><mi id="S3.SS3.SSS1.p3.7.m7.1.1.2.3" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.3.cmml">R</mi></msub><mo id="S3.SS3.SSS1.p3.7.m7.1.1.1" xref="S3.SS3.SSS1.p3.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p3.7.m7.1.1.3" xref="S3.SS3.SSS1.p3.7.m7.1.1.3.cmml"><mo id="S3.SS3.SSS1.p3.7.m7.1.1.3a" xref="S3.SS3.SSS1.p3.7.m7.1.1.3.cmml">−</mo><mn id="S3.SS3.SSS1.p3.7.m7.1.1.3.2" xref="S3.SS3.SSS1.p3.7.m7.1.1.3.2.cmml">1.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.7.m7.1b"><apply id="S3.SS3.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1"><eq id="S3.SS3.SSS1.p3.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.1"></eq><apply id="S3.SS3.SSS1.p3.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.7.m7.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p3.7.m7.1.1.2.2a.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.2"><mtext id="S3.SS3.SSS1.p3.7.m7.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.2">threshold</mtext></ci><ci id="S3.SS3.SSS1.p3.7.m7.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.2.3">𝑅</ci></apply><apply id="S3.SS3.SSS1.p3.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.3"><minus id="S3.SS3.SSS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.3"></minus><cn type="float" id="S3.SS3.SSS1.p3.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.7.m7.1c">\text{threshold}_{R}{}=-1.0</annotation></semantics></math> and <math id="S3.SS3.SSS1.p3.8.m8.1" class="ltx_Math" alttext="\text{threshold}_{W}{}=-0.5" display="inline"><semantics id="S3.SS3.SSS1.p3.8.m8.1a"><mrow id="S3.SS3.SSS1.p3.8.m8.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.cmml"><msub id="S3.SS3.SSS1.p3.8.m8.1.1.2" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.cmml"><mtext id="S3.SS3.SSS1.p3.8.m8.1.1.2.2" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.2a.cmml">threshold</mtext><mi id="S3.SS3.SSS1.p3.8.m8.1.1.2.3" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.3.cmml">W</mi></msub><mo id="S3.SS3.SSS1.p3.8.m8.1.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p3.8.m8.1.1.3" xref="S3.SS3.SSS1.p3.8.m8.1.1.3.cmml"><mo id="S3.SS3.SSS1.p3.8.m8.1.1.3a" xref="S3.SS3.SSS1.p3.8.m8.1.1.3.cmml">−</mo><mn id="S3.SS3.SSS1.p3.8.m8.1.1.3.2" xref="S3.SS3.SSS1.p3.8.m8.1.1.3.2.cmml">0.5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.8.m8.1b"><apply id="S3.SS3.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1"><eq id="S3.SS3.SSS1.p3.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1"></eq><apply id="S3.SS3.SSS1.p3.8.m8.1.1.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p3.8.m8.1.1.2.2a.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.2"><mtext id="S3.SS3.SSS1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.2">threshold</mtext></ci><ci id="S3.SS3.SSS1.p3.8.m8.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.2.3">𝑊</ci></apply><apply id="S3.SS3.SSS1.p3.8.m8.1.1.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.3"><minus id="S3.SS3.SSS1.p3.8.m8.1.1.3.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.3"></minus><cn type="float" id="S3.SS3.SSS1.p3.8.m8.1.1.3.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.3.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.8.m8.1c">\text{threshold}_{W}{}=-0.5</annotation></semantics></math> in our TRA model. Same thresholds are applied to all TRA experiments.
To avoid overriding 1-best when the N-best context is insufficient, we do not perform rewrite when <math id="S3.SS3.SSS1.p3.9.m9.1" class="ltx_Math" alttext="N=1" display="inline"><semantics id="S3.SS3.SSS1.p3.9.m9.1a"><mrow id="S3.SS3.SSS1.p3.9.m9.1.1" xref="S3.SS3.SSS1.p3.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.p3.9.m9.1.1.2" xref="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml">N</mi><mo id="S3.SS3.SSS1.p3.9.m9.1.1.1" xref="S3.SS3.SSS1.p3.9.m9.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.p3.9.m9.1.1.3" xref="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.9.m9.1b"><apply id="S3.SS3.SSS1.p3.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1"><eq id="S3.SS3.SSS1.p3.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1.1"></eq><ci id="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1.2">𝑁</ci><cn type="integer" id="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.9.m9.1c">N=1</annotation></semantics></math>.
In our experiments, we present evaluation results for our TRA model in two configurations: with rewriting enabled (TRA-RW, rescore-rewrite) and without rewriting (TRA-R, rescore-only).</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>4-gram LM with Katz back-off</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.1" class="ltx_p">In addition to the Transformer models (§<a href="#S3.SS3.SSS1" title="3.3.1 Transformers ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>) trained on entire N-best lists, we also train a 4-gram back-off LM <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> on the reference text in our training set (§<a href="#S3.SS2.SSS1" title="3.2.1 Training data ‣ 3.2 Training and evaluation data ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>). 3- and 4-grams with a count less than 2 are discarded. Good-Turing discounting is applied to 2-, 3- and 4-grams that have a frequency of 7 or less.
The 4-gram LM is combined with signals extracted from the ASR decoding process using linear interpolation to score the candidates in the N-best list, as described in the next section (§<a href="#S3.SS4" title="3.4 Interpolation with ASR decoding signals ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>).
The advantage of the 4-gram LM is that it allows for estimation without needing to synthesize audio or run speech recognition to generate N-best lists, unlike what is required for Transformer models in §<a href="#S3.SS3.SSS1" title="3.3.1 Transformers ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>. However, the downside of this approach is that the 4-gram LM cannot utilize N-best list context to correct the unique error distribution of the ASR system.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Interpolation with ASR decoding signals</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">In our second experiment set, we will combine the per-hypothesis signal from each of the models described above with the scores assigned by the ASR system (§<a href="#S3.SS1" title="3.1 ASR system ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>): the log-likelihood for the hypothesis given the input audio provided by the Conformer, and the log-likelihood of the hypothesis text under the on-device external LM <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, Ch. 16]</cite>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">For each of the rescore-only models above (TR, TRA-R, 4-gram LM), we include their log-probability as an additional signal. However, TRA-RW may generate a new hypothesis not part of the N-best list, and lacking corresponding ASR scores. In that case, the ASR-provided scores are assumed to be zero, and we introduce a fourth signal, <span id="S3.SS4.p2.1.1" class="ltx_text ltx_font_italic">lmCost+</span>, equal to the Transformer's generative log-likelihood.
Following <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. [<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, the various signals are combined through a linear combination, and we learn the weights via Powell's method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> against a separate development set sampled independently from the same population and with similar characteristics as the VA-2023 evaluation set.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>TR &amp; TRA</h3>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>WER evaluation (§<a href="#S3.SS2.SSS2" title="3.2.2 Evaluation sets ‣ 3.2 Training and evaluation data ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>) of the Transformer models (§<a href="#S3.SS3.SSS1" title="3.3.1 Transformers ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>) with ASR N-best input. The average column depicts the arithmetic mean across the evaluation sets.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"></th>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" colspan="2"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">VA-2022</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" colspan="2"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">VA-2023</span></td>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" colspan="2"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Average</span></td>
</tr>
<tr id="S4.T2.1.2.2" class="ltx_tr">
<th id="S4.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="S4.T2.1.2.2.2" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.2.1" class="ltx_text ltx_font_bold">All</span></td>
<td id="S4.T2.1.2.2.3" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.3.1" class="ltx_text ltx_font_bold">Music</span></td>
<td id="S4.T2.1.2.2.4" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.4.1" class="ltx_text ltx_font_bold">All</span></td>
<td id="S4.T2.1.2.2.5" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.5.1" class="ltx_text ltx_font_bold">Music</span></td>
<td id="S4.T2.1.2.2.6" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.6.1" class="ltx_text ltx_font_bold">All</span></td>
<td id="S4.T2.1.2.2.7" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.2.2.7.1" class="ltx_text ltx_font_bold">Music</span></td>
</tr>
<tr id="S4.T2.1.3.3" class="ltx_tr">
<th id="S4.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">ASR</th>
<td id="S4.T2.1.3.3.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">3.57</td>
<td id="S4.T2.1.3.3.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.70</td>
<td id="S4.T2.1.3.3.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.78</td>
<td id="S4.T2.1.3.3.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.52</td>
<td id="S4.T2.1.3.3.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.68</td>
<td id="S4.T2.1.3.3.7" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.11</td>
</tr>
<tr id="S4.T2.1.4.4" class="ltx_tr">
<th id="S4.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TR</th>
<td id="S4.T2.1.4.4.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">3.61</td>
<td id="S4.T2.1.4.4.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.50</td>
<td id="S4.T2.1.4.4.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.78</td>
<td id="S4.T2.1.4.4.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.4.4.5.1" class="ltx_text ltx_font_bold">5.18</span></td>
<td id="S4.T2.1.4.4.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.70</td>
<td id="S4.T2.1.4.4.7" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.84</td>
</tr>
<tr id="S4.T2.1.5.5" class="ltx_tr">
<th id="S4.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TRA-R</th>
<td id="S4.T2.1.5.5.2" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">3.52</td>
<td id="S4.T2.1.5.5.3" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.28</td>
<td id="S4.T2.1.5.5.4" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.5.5.4.1" class="ltx_text ltx_font_bold">5.72</span></td>
<td id="S4.T2.1.5.5.5" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.29</td>
<td id="S4.T2.1.5.5.6" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.5.5.6.1" class="ltx_text ltx_font_bold">4.62</span></td>
<td id="S4.T2.1.5.5.7" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4.79</td>
</tr>
<tr id="S4.T2.1.6.6" class="ltx_tr">
<th id="S4.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TRA-RW</th>
<td id="S4.T2.1.6.6.2" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.6.6.2.1" class="ltx_text ltx_font_bold">3.51</span></td>
<td id="S4.T2.1.6.6.3" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.6.6.3.1" class="ltx_text ltx_font_bold">3.98</span></td>
<td id="S4.T2.1.6.6.4" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.6.6.4.1" class="ltx_text ltx_font_bold">5.72</span></td>
<td id="S4.T2.1.6.6.5" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.36</td>
<td id="S4.T2.1.6.6.6" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.6.6.6.1" class="ltx_text ltx_font_bold">4.62</span></td>
<td id="S4.T2.1.6.6.7" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T2.1.6.6.7.1" class="ltx_text ltx_font_bold">4.67</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.1 TR &amp; TRA ‣ 4 Results ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results of the Transformer models operating directly on the ASR N-best list texts. While TR and TRA-R perform rescoring of the ASR N-best list only, TRA-RW also has the ability to overwrite the 1-best. We find that TRA (both R and RW) perform best on the entire query population. However, for the music sub-population, results are more inconsistent and while TRA-RW performs best on VA-2022 (music), the TR model without the rescoring attention layer seems to perform better on the music subset of VA-2023 (closely followed by TRA-R). We suspect that this may be due to a drift in music entities popularity or user behavior, since the training data was generated in 2022, and hence, the TRA-RW model may be over-correcting to entities that are no longer as relevant in 2023. However, if we look at the average across both test sets, we see that both TRA-R/RW perform well on the entire query population, and TRA-RW provides a significant improvement (<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="8.6\%" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">8.6</mn><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">8.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">8.6\%</annotation></semantics></math> rel.) on the music sub-collection. This is most likely due to good coverage of the in-domain music synthetic queries (95%) in our training set.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Interpolation with ASR signals</h3>

<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>WER on VA-2023 (§<a href="#S3.SS2.SSS2" title="3.2.2 Evaluation sets ‣ 3.2 Training and evaluation data ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>) by combining ASR decoding signals with signals from the rescoring/rewriting methods (§<a href="#S3.SS3" title="3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>) using a linear model (§<a href="#S3.SS4" title="3.4 Interpolation with ASR decoding signals ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>), where +<math id="S4.T3.2.m1.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.T3.2.m1.1b"><msup id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml"><mi id="S4.T3.2.m1.1.1.2" xref="S4.T3.2.m1.1.1.2.cmml">W</mi><mo id="S4.T3.2.m1.1.1.3" xref="S4.T3.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><apply id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.m1.1.1.1.cmml" xref="S4.T3.2.m1.1.1">superscript</csymbol><ci id="S4.T3.2.m1.1.1.2.cmml" xref="S4.T3.2.m1.1.1.2">𝑊</ci><times id="S4.T3.2.m1.1.1.3.cmml" xref="S4.T3.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">W^{*}</annotation></semantics></math> denotes models with optimized weights. The relative improvement in WER over the ASR system is listed between brackets.</figcaption>
<table id="S4.T3.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.16.15.1" class="ltx_tr">
<th id="S4.T3.16.15.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"></th>
<th id="S4.T3.16.15.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-1.25pt;padding-bottom:-1.25pt;" colspan="2"><span id="S4.T3.16.15.1.2.1" class="ltx_text ltx_font_bold">VA-2023</span></th>
</tr>
<tr id="S4.T3.16.16.2" class="ltx_tr">
<th id="S4.T3.16.16.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T3.16.16.2.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T3.16.16.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T3.16.16.2.2.1" class="ltx_text ltx_font_bold">All</span></th>
<th id="S4.T3.16.16.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T3.16.16.2.3.1" class="ltx_text ltx_font_bold">Music</span></th>
</tr>
<tr id="S4.T3.4.2" class="ltx_tr">
<th id="S4.T3.4.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">ASR</th>
<th id="S4.T3.3.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.78 <span id="S4.T3.3.1.1.1" class="ltx_text ltx_phantom"><span style="visibility:hidden"><math id="S4.T3.3.1.1.1.m1.1" class="ltx_Math" alttext="(0.00\%)" display="inline"><semantics id="S4.T3.3.1.1.1.m1.1a"><mrow id="S4.T3.3.1.1.1.m1.1.1.1" xref="S4.T3.3.1.1.1.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.3.1.1.1.m1.1.1.1.2" xref="S4.T3.3.1.1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.3.1.1.1.m1.1.1.1.1" xref="S4.T3.3.1.1.1.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.3.1.1.1.m1.1.1.1.1.2" xref="S4.T3.3.1.1.1.m1.1.1.1.1.2.cmml">0.00</mn><mo mathsize="80%" id="S4.T3.3.1.1.1.m1.1.1.1.1.1" xref="S4.T3.3.1.1.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.3.1.1.1.m1.1.1.1.3" xref="S4.T3.3.1.1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.1.m1.1b"><apply id="S4.T3.3.1.1.1.m1.1.1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.3.1.1.1.m1.1.1.1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.3.1.1.1.m1.1.1.1.1.2.cmml" xref="S4.T3.3.1.1.1.m1.1.1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.1.m1.1c">(0.00\%)</annotation></semantics></math></span></span><span id="S4.T3.3.1.1.2" class="ltx_text" style="font-size:80%;"></span>
</th>
<th id="S4.T3.4.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.52 <span id="S4.T3.4.2.2.1" class="ltx_text ltx_phantom"><span style="visibility:hidden"><math id="S4.T3.4.2.2.1.m1.1" class="ltx_Math" alttext="(0.00\%)" display="inline"><semantics id="S4.T3.4.2.2.1.m1.1a"><mrow id="S4.T3.4.2.2.1.m1.1.1.1" xref="S4.T3.4.2.2.1.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.4.2.2.1.m1.1.1.1.2" xref="S4.T3.4.2.2.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.4.2.2.1.m1.1.1.1.1" xref="S4.T3.4.2.2.1.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.4.2.2.1.m1.1.1.1.1.2" xref="S4.T3.4.2.2.1.m1.1.1.1.1.2.cmml">0.00</mn><mo mathsize="80%" id="S4.T3.4.2.2.1.m1.1.1.1.1.1" xref="S4.T3.4.2.2.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.4.2.2.1.m1.1.1.1.3" xref="S4.T3.4.2.2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.1.m1.1b"><apply id="S4.T3.4.2.2.1.m1.1.1.1.1.cmml" xref="S4.T3.4.2.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.4.2.2.1.m1.1.1.1.1.1.cmml" xref="S4.T3.4.2.2.1.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.4.2.2.1.m1.1.1.1.1.2.cmml" xref="S4.T3.4.2.2.1.m1.1.1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.1.m1.1c">(0.00\%)</annotation></semantics></math></span></span><span id="S4.T3.4.2.2.2" class="ltx_text" style="font-size:80%;"></span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.7.5" class="ltx_tr">
<th id="S4.T3.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">4-gram LM +<math id="S4.T3.5.3.1.m1.1" class="ltx_Math" alttext="W^{*}_{lm4}" display="inline"><semantics id="S4.T3.5.3.1.m1.1a"><msubsup id="S4.T3.5.3.1.m1.1.1" xref="S4.T3.5.3.1.m1.1.1.cmml"><mi id="S4.T3.5.3.1.m1.1.1.2.2" xref="S4.T3.5.3.1.m1.1.1.2.2.cmml">W</mi><mrow id="S4.T3.5.3.1.m1.1.1.3" xref="S4.T3.5.3.1.m1.1.1.3.cmml"><mi id="S4.T3.5.3.1.m1.1.1.3.2" xref="S4.T3.5.3.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.3.1.m1.1.1.3.1" xref="S4.T3.5.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.5.3.1.m1.1.1.3.3" xref="S4.T3.5.3.1.m1.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.3.1.m1.1.1.3.1a" xref="S4.T3.5.3.1.m1.1.1.3.1.cmml">​</mo><mn id="S4.T3.5.3.1.m1.1.1.3.4" xref="S4.T3.5.3.1.m1.1.1.3.4.cmml">4</mn></mrow><mo id="S4.T3.5.3.1.m1.1.1.2.3" xref="S4.T3.5.3.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.1.m1.1b"><apply id="S4.T3.5.3.1.m1.1.1.cmml" xref="S4.T3.5.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.5.3.1.m1.1.1.1.cmml" xref="S4.T3.5.3.1.m1.1.1">subscript</csymbol><apply id="S4.T3.5.3.1.m1.1.1.2.cmml" xref="S4.T3.5.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.5.3.1.m1.1.1.2.1.cmml" xref="S4.T3.5.3.1.m1.1.1">superscript</csymbol><ci id="S4.T3.5.3.1.m1.1.1.2.2.cmml" xref="S4.T3.5.3.1.m1.1.1.2.2">𝑊</ci><times id="S4.T3.5.3.1.m1.1.1.2.3.cmml" xref="S4.T3.5.3.1.m1.1.1.2.3"></times></apply><apply id="S4.T3.5.3.1.m1.1.1.3.cmml" xref="S4.T3.5.3.1.m1.1.1.3"><times id="S4.T3.5.3.1.m1.1.1.3.1.cmml" xref="S4.T3.5.3.1.m1.1.1.3.1"></times><ci id="S4.T3.5.3.1.m1.1.1.3.2.cmml" xref="S4.T3.5.3.1.m1.1.1.3.2">𝑙</ci><ci id="S4.T3.5.3.1.m1.1.1.3.3.cmml" xref="S4.T3.5.3.1.m1.1.1.3.3">𝑚</ci><cn type="integer" id="S4.T3.5.3.1.m1.1.1.3.4.cmml" xref="S4.T3.5.3.1.m1.1.1.3.4">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.1.m1.1c">W^{*}_{lm4}</annotation></semantics></math>
</th>
<td id="S4.T3.6.4.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.57 <math id="S4.T3.6.4.2.m1.1" class="ltx_Math" alttext="(3.63\%)" display="inline"><semantics id="S4.T3.6.4.2.m1.1a"><mrow id="S4.T3.6.4.2.m1.1.1.1" xref="S4.T3.6.4.2.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.6.4.2.m1.1.1.1.2" xref="S4.T3.6.4.2.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.6.4.2.m1.1.1.1.1" xref="S4.T3.6.4.2.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.6.4.2.m1.1.1.1.1.2" xref="S4.T3.6.4.2.m1.1.1.1.1.2.cmml">3.63</mn><mo mathsize="80%" id="S4.T3.6.4.2.m1.1.1.1.1.1" xref="S4.T3.6.4.2.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.6.4.2.m1.1.1.1.3" xref="S4.T3.6.4.2.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.2.m1.1b"><apply id="S4.T3.6.4.2.m1.1.1.1.1.cmml" xref="S4.T3.6.4.2.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.6.4.2.m1.1.1.1.1.1.cmml" xref="S4.T3.6.4.2.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.6.4.2.m1.1.1.1.1.2.cmml" xref="S4.T3.6.4.2.m1.1.1.1.1.2">3.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.2.m1.1c">(3.63\%)</annotation></semantics></math>
</td>
<td id="S4.T3.7.5.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.26 <math id="S4.T3.7.5.3.m1.1" class="ltx_Math" alttext="(4.71\%)" display="inline"><semantics id="S4.T3.7.5.3.m1.1a"><mrow id="S4.T3.7.5.3.m1.1.1.1" xref="S4.T3.7.5.3.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.7.5.3.m1.1.1.1.2" xref="S4.T3.7.5.3.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.7.5.3.m1.1.1.1.1" xref="S4.T3.7.5.3.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.7.5.3.m1.1.1.1.1.2" xref="S4.T3.7.5.3.m1.1.1.1.1.2.cmml">4.71</mn><mo mathsize="80%" id="S4.T3.7.5.3.m1.1.1.1.1.1" xref="S4.T3.7.5.3.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.7.5.3.m1.1.1.1.3" xref="S4.T3.7.5.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.7.5.3.m1.1b"><apply id="S4.T3.7.5.3.m1.1.1.1.1.cmml" xref="S4.T3.7.5.3.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.7.5.3.m1.1.1.1.1.1.cmml" xref="S4.T3.7.5.3.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.7.5.3.m1.1.1.1.1.2.cmml" xref="S4.T3.7.5.3.m1.1.1.1.1.2">4.71</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.5.3.m1.1c">(4.71\%)</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T3.10.8" class="ltx_tr">
<th id="S4.T3.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TR +<math id="S4.T3.8.6.1.m1.1" class="ltx_Math" alttext="W^{*}_{tr}" display="inline"><semantics id="S4.T3.8.6.1.m1.1a"><msubsup id="S4.T3.8.6.1.m1.1.1" xref="S4.T3.8.6.1.m1.1.1.cmml"><mi id="S4.T3.8.6.1.m1.1.1.2.2" xref="S4.T3.8.6.1.m1.1.1.2.2.cmml">W</mi><mrow id="S4.T3.8.6.1.m1.1.1.3" xref="S4.T3.8.6.1.m1.1.1.3.cmml"><mi id="S4.T3.8.6.1.m1.1.1.3.2" xref="S4.T3.8.6.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.8.6.1.m1.1.1.3.1" xref="S4.T3.8.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.8.6.1.m1.1.1.3.3" xref="S4.T3.8.6.1.m1.1.1.3.3.cmml">r</mi></mrow><mo id="S4.T3.8.6.1.m1.1.1.2.3" xref="S4.T3.8.6.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.T3.8.6.1.m1.1b"><apply id="S4.T3.8.6.1.m1.1.1.cmml" xref="S4.T3.8.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.8.6.1.m1.1.1.1.cmml" xref="S4.T3.8.6.1.m1.1.1">subscript</csymbol><apply id="S4.T3.8.6.1.m1.1.1.2.cmml" xref="S4.T3.8.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.8.6.1.m1.1.1.2.1.cmml" xref="S4.T3.8.6.1.m1.1.1">superscript</csymbol><ci id="S4.T3.8.6.1.m1.1.1.2.2.cmml" xref="S4.T3.8.6.1.m1.1.1.2.2">𝑊</ci><times id="S4.T3.8.6.1.m1.1.1.2.3.cmml" xref="S4.T3.8.6.1.m1.1.1.2.3"></times></apply><apply id="S4.T3.8.6.1.m1.1.1.3.cmml" xref="S4.T3.8.6.1.m1.1.1.3"><times id="S4.T3.8.6.1.m1.1.1.3.1.cmml" xref="S4.T3.8.6.1.m1.1.1.3.1"></times><ci id="S4.T3.8.6.1.m1.1.1.3.2.cmml" xref="S4.T3.8.6.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T3.8.6.1.m1.1.1.3.3.cmml" xref="S4.T3.8.6.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.6.1.m1.1c">W^{*}_{tr}</annotation></semantics></math>
</th>
<td id="S4.T3.9.7.2" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.57 <math id="S4.T3.9.7.2.m1.1" class="ltx_Math" alttext="(3.63\%)" display="inline"><semantics id="S4.T3.9.7.2.m1.1a"><mrow id="S4.T3.9.7.2.m1.1.1.1" xref="S4.T3.9.7.2.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.9.7.2.m1.1.1.1.2" xref="S4.T3.9.7.2.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.9.7.2.m1.1.1.1.1" xref="S4.T3.9.7.2.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.9.7.2.m1.1.1.1.1.2" xref="S4.T3.9.7.2.m1.1.1.1.1.2.cmml">3.63</mn><mo mathsize="80%" id="S4.T3.9.7.2.m1.1.1.1.1.1" xref="S4.T3.9.7.2.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.9.7.2.m1.1.1.1.3" xref="S4.T3.9.7.2.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.9.7.2.m1.1b"><apply id="S4.T3.9.7.2.m1.1.1.1.1.cmml" xref="S4.T3.9.7.2.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.9.7.2.m1.1.1.1.1.1.cmml" xref="S4.T3.9.7.2.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.9.7.2.m1.1.1.1.1.2.cmml" xref="S4.T3.9.7.2.m1.1.1.1.1.2">3.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.7.2.m1.1c">(3.63\%)</annotation></semantics></math>
</td>
<td id="S4.T3.10.8.3" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.32 <math id="S4.T3.10.8.3.m1.1" class="ltx_Math" alttext="(3.62\%)" display="inline"><semantics id="S4.T3.10.8.3.m1.1a"><mrow id="S4.T3.10.8.3.m1.1.1.1" xref="S4.T3.10.8.3.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.10.8.3.m1.1.1.1.2" xref="S4.T3.10.8.3.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.10.8.3.m1.1.1.1.1" xref="S4.T3.10.8.3.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.10.8.3.m1.1.1.1.1.2" xref="S4.T3.10.8.3.m1.1.1.1.1.2.cmml">3.62</mn><mo mathsize="80%" id="S4.T3.10.8.3.m1.1.1.1.1.1" xref="S4.T3.10.8.3.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.10.8.3.m1.1.1.1.3" xref="S4.T3.10.8.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.10.8.3.m1.1b"><apply id="S4.T3.10.8.3.m1.1.1.1.1.cmml" xref="S4.T3.10.8.3.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.10.8.3.m1.1.1.1.1.1.cmml" xref="S4.T3.10.8.3.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.10.8.3.m1.1.1.1.1.2.cmml" xref="S4.T3.10.8.3.m1.1.1.1.1.2">3.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.8.3.m1.1c">(3.62\%)</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T3.13.11" class="ltx_tr">
<th id="S4.T3.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TRA-R +<math id="S4.T3.11.9.1.m1.1" class="ltx_Math" alttext="W^{*}_{tra}" display="inline"><semantics id="S4.T3.11.9.1.m1.1a"><msubsup id="S4.T3.11.9.1.m1.1.1" xref="S4.T3.11.9.1.m1.1.1.cmml"><mi id="S4.T3.11.9.1.m1.1.1.2.2" xref="S4.T3.11.9.1.m1.1.1.2.2.cmml">W</mi><mrow id="S4.T3.11.9.1.m1.1.1.3" xref="S4.T3.11.9.1.m1.1.1.3.cmml"><mi id="S4.T3.11.9.1.m1.1.1.3.2" xref="S4.T3.11.9.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.11.9.1.m1.1.1.3.1" xref="S4.T3.11.9.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.11.9.1.m1.1.1.3.3" xref="S4.T3.11.9.1.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T3.11.9.1.m1.1.1.3.1a" xref="S4.T3.11.9.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.11.9.1.m1.1.1.3.4" xref="S4.T3.11.9.1.m1.1.1.3.4.cmml">a</mi></mrow><mo id="S4.T3.11.9.1.m1.1.1.2.3" xref="S4.T3.11.9.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.T3.11.9.1.m1.1b"><apply id="S4.T3.11.9.1.m1.1.1.cmml" xref="S4.T3.11.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.11.9.1.m1.1.1.1.cmml" xref="S4.T3.11.9.1.m1.1.1">subscript</csymbol><apply id="S4.T3.11.9.1.m1.1.1.2.cmml" xref="S4.T3.11.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.11.9.1.m1.1.1.2.1.cmml" xref="S4.T3.11.9.1.m1.1.1">superscript</csymbol><ci id="S4.T3.11.9.1.m1.1.1.2.2.cmml" xref="S4.T3.11.9.1.m1.1.1.2.2">𝑊</ci><times id="S4.T3.11.9.1.m1.1.1.2.3.cmml" xref="S4.T3.11.9.1.m1.1.1.2.3"></times></apply><apply id="S4.T3.11.9.1.m1.1.1.3.cmml" xref="S4.T3.11.9.1.m1.1.1.3"><times id="S4.T3.11.9.1.m1.1.1.3.1.cmml" xref="S4.T3.11.9.1.m1.1.1.3.1"></times><ci id="S4.T3.11.9.1.m1.1.1.3.2.cmml" xref="S4.T3.11.9.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T3.11.9.1.m1.1.1.3.3.cmml" xref="S4.T3.11.9.1.m1.1.1.3.3">𝑟</ci><ci id="S4.T3.11.9.1.m1.1.1.3.4.cmml" xref="S4.T3.11.9.1.m1.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.9.1.m1.1c">W^{*}_{tra}</annotation></semantics></math>
</th>
<td id="S4.T3.12.10.2" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.47 <math id="S4.T3.12.10.2.m1.1" class="ltx_Math" alttext="(5.36\%)" display="inline"><semantics id="S4.T3.12.10.2.m1.1a"><mrow id="S4.T3.12.10.2.m1.1.1.1" xref="S4.T3.12.10.2.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.12.10.2.m1.1.1.1.2" xref="S4.T3.12.10.2.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.12.10.2.m1.1.1.1.1" xref="S4.T3.12.10.2.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.12.10.2.m1.1.1.1.1.2" xref="S4.T3.12.10.2.m1.1.1.1.1.2.cmml">5.36</mn><mo mathsize="80%" id="S4.T3.12.10.2.m1.1.1.1.1.1" xref="S4.T3.12.10.2.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.12.10.2.m1.1.1.1.3" xref="S4.T3.12.10.2.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.12.10.2.m1.1b"><apply id="S4.T3.12.10.2.m1.1.1.1.1.cmml" xref="S4.T3.12.10.2.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.12.10.2.m1.1.1.1.1.1.cmml" xref="S4.T3.12.10.2.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.12.10.2.m1.1.1.1.1.2.cmml" xref="S4.T3.12.10.2.m1.1.1.1.1.2">5.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.10.2.m1.1c">(5.36\%)</annotation></semantics></math>
</td>
<td id="S4.T3.13.11.3" class="ltx_td ltx_align_right" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T3.13.11.3.1" class="ltx_text ltx_font_bold">5.15 <math id="S4.T3.13.11.3.1.m1.1" class="ltx_Math" alttext="(6.70\%)" display="inline"><semantics id="S4.T3.13.11.3.1.m1.1a"><mrow id="S4.T3.13.11.3.1.m1.1.1.1" xref="S4.T3.13.11.3.1.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.13.11.3.1.m1.1.1.1.2" xref="S4.T3.13.11.3.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.13.11.3.1.m1.1.1.1.1" xref="S4.T3.13.11.3.1.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.13.11.3.1.m1.1.1.1.1.2" xref="S4.T3.13.11.3.1.m1.1.1.1.1.2.cmml">6.70</mn><mo mathsize="80%" id="S4.T3.13.11.3.1.m1.1.1.1.1.1" xref="S4.T3.13.11.3.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.13.11.3.1.m1.1.1.1.3" xref="S4.T3.13.11.3.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.13.11.3.1.m1.1b"><apply id="S4.T3.13.11.3.1.m1.1.1.1.1.cmml" xref="S4.T3.13.11.3.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.13.11.3.1.m1.1.1.1.1.1.cmml" xref="S4.T3.13.11.3.1.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.13.11.3.1.m1.1.1.1.1.2.cmml" xref="S4.T3.13.11.3.1.m1.1.1.1.1.2">6.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.11.3.1.m1.1c">(6.70\%)</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T3.16.14" class="ltx_tr">
<th id="S4.T3.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">TRA-RW +<math id="S4.T3.14.12.1.m1.1" class="ltx_Math" alttext="W^{*}_{tra+}" display="inline"><semantics id="S4.T3.14.12.1.m1.1a"><msubsup id="S4.T3.14.12.1.m1.1.1" xref="S4.T3.14.12.1.m1.1.1.cmml"><mi id="S4.T3.14.12.1.m1.1.1.2.2" xref="S4.T3.14.12.1.m1.1.1.2.2.cmml">W</mi><mrow id="S4.T3.14.12.1.m1.1.1.3" xref="S4.T3.14.12.1.m1.1.1.3.cmml"><mrow id="S4.T3.14.12.1.m1.1.1.3.2" xref="S4.T3.14.12.1.m1.1.1.3.2.cmml"><mi id="S4.T3.14.12.1.m1.1.1.3.2.2" xref="S4.T3.14.12.1.m1.1.1.3.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.14.12.1.m1.1.1.3.2.1" xref="S4.T3.14.12.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.T3.14.12.1.m1.1.1.3.2.3" xref="S4.T3.14.12.1.m1.1.1.3.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T3.14.12.1.m1.1.1.3.2.1a" xref="S4.T3.14.12.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.T3.14.12.1.m1.1.1.3.2.4" xref="S4.T3.14.12.1.m1.1.1.3.2.4.cmml">a</mi></mrow><mo id="S4.T3.14.12.1.m1.1.1.3.3" xref="S4.T3.14.12.1.m1.1.1.3.3.cmml">+</mo></mrow><mo id="S4.T3.14.12.1.m1.1.1.2.3" xref="S4.T3.14.12.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.T3.14.12.1.m1.1b"><apply id="S4.T3.14.12.1.m1.1.1.cmml" xref="S4.T3.14.12.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.14.12.1.m1.1.1.1.cmml" xref="S4.T3.14.12.1.m1.1.1">subscript</csymbol><apply id="S4.T3.14.12.1.m1.1.1.2.cmml" xref="S4.T3.14.12.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.14.12.1.m1.1.1.2.1.cmml" xref="S4.T3.14.12.1.m1.1.1">superscript</csymbol><ci id="S4.T3.14.12.1.m1.1.1.2.2.cmml" xref="S4.T3.14.12.1.m1.1.1.2.2">𝑊</ci><times id="S4.T3.14.12.1.m1.1.1.2.3.cmml" xref="S4.T3.14.12.1.m1.1.1.2.3"></times></apply><apply id="S4.T3.14.12.1.m1.1.1.3.cmml" xref="S4.T3.14.12.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T3.14.12.1.m1.1.1.3.1.cmml" xref="S4.T3.14.12.1.m1.1.1.3">limit-from</csymbol><apply id="S4.T3.14.12.1.m1.1.1.3.2.cmml" xref="S4.T3.14.12.1.m1.1.1.3.2"><times id="S4.T3.14.12.1.m1.1.1.3.2.1.cmml" xref="S4.T3.14.12.1.m1.1.1.3.2.1"></times><ci id="S4.T3.14.12.1.m1.1.1.3.2.2.cmml" xref="S4.T3.14.12.1.m1.1.1.3.2.2">𝑡</ci><ci id="S4.T3.14.12.1.m1.1.1.3.2.3.cmml" xref="S4.T3.14.12.1.m1.1.1.3.2.3">𝑟</ci><ci id="S4.T3.14.12.1.m1.1.1.3.2.4.cmml" xref="S4.T3.14.12.1.m1.1.1.3.2.4">𝑎</ci></apply><plus id="S4.T3.14.12.1.m1.1.1.3.3.cmml" xref="S4.T3.14.12.1.m1.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.12.1.m1.1c">W^{*}_{tra+}</annotation></semantics></math>
</th>
<td id="S4.T3.15.13.2" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;"><span id="S4.T3.15.13.2.1" class="ltx_text ltx_font_bold">5.46 <math id="S4.T3.15.13.2.1.m1.1" class="ltx_Math" alttext="(5.53\%)" display="inline"><semantics id="S4.T3.15.13.2.1.m1.1a"><mrow id="S4.T3.15.13.2.1.m1.1.1.1" xref="S4.T3.15.13.2.1.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.15.13.2.1.m1.1.1.1.2" xref="S4.T3.15.13.2.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.15.13.2.1.m1.1.1.1.1" xref="S4.T3.15.13.2.1.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.15.13.2.1.m1.1.1.1.1.2" xref="S4.T3.15.13.2.1.m1.1.1.1.1.2.cmml">5.53</mn><mo mathsize="80%" id="S4.T3.15.13.2.1.m1.1.1.1.1.1" xref="S4.T3.15.13.2.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.15.13.2.1.m1.1.1.1.3" xref="S4.T3.15.13.2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.15.13.2.1.m1.1b"><apply id="S4.T3.15.13.2.1.m1.1.1.1.1.cmml" xref="S4.T3.15.13.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.15.13.2.1.m1.1.1.1.1.1.cmml" xref="S4.T3.15.13.2.1.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.15.13.2.1.m1.1.1.1.1.2.cmml" xref="S4.T3.15.13.2.1.m1.1.1.1.1.2">5.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.13.2.1.m1.1c">(5.53\%)</annotation></semantics></math></span></td>
<td id="S4.T3.16.14.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:-1.25pt;padding-bottom:-1.25pt;">5.23 <math id="S4.T3.16.14.3.m1.1" class="ltx_Math" alttext="(5.25\%)" display="inline"><semantics id="S4.T3.16.14.3.m1.1a"><mrow id="S4.T3.16.14.3.m1.1.1.1" xref="S4.T3.16.14.3.m1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S4.T3.16.14.3.m1.1.1.1.2" xref="S4.T3.16.14.3.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T3.16.14.3.m1.1.1.1.1" xref="S4.T3.16.14.3.m1.1.1.1.1.cmml"><mn mathsize="80%" id="S4.T3.16.14.3.m1.1.1.1.1.2" xref="S4.T3.16.14.3.m1.1.1.1.1.2.cmml">5.25</mn><mo mathsize="80%" id="S4.T3.16.14.3.m1.1.1.1.1.1" xref="S4.T3.16.14.3.m1.1.1.1.1.1.cmml">%</mo></mrow><mo maxsize="80%" minsize="80%" id="S4.T3.16.14.3.m1.1.1.1.3" xref="S4.T3.16.14.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.16.14.3.m1.1b"><apply id="S4.T3.16.14.3.m1.1.1.1.1.cmml" xref="S4.T3.16.14.3.m1.1.1.1"><csymbol cd="latexml" id="S4.T3.16.14.3.m1.1.1.1.1.1.cmml" xref="S4.T3.16.14.3.m1.1.1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.16.14.3.m1.1.1.1.1.2.cmml" xref="S4.T3.16.14.3.m1.1.1.1.1.2">5.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.14.3.m1.1c">(5.25\%)</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Interpolation with ASR signals ‣ 4 Results ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results when interpolating the log-probability provided by the various models with per-hypothesis signals extracted from the ASR decoding process (§<a href="#S3.SS4" title="3.4 Interpolation with ASR decoding signals ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>). The incorporation of an additional external LM (§<a href="#S3.SS3.SSS2" title="3.3.2 4-gram LM with Katz back-off ‣ 3.3 Rescoring/rewriting methods under comparison ‣ 3 Experimental Setup ‣ Transformer-based Model for ASR N-Best Rescoring and Rewriting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>), which constitutes a traditional rescoring approach, yields an additional improvement of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\sim}4\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">∼</mo><mrow id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mn id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">4</mn><mo id="S4.SS2.p1.1.m1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">absent</csymbol><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">{\sim}4\%</annotation></semantics></math>. However, compared to the 4-gram LM, the TRA models perform better and yield an relative improvement between <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="5.3\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">5.3</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">5.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">5.3\%</annotation></semantics></math> and <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="6.7\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">6.7</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">6.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">6.7\%</annotation></semantics></math> on the full collection, and the music sub-collection, resp.
This leads us to the following conclusion: while training a LM independently of the ASR system's error distribution is computationally simpler, as it eliminates the need for TTS and ASR decoding to generate N-best lists. However, training a Transformer using the ASR system's N-best list yields superior improvements because the Transformer approach can (a) make use of additional contextual information available in the N-best list (e.g., the number of hypotheses, segments that differ across hypotheses), and
(b) learn to correct error patterns made by the specific ASR system it was trained against.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a novel Transformer-based model capable of rescoring and rewriting ASR hypotheses. We also propose a new discriminative sequence training objective MQSD that can work well with cross-entropy based training for both rescore and rewrite tasks. Given an N-best list as text input, our TRA model outputs both predicted text and <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">query similarity scores</span> for N-best re-ranking. The predicted text can be used to override the top hypothesis if its sequence loss exceeds a threshold.
As a standalone model, our TRA achieves up to <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="8.6\%" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mn id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">8.6</mn><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">8.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">8.6\%</annotation></semantics></math> WER improvement over the ASR baseline on in-domain test sets.
As an external LM for ASR interpolations, our TRA model also outperforms the 4-gram LM and the baseline TR model.

<br class="ltx_break"><span id="S5.p1.1.2" class="ltx_text ltx_font_bold">Acknowledgments.</span> We thank Russ Webb, Tatiana Likhomanenko, Tim Ng, Thiago Fraga-Silva, and the anonymous reviewers for their comments and feedback.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pusateri et al. [2019]</span>
<span class="ltx_bibblock">
E. Pusateri, C. Van Gysel, R. Botros, S. Badaskar, M. Hannemann, Y. Oualil, and
I. Oparin, ``Connecting and Comparing Language Model Interpolation
Techniques,'' <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gondala et al. [2021]</span>
<span class="ltx_bibblock">
S. Gondala, L. Verwimp, E. Pusateri, M. Tsagkias, and C. Van Gysel,
``Error-driven pruning of language models for virtual assistants,'' in
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.   IEEE, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Gysel [2023]</span>
<span class="ltx_bibblock">
C. Van Gysel, ``Modeling spoken information queries for virtual assistants:
Open problems, challenges and opportunities,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">SIGIR</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2024]</span>
<span class="ltx_bibblock">
Y. Zhang, S. Gondala, T. Fraga-Silva, and C. Van Gysel, ``Server-side rescoring
of spoken entity-centric knowledge queries for virtual assistants,''
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Journal of Speech Technology</em>, 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sannigrahi et al. [2024]</span>
<span class="ltx_bibblock">
S. Sannigrahi, T. Fraga-Silva, Y. Oualil, and C. Van Gysel, ``Synthetic query
generation using large language models for virtual assistants,'' in
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">SIGIR</em>, 2024.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katz [1987]</span>
<span class="ltx_bibblock">
S. M. Katz, ``Estimation of probabilities from sparse data for the language
model component of a speech recognizer,'' <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ASSP</em>, vol. 35, 1987.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. [2019]</span>
<span class="ltx_bibblock">
J. Guo, T. N. Sainath, and R. J. Weiss, ``A spelling correction model for
end-to-end speech recognition,'' <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang and Peng [2020]</span>
<span class="ltx_bibblock">
H. Huang and F. Peng, ``An empirical study of efficient asr rescoring with
transformers,'' in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2022]</span>
<span class="ltx_bibblock">
L. Xu, Y. Gu, J. Kolehmainen, H. Khan, A. Gandhe, A. Rastrow, A. Stolcke, and
I. Bulyko, ``RescoreBERT: Discriminative speech recognition rescoring with
BERT,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.   IEEE, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin et al. [2019]</span>
<span class="ltx_bibblock">
J. Shin, Y. Lee, and K. Jung, ``Effective sentence scoring method using BERT
for speech recognition,'' in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Asian Conference on Machine
Learning</em>.   PMLR, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fohr and Illina [2021]</span>
<span class="ltx_bibblock">
D. Fohr and I. Illina, ``BERT-based semantic model for rescoring n-best speech
recognition list,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hrinchuk et al. [2020]</span>
<span class="ltx_bibblock">
O. Hrinchuk, M. Popova, and B. Ginsburg, ``Correction of automatic speech
recognition with transformer sequence-to-sequence model,'' in
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.   IEEE, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. [2014]</span>
<span class="ltx_bibblock">
I. Sutskever, O. Vinyals, and Q. V. Le, ``Sequence to sequence learning with
neural networks,'' <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, vol. 27, 2014.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kenton and Toutanova [2019]</span>
<span class="ltx_bibblock">
J. D. M.-W. C. Kenton and L. K. Toutanova, ``Bert: Pre-training of deep
bidirectional transformers for language understanding,'' in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">NAACL-HLT</em>,
vol. 1, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prabhavalkar et al. [2018]</span>
<span class="ltx_bibblock">
R. Prabhavalkar, T. N. Sainath, Y. Wu, P. Nguyen, Z. Chen, C.-C. Chiu, and
A. Kannan, ``Minimum word error rate training for attention-based
sequence-to-sequence models,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.   IEEE, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pandey et al. [2022]</span>
<span class="ltx_bibblock">
P. Pandey, S. D. Torres, A. O. Bayer, A. Gandhe, and V. Leutnant,
``Lattention: Lattice-attention in ASR rescoring,'' in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.   IEEE, 2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2021]</span>
<span class="ltx_bibblock">
K. Hu, R. Pang, T. N. Sainath, and T. Strohman, ``Transformer based
deliberation for two-pass speech recognition,'' in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">SLT</em>.   IEEE, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2022]</span>
<span class="ltx_bibblock">
K. Hu, T. N. Sainath, Y. He, R. Prabhavalkar, T. Strohman, S. Mavandadi, and
W. Wang, ``Improving deliberation by text-only and semi-supervised
training,'' in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sainath et al. [2019]</span>
<span class="ltx_bibblock">
T. N. Sainath, R. Pang, D. Rybach, Y. He, R. Prabhavalkar, W. Li, M. Visontai,
Q. Liang, T. Strohman, Y. Wu <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Two-pass end-to-end speech
recognition,'' <em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic">Interspeech</em>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Variani et al. [2020]</span>
<span class="ltx_bibblock">
E. Variani, T. Chen, J. Apfel, B. Ramabhadran, S. Lee, and P. Moreno, ``Neural
oracle search on n-best hypotheses,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2020, pp. 7824–7828.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Variani et al. [2022]</span>
<span class="ltx_bibblock">
E. Variani, M. Riley, D. Rybach, C. Allauzen, T. Chen, and B. Ramabhadran, ``On
weight interpolation of the hybrid autoregressive transducer model,'' in
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Comanducci et al. [2021]</span>
<span class="ltx_bibblock">
L. Comanducci, P. Bestagini, M. Tagliasacchi, A. Sarti, and S. Tubaro,
``Reconstructing Speech From CNN Embeddings,'' <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Letters</em>, vol. 28, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, ``Attention is all you need,''
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. [2021]</span>
<span class="ltx_bibblock">
Z. Yao, D. Wu, X. Wang, B. Zhang, F. Yu, C. Yang, Z. Peng, X. Chen, L. Xie, and
X. Lei, ``Wenet: Production oriented streaming and non-streaming end-to-end
speech recognition toolkit,'' in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao et al. [2015]</span>
<span class="ltx_bibblock">
Y. Miao, M. Gowayyed, and F. Metze, ``Eesen: End-to-end speech recognition
using deep rnn models and wfst-based decoding,'' in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ASRU</em>, 2015.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dolfing and Hetherington [2001]</span>
<span class="ltx_bibblock">
H. J. Dolfing and I. L. Hetherington, ``Incremental language models for speech
recognition using finite-state transducers,'' in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ASRU</em>, 2001.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lei et al. [2023]</span>
<span class="ltx_bibblock">
Z. Lei, M. Xu, S. Han, L. Liu, Z. Huang, T. Ng, Y. Zhang, E. Pusateri,
M. Hannemann, Y. Deng <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Acoustic model fusion for end-to-end
speech recognition,'' in <em id="bib.bib27.2.2" class="ltx_emph ltx_font_italic">ASRU</em>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Gysel et al. [2022]</span>
<span class="ltx_bibblock">
C. Van Gysel, M. Hannemann, E. Pusateri, Y. Oualil, and I. Oparin,
``Space-efficient representation of entity-centric query language models,''
in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo and Richardson [2018]</span>
<span class="ltx_bibblock">
T. Kudo and J. Richardson, ``SentencePiece: A simple and language independent
subword tokenizer and detokenizer for Neural Text Processing,''
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jurafsky and Martin [2023]</span>
<span class="ltx_bibblock">
D. Jurafsky and J. H. Martin, <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Speech and Language Processing, 3rd edition
(February 4, 2024 draft)</em>.   Prentice
Hall, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Powell [1964]</span>
<span class="ltx_bibblock">
M. J. D. Powell, ``An efficient method for finding the minimum of a function of
several variables without calculating derivatives,'' <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">The Computer
Journal</em>, vol. 7, no. 2, pp. 155–162, 1964.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.08206" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.08207" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.08207">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.08207" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.08208" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 23:24:10 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
