<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.08597] Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation</title><meta property="og:description" content="Recent advancements in integrating speech information into large language models (LLMs) have significantly improved automatic speech recognition (ASR) accuracy. However, existing methods often constrained by the capabi…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.08597">

<!--Generated on Sat Oct  5 20:41:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
large language model,  retrieval-augmented generation,  speech retrieval,  speech recognition,  in-context learning.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shaojun Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">lishaojun18@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hengchao Shang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">shanghengchao@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Daimeng Wei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">weidaimeng@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiaxin Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">guojiaxin1@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zongyao Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">lizongyao@huawei.com 
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xianghui He
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id6.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">hexianghui@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Min Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">zhangmin186@huawei.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id8.1.id1" class="ltx_text ltx_font_italic">Huawei TSC</span>
<br class="ltx_break">Beijing, China 
<br class="ltx_break">yanghao30@huawei.com
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Recent advancements in integrating speech information into large language models (LLMs) have significantly improved automatic speech recognition (ASR) accuracy. However, existing methods often constrained by the capabilities of the speech encoders under varied acoustic conditions, such as accents. To address this, we propose LA-RAG, a novel Retrieval-Augmented Generation (RAG) paradigm for LLM-based ASR. LA-RAG leverages fine-grained token-level speech datastores and a speech-to-speech retrieval mechanism to enhance ASR accuracy via LLM in-context learning (ICL) capabilities. Experiments on Mandarin and various Chinese dialect datasets demonstrate significant improvements in ASR accuracy compared to existing methods, validating the effectiveness of our approach, especially in handling accent variations.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
large language model, retrieval-augmented generation, speech retrieval, speech recognition, in-context learning.

</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2409.08597/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="363" height="228" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of proposed LA-RAG, The speech tokenizer is employed to generate aligned speech tokens and text tokens. With the 1th token as an example, the input of A’ represents an incorrect token, with the corresponding speech token indicated in green, which is one of retention of N-best pruning. This speech token is subsequently used to query the datastore. The retrieval examples include the mappings between speech token and the correct token A. Ultimately, the examples, the input speech tokens and the N-best results, are transmitted to the LLM prompt for ICL via the adapter and embed process.</figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In recent years, there has been growing interest in integrating speech information into LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. These models have demonstrated remarkable efficacy in ICL capabilities to improve the ASR accuracy (LLM-based ASR). Initial studies typically input pure textual transcriptions into the LLM, often combining the ASR N-best results with instructions to prompt the LLM for error correction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. In these studies, the LLM primarily serves as a text reranker or token selector. Concurrently, other studies have attempted to integrate pre-trained ASR models (most commonly using the speech encoder part) into LLMs with a modality adapter, such as Q-former, attention, or a projection to align the speech feature space with the textual space of the LLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. These approaches generally show improvements by leveraging rich acoustic signals. Further research has combined N-best results with speech encoders and even added denoising information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Such multi-source information integration usually leads to better performance. However, the performance ceiling of these methods is often limited by the capabilities of speech encoders. This is particularly evident when there is an acoustic feature mismatch between the training and test data of the speech encoder, such as in scenarios with accents where the encoder is insufficiently trained and the correct tokens do not appear in the N-best transcriptions. These methods struggle under such conditions. Usually, for traditional ASR models, domain adaptation or speaker adaptation can be used to address the issue of insufficient training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. However, for LLM-based ASR, aside from the costly fine-tuning, this can be achieved through Retrieval-Augmented Generation (RAG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, allowing the LLM to learn external knowledge during inference.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Compared to token-level or semantic-level matching in text-based RAG, the challenge of RAG in LLM-based ASR stems from how to accurately retrieve relevant speech examples and how to prompt LLMs from inherently high sampling rate acoustic data. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> explores and proposes a speech LLM capable of performing unseen classification tasks for the first time. COSMIC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> pioneered this capability in more complex ASR tasks, showing significant ASR accuracy gains in context-biased tasks. However, the above methods only use random sampling for example selection and lack exploration of how to retrieve more similar examples. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> first explored RAG in LLM-based ASR and created a retrieval datastore. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposed using RAG to enhance SLU task. However, they only focused on entity retrieval or only used coarse-grained speech retrieval, which makes accurate speech matching difficult.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The construction of a fine-grained speech datastore for the LLM-based ASR task is hindered by a lack of precise speech-transcript alignment and the enormous volume of frame-level entries. Recently, in the speech retrieval augmentation task for small models, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> separately used Connectionist Temporal Classification (CTC) and Attention Encoder-Decoder (AED) pre-trained ASR models as speech tokenizers to force-align the speech features and text tokens. They established key-value pair mappings between speech features and text transcription tokens and retrieved the keys for each decoding step with a query extracted from hidden states, achieving effective performance. However, due to the large number of LLM parameters, the speed and storage consumption would be enormous if directly applied to LLM-based ASR.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Therefore, we propose a new <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">L</span>LM-based <span id="S1.p4.1.2" class="ltx_text ltx_font_bold">A</span>SR <span id="S1.p4.1.3" class="ltx_text ltx_font_bold">RAG</span> (<span id="S1.p4.1.4" class="ltx_text ltx_font_bold">LA-RAG</span>) paradigm utilizing the above speech tokenizers, fully leveraging the LLM’s ICL capabilities. Specifically, in the database creation phase, speech tokenizers are used to obtain token-level precise alignment knowledge between speech hidden states and golden transcription tokens as key-value pairs, and the mapping between each key-value pair and its whole sequence is also stored as a speech inverted index. In the generation phase, the ASR transcription is used to perform the same speech tokenizing on the input speech, and each speech token obtained is used to query the index. By grouping and filtering policies, similar examples at the sequence level are obtained. In addition, to reduce the learning burden on the model, a pruning policy is added to remove tokens with low error probability. Finally, we input the speech and its golden transcription example pairs, together with the input speech tokens and N-best transcriptions, as prompts into the LLM. Here, we introduce a speech adapter to align speech and text spaces, and a model adapter to learn the mapping relationship of speech tokens to the correct text tokens. Experiments on Mandarin and various Chinese dialect datasets demonstrate significant improvements in ASR accuracy compared to existing methods, especially in handling accent variations.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Our contributions are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a fine-grained retrieval method for speech-to-speech, implemented using a pre-trained ASR model through a simple forced alignment technique.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce a novel RAG paradigm for LLM-based ASR. By enabling the LLM to learn the mapping relationship between speech tokens and text tokens.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We apply these methods to LLM-based ASR, leading to a significant enhancement in the accuracy of ASR results.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>CER (%) of our LA-RAG compare to others on Mandarin and various Chinese dialect datasets</figcaption>
<table id="S1.T1.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.T1.15.16.1" class="ltx_tr">
<td id="S1.T1.15.16.1.1" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S1.T1.15.16.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">w/ Datastore</td>
<td id="S1.T1.15.16.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">w/ LLM</td>
<td id="S1.T1.15.16.1.4" class="ltx_td ltx_align_center ltx_border_t">AISHELL</td>
<td id="S1.T1.15.16.1.5" class="ltx_td ltx_align_center ltx_border_t">Mandarin</td>
<td id="S1.T1.15.16.1.6" class="ltx_td ltx_align_center ltx_border_t">JiangHuai</td>
<td id="S1.T1.15.16.1.7" class="ltx_td ltx_align_center ltx_border_t">JiLu</td>
<td id="S1.T1.15.16.1.8" class="ltx_td ltx_align_center ltx_border_t">ZhongYuan</td>
<td id="S1.T1.15.16.1.9" class="ltx_td ltx_align_center ltx_border_t">Southwestern</td>
<td id="S1.T1.15.16.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">Avg.</td>
</tr>
<tr id="S1.T1.2.2" class="ltx_tr">
<td id="S1.T1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Base ASR</td>
<td id="S1.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.1.1.1.m1.1a"><mo id="S1.T1.1.1.1.m1.1.1" xref="S1.T1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.m1.1b"><times id="S1.T1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.2.2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.2.2.2.m1.1a"><mo id="S1.T1.2.2.2.m1.1.1" xref="S1.T1.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.2.m1.1b"><times id="S1.T1.2.2.2.m1.1.1.cmml" xref="S1.T1.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">5.18</td>
<td id="S1.T1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">12.18</td>
<td id="S1.T1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">43.94</td>
<td id="S1.T1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">31.61</td>
<td id="S1.T1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">34.01</td>
<td id="S1.T1.2.2.9" class="ltx_td ltx_align_center ltx_border_t">31.42</td>
<td id="S1.T1.2.2.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">26.39</td>
</tr>
<tr id="S1.T1.4.4" class="ltx_tr">
<td id="S1.T1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">HyPoradise</td>
<td id="S1.T1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.3.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.3.3.1.m1.1a"><mo id="S1.T1.3.3.1.m1.1.1" xref="S1.T1.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.1.m1.1b"><times id="S1.T1.3.3.1.m1.1.1.cmml" xref="S1.T1.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.4.4.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.4.4.2.m1.1a"><mi mathvariant="normal" id="S1.T1.4.4.2.m1.1.1" xref="S1.T1.4.4.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.4.4.2.m1.1b"><ci id="S1.T1.4.4.2.m1.1.1.cmml" xref="S1.T1.4.4.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.4.4.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">4.91</td>
<td id="S1.T1.4.4.5" class="ltx_td ltx_align_center ltx_border_t">12.1</td>
<td id="S1.T1.4.4.6" class="ltx_td ltx_align_center ltx_border_t">43.57</td>
<td id="S1.T1.4.4.7" class="ltx_td ltx_align_center ltx_border_t">30.97</td>
<td id="S1.T1.4.4.8" class="ltx_td ltx_align_center ltx_border_t">33.98</td>
<td id="S1.T1.4.4.9" class="ltx_td ltx_align_center ltx_border_t">31.33</td>
<td id="S1.T1.4.4.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">26.14</td>
</tr>
<tr id="S1.T1.6.6" class="ltx_tr">
<td id="S1.T1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">Whispering LLaMA</td>
<td id="S1.T1.5.5.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.5.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.5.5.1.m1.1a"><mo id="S1.T1.5.5.1.m1.1.1" xref="S1.T1.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.5.5.1.m1.1b"><times id="S1.T1.5.5.1.m1.1.1.cmml" xref="S1.T1.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.5.5.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.6.6.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.6.6.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.6.6.2.m1.1a"><mi mathvariant="normal" id="S1.T1.6.6.2.m1.1.1" xref="S1.T1.6.6.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.6.6.2.m1.1b"><ci id="S1.T1.6.6.2.m1.1.1.cmml" xref="S1.T1.6.6.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.6.6.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.6.6.4" class="ltx_td ltx_align_center">4.69</td>
<td id="S1.T1.6.6.5" class="ltx_td ltx_align_center">11.93</td>
<td id="S1.T1.6.6.6" class="ltx_td ltx_align_center">43.02</td>
<td id="S1.T1.6.6.7" class="ltx_td ltx_align_center">30.88</td>
<td id="S1.T1.6.6.8" class="ltx_td ltx_align_center">33.53</td>
<td id="S1.T1.6.6.9" class="ltx_td ltx_align_center">31.07</td>
<td id="S1.T1.6.6.10" class="ltx_td ltx_nopad_r ltx_align_center">25.85</td>
</tr>
<tr id="S1.T1.9.9" class="ltx_tr">
<td id="S1.T1.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S1.T1.7.7.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.T1.7.7.1.m1.1a"><mi id="S1.T1.7.7.1.m1.1.1" xref="S1.T1.7.7.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.T1.7.7.1.m1.1b"><ci id="S1.T1.7.7.1.m1.1.1.cmml" xref="S1.T1.7.7.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.7.7.1.m1.1c">k</annotation></semantics></math>NN-CTC</td>
<td id="S1.T1.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.8.8.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.8.8.2.m1.1a"><mi mathvariant="normal" id="S1.T1.8.8.2.m1.1.1" xref="S1.T1.8.8.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.8.8.2.m1.1b"><ci id="S1.T1.8.8.2.m1.1.1.cmml" xref="S1.T1.8.8.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.8.8.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S1.T1.9.9.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.9.9.3.m1.1a"><mo id="S1.T1.9.9.3.m1.1.1" xref="S1.T1.9.9.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.9.9.3.m1.1b"><times id="S1.T1.9.9.3.m1.1.1.cmml" xref="S1.T1.9.9.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.9.9.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">4.83</td>
<td id="S1.T1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">12</td>
<td id="S1.T1.9.9.6" class="ltx_td ltx_align_center ltx_border_t">43.41</td>
<td id="S1.T1.9.9.7" class="ltx_td ltx_align_center ltx_border_t">30.71</td>
<td id="S1.T1.9.9.8" class="ltx_td ltx_align_center ltx_border_t">32.6</td>
<td id="S1.T1.9.9.9" class="ltx_td ltx_align_center ltx_border_t">30.63</td>
<td id="S1.T1.9.9.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">25.70</td>
</tr>
<tr id="S1.T1.12.12" class="ltx_tr">
<td id="S1.T1.10.10.1" class="ltx_td ltx_align_center ltx_border_r">LA-RAG<sub id="S1.T1.10.10.1.1" class="ltx_sub"><span id="S1.T1.10.10.1.1.1" class="ltx_text ltx_font_italic">CTC</span></sub>
</td>
<td id="S1.T1.11.11.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.11.11.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.11.11.2.m1.1a"><mi mathvariant="normal" id="S1.T1.11.11.2.m1.1.1" xref="S1.T1.11.11.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.11.11.2.m1.1b"><ci id="S1.T1.11.11.2.m1.1.1.cmml" xref="S1.T1.11.11.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.11.11.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.12.12.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.12.12.3.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.12.12.3.m1.1a"><mi mathvariant="normal" id="S1.T1.12.12.3.m1.1.1" xref="S1.T1.12.12.3.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.12.12.3.m1.1b"><ci id="S1.T1.12.12.3.m1.1.1.cmml" xref="S1.T1.12.12.3.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.12.12.3.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.12.12.4" class="ltx_td ltx_align_center"><span id="S1.T1.12.12.4.1" class="ltx_text ltx_font_bold">4.56</span></td>
<td id="S1.T1.12.12.5" class="ltx_td ltx_align_center">11.86</td>
<td id="S1.T1.12.12.6" class="ltx_td ltx_align_center"><span id="S1.T1.12.12.6.1" class="ltx_text ltx_font_bold">41.8</span></td>
<td id="S1.T1.12.12.7" class="ltx_td ltx_align_center"><span id="S1.T1.12.12.7.1" class="ltx_text ltx_font_bold">30.39</span></td>
<td id="S1.T1.12.12.8" class="ltx_td ltx_align_center"><span id="S1.T1.12.12.8.1" class="ltx_text ltx_font_bold">31.96</span></td>
<td id="S1.T1.12.12.9" class="ltx_td ltx_align_center">29.6</td>
<td id="S1.T1.12.12.10" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S1.T1.12.12.10.1" class="ltx_text ltx_font_bold">25.03</span></td>
</tr>
<tr id="S1.T1.15.15" class="ltx_tr">
<td id="S1.T1.13.13.1" class="ltx_td ltx_align_center ltx_border_r">LA-RAG<sub id="S1.T1.13.13.1.1" class="ltx_sub"><span id="S1.T1.13.13.1.1.1" class="ltx_text ltx_font_italic">AED</span></sub>
</td>
<td id="S1.T1.14.14.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.14.14.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.14.14.2.m1.1a"><mi mathvariant="normal" id="S1.T1.14.14.2.m1.1.1" xref="S1.T1.14.14.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.14.14.2.m1.1b"><ci id="S1.T1.14.14.2.m1.1.1.cmml" xref="S1.T1.14.14.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.14.14.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.15.15.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S1.T1.15.15.3.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S1.T1.15.15.3.m1.1a"><mi mathvariant="normal" id="S1.T1.15.15.3.m1.1.1" xref="S1.T1.15.15.3.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S1.T1.15.15.3.m1.1b"><ci id="S1.T1.15.15.3.m1.1.1.cmml" xref="S1.T1.15.15.3.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.15.15.3.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S1.T1.15.15.4" class="ltx_td ltx_align_center">4.61</td>
<td id="S1.T1.15.15.5" class="ltx_td ltx_align_center"><span id="S1.T1.15.15.5.1" class="ltx_text ltx_font_bold">11.69</span></td>
<td id="S1.T1.15.15.6" class="ltx_td ltx_align_center">42.11</td>
<td id="S1.T1.15.15.7" class="ltx_td ltx_align_center">30.65</td>
<td id="S1.T1.15.15.8" class="ltx_td ltx_align_center">32.25</td>
<td id="S1.T1.15.15.9" class="ltx_td ltx_align_center"><span id="S1.T1.15.15.9.1" class="ltx_text ltx_font_bold">29.56</span></td>
<td id="S1.T1.15.15.10" class="ltx_td ltx_nopad_r ltx_align_center">25.15</td>
</tr>
<tr id="S1.T1.15.17.2" class="ltx_tr">
<td id="S1.T1.15.17.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">Datastore size (Million Tokens)</td>
<td id="S1.T1.15.17.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">-</td>
<td id="S1.T1.15.17.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">-</td>
<td id="S1.T1.15.17.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">38.4</td>
<td id="S1.T1.15.17.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">12.7</td>
<td id="S1.T1.15.17.2.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.9</td>
<td id="S1.T1.15.17.2.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">1.1</td>
<td id="S1.T1.15.17.2.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">1.6</td>
<td id="S1.T1.15.17.2.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">1.4</td>
<td id="S1.T1.15.17.2.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t">9.35</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">As shown in Figure <a href="#S0.F1" title="Figure 1 ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we leverage RAG for LLM-based ASR, to Enhancing ASR transcript accuracy. Our method includes four main parts: speech tokenizer, datastore creation, speech retrieval and LLM prompt.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Speech Tokenizer</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.8" class="ltx_p">Given speech transcription pair <math id="S2.SS1.p1.1.m1.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S2.SS1.p1.1.m1.2a"><mrow id="S2.SS1.p1.1.m1.2.3.2" xref="S2.SS1.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.2.3.2.1" xref="S2.SS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.p1.1.m1.2.3.2.2" xref="S2.SS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" xref="S2.SS1.p1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.1.m1.2.3.2.3" xref="S2.SS1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.2b"><interval closure="open" id="S2.SS1.p1.1.m1.2.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.2"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑥</ci><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.2c">(x,y)</annotation></semantics></math>, we can extract the intermediate representations of <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">X</annotation></semantics></math>, denoted as <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="f(x)" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.1" xref="S2.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.2" xref="S2.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><times id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></times><ci id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2">𝑓</ci><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">f(x)</annotation></semantics></math>, by a pre-trained AED/CTC model. For simplify, we use the output of the final encoder(for CTC)/decoder(for AED) layer’s feed-forward network (FFN) as our speech token.
To be specific, for CTC model, improve from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, we use a more precise algorithm for forced alignment, described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, by generate a trellis matrix which represents the probability of labels aligned at time step and find the most likely path from the trellis matrix. Then, we can get each speech token <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="f(x_{t})" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.4.m4.1.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><times id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2"></times><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑓</ci><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">f(x_{t})</annotation></semantics></math> from <math id="S2.SS1.p1.5.m5.2" class="ltx_Math" alttext="f_{CTC}(x,y)" display="inline"><semantics id="S2.SS1.p1.5.m5.2a"><mrow id="S2.SS1.p1.5.m5.2.3" xref="S2.SS1.p1.5.m5.2.3.cmml"><msub id="S2.SS1.p1.5.m5.2.3.2" xref="S2.SS1.p1.5.m5.2.3.2.cmml"><mi id="S2.SS1.p1.5.m5.2.3.2.2" xref="S2.SS1.p1.5.m5.2.3.2.2.cmml">f</mi><mrow id="S2.SS1.p1.5.m5.2.3.2.3" xref="S2.SS1.p1.5.m5.2.3.2.3.cmml"><mi id="S2.SS1.p1.5.m5.2.3.2.3.2" xref="S2.SS1.p1.5.m5.2.3.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.5.m5.2.3.2.3.1" xref="S2.SS1.p1.5.m5.2.3.2.3.1.cmml">​</mo><mi id="S2.SS1.p1.5.m5.2.3.2.3.3" xref="S2.SS1.p1.5.m5.2.3.2.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.5.m5.2.3.2.3.1a" xref="S2.SS1.p1.5.m5.2.3.2.3.1.cmml">​</mo><mi id="S2.SS1.p1.5.m5.2.3.2.3.4" xref="S2.SS1.p1.5.m5.2.3.2.3.4.cmml">C</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.5.m5.2.3.1" xref="S2.SS1.p1.5.m5.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.5.m5.2.3.3.2" xref="S2.SS1.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.5.m5.2.3.3.2.1" xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">x</mi><mo id="S2.SS1.p1.5.m5.2.3.3.2.2" xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.5.m5.2.2" xref="S2.SS1.p1.5.m5.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.5.m5.2.3.3.2.3" xref="S2.SS1.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.2b"><apply id="S2.SS1.p1.5.m5.2.3.cmml" xref="S2.SS1.p1.5.m5.2.3"><times id="S2.SS1.p1.5.m5.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.3.1"></times><apply id="S2.SS1.p1.5.m5.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.3.2.1.cmml" xref="S2.SS1.p1.5.m5.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.3.2.2.cmml" xref="S2.SS1.p1.5.m5.2.3.2.2">𝑓</ci><apply id="S2.SS1.p1.5.m5.2.3.2.3.cmml" xref="S2.SS1.p1.5.m5.2.3.2.3"><times id="S2.SS1.p1.5.m5.2.3.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.3.2.3.1"></times><ci id="S2.SS1.p1.5.m5.2.3.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.3.2.3.2">𝐶</ci><ci id="S2.SS1.p1.5.m5.2.3.2.3.3.cmml" xref="S2.SS1.p1.5.m5.2.3.2.3.3">𝑇</ci><ci id="S2.SS1.p1.5.m5.2.3.2.3.4.cmml" xref="S2.SS1.p1.5.m5.2.3.2.3.4">𝐶</ci></apply></apply><interval closure="open" id="S2.SS1.p1.5.m5.2.3.3.1.cmml" xref="S2.SS1.p1.5.m5.2.3.3.2"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑥</ci><ci id="S2.SS1.p1.5.m5.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.2c">f_{CTC}(x,y)</annotation></semantics></math> for each text token by remove the blank ones. For AED model, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, which can generates the context representation <math id="S2.SS1.p1.6.m6.2" class="ltx_Math" alttext="f_{AED}(x,y_{&lt;t})" display="inline"><semantics id="S2.SS1.p1.6.m6.2a"><mrow id="S2.SS1.p1.6.m6.2.2" xref="S2.SS1.p1.6.m6.2.2.cmml"><msub id="S2.SS1.p1.6.m6.2.2.3" xref="S2.SS1.p1.6.m6.2.2.3.cmml"><mi id="S2.SS1.p1.6.m6.2.2.3.2" xref="S2.SS1.p1.6.m6.2.2.3.2.cmml">f</mi><mrow id="S2.SS1.p1.6.m6.2.2.3.3" xref="S2.SS1.p1.6.m6.2.2.3.3.cmml"><mi id="S2.SS1.p1.6.m6.2.2.3.3.2" xref="S2.SS1.p1.6.m6.2.2.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.6.m6.2.2.3.3.1" xref="S2.SS1.p1.6.m6.2.2.3.3.1.cmml">​</mo><mi id="S2.SS1.p1.6.m6.2.2.3.3.3" xref="S2.SS1.p1.6.m6.2.2.3.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.6.m6.2.2.3.3.1a" xref="S2.SS1.p1.6.m6.2.2.3.3.1.cmml">​</mo><mi id="S2.SS1.p1.6.m6.2.2.3.3.4" xref="S2.SS1.p1.6.m6.2.2.3.3.4.cmml">D</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.6.m6.2.2.2" xref="S2.SS1.p1.6.m6.2.2.2.cmml">​</mo><mrow id="S2.SS1.p1.6.m6.2.2.1.1" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.6.m6.2.2.1.1.2" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">x</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.3" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">,</mo><msub id="S2.SS1.p1.6.m6.2.2.1.1.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.SS1.p1.6.m6.2.2.1.1.1.3" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.3.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.1.3.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.3.3" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.SS1.p1.6.m6.2.2.1.1.4" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.2b"><apply id="S2.SS1.p1.6.m6.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2"><times id="S2.SS1.p1.6.m6.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.2"></times><apply id="S2.SS1.p1.6.m6.2.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.3.1.cmml" xref="S2.SS1.p1.6.m6.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.2.3.2.cmml" xref="S2.SS1.p1.6.m6.2.2.3.2">𝑓</ci><apply id="S2.SS1.p1.6.m6.2.2.3.3.cmml" xref="S2.SS1.p1.6.m6.2.2.3.3"><times id="S2.SS1.p1.6.m6.2.2.3.3.1.cmml" xref="S2.SS1.p1.6.m6.2.2.3.3.1"></times><ci id="S2.SS1.p1.6.m6.2.2.3.3.2.cmml" xref="S2.SS1.p1.6.m6.2.2.3.3.2">𝐴</ci><ci id="S2.SS1.p1.6.m6.2.2.3.3.3.cmml" xref="S2.SS1.p1.6.m6.2.2.3.3.3">𝐸</ci><ci id="S2.SS1.p1.6.m6.2.2.3.3.4.cmml" xref="S2.SS1.p1.6.m6.2.2.3.3.4">𝐷</ci></apply></apply><interval closure="open" id="S2.SS1.p1.6.m6.2.2.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑥</ci><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2">𝑦</ci><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3"><lt id="S2.SS1.p1.6.m6.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p1.6.m6.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.2c">f_{AED}(x,y_{&lt;t})</annotation></semantics></math> at each time step <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">t</annotation></semantics></math> also as a speech token <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="f(x_{t})" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.8.m8.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.1.1.1.1.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.8.m8.1.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS1.p1.8.m8.1.1.1.1.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><times id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2"></times><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">𝑓</ci><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">f(x_{t})</annotation></semantics></math> for each text token.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Datastore Creation</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.10" class="ltx_p">For datastore creation, we utilize a speech tokenizer on each training data <math id="S2.SS2.p1.1.m1.2" class="ltx_Math" alttext="(x,y)\in\mathcal{S}" display="inline"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.3" xref="S2.SS2.p1.1.m1.2.3.cmml"><mrow id="S2.SS2.p1.1.m1.2.3.2.2" xref="S2.SS2.p1.1.m1.2.3.2.1.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.2.3.2.2.1" xref="S2.SS2.p1.1.m1.2.3.2.1.cmml">(</mo><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">x</mi><mo id="S2.SS2.p1.1.m1.2.3.2.2.2" xref="S2.SS2.p1.1.m1.2.3.2.1.cmml">,</mo><mi id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS2.p1.1.m1.2.3.2.2.3" xref="S2.SS2.p1.1.m1.2.3.2.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.1.m1.2.3.1" xref="S2.SS2.p1.1.m1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.2.3.3" xref="S2.SS2.p1.1.m1.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.3.cmml" xref="S2.SS2.p1.1.m1.2.3"><in id="S2.SS2.p1.1.m1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.2.3.1"></in><interval closure="open" id="S2.SS2.p1.1.m1.2.3.2.1.cmml" xref="S2.SS2.p1.1.m1.2.3.2.2"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑥</ci><ci id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2">𝑦</ci></interval><ci id="S2.SS2.p1.1.m1.2.3.3.cmml" xref="S2.SS2.p1.1.m1.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">(x,y)\in\mathcal{S}</annotation></semantics></math>. This process yields speech tokenizer, we get the speech token representation <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="f(x_{t})" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.2.m2.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.2.m2.1.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS2.p1.2.m2.1.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS2.p1.2.m2.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><times id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2"></times><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑓</ci><apply id="S2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">f(x_{t})</annotation></semantics></math> as the key <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="k_{t}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">k</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑘</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">k_{t}</annotation></semantics></math> and the CTC/AED ground-truth label <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="y_{t}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">y</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝑦</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">y_{t}</annotation></semantics></math> as the value <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="v_{t}" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">v</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝑣</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">v_{t}</annotation></semantics></math>, creating a speech-text key-value pair <math id="S2.SS2.p1.6.m6.2" class="ltx_Math" alttext="(k_{t},v_{t})" display="inline"><semantics id="S2.SS2.p1.6.m6.2a"><mrow id="S2.SS2.p1.6.m6.2.2.2" xref="S2.SS2.p1.6.m6.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.6.m6.2.2.2.3" xref="S2.SS2.p1.6.m6.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.6.m6.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.1.1.2" xref="S2.SS2.p1.6.m6.1.1.1.1.2.cmml">k</mi><mi id="S2.SS2.p1.6.m6.1.1.1.1.3" xref="S2.SS2.p1.6.m6.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.6.m6.2.2.2.4" xref="S2.SS2.p1.6.m6.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.6.m6.2.2.2.2" xref="S2.SS2.p1.6.m6.2.2.2.2.cmml"><mi id="S2.SS2.p1.6.m6.2.2.2.2.2" xref="S2.SS2.p1.6.m6.2.2.2.2.2.cmml">v</mi><mi id="S2.SS2.p1.6.m6.2.2.2.2.3" xref="S2.SS2.p1.6.m6.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS2.p1.6.m6.2.2.2.5" xref="S2.SS2.p1.6.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.2b"><interval closure="open" id="S2.SS2.p1.6.m6.2.2.3.cmml" xref="S2.SS2.p1.6.m6.2.2.2"><apply id="S2.SS2.p1.6.m6.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.2">𝑘</ci><ci id="S2.SS2.p1.6.m6.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.6.m6.2.2.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.2.2.2.2.1.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2.2">𝑣</ci><ci id="S2.SS2.p1.6.m6.2.2.2.2.3.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.2c">(k_{t},v_{t})</annotation></semantics></math> for the <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">t</annotation></semantics></math>-th token. Additionally, the corresponding sequence <math id="S2.SS2.p1.8.m8.3" class="ltx_Math" alttext="(f(x),y)" display="inline"><semantics id="S2.SS2.p1.8.m8.3a"><mrow id="S2.SS2.p1.8.m8.3.3.1" xref="S2.SS2.p1.8.m8.3.3.2.cmml"><mo stretchy="false" id="S2.SS2.p1.8.m8.3.3.1.2" xref="S2.SS2.p1.8.m8.3.3.2.cmml">(</mo><mrow id="S2.SS2.p1.8.m8.3.3.1.1" xref="S2.SS2.p1.8.m8.3.3.1.1.cmml"><mi id="S2.SS2.p1.8.m8.3.3.1.1.2" xref="S2.SS2.p1.8.m8.3.3.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.8.m8.3.3.1.1.1" xref="S2.SS2.p1.8.m8.3.3.1.1.1.cmml">​</mo><mrow id="S2.SS2.p1.8.m8.3.3.1.1.3.2" xref="S2.SS2.p1.8.m8.3.3.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.8.m8.3.3.1.1.3.2.1" xref="S2.SS2.p1.8.m8.3.3.1.1.cmml">(</mo><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS2.p1.8.m8.3.3.1.1.3.2.2" xref="S2.SS2.p1.8.m8.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.8.m8.3.3.1.3" xref="S2.SS2.p1.8.m8.3.3.2.cmml">,</mo><mi id="S2.SS2.p1.8.m8.2.2" xref="S2.SS2.p1.8.m8.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS2.p1.8.m8.3.3.1.4" xref="S2.SS2.p1.8.m8.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.3b"><interval closure="open" id="S2.SS2.p1.8.m8.3.3.2.cmml" xref="S2.SS2.p1.8.m8.3.3.1"><apply id="S2.SS2.p1.8.m8.3.3.1.1.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1"><times id="S2.SS2.p1.8.m8.3.3.1.1.1.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1.1"></times><ci id="S2.SS2.p1.8.m8.3.3.1.1.2.cmml" xref="S2.SS2.p1.8.m8.3.3.1.1.2">𝑓</ci><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑥</ci></apply><ci id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.3c">(f(x),y)</annotation></semantics></math> for each key-value pair is also saved and will serve as a final prompt example for the LLM, providing richer contextual information. Extending this process across the entirety of the training set <math id="S2.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S2.SS2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\mathcal{S}</annotation></semantics></math>, we construct a datastore <math id="S2.SS2.p1.10.m10.4" class="ltx_Math" alttext="\mathcal{(K,V,X,Y)}" display="inline"><semantics id="S2.SS2.p1.10.m10.4a"><mrow id="S2.SS2.p1.10.m10.4.5.2" xref="S2.SS2.p1.10.m10.4.5.1.cmml"><mo stretchy="false" id="S2.SS2.p1.10.m10.4.5.2.1" xref="S2.SS2.p1.10.m10.4.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">𝒦</mi><mo id="S2.SS2.p1.10.m10.4.5.2.2" xref="S2.SS2.p1.10.m10.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.2.2" xref="S2.SS2.p1.10.m10.2.2.cmml">𝒱</mi><mo id="S2.SS2.p1.10.m10.4.5.2.3" xref="S2.SS2.p1.10.m10.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.3.3" xref="S2.SS2.p1.10.m10.3.3.cmml">𝒳</mi><mo id="S2.SS2.p1.10.m10.4.5.2.4" xref="S2.SS2.p1.10.m10.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.4.4" xref="S2.SS2.p1.10.m10.4.4.cmml">𝒴</mi><mo stretchy="false" id="S2.SS2.p1.10.m10.4.5.2.5" xref="S2.SS2.p1.10.m10.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.4b"><vector id="S2.SS2.p1.10.m10.4.5.1.cmml" xref="S2.SS2.p1.10.m10.4.5.2"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝒦</ci><ci id="S2.SS2.p1.10.m10.2.2.cmml" xref="S2.SS2.p1.10.m10.2.2">𝒱</ci><ci id="S2.SS2.p1.10.m10.3.3.cmml" xref="S2.SS2.p1.10.m10.3.3">𝒳</ci><ci id="S2.SS2.p1.10.m10.4.4.cmml" xref="S2.SS2.p1.10.m10.4.4">𝒴</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.4c">\mathcal{(K,V,X,Y)}</annotation></semantics></math> composed of token-level key-value pairs and their corresponding sequences.</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.10" class="ltx_Math" alttext="(\mathcal{K,V,X,Y})=\{(f(x_{t}),y_{t},f(x),y)\mid(x,y)\in\mathcal{S}\}" display="block"><semantics id="S2.E1.m1.10a"><mrow id="S2.E1.m1.10.10" xref="S2.E1.m1.10.10.cmml"><mrow id="S2.E1.m1.10.10.4.2" xref="S2.E1.m1.10.10.4.1.cmml"><mo stretchy="false" id="S2.E1.m1.10.10.4.2.1" xref="S2.E1.m1.10.10.4.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝒦</mi><mo id="S2.E1.m1.10.10.4.2.2" xref="S2.E1.m1.10.10.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝒱</mi><mo id="S2.E1.m1.10.10.4.2.3" xref="S2.E1.m1.10.10.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝒳</mi><mo id="S2.E1.m1.10.10.4.2.4" xref="S2.E1.m1.10.10.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝒴</mi><mo stretchy="false" id="S2.E1.m1.10.10.4.2.5" xref="S2.E1.m1.10.10.4.1.cmml">)</mo></mrow><mo id="S2.E1.m1.10.10.3" xref="S2.E1.m1.10.10.3.cmml">=</mo><mrow id="S2.E1.m1.10.10.2.2" xref="S2.E1.m1.10.10.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.10.10.2.2.3" xref="S2.E1.m1.10.10.2.3.1.cmml">{</mo><mrow id="S2.E1.m1.9.9.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.4.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.4" xref="S2.E1.m1.9.9.1.1.1.4.cmml">(</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.1.3.5" xref="S2.E1.m1.9.9.1.1.1.4.cmml">,</mo><msub id="S2.E1.m1.9.9.1.1.1.2.2" xref="S2.E1.m1.9.9.1.1.1.2.2.cmml"><mi id="S2.E1.m1.9.9.1.1.1.2.2.2" xref="S2.E1.m1.9.9.1.1.1.2.2.2.cmml">y</mi><mi id="S2.E1.m1.9.9.1.1.1.2.2.3" xref="S2.E1.m1.9.9.1.1.1.2.2.3.cmml">t</mi></msub><mo id="S2.E1.m1.9.9.1.1.1.3.6" xref="S2.E1.m1.9.9.1.1.1.4.cmml">,</mo><mrow id="S2.E1.m1.9.9.1.1.1.3.3" xref="S2.E1.m1.9.9.1.1.1.3.3.cmml"><mi id="S2.E1.m1.9.9.1.1.1.3.3.2" xref="S2.E1.m1.9.9.1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.3.3.1" xref="S2.E1.m1.9.9.1.1.1.3.3.1.cmml">​</mo><mrow id="S2.E1.m1.9.9.1.1.1.3.3.3.2" xref="S2.E1.m1.9.9.1.1.1.3.3.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.3.3.2.1" xref="S2.E1.m1.9.9.1.1.1.3.3.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">x</mi><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.3.3.2.2" xref="S2.E1.m1.9.9.1.1.1.3.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.1.3.7" xref="S2.E1.m1.9.9.1.1.1.4.cmml">,</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.8" xref="S2.E1.m1.9.9.1.1.1.4.cmml">)</mo></mrow><mo fence="true" lspace="0em" rspace="0em" id="S2.E1.m1.10.10.2.2.4" xref="S2.E1.m1.10.10.2.3.1.cmml">∣</mo><mrow id="S2.E1.m1.10.10.2.2.2" xref="S2.E1.m1.10.10.2.2.2.cmml"><mrow id="S2.E1.m1.10.10.2.2.2.2.2" xref="S2.E1.m1.10.10.2.2.2.2.1.cmml"><mo stretchy="false" id="S2.E1.m1.10.10.2.2.2.2.2.1" xref="S2.E1.m1.10.10.2.2.2.2.1.cmml">(</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">x</mi><mo id="S2.E1.m1.10.10.2.2.2.2.2.2" xref="S2.E1.m1.10.10.2.2.2.2.1.cmml">,</mo><mi id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.10.10.2.2.2.2.2.3" xref="S2.E1.m1.10.10.2.2.2.2.1.cmml">)</mo></mrow><mo id="S2.E1.m1.10.10.2.2.2.1" xref="S2.E1.m1.10.10.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.10.10.2.2.2.3" xref="S2.E1.m1.10.10.2.2.2.3.cmml">𝒮</mi></mrow><mo stretchy="false" id="S2.E1.m1.10.10.2.2.5" xref="S2.E1.m1.10.10.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.10b"><apply id="S2.E1.m1.10.10.cmml" xref="S2.E1.m1.10.10"><eq id="S2.E1.m1.10.10.3.cmml" xref="S2.E1.m1.10.10.3"></eq><vector id="S2.E1.m1.10.10.4.1.cmml" xref="S2.E1.m1.10.10.4.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝒦</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝒱</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝒳</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝒴</ci></vector><apply id="S2.E1.m1.10.10.2.3.cmml" xref="S2.E1.m1.10.10.2.2"><csymbol cd="latexml" id="S2.E1.m1.10.10.2.3.1.cmml" xref="S2.E1.m1.10.10.2.2.3">conditional-set</csymbol><vector id="S2.E1.m1.9.9.1.1.1.4.cmml" xref="S2.E1.m1.9.9.1.1.1.3"><apply id="S2.E1.m1.9.9.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1"><times id="S2.E1.m1.9.9.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.2"></times><ci id="S2.E1.m1.9.9.1.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.3">𝑓</ci><apply id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.9.9.1.1.1.2.2.cmml" xref="S2.E1.m1.9.9.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.1.1.1.2.2.1.cmml" xref="S2.E1.m1.9.9.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.9.9.1.1.1.2.2.2.cmml" xref="S2.E1.m1.9.9.1.1.1.2.2.2">𝑦</ci><ci id="S2.E1.m1.9.9.1.1.1.2.2.3.cmml" xref="S2.E1.m1.9.9.1.1.1.2.2.3">𝑡</ci></apply><apply id="S2.E1.m1.9.9.1.1.1.3.3.cmml" xref="S2.E1.m1.9.9.1.1.1.3.3"><times id="S2.E1.m1.9.9.1.1.1.3.3.1.cmml" xref="S2.E1.m1.9.9.1.1.1.3.3.1"></times><ci id="S2.E1.m1.9.9.1.1.1.3.3.2.cmml" xref="S2.E1.m1.9.9.1.1.1.3.3.2">𝑓</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝑥</ci></apply><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑦</ci></vector><apply id="S2.E1.m1.10.10.2.2.2.cmml" xref="S2.E1.m1.10.10.2.2.2"><in id="S2.E1.m1.10.10.2.2.2.1.cmml" xref="S2.E1.m1.10.10.2.2.2.1"></in><interval closure="open" id="S2.E1.m1.10.10.2.2.2.2.1.cmml" xref="S2.E1.m1.10.10.2.2.2.2.2"><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝑥</ci><ci id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8">𝑦</ci></interval><ci id="S2.E1.m1.10.10.2.2.2.3.cmml" xref="S2.E1.m1.10.10.2.2.2.3">𝒮</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.10c">(\mathcal{K,V,X,Y})=\{(f(x_{t}),y_{t},f(x),y)\mid(x,y)\in\mathcal{S}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Speech Retrieval</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.8" class="ltx_p">The datastore is organized as a speech inverted index, which allows us to retrieve similar speech sequences using a term frequency (TF) method similar to text information retrieval. During inference, we use the same speech tokenizer as in the database creation phase and align input speech <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\hat{x}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mover accent="true" id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">x</mi><mo id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><ci id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1">^</ci><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\hat{x}</annotation></semantics></math> with the ASR transcription hypothesis to generate the query embedding <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="f(\hat{x}_{t})" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mrow id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.2.m2.1.1.1.1" xref="S2.SS3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.2.m2.1.1.1.1.2" xref="S2.SS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S2.SS3.p1.2.m2.1.1.1.1.1" xref="S2.SS3.p1.2.m2.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.p1.2.m2.1.1.1.1.1.2" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p1.2.m2.1.1.1.1.1.2.2" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mo id="S2.SS3.p1.2.m2.1.1.1.1.1.2.1" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p1.2.m2.1.1.1.1.1.3" xref="S2.SS3.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS3.p1.2.m2.1.1.1.1.3" xref="S2.SS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><times id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2"></times><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑓</ci><apply id="S2.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1">subscript</csymbol><apply id="S2.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2"><ci id="S2.SS3.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2.1">^</ci><ci id="S2.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">f(\hat{x}_{t})</annotation></semantics></math> for each token <math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">t</annotation></semantics></math>, This process helps us find the token-level k-nearest neighbors (kNN) <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><msub id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.2" xref="S2.SS3.p1.4.m4.1.1.2.cmml">N</mi><mi id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2">𝑁</ci><ci id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">N_{k}</annotation></semantics></math>. All retrieval results are grouped by the original <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="f(x)" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><mrow id="S2.SS3.p1.5.m5.1.2" xref="S2.SS3.p1.5.m5.1.2.cmml"><mi id="S2.SS3.p1.5.m5.1.2.2" xref="S2.SS3.p1.5.m5.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.5.m5.1.2.1" xref="S2.SS3.p1.5.m5.1.2.1.cmml">​</mo><mrow id="S2.SS3.p1.5.m5.1.2.3.2" xref="S2.SS3.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.5.m5.1.2.3.2.1" xref="S2.SS3.p1.5.m5.1.2.cmml">(</mo><mi id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS3.p1.5.m5.1.2.3.2.2" xref="S2.SS3.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.2.cmml" xref="S2.SS3.p1.5.m5.1.2"><times id="S2.SS3.p1.5.m5.1.2.1.cmml" xref="S2.SS3.p1.5.m5.1.2.1"></times><ci id="S2.SS3.p1.5.m5.1.2.2.cmml" xref="S2.SS3.p1.5.m5.1.2.2">𝑓</ci><ci id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">f(x)</annotation></semantics></math>, denoted as <math id="S2.SS3.p1.6.m6.1" class="ltx_Math" alttext="N_{f(x)}" display="inline"><semantics id="S2.SS3.p1.6.m6.1a"><msub id="S2.SS3.p1.6.m6.1.2" xref="S2.SS3.p1.6.m6.1.2.cmml"><mi id="S2.SS3.p1.6.m6.1.2.2" xref="S2.SS3.p1.6.m6.1.2.2.cmml">N</mi><mrow id="S2.SS3.p1.6.m6.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.cmml"><mi id="S2.SS3.p1.6.m6.1.1.1.3" xref="S2.SS3.p1.6.m6.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.6.m6.1.1.1.2" xref="S2.SS3.p1.6.m6.1.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.6.m6.1.1.1.4.2" xref="S2.SS3.p1.6.m6.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.4.2.1" xref="S2.SS3.p1.6.m6.1.1.1.cmml">(</mo><mi id="S2.SS3.p1.6.m6.1.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.4.2.2" xref="S2.SS3.p1.6.m6.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><apply id="S2.SS3.p1.6.m6.1.2.cmml" xref="S2.SS3.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.2.1.cmml" xref="S2.SS3.p1.6.m6.1.2">subscript</csymbol><ci id="S2.SS3.p1.6.m6.1.2.2.cmml" xref="S2.SS3.p1.6.m6.1.2.2">𝑁</ci><apply id="S2.SS3.p1.6.m6.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1"><times id="S2.SS3.p1.6.m6.1.1.1.2.cmml" xref="S2.SS3.p1.6.m6.1.1.1.2"></times><ci id="S2.SS3.p1.6.m6.1.1.1.3.cmml" xref="S2.SS3.p1.6.m6.1.1.1.3">𝑓</ci><ci id="S2.SS3.p1.6.m6.1.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">N_{f(x)}</annotation></semantics></math>, to calculate the final sequence level score for <math id="S2.SS3.p1.7.m7.4" class="ltx_Math" alttext="(f(\hat{x}),f(x))" display="inline"><semantics id="S2.SS3.p1.7.m7.4a"><mrow id="S2.SS3.p1.7.m7.4.4.2" xref="S2.SS3.p1.7.m7.4.4.3.cmml"><mo stretchy="false" id="S2.SS3.p1.7.m7.4.4.2.3" xref="S2.SS3.p1.7.m7.4.4.3.cmml">(</mo><mrow id="S2.SS3.p1.7.m7.3.3.1.1" xref="S2.SS3.p1.7.m7.3.3.1.1.cmml"><mi id="S2.SS3.p1.7.m7.3.3.1.1.2" xref="S2.SS3.p1.7.m7.3.3.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.7.m7.3.3.1.1.1" xref="S2.SS3.p1.7.m7.3.3.1.1.1.cmml">​</mo><mrow id="S2.SS3.p1.7.m7.3.3.1.1.3.2" xref="S2.SS3.p1.7.m7.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.7.m7.3.3.1.1.3.2.1" xref="S2.SS3.p1.7.m7.1.1.cmml">(</mo><mover accent="true" id="S2.SS3.p1.7.m7.1.1" xref="S2.SS3.p1.7.m7.1.1.cmml"><mi id="S2.SS3.p1.7.m7.1.1.2" xref="S2.SS3.p1.7.m7.1.1.2.cmml">x</mi><mo id="S2.SS3.p1.7.m7.1.1.1" xref="S2.SS3.p1.7.m7.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S2.SS3.p1.7.m7.3.3.1.1.3.2.2" xref="S2.SS3.p1.7.m7.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.7.m7.4.4.2.4" xref="S2.SS3.p1.7.m7.4.4.3.cmml">,</mo><mrow id="S2.SS3.p1.7.m7.4.4.2.2" xref="S2.SS3.p1.7.m7.4.4.2.2.cmml"><mi id="S2.SS3.p1.7.m7.4.4.2.2.2" xref="S2.SS3.p1.7.m7.4.4.2.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.7.m7.4.4.2.2.1" xref="S2.SS3.p1.7.m7.4.4.2.2.1.cmml">​</mo><mrow id="S2.SS3.p1.7.m7.4.4.2.2.3.2" xref="S2.SS3.p1.7.m7.4.4.2.2.cmml"><mo stretchy="false" id="S2.SS3.p1.7.m7.4.4.2.2.3.2.1" xref="S2.SS3.p1.7.m7.4.4.2.2.cmml">(</mo><mi id="S2.SS3.p1.7.m7.2.2" xref="S2.SS3.p1.7.m7.2.2.cmml">x</mi><mo stretchy="false" id="S2.SS3.p1.7.m7.4.4.2.2.3.2.2" xref="S2.SS3.p1.7.m7.4.4.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS3.p1.7.m7.4.4.2.5" xref="S2.SS3.p1.7.m7.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m7.4b"><interval closure="open" id="S2.SS3.p1.7.m7.4.4.3.cmml" xref="S2.SS3.p1.7.m7.4.4.2"><apply id="S2.SS3.p1.7.m7.3.3.1.1.cmml" xref="S2.SS3.p1.7.m7.3.3.1.1"><times id="S2.SS3.p1.7.m7.3.3.1.1.1.cmml" xref="S2.SS3.p1.7.m7.3.3.1.1.1"></times><ci id="S2.SS3.p1.7.m7.3.3.1.1.2.cmml" xref="S2.SS3.p1.7.m7.3.3.1.1.2">𝑓</ci><apply id="S2.SS3.p1.7.m7.1.1.cmml" xref="S2.SS3.p1.7.m7.3.3.1.1.3.2"><ci id="S2.SS3.p1.7.m7.1.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1.1">^</ci><ci id="S2.SS3.p1.7.m7.1.1.2.cmml" xref="S2.SS3.p1.7.m7.1.1.2">𝑥</ci></apply></apply><apply id="S2.SS3.p1.7.m7.4.4.2.2.cmml" xref="S2.SS3.p1.7.m7.4.4.2.2"><times id="S2.SS3.p1.7.m7.4.4.2.2.1.cmml" xref="S2.SS3.p1.7.m7.4.4.2.2.1"></times><ci id="S2.SS3.p1.7.m7.4.4.2.2.2.cmml" xref="S2.SS3.p1.7.m7.4.4.2.2.2">𝑓</ci><ci id="S2.SS3.p1.7.m7.2.2.cmml" xref="S2.SS3.p1.7.m7.2.2">𝑥</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m7.4c">(f(\hat{x}),f(x))</annotation></semantics></math>, and each group has <math id="S2.SS3.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p1.8.m8.1a"><mi id="S2.SS3.p1.8.m8.1.1" xref="S2.SS3.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m8.1b"><ci id="S2.SS3.p1.8.m8.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m8.1c">i</annotation></semantics></math> tokens. Specifically, we simply use the following formula to sum the token-level scores for each example:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.7" class="ltx_Math" alttext="\text{Score}(f(\hat{x}),f(x))=\sum_{\begin{subarray}{c}(k_{i},v_{i},f(x),y)\in N_{f(x)}\end{subarray}}d(f(\hat{x}_{t}),k_{i})" display="block"><semantics id="S2.E2.m1.7a"><mrow id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml"><mrow id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml"><mtext id="S2.E2.m1.5.5.2.4" xref="S2.E2.m1.5.5.2.4a.cmml">Score</mtext><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.2.3" xref="S2.E2.m1.5.5.2.3.cmml">​</mo><mrow id="S2.E2.m1.5.5.2.2.2" xref="S2.E2.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.3" xref="S2.E2.m1.5.5.2.2.3.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.3.2" xref="S2.E2.m1.2.2.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.3.2.1" xref="S2.E2.m1.2.2.cmml">(</mo><mover accent="true" id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mi id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml">x</mi><mo id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.3.2.2" xref="S2.E2.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.2.2.2.4" xref="S2.E2.m1.5.5.2.2.3.cmml">,</mo><mrow id="S2.E2.m1.5.5.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.cmml"><mi id="S2.E2.m1.5.5.2.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.2.2.2.2.1" xref="S2.E2.m1.5.5.2.2.2.2.1.cmml">​</mo><mrow id="S2.E2.m1.5.5.2.2.2.2.3.2" xref="S2.E2.m1.5.5.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.2.3.2.1" xref="S2.E2.m1.5.5.2.2.2.2.cmml">(</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">x</mi><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.2.3.2.2" xref="S2.E2.m1.5.5.2.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.5" xref="S2.E2.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E2.m1.7.7.5" xref="S2.E2.m1.7.7.5.cmml">=</mo><mrow id="S2.E2.m1.7.7.4" xref="S2.E2.m1.7.7.4.cmml"><munder id="S2.E2.m1.7.7.4.3" xref="S2.E2.m1.7.7.4.3.cmml"><mo movablelimits="false" id="S2.E2.m1.7.7.4.3.2" xref="S2.E2.m1.7.7.4.3.2.cmml">∑</mo><mtable id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.2.cmml"><mtr id="S2.E2.m1.1.1.1.1.1.1a" xref="S2.E2.m1.1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1.1.1b" xref="S2.E2.m1.1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.4" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.2.cmml">k</mi><mi id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.5" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml">,</mo><msub id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.2.cmml">v</mi><mi id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.3.cmml">i</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.6" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml">,</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.1" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.1.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.3.2.1" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.7" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml">,</mo><mi id="S2.E2.m1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3.3.3.cmml">y</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.8" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml">)</mo></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.7" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.7.cmml">∈</mo><msub id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.2" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.2.cmml">N</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow></mtd></mtr></mtable></munder><mrow id="S2.E2.m1.7.7.4.2" xref="S2.E2.m1.7.7.4.2.cmml"><mi id="S2.E2.m1.7.7.4.2.4" xref="S2.E2.m1.7.7.4.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.7.7.4.2.3" xref="S2.E2.m1.7.7.4.2.3.cmml">​</mo><mrow id="S2.E2.m1.7.7.4.2.2.2" xref="S2.E2.m1.7.7.4.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.7.7.4.2.2.2.3" xref="S2.E2.m1.7.7.4.2.2.3.cmml">(</mo><mrow id="S2.E2.m1.6.6.3.1.1.1.1" xref="S2.E2.m1.6.6.3.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.3.1.1.1.1.3" xref="S2.E2.m1.6.6.3.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.3.1.1.1.1.2" xref="S2.E2.m1.6.6.3.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.6.6.3.1.1.1.1.1.1" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.6.6.3.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.1" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E2.m1.6.6.3.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.4.2.2.2.4" xref="S2.E2.m1.7.7.4.2.2.3.cmml">,</mo><msub id="S2.E2.m1.7.7.4.2.2.2.2" xref="S2.E2.m1.7.7.4.2.2.2.2.cmml"><mi id="S2.E2.m1.7.7.4.2.2.2.2.2" xref="S2.E2.m1.7.7.4.2.2.2.2.2.cmml">k</mi><mi id="S2.E2.m1.7.7.4.2.2.2.2.3" xref="S2.E2.m1.7.7.4.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E2.m1.7.7.4.2.2.2.5" xref="S2.E2.m1.7.7.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.7b"><apply id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7"><eq id="S2.E2.m1.7.7.5.cmml" xref="S2.E2.m1.7.7.5"></eq><apply id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"><times id="S2.E2.m1.5.5.2.3.cmml" xref="S2.E2.m1.5.5.2.3"></times><ci id="S2.E2.m1.5.5.2.4a.cmml" xref="S2.E2.m1.5.5.2.4"><mtext id="S2.E2.m1.5.5.2.4.cmml" xref="S2.E2.m1.5.5.2.4">Score</mtext></ci><interval closure="open" id="S2.E2.m1.5.5.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2"><apply id="S2.E2.m1.4.4.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1"><times id="S2.E2.m1.4.4.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1"></times><ci id="S2.E2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2">𝑓</ci><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.2"><ci id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1">^</ci><ci id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2">𝑥</ci></apply></apply><apply id="S2.E2.m1.5.5.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2"><times id="S2.E2.m1.5.5.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.2.2.2.2.1"></times><ci id="S2.E2.m1.5.5.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2">𝑓</ci><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑥</ci></apply></interval></apply><apply id="S2.E2.m1.7.7.4.cmml" xref="S2.E2.m1.7.7.4"><apply id="S2.E2.m1.7.7.4.3.cmml" xref="S2.E2.m1.7.7.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.4.3.1.cmml" xref="S2.E2.m1.7.7.4.3">subscript</csymbol><sum id="S2.E2.m1.7.7.4.3.2.cmml" xref="S2.E2.m1.7.7.4.3.2"></sum><list id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><matrix id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><matrixrow id="S2.E2.m1.1.1.1.1.1.1a.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6"><in id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.7.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.7"></in><vector id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3"><apply id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.2">𝑘</ci><ci id="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.4.4.4.4.1.1.3">𝑖</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.2">𝑣</ci><ci id="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.5.5.5.5.5.2.2.3">𝑖</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3"><times id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.6.3.3.2">𝑓</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2">𝑥</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3.3.3">𝑦</ci></vector><apply id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6.6.6.6.8.2">𝑁</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑓</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">𝑥</ci></apply></apply></apply></matrixrow></matrix></list></apply><apply id="S2.E2.m1.7.7.4.2.cmml" xref="S2.E2.m1.7.7.4.2"><times id="S2.E2.m1.7.7.4.2.3.cmml" xref="S2.E2.m1.7.7.4.2.3"></times><ci id="S2.E2.m1.7.7.4.2.4.cmml" xref="S2.E2.m1.7.7.4.2.4">𝑑</ci><interval closure="open" id="S2.E2.m1.7.7.4.2.2.3.cmml" xref="S2.E2.m1.7.7.4.2.2.2"><apply id="S2.E2.m1.6.6.3.1.1.1.1.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1"><times id="S2.E2.m1.6.6.3.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.2"></times><ci id="S2.E2.m1.6.6.3.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.3">𝑓</ci><apply id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2"><ci id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.3.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.7.7.4.2.2.2.2.cmml" xref="S2.E2.m1.7.7.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.4.2.2.2.2.1.cmml" xref="S2.E2.m1.7.7.4.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.7.7.4.2.2.2.2.2.cmml" xref="S2.E2.m1.7.7.4.2.2.2.2.2">𝑘</ci><ci id="S2.E2.m1.7.7.4.2.2.2.2.3.cmml" xref="S2.E2.m1.7.7.4.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.7c">\text{Score}(f(\hat{x}),f(x))=\sum_{\begin{subarray}{c}(k_{i},v_{i},f(x),y)\in N_{f(x)}\end{subarray}}d(f(\hat{x}_{t}),k_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.9" class="ltx_p">where <math id="S2.SS3.p1.9.m1.2" class="ltx_Math" alttext="d(\cdot,\cdot)" display="inline"><semantics id="S2.SS3.p1.9.m1.2a"><mrow id="S2.SS3.p1.9.m1.2.3" xref="S2.SS3.p1.9.m1.2.3.cmml"><mi id="S2.SS3.p1.9.m1.2.3.2" xref="S2.SS3.p1.9.m1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.9.m1.2.3.1" xref="S2.SS3.p1.9.m1.2.3.1.cmml">​</mo><mrow id="S2.SS3.p1.9.m1.2.3.3.2" xref="S2.SS3.p1.9.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS3.p1.9.m1.2.3.3.2.1" xref="S2.SS3.p1.9.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p1.9.m1.1.1" xref="S2.SS3.p1.9.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS3.p1.9.m1.2.3.3.2.2" xref="S2.SS3.p1.9.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p1.9.m1.2.2" xref="S2.SS3.p1.9.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS3.p1.9.m1.2.3.3.2.3" xref="S2.SS3.p1.9.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m1.2b"><apply id="S2.SS3.p1.9.m1.2.3.cmml" xref="S2.SS3.p1.9.m1.2.3"><times id="S2.SS3.p1.9.m1.2.3.1.cmml" xref="S2.SS3.p1.9.m1.2.3.1"></times><ci id="S2.SS3.p1.9.m1.2.3.2.cmml" xref="S2.SS3.p1.9.m1.2.3.2">𝑑</ci><interval closure="open" id="S2.SS3.p1.9.m1.2.3.3.1.cmml" xref="S2.SS3.p1.9.m1.2.3.3.2"><ci id="S2.SS3.p1.9.m1.1.1.cmml" xref="S2.SS3.p1.9.m1.1.1">⋅</ci><ci id="S2.SS3.p1.9.m1.2.2.cmml" xref="S2.SS3.p1.9.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m1.2c">d(\cdot,\cdot)</annotation></semantics></math> denotes cosine similarity. Finally, we set a threshold filter out examples with low similarity score.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">RobustGER <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> shows that in token-aligned N-best lists, error transcription tokens tend to have multiple different values in the same position, while tokens in the same situation tend to be correct transcriptions. We use this information to prune the query sequence, removing the speech tokens in the query that have the same token in the N-best list. The pruning process is illustrated by the red token (C) in Figure <a href="#S0.F1" title="Figure 1 ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. This allows the LLM to focus only on the erroneous parts, thereby reducing complexity.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS4.4.1.1" class="ltx_text">II-D</span> </span><span id="S2.SS4.5.2" class="ltx_text ltx_font_italic">LLM Prompt</span>
</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.2" class="ltx_p">As shown in Figure <a href="#S0.F1" title="Figure 1 ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, after aligning the speech token sequence <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="f(x)" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><mrow id="S2.SS4.p1.1.m1.1.2" xref="S2.SS4.p1.1.m1.1.2.cmml"><mi id="S2.SS4.p1.1.m1.1.2.2" xref="S2.SS4.p1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.1.m1.1.2.1" xref="S2.SS4.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS4.p1.1.m1.1.2.3.2" xref="S2.SS4.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS4.p1.1.m1.1.2.3.2.1" xref="S2.SS4.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS4.p1.1.m1.1.2.3.2.2" xref="S2.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.2"><times id="S2.SS4.p1.1.m1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.1.2.1"></times><ci id="S2.SS4.p1.1.m1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.1.2.2">𝑓</ci><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">f(x)</annotation></semantics></math> with a speech tokenizer, it is fed into a speech adapter to align with the LLM token space and dimensions. Here, we use a feedforward network (FFN) as the adapter. The output of the FFN is given by: <math id="S2.SS4.p1.2.m2.2" class="ltx_Math" alttext="Z=\text{FFN}(f(x))" display="inline"><semantics id="S2.SS4.p1.2.m2.2a"><mrow id="S2.SS4.p1.2.m2.2.2" xref="S2.SS4.p1.2.m2.2.2.cmml"><mi id="S2.SS4.p1.2.m2.2.2.3" xref="S2.SS4.p1.2.m2.2.2.3.cmml">Z</mi><mo id="S2.SS4.p1.2.m2.2.2.2" xref="S2.SS4.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S2.SS4.p1.2.m2.2.2.1" xref="S2.SS4.p1.2.m2.2.2.1.cmml"><mtext id="S2.SS4.p1.2.m2.2.2.1.3" xref="S2.SS4.p1.2.m2.2.2.1.3a.cmml">FFN</mtext><mo lspace="0em" rspace="0em" id="S2.SS4.p1.2.m2.2.2.1.2" xref="S2.SS4.p1.2.m2.2.2.1.2.cmml">​</mo><mrow id="S2.SS4.p1.2.m2.2.2.1.1.1" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.2.m2.2.2.1.1.1.2" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p1.2.m2.2.2.1.1.1.1" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS4.p1.2.m2.2.2.1.1.1.1.2" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.2.m2.2.2.1.1.1.1.1" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS4.p1.2.m2.2.2.1.1.1.1.3.2" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.2.m2.2.2.1.1.1.1.3.2.1" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mi id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS4.p1.2.m2.2.2.1.1.1.1.3.2.2" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS4.p1.2.m2.2.2.1.1.1.3" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.2b"><apply id="S2.SS4.p1.2.m2.2.2.cmml" xref="S2.SS4.p1.2.m2.2.2"><eq id="S2.SS4.p1.2.m2.2.2.2.cmml" xref="S2.SS4.p1.2.m2.2.2.2"></eq><ci id="S2.SS4.p1.2.m2.2.2.3.cmml" xref="S2.SS4.p1.2.m2.2.2.3">𝑍</ci><apply id="S2.SS4.p1.2.m2.2.2.1.cmml" xref="S2.SS4.p1.2.m2.2.2.1"><times id="S2.SS4.p1.2.m2.2.2.1.2.cmml" xref="S2.SS4.p1.2.m2.2.2.1.2"></times><ci id="S2.SS4.p1.2.m2.2.2.1.3a.cmml" xref="S2.SS4.p1.2.m2.2.2.1.3"><mtext id="S2.SS4.p1.2.m2.2.2.1.3.cmml" xref="S2.SS4.p1.2.m2.2.2.1.3">FFN</mtext></ci><apply id="S2.SS4.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS4.p1.2.m2.2.2.1.1.1"><times id="S2.SS4.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.1"></times><ci id="S2.SS4.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS4.p1.2.m2.2.2.1.1.1.1.2">𝑓</ci><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.2c">Z=\text{FFN}(f(x))</annotation></semantics></math></p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.4" class="ltx_p">We also introduce a model adapter for our LA-RAG task. We employ LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> for parameter-efficient fine-tuning, aiming to learn the mapping between the speech token and its correct text token. This enables the LLM to learn the correct text token to the input speech token via ICL during the inference stage. More formally, let <math id="S2.SS4.p2.1.m1.3" class="ltx_Math" alttext="\{Z^{0},\cdots,Z^{M-1}\}" display="inline"><semantics id="S2.SS4.p2.1.m1.3a"><mrow id="S2.SS4.p2.1.m1.3.3.2" xref="S2.SS4.p2.1.m1.3.3.3.cmml"><mo stretchy="false" id="S2.SS4.p2.1.m1.3.3.2.3" xref="S2.SS4.p2.1.m1.3.3.3.cmml">{</mo><msup id="S2.SS4.p2.1.m1.2.2.1.1" xref="S2.SS4.p2.1.m1.2.2.1.1.cmml"><mi id="S2.SS4.p2.1.m1.2.2.1.1.2" xref="S2.SS4.p2.1.m1.2.2.1.1.2.cmml">Z</mi><mn id="S2.SS4.p2.1.m1.2.2.1.1.3" xref="S2.SS4.p2.1.m1.2.2.1.1.3.cmml">0</mn></msup><mo id="S2.SS4.p2.1.m1.3.3.2.4" xref="S2.SS4.p2.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml">⋯</mi><mo id="S2.SS4.p2.1.m1.3.3.2.5" xref="S2.SS4.p2.1.m1.3.3.3.cmml">,</mo><msup id="S2.SS4.p2.1.m1.3.3.2.2" xref="S2.SS4.p2.1.m1.3.3.2.2.cmml"><mi id="S2.SS4.p2.1.m1.3.3.2.2.2" xref="S2.SS4.p2.1.m1.3.3.2.2.2.cmml">Z</mi><mrow id="S2.SS4.p2.1.m1.3.3.2.2.3" xref="S2.SS4.p2.1.m1.3.3.2.2.3.cmml"><mi id="S2.SS4.p2.1.m1.3.3.2.2.3.2" xref="S2.SS4.p2.1.m1.3.3.2.2.3.2.cmml">M</mi><mo id="S2.SS4.p2.1.m1.3.3.2.2.3.1" xref="S2.SS4.p2.1.m1.3.3.2.2.3.1.cmml">−</mo><mn id="S2.SS4.p2.1.m1.3.3.2.2.3.3" xref="S2.SS4.p2.1.m1.3.3.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S2.SS4.p2.1.m1.3.3.2.6" xref="S2.SS4.p2.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.3b"><set id="S2.SS4.p2.1.m1.3.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2"><apply id="S2.SS4.p2.1.m1.2.2.1.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1">superscript</csymbol><ci id="S2.SS4.p2.1.m1.2.2.1.1.2.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.2">𝑍</ci><cn type="integer" id="S2.SS4.p2.1.m1.2.2.1.1.3.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.3">0</cn></apply><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">⋯</ci><apply id="S2.SS4.p2.1.m1.3.3.2.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.3.3.2.2.1.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2">superscript</csymbol><ci id="S2.SS4.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2">𝑍</ci><apply id="S2.SS4.p2.1.m1.3.3.2.2.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.3"><minus id="S2.SS4.p2.1.m1.3.3.2.2.3.1.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.3.1"></minus><ci id="S2.SS4.p2.1.m1.3.3.2.2.3.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.3.2">𝑀</ci><cn type="integer" id="S2.SS4.p2.1.m1.3.3.2.2.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.3c">\{Z^{0},\cdots,Z^{M-1}\}</annotation></semantics></math> be the FFN output of the top M speech tokens, <math id="S2.SS4.p2.2.m2.3" class="ltx_Math" alttext="\{Y^{0},\cdots,Y^{M-1}\}" display="inline"><semantics id="S2.SS4.p2.2.m2.3a"><mrow id="S2.SS4.p2.2.m2.3.3.2" xref="S2.SS4.p2.2.m2.3.3.3.cmml"><mo stretchy="false" id="S2.SS4.p2.2.m2.3.3.2.3" xref="S2.SS4.p2.2.m2.3.3.3.cmml">{</mo><msup id="S2.SS4.p2.2.m2.2.2.1.1" xref="S2.SS4.p2.2.m2.2.2.1.1.cmml"><mi id="S2.SS4.p2.2.m2.2.2.1.1.2" xref="S2.SS4.p2.2.m2.2.2.1.1.2.cmml">Y</mi><mn id="S2.SS4.p2.2.m2.2.2.1.1.3" xref="S2.SS4.p2.2.m2.2.2.1.1.3.cmml">0</mn></msup><mo id="S2.SS4.p2.2.m2.3.3.2.4" xref="S2.SS4.p2.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml">⋯</mi><mo id="S2.SS4.p2.2.m2.3.3.2.5" xref="S2.SS4.p2.2.m2.3.3.3.cmml">,</mo><msup id="S2.SS4.p2.2.m2.3.3.2.2" xref="S2.SS4.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS4.p2.2.m2.3.3.2.2.2" xref="S2.SS4.p2.2.m2.3.3.2.2.2.cmml">Y</mi><mrow id="S2.SS4.p2.2.m2.3.3.2.2.3" xref="S2.SS4.p2.2.m2.3.3.2.2.3.cmml"><mi id="S2.SS4.p2.2.m2.3.3.2.2.3.2" xref="S2.SS4.p2.2.m2.3.3.2.2.3.2.cmml">M</mi><mo id="S2.SS4.p2.2.m2.3.3.2.2.3.1" xref="S2.SS4.p2.2.m2.3.3.2.2.3.1.cmml">−</mo><mn id="S2.SS4.p2.2.m2.3.3.2.2.3.3" xref="S2.SS4.p2.2.m2.3.3.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S2.SS4.p2.2.m2.3.3.2.6" xref="S2.SS4.p2.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.3b"><set id="S2.SS4.p2.2.m2.3.3.3.cmml" xref="S2.SS4.p2.2.m2.3.3.2"><apply id="S2.SS4.p2.2.m2.2.2.1.1.cmml" xref="S2.SS4.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS4.p2.2.m2.2.2.1.1">superscript</csymbol><ci id="S2.SS4.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS4.p2.2.m2.2.2.1.1.2">𝑌</ci><cn type="integer" id="S2.SS4.p2.2.m2.2.2.1.1.3.cmml" xref="S2.SS4.p2.2.m2.2.2.1.1.3">0</cn></apply><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">⋯</ci><apply id="S2.SS4.p2.2.m2.3.3.2.2.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.3.3.2.2.1.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2">superscript</csymbol><ci id="S2.SS4.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2.2">𝑌</ci><apply id="S2.SS4.p2.2.m2.3.3.2.2.3.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2.3"><minus id="S2.SS4.p2.2.m2.3.3.2.2.3.1.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2.3.1"></minus><ci id="S2.SS4.p2.2.m2.3.3.2.2.3.2.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2.3.2">𝑀</ci><cn type="integer" id="S2.SS4.p2.2.m2.3.3.2.2.3.3.cmml" xref="S2.SS4.p2.2.m2.3.3.2.2.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.3c">\{Y^{0},\cdots,Y^{M-1}\}</annotation></semantics></math> be the embedding output of the corresponding text tokens. <math id="S2.SS4.p2.3.m3.1" class="ltx_Math" alttext="\hat{X}" display="inline"><semantics id="S2.SS4.p2.3.m3.1a"><mover accent="true" id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml"><mi id="S2.SS4.p2.3.m3.1.1.2" xref="S2.SS4.p2.3.m3.1.1.2.cmml">X</mi><mo id="S2.SS4.p2.3.m3.1.1.1" xref="S2.SS4.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><apply id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1"><ci id="S2.SS4.p2.3.m3.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1.1">^</ci><ci id="S2.SS4.p2.3.m3.1.1.2.cmml" xref="S2.SS4.p2.3.m3.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">\hat{X}</annotation></semantics></math> represents the input speech tokens, with N-best embeddings denoted as <math id="S2.SS4.p2.4.m4.3" class="ltx_Math" alttext="\{\hat{Y}^{0},\cdots,\hat{Y}^{N-1}\}" display="inline"><semantics id="S2.SS4.p2.4.m4.3a"><mrow id="S2.SS4.p2.4.m4.3.3.2" xref="S2.SS4.p2.4.m4.3.3.3.cmml"><mo stretchy="false" id="S2.SS4.p2.4.m4.3.3.2.3" xref="S2.SS4.p2.4.m4.3.3.3.cmml">{</mo><msup id="S2.SS4.p2.4.m4.2.2.1.1" xref="S2.SS4.p2.4.m4.2.2.1.1.cmml"><mover accent="true" id="S2.SS4.p2.4.m4.2.2.1.1.2" xref="S2.SS4.p2.4.m4.2.2.1.1.2.cmml"><mi id="S2.SS4.p2.4.m4.2.2.1.1.2.2" xref="S2.SS4.p2.4.m4.2.2.1.1.2.2.cmml">Y</mi><mo id="S2.SS4.p2.4.m4.2.2.1.1.2.1" xref="S2.SS4.p2.4.m4.2.2.1.1.2.1.cmml">^</mo></mover><mn id="S2.SS4.p2.4.m4.2.2.1.1.3" xref="S2.SS4.p2.4.m4.2.2.1.1.3.cmml">0</mn></msup><mo id="S2.SS4.p2.4.m4.3.3.2.4" xref="S2.SS4.p2.4.m4.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS4.p2.4.m4.1.1" xref="S2.SS4.p2.4.m4.1.1.cmml">⋯</mi><mo id="S2.SS4.p2.4.m4.3.3.2.5" xref="S2.SS4.p2.4.m4.3.3.3.cmml">,</mo><msup id="S2.SS4.p2.4.m4.3.3.2.2" xref="S2.SS4.p2.4.m4.3.3.2.2.cmml"><mover accent="true" id="S2.SS4.p2.4.m4.3.3.2.2.2" xref="S2.SS4.p2.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS4.p2.4.m4.3.3.2.2.2.2" xref="S2.SS4.p2.4.m4.3.3.2.2.2.2.cmml">Y</mi><mo id="S2.SS4.p2.4.m4.3.3.2.2.2.1" xref="S2.SS4.p2.4.m4.3.3.2.2.2.1.cmml">^</mo></mover><mrow id="S2.SS4.p2.4.m4.3.3.2.2.3" xref="S2.SS4.p2.4.m4.3.3.2.2.3.cmml"><mi id="S2.SS4.p2.4.m4.3.3.2.2.3.2" xref="S2.SS4.p2.4.m4.3.3.2.2.3.2.cmml">N</mi><mo id="S2.SS4.p2.4.m4.3.3.2.2.3.1" xref="S2.SS4.p2.4.m4.3.3.2.2.3.1.cmml">−</mo><mn id="S2.SS4.p2.4.m4.3.3.2.2.3.3" xref="S2.SS4.p2.4.m4.3.3.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S2.SS4.p2.4.m4.3.3.2.6" xref="S2.SS4.p2.4.m4.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.3b"><set id="S2.SS4.p2.4.m4.3.3.3.cmml" xref="S2.SS4.p2.4.m4.3.3.2"><apply id="S2.SS4.p2.4.m4.2.2.1.1.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1">superscript</csymbol><apply id="S2.SS4.p2.4.m4.2.2.1.1.2.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.2"><ci id="S2.SS4.p2.4.m4.2.2.1.1.2.1.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.2.1">^</ci><ci id="S2.SS4.p2.4.m4.2.2.1.1.2.2.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.2.2">𝑌</ci></apply><cn type="integer" id="S2.SS4.p2.4.m4.2.2.1.1.3.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.3">0</cn></apply><ci id="S2.SS4.p2.4.m4.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1">⋯</ci><apply id="S2.SS4.p2.4.m4.3.3.2.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.3.3.2.2.1.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2">superscript</csymbol><apply id="S2.SS4.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2"><ci id="S2.SS4.p2.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2.1">^</ci><ci id="S2.SS4.p2.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2.2">𝑌</ci></apply><apply id="S2.SS4.p2.4.m4.3.3.2.2.3.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.3"><minus id="S2.SS4.p2.4.m4.3.3.2.2.3.1.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.3.1"></minus><ci id="S2.SS4.p2.4.m4.3.3.2.2.3.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.3.2">𝑁</ci><cn type="integer" id="S2.SS4.p2.4.m4.3.3.2.2.3.3.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.3c">\{\hat{Y}^{0},\cdots,\hat{Y}^{N-1}\}</annotation></semantics></math>. The prompt fed into the LLM can finally be written as:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.9" class="ltx_Math" alttext="\text{Concat}(Z^{0},Y^{0},\cdots,Z^{M-1},Y^{M-1},\hat{X},\hat{Y}^{0},\cdots,\hat{Y}^{N-1})" display="block"><semantics id="S2.E3.m1.9a"><mrow id="S2.E3.m1.9.9" xref="S2.E3.m1.9.9.cmml"><mtext id="S2.E3.m1.9.9.8" xref="S2.E3.m1.9.9.8a.cmml">Concat</mtext><mo lspace="0em" rspace="0em" id="S2.E3.m1.9.9.7" xref="S2.E3.m1.9.9.7.cmml">​</mo><mrow id="S2.E3.m1.9.9.6.6" xref="S2.E3.m1.9.9.6.7.cmml"><mo stretchy="false" id="S2.E3.m1.9.9.6.6.7" xref="S2.E3.m1.9.9.6.7.cmml">(</mo><msup id="S2.E3.m1.4.4.1.1.1" xref="S2.E3.m1.4.4.1.1.1.cmml"><mi id="S2.E3.m1.4.4.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.2.cmml">Z</mi><mn id="S2.E3.m1.4.4.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.3.cmml">0</mn></msup><mo id="S2.E3.m1.9.9.6.6.8" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><msup id="S2.E3.m1.5.5.2.2.2" xref="S2.E3.m1.5.5.2.2.2.cmml"><mi id="S2.E3.m1.5.5.2.2.2.2" xref="S2.E3.m1.5.5.2.2.2.2.cmml">Y</mi><mn id="S2.E3.m1.5.5.2.2.2.3" xref="S2.E3.m1.5.5.2.2.2.3.cmml">0</mn></msup><mo id="S2.E3.m1.9.9.6.6.9" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><mi mathvariant="normal" id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">⋯</mi><mo id="S2.E3.m1.9.9.6.6.10" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><msup id="S2.E3.m1.6.6.3.3.3" xref="S2.E3.m1.6.6.3.3.3.cmml"><mi id="S2.E3.m1.6.6.3.3.3.2" xref="S2.E3.m1.6.6.3.3.3.2.cmml">Z</mi><mrow id="S2.E3.m1.6.6.3.3.3.3" xref="S2.E3.m1.6.6.3.3.3.3.cmml"><mi id="S2.E3.m1.6.6.3.3.3.3.2" xref="S2.E3.m1.6.6.3.3.3.3.2.cmml">M</mi><mo id="S2.E3.m1.6.6.3.3.3.3.1" xref="S2.E3.m1.6.6.3.3.3.3.1.cmml">−</mo><mn id="S2.E3.m1.6.6.3.3.3.3.3" xref="S2.E3.m1.6.6.3.3.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.E3.m1.9.9.6.6.11" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><msup id="S2.E3.m1.7.7.4.4.4" xref="S2.E3.m1.7.7.4.4.4.cmml"><mi id="S2.E3.m1.7.7.4.4.4.2" xref="S2.E3.m1.7.7.4.4.4.2.cmml">Y</mi><mrow id="S2.E3.m1.7.7.4.4.4.3" xref="S2.E3.m1.7.7.4.4.4.3.cmml"><mi id="S2.E3.m1.7.7.4.4.4.3.2" xref="S2.E3.m1.7.7.4.4.4.3.2.cmml">M</mi><mo id="S2.E3.m1.7.7.4.4.4.3.1" xref="S2.E3.m1.7.7.4.4.4.3.1.cmml">−</mo><mn id="S2.E3.m1.7.7.4.4.4.3.3" xref="S2.E3.m1.7.7.4.4.4.3.3.cmml">1</mn></mrow></msup><mo id="S2.E3.m1.9.9.6.6.12" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><mover accent="true" id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mi id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml">X</mi><mo id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.cmml">^</mo></mover><mo id="S2.E3.m1.9.9.6.6.13" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><msup id="S2.E3.m1.8.8.5.5.5" xref="S2.E3.m1.8.8.5.5.5.cmml"><mover accent="true" id="S2.E3.m1.8.8.5.5.5.2" xref="S2.E3.m1.8.8.5.5.5.2.cmml"><mi id="S2.E3.m1.8.8.5.5.5.2.2" xref="S2.E3.m1.8.8.5.5.5.2.2.cmml">Y</mi><mo id="S2.E3.m1.8.8.5.5.5.2.1" xref="S2.E3.m1.8.8.5.5.5.2.1.cmml">^</mo></mover><mn id="S2.E3.m1.8.8.5.5.5.3" xref="S2.E3.m1.8.8.5.5.5.3.cmml">0</mn></msup><mo id="S2.E3.m1.9.9.6.6.14" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><mi mathvariant="normal" id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">⋯</mi><mo id="S2.E3.m1.9.9.6.6.15" xref="S2.E3.m1.9.9.6.7.cmml">,</mo><msup id="S2.E3.m1.9.9.6.6.6" xref="S2.E3.m1.9.9.6.6.6.cmml"><mover accent="true" id="S2.E3.m1.9.9.6.6.6.2" xref="S2.E3.m1.9.9.6.6.6.2.cmml"><mi id="S2.E3.m1.9.9.6.6.6.2.2" xref="S2.E3.m1.9.9.6.6.6.2.2.cmml">Y</mi><mo id="S2.E3.m1.9.9.6.6.6.2.1" xref="S2.E3.m1.9.9.6.6.6.2.1.cmml">^</mo></mover><mrow id="S2.E3.m1.9.9.6.6.6.3" xref="S2.E3.m1.9.9.6.6.6.3.cmml"><mi id="S2.E3.m1.9.9.6.6.6.3.2" xref="S2.E3.m1.9.9.6.6.6.3.2.cmml">N</mi><mo id="S2.E3.m1.9.9.6.6.6.3.1" xref="S2.E3.m1.9.9.6.6.6.3.1.cmml">−</mo><mn id="S2.E3.m1.9.9.6.6.6.3.3" xref="S2.E3.m1.9.9.6.6.6.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S2.E3.m1.9.9.6.6.16" xref="S2.E3.m1.9.9.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.9b"><apply id="S2.E3.m1.9.9.cmml" xref="S2.E3.m1.9.9"><times id="S2.E3.m1.9.9.7.cmml" xref="S2.E3.m1.9.9.7"></times><ci id="S2.E3.m1.9.9.8a.cmml" xref="S2.E3.m1.9.9.8"><mtext id="S2.E3.m1.9.9.8.cmml" xref="S2.E3.m1.9.9.8">Concat</mtext></ci><vector id="S2.E3.m1.9.9.6.7.cmml" xref="S2.E3.m1.9.9.6.6"><apply id="S2.E3.m1.4.4.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1">superscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.2">𝑍</ci><cn type="integer" id="S2.E3.m1.4.4.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.3">0</cn></apply><apply id="S2.E3.m1.5.5.2.2.2.cmml" xref="S2.E3.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.2.2.2.1.cmml" xref="S2.E3.m1.5.5.2.2.2">superscript</csymbol><ci id="S2.E3.m1.5.5.2.2.2.2.cmml" xref="S2.E3.m1.5.5.2.2.2.2">𝑌</ci><cn type="integer" id="S2.E3.m1.5.5.2.2.2.3.cmml" xref="S2.E3.m1.5.5.2.2.2.3">0</cn></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">⋯</ci><apply id="S2.E3.m1.6.6.3.3.3.cmml" xref="S2.E3.m1.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.3.3.3.1.cmml" xref="S2.E3.m1.6.6.3.3.3">superscript</csymbol><ci id="S2.E3.m1.6.6.3.3.3.2.cmml" xref="S2.E3.m1.6.6.3.3.3.2">𝑍</ci><apply id="S2.E3.m1.6.6.3.3.3.3.cmml" xref="S2.E3.m1.6.6.3.3.3.3"><minus id="S2.E3.m1.6.6.3.3.3.3.1.cmml" xref="S2.E3.m1.6.6.3.3.3.3.1"></minus><ci id="S2.E3.m1.6.6.3.3.3.3.2.cmml" xref="S2.E3.m1.6.6.3.3.3.3.2">𝑀</ci><cn type="integer" id="S2.E3.m1.6.6.3.3.3.3.3.cmml" xref="S2.E3.m1.6.6.3.3.3.3.3">1</cn></apply></apply><apply id="S2.E3.m1.7.7.4.4.4.cmml" xref="S2.E3.m1.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.4.4.4.1.cmml" xref="S2.E3.m1.7.7.4.4.4">superscript</csymbol><ci id="S2.E3.m1.7.7.4.4.4.2.cmml" xref="S2.E3.m1.7.7.4.4.4.2">𝑌</ci><apply id="S2.E3.m1.7.7.4.4.4.3.cmml" xref="S2.E3.m1.7.7.4.4.4.3"><minus id="S2.E3.m1.7.7.4.4.4.3.1.cmml" xref="S2.E3.m1.7.7.4.4.4.3.1"></minus><ci id="S2.E3.m1.7.7.4.4.4.3.2.cmml" xref="S2.E3.m1.7.7.4.4.4.3.2">𝑀</ci><cn type="integer" id="S2.E3.m1.7.7.4.4.4.3.3.cmml" xref="S2.E3.m1.7.7.4.4.4.3.3">1</cn></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><ci id="S2.E3.m1.2.2.1.cmml" xref="S2.E3.m1.2.2.1">^</ci><ci id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2">𝑋</ci></apply><apply id="S2.E3.m1.8.8.5.5.5.cmml" xref="S2.E3.m1.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.5.5.5.1.cmml" xref="S2.E3.m1.8.8.5.5.5">superscript</csymbol><apply id="S2.E3.m1.8.8.5.5.5.2.cmml" xref="S2.E3.m1.8.8.5.5.5.2"><ci id="S2.E3.m1.8.8.5.5.5.2.1.cmml" xref="S2.E3.m1.8.8.5.5.5.2.1">^</ci><ci id="S2.E3.m1.8.8.5.5.5.2.2.cmml" xref="S2.E3.m1.8.8.5.5.5.2.2">𝑌</ci></apply><cn type="integer" id="S2.E3.m1.8.8.5.5.5.3.cmml" xref="S2.E3.m1.8.8.5.5.5.3">0</cn></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">⋯</ci><apply id="S2.E3.m1.9.9.6.6.6.cmml" xref="S2.E3.m1.9.9.6.6.6"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.6.6.6.1.cmml" xref="S2.E3.m1.9.9.6.6.6">superscript</csymbol><apply id="S2.E3.m1.9.9.6.6.6.2.cmml" xref="S2.E3.m1.9.9.6.6.6.2"><ci id="S2.E3.m1.9.9.6.6.6.2.1.cmml" xref="S2.E3.m1.9.9.6.6.6.2.1">^</ci><ci id="S2.E3.m1.9.9.6.6.6.2.2.cmml" xref="S2.E3.m1.9.9.6.6.6.2.2">𝑌</ci></apply><apply id="S2.E3.m1.9.9.6.6.6.3.cmml" xref="S2.E3.m1.9.9.6.6.6.3"><minus id="S2.E3.m1.9.9.6.6.6.3.1.cmml" xref="S2.E3.m1.9.9.6.6.6.3.1"></minus><ci id="S2.E3.m1.9.9.6.6.6.3.2.cmml" xref="S2.E3.m1.9.9.6.6.6.3.2">𝑁</ci><cn type="integer" id="S2.E3.m1.9.9.6.6.6.3.3.cmml" xref="S2.E3.m1.9.9.6.6.6.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.9c">\text{Concat}(Z^{0},Y^{0},\cdots,Z^{M-1},Y^{M-1},\hat{X},\hat{Y}^{0},\cdots,\hat{Y}^{N-1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p2.5" class="ltx_p">Our speech-to-speech retrieval method is a general approach that can be easily generalized to other speech tasks.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Experimental Setup</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Dataset</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We utilize both Mandarin and dialect datasets to evaluate the performance of the pre-trained ASR model in sufficiently and insufficiently trained scenarios respectively. The datasets include AISHELL-1 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (178 hours, Chinese) and the KeSpeech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> subdialect datasets. These subdialects encompass Mandarin (589 hours), JiangHuai (46 hours), JiLu (59 hours), ZhongYuan (84 hours), and Southwestern (75 hours).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We employed the Whisper-Medium model as our base ASR system, and from which we obtained the input and N-best transcriptions. To evaluate different speech tokenization methods, we tested both the CTC and the AED approaches. Specifically, we used the SenseVoice-Small model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> for CTC tokenzier and the Whisper-Small model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> for AED tokenzier. Both pre-trained models demonstrated comparable performance on standard open-source ASR test sets. Additionally, for LLM decoding, we adopt LLaMA 3 8B <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> from Huggingface. To enhance its performance, a LoRA adapter with a rank of 8 is integrated into each layer of LLaMA. We also implement a simple structured linear projector consisting of two linear layers with an intermediate hidden layer dimension of 2048.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">For retrieval, we utilize FAISS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to retrieve the approximate <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">k</annotation></semantics></math>-nearest neighbors, where <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">k</annotation></semantics></math> is set to 128. The sequence filter threshold is set to 0.5. For evaluation metrics, we employ the Character Error Rate (CER).</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p">The input to our model comprises the retrieved speech examples mentioned in Section <a href="#S2.SS3" title="II-C Speech Retrieval ‣ II Method ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-C</span></span></a>, along with input speech tokens and the 5 best transcripts generated by Whisper. The model is trained for 25 epochs with early stopping to prevent overfitting. We use the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and experiment with a learning rate of <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mn id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">×</mo><msup id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mn id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml"><mo id="S3.SS2.p3.1.m1.1.1.3.3a" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.p3.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><times id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></times><cn type="integer" id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">5</cn><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">10</cn><apply id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"><minus id="S3.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"></minus><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">5\times 10^{-4}</annotation></semantics></math>. Training is conducted on 8 GPUs to leverage efficient parallel processing. An effective batch size of 32 is used, and a weight decay of <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mn id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">×</mo><msup id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mn id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">10</mn><mrow id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml"><mo id="S3.SS2.p3.2.m2.1.1.3.3a" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="S3.SS2.p3.2.m2.1.1.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><times id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></times><cn type="integer" id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">1</cn><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">10</cn><apply id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3"><minus id="S3.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3"></minus><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">1\times 10^{-2}</annotation></semantics></math> is applied.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Results</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The results of ASR on six datasets, including AISHELL and KeSpeech, are presented in Table <a href="#S1.T1" title="TABLE I ‣ I Introduction ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, where the training data is used to construct the datastore.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Specifically, HyPoradise refers to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which uses the N-best results of the ASR model as LLM prompts for error correction. Whispering LLaMA refers to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which contrasts with HyPoradise by adding speech signals to the LLM and achieves more efficient results. Neither method, however, employs retrieval-augmentation to acquire external knowledge.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">kNN-CTC, as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, utilizes a external datastore and generally produces better results than the aforementioned methods. However, kNN-CTC uses a small model, lacking the capability of learning similar examples through LLM ICL and finding the optimal token using N-best results. Moreover, according to prior studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, such methods is more likely to introduce noise or overfitting during decoding.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">Two speech tokenizers were implemented for our LA-RAG. For CTC-based LA-RAG, which constructs the datastore similarly to kNN-CTC as mentioned in Section <a href="#S2.SS2" title="II-B Datastore Creation ‣ II Method ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-B</span></span></a>, the lowest CER was achieved among all methods. For AED-based LA-RAG, which employs a different datastore creation method from CTC-based LA-RAG, the average score was similar, with some test sets surpassing the results of CTC-based LA-RAG. Additionally, we observed that our method got more significantly improved performance on accented test sets (max 2.14 CER decrease) than AISHELL and Mandarin. This improvement is attributed to LA-RAG’s ability to help the LLM learn the mapping between pronunciation and correct tokens, which is particularly useful in accent scenarios where the ASR model might not have fully learned the mapping relationships. These experiments demonstrate the effectiveness of our proposed methods.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>CER (%) performance with different retrieval settings</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Retrieval Type</th>
<th id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">JiangHuai</th>
<th id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">JiLu</th>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Base ASR</th>
<th id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">43.94</th>
<th id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">31.61</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.4.1" class="ltx_tr">
<td id="S4.T2.1.4.1.1" class="ltx_td ltx_align_center ltx_border_t">Random</td>
<td id="S4.T2.1.4.1.2" class="ltx_td ltx_align_center ltx_border_t">43.47</td>
<td id="S4.T2.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t">31.4</td>
</tr>
<tr id="S4.T2.1.5.2" class="ltx_tr">
<td id="S4.T2.1.5.2.1" class="ltx_td ltx_align_center">Sequence Embedding</td>
<td id="S4.T2.1.5.2.2" class="ltx_td ltx_align_center">42.39</td>
<td id="S4.T2.1.5.2.3" class="ltx_td ltx_align_center">30.81</td>
</tr>
<tr id="S4.T2.1.6.3" class="ltx_tr">
<td id="S4.T2.1.6.3.1" class="ltx_td ltx_align_center">Text</td>
<td id="S4.T2.1.6.3.2" class="ltx_td ltx_align_center">42.72</td>
<td id="S4.T2.1.6.3.3" class="ltx_td ltx_align_center">31.1</td>
</tr>
<tr id="S4.T2.1.7.4" class="ltx_tr">
<td id="S4.T2.1.7.4.1" class="ltx_td ltx_align_center">Phoneme</td>
<td id="S4.T2.1.7.4.2" class="ltx_td ltx_align_center">42.41</td>
<td id="S4.T2.1.7.4.3" class="ltx_td ltx_align_center">30.78</td>
</tr>
<tr id="S4.T2.1.8.5" class="ltx_tr">
<td id="S4.T2.1.8.5.1" class="ltx_td ltx_align_center">No pruning</td>
<td id="S4.T2.1.8.5.2" class="ltx_td ltx_align_center">42.04</td>
<td id="S4.T2.1.8.5.3" class="ltx_td ltx_align_center">30.63</td>
</tr>
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">LA-RAG<sub id="S4.T2.1.1.1.1" class="ltx_sub"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_italic">CTC</span></sub>
</td>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">41.8</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">30.39</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Analysis</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Retrieval Comparison</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">To evaluate the effectiveness of our speech tokenizer of LA-RAG, we compare several related retrieval techniques across two datasets. The results are presented in Table <a href="#S4.T2" title="TABLE II ‣ IV Results ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">Firstly, following the methodology in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, we validated the <span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Random</span> sampling approach by selecting the same number of examples from the datastore as our method. While there were some effects, but not very significant. We also compared our method with the use of <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_bold">Sequence Embeddings</span> for kNN speech retrieval by employing the average value of sequence token embeddings, a technique shown to be effective in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. However, this coarse-grained approach was less effective than our proposed speech token-level retrieval method due to the lower alignment precision required.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">Additionally, given the availability of transcription text, we evaluated a simpler and more sophisticated <span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Text</span>-to-text retrieval method. This approach did not perform well on both accent test sets because the transcriptions of accents often contained errors, which limited retrieval accuracy. Furthermore, even with the conversion of text to <span id="S5.SS1.p3.1.2" class="ltx_text ltx_font_bold">Phonemes</span>, the improvement was marginal.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">Lastly, we assessed the impact of <span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">No Pruning</span>, which refers to not removing identical tokens in the N-best list as discussed in Section <a href="#S2.SS3" title="II-C Speech Retrieval ‣ II Method ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-C</span></span></a>. The slight increase in CER indicated that the extra tokens that were removed had a detrimental effect. This analysis demonstrates the advantages of our retrieval method, which can be seamlessly extended to other speech-to-speech retrieval tasks, warranting further exploration.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Parameter Settings</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Figure <a href="#S5.F2" title="Figure 2 ‣ V-B Parameter Settings ‣ V Analysis ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the impact of varying the top-k parameter and datastore size on performance using the JiangHuai test set and a CTC-based method. Optimal performance was observed at a top-k value of 128. Further increasing the retrieval number led to a performance decline due to noise, though this was mitigated by our threshold control filters described in Section <a href="#S2.SS3" title="II-C Speech Retrieval ‣ II Method ‣ Enhancing LLM-based ASR Accuracy with Retrieval-Augmented Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-C</span></span></a>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">The datastore size also influences performance. A larger datastore is preferable as it provides more external knowledge, but it may result in slower retrieval speeds. Given that our datastore currently contains millions of entries, we utilize GPU acceleration through search libraries such as FAISS and employ approximate retrieval methods to ensure the retrieval time remains within 50ms. Addressing the slowdown issue as the datastore grows larger remains a subject for future research.</p>
</div>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2409.08597/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="225" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Left side is the CER trend when use different top k, right side is the CER trend in different sample datastore size. </figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this study, we present a novel RAG paradigm for LLM-based ASR. By leveraging fine-grained speech datastores and precise token-level alignments achieved through pre-trained CTC and AED models, our method significantly enhances LLM-based ASR accuracy, particularly in accent variation scenarios. The experimental results demonstrate consistent improvements across various datasets, including Mandarin and Chinese dialects, with a notable reduction in the CER. This approach highlights the potential for integrating similar speech examples into LLMs and offers a solution for enhancing ASR performance, even under diverse speech conditions. In the future, we plan to generalize our RAG method to other tasks and other languages for speech.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C. Chen, Y. Hu, C.-H. H. Yang, S. M. Siniscalchi, P.-Y. Chen, and E. S. Chng, “Hyporadise: An open baseline for generative speech recognition with large language models,” 2023. [Online]. Available: https://arxiv.org/abs/2309.15701

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
E. Lakomkin, C. Wu, Y. Fathullah, O. Kalinli, M. L. Seltzer, and C. Fuegen, “End-to-end speech recognition contextualization with large language models,” 2023. [Online]. Available: https://arxiv.org/abs/2309.10917

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
S. Radhakrishnan, C.-H. Yang, S. Khan, R. Kumar, N. Kiani, D. Gomez-Cabrero, and J. Tegnér, “Whispering LLaMA: A cross-modal generative error correction framework for speech recognition,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, H. Bouamor, J. Pino, and K. Bali, Eds.   Singapore: Association for Computational Linguistics, Dec. 2023, pp. 10 007–10 016. [Online]. Available: https://aclanthology.org/2023.emnlp-main.618

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
C.-H. H. Yang, Y. Gu, Y.-C. Liu, S. Ghosh, I. Bulyko, and A. Stolcke, “Generative speech recognition error correction with large language models and task-activating prompting,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</em>.   IEEE, Dec. 2023. [Online]. Available: http://dx.doi.org/10.1109/ASRU57964.2023.10389673

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
R. Ma, M. Qian, P. Manakul, M. Gales, and K. Knill, “Can generative large language models perform asr error correction?” 2023. [Online]. Available: https://arxiv.org/abs/2307.04172

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
W. Yu, C. Tang, G. Sun, X. Chen, T. Tan, W. Li, L. Lu, Z. Ma, and C. Zhang, “Connecting speech encoder and large language model for asr,” 2023. [Online]. Available: https://arxiv.org/abs/2309.13963

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Li, J. Yu, M. Zhang, M. Ren, Y. Zhao, X. Zhao, S. Tao, J. Su, and H. Yang, “Using large language model for end-to-end chinese asr and ner,” 2024. [Online]. Available: https://arxiv.org/abs/2401.11382

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Fathullah, C. Wu, E. Lakomkin, J. Jia, Y. Shangguan, K. Li, J. Guo, W. Xiong, J. Mahadeokar, O. Kalinli, C. Fuegen, and M. Seltzer, “Prompting large language models with speech recognition abilities,” 2023. [Online]. Available: https://arxiv.org/abs/2307.11795

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Chen, R. Li, Y. Hu, S. M. Siniscalchi, P.-Y. Chen, E. Chng, and C.-H. H. Yang, “It’s never too late: Fusing acoustic information into large language models for automatic speech recognition,” 2024. [Online]. Available: https://arxiv.org/abs/2402.05457

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Hu, C. Chen, C.-H. H. Yang, R. Li, C. Zhang, P.-Y. Chen, and E. Chng, “Large language models are efficient learners of noise-robust speech recognition,” 2024. [Online]. Available: https://arxiv.org/abs/2401.10446

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Huang, G. Ye, J. Li, and Y. Gong, “Rapid speaker adaptation for conformer transducer: Attention and bias are all you need,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Interspeech 2021</em>, Aug 2021. [Online]. Available: http://dx.doi.org/10.21437/interspeech.2021-1884

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Li, Y. Wu, J. Li, and S. Liu, “Prompting large language models for zero-shot domain adaptation in speech recognition,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">2023 IEEE Automatic Speech Recognition and Understanding Workshop (ASRU)</em>, 2023, pp. 1–8.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
P. Lewis, E. Perez, A. Piktus, F. Petroni, V. Karpukhin, N. Goyal, H. Küttler, M. Lewis, W. tau Yih, T. Rocktäschel, S. Riedel, and D. Kiela, “Retrieval-augmented generation for knowledge-intensive nlp tasks,” 2021. [Online]. Available: https://arxiv.org/abs/2005.11401

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
K. Guu, K. Lee, Z. Tung, P. Pasupat, and M.-W. Chang, “Realm: Retrieval-augmented language model pre-training,” 2020. [Online]. Available: https://arxiv.org/abs/2002.08909

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M.-H. Hsu, K.-W. Chang, S.-W. Li, and H. yi Lee, “Exploring in-context learning of textless speech language model for speech classification tasks,” 2024. [Online]. Available: https://arxiv.org/abs/2310.12477

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J. Pan, J. Wu, Y. Gaur, S. Sivasankaran, Z. Chen, S. Liu, and J. Li, “Cosmic: Data efficient instruction-tuning for speech in-context learning,” 2024. [Online]. Available: https://arxiv.org/abs/2311.02248

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Wang, I. Shafran, H. Soltau, W. Han, Y. Cao, D. Yu, and L. E. Shafey, “Retrieval augmented end-to-end spoken dialog models,” 2024. [Online]. Available: https://arxiv.org/abs/2402.01828

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
H. Yang, M. Zhang, M. Wang, and J. Guo, “Rasu: Retrieval augmented speech understanding through generative modeling,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Interspeech 2024</em>, 2024, pp. 3510–3514.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
J. Zhou, S. Zhao, Y. Liu, W. Zeng, Y. Chen, and Y. Qin, “knn-ctc: Enhancing asr via retrieval of ctc pseudo labels,” 2024. [Online]. Available: https://arxiv.org/abs/2312.13560

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
S. Li, D. Wei, H. Shang, J. Guo, Z. Li, Z. Wu, Z. Rao, Y. Luo, X. He, and H. Yang, “Speaker-smoothed knn speaker adaptation for end-to-end asr,” 2024. [Online]. Available: https://arxiv.org/abs/2406.04791

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
L. Kurzinger, D. Winkelbauer, L. Li, T. Watzel, and G. Rigoll, “Ctc-segmentation of large corpora for german end-to-end speech recognition,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Conference on Speech and Computer</em>, 2020. [Online]. Available: https://api.semanticscholar.org/CorpusID:220633469

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen, “Lora: Low-rank adaptation of large language models,” 2021. [Online]. Available: https://arxiv.org/abs/2106.09685

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
H. Bu, J. Du, X. Na, B. Wu, and H. Zheng, “Aishell-1: An open-source mandarin speech corpus and a speech recognition baseline,” 2017. [Online]. Available: https://arxiv.org/abs/1709.05522

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Tang, D. Wang, Y. Xu, J. Sun, X. Lei, S. Zhao, C. Wen, X. Tan, C. Xie, S. Zhou, R. Yan, C. Lv, Y. Han, W. Zou, and X. Li, “Kespeech: An open source speech dataset of mandarin and its eight subdialects,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Thirty-fifth Conference on Neural Information Processing Systems Datasets and Benchmarks Track (Round 2)</em>, 2021. [Online]. Available: https://openreview.net/forum?id=b3Zoeq2sCLq

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. An, Q. Chen, C. Deng, Z. Du, C. Gao, Z. Gao, Y. Gu, T. He, H. Hu, K. Hu, S. Ji, Y. Li, Z. Li, H. Lu, H. Luo, X. Lv, B. Ma, Z. Ma, C. Ni, C. Song, J. Shi, X. Shi, H. Wang, W. Wang, Y. Wang, Z. Xiao, Z. Yan, Y. Yang, B. Zhang, Q. Zhang, S. Zhang, N. Zhao, and S. Zheng, “Funaudiollm: Voice understanding and generation foundation models for natural interaction between humans and llms,” 2024. [Online]. Available: https://arxiv.org/abs/2407.04051

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, T. Xu, G. Brockman, C. McLeavey, and I. Sutskever, “Robust speech recognition via large-scale weak supervision,” 2022. [Online]. Available: https://arxiv.org/abs/2212.04356

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
A. Dubey, A. Jauhri, A. Pandey, A. Kadian, A. Al-Dahle, A. Letman, A. Mathur, A. Schelten, A. Yang, A. Fan, A. Goyal, A. Hartshorn, A. Yang, and A. Mitra, “The llama 3 herd of models,” 2024. [Online]. Available: https://arxiv.org/abs/2407.21783

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Johnson, M. Douze, and H. Jégou, “Billion-scale similarity search with GPUs,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Big Data</em>, vol. 7, no. 3, pp. 535–547, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,” 2017. [Online]. Available: https://arxiv.org/abs/1412.6980

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Q. Jiang, M. Wang, J. Cao, S. Cheng, S. Huang, and L. Li, “Learning kernel-smoothed machine translation with retrieved examples,” 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
S. Wang, C.-H. H. Yang, J. Wu, and C. Zhang, “Can whisper perform speech-based in-context learning?” 2024. [Online]. Available: https://arxiv.org/abs/2309.07081

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.08596" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.08597" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.08597">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.08597" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.08598" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 20:41:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
