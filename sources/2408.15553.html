<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.15553] Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking</title><meta property="og:description" content="Digital audio watermarking consists in inserting a message into audio signals in a transparent way and can be used to allow automatic recognition of audio material and management of the copyrights.
We propose a percept…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.15553">

<!--Generated on Thu Sep  5 16:48:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Martin Moritz, Toni Olán, Tuomas Virtanen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_font_italic">Tampere University
<br class="ltx_break"></span>Tampere, Finland 
<br class="ltx_break">firstname.lastname@tuni.fi
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Digital audio watermarking consists in inserting a message into audio signals in a transparent way and can be used to allow automatic recognition of audio material and management of the copyrights.
We propose a perceptual loss function to be used in deep neural network based audio watermarking systems. The loss is based on the noise-to-mask ratio (NMR), which is a model of the psychoacoustic masking effect characteristic of the human ear. We use the NMR loss between marked and host signals to train the deep neural models and we evaluate the objective quality with PEAQ and the subjective quality with a MUSHRA test. Both objective and subjective tests show that models trained with NMR loss generate more transparent watermarks than models trained with the conventionally used MSE loss</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Digital audio watermarking consists in inserting a message into a host audio media, in a transparent way, meaning that the listener should perceive the degradation as little as possible and that their experience should not be affected. The retrieved hidden message can be used to prove the ownership of the media, or for identification and automatic management of the copyrights. The watermarks need to be robust against intentional or unintentional attacks such as compression, filtering or noise addition.
The grounds for some traditional techniques like spread spectrum, patchwork, low-bit or phase codings, and echo-based watermarking were set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and have been developed further in the following two decades as shown in the review <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> which classifies about 70 solutions for audio watermarking.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the recent years, some <span title="" class="ltx_glossaryref">deep neural network (DNN)</span> audio watermarking solutions have emerged.
The first <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> is based on two <span title="" class="ltx_glossaryref">DNN</span> networks: a U-net autoencoder to embed a binary message into the magnitude <span title="" class="ltx_glossaryref">short time Fourier transform (STFT)</span> of an audio segment and a deep convolutional multi label classifier for the extraction of the predicted message. The phase of the host <span title="" class="ltx_glossaryref">STFT</span> is directly reused for the watermarked <span title="" class="ltx_glossaryref">STFT</span>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A more recent solution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> uses similar embedder and extractor networks for speech watermarking, with the important difference that input and output of the embedder are complex-valued <span title="" class="ltx_glossaryref">STFT</span> and not only their magnitude, and both amplitude and phase of the watermarks are generated.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Those two previous works use the <span title="" class="ltx_glossaryref">binary cross entropy (BCE)</span> between the input and the extracted messages to guide the learning of the message retrieval, and the <span title="" class="ltx_glossaryref">mean absolute error (MAE)</span> to minimize the distortion between the input and the marked segments. The embedder and extraction networks are trained jointly and the two losses need to be weighted depending on the epoch: at the beginning the priority is given to the <span title="" class="ltx_glossaryref">BCE</span> to ensure the extraction of the message and afterwards the weight of the <span title="" class="ltx_glossaryref">MAE</span> is gradually increased to obtain a better transparency of the watermark. Another recent solution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> uses an embedder, an extractor and a third discriminator network with an adversarial loss to improve the quality of watermarked audio, but it still uses the <span title="" class="ltx_glossaryref">mean square error (MSE)</span> loss to minimize the distortion. In case of audio signal, loss functions like <span title="" class="ltx_glossaryref">MSE</span> or <span title="" class="ltx_glossaryref">MAE</span> minimize specific statistical criteria which do not match with the human capability to perceive signal modifications introduced by watermarks.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper we propose to use a <span title="" class="ltx_glossaryref">noise-to-mask ratio (NMR)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> based loss function for training <span title="" class="ltx_glossaryref">DNNs</span>, which takes into account the psychoacoustic masking, to improve the perceptual transparency of the audio watermarks. <span title="" class="ltx_glossaryref">NMR</span> is used as one of the statistics computed from audio signals from which the <span title="" class="ltx_glossaryref">perceptive evaluation of audio quality (PEAQ)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> metrics has been calculated, and has been applied for instance to minimize the distortion in non-negative matrix factorization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We do objective and subjective evaluations to show the better transparency of models trained with our novel <span title="" class="ltx_glossaryref">NMR</span> loss in comparison to the <span title="" class="ltx_glossaryref">MSE</span> commonly used to optimize the distortion between a <span title="" class="ltx_glossaryref">DNN</span> generated and an input signals.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">We are solely interested in improving the transparency of the watermark thanks to the <span title="" class="ltx_glossaryref">NMR</span> loss, and we are not addressing the robustness of the watermarking solution. Neither are we dealing with synchronization issue, and for the models we use the watermark needs to be retrieved exactly at the same position that it was embedded. To train a complete audio watermarking system, attacks can be performed on the embedded signals before the extraction. Those attacks can be <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> random noise addition, low-pass filter, or sample suppression. To deal with the synchronization issue, traditional watermarking methods are commonly based on synchronization code <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> which enables to retrieve efficiently the watermark location. In the case of <span title="" class="ltx_glossaryref">DNN</span> solutions, synchronization attacks can be introduced to train the network to retrieve the message from another location than the one it was exactly embedded. For instance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> finds a suitable location by brute force and the usage of pattern bits.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">The structure of the paper is as follows: Section <a href="#S2" title="II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> explains the <span title="" class="ltx_glossaryref">NMR</span> computation and gives the structure of the <span title="" class="ltx_glossaryref">DNN</span> embedder and extractor for audio watermarking. Section <a href="#S3" title="III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> describes the audio datasets used for the training and the objective and subjective tests, explains how the models are trained and selected, how the tests are performed, and presents the results.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">proposed method</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The proposed loss function is applicable with any <span title="" class="ltx_glossaryref">DNN</span> watermarking architecture but in this study we use an embedder and an extractor network with similar architecture to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.12" class="ltx_p">The embedder (Fig <a href="#S2.F3" title="Figure 3 ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) takes as input a host audio segment <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">x</annotation></semantics></math> and a 256-bit binary message <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">m</annotation></semantics></math>. The <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">X</annotation></semantics></math> of <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.p2.4.m4.1a"><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">x</annotation></semantics></math> is computed and fed with the message to the <em id="S2.p2.12.1" class="ltx_emph ltx_font_italic">embedder network</em>.
The output of the embedder network is the marked <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.p2.5.m5.1a"><mi id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">Y</annotation></semantics></math> and the marked time-domain signal <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="\widehat{x}" display="inline"><semantics id="S2.p2.6.m6.1a"><mover accent="true" id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">x</mi><mo id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><ci id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1">^</ci><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">\widehat{x}</annotation></semantics></math> is obtained by its inverse <span title="" class="ltx_glossaryref">STFT</span>.
The extractor (Fig <a href="#S2.F3" title="Figure 3 ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) takes as input the marked segment <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="\widehat{x}" display="inline"><semantics id="S2.p2.7.m7.1a"><mover accent="true" id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">x</mi><mo id="S2.p2.7.m7.1.1.1" xref="S2.p2.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><ci id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1">^</ci><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">\widehat{x}</annotation></semantics></math>, computes its <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="S2.p2.8.m8.1a"><mover accent="true" id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml"><mi id="S2.p2.8.m8.1.1.2" xref="S2.p2.8.m8.1.1.2.cmml">X</mi><mo id="S2.p2.8.m8.1.1.1" xref="S2.p2.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><apply id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1"><ci id="S2.p2.8.m8.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1">^</ci><ci id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\widehat{X}</annotation></semantics></math>
<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The <span title="" class="ltx_glossaryref">STFT</span> <math id="footnote1.m1.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">Y</annotation></semantics></math> output by the embedder network and the marked <span title="" class="ltx_glossaryref">STFT</span> <math id="footnote1.m2.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="footnote1.m2.1b"><mover accent="true" id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml"><mi id="footnote1.m2.1.1.2" xref="footnote1.m2.1.1.2.cmml">X</mi><mo id="footnote1.m2.1.1.1" xref="footnote1.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><apply id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1"><ci id="footnote1.m2.1.1.1.cmml" xref="footnote1.m2.1.1.1">^</ci><ci id="footnote1.m2.1.1.2.cmml" xref="footnote1.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">\widehat{X}</annotation></semantics></math> are not necessarily identical; even though the inverse <span title="" class="ltx_glossaryref">STFT</span> of <math id="footnote1.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="footnote1.m3.1b"><mi id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><ci id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">Y</annotation></semantics></math> is <math id="footnote1.m4.1" class="ltx_Math" alttext="\widehat{x}" display="inline"><semantics id="footnote1.m4.1b"><mover accent="true" id="footnote1.m4.1.1" xref="footnote1.m4.1.1.cmml"><mi id="footnote1.m4.1.1.2" xref="footnote1.m4.1.1.2.cmml">x</mi><mo id="footnote1.m4.1.1.1" xref="footnote1.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="footnote1.m4.1c"><apply id="footnote1.m4.1.1.cmml" xref="footnote1.m4.1.1"><ci id="footnote1.m4.1.1.1.cmml" xref="footnote1.m4.1.1.1">^</ci><ci id="footnote1.m4.1.1.2.cmml" xref="footnote1.m4.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m4.1d">\widehat{x}</annotation></semantics></math>, <math id="footnote1.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="footnote1.m5.1b"><mi id="footnote1.m5.1.1" xref="footnote1.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="footnote1.m5.1c"><ci id="footnote1.m5.1.1.cmml" xref="footnote1.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m5.1d">Y</annotation></semantics></math> might not be the <span title="" class="ltx_glossaryref">STFT</span> of any time-domain signal.</span></span></span>
and feeds it to the <em id="S2.p2.12.2" class="ltx_emph ltx_font_italic">extractor network</em>
to get the the sequence of probabilities <math id="S2.p2.9.m9.1" class="ltx_Math" alttext="\widehat{m}" display="inline"><semantics id="S2.p2.9.m9.1a"><mover accent="true" id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml"><mi id="S2.p2.9.m9.1.1.2" xref="S2.p2.9.m9.1.1.2.cmml">m</mi><mo id="S2.p2.9.m9.1.1.1" xref="S2.p2.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.1b"><apply id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1"><ci id="S2.p2.9.m9.1.1.1.cmml" xref="S2.p2.9.m9.1.1.1">^</ci><ci id="S2.p2.9.m9.1.1.2.cmml" xref="S2.p2.9.m9.1.1.2">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.1c">\widehat{m}</annotation></semantics></math> which can be rounded to obtain the predicted message of the same length, 256 bits, as the binary message <math id="S2.p2.10.m10.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.p2.10.m10.1a"><mi id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">m</annotation></semantics></math>.
The <span title="" class="ltx_glossaryref">NMR</span> loss is computed between the marked and host <span title="" class="ltx_glossaryref">STFTs</span> <math id="S2.p2.11.m11.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="S2.p2.11.m11.1a"><mover accent="true" id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml"><mi id="S2.p2.11.m11.1.1.2" xref="S2.p2.11.m11.1.1.2.cmml">X</mi><mo id="S2.p2.11.m11.1.1.1" xref="S2.p2.11.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.1b"><apply id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1"><ci id="S2.p2.11.m11.1.1.1.cmml" xref="S2.p2.11.m11.1.1.1">^</ci><ci id="S2.p2.11.m11.1.1.2.cmml" xref="S2.p2.11.m11.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.1c">\widehat{X}</annotation></semantics></math> and <math id="S2.p2.12.m12.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.p2.12.m12.1a"><mi id="S2.p2.12.m12.1.1" xref="S2.p2.12.m12.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m12.1b"><ci id="S2.p2.12.m12.1.1.cmml" xref="S2.p2.12.m12.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m12.1c">X</annotation></semantics></math>.</p>
</div>
<figure id="S2.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span id="S2.F3.4" class="ltx_ERROR ltx_figure_panel undefined">{subcaptionblock}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<p id="S2.F3.1" class="ltx_p ltx_figure_panel">[T]
 <img src="/html/2408.15553/assets/x1.png" id="S2.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="150" alt="Refer to caption"></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.5.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F3.6.2" class="ltx_text" style="font-size:90%;">Embedder</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span id="S2.F3.7" class="ltx_ERROR ltx_figure_panel undefined">{subcaptionblock}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F3.2" class="ltx_p ltx_figure_panel">[T]  <img src="/html/2408.15553/assets/x2.png" id="S2.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="102" alt="Refer to caption"></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.8.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F3.9.2" class="ltx_text" style="font-size:90%;">Extractor</span></figcaption>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.10.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S2.F3.11.2" class="ltx_text" style="font-size:90%;">The two steps of the watermarking system</span></figcaption>
</figure>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.5" class="ltx_p">All the audio segments have a duration of <math id="S2.p3.1.m1.3" class="ltx_Math" alttext="1\,103\text{\,}\mathrm{ms}\text{/}" display="inline"><semantics id="S2.p3.1.m1.3a"><mrow id="S2.p3.1.m1.3.3" xref="S2.p3.1.m1.3.3.cmml"><mn id="S2.p3.1.m1.1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.1.cmml">1 103</mn><mtext id="S2.p3.1.m1.2.2.2.2.2.2" xref="S2.p3.1.m1.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.p3.1.m1.3.3.3.3.3.3" xref="S2.p3.1.m1.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.p3.1.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.p3.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">ms</mi><mtext id="S2.p3.1.m1.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.p3.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.p3.1.m1.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.p3.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.3b"><apply id="S2.p3.1.m1.3.3.cmml" xref="S2.p3.1.m1.3.3"><csymbol cd="latexml" id="S2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.p3.1.m1.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1">1103</cn><apply id="S2.p3.1.m1.3.3.3.3.3.3.cmml" xref="S2.p3.1.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.p3.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.p3.1.m1.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.p3.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.3.3.3.3.3.3.1.1.1.1.1.1">millisecond</csymbol><csymbol cd="latexml" id="S2.p3.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.p3.1.m1.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.3c">1\,103\text{\,}\mathrm{ms}\text{/}</annotation></semantics></math> and are sampled at <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="F_{S}=$44.1\text{\,}\mathrm{kHz}\text{/}$" display="inline"><semantics id="S2.p3.2.m2.1a"><mrow id="S2.p3.2.m2.1.2" xref="S2.p3.2.m2.1.2.cmml"><msub id="S2.p3.2.m2.1.2.2" xref="S2.p3.2.m2.1.2.2.cmml"><mi id="S2.p3.2.m2.1.2.2.2" xref="S2.p3.2.m2.1.2.2.2.cmml">F</mi><mi id="S2.p3.2.m2.1.2.2.3" xref="S2.p3.2.m2.1.2.2.3.cmml">S</mi></msub><mo id="S2.p3.2.m2.1.2.1" xref="S2.p3.2.m2.1.2.1.cmml">=</mo><mrow id="S2.p3.2.m2.1.1.m1.3.3" xref="S2.p3.2.m2.1.1.m1.3.3.cmml"><mn id="S2.p3.2.m2.1.1.m1.1.1.1.1.1.1" xref="S2.p3.2.m2.1.1.m1.1.1.1.1.1.1.cmml">44.1</mn><mtext id="S2.p3.2.m2.1.1.m1.2.2.2.2.2.2" xref="S2.p3.2.m2.1.1.m1.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kHz</mi><mtext id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.2.cmml" xref="S2.p3.2.m2.1.2"><eq id="S2.p3.2.m2.1.2.1.cmml" xref="S2.p3.2.m2.1.2.1"></eq><apply id="S2.p3.2.m2.1.2.2.cmml" xref="S2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.2.2.1.cmml" xref="S2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S2.p3.2.m2.1.2.2.2.cmml" xref="S2.p3.2.m2.1.2.2.2">𝐹</ci><ci id="S2.p3.2.m2.1.2.2.3.cmml" xref="S2.p3.2.m2.1.2.2.3">𝑆</ci></apply><apply id="S2.p3.2.m2.1.1.m1.3.3.cmml" xref="S2.p3.2.m2.1.1.m1.3.3"><csymbol cd="latexml" id="S2.p3.2.m2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.p3.2.m2.1.1.m1.2.2.2.2.2.2">times</csymbol><cn type="float" id="S2.p3.2.m2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.m1.1.1.1.1.1.1">44.1</cn><apply id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.cmml" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.1.1.1.1.1.1">kilohertz</csymbol><csymbol cd="latexml" id="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.p3.2.m2.1.1.m1.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">F_{S}=$44.1\text{\,}\mathrm{kHz}\text{/}$</annotation></semantics></math>.
The <span title="" class="ltx_glossaryref">discrete Fourier transform (DFT)</span> length is <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="N=1024" display="inline"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">N</mi><mo id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><eq id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"></eq><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">𝑁</ci><cn type="integer" id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">N=1024</annotation></semantics></math> samples, and we use the Hanning window and a time-overlap of 50% to compute the <span title="" class="ltx_glossaryref">STFTs</span>.
Therefore the <span title="" class="ltx_glossaryref">STFT</span> matrices have <math id="S2.p3.4.m4.1" class="ltx_Math" alttext="F=513" display="inline"><semantics id="S2.p3.4.m4.1a"><mrow id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">F</mi><mo id="S2.p3.4.m4.1.1.1" xref="S2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">513</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><eq id="S2.p3.4.m4.1.1.1.cmml" xref="S2.p3.4.m4.1.1.1"></eq><ci id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2">𝐹</ci><cn type="integer" id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">513</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">F=513</annotation></semantics></math> rows and <math id="S2.p3.5.m5.1" class="ltx_Math" alttext="{T=96}" display="inline"><semantics id="S2.p3.5.m5.1a"><mrow id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml"><mi id="S2.p3.5.m5.1.1.2" xref="S2.p3.5.m5.1.1.2.cmml">T</mi><mo id="S2.p3.5.m5.1.1.1" xref="S2.p3.5.m5.1.1.1.cmml">=</mo><mn id="S2.p3.5.m5.1.1.3" xref="S2.p3.5.m5.1.1.3.cmml">96</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><apply id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1"><eq id="S2.p3.5.m5.1.1.1.cmml" xref="S2.p3.5.m5.1.1.1"></eq><ci id="S2.p3.5.m5.1.1.2.cmml" xref="S2.p3.5.m5.1.1.2">𝑇</ci><cn type="integer" id="S2.p3.5.m5.1.1.3.cmml" xref="S2.p3.5.m5.1.1.3">96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">{T=96}</annotation></semantics></math> columns, corresponding to the positive <span title="" class="ltx_glossaryref">DFT</span> frequencies and the <span title="" class="ltx_glossaryref">STFT</span> time frames, and 2 channels for the real and imaginary parts. The 96-frame duration is chosen to match the decimation operations in the downsampling units of the extractor network.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">NMR loss</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.2" class="ltx_p">The proposed loss used for the training of the <span title="" class="ltx_glossaryref">DNN</span> is a combination of the noise-to-mask ratio (NMR) and the binary cross entropy (BCE) given as</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.9" class="ltx_Math" alttext="\ell(\widehat{X},\widehat{m},X,m)=\alpha\text{NMR}(\widehat{X},X)+(1-\alpha)\text{BCE}(\widehat{m},m)\,," display="block"><semantics id="S2.E1.m1.9a"><mrow id="S2.E1.m1.9.9.1" xref="S2.E1.m1.9.9.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1" xref="S2.E1.m1.9.9.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1.3" xref="S2.E1.m1.9.9.1.1.3.cmml"><mi mathvariant="normal" id="S2.E1.m1.9.9.1.1.3.2" xref="S2.E1.m1.9.9.1.1.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.3.1" xref="S2.E1.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.9.9.1.1.3.3.2" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.3.3.2.1" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml">(</mo><mover accent="true" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml">^</mo></mover><mo id="S2.E1.m1.9.9.1.1.3.3.2.2" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml">,</mo><mover accent="true" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mi id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml">m</mi><mo id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.cmml">^</mo></mover><mo id="S2.E1.m1.9.9.1.1.3.3.2.3" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">X</mi><mo id="S2.E1.m1.9.9.1.1.3.3.2.4" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">m</mi><mo stretchy="false" id="S2.E1.m1.9.9.1.1.3.3.2.5" xref="S2.E1.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.2" xref="S2.E1.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.9.9.1.1.1" xref="S2.E1.m1.9.9.1.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.3.cmml"><mi id="S2.E1.m1.9.9.1.1.1.3.2" xref="S2.E1.m1.9.9.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.3.1" xref="S2.E1.m1.9.9.1.1.1.3.1.cmml">​</mo><mtext id="S2.E1.m1.9.9.1.1.1.3.3" xref="S2.E1.m1.9.9.1.1.1.3.3a.cmml">NMR</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.3.1a" xref="S2.E1.m1.9.9.1.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.9.9.1.1.1.3.4.2" xref="S2.E1.m1.9.9.1.1.1.3.4.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.4.2.1" xref="S2.E1.m1.9.9.1.1.1.3.4.1.cmml">(</mo><mover accent="true" id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml"><mi id="S2.E1.m1.5.5.2" xref="S2.E1.m1.5.5.2.cmml">X</mi><mo id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.cmml">^</mo></mover><mo id="S2.E1.m1.9.9.1.1.1.3.4.2.2" xref="S2.E1.m1.9.9.1.1.1.3.4.1.cmml">,</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">X</mi><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.3.4.2.3" xref="S2.E1.m1.9.9.1.1.1.3.4.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.2.cmml">+</mo><mrow id="S2.E1.m1.9.9.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml"><mn id="S2.E1.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E1.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.2.cmml">​</mo><mtext id="S2.E1.m1.9.9.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.3a.cmml">BCE</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.1.1.1.1.2a" xref="S2.E1.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.4.2" xref="S2.E1.m1.9.9.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.4.2.1" xref="S2.E1.m1.9.9.1.1.1.1.4.1.cmml">(</mo><mover accent="true" id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><mi id="S2.E1.m1.7.7.2" xref="S2.E1.m1.7.7.2.cmml">m</mi><mo id="S2.E1.m1.7.7.1" xref="S2.E1.m1.7.7.1.cmml">^</mo></mover><mo id="S2.E1.m1.9.9.1.1.1.1.4.2.2" xref="S2.E1.m1.9.9.1.1.1.1.4.1.cmml">,</mo><mi id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml">m</mi><mo rspace="0.170em" stretchy="false" id="S2.E1.m1.9.9.1.1.1.1.4.2.3" xref="S2.E1.m1.9.9.1.1.1.1.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.9.9.1.2" xref="S2.E1.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.9b"><apply id="S2.E1.m1.9.9.1.1.cmml" xref="S2.E1.m1.9.9.1"><eq id="S2.E1.m1.9.9.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.2"></eq><apply id="S2.E1.m1.9.9.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.3"><times id="S2.E1.m1.9.9.1.1.3.1.cmml" xref="S2.E1.m1.9.9.1.1.3.1"></times><ci id="S2.E1.m1.9.9.1.1.3.2.cmml" xref="S2.E1.m1.9.9.1.1.3.2">ℓ</ci><vector id="S2.E1.m1.9.9.1.1.3.3.1.cmml" xref="S2.E1.m1.9.9.1.1.3.3.2"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><ci id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1">^</ci><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">𝑋</ci></apply><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><ci id="S2.E1.m1.2.2.1.cmml" xref="S2.E1.m1.2.2.1">^</ci><ci id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2">𝑚</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑋</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑚</ci></vector></apply><apply id="S2.E1.m1.9.9.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1"><plus id="S2.E1.m1.9.9.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.2"></plus><apply id="S2.E1.m1.9.9.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.3"><times id="S2.E1.m1.9.9.1.1.1.3.1.cmml" xref="S2.E1.m1.9.9.1.1.1.3.1"></times><ci id="S2.E1.m1.9.9.1.1.1.3.2.cmml" xref="S2.E1.m1.9.9.1.1.1.3.2">𝛼</ci><ci id="S2.E1.m1.9.9.1.1.1.3.3a.cmml" xref="S2.E1.m1.9.9.1.1.1.3.3"><mtext id="S2.E1.m1.9.9.1.1.1.3.3.cmml" xref="S2.E1.m1.9.9.1.1.1.3.3">NMR</mtext></ci><interval closure="open" id="S2.E1.m1.9.9.1.1.1.3.4.1.cmml" xref="S2.E1.m1.9.9.1.1.1.3.4.2"><apply id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5"><ci id="S2.E1.m1.5.5.1.cmml" xref="S2.E1.m1.5.5.1">^</ci><ci id="S2.E1.m1.5.5.2.cmml" xref="S2.E1.m1.5.5.2">𝑋</ci></apply><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑋</ci></interval></apply><apply id="S2.E1.m1.9.9.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1"><times id="S2.E1.m1.9.9.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2"></times><apply id="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1"><minus id="S2.E1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E1.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E1.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.3">𝛼</ci></apply><ci id="S2.E1.m1.9.9.1.1.1.1.3a.cmml" xref="S2.E1.m1.9.9.1.1.1.1.3"><mtext id="S2.E1.m1.9.9.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.3">BCE</mtext></ci><interval closure="open" id="S2.E1.m1.9.9.1.1.1.1.4.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.4.2"><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><ci id="S2.E1.m1.7.7.1.cmml" xref="S2.E1.m1.7.7.1">^</ci><ci id="S2.E1.m1.7.7.2.cmml" xref="S2.E1.m1.7.7.2">𝑚</ci></apply><ci id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8">𝑚</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.9c">\ell(\widehat{X},\widehat{m},X,m)=\alpha\text{NMR}(\widehat{X},X)+(1-\alpha)\text{BCE}(\widehat{m},m)\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.1" class="ltx_p">where <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\alpha</annotation></semantics></math> is the transparency weight between 0 (only the extraction matters) and 1 (only the transparency matters).</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.6" class="ltx_p">For computing the NMR in (<a href="#S2.E1" title="Equation 1 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), we first need to compute the <em id="S2.SS1.p2.6.1" class="ltx_emph ltx_font_italic">noise patterns</em> <math id="S2.SS1.p2.1.m1.2" class="ltx_Math" alttext="N_{c,t}" display="inline"><semantics id="S2.SS1.p2.1.m1.2a"><msub id="S2.SS1.p2.1.m1.2.3" xref="S2.SS1.p2.1.m1.2.3.cmml"><mi id="S2.SS1.p2.1.m1.2.3.2" xref="S2.SS1.p2.1.m1.2.3.2.cmml">N</mi><mrow id="S2.SS1.p2.1.m1.2.2.2.4" xref="S2.SS1.p2.1.m1.2.2.2.3.cmml"><mi id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.cmml">c</mi><mo id="S2.SS1.p2.1.m1.2.2.2.4.1" xref="S2.SS1.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p2.1.m1.2.2.2.2" xref="S2.SS1.p2.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.2b"><apply id="S2.SS1.p2.1.m1.2.3.cmml" xref="S2.SS1.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.2.3.1.cmml" xref="S2.SS1.p2.1.m1.2.3">subscript</csymbol><ci id="S2.SS1.p2.1.m1.2.3.2.cmml" xref="S2.SS1.p2.1.m1.2.3.2">𝑁</ci><list id="S2.SS1.p2.1.m1.2.2.2.3.cmml" xref="S2.SS1.p2.1.m1.2.2.2.4"><ci id="S2.SS1.p2.1.m1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1">𝑐</ci><ci id="S2.SS1.p2.1.m1.2.2.2.2.cmml" xref="S2.SS1.p2.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.2c">N_{c,t}</annotation></semantics></math>, i.e. the squared errors between the marked <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mover accent="true" id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.p2.2.m2.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><ci id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1">^</ci><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\widehat{X}</annotation></semantics></math> and the host <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">X</annotation></semantics></math>, which are decimated to the <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="C=109" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">C</mi><mo id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">109</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><eq id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"></eq><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝐶</ci><cn type="integer" id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">109</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">C=109</annotation></semantics></math> critical band using critical band mapping matrix <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">U</annotation></semantics></math>, and weighted by outer and middle ear filter <math id="S2.SS1.p2.6.m6.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.SS1.p2.6.m6.1a"><mi id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">\omega</annotation></semantics></math> as</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.9" class="ltx_Math" alttext="N_{c,t}=\sum_{f=1}^{F}U_{c,f}\left|\omega_{f}(X_{f,t}-\widehat{X}_{f,t})\right|^{2}\;." display="block"><semantics id="S2.E2.m1.9a"><mrow id="S2.E2.m1.9.9.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1" xref="S2.E2.m1.9.9.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.3" xref="S2.E2.m1.9.9.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.3.2" xref="S2.E2.m1.9.9.1.1.3.2.cmml">N</mi><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">c</mi><mo id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo rspace="0.111em" id="S2.E2.m1.9.9.1.1.2" xref="S2.E2.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.9.9.1.1.1" xref="S2.E2.m1.9.9.1.1.1.cmml"><munderover id="S2.E2.m1.9.9.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.9.9.1.1.1.2.2.2" xref="S2.E2.m1.9.9.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.9.9.1.1.1.2.2.3" xref="S2.E2.m1.9.9.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.2.2.3.2" xref="S2.E2.m1.9.9.1.1.1.2.2.3.2.cmml">f</mi><mo id="S2.E2.m1.9.9.1.1.1.2.2.3.1" xref="S2.E2.m1.9.9.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.9.9.1.1.1.2.2.3.3" xref="S2.E2.m1.9.9.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.9.9.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.2.3.cmml">F</mi></munderover><mrow id="S2.E2.m1.9.9.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.3.2.cmml">U</mi><mrow id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">c</mi><mo id="S2.E2.m1.4.4.2.4.1" xref="S2.E2.m1.4.4.2.3.cmml">,</mo><mi id="S2.E2.m1.4.4.2.2" xref="S2.E2.m1.4.4.2.2.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.2.cmml">​</mo><msup id="S2.E2.m1.9.9.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">ω</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">X</mi><mrow id="S2.E2.m1.6.6.2.4" xref="S2.E2.m1.6.6.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml">f</mi><mo id="S2.E2.m1.6.6.2.4.1" xref="S2.E2.m1.6.6.2.3.cmml">,</mo><mi id="S2.E2.m1.6.6.2.2" xref="S2.E2.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">X</mi><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S2.E2.m1.8.8.2.4" xref="S2.E2.m1.8.8.2.3.cmml"><mi id="S2.E2.m1.7.7.1.1" xref="S2.E2.m1.7.7.1.1.cmml">f</mi><mo id="S2.E2.m1.8.8.2.4.1" xref="S2.E2.m1.8.8.2.3.cmml">,</mo><mi id="S2.E2.m1.8.8.2.2" xref="S2.E2.m1.8.8.2.2.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S2.E2.m1.9.9.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.9.9.1.2" xref="S2.E2.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.9b"><apply id="S2.E2.m1.9.9.1.1.cmml" xref="S2.E2.m1.9.9.1"><eq id="S2.E2.m1.9.9.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.2"></eq><apply id="S2.E2.m1.9.9.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.3.2">𝑁</ci><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑐</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S2.E2.m1.9.9.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1"><apply id="S2.E2.m1.9.9.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.2.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.9.9.1.1.1.2.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.9.9.1.1.1.2.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3"><eq id="S2.E2.m1.9.9.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.9.9.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.2">𝑓</ci><cn type="integer" id="S2.E2.m1.9.9.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.9.9.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.3">𝐹</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.3.2">𝑈</ci><list id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2.4"><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝑐</ci><ci id="S2.E2.m1.4.4.2.2.cmml" xref="S2.E2.m1.4.4.2.2">𝑓</ci></list></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1"><abs id="S2.E2.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.2"></abs><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝜔</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3">𝑓</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑋</ci><list id="S2.E2.m1.6.6.2.3.cmml" xref="S2.E2.m1.6.6.2.4"><ci id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1.1">𝑓</ci><ci id="S2.E2.m1.6.6.2.2.cmml" xref="S2.E2.m1.6.6.2.2">𝑡</ci></list></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑋</ci></apply><list id="S2.E2.m1.8.8.2.3.cmml" xref="S2.E2.m1.8.8.2.4"><ci id="S2.E2.m1.7.7.1.1.cmml" xref="S2.E2.m1.7.7.1.1">𝑓</ci><ci id="S2.E2.m1.8.8.2.2.cmml" xref="S2.E2.m1.8.8.2.2">𝑡</ci></list></apply></apply></apply></apply><cn type="integer" id="S2.E2.m1.9.9.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.9c">N_{c,t}=\sum_{f=1}^{F}U_{c,f}\left|\omega_{f}(X_{f,t}-\widehat{X}_{f,t})\right|^{2}\;.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">Then the NMR is the average of the ratios of the noise patterns and the <em id="S2.SS1.p4.1.1" class="ltx_emph ltx_font_italic">masking patterns</em>  <math id="S2.SS1.p4.1.m1.2" class="ltx_Math" alttext="M_{c,t}" display="inline"><semantics id="S2.SS1.p4.1.m1.2a"><msub id="S2.SS1.p4.1.m1.2.3" xref="S2.SS1.p4.1.m1.2.3.cmml"><mi id="S2.SS1.p4.1.m1.2.3.2" xref="S2.SS1.p4.1.m1.2.3.2.cmml">M</mi><mrow id="S2.SS1.p4.1.m1.2.2.2.4" xref="S2.SS1.p4.1.m1.2.2.2.3.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.cmml">c</mi><mo id="S2.SS1.p4.1.m1.2.2.2.4.1" xref="S2.SS1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p4.1.m1.2.2.2.2" xref="S2.SS1.p4.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.2b"><apply id="S2.SS1.p4.1.m1.2.3.cmml" xref="S2.SS1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.3.1.cmml" xref="S2.SS1.p4.1.m1.2.3">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.3.2.cmml" xref="S2.SS1.p4.1.m1.2.3.2">𝑀</ci><list id="S2.SS1.p4.1.m1.2.2.2.3.cmml" xref="S2.SS1.p4.1.m1.2.2.2.4"><ci id="S2.SS1.p4.1.m1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1">𝑐</ci><ci id="S2.SS1.p4.1.m1.2.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.2c">M_{c,t}</annotation></semantics></math> of the host signal:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.7" class="ltx_Math" alttext="\text{NMR}(\widehat{X},X)=\frac{1}{C\cdot T}\sum_{c=1}^{C}\sum_{t=1}^{T}\frac{N_{c,t}}{M_{c,t}}\;." display="block"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1" xref="S2.E3.m1.7.7.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1.2" xref="S2.E3.m1.7.7.1.1.2.cmml"><mtext id="S2.E3.m1.7.7.1.1.2.2" xref="S2.E3.m1.7.7.1.1.2.2a.cmml">NMR</mtext><mo lspace="0em" rspace="0em" id="S2.E3.m1.7.7.1.1.2.1" xref="S2.E3.m1.7.7.1.1.2.1.cmml">​</mo><mrow id="S2.E3.m1.7.7.1.1.2.3.2" xref="S2.E3.m1.7.7.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E3.m1.7.7.1.1.2.3.2.1" xref="S2.E3.m1.7.7.1.1.2.3.1.cmml">(</mo><mover accent="true" id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml"><mi id="S2.E3.m1.5.5.2" xref="S2.E3.m1.5.5.2.cmml">X</mi><mo id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.cmml">^</mo></mover><mo id="S2.E3.m1.7.7.1.1.2.3.2.2" xref="S2.E3.m1.7.7.1.1.2.3.1.cmml">,</mo><mi id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml">X</mi><mo stretchy="false" id="S2.E3.m1.7.7.1.1.2.3.2.3" xref="S2.E3.m1.7.7.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.7.7.1.1.3" xref="S2.E3.m1.7.7.1.1.3.cmml"><mfrac id="S2.E3.m1.7.7.1.1.3.2" xref="S2.E3.m1.7.7.1.1.3.2.cmml"><mn id="S2.E3.m1.7.7.1.1.3.2.2" xref="S2.E3.m1.7.7.1.1.3.2.2.cmml">1</mn><mrow id="S2.E3.m1.7.7.1.1.3.2.3" xref="S2.E3.m1.7.7.1.1.3.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.3.2.3.2" xref="S2.E3.m1.7.7.1.1.3.2.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E3.m1.7.7.1.1.3.2.3.1" xref="S2.E3.m1.7.7.1.1.3.2.3.1.cmml">⋅</mo><mi id="S2.E3.m1.7.7.1.1.3.2.3.3" xref="S2.E3.m1.7.7.1.1.3.2.3.3.cmml">T</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.7.7.1.1.3.1" xref="S2.E3.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m1.7.7.1.1.3.3" xref="S2.E3.m1.7.7.1.1.3.3.cmml"><munderover id="S2.E3.m1.7.7.1.1.3.3.1" xref="S2.E3.m1.7.7.1.1.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S2.E3.m1.7.7.1.1.3.3.1.2.2" xref="S2.E3.m1.7.7.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.7.7.1.1.3.3.1.2.3" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.3.3.1.2.3.2" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.2.cmml">c</mi><mo id="S2.E3.m1.7.7.1.1.3.3.1.2.3.1" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.7.7.1.1.3.3.1.2.3.3" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.7.7.1.1.3.3.1.3" xref="S2.E3.m1.7.7.1.1.3.3.1.3.cmml">C</mi></munderover><mrow id="S2.E3.m1.7.7.1.1.3.3.2" xref="S2.E3.m1.7.7.1.1.3.3.2.cmml"><munderover id="S2.E3.m1.7.7.1.1.3.3.2.1" xref="S2.E3.m1.7.7.1.1.3.3.2.1.cmml"><mo movablelimits="false" id="S2.E3.m1.7.7.1.1.3.3.2.1.2.2" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.2" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.2.cmml">t</mi><mo id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.1" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.3" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.7.7.1.1.3.3.2.1.3" xref="S2.E3.m1.7.7.1.1.3.3.2.1.3.cmml">T</mi></munderover><mfrac id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml"><msub id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.4.cmml">N</mi><mrow id="S2.E3.m1.2.2.2.2.2.4" xref="S2.E3.m1.2.2.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">c</mi><mo id="S2.E3.m1.2.2.2.2.2.4.1" xref="S2.E3.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">t</mi></mrow></msub><msub id="S2.E3.m1.4.4.4" xref="S2.E3.m1.4.4.4.cmml"><mi id="S2.E3.m1.4.4.4.4" xref="S2.E3.m1.4.4.4.4.cmml">M</mi><mrow id="S2.E3.m1.4.4.4.2.2.4" xref="S2.E3.m1.4.4.4.2.2.3.cmml"><mi id="S2.E3.m1.3.3.3.1.1.1" xref="S2.E3.m1.3.3.3.1.1.1.cmml">c</mi><mo id="S2.E3.m1.4.4.4.2.2.4.1" xref="S2.E3.m1.4.4.4.2.2.3.cmml">,</mo><mi id="S2.E3.m1.4.4.4.2.2.2" xref="S2.E3.m1.4.4.4.2.2.2.cmml">t</mi></mrow></msub></mfrac></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.7.7.1.2" xref="S2.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.1.1.cmml" xref="S2.E3.m1.7.7.1"><eq id="S2.E3.m1.7.7.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1"></eq><apply id="S2.E3.m1.7.7.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.2"><times id="S2.E3.m1.7.7.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.2.1"></times><ci id="S2.E3.m1.7.7.1.1.2.2a.cmml" xref="S2.E3.m1.7.7.1.1.2.2"><mtext id="S2.E3.m1.7.7.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.2.2">NMR</mtext></ci><interval closure="open" id="S2.E3.m1.7.7.1.1.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.2.3.2"><apply id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5"><ci id="S2.E3.m1.5.5.1.cmml" xref="S2.E3.m1.5.5.1">^</ci><ci id="S2.E3.m1.5.5.2.cmml" xref="S2.E3.m1.5.5.2">𝑋</ci></apply><ci id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6">𝑋</ci></interval></apply><apply id="S2.E3.m1.7.7.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.3"><times id="S2.E3.m1.7.7.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.1"></times><apply id="S2.E3.m1.7.7.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2"><divide id="S2.E3.m1.7.7.1.1.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.3.2"></divide><cn type="integer" id="S2.E3.m1.7.7.1.1.3.2.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2.2">1</cn><apply id="S2.E3.m1.7.7.1.1.3.2.3.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3"><ci id="S2.E3.m1.7.7.1.1.3.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.1">⋅</ci><ci id="S2.E3.m1.7.7.1.1.3.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.2">𝐶</ci><ci id="S2.E3.m1.7.7.1.1.3.2.3.3.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S2.E3.m1.7.7.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3"><apply id="S2.E3.m1.7.7.1.1.3.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.3.1.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.3.3.1.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.3.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1">subscript</csymbol><sum id="S2.E3.m1.7.7.1.1.3.3.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.2.2"></sum><apply id="S2.E3.m1.7.7.1.1.3.3.1.2.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3"><eq id="S2.E3.m1.7.7.1.1.3.3.1.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.1"></eq><ci id="S2.E3.m1.7.7.1.1.3.3.1.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.2">𝑐</ci><cn type="integer" id="S2.E3.m1.7.7.1.1.3.3.1.2.3.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.7.7.1.1.3.3.1.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.1.3">𝐶</ci></apply><apply id="S2.E3.m1.7.7.1.1.3.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2"><apply id="S2.E3.m1.7.7.1.1.3.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.3.2.1.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.3.3.2.1.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.3.2.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1">subscript</csymbol><sum id="S2.E3.m1.7.7.1.1.3.3.2.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.2"></sum><apply id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3"><eq id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.1"></eq><ci id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.7.7.1.1.3.3.2.1.3.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2.1.3">𝑇</ci></apply><apply id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"><divide id="S2.E3.m1.4.4.5.cmml" xref="S2.E3.m1.4.4"></divide><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.4.cmml" xref="S2.E3.m1.2.2.2.4">𝑁</ci><list id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">𝑐</ci><ci id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2">𝑡</ci></list></apply><apply id="S2.E3.m1.4.4.4.cmml" xref="S2.E3.m1.4.4.4"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.cmml" xref="S2.E3.m1.4.4.4">subscript</csymbol><ci id="S2.E3.m1.4.4.4.4.cmml" xref="S2.E3.m1.4.4.4.4">𝑀</ci><list id="S2.E3.m1.4.4.4.2.2.3.cmml" xref="S2.E3.m1.4.4.4.2.2.4"><ci id="S2.E3.m1.3.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.3.1.1.1">𝑐</ci><ci id="S2.E3.m1.4.4.4.2.2.2.cmml" xref="S2.E3.m1.4.4.4.2.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">\text{NMR}(\widehat{X},X)=\frac{1}{C\cdot T}\sum_{c=1}^{C}\sum_{t=1}^{T}\frac{N_{c,t}}{M_{c,t}}\;.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.3" class="ltx_p">Above, <math id="S2.SS1.p5.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">c</annotation></semantics></math> is the critical band index, <math id="S2.SS1.p5.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p5.2.m2.1a"><mi id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><ci id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">f</annotation></semantics></math> is the <span title="" class="ltx_glossaryref">STFT</span> frequency index, and <math id="S2.SS1.p5.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p5.3.m3.1a"><mi id="S2.SS1.p5.3.m3.1.1" xref="S2.SS1.p5.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.1b"><ci id="S2.SS1.p5.3.m3.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.1c">t</annotation></semantics></math> is the time frame index.</p>
</div>
<figure id="S2.F4" class="ltx_figure"><img src="/html/2408.15553/assets/x3.png" id="S2.F4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S2.F4.3.2" class="ltx_text" style="font-size:90%;">The computation steps of the <span title="" class="ltx_glossaryref">NMR</span> </span></figcaption>
</figure>
<div id="S2.SS1.p6" class="ltx_para">
<p id="S2.SS1.p6.1" class="ltx_p">The detailed processing steps<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> of <span title="" class="ltx_glossaryref">NMR</span> calculation are illustrated on Fig. <a href="#S2.F4" title="Figure 4 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and summarized are as follows.

<span id="S2.I1" class="ltx_inline-enumerate">
<span id="S2.I1.i1" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">1.</span> <span id="S2.I1.i1.2" class="ltx_text">Both complex-valued <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.I1.i1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.I1.i1.1.m1.1a"><mi id="S2.I1.i1.1.m1.1.1" xref="S2.I1.i1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.1.m1.1b"><ci id="S2.I1.i1.1.m1.1.1.cmml" xref="S2.I1.i1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.1.m1.1c">X</annotation></semantics></math> and <math id="S2.I1.i1.2.m2.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="S2.I1.i1.2.m2.1a"><mover accent="true" id="S2.I1.i1.2.m2.1.1" xref="S2.I1.i1.2.m2.1.1.cmml"><mi id="S2.I1.i1.2.m2.1.1.2" xref="S2.I1.i1.2.m2.1.1.2.cmml">X</mi><mo id="S2.I1.i1.2.m2.1.1.1" xref="S2.I1.i1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.I1.i1.2.m2.1b"><apply id="S2.I1.i1.2.m2.1.1.cmml" xref="S2.I1.i1.2.m2.1.1"><ci id="S2.I1.i1.2.m2.1.1.1.cmml" xref="S2.I1.i1.2.m2.1.1.1">^</ci><ci id="S2.I1.i1.2.m2.1.1.2.cmml" xref="S2.I1.i1.2.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.2.m2.1c">\widehat{X}</annotation></semantics></math> are computed and scaled by a loudness calibration constant as some factors of the model are level dependent.
</span></span>
<span id="S2.I1.i2" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">2.</span> <span id="S2.I1.i2.2" class="ltx_text">The error <math id="S2.I1.i2.1.m1.1" class="ltx_Math" alttext="\widehat{X}-X" display="inline"><semantics id="S2.I1.i2.1.m1.1a"><mrow id="S2.I1.i2.1.m1.1.1" xref="S2.I1.i2.1.m1.1.1.cmml"><mover accent="true" id="S2.I1.i2.1.m1.1.1.2" xref="S2.I1.i2.1.m1.1.1.2.cmml"><mi id="S2.I1.i2.1.m1.1.1.2.2" xref="S2.I1.i2.1.m1.1.1.2.2.cmml">X</mi><mo id="S2.I1.i2.1.m1.1.1.2.1" xref="S2.I1.i2.1.m1.1.1.2.1.cmml">^</mo></mover><mo id="S2.I1.i2.1.m1.1.1.1" xref="S2.I1.i2.1.m1.1.1.1.cmml">−</mo><mi id="S2.I1.i2.1.m1.1.1.3" xref="S2.I1.i2.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.1.m1.1b"><apply id="S2.I1.i2.1.m1.1.1.cmml" xref="S2.I1.i2.1.m1.1.1"><minus id="S2.I1.i2.1.m1.1.1.1.cmml" xref="S2.I1.i2.1.m1.1.1.1"></minus><apply id="S2.I1.i2.1.m1.1.1.2.cmml" xref="S2.I1.i2.1.m1.1.1.2"><ci id="S2.I1.i2.1.m1.1.1.2.1.cmml" xref="S2.I1.i2.1.m1.1.1.2.1">^</ci><ci id="S2.I1.i2.1.m1.1.1.2.2.cmml" xref="S2.I1.i2.1.m1.1.1.2.2">𝑋</ci></apply><ci id="S2.I1.i2.1.m1.1.1.3.cmml" xref="S2.I1.i2.1.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.1.m1.1c">\widehat{X}-X</annotation></semantics></math> is weighted for each <span title="" class="ltx_glossaryref">DFT</span> frequency by the frequency response <math id="S2.I1.i2.2.m2.1" class="ltx_Math" alttext="\omega_{f}" display="inline"><semantics id="S2.I1.i2.2.m2.1a"><msub id="S2.I1.i2.2.m2.1.1" xref="S2.I1.i2.2.m2.1.1.cmml"><mi id="S2.I1.i2.2.m2.1.1.2" xref="S2.I1.i2.2.m2.1.1.2.cmml">ω</mi><mi id="S2.I1.i2.2.m2.1.1.3" xref="S2.I1.i2.2.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.2.m2.1b"><apply id="S2.I1.i2.2.m2.1.1.cmml" xref="S2.I1.i2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.2.m2.1.1.1.cmml" xref="S2.I1.i2.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i2.2.m2.1.1.2.cmml" xref="S2.I1.i2.2.m2.1.1.2">𝜔</ci><ci id="S2.I1.i2.2.m2.1.1.3.cmml" xref="S2.I1.i2.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.2.m2.1c">\omega_{f}</annotation></semantics></math> of the outer and middle ear filter and the magnitudes are squared.
</span></span>
<span id="S2.I1.i3" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">3.</span> <span id="S2.I1.i3.7" class="ltx_text">These squared errors are decimated according to the 109 critical bands to get the noise patterns <math id="S2.I1.i3.1.m1.2" class="ltx_Math" alttext="N_{c,t}" display="inline"><semantics id="S2.I1.i3.1.m1.2a"><msub id="S2.I1.i3.1.m1.2.3" xref="S2.I1.i3.1.m1.2.3.cmml"><mi id="S2.I1.i3.1.m1.2.3.2" xref="S2.I1.i3.1.m1.2.3.2.cmml">N</mi><mrow id="S2.I1.i3.1.m1.2.2.2.4" xref="S2.I1.i3.1.m1.2.2.2.3.cmml"><mi id="S2.I1.i3.1.m1.1.1.1.1" xref="S2.I1.i3.1.m1.1.1.1.1.cmml">c</mi><mo id="S2.I1.i3.1.m1.2.2.2.4.1" xref="S2.I1.i3.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.I1.i3.1.m1.2.2.2.2" xref="S2.I1.i3.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.1.m1.2b"><apply id="S2.I1.i3.1.m1.2.3.cmml" xref="S2.I1.i3.1.m1.2.3"><csymbol cd="ambiguous" id="S2.I1.i3.1.m1.2.3.1.cmml" xref="S2.I1.i3.1.m1.2.3">subscript</csymbol><ci id="S2.I1.i3.1.m1.2.3.2.cmml" xref="S2.I1.i3.1.m1.2.3.2">𝑁</ci><list id="S2.I1.i3.1.m1.2.2.2.3.cmml" xref="S2.I1.i3.1.m1.2.2.2.4"><ci id="S2.I1.i3.1.m1.1.1.1.1.cmml" xref="S2.I1.i3.1.m1.1.1.1.1">𝑐</ci><ci id="S2.I1.i3.1.m1.2.2.2.2.cmml" xref="S2.I1.i3.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.1.m1.2c">N_{c,t}</annotation></semantics></math>. The decimation is obtained by a multiplication by the <span title="" class="ltx_glossaryref">DFT</span>-to-critical bands mapping matrix <math id="S2.I1.i3.2.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S2.I1.i3.2.m2.1a"><mi id="S2.I1.i3.2.m2.1.1" xref="S2.I1.i3.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.2.m2.1b"><ci id="S2.I1.i3.2.m2.1.1.cmml" xref="S2.I1.i3.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.2.m2.1c">U</annotation></semantics></math>. The critical frequency bands range from <math id="S2.I1.i3.3.m3.3" class="ltx_Math" alttext="80\text{\,}\mathrm{Hz}\text{/}" display="inline"><semantics id="S2.I1.i3.3.m3.3a"><mrow id="S2.I1.i3.3.m3.3.3" xref="S2.I1.i3.3.m3.3.3.cmml"><mn id="S2.I1.i3.3.m3.1.1.1.1.1.1" xref="S2.I1.i3.3.m3.1.1.1.1.1.1.cmml">80</mn><mtext id="S2.I1.i3.3.m3.2.2.2.2.2.2" xref="S2.I1.i3.3.m3.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.I1.i3.3.m3.3.3.3.3.3.3" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.I1.i3.3.m3.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml">Hz</mi><mtext id="S2.I1.i3.3.m3.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.I1.i3.3.m3.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.3.m3.3b"><apply id="S2.I1.i3.3.m3.3.3.cmml" xref="S2.I1.i3.3.m3.3.3"><csymbol cd="latexml" id="S2.I1.i3.3.m3.2.2.2.2.2.2.cmml" xref="S2.I1.i3.3.m3.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S2.I1.i3.3.m3.1.1.1.1.1.1.cmml" xref="S2.I1.i3.3.m3.1.1.1.1.1.1">80</cn><apply id="S2.I1.i3.3.m3.3.3.3.3.3.3.cmml" xref="S2.I1.i3.3.m3.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.I1.i3.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.I1.i3.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.1.1.1.1.1.1">hertz</csymbol><csymbol cd="latexml" id="S2.I1.i3.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.I1.i3.3.m3.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.3.m3.3c">80\text{\,}\mathrm{Hz}\text{/}</annotation></semantics></math> to <math id="S2.I1.i3.4.m4.3" class="ltx_Math" alttext="18\,000\text{\,}\mathrm{Hz}\text{/}" display="inline"><semantics id="S2.I1.i3.4.m4.3a"><mrow id="S2.I1.i3.4.m4.3.3" xref="S2.I1.i3.4.m4.3.3.cmml"><mn id="S2.I1.i3.4.m4.1.1.1.1.1.1" xref="S2.I1.i3.4.m4.1.1.1.1.1.1.cmml">18 000</mn><mtext id="S2.I1.i3.4.m4.2.2.2.2.2.2" xref="S2.I1.i3.4.m4.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.I1.i3.4.m4.3.3.3.3.3.3" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.I1.i3.4.m4.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml">Hz</mi><mtext id="S2.I1.i3.4.m4.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.I1.i3.4.m4.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.4.m4.3b"><apply id="S2.I1.i3.4.m4.3.3.cmml" xref="S2.I1.i3.4.m4.3.3"><csymbol cd="latexml" id="S2.I1.i3.4.m4.2.2.2.2.2.2.cmml" xref="S2.I1.i3.4.m4.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S2.I1.i3.4.m4.1.1.1.1.1.1.cmml" xref="S2.I1.i3.4.m4.1.1.1.1.1.1">18000</cn><apply id="S2.I1.i3.4.m4.3.3.3.3.3.3.cmml" xref="S2.I1.i3.4.m4.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.I1.i3.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.I1.i3.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.1.1.1.1.1.1">hertz</csymbol><csymbol cd="latexml" id="S2.I1.i3.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.I1.i3.4.m4.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.4.m4.3c">18\,000\text{\,}\mathrm{Hz}\text{/}</annotation></semantics></math> with a constant resolution of <math id="S2.I1.i3.5.m5.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="S2.I1.i3.5.m5.1a"><mn id="S2.I1.i3.5.m5.1.1" xref="S2.I1.i3.5.m5.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="S2.I1.i3.5.m5.1b"><cn type="float" id="S2.I1.i3.5.m5.1.1.cmml" xref="S2.I1.i3.5.m5.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.5.m5.1c">0.25</annotation></semantics></math> Bark. The rows of the matrix <math id="S2.I1.i3.6.m6.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S2.I1.i3.6.m6.1a"><mi id="S2.I1.i3.6.m6.1.1" xref="S2.I1.i3.6.m6.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.6.m6.1b"><ci id="S2.I1.i3.6.m6.1.1.cmml" xref="S2.I1.i3.6.m6.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.6.m6.1c">U</annotation></semantics></math> are the magnitude responses of band-pass filters equal to one inside the critical band, zero outside of it, and linearly interpolated in the transition bands. The columns of the matrix <math id="S2.I1.i3.7.m7.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S2.I1.i3.7.m7.1a"><mi id="S2.I1.i3.7.m7.1.1" xref="S2.I1.i3.7.m7.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.7.m7.1b"><ci id="S2.I1.i3.7.m7.1.1.cmml" xref="S2.I1.i3.7.m7.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.7.m7.1c">U</annotation></semantics></math> sum up to one.
</span></span>
<span id="S2.I1.i4" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">4.</span> <span id="S2.I1.i4.3" class="ltx_text">The host <span title="" class="ltx_glossaryref">STFT</span> is itself similarly scaled by the loudness calibration constant, weighted by <math id="S2.I1.i4.1.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.I1.i4.1.m1.1a"><mi id="S2.I1.i4.1.m1.1.1" xref="S2.I1.i4.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.1.m1.1b"><ci id="S2.I1.i4.1.m1.1.1.cmml" xref="S2.I1.i4.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.1.m1.1c">\omega</annotation></semantics></math> and the squared magnitude is decimated to the critical bands with the multiplication by the DFT-to-critical bands mapping matrix <math id="S2.I1.i4.2.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S2.I1.i4.2.m2.1a"><mi id="S2.I1.i4.2.m2.1.1" xref="S2.I1.i4.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.2.m2.1b"><ci id="S2.I1.i4.2.m2.1.1.cmml" xref="S2.I1.i4.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.2.m2.1c">U</annotation></semantics></math> to result into the <em id="S2.I1.i4.3.1" class="ltx_emph ltx_font_italic">pitch patterns</em>. Those pitch patterns are spread first over the frequencies to model simultaneous masking and then in time to model temporal masking to get the excitation patterns, which are multiplied by a frequency-dependent offset to get the <em id="S2.I1.i4.3.2" class="ltx_emph ltx_font_italic">masking patterns</em> <math id="S2.I1.i4.3.m3.2" class="ltx_Math" alttext="M_{c,t}" display="inline"><semantics id="S2.I1.i4.3.m3.2a"><msub id="S2.I1.i4.3.m3.2.3" xref="S2.I1.i4.3.m3.2.3.cmml"><mi id="S2.I1.i4.3.m3.2.3.2" xref="S2.I1.i4.3.m3.2.3.2.cmml">M</mi><mrow id="S2.I1.i4.3.m3.2.2.2.4" xref="S2.I1.i4.3.m3.2.2.2.3.cmml"><mi id="S2.I1.i4.3.m3.1.1.1.1" xref="S2.I1.i4.3.m3.1.1.1.1.cmml">c</mi><mo id="S2.I1.i4.3.m3.2.2.2.4.1" xref="S2.I1.i4.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.I1.i4.3.m3.2.2.2.2" xref="S2.I1.i4.3.m3.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i4.3.m3.2b"><apply id="S2.I1.i4.3.m3.2.3.cmml" xref="S2.I1.i4.3.m3.2.3"><csymbol cd="ambiguous" id="S2.I1.i4.3.m3.2.3.1.cmml" xref="S2.I1.i4.3.m3.2.3">subscript</csymbol><ci id="S2.I1.i4.3.m3.2.3.2.cmml" xref="S2.I1.i4.3.m3.2.3.2">𝑀</ci><list id="S2.I1.i4.3.m3.2.2.2.3.cmml" xref="S2.I1.i4.3.m3.2.2.2.4"><ci id="S2.I1.i4.3.m3.1.1.1.1.cmml" xref="S2.I1.i4.3.m3.1.1.1.1">𝑐</ci><ci id="S2.I1.i4.3.m3.2.2.2.2.cmml" xref="S2.I1.i4.3.m3.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.3.m3.2c">M_{c,t}</annotation></semantics></math>. The masking patterns correspond to the masking thresholds below which a sound would be imperceptible.
</span></span>
<span id="S2.I1.i5" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">5.</span> <span id="S2.I1.i5.2" class="ltx_text">The <span title="" class="ltx_glossaryref">NMR</span> is the average of the ratios (<a href="#S2.E3" title="Equation 3 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) of the noise patterns <math id="S2.I1.i5.1.m1.2" class="ltx_Math" alttext="N_{c,t}" display="inline"><semantics id="S2.I1.i5.1.m1.2a"><msub id="S2.I1.i5.1.m1.2.3" xref="S2.I1.i5.1.m1.2.3.cmml"><mi id="S2.I1.i5.1.m1.2.3.2" xref="S2.I1.i5.1.m1.2.3.2.cmml">N</mi><mrow id="S2.I1.i5.1.m1.2.2.2.4" xref="S2.I1.i5.1.m1.2.2.2.3.cmml"><mi id="S2.I1.i5.1.m1.1.1.1.1" xref="S2.I1.i5.1.m1.1.1.1.1.cmml">c</mi><mo id="S2.I1.i5.1.m1.2.2.2.4.1" xref="S2.I1.i5.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.I1.i5.1.m1.2.2.2.2" xref="S2.I1.i5.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i5.1.m1.2b"><apply id="S2.I1.i5.1.m1.2.3.cmml" xref="S2.I1.i5.1.m1.2.3"><csymbol cd="ambiguous" id="S2.I1.i5.1.m1.2.3.1.cmml" xref="S2.I1.i5.1.m1.2.3">subscript</csymbol><ci id="S2.I1.i5.1.m1.2.3.2.cmml" xref="S2.I1.i5.1.m1.2.3.2">𝑁</ci><list id="S2.I1.i5.1.m1.2.2.2.3.cmml" xref="S2.I1.i5.1.m1.2.2.2.4"><ci id="S2.I1.i5.1.m1.1.1.1.1.cmml" xref="S2.I1.i5.1.m1.1.1.1.1">𝑐</ci><ci id="S2.I1.i5.1.m1.2.2.2.2.cmml" xref="S2.I1.i5.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.1.m1.2c">N_{c,t}</annotation></semantics></math> and the masking patterns <math id="S2.I1.i5.2.m2.2" class="ltx_Math" alttext="M_{c,t}" display="inline"><semantics id="S2.I1.i5.2.m2.2a"><msub id="S2.I1.i5.2.m2.2.3" xref="S2.I1.i5.2.m2.2.3.cmml"><mi id="S2.I1.i5.2.m2.2.3.2" xref="S2.I1.i5.2.m2.2.3.2.cmml">M</mi><mrow id="S2.I1.i5.2.m2.2.2.2.4" xref="S2.I1.i5.2.m2.2.2.2.3.cmml"><mi id="S2.I1.i5.2.m2.1.1.1.1" xref="S2.I1.i5.2.m2.1.1.1.1.cmml">c</mi><mo id="S2.I1.i5.2.m2.2.2.2.4.1" xref="S2.I1.i5.2.m2.2.2.2.3.cmml">,</mo><mi id="S2.I1.i5.2.m2.2.2.2.2" xref="S2.I1.i5.2.m2.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i5.2.m2.2b"><apply id="S2.I1.i5.2.m2.2.3.cmml" xref="S2.I1.i5.2.m2.2.3"><csymbol cd="ambiguous" id="S2.I1.i5.2.m2.2.3.1.cmml" xref="S2.I1.i5.2.m2.2.3">subscript</csymbol><ci id="S2.I1.i5.2.m2.2.3.2.cmml" xref="S2.I1.i5.2.m2.2.3.2">𝑀</ci><list id="S2.I1.i5.2.m2.2.2.2.3.cmml" xref="S2.I1.i5.2.m2.2.2.2.4"><ci id="S2.I1.i5.2.m2.1.1.1.1.cmml" xref="S2.I1.i5.2.m2.1.1.1.1">𝑐</ci><ci id="S2.I1.i5.2.m2.2.2.2.2.cmml" xref="S2.I1.i5.2.m2.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.2.m2.2c">M_{c,t}</annotation></semantics></math>.
</span></span>
</span>
The pitch and the masking patterns of a host signal in one example time frame, and the noise patterns between the host and marked signals for two models that we trained are shown on Fig. <a href="#S2.F5" title="Figure 5 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S2.F5" class="ltx_figure"><img src="/html/2408.15553/assets/x4.png" id="S2.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="210" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S2.F5.3.2" class="ltx_text" style="font-size:90%;">Pitch and masking patterns for a host signal, and the noise patterns for marked signals generated by two (NMR256 and MSE256) of our models</span></figcaption>
</figure>
<div id="S2.SS1.p7" class="ltx_para">
<p id="S2.SS1.p7.1" class="ltx_p">The <span title="" class="ltx_glossaryref">NMR</span> calculation process is detailed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and some clarifications are given by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
where (<a href="#S2.E3" title="Equation 3 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), converted into dB, is referred as the total NMR. In the ITU-R recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, the error to compute the noise patterns is the squared difference of the magnitudes but here we compute the squared magnitude of the complex difference as shown in (<a href="#S2.E2" title="Equation 2 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
The reason for that lies in the fact that we want to use the <span title="" class="ltx_glossaryref">NMR</span> as a loss to generate a marked signal and we need not only the amplitude but also the phase to be as close as possible to the host signal. The sampling rate and STFT parameters we use are different than in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> where the signal is sampled at <math id="S2.SS1.p7.1.m1.3" class="ltx_Math" alttext="48\text{\,}\mathrm{kHz}\text{/}" display="inline"><semantics id="S2.SS1.p7.1.m1.3a"><mrow id="S2.SS1.p7.1.m1.3.3" xref="S2.SS1.p7.1.m1.3.3.cmml"><mn id="S2.SS1.p7.1.m1.1.1.1.1.1.1" xref="S2.SS1.p7.1.m1.1.1.1.1.1.1.cmml">48</mn><mtext id="S2.SS1.p7.1.m1.2.2.2.2.2.2" xref="S2.SS1.p7.1.m1.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.SS1.p7.1.m1.3.3.3.3.3.3" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.SS1.p7.1.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kHz</mi><mtext id="S2.SS1.p7.1.m1.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.SS1.p7.1.m1.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p7.1.m1.3b"><apply id="S2.SS1.p7.1.m1.3.3.cmml" xref="S2.SS1.p7.1.m1.3.3"><csymbol cd="latexml" id="S2.SS1.p7.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p7.1.m1.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S2.SS1.p7.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p7.1.m1.1.1.1.1.1.1">48</cn><apply id="S2.SS1.p7.1.m1.3.3.3.3.3.3.cmml" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.SS1.p7.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.SS1.p7.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.1.1.1.1.1.1">kilohertz</csymbol><csymbol cd="latexml" id="S2.SS1.p7.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.SS1.p7.1.m1.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p7.1.m1.3c">48\text{\,}\mathrm{kHz}\text{/}</annotation></semantics></math>, the length of the DFT is 2048 samples.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">The Embedder</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.4" class="ltx_p">A <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="128\times 64" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mn id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">128</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">128</cn><cn type="integer" id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">128\times 64</annotation></semantics></math>-submatrix of the host <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">X</annotation></semantics></math>, cropped between the <span id="S2.SS2.p1.4.1" class="ltx_ERROR undefined">\nth</span>4 and <span id="S2.SS2.p1.4.2" class="ltx_ERROR undefined">\nth</span>131 frequencies and between the <span id="S2.SS2.p1.4.3" class="ltx_ERROR undefined">\nth</span>17 and the <span id="S2.SS2.p1.4.4" class="ltx_ERROR undefined">\nth</span>80 time frame, is fed to the embedder network.
The goal of the frequency cropping is to limit the watermark in a frequency region (<math id="S2.SS2.p1.3.m3.3" class="ltx_Math" alttext="80\text{\,}\mathrm{Hz}\text{/}" display="inline"><semantics id="S2.SS2.p1.3.m3.3a"><mrow id="S2.SS2.p1.3.m3.3.3" xref="S2.SS2.p1.3.m3.3.3.cmml"><mn id="S2.SS2.p1.3.m3.1.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml">80</mn><mtext id="S2.SS2.p1.3.m3.2.2.2.2.2.2" xref="S2.SS2.p1.3.m3.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.SS2.p1.3.m3.3.3.3.3.3.3" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.SS2.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml">Hz</mi><mtext id="S2.SS2.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.SS2.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.3b"><apply id="S2.SS2.p1.3.m3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3"><csymbol cd="latexml" id="S2.SS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1">80</cn><apply id="S2.SS2.p1.3.m3.3.3.3.3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.SS2.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.SS2.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1">hertz</csymbol><csymbol cd="latexml" id="S2.SS2.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.3c">80\text{\,}\mathrm{Hz}\text{/}</annotation></semantics></math>-<math id="S2.SS2.p1.4.m4.3" class="ltx_Math" alttext="5.6\text{\,}\mathrm{kHz}\text{/}" display="inline"><semantics id="S2.SS2.p1.4.m4.3a"><mrow id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml"><mn id="S2.SS2.p1.4.m4.1.1.1.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.cmml">5.6</mn><mtext id="S2.SS2.p1.4.m4.2.2.2.2.2.2" xref="S2.SS2.p1.4.m4.2.2.2.2.2.2.cmml"> </mtext><mrow id="S2.SS2.p1.4.m4.3.3.3.3.3.3" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S2.SS2.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kHz</mi><mtext id="S2.SS2.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S2.SS2.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.3b"><apply id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3"><csymbol cd="latexml" id="S2.SS2.p1.4.m4.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.2.2.2">times</csymbol><cn type="float" id="S2.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1">5.6</cn><apply id="S2.SS2.p1.4.m4.3.3.3.3.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.SS2.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S2.SS2.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1">kilohertz</csymbol><csymbol cd="latexml" id="S2.SS2.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.3c">5.6\text{\,}\mathrm{kHz}\text{/}</annotation></semantics></math>) containing most of the audio content so that the watermark cannot be removed by simple filtering. The cropping in time was intended to improve the extraction of a desynchronized watermark (which is not addressed in this study). As a consequence of it, there is no watermark at the beginning and at the end of the marked segments as shown on Fig. <a href="#S2.F3" title="Figure 3 ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.4" class="ltx_p">As in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> the embedder network (Fig. <a href="#S2.F6" title="Figure 6 ‣ II-B The Embedder ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) is based on the U-net model and is composed of an encoder and a decoder. The encoder contains four downsampling units, each consisting of a convolutional layer, a 2D batch normalization layer and a leaky ReLU activation. Halving the width and the height of the feature maps is obtained with a stride of <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mn id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><times id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">2</cn><cn type="integer" id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">2\times 2</annotation></semantics></math> in the convolutional layers. The amount of channels is increased from 2 in the input to 256 in the bottommost layer where the feature map has a size of 8<math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mo id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><times id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\times</annotation></semantics></math>4. This last output is concatenated along the channels dimension with the binary message where each of the 256 bit is replicated 8<math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mo id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><times id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\times</annotation></semantics></math>4 times to constitute 256 channels. This 512-channel concatenation is fed to an embedding unit composed of a convolutional layer of stride <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mn id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mn id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></times><cn type="integer" id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">1</cn><cn type="integer" id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">1\times 1</annotation></semantics></math> followed by a leaky ReLU activation, which outputs a feature map of 256 channels.</p>
</div>
<figure id="S2.F6" class="ltx_figure"><img src="/html/2408.15553/assets/x5.png" id="S2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="182" height="131" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S2.F6.3.2" class="ltx_text" style="font-size:90%;">The embedder network</span></figcaption>
</figure>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">The decoder contains four upsampling units with skip connections coming from the encoder at each level. The input of the upsampling units are the concatenation of the output of the corresponding downsampling unit and the output of the unit below. The upsampling units are composed of a transposed convolution with a stride <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mn id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p3.1.m1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.cmml">×</mo><mn id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><times id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1"></times><cn type="integer" id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">2</cn><cn type="integer" id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">2\times 2</annotation></semantics></math>, a 2D batch normalization layer and a ReLU activation. For the two bottommost ones, the activation is followed by a dropout layer of probability 50% as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> to increase the robustness of the system against attacks. The output of each upsampling unit has the same size (number of channels, height and width) than the input of the downsampling unit at the same level at the exception of the topmost unit which has 16 channels, whereas the network input feature map has two. Finally, those two feature maps are concatenated and fed to a convolutional layer. This upper skip connection is added in comparison to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and another difference is that we have four downsampling and upsampling units whereas the embedder in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> has one more of each and an intermediary feature map of 16 channels.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.4" class="ltx_p">The full output <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><mi id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">Y</annotation></semantics></math> is obtained by inserting the <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="{2\times 128\times 64}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><mrow id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><mn id="S2.SS2.p4.2.m2.1.1.2" xref="S2.SS2.p4.2.m2.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.2.m2.1.1.1" xref="S2.SS2.p4.2.m2.1.1.1.cmml">×</mo><mn id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml">128</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.2.m2.1.1.1a" xref="S2.SS2.p4.2.m2.1.1.1.cmml">×</mo><mn id="S2.SS2.p4.2.m2.1.1.4" xref="S2.SS2.p4.2.m2.1.1.4.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><times id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1"></times><cn type="integer" id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2">2</cn><cn type="integer" id="S2.SS2.p4.2.m2.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3">128</cn><cn type="integer" id="S2.SS2.p4.2.m2.1.1.4.cmml" xref="S2.SS2.p4.2.m2.1.1.4">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">{2\times 128\times 64}</annotation></semantics></math> autoencoder output into the host <span title="" class="ltx_glossaryref">STFT</span> between the <span id="S2.SS2.p4.4.1" class="ltx_ERROR undefined">\nth</span>4 and <span id="S2.SS2.p4.4.2" class="ltx_ERROR undefined">\nth</span>131 frequency, and the <span id="S2.SS2.p4.4.3" class="ltx_ERROR undefined">\nth</span>17 and <span id="S2.SS2.p4.4.4" class="ltx_ERROR undefined">\nth</span>80 time frame. The inverse <span title="" class="ltx_glossaryref">STFT</span> of <math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><mi id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><ci id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">Y</annotation></semantics></math> is returned by the embedder as the marked segment <math id="S2.SS2.p4.4.m4.1" class="ltx_Math" alttext="\widehat{x}" display="inline"><semantics id="S2.SS2.p4.4.m4.1a"><mover accent="true" id="S2.SS2.p4.4.m4.1.1" xref="S2.SS2.p4.4.m4.1.1.cmml"><mi id="S2.SS2.p4.4.m4.1.1.2" xref="S2.SS2.p4.4.m4.1.1.2.cmml">x</mi><mo id="S2.SS2.p4.4.m4.1.1.1" xref="S2.SS2.p4.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m4.1b"><apply id="S2.SS2.p4.4.m4.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1"><ci id="S2.SS2.p4.4.m4.1.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1">^</ci><ci id="S2.SS2.p4.4.m4.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m4.1c">\widehat{x}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">The Extractor</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The 160 lowest frequency bins and 96 time frames from the <span title="" class="ltx_glossaryref">STFT</span> <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\widehat{X}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mover accent="true" id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">X</mi><mo id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><ci id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1">^</ci><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\widehat{X}</annotation></semantics></math> of the marked segment are fed to the <em id="S2.SS3.p1.1.1" class="ltx_emph ltx_font_italic">extractor network</em> (Fig. <a href="#S2.F7" title="Figure 7 ‣ II-C The Extractor ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). There is no cropping in time to give the possibility to recover a desynchronized watermark.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">The <em id="S2.SS3.p2.1.1" class="ltx_emph ltx_font_italic">extractor network</em> contains three downsampling units, each composed of a convolutional layer with a stride of 2<math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mo id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><times id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\times</annotation></semantics></math>2, a 2D batch normalization layer, and a leaky ReLU activation. The final unit’s output is fed to a dense layer and a sigmoid activation to compute the predicted message: a sequence of 256 floats, between 0 and 1.</p>
</div>
<figure id="S2.F7" class="ltx_figure"><img src="/html/2408.15553/assets/x6.png" id="S2.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="130" height="46" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S2.F7.3.2" class="ltx_text" style="font-size:90%;">The extractor network</span></figcaption>
</figure>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.2" class="ltx_p">In both embedder and extractor, the convolutional and transposed convolutional layers have kernels of size 5<math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><mo id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><times id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">\times</annotation></semantics></math>5, and the ones followed by a batch normalization have no bias. The leaky ReLUs have a negative slope of <math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><mn id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><cn type="float" id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">0.2</annotation></semantics></math>.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">We also designed a second model to embed messages of length 512 bits. The only differences are the number of input channels of the convolutional layer in the embedding unit (768 instead of 512) and the dimension for the output of the dense layer in the extractor (512 instead of 256).</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">evaluation</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We evaluate two models with message lengths 256 and 512 bits.
Each is trained in two versions, one with the loss (<a href="#S2.E1" title="Equation 1 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) that uses the <span title="" class="ltx_glossaryref">NMR</span>, and the second one where <span title="" class="ltx_glossaryref">MSE</span> is used instead of the <span title="" class="ltx_glossaryref">NMR</span> loss.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">The audio data</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">The models are trained with a subset of the FMA audio dataset (medium version) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The original dataset contains <math id="S3.SS1.p1.1.m1.3" class="ltx_Math" alttext="25\,000\text{\,}\mathrm{t}" display="inline"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mn id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml">25 000</mn><mtext id="S3.SS1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.cmml"> </mtext><mi mathvariant="normal" id="S3.SS1.p1.1.m1.3.3.3.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.3.3.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1">25000</cn><ci id="S3.SS1.p1.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3.3.3.3">t</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">25\,000\text{\,}\mathrm{t}</annotation></semantics></math>racks of <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="30\text{\,}\mathrm{s}\text{/}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml"><mn id="S3.SS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml">30</mn><mtext id="S3.SS1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS1.p1.2.m2.3.3.3.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.cmml"><mi class="ltx_unit" mathvariant="normal" id="S3.SS1.p1.2.m2.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.1.1.1.1.1.1.cmml">s</mi><mtext id="S3.SS1.p1.2.m2.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS1.p1.2.m2.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1">30</cn><apply id="S3.SS1.p1.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS1.p1.2.m2.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.1.1.1.1.1.1">second</csymbol><csymbol cd="latexml" id="S3.SS1.p1.2.m2.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">30\text{\,}\mathrm{s}\text{/}</annotation></semantics></math>, in mp3 format from 16 unbalanced genres, at a sampling rate of <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="44.1\text{\,}\mathrm{kHz}\text{/}" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">44.1</mn><mtext id="S3.SS1.p1.3.m3.2.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS1.p1.3.m3.3.3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S3.SS1.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kHz</mi><mtext id="S3.SS1.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS1.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2">times</csymbol><cn type="float" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1">44.1</cn><apply id="S3.SS1.p1.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS1.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.1.1.1.1.1.1">kilohertz</csymbol><csymbol cd="latexml" id="S3.SS1.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">44.1\text{\,}\mathrm{kHz}\text{/}</annotation></semantics></math>. The tracks which original bit rate compression is lower than <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="192\text{\,}\mathrm{kbit}\text{/}\mathrm{s}" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><mn id="S3.SS1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml">192</mn><mtext id="S3.SS1.p1.4.m4.2.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS1.p1.4.m4.3.3.3.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S3.SS1.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kbit</mi><mtext id="S3.SS1.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi class="ltx_unit" mathvariant="normal" id="S3.SS1.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1">192</cn><apply id="S3.SS1.p1.4.m4.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS1.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.1.1.1.1.1.1">kilobit</csymbol><csymbol cd="latexml" id="S3.SS1.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3.3.3.3.3.3.3.3.3">second</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">192\text{\,}\mathrm{kbit}\text{/}\mathrm{s}</annotation></semantics></math> are discarded. Each randomly selected track is converted to mono, cropped, and split into twenty-four <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="1\,103\text{\,}\mathrm{ms}\text{/}" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml"><mn id="S3.SS1.p1.5.m5.1.1.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml">1 103</mn><mtext id="S3.SS1.p1.5.m5.2.2.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS1.p1.5.m5.3.3.3.3.3.3" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S3.SS1.p1.5.m5.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.1.1.1.1.1.1.cmml">ms</mi><mtext id="S3.SS1.p1.5.m5.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS1.p1.5.m5.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><apply id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.1">1103</cn><apply id="S3.SS1.p1.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS1.p1.5.m5.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.1.1.1.1.1.1">millisecond</csymbol><csymbol cd="latexml" id="S3.SS1.p1.5.m5.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">1\,103\text{\,}\mathrm{ms}\text{/}</annotation></semantics></math>-long segments for which the masking patterns are computed. Those 24 segments are put into the same randomly selected training or validation set to reach a total duration of respectively 80 and 10 hours.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Training</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">A set of models is trained with <span title="" class="ltx_glossaryref">MSE</span> instead of <span title="" class="ltx_glossaryref">NMR</span> in the loss formula (<a href="#S2.E1" title="Equation 1 ‣ II-A NMR loss ‣ II proposed method ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). For a message length of 256 bits, an initial model is trained for one epoch with weight <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\alpha=0.5}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\alpha=0.5}</annotation></semantics></math>. Then the weight is given its final value and the training resumed for 29 more epochs. We choose five different final values for <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\alpha</annotation></semantics></math> (0.8, 0.9, 0.92, 0.95, and 0.98) and train three models for each of them; if we use directly the final weight values, without the initial epoch, the model would extract random messages.
Those final values for <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\alpha</annotation></semantics></math> were chosen to get a set of models with various and decent acoustic properties and accuracy for the extraction so that all of them could be selected for the listening tests.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">A second initial model is trained with the <span title="" class="ltx_glossaryref">NMR</span> for the three first epochs with successive weights <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha=10^{-4}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">=</mo><msup id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mn id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml"><mo id="S3.SS2.p2.1.m1.1.1.3.3a" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></eq><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝛼</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">10</cn><apply id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><minus id="S3.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\alpha=10^{-4}</annotation></semantics></math>, <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mn id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">10</mn><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mo id="S3.SS2.p2.2.m2.1.1.3a" xref="S3.SS2.p2.2.m2.1.1.3.cmml">−</mo><mn id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><cn type="integer" id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">10</cn><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><minus id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3"></minus><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">10^{-2}</annotation></semantics></math> and <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="10^{-1}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mn id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">10</mn><mrow id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mo id="S3.SS2.p2.3.m3.1.1.3a" xref="S3.SS2.p2.3.m3.1.1.3.cmml">−</mo><mn id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><cn type="integer" id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">10</cn><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><minus id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3"></minus><cn type="integer" id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">10^{-1}</annotation></semantics></math>. Then three models are trained with each of the final values for <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\alpha</annotation></semantics></math> (0.1, 0.2, 0.3, 0.4, and 0.5) for 27 more epochs. Those final weights values are chosen to get 15 <span title="" class="ltx_glossaryref">NMR</span> trained models with <span title="" class="ltx_glossaryref">bit error rate (BER)</span> comparable to the 15 previously <span title="" class="ltx_glossaryref">MSE</span> trained models.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p">Except the initial and final weights, and the distortion loss, all the models, with identical architecture, are trained in the same conditions (learning rate, batch size, Adam optimizer). The binary message is randomly drawn for each audio segment and at each epoch. The training sessions lasted at most 30 epochs, with early stopping when the validation loss did not improve for two consecutive epochs to prevent overfitting. The model at the epoch with the best validation loss <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi mathvariant="normal" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\ell</annotation></semantics></math> is selected.
The balance between the accuracy of the message extraction and the transparency of the watermark depends on the final value of the weight <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\alpha</annotation></semantics></math>. For two models trained with the same loss function, a higher final value of <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\alpha</annotation></semantics></math> generally means a better transparency (measured with <span title="" class="ltx_glossaryref">MSE</span> or <span title="" class="ltx_glossaryref">NMR</span>) and a lower accuracy (measured with the <span title="" class="ltx_glossaryref">BCE</span>).</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Out of those 15 models trained with <span title="" class="ltx_glossaryref">MSE</span>, we select the one with the best <span title="" class="ltx_glossaryref">signal-to-noise ratio (SNR)</span> on the test set.
Out of the 15 <span title="" class="ltx_glossaryref">NMR</span> trained models, we select the one with the best <span title="" class="ltx_glossaryref">NMR</span> among those with lower <span title="" class="ltx_glossaryref">BER</span> than the selected MSE model. Those two models are the MSE256 and the NMR256 models of the Table <a href="#S3.T1" title="Table I ‣ III-B Training ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">The same scenario is reproduced with an input message of 512 bits, and we obtain the four models of the Table <a href="#S3.T1" title="Table I ‣ III-B Training ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. We can observe that for this longer messages the <span title="" class="ltx_glossaryref">BER</span> is becoming very high and the <span title="" class="ltx_glossaryref">SNR</span> slightly worse and those models would not be accurate enough to be used for efficient audio watermarking.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.14.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S3.T1.15.2" class="ltx_text" style="font-size:90%;">The four selected trained models. The validation metrics used for the selection are in blue</span></figcaption>
<table id="S3.T1.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.12.13.1" class="ltx_tr">
<th id="S3.T1.12.13.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Model</th>
<th id="S3.T1.12.13.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">BER</th>
<th id="S3.T1.12.13.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">SNR (dB)</th>
<th id="S3.T1.12.13.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">NMR (dB)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.3.3" class="ltx_tr">
<th id="S3.T1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">MSE256</th>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="0.00030" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">0.00030</mn><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><cn type="float" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">0.00030</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">0.00030</annotation></semantics></math></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S3.T1.2.2.2.1" class="ltx_text" style="color:#0000FF;"><math id="S3.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="25.8" display="inline"><semantics id="S3.T1.2.2.2.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.1.m1.1.1.cmml">25.8</mn><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.m1.1b"><cn type="float" id="S3.T1.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1">25.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.m1.1c">25.8</annotation></semantics></math></span></td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="13.7" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><mn id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml">13.7</mn><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><cn type="float" id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">13.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">13.7</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<th id="S3.T1.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">NMR256</th>
<td id="S3.T1.4.4.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="0.00025" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">0.00025</mn><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><cn type="float" id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">0.00025</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">0.00025</annotation></semantics></math></td>
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.5.5.2.m1.1" class="ltx_Math" alttext="22.4" display="inline"><semantics id="S3.T1.5.5.2.m1.1a"><mn id="S3.T1.5.5.2.m1.1.1" xref="S3.T1.5.5.2.m1.1.1.cmml">22.4</mn><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.m1.1b"><cn type="float" id="S3.T1.5.5.2.m1.1.1.cmml" xref="S3.T1.5.5.2.m1.1.1">22.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.m1.1c">22.4</annotation></semantics></math></td>
<td id="S3.T1.6.6.3" class="ltx_td ltx_align_left ltx_border_r"><span id="S3.T1.6.6.3.1" class="ltx_text" style="color:#0000FF;"><math id="S3.T1.6.6.3.1.m1.1" class="ltx_Math" alttext="-18.0" display="inline"><semantics id="S3.T1.6.6.3.1.m1.1a"><mrow id="S3.T1.6.6.3.1.m1.1.1.2"><mo mathcolor="#0000FF" id="S3.T1.6.6.3.1.m1.1.1.2a" xref="S3.T1.6.6.3.1.m1.1.1.1.cmml">−</mo><mn mathcolor="#0000FF" id="S3.T1.6.6.3.1.m1.1.1.2.2" xref="S3.T1.6.6.3.1.m1.1.1.1.cmml">18.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.3.1.m1.1b"><cn type="float" id="S3.T1.6.6.3.1.m1.1.1.1.cmml" xref="S3.T1.6.6.3.1.m1.1.1.2a">-18.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.3.1.m1.1c">-18.0</annotation></semantics></math></span></td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<th id="S3.T1.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">MSE512</th>
<td id="S3.T1.7.7.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="0.111" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml">0.111</mn><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><cn type="float" id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">0.111</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">0.111</annotation></semantics></math></td>
<td id="S3.T1.8.8.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S3.T1.8.8.2.1" class="ltx_text" style="color:#0000FF;"><math id="S3.T1.8.8.2.1.m1.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S3.T1.8.8.2.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.8.8.2.1.m1.1.1" xref="S3.T1.8.8.2.1.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.2.1.m1.1b"><cn type="integer" id="S3.T1.8.8.2.1.m1.1.1.cmml" xref="S3.T1.8.8.2.1.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.2.1.m1.1c">25</annotation></semantics></math></span></td>
<td id="S3.T1.9.9.3" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.9.9.3.m1.1" class="ltx_Math" alttext="13.7" display="inline"><semantics id="S3.T1.9.9.3.m1.1a"><mn id="S3.T1.9.9.3.m1.1.1" xref="S3.T1.9.9.3.m1.1.1.cmml">13.7</mn><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.3.m1.1b"><cn type="float" id="S3.T1.9.9.3.m1.1.1.cmml" xref="S3.T1.9.9.3.m1.1.1">13.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.3.m1.1c">13.7</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">NMR512</th>
<td id="S3.T1.10.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="0.097" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><mn mathcolor="#0000FF" id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">0.097</mn><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><cn type="float" id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">0.097</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">0.097</annotation></semantics></math></td>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><math id="S3.T1.11.11.2.m1.1" class="ltx_Math" alttext="18.6" display="inline"><semantics id="S3.T1.11.11.2.m1.1a"><mn id="S3.T1.11.11.2.m1.1.1" xref="S3.T1.11.11.2.m1.1.1.cmml">18.6</mn><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.2.m1.1b"><cn type="float" id="S3.T1.11.11.2.m1.1.1.cmml" xref="S3.T1.11.11.2.m1.1.1">18.6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.2.m1.1c">18.6</annotation></semantics></math></td>
<td id="S3.T1.12.12.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S3.T1.12.12.3.1" class="ltx_text" style="color:#0000FF;"><math id="S3.T1.12.12.3.1.m1.1" class="ltx_Math" alttext="-13.3" display="inline"><semantics id="S3.T1.12.12.3.1.m1.1a"><mrow id="S3.T1.12.12.3.1.m1.1.1.2"><mo mathcolor="#0000FF" id="S3.T1.12.12.3.1.m1.1.1.2a" xref="S3.T1.12.12.3.1.m1.1.1.1.cmml">−</mo><mn mathcolor="#0000FF" id="S3.T1.12.12.3.1.m1.1.1.2.2" xref="S3.T1.12.12.3.1.m1.1.1.1.cmml">13.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.3.1.m1.1b"><cn type="float" id="S3.T1.12.12.3.1.m1.1.1.1.cmml" xref="S3.T1.12.12.3.1.m1.1.1.2a">-13.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.3.1.m1.1c">-13.3</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Objective evaluation</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The objective evaluation is performed with the 100 tracks of the Music Genre Database <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. For each track thirty 1103 ms-long segments are randomly selected. The <span title="" class="ltx_glossaryref">PEAQ</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is evaluated between the segments marked with each four selected models and the host segments. We used the MATLAB implementation by Kabal <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. The results are presented on Fig. <a href="#S3.F8" title="Figure 8 ‣ III-C Objective evaluation ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="S3.F8" class="ltx_figure"><img src="/html/2408.15553/assets/x7.png" id="S3.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="234" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F8.4.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span title="" class="ltx_glossaryref" style="font-size:90%;">PEAQ</span><span id="S3.F8.5.2" class="ltx_text" style="font-size:90%;"> (<span title="" class="ltx_glossaryref">ODG</span> scale) in blue. The red boxes represent the <span title="" class="ltx_glossaryref">SNR</span>. The upper and lower whisker corresponds to the <span id="S3.F8.5.2.1" class="ltx_ERROR undefined">\nth</span>5 and the <span id="S3.F8.5.2.2" class="ltx_ERROR undefined">\nth</span>95 percentiles, the outliers are not shown </span></figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.3" class="ltx_p">With the <span title="" class="ltx_glossaryref">NMR</span>-models more than 95% of the 3000 segments get a <span title="" class="ltx_glossaryref">PEAQ</span> rating between 0 (<em id="S3.SS3.p2.3.1" class="ltx_emph ltx_font_italic">imperceptible</em>) and <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="-1" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mo id="S3.SS3.p2.1.m1.1.1a" xref="S3.SS3.p2.1.m1.1.1.cmml">−</mo><mn id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><minus id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"></minus><cn type="integer" id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">-1</annotation></semantics></math> (<em id="S3.SS3.p2.3.2" class="ltx_emph ltx_font_italic">perceptible but not annoying</em>).
For the <span title="" class="ltx_glossaryref">MSE</span>-models around 25% of the segments are rated between <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="-1" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1a" xref="S3.SS3.p2.2.m2.1.1.cmml">−</mo><mn id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><minus id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"></minus><cn type="integer" id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">-1</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="-4" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mo id="S3.SS3.p2.3.m3.1.1a" xref="S3.SS3.p2.3.m3.1.1.cmml">−</mo><mn id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><minus id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"></minus><cn type="integer" id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">-4</annotation></semantics></math> (<em id="S3.SS3.p2.3.3" class="ltx_emph ltx_font_italic">very annoying</em>). The segments marked by the two <span title="" class="ltx_glossaryref">NMR</span>-models have a lower <span title="" class="ltx_glossaryref">SNR</span> in comparison to the ones marked by the <span title="" class="ltx_glossaryref">MSE</span> models, even though they have a better objective perceptual quality.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.4.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.5.2" class="ltx_text ltx_font_italic">Subjective evaluation</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">We organized a MUSHRA test <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> with the platform WEBMushra <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to evaluate the audio quality of the models of the Table <a href="#S3.T1" title="Table I ‣ III-B Training ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. Although those test have been initially designed to assess audio coding they have been used to evaluate the quality of watermarked audio <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> as well.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">We selected manually the 7 clips of <math id="S3.SS4.p2.1.m1.3" class="ltx_Math" alttext="10\text{\,}\mathrm{s}\text{/}" display="inline"><semantics id="S3.SS4.p2.1.m1.3a"><mrow id="S3.SS4.p2.1.m1.3.3" xref="S3.SS4.p2.1.m1.3.3.cmml"><mn id="S3.SS4.p2.1.m1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml">10</mn><mtext id="S3.SS4.p2.1.m1.2.2.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS4.p2.1.m1.3.3.3.3.3.3" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.cmml"><mi class="ltx_unit" mathvariant="normal" id="S3.SS4.p2.1.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">s</mi><mtext id="S3.SS4.p2.1.m1.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS4.p2.1.m1.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.3b"><apply id="S3.SS4.p2.1.m1.3.3.cmml" xref="S3.SS4.p2.1.m1.3.3"><csymbol cd="latexml" id="S3.SS4.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1">10</cn><apply id="S3.SS4.p2.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS4.p2.1.m1.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS4.p2.1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.1.1.1.1.1.1">second</csymbol><csymbol cd="latexml" id="S3.SS4.p2.1.m1.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.1.m1.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.3c">10\text{\,}\mathrm{s}\text{/}</annotation></semantics></math> shown on Table <a href="#S3.T2" title="Table II ‣ III-D Subjective evaluation ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> from the tracks used in the objective tests with the idea to present a variation of musical genre, number of instruments and spectral signature. For each clip the assessors had to evaluate blindly 7 versions: the original clip, two low-pass filtered anchors at <math id="S3.SS4.p2.2.m2.3" class="ltx_Math" alttext="3.5\text{\,}\mathrm{a}" display="inline"><semantics id="S3.SS4.p2.2.m2.3a"><mrow id="S3.SS4.p2.2.m2.3.3" xref="S3.SS4.p2.2.m2.3.3.cmml"><mn id="S3.SS4.p2.2.m2.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.1.1.cmml">3.5</mn><mtext id="S3.SS4.p2.2.m2.2.2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml"> </mtext><mi mathvariant="normal" id="S3.SS4.p2.2.m2.3.3.3.3.3.3" xref="S3.SS4.p2.2.m2.3.3.3.3.3.3.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.3b"><apply id="S3.SS4.p2.2.m2.3.3.cmml" xref="S3.SS4.p2.2.m2.3.3"><csymbol cd="latexml" id="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2">times</csymbol><cn type="float" id="S3.SS4.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.1">3.5</cn><ci id="S3.SS4.p2.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.2.m2.3.3.3.3.3.3">a</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.3c">3.5\text{\,}\mathrm{a}</annotation></semantics></math>nd <math id="S3.SS4.p2.3.m3.3" class="ltx_Math" alttext="7\text{\,}\mathrm{kHz}\text{/}" display="inline"><semantics id="S3.SS4.p2.3.m3.3a"><mrow id="S3.SS4.p2.3.m3.3.3" xref="S3.SS4.p2.3.m3.3.3.cmml"><mn id="S3.SS4.p2.3.m3.1.1.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.cmml">7</mn><mtext id="S3.SS4.p2.3.m3.2.2.2.2.2.2" xref="S3.SS4.p2.3.m3.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS4.p2.3.m3.3.3.3.3.3.3" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.cmml"><mi class="ltx_unit" id="S3.SS4.p2.3.m3.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml">kHz</mi><mtext id="S3.SS4.p2.3.m3.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS4.p2.3.m3.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.3b"><apply id="S3.SS4.p2.3.m3.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3"><csymbol cd="latexml" id="S3.SS4.p2.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.3.m3.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS4.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1">7</cn><apply id="S3.SS4.p2.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS4.p2.3.m3.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS4.p2.3.m3.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.1.1.1.1.1.1">kilohertz</csymbol><csymbol cd="latexml" id="S3.SS4.p2.3.m3.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.3c">7\text{\,}\mathrm{kHz}\text{/}</annotation></semantics></math> (recommended in MUSHRA tests), and the versions marked with the 4 trained models where the original clip is padded with zeros to the duration of 10 segments, the segments are embedded, concatenated and the result is cropped to the original <math id="S3.SS4.p2.4.m4.3" class="ltx_Math" alttext="10\text{\,}\mathrm{s}\text{/}" display="inline"><semantics id="S3.SS4.p2.4.m4.3a"><mrow id="S3.SS4.p2.4.m4.3.3" xref="S3.SS4.p2.4.m4.3.3.cmml"><mn id="S3.SS4.p2.4.m4.1.1.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml">10</mn><mtext id="S3.SS4.p2.4.m4.2.2.2.2.2.2" xref="S3.SS4.p2.4.m4.2.2.2.2.2.2.cmml"> </mtext><mrow id="S3.SS4.p2.4.m4.3.3.3.3.3.3" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.cmml"><mi class="ltx_unit" mathvariant="normal" id="S3.SS4.p2.4.m4.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml">s</mi><mtext id="S3.SS4.p2.4.m4.3.3.3.3.3.3.2.2.2.2.2.2" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml">/</mtext><mi id="S3.SS4.p2.4.m4.3.3.3.3.3.3.3.3.3.3.3.3" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.3b"><apply id="S3.SS4.p2.4.m4.3.3.cmml" xref="S3.SS4.p2.4.m4.3.3"><csymbol cd="latexml" id="S3.SS4.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2.2.2">times</csymbol><cn type="integer" id="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.1">10</cn><apply id="S3.SS4.p2.4.m4.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3"><csymbol cd="latexml" id="S3.SS4.p2.4.m4.3.3.3.3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.2.2.2.2.2.2">divide</csymbol><csymbol cd="latexml" id="S3.SS4.p2.4.m4.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.1.1.1.1.1.1">second</csymbol><csymbol cd="latexml" id="S3.SS4.p2.4.m4.3.3.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.SS4.p2.4.m4.3.3.3.3.3.3.3.3.3.3.3.3">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.3c">10\text{\,}\mathrm{s}\text{/}</annotation></semantics></math>-duration. The 20 assessors were naive listeners, between 15 and 50 years old, and had no previous experience in evaluation of audio quality. The results are shown on Fig. <a href="#S3.F9" title="Figure 9 ‣ III-D Subjective evaluation ‣ III evaluation ‣ Noise-to-mask Ratio Loss for Deep Neural Network based Audio Watermarking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.9.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S3.T2.10.2" class="ltx_text" style="font-size:90%;">The 10-second clips used for the MUSHRA test</span></figcaption>
<table id="S3.T2.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.7.8.1" class="ltx_tr">
<th id="S3.T2.7.8.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Study ID</th>
<th id="S3.T2.7.8.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Filename</th>
<th id="S3.T2.7.8.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Title</th>
<th id="S3.T2.7.8.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Start time (s)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1" class="ltx_tr">
<td id="S3.T2.1.1.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">pop</td>
<td id="S3.T2.1.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">G001</td>
<td id="S3.T2.1.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Wasting Time</td>
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="S3.T2.1.1.1.m1.1" class="ltx_Math" alttext="240" display="inline"><semantics id="S3.T2.1.1.1.m1.1a"><mn id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">240</mn><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><cn type="integer" id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">240</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">240</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.2.2" class="ltx_tr">
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">techno</td>
<td id="S3.T2.2.2.3" class="ltx_td ltx_align_left ltx_border_r">G021</td>
<td id="S3.T2.2.2.4" class="ltx_td ltx_align_left ltx_border_r">Stf</td>
<td id="S3.T2.2.2.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T2.2.2.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S3.T2.2.2.1.m1.1a"><mn id="S3.T2.2.2.1.m1.1.1" xref="S3.T2.2.2.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.1.m1.1b"><cn type="integer" id="S3.T2.2.2.1.m1.1.1.cmml" xref="S3.T2.2.2.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.1.m1.1c">20</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.3.3" class="ltx_tr">
<td id="S3.T2.3.3.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">jazz</td>
<td id="S3.T2.3.3.3" class="ltx_td ltx_align_left ltx_border_r">G030</td>
<td id="S3.T2.3.3.4" class="ltx_td ltx_align_left ltx_border_r">Kitchen</td>
<td id="S3.T2.3.3.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T2.3.3.1.m1.1" class="ltx_Math" alttext="58" display="inline"><semantics id="S3.T2.3.3.1.m1.1a"><mn id="S3.T2.3.3.1.m1.1.1" xref="S3.T2.3.3.1.m1.1.1.cmml">58</mn><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.1.m1.1b"><cn type="integer" id="S3.T2.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1">58</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.1.m1.1c">58</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.4.4" class="ltx_tr">
<td id="S3.T2.4.4.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">orchestra</td>
<td id="S3.T2.4.4.3" class="ltx_td ltx_align_left ltx_border_r">G050</td>
<td id="S3.T2.4.4.4" class="ltx_td ltx_align_left ltx_border_r">Egmont</td>
<td id="S3.T2.4.4.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T2.4.4.1.m1.1" class="ltx_Math" alttext="210" display="inline"><semantics id="S3.T2.4.4.1.m1.1a"><mn id="S3.T2.4.4.1.m1.1.1" xref="S3.T2.4.4.1.m1.1.1.cmml">210</mn><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.1.m1.1b"><cn type="integer" id="S3.T2.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.1.m1.1.1">210</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.1.m1.1c">210</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.5.5" class="ltx_tr">
<td id="S3.T2.5.5.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">chanson</td>
<td id="S3.T2.5.5.3" class="ltx_td ltx_align_left ltx_border_r">G087</td>
<td id="S3.T2.5.5.4" class="ltx_td ltx_align_left ltx_border_r">Je te Veux</td>
<td id="S3.T2.5.5.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T2.5.5.1.m1.1" class="ltx_Math" alttext="93" display="inline"><semantics id="S3.T2.5.5.1.m1.1a"><mn id="S3.T2.5.5.1.m1.1.1" xref="S3.T2.5.5.1.m1.1.1.cmml">93</mn><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.1.m1.1b"><cn type="integer" id="S3.T2.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.1.m1.1.1">93</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.1.m1.1c">93</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.6.6" class="ltx_tr">
<td id="S3.T2.6.6.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">flamenco</td>
<td id="S3.T2.6.6.3" class="ltx_td ltx_align_left ltx_border_r">G082</td>
<td id="S3.T2.6.6.4" class="ltx_td ltx_align_left ltx_border_r">Sevillanas</td>
<td id="S3.T2.6.6.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T2.6.6.1.m1.1" class="ltx_Math" alttext="70" display="inline"><semantics id="S3.T2.6.6.1.m1.1a"><mn id="S3.T2.6.6.1.m1.1.1" xref="S3.T2.6.6.1.m1.1.1.cmml">70</mn><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.1.m1.1b"><cn type="integer" id="S3.T2.6.6.1.m1.1.1.cmml" xref="S3.T2.6.6.1.m1.1.1">70</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.1.m1.1c">70</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.7.7" class="ltx_tr">
<td id="S3.T2.7.7.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">piano</td>
<td id="S3.T2.7.7.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">G059</td>
<td id="S3.T2.7.7.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">Rondo in D Major</td>
<td id="S3.T2.7.7.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><math id="S3.T2.7.7.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S3.T2.7.7.1.m1.1a"><mn id="S3.T2.7.7.1.m1.1.1" xref="S3.T2.7.7.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.1.m1.1b"><cn type="integer" id="S3.T2.7.7.1.m1.1.1.cmml" xref="S3.T2.7.7.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.1.m1.1c">20</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">For thirteen of the fourteen clips marked with the <span title="" class="ltx_glossaryref">NMR</span>-models the average rate is <em id="S3.SS4.p3.1.1" class="ltx_emph ltx_font_italic">excellent</em> (between 80% and 100%) whereas it is the case for only four of the clips marked with the <span title="" class="ltx_glossaryref">MSE</span>-models. For those, the two original clips (<em id="S3.SS4.p3.1.2" class="ltx_emph ltx_font_italic">pop</em> and <em id="S3.SS4.p3.1.3" class="ltx_emph ltx_font_italic">techno</em>) are acoustically busy with multiple instruments playing at the same time. For the <em id="S3.SS4.p3.1.4" class="ltx_emph ltx_font_italic">chanson</em> marked with the NMR512-model the quality was rated as <em id="S3.SS4.p3.1.5" class="ltx_emph ltx_font_italic">good</em> showing that the watermark is not transparent, but the subjective evaluation is better than the <em id="S3.SS4.p3.1.6" class="ltx_emph ltx_font_italic">fair</em> grade given for both MSE-models. The worse ratings have been given to mono-instrumental clips (guitar and piano) marked with <span title="" class="ltx_glossaryref">MSE</span>-models.</p>
</div>
<figure id="S3.F9" class="ltx_figure"><img src="/html/2408.15553/assets/x8.png" id="S3.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S3.F9.3.2" class="ltx_text" style="font-size:90%;">Mean and 95% confidence intervals of the MUSHRA scores for the 7 clips and their versions marked with the four trained models</span></figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this study we propose a perceptual loss based on the <span title="" class="ltx_glossaryref">NMR</span> which models the psychoacoustic masking effect of the human ear. We use this loss to train an autoencoder <span title="" class="ltx_glossaryref">DNN</span> for music watermarking in the goal of minimizing the perceptual distortion between the host and the marked signal. We also train from scratch the same encoder with <span title="" class="ltx_glossaryref">NMR</span> replaced by the commonly used <span title="" class="ltx_glossaryref">MSE</span> loss
and we compare objective quality with <span title="" class="ltx_glossaryref">PEAQ</span> and subjective quality with MUSHRA tests. Both tests show clear superiority of the audio quality of the watermarked audio embedded by models trained with our perceptual <span title="" class="ltx_glossaryref">NMR</span> loss.
Our solution is not dealing with robustness and synchronization, and this could be addressed by further studies where a <span title="" class="ltx_glossaryref">DNN</span> watermarking system could be trained to resist to attacks and some mechanism found to tackle the synchronization issue. Our <span title="" class="ltx_glossaryref">NMR</span> loss would be used in those future solutions to improve the transparency of the generated watermarks.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
W. Bender, D. Gruhl, N. Morimoto, , and A. Lu, “Techniques for data hiding,”
in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IBM Systems Journal</em>, vol. 35, no. 3-4, 1996.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
G.Hua, J.Huand, Y.Q.Shi, J.Goh, and V.L.Thing, “Twenty years of digital audio
watermarking – a comprehensive review,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Signal Processing</em>, vol.
128, 2016, pp. 222–242.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
L. Tegendal, “Watermarking in audio using deep learning,” Master’s thesis,
Dept. Comput. Vision, Linköping University, Linköping, Sweden, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
K. Pavlović, S. Kovačević, I. Djurović, and A. Wojciechowski, “Robust
speech watermarking by a jointly trained embedder and detector using a dnn,”
in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Digital Signal Processing</em>, vol. 122, 2022, p. 103381.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
C. Liu, J. Zhang, H. Fang, Z. Ma, W. Zhang, and N. Yu, “DeAR: A
deep-learning-based audio re-recording resilient watermarking,” in
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
vol. 37, no. 11, 2023, pp. 13 201–13 209.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
K. Brandenburg, “Evaluation of quality for audio encoding at low bit rates,”
in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Audio Engineering Society Convention 82</em>, 1987.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Method for objective measurements of perceived audio quality</em>, ITU-R
recommendation BS.1387, 1998.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
J. Nikunen and T. Virtanen, “Noise-to-mask ratio minimization by weighted
non-negative matrix factorization,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">2010 IEEE International
Conference on Acoustics, Speech and Signal Processing</em>, 2010, pp. 25–28.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Wu, J. Huang, D. Huang, and Y. Shi, “Efficiently self-synchronized audio
watermarking for assured audio data transmission,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions
on Broadcasting</em>, vol. 51, no. 1, pp. 69–76, 2005.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
G. Chen, Y. Wu, S. Liu, T. Liu, X. Du, and F. Wei, “Wavmark: Watermarking for
audio generation,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
P. Kabal, “An examination and interpretation of ITU-R BS.1387:perceptual
evaluation of audio quality,” Dept. of Elect. Comput. Eng., McGill Univ.,
Montréal, Quebec, Rep., 2002.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
M. Defferrard, K. Benzi, P. Vandergheynst, and X. Bresson, “FMA: A dataset
for music analysis,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">18th International Society for Music
Information Retrieval Conference</em>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Goto, “Development of the RWC music database,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">18th
International Congress on Acoustics</em>, vol. 1, 2004, pp. 553–556.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Method for the subjective assessment of intermediate quality level of
audio systems</em>, ITU-R recommendation BS.1534, Rev. 3, 2015.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Schoefler, “webMUSHRA — a comprehensive framework for web-based
listening tests,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Journal of Open Research Software</em>, vol. 6, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
R. Tachibana, “Sonic watermarking,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">EURASIP Journal on Advances in
Signal Processing</em>, no. 13, 2004.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
K. Kondo, “On the use of objective quality measures to estimate watermarked
audio quality,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">2012 Eighth International Conference on Intelligent
Information Hiding and Multimedia Signal Processing</em>, 2012, pp. 126–129.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.15552" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.15553" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.15553">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.15553" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.15554" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 16:48:34 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
