<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.17376] Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients</title><meta property="og:description" content="Automatic speech recognition models require large amounts of speech recordings for training. However, the collection of such data often is cumbersome and leads to privacy concerns. Federated learning has been widely us…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.17376">

<!--Generated on Wed Jun  5 18:24:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohamed Nabih Ali  <a target="_blank" href="https://orcid.org/0000-0001-9132-9220" title="" class="ltx_ref ltx_href"><img src="/html/2405.17376/assets/orcid.png" id="id1.1.1.g1" class="ltx_graphics ltx_img_square" width="12" height="12" alt="[Uncaptioned image]"> </a>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mnabih@fbk.eu">mnabih@fbk.eu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alessio Brutti <a target="_blank" href="https://orcid.org/0000-0003-4146-3071" title="" class="ltx_ref ltx_href"><img src="/html/2405.17376/assets/orcid.png" id="id2.1.1.g1" class="ltx_graphics ltx_img_square" width="12" height="12" alt="[Uncaptioned image]"> </a>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:brutti@fbk.eu">brutti@fbk.eu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Daniele Falavigna <a target="_blank" href="https://orcid.org/0000-0002-4844-5071" title="" class="ltx_ref ltx_href"><img src="/html/2405.17376/assets/orcid.png" id="id3.1.1.g1" class="ltx_graphics ltx_img_square" width="12" height="12" alt="[Uncaptioned image]"> </a>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:falavi@fbk.eu">falavi@fbk.eu</a>
</span>
<span class="ltx_contact ltx_role_address">Center for Augmented Intelligence, Fondazione Bruno Kessler, Trento, Italy 
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Automatic speech recognition models require large amounts of speech recordings for training. However, the collection of such data often is cumbersome and leads to privacy concerns. Federated learning has been widely used as an effective decentralized technique that collaboratively learns a shared prediction model while keeping the data local on different clients. Unfortunately, client devices often feature limited computation and communication resources leading to practical difficulties for large models. In addition, the heterogeneity that characterizes edge devices makes it sub-optimal to generate a single model that fits all of them. Differently from the recent literature, where multiple models with different architectures are used, in this work, we propose using dynamical architectures which, employing early-exit solutions, can adapt their processing (i.e. traversed layers) depending on the input and on the operation conditions. This solution falls in the realm of partial training methods and brings two benefits: a single model is used on a variety of devices; federating the models after local training is straightforward. Experiments on public datasets show that our proposed approach is effective and can be combined with basic federated learning strategies.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Federated Learning , Automatic Speech Recognition , Early-Exit Architectures

</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Computer Speech &amp; Language</span></span></span>
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\useunder</span>
<p id="p1.2" class="ltx_p"><span id="p1.2.1" class="ltx_text ltx_ulem_uline"></span><span id="p1.2.2" class="ltx_text ltx_framed ltx_framed_underline"></span>





















</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Nowadays, automatic speech recognition (ASR) systems based on deep learning provide excellent performance for many languages and allow to develop either products or services in many application domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. However, the amount of memory and computation resources for handling ASR models is usually high and training is carried out on high-performing servers using centralized datasets  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Nowadays, it is common practice to fine-tune large pre-trained ASR models using data collected on the field. The latter requirement, in particular, poses issues related to data ownership, latency, and cost. These aspects gained a lot of attention with the widespread employment of portable devices: computers, smartphones, wearable devices, etc., most of which featuring limited computational resources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
Consequently, training over a distributed environment, a strategy known as federated learning (FL), received growing attention from the scientific community giving rise to a flourish of investigations and research <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The main aim of FL is to effectively utilize the abundant local private data by training the model locally without the need for a centralized huge dataset. As depicted in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), this is achieved by combining pieces of information from the connected edge devices, while keeping the data decentralized.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2405.17376/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">(a) Federated learning framework with <span id="S1.F1.4.2.1" class="ltx_text ltx_font_bold">N</span> connected clients. (b) An early-exit model architecture deployed on different devices.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In practical application scenarios, besides the typical FL issues related to the variability of data distributions across clients, the heterogeneity and volatility of the computational resources available on the clients introduce a further challenge. In most FL methodologies, a foundational assumption entails treating all clients as "homogeneous" in terms of their computational assets, presuming compatibility with a common shared model architecture. However, this assumption encounters limitations in practical scenarios where devices exhibit substantial disparities in memory capacity, computational capabilities, and power consumption. In particular, the available <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">resources are volatile</span>, depending on what other tasks the device may be handling. Moreover, real-world application domains frequently involve the presence of low-end devices constrained by limited resources. Consequently, the overarching FL framework necessitates managing diverse "heterogeneous" architectures, guided by personalized tasks and local resource constraints <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. In the following, we define Homogeneous FL (OFL) the condition all clients share the same model architecture. Conversely, we denote with Heterogeneous FL (EFL) the case in which different architectures are deployed on the clients. In general, OFL is simpler than EFL, since centralized updates affect all the parameters of the same shared model, while in EFL different architectures have to be managed. The recent state of the art tackles the EFL scenario by: <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">a)</span> maintaining multiple central models (one for each different architecture) and/or <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">b)</span> implementing articulated agglomeration strategies, e.g. by sharing some layers across the various centralized models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Although effective in terms of performance, these approaches require maintaining and federating multiple different models, which demand inevitably more resources (in terms of storage and computation). As an alternative, methods based on partial training are recently emerging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which employ sub-nets or pruning to obtain partial networks of different dimensions that fit the client resources.
Following this direction, we propose to use early-exit (EE) architectures, which introduce intermediate exit branches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> (see Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b)) so that an output can be made available after a subset of the layers has processed the input. This results in multiple scaled versions of the same architectures, that can fit different (time-varying) client requirements. If properly trained, EE models can provide extremely good ASR performance in the lower exits compared against the full model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. In section <a href="#S3.SS2" title="3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> we show that EE architectures allow agglomerating coherently the model updates at the server side.
Moreover, being a partial training strategy thanks to the modularity of EE architectures, our approach naturally blends with differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and secure aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> solutions (as discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>), two techniques often applied to improve the protection of private data in FL settings.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">This paper extends our previous contribution in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> with better mathematical grounding and contextualization in the state of the art of our proposed approach, together with further experimental insights and ablations. Overall, we aim to contribute to the scientific literature in the following three directions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We provide a mathematical analysis of EE in FL, proving that FL training a set of heterogeneous EE models (i.e. with different numbers of processing layers) is equivalent to training a single homogeneous EE model, if appropriately combining the losses of the various exits.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We show that EE architectures allow federating heterogeneous models in a rather straightforward way. This surpasses current approaches based on the use of multiple models centrally aligned with edge-specific solutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, also allowing the combined use of differential privacy and secure aggregation.
</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We shed lights on some implementation aspects of federated ASR, showing the efficacy of the FedAdam agglomeration strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and of freezing part of the pre-trained model (pre-trained in an EE fashion).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section we provide a revision of the state of the art considering first of all FL applied to ASR and the related common practices. We then revise techniques for FL in presence of heterogeneous devices and architectures and finally we comment on the implications of EFL in current methods for differential privacy.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated learning for ASR</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Besides the typical issues related to non-i.i.d and unbalancing data distributions, FL for ASR is further complicated by the high computational requirements of most ASR architectures (e.g Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, Transducers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and RNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>), which may be not available on clients, and the need for large datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, usually featured only in the central servers.
A further complication is the lack of ground truth across the clients which demands for unsupervised or self-supervised approaches.
Recently several papers have been published on FL for ASR. In the following we report the most relevant in our opinion. A deep exploration of several optimization approaches and training strategies is available in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. We forward the reader to those publications for a more comprehensive survey and some practical suggestions.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">A pioneer work on FL in ASR is <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> which proposes two different dynamic aggregation methods for the gradients. Client-specific weighting strategies are frequently employed in the agglomeration stage, as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> which explores both loss-based and word error rate-based weighting, demonstrating the superior performance of the latter. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
also underscores the necessity of pre-training the model centrally (before FL) to achieve convergence. Additionally, the paper introduces a central training stage, subsequent to aggregation, to regulate model divergence between consecutive rounds. Similar observations are reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Note, however, that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, using the TED-LIUM-3 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, partially diverges from these observations, asserting that only the use of a large pre-trained model (Wav2Vec2.0 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>) is effective for cross-domain ASR tasks.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Differently from these findings, we show that our proposed EE model achieves performance improvements in FL on TED-LIUM-3 and VoxPopuli, even when starting from a global model trained solely on Librispeech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. Furthermore, we observe that the use of central training on a held-out training set does not bring particular benefits.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">Finally, motivated by the lack of labels typical of FL settings, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> investigate self-supervised and unsupervised FL approaches. Since our work proposes the use of a specific neural architecture for EFL, we do not address here solutions to handle the lack of supervision. Therefore, general solutions for self- or unsupervised training may be employed.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Learning with heterogeneous devices</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">FL with heterogeneous devices and architectures is receiving growing interest in literature recently, also from a theoretical perspective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. Recent works have addressed this challenge primarily by considering multiple neural architectures with distinct characteristics, yet sharing certain common components, as illustrated in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.2 Federated Learning with heterogeneous devices ‣ 2 Related Work ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a).</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2405.17376/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="423" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">Illustration of server-client aggregation strategy with heterogeneous models. (a) In the common SOTA approaches clients’ models have different architectures, sharing a common part (azure nodes) with the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. (b) Our proposed approach where all clients share the same architecture (with different layers according to computational resources), while their central agglomeration results into an EE model.</span></figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">One example is presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, where mixed architectures are adopted for local models, sharing a subset of parameters with the central model. To preserve global model parameters while assimilating local information, knowledge distillation is employed at the client side <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. Alternatively, a contrastive loss mechanism can be used to minimize the dissimilarity between central and local heterogeneous models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Finally, the Federated Ensemble Knowledge Transfer (Fed-ET) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> employs consensus distillation derived from clients, enabling the regulation of divergence from a large central model.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Training and managing multiple models with varying architectures is complex and computationally inefficient. Recently, approaches based on the concept of partial training (PT) are emerging, where the central models are somehow decomposed in different subnetworks to be deployed on the clients and that can be easily agglomerated. Federated Dropout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and FjORD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> handles FL for heterogeneous edge devices selecting lower footprint sub-models via drop-out. HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposes an analogous approach but focusing on the width of the hidden channels. PruneFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> propose dynamically adjustable pruning strategies of the models to improve the efficiency and reduce the communication costs, keeping the same pruned model for all clients. Finally, FedRolex <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> applies an analogous approach but also considering different pruned models in the edge devices.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.1" class="ltx_p">Note that, with respect to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, our approach, thanks to exit-specific decoders of EE architectures, optimizes the performance at the level of each early exit with a layer-specific loss, providing higher robustness to heavy model reduction compared to layer-drop and pruning.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">To conclude, it is worth mentioning that most of the approaches for EFL reported here have demonstrated effectiveness for image or text processing, leaving several speech-processing issues unresolved.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Differential Privacy</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Several works have recently shown that in FL settings information about the data used for local training can be inferred from the gradients or the updated weights. For ASR only preliminary analyses are available: for example <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> demonstrates that the speaker identity can be retrieved while there are no proofs that the acoustic features or the acoustic content can be obtained. On the contrary, these privacy attacks have been fully demonstrated for text and image processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">To actually preserve privacy in distributed model environments Differential Privacy (DP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and/or Secure Aggregation (SA) protocols <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> have been introduced. Towards DP, large models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> as well as large numbers of active clients in each round should be employed. This is somehow in contrast with the realistic requirements of FL for ASR, where many devices cannot run large models and where some rounds can involve only few clients. Some preliminary works have applied foundations of DP to ASR in distributed setting, providing performance figures on standard benchmarks. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> applies DP and FL for senone classification, while <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> sets-up useful reference baselines propossing per-layer clipping of gradients to compensate for the adversarial noise introduced by DP.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">To conclude, although DP and SA are nowadays indispensable tools to be coupled with FL, in this work we do not explicitly consider their implementations because our PT-based proposed approach is compliant, as reported in  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, with the methods reported above.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Approach</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Learning Framework</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">The goal of FL is to optimize a global model, on a server, through a sequence of rounds each agglomerating the parameters sent by the connected clients.
Let us assume that a set of clients <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math> are available at round <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\tau</annotation></semantics></math>, and each client <math id="S3.SS1.p1.3.m3.4" class="ltx_Math" alttext="c\in\{1,...,|\mathcal{C}|\}" display="inline"><semantics id="S3.SS1.p1.3.m3.4a"><mrow id="S3.SS1.p1.3.m3.4.4" xref="S3.SS1.p1.3.m3.4.4.cmml"><mi id="S3.SS1.p1.3.m3.4.4.3" xref="S3.SS1.p1.3.m3.4.4.3.cmml">c</mi><mo id="S3.SS1.p1.3.m3.4.4.2" xref="S3.SS1.p1.3.m3.4.4.2.cmml">∈</mo><mrow id="S3.SS1.p1.3.m3.4.4.1.1" xref="S3.SS1.p1.3.m3.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.2" xref="S3.SS1.p1.3.m3.4.4.1.2.cmml">{</mo><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.p1.3.m3.4.4.1.1.3" xref="S3.SS1.p1.3.m3.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.p1.3.m3.4.4.1.1.4" xref="S3.SS1.p1.3.m3.4.4.1.2.cmml">,</mo><mrow id="S3.SS1.p1.3.m3.4.4.1.1.1.2" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.1.2.1" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml">𝒞</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.1.2.2" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.5" xref="S3.SS1.p1.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b"><apply id="S3.SS1.p1.3.m3.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4"><in id="S3.SS1.p1.3.m3.4.4.2.cmml" xref="S3.SS1.p1.3.m3.4.4.2"></in><ci id="S3.SS1.p1.3.m3.4.4.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3">𝑐</ci><set id="S3.SS1.p1.3.m3.4.4.1.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1"><cn type="integer" id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">1</cn><ci id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">…</ci><apply id="S3.SS1.p1.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.2"><abs id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.2.1"></abs><ci id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3">𝒞</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">c\in\{1,...,|\mathcal{C}|\}</annotation></semantics></math> observes its own training set <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{B}_{c}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">ℬ</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">ℬ</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{B}_{c}</annotation></semantics></math>. At the beginning of each round, the clients receive the most recently trained model, <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{w}(\tau)" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.2" xref="S3.SS1.p1.5.m5.1.2.cmml"><mi id="S3.SS1.p1.5.m5.1.2.2" xref="S3.SS1.p1.5.m5.1.2.2.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.2.1" xref="S3.SS1.p1.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.5.m5.1.2.3.2" xref="S3.SS1.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.1.2.3.2.1" xref="S3.SS1.p1.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS1.p1.5.m5.1.2.3.2.2" xref="S3.SS1.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.2.cmml" xref="S3.SS1.p1.5.m5.1.2"><times id="S3.SS1.p1.5.m5.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.1"></times><ci id="S3.SS1.p1.5.m5.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2">𝐰</ci><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{w}(\tau)</annotation></semantics></math> from the central server:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\mathbf{w}^{c}(\tau,t)=\mathbf{w}(\tau),\ \ \ (t=1)" display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><mrow id="S3.E1.m1.5.5.4" xref="S3.E1.m1.5.5.4.cmml"><msup id="S3.E1.m1.5.5.4.2" xref="S3.E1.m1.5.5.4.2.cmml"><mi id="S3.E1.m1.5.5.4.2.2" xref="S3.E1.m1.5.5.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.5.5.4.2.3" xref="S3.E1.m1.5.5.4.2.3.cmml">c</mi></msup><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.4.1" xref="S3.E1.m1.5.5.4.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.4.3.2" xref="S3.E1.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.4.3.2.1" xref="S3.E1.m1.5.5.4.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">τ</mi><mo id="S3.E1.m1.5.5.4.3.2.2" xref="S3.E1.m1.5.5.4.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">t</mi><mo stretchy="false" id="S3.E1.m1.5.5.4.3.2.3" xref="S3.E1.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.3" xref="S3.E1.m1.5.5.3.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.2.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.3.2.1" xref="S3.E1.m1.4.4.1.1.1.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">τ</mi><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="1.667em" id="S3.E1.m1.5.5.2.2.3" xref="S3.E1.m1.5.5.2.3.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2.2.1" xref="S3.E1.m1.5.5.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.2.2.2.1.2" xref="S3.E1.m1.5.5.2.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.2.2.2.1.1" xref="S3.E1.m1.5.5.2.2.2.1.1.cmml"><mi id="S3.E1.m1.5.5.2.2.2.1.1.2" xref="S3.E1.m1.5.5.2.2.2.1.1.2.cmml">t</mi><mo id="S3.E1.m1.5.5.2.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.2.1.1.1.cmml">=</mo><mn id="S3.E1.m1.5.5.2.2.2.1.1.3" xref="S3.E1.m1.5.5.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E1.m1.5.5.2.2.2.1.3" xref="S3.E1.m1.5.5.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><eq id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.3"></eq><apply id="S3.E1.m1.5.5.4.cmml" xref="S3.E1.m1.5.5.4"><times id="S3.E1.m1.5.5.4.1.cmml" xref="S3.E1.m1.5.5.4.1"></times><apply id="S3.E1.m1.5.5.4.2.cmml" xref="S3.E1.m1.5.5.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.4.2.1.cmml" xref="S3.E1.m1.5.5.4.2">superscript</csymbol><ci id="S3.E1.m1.5.5.4.2.2.cmml" xref="S3.E1.m1.5.5.4.2.2">𝐰</ci><ci id="S3.E1.m1.5.5.4.2.3.cmml" xref="S3.E1.m1.5.5.4.2.3">𝑐</ci></apply><interval closure="open" id="S3.E1.m1.5.5.4.3.1.cmml" xref="S3.E1.m1.5.5.4.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜏</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑡</ci></interval></apply><list id="S3.E1.m1.5.5.2.3.cmml" xref="S3.E1.m1.5.5.2.2"><apply id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"></times><ci id="S3.E1.m1.4.4.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.2">𝐰</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝜏</ci></apply><apply id="S3.E1.m1.5.5.2.2.2.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.1"><eq id="S3.E1.m1.5.5.2.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.1.1.1"></eq><ci id="S3.E1.m1.5.5.2.2.2.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.2.1.1.2">𝑡</ci><cn type="integer" id="S3.E1.m1.5.5.2.2.2.1.1.3.cmml" xref="S3.E1.m1.5.5.2.2.2.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\mathbf{w}^{c}(\tau,t)=\mathbf{w}(\tau),\ \ \ (t=1)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.13" class="ltx_p">The <math id="S3.SS1.p1.6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.6.m1.1a"><mi id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><ci id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">k</annotation></semantics></math>-th parameter (<math id="S3.SS1.p1.7.m2.3" class="ltx_Math" alttext="k\in\{1,\dots,K\}" display="inline"><semantics id="S3.SS1.p1.7.m2.3a"><mrow id="S3.SS1.p1.7.m2.3.4" xref="S3.SS1.p1.7.m2.3.4.cmml"><mi id="S3.SS1.p1.7.m2.3.4.2" xref="S3.SS1.p1.7.m2.3.4.2.cmml">k</mi><mo id="S3.SS1.p1.7.m2.3.4.1" xref="S3.SS1.p1.7.m2.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p1.7.m2.3.4.3.2" xref="S3.SS1.p1.7.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m2.3.4.3.2.1" xref="S3.SS1.p1.7.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS1.p1.7.m2.1.1" xref="S3.SS1.p1.7.m2.1.1.cmml">1</mn><mo id="S3.SS1.p1.7.m2.3.4.3.2.2" xref="S3.SS1.p1.7.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m2.2.2" xref="S3.SS1.p1.7.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.7.m2.3.4.3.2.3" xref="S3.SS1.p1.7.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.7.m2.3.3" xref="S3.SS1.p1.7.m2.3.3.cmml">K</mi><mo stretchy="false" id="S3.SS1.p1.7.m2.3.4.3.2.4" xref="S3.SS1.p1.7.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m2.3b"><apply id="S3.SS1.p1.7.m2.3.4.cmml" xref="S3.SS1.p1.7.m2.3.4"><in id="S3.SS1.p1.7.m2.3.4.1.cmml" xref="S3.SS1.p1.7.m2.3.4.1"></in><ci id="S3.SS1.p1.7.m2.3.4.2.cmml" xref="S3.SS1.p1.7.m2.3.4.2">𝑘</ci><set id="S3.SS1.p1.7.m2.3.4.3.1.cmml" xref="S3.SS1.p1.7.m2.3.4.3.2"><cn type="integer" id="S3.SS1.p1.7.m2.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1">1</cn><ci id="S3.SS1.p1.7.m2.2.2.cmml" xref="S3.SS1.p1.7.m2.2.2">…</ci><ci id="S3.SS1.p1.7.m2.3.3.cmml" xref="S3.SS1.p1.7.m2.3.3">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m2.3c">k\in\{1,\dots,K\}</annotation></semantics></math>) of each model is updated for a certain number of epochs <math id="S3.SS1.p1.8.m3.1" class="ltx_Math" alttext="E\ (1&lt;t\leq E)" display="inline"><semantics id="S3.SS1.p1.8.m3.1a"><mrow id="S3.SS1.p1.8.m3.1.1" xref="S3.SS1.p1.8.m3.1.1.cmml"><mi id="S3.SS1.p1.8.m3.1.1.3" xref="S3.SS1.p1.8.m3.1.1.3.cmml">E</mi><mo lspace="0.500em" rspace="0em" id="S3.SS1.p1.8.m3.1.1.2" xref="S3.SS1.p1.8.m3.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.8.m3.1.1.1.1" xref="S3.SS1.p1.8.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m3.1.1.1.1.2" xref="S3.SS1.p1.8.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.8.m3.1.1.1.1.1" xref="S3.SS1.p1.8.m3.1.1.1.1.1.cmml"><mn id="S3.SS1.p1.8.m3.1.1.1.1.1.2" xref="S3.SS1.p1.8.m3.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.8.m3.1.1.1.1.1.3" xref="S3.SS1.p1.8.m3.1.1.1.1.1.3.cmml">&lt;</mo><mi id="S3.SS1.p1.8.m3.1.1.1.1.1.4" xref="S3.SS1.p1.8.m3.1.1.1.1.1.4.cmml">t</mi><mo id="S3.SS1.p1.8.m3.1.1.1.1.1.5" xref="S3.SS1.p1.8.m3.1.1.1.1.1.5.cmml">≤</mo><mi id="S3.SS1.p1.8.m3.1.1.1.1.1.6" xref="S3.SS1.p1.8.m3.1.1.1.1.1.6.cmml">E</mi></mrow><mo stretchy="false" id="S3.SS1.p1.8.m3.1.1.1.1.3" xref="S3.SS1.p1.8.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m3.1b"><apply id="S3.SS1.p1.8.m3.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1"><times id="S3.SS1.p1.8.m3.1.1.2.cmml" xref="S3.SS1.p1.8.m3.1.1.2"></times><ci id="S3.SS1.p1.8.m3.1.1.3.cmml" xref="S3.SS1.p1.8.m3.1.1.3">𝐸</ci><apply id="S3.SS1.p1.8.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1"><and id="S3.SS1.p1.8.m3.1.1.1.1.1a.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1"></and><apply id="S3.SS1.p1.8.m3.1.1.1.1.1b.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1"><lt id="S3.SS1.p1.8.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1.1.3"></lt><cn type="integer" id="S3.SS1.p1.8.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1.1.2">1</cn><ci id="S3.SS1.p1.8.m3.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1.1.4">𝑡</ci></apply><apply id="S3.SS1.p1.8.m3.1.1.1.1.1c.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1"><leq id="S3.SS1.p1.8.m3.1.1.1.1.1.5.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1.1.5"></leq><share href="#S3.SS1.p1.8.m3.1.1.1.1.1.4.cmml" id="S3.SS1.p1.8.m3.1.1.1.1.1d.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1"></share><ci id="S3.SS1.p1.8.m3.1.1.1.1.1.6.cmml" xref="S3.SS1.p1.8.m3.1.1.1.1.1.6">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m3.1c">E\ (1&lt;t\leq E)</annotation></semantics></math> applying SGD to the local dataset <math id="S3.SS1.p1.9.m4.1" class="ltx_Math" alttext="\mathcal{B}_{c}" display="inline"><semantics id="S3.SS1.p1.9.m4.1a"><msub id="S3.SS1.p1.9.m4.1.1" xref="S3.SS1.p1.9.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m4.1.1.2" xref="S3.SS1.p1.9.m4.1.1.2.cmml">ℬ</mi><mi id="S3.SS1.p1.9.m4.1.1.3" xref="S3.SS1.p1.9.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m4.1b"><apply id="S3.SS1.p1.9.m4.1.1.cmml" xref="S3.SS1.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m4.1.1.1.cmml" xref="S3.SS1.p1.9.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m4.1.1.2.cmml" xref="S3.SS1.p1.9.m4.1.1.2">ℬ</ci><ci id="S3.SS1.p1.9.m4.1.1.3.cmml" xref="S3.SS1.p1.9.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m4.1c">\mathcal{B}_{c}</annotation></semantics></math> and providing "local gradients" <math id="S3.SS1.p1.10.m5.5" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}^{c}(\tau)=\mathbf{w}_{k}^{c}(\tau,E)-\mathbf{w}_{k}^{c}(\tau,1)" display="inline"><semantics id="S3.SS1.p1.10.m5.5a"><mrow id="S3.SS1.p1.10.m5.5.6" xref="S3.SS1.p1.10.m5.5.6.cmml"><mrow id="S3.SS1.p1.10.m5.5.6.2" xref="S3.SS1.p1.10.m5.5.6.2.cmml"><mrow id="S3.SS1.p1.10.m5.5.6.2.2" xref="S3.SS1.p1.10.m5.5.6.2.2.cmml"><mo rspace="0.167em" id="S3.SS1.p1.10.m5.5.6.2.2.1" xref="S3.SS1.p1.10.m5.5.6.2.2.1.cmml">∇</mo><msubsup id="S3.SS1.p1.10.m5.5.6.2.2.2" xref="S3.SS1.p1.10.m5.5.6.2.2.2.cmml"><mi id="S3.SS1.p1.10.m5.5.6.2.2.2.2.2" xref="S3.SS1.p1.10.m5.5.6.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.10.m5.5.6.2.2.2.2.3" xref="S3.SS1.p1.10.m5.5.6.2.2.2.2.3.cmml">k</mi><mi id="S3.SS1.p1.10.m5.5.6.2.2.2.3" xref="S3.SS1.p1.10.m5.5.6.2.2.2.3.cmml">c</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m5.5.6.2.1" xref="S3.SS1.p1.10.m5.5.6.2.1.cmml">​</mo><mrow id="S3.SS1.p1.10.m5.5.6.2.3.2" xref="S3.SS1.p1.10.m5.5.6.2.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.2.3.2.1" xref="S3.SS1.p1.10.m5.5.6.2.cmml">(</mo><mi id="S3.SS1.p1.10.m5.1.1" xref="S3.SS1.p1.10.m5.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.2.3.2.2" xref="S3.SS1.p1.10.m5.5.6.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.10.m5.5.6.1" xref="S3.SS1.p1.10.m5.5.6.1.cmml">=</mo><mrow id="S3.SS1.p1.10.m5.5.6.3" xref="S3.SS1.p1.10.m5.5.6.3.cmml"><mrow id="S3.SS1.p1.10.m5.5.6.3.2" xref="S3.SS1.p1.10.m5.5.6.3.2.cmml"><msubsup id="S3.SS1.p1.10.m5.5.6.3.2.2" xref="S3.SS1.p1.10.m5.5.6.3.2.2.cmml"><mi id="S3.SS1.p1.10.m5.5.6.3.2.2.2.2" xref="S3.SS1.p1.10.m5.5.6.3.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.10.m5.5.6.3.2.2.2.3" xref="S3.SS1.p1.10.m5.5.6.3.2.2.2.3.cmml">k</mi><mi id="S3.SS1.p1.10.m5.5.6.3.2.2.3" xref="S3.SS1.p1.10.m5.5.6.3.2.2.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m5.5.6.3.2.1" xref="S3.SS1.p1.10.m5.5.6.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.10.m5.5.6.3.2.3.2" xref="S3.SS1.p1.10.m5.5.6.3.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.3.2.3.2.1" xref="S3.SS1.p1.10.m5.5.6.3.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.10.m5.2.2" xref="S3.SS1.p1.10.m5.2.2.cmml">τ</mi><mo id="S3.SS1.p1.10.m5.5.6.3.2.3.2.2" xref="S3.SS1.p1.10.m5.5.6.3.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.10.m5.3.3" xref="S3.SS1.p1.10.m5.3.3.cmml">E</mi><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.3.2.3.2.3" xref="S3.SS1.p1.10.m5.5.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.10.m5.5.6.3.1" xref="S3.SS1.p1.10.m5.5.6.3.1.cmml">−</mo><mrow id="S3.SS1.p1.10.m5.5.6.3.3" xref="S3.SS1.p1.10.m5.5.6.3.3.cmml"><msubsup id="S3.SS1.p1.10.m5.5.6.3.3.2" xref="S3.SS1.p1.10.m5.5.6.3.3.2.cmml"><mi id="S3.SS1.p1.10.m5.5.6.3.3.2.2.2" xref="S3.SS1.p1.10.m5.5.6.3.3.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.10.m5.5.6.3.3.2.2.3" xref="S3.SS1.p1.10.m5.5.6.3.3.2.2.3.cmml">k</mi><mi id="S3.SS1.p1.10.m5.5.6.3.3.2.3" xref="S3.SS1.p1.10.m5.5.6.3.3.2.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m5.5.6.3.3.1" xref="S3.SS1.p1.10.m5.5.6.3.3.1.cmml">​</mo><mrow id="S3.SS1.p1.10.m5.5.6.3.3.3.2" xref="S3.SS1.p1.10.m5.5.6.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.3.3.3.2.1" xref="S3.SS1.p1.10.m5.5.6.3.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.10.m5.4.4" xref="S3.SS1.p1.10.m5.4.4.cmml">τ</mi><mo id="S3.SS1.p1.10.m5.5.6.3.3.3.2.2" xref="S3.SS1.p1.10.m5.5.6.3.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.10.m5.5.5" xref="S3.SS1.p1.10.m5.5.5.cmml">1</mn><mo stretchy="false" id="S3.SS1.p1.10.m5.5.6.3.3.3.2.3" xref="S3.SS1.p1.10.m5.5.6.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m5.5b"><apply id="S3.SS1.p1.10.m5.5.6.cmml" xref="S3.SS1.p1.10.m5.5.6"><eq id="S3.SS1.p1.10.m5.5.6.1.cmml" xref="S3.SS1.p1.10.m5.5.6.1"></eq><apply id="S3.SS1.p1.10.m5.5.6.2.cmml" xref="S3.SS1.p1.10.m5.5.6.2"><times id="S3.SS1.p1.10.m5.5.6.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.2.1"></times><apply id="S3.SS1.p1.10.m5.5.6.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2"><ci id="S3.SS1.p1.10.m5.5.6.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.1">∇</ci><apply id="S3.SS1.p1.10.m5.5.6.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.2.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.10.m5.5.6.2.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.2.2.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m5.5.6.2.2.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2.2.2">𝐰</ci><ci id="S3.SS1.p1.10.m5.5.6.2.2.2.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.10.m5.5.6.2.2.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.2.2.2.3">𝑐</ci></apply></apply><ci id="S3.SS1.p1.10.m5.1.1.cmml" xref="S3.SS1.p1.10.m5.1.1">𝜏</ci></apply><apply id="S3.SS1.p1.10.m5.5.6.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3"><minus id="S3.SS1.p1.10.m5.5.6.3.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.1"></minus><apply id="S3.SS1.p1.10.m5.5.6.3.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2"><times id="S3.SS1.p1.10.m5.5.6.3.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.1"></times><apply id="S3.SS1.p1.10.m5.5.6.3.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.3.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2">superscript</csymbol><apply id="S3.SS1.p1.10.m5.5.6.3.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.3.2.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m5.5.6.3.2.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2.2.2">𝐰</ci><ci id="S3.SS1.p1.10.m5.5.6.3.2.2.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.10.m5.5.6.3.2.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.2.3">𝑐</ci></apply><interval closure="open" id="S3.SS1.p1.10.m5.5.6.3.2.3.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.2.3.2"><ci id="S3.SS1.p1.10.m5.2.2.cmml" xref="S3.SS1.p1.10.m5.2.2">𝜏</ci><ci id="S3.SS1.p1.10.m5.3.3.cmml" xref="S3.SS1.p1.10.m5.3.3">𝐸</ci></interval></apply><apply id="S3.SS1.p1.10.m5.5.6.3.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3"><times id="S3.SS1.p1.10.m5.5.6.3.3.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.1"></times><apply id="S3.SS1.p1.10.m5.5.6.3.3.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.3.3.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2">superscript</csymbol><apply id="S3.SS1.p1.10.m5.5.6.3.3.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.5.6.3.3.2.2.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.10.m5.5.6.3.3.2.2.2.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2.2.2">𝐰</ci><ci id="S3.SS1.p1.10.m5.5.6.3.3.2.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.10.m5.5.6.3.3.2.3.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.2.3">𝑐</ci></apply><interval closure="open" id="S3.SS1.p1.10.m5.5.6.3.3.3.1.cmml" xref="S3.SS1.p1.10.m5.5.6.3.3.3.2"><ci id="S3.SS1.p1.10.m5.4.4.cmml" xref="S3.SS1.p1.10.m5.4.4">𝜏</ci><cn type="integer" id="S3.SS1.p1.10.m5.5.5.cmml" xref="S3.SS1.p1.10.m5.5.5">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m5.5c">\nabla\mathbf{w}_{k}^{c}(\tau)=\mathbf{w}_{k}^{c}(\tau,E)-\mathbf{w}_{k}^{c}(\tau,1)</annotation></semantics></math> to the server (we use the time indexes <math id="S3.SS1.p1.11.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.11.m6.1a"><mi id="S3.SS1.p1.11.m6.1.1" xref="S3.SS1.p1.11.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m6.1b"><ci id="S3.SS1.p1.11.m6.1.1.cmml" xref="S3.SS1.p1.11.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m6.1c">t</annotation></semantics></math> and <math id="S3.SS1.p1.12.m7.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p1.12.m7.1a"><mi id="S3.SS1.p1.12.m7.1.1" xref="S3.SS1.p1.12.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m7.1b"><ci id="S3.SS1.p1.12.m7.1.1.cmml" xref="S3.SS1.p1.12.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m7.1c">\tau</annotation></semantics></math> for local iterations/epochs and server agglomeration rounds, respectively). Note that in the case of homogeneous devices, all clients accommodate the same network.
A common approach to update the global model parameters is by federated averaging the locally computed gradients <math id="S3.SS1.p1.13.m8.1" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}^{c}(\tau)" display="inline"><semantics id="S3.SS1.p1.13.m8.1a"><mrow id="S3.SS1.p1.13.m8.1.2" xref="S3.SS1.p1.13.m8.1.2.cmml"><mrow id="S3.SS1.p1.13.m8.1.2.2" xref="S3.SS1.p1.13.m8.1.2.2.cmml"><mo rspace="0.167em" id="S3.SS1.p1.13.m8.1.2.2.1" xref="S3.SS1.p1.13.m8.1.2.2.1.cmml">∇</mo><msubsup id="S3.SS1.p1.13.m8.1.2.2.2" xref="S3.SS1.p1.13.m8.1.2.2.2.cmml"><mi id="S3.SS1.p1.13.m8.1.2.2.2.2.2" xref="S3.SS1.p1.13.m8.1.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.13.m8.1.2.2.2.2.3" xref="S3.SS1.p1.13.m8.1.2.2.2.2.3.cmml">k</mi><mi id="S3.SS1.p1.13.m8.1.2.2.2.3" xref="S3.SS1.p1.13.m8.1.2.2.2.3.cmml">c</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m8.1.2.1" xref="S3.SS1.p1.13.m8.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.13.m8.1.2.3.2" xref="S3.SS1.p1.13.m8.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m8.1.2.3.2.1" xref="S3.SS1.p1.13.m8.1.2.cmml">(</mo><mi id="S3.SS1.p1.13.m8.1.1" xref="S3.SS1.p1.13.m8.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS1.p1.13.m8.1.2.3.2.2" xref="S3.SS1.p1.13.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m8.1b"><apply id="S3.SS1.p1.13.m8.1.2.cmml" xref="S3.SS1.p1.13.m8.1.2"><times id="S3.SS1.p1.13.m8.1.2.1.cmml" xref="S3.SS1.p1.13.m8.1.2.1"></times><apply id="S3.SS1.p1.13.m8.1.2.2.cmml" xref="S3.SS1.p1.13.m8.1.2.2"><ci id="S3.SS1.p1.13.m8.1.2.2.1.cmml" xref="S3.SS1.p1.13.m8.1.2.2.1">∇</ci><apply id="S3.SS1.p1.13.m8.1.2.2.2.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m8.1.2.2.2.1.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.13.m8.1.2.2.2.2.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m8.1.2.2.2.2.1.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m8.1.2.2.2.2.2.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2.2.2">𝐰</ci><ci id="S3.SS1.p1.13.m8.1.2.2.2.2.3.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.13.m8.1.2.2.2.3.cmml" xref="S3.SS1.p1.13.m8.1.2.2.2.3">𝑐</ci></apply></apply><ci id="S3.SS1.p1.13.m8.1.1.cmml" xref="S3.SS1.p1.13.m8.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m8.1c">\nabla\mathbf{w}_{k}^{c}(\tau)</annotation></semantics></math> (FedAvg  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>),
possibly applying clients specific weights (as in in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>), as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=\sum_{c\in\mathcal{C}}\gamma_{c}(\tau)\nabla\mathbf{w}_{k}^{c}(\tau)" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.4" xref="S3.E2.m1.3.4.cmml"><mrow id="S3.E2.m1.3.4.2" xref="S3.E2.m1.3.4.2.cmml"><mrow id="S3.E2.m1.3.4.2.2" xref="S3.E2.m1.3.4.2.2.cmml"><mo rspace="0.167em" id="S3.E2.m1.3.4.2.2.1" xref="S3.E2.m1.3.4.2.2.1.cmml">∇</mo><msub id="S3.E2.m1.3.4.2.2.2" xref="S3.E2.m1.3.4.2.2.2.cmml"><mi id="S3.E2.m1.3.4.2.2.2.2" xref="S3.E2.m1.3.4.2.2.2.2.cmml">𝐰</mi><mi id="S3.E2.m1.3.4.2.2.2.3" xref="S3.E2.m1.3.4.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.4.2.1" xref="S3.E2.m1.3.4.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.2.3.2" xref="S3.E2.m1.3.4.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.4.2.3.2.1" xref="S3.E2.m1.3.4.2.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.E2.m1.3.4.2.3.2.2" xref="S3.E2.m1.3.4.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.3.4.1" xref="S3.E2.m1.3.4.1.cmml">=</mo><mrow id="S3.E2.m1.3.4.3" xref="S3.E2.m1.3.4.3.cmml"><munder id="S3.E2.m1.3.4.3.1" xref="S3.E2.m1.3.4.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.3.4.3.1.2" xref="S3.E2.m1.3.4.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.3.4.3.1.3" xref="S3.E2.m1.3.4.3.1.3.cmml"><mi id="S3.E2.m1.3.4.3.1.3.2" xref="S3.E2.m1.3.4.3.1.3.2.cmml">c</mi><mo id="S3.E2.m1.3.4.3.1.3.1" xref="S3.E2.m1.3.4.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.4.3.1.3.3" xref="S3.E2.m1.3.4.3.1.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E2.m1.3.4.3.2" xref="S3.E2.m1.3.4.3.2.cmml"><msub id="S3.E2.m1.3.4.3.2.2" xref="S3.E2.m1.3.4.3.2.2.cmml"><mi id="S3.E2.m1.3.4.3.2.2.2" xref="S3.E2.m1.3.4.3.2.2.2.cmml">γ</mi><mi id="S3.E2.m1.3.4.3.2.2.3" xref="S3.E2.m1.3.4.3.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.4.3.2.1" xref="S3.E2.m1.3.4.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.3.2.3.2" xref="S3.E2.m1.3.4.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.4.3.2.3.2.1" xref="S3.E2.m1.3.4.3.2.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">τ</mi><mo stretchy="false" id="S3.E2.m1.3.4.3.2.3.2.2" xref="S3.E2.m1.3.4.3.2.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.3.4.3.2.1a" xref="S3.E2.m1.3.4.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.3.2.4" xref="S3.E2.m1.3.4.3.2.4.cmml"><mo rspace="0.167em" id="S3.E2.m1.3.4.3.2.4.1" xref="S3.E2.m1.3.4.3.2.4.1.cmml">∇</mo><msubsup id="S3.E2.m1.3.4.3.2.4.2" xref="S3.E2.m1.3.4.3.2.4.2.cmml"><mi id="S3.E2.m1.3.4.3.2.4.2.2.2" xref="S3.E2.m1.3.4.3.2.4.2.2.2.cmml">𝐰</mi><mi id="S3.E2.m1.3.4.3.2.4.2.2.3" xref="S3.E2.m1.3.4.3.2.4.2.2.3.cmml">k</mi><mi id="S3.E2.m1.3.4.3.2.4.2.3" xref="S3.E2.m1.3.4.3.2.4.2.3.cmml">c</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.4.3.2.1b" xref="S3.E2.m1.3.4.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.3.2.5.2" xref="S3.E2.m1.3.4.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.4.3.2.5.2.1" xref="S3.E2.m1.3.4.3.2.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">τ</mi><mo stretchy="false" id="S3.E2.m1.3.4.3.2.5.2.2" xref="S3.E2.m1.3.4.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.4.cmml" xref="S3.E2.m1.3.4"><eq id="S3.E2.m1.3.4.1.cmml" xref="S3.E2.m1.3.4.1"></eq><apply id="S3.E2.m1.3.4.2.cmml" xref="S3.E2.m1.3.4.2"><times id="S3.E2.m1.3.4.2.1.cmml" xref="S3.E2.m1.3.4.2.1"></times><apply id="S3.E2.m1.3.4.2.2.cmml" xref="S3.E2.m1.3.4.2.2"><ci id="S3.E2.m1.3.4.2.2.1.cmml" xref="S3.E2.m1.3.4.2.2.1">∇</ci><apply id="S3.E2.m1.3.4.2.2.2.cmml" xref="S3.E2.m1.3.4.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.2.2.2.1.cmml" xref="S3.E2.m1.3.4.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.4.2.2.2.2.cmml" xref="S3.E2.m1.3.4.2.2.2.2">𝐰</ci><ci id="S3.E2.m1.3.4.2.2.2.3.cmml" xref="S3.E2.m1.3.4.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝜏</ci></apply><apply id="S3.E2.m1.3.4.3.cmml" xref="S3.E2.m1.3.4.3"><apply id="S3.E2.m1.3.4.3.1.cmml" xref="S3.E2.m1.3.4.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.1.1.cmml" xref="S3.E2.m1.3.4.3.1">subscript</csymbol><sum id="S3.E2.m1.3.4.3.1.2.cmml" xref="S3.E2.m1.3.4.3.1.2"></sum><apply id="S3.E2.m1.3.4.3.1.3.cmml" xref="S3.E2.m1.3.4.3.1.3"><in id="S3.E2.m1.3.4.3.1.3.1.cmml" xref="S3.E2.m1.3.4.3.1.3.1"></in><ci id="S3.E2.m1.3.4.3.1.3.2.cmml" xref="S3.E2.m1.3.4.3.1.3.2">𝑐</ci><ci id="S3.E2.m1.3.4.3.1.3.3.cmml" xref="S3.E2.m1.3.4.3.1.3.3">𝒞</ci></apply></apply><apply id="S3.E2.m1.3.4.3.2.cmml" xref="S3.E2.m1.3.4.3.2"><times id="S3.E2.m1.3.4.3.2.1.cmml" xref="S3.E2.m1.3.4.3.2.1"></times><apply id="S3.E2.m1.3.4.3.2.2.cmml" xref="S3.E2.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.2.1.cmml" xref="S3.E2.m1.3.4.3.2.2">subscript</csymbol><ci id="S3.E2.m1.3.4.3.2.2.2.cmml" xref="S3.E2.m1.3.4.3.2.2.2">𝛾</ci><ci id="S3.E2.m1.3.4.3.2.2.3.cmml" xref="S3.E2.m1.3.4.3.2.2.3">𝑐</ci></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝜏</ci><apply id="S3.E2.m1.3.4.3.2.4.cmml" xref="S3.E2.m1.3.4.3.2.4"><ci id="S3.E2.m1.3.4.3.2.4.1.cmml" xref="S3.E2.m1.3.4.3.2.4.1">∇</ci><apply id="S3.E2.m1.3.4.3.2.4.2.cmml" xref="S3.E2.m1.3.4.3.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.4.2.1.cmml" xref="S3.E2.m1.3.4.3.2.4.2">superscript</csymbol><apply id="S3.E2.m1.3.4.3.2.4.2.2.cmml" xref="S3.E2.m1.3.4.3.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.4.2.2.1.cmml" xref="S3.E2.m1.3.4.3.2.4.2">subscript</csymbol><ci id="S3.E2.m1.3.4.3.2.4.2.2.2.cmml" xref="S3.E2.m1.3.4.3.2.4.2.2.2">𝐰</ci><ci id="S3.E2.m1.3.4.3.2.4.2.2.3.cmml" xref="S3.E2.m1.3.4.3.2.4.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.3.4.3.2.4.2.3.cmml" xref="S3.E2.m1.3.4.3.2.4.2.3">𝑐</ci></apply></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\nabla\mathbf{w}_{k}(\tau)=\sum_{c\in\mathcal{C}}\gamma_{c}(\tau)\nabla\mathbf{w}_{k}^{c}(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.14" class="ltx_p">where the weighting coefficients <math id="S3.SS1.p1.14.m1.1" class="ltx_Math" alttext="\gamma_{c}(\tau)" display="inline"><semantics id="S3.SS1.p1.14.m1.1a"><mrow id="S3.SS1.p1.14.m1.1.2" xref="S3.SS1.p1.14.m1.1.2.cmml"><msub id="S3.SS1.p1.14.m1.1.2.2" xref="S3.SS1.p1.14.m1.1.2.2.cmml"><mi id="S3.SS1.p1.14.m1.1.2.2.2" xref="S3.SS1.p1.14.m1.1.2.2.2.cmml">γ</mi><mi id="S3.SS1.p1.14.m1.1.2.2.3" xref="S3.SS1.p1.14.m1.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m1.1.2.1" xref="S3.SS1.p1.14.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.14.m1.1.2.3.2" xref="S3.SS1.p1.14.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m1.1.2.3.2.1" xref="S3.SS1.p1.14.m1.1.2.cmml">(</mo><mi id="S3.SS1.p1.14.m1.1.1" xref="S3.SS1.p1.14.m1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS1.p1.14.m1.1.2.3.2.2" xref="S3.SS1.p1.14.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m1.1b"><apply id="S3.SS1.p1.14.m1.1.2.cmml" xref="S3.SS1.p1.14.m1.1.2"><times id="S3.SS1.p1.14.m1.1.2.1.cmml" xref="S3.SS1.p1.14.m1.1.2.1"></times><apply id="S3.SS1.p1.14.m1.1.2.2.cmml" xref="S3.SS1.p1.14.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m1.1.2.2.1.cmml" xref="S3.SS1.p1.14.m1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.14.m1.1.2.2.2.cmml" xref="S3.SS1.p1.14.m1.1.2.2.2">𝛾</ci><ci id="S3.SS1.p1.14.m1.1.2.2.3.cmml" xref="S3.SS1.p1.14.m1.1.2.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.14.m1.1.1.cmml" xref="S3.SS1.p1.14.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m1.1c">\gamma_{c}(\tau)</annotation></semantics></math> estimates the client confidence, considering the size of the local training data or client-specific validation metrics.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">In the experiments reported below we apply FedAdam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>: a global adaptive optimization step, applied to the "pseudo-gradient" <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mrow id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml"><mo rspace="0.167em" id="S3.SS1.p2.1.m1.1.2.2.1" xref="S3.SS1.p2.1.m1.1.2.2.1.cmml">∇</mo><msub id="S3.SS1.p2.1.m1.1.2.2.2" xref="S3.SS1.p2.1.m1.1.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2.2.2" xref="S3.SS1.p2.1.m1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p2.1.m1.1.2.2.2.3" xref="S3.SS1.p2.1.m1.1.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.3.2.1" xref="S3.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.3.2.2" xref="S3.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><times id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></times><apply id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2"><ci id="S3.SS1.p2.1.m1.1.2.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.2.1">∇</ci><apply id="S3.SS1.p2.1.m1.1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2.2.2">𝐰</ci><ci id="S3.SS1.p2.1.m1.1.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.1.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\nabla\mathbf{w}_{k}(\tau)</annotation></semantics></math>, which has demonstrated to increase the convergence speed of FL on many tasks.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Learning with Early-Exit models</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.6" class="ltx_p">In the presence of devices with different processing capabilities, using a single model <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{w}</annotation></semantics></math> is not feasible. Most of current approaches employ <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">U</annotation></semantics></math> different models <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{w}^{u}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐰</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{w}^{u}</annotation></semantics></math>, <math id="S3.SS2.p1.4.m4.3" class="ltx_Math" alttext="u\in\{1,\dots,U\}" display="inline"><semantics id="S3.SS2.p1.4.m4.3a"><mrow id="S3.SS2.p1.4.m4.3.4" xref="S3.SS2.p1.4.m4.3.4.cmml"><mi id="S3.SS2.p1.4.m4.3.4.2" xref="S3.SS2.p1.4.m4.3.4.2.cmml">u</mi><mo id="S3.SS2.p1.4.m4.3.4.1" xref="S3.SS2.p1.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS2.p1.4.m4.3.4.3.2" xref="S3.SS2.p1.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.3.4.3.2.1" xref="S3.SS2.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS2.p1.4.m4.3.4.3.2.2" xref="S3.SS2.p1.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.4.m4.2.2" xref="S3.SS2.p1.4.m4.2.2.cmml">…</mi><mo id="S3.SS2.p1.4.m4.3.4.3.2.3" xref="S3.SS2.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml">U</mi><mo stretchy="false" id="S3.SS2.p1.4.m4.3.4.3.2.4" xref="S3.SS2.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.3b"><apply id="S3.SS2.p1.4.m4.3.4.cmml" xref="S3.SS2.p1.4.m4.3.4"><in id="S3.SS2.p1.4.m4.3.4.1.cmml" xref="S3.SS2.p1.4.m4.3.4.1"></in><ci id="S3.SS2.p1.4.m4.3.4.2.cmml" xref="S3.SS2.p1.4.m4.3.4.2">𝑢</ci><set id="S3.SS2.p1.4.m4.3.4.3.1.cmml" xref="S3.SS2.p1.4.m4.3.4.3.2"><cn type="integer" id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">1</cn><ci id="S3.SS2.p1.4.m4.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2">…</ci><ci id="S3.SS2.p1.4.m4.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3">𝑈</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.3c">u\in\{1,\dots,U\}</annotation></semantics></math> with different memory and computation requirements which are all maintained on the centralized server. As mentioned in Section <a href="#S2.SS2" title="2.2 Federated Learning with heterogeneous devices ‣ 2 Related Work ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>, an interesting solution is offered by EE architectures which provide <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">M</annotation></semantics></math> exit layers producing hypothesis: <math id="S3.SS2.p1.6.m6.3" class="ltx_Math" alttext="\hat{\mathbf{y}}^{1},\ldots,\hat{\mathbf{y}}^{M}" display="inline"><semantics id="S3.SS2.p1.6.m6.3a"><mrow id="S3.SS2.p1.6.m6.3.3.2" xref="S3.SS2.p1.6.m6.3.3.3.cmml"><msup id="S3.SS2.p1.6.m6.2.2.1.1" xref="S3.SS2.p1.6.m6.2.2.1.1.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.2.2.1.1.2" xref="S3.SS2.p1.6.m6.2.2.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.2.2.1.1.2.2" xref="S3.SS2.p1.6.m6.2.2.1.1.2.2.cmml">𝐲</mi><mo id="S3.SS2.p1.6.m6.2.2.1.1.2.1" xref="S3.SS2.p1.6.m6.2.2.1.1.2.1.cmml">^</mo></mover><mn id="S3.SS2.p1.6.m6.2.2.1.1.3" xref="S3.SS2.p1.6.m6.2.2.1.1.3.cmml">1</mn></msup><mo id="S3.SS2.p1.6.m6.3.3.2.3" xref="S3.SS2.p1.6.m6.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS2.p1.6.m6.3.3.2.4" xref="S3.SS2.p1.6.m6.3.3.3.cmml">,</mo><msup id="S3.SS2.p1.6.m6.3.3.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.3.3.2.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.6.m6.3.3.2.2.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.2.cmml">𝐲</mi><mo id="S3.SS2.p1.6.m6.3.3.2.2.2.1" xref="S3.SS2.p1.6.m6.3.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.6.m6.3.3.2.2.3" xref="S3.SS2.p1.6.m6.3.3.2.2.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.3b"><list id="S3.SS2.p1.6.m6.3.3.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2"><apply id="S3.SS2.p1.6.m6.2.2.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.2"><ci id="S3.SS2.p1.6.m6.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.2.1">^</ci><ci id="S3.SS2.p1.6.m6.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.2.2">𝐲</ci></apply><cn type="integer" id="S3.SS2.p1.6.m6.2.2.1.1.3.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">…</ci><apply id="S3.SS2.p1.6.m6.3.3.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.3.3.2.2.1.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2"><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.1">^</ci><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.2">𝐲</ci></apply><ci id="S3.SS2.p1.6.m6.3.3.2.2.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.3c">\hat{\mathbf{y}}^{1},\ldots,\hat{\mathbf{y}}^{M}</annotation></semantics></math>. The overall model is trained by optimizing the joint objective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\mathcal{L}_{EE}(\hat{\mathbf{y}}^{1},\ldots,\hat{\mathbf{y}}^{M},\mathbf{y})=\sum_{m=1}^{M}\mathcal{L}_{m}(\mathcal{B})," display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><msub id="S3.E3.m1.4.4.1.1.2.4" xref="S3.E3.m1.4.4.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.2.4.2" xref="S3.E3.m1.4.4.1.1.2.4.2.cmml">ℒ</mi><mrow id="S3.E3.m1.4.4.1.1.2.4.3" xref="S3.E3.m1.4.4.1.1.2.4.3.cmml"><mi id="S3.E3.m1.4.4.1.1.2.4.3.2" xref="S3.E3.m1.4.4.1.1.2.4.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.2.4.3.1" xref="S3.E3.m1.4.4.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E3.m1.4.4.1.1.2.4.3.3" xref="S3.E3.m1.4.4.1.1.2.4.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.2.3" xref="S3.E3.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">(</mo><msup id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E3.m1.4.4.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.2.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="S3.E3.m1.4.4.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.E3.m1.4.4.1.1.2.2.2.4" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">…</mi><mo id="S3.E3.m1.4.4.1.1.2.2.2.5" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">,</mo><msup id="S3.E3.m1.4.4.1.1.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E3.m1.4.4.1.1.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml">𝐲</mi><mo id="S3.E3.m1.4.4.1.1.2.2.2.2.2.1" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.4.4.1.1.2.2.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml">M</mi></msup><mo id="S3.E3.m1.4.4.1.1.2.2.2.6" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝐲</mi><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.2.2.7" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.4" xref="S3.E3.m1.4.4.1.1.4.cmml"><munderover id="S3.E3.m1.4.4.1.1.4.1" xref="S3.E3.m1.4.4.1.1.4.1.cmml"><mo movablelimits="false" id="S3.E3.m1.4.4.1.1.4.1.2.2" xref="S3.E3.m1.4.4.1.1.4.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.4.4.1.1.4.1.2.3" xref="S3.E3.m1.4.4.1.1.4.1.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.4.1.2.3.2" xref="S3.E3.m1.4.4.1.1.4.1.2.3.2.cmml">m</mi><mo id="S3.E3.m1.4.4.1.1.4.1.2.3.1" xref="S3.E3.m1.4.4.1.1.4.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.4.4.1.1.4.1.2.3.3" xref="S3.E3.m1.4.4.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.4.4.1.1.4.1.3" xref="S3.E3.m1.4.4.1.1.4.1.3.cmml">M</mi></munderover><mrow id="S3.E3.m1.4.4.1.1.4.2" xref="S3.E3.m1.4.4.1.1.4.2.cmml"><msub id="S3.E3.m1.4.4.1.1.4.2.2" xref="S3.E3.m1.4.4.1.1.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.4.2.2.2" xref="S3.E3.m1.4.4.1.1.4.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.4.4.1.1.4.2.2.3" xref="S3.E3.m1.4.4.1.1.4.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.4.2.1" xref="S3.E3.m1.4.4.1.1.4.2.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.4.2.3.2" xref="S3.E3.m1.4.4.1.1.4.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.4.2.3.2.1" xref="S3.E3.m1.4.4.1.1.4.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">ℬ</mi><mo stretchy="false" id="S3.E3.m1.4.4.1.1.4.2.3.2.2" xref="S3.E3.m1.4.4.1.1.4.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"></eq><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><times id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3"></times><apply id="S3.E3.m1.4.4.1.1.2.4.cmml" xref="S3.E3.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.4.1.cmml" xref="S3.E3.m1.4.4.1.1.2.4">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.4.2.cmml" xref="S3.E3.m1.4.4.1.1.2.4.2">ℒ</ci><apply id="S3.E3.m1.4.4.1.1.2.4.3.cmml" xref="S3.E3.m1.4.4.1.1.2.4.3"><times id="S3.E3.m1.4.4.1.1.2.4.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.4.3.1"></times><ci id="S3.E3.m1.4.4.1.1.2.4.3.2.cmml" xref="S3.E3.m1.4.4.1.1.2.4.3.2">𝐸</ci><ci id="S3.E3.m1.4.4.1.1.2.4.3.3.cmml" xref="S3.E3.m1.4.4.1.1.2.4.3.3">𝐸</ci></apply></apply><vector id="S3.E3.m1.4.4.1.1.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2"><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2"><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.2">𝐲</ci></apply><cn type="integer" id="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">…</ci><apply id="S3.E3.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2"><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.1">^</ci><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2">𝐲</ci></apply><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3">𝑀</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐲</ci></vector></apply><apply id="S3.E3.m1.4.4.1.1.4.cmml" xref="S3.E3.m1.4.4.1.1.4"><apply id="S3.E3.m1.4.4.1.1.4.1.cmml" xref="S3.E3.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1.4.1">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.4.1.2.cmml" xref="S3.E3.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.4.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.4.1">subscript</csymbol><sum id="S3.E3.m1.4.4.1.1.4.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.4.1.2.2"></sum><apply id="S3.E3.m1.4.4.1.1.4.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.4.1.2.3"><eq id="S3.E3.m1.4.4.1.1.4.1.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.4.1.2.3.1"></eq><ci id="S3.E3.m1.4.4.1.1.4.1.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.4.1.2.3.2">𝑚</ci><cn type="integer" id="S3.E3.m1.4.4.1.1.4.1.2.3.3.cmml" xref="S3.E3.m1.4.4.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.4.4.1.1.4.1.3.cmml" xref="S3.E3.m1.4.4.1.1.4.1.3">𝑀</ci></apply><apply id="S3.E3.m1.4.4.1.1.4.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2"><times id="S3.E3.m1.4.4.1.1.4.2.1.cmml" xref="S3.E3.m1.4.4.1.1.4.2.1"></times><apply id="S3.E3.m1.4.4.1.1.4.2.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.4.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.4.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.4.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2.2.2">ℒ</ci><ci id="S3.E3.m1.4.4.1.1.4.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.4.2.2.3">𝑚</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">ℬ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\mathcal{L}_{EE}(\hat{\mathbf{y}}^{1},\ldots,\hat{\mathbf{y}}^{M},\mathbf{y})=\sum_{m=1}^{M}\mathcal{L}_{m}(\mathcal{B}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.10" class="ltx_p">where <math id="S3.SS2.p1.7.m1.1" class="ltx_Math" alttext="\mathcal{L}_{m}" display="inline"><semantics id="S3.SS2.p1.7.m1.1a"><msub id="S3.SS2.p1.7.m1.1.1" xref="S3.SS2.p1.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m1.1.1.2" xref="S3.SS2.p1.7.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p1.7.m1.1.1.3" xref="S3.SS2.p1.7.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m1.1b"><apply id="S3.SS2.p1.7.m1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m1.1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m1.1.1.2.cmml" xref="S3.SS2.p1.7.m1.1.1.2">ℒ</ci><ci id="S3.SS2.p1.7.m1.1.1.3.cmml" xref="S3.SS2.p1.7.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m1.1c">\mathcal{L}_{m}</annotation></semantics></math> is the loss at the <math id="S3.SS2.p1.8.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p1.8.m2.1a"><mi id="S3.SS2.p1.8.m2.1.1" xref="S3.SS2.p1.8.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m2.1b"><ci id="S3.SS2.p1.8.m2.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m2.1c">m</annotation></semantics></math>-th exit layer, <math id="S3.SS2.p1.9.m3.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S3.SS2.p1.9.m3.1a"><mi id="S3.SS2.p1.9.m3.1.1" xref="S3.SS2.p1.9.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m3.1b"><ci id="S3.SS2.p1.9.m3.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m3.1c">\mathbf{y}</annotation></semantics></math> is the ground-truth and <math id="S3.SS2.p1.10.m4.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S3.SS2.p1.10.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m4.1.1" xref="S3.SS2.p1.10.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m4.1b"><ci id="S3.SS2.p1.10.m4.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m4.1c">\mathcal{B}</annotation></semantics></math> is the overall training set.
In a standard FL framework where the same architecture (i.e. the full EE network) is deployed in all clients, Eq. <a href="#S3.E2" title="Equation 2 ‣ 3.1 Federated Learning Framework ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> becomes:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E4.m1.11" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{c\in\mathcal{C}}\sum_{m=1}^{M}\nabla_{k}^{c,m}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\sum_{c\in\mathcal{C}}\nabla_{k}^{c,m}(\tau)" display="block"><semantics id="S3.E4.m1.11a"><mrow id="S3.E4.m1.11.11" xref="S3.E4.m1.11.11.cmml"><mrow id="S3.E4.m1.11.11.4" xref="S3.E4.m1.11.11.4.cmml"><mrow id="S3.E4.m1.11.11.4.2" xref="S3.E4.m1.11.11.4.2.cmml"><mo rspace="0.167em" id="S3.E4.m1.11.11.4.2.1" xref="S3.E4.m1.11.11.4.2.1.cmml">∇</mo><msub id="S3.E4.m1.11.11.4.2.2" xref="S3.E4.m1.11.11.4.2.2.cmml"><mi id="S3.E4.m1.11.11.4.2.2.2" xref="S3.E4.m1.11.11.4.2.2.2.cmml">𝐰</mi><mi id="S3.E4.m1.11.11.4.2.2.3" xref="S3.E4.m1.11.11.4.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.4.1" xref="S3.E4.m1.11.11.4.1.cmml">​</mo><mrow id="S3.E4.m1.11.11.4.3.2" xref="S3.E4.m1.11.11.4.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.4.3.2.1" xref="S3.E4.m1.11.11.4.cmml">(</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">τ</mi><mo stretchy="false" id="S3.E4.m1.11.11.4.3.2.2" xref="S3.E4.m1.11.11.4.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.11.11.5" xref="S3.E4.m1.11.11.5.cmml">=</mo><mrow id="S3.E4.m1.10.10.1" xref="S3.E4.m1.10.10.1.cmml"><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.10.10.1.2" xref="S3.E4.m1.10.10.1.2.cmml">​</mo><mrow id="S3.E4.m1.10.10.1.1" xref="S3.E4.m1.10.10.1.1.cmml"><munder id="S3.E4.m1.10.10.1.1.2" xref="S3.E4.m1.10.10.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.10.10.1.1.2.2" xref="S3.E4.m1.10.10.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.10.10.1.1.2.3" xref="S3.E4.m1.10.10.1.1.2.3.cmml"><mi id="S3.E4.m1.10.10.1.1.2.3.2" xref="S3.E4.m1.10.10.1.1.2.3.2.cmml">c</mi><mo id="S3.E4.m1.10.10.1.1.2.3.1" xref="S3.E4.m1.10.10.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.10.10.1.1.2.3.3" xref="S3.E4.m1.10.10.1.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E4.m1.10.10.1.1.1" xref="S3.E4.m1.10.10.1.1.1.cmml"><munderover id="S3.E4.m1.10.10.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.10.10.1.1.1.2.2.2" xref="S3.E4.m1.10.10.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.10.10.1.1.1.2.2.3" xref="S3.E4.m1.10.10.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.10.10.1.1.1.2.2.3.2" xref="S3.E4.m1.10.10.1.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E4.m1.10.10.1.1.1.2.2.3.1" xref="S3.E4.m1.10.10.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.10.10.1.1.1.2.2.3.3" xref="S3.E4.m1.10.10.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.10.10.1.1.1.2.3" xref="S3.E4.m1.10.10.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E4.m1.10.10.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.2.cmml"><msubsup id="S3.E4.m1.10.10.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.2.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E4.m1.3.3.2.4" xref="S3.E4.m1.3.3.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">c</mi><mo id="S3.E4.m1.3.3.2.4.1" xref="S3.E4.m1.3.3.2.3.cmml">,</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.E4.m1.10.10.1.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.1" xref="S3.E4.m1.10.10.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml">τ</mi><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.11.11.6" xref="S3.E4.m1.11.11.6.cmml">=</mo><mrow id="S3.E4.m1.11.11.2" xref="S3.E4.m1.11.11.2.cmml"><mfrac id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mn id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml">1</mn><mrow id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.3.1" xref="S3.E4.m1.4.4.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.3.2" xref="S3.E4.m1.4.4.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.2.2" xref="S3.E4.m1.11.11.2.2.cmml">​</mo><mrow id="S3.E4.m1.11.11.2.1" xref="S3.E4.m1.11.11.2.1.cmml"><munderover id="S3.E4.m1.11.11.2.1.2" xref="S3.E4.m1.11.11.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.11.11.2.1.2.2.2" xref="S3.E4.m1.11.11.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.2.1.2.2.3" xref="S3.E4.m1.11.11.2.1.2.2.3.cmml"><mi id="S3.E4.m1.11.11.2.1.2.2.3.2" xref="S3.E4.m1.11.11.2.1.2.2.3.2.cmml">m</mi><mo id="S3.E4.m1.11.11.2.1.2.2.3.1" xref="S3.E4.m1.11.11.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.11.11.2.1.2.2.3.3" xref="S3.E4.m1.11.11.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.11.11.2.1.2.3" xref="S3.E4.m1.11.11.2.1.2.3.cmml">M</mi></munderover><mrow id="S3.E4.m1.11.11.2.1.1" xref="S3.E4.m1.11.11.2.1.1.cmml"><munder id="S3.E4.m1.11.11.2.1.1.2" xref="S3.E4.m1.11.11.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.11.11.2.1.1.2.2" xref="S3.E4.m1.11.11.2.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.2.1.1.2.3" xref="S3.E4.m1.11.11.2.1.1.2.3.cmml"><mi id="S3.E4.m1.11.11.2.1.1.2.3.2" xref="S3.E4.m1.11.11.2.1.1.2.3.2.cmml">c</mi><mo id="S3.E4.m1.11.11.2.1.1.2.3.1" xref="S3.E4.m1.11.11.2.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.2.1.1.2.3.3" xref="S3.E4.m1.11.11.2.1.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E4.m1.11.11.2.1.1.1.1" xref="S3.E4.m1.11.11.2.1.1.1.2.cmml"><msubsup id="S3.E4.m1.11.11.2.1.1.1.1.1" xref="S3.E4.m1.11.11.2.1.1.1.1.1.cmml"><mo id="S3.E4.m1.11.11.2.1.1.1.1.1.2.2" xref="S3.E4.m1.11.11.2.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E4.m1.11.11.2.1.1.1.1.1.2.3" xref="S3.E4.m1.11.11.2.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">c</mi><mo id="S3.E4.m1.6.6.2.4.1" xref="S3.E4.m1.6.6.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.E4.m1.11.11.2.1.1.1.1.2" xref="S3.E4.m1.11.11.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.2.1.1.1.1.2.1" xref="S3.E4.m1.11.11.2.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml">τ</mi><mo stretchy="false" id="S3.E4.m1.11.11.2.1.1.1.1.2.2" xref="S3.E4.m1.11.11.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.11b"><apply id="S3.E4.m1.11.11.cmml" xref="S3.E4.m1.11.11"><and id="S3.E4.m1.11.11a.cmml" xref="S3.E4.m1.11.11"></and><apply id="S3.E4.m1.11.11b.cmml" xref="S3.E4.m1.11.11"><eq id="S3.E4.m1.11.11.5.cmml" xref="S3.E4.m1.11.11.5"></eq><apply id="S3.E4.m1.11.11.4.cmml" xref="S3.E4.m1.11.11.4"><times id="S3.E4.m1.11.11.4.1.cmml" xref="S3.E4.m1.11.11.4.1"></times><apply id="S3.E4.m1.11.11.4.2.cmml" xref="S3.E4.m1.11.11.4.2"><ci id="S3.E4.m1.11.11.4.2.1.cmml" xref="S3.E4.m1.11.11.4.2.1">∇</ci><apply id="S3.E4.m1.11.11.4.2.2.cmml" xref="S3.E4.m1.11.11.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.4.2.2.1.cmml" xref="S3.E4.m1.11.11.4.2.2">subscript</csymbol><ci id="S3.E4.m1.11.11.4.2.2.2.cmml" xref="S3.E4.m1.11.11.4.2.2.2">𝐰</ci><ci id="S3.E4.m1.11.11.4.2.2.3.cmml" xref="S3.E4.m1.11.11.4.2.2.3">𝑘</ci></apply></apply><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝜏</ci></apply><apply id="S3.E4.m1.10.10.1.cmml" xref="S3.E4.m1.10.10.1"><times id="S3.E4.m1.10.10.1.2.cmml" xref="S3.E4.m1.10.10.1.2"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn type="integer" id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></abs><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒞</ci></apply></apply><apply id="S3.E4.m1.10.10.1.1.cmml" xref="S3.E4.m1.10.10.1.1"><apply id="S3.E4.m1.10.10.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.2">subscript</csymbol><sum id="S3.E4.m1.10.10.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.2.2"></sum><apply id="S3.E4.m1.10.10.1.1.2.3.cmml" xref="S3.E4.m1.10.10.1.1.2.3"><in id="S3.E4.m1.10.10.1.1.2.3.1.cmml" xref="S3.E4.m1.10.10.1.1.2.3.1"></in><ci id="S3.E4.m1.10.10.1.1.2.3.2.cmml" xref="S3.E4.m1.10.10.1.1.2.3.2">𝑐</ci><ci id="S3.E4.m1.10.10.1.1.2.3.3.cmml" xref="S3.E4.m1.10.10.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.E4.m1.10.10.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1"><apply id="S3.E4.m1.10.10.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.2.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.10.10.1.1.1.2.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.10.10.1.1.1.2.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.2.2.3"><eq id="S3.E4.m1.10.10.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.10.10.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.10.10.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E4.m1.10.10.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.10.10.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.10.10.1.1.1.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E4.m1.10.10.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1"><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.4"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑐</ci><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">𝑚</ci></list></apply><ci id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8">𝜏</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.11.11c.cmml" xref="S3.E4.m1.11.11"><eq id="S3.E4.m1.11.11.6.cmml" xref="S3.E4.m1.11.11.6"></eq><share href="#S3.E4.m1.10.10.1.cmml" id="S3.E4.m1.11.11d.cmml" xref="S3.E4.m1.11.11"></share><apply id="S3.E4.m1.11.11.2.cmml" xref="S3.E4.m1.11.11.2"><times id="S3.E4.m1.11.11.2.2.cmml" xref="S3.E4.m1.11.11.2.2"></times><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4"></divide><cn type="integer" id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3">1</cn><apply id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.3"><abs id="S3.E4.m1.4.4.1.2.1.cmml" xref="S3.E4.m1.4.4.1.3.1"></abs><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝒞</ci></apply></apply><apply id="S3.E4.m1.11.11.2.1.cmml" xref="S3.E4.m1.11.11.2.1"><apply id="S3.E4.m1.11.11.2.1.2.cmml" xref="S3.E4.m1.11.11.2.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.2.1.2.1.cmml" xref="S3.E4.m1.11.11.2.1.2">superscript</csymbol><apply id="S3.E4.m1.11.11.2.1.2.2.cmml" xref="S3.E4.m1.11.11.2.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.2.1.2.2.1.cmml" xref="S3.E4.m1.11.11.2.1.2">subscript</csymbol><sum id="S3.E4.m1.11.11.2.1.2.2.2.cmml" xref="S3.E4.m1.11.11.2.1.2.2.2"></sum><apply id="S3.E4.m1.11.11.2.1.2.2.3.cmml" xref="S3.E4.m1.11.11.2.1.2.2.3"><eq id="S3.E4.m1.11.11.2.1.2.2.3.1.cmml" xref="S3.E4.m1.11.11.2.1.2.2.3.1"></eq><ci id="S3.E4.m1.11.11.2.1.2.2.3.2.cmml" xref="S3.E4.m1.11.11.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E4.m1.11.11.2.1.2.2.3.3.cmml" xref="S3.E4.m1.11.11.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.11.11.2.1.2.3.cmml" xref="S3.E4.m1.11.11.2.1.2.3">𝑀</ci></apply><apply id="S3.E4.m1.11.11.2.1.1.cmml" xref="S3.E4.m1.11.11.2.1.1"><apply id="S3.E4.m1.11.11.2.1.1.2.cmml" xref="S3.E4.m1.11.11.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.2.1.1.2.1.cmml" xref="S3.E4.m1.11.11.2.1.1.2">subscript</csymbol><sum id="S3.E4.m1.11.11.2.1.1.2.2.cmml" xref="S3.E4.m1.11.11.2.1.1.2.2"></sum><apply id="S3.E4.m1.11.11.2.1.1.2.3.cmml" xref="S3.E4.m1.11.11.2.1.1.2.3"><in id="S3.E4.m1.11.11.2.1.1.2.3.1.cmml" xref="S3.E4.m1.11.11.2.1.1.2.3.1"></in><ci id="S3.E4.m1.11.11.2.1.1.2.3.2.cmml" xref="S3.E4.m1.11.11.2.1.1.2.3.2">𝑐</ci><ci id="S3.E4.m1.11.11.2.1.1.2.3.3.cmml" xref="S3.E4.m1.11.11.2.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.E4.m1.11.11.2.1.1.1.2.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1"><apply id="S3.E4.m1.11.11.2.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.11.11.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.11.11.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1.2.2">∇</ci><ci id="S3.E4.m1.11.11.2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.11.11.2.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.4"><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑐</ci><ci id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2">𝑚</ci></list></apply><ci id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.11c">\nabla\mathbf{w}_{k}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{c\in\mathcal{C}}\sum_{m=1}^{M}\nabla_{k}^{c,m}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\sum_{c\in\mathcal{C}}\nabla_{k}^{c,m}(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.5" class="ltx_p">where <math id="S3.SS2.p2.1.m1.4" class="ltx_Math" alttext="\nabla_{k}^{c,m}(\tau)" display="inline"><semantics id="S3.SS2.p2.1.m1.4a"><mrow id="S3.SS2.p2.1.m1.4.4.1" xref="S3.SS2.p2.1.m1.4.4.2.cmml"><msubsup id="S3.SS2.p2.1.m1.4.4.1.1" xref="S3.SS2.p2.1.m1.4.4.1.1.cmml"><mo id="S3.SS2.p2.1.m1.4.4.1.1.2.2" xref="S3.SS2.p2.1.m1.4.4.1.1.2.2.cmml">∇</mo><mi id="S3.SS2.p2.1.m1.4.4.1.1.2.3" xref="S3.SS2.p2.1.m1.4.4.1.1.2.3.cmml">k</mi><mrow id="S3.SS2.p2.1.m1.2.2.2.4" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p2.1.m1.2.2.2.4.1" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.1.m1.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.SS2.p2.1.m1.4.4.1.2" xref="S3.SS2.p2.1.m1.4.4.2.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.4.4.1.2.1" xref="S3.SS2.p2.1.m1.4.4.2.cmml">(</mo><mi id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml">τ</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.4.4.1.2.2" xref="S3.SS2.p2.1.m1.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.4b"><apply id="S3.SS2.p2.1.m1.4.4.2.cmml" xref="S3.SS2.p2.1.m1.4.4.1"><apply id="S3.SS2.p2.1.m1.4.4.1.1.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.4.4.1.1.1.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1">superscript</csymbol><apply id="S3.SS2.p2.1.m1.4.4.1.1.2.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.4.4.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.4.4.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1.2.2">∇</ci><ci id="S3.SS2.p2.1.m1.4.4.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.4.4.1.1.2.3">𝑘</ci></apply><list id="S3.SS2.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.4"><ci id="S3.SS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1">𝑐</ci><ci id="S3.SS2.p2.1.m1.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2">𝑚</ci></list></apply><ci id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.4c">\nabla_{k}^{c,m}(\tau)</annotation></semantics></math> represents the local gradient of client <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">c</annotation></semantics></math> at exit <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">m</annotation></semantics></math>. For the sake of simplicity, we assume that <math id="S3.SS2.p2.4.m4.2" class="ltx_Math" alttext="\gamma_{c}(\tau)=1/{|\mathcal{C}|}" display="inline"><semantics id="S3.SS2.p2.4.m4.2a"><mrow id="S3.SS2.p2.4.m4.2.3" xref="S3.SS2.p2.4.m4.2.3.cmml"><mrow id="S3.SS2.p2.4.m4.2.3.2" xref="S3.SS2.p2.4.m4.2.3.2.cmml"><msub id="S3.SS2.p2.4.m4.2.3.2.2" xref="S3.SS2.p2.4.m4.2.3.2.2.cmml"><mi id="S3.SS2.p2.4.m4.2.3.2.2.2" xref="S3.SS2.p2.4.m4.2.3.2.2.2.cmml">γ</mi><mi id="S3.SS2.p2.4.m4.2.3.2.2.3" xref="S3.SS2.p2.4.m4.2.3.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.2.3.2.1" xref="S3.SS2.p2.4.m4.2.3.2.1.cmml">​</mo><mrow id="S3.SS2.p2.4.m4.2.3.2.3.2" xref="S3.SS2.p2.4.m4.2.3.2.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.2.3.2.3.2.1" xref="S3.SS2.p2.4.m4.2.3.2.cmml">(</mo><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS2.p2.4.m4.2.3.2.3.2.2" xref="S3.SS2.p2.4.m4.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.4.m4.2.3.1" xref="S3.SS2.p2.4.m4.2.3.1.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.2.3.3" xref="S3.SS2.p2.4.m4.2.3.3.cmml"><mn id="S3.SS2.p2.4.m4.2.3.3.2" xref="S3.SS2.p2.4.m4.2.3.3.2.cmml">1</mn><mo id="S3.SS2.p2.4.m4.2.3.3.1" xref="S3.SS2.p2.4.m4.2.3.3.1.cmml">/</mo><mrow id="S3.SS2.p2.4.m4.2.3.3.3.2" xref="S3.SS2.p2.4.m4.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.2.3.3.3.2.1" xref="S3.SS2.p2.4.m4.2.3.3.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.2.2" xref="S3.SS2.p2.4.m4.2.2.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p2.4.m4.2.3.3.3.2.2" xref="S3.SS2.p2.4.m4.2.3.3.3.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.2b"><apply id="S3.SS2.p2.4.m4.2.3.cmml" xref="S3.SS2.p2.4.m4.2.3"><eq id="S3.SS2.p2.4.m4.2.3.1.cmml" xref="S3.SS2.p2.4.m4.2.3.1"></eq><apply id="S3.SS2.p2.4.m4.2.3.2.cmml" xref="S3.SS2.p2.4.m4.2.3.2"><times id="S3.SS2.p2.4.m4.2.3.2.1.cmml" xref="S3.SS2.p2.4.m4.2.3.2.1"></times><apply id="S3.SS2.p2.4.m4.2.3.2.2.cmml" xref="S3.SS2.p2.4.m4.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.3.2.2.1.cmml" xref="S3.SS2.p2.4.m4.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.2.3.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.3.2.2.2">𝛾</ci><ci id="S3.SS2.p2.4.m4.2.3.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.3.2.2.3">𝑐</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝜏</ci></apply><apply id="S3.SS2.p2.4.m4.2.3.3.cmml" xref="S3.SS2.p2.4.m4.2.3.3"><divide id="S3.SS2.p2.4.m4.2.3.3.1.cmml" xref="S3.SS2.p2.4.m4.2.3.3.1"></divide><cn type="integer" id="S3.SS2.p2.4.m4.2.3.3.2.cmml" xref="S3.SS2.p2.4.m4.2.3.3.2">1</cn><apply id="S3.SS2.p2.4.m4.2.3.3.3.1.cmml" xref="S3.SS2.p2.4.m4.2.3.3.3.2"><abs id="S3.SS2.p2.4.m4.2.3.3.3.1.1.cmml" xref="S3.SS2.p2.4.m4.2.3.3.3.2.1"></abs><ci id="S3.SS2.p2.4.m4.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.2c">\gamma_{c}(\tau)=1/{|\mathcal{C}|}</annotation></semantics></math>. Basically, each sub-network, corresponding to a given exit <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">m</annotation></semantics></math>, is centrally updated averaging all the corresponding sub-nets on the clients, leading to a <em id="S3.SS2.p2.5.1" class="ltx_emph ltx_font_italic">per-exit</em> agglomeration.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Learning with Early-Exits on heterogeneous devices</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.16" class="ltx_p">Let us assume that the EE model on the server, <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{w}</annotation></semantics></math>, is split into <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">M</annotation></semantics></math> sub-nets, <math id="S3.SS3.p1.3.m3.3" class="ltx_Math" alttext="\mathbf{w}(l_{1}),\ldots,\mathbf{w}(l_{M})" display="inline"><semantics id="S3.SS3.p1.3.m3.3a"><mrow id="S3.SS3.p1.3.m3.3.3.2" xref="S3.SS3.p1.3.m3.3.3.3.cmml"><mrow id="S3.SS3.p1.3.m3.2.2.1.1" xref="S3.SS3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.p1.3.m3.2.2.1.1.3" xref="S3.SS3.p1.3.m3.2.2.1.1.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.2.2.1.1.2" xref="S3.SS3.p1.3.m3.2.2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.3.m3.2.2.1.1.1.1" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.2.2.1.1.1.1.2" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.2.cmml">l</mi><mn id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.SS3.p1.3.m3.2.2.1.1.1.1.3" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.3.m3.3.3.2.3" xref="S3.SS3.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p1.3.m3.3.3.2.4" xref="S3.SS3.p1.3.m3.3.3.3.cmml">,</mo><mrow id="S3.SS3.p1.3.m3.3.3.2.2" xref="S3.SS3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS3.p1.3.m3.3.3.2.2.3" xref="S3.SS3.p1.3.m3.3.3.2.2.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.3.3.2.2.2" xref="S3.SS3.p1.3.m3.3.3.2.2.2.cmml">​</mo><mrow id="S3.SS3.p1.3.m3.3.3.2.2.1.1" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.2.2.1.1.2" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.2" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.3" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.2.2.1.1.3" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.3b"><list id="S3.SS3.p1.3.m3.3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3.2"><apply id="S3.SS3.p1.3.m3.2.2.1.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1"><times id="S3.SS3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.2"></times><ci id="S3.SS3.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.3">𝐰</ci><apply id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">…</ci><apply id="S3.SS3.p1.3.m3.3.3.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2"><times id="S3.SS3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.2"></times><ci id="S3.SS3.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.3">𝐰</ci><apply id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.1.1.1.3">𝑀</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.3c">\mathbf{w}(l_{1}),\ldots,\mathbf{w}(l_{M})</annotation></semantics></math>, each of them corresponding to an exit layer, where <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">l</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑙</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">l_{m}</annotation></semantics></math> represents highest exit layers of the <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">m</annotation></semantics></math>-th sub-net and <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="l_{1}\leq l_{2}\leq\ldots\leq l_{M}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><msub id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2.2" xref="S3.SS3.p1.6.m6.1.1.2.2.cmml">l</mi><mn id="S3.SS3.p1.6.m6.1.1.2.3" xref="S3.SS3.p1.6.m6.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">≤</mo><msub id="S3.SS3.p1.6.m6.1.1.4" xref="S3.SS3.p1.6.m6.1.1.4.cmml"><mi id="S3.SS3.p1.6.m6.1.1.4.2" xref="S3.SS3.p1.6.m6.1.1.4.2.cmml">l</mi><mn id="S3.SS3.p1.6.m6.1.1.4.3" xref="S3.SS3.p1.6.m6.1.1.4.3.cmml">2</mn></msub><mo id="S3.SS3.p1.6.m6.1.1.5" xref="S3.SS3.p1.6.m6.1.1.5.cmml">≤</mo><mi mathvariant="normal" id="S3.SS3.p1.6.m6.1.1.6" xref="S3.SS3.p1.6.m6.1.1.6.cmml">…</mi><mo id="S3.SS3.p1.6.m6.1.1.7" xref="S3.SS3.p1.6.m6.1.1.7.cmml">≤</mo><msub id="S3.SS3.p1.6.m6.1.1.8" xref="S3.SS3.p1.6.m6.1.1.8.cmml"><mi id="S3.SS3.p1.6.m6.1.1.8.2" xref="S3.SS3.p1.6.m6.1.1.8.2.cmml">l</mi><mi id="S3.SS3.p1.6.m6.1.1.8.3" xref="S3.SS3.p1.6.m6.1.1.8.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><and id="S3.SS3.p1.6.m6.1.1a.cmml" xref="S3.SS3.p1.6.m6.1.1"></and><apply id="S3.SS3.p1.6.m6.1.1b.cmml" xref="S3.SS3.p1.6.m6.1.1"><leq id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3"></leq><apply id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2.2">𝑙</ci><cn type="integer" id="S3.SS3.p1.6.m6.1.1.2.3.cmml" xref="S3.SS3.p1.6.m6.1.1.2.3">1</cn></apply><apply id="S3.SS3.p1.6.m6.1.1.4.cmml" xref="S3.SS3.p1.6.m6.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.4.1.cmml" xref="S3.SS3.p1.6.m6.1.1.4">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.4.2.cmml" xref="S3.SS3.p1.6.m6.1.1.4.2">𝑙</ci><cn type="integer" id="S3.SS3.p1.6.m6.1.1.4.3.cmml" xref="S3.SS3.p1.6.m6.1.1.4.3">2</cn></apply></apply><apply id="S3.SS3.p1.6.m6.1.1c.cmml" xref="S3.SS3.p1.6.m6.1.1"><leq id="S3.SS3.p1.6.m6.1.1.5.cmml" xref="S3.SS3.p1.6.m6.1.1.5"></leq><share href="#S3.SS3.p1.6.m6.1.1.4.cmml" id="S3.SS3.p1.6.m6.1.1d.cmml" xref="S3.SS3.p1.6.m6.1.1"></share><ci id="S3.SS3.p1.6.m6.1.1.6.cmml" xref="S3.SS3.p1.6.m6.1.1.6">…</ci></apply><apply id="S3.SS3.p1.6.m6.1.1e.cmml" xref="S3.SS3.p1.6.m6.1.1"><leq id="S3.SS3.p1.6.m6.1.1.7.cmml" xref="S3.SS3.p1.6.m6.1.1.7"></leq><share href="#S3.SS3.p1.6.m6.1.1.6.cmml" id="S3.SS3.p1.6.m6.1.1f.cmml" xref="S3.SS3.p1.6.m6.1.1"></share><apply id="S3.SS3.p1.6.m6.1.1.8.cmml" xref="S3.SS3.p1.6.m6.1.1.8"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.8.1.cmml" xref="S3.SS3.p1.6.m6.1.1.8">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.8.2.cmml" xref="S3.SS3.p1.6.m6.1.1.8.2">𝑙</ci><ci id="S3.SS3.p1.6.m6.1.1.8.3.cmml" xref="S3.SS3.p1.6.m6.1.1.8.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">l_{1}\leq l_{2}\leq\ldots\leq l_{M}</annotation></semantics></math> (these are our <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">U</annotation></semantics></math> <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{w}^{u}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msup id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">𝐰</mi><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">𝐰</ci><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\mathbf{w}^{u}</annotation></semantics></math> models in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> for example).
In the heterogeneous device scenario, each client <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><mi id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><ci id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">c</annotation></semantics></math> fits a sub-net <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><msub id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">l</mi><mi id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">𝑙</ci><ci id="S3.SS3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">l_{m}</annotation></semantics></math> with probability <math id="S3.SS3.p1.11.m11.1" class="ltx_Math" alttext="\pi(m)" display="inline"><semantics id="S3.SS3.p1.11.m11.1a"><mrow id="S3.SS3.p1.11.m11.1.2" xref="S3.SS3.p1.11.m11.1.2.cmml"><mi id="S3.SS3.p1.11.m11.1.2.2" xref="S3.SS3.p1.11.m11.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.11.m11.1.2.1" xref="S3.SS3.p1.11.m11.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.11.m11.1.2.3.2" xref="S3.SS3.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.11.m11.1.2.3.2.1" xref="S3.SS3.p1.11.m11.1.2.cmml">(</mo><mi id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p1.11.m11.1.2.3.2.2" xref="S3.SS3.p1.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.2.cmml" xref="S3.SS3.p1.11.m11.1.2"><times id="S3.SS3.p1.11.m11.1.2.1.cmml" xref="S3.SS3.p1.11.m11.1.2.1"></times><ci id="S3.SS3.p1.11.m11.1.2.2.cmml" xref="S3.SS3.p1.11.m11.1.2.2">𝜋</ci><ci id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">\pi(m)</annotation></semantics></math>. We denote as <math id="S3.SS3.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{C}_{m}" display="inline"><semantics id="S3.SS3.p1.12.m12.1a"><msub id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.12.m12.1.1.2" xref="S3.SS3.p1.12.m12.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p1.12.m12.1.1.3" xref="S3.SS3.p1.12.m12.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b"><apply id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m12.1.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.p1.12.m12.1.1.2.cmml" xref="S3.SS3.p1.12.m12.1.1.2">𝒞</ci><ci id="S3.SS3.p1.12.m12.1.1.3.cmml" xref="S3.SS3.p1.12.m12.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">\mathcal{C}_{m}</annotation></semantics></math> the set of clients with sub-net <math id="S3.SS3.p1.13.m13.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p1.13.m13.1a"><msub id="S3.SS3.p1.13.m13.1.1" xref="S3.SS3.p1.13.m13.1.1.cmml"><mi id="S3.SS3.p1.13.m13.1.1.2" xref="S3.SS3.p1.13.m13.1.1.2.cmml">l</mi><mi id="S3.SS3.p1.13.m13.1.1.3" xref="S3.SS3.p1.13.m13.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m13.1b"><apply id="S3.SS3.p1.13.m13.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m13.1.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m13.1.1.2.cmml" xref="S3.SS3.p1.13.m13.1.1.2">𝑙</ci><ci id="S3.SS3.p1.13.m13.1.1.3.cmml" xref="S3.SS3.p1.13.m13.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m13.1c">l_{m}</annotation></semantics></math>, such that <math id="S3.SS3.p1.14.m14.2" class="ltx_Math" alttext="\sum_{m=1}^{M}|\mathcal{C}_{m}|=|\mathcal{C}|" display="inline"><semantics id="S3.SS3.p1.14.m14.2a"><mrow id="S3.SS3.p1.14.m14.2.2" xref="S3.SS3.p1.14.m14.2.2.cmml"><mrow id="S3.SS3.p1.14.m14.2.2.1" xref="S3.SS3.p1.14.m14.2.2.1.cmml"><msubsup id="S3.SS3.p1.14.m14.2.2.1.2" xref="S3.SS3.p1.14.m14.2.2.1.2.cmml"><mo id="S3.SS3.p1.14.m14.2.2.1.2.2.2" xref="S3.SS3.p1.14.m14.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p1.14.m14.2.2.1.2.2.3" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.cmml"><mi id="S3.SS3.p1.14.m14.2.2.1.2.2.3.2" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.2.cmml">m</mi><mo id="S3.SS3.p1.14.m14.2.2.1.2.2.3.1" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p1.14.m14.2.2.1.2.2.3.3" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p1.14.m14.2.2.1.2.3" xref="S3.SS3.p1.14.m14.2.2.1.2.3.cmml">M</mi></msubsup><mrow id="S3.SS3.p1.14.m14.2.2.1.1.1" xref="S3.SS3.p1.14.m14.2.2.1.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.SS3.p1.14.m14.2.2.1.1.1.2" xref="S3.SS3.p1.14.m14.2.2.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p1.14.m14.2.2.1.1.1.1" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m14.2.2.1.1.1.1.2" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p1.14.m14.2.2.1.1.1.1.3" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p1.14.m14.2.2.1.1.1.3" xref="S3.SS3.p1.14.m14.2.2.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.SS3.p1.14.m14.2.2.2" xref="S3.SS3.p1.14.m14.2.2.2.cmml">=</mo><mrow id="S3.SS3.p1.14.m14.2.2.3.2" xref="S3.SS3.p1.14.m14.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.14.m14.2.2.3.2.1" xref="S3.SS3.p1.14.m14.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m14.1.1" xref="S3.SS3.p1.14.m14.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.14.m14.2.2.3.2.2" xref="S3.SS3.p1.14.m14.2.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m14.2b"><apply id="S3.SS3.p1.14.m14.2.2.cmml" xref="S3.SS3.p1.14.m14.2.2"><eq id="S3.SS3.p1.14.m14.2.2.2.cmml" xref="S3.SS3.p1.14.m14.2.2.2"></eq><apply id="S3.SS3.p1.14.m14.2.2.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1"><apply id="S3.SS3.p1.14.m14.2.2.1.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.2.2.1.2.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2">superscript</csymbol><apply id="S3.SS3.p1.14.m14.2.2.1.2.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.2.2.1.2.2.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2">subscript</csymbol><sum id="S3.SS3.p1.14.m14.2.2.1.2.2.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.2.2"></sum><apply id="S3.SS3.p1.14.m14.2.2.1.2.2.3.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3"><eq id="S3.SS3.p1.14.m14.2.2.1.2.2.3.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.1"></eq><ci id="S3.SS3.p1.14.m14.2.2.1.2.2.3.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.SS3.p1.14.m14.2.2.1.2.2.3.3.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.14.m14.2.2.1.2.3.cmml" xref="S3.SS3.p1.14.m14.2.2.1.2.3">𝑀</ci></apply><apply id="S3.SS3.p1.14.m14.2.2.1.1.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1"><abs id="S3.SS3.p1.14.m14.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1.2"></abs><apply id="S3.SS3.p1.14.m14.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m14.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1.2">𝒞</ci><ci id="S3.SS3.p1.14.m14.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.14.m14.2.2.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S3.SS3.p1.14.m14.2.2.3.1.cmml" xref="S3.SS3.p1.14.m14.2.2.3.2"><abs id="S3.SS3.p1.14.m14.2.2.3.1.1.cmml" xref="S3.SS3.p1.14.m14.2.2.3.2.1"></abs><ci id="S3.SS3.p1.14.m14.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m14.2c">\sum_{m=1}^{M}|\mathcal{C}_{m}|=|\mathcal{C}|</annotation></semantics></math> (note that in this way <math id="S3.SS3.p1.15.m15.1" class="ltx_Math" alttext="\pi(m)" display="inline"><semantics id="S3.SS3.p1.15.m15.1a"><mrow id="S3.SS3.p1.15.m15.1.2" xref="S3.SS3.p1.15.m15.1.2.cmml"><mi id="S3.SS3.p1.15.m15.1.2.2" xref="S3.SS3.p1.15.m15.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.15.m15.1.2.1" xref="S3.SS3.p1.15.m15.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.15.m15.1.2.3.2" xref="S3.SS3.p1.15.m15.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.15.m15.1.2.3.2.1" xref="S3.SS3.p1.15.m15.1.2.cmml">(</mo><mi id="S3.SS3.p1.15.m15.1.1" xref="S3.SS3.p1.15.m15.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p1.15.m15.1.2.3.2.2" xref="S3.SS3.p1.15.m15.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m15.1b"><apply id="S3.SS3.p1.15.m15.1.2.cmml" xref="S3.SS3.p1.15.m15.1.2"><times id="S3.SS3.p1.15.m15.1.2.1.cmml" xref="S3.SS3.p1.15.m15.1.2.1"></times><ci id="S3.SS3.p1.15.m15.1.2.2.cmml" xref="S3.SS3.p1.15.m15.1.2.2">𝜋</ci><ci id="S3.SS3.p1.15.m15.1.1.cmml" xref="S3.SS3.p1.15.m15.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m15.1c">\pi(m)</annotation></semantics></math> can be estimated as: <math id="S3.SS3.p1.16.m16.3" class="ltx_Math" alttext="\pi(m)={|\mathcal{C}_{m}|}/{|\mathcal{C}|}" display="inline"><semantics id="S3.SS3.p1.16.m16.3a"><mrow id="S3.SS3.p1.16.m16.3.3" xref="S3.SS3.p1.16.m16.3.3.cmml"><mrow id="S3.SS3.p1.16.m16.3.3.3" xref="S3.SS3.p1.16.m16.3.3.3.cmml"><mi id="S3.SS3.p1.16.m16.3.3.3.2" xref="S3.SS3.p1.16.m16.3.3.3.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.16.m16.3.3.3.1" xref="S3.SS3.p1.16.m16.3.3.3.1.cmml">​</mo><mrow id="S3.SS3.p1.16.m16.3.3.3.3.2" xref="S3.SS3.p1.16.m16.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.3.3.2.1" xref="S3.SS3.p1.16.m16.3.3.3.cmml">(</mo><mi id="S3.SS3.p1.16.m16.1.1" xref="S3.SS3.p1.16.m16.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.3.3.2.2" xref="S3.SS3.p1.16.m16.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.16.m16.3.3.2" xref="S3.SS3.p1.16.m16.3.3.2.cmml">=</mo><mrow id="S3.SS3.p1.16.m16.3.3.1" xref="S3.SS3.p1.16.m16.3.3.1.cmml"><mrow id="S3.SS3.p1.16.m16.3.3.1.1.1" xref="S3.SS3.p1.16.m16.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.1.1.1.2" xref="S3.SS3.p1.16.m16.3.3.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p1.16.m16.3.3.1.1.1.1" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.16.m16.3.3.1.1.1.1.2" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p1.16.m16.3.3.1.1.1.1.3" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.1.1.1.3" xref="S3.SS3.p1.16.m16.3.3.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.16.m16.3.3.1.2" xref="S3.SS3.p1.16.m16.3.3.1.2.cmml">/</mo><mrow id="S3.SS3.p1.16.m16.3.3.1.3.2" xref="S3.SS3.p1.16.m16.3.3.1.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.1.3.2.1" xref="S3.SS3.p1.16.m16.3.3.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.16.m16.2.2" xref="S3.SS3.p1.16.m16.2.2.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.16.m16.3.3.1.3.2.2" xref="S3.SS3.p1.16.m16.3.3.1.3.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m16.3b"><apply id="S3.SS3.p1.16.m16.3.3.cmml" xref="S3.SS3.p1.16.m16.3.3"><eq id="S3.SS3.p1.16.m16.3.3.2.cmml" xref="S3.SS3.p1.16.m16.3.3.2"></eq><apply id="S3.SS3.p1.16.m16.3.3.3.cmml" xref="S3.SS3.p1.16.m16.3.3.3"><times id="S3.SS3.p1.16.m16.3.3.3.1.cmml" xref="S3.SS3.p1.16.m16.3.3.3.1"></times><ci id="S3.SS3.p1.16.m16.3.3.3.2.cmml" xref="S3.SS3.p1.16.m16.3.3.3.2">𝜋</ci><ci id="S3.SS3.p1.16.m16.1.1.cmml" xref="S3.SS3.p1.16.m16.1.1">𝑚</ci></apply><apply id="S3.SS3.p1.16.m16.3.3.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1"><divide id="S3.SS3.p1.16.m16.3.3.1.2.cmml" xref="S3.SS3.p1.16.m16.3.3.1.2"></divide><apply id="S3.SS3.p1.16.m16.3.3.1.1.2.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1"><abs id="S3.SS3.p1.16.m16.3.3.1.1.2.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1.2"></abs><apply id="S3.SS3.p1.16.m16.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m16.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.16.m16.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1.2">𝒞</ci><ci id="S3.SS3.p1.16.m16.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p1.16.m16.3.3.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S3.SS3.p1.16.m16.3.3.1.3.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1.3.2"><abs id="S3.SS3.p1.16.m16.3.3.1.3.1.1.cmml" xref="S3.SS3.p1.16.m16.3.3.1.3.2.1"></abs><ci id="S3.SS3.p1.16.m16.2.2.cmml" xref="S3.SS3.p1.16.m16.2.2">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m16.3c">\pi(m)={|\mathcal{C}_{m}|}/{|\mathcal{C}|}</annotation></semantics></math>).</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.7" class="ltx_p">Following the notation above, we also denote with <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="\mathbf{w}_{k}(\tau,l_{m})" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml"><msub id="S3.SS3.p2.1.m1.2.2.3" xref="S3.SS3.p2.1.m1.2.2.3.cmml"><mi id="S3.SS3.p2.1.m1.2.2.3.2" xref="S3.SS3.p2.1.m1.2.2.3.2.cmml">𝐰</mi><mi id="S3.SS3.p2.1.m1.2.2.3.3" xref="S3.SS3.p2.1.m1.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.2.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">τ</mi><mo id="S3.SS3.p2.1.m1.2.2.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p2.1.m1.2.2.1.1.4" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2"><times id="S3.SS3.p2.1.m1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2"></times><apply id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.2.3.2">𝐰</ci><ci id="S3.SS3.p2.1.m1.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.2.3.3">𝑘</ci></apply><interval closure="open" id="S3.SS3.p2.1.m1.2.2.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝜏</ci><apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\mathbf{w}_{k}(\tau,l_{m})</annotation></semantics></math> the <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">k</annotation></semantics></math>-th parameter of the EE sub-net with <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">l</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑙</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">l_{m}</annotation></semantics></math> exits at FL round <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\tau</annotation></semantics></math>. Each client <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">c</annotation></semantics></math>, exhibiting <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">l</mi><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝑙</ci><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">l_{m}</annotation></semantics></math> exits, locally updates the model applying SGD to the compound loss (see Eq. <a href="#S3.E3" title="Equation 3 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) providing at round <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">\tau</annotation></semantics></math> the following local gradients:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}^{c}(\tau,l_{m})=\sum_{i=1}^{l_{m}}\nabla_{k}^{c,i}(\tau)." display="block"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.3.cmml"><mo rspace="0.167em" id="S3.E5.m1.5.5.1.1.1.3.1" xref="S3.E5.m1.5.5.1.1.1.3.1.cmml">∇</mo><msubsup id="S3.E5.m1.5.5.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.3.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.3.2.2.2" xref="S3.E5.m1.5.5.1.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S3.E5.m1.5.5.1.1.1.3.2.2.3" xref="S3.E5.m1.5.5.1.1.1.3.2.2.3.cmml">k</mi><mi id="S3.E5.m1.5.5.1.1.1.3.2.3" xref="S3.E5.m1.5.5.1.1.1.3.2.3.cmml">c</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">τ</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">,</mo><msub id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml">l</mi><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.4" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><munderover id="S3.E5.m1.5.5.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E5.m1.5.5.1.1.2.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.5.5.1.1.2.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2.2.3.2" xref="S3.E5.m1.5.5.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E5.m1.5.5.1.1.2.2.2.3.1" xref="S3.E5.m1.5.5.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.5.5.1.1.2.2.2.3.3" xref="S3.E5.m1.5.5.1.1.2.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E5.m1.5.5.1.1.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2.3.2" xref="S3.E5.m1.5.5.1.1.2.2.3.2.cmml">l</mi><mi id="S3.E5.m1.5.5.1.1.2.2.3.3" xref="S3.E5.m1.5.5.1.1.2.2.3.3.cmml">m</mi></msub></munderover><mrow id="S3.E5.m1.5.5.1.1.2.1.1" xref="S3.E5.m1.5.5.1.1.2.1.2.cmml"><msubsup id="S3.E5.m1.5.5.1.1.2.1.1.1" xref="S3.E5.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.2.1.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml">∇</mo><mi id="S3.E5.m1.5.5.1.1.2.1.1.1.2.3" xref="S3.E5.m1.5.5.1.1.2.1.1.1.2.3.cmml">k</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">c</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">i</mi></mrow></msubsup><mrow id="S3.E5.m1.5.5.1.1.2.1.1.2" xref="S3.E5.m1.5.5.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.1.1.2.1" xref="S3.E5.m1.5.5.1.1.2.1.2.cmml">(</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">τ</mi><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3"></eq><apply id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"><times id="S3.E5.m1.5.5.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2"></times><apply id="S3.E5.m1.5.5.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3"><ci id="S3.E5.m1.5.5.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1">∇</ci><apply id="S3.E5.m1.5.5.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2.2.2">𝐰</ci><ci id="S3.E5.m1.5.5.1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="S3.E5.m1.5.5.1.1.1.3.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2.3">𝑐</ci></apply></apply><interval closure="open" id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝜏</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3">𝑚</ci></apply></interval></apply><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><apply id="S3.E5.m1.5.5.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2">subscript</csymbol><sum id="S3.E5.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2"></sum><apply id="S3.E5.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.3"><eq id="S3.E5.m1.5.5.1.1.2.2.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.3.1"></eq><ci id="S3.E5.m1.5.5.1.1.2.2.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.5.5.1.1.2.2.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.5.5.1.1.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3.2">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3.3">𝑚</ci></apply></apply><apply id="S3.E5.m1.5.5.1.1.2.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1"><apply id="S3.E5.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1.2.2">∇</ci><ci id="S3.E5.m1.5.5.1.1.2.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.1.1.1.2.3">𝑘</ci></apply><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑐</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\nabla\mathbf{w}_{k}^{c}(\tau,l_{m})=\sum_{i=1}^{l_{m}}\nabla_{k}^{c,i}(\tau).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">Therefore, following Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the FedAvg agglomerated gradients from all clients, fitting models with <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">l_{m}</annotation></semantics></math> exits, are:
textcolorred
</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E6.m1.12" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau,l_{m})=\frac{1}{|\mathcal{C}_{m}|}\sum_{c\in\mathcal{C}_{m}}\sum_{i=1}^{l_{m}}\nabla_{k}^{c,i}{(\tau)}=\frac{1}{|\mathcal{C}_{m}|}\sum_{i=1}^{l_{m}}\sum_{c\in\mathcal{C}_{m}}\nabla_{k}^{c,i}(\tau)" display="block"><semantics id="S3.E6.m1.12a"><mrow id="S3.E6.m1.12.12" xref="S3.E6.m1.12.12.cmml"><mrow id="S3.E6.m1.10.10.1" xref="S3.E6.m1.10.10.1.cmml"><mrow id="S3.E6.m1.10.10.1.3" xref="S3.E6.m1.10.10.1.3.cmml"><mo rspace="0.167em" id="S3.E6.m1.10.10.1.3.1" xref="S3.E6.m1.10.10.1.3.1.cmml">∇</mo><msub id="S3.E6.m1.10.10.1.3.2" xref="S3.E6.m1.10.10.1.3.2.cmml"><mi id="S3.E6.m1.10.10.1.3.2.2" xref="S3.E6.m1.10.10.1.3.2.2.cmml">𝐰</mi><mi id="S3.E6.m1.10.10.1.3.2.3" xref="S3.E6.m1.10.10.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.10.10.1.2" xref="S3.E6.m1.10.10.1.2.cmml">​</mo><mrow id="S3.E6.m1.10.10.1.1.1" xref="S3.E6.m1.10.10.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.10.10.1.1.1.2" xref="S3.E6.m1.10.10.1.1.2.cmml">(</mo><mi id="S3.E6.m1.7.7" xref="S3.E6.m1.7.7.cmml">τ</mi><mo id="S3.E6.m1.10.10.1.1.1.3" xref="S3.E6.m1.10.10.1.1.2.cmml">,</mo><msub id="S3.E6.m1.10.10.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml">l</mi><mi id="S3.E6.m1.10.10.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E6.m1.10.10.1.1.1.4" xref="S3.E6.m1.10.10.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.12.12.5" xref="S3.E6.m1.12.12.5.cmml">=</mo><mrow id="S3.E6.m1.11.11.2" xref="S3.E6.m1.11.11.2.cmml"><mfrac id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mn id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">1</mn><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.11.11.2.2" xref="S3.E6.m1.11.11.2.2.cmml">​</mo><mrow id="S3.E6.m1.11.11.2.1" xref="S3.E6.m1.11.11.2.1.cmml"><munder id="S3.E6.m1.11.11.2.1.2" xref="S3.E6.m1.11.11.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.11.11.2.1.2.2" xref="S3.E6.m1.11.11.2.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.11.11.2.1.2.3" xref="S3.E6.m1.11.11.2.1.2.3.cmml"><mi id="S3.E6.m1.11.11.2.1.2.3.2" xref="S3.E6.m1.11.11.2.1.2.3.2.cmml">c</mi><mo id="S3.E6.m1.11.11.2.1.2.3.1" xref="S3.E6.m1.11.11.2.1.2.3.1.cmml">∈</mo><msub id="S3.E6.m1.11.11.2.1.2.3.3" xref="S3.E6.m1.11.11.2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.11.11.2.1.2.3.3.2" xref="S3.E6.m1.11.11.2.1.2.3.3.2.cmml">𝒞</mi><mi id="S3.E6.m1.11.11.2.1.2.3.3.3" xref="S3.E6.m1.11.11.2.1.2.3.3.3.cmml">m</mi></msub></mrow></munder><mrow id="S3.E6.m1.11.11.2.1.1" xref="S3.E6.m1.11.11.2.1.1.cmml"><munderover id="S3.E6.m1.11.11.2.1.1.2" xref="S3.E6.m1.11.11.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.11.11.2.1.1.2.2.2" xref="S3.E6.m1.11.11.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.11.11.2.1.1.2.2.3" xref="S3.E6.m1.11.11.2.1.1.2.2.3.cmml"><mi id="S3.E6.m1.11.11.2.1.1.2.2.3.2" xref="S3.E6.m1.11.11.2.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.11.11.2.1.1.2.2.3.1" xref="S3.E6.m1.11.11.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.11.11.2.1.1.2.2.3.3" xref="S3.E6.m1.11.11.2.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.11.11.2.1.1.2.3" xref="S3.E6.m1.11.11.2.1.1.2.3.cmml"><mi id="S3.E6.m1.11.11.2.1.1.2.3.2" xref="S3.E6.m1.11.11.2.1.1.2.3.2.cmml">l</mi><mi id="S3.E6.m1.11.11.2.1.1.2.3.3" xref="S3.E6.m1.11.11.2.1.1.2.3.3.cmml">m</mi></msub></munderover><mrow id="S3.E6.m1.11.11.2.1.1.1.1" xref="S3.E6.m1.11.11.2.1.1.1.2.cmml"><msubsup id="S3.E6.m1.11.11.2.1.1.1.1.1" xref="S3.E6.m1.11.11.2.1.1.1.1.1.cmml"><mo id="S3.E6.m1.11.11.2.1.1.1.1.1.2.2" xref="S3.E6.m1.11.11.2.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E6.m1.11.11.2.1.1.1.1.1.2.3" xref="S3.E6.m1.11.11.2.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E6.m1.3.3.2.4" xref="S3.E6.m1.3.3.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml">c</mi><mo id="S3.E6.m1.3.3.2.4.1" xref="S3.E6.m1.3.3.2.3.cmml">,</mo><mi id="S3.E6.m1.3.3.2.2" xref="S3.E6.m1.3.3.2.2.cmml">i</mi></mrow></msubsup><mrow id="S3.E6.m1.11.11.2.1.1.1.1.2" xref="S3.E6.m1.11.11.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.11.11.2.1.1.1.1.2.1" xref="S3.E6.m1.11.11.2.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.8.8" xref="S3.E6.m1.8.8.cmml">τ</mi><mo stretchy="false" id="S3.E6.m1.11.11.2.1.1.1.1.2.2" xref="S3.E6.m1.11.11.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.12.12.6" xref="S3.E6.m1.12.12.6.cmml">=</mo><mrow id="S3.E6.m1.12.12.3" xref="S3.E6.m1.12.12.3.cmml"><mfrac id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml"><mn id="S3.E6.m1.4.4.3" xref="S3.E6.m1.4.4.3.cmml">1</mn><mrow id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.1.1.2" xref="S3.E6.m1.4.4.1.2.1.cmml">|</mo><msub id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.4.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.2.cmml">𝒞</mi><mi id="S3.E6.m1.4.4.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E6.m1.4.4.1.1.3" xref="S3.E6.m1.4.4.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.12.12.3.2" xref="S3.E6.m1.12.12.3.2.cmml">​</mo><mrow id="S3.E6.m1.12.12.3.1" xref="S3.E6.m1.12.12.3.1.cmml"><munderover id="S3.E6.m1.12.12.3.1.2" xref="S3.E6.m1.12.12.3.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.12.12.3.1.2.2.2" xref="S3.E6.m1.12.12.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.12.12.3.1.2.2.3" xref="S3.E6.m1.12.12.3.1.2.2.3.cmml"><mi id="S3.E6.m1.12.12.3.1.2.2.3.2" xref="S3.E6.m1.12.12.3.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.12.12.3.1.2.2.3.1" xref="S3.E6.m1.12.12.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.12.12.3.1.2.2.3.3" xref="S3.E6.m1.12.12.3.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.12.12.3.1.2.3" xref="S3.E6.m1.12.12.3.1.2.3.cmml"><mi id="S3.E6.m1.12.12.3.1.2.3.2" xref="S3.E6.m1.12.12.3.1.2.3.2.cmml">l</mi><mi id="S3.E6.m1.12.12.3.1.2.3.3" xref="S3.E6.m1.12.12.3.1.2.3.3.cmml">m</mi></msub></munderover><mrow id="S3.E6.m1.12.12.3.1.1" xref="S3.E6.m1.12.12.3.1.1.cmml"><munder id="S3.E6.m1.12.12.3.1.1.2" xref="S3.E6.m1.12.12.3.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.12.12.3.1.1.2.2" xref="S3.E6.m1.12.12.3.1.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.12.12.3.1.1.2.3" xref="S3.E6.m1.12.12.3.1.1.2.3.cmml"><mi id="S3.E6.m1.12.12.3.1.1.2.3.2" xref="S3.E6.m1.12.12.3.1.1.2.3.2.cmml">c</mi><mo id="S3.E6.m1.12.12.3.1.1.2.3.1" xref="S3.E6.m1.12.12.3.1.1.2.3.1.cmml">∈</mo><msub id="S3.E6.m1.12.12.3.1.1.2.3.3" xref="S3.E6.m1.12.12.3.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.12.12.3.1.1.2.3.3.2" xref="S3.E6.m1.12.12.3.1.1.2.3.3.2.cmml">𝒞</mi><mi id="S3.E6.m1.12.12.3.1.1.2.3.3.3" xref="S3.E6.m1.12.12.3.1.1.2.3.3.3.cmml">m</mi></msub></mrow></munder><mrow id="S3.E6.m1.12.12.3.1.1.1.1" xref="S3.E6.m1.12.12.3.1.1.1.2.cmml"><msubsup id="S3.E6.m1.12.12.3.1.1.1.1.1" xref="S3.E6.m1.12.12.3.1.1.1.1.1.cmml"><mo id="S3.E6.m1.12.12.3.1.1.1.1.1.2.2" xref="S3.E6.m1.12.12.3.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E6.m1.12.12.3.1.1.1.1.1.2.3" xref="S3.E6.m1.12.12.3.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E6.m1.6.6.2.4" xref="S3.E6.m1.6.6.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml">c</mi><mo id="S3.E6.m1.6.6.2.4.1" xref="S3.E6.m1.6.6.2.3.cmml">,</mo><mi id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.2.cmml">i</mi></mrow></msubsup><mrow id="S3.E6.m1.12.12.3.1.1.1.1.2" xref="S3.E6.m1.12.12.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.12.12.3.1.1.1.1.2.1" xref="S3.E6.m1.12.12.3.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.9.9" xref="S3.E6.m1.9.9.cmml">τ</mi><mo stretchy="false" id="S3.E6.m1.12.12.3.1.1.1.1.2.2" xref="S3.E6.m1.12.12.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.12b"><apply id="S3.E6.m1.12.12.cmml" xref="S3.E6.m1.12.12"><and id="S3.E6.m1.12.12a.cmml" xref="S3.E6.m1.12.12"></and><apply id="S3.E6.m1.12.12b.cmml" xref="S3.E6.m1.12.12"><eq id="S3.E6.m1.12.12.5.cmml" xref="S3.E6.m1.12.12.5"></eq><apply id="S3.E6.m1.10.10.1.cmml" xref="S3.E6.m1.10.10.1"><times id="S3.E6.m1.10.10.1.2.cmml" xref="S3.E6.m1.10.10.1.2"></times><apply id="S3.E6.m1.10.10.1.3.cmml" xref="S3.E6.m1.10.10.1.3"><ci id="S3.E6.m1.10.10.1.3.1.cmml" xref="S3.E6.m1.10.10.1.3.1">∇</ci><apply id="S3.E6.m1.10.10.1.3.2.cmml" xref="S3.E6.m1.10.10.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.3.2.1.cmml" xref="S3.E6.m1.10.10.1.3.2">subscript</csymbol><ci id="S3.E6.m1.10.10.1.3.2.2.cmml" xref="S3.E6.m1.10.10.1.3.2.2">𝐰</ci><ci id="S3.E6.m1.10.10.1.3.2.3.cmml" xref="S3.E6.m1.10.10.1.3.2.3">𝑘</ci></apply></apply><interval closure="open" id="S3.E6.m1.10.10.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1"><ci id="S3.E6.m1.7.7.cmml" xref="S3.E6.m1.7.7">𝜏</ci><apply id="S3.E6.m1.10.10.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.2">𝑙</ci><ci id="S3.E6.m1.10.10.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.3">𝑚</ci></apply></interval></apply><apply id="S3.E6.m1.11.11.2.cmml" xref="S3.E6.m1.11.11.2"><times id="S3.E6.m1.11.11.2.2.cmml" xref="S3.E6.m1.11.11.2.2"></times><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><divide id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"></divide><cn type="integer" id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">1</cn><apply id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1"><abs id="S3.E6.m1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2"></abs><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝒞</ci><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S3.E6.m1.11.11.2.1.cmml" xref="S3.E6.m1.11.11.2.1"><apply id="S3.E6.m1.11.11.2.1.2.cmml" xref="S3.E6.m1.11.11.2.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.2.1.cmml" xref="S3.E6.m1.11.11.2.1.2">subscript</csymbol><sum id="S3.E6.m1.11.11.2.1.2.2.cmml" xref="S3.E6.m1.11.11.2.1.2.2"></sum><apply id="S3.E6.m1.11.11.2.1.2.3.cmml" xref="S3.E6.m1.11.11.2.1.2.3"><in id="S3.E6.m1.11.11.2.1.2.3.1.cmml" xref="S3.E6.m1.11.11.2.1.2.3.1"></in><ci id="S3.E6.m1.11.11.2.1.2.3.2.cmml" xref="S3.E6.m1.11.11.2.1.2.3.2">𝑐</ci><apply id="S3.E6.m1.11.11.2.1.2.3.3.cmml" xref="S3.E6.m1.11.11.2.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.2.3.3.1.cmml" xref="S3.E6.m1.11.11.2.1.2.3.3">subscript</csymbol><ci id="S3.E6.m1.11.11.2.1.2.3.3.2.cmml" xref="S3.E6.m1.11.11.2.1.2.3.3.2">𝒞</ci><ci id="S3.E6.m1.11.11.2.1.2.3.3.3.cmml" xref="S3.E6.m1.11.11.2.1.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S3.E6.m1.11.11.2.1.1.cmml" xref="S3.E6.m1.11.11.2.1.1"><apply id="S3.E6.m1.11.11.2.1.1.2.cmml" xref="S3.E6.m1.11.11.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.1.2.1.cmml" xref="S3.E6.m1.11.11.2.1.1.2">superscript</csymbol><apply id="S3.E6.m1.11.11.2.1.1.2.2.cmml" xref="S3.E6.m1.11.11.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.1.2.2.1.cmml" xref="S3.E6.m1.11.11.2.1.1.2">subscript</csymbol><sum id="S3.E6.m1.11.11.2.1.1.2.2.2.cmml" xref="S3.E6.m1.11.11.2.1.1.2.2.2"></sum><apply id="S3.E6.m1.11.11.2.1.1.2.2.3.cmml" xref="S3.E6.m1.11.11.2.1.1.2.2.3"><eq id="S3.E6.m1.11.11.2.1.1.2.2.3.1.cmml" xref="S3.E6.m1.11.11.2.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.11.11.2.1.1.2.2.3.2.cmml" xref="S3.E6.m1.11.11.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.11.11.2.1.1.2.2.3.3.cmml" xref="S3.E6.m1.11.11.2.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.11.11.2.1.1.2.3.cmml" xref="S3.E6.m1.11.11.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.1.2.3.1.cmml" xref="S3.E6.m1.11.11.2.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.11.11.2.1.1.2.3.2.cmml" xref="S3.E6.m1.11.11.2.1.1.2.3.2">𝑙</ci><ci id="S3.E6.m1.11.11.2.1.1.2.3.3.cmml" xref="S3.E6.m1.11.11.2.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.E6.m1.11.11.2.1.1.1.2.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1"><apply id="S3.E6.m1.11.11.2.1.1.1.1.1.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.11.11.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.11.11.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.11.11.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1.2.2">∇</ci><ci id="S3.E6.m1.11.11.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.11.11.2.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E6.m1.3.3.2.3.cmml" xref="S3.E6.m1.3.3.2.4"><ci id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1">𝑐</ci><ci id="S3.E6.m1.3.3.2.2.cmml" xref="S3.E6.m1.3.3.2.2">𝑖</ci></list></apply><ci id="S3.E6.m1.8.8.cmml" xref="S3.E6.m1.8.8">𝜏</ci></apply></apply></apply></apply></apply><apply id="S3.E6.m1.12.12c.cmml" xref="S3.E6.m1.12.12"><eq id="S3.E6.m1.12.12.6.cmml" xref="S3.E6.m1.12.12.6"></eq><share href="#S3.E6.m1.11.11.2.cmml" id="S3.E6.m1.12.12d.cmml" xref="S3.E6.m1.12.12"></share><apply id="S3.E6.m1.12.12.3.cmml" xref="S3.E6.m1.12.12.3"><times id="S3.E6.m1.12.12.3.2.cmml" xref="S3.E6.m1.12.12.3.2"></times><apply id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4"><divide id="S3.E6.m1.4.4.2.cmml" xref="S3.E6.m1.4.4"></divide><cn type="integer" id="S3.E6.m1.4.4.3.cmml" xref="S3.E6.m1.4.4.3">1</cn><apply id="S3.E6.m1.4.4.1.2.cmml" xref="S3.E6.m1.4.4.1.1"><abs id="S3.E6.m1.4.4.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.2"></abs><apply id="S3.E6.m1.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2">𝒞</ci><ci id="S3.E6.m1.4.4.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S3.E6.m1.12.12.3.1.cmml" xref="S3.E6.m1.12.12.3.1"><apply id="S3.E6.m1.12.12.3.1.2.cmml" xref="S3.E6.m1.12.12.3.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.2.1.cmml" xref="S3.E6.m1.12.12.3.1.2">superscript</csymbol><apply id="S3.E6.m1.12.12.3.1.2.2.cmml" xref="S3.E6.m1.12.12.3.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.2.2.1.cmml" xref="S3.E6.m1.12.12.3.1.2">subscript</csymbol><sum id="S3.E6.m1.12.12.3.1.2.2.2.cmml" xref="S3.E6.m1.12.12.3.1.2.2.2"></sum><apply id="S3.E6.m1.12.12.3.1.2.2.3.cmml" xref="S3.E6.m1.12.12.3.1.2.2.3"><eq id="S3.E6.m1.12.12.3.1.2.2.3.1.cmml" xref="S3.E6.m1.12.12.3.1.2.2.3.1"></eq><ci id="S3.E6.m1.12.12.3.1.2.2.3.2.cmml" xref="S3.E6.m1.12.12.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.12.12.3.1.2.2.3.3.cmml" xref="S3.E6.m1.12.12.3.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.12.12.3.1.2.3.cmml" xref="S3.E6.m1.12.12.3.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.2.3.1.cmml" xref="S3.E6.m1.12.12.3.1.2.3">subscript</csymbol><ci id="S3.E6.m1.12.12.3.1.2.3.2.cmml" xref="S3.E6.m1.12.12.3.1.2.3.2">𝑙</ci><ci id="S3.E6.m1.12.12.3.1.2.3.3.cmml" xref="S3.E6.m1.12.12.3.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.E6.m1.12.12.3.1.1.cmml" xref="S3.E6.m1.12.12.3.1.1"><apply id="S3.E6.m1.12.12.3.1.1.2.cmml" xref="S3.E6.m1.12.12.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.1.2.1.cmml" xref="S3.E6.m1.12.12.3.1.1.2">subscript</csymbol><sum id="S3.E6.m1.12.12.3.1.1.2.2.cmml" xref="S3.E6.m1.12.12.3.1.1.2.2"></sum><apply id="S3.E6.m1.12.12.3.1.1.2.3.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3"><in id="S3.E6.m1.12.12.3.1.1.2.3.1.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.1"></in><ci id="S3.E6.m1.12.12.3.1.1.2.3.2.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.2">𝑐</ci><apply id="S3.E6.m1.12.12.3.1.1.2.3.3.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.1.2.3.3.1.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.3">subscript</csymbol><ci id="S3.E6.m1.12.12.3.1.1.2.3.3.2.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.3.2">𝒞</ci><ci id="S3.E6.m1.12.12.3.1.1.2.3.3.3.cmml" xref="S3.E6.m1.12.12.3.1.1.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S3.E6.m1.12.12.3.1.1.1.2.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1"><apply id="S3.E6.m1.12.12.3.1.1.1.1.1.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.12.12.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.3.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.12.12.3.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1.2.2">∇</ci><ci id="S3.E6.m1.12.12.3.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.12.12.3.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E6.m1.6.6.2.3.cmml" xref="S3.E6.m1.6.6.2.4"><ci id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1">𝑐</ci><ci id="S3.E6.m1.6.6.2.2.cmml" xref="S3.E6.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S3.E6.m1.9.9.cmml" xref="S3.E6.m1.9.9">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.12c">\nabla\mathbf{w}_{k}(\tau,l_{m})=\frac{1}{|\mathcal{C}_{m}|}\sum_{c\in\mathcal{C}_{m}}\sum_{i=1}^{l_{m}}\nabla_{k}^{c,i}{(\tau)}=\frac{1}{|\mathcal{C}_{m}|}\sum_{i=1}^{l_{m}}\sum_{c\in\mathcal{C}_{m}}\nabla_{k}^{c,i}(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.5" class="ltx_p">Note that if all clients fit the same full model <math id="S3.SS3.p3.2.m1.2" class="ltx_Math" alttext="\mathbf{w}(\tau,l_{M})" display="inline"><semantics id="S3.SS3.p3.2.m1.2a"><mrow id="S3.SS3.p3.2.m1.2.2" xref="S3.SS3.p3.2.m1.2.2.cmml"><mi id="S3.SS3.p3.2.m1.2.2.3" xref="S3.SS3.p3.2.m1.2.2.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m1.2.2.2" xref="S3.SS3.p3.2.m1.2.2.2.cmml">​</mo><mrow id="S3.SS3.p3.2.m1.2.2.1.1" xref="S3.SS3.p3.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m1.2.2.1.1.2" xref="S3.SS3.p3.2.m1.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p3.2.m1.1.1" xref="S3.SS3.p3.2.m1.1.1.cmml">τ</mi><mo id="S3.SS3.p3.2.m1.2.2.1.1.3" xref="S3.SS3.p3.2.m1.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p3.2.m1.2.2.1.1.1" xref="S3.SS3.p3.2.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.2.m1.2.2.1.1.1.2" xref="S3.SS3.p3.2.m1.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.2.m1.2.2.1.1.1.3" xref="S3.SS3.p3.2.m1.2.2.1.1.1.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS3.p3.2.m1.2.2.1.1.4" xref="S3.SS3.p3.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m1.2b"><apply id="S3.SS3.p3.2.m1.2.2.cmml" xref="S3.SS3.p3.2.m1.2.2"><times id="S3.SS3.p3.2.m1.2.2.2.cmml" xref="S3.SS3.p3.2.m1.2.2.2"></times><ci id="S3.SS3.p3.2.m1.2.2.3.cmml" xref="S3.SS3.p3.2.m1.2.2.3">𝐰</ci><interval closure="open" id="S3.SS3.p3.2.m1.2.2.1.2.cmml" xref="S3.SS3.p3.2.m1.2.2.1.1"><ci id="S3.SS3.p3.2.m1.1.1.cmml" xref="S3.SS3.p3.2.m1.1.1">𝜏</ci><apply id="S3.SS3.p3.2.m1.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m1.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.2.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m1.2.2.1.1.1.3">𝑀</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m1.2c">\mathbf{w}(\tau,l_{M})</annotation></semantics></math>, <math id="S3.SS3.p3.3.m2.1" class="ltx_Math" alttext="\mathcal{C}_{m}=\mathcal{C}" display="inline"><semantics id="S3.SS3.p3.3.m2.1a"><mrow id="S3.SS3.p3.3.m2.1.1" xref="S3.SS3.p3.3.m2.1.1.cmml"><msub id="S3.SS3.p3.3.m2.1.1.2" xref="S3.SS3.p3.3.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m2.1.1.2.2" xref="S3.SS3.p3.3.m2.1.1.2.2.cmml">𝒞</mi><mi id="S3.SS3.p3.3.m2.1.1.2.3" xref="S3.SS3.p3.3.m2.1.1.2.3.cmml">m</mi></msub><mo id="S3.SS3.p3.3.m2.1.1.1" xref="S3.SS3.p3.3.m2.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m2.1.1.3" xref="S3.SS3.p3.3.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m2.1b"><apply id="S3.SS3.p3.3.m2.1.1.cmml" xref="S3.SS3.p3.3.m2.1.1"><eq id="S3.SS3.p3.3.m2.1.1.1.cmml" xref="S3.SS3.p3.3.m2.1.1.1"></eq><apply id="S3.SS3.p3.3.m2.1.1.2.cmml" xref="S3.SS3.p3.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m2.1.1.2.1.cmml" xref="S3.SS3.p3.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.3.m2.1.1.2.2.cmml" xref="S3.SS3.p3.3.m2.1.1.2.2">𝒞</ci><ci id="S3.SS3.p3.3.m2.1.1.2.3.cmml" xref="S3.SS3.p3.3.m2.1.1.2.3">𝑚</ci></apply><ci id="S3.SS3.p3.3.m2.1.1.3.cmml" xref="S3.SS3.p3.3.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m2.1c">\mathcal{C}_{m}=\mathcal{C}</annotation></semantics></math> and the equation above becomes Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, which is the standard FedAvg formulation for EE architectures. Eq. <a href="#S3.E6" title="Equation 6 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> updates in a FL fashion the weights of the <math id="S3.SS3.p3.4.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.p3.4.m3.1a"><mi id="S3.SS3.p3.4.m3.1.1" xref="S3.SS3.p3.4.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m3.1b"><ci id="S3.SS3.p3.4.m3.1.1.cmml" xref="S3.SS3.p3.4.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m3.1c">m</annotation></semantics></math>-th sub-net, updating all the exits from 1 to <math id="S3.SS3.p3.5.m4.1" class="ltx_Math" alttext="l_{m}" display="inline"><semantics id="S3.SS3.p3.5.m4.1a"><msub id="S3.SS3.p3.5.m4.1.1" xref="S3.SS3.p3.5.m4.1.1.cmml"><mi id="S3.SS3.p3.5.m4.1.1.2" xref="S3.SS3.p3.5.m4.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.5.m4.1.1.3" xref="S3.SS3.p3.5.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m4.1b"><apply id="S3.SS3.p3.5.m4.1.1.cmml" xref="S3.SS3.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m4.1.1.1.cmml" xref="S3.SS3.p3.5.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m4.1.1.2.cmml" xref="S3.SS3.p3.5.m4.1.1.2">𝑙</ci><ci id="S3.SS3.p3.5.m4.1.1.3.cmml" xref="S3.SS3.p3.5.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m4.1c">l_{m}</annotation></semantics></math>. If we now aggregate all the sub-nets, we obtain the global gradients as sum of all the model-dependent gradients:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E7.m1.3" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=\sum_{m=1}^{M}\nabla\mathbf{w}_{k}(\tau,l_{m})," display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml"><mrow id="S3.E7.m1.3.3.1.1.3.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml"><mo rspace="0.167em" id="S3.E7.m1.3.3.1.1.3.2.1" xref="S3.E7.m1.3.3.1.1.3.2.1.cmml">∇</mo><msub id="S3.E7.m1.3.3.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.3.2.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S3.E7.m1.3.3.1.1.3.2.2.3" xref="S3.E7.m1.3.3.1.1.3.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.3.1" xref="S3.E7.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.3.3.2" xref="S3.E7.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.3.3.2.1" xref="S3.E7.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.1.3.3.2.2" xref="S3.E7.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml"><munderover id="S3.E7.m1.3.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E7.m1.3.3.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.1.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E7.m1.3.3.1.1.1.2.2.3.1" xref="S3.E7.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mo rspace="0.167em" id="S3.E7.m1.3.3.1.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.3.1.cmml">∇</mo><msub id="S3.E7.m1.3.3.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">τ</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.4" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"></eq><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"><times id="S3.E7.m1.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1"></times><apply id="S3.E7.m1.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2"><ci id="S3.E7.m1.3.3.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.1">∇</ci><apply id="S3.E7.m1.3.3.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.2">𝐰</ci><ci id="S3.E7.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.3">𝑘</ci></apply></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝜏</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3"><eq id="S3.E7.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E7.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"></times><apply id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><ci id="S3.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.1">∇</ci><apply id="S3.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.2">𝐰</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3">𝑘</ci></apply></apply><interval closure="open" id="S3.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝜏</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3">𝑚</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\nabla\mathbf{w}_{k}(\tau)=\sum_{m=1}^{M}\nabla\mathbf{w}_{k}(\tau,l_{m}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.7" class="ltx_p">where the gradients for parameters <math id="S3.SS3.p3.6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.6.m1.1a"><mi id="S3.SS3.p3.6.m1.1.1" xref="S3.SS3.p3.6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m1.1b"><ci id="S3.SS3.p3.6.m1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m1.1c">k</annotation></semantics></math> not in <math id="S3.SS3.p3.7.m2.2" class="ltx_Math" alttext="\mathbf{w}(\tau,l_{m})" display="inline"><semantics id="S3.SS3.p3.7.m2.2a"><mrow id="S3.SS3.p3.7.m2.2.2" xref="S3.SS3.p3.7.m2.2.2.cmml"><mi id="S3.SS3.p3.7.m2.2.2.3" xref="S3.SS3.p3.7.m2.2.2.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.7.m2.2.2.2" xref="S3.SS3.p3.7.m2.2.2.2.cmml">​</mo><mrow id="S3.SS3.p3.7.m2.2.2.1.1" xref="S3.SS3.p3.7.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m2.2.2.1.1.2" xref="S3.SS3.p3.7.m2.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p3.7.m2.1.1" xref="S3.SS3.p3.7.m2.1.1.cmml">τ</mi><mo id="S3.SS3.p3.7.m2.2.2.1.1.3" xref="S3.SS3.p3.7.m2.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p3.7.m2.2.2.1.1.1" xref="S3.SS3.p3.7.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.7.m2.2.2.1.1.1.2" xref="S3.SS3.p3.7.m2.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.7.m2.2.2.1.1.1.3" xref="S3.SS3.p3.7.m2.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p3.7.m2.2.2.1.1.4" xref="S3.SS3.p3.7.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m2.2b"><apply id="S3.SS3.p3.7.m2.2.2.cmml" xref="S3.SS3.p3.7.m2.2.2"><times id="S3.SS3.p3.7.m2.2.2.2.cmml" xref="S3.SS3.p3.7.m2.2.2.2"></times><ci id="S3.SS3.p3.7.m2.2.2.3.cmml" xref="S3.SS3.p3.7.m2.2.2.3">𝐰</ci><interval closure="open" id="S3.SS3.p3.7.m2.2.2.1.2.cmml" xref="S3.SS3.p3.7.m2.2.2.1.1"><ci id="S3.SS3.p3.7.m2.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1">𝜏</ci><apply id="S3.SS3.p3.7.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.7.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.7.m2.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.7.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.7.m2.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m2.2c">\mathbf{w}(\tau,l_{m})</annotation></semantics></math> is obviously 0. Replacing Eq. <a href="#S3.E6" title="Equation 6 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> into Eq. <a href="#S3.E7" title="Equation 7 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> we obtain:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\nabla\mathbf{w}_{k}(\tau)" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.2" xref="S3.Ex1.m1.1.2.cmml"><mrow id="S3.Ex1.m1.1.2.2" xref="S3.Ex1.m1.1.2.2.cmml"><mo rspace="0.167em" id="S3.Ex1.m1.1.2.2.1" xref="S3.Ex1.m1.1.2.2.1.cmml">∇</mo><msub id="S3.Ex1.m1.1.2.2.2" xref="S3.Ex1.m1.1.2.2.2.cmml"><mi id="S3.Ex1.m1.1.2.2.2.2" xref="S3.Ex1.m1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.Ex1.m1.1.2.2.2.3" xref="S3.Ex1.m1.1.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.2.1" xref="S3.Ex1.m1.1.2.1.cmml">​</mo><mrow id="S3.Ex1.m1.1.2.3.2" xref="S3.Ex1.m1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.1" xref="S3.Ex1.m1.1.2.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.2" xref="S3.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.2.cmml" xref="S3.Ex1.m1.1.2"><times id="S3.Ex1.m1.1.2.1.cmml" xref="S3.Ex1.m1.1.2.1"></times><apply id="S3.Ex1.m1.1.2.2.cmml" xref="S3.Ex1.m1.1.2.2"><ci id="S3.Ex1.m1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2.1">∇</ci><apply id="S3.Ex1.m1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.2.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2.2.2">𝐰</ci><ci id="S3.Ex1.m1.1.2.2.2.3.cmml" xref="S3.Ex1.m1.1.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\nabla\mathbf{w}_{k}(\tau)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.10" class="ltx_Math" alttext="\displaystyle=\sum_{m=1}^{M}\frac{1}{|\mathcal{C}_{m}|}\sum_{i=1}^{l_{m}}\sum_{c\in\mathcal{C}_{m}}\nabla_{k}^{c,i}(\tau)=\sum_{m=1}^{M}\frac{1}{|\mathcal{C}_{m}|}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)" display="inline"><semantics id="S3.Ex1.m2.10a"><mrow id="S3.Ex1.m2.10.10" xref="S3.Ex1.m2.10.10.cmml"><mi id="S3.Ex1.m2.10.10.4" xref="S3.Ex1.m2.10.10.4.cmml"></mi><mo id="S3.Ex1.m2.10.10.5" xref="S3.Ex1.m2.10.10.5.cmml">=</mo><mrow id="S3.Ex1.m2.9.9.1" xref="S3.Ex1.m2.9.9.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.9.9.1.2" xref="S3.Ex1.m2.9.9.1.2.cmml"><munderover id="S3.Ex1.m2.9.9.1.2a" xref="S3.Ex1.m2.9.9.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.9.9.1.2.2.2" xref="S3.Ex1.m2.9.9.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.9.9.1.2.2.3" xref="S3.Ex1.m2.9.9.1.2.2.3.cmml"><mi id="S3.Ex1.m2.9.9.1.2.2.3.2" xref="S3.Ex1.m2.9.9.1.2.2.3.2.cmml">m</mi><mo id="S3.Ex1.m2.9.9.1.2.2.3.1" xref="S3.Ex1.m2.9.9.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.9.9.1.2.2.3.3" xref="S3.Ex1.m2.9.9.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m2.9.9.1.2.3" xref="S3.Ex1.m2.9.9.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1.m2.9.9.1.1" xref="S3.Ex1.m2.9.9.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml"><mfrac id="S3.Ex1.m2.1.1a" xref="S3.Ex1.m2.1.1.cmml"><mn id="S3.Ex1.m2.1.1.3" xref="S3.Ex1.m2.1.1.3.cmml">1</mn><mrow id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex1.m2.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.Ex1.m2.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.9.9.1.1.2" xref="S3.Ex1.m2.9.9.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.9.9.1.1.1" xref="S3.Ex1.m2.9.9.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.9.9.1.1.1.2" xref="S3.Ex1.m2.9.9.1.1.1.2.cmml"><munderover id="S3.Ex1.m2.9.9.1.1.1.2a" xref="S3.Ex1.m2.9.9.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.9.9.1.1.1.2.2.2" xref="S3.Ex1.m2.9.9.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.9.9.1.1.1.2.2.3" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m2.9.9.1.1.1.2.2.3.2" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.9.9.1.1.1.2.2.3.1" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.9.9.1.1.1.2.2.3.3" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex1.m2.9.9.1.1.1.2.3" xref="S3.Ex1.m2.9.9.1.1.1.2.3.cmml"><mi id="S3.Ex1.m2.9.9.1.1.1.2.3.2" xref="S3.Ex1.m2.9.9.1.1.1.2.3.2.cmml">l</mi><mi id="S3.Ex1.m2.9.9.1.1.1.2.3.3" xref="S3.Ex1.m2.9.9.1.1.1.2.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S3.Ex1.m2.9.9.1.1.1.1" xref="S3.Ex1.m2.9.9.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.9.9.1.1.1.1.2" xref="S3.Ex1.m2.9.9.1.1.1.1.2.cmml"><munder id="S3.Ex1.m2.9.9.1.1.1.1.2a" xref="S3.Ex1.m2.9.9.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.9.9.1.1.1.1.2.2" xref="S3.Ex1.m2.9.9.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.9.9.1.1.1.1.2.3" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m2.9.9.1.1.1.1.2.3.2" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.2.cmml">c</mi><mo id="S3.Ex1.m2.9.9.1.1.1.1.2.3.1" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.2" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.2.cmml">𝒞</mi><mi id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.3" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.3.cmml">m</mi></msub></mrow></munder></mstyle><mrow id="S3.Ex1.m2.9.9.1.1.1.1.1.1" xref="S3.Ex1.m2.9.9.1.1.1.1.1.2.cmml"><msubsup id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.cmml"><mo lspace="0.167em" id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.Ex1.m2.3.3.2.4" xref="S3.Ex1.m2.3.3.2.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1" xref="S3.Ex1.m2.2.2.1.1.cmml">c</mi><mo id="S3.Ex1.m2.3.3.2.4.1" xref="S3.Ex1.m2.3.3.2.3.cmml">,</mo><mi id="S3.Ex1.m2.3.3.2.2" xref="S3.Ex1.m2.3.3.2.2.cmml">i</mi></mrow></msubsup><mrow id="S3.Ex1.m2.9.9.1.1.1.1.1.1.2" xref="S3.Ex1.m2.9.9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.9.9.1.1.1.1.1.1.2.1" xref="S3.Ex1.m2.9.9.1.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex1.m2.7.7" xref="S3.Ex1.m2.7.7.cmml">τ</mi><mo stretchy="false" id="S3.Ex1.m2.9.9.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.9.9.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m2.10.10.6" xref="S3.Ex1.m2.10.10.6.cmml">=</mo><mrow id="S3.Ex1.m2.10.10.2" xref="S3.Ex1.m2.10.10.2.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.10.10.2.2" xref="S3.Ex1.m2.10.10.2.2.cmml"><munderover id="S3.Ex1.m2.10.10.2.2a" xref="S3.Ex1.m2.10.10.2.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.10.10.2.2.2.2" xref="S3.Ex1.m2.10.10.2.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.10.10.2.2.2.3" xref="S3.Ex1.m2.10.10.2.2.2.3.cmml"><mi id="S3.Ex1.m2.10.10.2.2.2.3.2" xref="S3.Ex1.m2.10.10.2.2.2.3.2.cmml">m</mi><mo id="S3.Ex1.m2.10.10.2.2.2.3.1" xref="S3.Ex1.m2.10.10.2.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.10.10.2.2.2.3.3" xref="S3.Ex1.m2.10.10.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m2.10.10.2.2.3" xref="S3.Ex1.m2.10.10.2.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1.m2.10.10.2.1" xref="S3.Ex1.m2.10.10.2.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml"><mfrac id="S3.Ex1.m2.4.4a" xref="S3.Ex1.m2.4.4.cmml"><mn id="S3.Ex1.m2.4.4.3" xref="S3.Ex1.m2.4.4.3.cmml">1</mn><mrow id="S3.Ex1.m2.4.4.1.1" xref="S3.Ex1.m2.4.4.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.2" xref="S3.Ex1.m2.4.4.1.2.1.cmml">|</mo><msub id="S3.Ex1.m2.4.4.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.4.4.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.2.cmml">𝒞</mi><mi id="S3.Ex1.m2.4.4.1.1.1.3" xref="S3.Ex1.m2.4.4.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.3" xref="S3.Ex1.m2.4.4.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.10.10.2.1.2" xref="S3.Ex1.m2.10.10.2.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.10.10.2.1.1" xref="S3.Ex1.m2.10.10.2.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.10.10.2.1.1.2" xref="S3.Ex1.m2.10.10.2.1.1.2.cmml"><munder id="S3.Ex1.m2.10.10.2.1.1.2a" xref="S3.Ex1.m2.10.10.2.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.10.10.2.1.1.2.2" xref="S3.Ex1.m2.10.10.2.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.10.10.2.1.1.2.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.cmml"><mi id="S3.Ex1.m2.10.10.2.1.1.2.3.2" xref="S3.Ex1.m2.10.10.2.1.1.2.3.2.cmml">c</mi><mo rspace="0em" id="S3.Ex1.m2.10.10.2.1.1.2.3.1" xref="S3.Ex1.m2.10.10.2.1.1.2.3.1.cmml">∈</mo><mrow id="S3.Ex1.m2.10.10.2.1.1.2.3.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.cmml"><msubsup id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.cmml"><mo lspace="0em" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.2" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.2.cmml">∪</mo><mrow id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.cmml"><mi id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.2" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.1" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.3.cmml">m</mi></msubsup><msub id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.2" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.2.cmml">𝒞</mi><mi id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.3" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.3.cmml">i</mi></msub></mrow></mrow></munder></mstyle><mrow id="S3.Ex1.m2.10.10.2.1.1.1.1" xref="S3.Ex1.m2.10.10.2.1.1.1.2.cmml"><msubsup id="S3.Ex1.m2.10.10.2.1.1.1.1.1" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1.cmml"><mo lspace="0.167em" id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.2" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.3" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.Ex1.m2.6.6.2.4" xref="S3.Ex1.m2.6.6.2.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1" xref="S3.Ex1.m2.5.5.1.1.cmml">c</mi><mo id="S3.Ex1.m2.6.6.2.4.1" xref="S3.Ex1.m2.6.6.2.3.cmml">,</mo><mi id="S3.Ex1.m2.6.6.2.2" xref="S3.Ex1.m2.6.6.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.Ex1.m2.10.10.2.1.1.1.1.2" xref="S3.Ex1.m2.10.10.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.10.10.2.1.1.1.1.2.1" xref="S3.Ex1.m2.10.10.2.1.1.1.2.cmml">(</mo><mi id="S3.Ex1.m2.8.8" xref="S3.Ex1.m2.8.8.cmml">τ</mi><mo stretchy="false" id="S3.Ex1.m2.10.10.2.1.1.1.1.2.2" xref="S3.Ex1.m2.10.10.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.10b"><apply id="S3.Ex1.m2.10.10.cmml" xref="S3.Ex1.m2.10.10"><and id="S3.Ex1.m2.10.10a.cmml" xref="S3.Ex1.m2.10.10"></and><apply id="S3.Ex1.m2.10.10b.cmml" xref="S3.Ex1.m2.10.10"><eq id="S3.Ex1.m2.10.10.5.cmml" xref="S3.Ex1.m2.10.10.5"></eq><csymbol cd="latexml" id="S3.Ex1.m2.10.10.4.cmml" xref="S3.Ex1.m2.10.10.4">absent</csymbol><apply id="S3.Ex1.m2.9.9.1.cmml" xref="S3.Ex1.m2.9.9.1"><apply id="S3.Ex1.m2.9.9.1.2.cmml" xref="S3.Ex1.m2.9.9.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.2.1.cmml" xref="S3.Ex1.m2.9.9.1.2">superscript</csymbol><apply id="S3.Ex1.m2.9.9.1.2.2.cmml" xref="S3.Ex1.m2.9.9.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.2.2.1.cmml" xref="S3.Ex1.m2.9.9.1.2">subscript</csymbol><sum id="S3.Ex1.m2.9.9.1.2.2.2.cmml" xref="S3.Ex1.m2.9.9.1.2.2.2"></sum><apply id="S3.Ex1.m2.9.9.1.2.2.3.cmml" xref="S3.Ex1.m2.9.9.1.2.2.3"><eq id="S3.Ex1.m2.9.9.1.2.2.3.1.cmml" xref="S3.Ex1.m2.9.9.1.2.2.3.1"></eq><ci id="S3.Ex1.m2.9.9.1.2.2.3.2.cmml" xref="S3.Ex1.m2.9.9.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.Ex1.m2.9.9.1.2.2.3.3.cmml" xref="S3.Ex1.m2.9.9.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m2.9.9.1.2.3.cmml" xref="S3.Ex1.m2.9.9.1.2.3">𝑀</ci></apply><apply id="S3.Ex1.m2.9.9.1.1.cmml" xref="S3.Ex1.m2.9.9.1.1"><times id="S3.Ex1.m2.9.9.1.1.2.cmml" xref="S3.Ex1.m2.9.9.1.1.2"></times><apply id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1"><divide id="S3.Ex1.m2.1.1.2.cmml" xref="S3.Ex1.m2.1.1"></divide><cn type="integer" id="S3.Ex1.m2.1.1.3.cmml" xref="S3.Ex1.m2.1.1.3">1</cn><apply id="S3.Ex1.m2.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1"><abs id="S3.Ex1.m2.1.1.1.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.2"></abs><apply id="S3.Ex1.m2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.2">𝒞</ci><ci id="S3.Ex1.m2.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S3.Ex1.m2.9.9.1.1.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1"><apply id="S3.Ex1.m2.9.9.1.1.1.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.2.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m2.9.9.1.1.1.2.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m2.9.9.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.2.2"></sum><apply id="S3.Ex1.m2.9.9.1.1.1.2.2.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3"><eq id="S3.Ex1.m2.9.9.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1.m2.9.9.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex1.m2.9.9.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex1.m2.9.9.1.1.1.2.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1.m2.9.9.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.3.2">𝑙</ci><ci id="S3.Ex1.m2.9.9.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.Ex1.m2.9.9.1.1.1.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1"><apply id="S3.Ex1.m2.9.9.1.1.1.1.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m2.9.9.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.2"></sum><apply id="S3.Ex1.m2.9.9.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3"><in id="S3.Ex1.m2.9.9.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.1"></in><ci id="S3.Ex1.m2.9.9.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.2">𝑐</ci><apply id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.2">𝒞</ci><ci id="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S3.Ex1.m2.9.9.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1"><apply id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.9.9.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.Ex1.m2.3.3.2.3.cmml" xref="S3.Ex1.m2.3.3.2.4"><ci id="S3.Ex1.m2.2.2.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1">𝑐</ci><ci id="S3.Ex1.m2.3.3.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2">𝑖</ci></list></apply><ci id="S3.Ex1.m2.7.7.cmml" xref="S3.Ex1.m2.7.7">𝜏</ci></apply></apply></apply></apply></apply></apply><apply id="S3.Ex1.m2.10.10c.cmml" xref="S3.Ex1.m2.10.10"><eq id="S3.Ex1.m2.10.10.6.cmml" xref="S3.Ex1.m2.10.10.6"></eq><share href="#S3.Ex1.m2.9.9.1.cmml" id="S3.Ex1.m2.10.10d.cmml" xref="S3.Ex1.m2.10.10"></share><apply id="S3.Ex1.m2.10.10.2.cmml" xref="S3.Ex1.m2.10.10.2"><apply id="S3.Ex1.m2.10.10.2.2.cmml" xref="S3.Ex1.m2.10.10.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.2.1.cmml" xref="S3.Ex1.m2.10.10.2.2">superscript</csymbol><apply id="S3.Ex1.m2.10.10.2.2.2.cmml" xref="S3.Ex1.m2.10.10.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.2.2.1.cmml" xref="S3.Ex1.m2.10.10.2.2">subscript</csymbol><sum id="S3.Ex1.m2.10.10.2.2.2.2.cmml" xref="S3.Ex1.m2.10.10.2.2.2.2"></sum><apply id="S3.Ex1.m2.10.10.2.2.2.3.cmml" xref="S3.Ex1.m2.10.10.2.2.2.3"><eq id="S3.Ex1.m2.10.10.2.2.2.3.1.cmml" xref="S3.Ex1.m2.10.10.2.2.2.3.1"></eq><ci id="S3.Ex1.m2.10.10.2.2.2.3.2.cmml" xref="S3.Ex1.m2.10.10.2.2.2.3.2">𝑚</ci><cn type="integer" id="S3.Ex1.m2.10.10.2.2.2.3.3.cmml" xref="S3.Ex1.m2.10.10.2.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m2.10.10.2.2.3.cmml" xref="S3.Ex1.m2.10.10.2.2.3">𝑀</ci></apply><apply id="S3.Ex1.m2.10.10.2.1.cmml" xref="S3.Ex1.m2.10.10.2.1"><times id="S3.Ex1.m2.10.10.2.1.2.cmml" xref="S3.Ex1.m2.10.10.2.1.2"></times><apply id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4"><divide id="S3.Ex1.m2.4.4.2.cmml" xref="S3.Ex1.m2.4.4"></divide><cn type="integer" id="S3.Ex1.m2.4.4.3.cmml" xref="S3.Ex1.m2.4.4.3">1</cn><apply id="S3.Ex1.m2.4.4.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1"><abs id="S3.Ex1.m2.4.4.1.2.1.cmml" xref="S3.Ex1.m2.4.4.1.1.2"></abs><apply id="S3.Ex1.m2.4.4.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.4.4.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.4.4.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.2">𝒞</ci><ci id="S3.Ex1.m2.4.4.1.1.1.3.cmml" xref="S3.Ex1.m2.4.4.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S3.Ex1.m2.10.10.2.1.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1"><apply id="S3.Ex1.m2.10.10.2.1.1.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.2.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2">subscript</csymbol><sum id="S3.Ex1.m2.10.10.2.1.1.2.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.2"></sum><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3"><in id="S3.Ex1.m2.10.10.2.1.1.2.3.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.1"></in><ci id="S3.Ex1.m2.10.10.2.1.1.2.3.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.2">𝑐</ci><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3"><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1">superscript</csymbol><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1">subscript</csymbol><union id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.2"></union><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3"><eq id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.1"></eq><ci id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.1.3">𝑚</ci></apply><apply id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2">subscript</csymbol><ci id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.2">𝒞</ci><ci id="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.Ex1.m2.10.10.2.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1"><apply id="S3.Ex1.m2.10.10.2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.2">∇</ci><ci id="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.10.10.2.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.Ex1.m2.6.6.2.3.cmml" xref="S3.Ex1.m2.6.6.2.4"><ci id="S3.Ex1.m2.5.5.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1">𝑐</ci><ci id="S3.Ex1.m2.6.6.2.2.cmml" xref="S3.Ex1.m2.6.6.2.2">𝑚</ci></list></apply><ci id="S3.Ex1.m2.8.8.cmml" xref="S3.Ex1.m2.8.8">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.10c">\displaystyle=\sum_{m=1}^{M}\frac{1}{|\mathcal{C}_{m}|}\sum_{i=1}^{l_{m}}\sum_{c\in\mathcal{C}_{m}}\nabla_{k}^{c,i}(\tau)=\sum_{m=1}^{M}\frac{1}{|\mathcal{C}_{m}|}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\frac{1}{\pi(m)}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)" display="inline"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml"><mi id="S3.E8.m1.6.6.3" xref="S3.E8.m1.6.6.3.cmml"></mi><mo id="S3.E8.m1.6.6.2" xref="S3.E8.m1.6.6.2.cmml">=</mo><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.cmml"><mstyle displaystyle="true" id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mfrac id="S3.E8.m1.1.1a" xref="S3.E8.m1.1.1.cmml"><mn id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">1</mn><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.2.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mstyle displaystyle="true" id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml"><munderover id="S3.E8.m1.6.6.1.1.2a" xref="S3.E8.m1.6.6.1.1.2.cmml"><mo movablelimits="false" id="S3.E8.m1.6.6.1.1.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.6.6.1.1.2.2.3" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml"><mi id="S3.E8.m1.6.6.1.1.2.2.3.2" xref="S3.E8.m1.6.6.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E8.m1.6.6.1.1.2.2.3.1" xref="S3.E8.m1.6.6.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.6.6.1.1.2.2.3.3" xref="S3.E8.m1.6.6.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.6.6.1.1.2.3" xref="S3.E8.m1.6.6.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.E8.m1.6.6.1.1.1" xref="S3.E8.m1.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mfrac id="S3.E8.m1.2.2a" xref="S3.E8.m1.2.2.cmml"><mn id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml">1</mn><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.cmml"><mi id="S3.E8.m1.2.2.1.3" xref="S3.E8.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.4.2" xref="S3.E8.m1.2.2.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.4.2.1" xref="S3.E8.m1.2.2.1.cmml">(</mo><mi id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E8.m1.2.2.1.4.2.2" xref="S3.E8.m1.2.2.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E8.m1.6.6.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.2.cmml"><munder id="S3.E8.m1.6.6.1.1.1.1.2a" xref="S3.E8.m1.6.6.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E8.m1.6.6.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.2.3.2" xref="S3.E8.m1.6.6.1.1.1.1.2.3.2.cmml">c</mi><mo rspace="0em" id="S3.E8.m1.6.6.1.1.1.1.2.3.1" xref="S3.E8.m1.6.6.1.1.1.1.2.3.1.cmml">∈</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.2.3.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.cmml"><msubsup id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.cmml"><mo lspace="0em" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.2.cmml">∪</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.2" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.1" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.3.cmml">m</mi></msubsup><msub id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.2" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.2.cmml">𝒞</mi><mi id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.3" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.3.cmml">i</mi></msub></mrow></mrow></munder></mstyle><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.2.cmml"><msubsup id="S3.E8.m1.6.6.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><mo lspace="0.167em" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E8.m1.4.4.2.4" xref="S3.E8.m1.4.4.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml">c</mi><mo id="S3.E8.m1.4.4.2.4.1" xref="S3.E8.m1.4.4.2.3.cmml">,</mo><mi id="S3.E8.m1.4.4.2.2" xref="S3.E8.m1.4.4.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E8.m1.6.6.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">τ</mi><mo stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6"><eq id="S3.E8.m1.6.6.2.cmml" xref="S3.E8.m1.6.6.2"></eq><csymbol cd="latexml" id="S3.E8.m1.6.6.3.cmml" xref="S3.E8.m1.6.6.3">absent</csymbol><apply id="S3.E8.m1.6.6.1.cmml" xref="S3.E8.m1.6.6.1"><times id="S3.E8.m1.6.6.1.2.cmml" xref="S3.E8.m1.6.6.1.2"></times><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><divide id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1"></divide><cn type="integer" id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">1</cn><apply id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.3"><abs id="S3.E8.m1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.3.1"></abs><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝒞</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1.1"><apply id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2"></sum><apply id="S3.E8.m1.6.6.1.1.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.3"><eq id="S3.E8.m1.6.6.1.1.2.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.6.6.1.1.2.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E8.m1.6.6.1.1.2.2.3.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.6.6.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.3">𝑀</ci></apply><apply id="S3.E8.m1.6.6.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1"><times id="S3.E8.m1.6.6.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2"></times><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><divide id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2"></divide><cn type="integer" id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3">1</cn><apply id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2.1"><times id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.2"></times><ci id="S3.E8.m1.2.2.1.3.cmml" xref="S3.E8.m1.2.2.1.3">𝜋</ci><ci id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1.1">𝑚</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.2"></sum><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3"><in id="S3.E8.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.1"></in><ci id="S3.E8.m1.6.6.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.2">𝑐</ci><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3"><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1">subscript</csymbol><union id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.2"></union><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3"><eq id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.1"></eq><ci id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.1.3">𝑚</ci></apply><apply id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.2">𝒞</ci><ci id="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E8.m1.4.4.2.3.cmml" xref="S3.E8.m1.4.4.2.4"><ci id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1">𝑐</ci><ci id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2">𝑚</ci></list></apply><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\displaystyle=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\frac{1}{\pi(m)}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.2" class="ltx_p">Note that Eq. <a href="#S3.E8" title="Equation 8 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> resembles Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, which is the FedAvg formulation for EE architectures, except that a subset of clients is used for some of the layers, in particular the upper ones. These results in a weighted combination of the <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">M</annotation></semantics></math> EE losses based on the number of clients fitting the different sub-nets <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{w}(l_{m})" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.2.m2.1.1.1.1.2" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.2.m2.1.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.1.1.1.2" xref="S3.SS3.p4.2.m2.1.1.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p4.2.m2.1.1.1.1.1.3" xref="S3.SS3.p4.2.m2.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p4.2.m2.1.1.1.1.3" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><times id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"></times><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝐰</ci><apply id="S3.SS3.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.p4.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\mathbf{w}(l_{m})</annotation></semantics></math>. Therefore, the equation above can be approximated as a weighted version of Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (see also the example below for a clarification):</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E9.m1.11" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\frac{1}{\pi(m)}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)\approx\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\xi_{m}\sum_{c\in\mathcal{C}}\nabla_{k}^{c,m}(\tau)," display="block"><semantics id="S3.E9.m1.11a"><mrow id="S3.E9.m1.11.11.1" xref="S3.E9.m1.11.11.1.1.cmml"><mrow id="S3.E9.m1.11.11.1.1" xref="S3.E9.m1.11.11.1.1.cmml"><mrow id="S3.E9.m1.11.11.1.1.4" xref="S3.E9.m1.11.11.1.1.4.cmml"><mrow id="S3.E9.m1.11.11.1.1.4.2" xref="S3.E9.m1.11.11.1.1.4.2.cmml"><mo rspace="0.167em" id="S3.E9.m1.11.11.1.1.4.2.1" xref="S3.E9.m1.11.11.1.1.4.2.1.cmml">∇</mo><msub id="S3.E9.m1.11.11.1.1.4.2.2" xref="S3.E9.m1.11.11.1.1.4.2.2.cmml"><mi id="S3.E9.m1.11.11.1.1.4.2.2.2" xref="S3.E9.m1.11.11.1.1.4.2.2.2.cmml">𝐰</mi><mi id="S3.E9.m1.11.11.1.1.4.2.2.3" xref="S3.E9.m1.11.11.1.1.4.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.4.1" xref="S3.E9.m1.11.11.1.1.4.1.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.4.3.2" xref="S3.E9.m1.11.11.1.1.4.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.1.1.4.3.2.1" xref="S3.E9.m1.11.11.1.1.4.cmml">(</mo><mi id="S3.E9.m1.8.8" xref="S3.E9.m1.8.8.cmml">τ</mi><mo stretchy="false" id="S3.E9.m1.11.11.1.1.4.3.2.2" xref="S3.E9.m1.11.11.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.11.11.1.1.5" xref="S3.E9.m1.11.11.1.1.5.cmml">=</mo><mrow id="S3.E9.m1.11.11.1.1.1" xref="S3.E9.m1.11.11.1.1.1.cmml"><mfrac id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mn id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">1</mn><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E9.m1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.cmml"><munderover id="S3.E9.m1.11.11.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.11.11.1.1.1.1.2.2.2" xref="S3.E9.m1.11.11.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.2.2.3" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.11.11.1.1.1.1.2.2.3.2" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E9.m1.11.11.1.1.1.1.2.2.3.1" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.11.11.1.1.1.1.2.2.3.3" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.11.11.1.1.1.1.2.3" xref="S3.E9.m1.11.11.1.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E9.m1.11.11.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.cmml"><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mn id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml">1</mn><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.cmml"><mi id="S3.E9.m1.2.2.1.3" xref="S3.E9.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E9.m1.2.2.1.4.2" xref="S3.E9.m1.2.2.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.4.2.1" xref="S3.E9.m1.2.2.1.cmml">(</mo><mi id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.4.2.2" xref="S3.E9.m1.2.2.1.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.cmml"><munder id="S3.E9.m1.11.11.1.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.2.cmml">c</mi><mo rspace="0em" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.1.cmml">∈</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.cmml"><msubsup id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.cmml"><mo lspace="0em" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.2.cmml">∪</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.cmml"><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.3.cmml">m</mi></msubsup><msub id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.2.cmml">𝒞</mi><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.3.cmml">i</mi></msub></mrow></mrow></munder><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E9.m1.4.4.2.4" xref="S3.E9.m1.4.4.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">c</mi><mo id="S3.E9.m1.4.4.2.4.1" xref="S3.E9.m1.4.4.2.3.cmml">,</mo><mi id="S3.E9.m1.4.4.2.2" xref="S3.E9.m1.4.4.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E9.m1.9.9" xref="S3.E9.m1.9.9.cmml">τ</mi><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.11.11.1.1.6" xref="S3.E9.m1.11.11.1.1.6.cmml">≈</mo><mrow id="S3.E9.m1.11.11.1.1.2" xref="S3.E9.m1.11.11.1.1.2.cmml"><mfrac id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><mn id="S3.E9.m1.5.5.3" xref="S3.E9.m1.5.5.3.cmml">1</mn><mrow id="S3.E9.m1.5.5.1.3" xref="S3.E9.m1.5.5.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.1.3.1" xref="S3.E9.m1.5.5.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1" xref="S3.E9.m1.5.5.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E9.m1.5.5.1.3.2" xref="S3.E9.m1.5.5.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.2.2" xref="S3.E9.m1.11.11.1.1.2.2.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.2.1" xref="S3.E9.m1.11.11.1.1.2.1.cmml"><munderover id="S3.E9.m1.11.11.1.1.2.1.2" xref="S3.E9.m1.11.11.1.1.2.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.11.11.1.1.2.1.2.2.2" xref="S3.E9.m1.11.11.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.11.11.1.1.2.1.2.2.3" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.cmml"><mi id="S3.E9.m1.11.11.1.1.2.1.2.2.3.2" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.2.cmml">m</mi><mo id="S3.E9.m1.11.11.1.1.2.1.2.2.3.1" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.11.11.1.1.2.1.2.2.3.3" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.11.11.1.1.2.1.2.3" xref="S3.E9.m1.11.11.1.1.2.1.2.3.cmml">M</mi></munderover><mrow id="S3.E9.m1.11.11.1.1.2.1.1" xref="S3.E9.m1.11.11.1.1.2.1.1.cmml"><msub id="S3.E9.m1.11.11.1.1.2.1.1.3" xref="S3.E9.m1.11.11.1.1.2.1.1.3.cmml"><mi id="S3.E9.m1.11.11.1.1.2.1.1.3.2" xref="S3.E9.m1.11.11.1.1.2.1.1.3.2.cmml">ξ</mi><mi id="S3.E9.m1.11.11.1.1.2.1.1.3.3" xref="S3.E9.m1.11.11.1.1.2.1.1.3.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.2.1.1.2" xref="S3.E9.m1.11.11.1.1.2.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.2.1.1.1" xref="S3.E9.m1.11.11.1.1.2.1.1.1.cmml"><munder id="S3.E9.m1.11.11.1.1.2.1.1.1.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.11.11.1.1.2.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.cmml"><mi id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.2.cmml">c</mi><mo id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.1" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.3" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.2.cmml"><msubsup id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.3" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E9.m1.7.7.2.4" xref="S3.E9.m1.7.7.2.3.cmml"><mi id="S3.E9.m1.6.6.1.1" xref="S3.E9.m1.6.6.1.1.cmml">c</mi><mo id="S3.E9.m1.7.7.2.4.1" xref="S3.E9.m1.7.7.2.3.cmml">,</mo><mi id="S3.E9.m1.7.7.2.2" xref="S3.E9.m1.7.7.2.2.cmml">m</mi></mrow></msubsup><mrow id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.2.1" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E9.m1.10.10" xref="S3.E9.m1.10.10.cmml">τ</mi><mo stretchy="false" id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.11.11.1.2" xref="S3.E9.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.11b"><apply id="S3.E9.m1.11.11.1.1.cmml" xref="S3.E9.m1.11.11.1"><and id="S3.E9.m1.11.11.1.1a.cmml" xref="S3.E9.m1.11.11.1"></and><apply id="S3.E9.m1.11.11.1.1b.cmml" xref="S3.E9.m1.11.11.1"><eq id="S3.E9.m1.11.11.1.1.5.cmml" xref="S3.E9.m1.11.11.1.1.5"></eq><apply id="S3.E9.m1.11.11.1.1.4.cmml" xref="S3.E9.m1.11.11.1.1.4"><times id="S3.E9.m1.11.11.1.1.4.1.cmml" xref="S3.E9.m1.11.11.1.1.4.1"></times><apply id="S3.E9.m1.11.11.1.1.4.2.cmml" xref="S3.E9.m1.11.11.1.1.4.2"><ci id="S3.E9.m1.11.11.1.1.4.2.1.cmml" xref="S3.E9.m1.11.11.1.1.4.2.1">∇</ci><apply id="S3.E9.m1.11.11.1.1.4.2.2.cmml" xref="S3.E9.m1.11.11.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.4.2.2.1.cmml" xref="S3.E9.m1.11.11.1.1.4.2.2">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.4.2.2.2.cmml" xref="S3.E9.m1.11.11.1.1.4.2.2.2">𝐰</ci><ci id="S3.E9.m1.11.11.1.1.4.2.2.3.cmml" xref="S3.E9.m1.11.11.1.1.4.2.2.3">𝑘</ci></apply></apply><ci id="S3.E9.m1.8.8.cmml" xref="S3.E9.m1.8.8">𝜏</ci></apply><apply id="S3.E9.m1.11.11.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1"><times id="S3.E9.m1.11.11.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.2"></times><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><divide id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"></divide><cn type="integer" id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">1</cn><apply id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.3"><abs id="S3.E9.m1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.3.1"></abs><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝒞</ci></apply></apply><apply id="S3.E9.m1.11.11.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1"><apply id="S3.E9.m1.11.11.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.2.2"></sum><apply id="S3.E9.m1.11.11.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3"><eq id="S3.E9.m1.11.11.1.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.11.11.1.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E9.m1.11.11.1.1.1.1.2.2.3.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.11.11.1.1.1.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E9.m1.11.11.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1"><times id="S3.E9.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.2"></times><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2"></divide><cn type="integer" id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3">1</cn><apply id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.2.2.1"><times id="S3.E9.m1.2.2.1.2.cmml" xref="S3.E9.m1.2.2.1.2"></times><ci id="S3.E9.m1.2.2.1.3.cmml" xref="S3.E9.m1.2.2.1.3">𝜋</ci><ci id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1.1">𝑚</ci></apply></apply><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1"><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.11.11.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.2"></sum><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3"><in id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.1"></in><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.2">𝑐</ci><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3"><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1">superscript</csymbol><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1">subscript</csymbol><union id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.2"></union><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3"><eq id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.1"></eq><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.1.3">𝑚</ci></apply><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.2">𝒞</ci><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1"><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E9.m1.4.4.2.3.cmml" xref="S3.E9.m1.4.4.2.4"><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">𝑐</ci><ci id="S3.E9.m1.4.4.2.2.cmml" xref="S3.E9.m1.4.4.2.2">𝑚</ci></list></apply><ci id="S3.E9.m1.9.9.cmml" xref="S3.E9.m1.9.9">𝜏</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E9.m1.11.11.1.1c.cmml" xref="S3.E9.m1.11.11.1"><approx id="S3.E9.m1.11.11.1.1.6.cmml" xref="S3.E9.m1.11.11.1.1.6"></approx><share href="#S3.E9.m1.11.11.1.1.1.cmml" id="S3.E9.m1.11.11.1.1d.cmml" xref="S3.E9.m1.11.11.1"></share><apply id="S3.E9.m1.11.11.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2"><times id="S3.E9.m1.11.11.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.2.2"></times><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><divide id="S3.E9.m1.5.5.2.cmml" xref="S3.E9.m1.5.5"></divide><cn type="integer" id="S3.E9.m1.5.5.3.cmml" xref="S3.E9.m1.5.5.3">1</cn><apply id="S3.E9.m1.5.5.1.2.cmml" xref="S3.E9.m1.5.5.1.3"><abs id="S3.E9.m1.5.5.1.2.1.cmml" xref="S3.E9.m1.5.5.1.3.1"></abs><ci id="S3.E9.m1.5.5.1.1.cmml" xref="S3.E9.m1.5.5.1.1">𝒞</ci></apply></apply><apply id="S3.E9.m1.11.11.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1"><apply id="S3.E9.m1.11.11.1.1.2.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2">superscript</csymbol><apply id="S3.E9.m1.11.11.1.1.2.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.2.2.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2">subscript</csymbol><sum id="S3.E9.m1.11.11.1.1.2.1.2.2.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.2.2"></sum><apply id="S3.E9.m1.11.11.1.1.2.1.2.2.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3"><eq id="S3.E9.m1.11.11.1.1.2.1.2.2.3.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.1"></eq><ci id="S3.E9.m1.11.11.1.1.2.1.2.2.3.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E9.m1.11.11.1.1.2.1.2.2.3.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.11.11.1.1.2.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.2.3">𝑀</ci></apply><apply id="S3.E9.m1.11.11.1.1.2.1.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1"><times id="S3.E9.m1.11.11.1.1.2.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.2"></times><apply id="S3.E9.m1.11.11.1.1.2.1.1.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.1.3.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.2.1.1.3.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.3.2">𝜉</ci><ci id="S3.E9.m1.11.11.1.1.2.1.1.3.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.3.3">𝑚</ci></apply><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1"><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.11.11.1.1.2.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.2"></sum><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3"><in id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.1"></in><ci id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.2">𝑐</ci><ci id="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1"><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.11.11.1.1.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E9.m1.7.7.2.3.cmml" xref="S3.E9.m1.7.7.2.4"><ci id="S3.E9.m1.6.6.1.1.cmml" xref="S3.E9.m1.6.6.1.1">𝑐</ci><ci id="S3.E9.m1.7.7.2.2.cmml" xref="S3.E9.m1.7.7.2.2">𝑚</ci></list></apply><ci id="S3.E9.m1.10.10.cmml" xref="S3.E9.m1.10.10">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.11c">\nabla\mathbf{w}_{k}(\tau)=\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\frac{1}{\pi(m)}\sum_{c\in\cup_{i=1}^{m}\mathcal{C}_{i}}\nabla_{k}^{c,m}(\tau)\approx\frac{1}{|\mathcal{C}|}\sum_{m=1}^{M}\xi_{m}\sum_{c\in\mathcal{C}}\nabla_{k}^{c,m}(\tau),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.2" class="ltx_p">where the weighting parameter <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="\xi_{m}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><msub id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">ξ</mi><mi id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝜉</ci><ci id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\xi_{m}</annotation></semantics></math> is a function of the number of clients in each set <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{m}" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><msub id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.2.m2.1.1.2" xref="S3.SS3.p6.2.m2.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p6.2.m2.1.1.3" xref="S3.SS3.p6.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p6.2.m2.1.1.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2">𝒞</ci><ci id="S3.SS3.p6.2.m2.1.1.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">\mathcal{C}_{m}</annotation></semantics></math>. Keeping in mind that lower layers are present in all sub-nets fitting higher layers (e.g. layer 1 is always present), we have</p>
</div>
<div id="S3.SS3.p7" class="ltx_para">
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E10.m1.3" class="ltx_Math" alttext="\xi_{m}=\left\{\begin{array}[]{ll}\frac{M-m}{\pi(m)}&amp;|\mathcal{C}_{m}|&gt;0\\
\\
0&amp;|\mathcal{C}_{m}|=0\\
\end{array}\right." display="block"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.4" xref="S3.E10.m1.3.4.cmml"><msub id="S3.E10.m1.3.4.2" xref="S3.E10.m1.3.4.2.cmml"><mi id="S3.E10.m1.3.4.2.2" xref="S3.E10.m1.3.4.2.2.cmml">ξ</mi><mi id="S3.E10.m1.3.4.2.3" xref="S3.E10.m1.3.4.2.3.cmml">m</mi></msub><mo id="S3.E10.m1.3.4.1" xref="S3.E10.m1.3.4.1.cmml">=</mo><mrow id="S3.E10.m1.3.4.3.2" xref="S3.E10.m1.3.4.3.1.cmml"><mo id="S3.E10.m1.3.4.3.2.1" xref="S3.E10.m1.3.4.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml"><mtr id="S3.E10.m1.3.3a" xref="S3.E10.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.3.3b" xref="S3.E10.m1.3.3.cmml"><mstyle displaystyle="false" id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mfrac id="S3.E10.m1.1.1.1.1.1a" xref="S3.E10.m1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.3.2.cmml">M</mi><mo id="S3.E10.m1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.1.3.1.cmml">−</mo><mi id="S3.E10.m1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.3.3.cmml">m</mi></mrow><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.4.2" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.1.4.2.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.1.4.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.3.3c" xref="S3.E10.m1.3.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.1.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.2.1.cmml">|</mo><msub id="S3.E10.m1.2.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.2.2.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.E10.m1.2.2.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E10.m1.2.2.2.2.1.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E10.m1.2.2.2.2.1.2" xref="S3.E10.m1.2.2.2.2.1.2.cmml">&gt;</mo><mn id="S3.E10.m1.2.2.2.2.1.3" xref="S3.E10.m1.2.2.2.2.1.3.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.E10.m1.3.3d" xref="S3.E10.m1.3.3.cmml"><mtd id="S3.E10.m1.3.3e" xref="S3.E10.m1.3.3.cmml"></mtd><mtd id="S3.E10.m1.3.3f" xref="S3.E10.m1.3.3.cmml"></mtd></mtr><mtr id="S3.E10.m1.3.3g" xref="S3.E10.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.3.3h" xref="S3.E10.m1.3.3.cmml"><mn id="S3.E10.m1.3.3.3.2.1" xref="S3.E10.m1.3.3.3.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.3.3i" xref="S3.E10.m1.3.3.cmml"><mrow id="S3.E10.m1.3.3.3.1.1" xref="S3.E10.m1.3.3.3.1.1.cmml"><mrow id="S3.E10.m1.3.3.3.1.1.1.1" xref="S3.E10.m1.3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.3.1.1.1.1.2" xref="S3.E10.m1.3.3.3.1.1.1.2.1.cmml">|</mo><msub id="S3.E10.m1.3.3.3.1.1.1.1.1" xref="S3.E10.m1.3.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.3.3.3.1.1.1.1.1.2" xref="S3.E10.m1.3.3.3.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.E10.m1.3.3.3.1.1.1.1.1.3" xref="S3.E10.m1.3.3.3.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E10.m1.3.3.3.1.1.1.1.3" xref="S3.E10.m1.3.3.3.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E10.m1.3.3.3.1.1.2" xref="S3.E10.m1.3.3.3.1.1.2.cmml">=</mo><mn id="S3.E10.m1.3.3.3.1.1.3" xref="S3.E10.m1.3.3.3.1.1.3.cmml">0</mn></mrow></mtd></mtr></mtable><mi id="S3.E10.m1.3.4.3.2.2" xref="S3.E10.m1.3.4.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.4.cmml" xref="S3.E10.m1.3.4"><eq id="S3.E10.m1.3.4.1.cmml" xref="S3.E10.m1.3.4.1"></eq><apply id="S3.E10.m1.3.4.2.cmml" xref="S3.E10.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.2.1.cmml" xref="S3.E10.m1.3.4.2">subscript</csymbol><ci id="S3.E10.m1.3.4.2.2.cmml" xref="S3.E10.m1.3.4.2.2">𝜉</ci><ci id="S3.E10.m1.3.4.2.3.cmml" xref="S3.E10.m1.3.4.2.3">𝑚</ci></apply><apply id="S3.E10.m1.3.4.3.1.cmml" xref="S3.E10.m1.3.4.3.2"><csymbol cd="latexml" id="S3.E10.m1.3.4.3.1.1.cmml" xref="S3.E10.m1.3.4.3.2.1">cases</csymbol><matrix id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"><matrixrow id="S3.E10.m1.3.3a.cmml" xref="S3.E10.m1.3.3"><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><divide id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1"></divide><apply id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3"><minus id="S3.E10.m1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.3.1"></minus><ci id="S3.E10.m1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.3.2">𝑀</ci><ci id="S3.E10.m1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3">𝜋</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1">𝑚</ci></apply></apply><apply id="S3.E10.m1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.1"><gt id="S3.E10.m1.2.2.2.2.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.2"></gt><apply id="S3.E10.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1"><abs id="S3.E10.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.2"></abs><apply id="S3.E10.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.2">𝒞</ci><ci id="S3.E10.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.3">𝑚</ci></apply></apply><cn type="integer" id="S3.E10.m1.2.2.2.2.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.3">0</cn></apply></matrixrow><matrixrow id="S3.E10.m1.3.3b.cmml" xref="S3.E10.m1.3.3"><cerror id="S3.E10.m1.3.3c.cmml" xref="S3.E10.m1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3d.cmml" xref="S3.E10.m1.3.3">missing-subexpression</csymbol></cerror><cerror id="S3.E10.m1.3.3e.cmml" xref="S3.E10.m1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3f.cmml" xref="S3.E10.m1.3.3">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S3.E10.m1.3.3g.cmml" xref="S3.E10.m1.3.3"><cn type="integer" id="S3.E10.m1.3.3.3.2.1.cmml" xref="S3.E10.m1.3.3.3.2.1">0</cn><apply id="S3.E10.m1.3.3.3.1.1.cmml" xref="S3.E10.m1.3.3.3.1.1"><eq id="S3.E10.m1.3.3.3.1.1.2.cmml" xref="S3.E10.m1.3.3.3.1.1.2"></eq><apply id="S3.E10.m1.3.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1"><abs id="S3.E10.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1.2"></abs><apply id="S3.E10.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1.1.2">𝒞</ci><ci id="S3.E10.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.3.1.1.1.1.1.3">𝑚</ci></apply></apply><cn type="integer" id="S3.E10.m1.3.3.3.1.1.3.cmml" xref="S3.E10.m1.3.3.3.1.1.3">0</cn></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">\xi_{m}=\left\{\begin{array}[]{ll}\frac{M-m}{\pi(m)}&amp;|\mathcal{C}_{m}|&gt;0\\
\\
0&amp;|\mathcal{C}_{m}|=0\\
\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p8" class="ltx_para">
<p id="S3.SS3.p8.1" class="ltx_p">As a consequence, although heterogeneous architectures are non-uniformly distributed along the various FL rounds (e.g. some of them can lack in round <math id="S3.SS3.p8.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p8.1.m1.1a"><mi id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><ci id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">\tau</annotation></semantics></math>, while others can be present many times), we can assume for the gradients an expression formed by the weighted sum of single-exit gradientsOverall, using non-homogeneous EE architectures results in <span id="S3.SS3.p8.1.1" class="ltx_text ltx_font_italic">layer-dependent learning rates</span> that slow down the convergence of the less represented layers but without compromising the convergence, as experimentally shown in section <a href="#S4.SS3" title="4.3 Non-uniform distribution of heterogeneous clients ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E11.m1.1" class="ltx_Math" alttext="\eta_{m}=\xi_{m}\eta\sim\frac{M-m}{\pi(m)}\eta" display="block"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.2" xref="S3.E11.m1.1.2.cmml"><msub id="S3.E11.m1.1.2.2" xref="S3.E11.m1.1.2.2.cmml"><mi id="S3.E11.m1.1.2.2.2" xref="S3.E11.m1.1.2.2.2.cmml">η</mi><mi id="S3.E11.m1.1.2.2.3" xref="S3.E11.m1.1.2.2.3.cmml">m</mi></msub><mo id="S3.E11.m1.1.2.3" xref="S3.E11.m1.1.2.3.cmml">=</mo><mrow id="S3.E11.m1.1.2.4" xref="S3.E11.m1.1.2.4.cmml"><msub id="S3.E11.m1.1.2.4.2" xref="S3.E11.m1.1.2.4.2.cmml"><mi id="S3.E11.m1.1.2.4.2.2" xref="S3.E11.m1.1.2.4.2.2.cmml">ξ</mi><mi id="S3.E11.m1.1.2.4.2.3" xref="S3.E11.m1.1.2.4.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.2.4.1" xref="S3.E11.m1.1.2.4.1.cmml">​</mo><mi id="S3.E11.m1.1.2.4.3" xref="S3.E11.m1.1.2.4.3.cmml">η</mi></mrow><mo id="S3.E11.m1.1.2.5" xref="S3.E11.m1.1.2.5.cmml">∼</mo><mrow id="S3.E11.m1.1.2.6" xref="S3.E11.m1.1.2.6.cmml"><mfrac id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><mrow id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.3.2" xref="S3.E11.m1.1.1.3.2.cmml">M</mi><mo id="S3.E11.m1.1.1.3.1" xref="S3.E11.m1.1.1.3.1.cmml">−</mo><mi id="S3.E11.m1.1.1.3.3" xref="S3.E11.m1.1.1.3.3.cmml">m</mi></mrow><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.3" xref="S3.E11.m1.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.2" xref="S3.E11.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.1.1.1.4.2" xref="S3.E11.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.4.2.1" xref="S3.E11.m1.1.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.4.2.2" xref="S3.E11.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.2.6.1" xref="S3.E11.m1.1.2.6.1.cmml">​</mo><mi id="S3.E11.m1.1.2.6.2" xref="S3.E11.m1.1.2.6.2.cmml">η</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.2.cmml" xref="S3.E11.m1.1.2"><and id="S3.E11.m1.1.2a.cmml" xref="S3.E11.m1.1.2"></and><apply id="S3.E11.m1.1.2b.cmml" xref="S3.E11.m1.1.2"><eq id="S3.E11.m1.1.2.3.cmml" xref="S3.E11.m1.1.2.3"></eq><apply id="S3.E11.m1.1.2.2.cmml" xref="S3.E11.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.2.2.1.cmml" xref="S3.E11.m1.1.2.2">subscript</csymbol><ci id="S3.E11.m1.1.2.2.2.cmml" xref="S3.E11.m1.1.2.2.2">𝜂</ci><ci id="S3.E11.m1.1.2.2.3.cmml" xref="S3.E11.m1.1.2.2.3">𝑚</ci></apply><apply id="S3.E11.m1.1.2.4.cmml" xref="S3.E11.m1.1.2.4"><times id="S3.E11.m1.1.2.4.1.cmml" xref="S3.E11.m1.1.2.4.1"></times><apply id="S3.E11.m1.1.2.4.2.cmml" xref="S3.E11.m1.1.2.4.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.2.4.2.1.cmml" xref="S3.E11.m1.1.2.4.2">subscript</csymbol><ci id="S3.E11.m1.1.2.4.2.2.cmml" xref="S3.E11.m1.1.2.4.2.2">𝜉</ci><ci id="S3.E11.m1.1.2.4.2.3.cmml" xref="S3.E11.m1.1.2.4.2.3">𝑚</ci></apply><ci id="S3.E11.m1.1.2.4.3.cmml" xref="S3.E11.m1.1.2.4.3">𝜂</ci></apply></apply><apply id="S3.E11.m1.1.2c.cmml" xref="S3.E11.m1.1.2"><csymbol cd="latexml" id="S3.E11.m1.1.2.5.cmml" xref="S3.E11.m1.1.2.5">similar-to</csymbol><share href="#S3.E11.m1.1.2.4.cmml" id="S3.E11.m1.1.2d.cmml" xref="S3.E11.m1.1.2"></share><apply id="S3.E11.m1.1.2.6.cmml" xref="S3.E11.m1.1.2.6"><times id="S3.E11.m1.1.2.6.1.cmml" xref="S3.E11.m1.1.2.6.1"></times><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><divide id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1"></divide><apply id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3"><minus id="S3.E11.m1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.3.1"></minus><ci id="S3.E11.m1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.3.2">𝑀</ci><ci id="S3.E11.m1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.3.3">𝑚</ci></apply><apply id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><times id="S3.E11.m1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.2"></times><ci id="S3.E11.m1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.3">𝜋</ci><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑚</ci></apply></apply><ci id="S3.E11.m1.1.2.6.2.cmml" xref="S3.E11.m1.1.2.6.2">𝜂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\eta_{m}=\xi_{m}\eta\sim\frac{M-m}{\pi(m)}\eta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Example of heterogeneous devices</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.2" class="ltx_p">For the sake of clarity, we now report a simple practical example.
In a OFL scenario, one central EE model with <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">M</annotation></semantics></math> exits is trained over <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="|\mathcal{C}|" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.2.2" xref="S3.SS4.p1.2.m2.1.2.1.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.1.2.2.1" xref="S3.SS4.p1.2.m2.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS4.p1.2.m2.1.2.2.2" xref="S3.SS4.p1.2.m2.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.2.2"><abs id="S3.SS4.p1.2.m2.1.2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.2.2.1"></abs><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">|\mathcal{C}|</annotation></semantics></math> clients (assume without losing generality a fixed number of clients per round). The local gradients from every exit equally contribute to the agglomerated gradient of Eq. <a href="#S3.E7" title="Equation 7 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. Instead, in a EFL scenario, the central EE model agglomerates gradients from models with different number of layers: clients fitting more layers contribute to FedAvg with both the gradients of the upmost exits and the lowest ones. As a result, the gradients of the lowest layers are weighted more in the central EE model.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.10" class="ltx_p">For example, consider the case, similar to that depicted in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 Federated Learning with heterogeneous devices ‣ 2 Related Work ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>b),
where 3 EE clients <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{w}^{a}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><msup id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝐰</ci><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathbf{w}^{a}</annotation></semantics></math>, <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{b}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><msup id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">b</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝐰</ci><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathbf{w}^{b}</annotation></semantics></math>, and <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{w}^{c}" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><msup id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝐰</ci><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\mathbf{w}^{c}</annotation></semantics></math> with 1, 2 and 3 exits, respectively, are available.
At round <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mi id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><ci id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\tau</annotation></semantics></math> the gradients of the centralized model <math id="S3.SS4.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{w}_{k}(\tau)" display="inline"><semantics id="S3.SS4.p2.5.m5.1a"><mrow id="S3.SS4.p2.5.m5.1.2" xref="S3.SS4.p2.5.m5.1.2.cmml"><msub id="S3.SS4.p2.5.m5.1.2.2" xref="S3.SS4.p2.5.m5.1.2.2.cmml"><mi id="S3.SS4.p2.5.m5.1.2.2.2" xref="S3.SS4.p2.5.m5.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.5.m5.1.2.2.3" xref="S3.SS4.p2.5.m5.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.5.m5.1.2.1" xref="S3.SS4.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS4.p2.5.m5.1.2.3.2" xref="S3.SS4.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS4.p2.5.m5.1.2.3.2.1" xref="S3.SS4.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.5.m5.1.2.3.2.2" xref="S3.SS4.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.2.cmml" xref="S3.SS4.p2.5.m5.1.2"><times id="S3.SS4.p2.5.m5.1.2.1.cmml" xref="S3.SS4.p2.5.m5.1.2.1"></times><apply id="S3.SS4.p2.5.m5.1.2.2.cmml" xref="S3.SS4.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.2.2.1.cmml" xref="S3.SS4.p2.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.2.2.2.cmml" xref="S3.SS4.p2.5.m5.1.2.2.2">𝐰</ci><ci id="S3.SS4.p2.5.m5.1.2.2.3.cmml" xref="S3.SS4.p2.5.m5.1.2.2.3">𝑘</ci></apply><ci id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">\mathbf{w}_{k}(\tau)</annotation></semantics></math>, according to Eq. <a href="#S3.E6" title="Equation 6 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and <a href="#S3.E7" title="Equation 7 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> are:

<br class="ltx_break"><math id="S3.SS4.p2.6.m6.19" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=\nabla\mathbf{w}^{a,1}_{k}(\tau)+\nabla\mathbf{w}^{b,1}_{k}(\tau)+\nabla\mathbf{w}^{b,2}_{k}(\tau)+\nabla\mathbf{w}^{c,1}_{k}(\tau)+\nabla\mathbf{w}^{c,2}_{k}(\tau)+\nabla\mathbf{w}^{c,3}_{k}(\tau)" display="inline"><semantics id="S3.SS4.p2.6.m6.19a"><mrow id="S3.SS4.p2.6.m6.19.20" xref="S3.SS4.p2.6.m6.19.20.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.2" xref="S3.SS4.p2.6.m6.19.20.2.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.2.2" xref="S3.SS4.p2.6.m6.19.20.2.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.2.2.1" xref="S3.SS4.p2.6.m6.19.20.2.2.1.cmml">∇</mo><msub id="S3.SS4.p2.6.m6.19.20.2.2.2" xref="S3.SS4.p2.6.m6.19.20.2.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.2.2.2.3" xref="S3.SS4.p2.6.m6.19.20.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.2.1" xref="S3.SS4.p2.6.m6.19.20.2.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.2.3.2" xref="S3.SS4.p2.6.m6.19.20.2.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.2.3.2.1" xref="S3.SS4.p2.6.m6.19.20.2.cmml">(</mo><mi id="S3.SS4.p2.6.m6.13.13" xref="S3.SS4.p2.6.m6.13.13.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.2.3.2.2" xref="S3.SS4.p2.6.m6.19.20.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.1" xref="S3.SS4.p2.6.m6.19.20.1.cmml">=</mo><mrow id="S3.SS4.p2.6.m6.19.20.3" xref="S3.SS4.p2.6.m6.19.20.3.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.2" xref="S3.SS4.p2.6.m6.19.20.3.2.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.2.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.2.2.1" xref="S3.SS4.p2.6.m6.19.20.3.2.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.2.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.2.2.2.4" xref="S3.SS4.p2.6.m6.2.2.2.3.cmml"><mi id="S3.SS4.p2.6.m6.1.1.1.1" xref="S3.SS4.p2.6.m6.1.1.1.1.cmml">a</mi><mo id="S3.SS4.p2.6.m6.2.2.2.4.1" xref="S3.SS4.p2.6.m6.2.2.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.2.2.2.2" xref="S3.SS4.p2.6.m6.2.2.2.2.cmml">1</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.2.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.2.3.2" xref="S3.SS4.p2.6.m6.19.20.3.2.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.2.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.2.cmml">(</mo><mi id="S3.SS4.p2.6.m6.14.14" xref="S3.SS4.p2.6.m6.14.14.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.2.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.3.1" xref="S3.SS4.p2.6.m6.19.20.3.1.cmml">+</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.3" xref="S3.SS4.p2.6.m6.19.20.3.3.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.3.2" xref="S3.SS4.p2.6.m6.19.20.3.3.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.3.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.3.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.4.4.2.4" xref="S3.SS4.p2.6.m6.4.4.2.3.cmml"><mi id="S3.SS4.p2.6.m6.3.3.1.1" xref="S3.SS4.p2.6.m6.3.3.1.1.cmml">b</mi><mo id="S3.SS4.p2.6.m6.4.4.2.4.1" xref="S3.SS4.p2.6.m6.4.4.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.4.4.2.2" xref="S3.SS4.p2.6.m6.4.4.2.2.cmml">1</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.3.1" xref="S3.SS4.p2.6.m6.19.20.3.3.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.3.3.2" xref="S3.SS4.p2.6.m6.19.20.3.3.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.3.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.3.cmml">(</mo><mi id="S3.SS4.p2.6.m6.15.15" xref="S3.SS4.p2.6.m6.15.15.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.3.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.3.1a" xref="S3.SS4.p2.6.m6.19.20.3.1.cmml">+</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.4" xref="S3.SS4.p2.6.m6.19.20.3.4.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.4.2" xref="S3.SS4.p2.6.m6.19.20.3.4.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.4.2.1" xref="S3.SS4.p2.6.m6.19.20.3.4.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.4.2.2" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.4.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.6.6.2.4" xref="S3.SS4.p2.6.m6.6.6.2.3.cmml"><mi id="S3.SS4.p2.6.m6.5.5.1.1" xref="S3.SS4.p2.6.m6.5.5.1.1.cmml">b</mi><mo id="S3.SS4.p2.6.m6.6.6.2.4.1" xref="S3.SS4.p2.6.m6.6.6.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.6.6.2.2" xref="S3.SS4.p2.6.m6.6.6.2.2.cmml">2</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.4.1" xref="S3.SS4.p2.6.m6.19.20.3.4.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.4.3.2" xref="S3.SS4.p2.6.m6.19.20.3.4.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.4.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.4.cmml">(</mo><mi id="S3.SS4.p2.6.m6.16.16" xref="S3.SS4.p2.6.m6.16.16.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.4.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.4.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.3.1b" xref="S3.SS4.p2.6.m6.19.20.3.1.cmml">+</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.5" xref="S3.SS4.p2.6.m6.19.20.3.5.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.5.2" xref="S3.SS4.p2.6.m6.19.20.3.5.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.5.2.1" xref="S3.SS4.p2.6.m6.19.20.3.5.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.5.2.2" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.5.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.8.8.2.4" xref="S3.SS4.p2.6.m6.8.8.2.3.cmml"><mi id="S3.SS4.p2.6.m6.7.7.1.1" xref="S3.SS4.p2.6.m6.7.7.1.1.cmml">c</mi><mo id="S3.SS4.p2.6.m6.8.8.2.4.1" xref="S3.SS4.p2.6.m6.8.8.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.8.8.2.2" xref="S3.SS4.p2.6.m6.8.8.2.2.cmml">1</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.5.1" xref="S3.SS4.p2.6.m6.19.20.3.5.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.5.3.2" xref="S3.SS4.p2.6.m6.19.20.3.5.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.5.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.5.cmml">(</mo><mi id="S3.SS4.p2.6.m6.17.17" xref="S3.SS4.p2.6.m6.17.17.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.5.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.5.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.3.1c" xref="S3.SS4.p2.6.m6.19.20.3.1.cmml">+</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.6" xref="S3.SS4.p2.6.m6.19.20.3.6.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.6.2" xref="S3.SS4.p2.6.m6.19.20.3.6.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.6.2.1" xref="S3.SS4.p2.6.m6.19.20.3.6.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.6.2.2" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.6.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.10.10.2.4" xref="S3.SS4.p2.6.m6.10.10.2.3.cmml"><mi id="S3.SS4.p2.6.m6.9.9.1.1" xref="S3.SS4.p2.6.m6.9.9.1.1.cmml">c</mi><mo id="S3.SS4.p2.6.m6.10.10.2.4.1" xref="S3.SS4.p2.6.m6.10.10.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.10.10.2.2" xref="S3.SS4.p2.6.m6.10.10.2.2.cmml">2</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.6.1" xref="S3.SS4.p2.6.m6.19.20.3.6.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.6.3.2" xref="S3.SS4.p2.6.m6.19.20.3.6.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.6.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.6.cmml">(</mo><mi id="S3.SS4.p2.6.m6.18.18" xref="S3.SS4.p2.6.m6.18.18.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.6.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.6.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.6.m6.19.20.3.1d" xref="S3.SS4.p2.6.m6.19.20.3.1.cmml">+</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.7" xref="S3.SS4.p2.6.m6.19.20.3.7.cmml"><mrow id="S3.SS4.p2.6.m6.19.20.3.7.2" xref="S3.SS4.p2.6.m6.19.20.3.7.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.6.m6.19.20.3.7.2.1" xref="S3.SS4.p2.6.m6.19.20.3.7.2.1.cmml">∇</mo><msubsup id="S3.SS4.p2.6.m6.19.20.3.7.2.2" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2.cmml"><mi id="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.2" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.6.m6.19.20.3.7.2.2.3" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2.3.cmml">k</mi><mrow id="S3.SS4.p2.6.m6.12.12.2.4" xref="S3.SS4.p2.6.m6.12.12.2.3.cmml"><mi id="S3.SS4.p2.6.m6.11.11.1.1" xref="S3.SS4.p2.6.m6.11.11.1.1.cmml">c</mi><mo id="S3.SS4.p2.6.m6.12.12.2.4.1" xref="S3.SS4.p2.6.m6.12.12.2.3.cmml">,</mo><mn id="S3.SS4.p2.6.m6.12.12.2.2" xref="S3.SS4.p2.6.m6.12.12.2.2.cmml">3</mn></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.6.m6.19.20.3.7.1" xref="S3.SS4.p2.6.m6.19.20.3.7.1.cmml">​</mo><mrow id="S3.SS4.p2.6.m6.19.20.3.7.3.2" xref="S3.SS4.p2.6.m6.19.20.3.7.cmml"><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.7.3.2.1" xref="S3.SS4.p2.6.m6.19.20.3.7.cmml">(</mo><mi id="S3.SS4.p2.6.m6.19.19" xref="S3.SS4.p2.6.m6.19.19.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.6.m6.19.20.3.7.3.2.2" xref="S3.SS4.p2.6.m6.19.20.3.7.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.19b"><apply id="S3.SS4.p2.6.m6.19.20.cmml" xref="S3.SS4.p2.6.m6.19.20"><eq id="S3.SS4.p2.6.m6.19.20.1.cmml" xref="S3.SS4.p2.6.m6.19.20.1"></eq><apply id="S3.SS4.p2.6.m6.19.20.2.cmml" xref="S3.SS4.p2.6.m6.19.20.2"><times id="S3.SS4.p2.6.m6.19.20.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.2.1"></times><apply id="S3.SS4.p2.6.m6.19.20.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2"><ci id="S3.SS4.p2.6.m6.19.20.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2.2.2">𝐰</ci><ci id="S3.SS4.p2.6.m6.19.20.2.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.13.13.cmml" xref="S3.SS4.p2.6.m6.13.13">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3"><plus id="S3.SS4.p2.6.m6.19.20.3.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.1"></plus><apply id="S3.SS4.p2.6.m6.19.20.3.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2"><times id="S3.SS4.p2.6.m6.19.20.3.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2"><ci id="S3.SS4.p2.6.m6.19.20.3.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.2.2.2.3.cmml" xref="S3.SS4.p2.6.m6.2.2.2.4"><ci id="S3.SS4.p2.6.m6.1.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1.1.1">𝑎</ci><cn type="integer" id="S3.SS4.p2.6.m6.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.2.2.2.2">1</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.2.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.14.14.cmml" xref="S3.SS4.p2.6.m6.14.14">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3"><times id="S3.SS4.p2.6.m6.19.20.3.3.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.3.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2"><ci id="S3.SS4.p2.6.m6.19.20.3.3.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.3.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.3.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.4.4.2.3.cmml" xref="S3.SS4.p2.6.m6.4.4.2.4"><ci id="S3.SS4.p2.6.m6.3.3.1.1.cmml" xref="S3.SS4.p2.6.m6.3.3.1.1">𝑏</ci><cn type="integer" id="S3.SS4.p2.6.m6.4.4.2.2.cmml" xref="S3.SS4.p2.6.m6.4.4.2.2">1</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.3.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.3.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.15.15.cmml" xref="S3.SS4.p2.6.m6.15.15">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.4.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4"><times id="S3.SS4.p2.6.m6.19.20.3.4.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.4.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2"><ci id="S3.SS4.p2.6.m6.19.20.3.4.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.4.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.4.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.6.6.2.3.cmml" xref="S3.SS4.p2.6.m6.6.6.2.4"><ci id="S3.SS4.p2.6.m6.5.5.1.1.cmml" xref="S3.SS4.p2.6.m6.5.5.1.1">𝑏</ci><cn type="integer" id="S3.SS4.p2.6.m6.6.6.2.2.cmml" xref="S3.SS4.p2.6.m6.6.6.2.2">2</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.4.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.4.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.16.16.cmml" xref="S3.SS4.p2.6.m6.16.16">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.5.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5"><times id="S3.SS4.p2.6.m6.19.20.3.5.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.5.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2"><ci id="S3.SS4.p2.6.m6.19.20.3.5.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.5.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.5.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.8.8.2.3.cmml" xref="S3.SS4.p2.6.m6.8.8.2.4"><ci id="S3.SS4.p2.6.m6.7.7.1.1.cmml" xref="S3.SS4.p2.6.m6.7.7.1.1">𝑐</ci><cn type="integer" id="S3.SS4.p2.6.m6.8.8.2.2.cmml" xref="S3.SS4.p2.6.m6.8.8.2.2">1</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.5.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.5.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.17.17.cmml" xref="S3.SS4.p2.6.m6.17.17">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.6.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6"><times id="S3.SS4.p2.6.m6.19.20.3.6.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.6.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2"><ci id="S3.SS4.p2.6.m6.19.20.3.6.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.6.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.6.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.10.10.2.3.cmml" xref="S3.SS4.p2.6.m6.10.10.2.4"><ci id="S3.SS4.p2.6.m6.9.9.1.1.cmml" xref="S3.SS4.p2.6.m6.9.9.1.1">𝑐</ci><cn type="integer" id="S3.SS4.p2.6.m6.10.10.2.2.cmml" xref="S3.SS4.p2.6.m6.10.10.2.2">2</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.6.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.6.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.18.18.cmml" xref="S3.SS4.p2.6.m6.18.18">𝜏</ci></apply><apply id="S3.SS4.p2.6.m6.19.20.3.7.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7"><times id="S3.SS4.p2.6.m6.19.20.3.7.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.1"></times><apply id="S3.SS4.p2.6.m6.19.20.3.7.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2"><ci id="S3.SS4.p2.6.m6.19.20.3.7.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.1">∇</ci><apply id="S3.SS4.p2.6.m6.19.20.3.7.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.7.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2">subscript</csymbol><apply id="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.1.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2">superscript</csymbol><ci id="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.2.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2.2.2">𝐰</ci><list id="S3.SS4.p2.6.m6.12.12.2.3.cmml" xref="S3.SS4.p2.6.m6.12.12.2.4"><ci id="S3.SS4.p2.6.m6.11.11.1.1.cmml" xref="S3.SS4.p2.6.m6.11.11.1.1">𝑐</ci><cn type="integer" id="S3.SS4.p2.6.m6.12.12.2.2.cmml" xref="S3.SS4.p2.6.m6.12.12.2.2">3</cn></list></apply><ci id="S3.SS4.p2.6.m6.19.20.3.7.2.2.3.cmml" xref="S3.SS4.p2.6.m6.19.20.3.7.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.6.m6.19.19.cmml" xref="S3.SS4.p2.6.m6.19.19">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.19c">\nabla\mathbf{w}_{k}(\tau)=\nabla\mathbf{w}^{a,1}_{k}(\tau)+\nabla\mathbf{w}^{b,1}_{k}(\tau)+\nabla\mathbf{w}^{b,2}_{k}(\tau)+\nabla\mathbf{w}^{c,1}_{k}(\tau)+\nabla\mathbf{w}^{c,2}_{k}(\tau)+\nabla\mathbf{w}^{c,3}_{k}(\tau)</annotation></semantics></math>
Note that exit 1 is present three times, exit 2 twice and exit 3 only once. This is equivalent, in Eq. <a href="#S3.E7" title="Equation 7 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, weighting 3 the client <math id="S3.SS4.p2.7.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS4.p2.7.m7.1a"><mi id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><ci id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">a</annotation></semantics></math>, 2 the client <math id="S3.SS4.p2.8.m8.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS4.p2.8.m8.1a"><mi id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><ci id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">b</annotation></semantics></math> and 1 the client <math id="S3.SS4.p2.9.m9.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS4.p2.9.m9.1a"><mi id="S3.SS4.p2.9.m9.1.1" xref="S3.SS4.p2.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m9.1b"><ci id="S3.SS4.p2.9.m9.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m9.1c">c</annotation></semantics></math>, i.e.<math id="S3.SS4.p2.10.m10.7" class="ltx_Math" alttext="\nabla\mathbf{w}_{k}(\tau)=3\times\nabla\mathbf{w}_{k}(\tau,1)+2\times\nabla\mathbf{w}_{k}(\tau,2)+\nabla\mathbf{w}_{k}(\tau,3)" display="inline"><semantics id="S3.SS4.p2.10.m10.7a"><mrow id="S3.SS4.p2.10.m10.7.8" xref="S3.SS4.p2.10.m10.7.8.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.2" xref="S3.SS4.p2.10.m10.7.8.2.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.2.2" xref="S3.SS4.p2.10.m10.7.8.2.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.10.m10.7.8.2.2.1" xref="S3.SS4.p2.10.m10.7.8.2.2.1.cmml">∇</mo><msub id="S3.SS4.p2.10.m10.7.8.2.2.2" xref="S3.SS4.p2.10.m10.7.8.2.2.2.cmml"><mi id="S3.SS4.p2.10.m10.7.8.2.2.2.2" xref="S3.SS4.p2.10.m10.7.8.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.10.m10.7.8.2.2.2.3" xref="S3.SS4.p2.10.m10.7.8.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.10.m10.7.8.2.1" xref="S3.SS4.p2.10.m10.7.8.2.1.cmml">​</mo><mrow id="S3.SS4.p2.10.m10.7.8.2.3.2" xref="S3.SS4.p2.10.m10.7.8.2.cmml"><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.2.3.2.1" xref="S3.SS4.p2.10.m10.7.8.2.cmml">(</mo><mi id="S3.SS4.p2.10.m10.1.1" xref="S3.SS4.p2.10.m10.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.2.3.2.2" xref="S3.SS4.p2.10.m10.7.8.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.10.m10.7.8.1" xref="S3.SS4.p2.10.m10.7.8.1.cmml">=</mo><mrow id="S3.SS4.p2.10.m10.7.8.3" xref="S3.SS4.p2.10.m10.7.8.3.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.3.2" xref="S3.SS4.p2.10.m10.7.8.3.2.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.2.2.cmml"><mn id="S3.SS4.p2.10.m10.7.8.3.2.2.2" xref="S3.SS4.p2.10.m10.7.8.3.2.2.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p2.10.m10.7.8.3.2.2.1" xref="S3.SS4.p2.10.m10.7.8.3.2.2.1.cmml">×</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.2.2.3" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.cmml"><mo rspace="0.167em" id="S3.SS4.p2.10.m10.7.8.3.2.2.3.1" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.1.cmml">∇</mo><msub id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.cmml"><mi id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.3.cmml">k</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.10.m10.7.8.3.2.1" xref="S3.SS4.p2.10.m10.7.8.3.2.1.cmml">​</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.2.3.2" xref="S3.SS4.p2.10.m10.7.8.3.2.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.2.3.2.1" xref="S3.SS4.p2.10.m10.7.8.3.2.3.1.cmml">(</mo><mi id="S3.SS4.p2.10.m10.2.2" xref="S3.SS4.p2.10.m10.2.2.cmml">τ</mi><mo id="S3.SS4.p2.10.m10.7.8.3.2.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.2.3.1.cmml">,</mo><mn id="S3.SS4.p2.10.m10.3.3" xref="S3.SS4.p2.10.m10.3.3.cmml">1</mn><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.2.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.10.m10.7.8.3.1" xref="S3.SS4.p2.10.m10.7.8.3.1.cmml">+</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.3" xref="S3.SS4.p2.10.m10.7.8.3.3.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.3.3.2" xref="S3.SS4.p2.10.m10.7.8.3.3.2.cmml"><mn id="S3.SS4.p2.10.m10.7.8.3.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.3.2.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p2.10.m10.7.8.3.3.2.1" xref="S3.SS4.p2.10.m10.7.8.3.3.2.1.cmml">×</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.cmml"><mo rspace="0.167em" id="S3.SS4.p2.10.m10.7.8.3.3.2.3.1" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.1.cmml">∇</mo><msub id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.cmml"><mi id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.3.cmml">k</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.10.m10.7.8.3.3.1" xref="S3.SS4.p2.10.m10.7.8.3.3.1.cmml">​</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.3.3.2" xref="S3.SS4.p2.10.m10.7.8.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.3.3.2.1" xref="S3.SS4.p2.10.m10.7.8.3.3.3.1.cmml">(</mo><mi id="S3.SS4.p2.10.m10.4.4" xref="S3.SS4.p2.10.m10.4.4.cmml">τ</mi><mo id="S3.SS4.p2.10.m10.7.8.3.3.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.3.3.1.cmml">,</mo><mn id="S3.SS4.p2.10.m10.5.5" xref="S3.SS4.p2.10.m10.5.5.cmml">2</mn><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.3.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.10.m10.7.8.3.1a" xref="S3.SS4.p2.10.m10.7.8.3.1.cmml">+</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.4" xref="S3.SS4.p2.10.m10.7.8.3.4.cmml"><mrow id="S3.SS4.p2.10.m10.7.8.3.4.2" xref="S3.SS4.p2.10.m10.7.8.3.4.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.10.m10.7.8.3.4.2.1" xref="S3.SS4.p2.10.m10.7.8.3.4.2.1.cmml">∇</mo><msub id="S3.SS4.p2.10.m10.7.8.3.4.2.2" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2.cmml"><mi id="S3.SS4.p2.10.m10.7.8.3.4.2.2.2" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.p2.10.m10.7.8.3.4.2.2.3" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.10.m10.7.8.3.4.1" xref="S3.SS4.p2.10.m10.7.8.3.4.1.cmml">​</mo><mrow id="S3.SS4.p2.10.m10.7.8.3.4.3.2" xref="S3.SS4.p2.10.m10.7.8.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.4.3.2.1" xref="S3.SS4.p2.10.m10.7.8.3.4.3.1.cmml">(</mo><mi id="S3.SS4.p2.10.m10.6.6" xref="S3.SS4.p2.10.m10.6.6.cmml">τ</mi><mo id="S3.SS4.p2.10.m10.7.8.3.4.3.2.2" xref="S3.SS4.p2.10.m10.7.8.3.4.3.1.cmml">,</mo><mn id="S3.SS4.p2.10.m10.7.7" xref="S3.SS4.p2.10.m10.7.7.cmml">3</mn><mo stretchy="false" id="S3.SS4.p2.10.m10.7.8.3.4.3.2.3" xref="S3.SS4.p2.10.m10.7.8.3.4.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m10.7b"><apply id="S3.SS4.p2.10.m10.7.8.cmml" xref="S3.SS4.p2.10.m10.7.8"><eq id="S3.SS4.p2.10.m10.7.8.1.cmml" xref="S3.SS4.p2.10.m10.7.8.1"></eq><apply id="S3.SS4.p2.10.m10.7.8.2.cmml" xref="S3.SS4.p2.10.m10.7.8.2"><times id="S3.SS4.p2.10.m10.7.8.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.2.1"></times><apply id="S3.SS4.p2.10.m10.7.8.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2"><ci id="S3.SS4.p2.10.m10.7.8.2.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2.1">∇</ci><apply id="S3.SS4.p2.10.m10.7.8.2.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.7.8.2.2.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.10.m10.7.8.2.2.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2.2.2">𝐰</ci><ci id="S3.SS4.p2.10.m10.7.8.2.2.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.2.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.10.m10.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1">𝜏</ci></apply><apply id="S3.SS4.p2.10.m10.7.8.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3"><plus id="S3.SS4.p2.10.m10.7.8.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.1"></plus><apply id="S3.SS4.p2.10.m10.7.8.3.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2"><times id="S3.SS4.p2.10.m10.7.8.3.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.1"></times><apply id="S3.SS4.p2.10.m10.7.8.3.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2"><times id="S3.SS4.p2.10.m10.7.8.3.2.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.1"></times><cn type="integer" id="S3.SS4.p2.10.m10.7.8.3.2.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.2">3</cn><apply id="S3.SS4.p2.10.m10.7.8.3.2.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3"><ci id="S3.SS4.p2.10.m10.7.8.3.2.2.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.1">∇</ci><apply id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2">subscript</csymbol><ci id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.2">𝐰</ci><ci id="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.2.3.2.3">𝑘</ci></apply></apply></apply><interval closure="open" id="S3.SS4.p2.10.m10.7.8.3.2.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.2.3.2"><ci id="S3.SS4.p2.10.m10.2.2.cmml" xref="S3.SS4.p2.10.m10.2.2">𝜏</ci><cn type="integer" id="S3.SS4.p2.10.m10.3.3.cmml" xref="S3.SS4.p2.10.m10.3.3">1</cn></interval></apply><apply id="S3.SS4.p2.10.m10.7.8.3.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3"><times id="S3.SS4.p2.10.m10.7.8.3.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.1"></times><apply id="S3.SS4.p2.10.m10.7.8.3.3.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2"><times id="S3.SS4.p2.10.m10.7.8.3.3.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.1"></times><cn type="integer" id="S3.SS4.p2.10.m10.7.8.3.3.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.2">2</cn><apply id="S3.SS4.p2.10.m10.7.8.3.3.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3"><ci id="S3.SS4.p2.10.m10.7.8.3.3.2.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.1">∇</ci><apply id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2">subscript</csymbol><ci id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.2">𝐰</ci><ci id="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.2.3.2.3">𝑘</ci></apply></apply></apply><interval closure="open" id="S3.SS4.p2.10.m10.7.8.3.3.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.3.3.2"><ci id="S3.SS4.p2.10.m10.4.4.cmml" xref="S3.SS4.p2.10.m10.4.4">𝜏</ci><cn type="integer" id="S3.SS4.p2.10.m10.5.5.cmml" xref="S3.SS4.p2.10.m10.5.5">2</cn></interval></apply><apply id="S3.SS4.p2.10.m10.7.8.3.4.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4"><times id="S3.SS4.p2.10.m10.7.8.3.4.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.1"></times><apply id="S3.SS4.p2.10.m10.7.8.3.4.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2"><ci id="S3.SS4.p2.10.m10.7.8.3.4.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2.1">∇</ci><apply id="S3.SS4.p2.10.m10.7.8.3.4.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.7.8.3.4.2.2.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2">subscript</csymbol><ci id="S3.SS4.p2.10.m10.7.8.3.4.2.2.2.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2.2">𝐰</ci><ci id="S3.SS4.p2.10.m10.7.8.3.4.2.2.3.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.2.2.3">𝑘</ci></apply></apply><interval closure="open" id="S3.SS4.p2.10.m10.7.8.3.4.3.1.cmml" xref="S3.SS4.p2.10.m10.7.8.3.4.3.2"><ci id="S3.SS4.p2.10.m10.6.6.cmml" xref="S3.SS4.p2.10.m10.6.6">𝜏</ci><cn type="integer" id="S3.SS4.p2.10.m10.7.7.cmml" xref="S3.SS4.p2.10.m10.7.7">3</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m10.7c">\nabla\mathbf{w}_{k}(\tau)=3\times\nabla\mathbf{w}_{k}(\tau,1)+2\times\nabla\mathbf{w}_{k}(\tau,2)+\nabla\mathbf{w}_{k}(\tau,3)</annotation></semantics></math>.
Therefore, the lower sub-nets result enforced after their agglomeration, as if they occur more times in the overall distributed architecture.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Setup</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate our proposed FL framework on TED-LIUM-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> and on the English part of VoxPopuli <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. TED-LIUM-3 includes English TED talks, for a total of 452 hours of speech from 1938 speakers. VoxPopuli is a large-scale multilingual corpus with 1.8K hours of speech. In our experiments, we use the English subset from 1313 speakers.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Following the best practice in literature and in an attempt to make the scenario as realistic as possible, the training set of TED-LIUM-3 and Voxpopuli is split in such a way that each client sees data of a single speaker (this way mimicking personal devices). As observed in previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, training an ASR model from scratch in a federated fashion is not feasible. Therefore we <span id="S4.p2.1.1" class="ltx_text ltx_font_bold">pre-train</span> our model in a centralized way using the whole 960 hours of the Librispeech training set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. Note that, differently from the current literature, this choice implies that we use FL for <span id="S4.p2.1.2" class="ltx_text ltx_font_bold">domain adaptation</span> rather than for fine-tuning on the same domain. Performance is measured in terms of WER on each of the <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">M</annotation></semantics></math> exits of the resulting agglomerated model.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.4" class="ltx_p">For the <span id="S4.p3.4.1" class="ltx_text ltx_font_bold">ASR model<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_medium">1</span></span><span id="footnote1.9" class="ltx_text ltx_font_medium">The code is available at: </span><a target="_blank" href="https://github.com/augustgw/early-exit-transformer" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium">https://github.com/augustgw/early-exit-transformer</a></span></span></span></span>, we use the EE architecture shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. The network takes as input 80 Mel Frequency Cepstral Coefficients (MFCCs). This sequence is passed through two depth-wise convolutional layers, each downsampling the input data by factor <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.p3.1.m1.1a"><mn id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><cn type="integer" id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">2</annotation></semantics></math>, followed by a stack of <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="N=12" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">N</mi><mo id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><eq id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></eq><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">N=12</annotation></semantics></math> conformer layers with <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="M=6" display="inline"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">M</mi><mo id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><eq id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></eq><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝑀</ci><cn type="integer" id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">M=6</annotation></semantics></math> intermediate decoders (one every 2 conformer layers, <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="M=\frac{N}{2}" display="inline"><semantics id="S4.p3.4.m4.1a"><mrow id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">M</mi><mo id="S4.p3.4.m4.1.1.1" xref="S4.p3.4.m4.1.1.1.cmml">=</mo><mfrac id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml"><mi id="S4.p3.4.m4.1.1.3.2" xref="S4.p3.4.m4.1.1.3.2.cmml">N</mi><mn id="S4.p3.4.m4.1.1.3.3" xref="S4.p3.4.m4.1.1.3.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><eq id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1.1"></eq><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝑀</ci><apply id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3"><divide id="S4.p3.4.m4.1.1.3.1.cmml" xref="S4.p3.4.m4.1.1.3"></divide><ci id="S4.p3.4.m4.1.1.3.2.cmml" xref="S4.p3.4.m4.1.1.3.2">𝑁</ci><cn type="integer" id="S4.p3.4.m4.1.1.3.3.cmml" xref="S4.p3.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">M=\frac{N}{2}</annotation></semantics></math>). Each exit is an independent head consisting of a linear layer. The model uses a byte pair encoding (BPE) based tokenizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> with 256 tokens and it is trained using the CTC loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.
Table <a href="#S4.T1" title="Table 1 ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the main hyperparameters of the model and of the training procedure.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.5.1.1" class="ltx_text" style="font-size:129%;">Table 1</span>: </span><span id="S4.T1.6.2" class="ltx_text" style="font-size:129%;">Hyperparameters for the EE architecture shown in Fig.<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b).</span></figcaption>
<table id="S4.T1.7" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.7.1" class="ltx_tr">
<td id="S4.T1.7.1.1" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.1.1" class="ltx_text"></span><span id="S4.T1.7.1.1.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.1.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.1.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.1.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Para.</span></span>
<span id="S4.T1.7.1.1.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(M)</span></span>
</span></span><span id="S4.T1.7.1.1.4" class="ltx_text"></span><span id="S4.T1.7.1.1.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.2.1" class="ltx_text"></span><span id="S4.T1.7.1.2.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.2.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.2.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.2.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Enc.</span></span>
<span id="S4.T1.7.1.2.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">layers</span></span>
</span></span><span id="S4.T1.7.1.2.4" class="ltx_text"></span><span id="S4.T1.7.1.2.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.3" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.3.1" class="ltx_text"></span><span id="S4.T1.7.1.3.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.3.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.3.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.3.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Att.</span></span>
<span id="S4.T1.7.1.3.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">dim.</span></span>
</span></span><span id="S4.T1.7.1.3.4" class="ltx_text"></span><span id="S4.T1.7.1.3.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.7.1.4.1" class="ltx_text" style="font-size:70%;">Heads #</span></td>
<td id="S4.T1.7.1.5" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.5.1" class="ltx_text"></span><span id="S4.T1.7.1.5.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.5.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.5.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.5.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.5.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FF</span></span>
<span id="S4.T1.7.1.5.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.5.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">dim</span></span>
</span></span><span id="S4.T1.7.1.5.4" class="ltx_text"></span><span id="S4.T1.7.1.5.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.6" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.6.1" class="ltx_text"></span><span id="S4.T1.7.1.6.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.6.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.6.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.6.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.6.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Dec.</span></span>
<span id="S4.T1.7.1.6.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.6.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">type</span></span>
</span></span><span id="S4.T1.7.1.6.4" class="ltx_text"></span><span id="S4.T1.7.1.6.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.7.1.7.1" class="ltx_text" style="font-size:70%;">Input</span></td>
<td id="S4.T1.7.1.8" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.7.1.8.1" class="ltx_text" style="font-size:70%;">Loss</span></td>
<td id="S4.T1.7.1.9" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.9.1" class="ltx_text"></span><span id="S4.T1.7.1.9.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.9.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.9.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.9.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.9.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Output</span></span>
<span id="S4.T1.7.1.9.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.9.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">units</span></span>
</span></span><span id="S4.T1.7.1.9.4" class="ltx_text"></span><span id="S4.T1.7.1.9.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T1.7.1.10" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.7.1.10.1" class="ltx_text"></span><span id="S4.T1.7.1.10.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T1.7.1.10.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T1.7.1.10.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.1.10.3.1.1" class="ltx_tr">
<span id="S4.T1.7.1.10.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">LM</span></span>
<span id="S4.T1.7.1.10.3.1.2" class="ltx_tr">
<span id="S4.T1.7.1.10.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">scoring</span></span>
</span></span><span id="S4.T1.7.1.10.4" class="ltx_text"></span><span id="S4.T1.7.1.10.5" class="ltx_text" style="font-size:70%;"></span>
</td>
</tr>
<tr id="S4.T1.7.2" class="ltx_tr">
<td id="S4.T1.7.2.1" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.1.1" class="ltx_text" style="font-size:70%;">31</span></td>
<td id="S4.T1.7.2.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.2.1" class="ltx_text" style="font-size:70%;">12-layers</span></td>
<td id="S4.T1.7.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.3.1" class="ltx_text" style="font-size:70%;">256</span></td>
<td id="S4.T1.7.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.4.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="S4.T1.7.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.5.1" class="ltx_text" style="font-size:70%;">2048</span></td>
<td id="S4.T1.7.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.6.1" class="ltx_text" style="font-size:70%;">Linear</span></td>
<td id="S4.T1.7.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.7.1" class="ltx_text" style="font-size:70%;">80-MFCC</span></td>
<td id="S4.T1.7.2.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.8.1" class="ltx_text" style="font-size:70%;">CTC</span></td>
<td id="S4.T1.7.2.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.9.1" class="ltx_text" style="font-size:70%;">BPE</span></td>
<td id="S4.T1.7.2.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.7.2.10.1" class="ltx_text" style="font-size:70%;">✗</span></td>
</tr>
</table>
</figure>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.2" class="ltx_p">We implement the <span id="S4.p4.2.1" class="ltx_text ltx_font_bold">FL framework<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span id="footnote2.1.1.1" class="ltx_text ltx_font_medium">2</span></span><span id="footnote2.9" class="ltx_text ltx_font_medium">The code is available at: </span><a target="_blank" href="https://github.com/mnabihali/ASR-FL" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium">https://github.com/mnabihali/ASR-FL</a></span></span></span></span> using Flower <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. As mentioned above, we deploy a client for each speaker: 1938 for TED-LIUM-3 and 580 for VoxPopuli. In each round, <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mn id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">10</mn><mo id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">10\%</annotation></semantics></math> of available clients are randomly instantiated for local training, which applies SGD for <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S4.p4.2.m2.1a"><mrow id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mi id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">E</mi><mo id="S4.p4.2.m2.1.1.1" xref="S4.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><eq id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1"></eq><ci id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">E=5</annotation></semantics></math> epochs with learning rate 0.01. These values were empirically chosen to achieve learning efficacy on local data while avoiding overfitting. Models are centrally agglomerated using either <span id="S4.p4.2.2" class="ltx_text ltx_font_bold">FedAvg</span> or <span id="S4.p4.2.3" class="ltx_text ltx_font_bold">FedAdam</span>. In order to speed up the convergence we also consider <span id="S4.p4.2.4" class="ltx_text ltx_font_bold">freezing the convolutional front-end</span>, as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">Finally, we consider two FL scenarios: OFL) the traditional one, where <span id="S4.p5.1.1" class="ltx_text ltx_font_bold">homogeneous</span> models are deployed on the clients (i.e. the full EE architecture), that is our FL upper-bound; EFL) the case where devices are <span id="S4.p5.1.2" class="ltx_text ltx_font_bold">heterogeneous</span> and the number of available exits randomly varies across clients and rounds. For the latter case, which is the scenario of interest in our work, we simulate 3 conditions: 1) <span id="S4.p5.1.3" class="ltx_text ltx_font_italic">uniform</span> distributions of the sub-nets on the clients (i.e. each sub-net has probability <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="\frac{1}{M}" display="inline"><semantics id="S4.p5.1.m1.1a"><mfrac id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml"><mn id="S4.p5.1.m1.1.1.2" xref="S4.p5.1.m1.1.1.2.cmml">1</mn><mi id="S4.p5.1.m1.1.1.3" xref="S4.p5.1.m1.1.1.3.cmml">M</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><apply id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1"><divide id="S4.p5.1.m1.1.1.1.cmml" xref="S4.p5.1.m1.1.1"></divide><cn type="integer" id="S4.p5.1.m1.1.1.2.cmml" xref="S4.p5.1.m1.1.1.2">1</cn><ci id="S4.p5.1.m1.1.1.3.cmml" xref="S4.p5.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">\frac{1}{M}</annotation></semantics></math>); 2) <span id="S4.p5.1.4" class="ltx_text ltx_font_italic">non uniform</span> distributions where smaller sub-nets are more likely; 3) <span id="S4.p5.1.5" class="ltx_text ltx_font_italic">extreme non uniform</span> distribution where highest exits are rarely available.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Results</h3>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.7.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.8.2" class="ltx_text" style="font-size:90%;">Three leftmost columns: WER of the model pre-trained on Librispeech and evaluated on Librispeech, TED-LIUM-3 and VoxPopuli. The 4th and 5th columns report the FL performance using FedAdam and the frozen convolutional front-end on TED-LIUM-3 and VoxPopuli. The last two columns report the upper-bound performance when training on TED-LIUM-3 and Voxpopuli in a centralized way.</span></figcaption>
<table id="S4.T2.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.3.3" class="ltx_tr">
<td id="S4.T2.3.3.4" class="ltx_td ltx_border_tt"></td>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Librispeech-960<sup id="S4.T2.1.1.1.1.1" class="ltx_sup"><span id="S4.T2.1.1.1.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">∗</span></sup></span></td>
<td id="S4.T2.3.3.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T2.3.3.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">FedAdam-Hetero-Freeze</span></td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">TED-LIUM-3<sup id="S4.T2.2.2.2.1.1" class="ltx_sup"><span id="S4.T2.2.2.2.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">†</span></sup></span></td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.3.3.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Voxpopuli<sup id="S4.T2.3.3.3.1.1" class="ltx_sup"><span id="S4.T2.3.3.3.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">†</span></sup></span></td>
</tr>
<tr id="S4.T2.5.6" class="ltx_tr">
<td id="S4.T2.5.6.1" class="ltx_td ltx_align_center"><span id="S4.T2.5.6.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Exit</span></td>
<td id="S4.T2.5.6.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.2.1" class="ltx_text"></span><span id="S4.T2.5.6.2.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.2.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.2.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.2.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Libri</span></span>
<span id="S4.T2.5.6.2.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Test-Clean</span></span>
</span></span><span id="S4.T2.5.6.2.4" class="ltx_text"></span><span id="S4.T2.5.6.2.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.3.1" class="ltx_text"></span><span id="S4.T2.5.6.3.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.3.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.3.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.3.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">TED</span></span>
<span id="S4.T2.5.6.3.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Test</span></span>
</span></span><span id="S4.T2.5.6.3.4" class="ltx_text"></span><span id="S4.T2.5.6.3.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.4.1" class="ltx_text"></span><span id="S4.T2.5.6.4.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.4.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.4.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.4.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.4.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Vox</span></span>
<span id="S4.T2.5.6.4.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.4.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Test</span></span>
</span></span><span id="S4.T2.5.6.4.4" class="ltx_text"></span><span id="S4.T2.5.6.4.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.5" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.5.1" class="ltx_text"></span><span id="S4.T2.5.6.5.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.5.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.5.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.5.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.5.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">TED-Test</span></span>
<span id="S4.T2.5.6.5.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.5.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">1650 rounds</span></span>
</span></span><span id="S4.T2.5.6.5.4" class="ltx_text"></span><span id="S4.T2.5.6.5.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.6.1" class="ltx_text"></span><span id="S4.T2.5.6.6.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.6.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.6.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.6.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.6.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Vox-Test</span></span>
<span id="S4.T2.5.6.6.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.6.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">4000 rounds</span></span>
</span></span><span id="S4.T2.5.6.6.4" class="ltx_text"></span><span id="S4.T2.5.6.6.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.7" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.7.1" class="ltx_text"></span><span id="S4.T2.5.6.7.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.7.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.7.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.7.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.7.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">TED</span></span>
<span id="S4.T2.5.6.7.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.7.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Test</span></span>
</span></span><span id="S4.T2.5.6.7.4" class="ltx_text"></span><span id="S4.T2.5.6.7.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T2.5.6.8" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T2.5.6.8.1" class="ltx_text"></span><span id="S4.T2.5.6.8.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T2.5.6.8.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T2.5.6.8.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.5.6.8.3.1.1" class="ltx_tr">
<span id="S4.T2.5.6.8.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Vox</span></span>
<span id="S4.T2.5.6.8.3.1.2" class="ltx_tr">
<span id="S4.T2.5.6.8.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Test</span></span>
</span></span><span id="S4.T2.5.6.8.4" class="ltx_text"></span><span id="S4.T2.5.6.8.5" class="ltx_text" style="font-size:70%;"></span>
</td>
</tr>
<tr id="S4.T2.5.7" class="ltx_tr">
<td id="S4.T2.5.7.1" class="ltx_td ltx_align_center"><span id="S4.T2.5.7.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1</span></td>
<td id="S4.T2.5.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.2.1" class="ltx_text" style="font-size:70%;">24.10</span></td>
<td id="S4.T2.5.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.3.1" class="ltx_text" style="font-size:70%;">50.94</span></td>
<td id="S4.T2.5.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.4.1" class="ltx_text" style="font-size:70%;">62.91</span></td>
<td id="S4.T2.5.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.5.1" class="ltx_text" style="font-size:70%;">45.20</span></td>
<td id="S4.T2.5.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.6.1" class="ltx_text" style="font-size:70%;">43.36</span></td>
<td id="S4.T2.5.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.7.1" class="ltx_text" style="font-size:70%;">43.8</span></td>
<td id="S4.T2.5.7.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.7.8.1" class="ltx_text" style="font-size:70%;">36.7</span></td>
</tr>
<tr id="S4.T2.5.8" class="ltx_tr">
<td id="S4.T2.5.8.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">2</span></td>
<td id="S4.T2.5.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.2.1" class="ltx_text" style="font-size:70%;">11.78</span></td>
<td id="S4.T2.5.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.3.1" class="ltx_text" style="font-size:70%;">34.50</span></td>
<td id="S4.T2.5.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.4.1" class="ltx_text" style="font-size:70%;">40.10</span></td>
<td id="S4.T2.5.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.5.1" class="ltx_text" style="font-size:70%;">29.92</span></td>
<td id="S4.T2.5.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.6.1" class="ltx_text" style="font-size:70%;">26.73</span></td>
<td id="S4.T2.5.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.7.1" class="ltx_text" style="font-size:70%;">23.4</span></td>
<td id="S4.T2.5.8.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.8.8.1" class="ltx_text" style="font-size:70%;">21.1</span></td>
</tr>
<tr id="S4.T2.5.9" class="ltx_tr">
<td id="S4.T2.5.9.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">3</span></td>
<td id="S4.T2.5.9.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.2.1" class="ltx_text" style="font-size:70%;">6.91</span></td>
<td id="S4.T2.5.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.3.1" class="ltx_text" style="font-size:70%;">29.58</span></td>
<td id="S4.T2.5.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.4.1" class="ltx_text" style="font-size:70%;">33.17</span></td>
<td id="S4.T2.5.9.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.5.1" class="ltx_text" style="font-size:70%;">24.16</span></td>
<td id="S4.T2.5.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.6.1" class="ltx_text" style="font-size:70%;">20.95</span></td>
<td id="S4.T2.5.9.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.7.1" class="ltx_text" style="font-size:70%;">18.0</span></td>
<td id="S4.T2.5.9.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.9.8.1" class="ltx_text" style="font-size:70%;">17.3</span></td>
</tr>
<tr id="S4.T2.5.10" class="ltx_tr">
<td id="S4.T2.5.10.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">4</span></td>
<td id="S4.T2.5.10.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.2.1" class="ltx_text" style="font-size:70%;">6.28</span></td>
<td id="S4.T2.5.10.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.3.1" class="ltx_text" style="font-size:70%;">28.61</span></td>
<td id="S4.T2.5.10.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.4.1" class="ltx_text" style="font-size:70%;">31.57</span></td>
<td id="S4.T2.5.10.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.5.1" class="ltx_text" style="font-size:70%;">23.22</span></td>
<td id="S4.T2.5.10.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.6.1" class="ltx_text" style="font-size:70%;">19.64</span></td>
<td id="S4.T2.5.10.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.7.1" class="ltx_text" style="font-size:70%;">16.1</span></td>
<td id="S4.T2.5.10.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.10.8.1" class="ltx_text" style="font-size:70%;">15.4</span></td>
</tr>
<tr id="S4.T2.5.11" class="ltx_tr">
<td id="S4.T2.5.11.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">5</span></td>
<td id="S4.T2.5.11.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.2.1" class="ltx_text" style="font-size:70%;">7.30</span></td>
<td id="S4.T2.5.11.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.3.1" class="ltx_text" style="font-size:70%;">28.79</span></td>
<td id="S4.T2.5.11.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.4.1" class="ltx_text" style="font-size:70%;">30.89</span></td>
<td id="S4.T2.5.11.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.5.1" class="ltx_text" style="font-size:70%;">23.13</span></td>
<td id="S4.T2.5.11.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.6.1" class="ltx_text" style="font-size:70%;">18.98</span></td>
<td id="S4.T2.5.11.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.7.1" class="ltx_text" style="font-size:70%;">14.9</span></td>
<td id="S4.T2.5.11.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.11.8.1" class="ltx_text" style="font-size:70%;">14.7</span></td>
</tr>
<tr id="S4.T2.5.12" class="ltx_tr">
<td id="S4.T2.5.12.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">6</span></td>
<td id="S4.T2.5.12.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.2.1" class="ltx_text" style="font-size:70%;">5.34</span></td>
<td id="S4.T2.5.12.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.3.1" class="ltx_text" style="font-size:70%;">27.35</span></td>
<td id="S4.T2.5.12.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.4.1" class="ltx_text" style="font-size:70%;">30.26</span></td>
<td id="S4.T2.5.12.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.5.1" class="ltx_text" style="font-size:70%;">21.70</span></td>
<td id="S4.T2.5.12.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.6.1" class="ltx_text" style="font-size:70%;">18.06</span></td>
<td id="S4.T2.5.12.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.7.1" class="ltx_text" style="font-size:70%;">14.6</span></td>
<td id="S4.T2.5.12.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.12.8.1" class="ltx_text" style="font-size:70%;">14.3</span></td>
</tr>
<tr id="S4.T2.4.4" class="ltx_tr">
<td id="S4.T2.4.4.1" class="ltx_td ltx_align_left ltx_border_tt" colspan="8">
<sup id="S4.T2.4.4.1.1" class="ltx_sup"><span id="S4.T2.4.4.1.1.1" class="ltx_text ltx_font_italic" style="font-size:80%;">∗</span></sup><span id="S4.T2.4.4.1.2" class="ltx_text" style="font-size:80%;"> This model was used as an initial starting model for all federated learning experiments.</span>
</td>
</tr>
<tr id="S4.T2.5.5" class="ltx_tr">
<td id="S4.T2.5.5.1" class="ltx_td ltx_align_left" colspan="8">
<math id="S4.T2.5.5.1.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="S4.T2.5.5.1.m1.1a"><mo mathsize="80%" id="S4.T2.5.5.1.m1.1.1" xref="S4.T2.5.5.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.m1.1b"><ci id="S4.T2.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.1.m1.1c">\dagger</annotation></semantics></math><span id="S4.T2.5.5.1.1" class="ltx_text" style="font-size:80%;"> Upper-bound WER with centralized training.</span>
</td>
</tr>
</table>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The results of our experimental analysis are reported in Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Experimental Results ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in terms of WER for each exit, comparing our proposed FL approach for heterogeneous devices with central training. The three leftmost columns report the performance of the model pre-trained on Librispeech. The first column shows the performance on the Librispeech test-clean set, confirming that our architecture is a reasonable baseline in comparison with the state of the art (note that in order to save computation time we have adopted a quite small model in the experiments and we didn’t apply data augmentation in training). The second and third columns report the WER achieved by the Librispeech pre-trained model on TED-LIUM-3 and VoxPopuli. This is our starting point, on which we apply our FL approach. The last two columns reports our upper-bound, given by the model trained from scratch in a centralized way. Finally, the results of our FL approach using heterogeneous models with FedAdam and freezing the convolutional layers are reported in the fourth and fifth columns. Note that, using the EE architecture, even if not all the subnets are always available at all clients, we can improve the model performance towards the new domain for all exits, approaching the performance of the model centrally trained. Due to the heavy computational cost of simulating a federated infrastructure, we could not achieve full convergence of the models, however the trends are clear.
In the following sections, we provide more details on some specific aspects of our framework.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Heterogeneous vs Homogeneous devices</h3>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2405.17376/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">WER achieved on TED-LIUM-3 with homogeneous and heterogeneous devices, using FedAvg and FedAdam during the first 200 FL rounds. Each figure refers to one exit. Heterogeneous models are uniformly distributed.</span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The fundamental claim of our work, mathematically demonstrated in Section <a href="#S3.SS2" title="3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, is that using EE architectures we can train the full model even if only part of that is available in some of the clients due to device heterogeneity. In Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Heterogeneous vs Homogeneous devices ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we provide more details on the proposed approach, comparing WER trends of both OFL and EFL along the FL rounds for all the 6 exits (each sub-figure refers to a single exit, top left is the lowest exit, bottom right the last one), aggregating either with FedAdam or FedAvg. Note that in this case the heterogeneous models are uniformly distributed on the clients. The first interesting result is that agglomerating the models with standard FL strategies (i.e. with both FedAvg and FedAdam) is viable, for all exits, even in EFL conditions. Note that the performance for both homogeneous and heterogeneous models are very similar for all exits and for both agglomeration methods. This confirms the efficacy of EE architectures in this scenario as well as our claim. Furthermore, similarly to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>, the figure clearly exhibits the superior performance of FedAdam (green and red lines) with respect to FedAvg (black and yellow), both in terms of WERs and convergence speed.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2405.17376/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Comparison of the WER achieved with FedAdam on TED-LIUM-3 with (pink and pale colors) and without (red and green colors) freezing the convolutional front-end.</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Heterogeneous vs Homogeneous devices ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the beneficial impact of freezing the convolutional layers of the model: the pink and pale-blue lines are well below the other two, for all exits and both OFL and EFL. It is worth mentioning that freezing the convolutional front-end and training only the encoder-decoder part is a common practice in ASR when fine-tuning pre-trained models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Finally, Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2 Heterogeneous vs Homogeneous devices ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> supports our proposed approach confirming the convergence trends observed so far also on VoxPopuli, for both EFL and OFL.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2405.17376/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Comparison of the WER achieved on VoxPopuli with freezing the convolutional front-end for ELF and OFL.</span></figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Non-uniform distribution of heterogeneous clients</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p">The experiments reported above consider a rather ideal case where the different sub-nets <math id="S4.SS3.p1.1.m1.2" class="ltx_Math" alttext="\mathbf{w}(\tau,l_{m})" display="inline"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml"><mi id="S4.SS3.p1.1.m1.2.2.3" xref="S4.SS3.p1.1.m1.2.2.3.cmml">𝐰</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.2.2.2" xref="S4.SS3.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S4.SS3.p1.1.m1.2.2.1.1" xref="S4.SS3.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.2.2.1.1.2" xref="S4.SS3.p1.1.m1.2.2.1.2.cmml">(</mo><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">τ</mi><mo id="S4.SS3.p1.1.m1.2.2.1.1.3" xref="S4.SS3.p1.1.m1.2.2.1.2.cmml">,</mo><msub id="S4.SS3.p1.1.m1.2.2.1.1.1" xref="S4.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.2.2.1.1.1.2" xref="S4.SS3.p1.1.m1.2.2.1.1.1.2.cmml">l</mi><mi id="S4.SS3.p1.1.m1.2.2.1.1.1.3" xref="S4.SS3.p1.1.m1.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S4.SS3.p1.1.m1.2.2.1.1.4" xref="S4.SS3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><apply id="S4.SS3.p1.1.m1.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2"><times id="S4.SS3.p1.1.m1.2.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2.2"></times><ci id="S4.SS3.p1.1.m1.2.2.3.cmml" xref="S4.SS3.p1.1.m1.2.2.3">𝐰</ci><interval closure="open" id="S4.SS3.p1.1.m1.2.2.1.2.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝜏</ci><apply id="S4.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1.2">𝑙</ci><ci id="S4.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">\mathbf{w}(\tau,l_{m})</annotation></semantics></math> are uniformly distributed across the clients. This implies that the central server receives enough updates for the upper exits. However, in practical scenarios, we may expect that a large number of participating devices offer limited resources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. This leads to an unbalanced device heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. To mimic this more realistic scenario, we simulate non-uniform distributions of the devices where the clients fitting the first exists are more frequent. This non-uniform distribution of clients can significantly impact the FL process as it affects the weights <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\xi_{m}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">ξ</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝜉</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\xi_{m}</annotation></semantics></math> in Eq. <a href="#S3.E11" title="Equation 11 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> via the ratio <math id="S4.SS3.p1.3.m3.2" class="ltx_Math" alttext="|\mathcal{C}_{m}|/|\mathcal{C}|" display="inline"><semantics id="S4.SS3.p1.3.m3.2a"><mrow id="S4.SS3.p1.3.m3.2.2" xref="S4.SS3.p1.3.m3.2.2.cmml"><mrow id="S4.SS3.p1.3.m3.2.2.1.1" xref="S4.SS3.p1.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.1.1.2" xref="S4.SS3.p1.3.m3.2.2.1.2.1.cmml">|</mo><msub id="S4.SS3.p1.3.m3.2.2.1.1.1" xref="S4.SS3.p1.3.m3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.3.m3.2.2.1.1.1.2" xref="S4.SS3.p1.3.m3.2.2.1.1.1.2.cmml">𝒞</mi><mi id="S4.SS3.p1.3.m3.2.2.1.1.1.3" xref="S4.SS3.p1.3.m3.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.1.1.3" xref="S4.SS3.p1.3.m3.2.2.1.2.1.cmml">|</mo></mrow><mo id="S4.SS3.p1.3.m3.2.2.2" xref="S4.SS3.p1.3.m3.2.2.2.cmml">/</mo><mrow id="S4.SS3.p1.3.m3.2.2.3.2" xref="S4.SS3.p1.3.m3.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.3.2.1" xref="S4.SS3.p1.3.m3.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">𝒞</mi><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.3.2.2" xref="S4.SS3.p1.3.m3.2.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.2b"><apply id="S4.SS3.p1.3.m3.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2"><divide id="S4.SS3.p1.3.m3.2.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2"></divide><apply id="S4.SS3.p1.3.m3.2.2.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1"><abs id="S4.SS3.p1.3.m3.2.2.1.2.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.2"></abs><apply id="S4.SS3.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.1.2">𝒞</ci><ci id="S4.SS3.p1.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.1.3">𝑚</ci></apply></apply><apply id="S4.SS3.p1.3.m3.2.2.3.1.cmml" xref="S4.SS3.p1.3.m3.2.2.3.2"><abs id="S4.SS3.p1.3.m3.2.2.3.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.3.2.1"></abs><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.2c">|\mathcal{C}_{m}|/|\mathcal{C}|</annotation></semantics></math>. As seen in Sec. <a href="#S3" title="3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, low probabilities for the upper exits feed the central server with few (or even none) observations for adapting the upper attention blocks of the encoder with the related linear decoders. In particular, we consider 2 scenarios using the probability distributions depicted in Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.3 Non-uniform distribution of heterogeneous clients ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (from 1 to <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">M</annotation></semantics></math>): a <span id="S4.SS3.p1.4.1" class="ltx_text ltx_font_italic">regular</span> distribution where 80% of the clients cover the first 3 exits and an <span id="S4.SS3.p1.4.2" class="ltx_text ltx_font_italic">extreme</span> distribution where the 80% of the clients feature only the first exit.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2405.17376/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="242" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.3.2" class="ltx_text" style="font-size:90%;">The regular and extreme non-uniform clients distributions.</span></figcaption>
</figure>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2405.17376/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.3.2" class="ltx_text" style="font-size:90%;">WER achieved with FedAdam in case of uniform and non-uniform heterogeneous clients distributions on TED-LIUM-3.</span></figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">Figure <a href="#S4.F7" title="Figure 7 ‣ 4.3 Non-uniform distribution of heterogeneous clients ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> reports the WER results across different FL rounds for the uniform (black) and the 2 non-uniform distributions (yellow and green).
Note that, in the non-uniform scenario, the first exit converges faster than in the uniform case as <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="40\%" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mn id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">40</mn><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">40\%</annotation></semantics></math> of clients (<math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="80\%" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mn id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">80</mn><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">80\%</annotation></semantics></math> in the extreme case) train this exit only, which is also trained in all other clients. Therefore, the training is heavily focused on improving that part of the network. Conversely, the model convergence in upper exits is definitely slower. Nevertheless, it is still possible to train those upper exists and improve the recognition performance. The figure confirms the fact that the non-uniform heterogeneous scenario leads to a sub-net dependent learning rate as in Eq. <a href="#S3.E11" title="Equation 11 ‣ 3.3 Federated Learning with Early-Exits on heterogeneous devices ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">These latter results may seem rather counter-intuitive: if the lower encoders are trained without accounting for the upper ones, we would expect that the performance of the upper exits deteriorates. Instead, it appears that improving the lower attention blocks is beneficial (or not detrimental) for the upper layers too, as long as the model is sufficiently trained.
We experimentally verified this by performing central training on Librispeech and fine-tuning using only the exits lower than 2 (<math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="m&lt;2" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">m</mi><mo id="S4.SS3.p3.1.m1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><lt id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"></lt><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">m&lt;2</annotation></semantics></math>) in the compound loss of Eq. <a href="#S3.E3" title="Equation 3 ‣ 3.2 Federated Learning with Early-Exit models ‣ 3 Proposed Approach ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The results are reported in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Non-uniform distribution of heterogeneous clients ‣ 4 Experimental Setup ‣ Federating Dynamic Models using Early-Exit Architectures for Automatic Speech Recognition on Heterogeneous Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for all of the 6 exits. We consider the following training conditions: <span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_italic">a)</span> training from scratch, <span id="S4.SS3.p3.1.2" class="ltx_text ltx_font_italic">b)</span> fine-tuning from a model pre-trained on 960 hour of Librispeech and <span id="S4.SS3.p3.1.3" class="ltx_text ltx_font_italic">c)</span> fine-tuning from a model pre-trained on 100 hours of Librispeech. For the latter 2 cases, the table reports the initial performance and the performance reached after fine-tuning for 100 epochs (the relative improvements are shown in parenthesis).
As expected training from scratch improves the performance of only the first two exits. Conversely, if the model is reasonably pre-trained, fine-tuning only the lower exits does not compromise the performance of the upper ones.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.3.2" class="ltx_text" style="font-size:90%;">Performance obtained on Librispeech test-clean data set with central training, starting from different initial checkpoints (also from scratch) and fine-tuning only the first two exits of the EE model with SGD.</span></figcaption>
<table id="S4.T3.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T3.4.1" class="ltx_tr">
<td id="S4.T3.4.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.4.1.2" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T3.4.1.2.1" class="ltx_text"></span><span id="S4.T3.4.1.2.2" class="ltx_text ltx_font_bold" style="font-size:70%;"> <span id="S4.T3.4.1.2.2.1" class="ltx_text">
<span id="S4.T3.4.1.2.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.4.1.2.2.1.1.1" class="ltx_tr">
<span id="S4.T3.4.1.2.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">From</span></span>
<span id="S4.T3.4.1.2.2.1.1.2" class="ltx_tr">
<span id="S4.T3.4.1.2.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Scratch</span></span>
</span></span><span id="S4.T3.4.1.2.2.2" class="ltx_text"></span></span>
</td>
<td id="S4.T3.4.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">
<span id="S4.T3.4.1.3.1" class="ltx_text"></span><span id="S4.T3.4.1.3.2" class="ltx_text ltx_font_bold" style="font-size:70%;"> <span id="S4.T3.4.1.3.2.1" class="ltx_text">
<span id="S4.T3.4.1.3.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.4.1.3.2.1.1.1" class="ltx_tr">
<span id="S4.T3.4.1.3.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Librispeech</span></span>
<span id="S4.T3.4.1.3.2.1.1.2" class="ltx_tr">
<span id="S4.T3.4.1.3.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">960h</span></span>
</span></span><span id="S4.T3.4.1.3.2.2" class="ltx_text"></span></span>
</td>
<td id="S4.T3.4.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">
<span id="S4.T3.4.1.4.1" class="ltx_text"></span><span id="S4.T3.4.1.4.2" class="ltx_text ltx_font_bold" style="font-size:70%;"> <span id="S4.T3.4.1.4.2.1" class="ltx_text">
<span id="S4.T3.4.1.4.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.4.1.4.2.1.1.1" class="ltx_tr">
<span id="S4.T3.4.1.4.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Librispeech</span></span>
<span id="S4.T3.4.1.4.2.1.1.2" class="ltx_tr">
<span id="S4.T3.4.1.4.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">100 h</span></span>
</span></span><span id="S4.T3.4.1.4.2.2" class="ltx_text"></span></span>
</td>
</tr>
<tr id="S4.T3.4.2" class="ltx_tr">
<td id="S4.T3.4.2.1" class="ltx_td ltx_align_left"><span id="S4.T3.4.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Exit</span></td>
<td id="S4.T3.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.2.2.1" class="ltx_text" style="font-size:70%;">fine-tuned</span></td>
<td id="S4.T3.4.2.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T3.4.2.3.1" class="ltx_text"></span><span id="S4.T3.4.2.3.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T3.4.2.3.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T3.4.2.3.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.4.2.3.3.1.1" class="ltx_tr">
<span id="S4.T3.4.2.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Initial</span></span>
<span id="S4.T3.4.2.3.3.1.2" class="ltx_tr">
<span id="S4.T3.4.2.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Perform.</span></span>
</span></span><span id="S4.T3.4.2.3.4" class="ltx_text"></span><span id="S4.T3.4.2.3.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T3.4.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.2.4.1" class="ltx_text" style="font-size:70%;">fine-tuned</span></td>
<td id="S4.T3.4.2.5" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T3.4.2.5.1" class="ltx_text"></span><span id="S4.T3.4.2.5.2" class="ltx_text" style="font-size:70%;"> </span><span id="S4.T3.4.2.5.3" class="ltx_text" style="font-size:70%;">
<span id="S4.T3.4.2.5.3.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.4.2.5.3.1.1" class="ltx_tr">
<span id="S4.T3.4.2.5.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Initial</span></span>
<span id="S4.T3.4.2.5.3.1.2" class="ltx_tr">
<span id="S4.T3.4.2.5.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Perform.</span></span>
</span></span><span id="S4.T3.4.2.5.4" class="ltx_text"></span><span id="S4.T3.4.2.5.5" class="ltx_text" style="font-size:70%;"></span>
</td>
<td id="S4.T3.4.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.2.6.1" class="ltx_text" style="font-size:70%;">fine-tuned</span></td>
</tr>
<tr id="S4.T3.4.3" class="ltx_tr">
<td id="S4.T3.4.3.1" class="ltx_td ltx_align_left"><span id="S4.T3.4.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1</span></td>
<td id="S4.T3.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.3.2.1" class="ltx_text" style="font-size:70%;">35.96</span></td>
<td id="S4.T3.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.3.3.1" class="ltx_text" style="font-size:70%;">24.10</span></td>
<td id="S4.T3.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.3.4.1" class="ltx_text" style="font-size:70%;">23.81 (1.2%)</span></td>
<td id="S4.T3.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.3.5.1" class="ltx_text" style="font-size:70%;">42.28</span></td>
<td id="S4.T3.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.3.6.1" class="ltx_text" style="font-size:70%;">41.15 (2.7%)</span></td>
</tr>
<tr id="S4.T3.4.4" class="ltx_tr">
<td id="S4.T3.4.4.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.4.4.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">2</span></td>
<td id="S4.T3.4.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.4.2.1" class="ltx_text" style="font-size:70%;">20.40</span></td>
<td id="S4.T3.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.4.3.1" class="ltx_text" style="font-size:70%;">11.78</span></td>
<td id="S4.T3.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.4.4.1" class="ltx_text" style="font-size:70%;">11.67 (0.9%)</span></td>
<td id="S4.T3.4.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.4.5.1" class="ltx_text" style="font-size:70%;">22.58</span></td>
<td id="S4.T3.4.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.4.6.1" class="ltx_text" style="font-size:70%;">21.76 (3.6%)</span></td>
</tr>
<tr id="S4.T3.4.5" class="ltx_tr">
<td id="S4.T3.4.5.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S4.T3.4.5.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">3</span></td>
<td id="S4.T3.4.5.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.4.5.2.1" class="ltx_text" style="font-size:70%;">142.72</span></td>
<td id="S4.T3.4.5.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.4.5.3.1" class="ltx_text" style="font-size:70%;">6.91</span></td>
<td id="S4.T3.4.5.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.4.5.4.1" class="ltx_text" style="font-size:70%;">6.97 (-0.8%)</span></td>
<td id="S4.T3.4.5.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.4.5.5.1" class="ltx_text" style="font-size:70%;">17.74</span></td>
<td id="S4.T3.4.5.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.4.5.6.1" class="ltx_text" style="font-size:70%;">17.49 (1.4%)</span></td>
</tr>
<tr id="S4.T3.4.6" class="ltx_tr">
<td id="S4.T3.4.6.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.4.6.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">4</span></td>
<td id="S4.T3.4.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.6.2.1" class="ltx_text" style="font-size:70%;">102.44</span></td>
<td id="S4.T3.4.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.6.3.1" class="ltx_text" style="font-size:70%;">6.28</span></td>
<td id="S4.T3.4.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.6.4.1" class="ltx_text" style="font-size:70%;">6.15 (2%)</span></td>
<td id="S4.T3.4.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.6.5.1" class="ltx_text" style="font-size:70%;">15.58</span></td>
<td id="S4.T3.4.6.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.6.6.1" class="ltx_text" style="font-size:70%;">15.26 (2%)</span></td>
</tr>
<tr id="S4.T3.4.7" class="ltx_tr">
<td id="S4.T3.4.7.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.4.7.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">5</span></td>
<td id="S4.T3.4.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.7.2.1" class="ltx_text" style="font-size:70%;">100.49</span></td>
<td id="S4.T3.4.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.7.3.1" class="ltx_text" style="font-size:70%;">7.30</span></td>
<td id="S4.T3.4.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.7.4.1" class="ltx_text" style="font-size:70%;">6.89 (5.6%)</span></td>
<td id="S4.T3.4.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.7.5.1" class="ltx_text" style="font-size:70%;">15.17</span></td>
<td id="S4.T3.4.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.4.7.6.1" class="ltx_text" style="font-size:70%;">15.10 (0.4%)</span></td>
</tr>
<tr id="S4.T3.4.8" class="ltx_tr">
<td id="S4.T3.4.8.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T3.4.8.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">6</span></td>
<td id="S4.T3.4.8.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.4.8.2.1" class="ltx_text" style="font-size:70%;">100.35</span></td>
<td id="S4.T3.4.8.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.4.8.3.1" class="ltx_text" style="font-size:70%;">5.34</span></td>
<td id="S4.T3.4.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.4.8.4.1" class="ltx_text" style="font-size:70%;">5.24 (1.8%)</span></td>
<td id="S4.T3.4.8.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.4.8.5.1" class="ltx_text" style="font-size:70%;">14.73</span></td>
<td id="S4.T3.4.8.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.4.8.6.1" class="ltx_text" style="font-size:70%;">14.61 (0.8%)</span></td>
</tr>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this investigation, we present a comprehensive examination of federated learning within the context of heterogeneous devices, utilizing early-exit ASR architectures. Our study mathematically shows that the use of early-exit solutions with intermediates output layers and corresponding losses, allows federating heterogeneous models in a straightforward manner, obviating the necessity for specifically tailored agglomeration strategies. Through experimental evaluations conducted on the widely recognized TED-LIUM-3 and VoxPopuli benchmark datasets, we substantiate our claims showing the efficacy of early-exit architectures. Notably, we show experimentally that even in very unfavorable conditions, where the large majority of the clients updates only the lower part of the network, the convergence of the model is still achieved, although at a slower rate. Finally, through ablation studies we show that freezing the convolutional front-end of the pre-trained model in combination with FedAdam significantly enhances convergence in comparison to FedAvg.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. Mehrish, N. Majumder, R. Bharadwaj, R. Mihalcea, S. Poria, A review of deep learning techniques for speech processing, Information Fusion (2023) 101869.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Kumar, S. Verma, H. Mangla, A survey of deep learning techniques in speech recognition, in: Proc. of ICACCCN, IEEE, 2018, pp. 179–185.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M. Rao, G. Chennupati, G. Tiwari, A. K. Sahu, A. Raju, A. Rastrow, J. Droppo, Federated self-learning with weak supervision for speech recognition, in: Proc. of ICASSP, IEEE, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. Zhu, T. Voigt, J. Ko, F. Rahimian, On-device training: A first overview on existing systems, arXiv preprint arXiv:2212.00824.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
F. Paissan, A. Ancilotto, E. Farella, PhiNets: A Scalable Backbone for Low-power AI at the Edge, ACM Trans. Embed. Comput. Syst. 21 (5).

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, B. A. y Arcas, Communication-efficient learning of deep networks from decentralized data, in: Artificial intelligence and statistics, PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Matsubara, M. Levorato, F. Restuccia, Split computing and early exiting for deep learning applications: Survey and research challenges, ACM Computing Surveys 55 (5) (2022) 1–30.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Gao, T. Parcollet, S. Zaiem, J. Fernandez-Marques, P. P. de Gusmao, D. J. Beutel, N. D. Lane, End-to-end speech recognition from federated acoustic models, in: Proc. of ICASSP, IEEE, 2022, pp. 7227–7231.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. Li, Y. Fan, M. Tse, K.-Y. Lin, A review of applications in federated learning, Computers &amp; Industrial Engineering 149 (2020) 106854.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, Q. Yang, Towards personalized federated learning, IEEE Transactions on Neural Networks and Learning Systems.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Park, J. Ko, FedHM: Practical federated learning for heterogeneous model deployments, ICT Express.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
H. Cho, A. Mathur, F. Kawsar, Flame: Federated learning across multi-device environments, Proc. of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies 6 (3) (2022) 1–29.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. J. Cho, A. Manoel, G. Joshi, R. Sim, D. Dimitriadis, Heterogeneous ensemble knowledge transfer for training large models in federated learning, arXiv preprint arXiv:2204.12703.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
E. Diao, J. Ding, V. Tarokh, HeteroFL: Computation and communication efficient federated learning for heterogeneous clients, in: International Conference on Learning Representations, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y. Jiang, S. Wang, V. Valls, B. J. Ko, W.-H. Lee, K. K. Leung, L. Tassiulas, Model pruning enables efficient federated learning on edge devices, IEEE Transactions on Neural Networks and Learning Systems 34 (12) (2023) 10374–10386.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Alam, L. Liu, M. Yan, M. Zhang, FedRolex: Model-Heterogeneous Federated Learning with Rolling Sub-Model Extraction, in: A. H. Oh, A. Agarwal, D. Belgrave, K. Cho (Eds.), Advances in Neural Information Processing Systems, 2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
D. Guliani, L. Zhou, C. Ryu, T.-J. Yang, H. Zhang, Y. Xiao, F. Beaufays, G. Motta, Enabling on-device training of speech recognition models with federated dropout, in: Proc. of ICASSP, IEEE, 2022, pp. 8757–8761.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. Teerapittayanon, B. McDanel, H.-T. Kung, BranchyNet: Fast inference via early exiting from deep neural networks, in: Proc. of ICPR, IEEE, 2016, pp. 2464–2469.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M. Phuong, C. H. Lampert, Distillation-based training for multi-exit architectures, in: Proc. of ICCV, IEEE, 2019, pp. 1355–1364.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
G. A. Wright, U. Cappellazzo, S. Zaiem, D. Raj, L. O. Yang, D. Falavigna, A. Brutti, Training dynamic models using early exits for automatic speech recognition on resource-constrained devices, arXiv preprint arXiv:2309.09546.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
C. Dwork, A. Roth, et al., The algorithmic foundations of differential privacy, Foundations and Trends® in Theoretical Computer Science 9 (3–4) (2014) 211–407.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
K. Bonawitz, V. Ivanov, B. Kreuter, A. Marcedone, H. B. McMahan, S. Patel, D. Ramage, A. Segal, K. Seth, Practical secure aggregation for federated learning on user-held data, arXiv preprint arXiv:1611.04482.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
M. N. Ali, D. Falavigna, A. Brutti, Fed-EE: Federating heterogeneous asr models using early-exit architectures, in: Proceedings of 3rd Neurips Workshop on Efficient Natural Language and Speech Processing, 2023, pp. 1–9.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
S. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečnỳ, S. Kumar, H. B. McMahan, Adaptive federated optimization, arXiv preprint arXiv:2003.00295.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Zeyer, P. Bahar, K. Irie, R. Schlüter, H. Ney, A comparison of transformer and lstm encoder decoder models for asr, in: Proc. of ASRU, IEEE, 2019, pp. 8–15.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Moriya, T. Ashihara, H. Sato, K. Matsuura, T. Tanaka, R. Masumura, Improving scheduled sampling for neural transducer-based asr, in: Proc. of ICASSP, IEEE, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
M. Zeineldeen, J. Xu, C. Lüscher, W. Michel, A. Gerstenberger, R. Schlüter, H. Ney, Conformer-based hybrid asr system for switchboard dataset, in: Proc. of ICASSP, IEEE, 2022, pp. 7437–7441.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Oruh, S. Viriri, A. Adegun, Long short-term memory recurrent neural network for automatic speech recognition, IEEE Access 10 (2022) 30069–30079.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
C. Wang, et al., VoxPopuli: A large-scale multilingual speech corpus for representation learning, semi-supervised learning and interpretation, in: Proc. of Annual Meeting of the Association for Computational Linguistics and the International Joint Conference on Natural Language Processing, Association for Computational Linguistics, Online, 2021, pp. 993–1003.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
S. S. Azam, et al., Importance of smoothness induced by optimizers in fl4asr: Towards understanding federated learning for end-to-end asr, in: Proc. of ASRU, IEEE, 2023, pp. 1–8.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
W. Yu, J. Freiwald, S. Tewes, F. Huennemeyer, D. Kolossa, Federated learning in ASR: Not as easy as you think, in: Speech Communication; 14th ITG Conference, VDE, 2021, pp. 1–5.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
D. Dimitriadis, R. G. Ken’ichi Kumatani, R. Gmyr, Y. Gaur, S. E. Eskimez, A federated approach in training acoustic models., in: Proc. of Interspeech, 2020, pp. 981–985.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Gao, J. Fernandez-Marques, T. Parcollet, A. Mehrotra, N. D. Lane, Federated self-supervised speech representations: Are we there yet?, arXiv preprint arXiv:2204.02804.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
T. Nguyen, S. Mdhaffar, N. Tomashenko, J.-F. Bonastre, Y. Estève, Federated learning for ASR based on Wav2vec 2.0, in: Proc. of ICASSP, IEEE, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
F. Hernandez, V. Nguyen, S. Ghannay, N. Tomashenko, Y. Esteve, Ted-lium 3: Twice as much data and corpus repartition for experiments on speaker adaptation, in: Speech and Computer: International Conference, SPECOM 2018, Leipzig, Germany, Springer, 2018, pp. 198–208.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Baevski, Y. Zhou, A. Mohamed, M. Auli, wav2vec 2.0: A framework for self-supervised learning of speech representations, Advances in neural information processing systems 33 (2020) 12449–12460.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
V. Panayotov, G. Chen, D. Povey, S. Khudanpur, Librispeech: an asr corpus based on public domain audio books, in: Proc. of ICASSP, IEEE, 2015, pp. 5206–5210.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
J. Jia, J. Mahadeokar, W. Zheng, Y. Shangguan, O. Kalinli, F. Seide, Federated domain adaptation for asr with full self-supervision, arXiv preprint arXiv:2203.15966.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
H. Zhou, T. Lan, G. P. Venkataramani, W. Ding, Every parameter matters: Ensuring the convergence of federated learning with dynamic heterogeneous models reduction, in: Thirty-seventh Conference on Neural Information Processing Systems, 2023.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. Mills, J. Hu, G. Min, Multi-task federated learning for personalised deep neural networks in edge computing, IEEE Transactions on Parallel and Distributed Systems 33 (3) (2021) 630–641.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
X. Ni, X. Shen, H. Zhao, Federated optimization via knowledge codistillation, Expert Systems with Applications 191 (2022) 116310.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
T. Lin, L. Kong, S. U. Stich, M. Jaggi, Ensemble distillation for robust model fusion in federated learning, Advances in Neural Information Processing Systems 33 (2020) 2351–2363.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Q. Li, B. He, D. Song, Model-contrastive federated learning, in: Proc. of ICCV, 2021, pp. 10713–10722.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
S. Horvath, S. Laskaridis, M. Almeida, I. Leontiadis, S. Venieris, N. Lane, FjORD: Fair and accurate federated learning under heterogeneous targets with ordered dropout, Advances in Neural Information Processing Systems 34 (2021) 12876–12889.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
N. Tomashenko, S. Mdhaffar, M. Tommasi, Y. Estève, J.-F. Bonastre, Privacy attacks for automatic speech recognition acoustic models in a federated learning framework, in: Proc. of ICASSP, IEEE, 2022, pp. 6972–6976.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
F. Boenisch, A. Dziedzic, R. Schuster, A. S. Shamsabadi, I. Shumailov, N. Papernot, When the curious abandon honesty: Federated learning is not private, in: European Symposium on Security and Privacy, IEEE, 2023, pp. 175–199.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Y. Shen, Z. Wang, R. Sun, X. Shen, Towards understanding the impact of model size on differential private classification, arXiv preprint arXiv:2111.13895.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
M. Shoemate, K. Jett, E. Cowan, S. Colbath, J. Honaker, P. Muthukumar, Sotto voce: Federated speech recognition with differential privacy guarantees, arXiv preprint arXiv:2207.07816.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
M. Pelikan, S. S. Azam, V. Feldman, J. Silovsky, K. Talwar, T. Likhomanenko, et al., Federated learning with differential privacy for end-to-end speech recognition, arXiv preprint arXiv:2310.00098.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
R. Sennrich, B. Haddow, A. Birch, Neural machine translation of rare words with subword units, arXiv preprint arXiv:1508.07909.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
A. Graves, N. Jaitly, Towards end-to-end speech recognition with recurrent neural networks, in: International conference on machine learning, PMLR, 2014, pp. 1764–1772.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
A. Graves, A.-r. Mohamed, G. Hinton, Speech recognition with deep recurrent neural networks, in: Proc. of ICASSP, Ieee, 2013, pp. 6645–6649.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
D. J. Beutel, T. Topal, A. Mathur, X. Qiu, J. Fernandez-Marques, Y. Gao, L. Sani, K. H. Li, T. Parcollet, P. P. B. de Gusmão, et al., Flower: A friendly federated learning research framework, arXiv preprint arXiv:2007.14390.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
L. Ju, T. Zhang, S. Toor, A. Hellander, Accelerating fair federated learning: Adaptive federated adam, arXiv preprint arXiv:2301.09357.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Y. Liu, S. Agarwal, S. Venkataraman, Autofreeze: Automatically freezing model blocks to accelerate fine-tuning, arXiv preprint arXiv:2102.01386.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
J. Lee, R. Tang, J. Lin, What would elsa do? freezing layers during transformer fine-tuning, arXiv preprint arXiv:1911.03090.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
M. Ye, X. Fang, B. Du, P. C. Yuen, D. Tao, Heterogeneous federated learning: State-of-the-art and research challenges, ACM Computing Surveys 56 (3) (2023) 1–44.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, V. Smith, Federated learning: Challenges, methods, and future directions, IEEE signal processing magazine 37 (3) (2020) 50–60.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.17375" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.17376" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.17376">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.17376" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.17377" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 18:24:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
