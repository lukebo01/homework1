<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.13008] Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models</title><meta property="og:description" content="This paper introduces a novel training framework called Focused Discriminative Training (FDT) to further improve streaming word-piece end-to-end (E2E) automatic speech recognition (ASR) models trained using either CTC …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.13008">

<!--Generated on Thu Sep  5 14:28:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">This paper introduces a novel training framework called Focused Discriminative Training (FDT) to further improve streaming word-piece end-to-end (E2E) automatic speech recognition (ASR) models trained using either CTC or an interpolation of CTC and attention-based encoder-decoder (AED) loss. The proposed approach presents a novel framework to identify and improve a model’s recognition on challenging segments of an audio. Notably, this training framework is independent of hidden Markov models (HMMs) and lattices, eliminating the need for substantial decision-making regarding HMM topology, lexicon, and graph generation, as typically required in standard discriminative training approaches. Compared to additional fine-tuning with MMI or MWER loss on the encoder, FDT is shown to be more effective in achieving greater reductions in Word Error Rate (WER) on streaming models trained on LibriSpeech. Additionally, this method is shown to be effective in further improving a converged word-piece streaming E2E model trained on 600k hours of assistant and dictation dataset.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The combination of connectionist temporal classification (CTC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and attention-based encoder-decoder (AED)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> loss has become a powerful approach for training end-to-end (E2E) models to address both streaming and non-streaming speech recognition tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">This paper in particular aims to address the challenging task of further improving a streaming word-piece ASR model that has converged with respect to CTC loss. For neural network models whose output units correspond to phones, sequence discriminative training approaches such as MMI, sMBR, EMBR, etc. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, which embed the models within an HMM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> framework, have been shown to be effective in achieving further WER improvements. However, the implementation of discriminative sequence training is a time-consuming and challenging process. Implementations of both lattice-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and lattice-free sMBR/MMI <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> techniques necessitate careful design decisions regarding the choice of HMM topology, lexicon, and graph generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. This results in a slower evolution of the training pipeline compared to the rapidly evolving training frameworks for E2E models. In particular, lattice-based MMI introduces an additional computational overhead by requiring pre-generated lattices, potentially diminishing the training framework’s flexibility. Furthermore, in the LF-MMI paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, the authors acknowledge the difficulty of further improving models trained with CTC and thus employ their discriminative training approach to fine-tune models initially trained with Cross-Entropy loss. The current variant of LF-MMI trains models with phonetic output units from scratch. It should be noted that, aside from the mentioned approaches, the Minimum Word Error Rate (MWER) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> loss has been shown to be effective when applied on top of the decoder in encoder-decoder based models. This method is an HMM-independent approach. However, at the time of writing this paper, this work found no evidence in the literature that presents a successful application of this loss to fine-tune word-piece based CTC-trained encoders using N-best lists <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">This paper introduces a novel approach called Focused Discriminative Training (FDT) to specifically fine-tune encoders with word-piece outputs trained using either CTC or an interpolation of CTC and AED (CTC+AED) loss. The motivation behind the algorithm is to address a particular problem encountered by streaming E2E ASR models. To exemplify the problem, consider the following voice assistant request: ”Hey Assistant, call Beethoven.” Assume that in the dataset used to train the model, there are ample audio examples for the phrase ”Hey Assistant, call,” but few examples for the proper noun ”Beethoven.” In such situations, the intended action is correctly recognised by the ASR model, but difficulties are encountered in identifying the intended callee. Current discriminative training approaches use sequence-level objectives, which aim to increase the probability of the entire word sequence as a whole without specifically targeting the regions where ASR mis-recognises words. Ideally, a framework that fine-tunes the model specifically on these challenging regions is desired.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The FDT algorithm consists of 3 key components: implicit data selection, an error region detection mechanism and a novel constrained CTC-based contrastive segment-level loss. FDT integrates these components to identify and improve the recognition of challenging segments within the input sequence. The proposed method is HMM-independent, eliminating the requirement for various components, like HMM topology, lexicon, and utilises N-best lists. Thus, the method is also lattice-free.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The efficacy of the algorithm is demonstrated through further fine-tuning streaming encoders with word-piece outputs, trained on the LibriSpeech dataset using CTC and CTC+AED loss. The method’s efficacy was compared with MMI and MWER loss applied on top of the encoder. The latter two approaches can be viewed as the CTC versions of previous work that utilised N-best lists for MWER <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and MMI training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> of word-piece based AED and Neural Transducer models. To the best of our knowledge, this work presents the first application of MWER on word-piece based CTC-trained models. The MMI and MWER experiments reported here do not use a separate language model. This study also assesses the FDT algorithm’s efficacy in improving a converged model trained on a large-scale dataset from a distinct domain. Results demonstrate that when applied to further fine-tune a converged word-piece streaming E2E model trained on a dataset comprising 600K hours of assistant and dictation data with CTC+AED loss, the algorithm achieves additional improvements in WER. The rest of this paper is organised as follows: Sec.4 describes the proposed method. Sec.5 details the data, model, and experimental results. Conclusions are provided in Sec.6.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Notation</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">To facilitate understanding of the mathematical statements in this work, let</p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">i</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p"><math id="S2.I1.i1.p1.1.m1.1" class="ltx_math_unparsed" alttext="P_{\bm{\theta}}(\cdot)=P(\cdot|\bm{\theta})" display="inline"><semantics id="S2.I1.i1.p1.1.m1.1a"><mrow id="S2.I1.i1.p1.1.m1.1b"><msub id="S2.I1.i1.p1.1.m1.1.2"><mi id="S2.I1.i1.p1.1.m1.1.2.2">P</mi><mi id="S2.I1.i1.p1.1.m1.1.2.3">𝜽</mi></msub><mrow id="S2.I1.i1.p1.1.m1.1.3"><mo stretchy="false" id="S2.I1.i1.p1.1.m1.1.3.1">(</mo><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1">⋅</mo><mo stretchy="false" id="S2.I1.i1.p1.1.m1.1.3.2">)</mo></mrow><mo id="S2.I1.i1.p1.1.m1.1.4">=</mo><mi id="S2.I1.i1.p1.1.m1.1.5">P</mi><mrow id="S2.I1.i1.p1.1.m1.1.6"><mo stretchy="false" id="S2.I1.i1.p1.1.m1.1.6.1">(</mo><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.6.2">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.I1.i1.p1.1.m1.1.6.3">|</mo><mi id="S2.I1.i1.p1.1.m1.1.6.4">𝜽</mi><mo stretchy="false" id="S2.I1.i1.p1.1.m1.1.6.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">P_{\bm{\theta}}(\cdot)=P(\cdot|\bm{\theta})</annotation></semantics></math> - Probability function dependent on the choice of model parameters.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">ii</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.4" class="ltx_p"><math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{x}_{1:T}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">𝐱</mi><mrow id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml"><mn id="S2.I1.i2.p1.1.m1.1.1.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i2.p1.1.m1.1.1.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">:</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">𝐱</ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><ci id="S2.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2">1</cn><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mathbf{x}_{1:T}</annotation></semantics></math> denote an input sequence of feature vectors, <math id="S2.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{W}^{r}_{1:k}" display="inline"><semantics id="S2.I1.i2.p1.2.m2.1a"><msubsup id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.2.2" xref="S2.I1.i2.p1.2.m2.1.1.2.2.cmml">𝐖</mi><mrow id="S2.I1.i2.p1.2.m2.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.3.cmml"><mn id="S2.I1.i2.p1.2.m2.1.1.3.2" xref="S2.I1.i2.p1.2.m2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i2.p1.2.m2.1.1.3.1" xref="S2.I1.i2.p1.2.m2.1.1.3.1.cmml">:</mo><mi id="S2.I1.i2.p1.2.m2.1.1.3.3" xref="S2.I1.i2.p1.2.m2.1.1.3.3.cmml">k</mi></mrow><mi id="S2.I1.i2.p1.2.m2.1.1.2.3" xref="S2.I1.i2.p1.2.m2.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">subscript</csymbol><apply id="S2.I1.i2.p1.2.m2.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">superscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2.2">𝐖</ci><ci id="S2.I1.i2.p1.2.m2.1.1.2.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2.3">𝑟</ci></apply><apply id="S2.I1.i2.p1.2.m2.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3"><ci id="S2.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.2">1</cn><ci id="S2.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">\mathbf{W}^{r}_{1:k}</annotation></semantics></math> denote its associated reference word sequence with <math id="S2.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{l}^{r}_{1:U}" display="inline"><semantics id="S2.I1.i2.p1.3.m3.1a"><msubsup id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.2.2" xref="S2.I1.i2.p1.3.m3.1.1.2.2.cmml">𝐥</mi><mrow id="S2.I1.i2.p1.3.m3.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.3.cmml"><mn id="S2.I1.i2.p1.3.m3.1.1.3.2" xref="S2.I1.i2.p1.3.m3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i2.p1.3.m3.1.1.3.1" xref="S2.I1.i2.p1.3.m3.1.1.3.1.cmml">:</mo><mi id="S2.I1.i2.p1.3.m3.1.1.3.3" xref="S2.I1.i2.p1.3.m3.1.1.3.3.cmml">U</mi></mrow><mi id="S2.I1.i2.p1.3.m3.1.1.2.3" xref="S2.I1.i2.p1.3.m3.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><apply id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">subscript</csymbol><apply id="S2.I1.i2.p1.3.m3.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.2.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.2.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.2.2">𝐥</ci><ci id="S2.I1.i2.p1.3.m3.1.1.2.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.2.3">𝑟</ci></apply><apply id="S2.I1.i2.p1.3.m3.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3"><ci id="S2.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3.2">1</cn><ci id="S2.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3.3">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">\mathbf{l}^{r}_{1:U}</annotation></semantics></math> representing corresponding target word-piece label sequence. The superscript <math id="S2.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.I1.i2.p1.4.m4.1a"><mi id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><ci id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">r</annotation></semantics></math> denotes ‘reference’.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">iii</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.2" class="ltx_p"><math id="S2.I1.i3.p1.1.m1.2" class="ltx_Math" alttext="\bm{e}_{t}=f(\bm{x}_{1:t},\bm{\theta})" display="inline"><semantics id="S2.I1.i3.p1.1.m1.2a"><mrow id="S2.I1.i3.p1.1.m1.2.2" xref="S2.I1.i3.p1.1.m1.2.2.cmml"><msub id="S2.I1.i3.p1.1.m1.2.2.3" xref="S2.I1.i3.p1.1.m1.2.2.3.cmml"><mi id="S2.I1.i3.p1.1.m1.2.2.3.2" xref="S2.I1.i3.p1.1.m1.2.2.3.2.cmml">𝒆</mi><mi id="S2.I1.i3.p1.1.m1.2.2.3.3" xref="S2.I1.i3.p1.1.m1.2.2.3.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.1.m1.2.2.2" xref="S2.I1.i3.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S2.I1.i3.p1.1.m1.2.2.1" xref="S2.I1.i3.p1.1.m1.2.2.1.cmml"><mi id="S2.I1.i3.p1.1.m1.2.2.1.3" xref="S2.I1.i3.p1.1.m1.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.2.2.1.2" xref="S2.I1.i3.p1.1.m1.2.2.1.2.cmml">​</mo><mrow id="S2.I1.i3.p1.1.m1.2.2.1.1.1" xref="S2.I1.i3.p1.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.I1.i3.p1.1.m1.2.2.1.1.1.2" xref="S2.I1.i3.p1.1.m1.2.2.1.1.2.cmml">(</mo><msub id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml"><mi id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.2" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.2.cmml">𝒙</mi><mrow id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.cmml"><mn id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.1" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.I1.i3.p1.1.m1.2.2.1.1.1.3" xref="S2.I1.i3.p1.1.m1.2.2.1.1.2.cmml">,</mo><mi id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.I1.i3.p1.1.m1.2.2.1.1.1.4" xref="S2.I1.i3.p1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.2b"><apply id="S2.I1.i3.p1.1.m1.2.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2"><eq id="S2.I1.i3.p1.1.m1.2.2.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.2"></eq><apply id="S2.I1.i3.p1.1.m1.2.2.3.cmml" xref="S2.I1.i3.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.2.2.3.1.cmml" xref="S2.I1.i3.p1.1.m1.2.2.3">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.2.2.3.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.3.2">𝒆</ci><ci id="S2.I1.i3.p1.1.m1.2.2.3.3.cmml" xref="S2.I1.i3.p1.1.m1.2.2.3.3">𝑡</ci></apply><apply id="S2.I1.i3.p1.1.m1.2.2.1.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1"><times id="S2.I1.i3.p1.1.m1.2.2.1.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.2"></times><ci id="S2.I1.i3.p1.1.m1.2.2.1.3.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.3">𝑓</ci><interval closure="open" id="S2.I1.i3.p1.1.m1.2.2.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1"><apply id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.2">𝒙</ci><apply id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3"><ci id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2">1</cn><ci id="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝜽</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.2c">\bm{e}_{t}=f(\bm{x}_{1:t},\bm{\theta})</annotation></semantics></math> denote the mapping of an acoustic encoder that strictly operates on frames corresponding to the left context for a fixed choice of model parameters <math id="S2.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S2.I1.i3.p1.2.m2.1a"><mi id="S2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i3.p1.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m2.1b"><ci id="S2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m2.1c">\bm{\theta}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">iv</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p id="S2.I1.i4.p1.4" class="ltx_p"><math id="S2.I1.i4.p1.1.m1.2" class="ltx_Math" alttext="P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})={\tt softmax}(\bm{e}_{t})" display="inline"><semantics id="S2.I1.i4.p1.1.m1.2a"><mrow id="S2.I1.i4.p1.1.m1.2.2" xref="S2.I1.i4.p1.1.m1.2.2.cmml"><mrow id="S2.I1.i4.p1.1.m1.1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.1.cmml"><msub id="S2.I1.i4.p1.1.m1.1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.1.3.cmml"><mi id="S2.I1.i4.p1.1.m1.1.1.1.3.2" xref="S2.I1.i4.p1.1.m1.1.1.1.3.2.cmml">P</mi><mi id="S2.I1.i4.p1.1.m1.1.1.1.3.3" xref="S2.I1.i4.p1.1.m1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S2.I1.i4.p1.1.m1.1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S2.I1.i4.p1.1.m1.1.1.1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml"><msub id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.2" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.3" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.2" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.cmml"><mn id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.2" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.1" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.3" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i4.p1.1.m1.2.2.3" xref="S2.I1.i4.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S2.I1.i4.p1.1.m1.2.2.2" xref="S2.I1.i4.p1.1.m1.2.2.2.cmml"><mi id="S2.I1.i4.p1.1.m1.2.2.2.3" xref="S2.I1.i4.p1.1.m1.2.2.2.3.cmml">𝚜𝚘𝚏𝚝𝚖𝚊𝚡</mi><mo lspace="0em" rspace="0em" id="S2.I1.i4.p1.1.m1.2.2.2.2" xref="S2.I1.i4.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="S2.I1.i4.p1.1.m1.2.2.2.1.1" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.I1.i4.p1.1.m1.2.2.2.1.1.2" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.2" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.2.cmml">𝒆</mi><mi id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.3" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.I1.i4.p1.1.m1.2.2.2.1.1.3" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.2b"><apply id="S2.I1.i4.p1.1.m1.2.2.cmml" xref="S2.I1.i4.p1.1.m1.2.2"><eq id="S2.I1.i4.p1.1.m1.2.2.3.cmml" xref="S2.I1.i4.p1.1.m1.2.2.3"></eq><apply id="S2.I1.i4.p1.1.m1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1"><times id="S2.I1.i4.p1.1.m1.1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.2"></times><apply id="S2.I1.i4.p1.1.m1.1.1.1.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.1.1.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.3.2">𝑃</ci><ci id="S2.I1.i4.p1.1.m1.1.1.1.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.3.3">𝜽</ci></apply><apply id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.2">𝒛</ci><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3"><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S2.I1.i4.p1.1.m1.2.2.2.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2"><times id="S2.I1.i4.p1.1.m1.2.2.2.2.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.2"></times><ci id="S2.I1.i4.p1.1.m1.2.2.2.3.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.3">𝚜𝚘𝚏𝚝𝚖𝚊𝚡</ci><apply id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.2">𝒆</ci><ci id="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.I1.i4.p1.1.m1.2.2.2.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.2c">P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})={\tt softmax}(\bm{e}_{t})</annotation></semantics></math> denote the conditional distribution at time <math id="S2.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.I1.i4.p1.2.m2.1a"><mi id="S2.I1.i4.p1.2.m2.1.1" xref="S2.I1.i4.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b"><ci id="S2.I1.i4.p1.2.m2.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">t</annotation></semantics></math> yielded by the acoustic encoder where <math id="S2.I1.i4.p1.3.m3.1" class="ltx_Math" alttext="\bm{z}_{t}" display="inline"><semantics id="S2.I1.i4.p1.3.m3.1a"><msub id="S2.I1.i4.p1.3.m3.1.1" xref="S2.I1.i4.p1.3.m3.1.1.cmml"><mi id="S2.I1.i4.p1.3.m3.1.1.2" xref="S2.I1.i4.p1.3.m3.1.1.2.cmml">𝒛</mi><mi id="S2.I1.i4.p1.3.m3.1.1.3" xref="S2.I1.i4.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.3.m3.1b"><apply id="S2.I1.i4.p1.3.m3.1.1.cmml" xref="S2.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i4.p1.3.m3.1.1.1.cmml" xref="S2.I1.i4.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i4.p1.3.m3.1.1.2.cmml" xref="S2.I1.i4.p1.3.m3.1.1.2">𝒛</ci><ci id="S2.I1.i4.p1.3.m3.1.1.3.cmml" xref="S2.I1.i4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.3.m3.1c">\bm{z}_{t}</annotation></semantics></math> represents a token/blank realisation at time <math id="S2.I1.i4.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.I1.i4.p1.4.m4.1a"><mi id="S2.I1.i4.p1.4.m4.1.1" xref="S2.I1.i4.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.4.m4.1b"><ci id="S2.I1.i4.p1.4.m4.1.1.cmml" xref="S2.I1.i4.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.4.m4.1c">t</annotation></semantics></math>.</p>
</div>
</li>
<li id="S2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">v</span> 
<div id="S2.I1.i5.p1" class="ltx_para">
<p id="S2.I1.i5.p1.3" class="ltx_p"><math id="S2.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="{1}_{\mathbf{l}_{1:U}}(\bm{z}_{1:T})" display="inline"><semantics id="S2.I1.i5.p1.1.m1.1a"><mrow id="S2.I1.i5.p1.1.m1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.cmml"><msub id="S2.I1.i5.p1.1.m1.1.1.3" xref="S2.I1.i5.p1.1.m1.1.1.3.cmml"><mn id="S2.I1.i5.p1.1.m1.1.1.3.2" xref="S2.I1.i5.p1.1.m1.1.1.3.2.cmml">1</mn><msub id="S2.I1.i5.p1.1.m1.1.1.3.3" xref="S2.I1.i5.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I1.i5.p1.1.m1.1.1.3.3.2" xref="S2.I1.i5.p1.1.m1.1.1.3.3.2.cmml">𝐥</mi><mrow id="S2.I1.i5.p1.1.m1.1.1.3.3.3" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.cmml"><mn id="S2.I1.i5.p1.1.m1.1.1.3.3.3.2" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i5.p1.1.m1.1.1.3.3.3.1" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.1.cmml">:</mo><mi id="S2.I1.i5.p1.1.m1.1.1.3.3.3.3" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.3.cmml">U</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S2.I1.i5.p1.1.m1.1.1.2" xref="S2.I1.i5.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S2.I1.i5.p1.1.m1.1.1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.I1.i5.p1.1.m1.1.1.1.1.2" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i5.p1.1.m1.1.1.1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.I1.i5.p1.1.m1.1.1.1.1.1.2" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.cmml"><mn id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.2" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.1" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.3" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S2.I1.i5.p1.1.m1.1.1.1.1.3" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.m1.1b"><apply id="S2.I1.i5.p1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1"><times id="S2.I1.i5.p1.1.m1.1.1.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.2"></times><apply id="S2.I1.i5.p1.1.m1.1.1.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i5.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3">subscript</csymbol><cn type="integer" id="S2.I1.i5.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.2">1</cn><apply id="S2.I1.i5.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.I1.i5.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.I1.i5.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3.2">𝐥</ci><apply id="S2.I1.i5.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3"><ci id="S2.I1.i5.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.1">:</ci><cn type="integer" id="S2.I1.i5.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.2">1</cn><ci id="S2.I1.i5.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3.3.3.3">𝑈</ci></apply></apply></apply><apply id="S2.I1.i5.p1.1.m1.1.1.1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i5.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i5.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.2">𝒛</ci><apply id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3"><ci id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.2">1</cn><ci id="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.m1.1c">{1}_{\mathbf{l}_{1:U}}(\bm{z}_{1:T})</annotation></semantics></math> be the characteristic function that equals 1 if and only if <math id="S2.I1.i5.p1.2.m2.1" class="ltx_Math" alttext="\mathbb{B}(\bm{z}_{1:T})=\mathbf{l}_{1:U}" display="inline"><semantics id="S2.I1.i5.p1.2.m2.1a"><mrow id="S2.I1.i5.p1.2.m2.1.1" xref="S2.I1.i5.p1.2.m2.1.1.cmml"><mrow id="S2.I1.i5.p1.2.m2.1.1.1" xref="S2.I1.i5.p1.2.m2.1.1.1.cmml"><mi id="S2.I1.i5.p1.2.m2.1.1.1.3" xref="S2.I1.i5.p1.2.m2.1.1.1.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S2.I1.i5.p1.2.m2.1.1.1.2" xref="S2.I1.i5.p1.2.m2.1.1.1.2.cmml">​</mo><mrow id="S2.I1.i5.p1.2.m2.1.1.1.1.1" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.I1.i5.p1.2.m2.1.1.1.1.1.2" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.2" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.cmml"><mn id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.2" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.1" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.3" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S2.I1.i5.p1.2.m2.1.1.1.1.1.3" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i5.p1.2.m2.1.1.2" xref="S2.I1.i5.p1.2.m2.1.1.2.cmml">=</mo><msub id="S2.I1.i5.p1.2.m2.1.1.3" xref="S2.I1.i5.p1.2.m2.1.1.3.cmml"><mi id="S2.I1.i5.p1.2.m2.1.1.3.2" xref="S2.I1.i5.p1.2.m2.1.1.3.2.cmml">𝐥</mi><mrow id="S2.I1.i5.p1.2.m2.1.1.3.3" xref="S2.I1.i5.p1.2.m2.1.1.3.3.cmml"><mn id="S2.I1.i5.p1.2.m2.1.1.3.3.2" xref="S2.I1.i5.p1.2.m2.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.I1.i5.p1.2.m2.1.1.3.3.1" xref="S2.I1.i5.p1.2.m2.1.1.3.3.1.cmml">:</mo><mi id="S2.I1.i5.p1.2.m2.1.1.3.3.3" xref="S2.I1.i5.p1.2.m2.1.1.3.3.3.cmml">U</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.2.m2.1b"><apply id="S2.I1.i5.p1.2.m2.1.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1"><eq id="S2.I1.i5.p1.2.m2.1.1.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.2"></eq><apply id="S2.I1.i5.p1.2.m2.1.1.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1"><times id="S2.I1.i5.p1.2.m2.1.1.1.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.2"></times><ci id="S2.I1.i5.p1.2.m2.1.1.1.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.3">𝔹</ci><apply id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.2">𝒛</ci><apply id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3"><ci id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.2">1</cn><ci id="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply><apply id="S2.I1.i5.p1.2.m2.1.1.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i5.p1.2.m2.1.1.3.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.I1.i5.p1.2.m2.1.1.3.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3.2">𝐥</ci><apply id="S2.I1.i5.p1.2.m2.1.1.3.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3.3"><ci id="S2.I1.i5.p1.2.m2.1.1.3.3.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3.3.1">:</ci><cn type="integer" id="S2.I1.i5.p1.2.m2.1.1.3.3.2.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3.3.2">1</cn><ci id="S2.I1.i5.p1.2.m2.1.1.3.3.3.cmml" xref="S2.I1.i5.p1.2.m2.1.1.3.3.3">𝑈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.2.m2.1c">\mathbb{B}(\bm{z}_{1:T})=\mathbf{l}_{1:U}</annotation></semantics></math> where <math id="S2.I1.i5.p1.3.m3.1" class="ltx_Math" alttext="\mathbb{B}(\cdot)" display="inline"><semantics id="S2.I1.i5.p1.3.m3.1a"><mrow id="S2.I1.i5.p1.3.m3.1.2" xref="S2.I1.i5.p1.3.m3.1.2.cmml"><mi id="S2.I1.i5.p1.3.m3.1.2.2" xref="S2.I1.i5.p1.3.m3.1.2.2.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S2.I1.i5.p1.3.m3.1.2.1" xref="S2.I1.i5.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S2.I1.i5.p1.3.m3.1.2.3.2" xref="S2.I1.i5.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S2.I1.i5.p1.3.m3.1.2.3.2.1" xref="S2.I1.i5.p1.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.I1.i5.p1.3.m3.1.1" xref="S2.I1.i5.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.I1.i5.p1.3.m3.1.2.3.2.2" xref="S2.I1.i5.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.3.m3.1b"><apply id="S2.I1.i5.p1.3.m3.1.2.cmml" xref="S2.I1.i5.p1.3.m3.1.2"><times id="S2.I1.i5.p1.3.m3.1.2.1.cmml" xref="S2.I1.i5.p1.3.m3.1.2.1"></times><ci id="S2.I1.i5.p1.3.m3.1.2.2.cmml" xref="S2.I1.i5.p1.3.m3.1.2.2">𝔹</ci><ci id="S2.I1.i5.p1.3.m3.1.1.cmml" xref="S2.I1.i5.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.3.m3.1c">\mathbb{B}(\cdot)</annotation></semantics></math> presents a deterministic mapping that removes all blanks and repetitive tokens but preserves the repetitive tokens separated by blanks.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The CTC Model </h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">Given an input-word-piece label sequence pair <math id="S3.p1.1.m1.2" class="ltx_Math" alttext="(\mathbf{x}_{1:T},\mathbf{l}_{1:U})" display="inline"><semantics id="S3.p1.1.m1.2a"><mrow id="S3.p1.1.m1.2.2.2" xref="S3.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.p1.1.m1.2.2.2.3" xref="S3.p1.1.m1.2.2.3.cmml">(</mo><msub id="S3.p1.1.m1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.p1.1.m1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.3.cmml"><mn id="S3.p1.1.m1.1.1.1.1.3.2" xref="S3.p1.1.m1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p1.1.m1.1.1.1.1.3.1" xref="S3.p1.1.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.p1.1.m1.1.1.1.1.3.3" xref="S3.p1.1.m1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.p1.1.m1.2.2.2.4" xref="S3.p1.1.m1.2.2.3.cmml">,</mo><msub id="S3.p1.1.m1.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.cmml"><mi id="S3.p1.1.m1.2.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.2.cmml">𝐥</mi><mrow id="S3.p1.1.m1.2.2.2.2.3" xref="S3.p1.1.m1.2.2.2.2.3.cmml"><mn id="S3.p1.1.m1.2.2.2.2.3.2" xref="S3.p1.1.m1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p1.1.m1.2.2.2.2.3.1" xref="S3.p1.1.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S3.p1.1.m1.2.2.2.2.3.3" xref="S3.p1.1.m1.2.2.2.2.3.3.cmml">U</mi></mrow></msub><mo stretchy="false" id="S3.p1.1.m1.2.2.2.5" xref="S3.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b"><interval closure="open" id="S3.p1.1.m1.2.2.3.cmml" xref="S3.p1.1.m1.2.2.2"><apply id="S3.p1.1.m1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.2">𝐱</ci><apply id="S3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.3"><ci id="S3.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.1.1.3.2">1</cn><ci id="S3.p1.1.m1.1.1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S3.p1.1.m1.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.p1.1.m1.2.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2.2">𝐥</ci><apply id="S3.p1.1.m1.2.2.2.2.3.cmml" xref="S3.p1.1.m1.2.2.2.2.3"><ci id="S3.p1.1.m1.2.2.2.2.3.1.cmml" xref="S3.p1.1.m1.2.2.2.2.3.1">:</ci><cn type="integer" id="S3.p1.1.m1.2.2.2.2.3.2.cmml" xref="S3.p1.1.m1.2.2.2.2.3.2">1</cn><ci id="S3.p1.1.m1.2.2.2.2.3.3.cmml" xref="S3.p1.1.m1.2.2.2.2.3.3">𝑈</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">(\mathbf{x}_{1:T},\mathbf{l}_{1:U})</annotation></semantics></math>, CTC training implicitly constructs a specific form of a discriminative latent variable probabilistic model for the conditional distribution <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="P({\mathbf{l}}_{1:U}|\mathbf{x}_{1:T})" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.p1.2.m2.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.1.1.1.1.2" xref="S3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.2.m2.1.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.1.cmml"><msub id="S3.p1.2.m2.1.1.1.1.1.2" xref="S3.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.p1.2.m2.1.1.1.1.1.2.2" xref="S3.p1.2.m2.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S3.p1.2.m2.1.1.1.1.1.2.3" xref="S3.p1.2.m2.1.1.1.1.1.2.3.cmml"><mn id="S3.p1.2.m2.1.1.1.1.1.2.3.2" xref="S3.p1.2.m2.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p1.2.m2.1.1.1.1.1.2.3.1" xref="S3.p1.2.m2.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.p1.2.m2.1.1.1.1.1.2.3.3" xref="S3.p1.2.m2.1.1.1.1.1.2.3.3.cmml">U</mi></mrow></msub><mo fence="false" id="S3.p1.2.m2.1.1.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.2.m2.1.1.1.1.1.3" xref="S3.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.1.1.1.3.2" xref="S3.p1.2.m2.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.p1.2.m2.1.1.1.1.1.3.3" xref="S3.p1.2.m2.1.1.1.1.1.3.3.cmml"><mn id="S3.p1.2.m2.1.1.1.1.1.3.3.2" xref="S3.p1.2.m2.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p1.2.m2.1.1.1.1.1.3.3.1" xref="S3.p1.2.m2.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.p1.2.m2.1.1.1.1.1.3.3.3" xref="S3.p1.2.m2.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S3.p1.2.m2.1.1.1.1.3" xref="S3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><times id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2"></times><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑃</ci><apply id="S3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2.2">𝐥</ci><apply id="S3.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2.3"><ci id="S3.p1.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.p1.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2.3.2">1</cn><ci id="S3.p1.2.m2.1.1.1.1.1.2.3.3.cmml" xref="S3.p1.2.m2.1.1.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="S3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3.3"><ci id="S3.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3.3.2">1</cn><ci id="S3.p1.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.p1.2.m2.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">P({\mathbf{l}}_{1:U}|\mathbf{x}_{1:T})</annotation></semantics></math> from the frame-level conditional distribution <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><msub id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">P</mi><mi id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.p1.3.m3.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.3.m3.1.1.1.1.2" xref="S3.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.3.m3.1.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.1.cmml"><msub id="S3.p1.3.m3.1.1.1.1.1.2" xref="S3.p1.3.m3.1.1.1.1.1.2.cmml"><mi id="S3.p1.3.m3.1.1.1.1.1.2.2" xref="S3.p1.3.m3.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S3.p1.3.m3.1.1.1.1.1.2.3" xref="S3.p1.3.m3.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.3.m3.1.1.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.3.m3.1.1.1.1.1.3" xref="S3.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.1.1.1.3.2" xref="S3.p1.3.m3.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.p1.3.m3.1.1.1.1.1.3.3" xref="S3.p1.3.m3.1.1.1.1.1.3.3.cmml"><mn id="S3.p1.3.m3.1.1.1.1.1.3.3.2" xref="S3.p1.3.m3.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p1.3.m3.1.1.1.1.1.3.3.1" xref="S3.p1.3.m3.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.p1.3.m3.1.1.1.1.1.3.3.3" xref="S3.p1.3.m3.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.p1.3.m3.1.1.1.1.3" xref="S3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><times id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"></times><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">𝑃</ci><ci id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">𝜽</ci></apply><apply id="S3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.p1.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.1.1.1.2.2">𝒛</ci><ci id="S3.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3.3"><ci id="S3.p1.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.p1.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3.3.2">1</cn><ci id="S3.p1.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S3.p1.3.m3.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})</annotation></semantics></math> as follows:</p>
</div>
<div id="S3.p2" class="ltx_para">
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle F_{\mathrm{CTC}}(\bm{\theta})" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.2" xref="S3.Ex1.m1.1.2.cmml"><msub id="S3.Ex1.m1.1.2.2" xref="S3.Ex1.m1.1.2.2.cmml"><mi id="S3.Ex1.m1.1.2.2.2" xref="S3.Ex1.m1.1.2.2.2.cmml">F</mi><mi id="S3.Ex1.m1.1.2.2.3" xref="S3.Ex1.m1.1.2.2.3.cmml">CTC</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.2.1" xref="S3.Ex1.m1.1.2.1.cmml">​</mo><mrow id="S3.Ex1.m1.1.2.3.2" xref="S3.Ex1.m1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.1" xref="S3.Ex1.m1.1.2.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.2" xref="S3.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.2.cmml" xref="S3.Ex1.m1.1.2"><times id="S3.Ex1.m1.1.2.1.cmml" xref="S3.Ex1.m1.1.2.1"></times><apply id="S3.Ex1.m1.1.2.2.cmml" xref="S3.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2.2">𝐹</ci><ci id="S3.Ex1.m1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.2.2.3">CTC</ci></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle F_{\mathrm{CTC}}(\bm{\theta})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.1" class="ltx_Math" alttext="\displaystyle=-\log P_{\bm{\theta}}({\mathbf{l}}_{1:U}|\mathbf{x}_{1:T})," display="inline"><semantics id="S3.Ex1.m2.1a"><mrow id="S3.Ex1.m2.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml"><mrow id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml"><mi id="S3.Ex1.m2.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.3.cmml"></mi><mo id="S3.Ex1.m2.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m2.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.Ex1.m2.1.1.1.1.1a" xref="S3.Ex1.m2.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex1.m2.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.3.1" xref="S3.Ex1.m2.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.Ex1.m2.1.1.1.1.1.1.3a" xref="S3.Ex1.m2.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.Ex1.m2.1.1.1.1.1.1.3.2.3" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">U</mi></mrow></msub><mo fence="false" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m2.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.1b"><apply id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1"><eq id="S3.Ex1.m2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex1.m2.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.3">absent</csymbol><apply id="S3.Ex1.m2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1"><minus id="S3.Ex1.m2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1"></minus><apply id="S3.Ex1.m2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1"><times id="S3.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.2"></times><apply id="S3.Ex1.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3"><log id="S3.Ex1.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3.1"></log><apply id="S3.Ex1.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.Ex1.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2">𝐥</ci><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3"><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle=-\log P_{\bm{\theta}}({\mathbf{l}}_{1:U}|\mathbf{x}_{1:T}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle=-\log\ \sum_{\bm{z}_{1:T}}P_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})\ \mathbf{1}_{{\mathbf{l}}_{1:U}}(\bm{z}_{1:T})," display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"></mi><mo id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="S3.E1.m1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.4.cmml">log</mi><mo lspace="0.667em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml"><munder id="S3.E1.m1.1.1.1.1.2.2.2.3a" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.2.cmml">∑</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.2.cmml">𝒛</mi><mrow id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.cmml"><mn id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.1" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.3.cmml">T</mi></mrow></msub></munder></mstyle><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.4.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4.2.cmml">P</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.4.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.2.2.3a" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.2.cmml"> 1</mn><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.2.cmml">𝐥</mi><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.cmml"><mn id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.3.cmml">U</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.2.2.3b" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.2.cmml">𝒛</mi><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4">absent</csymbol><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><minus id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2"></minus><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"></times><log id="S3.E1.m1.1.1.1.1.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.2.4"></log><apply id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"><apply id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.2">𝒛</ci><apply id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3"><ci id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.1">:</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3.3.3.3">𝑇</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3"></times><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4.2">𝑃</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.4.3">𝜽</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.5.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5">subscript</csymbol><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.2">1</cn><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.2">𝐥</ci><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3"><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.1">:</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.5.3.3.3">𝑈</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.2">𝒛</ci><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3"><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.1">:</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle=-\log\ \sum_{\bm{z}_{1:T}}P_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})\ \mathbf{1}_{{\mathbf{l}}_{1:U}}(\bm{z}_{1:T}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\displaystyle=-\log\ \sum_{\bm{z}_{1:T}}\Big{[}\prod_{t}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})\Big{]}\mathbf{1}_{{\mathbf{l}}_{1:U}}(\bm{z}_{1:T})" display="inline"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mi id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"></mi><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E2.m1.2.2.2a" xref="S3.E2.m1.2.2.2.cmml">−</mo><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.4.cmml">log</mi><mo lspace="0.667em" rspace="0em" id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><munder id="S3.E2.m1.2.2.2.2.2.3a" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.3.2.cmml">∑</mo><msub id="S3.E2.m1.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.3.3.2" xref="S3.E2.m1.2.2.2.2.2.3.3.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.2.2.2.3.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.3.cmml"><mn id="S3.E2.m1.2.2.2.2.2.3.3.3.2" xref="S3.E2.m1.2.2.2.2.2.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m1.2.2.2.2.2.3.3.3.1" xref="S3.E2.m1.2.2.2.2.2.3.3.3.1.cmml">:</mo><mi id="S3.E2.m1.2.2.2.2.2.3.3.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.3.3.cmml">T</mi></mrow></msub></munder></mstyle><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="160%" minsize="160%" id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><munderover id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∏</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="160%" minsize="160%" id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">​</mo><msub id="S3.E2.m1.2.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.2.4.cmml"><mn id="S3.E2.m1.2.2.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.2.2.4.2.cmml">𝟏</mn><msub id="S3.E2.m1.2.2.2.2.2.2.4.3" xref="S3.E2.m1.2.2.2.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.4.3.2" xref="S3.E2.m1.2.2.2.2.2.2.4.3.2.cmml">𝐥</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.cmml"><mn id="S3.E2.m1.2.2.2.2.2.2.4.3.3.2" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m1.2.2.2.2.2.2.4.3.3.1" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.1.cmml">:</mo><mi id="S3.E2.m1.2.2.2.2.2.2.4.3.3.3" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.3.cmml">U</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.3a" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.cmml"><mn id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.1.cmml">:</mo><mi id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><csymbol cd="latexml" id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4">absent</csymbol><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><minus id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2"></minus><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"></times><log id="S3.E2.m1.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.4"></log><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><apply id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2"></sum><apply id="S3.E2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3.2">𝒛</ci><apply id="S3.E2.m1.2.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3.3"><ci id="S3.E2.m1.2.2.2.2.2.3.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3.3.1">:</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.2.3.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3.3.2">1</cn><ci id="S3.E2.m1.2.2.2.2.2.3.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3.3.3">𝑇</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2">product</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4">subscript</csymbol><cn type="integer" id="S3.E2.m1.2.2.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.2">1</cn><apply id="S3.E2.m1.2.2.2.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.2">𝐥</ci><apply id="S3.E2.m1.2.2.2.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3"><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.1">:</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.2.2.4.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.2">1</cn><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.3">𝑈</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.2">𝒛</ci><apply id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3"><ci id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.1">:</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.2">1</cn><ci id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle=-\log\ \sum_{\bm{z}_{1:T}}\Big{[}\prod_{t}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})\Big{]}\mathbf{1}_{{\mathbf{l}}_{1:U}}(\bm{z}_{1:T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.2" class="ltx_p">Eqn(<a href="#S3.E1" title="In 3 The CTC Model ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) illustrates how the restriction imposed by the characteristic function gives rise to the implicit discrete latent variable model, while eqn(<a href="#S3.E2" title="In 3 The CTC Model ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) corresponds to the CTC independence assumption. Conditioned on this specific choice of discriminative model, acoustic encoder mapping <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\bm{e}_{t}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">𝒆</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝒆</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\bm{e}_{t}</annotation></semantics></math>, and model parameters <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\bm{\theta}</annotation></semantics></math>,</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\displaystyle\hat{\bm{z}}_{1:T}(\bm{\theta})=\operatorname*{arg\,max}_{\bm{z}_{1:T}:\mathbb{B}(\bm{z}_{1:T})=\mathbf{l}_{1:U}}\prod_{t}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})" display="inline"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><msub id="S3.E3.m1.3.3.3.2" xref="S3.E3.m1.3.3.3.2.cmml"><mover accent="true" id="S3.E3.m1.3.3.3.2.2" xref="S3.E3.m1.3.3.3.2.2.cmml"><mi id="S3.E3.m1.3.3.3.2.2.2" xref="S3.E3.m1.3.3.3.2.2.2.cmml">𝒛</mi><mo id="S3.E3.m1.3.3.3.2.2.1" xref="S3.E3.m1.3.3.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E3.m1.3.3.3.2.3" xref="S3.E3.m1.3.3.3.2.3.cmml"><mn id="S3.E3.m1.3.3.3.2.3.2" xref="S3.E3.m1.3.3.3.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.3.3.3.2.3.1" xref="S3.E3.m1.3.3.3.2.3.1.cmml">:</mo><mi id="S3.E3.m1.3.3.3.2.3.3" xref="S3.E3.m1.3.3.3.2.3.3.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.1" xref="S3.E3.m1.3.3.3.1.cmml">​</mo><mrow id="S3.E3.m1.3.3.3.3.2" xref="S3.E3.m1.3.3.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.3.3.2.1" xref="S3.E3.m1.3.3.3.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="S3.E3.m1.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.cmml"><munder id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.3.3.1.3.cmml"><mrow id="S3.E3.m1.3.3.1.3.2" xref="S3.E3.m1.3.3.1.3.2.cmml"><mi id="S3.E3.m1.3.3.1.3.2.2" xref="S3.E3.m1.3.3.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E3.m1.3.3.1.3.2.1" xref="S3.E3.m1.3.3.1.3.2.1.cmml">​</mo><mi id="S3.E3.m1.3.3.1.3.2.3" xref="S3.E3.m1.3.3.1.3.2.3.cmml">max</mi></mrow><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">𝒛</mi><mrow id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml"><mn id="S3.E3.m1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.1.1.1.3.3.1" xref="S3.E3.m1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.3.3.3.cmml">T</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">:</mo><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><msub id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">𝐥</mi><mrow id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml"><mn id="S3.E3.m1.1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.1.1.1.1.3.3.1" xref="S3.E3.m1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.3.3.3.cmml">U</mi></mrow></msub></mrow></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><munderover id="S3.E3.m1.3.3.1.1.2a" xref="S3.E3.m1.3.3.1.1.2.cmml"><mo movablelimits="false" id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.cmml">∏</mo><mi id="S3.E3.m1.3.3.1.1.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml">t</mi><mi id="S3.E3.m1.3.3.1.1.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.3.2.cmml">P</mi><mi id="S3.E3.m1.3.3.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><eq id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"></eq><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><times id="S3.E3.m1.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.1"></times><apply id="S3.E3.m1.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.2">subscript</csymbol><apply id="S3.E3.m1.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.2.2"><ci id="S3.E3.m1.3.3.3.2.2.1.cmml" xref="S3.E3.m1.3.3.3.2.2.1">^</ci><ci id="S3.E3.m1.3.3.3.2.2.2.cmml" xref="S3.E3.m1.3.3.3.2.2.2">𝒛</ci></apply><apply id="S3.E3.m1.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.2.3"><ci id="S3.E3.m1.3.3.3.2.3.1.cmml" xref="S3.E3.m1.3.3.3.2.3.1">:</ci><cn type="integer" id="S3.E3.m1.3.3.3.2.3.2.cmml" xref="S3.E3.m1.3.3.3.2.3.2">1</cn><ci id="S3.E3.m1.3.3.3.2.3.3.cmml" xref="S3.E3.m1.3.3.3.2.3.3">𝑇</ci></apply></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝜽</ci></apply><apply id="S3.E3.m1.3.3.1.cmml" xref="S3.E3.m1.3.3.1"><times id="S3.E3.m1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1.2"></times><apply id="S3.E3.m1.3.3.1.3.cmml" xref="S3.E3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.3.1.cmml" xref="S3.E3.m1.3.3.1.3">subscript</csymbol><apply id="S3.E3.m1.3.3.1.3.2.cmml" xref="S3.E3.m1.3.3.1.3.2"><times id="S3.E3.m1.3.3.1.3.2.1.cmml" xref="S3.E3.m1.3.3.1.3.2.1"></times><ci id="S3.E3.m1.3.3.1.3.2.2.cmml" xref="S3.E3.m1.3.3.1.3.2.2">arg</ci><ci id="S3.E3.m1.3.3.1.3.2.3.cmml" xref="S3.E3.m1.3.3.1.3.2.3">max</ci></apply><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><ci id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2">:</ci><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝒛</ci><apply id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3"><ci id="S3.E3.m1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E3.m1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.3.3.2">1</cn><ci id="S3.E3.m1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝔹</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">𝒛</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3"><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2">𝐥</ci><apply id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3"><ci id="S3.E3.m1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3">𝑈</ci></apply></apply></apply></apply></apply><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2">product</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.3">𝑇</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2">𝑃</ci><ci id="S3.E3.m1.3.3.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3.3">𝜽</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2">𝒛</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3"><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle\hat{\bm{z}}_{1:T}(\bm{\theta})=\operatorname*{arg\,max}_{\bm{z}_{1:T}:\mathbb{B}(\bm{z}_{1:T})=\mathbf{l}_{1:U}}\prod_{t}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.3" class="ltx_p">corresponds to the CTC alignment generated by the model for the input-label sequence pair <math id="S3.p2.3.m1.2" class="ltx_Math" alttext="(\mathbf{x}_{1:T},\mathbf{l}_{1:U})" display="inline"><semantics id="S3.p2.3.m1.2a"><mrow id="S3.p2.3.m1.2.2.2" xref="S3.p2.3.m1.2.2.3.cmml"><mo stretchy="false" id="S3.p2.3.m1.2.2.2.3" xref="S3.p2.3.m1.2.2.3.cmml">(</mo><msub id="S3.p2.3.m1.1.1.1.1" xref="S3.p2.3.m1.1.1.1.1.cmml"><mi id="S3.p2.3.m1.1.1.1.1.2" xref="S3.p2.3.m1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.p2.3.m1.1.1.1.1.3" xref="S3.p2.3.m1.1.1.1.1.3.cmml"><mn id="S3.p2.3.m1.1.1.1.1.3.2" xref="S3.p2.3.m1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p2.3.m1.1.1.1.1.3.1" xref="S3.p2.3.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.p2.3.m1.1.1.1.1.3.3" xref="S3.p2.3.m1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.p2.3.m1.2.2.2.4" xref="S3.p2.3.m1.2.2.3.cmml">,</mo><msub id="S3.p2.3.m1.2.2.2.2" xref="S3.p2.3.m1.2.2.2.2.cmml"><mi id="S3.p2.3.m1.2.2.2.2.2" xref="S3.p2.3.m1.2.2.2.2.2.cmml">𝐥</mi><mrow id="S3.p2.3.m1.2.2.2.2.3" xref="S3.p2.3.m1.2.2.2.2.3.cmml"><mn id="S3.p2.3.m1.2.2.2.2.3.2" xref="S3.p2.3.m1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p2.3.m1.2.2.2.2.3.1" xref="S3.p2.3.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S3.p2.3.m1.2.2.2.2.3.3" xref="S3.p2.3.m1.2.2.2.2.3.3.cmml">U</mi></mrow></msub><mo stretchy="false" id="S3.p2.3.m1.2.2.2.5" xref="S3.p2.3.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m1.2b"><interval closure="open" id="S3.p2.3.m1.2.2.3.cmml" xref="S3.p2.3.m1.2.2.2"><apply id="S3.p2.3.m1.1.1.1.1.cmml" xref="S3.p2.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m1.1.1.1.1.1.cmml" xref="S3.p2.3.m1.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m1.1.1.1.1.2.cmml" xref="S3.p2.3.m1.1.1.1.1.2">𝐱</ci><apply id="S3.p2.3.m1.1.1.1.1.3.cmml" xref="S3.p2.3.m1.1.1.1.1.3"><ci id="S3.p2.3.m1.1.1.1.1.3.1.cmml" xref="S3.p2.3.m1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.p2.3.m1.1.1.1.1.3.2.cmml" xref="S3.p2.3.m1.1.1.1.1.3.2">1</cn><ci id="S3.p2.3.m1.1.1.1.1.3.3.cmml" xref="S3.p2.3.m1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S3.p2.3.m1.2.2.2.2.cmml" xref="S3.p2.3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.3.m1.2.2.2.2.1.cmml" xref="S3.p2.3.m1.2.2.2.2">subscript</csymbol><ci id="S3.p2.3.m1.2.2.2.2.2.cmml" xref="S3.p2.3.m1.2.2.2.2.2">𝐥</ci><apply id="S3.p2.3.m1.2.2.2.2.3.cmml" xref="S3.p2.3.m1.2.2.2.2.3"><ci id="S3.p2.3.m1.2.2.2.2.3.1.cmml" xref="S3.p2.3.m1.2.2.2.2.3.1">:</ci><cn type="integer" id="S3.p2.3.m1.2.2.2.2.3.2.cmml" xref="S3.p2.3.m1.2.2.2.2.3.2">1</cn><ci id="S3.p2.3.m1.2.2.2.2.3.3.cmml" xref="S3.p2.3.m1.2.2.2.2.3.3">𝑈</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m1.2c">(\mathbf{x}_{1:T},\mathbf{l}_{1:U})</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>FDT algorithm </h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This work introduces a two-stage iterative algorithm called FDT-‘Focused Discriminative Training’. The algorithm consists of 3 essential components: implicit data selection coupled, an error region detection system and a CTC based contrastive segment loss. The first component enables the algorithm to focus on challenging utterances. For such utterances, the error detection component aims to identify the regions where mis-recognition occurs. Subsequently, by employing a contrastive segment loss, the algorithm aims to enhance recognition performance within these identified error regions.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.5" class="ltx_p">The algorithm works very similar to the EM algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> to minimise the errors seen w.r.t a particular utterance reference word sequence pair <math id="S4.p2.1.m1.2" class="ltx_Math" alttext="(\mathbf{x}_{1:T},\mathbf{W}^{r}_{1:k})" display="inline"><semantics id="S4.p2.1.m1.2a"><mrow id="S4.p2.1.m1.2.2.2" xref="S4.p2.1.m1.2.2.3.cmml"><mo stretchy="false" id="S4.p2.1.m1.2.2.2.3" xref="S4.p2.1.m1.2.2.3.cmml">(</mo><msub id="S4.p2.1.m1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S4.p2.1.m1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.3.cmml"><mn id="S4.p2.1.m1.1.1.1.1.3.2" xref="S4.p2.1.m1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.1.m1.1.1.1.1.3.1" xref="S4.p2.1.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.p2.1.m1.1.1.1.1.3.3" xref="S4.p2.1.m1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S4.p2.1.m1.2.2.2.4" xref="S4.p2.1.m1.2.2.3.cmml">,</mo><msubsup id="S4.p2.1.m1.2.2.2.2" xref="S4.p2.1.m1.2.2.2.2.cmml"><mi id="S4.p2.1.m1.2.2.2.2.2.2" xref="S4.p2.1.m1.2.2.2.2.2.2.cmml">𝐖</mi><mrow id="S4.p2.1.m1.2.2.2.2.3" xref="S4.p2.1.m1.2.2.2.2.3.cmml"><mn id="S4.p2.1.m1.2.2.2.2.3.2" xref="S4.p2.1.m1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.1.m1.2.2.2.2.3.1" xref="S4.p2.1.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S4.p2.1.m1.2.2.2.2.3.3" xref="S4.p2.1.m1.2.2.2.2.3.3.cmml">k</mi></mrow><mi id="S4.p2.1.m1.2.2.2.2.2.3" xref="S4.p2.1.m1.2.2.2.2.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S4.p2.1.m1.2.2.2.5" xref="S4.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.2b"><interval closure="open" id="S4.p2.1.m1.2.2.3.cmml" xref="S4.p2.1.m1.2.2.2"><apply id="S4.p2.1.m1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.1.2">𝐱</ci><apply id="S4.p2.1.m1.1.1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3"><ci id="S4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.1.1.3.2">1</cn><ci id="S4.p2.1.m1.1.1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.p2.1.m1.2.2.2.2.cmml" xref="S4.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.2.2.2.2.1.cmml" xref="S4.p2.1.m1.2.2.2.2">subscript</csymbol><apply id="S4.p2.1.m1.2.2.2.2.2.cmml" xref="S4.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.2.2.2.2.2.1.cmml" xref="S4.p2.1.m1.2.2.2.2">superscript</csymbol><ci id="S4.p2.1.m1.2.2.2.2.2.2.cmml" xref="S4.p2.1.m1.2.2.2.2.2.2">𝐖</ci><ci id="S4.p2.1.m1.2.2.2.2.2.3.cmml" xref="S4.p2.1.m1.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.p2.1.m1.2.2.2.2.3.cmml" xref="S4.p2.1.m1.2.2.2.2.3"><ci id="S4.p2.1.m1.2.2.2.2.3.1.cmml" xref="S4.p2.1.m1.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.p2.1.m1.2.2.2.2.3.2.cmml" xref="S4.p2.1.m1.2.2.2.2.3.2">1</cn><ci id="S4.p2.1.m1.2.2.2.2.3.3.cmml" xref="S4.p2.1.m1.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.2c">(\mathbf{x}_{1:T},\mathbf{W}^{r}_{1:k})</annotation></semantics></math>. To align with the EM algorithm’s terminology, in the “E” step, the current parameter vector <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="\bm{\theta}^{\rm{old}}" display="inline"><semantics id="S4.p2.2.m2.1a"><msup id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">𝜽</mi><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">old</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">superscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝜽</ci><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">old</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\bm{\theta}^{\rm{old}}</annotation></semantics></math> is used to find the posterior distribution <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><msub id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml"><mi id="S4.p2.3.m3.1.1.3.2" xref="S4.p2.3.m3.1.1.3.2.cmml">P</mi><msup id="S4.p2.3.m3.1.1.3.3" xref="S4.p2.3.m3.1.1.3.3.cmml"><mi id="S4.p2.3.m3.1.1.3.3.2" xref="S4.p2.3.m3.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.p2.3.m3.1.1.3.3.3" xref="S4.p2.3.m3.1.1.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S4.p2.3.m3.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.3.m3.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.cmml"><msub id="S4.p2.3.m3.1.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.p2.3.m3.1.1.1.1.1.2.2" xref="S4.p2.3.m3.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S4.p2.3.m3.1.1.1.1.1.2.3" xref="S4.p2.3.m3.1.1.1.1.1.2.3.cmml"><mn id="S4.p2.3.m3.1.1.1.1.1.2.3.2" xref="S4.p2.3.m3.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.3.m3.1.1.1.1.1.2.3.1" xref="S4.p2.3.m3.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.p2.3.m3.1.1.1.1.1.2.3.3" xref="S4.p2.3.m3.1.1.1.1.1.2.3.3.cmml">L</mi></mrow></msub><mo fence="false" id="S4.p2.3.m3.1.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S4.p2.3.m3.1.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.p2.3.m3.1.1.1.1.1.3.2" xref="S4.p2.3.m3.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.p2.3.m3.1.1.1.1.1.3.3" xref="S4.p2.3.m3.1.1.1.1.1.3.3.cmml"><mn id="S4.p2.3.m3.1.1.1.1.1.3.3.2" xref="S4.p2.3.m3.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.3.m3.1.1.1.1.1.3.3.1" xref="S4.p2.3.m3.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.p2.3.m3.1.1.1.1.1.3.3.3" xref="S4.p2.3.m3.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><times id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2"></times><apply id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.3.1.cmml" xref="S4.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.p2.3.m3.1.1.3.2.cmml" xref="S4.p2.3.m3.1.1.3.2">𝑃</ci><apply id="S4.p2.3.m3.1.1.3.3.cmml" xref="S4.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.3.3.1.cmml" xref="S4.p2.3.m3.1.1.3.3">superscript</csymbol><ci id="S4.p2.3.m3.1.1.3.3.2.cmml" xref="S4.p2.3.m3.1.1.3.3.2">𝜽</ci><ci id="S4.p2.3.m3.1.1.3.3.3.cmml" xref="S4.p2.3.m3.1.1.3.3.3">old</ci></apply></apply><apply id="S4.p2.3.m3.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S4.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2.2">𝐖</ci><apply id="S4.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2.3"><ci id="S4.p2.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.p2.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2.3.2">1</cn><ci id="S4.p2.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2.3.3">𝐿</ci></apply></apply><apply id="S4.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3.3"><ci id="S4.p2.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.p2.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3.3.2">1</cn><ci id="S4.p2.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})</annotation></semantics></math>. The posterior distribution is then used to find the expected loss evaluated for some parameter vector <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\bm{\theta}</annotation></semantics></math>. The expectation denoted by <math id="S4.p2.5.m5.2" class="ltx_Math" alttext="\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})" display="inline"><semantics id="S4.p2.5.m5.2a"><mrow id="S4.p2.5.m5.2.2" xref="S4.p2.5.m5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.5.m5.2.2.3" xref="S4.p2.5.m5.2.2.3.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="S4.p2.5.m5.2.2.2" xref="S4.p2.5.m5.2.2.2.cmml">​</mo><mrow id="S4.p2.5.m5.2.2.1.1" xref="S4.p2.5.m5.2.2.1.2.cmml"><mo stretchy="false" id="S4.p2.5.m5.2.2.1.1.2" xref="S4.p2.5.m5.2.2.1.2.cmml">(</mo><msup id="S4.p2.5.m5.2.2.1.1.1" xref="S4.p2.5.m5.2.2.1.1.1.cmml"><mi id="S4.p2.5.m5.2.2.1.1.1.2" xref="S4.p2.5.m5.2.2.1.1.1.2.cmml">𝜽</mi><mi id="S4.p2.5.m5.2.2.1.1.1.3" xref="S4.p2.5.m5.2.2.1.1.1.3.cmml">old</mi></msup><mo id="S4.p2.5.m5.2.2.1.1.3" xref="S4.p2.5.m5.2.2.1.2.cmml">,</mo><mi id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.p2.5.m5.2.2.1.1.4" xref="S4.p2.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.2b"><apply id="S4.p2.5.m5.2.2.cmml" xref="S4.p2.5.m5.2.2"><times id="S4.p2.5.m5.2.2.2.cmml" xref="S4.p2.5.m5.2.2.2"></times><ci id="S4.p2.5.m5.2.2.3.cmml" xref="S4.p2.5.m5.2.2.3">𝒬</ci><interval closure="open" id="S4.p2.5.m5.2.2.1.2.cmml" xref="S4.p2.5.m5.2.2.1.1"><apply id="S4.p2.5.m5.2.2.1.1.1.cmml" xref="S4.p2.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.2.2.1.1.1.1.cmml" xref="S4.p2.5.m5.2.2.1.1.1">superscript</csymbol><ci id="S4.p2.5.m5.2.2.1.1.1.2.cmml" xref="S4.p2.5.m5.2.2.1.1.1.2">𝜽</ci><ci id="S4.p2.5.m5.2.2.1.1.1.3.cmml" xref="S4.p2.5.m5.2.2.1.1.1.3">old</ci></apply><ci id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.2c">\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})</annotation></semantics></math> is given by:</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})" display="inline"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.2.2.3" xref="S4.E4.m1.2.2.3.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.2.cmml">(</mo><msup id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.2.cmml">𝜽</mi><mi id="S4.E4.m1.2.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.3.cmml">old</mi></msup><mo id="S4.E4.m1.2.2.1.1.3" xref="S4.E4.m1.2.2.1.2.cmml">,</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.E4.m1.2.2.1.1.4" xref="S4.E4.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"><times id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2.2"></times><ci id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2.3">𝒬</ci><interval closure="open" id="S4.E4.m1.2.2.1.2.cmml" xref="S4.E4.m1.2.2.1.1"><apply id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1">superscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.2">𝜽</ci><ci id="S4.E4.m1.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3">old</ci></apply><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\displaystyle\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{\mathbf{W}_{1:L}}P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})\ \ \mathcal{L}(\bm{\theta},\mathbf{W}_{1:L},\mathbf{W}^{r}_{1:k}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.E4.m2.3a"><mrow id="S4.E4.m2.3.3" xref="S4.E4.m2.3.3.cmml"><mi id="S4.E4.m2.3.3.4" xref="S4.E4.m2.3.3.4.cmml"></mi><mo id="S4.E4.m2.3.3.3" xref="S4.E4.m2.3.3.3.cmml">=</mo><mrow id="S4.E4.m2.3.3.2.2" xref="S4.E4.m2.3.3.2.3.cmml"><mrow id="S4.E4.m2.2.2.1.1.1" xref="S4.E4.m2.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m2.2.2.1.1.1.2" xref="S4.E4.m2.2.2.1.1.1.2.cmml"><munder id="S4.E4.m2.2.2.1.1.1.2a" xref="S4.E4.m2.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4.m2.2.2.1.1.1.2.2" xref="S4.E4.m2.2.2.1.1.1.2.2.cmml">∑</mo><msub id="S4.E4.m2.2.2.1.1.1.2.3" xref="S4.E4.m2.2.2.1.1.1.2.3.cmml"><mi id="S4.E4.m2.2.2.1.1.1.2.3.2" xref="S4.E4.m2.2.2.1.1.1.2.3.2.cmml">𝐖</mi><mrow id="S4.E4.m2.2.2.1.1.1.2.3.3" xref="S4.E4.m2.2.2.1.1.1.2.3.3.cmml"><mn id="S4.E4.m2.2.2.1.1.1.2.3.3.2" xref="S4.E4.m2.2.2.1.1.1.2.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.2.2.1.1.1.2.3.3.1" xref="S4.E4.m2.2.2.1.1.1.2.3.3.1.cmml">:</mo><mi id="S4.E4.m2.2.2.1.1.1.2.3.3.3" xref="S4.E4.m2.2.2.1.1.1.2.3.3.3.cmml">L</mi></mrow></msub></munder></mstyle><mrow id="S4.E4.m2.2.2.1.1.1.1" xref="S4.E4.m2.2.2.1.1.1.1.cmml"><msub id="S4.E4.m2.2.2.1.1.1.1.3" xref="S4.E4.m2.2.2.1.1.1.1.3.cmml"><mi id="S4.E4.m2.2.2.1.1.1.1.3.2" xref="S4.E4.m2.2.2.1.1.1.1.3.2.cmml">P</mi><msup id="S4.E4.m2.2.2.1.1.1.1.3.3" xref="S4.E4.m2.2.2.1.1.1.1.3.3.cmml"><mi id="S4.E4.m2.2.2.1.1.1.1.3.3.2" xref="S4.E4.m2.2.2.1.1.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.E4.m2.2.2.1.1.1.1.3.3.3" xref="S4.E4.m2.2.2.1.1.1.1.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.E4.m2.2.2.1.1.1.1.2" xref="S4.E4.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m2.2.2.1.1.1.1.1.1" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m2.2.2.1.1.1.1.1.1.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m2.2.2.1.1.1.1.1.1.1" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mn id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">L</mi></mrow></msub><mo fence="false" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.1" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.cmml"><mn id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.2" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.1" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E4.m2.2.2.1.1.1.1.1.1.3" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace width="1em" id="S4.E4.m2.3.3.2.2.3" xref="S4.E4.m2.3.3.2.3.cmml"></mspace><mrow id="S4.E4.m2.3.3.2.2.2" xref="S4.E4.m2.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m2.3.3.2.2.2.4" xref="S4.E4.m2.3.3.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m2.3.3.2.2.2.3" xref="S4.E4.m2.3.3.2.2.2.3.cmml">​</mo><mrow id="S4.E4.m2.3.3.2.2.2.2.2" xref="S4.E4.m2.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m2.3.3.2.2.2.2.2.3" xref="S4.E4.m2.3.3.2.2.2.2.3.cmml">(</mo><mi id="S4.E4.m2.1.1" xref="S4.E4.m2.1.1.cmml">𝜽</mi><mo id="S4.E4.m2.3.3.2.2.2.2.2.4" xref="S4.E4.m2.3.3.2.2.2.2.3.cmml">,</mo><msub id="S4.E4.m2.3.3.2.2.2.1.1.1" xref="S4.E4.m2.3.3.2.2.2.1.1.1.cmml"><mi id="S4.E4.m2.3.3.2.2.2.1.1.1.2" xref="S4.E4.m2.3.3.2.2.2.1.1.1.2.cmml">𝐖</mi><mrow id="S4.E4.m2.3.3.2.2.2.1.1.1.3" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.cmml"><mn id="S4.E4.m2.3.3.2.2.2.1.1.1.3.2" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.3.3.2.2.2.1.1.1.3.1" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.1.cmml">:</mo><mi id="S4.E4.m2.3.3.2.2.2.1.1.1.3.3" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.3.cmml">L</mi></mrow></msub><mo id="S4.E4.m2.3.3.2.2.2.2.2.5" xref="S4.E4.m2.3.3.2.2.2.2.3.cmml">,</mo><mrow id="S4.E4.m2.3.3.2.2.2.2.2.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.cmml"><msubsup id="S4.E4.m2.3.3.2.2.2.2.2.2.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.cmml"><mi id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.2.cmml">𝐖</mi><mrow id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.cmml"><mn id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.1" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.1.cmml">:</mo><mi id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.3.cmml">k</mi></mrow><mi id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.3.cmml">r</mi></msubsup><mo fence="false" id="S4.E4.m2.3.3.2.2.2.2.2.2.1" xref="S4.E4.m2.3.3.2.2.2.2.2.2.1.cmml">|</mo><msub id="S4.E4.m2.3.3.2.2.2.2.2.2.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.cmml"><mi id="S4.E4.m2.3.3.2.2.2.2.2.2.3.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.2.cmml">𝐱</mi><mrow id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.cmml"><mn id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.2" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.1" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.1.cmml">:</mo><mi id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.3" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E4.m2.3.3.2.2.2.2.2.6" xref="S4.E4.m2.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.3b"><apply id="S4.E4.m2.3.3.cmml" xref="S4.E4.m2.3.3"><eq id="S4.E4.m2.3.3.3.cmml" xref="S4.E4.m2.3.3.3"></eq><csymbol cd="latexml" id="S4.E4.m2.3.3.4.cmml" xref="S4.E4.m2.3.3.4">absent</csymbol><list id="S4.E4.m2.3.3.2.3.cmml" xref="S4.E4.m2.3.3.2.2"><apply id="S4.E4.m2.2.2.1.1.1.cmml" xref="S4.E4.m2.2.2.1.1.1"><apply id="S4.E4.m2.2.2.1.1.1.2.cmml" xref="S4.E4.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.2.1.cmml" xref="S4.E4.m2.2.2.1.1.1.2">subscript</csymbol><sum id="S4.E4.m2.2.2.1.1.1.2.2.cmml" xref="S4.E4.m2.2.2.1.1.1.2.2"></sum><apply id="S4.E4.m2.2.2.1.1.1.2.3.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.2.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E4.m2.2.2.1.1.1.2.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3.2">𝐖</ci><apply id="S4.E4.m2.2.2.1.1.1.2.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3.3"><ci id="S4.E4.m2.2.2.1.1.1.2.3.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3.3.1">:</ci><cn type="integer" id="S4.E4.m2.2.2.1.1.1.2.3.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3.3.2">1</cn><ci id="S4.E4.m2.2.2.1.1.1.2.3.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.2.3.3.3">𝐿</ci></apply></apply></apply><apply id="S4.E4.m2.2.2.1.1.1.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1"><times id="S4.E4.m2.2.2.1.1.1.1.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.2"></times><apply id="S4.E4.m2.2.2.1.1.1.1.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.1.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m2.2.2.1.1.1.1.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3.2">𝑃</ci><apply id="S4.E4.m2.2.2.1.1.1.1.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E4.m2.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3.3.2">𝜽</ci><ci id="S4.E4.m2.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.3.3.3">old</ci></apply></apply><apply id="S4.E4.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.2">𝐖</ci><apply id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3"><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.2.3.3">𝐿</ci></apply></apply><apply id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3"><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m2.2.2.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></apply><apply id="S4.E4.m2.3.3.2.2.2.cmml" xref="S4.E4.m2.3.3.2.2.2"><times id="S4.E4.m2.3.3.2.2.2.3.cmml" xref="S4.E4.m2.3.3.2.2.2.3"></times><ci id="S4.E4.m2.3.3.2.2.2.4.cmml" xref="S4.E4.m2.3.3.2.2.2.4">ℒ</ci><vector id="S4.E4.m2.3.3.2.2.2.2.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2"><ci id="S4.E4.m2.1.1.cmml" xref="S4.E4.m2.1.1">𝜽</ci><apply id="S4.E4.m2.3.3.2.2.2.1.1.1.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.3.3.2.2.2.1.1.1.1.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E4.m2.3.3.2.2.2.1.1.1.2.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1.2">𝐖</ci><apply id="S4.E4.m2.3.3.2.2.2.1.1.1.3.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3"><ci id="S4.E4.m2.3.3.2.2.2.1.1.1.3.1.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.1">:</ci><cn type="integer" id="S4.E4.m2.3.3.2.2.2.1.1.1.3.2.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.2">1</cn><ci id="S4.E4.m2.3.3.2.2.2.1.1.1.3.3.cmml" xref="S4.E4.m2.3.3.2.2.2.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2"><csymbol cd="latexml" id="S4.E4.m2.3.3.2.2.2.2.2.2.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.1">conditional</csymbol><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m2.3.3.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2">superscript</csymbol><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.2">𝐖</ci><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3"><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.2">1</cn><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m2.3.3.2.2.2.2.2.2.3.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.3.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.2">𝐱</ci><apply id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3"><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.1.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.1">:</ci><cn type="integer" id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.2.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.2">1</cn><ci id="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.3.cmml" xref="S4.E4.m2.3.3.2.2.2.2.2.2.3.3.3">𝑇</ci></apply></apply></apply></vector></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.3c">\displaystyle=\sum_{\mathbf{W}_{1:L}}P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})\ \ \mathcal{L}(\bm{\theta},\mathbf{W}_{1:L},\mathbf{W}^{r}_{1:k}|\mathbf{x}_{1:T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.6" class="ltx_p">In the “M” step, a revised parameter estimate <math id="S4.p2.6.m1.1" class="ltx_Math" alttext="\bm{\theta}^{\rm{new}}" display="inline"><semantics id="S4.p2.6.m1.1a"><msup id="S4.p2.6.m1.1.1" xref="S4.p2.6.m1.1.1.cmml"><mi id="S4.p2.6.m1.1.1.2" xref="S4.p2.6.m1.1.1.2.cmml">𝜽</mi><mi id="S4.p2.6.m1.1.1.3" xref="S4.p2.6.m1.1.1.3.cmml">new</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p2.6.m1.1b"><apply id="S4.p2.6.m1.1.1.cmml" xref="S4.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.6.m1.1.1.1.cmml" xref="S4.p2.6.m1.1.1">superscript</csymbol><ci id="S4.p2.6.m1.1.1.2.cmml" xref="S4.p2.6.m1.1.1.2">𝜽</ci><ci id="S4.p2.6.m1.1.1.3.cmml" xref="S4.p2.6.m1.1.1.3">new</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m1.1c">\bm{\theta}^{\rm{new}}</annotation></semantics></math> is determined by minimising the above function:</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex2.m1.2" class="ltx_Math" alttext="\displaystyle\bm{\theta}^{\rm{new}}=\operatorname*{arg\,min}_{\bm{\theta}}\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})" display="inline"><semantics id="S4.Ex2.m1.2a"><mrow id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml"><msup id="S4.Ex2.m1.2.2.3" xref="S4.Ex2.m1.2.2.3.cmml"><mi id="S4.Ex2.m1.2.2.3.2" xref="S4.Ex2.m1.2.2.3.2.cmml">𝜽</mi><mi id="S4.Ex2.m1.2.2.3.3" xref="S4.Ex2.m1.2.2.3.3.cmml">new</mi></msup><mo id="S4.Ex2.m1.2.2.2" xref="S4.Ex2.m1.2.2.2.cmml">=</mo><mrow id="S4.Ex2.m1.2.2.1" xref="S4.Ex2.m1.2.2.1.cmml"><mrow id="S4.Ex2.m1.2.2.1.3" xref="S4.Ex2.m1.2.2.1.3.cmml"><munder id="S4.Ex2.m1.2.2.1.3.1" xref="S4.Ex2.m1.2.2.1.3.1.cmml"><mrow id="S4.Ex2.m1.2.2.1.3.1.2" xref="S4.Ex2.m1.2.2.1.3.1.2.cmml"><mi id="S4.Ex2.m1.2.2.1.3.1.2.2" xref="S4.Ex2.m1.2.2.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.Ex2.m1.2.2.1.3.1.2.1" xref="S4.Ex2.m1.2.2.1.3.1.2.1.cmml">​</mo><mi id="S4.Ex2.m1.2.2.1.3.1.2.3" xref="S4.Ex2.m1.2.2.1.3.1.2.3.cmml">min</mi></mrow><mi id="S4.Ex2.m1.2.2.1.3.1.3" xref="S4.Ex2.m1.2.2.1.3.1.3.cmml">𝜽</mi></munder><mo id="S4.Ex2.m1.2.2.1.3a" xref="S4.Ex2.m1.2.2.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.2.2.1.3.2" xref="S4.Ex2.m1.2.2.1.3.2.cmml">𝒬</mi></mrow><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.2.2.1.2" xref="S4.Ex2.m1.2.2.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.2.2.1.1.1" xref="S4.Ex2.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.2.2.1.1.1.2" xref="S4.Ex2.m1.2.2.1.1.2.cmml">(</mo><msup id="S4.Ex2.m1.2.2.1.1.1.1" xref="S4.Ex2.m1.2.2.1.1.1.1.cmml"><mi id="S4.Ex2.m1.2.2.1.1.1.1.2" xref="S4.Ex2.m1.2.2.1.1.1.1.2.cmml">𝜽</mi><mi id="S4.Ex2.m1.2.2.1.1.1.1.3" xref="S4.Ex2.m1.2.2.1.1.1.1.3.cmml">old</mi></msup><mo id="S4.Ex2.m1.2.2.1.1.1.3" xref="S4.Ex2.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.Ex2.m1.2.2.1.1.1.4" xref="S4.Ex2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.2b"><apply id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2"><eq id="S4.Ex2.m1.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2"></eq><apply id="S4.Ex2.m1.2.2.3.cmml" xref="S4.Ex2.m1.2.2.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.3.1.cmml" xref="S4.Ex2.m1.2.2.3">superscript</csymbol><ci id="S4.Ex2.m1.2.2.3.2.cmml" xref="S4.Ex2.m1.2.2.3.2">𝜽</ci><ci id="S4.Ex2.m1.2.2.3.3.cmml" xref="S4.Ex2.m1.2.2.3.3">new</ci></apply><apply id="S4.Ex2.m1.2.2.1.cmml" xref="S4.Ex2.m1.2.2.1"><times id="S4.Ex2.m1.2.2.1.2.cmml" xref="S4.Ex2.m1.2.2.1.2"></times><apply id="S4.Ex2.m1.2.2.1.3.cmml" xref="S4.Ex2.m1.2.2.1.3"><apply id="S4.Ex2.m1.2.2.1.3.1.cmml" xref="S4.Ex2.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.1.3.1.1.cmml" xref="S4.Ex2.m1.2.2.1.3.1">subscript</csymbol><apply id="S4.Ex2.m1.2.2.1.3.1.2.cmml" xref="S4.Ex2.m1.2.2.1.3.1.2"><times id="S4.Ex2.m1.2.2.1.3.1.2.1.cmml" xref="S4.Ex2.m1.2.2.1.3.1.2.1"></times><ci id="S4.Ex2.m1.2.2.1.3.1.2.2.cmml" xref="S4.Ex2.m1.2.2.1.3.1.2.2">arg</ci><ci id="S4.Ex2.m1.2.2.1.3.1.2.3.cmml" xref="S4.Ex2.m1.2.2.1.3.1.2.3">min</ci></apply><ci id="S4.Ex2.m1.2.2.1.3.1.3.cmml" xref="S4.Ex2.m1.2.2.1.3.1.3">𝜽</ci></apply><ci id="S4.Ex2.m1.2.2.1.3.2.cmml" xref="S4.Ex2.m1.2.2.1.3.2">𝒬</ci></apply><interval closure="open" id="S4.Ex2.m1.2.2.1.1.2.cmml" xref="S4.Ex2.m1.2.2.1.1.1"><apply id="S4.Ex2.m1.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.1.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S4.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1.2">𝜽</ci><ci id="S4.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1.3">old</ci></apply><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝜽</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.2c">\displaystyle\bm{\theta}^{\rm{new}}=\operatorname*{arg\,min}_{\bm{\theta}}\mathcal{Q}(\bm{\theta}^{\rm{old}},\bm{\theta})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.p2.12" class="ltx_p">The goal of the “M” step is to reduce the loss associated with each hypothesis. The probability <math id="S4.p2.7.m1.1" class="ltx_Math" alttext="P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.p2.7.m1.1a"><mrow id="S4.p2.7.m1.1.1" xref="S4.p2.7.m1.1.1.cmml"><msub id="S4.p2.7.m1.1.1.3" xref="S4.p2.7.m1.1.1.3.cmml"><mi id="S4.p2.7.m1.1.1.3.2" xref="S4.p2.7.m1.1.1.3.2.cmml">P</mi><msup id="S4.p2.7.m1.1.1.3.3" xref="S4.p2.7.m1.1.1.3.3.cmml"><mi id="S4.p2.7.m1.1.1.3.3.2" xref="S4.p2.7.m1.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.p2.7.m1.1.1.3.3.3" xref="S4.p2.7.m1.1.1.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.p2.7.m1.1.1.2" xref="S4.p2.7.m1.1.1.2.cmml">​</mo><mrow id="S4.p2.7.m1.1.1.1.1" xref="S4.p2.7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.7.m1.1.1.1.1.2" xref="S4.p2.7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.7.m1.1.1.1.1.1" xref="S4.p2.7.m1.1.1.1.1.1.cmml"><msub id="S4.p2.7.m1.1.1.1.1.1.2" xref="S4.p2.7.m1.1.1.1.1.1.2.cmml"><mi id="S4.p2.7.m1.1.1.1.1.1.2.2" xref="S4.p2.7.m1.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S4.p2.7.m1.1.1.1.1.1.2.3" xref="S4.p2.7.m1.1.1.1.1.1.2.3.cmml"><mn id="S4.p2.7.m1.1.1.1.1.1.2.3.2" xref="S4.p2.7.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.7.m1.1.1.1.1.1.2.3.1" xref="S4.p2.7.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.p2.7.m1.1.1.1.1.1.2.3.3" xref="S4.p2.7.m1.1.1.1.1.1.2.3.3.cmml">L</mi></mrow></msub><mo fence="false" id="S4.p2.7.m1.1.1.1.1.1.1" xref="S4.p2.7.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.p2.7.m1.1.1.1.1.1.3" xref="S4.p2.7.m1.1.1.1.1.1.3.cmml"><mi id="S4.p2.7.m1.1.1.1.1.1.3.2" xref="S4.p2.7.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.p2.7.m1.1.1.1.1.1.3.3" xref="S4.p2.7.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.p2.7.m1.1.1.1.1.1.3.3.2" xref="S4.p2.7.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.7.m1.1.1.1.1.1.3.3.1" xref="S4.p2.7.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.p2.7.m1.1.1.1.1.1.3.3.3" xref="S4.p2.7.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.p2.7.m1.1.1.1.1.3" xref="S4.p2.7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.7.m1.1b"><apply id="S4.p2.7.m1.1.1.cmml" xref="S4.p2.7.m1.1.1"><times id="S4.p2.7.m1.1.1.2.cmml" xref="S4.p2.7.m1.1.1.2"></times><apply id="S4.p2.7.m1.1.1.3.cmml" xref="S4.p2.7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.7.m1.1.1.3.1.cmml" xref="S4.p2.7.m1.1.1.3">subscript</csymbol><ci id="S4.p2.7.m1.1.1.3.2.cmml" xref="S4.p2.7.m1.1.1.3.2">𝑃</ci><apply id="S4.p2.7.m1.1.1.3.3.cmml" xref="S4.p2.7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.7.m1.1.1.3.3.1.cmml" xref="S4.p2.7.m1.1.1.3.3">superscript</csymbol><ci id="S4.p2.7.m1.1.1.3.3.2.cmml" xref="S4.p2.7.m1.1.1.3.3.2">𝜽</ci><ci id="S4.p2.7.m1.1.1.3.3.3.cmml" xref="S4.p2.7.m1.1.1.3.3.3">old</ci></apply></apply><apply id="S4.p2.7.m1.1.1.1.1.1.cmml" xref="S4.p2.7.m1.1.1.1.1"><csymbol cd="latexml" id="S4.p2.7.m1.1.1.1.1.1.1.cmml" xref="S4.p2.7.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p2.7.m1.1.1.1.1.1.2.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.7.m1.1.1.1.1.1.2.1.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.7.m1.1.1.1.1.1.2.2.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2.2">𝐖</ci><apply id="S4.p2.7.m1.1.1.1.1.1.2.3.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2.3"><ci id="S4.p2.7.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.p2.7.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.p2.7.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.p2.7.m1.1.1.1.1.1.2.3.3">𝐿</ci></apply></apply><apply id="S4.p2.7.m1.1.1.1.1.1.3.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.7.m1.1.1.1.1.1.3.1.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.7.m1.1.1.1.1.1.3.2.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.p2.7.m1.1.1.1.1.1.3.3.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3.3"><ci id="S4.p2.7.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.p2.7.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.p2.7.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.p2.7.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m1.1c">P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})</annotation></semantics></math> serves as a measure of how much emphasis the approach should place on reducing errors associated with a specific <math id="S4.p2.8.m2.1" class="ltx_Math" alttext="\mathbf{W}_{1:L}" display="inline"><semantics id="S4.p2.8.m2.1a"><msub id="S4.p2.8.m2.1.1" xref="S4.p2.8.m2.1.1.cmml"><mi id="S4.p2.8.m2.1.1.2" xref="S4.p2.8.m2.1.1.2.cmml">𝐖</mi><mrow id="S4.p2.8.m2.1.1.3" xref="S4.p2.8.m2.1.1.3.cmml"><mn id="S4.p2.8.m2.1.1.3.2" xref="S4.p2.8.m2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.8.m2.1.1.3.1" xref="S4.p2.8.m2.1.1.3.1.cmml">:</mo><mi id="S4.p2.8.m2.1.1.3.3" xref="S4.p2.8.m2.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.8.m2.1b"><apply id="S4.p2.8.m2.1.1.cmml" xref="S4.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.8.m2.1.1.1.cmml" xref="S4.p2.8.m2.1.1">subscript</csymbol><ci id="S4.p2.8.m2.1.1.2.cmml" xref="S4.p2.8.m2.1.1.2">𝐖</ci><apply id="S4.p2.8.m2.1.1.3.cmml" xref="S4.p2.8.m2.1.1.3"><ci id="S4.p2.8.m2.1.1.3.1.cmml" xref="S4.p2.8.m2.1.1.3.1">:</ci><cn type="integer" id="S4.p2.8.m2.1.1.3.2.cmml" xref="S4.p2.8.m2.1.1.3.2">1</cn><ci id="S4.p2.8.m2.1.1.3.3.cmml" xref="S4.p2.8.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m2.1c">\mathbf{W}_{1:L}</annotation></semantics></math>. This enables the prioritisation of the most confusing hypotheses. In the context of a deterministic tokenizer that maps <math id="S4.p2.9.m3.1" class="ltx_Math" alttext="\mathbf{W}_{1:L}" display="inline"><semantics id="S4.p2.9.m3.1a"><msub id="S4.p2.9.m3.1.1" xref="S4.p2.9.m3.1.1.cmml"><mi id="S4.p2.9.m3.1.1.2" xref="S4.p2.9.m3.1.1.2.cmml">𝐖</mi><mrow id="S4.p2.9.m3.1.1.3" xref="S4.p2.9.m3.1.1.3.cmml"><mn id="S4.p2.9.m3.1.1.3.2" xref="S4.p2.9.m3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.9.m3.1.1.3.1" xref="S4.p2.9.m3.1.1.3.1.cmml">:</mo><mi id="S4.p2.9.m3.1.1.3.3" xref="S4.p2.9.m3.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.9.m3.1b"><apply id="S4.p2.9.m3.1.1.cmml" xref="S4.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.9.m3.1.1.1.cmml" xref="S4.p2.9.m3.1.1">subscript</csymbol><ci id="S4.p2.9.m3.1.1.2.cmml" xref="S4.p2.9.m3.1.1.2">𝐖</ci><apply id="S4.p2.9.m3.1.1.3.cmml" xref="S4.p2.9.m3.1.1.3"><ci id="S4.p2.9.m3.1.1.3.1.cmml" xref="S4.p2.9.m3.1.1.3.1">:</ci><cn type="integer" id="S4.p2.9.m3.1.1.3.2.cmml" xref="S4.p2.9.m3.1.1.3.2">1</cn><ci id="S4.p2.9.m3.1.1.3.3.cmml" xref="S4.p2.9.m3.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m3.1c">\mathbf{W}_{1:L}</annotation></semantics></math> to its associated word-piece sequence <math id="S4.p2.10.m4.1" class="ltx_Math" alttext="\mathbf{l}_{1:U}" display="inline"><semantics id="S4.p2.10.m4.1a"><msub id="S4.p2.10.m4.1.1" xref="S4.p2.10.m4.1.1.cmml"><mi id="S4.p2.10.m4.1.1.2" xref="S4.p2.10.m4.1.1.2.cmml">𝐥</mi><mrow id="S4.p2.10.m4.1.1.3" xref="S4.p2.10.m4.1.1.3.cmml"><mn id="S4.p2.10.m4.1.1.3.2" xref="S4.p2.10.m4.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.10.m4.1.1.3.1" xref="S4.p2.10.m4.1.1.3.1.cmml">:</mo><mi id="S4.p2.10.m4.1.1.3.3" xref="S4.p2.10.m4.1.1.3.3.cmml">U</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.10.m4.1b"><apply id="S4.p2.10.m4.1.1.cmml" xref="S4.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.10.m4.1.1.1.cmml" xref="S4.p2.10.m4.1.1">subscript</csymbol><ci id="S4.p2.10.m4.1.1.2.cmml" xref="S4.p2.10.m4.1.1.2">𝐥</ci><apply id="S4.p2.10.m4.1.1.3.cmml" xref="S4.p2.10.m4.1.1.3"><ci id="S4.p2.10.m4.1.1.3.1.cmml" xref="S4.p2.10.m4.1.1.3.1">:</ci><cn type="integer" id="S4.p2.10.m4.1.1.3.2.cmml" xref="S4.p2.10.m4.1.1.3.2">1</cn><ci id="S4.p2.10.m4.1.1.3.3.cmml" xref="S4.p2.10.m4.1.1.3.3">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m4.1c">\mathbf{l}_{1:U}</annotation></semantics></math>, <math id="S4.p2.11.m5.2" class="ltx_Math" alttext="P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})=P_{\bm{\theta}^{\rm{old}}}(\mathbf{l}_{1:U}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.p2.11.m5.2a"><mrow id="S4.p2.11.m5.2.2" xref="S4.p2.11.m5.2.2.cmml"><mrow id="S4.p2.11.m5.1.1.1" xref="S4.p2.11.m5.1.1.1.cmml"><msub id="S4.p2.11.m5.1.1.1.3" xref="S4.p2.11.m5.1.1.1.3.cmml"><mi id="S4.p2.11.m5.1.1.1.3.2" xref="S4.p2.11.m5.1.1.1.3.2.cmml">P</mi><msup id="S4.p2.11.m5.1.1.1.3.3" xref="S4.p2.11.m5.1.1.1.3.3.cmml"><mi id="S4.p2.11.m5.1.1.1.3.3.2" xref="S4.p2.11.m5.1.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.p2.11.m5.1.1.1.3.3.3" xref="S4.p2.11.m5.1.1.1.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.p2.11.m5.1.1.1.2" xref="S4.p2.11.m5.1.1.1.2.cmml">​</mo><mrow id="S4.p2.11.m5.1.1.1.1.1" xref="S4.p2.11.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.11.m5.1.1.1.1.1.2" xref="S4.p2.11.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.11.m5.1.1.1.1.1.1" xref="S4.p2.11.m5.1.1.1.1.1.1.cmml"><msub id="S4.p2.11.m5.1.1.1.1.1.1.2" xref="S4.p2.11.m5.1.1.1.1.1.1.2.cmml"><mi id="S4.p2.11.m5.1.1.1.1.1.1.2.2" xref="S4.p2.11.m5.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S4.p2.11.m5.1.1.1.1.1.1.2.3" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.cmml"><mn id="S4.p2.11.m5.1.1.1.1.1.1.2.3.2" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.11.m5.1.1.1.1.1.1.2.3.1" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.p2.11.m5.1.1.1.1.1.1.2.3.3" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.3.cmml">L</mi></mrow></msub><mo fence="false" id="S4.p2.11.m5.1.1.1.1.1.1.1" xref="S4.p2.11.m5.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.p2.11.m5.1.1.1.1.1.1.3" xref="S4.p2.11.m5.1.1.1.1.1.1.3.cmml"><mi id="S4.p2.11.m5.1.1.1.1.1.1.3.2" xref="S4.p2.11.m5.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.p2.11.m5.1.1.1.1.1.1.3.3" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.cmml"><mn id="S4.p2.11.m5.1.1.1.1.1.1.3.3.2" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.11.m5.1.1.1.1.1.1.3.3.1" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.p2.11.m5.1.1.1.1.1.1.3.3.3" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.p2.11.m5.1.1.1.1.1.3" xref="S4.p2.11.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p2.11.m5.2.2.3" xref="S4.p2.11.m5.2.2.3.cmml">=</mo><mrow id="S4.p2.11.m5.2.2.2" xref="S4.p2.11.m5.2.2.2.cmml"><msub id="S4.p2.11.m5.2.2.2.3" xref="S4.p2.11.m5.2.2.2.3.cmml"><mi id="S4.p2.11.m5.2.2.2.3.2" xref="S4.p2.11.m5.2.2.2.3.2.cmml">P</mi><msup id="S4.p2.11.m5.2.2.2.3.3" xref="S4.p2.11.m5.2.2.2.3.3.cmml"><mi id="S4.p2.11.m5.2.2.2.3.3.2" xref="S4.p2.11.m5.2.2.2.3.3.2.cmml">𝜽</mi><mi id="S4.p2.11.m5.2.2.2.3.3.3" xref="S4.p2.11.m5.2.2.2.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.p2.11.m5.2.2.2.2" xref="S4.p2.11.m5.2.2.2.2.cmml">​</mo><mrow id="S4.p2.11.m5.2.2.2.1.1" xref="S4.p2.11.m5.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p2.11.m5.2.2.2.1.1.2" xref="S4.p2.11.m5.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.p2.11.m5.2.2.2.1.1.1" xref="S4.p2.11.m5.2.2.2.1.1.1.cmml"><msub id="S4.p2.11.m5.2.2.2.1.1.1.2" xref="S4.p2.11.m5.2.2.2.1.1.1.2.cmml"><mi id="S4.p2.11.m5.2.2.2.1.1.1.2.2" xref="S4.p2.11.m5.2.2.2.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.p2.11.m5.2.2.2.1.1.1.2.3" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.cmml"><mn id="S4.p2.11.m5.2.2.2.1.1.1.2.3.2" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.11.m5.2.2.2.1.1.1.2.3.1" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.1.cmml">:</mo><mi id="S4.p2.11.m5.2.2.2.1.1.1.2.3.3" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.3.cmml">U</mi></mrow></msub><mo fence="false" id="S4.p2.11.m5.2.2.2.1.1.1.1" xref="S4.p2.11.m5.2.2.2.1.1.1.1.cmml">|</mo><msub id="S4.p2.11.m5.2.2.2.1.1.1.3" xref="S4.p2.11.m5.2.2.2.1.1.1.3.cmml"><mi id="S4.p2.11.m5.2.2.2.1.1.1.3.2" xref="S4.p2.11.m5.2.2.2.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.p2.11.m5.2.2.2.1.1.1.3.3" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.cmml"><mn id="S4.p2.11.m5.2.2.2.1.1.1.3.3.2" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.11.m5.2.2.2.1.1.1.3.3.1" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.1.cmml">:</mo><mi id="S4.p2.11.m5.2.2.2.1.1.1.3.3.3" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.p2.11.m5.2.2.2.1.1.3" xref="S4.p2.11.m5.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.11.m5.2b"><apply id="S4.p2.11.m5.2.2.cmml" xref="S4.p2.11.m5.2.2"><eq id="S4.p2.11.m5.2.2.3.cmml" xref="S4.p2.11.m5.2.2.3"></eq><apply id="S4.p2.11.m5.1.1.1.cmml" xref="S4.p2.11.m5.1.1.1"><times id="S4.p2.11.m5.1.1.1.2.cmml" xref="S4.p2.11.m5.1.1.1.2"></times><apply id="S4.p2.11.m5.1.1.1.3.cmml" xref="S4.p2.11.m5.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.1.1.1.3.1.cmml" xref="S4.p2.11.m5.1.1.1.3">subscript</csymbol><ci id="S4.p2.11.m5.1.1.1.3.2.cmml" xref="S4.p2.11.m5.1.1.1.3.2">𝑃</ci><apply id="S4.p2.11.m5.1.1.1.3.3.cmml" xref="S4.p2.11.m5.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.1.1.1.3.3.1.cmml" xref="S4.p2.11.m5.1.1.1.3.3">superscript</csymbol><ci id="S4.p2.11.m5.1.1.1.3.3.2.cmml" xref="S4.p2.11.m5.1.1.1.3.3.2">𝜽</ci><ci id="S4.p2.11.m5.1.1.1.3.3.3.cmml" xref="S4.p2.11.m5.1.1.1.3.3.3">old</ci></apply></apply><apply id="S4.p2.11.m5.1.1.1.1.1.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1"><csymbol cd="latexml" id="S4.p2.11.m5.1.1.1.1.1.1.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p2.11.m5.1.1.1.1.1.1.2.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.11.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.11.m5.1.1.1.1.1.1.2.2.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2.2">𝐖</ci><apply id="S4.p2.11.m5.1.1.1.1.1.1.2.3.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3"><ci id="S4.p2.11.m5.1.1.1.1.1.1.2.3.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.p2.11.m5.1.1.1.1.1.1.2.3.2.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.p2.11.m5.1.1.1.1.1.1.2.3.3.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.2.3.3">𝐿</ci></apply></apply><apply id="S4.p2.11.m5.1.1.1.1.1.1.3.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.1.1.1.1.1.1.3.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.11.m5.1.1.1.1.1.1.3.2.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.p2.11.m5.1.1.1.1.1.1.3.3.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3"><ci id="S4.p2.11.m5.1.1.1.1.1.1.3.3.1.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.p2.11.m5.1.1.1.1.1.1.3.3.2.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.p2.11.m5.1.1.1.1.1.1.3.3.3.cmml" xref="S4.p2.11.m5.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply><apply id="S4.p2.11.m5.2.2.2.cmml" xref="S4.p2.11.m5.2.2.2"><times id="S4.p2.11.m5.2.2.2.2.cmml" xref="S4.p2.11.m5.2.2.2.2"></times><apply id="S4.p2.11.m5.2.2.2.3.cmml" xref="S4.p2.11.m5.2.2.2.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.2.2.2.3.1.cmml" xref="S4.p2.11.m5.2.2.2.3">subscript</csymbol><ci id="S4.p2.11.m5.2.2.2.3.2.cmml" xref="S4.p2.11.m5.2.2.2.3.2">𝑃</ci><apply id="S4.p2.11.m5.2.2.2.3.3.cmml" xref="S4.p2.11.m5.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.2.2.2.3.3.1.cmml" xref="S4.p2.11.m5.2.2.2.3.3">superscript</csymbol><ci id="S4.p2.11.m5.2.2.2.3.3.2.cmml" xref="S4.p2.11.m5.2.2.2.3.3.2">𝜽</ci><ci id="S4.p2.11.m5.2.2.2.3.3.3.cmml" xref="S4.p2.11.m5.2.2.2.3.3.3">old</ci></apply></apply><apply id="S4.p2.11.m5.2.2.2.1.1.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1"><csymbol cd="latexml" id="S4.p2.11.m5.2.2.2.1.1.1.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.1">conditional</csymbol><apply id="S4.p2.11.m5.2.2.2.1.1.1.2.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.11.m5.2.2.2.1.1.1.2.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.p2.11.m5.2.2.2.1.1.1.2.2.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2.2">𝐥</ci><apply id="S4.p2.11.m5.2.2.2.1.1.1.2.3.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3"><ci id="S4.p2.11.m5.2.2.2.1.1.1.2.3.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.p2.11.m5.2.2.2.1.1.1.2.3.2.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.2">1</cn><ci id="S4.p2.11.m5.2.2.2.1.1.1.2.3.3.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="S4.p2.11.m5.2.2.2.1.1.1.3.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m5.2.2.2.1.1.1.3.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.p2.11.m5.2.2.2.1.1.1.3.2.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3.2">𝐱</ci><apply id="S4.p2.11.m5.2.2.2.1.1.1.3.3.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3"><ci id="S4.p2.11.m5.2.2.2.1.1.1.3.3.1.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.p2.11.m5.2.2.2.1.1.1.3.3.2.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.2">1</cn><ci id="S4.p2.11.m5.2.2.2.1.1.1.3.3.3.cmml" xref="S4.p2.11.m5.2.2.2.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m5.2c">P_{\bm{\theta}^{\rm{old}}}(\mathbf{W}_{1:L}|\mathbf{x}_{1:T})=P_{\bm{\theta}^{\rm{old}}}(\mathbf{l}_{1:U}|\mathbf{x}_{1:T})</annotation></semantics></math>.
This work utilises <math id="S4.p2.12.m6.1" class="ltx_Math" alttext="P_{\bm{\theta}^{\rm{old}}}(\mathbf{l}_{1:U}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.p2.12.m6.1a"><mrow id="S4.p2.12.m6.1.1" xref="S4.p2.12.m6.1.1.cmml"><msub id="S4.p2.12.m6.1.1.3" xref="S4.p2.12.m6.1.1.3.cmml"><mi id="S4.p2.12.m6.1.1.3.2" xref="S4.p2.12.m6.1.1.3.2.cmml">P</mi><msup id="S4.p2.12.m6.1.1.3.3" xref="S4.p2.12.m6.1.1.3.3.cmml"><mi id="S4.p2.12.m6.1.1.3.3.2" xref="S4.p2.12.m6.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.p2.12.m6.1.1.3.3.3" xref="S4.p2.12.m6.1.1.3.3.3.cmml">old</mi></msup></msub><mo lspace="0em" rspace="0em" id="S4.p2.12.m6.1.1.2" xref="S4.p2.12.m6.1.1.2.cmml">​</mo><mrow id="S4.p2.12.m6.1.1.1.1" xref="S4.p2.12.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.12.m6.1.1.1.1.2" xref="S4.p2.12.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.12.m6.1.1.1.1.1" xref="S4.p2.12.m6.1.1.1.1.1.cmml"><msub id="S4.p2.12.m6.1.1.1.1.1.2" xref="S4.p2.12.m6.1.1.1.1.1.2.cmml"><mi id="S4.p2.12.m6.1.1.1.1.1.2.2" xref="S4.p2.12.m6.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.p2.12.m6.1.1.1.1.1.2.3" xref="S4.p2.12.m6.1.1.1.1.1.2.3.cmml"><mn id="S4.p2.12.m6.1.1.1.1.1.2.3.2" xref="S4.p2.12.m6.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.12.m6.1.1.1.1.1.2.3.1" xref="S4.p2.12.m6.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.p2.12.m6.1.1.1.1.1.2.3.3" xref="S4.p2.12.m6.1.1.1.1.1.2.3.3.cmml">U</mi></mrow></msub><mo fence="false" id="S4.p2.12.m6.1.1.1.1.1.1" xref="S4.p2.12.m6.1.1.1.1.1.1.cmml">|</mo><msub id="S4.p2.12.m6.1.1.1.1.1.3" xref="S4.p2.12.m6.1.1.1.1.1.3.cmml"><mi id="S4.p2.12.m6.1.1.1.1.1.3.2" xref="S4.p2.12.m6.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.p2.12.m6.1.1.1.1.1.3.3" xref="S4.p2.12.m6.1.1.1.1.1.3.3.cmml"><mn id="S4.p2.12.m6.1.1.1.1.1.3.3.2" xref="S4.p2.12.m6.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p2.12.m6.1.1.1.1.1.3.3.1" xref="S4.p2.12.m6.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.p2.12.m6.1.1.1.1.1.3.3.3" xref="S4.p2.12.m6.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.p2.12.m6.1.1.1.1.3" xref="S4.p2.12.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.12.m6.1b"><apply id="S4.p2.12.m6.1.1.cmml" xref="S4.p2.12.m6.1.1"><times id="S4.p2.12.m6.1.1.2.cmml" xref="S4.p2.12.m6.1.1.2"></times><apply id="S4.p2.12.m6.1.1.3.cmml" xref="S4.p2.12.m6.1.1.3"><csymbol cd="ambiguous" id="S4.p2.12.m6.1.1.3.1.cmml" xref="S4.p2.12.m6.1.1.3">subscript</csymbol><ci id="S4.p2.12.m6.1.1.3.2.cmml" xref="S4.p2.12.m6.1.1.3.2">𝑃</ci><apply id="S4.p2.12.m6.1.1.3.3.cmml" xref="S4.p2.12.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.12.m6.1.1.3.3.1.cmml" xref="S4.p2.12.m6.1.1.3.3">superscript</csymbol><ci id="S4.p2.12.m6.1.1.3.3.2.cmml" xref="S4.p2.12.m6.1.1.3.3.2">𝜽</ci><ci id="S4.p2.12.m6.1.1.3.3.3.cmml" xref="S4.p2.12.m6.1.1.3.3.3">old</ci></apply></apply><apply id="S4.p2.12.m6.1.1.1.1.1.cmml" xref="S4.p2.12.m6.1.1.1.1"><csymbol cd="latexml" id="S4.p2.12.m6.1.1.1.1.1.1.cmml" xref="S4.p2.12.m6.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p2.12.m6.1.1.1.1.1.2.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.12.m6.1.1.1.1.1.2.1.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.12.m6.1.1.1.1.1.2.2.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2.2">𝐥</ci><apply id="S4.p2.12.m6.1.1.1.1.1.2.3.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2.3"><ci id="S4.p2.12.m6.1.1.1.1.1.2.3.1.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.p2.12.m6.1.1.1.1.1.2.3.2.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2.3.2">1</cn><ci id="S4.p2.12.m6.1.1.1.1.1.2.3.3.cmml" xref="S4.p2.12.m6.1.1.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="S4.p2.12.m6.1.1.1.1.1.3.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.12.m6.1.1.1.1.1.3.1.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.12.m6.1.1.1.1.1.3.2.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.p2.12.m6.1.1.1.1.1.3.3.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3.3"><ci id="S4.p2.12.m6.1.1.1.1.1.3.3.1.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.p2.12.m6.1.1.1.1.1.3.3.2.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3.3.2">1</cn><ci id="S4.p2.12.m6.1.1.1.1.1.3.3.3.cmml" xref="S4.p2.12.m6.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m6.1c">P_{\bm{\theta}^{\rm{old}}}(\mathbf{l}_{1:U}|\mathbf{x}_{1:T})</annotation></semantics></math> to score each competing hypothesis and considers only the top N best alternatives due to the intractability of computing eqn(<a href="#S4.E4" title="In 4 FDT algorithm ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) exactly. The following sections details the specific loss used in this paper.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Error region detection </h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.13" class="ltx_p">The proposed loss in this paper targets segments of the input sequence affected by ASR errors. The first step in designing this loss involves developing a procedure to identify regions in the audio where the ASR system performs poorly. For a given input-reference word-piece label sequence pair <math id="S4.SS1.p1.1.m1.2" class="ltx_Math" alttext="(\mathbf{x}_{1:T},\mathbf{l}^{{r}}_{1:U})" display="inline"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.2.2" xref="S4.SS1.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.3.cmml">(</mo><msub id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S4.SS1.p1.1.m1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.1.3.cmml"><mn id="S4.SS1.p1.1.m1.1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.1.m1.1.1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS1.p1.1.m1.1.1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S4.SS1.p1.1.m1.2.2.2.4" xref="S4.SS1.p1.1.m1.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.1.m1.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml">𝐥</mi><mrow id="S4.SS1.p1.1.m1.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.3.cmml"><mn id="S4.SS1.p1.1.m1.2.2.2.2.3.2" xref="S4.SS1.p1.1.m1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.1.m1.2.2.2.2.3.1" xref="S4.SS1.p1.1.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S4.SS1.p1.1.m1.2.2.2.2.3.3" xref="S4.SS1.p1.1.m1.2.2.2.2.3.3.cmml">U</mi></mrow><mi id="S4.SS1.p1.1.m1.2.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.2.5" xref="S4.SS1.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><interval closure="open" id="S4.SS1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2"><apply id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.2">𝐱</ci><apply id="S4.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.3"><ci id="S4.SS1.p1.1.m1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.3.2">1</cn><ci id="S4.SS1.p1.1.m1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.p1.1.m1.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2">subscript</csymbol><apply id="S4.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2">𝐥</ci><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3"><ci id="S4.SS1.p1.1.m1.2.2.2.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.SS1.p1.1.m1.2.2.2.2.3.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3.2">1</cn><ci id="S4.SS1.p1.1.m1.2.2.2.2.3.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3.3">𝑈</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">(\mathbf{x}_{1:T},\mathbf{l}^{{r}}_{1:U})</annotation></semantics></math>, its CTC alignment <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\hat{\bm{z}}^{r}_{1:T}(\bm{\theta})" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><msubsup id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml"><mover accent="true" id="S4.SS1.p1.2.m2.1.2.2.2.2" xref="S4.SS1.p1.2.m2.1.2.2.2.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2.2.2.2" xref="S4.SS1.p1.2.m2.1.2.2.2.2.2.cmml">𝒛</mi><mo id="S4.SS1.p1.2.m2.1.2.2.2.2.1" xref="S4.SS1.p1.2.m2.1.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p1.2.m2.1.2.2.3" xref="S4.SS1.p1.2.m2.1.2.2.3.cmml"><mn id="S4.SS1.p1.2.m2.1.2.2.3.2" xref="S4.SS1.p1.2.m2.1.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.2.m2.1.2.2.3.1" xref="S4.SS1.p1.2.m2.1.2.2.3.1.cmml">:</mo><mi id="S4.SS1.p1.2.m2.1.2.2.3.3" xref="S4.SS1.p1.2.m2.1.2.2.3.3.cmml">T</mi></mrow><mi id="S4.SS1.p1.2.m2.1.2.2.2.3" xref="S4.SS1.p1.2.m2.1.2.2.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.2.m2.1.2.3.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.1.2.3.2.1" xref="S4.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.SS1.p1.2.m2.1.2.3.2.2" xref="S4.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><times id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></times><apply id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2">subscript</csymbol><apply id="S4.SS1.p1.2.m2.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2.2"><ci id="S4.SS1.p1.2.m2.1.2.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2.2.1">^</ci><ci id="S4.SS1.p1.2.m2.1.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2.2.2">𝒛</ci></apply><ci id="S4.SS1.p1.2.m2.1.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2.3">𝑟</ci></apply><apply id="S4.SS1.p1.2.m2.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.2.2.3"><ci id="S4.SS1.p1.2.m2.1.2.2.3.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2.3.1">:</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.2.2.3.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2.3.2">1</cn><ci id="S4.SS1.p1.2.m2.1.2.2.3.3.cmml" xref="S4.SS1.p1.2.m2.1.2.2.3.3">𝑇</ci></apply></apply><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\hat{\bm{z}}^{r}_{1:T}(\bm{\theta})</annotation></semantics></math> defines a unique segmentation of the encoder output sequence <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{e}_{1:T}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">𝒆</mi><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mn id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.3.m3.1.1.3.1" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">:</mo><mi id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝒆</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><ci id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">1</cn><ci id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\bm{e}_{1:T}</annotation></semantics></math>. This segmentation aligns the <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">i</annotation></semantics></math>-th token <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{l}^{r}_{i}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msubsup id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">𝐥</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">i</mi><mi id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝐥</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">𝑟</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathbf{l}^{r}_{i}</annotation></semantics></math> with a unique sub sequence <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\bm{e}_{t_{i}:t_{i+1}}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msub id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">𝒆</mi><mrow id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml"><msub id="S4.SS1.p1.6.m6.1.1.3.2" xref="S4.SS1.p1.6.m6.1.1.3.2.cmml"><mi id="S4.SS1.p1.6.m6.1.1.3.2.2" xref="S4.SS1.p1.6.m6.1.1.3.2.2.cmml">t</mi><mi id="S4.SS1.p1.6.m6.1.1.3.2.3" xref="S4.SS1.p1.6.m6.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.6.m6.1.1.3.1" xref="S4.SS1.p1.6.m6.1.1.3.1.cmml">:</mo><msub id="S4.SS1.p1.6.m6.1.1.3.3" xref="S4.SS1.p1.6.m6.1.1.3.3.cmml"><mi id="S4.SS1.p1.6.m6.1.1.3.3.2" xref="S4.SS1.p1.6.m6.1.1.3.3.2.cmml">t</mi><mrow id="S4.SS1.p1.6.m6.1.1.3.3.3" xref="S4.SS1.p1.6.m6.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.6.m6.1.1.3.3.3.2" xref="S4.SS1.p1.6.m6.1.1.3.3.3.2.cmml">i</mi><mo id="S4.SS1.p1.6.m6.1.1.3.3.3.1" xref="S4.SS1.p1.6.m6.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS1.p1.6.m6.1.1.3.3.3.3" xref="S4.SS1.p1.6.m6.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝒆</ci><apply id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3"><ci id="S4.SS1.p1.6.m6.1.1.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3.1">:</ci><apply id="S4.SS1.p1.6.m6.1.1.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.3.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.3.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2.2">𝑡</ci><ci id="S4.SS1.p1.6.m6.1.1.3.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.6.m6.1.1.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3.2">𝑡</ci><apply id="S4.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3.3"><plus id="S4.SS1.p1.6.m6.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3.3.1"></plus><ci id="S4.SS1.p1.6.m6.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.3.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\bm{e}_{t_{i}:t_{i+1}}</annotation></semantics></math>, such that <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbb{B}(\hat{\bm{z}}^{r}_{t_{i}:t_{i+1}})=\mathbf{l}^{r}_{i}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mrow id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m7.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p1.7.m7.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.2.cmml">𝒛</mi><mo id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml"><msub id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.2.cmml">t</mi><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.1.cmml">:</mo><msub id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.2.cmml">t</mi><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.3.2.2" xref="S4.SS1.p1.7.m7.1.1.3.2.2.cmml">𝐥</mi><mi id="S4.SS1.p1.7.m7.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.3.3.cmml">i</mi><mi id="S4.SS1.p1.7.m7.1.1.3.2.3" xref="S4.SS1.p1.7.m7.1.1.3.2.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><eq id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2"></eq><apply id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"><times id="S4.SS1.p1.7.m7.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.2"></times><ci id="S4.SS1.p1.7.m7.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.3">𝔹</ci><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2"><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.2.2">𝒛</ci></apply><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.2.3">𝑟</ci></apply><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3"><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.1">:</ci><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.2">𝑡</ci><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3"><plus id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3">subscript</csymbol><apply id="S4.SS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.3.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.3.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3.2.2">𝐥</ci><ci id="S4.SS1.p1.7.m7.1.1.3.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3.2.3">𝑟</ci></apply><ci id="S4.SS1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\mathbb{B}(\hat{\bm{z}}^{r}_{t_{i}:t_{i+1}})=\mathbf{l}^{r}_{i}</annotation></semantics></math>. This procedure is exemplified by the following example. Consider the alignment <math id="S4.SS1.p1.8.m8.6" class="ltx_Math" alttext="[\emptyset,\emptyset,\mbox{`a'},\emptyset,\emptyset,\mbox{`b'}]" display="inline"><semantics id="S4.SS1.p1.8.m8.6a"><mrow id="S4.SS1.p1.8.m8.6.7.2" xref="S4.SS1.p1.8.m8.6.7.1.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.6.7.2.1" xref="S4.SS1.p1.8.m8.6.7.1.cmml">[</mo><mi mathvariant="normal" id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">∅</mi><mo id="S4.SS1.p1.8.m8.6.7.2.2" xref="S4.SS1.p1.8.m8.6.7.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.8.m8.2.2" xref="S4.SS1.p1.8.m8.2.2.cmml">∅</mi><mo id="S4.SS1.p1.8.m8.6.7.2.3" xref="S4.SS1.p1.8.m8.6.7.1.cmml">,</mo><mtext id="S4.SS1.p1.8.m8.3.3" xref="S4.SS1.p1.8.m8.3.3a.cmml">‘a’</mtext><mo id="S4.SS1.p1.8.m8.6.7.2.4" xref="S4.SS1.p1.8.m8.6.7.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.8.m8.4.4" xref="S4.SS1.p1.8.m8.4.4.cmml">∅</mi><mo id="S4.SS1.p1.8.m8.6.7.2.5" xref="S4.SS1.p1.8.m8.6.7.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.8.m8.5.5" xref="S4.SS1.p1.8.m8.5.5.cmml">∅</mi><mo id="S4.SS1.p1.8.m8.6.7.2.6" xref="S4.SS1.p1.8.m8.6.7.1.cmml">,</mo><mtext id="S4.SS1.p1.8.m8.6.6" xref="S4.SS1.p1.8.m8.6.6a.cmml">‘b’</mtext><mo stretchy="false" id="S4.SS1.p1.8.m8.6.7.2.7" xref="S4.SS1.p1.8.m8.6.7.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.6b"><list id="S4.SS1.p1.8.m8.6.7.1.cmml" xref="S4.SS1.p1.8.m8.6.7.2"><emptyset id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"></emptyset><emptyset id="S4.SS1.p1.8.m8.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2"></emptyset><ci id="S4.SS1.p1.8.m8.3.3a.cmml" xref="S4.SS1.p1.8.m8.3.3"><mtext id="S4.SS1.p1.8.m8.3.3.cmml" xref="S4.SS1.p1.8.m8.3.3">‘a’</mtext></ci><emptyset id="S4.SS1.p1.8.m8.4.4.cmml" xref="S4.SS1.p1.8.m8.4.4"></emptyset><emptyset id="S4.SS1.p1.8.m8.5.5.cmml" xref="S4.SS1.p1.8.m8.5.5"></emptyset><ci id="S4.SS1.p1.8.m8.6.6a.cmml" xref="S4.SS1.p1.8.m8.6.6"><mtext id="S4.SS1.p1.8.m8.6.6.cmml" xref="S4.SS1.p1.8.m8.6.6">‘b’</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.6c">[\emptyset,\emptyset,\mbox{`a'},\emptyset,\emptyset,\mbox{`b'}]</annotation></semantics></math> for an input sequence <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\bm{x}_{1:6}" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><msub id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml"><mn id="S4.SS1.p1.9.m9.1.1.3.2" xref="S4.SS1.p1.9.m9.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.9.m9.1.1.3.1" xref="S4.SS1.p1.9.m9.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p1.9.m9.1.1.3.3" xref="S4.SS1.p1.9.m9.1.1.3.3.cmml">6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">𝒙</ci><apply id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3"><ci id="S4.SS1.p1.9.m9.1.1.3.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p1.9.m9.1.1.3.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2">1</cn><cn type="integer" id="S4.SS1.p1.9.m9.1.1.3.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\bm{x}_{1:6}</annotation></semantics></math>. Although CTC training marginalises over all possible alignments allowed by its latent discriminative model, it is well-known that CTC training converges to a dominant alignment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. In this example the observation that <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\bm{z}_{3}=" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mrow id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><msub id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml"><mi id="S4.SS1.p1.10.m10.1.1.2.2" xref="S4.SS1.p1.10.m10.1.1.2.2.cmml">𝒛</mi><mn id="S4.SS1.p1.10.m10.1.1.2.3" xref="S4.SS1.p1.10.m10.1.1.2.3.cmml">3</mn></msub><mo id="S4.SS1.p1.10.m10.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.cmml">=</mo><mi id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><eq id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1"></eq><apply id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.2.1.cmml" xref="S4.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.2.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2.2">𝒛</ci><cn type="integer" id="S4.SS1.p1.10.m10.1.1.2.3.cmml" xref="S4.SS1.p1.10.m10.1.1.2.3">3</cn></apply><csymbol cd="latexml" id="S4.SS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">\bm{z}_{3}=</annotation></semantics></math> ‘a’ and <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="\bm{z}_{6}=" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mrow id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><msub id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml"><mi id="S4.SS1.p1.11.m11.1.1.2.2" xref="S4.SS1.p1.11.m11.1.1.2.2.cmml">𝒛</mi><mn id="S4.SS1.p1.11.m11.1.1.2.3" xref="S4.SS1.p1.11.m11.1.1.2.3.cmml">6</mn></msub><mo id="S4.SS1.p1.11.m11.1.1.1" xref="S4.SS1.p1.11.m11.1.1.1.cmml">=</mo><mi id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><eq id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1.1"></eq><apply id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.2.1.cmml" xref="S4.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2.2">𝒛</ci><cn type="integer" id="S4.SS1.p1.11.m11.1.1.2.3.cmml" xref="S4.SS1.p1.11.m11.1.1.2.3">6</cn></apply><csymbol cd="latexml" id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\bm{z}_{6}=</annotation></semantics></math> ‘b’ implies that the CTC trained model emits the token ‘a’ after processing <math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="\bm{x}_{1:3}" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><msub id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.p1.12.m12.1.1.2" xref="S4.SS1.p1.12.m12.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p1.12.m12.1.1.3" xref="S4.SS1.p1.12.m12.1.1.3.cmml"><mn id="S4.SS1.p1.12.m12.1.1.3.2" xref="S4.SS1.p1.12.m12.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.12.m12.1.1.3.1" xref="S4.SS1.p1.12.m12.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p1.12.m12.1.1.3.3" xref="S4.SS1.p1.12.m12.1.1.3.3.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><apply id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.p1.12.m12.1.1.2">𝒙</ci><apply id="S4.SS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.p1.12.m12.1.1.3"><ci id="S4.SS1.p1.12.m12.1.1.3.1.cmml" xref="S4.SS1.p1.12.m12.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p1.12.m12.1.1.3.2.cmml" xref="S4.SS1.p1.12.m12.1.1.3.2">1</cn><cn type="integer" id="S4.SS1.p1.12.m12.1.1.3.3.cmml" xref="S4.SS1.p1.12.m12.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">\bm{x}_{1:3}</annotation></semantics></math> and token ‘b’ after processing <math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="\bm{x}_{1:6}" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><msub id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.p1.13.m13.1.1.2" xref="S4.SS1.p1.13.m13.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p1.13.m13.1.1.3" xref="S4.SS1.p1.13.m13.1.1.3.cmml"><mn id="S4.SS1.p1.13.m13.1.1.3.2" xref="S4.SS1.p1.13.m13.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.13.m13.1.1.3.1" xref="S4.SS1.p1.13.m13.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p1.13.m13.1.1.3.3" xref="S4.SS1.p1.13.m13.1.1.3.3.cmml">6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><apply id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.p1.13.m13.1.1.2">𝒙</ci><apply id="S4.SS1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.p1.13.m13.1.1.3"><ci id="S4.SS1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.p1.13.m13.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.p1.13.m13.1.1.3.2">1</cn><cn type="integer" id="S4.SS1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.p1.13.m13.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">\bm{x}_{1:6}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.6" class="ltx_p">The segmentation scheme proposed in this paper operates under the assumption that all the acoustic information required to predict ‘a’ is captured by the encoder output sequence <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bm{e}_{1:3}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">𝒆</mi><mrow id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mn id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p2.1.m1.1.1.3.1" xref="S4.SS1.p2.1.m1.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝒆</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><ci id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">1</cn><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bm{e}_{1:3}</annotation></semantics></math>, where <math id="S4.SS1.p2.2.m2.2" class="ltx_Math" alttext="\bm{e}_{t}=f(\bm{x}_{1:t},\bm{\theta})" display="inline"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml"><msub id="S4.SS1.p2.2.m2.2.2.3" xref="S4.SS1.p2.2.m2.2.2.3.cmml"><mi id="S4.SS1.p2.2.m2.2.2.3.2" xref="S4.SS1.p2.2.m2.2.2.3.2.cmml">𝒆</mi><mi id="S4.SS1.p2.2.m2.2.2.3.3" xref="S4.SS1.p2.2.m2.2.2.3.3.cmml">t</mi></msub><mo id="S4.SS1.p2.2.m2.2.2.2" xref="S4.SS1.p2.2.m2.2.2.2.cmml">=</mo><mrow id="S4.SS1.p2.2.m2.2.2.1" xref="S4.SS1.p2.2.m2.2.2.1.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.3" xref="S4.SS1.p2.2.m2.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.2.2.1.2" xref="S4.SS1.p2.2.m2.2.2.1.2.cmml">​</mo><mrow id="S4.SS1.p2.2.m2.2.2.1.1.1" xref="S4.SS1.p2.2.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.2.2.1.1.1.2" xref="S4.SS1.p2.2.m2.2.2.1.1.2.cmml">(</mo><msub id="S4.SS1.p2.2.m2.2.2.1.1.1.1" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.1.2" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.cmml"><mn id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.2" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.1" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S4.SS1.p2.2.m2.2.2.1.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.1.2.cmml">,</mo><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.SS1.p2.2.m2.2.2.1.1.1.4" xref="S4.SS1.p2.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><apply id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2"><eq id="S4.SS1.p2.2.m2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.2"></eq><apply id="S4.SS1.p2.2.m2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.2.2.3.2">𝒆</ci><ci id="S4.SS1.p2.2.m2.2.2.3.3.cmml" xref="S4.SS1.p2.2.m2.2.2.3.3">𝑡</ci></apply><apply id="S4.SS1.p2.2.m2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1"><times id="S4.SS1.p2.2.m2.2.2.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.2"></times><ci id="S4.SS1.p2.2.m2.2.2.1.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.3">𝑓</ci><interval closure="open" id="S4.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1"><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.2">𝒙</ci><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3"><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.2">1</cn><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝜽</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">\bm{e}_{t}=f(\bm{x}_{1:t},\bm{\theta})</annotation></semantics></math>, and the information required to predict b’ is contained within the encoder sequence <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\bm{e}_{3:6}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">𝒆</mi><mrow id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mn id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">3</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p2.3.m3.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝒆</ci><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><ci id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.2">3</cn><cn type="integer" id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\bm{e}_{3:6}</annotation></semantics></math> which operates on the frames <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\bm{x}_{1:6}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml"><mn id="S4.SS1.p2.4.m4.1.1.3.2" xref="S4.SS1.p2.4.m4.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p2.4.m4.1.1.3.1" xref="S4.SS1.p2.4.m4.1.1.3.1.cmml">:</mo><mn id="S4.SS1.p2.4.m4.1.1.3.3" xref="S4.SS1.p2.4.m4.1.1.3.3.cmml">6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝒙</ci><apply id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3"><ci id="S4.SS1.p2.4.m4.1.1.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p2.4.m4.1.1.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.3.2">1</cn><cn type="integer" id="S4.SS1.p2.4.m4.1.1.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\bm{x}_{1:6}</annotation></semantics></math>. It is worth noting that the scheme is dynamic (i.e., dependent on the choice of <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\bm{\theta}</annotation></semantics></math> and assumes the acoustic information from the right context frames is not required when predicting a token. Thus, this particular segmentation scheme will not be appropriate for encoders employing global attention to generate output at each time step i.e <math id="S4.SS1.p2.6.m6.2" class="ltx_Math" alttext="\bm{e}_{t}=f(\bm{x}_{1:T},\bm{\theta})" display="inline"><semantics id="S4.SS1.p2.6.m6.2a"><mrow id="S4.SS1.p2.6.m6.2.2" xref="S4.SS1.p2.6.m6.2.2.cmml"><msub id="S4.SS1.p2.6.m6.2.2.3" xref="S4.SS1.p2.6.m6.2.2.3.cmml"><mi id="S4.SS1.p2.6.m6.2.2.3.2" xref="S4.SS1.p2.6.m6.2.2.3.2.cmml">𝒆</mi><mi id="S4.SS1.p2.6.m6.2.2.3.3" xref="S4.SS1.p2.6.m6.2.2.3.3.cmml">t</mi></msub><mo id="S4.SS1.p2.6.m6.2.2.2" xref="S4.SS1.p2.6.m6.2.2.2.cmml">=</mo><mrow id="S4.SS1.p2.6.m6.2.2.1" xref="S4.SS1.p2.6.m6.2.2.1.cmml"><mi id="S4.SS1.p2.6.m6.2.2.1.3" xref="S4.SS1.p2.6.m6.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m6.2.2.1.2" xref="S4.SS1.p2.6.m6.2.2.1.2.cmml">​</mo><mrow id="S4.SS1.p2.6.m6.2.2.1.1.1" xref="S4.SS1.p2.6.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m6.2.2.1.1.1.2" xref="S4.SS1.p2.6.m6.2.2.1.1.2.cmml">(</mo><msub id="S4.SS1.p2.6.m6.2.2.1.1.1.1" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.1.2" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml"><mn id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.2" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.1" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.3" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S4.SS1.p2.6.m6.2.2.1.1.1.3" xref="S4.SS1.p2.6.m6.2.2.1.1.2.cmml">,</mo><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.SS1.p2.6.m6.2.2.1.1.1.4" xref="S4.SS1.p2.6.m6.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.2b"><apply id="S4.SS1.p2.6.m6.2.2.cmml" xref="S4.SS1.p2.6.m6.2.2"><eq id="S4.SS1.p2.6.m6.2.2.2.cmml" xref="S4.SS1.p2.6.m6.2.2.2"></eq><apply id="S4.SS1.p2.6.m6.2.2.3.cmml" xref="S4.SS1.p2.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.2.2.3.1.cmml" xref="S4.SS1.p2.6.m6.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.6.m6.2.2.3.2.cmml" xref="S4.SS1.p2.6.m6.2.2.3.2">𝒆</ci><ci id="S4.SS1.p2.6.m6.2.2.3.3.cmml" xref="S4.SS1.p2.6.m6.2.2.3.3">𝑡</ci></apply><apply id="S4.SS1.p2.6.m6.2.2.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1"><times id="S4.SS1.p2.6.m6.2.2.1.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.2"></times><ci id="S4.SS1.p2.6.m6.2.2.1.3.cmml" xref="S4.SS1.p2.6.m6.2.2.1.3">𝑓</ci><interval closure="open" id="S4.SS1.p2.6.m6.2.2.1.1.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1"><apply id="S4.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.2">𝒙</ci><apply id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3"><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.2">1</cn><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.1.3.3">𝑇</ci></apply></apply><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝜽</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.2c">\bm{e}_{t}=f(\bm{x}_{1:T},\bm{\theta})</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p">In the presence of a deterministic tokenizer, the above segmentation scheme can be extended to align each reference word <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{W}^{r}_{k}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msubsup id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">𝐖</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">k</mi><mi id="S4.SS1.p3.1.m1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2.2">𝐖</ci><ci id="S4.SS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.2.3">𝑟</ci></apply><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathbf{W}^{r}_{k}</annotation></semantics></math> with a unique sub-sequence <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\bm{e}_{t_{k}:t_{k+1}}" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">𝒆</mi><mrow id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><msub id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.2.2" xref="S4.SS1.p3.2.m2.1.1.3.2.2.cmml">t</mi><mi id="S4.SS1.p3.2.m2.1.1.3.2.3" xref="S4.SS1.p3.2.m2.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p3.2.m2.1.1.3.1" xref="S4.SS1.p3.2.m2.1.1.3.1.cmml">:</mo><msub id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.2.cmml">t</mi><mrow id="S4.SS1.p3.2.m2.1.1.3.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.3.2.cmml">k</mi><mo id="S4.SS1.p3.2.m2.1.1.3.3.3.1" xref="S4.SS1.p3.2.m2.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS1.p3.2.m2.1.1.3.3.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝒆</ci><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><ci id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.1">:</ci><apply id="S4.SS1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2.2">𝑡</ci><ci id="S4.SS1.p3.2.m2.1.1.3.2.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.2">𝑡</ci><apply id="S4.SS1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3"><plus id="S4.SS1.p3.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3.1"></plus><ci id="S4.SS1.p3.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS1.p3.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\bm{e}_{t_{k}:t_{k+1}}</annotation></semantics></math>, thus allowing the identification of segments conforming to word boundaries. By comparing the Viterbi alignment of each competing hypothesis along the marked segments, the procedure provides a framework to identify regions when the model’s recognition deviates away from the intended words.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Constrained CTC Graph</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">To improve recognition of identified word segments, this work employs a contrastive loss that utilises a constrained variant of CTC’s implicit discrete latent variable model to represent <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S4.SS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml"><mn id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.3.cmml">u</mi></mrow></msub><mo fence="false" id="S4.SS2.p1.1.m1.1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"></times><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑃</ci><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.2">𝐥</ci><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3"><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3"><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})</annotation></semantics></math>, where <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{l}_{1:u}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">𝐥</mi><mrow id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mn id="S4.SS2.p1.2.m2.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.2.m2.1.1.3.1" xref="S4.SS2.p1.2.m2.1.1.3.1.cmml">:</mo><mi id="S4.SS2.p1.2.m2.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝐥</ci><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><ci id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.1">:</ci><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2">1</cn><ci id="S4.SS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathbf{l}_{1:u}</annotation></semantics></math> denotes word-pieces sequence associate with a word. The original CTC loss formulation, designed for character-based models, interleaves label units with blanks in its discrete latent variable model (CTC graph) to accommodate character repetitions in generated label sequences. However, this design is unnecessary for word-piece models, as word-piece units typically do not repeat within a word. Therefore, this work during training adapts the CTC graph for word-piece models and models <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.cmml"><mn id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.3.cmml">u</mi></mrow></msub><mo fence="false" id="S4.SS2.p1.3.m3.1.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.3.m3.1.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.cmml"><mn id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"></times><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑃</ci><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.2">𝐥</ci><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3"><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.2">1</cn><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3"><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.2">1</cn><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})</annotation></semantics></math> with the following Markov random field <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>:</p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.Ex3.m1.1a"><mrow id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.3" xref="S4.Ex3.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.1.1.2" xref="S4.Ex3.m1.1.1.2.cmml">​</mo><mrow id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex3.m1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.cmml"><msub id="S4.Ex3.m1.1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.2.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.Ex3.m1.1.1.1.1.1.2.3" xref="S4.Ex3.m1.1.1.1.1.1.2.3.cmml"><mn id="S4.Ex3.m1.1.1.1.1.1.2.3.2" xref="S4.Ex3.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex3.m1.1.1.1.1.1.2.3.1" xref="S4.Ex3.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.Ex3.m1.1.1.1.1.1.2.3.3" xref="S4.Ex3.m1.1.1.1.1.1.2.3.3.cmml">u</mi></mrow></msub><mo fence="false" id="S4.Ex3.m1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex3.m1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.3.2" xref="S4.Ex3.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.Ex3.m1.1.1.1.1.1.3.3" xref="S4.Ex3.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.Ex3.m1.1.1.1.1.1.3.3.2" xref="S4.Ex3.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex3.m1.1.1.1.1.1.3.3.1" xref="S4.Ex3.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.Ex3.m1.1.1.1.1.1.3.3.3" xref="S4.Ex3.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.Ex3.m1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1"><times id="S4.Ex3.m1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.2"></times><ci id="S4.Ex3.m1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.3">𝑃</ci><apply id="S4.Ex3.m1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex3.m1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2.2">𝐥</ci><apply id="S4.Ex3.m1.1.1.1.1.1.2.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2.3"><ci id="S4.Ex3.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.Ex3.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.Ex3.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.Ex3.m1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.Ex3.m1.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.3"><ci id="S4.Ex3.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.Ex3.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.Ex3.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">\displaystyle P({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex3.m2.1" class="ltx_Math" alttext="\displaystyle=\frac{1}{\mathcal{Z}}Q_{\bm{\theta}}({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T})," display="inline"><semantics id="S4.Ex3.m2.1a"><mrow id="S4.Ex3.m2.1.1.1" xref="S4.Ex3.m2.1.1.1.1.cmml"><mrow id="S4.Ex3.m2.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.cmml"><mi id="S4.Ex3.m2.1.1.1.1.3" xref="S4.Ex3.m2.1.1.1.1.3.cmml"></mi><mo id="S4.Ex3.m2.1.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex3.m2.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex3.m2.1.1.1.1.1.3" xref="S4.Ex3.m2.1.1.1.1.1.3.cmml"><mfrac id="S4.Ex3.m2.1.1.1.1.1.3a" xref="S4.Ex3.m2.1.1.1.1.1.3.cmml"><mn id="S4.Ex3.m2.1.1.1.1.1.3.2" xref="S4.Ex3.m2.1.1.1.1.1.3.2.cmml">1</mn><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m2.1.1.1.1.1.3.3" xref="S4.Ex3.m2.1.1.1.1.1.3.3.cmml">𝒵</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.Ex3.m2.1.1.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.1.2.cmml">​</mo><msub id="S4.Ex3.m2.1.1.1.1.1.4" xref="S4.Ex3.m2.1.1.1.1.1.4.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.4.2" xref="S4.Ex3.m2.1.1.1.1.1.4.2.cmml">Q</mi><mi id="S4.Ex3.m2.1.1.1.1.1.4.3" xref="S4.Ex3.m2.1.1.1.1.1.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex3.m2.1.1.1.1.1.2a" xref="S4.Ex3.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex3.m2.1.1.1.1.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐥</mi><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.3.cmml">u</mi></mrow></msub><mo fence="false" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.Ex3.m2.1.1.1.1.1.1.1.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex3.m2.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m2.1b"><apply id="S4.Ex3.m2.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1"><eq id="S4.Ex3.m2.1.1.1.1.2.cmml" xref="S4.Ex3.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.Ex3.m2.1.1.1.1.3.cmml" xref="S4.Ex3.m2.1.1.1.1.3">absent</csymbol><apply id="S4.Ex3.m2.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1"><times id="S4.Ex3.m2.1.1.1.1.1.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.2"></times><apply id="S4.Ex3.m2.1.1.1.1.1.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.3"><divide id="S4.Ex3.m2.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.3"></divide><cn type="integer" id="S4.Ex3.m2.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.3.2">1</cn><ci id="S4.Ex3.m2.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.3.3">𝒵</ci></apply><apply id="S4.Ex3.m2.1.1.1.1.1.4.cmml" xref="S4.Ex3.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex3.m2.1.1.1.1.1.4.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.Ex3.m2.1.1.1.1.1.4.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.4.2">𝑄</ci><ci id="S4.Ex3.m2.1.1.1.1.1.4.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.4.3">𝜽</ci></apply><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.2">𝐥</ci><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3"><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3"><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m2.1c">\displaystyle=\frac{1}{\mathcal{Z}}Q_{\bm{\theta}}({\mathbf{l}}_{1:u}|\mathbf{x}_{1:T}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\displaystyle=\frac{1}{\mathcal{Z}}\sum_{\bm{z}_{1:T}}Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})\cdot{1}_{{\mathbf{l}}_{1:u}}(\bm{z}_{1:T})." display="inline"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml"></mi><mo id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E5.m1.1.1.1.1.2.4" xref="S4.E5.m1.1.1.1.1.2.4.cmml"><mfrac id="S4.E5.m1.1.1.1.1.2.4a" xref="S4.E5.m1.1.1.1.1.2.4.cmml"><mn id="S4.E5.m1.1.1.1.1.2.4.2" xref="S4.E5.m1.1.1.1.1.2.4.2.cmml">1</mn><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.2.4.3" xref="S4.E5.m1.1.1.1.1.2.4.3.cmml">𝒵</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E5.m1.1.1.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml"><munder id="S4.E5.m1.1.1.1.1.2.2.3a" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="S4.E5.m1.1.1.1.1.2.2.3.2" xref="S4.E5.m1.1.1.1.1.2.2.3.2.cmml">∑</mo><msub id="S4.E5.m1.1.1.1.1.2.2.3.3" xref="S4.E5.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.3.3.2" xref="S4.E5.m1.1.1.1.1.2.2.3.3.2.cmml">𝒛</mi><mrow id="S4.E5.m1.1.1.1.1.2.2.3.3.3" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.cmml"><mn id="S4.E5.m1.1.1.1.1.2.2.3.3.3.2" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.1.1.1.1.2.2.3.3.3.1" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.1.cmml">:</mo><mi id="S4.E5.m1.1.1.1.1.2.2.3.3.3.3" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.3.cmml">T</mi></mrow></msub></munder></mstyle><mrow id="S4.E5.m1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐥</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mn id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">:</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">u</mi></mrow></msub></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.2.2.2.2.1" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.2.cmml">𝒛</mi><mrow id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.cmml"><mn id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.1" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.1.cmml">:</mo><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4">absent</csymbol><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><times id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3"></times><apply id="S4.E5.m1.1.1.1.1.2.4.cmml" xref="S4.E5.m1.1.1.1.1.2.4"><divide id="S4.E5.m1.1.1.1.1.2.4.1.cmml" xref="S4.E5.m1.1.1.1.1.2.4"></divide><cn type="integer" id="S4.E5.m1.1.1.1.1.2.4.2.cmml" xref="S4.E5.m1.1.1.1.1.2.4.2">1</cn><ci id="S4.E5.m1.1.1.1.1.2.4.3.cmml" xref="S4.E5.m1.1.1.1.1.2.4.3">𝒵</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2"><apply id="S4.E5.m1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.2"></sum><apply id="S4.E5.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3.2">𝒛</ci><apply id="S4.E5.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3"><ci id="S4.E5.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.1">:</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3.3.3">𝑇</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2"><times id="S4.E5.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.3"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2">𝑄</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2">1</cn><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.2">𝐥</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3"><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.1">:</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.3.3">𝑢</ci></apply></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.2">𝒛</ci><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3"><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.1">:</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle=\frac{1}{\mathcal{Z}}\sum_{\bm{z}_{1:T}}Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})\cdot{1}_{{\mathbf{l}}_{1:u}}(\bm{z}_{1:T}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.4" class="ltx_p">In the context of this Markov random field, the function <math id="S4.SS2.p1.4.m1.1" class="ltx_Math" alttext="Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.SS2.p1.4.m1.1a"><mrow id="S4.SS2.p1.4.m1.1.1" xref="S4.SS2.p1.4.m1.1.1.cmml"><msub id="S4.SS2.p1.4.m1.1.1.3" xref="S4.SS2.p1.4.m1.1.1.3.cmml"><mi id="S4.SS2.p1.4.m1.1.1.3.2" xref="S4.SS2.p1.4.m1.1.1.3.2.cmml">Q</mi><mi id="S4.SS2.p1.4.m1.1.1.3.3" xref="S4.SS2.p1.4.m1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m1.1.1.2" xref="S4.SS2.p1.4.m1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.4.m1.1.1.1.1" xref="S4.SS2.p1.4.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m1.1.1.1.1.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.4.m1.1.1.1.1.1" xref="S4.SS2.p1.4.m1.1.1.1.1.1.cmml"><msub id="S4.SS2.p1.4.m1.1.1.1.1.1.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.4.m1.1.1.1.1.1.2.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.cmml"><mn id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.1" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S4.SS2.p1.4.m1.1.1.1.1.1.1" xref="S4.SS2.p1.4.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.4.m1.1.1.1.1.1.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.4.m1.1.1.1.1.1.3.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.2" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.1" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.SS2.p1.4.m1.1.1.1.1.3" xref="S4.SS2.p1.4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m1.1b"><apply id="S4.SS2.p1.4.m1.1.1.cmml" xref="S4.SS2.p1.4.m1.1.1"><times id="S4.SS2.p1.4.m1.1.1.2.cmml" xref="S4.SS2.p1.4.m1.1.1.2"></times><apply id="S4.SS2.p1.4.m1.1.1.3.cmml" xref="S4.SS2.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.4.m1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m1.1.1.3.2">𝑄</ci><ci id="S4.SS2.p1.4.m1.1.1.3.3.cmml" xref="S4.SS2.p1.4.m1.1.1.3.3">𝜽</ci></apply><apply id="S4.SS2.p1.4.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.4.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.2">𝒛</ci><apply id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3"><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S4.SS2.p1.4.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3"><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.4.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m1.1c">Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})</annotation></semantics></math> factorises into a product of functions over maximal cliques in the CTC graph as follows:</p>
<table id="S6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><msub id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.3.2" xref="S4.E6.m1.1.1.3.2.cmml">Q</mi><mi id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.E6.m1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.2.3.cmml"><mn id="S4.E6.m1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E6.m1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S4.E6.m1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E6.m1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.E6.m1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E6.m1.1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.E6.m1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><times id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></times><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3.2">𝑄</ci><ci id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3">𝜽</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2.2">𝒛</ci><apply id="S4.E6.m1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.2.3"><ci id="S4.E6.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S4.E6.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2.3.2">1</cn><ci id="S4.E6.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S4.E6.m1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3"><ci id="S4.E6.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.E6.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.E6.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle Q_{\bm{\theta}}(\bm{z}_{1:T}|\mathbf{x}_{1:T})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6.m2.2" class="ltx_Math" alttext="\displaystyle={1}(\bm{z}_{1:T})\prod_{t=1}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})\ q(\bm{z}_{t}|\bm{z}_{t-1},T)." display="inline"><semantics id="S4.E6.m2.2a"><mrow id="S4.E6.m2.2.2.1" xref="S4.E6.m2.2.2.1.1.cmml"><mrow id="S4.E6.m2.2.2.1.1" xref="S4.E6.m2.2.2.1.1.cmml"><mi id="S4.E6.m2.2.2.1.1.5" xref="S4.E6.m2.2.2.1.1.5.cmml"></mi><mo id="S4.E6.m2.2.2.1.1.4" xref="S4.E6.m2.2.2.1.1.4.cmml">=</mo><mrow id="S4.E6.m2.2.2.1.1.3" xref="S4.E6.m2.2.2.1.1.3.cmml"><mn id="S4.E6.m2.2.2.1.1.3.5" xref="S4.E6.m2.2.2.1.1.3.5.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.E6.m2.2.2.1.1.3.4" xref="S4.E6.m2.2.2.1.1.3.4.cmml">​</mo><mrow id="S4.E6.m2.2.2.1.1.1.1.1" xref="S4.E6.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.2.2.1.1.1.1.1.2" xref="S4.E6.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E6.m2.2.2.1.1.1.1.1.1" xref="S4.E6.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E6.m2.2.2.1.1.1.1.1.1.2" xref="S4.E6.m2.2.2.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S4.E6.m2.2.2.1.1.1.1.1.1.3" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.cmml"><mn id="S4.E6.m2.2.2.1.1.1.1.1.1.3.2" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E6.m2.2.2.1.1.1.1.1.1.3.1" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.E6.m2.2.2.1.1.1.1.1.1.3.3" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S4.E6.m2.2.2.1.1.1.1.1.3" xref="S4.E6.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m2.2.2.1.1.3.4a" xref="S4.E6.m2.2.2.1.1.3.4.cmml">​</mo><mrow id="S4.E6.m2.2.2.1.1.3.3" xref="S4.E6.m2.2.2.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E6.m2.2.2.1.1.3.3.3" xref="S4.E6.m2.2.2.1.1.3.3.3.cmml"><munderover id="S4.E6.m2.2.2.1.1.3.3.3a" xref="S4.E6.m2.2.2.1.1.3.3.3.cmml"><mo movablelimits="false" id="S4.E6.m2.2.2.1.1.3.3.3.2.2" xref="S4.E6.m2.2.2.1.1.3.3.3.2.2.cmml">∏</mo><mrow id="S4.E6.m2.2.2.1.1.3.3.3.2.3" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.cmml"><mi id="S4.E6.m2.2.2.1.1.3.3.3.2.3.2" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="S4.E6.m2.2.2.1.1.3.3.3.2.3.1" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.1.cmml">=</mo><mn id="S4.E6.m2.2.2.1.1.3.3.3.2.3.3" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m2.2.2.1.1.3.3.3.3" xref="S4.E6.m2.2.2.1.1.3.3.3.3.cmml">T</mi></munderover></mstyle><mrow id="S4.E6.m2.2.2.1.1.3.3.2" xref="S4.E6.m2.2.2.1.1.3.3.2.cmml"><msub id="S4.E6.m2.2.2.1.1.3.3.2.4" xref="S4.E6.m2.2.2.1.1.3.3.2.4.cmml"><mi id="S4.E6.m2.2.2.1.1.3.3.2.4.2" xref="S4.E6.m2.2.2.1.1.3.3.2.4.2.cmml">P</mi><mi id="S4.E6.m2.2.2.1.1.3.3.2.4.3" xref="S4.E6.m2.2.2.1.1.3.3.2.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m2.2.2.1.1.3.3.2.3" xref="S4.E6.m2.2.2.1.1.3.3.2.3.cmml">​</mo><mrow id="S4.E6.m2.2.2.1.1.2.2.1.1.1" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.2" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.cmml"><msub id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.cmml"><mi id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.2" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.3" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.1" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.1.cmml">|</mo><msub id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.cmml"><mi id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.2" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.cmml"><mn id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.2" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.1" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.3" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.3" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.500em" rspace="0em" id="S4.E6.m2.2.2.1.1.3.3.2.3a" xref="S4.E6.m2.2.2.1.1.3.3.2.3.cmml">​</mo><mi id="S4.E6.m2.2.2.1.1.3.3.2.5" xref="S4.E6.m2.2.2.1.1.3.3.2.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.E6.m2.2.2.1.1.3.3.2.3b" xref="S4.E6.m2.2.2.1.1.3.3.2.3.cmml">​</mo><mrow id="S4.E6.m2.2.2.1.1.3.3.2.2.1" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.cmml">(</mo><mrow id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.cmml"><msub id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.cmml"><mi id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.2.cmml">𝒛</mi><mi id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.3" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.2.cmml">|</mo><mrow id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.2.cmml"><msub id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.cmml"><mi id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.1" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.3" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.2" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.2.cmml">,</mo><mi id="S4.E6.m2.1.1" xref="S4.E6.m2.1.1.cmml">T</mi></mrow></mrow><mo stretchy="false" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.3" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m2.2.2.1.2" xref="S4.E6.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m2.2b"><apply id="S4.E6.m2.2.2.1.1.cmml" xref="S4.E6.m2.2.2.1"><eq id="S4.E6.m2.2.2.1.1.4.cmml" xref="S4.E6.m2.2.2.1.1.4"></eq><csymbol cd="latexml" id="S4.E6.m2.2.2.1.1.5.cmml" xref="S4.E6.m2.2.2.1.1.5">absent</csymbol><apply id="S4.E6.m2.2.2.1.1.3.cmml" xref="S4.E6.m2.2.2.1.1.3"><times id="S4.E6.m2.2.2.1.1.3.4.cmml" xref="S4.E6.m2.2.2.1.1.3.4"></times><cn type="integer" id="S4.E6.m2.2.2.1.1.3.5.cmml" xref="S4.E6.m2.2.2.1.1.3.5">1</cn><apply id="S4.E6.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1.1.2">𝒛</ci><apply id="S4.E6.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3"><ci id="S4.E6.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.E6.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S4.E6.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m2.2.2.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S4.E6.m2.2.2.1.1.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3"><apply id="S4.E6.m2.2.2.1.1.3.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.3.3.3.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3">superscript</csymbol><apply id="S4.E6.m2.2.2.1.1.3.3.3.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.3.3.3.2.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3">subscript</csymbol><csymbol cd="latexml" id="S4.E6.m2.2.2.1.1.3.3.3.2.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.2.2">product</csymbol><apply id="S4.E6.m2.2.2.1.1.3.3.3.2.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3"><eq id="S4.E6.m2.2.2.1.1.3.3.3.2.3.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.1"></eq><ci id="S4.E6.m2.2.2.1.1.3.3.3.2.3.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S4.E6.m2.2.2.1.1.3.3.3.2.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.2.3.3">1</cn></apply></apply><ci id="S4.E6.m2.2.2.1.1.3.3.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.3.3">𝑇</ci></apply><apply id="S4.E6.m2.2.2.1.1.3.3.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2"><times id="S4.E6.m2.2.2.1.1.3.3.2.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.3"></times><apply id="S4.E6.m2.2.2.1.1.3.3.2.4.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.4"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.3.3.2.4.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.4">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.3.3.2.4.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.4.2">𝑃</ci><ci id="S4.E6.m2.2.2.1.1.3.3.2.4.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.4.3">𝜽</ci></apply><apply id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.2">𝒛</ci><ci id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.3.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.2.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.2">𝐱</ci><apply id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3"><ci id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.1">:</ci><cn type="integer" id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.2">1</cn><ci id="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E6.m2.2.2.1.1.2.2.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><ci id="S4.E6.m2.2.2.1.1.3.3.2.5.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.5">𝑞</ci><apply id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1"><csymbol cd="latexml" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.2">conditional</csymbol><apply id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.2">𝒛</ci><ci id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.3.3">𝑡</ci></apply><list id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1"><apply id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.2">𝒛</ci><apply id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3"><minus id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.1"></minus><ci id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E6.m2.2.2.1.1.3.3.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E6.m2.1.1.cmml" xref="S4.E6.m2.1.1">𝑇</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m2.2c">\displaystyle={1}(\bm{z}_{1:T})\prod_{t=1}^{T}P_{\bm{\theta}}(\bm{z}_{t}|\mathbf{x}_{1:t})\ q(\bm{z}_{t}|\bm{z}_{t-1},T).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.13" class="ltx_p">The partition function <math id="S4.SS2.p1.5.m1.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S4.SS2.p1.5.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.5.m1.1.1" xref="S4.SS2.p1.5.m1.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m1.1b"><ci id="S4.SS2.p1.5.m1.1.1.cmml" xref="S4.SS2.p1.5.m1.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m1.1c">\mathcal{Z}</annotation></semantics></math> presents a summation over all label sequences to ensure that the distribution is correctly normalised. The introduction of the characteristic function <math id="S4.SS2.p1.6.m2.1" class="ltx_Math" alttext="{1}(\bm{z}_{1:T})" display="inline"><semantics id="S4.SS2.p1.6.m2.1a"><mrow id="S4.SS2.p1.6.m2.1.1" xref="S4.SS2.p1.6.m2.1.1.cmml"><mn id="S4.SS2.p1.6.m2.1.1.3" xref="S4.SS2.p1.6.m2.1.1.3.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m2.1.1.2" xref="S4.SS2.p1.6.m2.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.6.m2.1.1.1.1" xref="S4.SS2.p1.6.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m2.1.1.1.1.2" xref="S4.SS2.p1.6.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p1.6.m2.1.1.1.1.1" xref="S4.SS2.p1.6.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m2.1.1.1.1.1.2" xref="S4.SS2.p1.6.m2.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S4.SS2.p1.6.m2.1.1.1.1.1.3" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.cmml"><mn id="S4.SS2.p1.6.m2.1.1.1.1.1.3.2" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.6.m2.1.1.1.1.1.3.1" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS2.p1.6.m2.1.1.1.1.1.3.3" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p1.6.m2.1.1.1.1.3" xref="S4.SS2.p1.6.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m2.1b"><apply id="S4.SS2.p1.6.m2.1.1.cmml" xref="S4.SS2.p1.6.m2.1.1"><times id="S4.SS2.p1.6.m2.1.1.2.cmml" xref="S4.SS2.p1.6.m2.1.1.2"></times><cn type="integer" id="S4.SS2.p1.6.m2.1.1.3.cmml" xref="S4.SS2.p1.6.m2.1.1.3">1</cn><apply id="S4.SS2.p1.6.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1.1.2">𝒛</ci><apply id="S4.SS2.p1.6.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3"><ci id="S4.SS2.p1.6.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.SS2.p1.6.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.2">1</cn><ci id="S4.SS2.p1.6.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.6.m2.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m2.1c">{1}(\bm{z}_{1:T})</annotation></semantics></math> enforces an additional constraint on the CTC graph, prohibiting diagonal transition from a label token to the blank symbol unless its the last token in the label sequence. It results in constrained form of CTC graph where blanks are not allowed between word-pieces within a word. This results in the algorithm’s time complexity being reduced to <math id="S4.SS2.p1.7.m3.1" class="ltx_Math" alttext="\mathcal{O}(N^{2}T)" display="inline"><semantics id="S4.SS2.p1.7.m3.1a"><mrow id="S4.SS2.p1.7.m3.1.1" xref="S4.SS2.p1.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.7.m3.1.1.3" xref="S4.SS2.p1.7.m3.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m3.1.1.2" xref="S4.SS2.p1.7.m3.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.7.m3.1.1.1.1" xref="S4.SS2.p1.7.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m3.1.1.1.1.2" xref="S4.SS2.p1.7.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.7.m3.1.1.1.1.1" xref="S4.SS2.p1.7.m3.1.1.1.1.1.cmml"><msup id="S4.SS2.p1.7.m3.1.1.1.1.1.2" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.7.m3.1.1.1.1.1.2.2" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2.2.cmml">N</mi><mn id="S4.SS2.p1.7.m3.1.1.1.1.1.2.3" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m3.1.1.1.1.1.1" xref="S4.SS2.p1.7.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.p1.7.m3.1.1.1.1.1.3" xref="S4.SS2.p1.7.m3.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S4.SS2.p1.7.m3.1.1.1.1.3" xref="S4.SS2.p1.7.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m3.1b"><apply id="S4.SS2.p1.7.m3.1.1.cmml" xref="S4.SS2.p1.7.m3.1.1"><times id="S4.SS2.p1.7.m3.1.1.2.cmml" xref="S4.SS2.p1.7.m3.1.1.2"></times><ci id="S4.SS2.p1.7.m3.1.1.3.cmml" xref="S4.SS2.p1.7.m3.1.1.3">𝒪</ci><apply id="S4.SS2.p1.7.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1"><times id="S4.SS2.p1.7.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.1"></times><apply id="S4.SS2.p1.7.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS2.p1.7.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2.2">𝑁</ci><cn type="integer" id="S4.SS2.p1.7.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.SS2.p1.7.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m3.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m3.1c">\mathcal{O}(N^{2}T)</annotation></semantics></math> from <math id="S4.SS2.p1.8.m4.1" class="ltx_Math" alttext="\mathcal{O}((2U+1)^{2}T)" display="inline"><semantics id="S4.SS2.p1.8.m4.1a"><mrow id="S4.SS2.p1.8.m4.1.1" xref="S4.SS2.p1.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.8.m4.1.1.3" xref="S4.SS2.p1.8.m4.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m4.1.1.2" xref="S4.SS2.p1.8.m4.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.8.m4.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m4.1.1.1.1.2" xref="S4.SS2.p1.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.8.m4.1.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.cmml"><msup id="S4.SS2.p1.8.m4.1.1.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">U</mi></mrow><mo id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.SS2.p1.8.m4.1.1.1.1.1.1.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m4.1.1.1.1.1.2" xref="S4.SS2.p1.8.m4.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS2.p1.8.m4.1.1.1.1.1.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S4.SS2.p1.8.m4.1.1.1.1.3" xref="S4.SS2.p1.8.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m4.1b"><apply id="S4.SS2.p1.8.m4.1.1.cmml" xref="S4.SS2.p1.8.m4.1.1"><times id="S4.SS2.p1.8.m4.1.1.2.cmml" xref="S4.SS2.p1.8.m4.1.1.2"></times><ci id="S4.SS2.p1.8.m4.1.1.3.cmml" xref="S4.SS2.p1.8.m4.1.1.3">𝒪</ci><apply id="S4.SS2.p1.8.m4.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1"><times id="S4.SS2.p1.8.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.2"></times><apply id="S4.SS2.p1.8.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1"><plus id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2"><times id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.2">2</cn><ci id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.2.3">𝑈</ci></apply><cn type="integer" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn type="integer" id="S4.SS2.p1.8.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.1.3">2</cn></apply><ci id="S4.SS2.p1.8.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m4.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m4.1c">\mathcal{O}((2U+1)^{2}T)</annotation></semantics></math>, where <math id="S4.SS2.p1.9.m5.1" class="ltx_Math" alttext="N&lt;2U+1" display="inline"><semantics id="S4.SS2.p1.9.m5.1a"><mrow id="S4.SS2.p1.9.m5.1.1" xref="S4.SS2.p1.9.m5.1.1.cmml"><mi id="S4.SS2.p1.9.m5.1.1.2" xref="S4.SS2.p1.9.m5.1.1.2.cmml">N</mi><mo id="S4.SS2.p1.9.m5.1.1.1" xref="S4.SS2.p1.9.m5.1.1.1.cmml">&lt;</mo><mrow id="S4.SS2.p1.9.m5.1.1.3" xref="S4.SS2.p1.9.m5.1.1.3.cmml"><mrow id="S4.SS2.p1.9.m5.1.1.3.2" xref="S4.SS2.p1.9.m5.1.1.3.2.cmml"><mn id="S4.SS2.p1.9.m5.1.1.3.2.2" xref="S4.SS2.p1.9.m5.1.1.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m5.1.1.3.2.1" xref="S4.SS2.p1.9.m5.1.1.3.2.1.cmml">​</mo><mi id="S4.SS2.p1.9.m5.1.1.3.2.3" xref="S4.SS2.p1.9.m5.1.1.3.2.3.cmml">U</mi></mrow><mo id="S4.SS2.p1.9.m5.1.1.3.1" xref="S4.SS2.p1.9.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p1.9.m5.1.1.3.3" xref="S4.SS2.p1.9.m5.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m5.1b"><apply id="S4.SS2.p1.9.m5.1.1.cmml" xref="S4.SS2.p1.9.m5.1.1"><lt id="S4.SS2.p1.9.m5.1.1.1.cmml" xref="S4.SS2.p1.9.m5.1.1.1"></lt><ci id="S4.SS2.p1.9.m5.1.1.2.cmml" xref="S4.SS2.p1.9.m5.1.1.2">𝑁</ci><apply id="S4.SS2.p1.9.m5.1.1.3.cmml" xref="S4.SS2.p1.9.m5.1.1.3"><plus id="S4.SS2.p1.9.m5.1.1.3.1.cmml" xref="S4.SS2.p1.9.m5.1.1.3.1"></plus><apply id="S4.SS2.p1.9.m5.1.1.3.2.cmml" xref="S4.SS2.p1.9.m5.1.1.3.2"><times id="S4.SS2.p1.9.m5.1.1.3.2.1.cmml" xref="S4.SS2.p1.9.m5.1.1.3.2.1"></times><cn type="integer" id="S4.SS2.p1.9.m5.1.1.3.2.2.cmml" xref="S4.SS2.p1.9.m5.1.1.3.2.2">2</cn><ci id="S4.SS2.p1.9.m5.1.1.3.2.3.cmml" xref="S4.SS2.p1.9.m5.1.1.3.2.3">𝑈</ci></apply><cn type="integer" id="S4.SS2.p1.9.m5.1.1.3.3.cmml" xref="S4.SS2.p1.9.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m5.1c">N&lt;2U+1</annotation></semantics></math>. This work also enforces a time-invariant transition probability <math id="S4.SS2.p1.10.m6.2" class="ltx_Math" alttext="q(\bm{z}_{t}|\bm{z}_{t-1},T)" display="inline"><semantics id="S4.SS2.p1.10.m6.2a"><mrow id="S4.SS2.p1.10.m6.2.2" xref="S4.SS2.p1.10.m6.2.2.cmml"><mi id="S4.SS2.p1.10.m6.2.2.3" xref="S4.SS2.p1.10.m6.2.2.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.10.m6.2.2.2" xref="S4.SS2.p1.10.m6.2.2.2.cmml">​</mo><mrow id="S4.SS2.p1.10.m6.2.2.1.1" xref="S4.SS2.p1.10.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m6.2.2.1.1.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.10.m6.2.2.1.1.1" xref="S4.SS2.p1.10.m6.2.2.1.1.1.cmml"><msub id="S4.SS2.p1.10.m6.2.2.1.1.1.3" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p1.10.m6.2.2.1.1.1.3.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3.2.cmml">𝒛</mi><mi id="S4.SS2.p1.10.m6.2.2.1.1.1.3.3" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S4.SS2.p1.10.m6.2.2.1.1.1.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.2.cmml"><msub id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.1" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.3" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.2" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.2.cmml">,</mo><mi id="S4.SS2.p1.10.m6.1.1" xref="S4.SS2.p1.10.m6.1.1.cmml">T</mi></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.10.m6.2.2.1.1.3" xref="S4.SS2.p1.10.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m6.2b"><apply id="S4.SS2.p1.10.m6.2.2.cmml" xref="S4.SS2.p1.10.m6.2.2"><times id="S4.SS2.p1.10.m6.2.2.2.cmml" xref="S4.SS2.p1.10.m6.2.2.2"></times><ci id="S4.SS2.p1.10.m6.2.2.3.cmml" xref="S4.SS2.p1.10.m6.2.2.3">𝑞</ci><apply id="S4.SS2.p1.10.m6.2.2.1.1.1.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.10.m6.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.2">conditional</csymbol><apply id="S4.SS2.p1.10.m6.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m6.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.10.m6.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3.2">𝒛</ci><ci id="S4.SS2.p1.10.m6.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.3.3">𝑡</ci></apply><list id="S4.SS2.p1.10.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1"><apply id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.2">𝒛</ci><apply id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3"><minus id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.1"></minus><ci id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.10.m6.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.10.m6.1.1.cmml" xref="S4.SS2.p1.10.m6.1.1">𝑇</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m6.2c">q(\bm{z}_{t}|\bm{z}_{t-1},T)</annotation></semantics></math> to discourage consecutive blank transitions. For transitions involving non-blank tokens, equal probabilities are assigned to both horizontal and diagonal movements. However, when <math id="S4.SS2.p1.11.m7.1" class="ltx_Math" alttext="\bm{z}_{t-1}=\emptyset" display="inline"><semantics id="S4.SS2.p1.11.m7.1a"><mrow id="S4.SS2.p1.11.m7.1.1" xref="S4.SS2.p1.11.m7.1.1.cmml"><msub id="S4.SS2.p1.11.m7.1.1.2" xref="S4.SS2.p1.11.m7.1.1.2.cmml"><mi id="S4.SS2.p1.11.m7.1.1.2.2" xref="S4.SS2.p1.11.m7.1.1.2.2.cmml">𝒛</mi><mrow id="S4.SS2.p1.11.m7.1.1.2.3" xref="S4.SS2.p1.11.m7.1.1.2.3.cmml"><mi id="S4.SS2.p1.11.m7.1.1.2.3.2" xref="S4.SS2.p1.11.m7.1.1.2.3.2.cmml">t</mi><mo id="S4.SS2.p1.11.m7.1.1.2.3.1" xref="S4.SS2.p1.11.m7.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p1.11.m7.1.1.2.3.3" xref="S4.SS2.p1.11.m7.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p1.11.m7.1.1.1" xref="S4.SS2.p1.11.m7.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS2.p1.11.m7.1.1.3" xref="S4.SS2.p1.11.m7.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m7.1b"><apply id="S4.SS2.p1.11.m7.1.1.cmml" xref="S4.SS2.p1.11.m7.1.1"><eq id="S4.SS2.p1.11.m7.1.1.1.cmml" xref="S4.SS2.p1.11.m7.1.1.1"></eq><apply id="S4.SS2.p1.11.m7.1.1.2.cmml" xref="S4.SS2.p1.11.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m7.1.1.2.1.cmml" xref="S4.SS2.p1.11.m7.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.11.m7.1.1.2.2.cmml" xref="S4.SS2.p1.11.m7.1.1.2.2">𝒛</ci><apply id="S4.SS2.p1.11.m7.1.1.2.3.cmml" xref="S4.SS2.p1.11.m7.1.1.2.3"><minus id="S4.SS2.p1.11.m7.1.1.2.3.1.cmml" xref="S4.SS2.p1.11.m7.1.1.2.3.1"></minus><ci id="S4.SS2.p1.11.m7.1.1.2.3.2.cmml" xref="S4.SS2.p1.11.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.11.m7.1.1.2.3.3.cmml" xref="S4.SS2.p1.11.m7.1.1.2.3.3">1</cn></apply></apply><emptyset id="S4.SS2.p1.11.m7.1.1.3.cmml" xref="S4.SS2.p1.11.m7.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m7.1c">\bm{z}_{t-1}=\emptyset</annotation></semantics></math>, the transition probability is <math id="S4.SS2.p1.12.m8.1" class="ltx_Math" alttext="\frac{1}{T}" display="inline"><semantics id="S4.SS2.p1.12.m8.1a"><mfrac id="S4.SS2.p1.12.m8.1.1" xref="S4.SS2.p1.12.m8.1.1.cmml"><mn id="S4.SS2.p1.12.m8.1.1.2" xref="S4.SS2.p1.12.m8.1.1.2.cmml">1</mn><mi id="S4.SS2.p1.12.m8.1.1.3" xref="S4.SS2.p1.12.m8.1.1.3.cmml">T</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m8.1b"><apply id="S4.SS2.p1.12.m8.1.1.cmml" xref="S4.SS2.p1.12.m8.1.1"><divide id="S4.SS2.p1.12.m8.1.1.1.cmml" xref="S4.SS2.p1.12.m8.1.1"></divide><cn type="integer" id="S4.SS2.p1.12.m8.1.1.2.cmml" xref="S4.SS2.p1.12.m8.1.1.2">1</cn><ci id="S4.SS2.p1.12.m8.1.1.3.cmml" xref="S4.SS2.p1.12.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m8.1c">\frac{1}{T}</annotation></semantics></math> for horizontal transition and <math id="S4.SS2.p1.13.m9.1" class="ltx_Math" alttext="\frac{T-1}{T}" display="inline"><semantics id="S4.SS2.p1.13.m9.1a"><mfrac id="S4.SS2.p1.13.m9.1.1" xref="S4.SS2.p1.13.m9.1.1.cmml"><mrow id="S4.SS2.p1.13.m9.1.1.2" xref="S4.SS2.p1.13.m9.1.1.2.cmml"><mi id="S4.SS2.p1.13.m9.1.1.2.2" xref="S4.SS2.p1.13.m9.1.1.2.2.cmml">T</mi><mo id="S4.SS2.p1.13.m9.1.1.2.1" xref="S4.SS2.p1.13.m9.1.1.2.1.cmml">−</mo><mn id="S4.SS2.p1.13.m9.1.1.2.3" xref="S4.SS2.p1.13.m9.1.1.2.3.cmml">1</mn></mrow><mi id="S4.SS2.p1.13.m9.1.1.3" xref="S4.SS2.p1.13.m9.1.1.3.cmml">T</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m9.1b"><apply id="S4.SS2.p1.13.m9.1.1.cmml" xref="S4.SS2.p1.13.m9.1.1"><divide id="S4.SS2.p1.13.m9.1.1.1.cmml" xref="S4.SS2.p1.13.m9.1.1"></divide><apply id="S4.SS2.p1.13.m9.1.1.2.cmml" xref="S4.SS2.p1.13.m9.1.1.2"><minus id="S4.SS2.p1.13.m9.1.1.2.1.cmml" xref="S4.SS2.p1.13.m9.1.1.2.1"></minus><ci id="S4.SS2.p1.13.m9.1.1.2.2.cmml" xref="S4.SS2.p1.13.m9.1.1.2.2">𝑇</ci><cn type="integer" id="S4.SS2.p1.13.m9.1.1.2.3.cmml" xref="S4.SS2.p1.13.m9.1.1.2.3">1</cn></apply><ci id="S4.SS2.p1.13.m9.1.1.3.cmml" xref="S4.SS2.p1.13.m9.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m9.1c">\frac{T-1}{T}</annotation></semantics></math> for diagonal transition.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Contrastive Loss</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.13" class="ltx_p">This work assumes the existence of a deterministic tokenizer <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">T</annotation></semantics></math>, which, for any given a pair <math id="S4.SS3.p1.2.m2.2" class="ltx_Math" alttext="(\mathbf{W}_{1:L},\mathbf{l}_{1:U})" display="inline"><semantics id="S4.SS3.p1.2.m2.2a"><mrow id="S4.SS3.p1.2.m2.2.2.2" xref="S4.SS3.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.2.2.2.3" xref="S4.SS3.p1.2.m2.2.2.3.cmml">(</mo><msub id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.1.1.2" xref="S4.SS3.p1.2.m2.1.1.1.1.2.cmml">𝐖</mi><mrow id="S4.SS3.p1.2.m2.1.1.1.1.3" xref="S4.SS3.p1.2.m2.1.1.1.1.3.cmml"><mn id="S4.SS3.p1.2.m2.1.1.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.2.m2.1.1.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p1.2.m2.1.1.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.1.1.3.3.cmml">L</mi></mrow></msub><mo id="S4.SS3.p1.2.m2.2.2.2.4" xref="S4.SS3.p1.2.m2.2.2.3.cmml">,</mo><msub id="S4.SS3.p1.2.m2.2.2.2.2" xref="S4.SS3.p1.2.m2.2.2.2.2.cmml"><mi id="S4.SS3.p1.2.m2.2.2.2.2.2" xref="S4.SS3.p1.2.m2.2.2.2.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p1.2.m2.2.2.2.2.3" xref="S4.SS3.p1.2.m2.2.2.2.2.3.cmml"><mn id="S4.SS3.p1.2.m2.2.2.2.2.3.2" xref="S4.SS3.p1.2.m2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.2.m2.2.2.2.2.3.1" xref="S4.SS3.p1.2.m2.2.2.2.2.3.1.cmml">:</mo><mi id="S4.SS3.p1.2.m2.2.2.2.2.3.3" xref="S4.SS3.p1.2.m2.2.2.2.2.3.3.cmml">U</mi></mrow></msub><mo stretchy="false" id="S4.SS3.p1.2.m2.2.2.2.5" xref="S4.SS3.p1.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.2b"><interval closure="open" id="S4.SS3.p1.2.m2.2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.2.2"><apply id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.2">𝐖</ci><apply id="S4.SS3.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.3"><ci id="S4.SS3.p1.2.m2.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.3.2">1</cn><ci id="S4.SS3.p1.2.m2.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S4.SS3.p1.2.m2.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.2.2.2.2.1.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2.2">𝐥</ci><apply id="S4.SS3.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2.3"><ci id="S4.SS3.p1.2.m2.2.2.2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.SS3.p1.2.m2.2.2.2.2.3.2.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2.3.2">1</cn><ci id="S4.SS3.p1.2.m2.2.2.2.2.3.3.cmml" xref="S4.SS3.p1.2.m2.2.2.2.2.3.3">𝑈</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.2c">(\mathbf{W}_{1:L},\mathbf{l}_{1:U})</annotation></semantics></math>, facilitates the alignment of each word <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{W}_{k}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">𝐖</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝐖</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\mathbf{W}_{k}</annotation></semantics></math> with a unique sub-sequence <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{l}_{j_{k}:j_{k+1}}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">𝐥</mi><mrow id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><msub id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2.2" xref="S4.SS3.p1.4.m4.1.1.3.2.2.cmml">j</mi><mi id="S4.SS3.p1.4.m4.1.1.3.2.3" xref="S4.SS3.p1.4.m4.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.4.m4.1.1.3.1" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">:</mo><msub id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.3.2" xref="S4.SS3.p1.4.m4.1.1.3.3.2.cmml">j</mi><mrow id="S4.SS3.p1.4.m4.1.1.3.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.3.3.2" xref="S4.SS3.p1.4.m4.1.1.3.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.4.m4.1.1.3.3.3.1" xref="S4.SS3.p1.4.m4.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.4.m4.1.1.3.3.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝐥</ci><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><ci id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.1">:</ci><apply id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2.2">𝑗</ci><ci id="S4.SS3.p1.4.m4.1.1.3.2.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.2">𝑗</ci><apply id="S4.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3"><plus id="S4.SS3.p1.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3.1"></plus><ci id="S4.SS3.p1.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.4.m4.1.1.3.3.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mathbf{l}_{j_{k}:j_{k+1}}</annotation></semantics></math>. For a given <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{x}_{1:T}" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><msub id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">𝐱</mi><mrow id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml"><mn id="S4.SS3.p1.5.m5.1.1.3.2" xref="S4.SS3.p1.5.m5.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.5.m5.1.1.3.1" xref="S4.SS3.p1.5.m5.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p1.5.m5.1.1.3.3" xref="S4.SS3.p1.5.m5.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">𝐱</ci><apply id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3"><ci id="S4.SS3.p1.5.m5.1.1.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.3.1">:</ci><cn type="integer" id="S4.SS3.p1.5.m5.1.1.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.3.2">1</cn><ci id="S4.SS3.p1.5.m5.1.1.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\mathbf{x}_{1:T}</annotation></semantics></math>, let <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\hat{\mathbf{z}}^{r}_{1:T}" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><msubsup id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.SS3.p1.6.m6.1.1.2.2" xref="S4.SS3.p1.6.m6.1.1.2.2.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2.2.2" xref="S4.SS3.p1.6.m6.1.1.2.2.2.cmml">𝐳</mi><mo id="S4.SS3.p1.6.m6.1.1.2.2.1" xref="S4.SS3.p1.6.m6.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml"><mn id="S4.SS3.p1.6.m6.1.1.3.2" xref="S4.SS3.p1.6.m6.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.6.m6.1.1.3.1" xref="S4.SS3.p1.6.m6.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p1.6.m6.1.1.3.3" xref="S4.SS3.p1.6.m6.1.1.3.3.cmml">T</mi></mrow><mi id="S4.SS3.p1.6.m6.1.1.2.3" xref="S4.SS3.p1.6.m6.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><apply id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.2.1.cmml" xref="S4.SS3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS3.p1.6.m6.1.1.2.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2.2"><ci id="S4.SS3.p1.6.m6.1.1.2.2.1.cmml" xref="S4.SS3.p1.6.m6.1.1.2.2.1">^</ci><ci id="S4.SS3.p1.6.m6.1.1.2.2.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2.2.2">𝐳</ci></apply><ci id="S4.SS3.p1.6.m6.1.1.2.3.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3">𝑟</ci></apply><apply id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3"><ci id="S4.SS3.p1.6.m6.1.1.3.1.cmml" xref="S4.SS3.p1.6.m6.1.1.3.1">:</ci><cn type="integer" id="S4.SS3.p1.6.m6.1.1.3.2.cmml" xref="S4.SS3.p1.6.m6.1.1.3.2">1</cn><ci id="S4.SS3.p1.6.m6.1.1.3.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\hat{\mathbf{z}}^{r}_{1:T}</annotation></semantics></math> denote the CTC alignment associated with the reference word-piece sequence and <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="\hat{\mathbf{z}}_{1:T}" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><msub id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mover accent="true" id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2.2" xref="S4.SS3.p1.7.m7.1.1.2.2.cmml">𝐳</mi><mo id="S4.SS3.p1.7.m7.1.1.2.1" xref="S4.SS3.p1.7.m7.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml"><mn id="S4.SS3.p1.7.m7.1.1.3.2" xref="S4.SS3.p1.7.m7.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.7.m7.1.1.3.1" xref="S4.SS3.p1.7.m7.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p1.7.m7.1.1.3.3" xref="S4.SS3.p1.7.m7.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">subscript</csymbol><apply id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2"><ci id="S4.SS3.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.p1.7.m7.1.1.2.1">^</ci><ci id="S4.SS3.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2.2">𝐳</ci></apply><apply id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3"><ci id="S4.SS3.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.p1.7.m7.1.1.3.1">:</ci><cn type="integer" id="S4.SS3.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.p1.7.m7.1.1.3.2">1</cn><ci id="S4.SS3.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">\hat{\mathbf{z}}_{1:T}</annotation></semantics></math> denote the CTC alignment associated with the word-piece sequence of an competing hypothesis. Additionally, let <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]}" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><msub id="S4.SS3.p1.8.m8.1.2" xref="S4.SS3.p1.8.m8.1.2.cmml"><mover accent="true" id="S4.SS3.p1.8.m8.1.2.2" xref="S4.SS3.p1.8.m8.1.2.2.cmml"><mi id="S4.SS3.p1.8.m8.1.2.2.2" xref="S4.SS3.p1.8.m8.1.2.2.2.cmml">𝐳</mi><mo id="S4.SS3.p1.8.m8.1.2.2.1" xref="S4.SS3.p1.8.m8.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p1.8.m8.1.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.8.m8.1.1.1.1.2" xref="S4.SS3.p1.8.m8.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p1.8.m8.1.1.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.1.1.cmml"><msub id="S4.SS3.p1.8.m8.1.1.1.1.1.2" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.8.m8.1.1.1.1.1.2.2" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p1.8.m8.1.1.1.1.1.2.3" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.8.m8.1.1.1.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p1.8.m8.1.1.1.1.1.3" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.1.1.1.3.2" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.2" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.1" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.3" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p1.8.m8.1.1.1.1.3" xref="S4.SS3.p1.8.m8.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.2.cmml" xref="S4.SS3.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.2">subscript</csymbol><apply id="S4.SS3.p1.8.m8.1.2.2.cmml" xref="S4.SS3.p1.8.m8.1.2.2"><ci id="S4.SS3.p1.8.m8.1.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.2.2.1">^</ci><ci id="S4.SS3.p1.8.m8.1.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.2.2.2">𝐳</ci></apply><apply id="S4.SS3.p1.8.m8.1.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.8.m8.1.1.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1"><ci id="S4.SS3.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3"><plus id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]}</annotation></semantics></math> denote the segment within the CTC alignment that aligns with <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{l}_{j_{k}:j_{k+1}}" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><msub id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2" xref="S4.SS3.p1.9.m9.1.1.2.cmml">𝐥</mi><mrow id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml"><msub id="S4.SS3.p1.9.m9.1.1.3.2" xref="S4.SS3.p1.9.m9.1.1.3.2.cmml"><mi id="S4.SS3.p1.9.m9.1.1.3.2.2" xref="S4.SS3.p1.9.m9.1.1.3.2.2.cmml">j</mi><mi id="S4.SS3.p1.9.m9.1.1.3.2.3" xref="S4.SS3.p1.9.m9.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.9.m9.1.1.3.1" xref="S4.SS3.p1.9.m9.1.1.3.1.cmml">:</mo><msub id="S4.SS3.p1.9.m9.1.1.3.3" xref="S4.SS3.p1.9.m9.1.1.3.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.3.3.2" xref="S4.SS3.p1.9.m9.1.1.3.3.2.cmml">j</mi><mrow id="S4.SS3.p1.9.m9.1.1.3.3.3" xref="S4.SS3.p1.9.m9.1.1.3.3.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.3.3.3.2" xref="S4.SS3.p1.9.m9.1.1.3.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.9.m9.1.1.3.3.3.1" xref="S4.SS3.p1.9.m9.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.9.m9.1.1.3.3.3.3" xref="S4.SS3.p1.9.m9.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2">𝐥</ci><apply id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3"><ci id="S4.SS3.p1.9.m9.1.1.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.1">:</ci><apply id="S4.SS3.p1.9.m9.1.1.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.3.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.3.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.2.2">𝑗</ci><ci id="S4.SS3.p1.9.m9.1.1.3.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.9.m9.1.1.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.3.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.3.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.2">𝑗</ci><apply id="S4.SS3.p1.9.m9.1.1.3.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.3"><plus id="S4.SS3.p1.9.m9.1.1.3.3.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.3.1"></plus><ci id="S4.SS3.p1.9.m9.1.1.3.3.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.9.m9.1.1.3.3.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">\mathbf{l}_{j_{k}:j_{k+1}}</annotation></semantics></math> i.e <math id="S4.SS3.p1.10.m10.2" class="ltx_Math" alttext="\mathbb{B}(\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]})=\mathbf{l}_{j_{k}:j_{k+1}}" display="inline"><semantics id="S4.SS3.p1.10.m10.2a"><mrow id="S4.SS3.p1.10.m10.2.2" xref="S4.SS3.p1.10.m10.2.2.cmml"><mrow id="S4.SS3.p1.10.m10.2.2.1" xref="S4.SS3.p1.10.m10.2.2.1.cmml"><mi id="S4.SS3.p1.10.m10.2.2.1.3" xref="S4.SS3.p1.10.m10.2.2.1.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.10.m10.2.2.1.2" xref="S4.SS3.p1.10.m10.2.2.1.2.cmml">​</mo><mrow id="S4.SS3.p1.10.m10.2.2.1.1.1" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.10.m10.2.2.1.1.1.2" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p1.10.m10.2.2.1.1.1.1" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.2" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.2.cmml">𝐳</mi><mo id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.1" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p1.10.m10.1.1.1.1" xref="S4.SS3.p1.10.m10.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.10.m10.1.1.1.1.2" xref="S4.SS3.p1.10.m10.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p1.10.m10.1.1.1.1.1" xref="S4.SS3.p1.10.m10.1.1.1.1.1.cmml"><msub id="S4.SS3.p1.10.m10.1.1.1.1.1.2" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.10.m10.1.1.1.1.1.2.2" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p1.10.m10.1.1.1.1.1.2.3" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.10.m10.1.1.1.1.1.1" xref="S4.SS3.p1.10.m10.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p1.10.m10.1.1.1.1.1.3" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.10.m10.1.1.1.1.1.3.2" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.2" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.1" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.3" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p1.10.m10.1.1.1.1.3" xref="S4.SS3.p1.10.m10.1.1.1.2.1.cmml">]</mo></mrow></msub><mo stretchy="false" id="S4.SS3.p1.10.m10.2.2.1.1.1.3" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.10.m10.2.2.2" xref="S4.SS3.p1.10.m10.2.2.2.cmml">=</mo><msub id="S4.SS3.p1.10.m10.2.2.3" xref="S4.SS3.p1.10.m10.2.2.3.cmml"><mi id="S4.SS3.p1.10.m10.2.2.3.2" xref="S4.SS3.p1.10.m10.2.2.3.2.cmml">𝐥</mi><mrow id="S4.SS3.p1.10.m10.2.2.3.3" xref="S4.SS3.p1.10.m10.2.2.3.3.cmml"><msub id="S4.SS3.p1.10.m10.2.2.3.3.2" xref="S4.SS3.p1.10.m10.2.2.3.3.2.cmml"><mi id="S4.SS3.p1.10.m10.2.2.3.3.2.2" xref="S4.SS3.p1.10.m10.2.2.3.3.2.2.cmml">j</mi><mi id="S4.SS3.p1.10.m10.2.2.3.3.2.3" xref="S4.SS3.p1.10.m10.2.2.3.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.10.m10.2.2.3.3.1" xref="S4.SS3.p1.10.m10.2.2.3.3.1.cmml">:</mo><msub id="S4.SS3.p1.10.m10.2.2.3.3.3" xref="S4.SS3.p1.10.m10.2.2.3.3.3.cmml"><mi id="S4.SS3.p1.10.m10.2.2.3.3.3.2" xref="S4.SS3.p1.10.m10.2.2.3.3.3.2.cmml">j</mi><mrow id="S4.SS3.p1.10.m10.2.2.3.3.3.3" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.cmml"><mi id="S4.SS3.p1.10.m10.2.2.3.3.3.3.2" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.10.m10.2.2.3.3.3.3.1" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.10.m10.2.2.3.3.3.3.3" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.2b"><apply id="S4.SS3.p1.10.m10.2.2.cmml" xref="S4.SS3.p1.10.m10.2.2"><eq id="S4.SS3.p1.10.m10.2.2.2.cmml" xref="S4.SS3.p1.10.m10.2.2.2"></eq><apply id="S4.SS3.p1.10.m10.2.2.1.cmml" xref="S4.SS3.p1.10.m10.2.2.1"><times id="S4.SS3.p1.10.m10.2.2.1.2.cmml" xref="S4.SS3.p1.10.m10.2.2.1.2"></times><ci id="S4.SS3.p1.10.m10.2.2.1.3.cmml" xref="S4.SS3.p1.10.m10.2.2.1.3">𝔹</ci><apply id="S4.SS3.p1.10.m10.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml" xref="S4.SS3.p1.10.m10.2.2.1.1.1">subscript</csymbol><apply id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.cmml" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2"><ci id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.1">^</ci><ci id="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.10.m10.2.2.1.1.1.1.2.2">𝐳</ci></apply><apply id="S4.SS3.p1.10.m10.1.1.1.2.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.10.m10.1.1.1.2.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p1.10.m10.1.1.1.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1"><ci id="S4.SS3.p1.10.m10.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p1.10.m10.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.10.m10.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.10.m10.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.10.m10.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3"><plus id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p1.10.m10.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.SS3.p1.10.m10.2.2.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.2.2.3.1.cmml" xref="S4.SS3.p1.10.m10.2.2.3">subscript</csymbol><ci id="S4.SS3.p1.10.m10.2.2.3.2.cmml" xref="S4.SS3.p1.10.m10.2.2.3.2">𝐥</ci><apply id="S4.SS3.p1.10.m10.2.2.3.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3"><ci id="S4.SS3.p1.10.m10.2.2.3.3.1.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.1">:</ci><apply id="S4.SS3.p1.10.m10.2.2.3.3.2.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.2.2.3.3.2.1.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.2">subscript</csymbol><ci id="S4.SS3.p1.10.m10.2.2.3.3.2.2.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.2.2">𝑗</ci><ci id="S4.SS3.p1.10.m10.2.2.3.3.2.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.10.m10.2.2.3.3.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.2.2.3.3.3.1.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3">subscript</csymbol><ci id="S4.SS3.p1.10.m10.2.2.3.3.3.2.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3.2">𝑗</ci><apply id="S4.SS3.p1.10.m10.2.2.3.3.3.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3"><plus id="S4.SS3.p1.10.m10.2.2.3.3.3.3.1.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.1"></plus><ci id="S4.SS3.p1.10.m10.2.2.3.3.3.3.2.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.10.m10.2.2.3.3.3.3.3.cmml" xref="S4.SS3.p1.10.m10.2.2.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.2c">\mathbb{B}(\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]})=\mathbf{l}_{j_{k}:j_{k+1}}</annotation></semantics></math>. By defining
<math id="S4.SS3.p1.11.m11.1" class="ltx_Math" alttext="\mathbf{l}^{e}_{j_{k}:j_{k+1}}" display="inline"><semantics id="S4.SS3.p1.11.m11.1a"><msubsup id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml"><mi id="S4.SS3.p1.11.m11.1.1.2.2" xref="S4.SS3.p1.11.m11.1.1.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p1.11.m11.1.1.3" xref="S4.SS3.p1.11.m11.1.1.3.cmml"><msub id="S4.SS3.p1.11.m11.1.1.3.2" xref="S4.SS3.p1.11.m11.1.1.3.2.cmml"><mi id="S4.SS3.p1.11.m11.1.1.3.2.2" xref="S4.SS3.p1.11.m11.1.1.3.2.2.cmml">j</mi><mi id="S4.SS3.p1.11.m11.1.1.3.2.3" xref="S4.SS3.p1.11.m11.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.11.m11.1.1.3.1" xref="S4.SS3.p1.11.m11.1.1.3.1.cmml">:</mo><msub id="S4.SS3.p1.11.m11.1.1.3.3" xref="S4.SS3.p1.11.m11.1.1.3.3.cmml"><mi id="S4.SS3.p1.11.m11.1.1.3.3.2" xref="S4.SS3.p1.11.m11.1.1.3.3.2.cmml">j</mi><mrow id="S4.SS3.p1.11.m11.1.1.3.3.3" xref="S4.SS3.p1.11.m11.1.1.3.3.3.cmml"><mi id="S4.SS3.p1.11.m11.1.1.3.3.3.2" xref="S4.SS3.p1.11.m11.1.1.3.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.11.m11.1.1.3.3.3.1" xref="S4.SS3.p1.11.m11.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.11.m11.1.1.3.3.3.3" xref="S4.SS3.p1.11.m11.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mi id="S4.SS3.p1.11.m11.1.1.2.3" xref="S4.SS3.p1.11.m11.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><apply id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m11.1.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1">subscript</csymbol><apply id="S4.SS3.p1.11.m11.1.1.2.cmml" xref="S4.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m11.1.1.2.1.cmml" xref="S4.SS3.p1.11.m11.1.1">superscript</csymbol><ci id="S4.SS3.p1.11.m11.1.1.2.2.cmml" xref="S4.SS3.p1.11.m11.1.1.2.2">𝐥</ci><ci id="S4.SS3.p1.11.m11.1.1.2.3.cmml" xref="S4.SS3.p1.11.m11.1.1.2.3">𝑒</ci></apply><apply id="S4.SS3.p1.11.m11.1.1.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3"><ci id="S4.SS3.p1.11.m11.1.1.3.1.cmml" xref="S4.SS3.p1.11.m11.1.1.3.1">:</ci><apply id="S4.SS3.p1.11.m11.1.1.3.2.cmml" xref="S4.SS3.p1.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m11.1.1.3.2.1.cmml" xref="S4.SS3.p1.11.m11.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p1.11.m11.1.1.3.2.2.cmml" xref="S4.SS3.p1.11.m11.1.1.3.2.2">𝑗</ci><ci id="S4.SS3.p1.11.m11.1.1.3.2.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.11.m11.1.1.3.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m11.1.1.3.3.1.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p1.11.m11.1.1.3.3.2.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3.2">𝑗</ci><apply id="S4.SS3.p1.11.m11.1.1.3.3.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3.3"><plus id="S4.SS3.p1.11.m11.1.1.3.3.3.1.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3.3.1"></plus><ci id="S4.SS3.p1.11.m11.1.1.3.3.3.2.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.11.m11.1.1.3.3.3.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">\mathbf{l}^{e}_{j_{k}:j_{k+1}}</annotation></semantics></math> to correspond to word-piece labels in the alignment <math id="S4.SS3.p1.12.m12.1" class="ltx_Math" alttext="\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]}" display="inline"><semantics id="S4.SS3.p1.12.m12.1a"><msub id="S4.SS3.p1.12.m12.1.2" xref="S4.SS3.p1.12.m12.1.2.cmml"><mover accent="true" id="S4.SS3.p1.12.m12.1.2.2" xref="S4.SS3.p1.12.m12.1.2.2.cmml"><mi id="S4.SS3.p1.12.m12.1.2.2.2" xref="S4.SS3.p1.12.m12.1.2.2.2.cmml">𝐳</mi><mo id="S4.SS3.p1.12.m12.1.2.2.1" xref="S4.SS3.p1.12.m12.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p1.12.m12.1.1.1.1" xref="S4.SS3.p1.12.m12.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.12.m12.1.1.1.1.2" xref="S4.SS3.p1.12.m12.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p1.12.m12.1.1.1.1.1" xref="S4.SS3.p1.12.m12.1.1.1.1.1.cmml"><msub id="S4.SS3.p1.12.m12.1.1.1.1.1.2" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.12.m12.1.1.1.1.1.2.2" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p1.12.m12.1.1.1.1.1.2.3" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.12.m12.1.1.1.1.1.1" xref="S4.SS3.p1.12.m12.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p1.12.m12.1.1.1.1.1.3" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.1.1.1.3.2" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.2" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.1" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.3" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p1.12.m12.1.1.1.1.3" xref="S4.SS3.p1.12.m12.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m12.1b"><apply id="S4.SS3.p1.12.m12.1.2.cmml" xref="S4.SS3.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.2.1.cmml" xref="S4.SS3.p1.12.m12.1.2">subscript</csymbol><apply id="S4.SS3.p1.12.m12.1.2.2.cmml" xref="S4.SS3.p1.12.m12.1.2.2"><ci id="S4.SS3.p1.12.m12.1.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.2.2.1">^</ci><ci id="S4.SS3.p1.12.m12.1.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.2.2.2">𝐳</ci></apply><apply id="S4.SS3.p1.12.m12.1.1.1.2.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.12.m12.1.1.1.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p1.12.m12.1.1.1.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1"><ci id="S4.SS3.p1.12.m12.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p1.12.m12.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p1.12.m12.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.12.m12.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3"><plus id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m12.1c">\hat{\mathbf{z}}_{[t_{k}:t_{k+1}]}</annotation></semantics></math> that are not present within the alignment segment in <math id="S4.SS3.p1.13.m13.1" class="ltx_Math" alttext="\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}" display="inline"><semantics id="S4.SS3.p1.13.m13.1a"><msubsup id="S4.SS3.p1.13.m13.1.2" xref="S4.SS3.p1.13.m13.1.2.cmml"><mi id="S4.SS3.p1.13.m13.1.2.2.2" xref="S4.SS3.p1.13.m13.1.2.2.2.cmml">𝐳</mi><mrow id="S4.SS3.p1.13.m13.1.1.1.1" xref="S4.SS3.p1.13.m13.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.13.m13.1.1.1.1.2" xref="S4.SS3.p1.13.m13.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p1.13.m13.1.1.1.1.1" xref="S4.SS3.p1.13.m13.1.1.1.1.1.cmml"><msub id="S4.SS3.p1.13.m13.1.1.1.1.1.2" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.13.m13.1.1.1.1.1.2.2" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p1.13.m13.1.1.1.1.1.2.3" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.13.m13.1.1.1.1.1.1" xref="S4.SS3.p1.13.m13.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p1.13.m13.1.1.1.1.1.3" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.13.m13.1.1.1.1.1.3.2" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.2" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.1" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.3" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p1.13.m13.1.1.1.1.3" xref="S4.SS3.p1.13.m13.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.SS3.p1.13.m13.1.2.2.3" xref="S4.SS3.p1.13.m13.1.2.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m13.1b"><apply id="S4.SS3.p1.13.m13.1.2.cmml" xref="S4.SS3.p1.13.m13.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.2.1.cmml" xref="S4.SS3.p1.13.m13.1.2">subscript</csymbol><apply id="S4.SS3.p1.13.m13.1.2.2.cmml" xref="S4.SS3.p1.13.m13.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.2.2.1.cmml" xref="S4.SS3.p1.13.m13.1.2">superscript</csymbol><ci id="S4.SS3.p1.13.m13.1.2.2.2.cmml" xref="S4.SS3.p1.13.m13.1.2.2.2">𝐳</ci><ci id="S4.SS3.p1.13.m13.1.2.2.3.cmml" xref="S4.SS3.p1.13.m13.1.2.2.3">𝑟</ci></apply><apply id="S4.SS3.p1.13.m13.1.1.1.2.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.13.m13.1.1.1.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p1.13.m13.1.1.1.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1"><ci id="S4.SS3.p1.13.m13.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p1.13.m13.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.13.m13.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p1.13.m13.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.13.m13.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.13.m13.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3"><plus id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p1.13.m13.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m13.1c">\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}</annotation></semantics></math>, the following segment-level loss function can now be delineated:</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<table id="S6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex4.m1.6" class="ltx_Math" alttext="\displaystyle\mathcal{L}(\bm{\theta},\mathbf{W}_{1:L},\mathbf{W}^{r}_{1:k}|\mathbf{x}_{1:T})=\mathcal{L}(\bm{\theta},\mathbf{l}_{1:U},\mathbf{l}^{r}_{1:U}|\mathbf{x}_{1:T})" display="inline"><semantics id="S4.Ex4.m1.6a"><mrow id="S4.Ex4.m1.6.6" xref="S4.Ex4.m1.6.6.cmml"><mrow id="S4.Ex4.m1.4.4.2" xref="S4.Ex4.m1.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.4.4.2.4" xref="S4.Ex4.m1.4.4.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.4.4.2.3" xref="S4.Ex4.m1.4.4.2.3.cmml">​</mo><mrow id="S4.Ex4.m1.4.4.2.2.2" xref="S4.Ex4.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S4.Ex4.m1.4.4.2.2.2.3" xref="S4.Ex4.m1.4.4.2.2.3.cmml">(</mo><mi id="S4.Ex4.m1.1.1" xref="S4.Ex4.m1.1.1.cmml">𝜽</mi><mo id="S4.Ex4.m1.4.4.2.2.2.4" xref="S4.Ex4.m1.4.4.2.2.3.cmml">,</mo><msub id="S4.Ex4.m1.3.3.1.1.1.1" xref="S4.Ex4.m1.3.3.1.1.1.1.cmml"><mi id="S4.Ex4.m1.3.3.1.1.1.1.2" xref="S4.Ex4.m1.3.3.1.1.1.1.2.cmml">𝐖</mi><mrow id="S4.Ex4.m1.3.3.1.1.1.1.3" xref="S4.Ex4.m1.3.3.1.1.1.1.3.cmml"><mn id="S4.Ex4.m1.3.3.1.1.1.1.3.2" xref="S4.Ex4.m1.3.3.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.3.3.1.1.1.1.3.1" xref="S4.Ex4.m1.3.3.1.1.1.1.3.1.cmml">:</mo><mi id="S4.Ex4.m1.3.3.1.1.1.1.3.3" xref="S4.Ex4.m1.3.3.1.1.1.1.3.3.cmml">L</mi></mrow></msub><mo id="S4.Ex4.m1.4.4.2.2.2.5" xref="S4.Ex4.m1.4.4.2.2.3.cmml">,</mo><mrow id="S4.Ex4.m1.4.4.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.2.cmml"><msubsup id="S4.Ex4.m1.4.4.2.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.Ex4.m1.4.4.2.2.2.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2.2.cmml">𝐖</mi><mrow id="S4.Ex4.m1.4.4.2.2.2.2.2.3" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.cmml"><mn id="S4.Ex4.m1.4.4.2.2.2.2.2.3.2" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.4.4.2.2.2.2.2.3.1" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.1.cmml">:</mo><mi id="S4.Ex4.m1.4.4.2.2.2.2.2.3.3" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.3.cmml">k</mi></mrow><mi id="S4.Ex4.m1.4.4.2.2.2.2.2.2.3" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2.3.cmml">r</mi></msubsup><mo fence="false" id="S4.Ex4.m1.4.4.2.2.2.2.1" xref="S4.Ex4.m1.4.4.2.2.2.2.1.cmml">|</mo><msub id="S4.Ex4.m1.4.4.2.2.2.2.3" xref="S4.Ex4.m1.4.4.2.2.2.2.3.cmml"><mi id="S4.Ex4.m1.4.4.2.2.2.2.3.2" xref="S4.Ex4.m1.4.4.2.2.2.2.3.2.cmml">𝐱</mi><mrow id="S4.Ex4.m1.4.4.2.2.2.2.3.3" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.cmml"><mn id="S4.Ex4.m1.4.4.2.2.2.2.3.3.2" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.4.4.2.2.2.2.3.3.1" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.1.cmml">:</mo><mi id="S4.Ex4.m1.4.4.2.2.2.2.3.3.3" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.Ex4.m1.4.4.2.2.2.6" xref="S4.Ex4.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m1.6.6.5" xref="S4.Ex4.m1.6.6.5.cmml">=</mo><mrow id="S4.Ex4.m1.6.6.4" xref="S4.Ex4.m1.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.6.6.4.4" xref="S4.Ex4.m1.6.6.4.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.6.6.4.3" xref="S4.Ex4.m1.6.6.4.3.cmml">​</mo><mrow id="S4.Ex4.m1.6.6.4.2.2" xref="S4.Ex4.m1.6.6.4.2.3.cmml"><mo stretchy="false" id="S4.Ex4.m1.6.6.4.2.2.3" xref="S4.Ex4.m1.6.6.4.2.3.cmml">(</mo><mi id="S4.Ex4.m1.2.2" xref="S4.Ex4.m1.2.2.cmml">𝜽</mi><mo id="S4.Ex4.m1.6.6.4.2.2.4" xref="S4.Ex4.m1.6.6.4.2.3.cmml">,</mo><msub id="S4.Ex4.m1.5.5.3.1.1.1" xref="S4.Ex4.m1.5.5.3.1.1.1.cmml"><mi id="S4.Ex4.m1.5.5.3.1.1.1.2" xref="S4.Ex4.m1.5.5.3.1.1.1.2.cmml">𝐥</mi><mrow id="S4.Ex4.m1.5.5.3.1.1.1.3" xref="S4.Ex4.m1.5.5.3.1.1.1.3.cmml"><mn id="S4.Ex4.m1.5.5.3.1.1.1.3.2" xref="S4.Ex4.m1.5.5.3.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.5.5.3.1.1.1.3.1" xref="S4.Ex4.m1.5.5.3.1.1.1.3.1.cmml">:</mo><mi id="S4.Ex4.m1.5.5.3.1.1.1.3.3" xref="S4.Ex4.m1.5.5.3.1.1.1.3.3.cmml">U</mi></mrow></msub><mo id="S4.Ex4.m1.6.6.4.2.2.5" xref="S4.Ex4.m1.6.6.4.2.3.cmml">,</mo><mrow id="S4.Ex4.m1.6.6.4.2.2.2" xref="S4.Ex4.m1.6.6.4.2.2.2.cmml"><msubsup id="S4.Ex4.m1.6.6.4.2.2.2.2" xref="S4.Ex4.m1.6.6.4.2.2.2.2.cmml"><mi id="S4.Ex4.m1.6.6.4.2.2.2.2.2.2" xref="S4.Ex4.m1.6.6.4.2.2.2.2.2.2.cmml">𝐥</mi><mrow id="S4.Ex4.m1.6.6.4.2.2.2.2.3" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.cmml"><mn id="S4.Ex4.m1.6.6.4.2.2.2.2.3.2" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.6.6.4.2.2.2.2.3.1" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.1.cmml">:</mo><mi id="S4.Ex4.m1.6.6.4.2.2.2.2.3.3" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.3.cmml">U</mi></mrow><mi id="S4.Ex4.m1.6.6.4.2.2.2.2.2.3" xref="S4.Ex4.m1.6.6.4.2.2.2.2.2.3.cmml">r</mi></msubsup><mo fence="false" id="S4.Ex4.m1.6.6.4.2.2.2.1" xref="S4.Ex4.m1.6.6.4.2.2.2.1.cmml">|</mo><msub id="S4.Ex4.m1.6.6.4.2.2.2.3" xref="S4.Ex4.m1.6.6.4.2.2.2.3.cmml"><mi id="S4.Ex4.m1.6.6.4.2.2.2.3.2" xref="S4.Ex4.m1.6.6.4.2.2.2.3.2.cmml">𝐱</mi><mrow id="S4.Ex4.m1.6.6.4.2.2.2.3.3" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.cmml"><mn id="S4.Ex4.m1.6.6.4.2.2.2.3.3.2" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.Ex4.m1.6.6.4.2.2.2.3.3.1" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.1.cmml">:</mo><mi id="S4.Ex4.m1.6.6.4.2.2.2.3.3.3" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.3.cmml">T</mi></mrow></msub></mrow><mo stretchy="false" id="S4.Ex4.m1.6.6.4.2.2.6" xref="S4.Ex4.m1.6.6.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.6b"><apply id="S4.Ex4.m1.6.6.cmml" xref="S4.Ex4.m1.6.6"><eq id="S4.Ex4.m1.6.6.5.cmml" xref="S4.Ex4.m1.6.6.5"></eq><apply id="S4.Ex4.m1.4.4.2.cmml" xref="S4.Ex4.m1.4.4.2"><times id="S4.Ex4.m1.4.4.2.3.cmml" xref="S4.Ex4.m1.4.4.2.3"></times><ci id="S4.Ex4.m1.4.4.2.4.cmml" xref="S4.Ex4.m1.4.4.2.4">ℒ</ci><vector id="S4.Ex4.m1.4.4.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2"><ci id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1">𝜽</ci><apply id="S4.Ex4.m1.3.3.1.1.1.1.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.2">𝐖</ci><apply id="S4.Ex4.m1.3.3.1.1.1.1.3.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.3"><ci id="S4.Ex4.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.3.2">1</cn><ci id="S4.Ex4.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S4.Ex4.m1.4.4.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2"><csymbol cd="latexml" id="S4.Ex4.m1.4.4.2.2.2.2.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.1">conditional</csymbol><apply id="S4.Ex4.m1.4.4.2.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2">subscript</csymbol><apply id="S4.Ex4.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2">superscript</csymbol><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2.2">𝐖</ci><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.Ex4.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3"><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.3.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.4.4.2.2.2.2.2.3.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.2">1</cn><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.3.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.Ex4.m1.4.4.2.2.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.2.2.2.3.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3">subscript</csymbol><ci id="S4.Ex4.m1.4.4.2.2.2.2.3.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3.2">𝐱</ci><apply id="S4.Ex4.m1.4.4.2.2.2.2.3.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3"><ci id="S4.Ex4.m1.4.4.2.2.2.2.3.3.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.4.4.2.2.2.2.3.3.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.2">1</cn><ci id="S4.Ex4.m1.4.4.2.2.2.2.3.3.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.3.3.3">𝑇</ci></apply></apply></apply></vector></apply><apply id="S4.Ex4.m1.6.6.4.cmml" xref="S4.Ex4.m1.6.6.4"><times id="S4.Ex4.m1.6.6.4.3.cmml" xref="S4.Ex4.m1.6.6.4.3"></times><ci id="S4.Ex4.m1.6.6.4.4.cmml" xref="S4.Ex4.m1.6.6.4.4">ℒ</ci><vector id="S4.Ex4.m1.6.6.4.2.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2"><ci id="S4.Ex4.m1.2.2.cmml" xref="S4.Ex4.m1.2.2">𝜽</ci><apply id="S4.Ex4.m1.5.5.3.1.1.1.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.5.5.3.1.1.1.1.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.5.5.3.1.1.1.2.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1.2">𝐥</ci><apply id="S4.Ex4.m1.5.5.3.1.1.1.3.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1.3"><ci id="S4.Ex4.m1.5.5.3.1.1.1.3.1.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.5.5.3.1.1.1.3.2.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1.3.2">1</cn><ci id="S4.Ex4.m1.5.5.3.1.1.1.3.3.cmml" xref="S4.Ex4.m1.5.5.3.1.1.1.3.3">𝑈</ci></apply></apply><apply id="S4.Ex4.m1.6.6.4.2.2.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2"><csymbol cd="latexml" id="S4.Ex4.m1.6.6.4.2.2.2.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.1">conditional</csymbol><apply id="S4.Ex4.m1.6.6.4.2.2.2.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.6.6.4.2.2.2.2.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2">subscript</csymbol><apply id="S4.Ex4.m1.6.6.4.2.2.2.2.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.6.6.4.2.2.2.2.2.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2">superscript</csymbol><ci id="S4.Ex4.m1.6.6.4.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.2.2">𝐥</ci><ci id="S4.Ex4.m1.6.6.4.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.Ex4.m1.6.6.4.2.2.2.2.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3"><ci id="S4.Ex4.m1.6.6.4.2.2.2.2.3.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.6.6.4.2.2.2.2.3.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.2">1</cn><ci id="S4.Ex4.m1.6.6.4.2.2.2.2.3.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.2.3.3">𝑈</ci></apply></apply><apply id="S4.Ex4.m1.6.6.4.2.2.2.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.6.6.4.2.2.2.3.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3">subscript</csymbol><ci id="S4.Ex4.m1.6.6.4.2.2.2.3.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3.2">𝐱</ci><apply id="S4.Ex4.m1.6.6.4.2.2.2.3.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3"><ci id="S4.Ex4.m1.6.6.4.2.2.2.3.3.1.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.1">:</ci><cn type="integer" id="S4.Ex4.m1.6.6.4.2.2.2.3.3.2.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.2">1</cn><ci id="S4.Ex4.m1.6.6.4.2.2.2.3.3.3.cmml" xref="S4.Ex4.m1.6.6.4.2.2.2.3.3.3">𝑇</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.6c">\displaystyle\mathcal{L}(\bm{\theta},\mathbf{W}_{1:L},\mathbf{W}^{r}_{1:k}|\mathbf{x}_{1:T})=\mathcal{L}(\bm{\theta},\mathbf{l}_{1:U},\mathbf{l}^{r}_{1:U}|\mathbf{x}_{1:T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7.m1.8" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{K}{1}_{\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}}(\mathbf{z}_{[t_{k}:t_{k+1}]})\log\dfrac{Q_{\bm{\theta}}(\mathbf{l}^{e}_{j_{k}:j_{k+1}}|\mathbf{x}_{[1:t_{k+1}]})}{Q_{\bm{\theta}}(\mathbf{l}^{r}_{[j_{k}:j_{k+1}]}|\mathbf{x}_{[1:t_{k+1}]})}" display="inline"><semantics id="S4.E7.m1.8a"><mrow id="S4.E7.m1.8.8" xref="S4.E7.m1.8.8.cmml"><mi id="S4.E7.m1.8.8.3" xref="S4.E7.m1.8.8.3.cmml"></mi><mo id="S4.E7.m1.8.8.2" xref="S4.E7.m1.8.8.2.cmml">=</mo><mrow id="S4.E7.m1.8.8.1" xref="S4.E7.m1.8.8.1.cmml"><mstyle displaystyle="true" id="S4.E7.m1.8.8.1.2" xref="S4.E7.m1.8.8.1.2.cmml"><munderover id="S4.E7.m1.8.8.1.2a" xref="S4.E7.m1.8.8.1.2.cmml"><mo movablelimits="false" id="S4.E7.m1.8.8.1.2.2.2" xref="S4.E7.m1.8.8.1.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.8.8.1.2.2.3" xref="S4.E7.m1.8.8.1.2.2.3.cmml"><mi id="S4.E7.m1.8.8.1.2.2.3.2" xref="S4.E7.m1.8.8.1.2.2.3.2.cmml">k</mi><mo id="S4.E7.m1.8.8.1.2.2.3.1" xref="S4.E7.m1.8.8.1.2.2.3.1.cmml">=</mo><mn id="S4.E7.m1.8.8.1.2.2.3.3" xref="S4.E7.m1.8.8.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.8.8.1.2.3" xref="S4.E7.m1.8.8.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E7.m1.8.8.1.1" xref="S4.E7.m1.8.8.1.1.cmml"><msub id="S4.E7.m1.8.8.1.1.3" xref="S4.E7.m1.8.8.1.1.3.cmml"><mn id="S4.E7.m1.8.8.1.1.3.2" xref="S4.E7.m1.8.8.1.1.3.2.cmml">1</mn><msubsup id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">:</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.E7.m1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1.3.3.1" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.E7.m1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.3.3.cmml">r</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.8.8.1.1.2" xref="S4.E7.m1.8.8.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.8.8.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.8.8.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.8.8.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.cmml"><mi id="S4.E7.m1.8.8.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.2" xref="S4.E7.m1.2.2.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><msub id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml"><mi id="S4.E7.m1.2.2.1.1.1.2.2" xref="S4.E7.m1.2.2.1.1.1.2.2.cmml">t</mi><mi id="S4.E7.m1.2.2.1.1.1.2.3" xref="S4.E7.m1.2.2.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.2.2.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.cmml">:</mo><msub id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.1.3.2" xref="S4.E7.m1.2.2.1.1.1.3.2.cmml">t</mi><mrow id="S4.E7.m1.2.2.1.1.1.3.3" xref="S4.E7.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E7.m1.2.2.1.1.1.3.3.2" xref="S4.E7.m1.2.2.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E7.m1.2.2.1.1.1.3.3.1" xref="S4.E7.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.2.2.1.1.1.3.3.3" xref="S4.E7.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.2.1.cmml">]</mo></mrow></msub><mo stretchy="false" id="S4.E7.m1.8.8.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E7.m1.8.8.1.1.2a" xref="S4.E7.m1.8.8.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.8.8.1.1.4" xref="S4.E7.m1.8.8.1.1.4.cmml"><mi id="S4.E7.m1.8.8.1.1.4.1" xref="S4.E7.m1.8.8.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.E7.m1.8.8.1.1.4a" xref="S4.E7.m1.8.8.1.1.4.cmml">⁡</mo><mstyle displaystyle="true" id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml"><mfrac id="S4.E7.m1.7.7a" xref="S4.E7.m1.7.7.cmml"><mrow id="S4.E7.m1.4.4.2" xref="S4.E7.m1.4.4.2.cmml"><msub id="S4.E7.m1.4.4.2.4" xref="S4.E7.m1.4.4.2.4.cmml"><mi id="S4.E7.m1.4.4.2.4.2" xref="S4.E7.m1.4.4.2.4.2.cmml">Q</mi><mi id="S4.E7.m1.4.4.2.4.3" xref="S4.E7.m1.4.4.2.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.2.3" xref="S4.E7.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E7.m1.4.4.2.2.1" xref="S4.E7.m1.4.4.2.2.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.4.4.2.2.1.2" xref="S4.E7.m1.4.4.2.2.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.2.2.1.1" xref="S4.E7.m1.4.4.2.2.1.1.cmml"><msubsup id="S4.E7.m1.4.4.2.2.1.1.2" xref="S4.E7.m1.4.4.2.2.1.1.2.cmml"><mi id="S4.E7.m1.4.4.2.2.1.1.2.2.2" xref="S4.E7.m1.4.4.2.2.1.1.2.2.2.cmml">𝐥</mi><mrow id="S4.E7.m1.4.4.2.2.1.1.2.3" xref="S4.E7.m1.4.4.2.2.1.1.2.3.cmml"><msub id="S4.E7.m1.4.4.2.2.1.1.2.3.2" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2.cmml"><mi id="S4.E7.m1.4.4.2.2.1.1.2.3.2.2" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2.2.cmml">j</mi><mi id="S4.E7.m1.4.4.2.2.1.1.2.3.2.3" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.4.4.2.2.1.1.2.3.1" xref="S4.E7.m1.4.4.2.2.1.1.2.3.1.cmml">:</mo><msub id="S4.E7.m1.4.4.2.2.1.1.2.3.3" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.cmml"><mi id="S4.E7.m1.4.4.2.2.1.1.2.3.3.2" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.2.cmml">j</mi><mrow id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.cmml"><mi id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.2" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.2.cmml">k</mi><mo id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.1" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.1.cmml">+</mo><mn id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.3" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mi id="S4.E7.m1.4.4.2.2.1.1.2.2.3" xref="S4.E7.m1.4.4.2.2.1.1.2.2.3.cmml">e</mi></msubsup><mo fence="false" id="S4.E7.m1.4.4.2.2.1.1.1" xref="S4.E7.m1.4.4.2.2.1.1.1.cmml">|</mo><msub id="S4.E7.m1.4.4.2.2.1.1.3" xref="S4.E7.m1.4.4.2.2.1.1.3.cmml"><mi id="S4.E7.m1.4.4.2.2.1.1.3.2" xref="S4.E7.m1.4.4.2.2.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml"><mn id="S4.E7.m1.3.3.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.3.3.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml">:</mo><msub id="S4.E7.m1.3.3.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.E7.m1.3.3.1.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.3.3.2" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.3.3.1" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.3.3.1.1.1.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.4.4.2.2.1.3" xref="S4.E7.m1.4.4.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E7.m1.7.7.5" xref="S4.E7.m1.7.7.5.cmml"><msub id="S4.E7.m1.7.7.5.5" xref="S4.E7.m1.7.7.5.5.cmml"><mi id="S4.E7.m1.7.7.5.5.2" xref="S4.E7.m1.7.7.5.5.2.cmml">Q</mi><mi id="S4.E7.m1.7.7.5.5.3" xref="S4.E7.m1.7.7.5.5.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.5.4" xref="S4.E7.m1.7.7.5.4.cmml">​</mo><mrow id="S4.E7.m1.7.7.5.3.1" xref="S4.E7.m1.7.7.5.3.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.5.3.1.2" xref="S4.E7.m1.7.7.5.3.1.1.cmml">(</mo><mrow id="S4.E7.m1.7.7.5.3.1.1" xref="S4.E7.m1.7.7.5.3.1.1.cmml"><msubsup id="S4.E7.m1.7.7.5.3.1.1.2" xref="S4.E7.m1.7.7.5.3.1.1.2.cmml"><mi id="S4.E7.m1.7.7.5.3.1.1.2.2.2" xref="S4.E7.m1.7.7.5.3.1.1.2.2.2.cmml">𝐥</mi><mrow id="S4.E7.m1.5.5.3.1.1.1" xref="S4.E7.m1.5.5.3.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.3.1.1.1.2" xref="S4.E7.m1.5.5.3.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.5.5.3.1.1.1.1" xref="S4.E7.m1.5.5.3.1.1.1.1.cmml"><msub id="S4.E7.m1.5.5.3.1.1.1.1.2" xref="S4.E7.m1.5.5.3.1.1.1.1.2.cmml"><mi id="S4.E7.m1.5.5.3.1.1.1.1.2.2" xref="S4.E7.m1.5.5.3.1.1.1.1.2.2.cmml">j</mi><mi id="S4.E7.m1.5.5.3.1.1.1.1.2.3" xref="S4.E7.m1.5.5.3.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.5.5.3.1.1.1.1.1" xref="S4.E7.m1.5.5.3.1.1.1.1.1.cmml">:</mo><msub id="S4.E7.m1.5.5.3.1.1.1.1.3" xref="S4.E7.m1.5.5.3.1.1.1.1.3.cmml"><mi id="S4.E7.m1.5.5.3.1.1.1.1.3.2" xref="S4.E7.m1.5.5.3.1.1.1.1.3.2.cmml">j</mi><mrow id="S4.E7.m1.5.5.3.1.1.1.1.3.3" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.5.5.3.1.1.1.1.3.3.2" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E7.m1.5.5.3.1.1.1.1.3.3.1" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.5.5.3.1.1.1.1.3.3.3" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.5.5.3.1.1.1.3" xref="S4.E7.m1.5.5.3.1.1.2.1.cmml">]</mo></mrow><mi id="S4.E7.m1.7.7.5.3.1.1.2.2.3" xref="S4.E7.m1.7.7.5.3.1.1.2.2.3.cmml">r</mi></msubsup><mo fence="false" id="S4.E7.m1.7.7.5.3.1.1.1" xref="S4.E7.m1.7.7.5.3.1.1.1.cmml">|</mo><msub id="S4.E7.m1.7.7.5.3.1.1.3" xref="S4.E7.m1.7.7.5.3.1.1.3.cmml"><mi id="S4.E7.m1.7.7.5.3.1.1.3.2" xref="S4.E7.m1.7.7.5.3.1.1.3.2.cmml">𝐱</mi><mrow id="S4.E7.m1.6.6.4.2.1.1" xref="S4.E7.m1.6.6.4.2.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.6.6.4.2.1.1.2" xref="S4.E7.m1.6.6.4.2.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.6.6.4.2.1.1.1" xref="S4.E7.m1.6.6.4.2.1.1.1.cmml"><mn id="S4.E7.m1.6.6.4.2.1.1.1.2" xref="S4.E7.m1.6.6.4.2.1.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.6.6.4.2.1.1.1.1" xref="S4.E7.m1.6.6.4.2.1.1.1.1.cmml">:</mo><msub id="S4.E7.m1.6.6.4.2.1.1.1.3" xref="S4.E7.m1.6.6.4.2.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.4.2.1.1.1.3.2" xref="S4.E7.m1.6.6.4.2.1.1.1.3.2.cmml">t</mi><mrow id="S4.E7.m1.6.6.4.2.1.1.1.3.3" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.cmml"><mi id="S4.E7.m1.6.6.4.2.1.1.1.3.3.2" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E7.m1.6.6.4.2.1.1.1.3.3.1" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.6.6.4.2.1.1.1.3.3.3" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.6.6.4.2.1.1.3" xref="S4.E7.m1.6.6.4.2.1.2.1.cmml">]</mo></mrow></msub></mrow><mo stretchy="false" id="S4.E7.m1.7.7.5.3.1.3" xref="S4.E7.m1.7.7.5.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.8b"><apply id="S4.E7.m1.8.8.cmml" xref="S4.E7.m1.8.8"><eq id="S4.E7.m1.8.8.2.cmml" xref="S4.E7.m1.8.8.2"></eq><csymbol cd="latexml" id="S4.E7.m1.8.8.3.cmml" xref="S4.E7.m1.8.8.3">absent</csymbol><apply id="S4.E7.m1.8.8.1.cmml" xref="S4.E7.m1.8.8.1"><apply id="S4.E7.m1.8.8.1.2.cmml" xref="S4.E7.m1.8.8.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.2.1.cmml" xref="S4.E7.m1.8.8.1.2">superscript</csymbol><apply id="S4.E7.m1.8.8.1.2.2.cmml" xref="S4.E7.m1.8.8.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.2.2.1.cmml" xref="S4.E7.m1.8.8.1.2">subscript</csymbol><sum id="S4.E7.m1.8.8.1.2.2.2.cmml" xref="S4.E7.m1.8.8.1.2.2.2"></sum><apply id="S4.E7.m1.8.8.1.2.2.3.cmml" xref="S4.E7.m1.8.8.1.2.2.3"><eq id="S4.E7.m1.8.8.1.2.2.3.1.cmml" xref="S4.E7.m1.8.8.1.2.2.3.1"></eq><ci id="S4.E7.m1.8.8.1.2.2.3.2.cmml" xref="S4.E7.m1.8.8.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.8.8.1.2.2.3.3.cmml" xref="S4.E7.m1.8.8.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.8.8.1.2.3.cmml" xref="S4.E7.m1.8.8.1.2.3">𝐾</ci></apply><apply id="S4.E7.m1.8.8.1.1.cmml" xref="S4.E7.m1.8.8.1.1"><times id="S4.E7.m1.8.8.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.2"></times><apply id="S4.E7.m1.8.8.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3">subscript</csymbol><cn type="integer" id="S4.E7.m1.8.8.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3.2">1</cn><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.3.2">𝐳</ci><ci id="S4.E7.m1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.3.3">𝑟</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1"><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1">:</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3"><plus id="S4.E7.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S4.E7.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.E7.m1.8.8.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.2">𝐳</ci><apply id="S4.E7.m1.2.2.1.2.cmml" xref="S4.E7.m1.2.2.1.1"><csymbol cd="latexml" id="S4.E7.m1.2.2.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1"><ci id="S4.E7.m1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1">:</ci><apply id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.E7.m1.2.2.1.1.1.2.3.cmml" xref="S4.E7.m1.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E7.m1.2.2.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.1.3.2">𝑡</ci><apply id="S4.E7.m1.2.2.1.1.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3"><plus id="S4.E7.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3.1"></plus><ci id="S4.E7.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S4.E7.m1.8.8.1.1.4.cmml" xref="S4.E7.m1.8.8.1.1.4"><log id="S4.E7.m1.8.8.1.1.4.1.cmml" xref="S4.E7.m1.8.8.1.1.4.1"></log><apply id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7"><divide id="S4.E7.m1.7.7.6.cmml" xref="S4.E7.m1.7.7"></divide><apply id="S4.E7.m1.4.4.2.cmml" xref="S4.E7.m1.4.4.2"><times id="S4.E7.m1.4.4.2.3.cmml" xref="S4.E7.m1.4.4.2.3"></times><apply id="S4.E7.m1.4.4.2.4.cmml" xref="S4.E7.m1.4.4.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.4.1.cmml" xref="S4.E7.m1.4.4.2.4">subscript</csymbol><ci id="S4.E7.m1.4.4.2.4.2.cmml" xref="S4.E7.m1.4.4.2.4.2">𝑄</ci><ci id="S4.E7.m1.4.4.2.4.3.cmml" xref="S4.E7.m1.4.4.2.4.3">𝜽</ci></apply><apply id="S4.E7.m1.4.4.2.2.1.1.cmml" xref="S4.E7.m1.4.4.2.2.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.2.2.1.1.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.1">conditional</csymbol><apply id="S4.E7.m1.4.4.2.2.1.1.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.1.1.2.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2">subscript</csymbol><apply id="S4.E7.m1.4.4.2.2.1.1.2.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.1.1.2.2.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2">superscript</csymbol><ci id="S4.E7.m1.4.4.2.2.1.1.2.2.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.2.2">𝐥</ci><ci id="S4.E7.m1.4.4.2.2.1.1.2.2.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.2.3">𝑒</ci></apply><apply id="S4.E7.m1.4.4.2.2.1.1.2.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3"><ci id="S4.E7.m1.4.4.2.2.1.1.2.3.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.1">:</ci><apply id="S4.E7.m1.4.4.2.2.1.1.2.3.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.1.1.2.3.2.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2">subscript</csymbol><ci id="S4.E7.m1.4.4.2.2.1.1.2.3.2.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2.2">𝑗</ci><ci id="S4.E7.m1.4.4.2.2.1.1.2.3.2.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.2.3">𝑘</ci></apply><apply id="S4.E7.m1.4.4.2.2.1.1.2.3.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.1.1.2.3.3.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3">subscript</csymbol><ci id="S4.E7.m1.4.4.2.2.1.1.2.3.3.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.2">𝑗</ci><apply id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3"><plus id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.1"></plus><ci id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.2.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="S4.E7.m1.4.4.2.2.1.1.3.cmml" xref="S4.E7.m1.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.1.1.3.1.cmml" xref="S4.E7.m1.4.4.2.2.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.2.2.1.1.3.2.cmml" xref="S4.E7.m1.4.4.2.2.1.1.3.2">𝐱</ci><apply id="S4.E7.m1.3.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1"><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1">:</ci><cn type="integer" id="S4.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.2">1</cn><apply id="S4.E7.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3"><plus id="S4.E7.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.1"></plus><ci id="S4.E7.m1.3.3.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E7.m1.7.7.5.cmml" xref="S4.E7.m1.7.7.5"><times id="S4.E7.m1.7.7.5.4.cmml" xref="S4.E7.m1.7.7.5.4"></times><apply id="S4.E7.m1.7.7.5.5.cmml" xref="S4.E7.m1.7.7.5.5"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.5.5.1.cmml" xref="S4.E7.m1.7.7.5.5">subscript</csymbol><ci id="S4.E7.m1.7.7.5.5.2.cmml" xref="S4.E7.m1.7.7.5.5.2">𝑄</ci><ci id="S4.E7.m1.7.7.5.5.3.cmml" xref="S4.E7.m1.7.7.5.5.3">𝜽</ci></apply><apply id="S4.E7.m1.7.7.5.3.1.1.cmml" xref="S4.E7.m1.7.7.5.3.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.5.3.1.1.1.cmml" xref="S4.E7.m1.7.7.5.3.1.1.1">conditional</csymbol><apply id="S4.E7.m1.7.7.5.3.1.1.2.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.5.3.1.1.2.1.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2">subscript</csymbol><apply id="S4.E7.m1.7.7.5.3.1.1.2.2.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.5.3.1.1.2.2.1.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2">superscript</csymbol><ci id="S4.E7.m1.7.7.5.3.1.1.2.2.2.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2.2.2">𝐥</ci><ci id="S4.E7.m1.7.7.5.3.1.1.2.2.3.cmml" xref="S4.E7.m1.7.7.5.3.1.1.2.2.3">𝑟</ci></apply><apply id="S4.E7.m1.5.5.3.1.1.2.cmml" xref="S4.E7.m1.5.5.3.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.5.5.3.1.1.2.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.5.5.3.1.1.1.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1"><ci id="S4.E7.m1.5.5.3.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.1">:</ci><apply id="S4.E7.m1.5.5.3.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.3.1.1.1.1.2.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.5.5.3.1.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.2.2">𝑗</ci><ci id="S4.E7.m1.5.5.3.1.1.1.1.2.3.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E7.m1.5.5.3.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.3.1.1.1.1.3.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.5.5.3.1.1.1.1.3.2.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3.2">𝑗</ci><apply id="S4.E7.m1.5.5.3.1.1.1.1.3.3.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3"><plus id="S4.E7.m1.5.5.3.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.1"></plus><ci id="S4.E7.m1.5.5.3.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.5.5.3.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.5.5.3.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S4.E7.m1.7.7.5.3.1.1.3.cmml" xref="S4.E7.m1.7.7.5.3.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.5.3.1.1.3.1.cmml" xref="S4.E7.m1.7.7.5.3.1.1.3">subscript</csymbol><ci id="S4.E7.m1.7.7.5.3.1.1.3.2.cmml" xref="S4.E7.m1.7.7.5.3.1.1.3.2">𝐱</ci><apply id="S4.E7.m1.6.6.4.2.1.2.cmml" xref="S4.E7.m1.6.6.4.2.1.1"><csymbol cd="latexml" id="S4.E7.m1.6.6.4.2.1.2.1.cmml" xref="S4.E7.m1.6.6.4.2.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.6.6.4.2.1.1.1.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1"><ci id="S4.E7.m1.6.6.4.2.1.1.1.1.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.1">:</ci><cn type="integer" id="S4.E7.m1.6.6.4.2.1.1.1.2.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.2">1</cn><apply id="S4.E7.m1.6.6.4.2.1.1.1.3.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.4.2.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.4.2.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3.2">𝑡</ci><apply id="S4.E7.m1.6.6.4.2.1.1.1.3.3.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3"><plus id="S4.E7.m1.6.6.4.2.1.1.1.3.3.1.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.1"></plus><ci id="S4.E7.m1.6.6.4.2.1.1.1.3.3.2.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.6.6.4.2.1.1.1.3.3.3.cmml" xref="S4.E7.m1.6.6.4.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.8c">\displaystyle=\sum_{k=1}^{K}{1}_{\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}}(\mathbf{z}_{[t_{k}:t_{k+1}]})\log\dfrac{Q_{\bm{\theta}}(\mathbf{l}^{e}_{j_{k}:j_{k+1}}|\mathbf{x}_{[1:t_{k+1}]})}{Q_{\bm{\theta}}(\mathbf{l}^{r}_{[j_{k}:j_{k+1}]}|\mathbf{x}_{[1:t_{k+1}]})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.10" class="ltx_p">The characteristic function <math id="S4.SS3.p3.1.m1.3" class="ltx_Math" alttext="{1}_{\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}}(\mathbf{z}_{[t_{k}:t_{k+1}]})" display="inline"><semantics id="S4.SS3.p3.1.m1.3a"><mrow id="S4.SS3.p3.1.m1.3.3" xref="S4.SS3.p3.1.m1.3.3.cmml"><msub id="S4.SS3.p3.1.m1.3.3.3" xref="S4.SS3.p3.1.m1.3.3.3.cmml"><mn id="S4.SS3.p3.1.m1.3.3.3.2" xref="S4.SS3.p3.1.m1.3.3.3.2.cmml">1</mn><msubsup id="S4.SS3.p3.1.m1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.3.2" xref="S4.SS3.p3.1.m1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S4.SS3.p3.1.m1.1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.SS3.p3.1.m1.1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.1.3.3.cmml">r</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p3.1.m1.3.3.2" xref="S4.SS3.p3.1.m1.3.3.2.cmml">​</mo><mrow id="S4.SS3.p3.1.m1.3.3.1.1" xref="S4.SS3.p3.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p3.1.m1.3.3.1.1.2" xref="S4.SS3.p3.1.m1.3.3.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.1.m1.3.3.1.1.1" xref="S4.SS3.p3.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.3.3.1.1.1.2" xref="S4.SS3.p3.1.m1.3.3.1.1.1.2.cmml">𝐳</mi><mrow id="S4.SS3.p3.1.m1.2.2.1.1" xref="S4.SS3.p3.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.1.m1.2.2.1.1.2" xref="S4.SS3.p3.1.m1.2.2.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.1.m1.2.2.1.1.1" xref="S4.SS3.p3.1.m1.2.2.1.1.1.cmml"><msub id="S4.SS3.p3.1.m1.2.2.1.1.1.2" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p3.1.m1.2.2.1.1.1.2.2" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p3.1.m1.2.2.1.1.1.2.3" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.1.m1.2.2.1.1.1.1" xref="S4.SS3.p3.1.m1.2.2.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p3.1.m1.2.2.1.1.1.3" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.cmml"><mi id="S4.SS3.p3.1.m1.2.2.1.1.1.3.2" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.2" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.1" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.3" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p3.1.m1.2.2.1.1.3" xref="S4.SS3.p3.1.m1.2.2.1.2.1.cmml">]</mo></mrow></msub><mo stretchy="false" id="S4.SS3.p3.1.m1.3.3.1.1.3" xref="S4.SS3.p3.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.3b"><apply id="S4.SS3.p3.1.m1.3.3.cmml" xref="S4.SS3.p3.1.m1.3.3"><times id="S4.SS3.p3.1.m1.3.3.2.cmml" xref="S4.SS3.p3.1.m1.3.3.2"></times><apply id="S4.SS3.p3.1.m1.3.3.3.cmml" xref="S4.SS3.p3.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.3.3.3.1.cmml" xref="S4.SS3.p3.1.m1.3.3.3">subscript</csymbol><cn type="integer" id="S4.SS3.p3.1.m1.3.3.3.2.cmml" xref="S4.SS3.p3.1.m1.3.3.3.2">1</cn><apply id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1">subscript</csymbol><apply id="S4.SS3.p3.1.m1.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1">superscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.3.2">𝐳</ci><ci id="S4.SS3.p3.1.m1.1.1.1.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.3.3">𝑟</ci></apply><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1"><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3"><plus id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.SS3.p3.1.m1.3.3.1.1.1.cmml" xref="S4.SS3.p3.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.3.3.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.3.3.1.1.1.2">𝐳</ci><apply id="S4.SS3.p3.1.m1.2.2.1.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1"><csymbol cd="latexml" id="S4.SS3.p3.1.m1.2.2.1.2.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1"><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.1">:</ci><apply id="S4.SS3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3"><plus id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.1"></plus><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.3c">{1}_{\mathbf{z}^{r}_{[t_{k}:t_{k+1}]}}(\mathbf{z}_{[t_{k}:t_{k+1}]})</annotation></semantics></math> equals to 0 if <math id="S4.SS3.p3.2.m2.4" class="ltx_Math" alttext="\mathbb{B}(\mathbf{z}_{[t_{k}:t_{k+1}]})=\mathbb{B}(\mathbf{z}^{r}_{[t_{k}:t_{k+1}]})" display="inline"><semantics id="S4.SS3.p3.2.m2.4a"><mrow id="S4.SS3.p3.2.m2.4.4" xref="S4.SS3.p3.2.m2.4.4.cmml"><mrow id="S4.SS3.p3.2.m2.3.3.1" xref="S4.SS3.p3.2.m2.3.3.1.cmml"><mi id="S4.SS3.p3.2.m2.3.3.1.3" xref="S4.SS3.p3.2.m2.3.3.1.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.2.m2.3.3.1.2" xref="S4.SS3.p3.2.m2.3.3.1.2.cmml">​</mo><mrow id="S4.SS3.p3.2.m2.3.3.1.1.1" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p3.2.m2.3.3.1.1.1.2" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.2.m2.3.3.1.1.1.1" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS3.p3.2.m2.3.3.1.1.1.1.2" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.2.cmml">𝐳</mi><mrow id="S4.SS3.p3.2.m2.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.2.m2.1.1.1.1.2" xref="S4.SS3.p3.2.m2.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.2.m2.1.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.cmml"><msub id="S4.SS3.p3.2.m2.1.1.1.1.1.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.2.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.2.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.2.m2.1.1.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p3.2.m2.1.1.1.1.1.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p3.2.m2.1.1.1.1.3" xref="S4.SS3.p3.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msub><mo stretchy="false" id="S4.SS3.p3.2.m2.3.3.1.1.1.3" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p3.2.m2.4.4.3" xref="S4.SS3.p3.2.m2.4.4.3.cmml">=</mo><mrow id="S4.SS3.p3.2.m2.4.4.2" xref="S4.SS3.p3.2.m2.4.4.2.cmml"><mi id="S4.SS3.p3.2.m2.4.4.2.3" xref="S4.SS3.p3.2.m2.4.4.2.3.cmml">𝔹</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.2.m2.4.4.2.2" xref="S4.SS3.p3.2.m2.4.4.2.2.cmml">​</mo><mrow id="S4.SS3.p3.2.m2.4.4.2.1.1" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p3.2.m2.4.4.2.1.1.2" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.cmml">(</mo><msubsup id="S4.SS3.p3.2.m2.4.4.2.1.1.1" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.cmml"><mi id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.2" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.2.cmml">𝐳</mi><mrow id="S4.SS3.p3.2.m2.2.2.1.1" xref="S4.SS3.p3.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.2.m2.2.2.1.1.2" xref="S4.SS3.p3.2.m2.2.2.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.2.m2.2.2.1.1.1" xref="S4.SS3.p3.2.m2.2.2.1.1.1.cmml"><msub id="S4.SS3.p3.2.m2.2.2.1.1.1.2" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.2.2.1.1.1.2.2" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.2.cmml">t</mi><mi id="S4.SS3.p3.2.m2.2.2.1.1.1.2.3" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.2.m2.2.2.1.1.1.1" xref="S4.SS3.p3.2.m2.2.2.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p3.2.m2.2.2.1.1.1.3" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.2.2.1.1.1.3.2" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.2.cmml">t</mi><mrow id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.cmml"><mi id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.2" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.1" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.3" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p3.2.m2.2.2.1.1.3" xref="S4.SS3.p3.2.m2.2.2.1.2.1.cmml">]</mo></mrow><mi id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.3" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S4.SS3.p3.2.m2.4.4.2.1.1.3" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.4b"><apply id="S4.SS3.p3.2.m2.4.4.cmml" xref="S4.SS3.p3.2.m2.4.4"><eq id="S4.SS3.p3.2.m2.4.4.3.cmml" xref="S4.SS3.p3.2.m2.4.4.3"></eq><apply id="S4.SS3.p3.2.m2.3.3.1.cmml" xref="S4.SS3.p3.2.m2.3.3.1"><times id="S4.SS3.p3.2.m2.3.3.1.2.cmml" xref="S4.SS3.p3.2.m2.3.3.1.2"></times><ci id="S4.SS3.p3.2.m2.3.3.1.3.cmml" xref="S4.SS3.p3.2.m2.3.3.1.3">𝔹</ci><apply id="S4.SS3.p3.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.3.3.1.1.1.1.2">𝐳</ci><apply id="S4.SS3.p3.2.m2.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.2.m2.1.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1"><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3"><plus id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.SS3.p3.2.m2.4.4.2.cmml" xref="S4.SS3.p3.2.m2.4.4.2"><times id="S4.SS3.p3.2.m2.4.4.2.2.cmml" xref="S4.SS3.p3.2.m2.4.4.2.2"></times><ci id="S4.SS3.p3.2.m2.4.4.2.3.cmml" xref="S4.SS3.p3.2.m2.4.4.2.3">𝔹</ci><apply id="S4.SS3.p3.2.m2.4.4.2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.4.4.2.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1">subscript</csymbol><apply id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1">superscript</csymbol><ci id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.2">𝐳</ci><ci id="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.4.4.2.1.1.1.2.3">𝑟</ci></apply><apply id="S4.SS3.p3.2.m2.2.2.1.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1"><csymbol cd="latexml" id="S4.SS3.p3.2.m2.2.2.1.2.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1"><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.1">:</ci><apply id="S4.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.2">𝑡</ci><apply id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3"><plus id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.1"></plus><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.4c">\mathbb{B}(\mathbf{z}_{[t_{k}:t_{k+1}]})=\mathbb{B}(\mathbf{z}^{r}_{[t_{k}:t_{k+1}]})</annotation></semantics></math> and 1 otherwise, and enables the identification of the specific audio segments where the model’s recognition does not align with its predicted guess.
The efficacy of the above segment level loss can be understood by studying its corresponding gradient update at time <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">t</annotation></semantics></math>. Let <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="\gamma^{r}_{t}" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><msubsup id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2.2" xref="S4.SS3.p3.4.m4.1.1.2.2.cmml">γ</mi><mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">t</mi><mi id="S4.SS3.p3.4.m4.1.1.2.3" xref="S4.SS3.p3.4.m4.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.2.1.cmml" xref="S4.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.2.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2.2">𝛾</ci><ci id="S4.SS3.p3.4.m4.1.1.2.3.cmml" xref="S4.SS3.p3.4.m4.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">\gamma^{r}_{t}</annotation></semantics></math> represent the vector where the <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">j</annotation></semantics></math>-th entry signifies the sum of probabilities of all alignments in the constrained CTC graph of <math id="S4.SS3.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{l}^{r}_{[j_{k}:j_{k+1}]}" display="inline"><semantics id="S4.SS3.p3.6.m6.1a"><msubsup id="S4.SS3.p3.6.m6.1.2" xref="S4.SS3.p3.6.m6.1.2.cmml"><mi id="S4.SS3.p3.6.m6.1.2.2.2" xref="S4.SS3.p3.6.m6.1.2.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p3.6.m6.1.1.1.1" xref="S4.SS3.p3.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.6.m6.1.1.1.1.2" xref="S4.SS3.p3.6.m6.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.6.m6.1.1.1.1.1" xref="S4.SS3.p3.6.m6.1.1.1.1.1.cmml"><msub id="S4.SS3.p3.6.m6.1.1.1.1.1.2" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.6.m6.1.1.1.1.1.2.2" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2.2.cmml">j</mi><mi id="S4.SS3.p3.6.m6.1.1.1.1.1.2.3" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.6.m6.1.1.1.1.1.1" xref="S4.SS3.p3.6.m6.1.1.1.1.1.1.cmml">:</mo><msub id="S4.SS3.p3.6.m6.1.1.1.1.1.3" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.1.1.1.3.2" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.2.cmml">j</mi><mrow id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.2" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.1" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.3" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p3.6.m6.1.1.1.1.3" xref="S4.SS3.p3.6.m6.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.SS3.p3.6.m6.1.2.2.3" xref="S4.SS3.p3.6.m6.1.2.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.2.cmml" xref="S4.SS3.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.2">subscript</csymbol><apply id="S4.SS3.p3.6.m6.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.2.2.1.cmml" xref="S4.SS3.p3.6.m6.1.2">superscript</csymbol><ci id="S4.SS3.p3.6.m6.1.2.2.2.cmml" xref="S4.SS3.p3.6.m6.1.2.2.2">𝐥</ci><ci id="S4.SS3.p3.6.m6.1.2.2.3.cmml" xref="S4.SS3.p3.6.m6.1.2.2.3">𝑟</ci></apply><apply id="S4.SS3.p3.6.m6.1.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.6.m6.1.1.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.6.m6.1.1.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1"><ci id="S4.SS3.p3.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.1">:</ci><apply id="S4.SS3.p3.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2.2">𝑗</ci><ci id="S4.SS3.p3.6.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.2">𝑗</ci><apply id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3"><plus id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.1"></plus><ci id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">\mathbf{l}^{r}_{[j_{k}:j_{k+1}]}</annotation></semantics></math>, assigning time <math id="S4.SS3.p3.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p3.7.m7.1a"><mi id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><ci id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">t</annotation></semantics></math> to the <math id="S4.SS3.p3.8.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p3.8.m8.1a"><mi id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><ci id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">j</annotation></semantics></math>-th token and normalized by the sum of all allowed alignments. Similarly, let <math id="S4.SS3.p3.9.m9.1" class="ltx_Math" alttext="\gamma_{t}" display="inline"><semantics id="S4.SS3.p3.9.m9.1a"><msub id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><mi id="S4.SS3.p3.9.m9.1.1.2" xref="S4.SS3.p3.9.m9.1.1.2.cmml">γ</mi><mi id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2">𝛾</ci><ci id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">\gamma_{t}</annotation></semantics></math> denote the equivalent probability yielded at each time step from the constrained CTC graph of <math id="S4.SS3.p3.10.m10.1" class="ltx_Math" alttext="\mathbf{l}^{e}_{j_{k}:j_{k+1}}" display="inline"><semantics id="S4.SS3.p3.10.m10.1a"><msubsup id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml"><mi id="S4.SS3.p3.10.m10.1.1.2.2" xref="S4.SS3.p3.10.m10.1.1.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p3.10.m10.1.1.3" xref="S4.SS3.p3.10.m10.1.1.3.cmml"><msub id="S4.SS3.p3.10.m10.1.1.3.2" xref="S4.SS3.p3.10.m10.1.1.3.2.cmml"><mi id="S4.SS3.p3.10.m10.1.1.3.2.2" xref="S4.SS3.p3.10.m10.1.1.3.2.2.cmml">j</mi><mi id="S4.SS3.p3.10.m10.1.1.3.2.3" xref="S4.SS3.p3.10.m10.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.10.m10.1.1.3.1" xref="S4.SS3.p3.10.m10.1.1.3.1.cmml">:</mo><msub id="S4.SS3.p3.10.m10.1.1.3.3" xref="S4.SS3.p3.10.m10.1.1.3.3.cmml"><mi id="S4.SS3.p3.10.m10.1.1.3.3.2" xref="S4.SS3.p3.10.m10.1.1.3.3.2.cmml">j</mi><mrow id="S4.SS3.p3.10.m10.1.1.3.3.3" xref="S4.SS3.p3.10.m10.1.1.3.3.3.cmml"><mi id="S4.SS3.p3.10.m10.1.1.3.3.3.2" xref="S4.SS3.p3.10.m10.1.1.3.3.3.2.cmml">k</mi><mo id="S4.SS3.p3.10.m10.1.1.3.3.3.1" xref="S4.SS3.p3.10.m10.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.10.m10.1.1.3.3.3.3" xref="S4.SS3.p3.10.m10.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mi id="S4.SS3.p3.10.m10.1.1.2.3" xref="S4.SS3.p3.10.m10.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1">subscript</csymbol><apply id="S4.SS3.p3.10.m10.1.1.2.cmml" xref="S4.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.2.1.cmml" xref="S4.SS3.p3.10.m10.1.1">superscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.2.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2.2">𝐥</ci><ci id="S4.SS3.p3.10.m10.1.1.2.3.cmml" xref="S4.SS3.p3.10.m10.1.1.2.3">𝑒</ci></apply><apply id="S4.SS3.p3.10.m10.1.1.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3"><ci id="S4.SS3.p3.10.m10.1.1.3.1.cmml" xref="S4.SS3.p3.10.m10.1.1.3.1">:</ci><apply id="S4.SS3.p3.10.m10.1.1.3.2.cmml" xref="S4.SS3.p3.10.m10.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.3.2.1.cmml" xref="S4.SS3.p3.10.m10.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.3.2.2.cmml" xref="S4.SS3.p3.10.m10.1.1.3.2.2">𝑗</ci><ci id="S4.SS3.p3.10.m10.1.1.3.2.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.10.m10.1.1.3.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.3.3.1.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.3.3.2.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3.2">𝑗</ci><apply id="S4.SS3.p3.10.m10.1.1.3.3.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3.3"><plus id="S4.SS3.p3.10.m10.1.1.3.3.3.1.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3.3.1"></plus><ci id="S4.SS3.p3.10.m10.1.1.3.3.3.2.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.SS3.p3.10.m10.1.1.3.3.3.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">\mathbf{l}^{e}_{j_{k}:j_{k+1}}</annotation></semantics></math>. Then,</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.11" class="ltx_Math" alttext="-\nabla\mathcal{L}(\bm{\theta})_{t}(j)=\left\{\begin{array}[]{ll}\gamma^{r}_{t}(j)&amp;\mbox{if}\ j\mbox{ in }\mathbf{l}^{r}_{[j_{k}:j_{k+1}]},\\
\gamma^{ref}(j)-\gamma_{t}(j)&amp;\text{ if}\ j\mbox{ is }\emptyset,\\
-\ \gamma_{t}(j)&amp;\text{if}\ j\mbox{ in }\mathbf{l}^{e}_{j_{k}:j_{k+1}},\\
0&amp;\text{otherwise}.\end{array}\right." display="block"><semantics id="S4.E8.m1.11a"><mrow id="S4.E8.m1.11.12" xref="S4.E8.m1.11.12.cmml"><mrow id="S4.E8.m1.11.12.2" xref="S4.E8.m1.11.12.2.cmml"><mo rspace="0.167em" id="S4.E8.m1.11.12.2a" xref="S4.E8.m1.11.12.2.cmml">−</mo><mrow id="S4.E8.m1.11.12.2.2" xref="S4.E8.m1.11.12.2.2.cmml"><mrow id="S4.E8.m1.11.12.2.2.2" xref="S4.E8.m1.11.12.2.2.2.cmml"><mo rspace="0.167em" id="S4.E8.m1.11.12.2.2.2.1" xref="S4.E8.m1.11.12.2.2.2.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.11.12.2.2.2.2" xref="S4.E8.m1.11.12.2.2.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.11.12.2.2.1" xref="S4.E8.m1.11.12.2.2.1.cmml">​</mo><msub id="S4.E8.m1.11.12.2.2.3" xref="S4.E8.m1.11.12.2.2.3.cmml"><mrow id="S4.E8.m1.11.12.2.2.3.2.2" xref="S4.E8.m1.11.12.2.2.3.cmml"><mo stretchy="false" id="S4.E8.m1.11.12.2.2.3.2.2.1" xref="S4.E8.m1.11.12.2.2.3.cmml">(</mo><mi id="S4.E8.m1.10.10" xref="S4.E8.m1.10.10.cmml">𝜽</mi><mo stretchy="false" id="S4.E8.m1.11.12.2.2.3.2.2.2" xref="S4.E8.m1.11.12.2.2.3.cmml">)</mo></mrow><mi id="S4.E8.m1.11.12.2.2.3.3" xref="S4.E8.m1.11.12.2.2.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.11.12.2.2.1a" xref="S4.E8.m1.11.12.2.2.1.cmml">​</mo><mrow id="S4.E8.m1.11.12.2.2.4.2" xref="S4.E8.m1.11.12.2.2.cmml"><mo stretchy="false" id="S4.E8.m1.11.12.2.2.4.2.1" xref="S4.E8.m1.11.12.2.2.cmml">(</mo><mi id="S4.E8.m1.11.11" xref="S4.E8.m1.11.11.cmml">j</mi><mo stretchy="false" id="S4.E8.m1.11.12.2.2.4.2.2" xref="S4.E8.m1.11.12.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.11.12.1" xref="S4.E8.m1.11.12.1.cmml">=</mo><mrow id="S4.E8.m1.11.12.3.2" xref="S4.E8.m1.11.12.3.1.cmml"><mo id="S4.E8.m1.11.12.3.2.1" xref="S4.E8.m1.11.12.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E8.m1.9.9" xref="S4.E8.m1.9.9.cmml"><mtr id="S4.E8.m1.9.9a" xref="S4.E8.m1.9.9.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9b" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.3.2.2.cmml">γ</mi><mi id="S4.E8.m1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.3.3.cmml">t</mi><mi id="S4.E8.m1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.3.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1.4.2" xref="S4.E8.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.4.2.1" xref="S4.E8.m1.1.1.1.1.1.cmml">(</mo><mi id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.4.2.2" xref="S4.E8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9c" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.3.3.3.3.2.2" xref="S4.E8.m1.3.3.3.3.2.2.1.cmml"><mrow id="S4.E8.m1.3.3.3.3.2.2.1" xref="S4.E8.m1.3.3.3.3.2.2.1.cmml"><mtext id="S4.E8.m1.3.3.3.3.2.2.1.2" xref="S4.E8.m1.3.3.3.3.2.2.1.2a.cmml">if</mtext><mo lspace="0.500em" rspace="0em" id="S4.E8.m1.3.3.3.3.2.2.1.1" xref="S4.E8.m1.3.3.3.3.2.2.1.1.cmml">​</mo><mi id="S4.E8.m1.3.3.3.3.2.2.1.3" xref="S4.E8.m1.3.3.3.3.2.2.1.3.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.3.3.2.2.1.1a" xref="S4.E8.m1.3.3.3.3.2.2.1.1.cmml">​</mo><mtext id="S4.E8.m1.3.3.3.3.2.2.1.4" xref="S4.E8.m1.3.3.3.3.2.2.1.4a.cmml"> in </mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.3.3.2.2.1.1b" xref="S4.E8.m1.3.3.3.3.2.2.1.1.cmml">​</mo><msubsup id="S4.E8.m1.3.3.3.3.2.2.1.5" xref="S4.E8.m1.3.3.3.3.2.2.1.5.cmml"><mi id="S4.E8.m1.3.3.3.3.2.2.1.5.2.2" xref="S4.E8.m1.3.3.3.3.2.2.1.5.2.2.cmml">𝐥</mi><mrow id="S4.E8.m1.2.2.2.2.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.2.2.1.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S4.E8.m1.2.2.2.2.1.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.cmml"><msub id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.2.cmml">j</mi><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml">:</mo><msub id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.2.cmml">j</mi><mrow id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.E8.m1.2.2.2.2.1.1.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.E8.m1.3.3.3.3.2.2.1.5.2.3" xref="S4.E8.m1.3.3.3.3.2.2.1.5.2.3.cmml">r</mi></msubsup></mrow><mo id="S4.E8.m1.3.3.3.3.2.2.2" xref="S4.E8.m1.3.3.3.3.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E8.m1.9.9d" xref="S4.E8.m1.9.9.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9e" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.5.5.5.2.2" xref="S4.E8.m1.5.5.5.2.2.cmml"><mrow id="S4.E8.m1.5.5.5.2.2.4" xref="S4.E8.m1.5.5.5.2.2.4.cmml"><msup id="S4.E8.m1.5.5.5.2.2.4.2" xref="S4.E8.m1.5.5.5.2.2.4.2.cmml"><mi id="S4.E8.m1.5.5.5.2.2.4.2.2" xref="S4.E8.m1.5.5.5.2.2.4.2.2.cmml">γ</mi><mrow id="S4.E8.m1.5.5.5.2.2.4.2.3" xref="S4.E8.m1.5.5.5.2.2.4.2.3.cmml"><mi id="S4.E8.m1.5.5.5.2.2.4.2.3.2" xref="S4.E8.m1.5.5.5.2.2.4.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.5.2.2.4.2.3.1" xref="S4.E8.m1.5.5.5.2.2.4.2.3.1.cmml">​</mo><mi id="S4.E8.m1.5.5.5.2.2.4.2.3.3" xref="S4.E8.m1.5.5.5.2.2.4.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.5.2.2.4.2.3.1a" xref="S4.E8.m1.5.5.5.2.2.4.2.3.1.cmml">​</mo><mi id="S4.E8.m1.5.5.5.2.2.4.2.3.4" xref="S4.E8.m1.5.5.5.2.2.4.2.3.4.cmml">f</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.5.2.2.4.1" xref="S4.E8.m1.5.5.5.2.2.4.1.cmml">​</mo><mrow id="S4.E8.m1.5.5.5.2.2.4.3.2" xref="S4.E8.m1.5.5.5.2.2.4.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.5.2.2.4.3.2.1" xref="S4.E8.m1.5.5.5.2.2.4.cmml">(</mo><mi id="S4.E8.m1.4.4.4.1.1.1" xref="S4.E8.m1.4.4.4.1.1.1.cmml">j</mi><mo stretchy="false" id="S4.E8.m1.5.5.5.2.2.4.3.2.2" xref="S4.E8.m1.5.5.5.2.2.4.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.5.5.5.2.2.3" xref="S4.E8.m1.5.5.5.2.2.3.cmml">−</mo><mrow id="S4.E8.m1.5.5.5.2.2.5" xref="S4.E8.m1.5.5.5.2.2.5.cmml"><msub id="S4.E8.m1.5.5.5.2.2.5.2" xref="S4.E8.m1.5.5.5.2.2.5.2.cmml"><mi id="S4.E8.m1.5.5.5.2.2.5.2.2" xref="S4.E8.m1.5.5.5.2.2.5.2.2.cmml">γ</mi><mi id="S4.E8.m1.5.5.5.2.2.5.2.3" xref="S4.E8.m1.5.5.5.2.2.5.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.5.2.2.5.1" xref="S4.E8.m1.5.5.5.2.2.5.1.cmml">​</mo><mrow id="S4.E8.m1.5.5.5.2.2.5.3.2" xref="S4.E8.m1.5.5.5.2.2.5.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.5.2.2.5.3.2.1" xref="S4.E8.m1.5.5.5.2.2.5.cmml">(</mo><mi id="S4.E8.m1.5.5.5.2.2.2" xref="S4.E8.m1.5.5.5.2.2.2.cmml">j</mi><mo stretchy="false" id="S4.E8.m1.5.5.5.2.2.5.3.2.2" xref="S4.E8.m1.5.5.5.2.2.5.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9f" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.6.6.6.3.1.1" xref="S4.E8.m1.6.6.6.3.1.1.1.cmml"><mrow id="S4.E8.m1.6.6.6.3.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.1.cmml"><mtext id="S4.E8.m1.6.6.6.3.1.1.1.2" xref="S4.E8.m1.6.6.6.3.1.1.1.2a.cmml"> if</mtext><mo lspace="0.500em" rspace="0em" id="S4.E8.m1.6.6.6.3.1.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.1.1.cmml">​</mo><mi id="S4.E8.m1.6.6.6.3.1.1.1.3" xref="S4.E8.m1.6.6.6.3.1.1.1.3.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.6.6.6.3.1.1.1.1a" xref="S4.E8.m1.6.6.6.3.1.1.1.1.cmml">​</mo><mtext id="S4.E8.m1.6.6.6.3.1.1.1.4" xref="S4.E8.m1.6.6.6.3.1.1.1.4a.cmml"> is </mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.6.6.6.3.1.1.1.1b" xref="S4.E8.m1.6.6.6.3.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.E8.m1.6.6.6.3.1.1.1.5" xref="S4.E8.m1.6.6.6.3.1.1.1.5.cmml">∅</mi></mrow><mo id="S4.E8.m1.6.6.6.3.1.1.2" xref="S4.E8.m1.6.6.6.3.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E8.m1.9.9g" xref="S4.E8.m1.9.9.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9h" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.7.7.7.1.1" xref="S4.E8.m1.7.7.7.1.1.cmml"><mo id="S4.E8.m1.7.7.7.1.1a" xref="S4.E8.m1.7.7.7.1.1.cmml">−</mo><mrow id="S4.E8.m1.7.7.7.1.1.3" xref="S4.E8.m1.7.7.7.1.1.3.cmml"><msub id="S4.E8.m1.7.7.7.1.1.3.2" xref="S4.E8.m1.7.7.7.1.1.3.2.cmml"><mi id="S4.E8.m1.7.7.7.1.1.3.2.2" xref="S4.E8.m1.7.7.7.1.1.3.2.2.cmml">γ</mi><mi id="S4.E8.m1.7.7.7.1.1.3.2.3" xref="S4.E8.m1.7.7.7.1.1.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.7.7.7.1.1.3.1" xref="S4.E8.m1.7.7.7.1.1.3.1.cmml">​</mo><mrow id="S4.E8.m1.7.7.7.1.1.3.3.2" xref="S4.E8.m1.7.7.7.1.1.3.cmml"><mo stretchy="false" id="S4.E8.m1.7.7.7.1.1.3.3.2.1" xref="S4.E8.m1.7.7.7.1.1.3.cmml">(</mo><mi id="S4.E8.m1.7.7.7.1.1.1" xref="S4.E8.m1.7.7.7.1.1.1.cmml">j</mi><mo stretchy="false" id="S4.E8.m1.7.7.7.1.1.3.3.2.2" xref="S4.E8.m1.7.7.7.1.1.3.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9i" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.8.8.8.2.1.1" xref="S4.E8.m1.8.8.8.2.1.1.1.cmml"><mrow id="S4.E8.m1.8.8.8.2.1.1.1" xref="S4.E8.m1.8.8.8.2.1.1.1.cmml"><mtext id="S4.E8.m1.8.8.8.2.1.1.1.2" xref="S4.E8.m1.8.8.8.2.1.1.1.2a.cmml">if</mtext><mo lspace="0.500em" rspace="0em" id="S4.E8.m1.8.8.8.2.1.1.1.1" xref="S4.E8.m1.8.8.8.2.1.1.1.1.cmml">​</mo><mi id="S4.E8.m1.8.8.8.2.1.1.1.3" xref="S4.E8.m1.8.8.8.2.1.1.1.3.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.8.8.8.2.1.1.1.1a" xref="S4.E8.m1.8.8.8.2.1.1.1.1.cmml">​</mo><mtext id="S4.E8.m1.8.8.8.2.1.1.1.4" xref="S4.E8.m1.8.8.8.2.1.1.1.4a.cmml"> in </mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.8.8.8.2.1.1.1.1b" xref="S4.E8.m1.8.8.8.2.1.1.1.1.cmml">​</mo><msubsup id="S4.E8.m1.8.8.8.2.1.1.1.5" xref="S4.E8.m1.8.8.8.2.1.1.1.5.cmml"><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.2.2" xref="S4.E8.m1.8.8.8.2.1.1.1.5.2.2.cmml">𝐥</mi><mrow id="S4.E8.m1.8.8.8.2.1.1.1.5.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.cmml"><msub id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.cmml"><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.2" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.2.cmml">j</mi><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.E8.m1.8.8.8.2.1.1.1.5.3.1" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.1.cmml">:</mo><msub id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.cmml"><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.2" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.2.cmml">j</mi><mrow id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.cmml"><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.2" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.2.cmml">k</mi><mo id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.1" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.1.cmml">+</mo><mn id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mi id="S4.E8.m1.8.8.8.2.1.1.1.5.2.3" xref="S4.E8.m1.8.8.8.2.1.1.1.5.2.3.cmml">e</mi></msubsup></mrow><mo id="S4.E8.m1.8.8.8.2.1.1.2" xref="S4.E8.m1.8.8.8.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E8.m1.9.9j" xref="S4.E8.m1.9.9.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9k" xref="S4.E8.m1.9.9.cmml"><mn id="S4.E8.m1.9.9.9.2.1" xref="S4.E8.m1.9.9.9.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.9.9l" xref="S4.E8.m1.9.9.cmml"><mrow id="S4.E8.m1.9.9.9.1.1.3" xref="S4.E8.m1.9.9.9.1.1.1a.cmml"><mtext id="S4.E8.m1.9.9.9.1.1.1" xref="S4.E8.m1.9.9.9.1.1.1.cmml">otherwise</mtext><mo lspace="0em" id="S4.E8.m1.9.9.9.1.1.3.1" xref="S4.E8.m1.9.9.9.1.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="S4.E8.m1.11.12.3.2.2" xref="S4.E8.m1.11.12.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.11b"><apply id="S4.E8.m1.11.12.cmml" xref="S4.E8.m1.11.12"><eq id="S4.E8.m1.11.12.1.cmml" xref="S4.E8.m1.11.12.1"></eq><apply id="S4.E8.m1.11.12.2.cmml" xref="S4.E8.m1.11.12.2"><minus id="S4.E8.m1.11.12.2.1.cmml" xref="S4.E8.m1.11.12.2"></minus><apply id="S4.E8.m1.11.12.2.2.cmml" xref="S4.E8.m1.11.12.2.2"><times id="S4.E8.m1.11.12.2.2.1.cmml" xref="S4.E8.m1.11.12.2.2.1"></times><apply id="S4.E8.m1.11.12.2.2.2.cmml" xref="S4.E8.m1.11.12.2.2.2"><ci id="S4.E8.m1.11.12.2.2.2.1.cmml" xref="S4.E8.m1.11.12.2.2.2.1">∇</ci><ci id="S4.E8.m1.11.12.2.2.2.2.cmml" xref="S4.E8.m1.11.12.2.2.2.2">ℒ</ci></apply><apply id="S4.E8.m1.11.12.2.2.3.cmml" xref="S4.E8.m1.11.12.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.11.12.2.2.3.1.cmml" xref="S4.E8.m1.11.12.2.2.3">subscript</csymbol><ci id="S4.E8.m1.10.10.cmml" xref="S4.E8.m1.10.10">𝜽</ci><ci id="S4.E8.m1.11.12.2.2.3.3.cmml" xref="S4.E8.m1.11.12.2.2.3.3">𝑡</ci></apply><ci id="S4.E8.m1.11.11.cmml" xref="S4.E8.m1.11.11">𝑗</ci></apply></apply><apply id="S4.E8.m1.11.12.3.1.cmml" xref="S4.E8.m1.11.12.3.2"><csymbol cd="latexml" id="S4.E8.m1.11.12.3.1.1.cmml" xref="S4.E8.m1.11.12.3.2.1">cases</csymbol><matrix id="S4.E8.m1.9.9.cmml" xref="S4.E8.m1.9.9"><matrixrow id="S4.E8.m1.9.9a.cmml" xref="S4.E8.m1.9.9"><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2.2">𝛾</ci><ci id="S4.E8.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S4.E8.m1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.3">𝑡</ci></apply><ci id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1">𝑗</ci></apply><apply id="S4.E8.m1.3.3.3.3.2.2.1.cmml" xref="S4.E8.m1.3.3.3.3.2.2"><times id="S4.E8.m1.3.3.3.3.2.2.1.1.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.1"></times><ci id="S4.E8.m1.3.3.3.3.2.2.1.2a.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.2"><mtext id="S4.E8.m1.3.3.3.3.2.2.1.2.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.2">if</mtext></ci><ci id="S4.E8.m1.3.3.3.3.2.2.1.3.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.3">𝑗</ci><ci id="S4.E8.m1.3.3.3.3.2.2.1.4a.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.4"><mtext id="S4.E8.m1.3.3.3.3.2.2.1.4.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.4"> in </mtext></ci><apply id="S4.E8.m1.3.3.3.3.2.2.1.5.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.2.2.1.5.1.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5">subscript</csymbol><apply id="S4.E8.m1.3.3.3.3.2.2.1.5.2.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.2.2.1.5.2.1.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5">superscript</csymbol><ci id="S4.E8.m1.3.3.3.3.2.2.1.5.2.2.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5.2.2">𝐥</ci><ci id="S4.E8.m1.3.3.3.3.2.2.1.5.2.3.cmml" xref="S4.E8.m1.3.3.3.3.2.2.1.5.2.3">𝑟</ci></apply><apply id="S4.E8.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1"><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1">:</ci><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.2">𝑗</ci><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.2">𝑗</ci><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3"><plus id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.1"></plus><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></matrixrow><matrixrow id="S4.E8.m1.9.9b.cmml" xref="S4.E8.m1.9.9"><apply id="S4.E8.m1.5.5.5.2.2.cmml" xref="S4.E8.m1.5.5.5.2.2"><minus id="S4.E8.m1.5.5.5.2.2.3.cmml" xref="S4.E8.m1.5.5.5.2.2.3"></minus><apply id="S4.E8.m1.5.5.5.2.2.4.cmml" xref="S4.E8.m1.5.5.5.2.2.4"><times id="S4.E8.m1.5.5.5.2.2.4.1.cmml" xref="S4.E8.m1.5.5.5.2.2.4.1"></times><apply id="S4.E8.m1.5.5.5.2.2.4.2.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.5.2.2.4.2.1.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2">superscript</csymbol><ci id="S4.E8.m1.5.5.5.2.2.4.2.2.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.2">𝛾</ci><apply id="S4.E8.m1.5.5.5.2.2.4.2.3.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.3"><times id="S4.E8.m1.5.5.5.2.2.4.2.3.1.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.3.1"></times><ci id="S4.E8.m1.5.5.5.2.2.4.2.3.2.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.3.2">𝑟</ci><ci id="S4.E8.m1.5.5.5.2.2.4.2.3.3.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.3.3">𝑒</ci><ci id="S4.E8.m1.5.5.5.2.2.4.2.3.4.cmml" xref="S4.E8.m1.5.5.5.2.2.4.2.3.4">𝑓</ci></apply></apply><ci id="S4.E8.m1.4.4.4.1.1.1.cmml" xref="S4.E8.m1.4.4.4.1.1.1">𝑗</ci></apply><apply id="S4.E8.m1.5.5.5.2.2.5.cmml" xref="S4.E8.m1.5.5.5.2.2.5"><times id="S4.E8.m1.5.5.5.2.2.5.1.cmml" xref="S4.E8.m1.5.5.5.2.2.5.1"></times><apply id="S4.E8.m1.5.5.5.2.2.5.2.cmml" xref="S4.E8.m1.5.5.5.2.2.5.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.5.2.2.5.2.1.cmml" xref="S4.E8.m1.5.5.5.2.2.5.2">subscript</csymbol><ci id="S4.E8.m1.5.5.5.2.2.5.2.2.cmml" xref="S4.E8.m1.5.5.5.2.2.5.2.2">𝛾</ci><ci id="S4.E8.m1.5.5.5.2.2.5.2.3.cmml" xref="S4.E8.m1.5.5.5.2.2.5.2.3">𝑡</ci></apply><ci id="S4.E8.m1.5.5.5.2.2.2.cmml" xref="S4.E8.m1.5.5.5.2.2.2">𝑗</ci></apply></apply><apply id="S4.E8.m1.6.6.6.3.1.1.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1"><times id="S4.E8.m1.6.6.6.3.1.1.1.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1"></times><ci id="S4.E8.m1.6.6.6.3.1.1.1.2a.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.2"><mtext id="S4.E8.m1.6.6.6.3.1.1.1.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.2"> if</mtext></ci><ci id="S4.E8.m1.6.6.6.3.1.1.1.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.3">𝑗</ci><ci id="S4.E8.m1.6.6.6.3.1.1.1.4a.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.4"><mtext id="S4.E8.m1.6.6.6.3.1.1.1.4.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.4"> is </mtext></ci><emptyset id="S4.E8.m1.6.6.6.3.1.1.1.5.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.5"></emptyset></apply></matrixrow><matrixrow id="S4.E8.m1.9.9c.cmml" xref="S4.E8.m1.9.9"><apply id="S4.E8.m1.7.7.7.1.1.cmml" xref="S4.E8.m1.7.7.7.1.1"><minus id="S4.E8.m1.7.7.7.1.1.2.cmml" xref="S4.E8.m1.7.7.7.1.1"></minus><apply id="S4.E8.m1.7.7.7.1.1.3.cmml" xref="S4.E8.m1.7.7.7.1.1.3"><times id="S4.E8.m1.7.7.7.1.1.3.1.cmml" xref="S4.E8.m1.7.7.7.1.1.3.1"></times><apply id="S4.E8.m1.7.7.7.1.1.3.2.cmml" xref="S4.E8.m1.7.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.7.1.1.3.2.1.cmml" xref="S4.E8.m1.7.7.7.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.7.7.7.1.1.3.2.2.cmml" xref="S4.E8.m1.7.7.7.1.1.3.2.2">𝛾</ci><ci id="S4.E8.m1.7.7.7.1.1.3.2.3.cmml" xref="S4.E8.m1.7.7.7.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E8.m1.7.7.7.1.1.1.cmml" xref="S4.E8.m1.7.7.7.1.1.1">𝑗</ci></apply></apply><apply id="S4.E8.m1.8.8.8.2.1.1.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1"><times id="S4.E8.m1.8.8.8.2.1.1.1.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.1"></times><ci id="S4.E8.m1.8.8.8.2.1.1.1.2a.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.2"><mtext id="S4.E8.m1.8.8.8.2.1.1.1.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.2">if</mtext></ci><ci id="S4.E8.m1.8.8.8.2.1.1.1.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.3">𝑗</ci><ci id="S4.E8.m1.8.8.8.2.1.1.1.4a.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.4"><mtext id="S4.E8.m1.8.8.8.2.1.1.1.4.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.4"> in </mtext></ci><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.8.2.1.1.1.5.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5">subscript</csymbol><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.8.2.1.1.1.5.2.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5">superscript</csymbol><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.2.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.2.2">𝐥</ci><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.2.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.2.3">𝑒</ci></apply><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3"><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.3.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.1">:</ci><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2">subscript</csymbol><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.2">𝑗</ci><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.2.3">𝑘</ci></apply><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3">subscript</csymbol><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.2">𝑗</ci><apply id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3"><plus id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.1.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.1"></plus><ci id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.2.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.2">𝑘</ci><cn type="integer" id="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.3.cmml" xref="S4.E8.m1.8.8.8.2.1.1.1.5.3.3.3.3">1</cn></apply></apply></apply></apply></apply></matrixrow><matrixrow id="S4.E8.m1.9.9d.cmml" xref="S4.E8.m1.9.9"><cn type="integer" id="S4.E8.m1.9.9.9.2.1.cmml" xref="S4.E8.m1.9.9.9.2.1">0</cn><ci id="S4.E8.m1.9.9.9.1.1.1a.cmml" xref="S4.E8.m1.9.9.9.1.1.3"><mtext id="S4.E8.m1.9.9.9.1.1.1.cmml" xref="S4.E8.m1.9.9.9.1.1.1">otherwise</mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.11c">-\nabla\mathcal{L}(\bm{\theta})_{t}(j)=\left\{\begin{array}[]{ll}\gamma^{r}_{t}(j)&amp;\mbox{if}\ j\mbox{ in }\mathbf{l}^{r}_{[j_{k}:j_{k+1}]},\\
\gamma^{ref}(j)-\gamma_{t}(j)&amp;\text{ if}\ j\mbox{ is }\emptyset,\\
-\ \gamma_{t}(j)&amp;\text{if}\ j\mbox{ in }\mathbf{l}^{e}_{j_{k}:j_{k+1}},\\
0&amp;\text{otherwise}.\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">The segment-level loss selectively updates certain nodes in the network at each time step: tokens aligned with the reference label sequence receive positive updates, boosting their probabilities, while tokens linked to insertion or substitution errors undergo negative updates to decrease their probabilities.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments </h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">The algorithm’s efficacy was assessed in improving streaming word-piece models trained with CTC for a fixed number of epochs on the 960-hour LibriSpeech dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, using the standard LibriSpeech test sets (’test-clean’ and ’test-other’). Additionally, this work also evaluated the efficacy of the approach in further fine-tuning a converged CTC+AED trained E2E model that had been first pre-trained on 600k hours of semi-supervised anonymised English dictation and assistant query data and then later fine-tuned on 52K hours of supervised data from the same tasks.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">To efficiently train the model within a fixed computational budget on both the LibriSpeech dataset and 600k hours dataset, this study focused on experimenting with a conformer encoder paired with a bidirectional attention decoder consisting of 104 million parameters. The conformer encoder comprised of 12 blocks, each equipped with 8 attention heads. To optimise efficiency, the kernel size of the convolutional layers in the conformer was reduced to 8, and the acoustic feature sequence was sub-sampled by a factor of 6. The encoder was configured to utilise only the left context, enabling it to operate in a streaming fashion. The bidirectional transformer decoder consisted of 3 blocks, with each block featuring 8 attention heads in both the left and right decoders. The input features consisted of 80-channel Fbank features extracted from 25 ms windows shifted by 10 ms, with dither set to 0.1. Additionally, SpecAugment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> was employed to augment the training data for models trained on anonymised dictation and assistant tasks. The overall model configuration is comparable to the streaming model described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">On the LibriSpeech dataset, the impact of the segmentation strategy (Sec. <a href="#S4.SS1" title="4.1 Error region detection ‣ 4 FDT algorithm ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) on the gains achieved through FDT was assessed. Two baseline models were trained using CTC+AED loss; one using a streaming encoder and the other employing a non-streaming one. Both baseline models were trained using a fixed computational budget: for 80 epochs using the Adam optimiser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> on a single V100 GPU. Discriminative training was performed for 1 epoch. The effectiveness of FDT was compared with MMI and MWER loss applied on top of the encoder, using N-best lists. Additionally, comparisons were made between the discriminative training approaches on further fine-tuning a streaming encoder that had been trained with CTC alone (with the decoder omitted), using the same training setup as the baseline.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">A second experiment was conducted to explore the advantages of additional fine-tuning with FDT on a streaming acoustic model trained using CTC+AED loss on a large-scale dataset from a different domain. The seed model was trained on a dataset comprised of dictation and assistant English requests in two stages. In the first stage, the model underwent pre-training with 600k hrs of semi-supervised data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. This pre-trained model was then fine-tuned in the second stage using 52k hours of supervised data. The fine-tuning was guided by the WER on the held out validation set. Training was found to converge after 9 epochs. As a refined step, the chosen model then underwent additional fine-tuning on 2.5k hrs of randomly sampled data from the supervised set for 1 epoch. To make fair comparison, FDT was compared with MWER loss applied on top of the encoder during this additional fine-tuning phase. The resultant models underwent evaluation on carefully curated dictation and assistant test sets, comprising 27 hours and 43 hours, respectively, with no overlap in speakers.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">It should be mentioned that for all seed models whose training incorporated the AED loss, CTC+AED loss smoothing was applied during MWER and MMI training, whereas AED loss smoothing was used for FDT.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental Results </h3>

<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.2.1.1" class="ltx_tr">
<th id="S5.T1.2.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S5.T1.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T1.2.1.1.2.1" class="ltx_text ltx_font_bold">ls test clean</span></th>
<th id="S5.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T1.2.1.1.3.1" class="ltx_text ltx_font_bold">ls test other</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.2.2.1" class="ltx_tr">
<td id="S5.T1.2.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Loss</td>
<td id="S5.T1.2.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T1.2.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">joint decode</td>
<td id="S5.T1.2.2.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T1.2.2.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">joint decode</td>
</tr>
<tr id="S5.T1.2.3.2" class="ltx_tr">
<td id="S5.T1.2.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CTC+AED</td>
<td id="S5.T1.2.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.1</td>
<td id="S5.T1.2.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.2</td>
<td id="S5.T1.2.3.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">10.22</td>
<td id="S5.T1.2.3.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">8.52</td>
</tr>
<tr id="S5.T1.2.4.3" class="ltx_tr">
<td id="S5.T1.2.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+MMI</td>
<td id="S5.T1.2.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.03</td>
<td id="S5.T1.2.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.17</td>
<td id="S5.T1.2.4.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">10.12</td>
<td id="S5.T1.2.4.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">8.37</td>
</tr>
<tr id="S5.T1.2.5.4" class="ltx_tr">
<td id="S5.T1.2.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+MWER</td>
<td id="S5.T1.2.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.04</td>
<td id="S5.T1.2.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.18</td>
<td id="S5.T1.2.5.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">10.22</td>
<td id="S5.T1.2.5.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">8.44</td>
</tr>
<tr id="S5.T1.2.6.5" class="ltx_tr">
<td id="S5.T1.2.6.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">+FDT</td>
<td id="S5.T1.2.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.2.6.5.2.1" class="ltx_text ltx_font_bold">3.91</span></td>
<td id="S5.T1.2.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.2.6.5.3.1" class="ltx_text ltx_font_bold">3.12</span></td>
<td id="S5.T1.2.6.5.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.2.6.5.4.1" class="ltx_text ltx_font_bold">10.04</span></td>
<td id="S5.T1.2.6.5.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.2.6.5.5.1" class="ltx_text ltx_font_bold">8.34</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.4.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>WER results with different discriminative approaches on fine-tuning a <span id="S5.T1.5.2" class="ltx_text ltx_font_bold">streaming</span> CTC+AED trained model. </figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.2.1.1" class="ltx_tr">
<th id="S5.T2.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Loss</th>
<th id="S5.T2.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">ls test clean</th>
<th id="S5.T2.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">ls test other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.2.2.1" class="ltx_tr">
<td id="S5.T2.2.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CTC</td>
<td id="S5.T2.2.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.83</td>
<td id="S5.T2.2.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.84</td>
</tr>
<tr id="S5.T2.2.3.2" class="ltx_tr">
<td id="S5.T2.2.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+ MMI</td>
<td id="S5.T2.2.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.83</td>
<td id="S5.T2.2.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.84</td>
</tr>
<tr id="S5.T2.2.4.3" class="ltx_tr">
<td id="S5.T2.2.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+MWER</td>
<td id="S5.T2.2.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.83</td>
<td id="S5.T2.2.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.84</td>
</tr>
<tr id="S5.T2.2.5.4" class="ltx_tr">
<td id="S5.T2.2.5.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">+FDT</td>
<td id="S5.T2.2.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.2.5.4.2.1" class="ltx_text ltx_font_bold">4.7</span></td>
<td id="S5.T2.2.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T2.2.5.4.3.1" class="ltx_text ltx_font_bold">11.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.4.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span> WER results with different discriminative approaches on fine-tuning a CTC trained <span id="S5.T2.5.2" class="ltx_text ltx_font_bold">streaming</span> encoder. </figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.2.1.1" class="ltx_tr">
<th id="S5.T3.2.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S5.T3.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T3.2.1.1.2.1" class="ltx_text ltx_font_bold">ls test clean</span></th>
<th id="S5.T3.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S5.T3.2.1.1.3.1" class="ltx_text ltx_font_bold">ls test other</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.2.2.1" class="ltx_tr">
<td id="S5.T3.2.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Loss</td>
<td id="S5.T3.2.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T3.2.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">j-decode</td>
<td id="S5.T3.2.2.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T3.2.2.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">j-decode</td>
</tr>
<tr id="S5.T3.2.3.2" class="ltx_tr">
<td id="S5.T3.2.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CTC+AED</td>
<td id="S5.T3.2.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.16</td>
<td id="S5.T3.2.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.75</td>
<td id="S5.T3.2.3.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">7.81</td>
<td id="S5.T3.2.3.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">6.66</td>
</tr>
<tr id="S5.T3.2.4.3" class="ltx_tr">
<td id="S5.T3.2.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+MMI</td>
<td id="S5.T3.2.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.16</td>
<td id="S5.T3.2.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.73</td>
<td id="S5.T3.2.4.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">7.8</td>
<td id="S5.T3.2.4.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">6.66</td>
</tr>
<tr id="S5.T3.2.5.4" class="ltx_tr">
<td id="S5.T3.2.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">+MWER</td>
<td id="S5.T3.2.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.2.5.4.2.1" class="ltx_text ltx_font_bold">3.12</span></td>
<td id="S5.T3.2.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.2.5.4.3.1" class="ltx_text ltx_font_bold">2.7</span></td>
<td id="S5.T3.2.5.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T3.2.5.4.4.1" class="ltx_text ltx_font_bold">7.7</span></td>
<td id="S5.T3.2.5.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T3.2.5.4.5.1" class="ltx_text ltx_font_bold">6.56</span></td>
</tr>
<tr id="S5.T3.2.6.5" class="ltx_tr">
<td id="S5.T3.2.6.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">+FDT</td>
<td id="S5.T3.2.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">3.16</td>
<td id="S5.T3.2.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2.75</td>
<td id="S5.T3.2.6.5.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">7.75</td>
<td id="S5.T3.2.6.5.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">6.65</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.3.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>WER results with different discriminative approaches on fine-tuning a non-streaming CTC+AED trained model.</figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Tables <a href="#S5.T1" title="Table 1 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S5.T3" title="Table 3 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> compare the efficacy of FDT against MMI and MWER in further improving both streaming and non-streaming models trained with CTC+AED loss. These tables present WER comparisons with respect to CTC prefix beam search and the joint CTC-AED decoding framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, where CTC and AED scores are employed in the first pass. Table <a href="#S5.T2" title="Table 2 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares the discriminative training approaches in further improving a streaming CTC-trained encoder with respect to CTC prefix beam search. The model here in constrast to Table <a href="#S5.T1" title="Table 1 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> was trained solely with CTC and no form CTC+AED loss smoothing was employed during discriminative training.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">From Tables <a href="#S5.T1" title="Table 1 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S5.T2" title="Table 2 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, FDT can be seen to the most effective in achieving the greatest WER reductions (WERR) from the streaming models. Comparison of WERs between the baseline models of Tables <a href="#S5.T1" title="Table 1 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S5.T2" title="Table 2 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> revealed that model trained solely with CTC exhibited higher deletion errors on the test sets. Further analysis uncovered a correlation between the prevalence of higher deletions and the average entropy of the CTC softmax layer. Frame posteriors of CTC-only trained models exhibited lower average entropy compared to their CTC+AED counterparts, indicating greater ‘peaky behaviour’ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, i.e. a greater preference towards the dominant alignment. This indicates that the AED loss plays a crucial role in reducing the ‘peaky behaviour’ associated with CTC models. By imposing constraints (see Eqn (<a href="#S4.E6" title="In 4.2 Constrained CTC Graph ‣ 4 FDT algorithm ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)) on the blank transitions in the CTC search graph, FDT was observed to regulate the entropy of the trained models as shown in Figure <a href="#S5.F1" title="Figure 1 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The figure shows how aside from the AED loss, the FDT framework can also regulate the ‘peaky behaviour’ associated with CTC models. In addition, the investigation on the CTC-trained model revealed that CTC+AED loss smoothing was essential for achieving gains from MWER and MMI.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows how the strong assumptions made in segmentation strategy (Sec.<a href="#S4.SS1" title="4.1 Error region detection ‣ 4 FDT algorithm ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) limits FDT’s efficacy to only streaming models. On the non-streaming LibriSpeech model, MWER was found to yield the greatest WERR.</p>
</div>
<figure id="S5.F1" class="ltx_figure">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>  </figcaption><img src="/html/2408.13008/assets/Entropy.png" id="S5.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="291" height="327" alt="Refer to caption">
</figure>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.2.1.1" class="ltx_tr">
<th id="S5.T4.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Test set</th>
<th id="S5.T4.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Decoding</th>
<th id="S5.T4.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CTC</th>
<th id="S5.T4.2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">+ FDT</th>
<th id="S5.T4.2.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">+ MWER</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.2.2.1" class="ltx_tr">
<td id="S5.T4.2.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T4.2.2.1.1.1" class="ltx_text">Dictation</span></td>
<td id="S5.T4.2.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T4.2.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.89</td>
<td id="S5.T4.2.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.2.2.1.4.1" class="ltx_text ltx_font_bold">8.68</span></td>
<td id="S5.T4.2.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.56</td>
</tr>
<tr id="S5.T4.2.3.2" class="ltx_tr">
<td id="S5.T4.2.3.2.1" class="ltx_td ltx_align_center ltx_border_r">att. re-scoring</td>
<td id="S5.T4.2.3.2.2" class="ltx_td ltx_align_center ltx_border_r">7.84</td>
<td id="S5.T4.2.3.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T4.2.3.2.3.1" class="ltx_text ltx_font_bold">7.70</span></td>
<td id="S5.T4.2.3.2.4" class="ltx_td ltx_align_center ltx_border_r">8.35</td>
</tr>
<tr id="S5.T4.2.4.3" class="ltx_tr">
<td id="S5.T4.2.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T4.2.4.3.1.1" class="ltx_text">Assistant</span></td>
<td id="S5.T4.2.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ctc-prefix</td>
<td id="S5.T4.2.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.9</td>
<td id="S5.T4.2.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.2.4.3.4.1" class="ltx_text ltx_font_bold">8.11</span></td>
<td id="S5.T4.2.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.29</td>
</tr>
<tr id="S5.T4.2.5.4" class="ltx_tr">
<td id="S5.T4.2.5.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">att. re-scoring</td>
<td id="S5.T4.2.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">6.91</td>
<td id="S5.T4.2.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T4.2.5.4.3.1" class="ltx_text ltx_font_bold">6.62</span></td>
<td id="S5.T4.2.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">6.88</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T4.4.1.1" class="ltx_text ltx_font_bold">Table 4</span>: </span>FDT vs MWER: Fine-tuning a <span id="S5.T4.5.2" class="ltx_text ltx_font_bold">streaming</span> encoder trained on 600K hrs semi-supervised data, followed by 52K hrs of supervised data, using 2.5K hrs for fine-tuning.</figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">When scaled to large-scale training with a different data distribution, the effectiveness of FDT in further improving the model is evident in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Focused Discriminative Training For Streaming CTC-Trained Automatic Speech Recognition Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. This table presents comparisons between FDT and MWER with respect to CTC prefix decoding and attention re-scoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> after additional fine-tuning using 2.5K hours of data for 1 epoch. FDT yields a relative 2% improvement over the baseline model on the Dictation Task. On the Assistant Task, FDT achieves a 9% relative improvement in WER with respect to CTC prefix decoding (4% with respect to attention re-scoring) over the baseline model, and a 2% relative improvement over additional WER fine-tuning.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion </h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In summary, this work introduces a novel framework for fine-tuning streaming models trained with either CTC or CTC+AED loss. The proposed method is HMM-independent and lattice-free, with lower implementation overhead compared to current discriminative training approaches. This paper also presents an application of MWER on top of encoders.
In contrast to additional fine-tuning with MMI and MWER in an N-best list setting, FDT
is shown to be comparatively more effective in achieving WERR when fine-tuning is constrained to a fixed number of training steps or applied to a subset of the training data. This makes the method quite attractive in a setting where computation budget is fixed. This study also highlights the current limitations of the algorithm, particularly in scenarios where encoders use the entire acoustic context at each time step. Future work will focus on extending the efficacy of FDT to both streaming and non-streaming models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"> A. Graves, S. Fernandez, F.Gomez and H. Schmidhuber “Connectionist temporal classification: labelling unsegmented sequence data with re- current neural networks” in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proc. ICML</span>, 2006, pp. 369–376.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"> H. Luo, S. Zhang, M. Lei, and L. Xie. “ Simplified self-attention for transformer-based end-to-end speech recognition” in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proc. SLT Workshop</span>, 2021, pp 75–81.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"> H. Miao, G. Cheng, C. Gao, P. Zhang and Y.Yan “Transformer based online ctc/attention end-to-end speech recognition architecture” in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2020, pp 6084–6088.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"> S. Karita NEY Soplin, S Watanabe, M Delcroix, A Ogawa and T Nakatani, “Improving transformer-based end-to-end speech recognition with connectionist temporal classification and language model integration” in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>, 2019, pp. 1408–1412.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"> Baum, L.E. and Eagon, J.A., “An Inequality with applications to statistical Estimation for probabilistic functions of Markov processes and to a model for ecology,” <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Bulletin of the American Mathematical Society</span>, vol. 73, no. 3, pp. 360–363, Jan. 1967.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"> J Tian, J Yu, C Weng, Y Zou and D Yu “Integrating lattice-free MMI into end-to-end speech recognition,” <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">IEEE/ACM Transactions on Audio, Speech, and Language Processing.</span>, vol. 31, no. 2, pp. 25–38, Aug. 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"> P.C. Woodland and D. Povey, “Large scale discriminative training of hidden Markov models for speech recognition,” <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Computer Speech and Language</span>, vol. 16, no. 1, pp. 25–47, 2002.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"> S. Watanabe, T. Hori, S. Kim, J. R. Hershey, and T. Hayashi, “Hybrid CTC/attention architecture for end-to-end speech recognition.” <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE Journal of Selected Topics in Signal Processing</span> , vol 11, no. 8, pp 1240-1253, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"> T. Hori, S. Watanabe, and J. Hershey, “Joint CTC/attention decoding for end-to-end speech recognition,” in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proc. 55th
Annual Meeting of the Association for Computational Linguistics</span>, vol. 1, 2017, pp. 518–529.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"> R. Kindermann and J.L Snell, “Markov random fields and their applications” <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">American Mathematical Society</span>, vol. 1, 1980.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"> X. Cui, W. Zhang, A. Kayi, M. Liu, U. Finkler and B. Kingsburgy , “Asynchronous decentralized distributed training of acoustic models,” <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">IEEE/ACM Transactions on Audio, Speech, and Language Processing</span>, vol. 29, pp. 3565–3576, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"> D. Povey, V.Peddinti, D. Galvez, P. Ghahremani, V.Manohar, X. Na , Y.Wang and S. Khudanpur, “Purely sequence-trained neural networks for ASR based on lattice-free MMI,” in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"> D.S.Park, W.Chan, Y.Zhang, C. Chiu, B. Zoph et al., “Specaugment: A simple data augmentation method for automatic speech recognition,” in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"> J. Tian, B. Yan, J. Yu, C. Weng, D. Yu, S. Watanabe, “Bayes risk CTC: controllable CTC alignment in sequence-to-sequence tasks,” in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proc. ICLR</span>, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"> A. Zeyer, R. Schluter, and H Ney. “Why does ctc result in peaky behavior?” in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2105.14849</span>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"> M. Shannon, “Optimizing expected word error rate via sampling for speech recognition,” in  <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Proc, Interpseech</span>, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"> D. Povey and P.C. Woodland, “Minimum phone error and i-smoothing for improved discriminative training,” in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2022, pp. 105–108.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"> B. Kingsbury, T. Sainath and H. Soltau, “Scalable minimum Bayes risk training of deep neural networks acoustic models using distributed Hessian-Free optimization,” in <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proc. InterSpeech</span>, 2013, pp. 10–13.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"> M. Shannon, “Optimizing expected Word Error Rate via Sampling for Speech Recognition,” in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proc. InterSpeech</span>, 2017, pp. 10–13.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"> T. Kado, “Subword regularization: improving neural network translation models with multiple subword candidates,” in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proc. ACL</span>, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"> E. McDermott, G. Heigold, P. Moreno, A. Senior and M.Bacchiani, “Asynchronous stochastic optimization for sequence training of deep neural networks: towards big data,” in <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proc. InterSpeech</span>, 2014, pp. 10–13.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"> R. Prabhavalkar, T. N. Sainath, Y. Wu, P. Nguyen, Z. Chen, C.-C. Chiu, and A. Kannan, “Minimum word error rate training for attention-based sequence-to-sequence sodels,” in <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2018, pp. 4839–4843.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"> C. Weng, C.Yu, J. Cui, C. Zhang and D. Yu, “Minimum Bayes Risk Training of RNN-Transducer for End-to-End Speech Recognition”, in <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Proc. InterSpeech</span>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"> W. Michel, R. Schluter and H. Ney, “Early Stage LM Integration Using Local and Global Log-Linear Combination”,in <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Proc InterSpeech</span>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"> Z. Yang, W. Zhou, R. Schlüter and H. Ney, “On the Relation Between Internal Language Model and Sequence Discriminative Training for Neural Transducers”, in <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2024.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"> W. Michel and R. Schlüter and H. Ney, “Comparison of lattice-free and lattice-based sequence discriminative training criteria for LVCSR” in <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Proc. InterSpeech</span>, 2019, pp. 1601-1605.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"> V. Panayotov, G. Chen, D. Povey and S. Khudanpur, “LibriSpeech: an ASR corpus based on public domain audio books” in <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"> D. S. Park, Y. Zhang, Y. Jia, W. Han, C.-C. Chiu, B. Li, Y. Wu, and Q. V. Le, “Improved noisy student training for automatic speech recognition” in <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>, 2020, pp. 2817–-2821.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"> L. Bahl, P. Brown P.V Souza and R. Mercer, “Maximum mutual information estimation of hidden Markov model parameters for Speech Recognition“ in <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 1986, pp. 231–-234.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"> M. Gibson and T. Hains, “Hypothesis spaces for Minimum bayes risk training in Large Vocabulary Speech Recognition“ in <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>, 2006.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"> S.S. Azam, T. Likhomanenko, M. Pelikan and H. Silovsky “Importance of Smoothness Induced by Optimizers in FL4ASR: towards understanding federated learning for end-to-end ASR“ in <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Proc. ASRU workshop</span>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"> D. Povey and B. Kingsbury, “Evaluation of proposed modifications to MPE for large scale discriminative training” in <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2007, pp. 321–324.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"> Z. Yao, D. Wu, X. Wang, B. Zhang, F. Yu, C. Yang, Z. Peng, X. Chen, L. Xie, and X. Lei. “Wenet: Production oriented streaming and non-streaming end-to-end speech recognition toolkit ” in <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>. 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"> B. Zhang, D.Wu, Z. Peng, X. Song, Z. Yao, H. Lv, X. Lei, C. Yang, F. Pan and J. Niu, “WeNet 2.0: more productive end-to-end speech recognition toolkit ” in <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech</span>. 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"> P. D. Kingma and J.L Ba , “Adam: a method for stochastic optimization” in <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proc. ICLP</span>, 2015, pp. 1–13.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"> D. Povey, M. Hannemann, G. Boulianne, L. Burget, A. Ghosal, M. Janda, M. Karafiät, S. Kombrink, P. Motlic̈ek, Y.Qian, K. Riedhammer, K. Vesely and T. N. Vu, “Generating exact lattices in the WFST framework” in <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Proc. ICASSP</span>, 2012, pp 4123–4216.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"> D. Povey, “Discriminative training for large vocabulary speech recognition,” Ph.D. dissertation, University of Cambridge, 2005.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"> C. M. Bishop, “Pattern Recognition and Machine Learning” in <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Springer</span>, 2006, pp. 439–447, pp.383-392.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"> S. Axler, “ Measure, Integration &amp; Real Analysis” in <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Springer</span>, 2020, pp. 31.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.13007" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.13008" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.13008">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.13008" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.13009" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 14:28:48 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
