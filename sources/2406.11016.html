<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.11016] Optimized Speculative Sampling for GPU Hardware Accelerators</title><meta property="og:description" content="In this work, we optimize speculative sampling for parallel hardware accelerators to improve sampling speed.
We notice that substantial portions of the intermediate matrices necessary for speculative sampling can be co…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Optimized Speculative Sampling for GPU Hardware Accelerators">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Optimized Speculative Sampling for GPU Hardware Accelerators">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.11016">

<!--Generated on Fri Jul  5 23:41:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Optimized Speculative Sampling for GPU Hardware Accelerators</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id2.2.id1" class="ltx_text ltx_font_bold">Dominik Wagner<sup id="id2.2.id1.1" class="ltx_sup">1</sup></span>,
<span id="id3.3.id2" class="ltx_text ltx_font_bold">Seanie Lee<sup id="id3.3.id2.1" class="ltx_sup">2</sup></span>,
<span id="id4.4.id3" class="ltx_text ltx_font_bold">Ilja Baumann<sup id="id4.4.id3.1" class="ltx_sup">1</sup></span>,
<span id="id5.5.id4" class="ltx_text ltx_font_bold">Philipp Seeberger<sup id="id5.5.id4.1" class="ltx_sup">1</sup></span>,

<br class="ltx_break"><span id="id6.6.id5" class="ltx_text ltx_font_bold">Korbinian Riedhammer<sup id="id6.6.id5.1" class="ltx_sup">1</sup></span>,
<span id="id7.7.id6" class="ltx_text ltx_font_bold">Tobias Bocklet<sup id="id7.7.id6.1" class="ltx_sup">1,3</sup></span>

<br class="ltx_break"><sup id="id8.8.id7" class="ltx_sup">1</sup>Technische Hochschule Nürnberg Georg Simon Ohm,
<sup id="id9.9.id8" class="ltx_sup">2</sup>KAIST,
<sup id="id10.10.id9" class="ltx_sup">3</sup>Intel Labs

<br class="ltx_break"><span id="id11.11.id10" class="ltx_text ltx_font_typewriter">dominik.wagner@th-nuernberg.de</span> 
<br class="ltx_break"><span id="id1.1.1" class="ltx_text ltx_font_typewriter">lsnfamily02@kaist.ac.kr
<br class="ltx_break"><span id="id1.1.1.1" class="ltx_text ltx_markedasmath">{ilja.baumann, philipp.seeberger, korbinian.riedhammer, tobias.bocklet}@th-nuernberg.de</span></span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">In this work, we optimize speculative sampling for parallel hardware accelerators to improve sampling speed.
We notice that substantial portions of the intermediate matrices necessary for speculative sampling can be computed concurrently.
This allows us to distribute the workload across multiple GPU threads, enabling simultaneous operations on matrix segments within thread blocks.
Additionally, we use fast on-chip memory to store intermediate results, thereby minimizing the frequency of slow read and write operations across different types of memory.
This results in <em id="id12.id1.1" class="ltx_emph ltx_font_italic">profiling time improvements</em> ranging from 6% to 13% relative to the baseline implementation, <em id="id12.id1.2" class="ltx_emph ltx_font_italic">without compromising accuracy</em>.
To further accelerate speculative sampling, probability distributions parameterized by softmax are approximated by sigmoid.
This approximation approach results in significantly greater relative improvements in profiling time, ranging from 37% to 94%, with a slight decline in accuracy.
We conduct extensive experiments on both automatic speech recognition and summarization tasks to validate the effectiveness of our optimization methods.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.1" class="ltx_block ltx_align_bottom">
<p id="p1.1.2" class="ltx_p"><span id="p1.1.2.1" class="ltx_text ltx_font_bold">Optimized Speculative Sampling for GPU Hardware Accelerators</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.1.1" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.1.1.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.1.1.1" class="ltx_tabular ltx_align_top">
<span id="p1.1.1.1.1.2" class="ltx_tr">
<span id="p1.1.1.1.1.2.1" class="ltx_td ltx_align_center"><span id="p1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">
Dominik Wagner<sup id="p1.1.1.1.1.2.1.1.1" class="ltx_sup">1</sup>,
Seanie Lee<sup id="p1.1.1.1.1.2.1.1.2" class="ltx_sup">2</sup>,
Ilja Baumann<sup id="p1.1.1.1.1.2.1.1.3" class="ltx_sup">1</sup>,
Philipp Seeberger<sup id="p1.1.1.1.1.2.1.1.4" class="ltx_sup">1</sup>,</span></span></span>
<span id="p1.1.1.1.1.3" class="ltx_tr">
<span id="p1.1.1.1.1.3.1" class="ltx_td ltx_align_center"><span id="p1.1.1.1.1.3.1.1" class="ltx_text ltx_font_bold">Korbinian Riedhammer<sup id="p1.1.1.1.1.3.1.1.1" class="ltx_sup">1</sup></span>,
<span id="p1.1.1.1.1.3.1.2" class="ltx_text ltx_font_bold">Tobias Bocklet<sup id="p1.1.1.1.1.3.1.2.1" class="ltx_sup">1,3</sup></span></span></span>
<span id="p1.1.1.1.1.4" class="ltx_tr">
<span id="p1.1.1.1.1.4.1" class="ltx_td ltx_align_center"><sup id="p1.1.1.1.1.4.1.1" class="ltx_sup">1</sup>Technische Hochschule Nürnberg Georg Simon Ohm,
<sup id="p1.1.1.1.1.4.1.2" class="ltx_sup">2</sup>KAIST,
<sup id="p1.1.1.1.1.4.1.3" class="ltx_sup">3</sup>Intel Labs</span></span>
<span id="p1.1.1.1.1.5" class="ltx_tr">
<span id="p1.1.1.1.1.5.1" class="ltx_td ltx_align_center"><span id="p1.1.1.1.1.5.1.1" class="ltx_text ltx_font_typewriter">dominik.wagner@th-nuernberg.de</span></span></span>
<span id="p1.1.1.1.1.6" class="ltx_tr">
<span id="p1.1.1.1.1.6.1" class="ltx_td ltx_align_center"><span id="p1.1.1.1.1.6.1.1" class="ltx_text ltx_font_typewriter">lsnfamily02@kaist.ac.kr</span></span></span>
<span id="p1.1.1.1.1.1" class="ltx_tr">
<span id="p1.1.1.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.1.1.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">{ilja.baumann, philipp.seeberger, korbinian.riedhammer, tobias.bocklet}@th-nuernberg.de</span></span></span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Large foundational speech and language models based on autoregressive Transformer <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a href="#bib.bib63" title="" class="ltx_ref">2017</a>)</cite> models have demonstrated remarkable proficiency across a variety of downstream tasks <cite class="ltx_cite ltx_citemacro_cite">Hsu et al. (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>); Radford et al. (<a href="#bib.bib48" title="" class="ltx_ref">2022</a>); Touvron et al. (<a href="#bib.bib62" title="" class="ltx_ref">2023b</a>); Achiam et al. (<a href="#bib.bib1" title="" class="ltx_ref">2024</a>)</cite>.
These models frequently increase in size, consequently requiring more memory and computational resources.
However, downstream applications, such as dialogue systems, have strict wall-clock constraints and are often required to generate long sequences <cite class="ltx_cite ltx_citemacro_cite">Pope et al. (<a href="#bib.bib46" title="" class="ltx_ref">2023</a>); Chi et al. (<a href="#bib.bib12" title="" class="ltx_ref">2023</a>); Fischer et al. (<a href="#bib.bib17" title="" class="ltx_ref">2024</a>)</cite>.
Due to the sequential token generation in autoregressive decoding, latency increases with both the length of the sequence and the size of the model, resulting in a significant barrier to widespread deployment.
On many general-purpose GPU hardware accelerator architectures, the increasing size of models leads to more read and write operations between high-bandwidth memory (HBM) and on-chip shared memory (SRAM) at each decoding step, necessitating more memory bandwidth to meet latency constraints <cite class="ltx_cite ltx_citemacro_cite">Pope et al. (<a href="#bib.bib46" title="" class="ltx_ref">2023</a>); Dao et al. (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>); Dao (<a href="#bib.bib13" title="" class="ltx_ref">2024</a>)</cite>.
Consequently, the speed of autoregressive decoding becomes primarily limited by the available memory bandwidth and not by the number of computations that need to be executed on the dedicated hardware <cite class="ltx_cite ltx_citemacro_cite">Shazeer (<a href="#bib.bib52" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In many cases, tokens may be accurately generated by much smaller models that require fewer resources.
Motivated by this hypothesis, speculative sampling has been developed to accelerate autoregressive sampling <cite class="ltx_cite ltx_citemacro_cite">Stern et al. (<a href="#bib.bib57" title="" class="ltx_ref">2018</a>); Xia et al. (<a href="#bib.bib67" title="" class="ltx_ref">2023</a>); Leviathan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite>.
Speculative sampling employs a small draft model to generate tokens, which are potential future outputs of a larger target model.
These drafted tokens are then verified in parallel by the target model, and only tokens that meet the validation criteria are retained as final outputs to ensure generation accuracy.
This approach has been shown to significantly reduce the frequency of time-consuming operations, thereby improving inference latency <cite class="ltx_cite ltx_citemacro_cite">Leviathan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we focus on optimizing the validation part of speculative sampling to further increase the inference speed.
Inspired by recent advances in accelerating computations in the attention mechanism <cite class="ltx_cite ltx_citemacro_cite">Dao et al. (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>); Dao (<a href="#bib.bib13" title="" class="ltx_ref">2024</a>)</cite>, we explore two faster methods for assessing drafted tokens by leveraging the parallelism capabilities of modern GPUs and reducing the number of slow read and write operations across the memory hierarchy.
We identify that a significant portion of the intermediate matrices required for the sampling process can be computed independently.
Exploiting this observation, we distribute the workload across multiple GPU threads and simultaneously compute portions of the intermediate output matrices within thread blocks.
Additionally, we store intermediate results in fast shared memory and minimize the number of slow read and write operations to and from high-bandwidth memory.
This optimization method is faster than the non-optimized baseline implementation and <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">exact</span> with regard to the decoding outputs, <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">i.e.</span>, it generates the same outputs as the non-optimized method.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To further accelerate speculative sampling, we propose using sigmoid as a pointwise approximation to softmax <cite class="ltx_cite ltx_citemacro_citep">(Bridle, <a href="#bib.bib7" title="" class="ltx_ref">1989</a>)</cite>, which is used to parameterize distributions of target and draft models.
Since sigmoid is applied to logits in element-wise fashion, it can be computed in parallel and fused with other sampling-related computations. This enables significant acceleration of the overall process, but results in a small accuracy decline due to the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">non-exact</span> nature of the method.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We evaluate our two optimized algorithms on automatic speech recognition (ASR) and summarization tasks, covering draft model sizes between 166M and 2B parameters and target model sizes between 244M and 13B parameters.
The <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">exact</span> optimization method reduces profiling time between 6% and 13% relative to the baseline implementation without compromising accuracy.
Moreover, the <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">non-exact</span> optimization method improves profiling time by 37% to 94%, albeit with a small reduction in accuracy.
We summarize our main contributions as follows:</p>
</div>
<div id="S1.p6" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Implementation of an <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">exact</span> and consistently faster variant of speculative sampling optimized for GPU hardware accelerators.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Exploration of sigmoid as a pointwise approximation to softmax in an even faster but <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">non-exact</span> variant of speculative sampling.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Comprehensive evaluation across multiple tasks, covering a wide range of draft and target model combinations.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Techniques such as quantization
 <cite class="ltx_cite ltx_citemacro_cite">Dettmers et al. (<a href="#bib.bib15" title="" class="ltx_ref">2022</a>); Bondarenko et al. (<a href="#bib.bib6" title="" class="ltx_ref">2023</a>); Stock et al. (<a href="#bib.bib58" title="" class="ltx_ref">2021</a>); Nagel et al. (<a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, pruning <cite class="ltx_cite ltx_citemacro_cite">Voita et al. (<a href="#bib.bib64" title="" class="ltx_ref">2019</a>); Lagunas et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>); Gromov et al. (<a href="#bib.bib21" title="" class="ltx_ref">2024</a>)</cite> and knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>); Sanh et al. (<a href="#bib.bib51" title="" class="ltx_ref">2019</a>); Jiao et al. (<a href="#bib.bib29" title="" class="ltx_ref">2020</a>); Hsieh et al. (<a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite> have proven effective in reducing inference latency with minimal performance impact.
However, these approaches often require architectural changes or custom training procedures.
Efforts specifically targeting the reduction of memory bandwidth bottlenecks during decoding include methods like multi-query attention, which aims to optimize memory usage per attention layer <cite class="ltx_cite ltx_citemacro_cite">Shazeer (<a href="#bib.bib52" title="" class="ltx_ref">2019</a>)</cite>, or FlashAttention <cite class="ltx_cite ltx_citemacro_citep">(Dao et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>; Dao, <a href="#bib.bib13" title="" class="ltx_ref">2024</a>)</cite>, which aims to reduce the number of read/write operations between HBM and SRAM on GPUs.
In <cite class="ltx_cite ltx_citemacro_citet">Pope et al. (<a href="#bib.bib46" title="" class="ltx_ref">2023</a>)</cite>, improvements in large-scale inference latency have been achieved by partitioning models and workload across multiple accelerators combined with various low-level optimizations to improve communication efficiency between devices.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Speculative sampling approaches can be broadly categorized by the way drafting and verification is performed <cite class="ltx_cite ltx_citemacro_cite">Xia et al. (<a href="#bib.bib68" title="" class="ltx_ref">2024a</a>)</cite>.
<span id="S2.p2.1.1" class="ltx_text ltx_font_italic">Drafting</span> refers to the efficient prediction of multiple future tokens with a draft model and <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">verification</span> refers to the methods used to verify the token sequence with the target model.
Some works use specialized draft models <cite class="ltx_cite ltx_citemacro_cite">Xia et al. (<a href="#bib.bib67" title="" class="ltx_ref">2023</a>); Zhou et al. (<a href="#bib.bib74" title="" class="ltx_ref">2024</a>)</cite>.
Others employ an existing smaller model from the same series <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023a</a>); Spector and Re (<a href="#bib.bib56" title="" class="ltx_ref">2023</a>); Leviathan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>); Yang et al. (<a href="#bib.bib70" title="" class="ltx_ref">2024</a>)</cite> or leverage the target model directly for drafting, <span id="S2.p2.1.3" class="ltx_text ltx_font_italic">e.g.</span>, by skipping intermediate layers <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a href="#bib.bib73" title="" class="ltx_ref">2023</a>)</cite>, using special look-ahead tokens <cite class="ltx_cite ltx_citemacro_cite">Monea et al. (<a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite>, or additional modeling heads <cite class="ltx_cite ltx_citemacro_cite">Stern et al. (<a href="#bib.bib57" title="" class="ltx_ref">2018</a>); Cai et al. (<a href="#bib.bib8" title="" class="ltx_ref">2024</a>); Zhang et al. (<a href="#bib.bib71" title="" class="ltx_ref">2024</a>)</cite>.
Verification approaches first supported greedy decoding <cite class="ltx_cite ltx_citemacro_cite">Stern et al. (<a href="#bib.bib57" title="" class="ltx_ref">2018</a>); Xia et al. (<a href="#bib.bib67" title="" class="ltx_ref">2023</a>); Zhang et al. (<a href="#bib.bib73" title="" class="ltx_ref">2023</a>)</cite> and were subsequently extended to support other methods such as nucleus sampling <cite class="ltx_cite ltx_citemacro_cite">Leviathan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite>.
Recently, methods to verify multiple draft sequences in parallel have also been explored <cite class="ltx_cite ltx_citemacro_cite">Miao et al. (<a href="#bib.bib37" title="" class="ltx_ref">2024</a>); Cai et al. (<a href="#bib.bib8" title="" class="ltx_ref">2024</a>); Spector and Re (<a href="#bib.bib56" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Several studies have experimented with ReLU as alternatives to softmax in the attention <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib5" title="" class="ltx_ref">2023b</a>; Shen et al., <a href="#bib.bib54" title="" class="ltx_ref">2023</a>; Hron et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Hua et al., <a href="#bib.bib27" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>; Wortsman et al., <a href="#bib.bib66" title="" class="ltx_ref">2023</a>)</cite>. They either require training new models from scratch or maintain the computational overhead of gathering information along the full sequence length.
Other softmax-related optimizations are tailored to reduce the memory requirement during training by computing only smaller fractions of the full softmax output in the backward pass <cite class="ltx_cite ltx_citemacro_cite">Lee and Lee (<a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite> or leverage word frequencies in the training data to speed up computation <cite class="ltx_cite ltx_citemacro_cite">Grave et al. (<a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citet">Shim et al. (<a href="#bib.bib55" title="" class="ltx_ref">2017</a>)</cite> approximate softmax by computing only a fraction of the full input with singular value decomposition.
Other approximation methods are specifically designed for custom hardware such as field-programmable gate arrays <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a href="#bib.bib10" title="" class="ltx_ref">2023b</a>)</cite> and application specific integrated circuits <cite class="ltx_cite ltx_citemacro_cite">Geng et al. (<a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries</h3>

<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Speculative sampling.</h5>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p1.7" class="ltx_p">Let <math id="S3.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="M_{p}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝑀</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">M_{p}</annotation></semantics></math> be an autoregressive target model, which induces a categorical distribution distribution <math id="S3.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="p(x|x_{&lt;i+1})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1"><times id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2"></times><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑝</ci><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3"><lt id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3"><plus id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">p(x|x_{&lt;i+1})</annotation></semantics></math> over a vocabulary <math id="S3.SS1.SSS0.Px1.p1.3.m3.2" class="ltx_Math" alttext="\mathcal{V}=\{x\in\mathbb{N}:1\leq x\leq\texttt{vocab\_size}\}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.2a"><mrow id="S3.SS1.SSS0.Px1.p1.3.m3.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.4" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.4.cmml">𝒱</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml">∈</mo><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml">ℕ</mi></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.1.cmml">:</mo><mrow id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.cmml"><mn id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.cmml">1</mn><mo id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.4.cmml">x</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.5" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.5.cmml">≤</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6a.cmml">vocab_size</mtext></mrow><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.5" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.2b"><apply id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2"><eq id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.3"></eq><ci id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.4">𝒱</ci><apply id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1"><in id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.1"></in><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3">ℕ</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"><and id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2a.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"></and><apply id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2b.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"><leq id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3"></leq><cn type="integer" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2">1</cn><ci id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.4">𝑥</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2c.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"><leq id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.5.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.5"></leq><share href="#S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.4.cmml" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2d.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"></share><ci id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6a.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.6">vocab_size</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.2c">\mathcal{V}=\{x\in\mathbb{N}:1\leq x\leq\texttt{vocab\_size}\}</annotation></semantics></math>, given the prefix <math id="S3.SS1.SSS0.Px1.p1.4.m4.3" class="ltx_Math" alttext="x_{&lt;i+1}=(x_{1},\ldots,x_{i})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.3a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.3.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.2.cmml"></mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.1.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.5" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.2.cmml">x</mi><mi id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.6" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.3b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3"><eq id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.3"></eq><apply id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3"><lt id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.1"></lt><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.2">absent</csymbol><apply id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3"><plus id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.2">𝑖</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.4.3.3.3">1</cn></apply></apply></apply><vector id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.2">𝑥</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.3.3.2.2.2.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.3c">x_{&lt;i+1}=(x_{1},\ldots,x_{i})</annotation></semantics></math>.
Our goal is to use speculative sampling to accelerate the sampling process of discrete tokens <math id="S3.SS1.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="x\in\mathcal{V}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1"><in id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2">𝑥</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.1c">x\in\mathcal{V}</annotation></semantics></math>.
This is achieved by approximating the target model with a draft model <math id="S3.SS1.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="M_{q}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml">M</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2">𝑀</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.6.m6.1c">M_{q}</annotation></semantics></math>, resulting in another categorical distribution <math id="S3.SS1.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="q(x|x_{&lt;i+1})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.7.m7.1a"><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1"><times id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2"></times><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑞</ci><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3"><lt id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3"><plus id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.7.m7.1c">q(x|x_{&lt;i+1})</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p2.11" class="ltx_p">First, given the prefix <math id="S3.SS1.SSS0.Px1.p2.1.m1.3" class="ltx_Math" alttext="(x_{1},\ldots,x_{i+c-1})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.1.m1.3a"><mrow id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.4" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.5" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.cmml"><mrow id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.1" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.3.cmml">c</mi></mrow><mo id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.1" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.6" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.1.m1.3b"><vector id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2"><apply id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1">…</ci><apply id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3"><minus id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.1"></minus><apply id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2"><plus id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.3.3.2.2.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.1.m1.3c">(x_{1},\ldots,x_{i+c-1})</annotation></semantics></math>, <math id="S3.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\gamma\in\mathbb{N}_{+}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml">γ</mi><mo id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><msub id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">ℕ</mi><mo id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.cmml">+</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1"></in><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2">𝛾</ci><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2">ℕ</ci><plus id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.2.m2.1c">\gamma\in\mathbb{N}_{+}</annotation></semantics></math> draft tokens are sequentially sampled with <math id="S3.SS1.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="M_{q}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.3.m3.1a"><msub id="S3.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml">M</mi><mi id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.2">𝑀</ci><ci id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.3.m3.1c">M_{q}</annotation></semantics></math>: <math id="S3.SS1.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="x_{i+c}\sim q(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.4.m4.1a"><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.3.cmml">c</mi></mrow></msub><mo id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml">∼</mo><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2">similar-to</csymbol><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3"><plus id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1"><times id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.2"></times><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.3">𝑞</ci><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3"><lt id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3"><plus id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.4.m4.1c">x_{i+c}\sim q(x|x_{&lt;i+c})</annotation></semantics></math> for <math id="S3.SS1.SSS0.Px1.p2.5.m5.3" class="ltx_Math" alttext="c=1,\ldots,\gamma" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.5.m5.3a"><mrow id="S3.SS1.SSS0.Px1.p2.5.m5.3.4" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.cmml"><mi id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.2.cmml">c</mi><mo id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.1.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.1.cmml"><mn id="S3.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml">1</mn><mo id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.2.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS0.Px1.p2.5.m5.2.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.2.2.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.2.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p2.5.m5.3.3" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.3.cmml">γ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.5.m5.3b"><apply id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4"><eq id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.1"></eq><ci id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.2.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.2">𝑐</ci><list id="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.4.3.2"><cn type="integer" id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1">1</cn><ci id="S3.SS1.SSS0.Px1.p2.5.m5.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.2.2">…</ci><ci id="S3.SS1.SSS0.Px1.p2.5.m5.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.3.3">𝛾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.5.m5.3c">c=1,\ldots,\gamma</annotation></semantics></math>.
The draft tokens are then evaluated using the target model <math id="S3.SS1.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="M_{p}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.6.m6.1a"><msub id="S3.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml">M</mi><mi id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.2">𝑀</ci><ci id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.6.m6.1c">M_{p}</annotation></semantics></math>, a process that can be performed in parallel.
Each draft token <math id="S3.SS1.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="x_{i+c}\in\mathcal{V}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.7.m7.1a"><mrow id="S3.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.2" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.2" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.1" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.3" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.3.cmml">c</mi></mrow></msub><mo id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.1" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1"><in id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.1"></in><apply id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3"><plus id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.3">𝑐</ci></apply></apply><ci id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.7.m7.1c">x_{i+c}\in\mathcal{V}</annotation></semantics></math> is accepted if <math id="S3.SS1.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="r_{c}\leq\tau_{c}(x_{i+c})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.8.m8.1a"><mrow id="S3.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.cmml">c</mi></msub><mo id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml">≤</mo><mrow id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.2.cmml">τ</mi><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.8.m8.1b"><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1"><leq id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2"></leq><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.2">𝑟</ci><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.3">𝑐</ci></apply><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1"><times id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.2">𝜏</ci><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.3.3">𝑐</ci></apply><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3"><plus id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.8.m8.1c">r_{c}\leq\tau_{c}(x_{i+c})</annotation></semantics></math> for <math id="S3.SS1.SSS0.Px1.p2.9.m9.3" class="ltx_Math" alttext="c=1,\ldots,\gamma" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.9.m9.3a"><mrow id="S3.SS1.SSS0.Px1.p2.9.m9.3.4" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.cmml"><mi id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.2" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.2.cmml">c</mi><mo id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.1" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.1.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.2" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.1.cmml"><mn id="S3.SS1.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">1</mn><mo id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.2.1" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS0.Px1.p2.9.m9.2.2" xref="S3.SS1.SSS0.Px1.p2.9.m9.2.2.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.2.2" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p2.9.m9.3.3" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.3.cmml">γ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.9.m9.3b"><apply id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4"><eq id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.1.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.1"></eq><ci id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.2.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.2">𝑐</ci><list id="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.4.3.2"><cn type="integer" id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1">1</cn><ci id="S3.SS1.SSS0.Px1.p2.9.m9.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.2.2">…</ci><ci id="S3.SS1.SSS0.Px1.p2.9.m9.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.3.3">𝛾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.9.m9.3c">c=1,\ldots,\gamma</annotation></semantics></math>.
The terms <math id="S3.SS1.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="r_{c}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.10.m10.1a"><msub id="S3.SS1.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.2" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.3" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.10.m10.1b"><apply id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.2">𝑟</ci><ci id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.10.m10.1c">r_{c}</annotation></semantics></math> and <math id="S3.SS1.SSS0.Px1.p2.11.m11.1" class="ltx_Math" alttext="\tau_{c}(x_{i+c})" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.11.m11.1a"><mrow id="S3.SS1.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.2.cmml">τ</mi><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.11.m11.1b"><apply id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1"><times id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.2">𝜏</ci><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.3">𝑐</ci></apply><apply id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3"><plus id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.11.m11.1c">\tau_{c}(x_{i+c})</annotation></semantics></math> are computed as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.26" class="ltx_Math" alttext="\begin{gathered}\tau_{c}(x_{i+c})=\min\left(1,\frac{p({x}_{i+c}|{x}_{&lt;i+c})}{q({x}_{i+c}|{x}_{&lt;i+c})}\right)\\
r_{c}\sim U(0,1),\end{gathered}" display="block"><semantics id="S3.E1.m1.26a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E1.m1.26.26.3"><mtr id="S3.E1.m1.26.26.3a"><mtd id="S3.E1.m1.26.26.3b"><mrow id="S3.E1.m1.25.25.2.24.14.14"><mrow id="S3.E1.m1.25.25.2.24.14.14.14"><msub id="S3.E1.m1.25.25.2.24.14.14.14.3"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">τ</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.25.25.2.24.14.14.14.2" xref="S3.E1.m1.24.24.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.25.25.2.24.14.14.14.1.1"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.24.24.1.1.1.cmml">(</mo><msub id="S3.E1.m1.25.25.2.24.14.14.14.1.1.1"><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">x</mi><mrow id="S3.E1.m1.5.5.5.5.5.5.1" xref="S3.E1.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E1.m1.5.5.5.5.5.5.1.2" xref="S3.E1.m1.5.5.5.5.5.5.1.2.cmml">i</mi><mo id="S3.E1.m1.5.5.5.5.5.5.1.1" xref="S3.E1.m1.5.5.5.5.5.5.1.1.cmml">+</mo><mi id="S3.E1.m1.5.5.5.5.5.5.1.3" xref="S3.E1.m1.5.5.5.5.5.5.1.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.7.7.7.7.7.7.cmml">=</mo><mrow id="S3.E1.m1.25.25.2.24.14.14.15"><mi id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.8.8.8.8.8.8.cmml">min</mi><mo id="S3.E1.m1.25.25.2.24.14.14.15a" xref="S3.E1.m1.24.24.1.1.1.cmml">⁡</mo><mrow id="S3.E1.m1.25.25.2.24.14.14.15.1"><mo id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.24.24.1.1.1.cmml">(</mo><mn id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.10.10.10.10.10.10.cmml">1</mn><mo id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.24.24.1.1.1.cmml">,</mo><mfrac id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.12.12.12.12.12.12.cmml"><mrow id="S3.E1.m1.12.12.12.12.12.12.1" xref="S3.E1.m1.12.12.12.12.12.12.1.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.3" xref="S3.E1.m1.12.12.12.12.12.12.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.12.12.12.12.12.12.1.2" xref="S3.E1.m1.12.12.12.12.12.12.1.2.cmml">​</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.1.1.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.cmml"><msub id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3.cmml">c</mi></mrow></msub><mo fence="false" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.3" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.12.12.12.12.12.12.2" xref="S3.E1.m1.12.12.12.12.12.12.2.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.3" xref="S3.E1.m1.12.12.12.12.12.12.2.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.12.12.12.12.12.12.2.2" xref="S3.E1.m1.12.12.12.12.12.12.2.2.cmml">​</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.2.1.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.cmml"><msub id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.2.cmml">x</mi><mrow id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1.cmml">+</mo><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3.cmml">c</mi></mrow></msub><mo fence="false" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.2.cmml">x</mi><mrow id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2.cmml"></mi><mo id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.3" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.26.26.3c"><mtd id="S3.E1.m1.26.26.3d"><mrow id="S3.E1.m1.26.26.3.25.11.11.11"><mrow id="S3.E1.m1.26.26.3.25.11.11.11.1"><msub id="S3.E1.m1.26.26.3.25.11.11.11.1.1"><mi id="S3.E1.m1.14.14.14.1.1.1" xref="S3.E1.m1.14.14.14.1.1.1.cmml">r</mi><mi id="S3.E1.m1.15.15.15.2.2.2.1" xref="S3.E1.m1.15.15.15.2.2.2.1.cmml">c</mi></msub><mo id="S3.E1.m1.16.16.16.3.3.3" xref="S3.E1.m1.16.16.16.3.3.3.cmml">∼</mo><mrow id="S3.E1.m1.26.26.3.25.11.11.11.1.2"><mi id="S3.E1.m1.17.17.17.4.4.4" xref="S3.E1.m1.17.17.17.4.4.4.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.26.26.3.25.11.11.11.1.2.1" xref="S3.E1.m1.24.24.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.26.26.3.25.11.11.11.1.2.2"><mo stretchy="false" id="S3.E1.m1.18.18.18.5.5.5" xref="S3.E1.m1.24.24.1.1.1.cmml">(</mo><mn id="S3.E1.m1.19.19.19.6.6.6" xref="S3.E1.m1.19.19.19.6.6.6.cmml">0</mn><mo id="S3.E1.m1.20.20.20.7.7.7" xref="S3.E1.m1.24.24.1.1.1.cmml">,</mo><mn id="S3.E1.m1.21.21.21.8.8.8" xref="S3.E1.m1.21.21.21.8.8.8.cmml">1</mn><mo stretchy="false" id="S3.E1.m1.22.22.22.9.9.9" xref="S3.E1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.23.23.23.10.10.10" xref="S3.E1.m1.24.24.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.26b"><apply id="S3.E1.m1.24.24.1.1.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><and id="S3.E1.m1.24.24.1.1.1a.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"></and><apply id="S3.E1.m1.24.24.1.1.1b.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><eq id="S3.E1.m1.7.7.7.7.7.7.cmml" xref="S3.E1.m1.7.7.7.7.7.7"></eq><apply id="S3.E1.m1.24.24.1.1.1.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><times id="S3.E1.m1.24.24.1.1.1.1.2.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"></times><apply id="S3.E1.m1.24.24.1.1.1.1.3.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.E1.m1.24.24.1.1.1.1.3.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝜏</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">𝑐</ci></apply><apply id="S3.E1.m1.24.24.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.E1.m1.24.24.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">𝑥</ci><apply id="S3.E1.m1.5.5.5.5.5.5.1.cmml" xref="S3.E1.m1.5.5.5.5.5.5.1"><plus id="S3.E1.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E1.m1.5.5.5.5.5.5.1.1"></plus><ci id="S3.E1.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E1.m1.5.5.5.5.5.5.1.2">𝑖</ci><ci id="S3.E1.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E1.m1.5.5.5.5.5.5.1.3">𝑐</ci></apply></apply></apply><apply id="S3.E1.m1.24.24.1.1.1.4.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><times id="S3.E1.m1.24.24.1.1.1.4.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"></times><apply id="S3.E1.m1.24.24.1.1.1.4.2.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><min id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8"></min><cn type="integer" id="S3.E1.m1.10.10.10.10.10.10.cmml" xref="S3.E1.m1.10.10.10.10.10.10">1</cn><apply id="S3.E1.m1.12.12.12.12.12.12.cmml" xref="S3.E1.m1.12.12.12.12.12.12"><divide id="S3.E1.m1.12.12.12.12.12.12.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12"></divide><apply id="S3.E1.m1.12.12.12.12.12.12.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1"><times id="S3.E1.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.2"></times><ci id="S3.E1.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.3">𝑝</ci><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.2">𝑥</ci><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3"><plus id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1"></plus><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3"><lt id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3"><plus id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1"></plus><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.E1.m1.12.12.12.12.12.12.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2"><times id="S3.E1.m1.12.12.12.12.12.12.2.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.2"></times><ci id="S3.E1.m1.12.12.12.12.12.12.2.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.3">𝑞</ci><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.2">𝑥</ci><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3"><plus id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1"></plus><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2">𝑖</ci><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3"><lt id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2">absent</csymbol><apply id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3"><plus id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1"></plus><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E1.m1.24.24.1.1.1.4.3.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.E1.m1.24.24.1.1.1.4.3.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><ci id="S3.E1.m1.14.14.14.1.1.1.cmml" xref="S3.E1.m1.14.14.14.1.1.1">𝑟</ci><ci id="S3.E1.m1.15.15.15.2.2.2.1.cmml" xref="S3.E1.m1.15.15.15.2.2.2.1">𝑐</ci></apply></apply></apply><apply id="S3.E1.m1.24.24.1.1.1c.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><csymbol cd="latexml" id="S3.E1.m1.16.16.16.3.3.3.cmml" xref="S3.E1.m1.16.16.16.3.3.3">similar-to</csymbol><share href="#S3.E1.m1.24.24.1.1.1.4.cmml" id="S3.E1.m1.24.24.1.1.1d.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"></share><apply id="S3.E1.m1.24.24.1.1.1.6.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><times id="S3.E1.m1.24.24.1.1.1.6.1.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"></times><ci id="S3.E1.m1.17.17.17.4.4.4.cmml" xref="S3.E1.m1.17.17.17.4.4.4">𝑈</ci><interval closure="open" id="S3.E1.m1.24.24.1.1.1.6.3.cmml" xref="S3.E1.m1.25.25.2.24.14.14.14.2"><cn type="integer" id="S3.E1.m1.19.19.19.6.6.6.cmml" xref="S3.E1.m1.19.19.19.6.6.6">0</cn><cn type="integer" id="S3.E1.m1.21.21.21.8.8.8.cmml" xref="S3.E1.m1.21.21.21.8.8.8">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.26c">\begin{gathered}\tau_{c}(x_{i+c})=\min\left(1,\frac{p({x}_{i+c}|{x}_{&lt;i+c})}{q({x}_{i+c}|{x}_{&lt;i+c})}\right)\\
r_{c}\sim U(0,1),\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS0.Px1.p2.15" class="ltx_p">where <math id="S3.SS1.SSS0.Px1.p2.12.m1.2" class="ltx_Math" alttext="U(0,1)" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.12.m1.2a"><mrow id="S3.SS1.SSS0.Px1.p2.12.m1.2.3" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.2" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.1" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.2" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.2.1" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.1.cmml">(</mo><mn id="S3.SS1.SSS0.Px1.p2.12.m1.1.1" xref="S3.SS1.SSS0.Px1.p2.12.m1.1.1.cmml">0</mn><mo id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.2.2" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS1.SSS0.Px1.p2.12.m1.2.2" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.2.3" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.12.m1.2b"><apply id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3"><times id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.2">𝑈</ci><interval closure="open" id="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.3.3.2"><cn type="integer" id="S3.SS1.SSS0.Px1.p2.12.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.1.1">0</cn><cn type="integer" id="S3.SS1.SSS0.Px1.p2.12.m1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.12.m1.2c">U(0,1)</annotation></semantics></math> denotes a uniform distribution between 0 and 1.
If <math id="S3.SS1.SSS0.Px1.p2.13.m2.1" class="ltx_Math" alttext="{{x}}_{i+c}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.13.m2.1a"><msub id="S3.SS1.SSS0.Px1.p2.13.m2.1.1" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.13.m2.1b"><apply id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3"><plus id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.13.m2.1c">{{x}}_{i+c}</annotation></semantics></math> is accepted, the process is repeated for the next token <math id="S3.SS1.SSS0.Px1.p2.14.m3.1" class="ltx_Math" alttext="{{x}}_{i+c+1}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.14.m3.1a"><msub id="S3.SS1.SSS0.Px1.p2.14.m3.1.1" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.3.cmml">c</mi><mo id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1a" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.4" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.4.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.14.m3.1b"><apply id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3"><plus id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.3">𝑐</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.4.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m3.1.1.3.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.14.m3.1c">{{x}}_{i+c+1}</annotation></semantics></math> until either a token is rejected or all tokens have been accepted.
If <math id="S3.SS1.SSS0.Px1.p2.15.m4.1" class="ltx_Math" alttext="{{x}}_{i+c}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.15.m4.1a"><msub id="S3.SS1.SSS0.Px1.p2.15.m4.1.1" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.1.cmml">+</mo><mi id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.15.m4.1b"><apply id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.2">𝑥</ci><apply id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3"><plus id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m4.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.15.m4.1c">{{x}}_{i+c}</annotation></semantics></math> is rejected, a token is resampled from the following adjusted distribution instead:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.24" class="ltx_Math" alttext="\begin{gathered}{x}_{i+c}\sim\texttt{max\_norm}\left(p({x}|{x}_{&lt;i+c})-q({x}|{x}_{&lt;i+c})\right),\end{gathered}" display="block"><semantics id="S3.E2.m1.24a"><mtable displaystyle="true" id="S3.E2.m1.24.24.2"><mtr id="S3.E2.m1.24.24.2a"><mtd id="S3.E2.m1.24.24.2b"><mrow id="S3.E2.m1.24.24.2.23.23.23.23"><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1"><msub id="S3.E2.m1.24.24.2.23.23.23.23.1.2"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">x</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.3.cmml">c</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.cmml">∼</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.4.4.4.4.4.4" xref="S3.E2.m1.4.4.4.4.4.4a.cmml">max_norm</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.24.24.2.23.23.23.23.1.1.2" xref="S3.E2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1"><mo id="S3.E2.m1.5.5.5.5.5.5" xref="S3.E2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1"><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1"><mi id="S3.E2.m1.6.6.6.6.6.6" xref="S3.E2.m1.6.6.6.6.6.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.2" xref="S3.E2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E2.m1.7.7.7.7.7.7" xref="S3.E2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1.1"><mi id="S3.E2.m1.8.8.8.8.8.8" xref="S3.E2.m1.8.8.8.8.8.8.cmml">x</mi><mo fence="false" id="S3.E2.m1.9.9.9.9.9.9" xref="S3.E2.m1.9.9.9.9.9.9.cmml">|</mo><msub id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E2.m1.10.10.10.10.10.10" xref="S3.E2.m1.10.10.10.10.10.10.cmml">x</mi><mrow id="S3.E2.m1.11.11.11.11.11.11.1" xref="S3.E2.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E2.m1.11.11.11.11.11.11.1.2" xref="S3.E2.m1.11.11.11.11.11.11.1.2.cmml"></mi><mo id="S3.E2.m1.11.11.11.11.11.11.1.1" xref="S3.E2.m1.11.11.11.11.11.11.1.1.cmml">&lt;</mo><mrow id="S3.E2.m1.11.11.11.11.11.11.1.3" xref="S3.E2.m1.11.11.11.11.11.11.1.3.cmml"><mi id="S3.E2.m1.11.11.11.11.11.11.1.3.2" xref="S3.E2.m1.11.11.11.11.11.11.1.3.2.cmml">i</mi><mo id="S3.E2.m1.11.11.11.11.11.11.1.3.1" xref="S3.E2.m1.11.11.11.11.11.11.1.3.1.cmml">+</mo><mi id="S3.E2.m1.11.11.11.11.11.11.1.3.3" xref="S3.E2.m1.11.11.11.11.11.11.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E2.m1.12.12.12.12.12.12" xref="S3.E2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.13.13.13.13.13.13" xref="S3.E2.m1.13.13.13.13.13.13.cmml">−</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2"><mi id="S3.E2.m1.14.14.14.14.14.14" xref="S3.E2.m1.14.14.14.14.14.14.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.2" xref="S3.E2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1"><mo stretchy="false" id="S3.E2.m1.15.15.15.15.15.15" xref="S3.E2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1.1"><mi id="S3.E2.m1.16.16.16.16.16.16" xref="S3.E2.m1.16.16.16.16.16.16.cmml">x</mi><mo fence="false" id="S3.E2.m1.17.17.17.17.17.17" xref="S3.E2.m1.17.17.17.17.17.17.cmml">|</mo><msub id="S3.E2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1.1.1"><mi id="S3.E2.m1.18.18.18.18.18.18" xref="S3.E2.m1.18.18.18.18.18.18.cmml">x</mi><mrow id="S3.E2.m1.19.19.19.19.19.19.1" xref="S3.E2.m1.19.19.19.19.19.19.1.cmml"><mi id="S3.E2.m1.19.19.19.19.19.19.1.2" xref="S3.E2.m1.19.19.19.19.19.19.1.2.cmml"></mi><mo id="S3.E2.m1.19.19.19.19.19.19.1.1" xref="S3.E2.m1.19.19.19.19.19.19.1.1.cmml">&lt;</mo><mrow id="S3.E2.m1.19.19.19.19.19.19.1.3" xref="S3.E2.m1.19.19.19.19.19.19.1.3.cmml"><mi id="S3.E2.m1.19.19.19.19.19.19.1.3.2" xref="S3.E2.m1.19.19.19.19.19.19.1.3.2.cmml">i</mi><mo id="S3.E2.m1.19.19.19.19.19.19.1.3.1" xref="S3.E2.m1.19.19.19.19.19.19.1.3.1.cmml">+</mo><mi id="S3.E2.m1.19.19.19.19.19.19.1.3.3" xref="S3.E2.m1.19.19.19.19.19.19.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E2.m1.20.20.20.20.20.20" xref="S3.E2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.21.21.21.21.21.21" xref="S3.E2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.22.22.22.22.22.22" xref="S3.E2.m1.23.23.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.24b"><apply id="S3.E2.m1.23.23.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3">similar-to</csymbol><apply id="S3.E2.m1.23.23.1.1.1.3.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.23.23.1.1.1.3.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑥</ci><apply id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"><plus id="S3.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3">𝑐</ci></apply></apply><apply id="S3.E2.m1.23.23.1.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.E2.m1.23.23.1.1.1.1.2.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"></times><ci id="S3.E2.m1.4.4.4.4.4.4a.cmml" xref="S3.E2.m1.4.4.4.4.4.4"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.4.4.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4.4.4">max_norm</mtext></ci><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><minus id="S3.E2.m1.13.13.13.13.13.13.cmml" xref="S3.E2.m1.13.13.13.13.13.13"></minus><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.E2.m1.23.23.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"></times><ci id="S3.E2.m1.6.6.6.6.6.6.cmml" xref="S3.E2.m1.6.6.6.6.6.6">𝑝</ci><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.E2.m1.9.9.9.9.9.9.cmml" xref="S3.E2.m1.9.9.9.9.9.9">conditional</csymbol><ci id="S3.E2.m1.8.8.8.8.8.8.cmml" xref="S3.E2.m1.8.8.8.8.8.8">𝑥</ci><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.E2.m1.10.10.10.10.10.10.cmml" xref="S3.E2.m1.10.10.10.10.10.10">𝑥</ci><apply id="S3.E2.m1.11.11.11.11.11.11.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1"><lt id="S3.E2.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.1"></lt><csymbol cd="latexml" id="S3.E2.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.2">absent</csymbol><apply id="S3.E2.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.3"><plus id="S3.E2.m1.11.11.11.11.11.11.1.3.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.3.1"></plus><ci id="S3.E2.m1.11.11.11.11.11.11.1.3.2.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.3.2">𝑖</ci><ci id="S3.E2.m1.11.11.11.11.11.11.1.3.3.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.E2.m1.23.23.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"></times><ci id="S3.E2.m1.14.14.14.14.14.14.cmml" xref="S3.E2.m1.14.14.14.14.14.14">𝑞</ci><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.E2.m1.17.17.17.17.17.17.cmml" xref="S3.E2.m1.17.17.17.17.17.17">conditional</csymbol><ci id="S3.E2.m1.16.16.16.16.16.16.cmml" xref="S3.E2.m1.16.16.16.16.16.16">𝑥</ci><apply id="S3.E2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.E2.m1.18.18.18.18.18.18.cmml" xref="S3.E2.m1.18.18.18.18.18.18">𝑥</ci><apply id="S3.E2.m1.19.19.19.19.19.19.1.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1"><lt id="S3.E2.m1.19.19.19.19.19.19.1.1.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.1"></lt><csymbol cd="latexml" id="S3.E2.m1.19.19.19.19.19.19.1.2.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.2">absent</csymbol><apply id="S3.E2.m1.19.19.19.19.19.19.1.3.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.3"><plus id="S3.E2.m1.19.19.19.19.19.19.1.3.1.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.3.1"></plus><ci id="S3.E2.m1.19.19.19.19.19.19.1.3.2.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.3.2">𝑖</ci><ci id="S3.E2.m1.19.19.19.19.19.19.1.3.3.cmml" xref="S3.E2.m1.19.19.19.19.19.19.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.24c">\begin{gathered}{x}_{i+c}\sim\texttt{max\_norm}\left(p({x}|{x}_{&lt;i+c})-q({x}|{x}_{&lt;i+c})\right),\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS0.Px1.p2.16" class="ltx_p">where <math id="S3.SS1.SSS0.Px1.p2.16.m1.2" class="ltx_Math" alttext="\texttt{max\_norm}(f(x))" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.16.m1.2a"><mrow id="S3.SS1.SSS0.Px1.p2.16.m1.2.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3a.cmml">max_norm</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.1" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.3.2.1" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.SS1.SSS0.Px1.p2.16.m1.1.1" xref="S3.SS1.SSS0.Px1.p2.16.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.3.2.2" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.16.m1.2b"><apply id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2"><times id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.2"></times><ci id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3a.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.3">max_norm</mtext></ci><apply id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1"><times id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.1"></times><ci id="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.2.2.1.1.1.2">𝑓</ci><ci id="S3.SS1.SSS0.Px1.p2.16.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.16.m1.2c">\texttt{max\_norm}(f(x))</annotation></semantics></math> is given by:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.9" class="ltx_Math" alttext="\texttt{max\_norm}(f(x))=\frac{\max(0,f(x))}{{\sum_{x^{\prime}\in\mathcal{V}}\max(0,f(x^{\prime}))}}." display="block"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9.1" xref="S3.E3.m1.9.9.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1" xref="S3.E3.m1.9.9.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.1" xref="S3.E3.m1.9.9.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.9.9.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.3a.cmml">max_norm</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.1.1.2" xref="S3.E3.m1.9.9.1.1.2.cmml">=</mo><mfrac id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml"><mrow id="S3.E3.m1.4.4.4.4" xref="S3.E3.m1.4.4.4.5.cmml"><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">max</mi><mo id="S3.E3.m1.4.4.4.4a" xref="S3.E3.m1.4.4.4.5.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.4.4.1" xref="S3.E3.m1.4.4.4.5.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.4.4.1.2" xref="S3.E3.m1.4.4.4.5.cmml">(</mo><mn id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml">0</mn><mo id="S3.E3.m1.4.4.4.4.1.3" xref="S3.E3.m1.4.4.4.5.cmml">,</mo><mrow id="S3.E3.m1.4.4.4.4.1.1" xref="S3.E3.m1.4.4.4.4.1.1.cmml"><mi id="S3.E3.m1.4.4.4.4.1.1.2" xref="S3.E3.m1.4.4.4.4.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.4.4.1.1.1" xref="S3.E3.m1.4.4.4.4.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.4.4.1.1.3.2" xref="S3.E3.m1.4.4.4.4.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.4.4.1.1.3.2.1" xref="S3.E3.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.4.4.4.4.1.1.3.2.2" xref="S3.E3.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.4.4.4.4.1.4" xref="S3.E3.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.7.7.7" xref="S3.E3.m1.7.7.7.cmml"><msub id="S3.E3.m1.7.7.7.4" xref="S3.E3.m1.7.7.7.4.cmml"><mo id="S3.E3.m1.7.7.7.4.2" xref="S3.E3.m1.7.7.7.4.2.cmml">∑</mo><mrow id="S3.E3.m1.7.7.7.4.3" xref="S3.E3.m1.7.7.7.4.3.cmml"><msup id="S3.E3.m1.7.7.7.4.3.2" xref="S3.E3.m1.7.7.7.4.3.2.cmml"><mi id="S3.E3.m1.7.7.7.4.3.2.2" xref="S3.E3.m1.7.7.7.4.3.2.2.cmml">x</mi><mo id="S3.E3.m1.7.7.7.4.3.2.3" xref="S3.E3.m1.7.7.7.4.3.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.7.7.7.4.3.1" xref="S3.E3.m1.7.7.7.4.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.7.7.7.4.3.3" xref="S3.E3.m1.7.7.7.4.3.3.cmml">𝒱</mi></mrow></msub><mrow id="S3.E3.m1.7.7.7.3.1" xref="S3.E3.m1.7.7.7.3.2.cmml"><mi id="S3.E3.m1.5.5.5.1" xref="S3.E3.m1.5.5.5.1.cmml">max</mi><mo id="S3.E3.m1.7.7.7.3.1a" xref="S3.E3.m1.7.7.7.3.2.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.7.3.1.1" xref="S3.E3.m1.7.7.7.3.2.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.7.3.1.1.2" xref="S3.E3.m1.7.7.7.3.2.cmml">(</mo><mn id="S3.E3.m1.6.6.6.2" xref="S3.E3.m1.6.6.6.2.cmml">0</mn><mo id="S3.E3.m1.7.7.7.3.1.1.3" xref="S3.E3.m1.7.7.7.3.2.cmml">,</mo><mrow id="S3.E3.m1.7.7.7.3.1.1.1" xref="S3.E3.m1.7.7.7.3.1.1.1.cmml"><mi id="S3.E3.m1.7.7.7.3.1.1.1.3" xref="S3.E3.m1.7.7.7.3.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.7.7.7.3.1.1.1.2" xref="S3.E3.m1.7.7.7.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.7.7.7.3.1.1.1.1.1" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.7.3.1.1.1.1.1.2" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.2" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.3" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E3.m1.7.7.7.3.1.1.1.1.1.3" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.7.7.7.3.1.1.4" xref="S3.E3.m1.7.7.7.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo lspace="0em" id="S3.E3.m1.9.9.1.2" xref="S3.E3.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.1.1.cmml" xref="S3.E3.m1.9.9.1"><eq id="S3.E3.m1.9.9.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.2"></eq><apply id="S3.E3.m1.9.9.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.2"></times><ci id="S3.E3.m1.9.9.1.1.1.3a.cmml" xref="S3.E3.m1.9.9.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.9.9.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.3">max_norm</mtext></ci><apply id="S3.E3.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1"></times><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">𝑥</ci></apply></apply><apply id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7"><divide id="S3.E3.m1.7.7.8.cmml" xref="S3.E3.m1.7.7"></divide><apply id="S3.E3.m1.4.4.4.5.cmml" xref="S3.E3.m1.4.4.4.4"><max id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"></max><cn type="integer" id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3">0</cn><apply id="S3.E3.m1.4.4.4.4.1.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1"><times id="S3.E3.m1.4.4.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1.1"></times><ci id="S3.E3.m1.4.4.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.4.4.1.1.2">𝑓</ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="S3.E3.m1.7.7.7.cmml" xref="S3.E3.m1.7.7.7"><apply id="S3.E3.m1.7.7.7.4.cmml" xref="S3.E3.m1.7.7.7.4"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.4.1.cmml" xref="S3.E3.m1.7.7.7.4">subscript</csymbol><sum id="S3.E3.m1.7.7.7.4.2.cmml" xref="S3.E3.m1.7.7.7.4.2"></sum><apply id="S3.E3.m1.7.7.7.4.3.cmml" xref="S3.E3.m1.7.7.7.4.3"><in id="S3.E3.m1.7.7.7.4.3.1.cmml" xref="S3.E3.m1.7.7.7.4.3.1"></in><apply id="S3.E3.m1.7.7.7.4.3.2.cmml" xref="S3.E3.m1.7.7.7.4.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.4.3.2.1.cmml" xref="S3.E3.m1.7.7.7.4.3.2">superscript</csymbol><ci id="S3.E3.m1.7.7.7.4.3.2.2.cmml" xref="S3.E3.m1.7.7.7.4.3.2.2">𝑥</ci><ci id="S3.E3.m1.7.7.7.4.3.2.3.cmml" xref="S3.E3.m1.7.7.7.4.3.2.3">′</ci></apply><ci id="S3.E3.m1.7.7.7.4.3.3.cmml" xref="S3.E3.m1.7.7.7.4.3.3">𝒱</ci></apply></apply><apply id="S3.E3.m1.7.7.7.3.2.cmml" xref="S3.E3.m1.7.7.7.3.1"><max id="S3.E3.m1.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.1"></max><cn type="integer" id="S3.E3.m1.6.6.6.2.cmml" xref="S3.E3.m1.6.6.6.2">0</cn><apply id="S3.E3.m1.7.7.7.3.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1"><times id="S3.E3.m1.7.7.7.3.1.1.1.2.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.2"></times><ci id="S3.E3.m1.7.7.7.3.1.1.1.3.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.3">𝑓</ci><apply id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.7.7.7.3.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">\texttt{max\_norm}(f(x))=\frac{\max(0,f(x))}{{\sum_{x^{\prime}\in\mathcal{V}}\max(0,f(x^{\prime}))}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">GPU memory and execution model.</h5>

<div id="S3.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS1.SSS0.Px2.p1.1" class="ltx_p">We briefly describe the memory components and parts of the execution model of GPU hardware accelerators relevant to this work.
GPU memory has a hierarchical layout, consisting of various types of memory that differ in size and read/write bandwidth <cite class="ltx_cite ltx_citemacro_citep">(Jia et al., <a href="#bib.bib28" title="" class="ltx_ref">2018</a>)</cite>.
Recent GPUs (<span id="S3.SS1.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, NVIDIA’s A100 series) typically feature several gigabytes of high-bandwidth memory (HBM) and only a few hundred kilobytes of on-chip shared memory (SRAM) per streaming multiprocessor (SM) <cite class="ltx_cite ltx_citemacro_cite">NVIDIA Corporation (<a href="#bib.bib43" title="" class="ltx_ref">2020</a>)</cite>.
While HBM provides substantial capacity, its memory bandwidth is lower compared to SRAM. The execution model of GPU hardware accelerators involves a large number of threads executing operations known as kernels <cite class="ltx_cite ltx_citemacro_cite">Cheng et al. (<a href="#bib.bib11" title="" class="ltx_ref">2014</a>)</cite>.
These threads are organized into thread blocks and assigned to SMs.
Each SM partitions its assigned thread blocks into warps of 32 threads, which are then queued for execution on available hardware resources.
Each kernel typically follows a pattern: loading inputs from HBM into registers and SRAM, performing computations, and writing the outputs back to HBM.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Acceleration of speculative sampling</h3>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.11016/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="82" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of our exact optimization approach. We compute most of the results required for speculative sampling in parallel using fast SRAM to read and write intermediate results. We maximize the number of threads per block to run parallel computation on as many elements as possible without exhausting the available on-chip memory.
</figcaption>
</figure>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Exact optimization</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">Our optimization of speculative sampling is designed for parallel heterogeneous hardware accelerators, such as NVIDIA GPUs, which are widely employed to perform inference on large scale models.
Similar to the approaches described in <cite class="ltx_cite ltx_citemacro_citet">Ryoo et al. (<a href="#bib.bib50" title="" class="ltx_ref">2008</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Dao et al. (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, we aim to redistribute the speculative sampling workload across threads and thread blocks.
We load chunks of inputs from HBM to SRAM and make the necessary computations with respect to this input chunk before writing the final result back to HBM.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.6" class="ltx_p">We notice that the intermediate elements needed for speculative sampling can be computed concurrently within thread blocks and are largely independent of other thread blocks.
Specifically, we can compute <math id="S3.SS2.SSS1.p2.1.m1.2" class="ltx_Math" alttext="(\tau_{c}(x))_{x\in\mathcal{V}}" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.2a"><msub id="S3.SS2.SSS1.p2.1.m1.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.cmml"><mrow id="S3.SS2.SSS1.p2.1.m1.2.2.1.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml">τ</mi><mi id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.2.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS2.SSS1.p2.1.m1.2.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.2.2.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.2.cmml">x</mi><mo id="S3.SS2.SSS1.p2.1.m1.2.2.3.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.2.2.3.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.3.cmml">𝒱</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.2b"><apply id="S3.SS2.SSS1.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1"><times id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1"></times><apply id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2">𝜏</ci><ci id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝑥</ci></apply><apply id="S3.SS2.SSS1.p2.1.m1.2.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.3"><in id="S3.SS2.SSS1.p2.1.m1.2.2.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.1"></in><ci id="S3.SS2.SSS1.p2.1.m1.2.2.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.2">𝑥</ci><ci id="S3.SS2.SSS1.p2.1.m1.2.2.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.3.3">𝒱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.2c">(\tau_{c}(x))_{x\in\mathcal{V}}</annotation></semantics></math> and parts of <a href="#S3.E3" title="3 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 3</span></a> in parallel.
The kernel is tiled <cite class="ltx_cite ltx_citemacro_cite">Lam et al. (<a href="#bib.bib31" title="" class="ltx_ref">1991</a>)</cite>, such that each thread block computes a tile of <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">n</annotation></semantics></math> elements from each matrix at once.
Threads within a block jointly load segments of the probability matrices <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="p(x|x_{x&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mrow id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.2.cmml">x</mi><mo id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><times id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2"></times><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">𝑝</ci><apply id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.1"></lt><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">p(x|x_{x&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="q(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mrow id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.4.m4.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><times id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2"></times><ci id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3">𝑞</ci><apply id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">q(x|x_{&lt;i+c})</annotation></semantics></math>, whose full dimensions are <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="B\times\gamma\times\lvert\mathcal{V}\rvert" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mrow id="S3.SS2.SSS1.p2.5.m5.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.2.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.2.2" xref="S3.SS2.SSS1.p2.5.m5.1.2.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.5.m5.1.2.1" xref="S3.SS2.SSS1.p2.5.m5.1.2.1.cmml">×</mo><mi id="S3.SS2.SSS1.p2.5.m5.1.2.3" xref="S3.SS2.SSS1.p2.5.m5.1.2.3.cmml">γ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.5.m5.1.2.1a" xref="S3.SS2.SSS1.p2.5.m5.1.2.1.cmml">×</mo><mrow id="S3.SS2.SSS1.p2.5.m5.1.2.4.2" xref="S3.SS2.SSS1.p2.5.m5.1.2.4.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.2.4.2.1" xref="S3.SS2.SSS1.p2.5.m5.1.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.2.4.2.2" xref="S3.SS2.SSS1.p2.5.m5.1.2.4.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2"><times id="S3.SS2.SSS1.p2.5.m5.1.2.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2.1"></times><ci id="S3.SS2.SSS1.p2.5.m5.1.2.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2.2">𝐵</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.2.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2.3">𝛾</ci><apply id="S3.SS2.SSS1.p2.5.m5.1.2.4.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2.4.2"><abs id="S3.SS2.SSS1.p2.5.m5.1.2.4.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.2.4.2.1"></abs><ci id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">𝒱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">B\times\gamma\times\lvert\mathcal{V}\rvert</annotation></semantics></math>, into SRAM, effectively distributing the overhead of load latency, as discussed in more detail in <cite class="ltx_cite ltx_citemacro_citet">Ryoo et al. (<a href="#bib.bib50" title="" class="ltx_ref">2008</a>)</cite>.
<math id="S3.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><mi id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><ci id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">B</annotation></semantics></math> denotes the batch size used during speculative decoding.</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<p id="S3.SS2.SSS1.p3.16" class="ltx_p"><a href="#S3.F1" title="Figure 1 ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 1</span></a> illustrates the details of our approach.
The overall workload is distributed across a two-dimensional grid of batch size <math id="S3.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><mi id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><ci id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">B</annotation></semantics></math> and number of draft tokens <math id="S3.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><mi id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">\gamma</annotation></semantics></math>. The vocabulary <math id="S3.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><ci id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">\mathcal{V}</annotation></semantics></math> is partitioned into disjoint subsets <math id="S3.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\{\mathcal{V}_{k}\}_{k=1}^{K}" display="inline"><semantics id="S3.SS2.SSS1.p3.4.m4.1a"><msubsup id="S3.SS2.SSS1.p3.4.m4.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p3.4.m4.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.4.m4.1b"><apply id="S3.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1"><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3"><eq id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.1"></eq><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.4.m4.1c">\{\mathcal{V}_{k}\}_{k=1}^{K}</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p3.5.m5.2" class="ltx_Math" alttext="K=\lceil\lvert\mathcal{V}\rvert/n\rceil" display="inline"><semantics id="S3.SS2.SSS1.p3.5.m5.2a"><mrow id="S3.SS2.SSS1.p3.5.m5.2.2" xref="S3.SS2.SSS1.p3.5.m5.2.2.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.2.2.3" xref="S3.SS2.SSS1.p3.5.m5.2.2.3.cmml">K</mi><mo id="S3.SS2.SSS1.p3.5.m5.2.2.2" xref="S3.SS2.SSS1.p3.5.m5.2.2.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p3.5.m5.2.2.1.1" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.2" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.2.1.cmml">⌈</mo><mrow id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.2.1" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.5.m5.1.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.2.2" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.1" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.3" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.3" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.2.1.cmml">⌉</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.5.m5.2b"><apply id="S3.SS2.SSS1.p3.5.m5.2.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2"><eq id="S3.SS2.SSS1.p3.5.m5.2.2.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.2"></eq><ci id="S3.SS2.SSS1.p3.5.m5.2.2.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.3">𝐾</ci><apply id="S3.SS2.SSS1.p3.5.m5.2.2.1.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1"><ceiling id="S3.SS2.SSS1.p3.5.m5.2.2.1.2.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.2"></ceiling><apply id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1"><divide id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.1"></divide><apply id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.2"><abs id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.2.2.1"></abs><ci id="S3.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1">𝒱</ci></apply><ci id="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.2.2.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.5.m5.2c">K=\lceil\lvert\mathcal{V}\rvert/n\rceil</annotation></semantics></math> and <math id="S3.SS2.SSS1.p3.6.m6.1" class="ltx_Math" alttext="\lceil\cdot\rceil" display="inline"><semantics id="S3.SS2.SSS1.p3.6.m6.1a"><mrow id="S3.SS2.SSS1.p3.6.m6.1.2.2" xref="S3.SS2.SSS1.p3.6.m6.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.6.m6.1.2.2.1" xref="S3.SS2.SSS1.p3.6.m6.1.2.1.1.cmml">⌈</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.6.m6.1.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.SSS1.p3.6.m6.1.2.2.2" xref="S3.SS2.SSS1.p3.6.m6.1.2.1.1.cmml">⌉</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.6.m6.1b"><apply id="S3.SS2.SSS1.p3.6.m6.1.2.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.2.2"><ceiling id="S3.SS2.SSS1.p3.6.m6.1.2.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.2.2.1"></ceiling><ci id="S3.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.6.m6.1c">\lceil\cdot\rceil</annotation></semantics></math> is the ceiling function.
Each thread in a block performs operations on the sub-vocabulary <math id="S3.SS2.SSS1.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS1.p3.7.m7.1a"><msub id="S3.SS2.SSS1.p3.7.m7.1.1" xref="S3.SS2.SSS1.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.7.m7.1.1.2" xref="S3.SS2.SSS1.p3.7.m7.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p3.7.m7.1.1.3" xref="S3.SS2.SSS1.p3.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.7.m7.1b"><apply id="S3.SS2.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p3.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.7.m7.1c">\mathcal{V}_{k}</annotation></semantics></math> within its corresponding tile.
The results in each tile <math id="S3.SS2.SSS1.p3.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.SSS1.p3.8.m8.1a"><mi id="S3.SS2.SSS1.p3.8.m8.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.8.m8.1b"><ci id="S3.SS2.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.8.m8.1c">k</annotation></semantics></math> are obtained in three steps.  <svg id="S3.SS2.SSS1.p3.9.pic1" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#DAE8FC" stroke="#6C8EBF"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS1.p3.9.pic1.1.1.1.1.1" class="ltx_text ltx_font_bold">1</span></foreignObject></g></g></svg>
The domains of the probability density functions <math id="S3.SS2.SSS1.p3.10.m9.1" class="ltx_Math" alttext="p(x|x_{i+c})" display="inline"><semantics id="S3.SS2.SSS1.p3.10.m9.1a"><mrow id="S3.SS2.SSS1.p3.10.m9.1.1" xref="S3.SS2.SSS1.p3.10.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p3.10.m9.1.1.3" xref="S3.SS2.SSS1.p3.10.m9.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.10.m9.1.1.2" xref="S3.SS2.SSS1.p3.10.m9.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.10.m9.1.1.1.1" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.2" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.3" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.10.m9.1b"><apply id="S3.SS2.SSS1.p3.10.m9.1.1.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1"><times id="S3.SS2.SSS1.p3.10.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.2"></times><ci id="S3.SS2.SSS1.p3.10.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.3">𝑝</ci><apply id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3"><plus id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p3.10.m9.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.10.m9.1c">p(x|x_{i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS1.p3.11.m10.1" class="ltx_Math" alttext="q(x|x_{i+c})" display="inline"><semantics id="S3.SS2.SSS1.p3.11.m10.1a"><mrow id="S3.SS2.SSS1.p3.11.m10.1.1" xref="S3.SS2.SSS1.p3.11.m10.1.1.cmml"><mi id="S3.SS2.SSS1.p3.11.m10.1.1.3" xref="S3.SS2.SSS1.p3.11.m10.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.11.m10.1.1.2" xref="S3.SS2.SSS1.p3.11.m10.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.11.m10.1.1.1.1" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.2" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.3" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.11.m10.1b"><apply id="S3.SS2.SSS1.p3.11.m10.1.1.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1"><times id="S3.SS2.SSS1.p3.11.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.2"></times><ci id="S3.SS2.SSS1.p3.11.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.3">𝑞</ci><apply id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3"><plus id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p3.11.m10.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.11.m10.1c">q(x|x_{i+c})</annotation></semantics></math> are restricted to the sub-vocabulary <math id="S3.SS2.SSS1.p3.12.m11.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS1.p3.12.m11.1a"><msub id="S3.SS2.SSS1.p3.12.m11.1.1" xref="S3.SS2.SSS1.p3.12.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.12.m11.1.1.2" xref="S3.SS2.SSS1.p3.12.m11.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p3.12.m11.1.1.3" xref="S3.SS2.SSS1.p3.12.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.12.m11.1b"><apply id="S3.SS2.SSS1.p3.12.m11.1.1.cmml" xref="S3.SS2.SSS1.p3.12.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.12.m11.1.1.1.cmml" xref="S3.SS2.SSS1.p3.12.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.12.m11.1.1.2.cmml" xref="S3.SS2.SSS1.p3.12.m11.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p3.12.m11.1.1.3.cmml" xref="S3.SS2.SSS1.p3.12.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.12.m11.1c">\mathcal{V}_{k}</annotation></semantics></math> and the restricted functions are denoted as <math id="S3.SS2.SSS1.p3.13.m12.1" class="ltx_Math" alttext="{p}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p3.13.m12.1a"><mrow id="S3.SS2.SSS1.p3.13.m12.1.2" xref="S3.SS2.SSS1.p3.13.m12.1.2.cmml"><msub id="S3.SS2.SSS1.p3.13.m12.1.2.2" xref="S3.SS2.SSS1.p3.13.m12.1.2.2.cmml"><mi id="S3.SS2.SSS1.p3.13.m12.1.2.2.2" xref="S3.SS2.SSS1.p3.13.m12.1.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p3.13.m12.1.2.2.3" xref="S3.SS2.SSS1.p3.13.m12.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.13.m12.1.2.1" xref="S3.SS2.SSS1.p3.13.m12.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.13.m12.1.2.3.2" xref="S3.SS2.SSS1.p3.13.m12.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.13.m12.1.2.3.2.1" xref="S3.SS2.SSS1.p3.13.m12.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p3.13.m12.1.1" xref="S3.SS2.SSS1.p3.13.m12.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.13.m12.1.2.3.2.2" xref="S3.SS2.SSS1.p3.13.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.13.m12.1b"><apply id="S3.SS2.SSS1.p3.13.m12.1.2.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2"><times id="S3.SS2.SSS1.p3.13.m12.1.2.1.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2.1"></times><apply id="S3.SS2.SSS1.p3.13.m12.1.2.2.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.13.m12.1.2.2.1.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.13.m12.1.2.2.2.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2.2.2">𝑝</ci><ci id="S3.SS2.SSS1.p3.13.m12.1.2.2.3.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p3.13.m12.1.1.cmml" xref="S3.SS2.SSS1.p3.13.m12.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.13.m12.1c">{p}_{k}(x)</annotation></semantics></math> and <math id="S3.SS2.SSS1.p3.14.m13.1" class="ltx_Math" alttext="{q}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p3.14.m13.1a"><mrow id="S3.SS2.SSS1.p3.14.m13.1.2" xref="S3.SS2.SSS1.p3.14.m13.1.2.cmml"><msub id="S3.SS2.SSS1.p3.14.m13.1.2.2" xref="S3.SS2.SSS1.p3.14.m13.1.2.2.cmml"><mi id="S3.SS2.SSS1.p3.14.m13.1.2.2.2" xref="S3.SS2.SSS1.p3.14.m13.1.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS1.p3.14.m13.1.2.2.3" xref="S3.SS2.SSS1.p3.14.m13.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.14.m13.1.2.1" xref="S3.SS2.SSS1.p3.14.m13.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.14.m13.1.2.3.2" xref="S3.SS2.SSS1.p3.14.m13.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.14.m13.1.2.3.2.1" xref="S3.SS2.SSS1.p3.14.m13.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p3.14.m13.1.1" xref="S3.SS2.SSS1.p3.14.m13.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.14.m13.1.2.3.2.2" xref="S3.SS2.SSS1.p3.14.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.14.m13.1b"><apply id="S3.SS2.SSS1.p3.14.m13.1.2.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2"><times id="S3.SS2.SSS1.p3.14.m13.1.2.1.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2.1"></times><apply id="S3.SS2.SSS1.p3.14.m13.1.2.2.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.14.m13.1.2.2.1.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.14.m13.1.2.2.2.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2.2.2">𝑞</ci><ci id="S3.SS2.SSS1.p3.14.m13.1.2.2.3.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p3.14.m13.1.1.cmml" xref="S3.SS2.SSS1.p3.14.m13.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.14.m13.1c">{q}_{k}(x)</annotation></semantics></math>, respectively. All function values of <math id="S3.SS2.SSS1.p3.15.m14.1" class="ltx_Math" alttext="{p}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p3.15.m14.1a"><mrow id="S3.SS2.SSS1.p3.15.m14.1.2" xref="S3.SS2.SSS1.p3.15.m14.1.2.cmml"><msub id="S3.SS2.SSS1.p3.15.m14.1.2.2" xref="S3.SS2.SSS1.p3.15.m14.1.2.2.cmml"><mi id="S3.SS2.SSS1.p3.15.m14.1.2.2.2" xref="S3.SS2.SSS1.p3.15.m14.1.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p3.15.m14.1.2.2.3" xref="S3.SS2.SSS1.p3.15.m14.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.15.m14.1.2.1" xref="S3.SS2.SSS1.p3.15.m14.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.15.m14.1.2.3.2" xref="S3.SS2.SSS1.p3.15.m14.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.15.m14.1.2.3.2.1" xref="S3.SS2.SSS1.p3.15.m14.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p3.15.m14.1.1" xref="S3.SS2.SSS1.p3.15.m14.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.15.m14.1.2.3.2.2" xref="S3.SS2.SSS1.p3.15.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.15.m14.1b"><apply id="S3.SS2.SSS1.p3.15.m14.1.2.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2"><times id="S3.SS2.SSS1.p3.15.m14.1.2.1.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2.1"></times><apply id="S3.SS2.SSS1.p3.15.m14.1.2.2.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.15.m14.1.2.2.1.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.15.m14.1.2.2.2.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2.2.2">𝑝</ci><ci id="S3.SS2.SSS1.p3.15.m14.1.2.2.3.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p3.15.m14.1.1.cmml" xref="S3.SS2.SSS1.p3.15.m14.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.15.m14.1c">{p}_{k}(x)</annotation></semantics></math> and <math id="S3.SS2.SSS1.p3.16.m15.1" class="ltx_Math" alttext="{q}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p3.16.m15.1a"><mrow id="S3.SS2.SSS1.p3.16.m15.1.2" xref="S3.SS2.SSS1.p3.16.m15.1.2.cmml"><msub id="S3.SS2.SSS1.p3.16.m15.1.2.2" xref="S3.SS2.SSS1.p3.16.m15.1.2.2.cmml"><mi id="S3.SS2.SSS1.p3.16.m15.1.2.2.2" xref="S3.SS2.SSS1.p3.16.m15.1.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS1.p3.16.m15.1.2.2.3" xref="S3.SS2.SSS1.p3.16.m15.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.16.m15.1.2.1" xref="S3.SS2.SSS1.p3.16.m15.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p3.16.m15.1.2.3.2" xref="S3.SS2.SSS1.p3.16.m15.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.16.m15.1.2.3.2.1" xref="S3.SS2.SSS1.p3.16.m15.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p3.16.m15.1.1" xref="S3.SS2.SSS1.p3.16.m15.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.16.m15.1.2.3.2.2" xref="S3.SS2.SSS1.p3.16.m15.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.16.m15.1b"><apply id="S3.SS2.SSS1.p3.16.m15.1.2.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2"><times id="S3.SS2.SSS1.p3.16.m15.1.2.1.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2.1"></times><apply id="S3.SS2.SSS1.p3.16.m15.1.2.2.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.16.m15.1.2.2.1.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.16.m15.1.2.2.2.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2.2.2">𝑞</ci><ci id="S3.SS2.SSS1.p3.16.m15.1.2.2.3.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p3.16.m15.1.1.cmml" xref="S3.SS2.SSS1.p3.16.m15.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.16.m15.1c">{q}_{k}(x)</annotation></semantics></math> are loaded from HBM to SRAM.</p>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para">
<svg id="S3.SS2.SSS1.p4.pic1" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#DAE8FC" stroke="#6C8EBF"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS1.p4.pic1.1.1.1.1.1" class="ltx_text ltx_font_bold">2</span></foreignObject></g></g></svg>
<p id="S3.SS2.SSS1.p4.12" class="ltx_p">All necessary partial results are computed with respect to the sub-vocabulary <math id="S3.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><msub id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.1.m1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p4.1.m1.1.1.3" xref="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">\mathcal{V}_{k}</annotation></semantics></math> and stored in SRAM.
Note that
the probability ratio <math id="S3.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="\tau_{c}(x)" display="inline"><semantics id="S3.SS2.SSS1.p4.2.m2.1a"><mrow id="S3.SS2.SSS1.p4.2.m2.1.2" xref="S3.SS2.SSS1.p4.2.m2.1.2.cmml"><msub id="S3.SS2.SSS1.p4.2.m2.1.2.2" xref="S3.SS2.SSS1.p4.2.m2.1.2.2.cmml"><mi id="S3.SS2.SSS1.p4.2.m2.1.2.2.2" xref="S3.SS2.SSS1.p4.2.m2.1.2.2.2.cmml">τ</mi><mi id="S3.SS2.SSS1.p4.2.m2.1.2.2.3" xref="S3.SS2.SSS1.p4.2.m2.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.2.m2.1.2.1" xref="S3.SS2.SSS1.p4.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.2.m2.1.2.3.2" xref="S3.SS2.SSS1.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.2.m2.1.2.3.2.1" xref="S3.SS2.SSS1.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p4.2.m2.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.2.m2.1.2.3.2.2" xref="S3.SS2.SSS1.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.2.m2.1b"><apply id="S3.SS2.SSS1.p4.2.m2.1.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2"><times id="S3.SS2.SSS1.p4.2.m2.1.2.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2.1"></times><apply id="S3.SS2.SSS1.p4.2.m2.1.2.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p4.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2.2.2">𝜏</ci><ci id="S3.SS2.SSS1.p4.2.m2.1.2.2.3.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.2.2.3">𝑐</ci></apply><ci id="S3.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.2.m2.1c">\tau_{c}(x)</annotation></semantics></math> in <a href="#S3.E1" title="1 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 1</span></a>,
the difference <math id="S3.SS2.SSS1.p4.3.m3.3" class="ltx_Math" alttext="f(x)=p(x|x_{&lt;i+c})-q(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS1.p4.3.m3.3a"><mrow id="S3.SS2.SSS1.p4.3.m3.3.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.cmml"><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.4" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.4.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.3.m3.3.3.4.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.4.3.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.3.3.4.3.2.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.cmml">(</mo><mi id="S3.SS2.SSS1.p4.3.m3.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.3.3.4.3.2.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p4.3.m3.3.3.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.cmml"><mrow id="S3.SS2.SSS1.p4.3.m3.2.2.1.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p4.3.m3.3.3.2.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.3.cmml">−</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.3.m3.3b"><apply id="S3.SS2.SSS1.p4.3.m3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3"><eq id="S3.SS2.SSS1.p4.3.m3.3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.3"></eq><apply id="S3.SS2.SSS1.p4.3.m3.3.3.4.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.4"><times id="S3.SS2.SSS1.p4.3.m3.3.3.4.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.1"></times><ci id="S3.SS2.SSS1.p4.3.m3.3.3.4.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.4.2">𝑓</ci><ci id="S3.SS2.SSS1.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1">𝑥</ci></apply><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2"><minus id="S3.SS2.SSS1.p4.3.m3.3.3.2.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.3"></minus><apply id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1"><times id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.2"></times><ci id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.3">𝑝</ci><apply id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.2.2.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2"><times id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.2"></times><ci id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.3">𝑞</ci><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3"><lt id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.3.3.2.2.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.3.m3.3c">f(x)=p(x|x_{&lt;i+c})-q(x|x_{&lt;i+c})</annotation></semantics></math> in <a href="#S3.E2" title="2 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 2</span></a>, and the numerator <math id="S3.SS2.SSS1.p4.4.m4.5" class="ltx_Math" alttext="a(x)=\max(0,f(x))" display="inline"><semantics id="S3.SS2.SSS1.p4.4.m4.5a"><mrow id="S3.SS2.SSS1.p4.4.m4.5.5" xref="S3.SS2.SSS1.p4.4.m4.5.5.cmml"><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.3" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.5.5.3.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.4.m4.5.5.3.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.3.3.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.3.3.2.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.cmml">(</mo><mi id="S3.SS2.SSS1.p4.4.m4.1.1" xref="S3.SS2.SSS1.p4.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.3.3.2.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p4.4.m4.5.5.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.1.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.3.3" xref="S3.SS2.SSS1.p4.4.m4.3.3.cmml">max</mi><mo id="S3.SS2.SSS1.p4.4.m4.5.5.1.1a" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml">(</mo><mn id="S3.SS2.SSS1.p4.4.m4.4.4" xref="S3.SS2.SSS1.p4.4.m4.4.4.cmml">0</mn><mo id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.3" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml">,</mo><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.3.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.3.2.1" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS1.p4.4.m4.2.2" xref="S3.SS2.SSS1.p4.4.m4.2.2.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.3.2.2" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.4" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.4.m4.5b"><apply id="S3.SS2.SSS1.p4.4.m4.5.5.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5"><eq id="S3.SS2.SSS1.p4.4.m4.5.5.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.2"></eq><apply id="S3.SS2.SSS1.p4.4.m4.5.5.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.3"><times id="S3.SS2.SSS1.p4.4.m4.5.5.3.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.1"></times><ci id="S3.SS2.SSS1.p4.4.m4.5.5.3.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.3.2">𝑎</ci><ci id="S3.SS2.SSS1.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1">𝑥</ci></apply><apply id="S3.SS2.SSS1.p4.4.m4.5.5.1.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1"><max id="S3.SS2.SSS1.p4.4.m4.3.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.3.3"></max><cn type="integer" id="S3.SS2.SSS1.p4.4.m4.4.4.cmml" xref="S3.SS2.SSS1.p4.4.m4.4.4">0</cn><apply id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1"><times id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.5.5.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.SSS1.p4.4.m4.2.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.4.m4.5c">a(x)=\max(0,f(x))</annotation></semantics></math> in <a href="#S3.E3" title="3 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 3</span></a> can be computed in element-wise fashion.
Their partial evaluations with the sub-vocabulary <math id="S3.SS2.SSS1.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS1.p4.5.m5.1a"><msub id="S3.SS2.SSS1.p4.5.m5.1.1" xref="S3.SS2.SSS1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.5.m5.1.1.2" xref="S3.SS2.SSS1.p4.5.m5.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p4.5.m5.1.1.3" xref="S3.SS2.SSS1.p4.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.5.m5.1b"><apply id="S3.SS2.SSS1.p4.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p4.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.5.m5.1c">\mathcal{V}_{k}</annotation></semantics></math>, denoted as <math id="S3.SS2.SSS1.p4.6.m6.1" class="ltx_Math" alttext="\tau_{c_{k}}(x)" display="inline"><semantics id="S3.SS2.SSS1.p4.6.m6.1a"><mrow id="S3.SS2.SSS1.p4.6.m6.1.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.cmml"><msub id="S3.SS2.SSS1.p4.6.m6.1.2.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.cmml"><mi id="S3.SS2.SSS1.p4.6.m6.1.2.2.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.2.cmml">τ</mi><msub id="S3.SS2.SSS1.p4.6.m6.1.2.2.3" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3.cmml"><mi id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3.2.cmml">c</mi><mi id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.3" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.6.m6.1.2.1" xref="S3.SS2.SSS1.p4.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.6.m6.1.2.3.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.6.m6.1.2.3.2.1" xref="S3.SS2.SSS1.p4.6.m6.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p4.6.m6.1.1" xref="S3.SS2.SSS1.p4.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.6.m6.1.2.3.2.2" xref="S3.SS2.SSS1.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.6.m6.1b"><apply id="S3.SS2.SSS1.p4.6.m6.1.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2"><times id="S3.SS2.SSS1.p4.6.m6.1.2.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.1"></times><apply id="S3.SS2.SSS1.p4.6.m6.1.2.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.6.m6.1.2.2.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p4.6.m6.1.2.2.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.2">𝜏</ci><apply id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3.2">𝑐</ci><ci id="S3.SS2.SSS1.p4.6.m6.1.2.2.3.3.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.SSS1.p4.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.6.m6.1c">\tau_{c_{k}}(x)</annotation></semantics></math>, <math id="S3.SS2.SSS1.p4.7.m7.1" class="ltx_Math" alttext="f_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p4.7.m7.1a"><mrow id="S3.SS2.SSS1.p4.7.m7.1.2" xref="S3.SS2.SSS1.p4.7.m7.1.2.cmml"><msub id="S3.SS2.SSS1.p4.7.m7.1.2.2" xref="S3.SS2.SSS1.p4.7.m7.1.2.2.cmml"><mi id="S3.SS2.SSS1.p4.7.m7.1.2.2.2" xref="S3.SS2.SSS1.p4.7.m7.1.2.2.2.cmml">f</mi><mi id="S3.SS2.SSS1.p4.7.m7.1.2.2.3" xref="S3.SS2.SSS1.p4.7.m7.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.7.m7.1.2.1" xref="S3.SS2.SSS1.p4.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.7.m7.1.2.3.2" xref="S3.SS2.SSS1.p4.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.7.m7.1.2.3.2.1" xref="S3.SS2.SSS1.p4.7.m7.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p4.7.m7.1.1" xref="S3.SS2.SSS1.p4.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.7.m7.1.2.3.2.2" xref="S3.SS2.SSS1.p4.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.7.m7.1b"><apply id="S3.SS2.SSS1.p4.7.m7.1.2.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2"><times id="S3.SS2.SSS1.p4.7.m7.1.2.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2.1"></times><apply id="S3.SS2.SSS1.p4.7.m7.1.2.2.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.7.m7.1.2.2.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p4.7.m7.1.2.2.2.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2.2.2">𝑓</ci><ci id="S3.SS2.SSS1.p4.7.m7.1.2.2.3.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p4.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.7.m7.1c">f_{k}(x)</annotation></semantics></math>, and <math id="S3.SS2.SSS1.p4.8.m8.1" class="ltx_Math" alttext="a_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p4.8.m8.1a"><mrow id="S3.SS2.SSS1.p4.8.m8.1.2" xref="S3.SS2.SSS1.p4.8.m8.1.2.cmml"><msub id="S3.SS2.SSS1.p4.8.m8.1.2.2" xref="S3.SS2.SSS1.p4.8.m8.1.2.2.cmml"><mi id="S3.SS2.SSS1.p4.8.m8.1.2.2.2" xref="S3.SS2.SSS1.p4.8.m8.1.2.2.2.cmml">a</mi><mi id="S3.SS2.SSS1.p4.8.m8.1.2.2.3" xref="S3.SS2.SSS1.p4.8.m8.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.8.m8.1.2.1" xref="S3.SS2.SSS1.p4.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.8.m8.1.2.3.2" xref="S3.SS2.SSS1.p4.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.8.m8.1.2.3.2.1" xref="S3.SS2.SSS1.p4.8.m8.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p4.8.m8.1.1" xref="S3.SS2.SSS1.p4.8.m8.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p4.8.m8.1.2.3.2.2" xref="S3.SS2.SSS1.p4.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.8.m8.1b"><apply id="S3.SS2.SSS1.p4.8.m8.1.2.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2"><times id="S3.SS2.SSS1.p4.8.m8.1.2.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2.1"></times><apply id="S3.SS2.SSS1.p4.8.m8.1.2.2.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.8.m8.1.2.2.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p4.8.m8.1.2.2.2.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2.2.2">𝑎</ci><ci id="S3.SS2.SSS1.p4.8.m8.1.2.2.3.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p4.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.8.m8.1c">a_{k}(x)</annotation></semantics></math>, respectively, do not require any synchronization between threads and blocks, thus allowing fast parallel computation.
The denominator in <a href="#S3.E3" title="3 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 3</span></a>, <math id="S3.SS2.SSS1.p4.9.m9.1" class="ltx_math_unparsed" alttext="b=\sum_{x^{\prime}\in\mathcal{V}}\max(0,f(x^{\prime})" display="inline"><semantics id="S3.SS2.SSS1.p4.9.m9.1a"><mrow id="S3.SS2.SSS1.p4.9.m9.1b"><mi id="S3.SS2.SSS1.p4.9.m9.1.2">b</mi><mo rspace="0.111em" id="S3.SS2.SSS1.p4.9.m9.1.3">=</mo><msub id="S3.SS2.SSS1.p4.9.m9.1.4"><mo id="S3.SS2.SSS1.p4.9.m9.1.4.2">∑</mo><mrow id="S3.SS2.SSS1.p4.9.m9.1.4.3"><msup id="S3.SS2.SSS1.p4.9.m9.1.4.3.2"><mi id="S3.SS2.SSS1.p4.9.m9.1.4.3.2.2">x</mi><mo id="S3.SS2.SSS1.p4.9.m9.1.4.3.2.3">′</mo></msup><mo id="S3.SS2.SSS1.p4.9.m9.1.4.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.9.m9.1.4.3.3">𝒱</mi></mrow></msub><mi id="S3.SS2.SSS1.p4.9.m9.1.5">max</mi><mrow id="S3.SS2.SSS1.p4.9.m9.1.6"><mo stretchy="false" id="S3.SS2.SSS1.p4.9.m9.1.6.1">(</mo><mn id="S3.SS2.SSS1.p4.9.m9.1.1">0</mn><mo id="S3.SS2.SSS1.p4.9.m9.1.6.2">,</mo><mi id="S3.SS2.SSS1.p4.9.m9.1.6.3">f</mi><mrow id="S3.SS2.SSS1.p4.9.m9.1.6.4"><mo stretchy="false" id="S3.SS2.SSS1.p4.9.m9.1.6.4.1">(</mo><msup id="S3.SS2.SSS1.p4.9.m9.1.6.4.2"><mi id="S3.SS2.SSS1.p4.9.m9.1.6.4.2.2">x</mi><mo id="S3.SS2.SSS1.p4.9.m9.1.6.4.2.3">′</mo></msup><mo stretchy="false" id="S3.SS2.SSS1.p4.9.m9.1.6.4.3">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.9.m9.1c">b=\sum_{x^{\prime}\in\mathcal{V}}\max(0,f(x^{\prime})</annotation></semantics></math>, requires a reduction across all elements in the vocabulary <math id="S3.SS2.SSS1.p4.10.m10.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS2.SSS1.p4.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.10.m10.1.1" xref="S3.SS2.SSS1.p4.10.m10.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.10.m10.1b"><ci id="S3.SS2.SSS1.p4.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.10.m10.1c">\mathcal{V}</annotation></semantics></math> and is more challenging to fully compute in parallel, due to its dependency on other thread blocks.
We use parallel reduction <cite class="ltx_cite ltx_citemacro_cite">Harris (<a href="#bib.bib22" title="" class="ltx_ref">2007</a>)</cite> to compute the partial sum <math id="S3.SS2.SSS1.p4.11.m11.3" class="ltx_Math" alttext="b_{k}=\sum_{x^{\prime}\in\mathcal{V}_{k}}\max(0,f(x^{\prime}))" display="inline"><semantics id="S3.SS2.SSS1.p4.11.m11.3a"><mrow id="S3.SS2.SSS1.p4.11.m11.3.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.cmml"><msub id="S3.SS2.SSS1.p4.11.m11.3.3.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.3.cmml"><mi id="S3.SS2.SSS1.p4.11.m11.3.3.3.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.3.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.11.m11.3.3.3.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.3.3.cmml">k</mi></msub><mo rspace="0.111em" id="S3.SS2.SSS1.p4.11.m11.3.3.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.cmml"><msub id="S3.SS2.SSS1.p4.11.m11.3.3.1.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.cmml"><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.cmml"><msup id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.cmml"><mi id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.2.cmml">x</mi><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.1.cmml">∈</mo><msub id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.3.cmml">k</mi></msub></mrow></msub><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml"><mi id="S3.SS2.SSS1.p4.11.m11.1.1" xref="S3.SS2.SSS1.p4.11.m11.1.1.cmml">max</mi><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1a" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml">(</mo><mn id="S3.SS2.SSS1.p4.11.m11.2.2" xref="S3.SS2.SSS1.p4.11.m11.2.2.cmml">0</mn><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml">,</mo><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.4" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.11.m11.3b"><apply id="S3.SS2.SSS1.p4.11.m11.3.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3"><eq id="S3.SS2.SSS1.p4.11.m11.3.3.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.2"></eq><apply id="S3.SS2.SSS1.p4.11.m11.3.3.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.11.m11.3.3.3.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.11.m11.3.3.3.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.3.2">𝑏</ci><ci id="S3.SS2.SSS1.p4.11.m11.3.3.3.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.3.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1"><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2">subscript</csymbol><sum id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.2"></sum><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3"><in id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.1"></in><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2">superscript</csymbol><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.2">𝑥</ci><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.2.3">′</ci></apply><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.2">𝒱</ci><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1"><max id="S3.SS2.SSS1.p4.11.m11.1.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.1.1"></max><cn type="integer" id="S3.SS2.SSS1.p4.11.m11.2.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.2.2">0</cn><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1"><times id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.2"></times><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.3">𝑓</ci><apply id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.11.m11.3.3.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.11.m11.3c">b_{k}=\sum_{x^{\prime}\in\mathcal{V}_{k}}\max(0,f(x^{\prime}))</annotation></semantics></math> of the denominator with the sub-vocabulary <math id="S3.SS2.SSS1.p4.12.m12.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS1.p4.12.m12.1a"><msub id="S3.SS2.SSS1.p4.12.m12.1.1" xref="S3.SS2.SSS1.p4.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.12.m12.1.1.2" xref="S3.SS2.SSS1.p4.12.m12.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.p4.12.m12.1.1.3" xref="S3.SS2.SSS1.p4.12.m12.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.12.m12.1b"><apply id="S3.SS2.SSS1.p4.12.m12.1.1.cmml" xref="S3.SS2.SSS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.12.m12.1.1.1.cmml" xref="S3.SS2.SSS1.p4.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.12.m12.1.1.2.cmml" xref="S3.SS2.SSS1.p4.12.m12.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.p4.12.m12.1.1.3.cmml" xref="S3.SS2.SSS1.p4.12.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.12.m12.1c">\mathcal{V}_{k}</annotation></semantics></math> in SRAM, and perform the final aggregation across blocks in the subsequent procedure on HBM.</p>
</div>
<div id="S3.SS2.SSS1.p5" class="ltx_para">
<svg id="S3.SS2.SSS1.p5.pic1" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#DAE8FC" stroke="#6C8EBF"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS1.p5.pic1.1.1.1.1.1" class="ltx_text ltx_font_bold">3</span></foreignObject></g></g></svg>
<p id="S3.SS2.SSS1.p5.6" class="ltx_p">The partial results, <math id="S3.SS2.SSS1.p5.1.m1.1" class="ltx_Math" alttext="\tau_{c_{k}}" display="inline"><semantics id="S3.SS2.SSS1.p5.1.m1.1a"><msub id="S3.SS2.SSS1.p5.1.m1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.1.m1.1.1.2" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml">τ</mi><msub id="S3.SS2.SSS1.p5.1.m1.1.1.3" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p5.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS1.p5.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.1.m1.1b"><apply id="S3.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2">𝜏</ci><apply id="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS1.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.1.m1.1c">\tau_{c_{k}}</annotation></semantics></math>, <math id="S3.SS2.SSS1.p5.2.m2.1" class="ltx_Math" alttext="a_{k}(x)" display="inline"><semantics id="S3.SS2.SSS1.p5.2.m2.1a"><mrow id="S3.SS2.SSS1.p5.2.m2.1.2" xref="S3.SS2.SSS1.p5.2.m2.1.2.cmml"><msub id="S3.SS2.SSS1.p5.2.m2.1.2.2" xref="S3.SS2.SSS1.p5.2.m2.1.2.2.cmml"><mi id="S3.SS2.SSS1.p5.2.m2.1.2.2.2" xref="S3.SS2.SSS1.p5.2.m2.1.2.2.2.cmml">a</mi><mi id="S3.SS2.SSS1.p5.2.m2.1.2.2.3" xref="S3.SS2.SSS1.p5.2.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p5.2.m2.1.2.1" xref="S3.SS2.SSS1.p5.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p5.2.m2.1.2.3.2" xref="S3.SS2.SSS1.p5.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p5.2.m2.1.2.3.2.1" xref="S3.SS2.SSS1.p5.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p5.2.m2.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p5.2.m2.1.2.3.2.2" xref="S3.SS2.SSS1.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.2.m2.1b"><apply id="S3.SS2.SSS1.p5.2.m2.1.2.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2"><times id="S3.SS2.SSS1.p5.2.m2.1.2.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2.1"></times><apply id="S3.SS2.SSS1.p5.2.m2.1.2.2.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p5.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2.2.2">𝑎</ci><ci id="S3.SS2.SSS1.p5.2.m2.1.2.2.3.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.2.m2.1c">a_{k}(x)</annotation></semantics></math>, and <math id="S3.SS2.SSS1.p5.3.m3.1" class="ltx_Math" alttext="b_{k}" display="inline"><semantics id="S3.SS2.SSS1.p5.3.m3.1a"><msub id="S3.SS2.SSS1.p5.3.m3.1.1" xref="S3.SS2.SSS1.p5.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p5.3.m3.1.1.2" xref="S3.SS2.SSS1.p5.3.m3.1.1.2.cmml">b</mi><mi id="S3.SS2.SSS1.p5.3.m3.1.1.3" xref="S3.SS2.SSS1.p5.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.3.m3.1b"><apply id="S3.SS2.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1.2">𝑏</ci><ci id="S3.SS2.SSS1.p5.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.3.m3.1c">b_{k}</annotation></semantics></math>, are written back to HBM.
The partial sum <math id="S3.SS2.SSS1.p5.4.m4.1" class="ltx_Math" alttext="b_{k}" display="inline"><semantics id="S3.SS2.SSS1.p5.4.m4.1a"><msub id="S3.SS2.SSS1.p5.4.m4.1.1" xref="S3.SS2.SSS1.p5.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p5.4.m4.1.1.2" xref="S3.SS2.SSS1.p5.4.m4.1.1.2.cmml">b</mi><mi id="S3.SS2.SSS1.p5.4.m4.1.1.3" xref="S3.SS2.SSS1.p5.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.4.m4.1b"><apply id="S3.SS2.SSS1.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1.2">𝑏</ci><ci id="S3.SS2.SSS1.p5.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.4.m4.1c">b_{k}</annotation></semantics></math> is now combined with the partial sums from other thread blocks to compute the full sum <math id="S3.SS2.SSS1.p5.5.m5.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS2.SSS1.p5.5.m5.1a"><mi id="S3.SS2.SSS1.p5.5.m5.1.1" xref="S3.SS2.SSS1.p5.5.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.5.m5.1b"><ci id="S3.SS2.SSS1.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p5.5.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.5.m5.1c">b</annotation></semantics></math>.
The final division operation to compute <math id="S3.SS2.SSS1.p5.6.m6.2" class="ltx_Math" alttext="\texttt{max\_norm}(f(x))" display="inline"><semantics id="S3.SS2.SSS1.p5.6.m6.2a"><mrow id="S3.SS2.SSS1.p5.6.m6.2.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS2.SSS1.p5.6.m6.2.2.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.3a.cmml">max_norm</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p5.6.m6.2.2.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.1.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.3.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.3.2.1" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS1.p5.6.m6.1.1" xref="S3.SS2.SSS1.p5.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.3.2.2" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.3" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.6.m6.2b"><apply id="S3.SS2.SSS1.p5.6.m6.2.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2"><times id="S3.SS2.SSS1.p5.6.m6.2.2.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.2"></times><ci id="S3.SS2.SSS1.p5.6.m6.2.2.3a.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.SS2.SSS1.p5.6.m6.2.2.3.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.3">max_norm</mtext></ci><apply id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1"><times id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.1"></times><ci id="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.6.m6.2.2.1.1.1.2">𝑓</ci><ci id="S3.SS2.SSS1.p5.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m6.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.6.m6.2c">\texttt{max\_norm}(f(x))</annotation></semantics></math> in <a href="#S3.E3" title="3 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 3</span></a> and the resampling procedure in <a href="#S3.E2" title="2 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 2</span></a> are done once all the partial results are aggregated.</p>
</div>
<div id="S3.SS2.SSS1.p6" class="ltx_para">
<p id="S3.SS2.SSS1.p6.2" class="ltx_p">By reorganizing the computations as illustrated in <a href="#S3.F1" title="Figure 1 ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 1</span></a>, batches of <math id="S3.SS2.SSS1.p6.1.m1.1" class="ltx_Math" alttext="p({x}|{x}_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS1.p6.1.m1.1a"><mrow id="S3.SS2.SSS1.p6.1.m1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p6.1.m1.1.1.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p6.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p6.1.m1.1b"><apply id="S3.SS2.SSS1.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1"><times id="S3.SS2.SSS1.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.2"></times><ci id="S3.SS2.SSS1.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.3">𝑝</ci><apply id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p6.1.m1.1c">p({x}|{x}_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS1.p6.2.m2.1" class="ltx_Math" alttext="q({x}|{x}_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS1.p6.2.m2.1a"><mrow id="S3.SS2.SSS1.p6.2.m2.1.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p6.2.m2.1.1.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p6.2.m2.1.1.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p6.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.3" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p6.2.m2.1b"><apply id="S3.SS2.SSS1.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1"><times id="S3.SS2.SSS1.p6.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.2"></times><ci id="S3.SS2.SSS1.p6.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.3">𝑞</ci><apply id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p6.2.m2.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p6.2.m2.1c">q({x}|{x}_{&lt;i+c})</annotation></semantics></math> are <em id="S3.SS2.SSS1.p6.2.1" class="ltx_emph ltx_font_italic">loaded only once</em> from HBM into SRAM.
Moreover, most operations are coupled within the kernel and performed in parallel while using fast SRAM to store intermediate values.
Only the results necessary to produce token acceptance decisions are written to HBM.
Therefore, read and write operations across the memory hierarchy are minimized, enabling faster speculative sampling.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Approximated optimization</h4>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2406.11016/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="118" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the computations within each thread block for sigmoid approximation. Each set of logits is scaled by a minimum constant <math id="S3.F2.11.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.11.m1.1b"><mi id="S3.F2.11.m1.1.1" xref="S3.F2.11.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.11.m1.1c"><ci id="S3.F2.11.m1.1.1.cmml" xref="S3.F2.11.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.m1.1d">\alpha</annotation></semantics></math> and a maximum constant <math id="S3.F2.12.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.F2.12.m2.1b"><mi id="S3.F2.12.m2.1.1" xref="S3.F2.12.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.F2.12.m2.1c"><ci id="S3.F2.12.m2.1.1.cmml" xref="S3.F2.12.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m2.1d">\beta</annotation></semantics></math>.
Sigmoid activations <math id="S3.F2.13.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.F2.13.m3.1b"><mi id="S3.F2.13.m3.1.1" xref="S3.F2.13.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F2.13.m3.1c"><ci id="S3.F2.13.m3.1.1.cmml" xref="S3.F2.13.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.13.m3.1d">\sigma</annotation></semantics></math> are then computed and stored in SRAM for each segment of draft and target logits.
Subsequently, the intermediate values <math id="S3.F2.14.m4.1" class="ltx_Math" alttext="\hat{f}_{k}" display="inline"><semantics id="S3.F2.14.m4.1b"><msub id="S3.F2.14.m4.1.1" xref="S3.F2.14.m4.1.1.cmml"><mover accent="true" id="S3.F2.14.m4.1.1.2" xref="S3.F2.14.m4.1.1.2.cmml"><mi id="S3.F2.14.m4.1.1.2.2" xref="S3.F2.14.m4.1.1.2.2.cmml">f</mi><mo id="S3.F2.14.m4.1.1.2.1" xref="S3.F2.14.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.F2.14.m4.1.1.3" xref="S3.F2.14.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.14.m4.1c"><apply id="S3.F2.14.m4.1.1.cmml" xref="S3.F2.14.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.14.m4.1.1.1.cmml" xref="S3.F2.14.m4.1.1">subscript</csymbol><apply id="S3.F2.14.m4.1.1.2.cmml" xref="S3.F2.14.m4.1.1.2"><ci id="S3.F2.14.m4.1.1.2.1.cmml" xref="S3.F2.14.m4.1.1.2.1">^</ci><ci id="S3.F2.14.m4.1.1.2.2.cmml" xref="S3.F2.14.m4.1.1.2.2">𝑓</ci></apply><ci id="S3.F2.14.m4.1.1.3.cmml" xref="S3.F2.14.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.14.m4.1d">\hat{f}_{k}</annotation></semantics></math>, <math id="S3.F2.15.m5.1" class="ltx_Math" alttext="\hat{a}_{k}" display="inline"><semantics id="S3.F2.15.m5.1b"><msub id="S3.F2.15.m5.1.1" xref="S3.F2.15.m5.1.1.cmml"><mover accent="true" id="S3.F2.15.m5.1.1.2" xref="S3.F2.15.m5.1.1.2.cmml"><mi id="S3.F2.15.m5.1.1.2.2" xref="S3.F2.15.m5.1.1.2.2.cmml">a</mi><mo id="S3.F2.15.m5.1.1.2.1" xref="S3.F2.15.m5.1.1.2.1.cmml">^</mo></mover><mi id="S3.F2.15.m5.1.1.3" xref="S3.F2.15.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.15.m5.1c"><apply id="S3.F2.15.m5.1.1.cmml" xref="S3.F2.15.m5.1.1"><csymbol cd="ambiguous" id="S3.F2.15.m5.1.1.1.cmml" xref="S3.F2.15.m5.1.1">subscript</csymbol><apply id="S3.F2.15.m5.1.1.2.cmml" xref="S3.F2.15.m5.1.1.2"><ci id="S3.F2.15.m5.1.1.2.1.cmml" xref="S3.F2.15.m5.1.1.2.1">^</ci><ci id="S3.F2.15.m5.1.1.2.2.cmml" xref="S3.F2.15.m5.1.1.2.2">𝑎</ci></apply><ci id="S3.F2.15.m5.1.1.3.cmml" xref="S3.F2.15.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.15.m5.1d">\hat{a}_{k}</annotation></semantics></math>, <math id="S3.F2.16.m6.1" class="ltx_Math" alttext="\hat{b}_{k}" display="inline"><semantics id="S3.F2.16.m6.1b"><msub id="S3.F2.16.m6.1.1" xref="S3.F2.16.m6.1.1.cmml"><mover accent="true" id="S3.F2.16.m6.1.1.2" xref="S3.F2.16.m6.1.1.2.cmml"><mi id="S3.F2.16.m6.1.1.2.2" xref="S3.F2.16.m6.1.1.2.2.cmml">b</mi><mo id="S3.F2.16.m6.1.1.2.1" xref="S3.F2.16.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.F2.16.m6.1.1.3" xref="S3.F2.16.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.16.m6.1c"><apply id="S3.F2.16.m6.1.1.cmml" xref="S3.F2.16.m6.1.1"><csymbol cd="ambiguous" id="S3.F2.16.m6.1.1.1.cmml" xref="S3.F2.16.m6.1.1">subscript</csymbol><apply id="S3.F2.16.m6.1.1.2.cmml" xref="S3.F2.16.m6.1.1.2"><ci id="S3.F2.16.m6.1.1.2.1.cmml" xref="S3.F2.16.m6.1.1.2.1">^</ci><ci id="S3.F2.16.m6.1.1.2.2.cmml" xref="S3.F2.16.m6.1.1.2.2">𝑏</ci></apply><ci id="S3.F2.16.m6.1.1.3.cmml" xref="S3.F2.16.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.16.m6.1d">\hat{b}_{k}</annotation></semantics></math>, and <math id="S3.F2.17.m7.1" class="ltx_Math" alttext="\hat{\tau}_{c_{k}}" display="inline"><semantics id="S3.F2.17.m7.1b"><msub id="S3.F2.17.m7.1.1" xref="S3.F2.17.m7.1.1.cmml"><mover accent="true" id="S3.F2.17.m7.1.1.2" xref="S3.F2.17.m7.1.1.2.cmml"><mi id="S3.F2.17.m7.1.1.2.2" xref="S3.F2.17.m7.1.1.2.2.cmml">τ</mi><mo id="S3.F2.17.m7.1.1.2.1" xref="S3.F2.17.m7.1.1.2.1.cmml">^</mo></mover><msub id="S3.F2.17.m7.1.1.3" xref="S3.F2.17.m7.1.1.3.cmml"><mi id="S3.F2.17.m7.1.1.3.2" xref="S3.F2.17.m7.1.1.3.2.cmml">c</mi><mi id="S3.F2.17.m7.1.1.3.3" xref="S3.F2.17.m7.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.F2.17.m7.1c"><apply id="S3.F2.17.m7.1.1.cmml" xref="S3.F2.17.m7.1.1"><csymbol cd="ambiguous" id="S3.F2.17.m7.1.1.1.cmml" xref="S3.F2.17.m7.1.1">subscript</csymbol><apply id="S3.F2.17.m7.1.1.2.cmml" xref="S3.F2.17.m7.1.1.2"><ci id="S3.F2.17.m7.1.1.2.1.cmml" xref="S3.F2.17.m7.1.1.2.1">^</ci><ci id="S3.F2.17.m7.1.1.2.2.cmml" xref="S3.F2.17.m7.1.1.2.2">𝜏</ci></apply><apply id="S3.F2.17.m7.1.1.3.cmml" xref="S3.F2.17.m7.1.1.3"><csymbol cd="ambiguous" id="S3.F2.17.m7.1.1.3.1.cmml" xref="S3.F2.17.m7.1.1.3">subscript</csymbol><ci id="S3.F2.17.m7.1.1.3.2.cmml" xref="S3.F2.17.m7.1.1.3.2">𝑐</ci><ci id="S3.F2.17.m7.1.1.3.3.cmml" xref="S3.F2.17.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.17.m7.1d">\hat{\tau}_{c_{k}}</annotation></semantics></math> are computed analogous to <a href="#S3.F1" title="Figure 1 ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 1</span></a>.
The resulting outputs are then used to update <math id="S3.F2.18.m8.1" class="ltx_Math" alttext="\hat{\tau}_{c}" display="inline"><semantics id="S3.F2.18.m8.1b"><msub id="S3.F2.18.m8.1.1" xref="S3.F2.18.m8.1.1.cmml"><mover accent="true" id="S3.F2.18.m8.1.1.2" xref="S3.F2.18.m8.1.1.2.cmml"><mi id="S3.F2.18.m8.1.1.2.2" xref="S3.F2.18.m8.1.1.2.2.cmml">τ</mi><mo id="S3.F2.18.m8.1.1.2.1" xref="S3.F2.18.m8.1.1.2.1.cmml">^</mo></mover><mi id="S3.F2.18.m8.1.1.3" xref="S3.F2.18.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.18.m8.1c"><apply id="S3.F2.18.m8.1.1.cmml" xref="S3.F2.18.m8.1.1"><csymbol cd="ambiguous" id="S3.F2.18.m8.1.1.1.cmml" xref="S3.F2.18.m8.1.1">subscript</csymbol><apply id="S3.F2.18.m8.1.1.2.cmml" xref="S3.F2.18.m8.1.1.2"><ci id="S3.F2.18.m8.1.1.2.1.cmml" xref="S3.F2.18.m8.1.1.2.1">^</ci><ci id="S3.F2.18.m8.1.1.2.2.cmml" xref="S3.F2.18.m8.1.1.2.2">𝜏</ci></apply><ci id="S3.F2.18.m8.1.1.3.cmml" xref="S3.F2.18.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.18.m8.1d">\hat{\tau}_{c}</annotation></semantics></math>, <math id="S3.F2.19.m9.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="S3.F2.19.m9.1b"><mover accent="true" id="S3.F2.19.m9.1.1" xref="S3.F2.19.m9.1.1.cmml"><mi id="S3.F2.19.m9.1.1.2" xref="S3.F2.19.m9.1.1.2.cmml">a</mi><mo id="S3.F2.19.m9.1.1.1" xref="S3.F2.19.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.19.m9.1c"><apply id="S3.F2.19.m9.1.1.cmml" xref="S3.F2.19.m9.1.1"><ci id="S3.F2.19.m9.1.1.1.cmml" xref="S3.F2.19.m9.1.1.1">^</ci><ci id="S3.F2.19.m9.1.1.2.cmml" xref="S3.F2.19.m9.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.19.m9.1d">\hat{a}</annotation></semantics></math>, and <math id="S3.F2.20.m10.1" class="ltx_Math" alttext="\hat{b}" display="inline"><semantics id="S3.F2.20.m10.1b"><mover accent="true" id="S3.F2.20.m10.1.1" xref="S3.F2.20.m10.1.1.cmml"><mi id="S3.F2.20.m10.1.1.2" xref="S3.F2.20.m10.1.1.2.cmml">b</mi><mo id="S3.F2.20.m10.1.1.1" xref="S3.F2.20.m10.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.20.m10.1c"><apply id="S3.F2.20.m10.1.1.cmml" xref="S3.F2.20.m10.1.1"><ci id="S3.F2.20.m10.1.1.1.cmml" xref="S3.F2.20.m10.1.1.1">^</ci><ci id="S3.F2.20.m10.1.1.2.cmml" xref="S3.F2.20.m10.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.20.m10.1d">\hat{b}</annotation></semantics></math> in HBM.</figcaption>
</figure>
<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.4" class="ltx_p">To further accelerate speculative sampling, we use sigmoid to approximate <math id="S3.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="p(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><times id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2"></times><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑝</ci><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">p(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="q(x|x_{i+c})" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mrow id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><times id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2"></times><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑞</ci><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3"><plus id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">q(x|x_{i+c})</annotation></semantics></math>, which are parameterized by softmax in the baseline implementation and the exact method described in <a href="#S3.SS2.SSS1" title="3.2.1 Exact optimization ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">§ 3.2.1</span></a>.
Instead of treating <math id="S3.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="p(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><times id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2"></times><ci id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">𝑝</ci><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">p(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="q(x|x_{i+c})" display="inline"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p1.4.m4.1.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1"><times id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2"></times><ci id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.3">𝑞</ci><apply id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3"><plus id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">q(x|x_{i+c})</annotation></semantics></math> as precomputed inputs to the kernel, the sigmoid approximation is tightly coupled with the other operations in the speculative sampling process. This integration within the kernel substantially accelerates the overall sampling procedure.</p>
</div>
<section id="S3.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Bottleneck of softmax.</h5>

<div id="S3.SS2.SSS2.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px1.p1.1" class="ltx_p">For any given input vector <math id="S3.SS2.SSS2.Px1.p1.1.m1.4" class="ltx_Math" alttext="\mathbf{w}=(w_{1},\ldots,w_{\lvert\mathcal{V}\rvert})" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.4a"><mrow id="S3.SS2.SSS2.Px1.p1.1.m1.4.4" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.cmml"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.4" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.4.cmml">𝐰</mi><mo id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.3.cmml">=</mo><mrow id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.2.cmml">w</mi><mn id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.4" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.5" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.2.cmml">w</mi><mrow id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.6" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.4b"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4"><eq id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.3"></eq><ci id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.4">𝐰</ci><vector id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2">…</ci><apply id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.4.4.2.2.2.2">𝑤</ci><apply id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.3"><abs id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1">𝒱</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.4c">\mathbf{w}=(w_{1},\ldots,w_{\lvert\mathcal{V}\rvert})</annotation></semantics></math>, the outputs must be positive and they must sum to unity to be interpretable as a probability distribution <cite class="ltx_cite ltx_citemacro_cite">Bridle (<a href="#bib.bib7" title="" class="ltx_ref">1989</a>)</cite>.
In softmax, both conditions are satisfied via a normalized exponential transformation.
With limited value ranges that can be represented in hardware, softmax is prone to overflow or underflow due to the exponentiation.
Therefore, a numerically stable version is often used <cite class="ltx_cite ltx_citemacro_cite">Milakov and Gimelshein (<a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.6" class="ltx_Math" alttext="\texttt{softmax}(\mathbf{w})_{j}=\frac{\exp\left(w_{j}-w_{\texttt{max}}\right)}{\sum_{l=1}^{\lvert\mathcal{V}\rvert}\exp(w_{l}-w_{\texttt{max}})}" display="block"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.7" xref="S3.E4.m1.6.7.cmml"><mrow id="S3.E4.m1.6.7.2" xref="S3.E4.m1.6.7.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.6.7.2.2" xref="S3.E4.m1.6.7.2.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.7.2.1" xref="S3.E4.m1.6.7.2.1.cmml">​</mo><msub id="S3.E4.m1.6.7.2.3" xref="S3.E4.m1.6.7.2.3.cmml"><mrow id="S3.E4.m1.6.7.2.3.2.2" xref="S3.E4.m1.6.7.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.6.7.2.3.2.2.1" xref="S3.E4.m1.6.7.2.3.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">𝐰</mi><mo stretchy="false" id="S3.E4.m1.6.7.2.3.2.2.2" xref="S3.E4.m1.6.7.2.3.cmml">)</mo></mrow><mi id="S3.E4.m1.6.7.2.3.3" xref="S3.E4.m1.6.7.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E4.m1.6.7.1" xref="S3.E4.m1.6.7.1.cmml">=</mo><mfrac id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E4.m1.2.2.2.2a" xref="S3.E4.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.3.cmml"><mo id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.2.2" xref="S3.E4.m1.2.2.2.2.1.1.2.2.cmml">w</mi><mi id="S3.E4.m1.2.2.2.2.1.1.2.3" xref="S3.E4.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.2.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.2.1.1.1.cmml">−</mo><msub id="S3.E4.m1.2.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.3.2" xref="S3.E4.m1.2.2.2.2.1.1.3.2.cmml">w</mi><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.2.2.2.2.1.1.3.3" xref="S3.E4.m1.2.2.2.2.1.1.3.3a.cmml">max</mtext></msub></mrow><mo id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.5.5.5" xref="S3.E4.m1.5.5.5.cmml"><msubsup id="S3.E4.m1.5.5.5.4" xref="S3.E4.m1.5.5.5.4.cmml"><mo id="S3.E4.m1.5.5.5.4.2.2" xref="S3.E4.m1.5.5.5.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.5.4.2.3" xref="S3.E4.m1.5.5.5.4.2.3.cmml"><mi id="S3.E4.m1.5.5.5.4.2.3.2" xref="S3.E4.m1.5.5.5.4.2.3.2.cmml">l</mi><mo id="S3.E4.m1.5.5.5.4.2.3.1" xref="S3.E4.m1.5.5.5.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.5.5.5.4.2.3.3" xref="S3.E4.m1.5.5.5.4.2.3.3.cmml">1</mn></mrow><mrow id="S3.E4.m1.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.1.1.3.1" xref="S3.E4.m1.3.3.3.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.1.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.E4.m1.3.3.3.1.1.3.2" xref="S3.E4.m1.3.3.3.1.1.2.1.cmml">|</mo></mrow></msubsup><mrow id="S3.E4.m1.5.5.5.3.1" xref="S3.E4.m1.5.5.5.3.2.cmml"><mi id="S3.E4.m1.4.4.4.2" xref="S3.E4.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E4.m1.5.5.5.3.1a" xref="S3.E4.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.5.3.1.1" xref="S3.E4.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.5.3.1.1.2" xref="S3.E4.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E4.m1.5.5.5.3.1.1.1" xref="S3.E4.m1.5.5.5.3.1.1.1.cmml"><msub id="S3.E4.m1.5.5.5.3.1.1.1.2" xref="S3.E4.m1.5.5.5.3.1.1.1.2.cmml"><mi id="S3.E4.m1.5.5.5.3.1.1.1.2.2" xref="S3.E4.m1.5.5.5.3.1.1.1.2.2.cmml">w</mi><mi id="S3.E4.m1.5.5.5.3.1.1.1.2.3" xref="S3.E4.m1.5.5.5.3.1.1.1.2.3.cmml">l</mi></msub><mo id="S3.E4.m1.5.5.5.3.1.1.1.1" xref="S3.E4.m1.5.5.5.3.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.5.5.5.3.1.1.1.3" xref="S3.E4.m1.5.5.5.3.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.5.3.1.1.1.3.2" xref="S3.E4.m1.5.5.5.3.1.1.1.3.2.cmml">w</mi><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.5.5.5.3.1.1.1.3.3" xref="S3.E4.m1.5.5.5.3.1.1.1.3.3a.cmml">max</mtext></msub></mrow><mo stretchy="false" id="S3.E4.m1.5.5.5.3.1.1.3" xref="S3.E4.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.7.cmml" xref="S3.E4.m1.6.7"><eq id="S3.E4.m1.6.7.1.cmml" xref="S3.E4.m1.6.7.1"></eq><apply id="S3.E4.m1.6.7.2.cmml" xref="S3.E4.m1.6.7.2"><times id="S3.E4.m1.6.7.2.1.cmml" xref="S3.E4.m1.6.7.2.1"></times><ci id="S3.E4.m1.6.7.2.2a.cmml" xref="S3.E4.m1.6.7.2.2"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.6.7.2.2.cmml" xref="S3.E4.m1.6.7.2.2">softmax</mtext></ci><apply id="S3.E4.m1.6.7.2.3.cmml" xref="S3.E4.m1.6.7.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.7.2.3.1.cmml" xref="S3.E4.m1.6.7.2.3">subscript</csymbol><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝐰</ci><ci id="S3.E4.m1.6.7.2.3.3.cmml" xref="S3.E4.m1.6.7.2.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><divide id="S3.E4.m1.5.5.6.cmml" xref="S3.E4.m1.5.5"></divide><apply id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><exp id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"></exp><apply id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"><minus id="S3.E4.m1.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1"></minus><apply id="S3.E4.m1.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2">𝑤</ci><ci id="S3.E4.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.E4.m1.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3.2">𝑤</ci><ci id="S3.E4.m1.2.2.2.2.1.1.3.3a.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E4.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3.3">max</mtext></ci></apply></apply></apply><apply id="S3.E4.m1.5.5.5.cmml" xref="S3.E4.m1.5.5.5"><apply id="S3.E4.m1.5.5.5.4.cmml" xref="S3.E4.m1.5.5.5.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.4.1.cmml" xref="S3.E4.m1.5.5.5.4">superscript</csymbol><apply id="S3.E4.m1.5.5.5.4.2.cmml" xref="S3.E4.m1.5.5.5.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.4.2.1.cmml" xref="S3.E4.m1.5.5.5.4">subscript</csymbol><sum id="S3.E4.m1.5.5.5.4.2.2.cmml" xref="S3.E4.m1.5.5.5.4.2.2"></sum><apply id="S3.E4.m1.5.5.5.4.2.3.cmml" xref="S3.E4.m1.5.5.5.4.2.3"><eq id="S3.E4.m1.5.5.5.4.2.3.1.cmml" xref="S3.E4.m1.5.5.5.4.2.3.1"></eq><ci id="S3.E4.m1.5.5.5.4.2.3.2.cmml" xref="S3.E4.m1.5.5.5.4.2.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.5.5.5.4.2.3.3.cmml" xref="S3.E4.m1.5.5.5.4.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.3.1.1.3"><abs id="S3.E4.m1.3.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.3.1.1.3.1"></abs><ci id="S3.E4.m1.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1.1">𝒱</ci></apply></apply><apply id="S3.E4.m1.5.5.5.3.2.cmml" xref="S3.E4.m1.5.5.5.3.1"><exp id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.2"></exp><apply id="S3.E4.m1.5.5.5.3.1.1.1.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1"><minus id="S3.E4.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.1"></minus><apply id="S3.E4.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.2.2">𝑤</ci><ci id="S3.E4.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E4.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.3.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.5.3.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.3.2">𝑤</ci><ci id="S3.E4.m1.5.5.5.3.1.1.1.3.3a.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E4.m1.5.5.5.3.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.5.3.1.1.1.3.3">max</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">\texttt{softmax}(\mathbf{w})_{j}=\frac{\exp\left(w_{j}-w_{\texttt{max}}\right)}{\sum_{l=1}^{\lvert\mathcal{V}\rvert}\exp(w_{l}-w_{\texttt{max}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px1.p1.5" class="ltx_p">for <math id="S3.SS2.SSS2.Px1.p1.2.m1.4" class="ltx_Math" alttext="j=1,\ldots,\lvert\mathcal{V}\rvert" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.2.m1.4a"><mrow id="S3.SS2.SSS2.Px1.p1.2.m1.4.4" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.cmml"><mi id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.3" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.3.cmml">j</mi><mo id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.2" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.2.cmml">=</mo><mrow id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.2.cmml"><mn id="S3.SS2.SSS2.Px1.p1.2.m1.2.2" xref="S3.SS2.SSS2.Px1.p1.2.m1.2.2.cmml">1</mn><mo id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.2" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.2.m1.3.3" xref="S3.SS2.SSS2.Px1.p1.2.m1.3.3.cmml">…</mi><mo id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.3" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.2.cmml">,</mo><mrow id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.2.1" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.2.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m1.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m1.4b"><apply id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4"><eq id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.2"></eq><ci id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.3.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.3">𝑗</ci><list id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1"><cn type="integer" id="S3.SS2.SSS2.Px1.p1.2.m1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.2.2">1</cn><ci id="S3.SS2.SSS2.Px1.p1.2.m1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.3.3">…</ci><apply id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.2"><abs id="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.4.4.1.1.1.2.1"></abs><ci id="S3.SS2.SSS2.Px1.p1.2.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m1.1.1">𝒱</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m1.4c">j=1,\ldots,\lvert\mathcal{V}\rvert</annotation></semantics></math>, where <math id="S3.SS2.SSS2.Px1.p1.3.m2.3" class="ltx_Math" alttext="w_{\texttt{max}}=\max\{w_{l}:1\leq l\leq\lvert\mathcal{V}\rvert\}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.3.m2.3a"><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.cmml"><msub id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.2.cmml">w</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3a.cmml">max</mtext></msub><mo id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.2.cmml">=</mo><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.3.m2.2.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.2.2.cmml">max</mi><mo id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1a" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml">{</mo><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.3.cmml">l</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.1.cmml">:</mo><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.cmml"><mn id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.3.cmml">≤</mo><mi id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.4" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.4.cmml">l</mi><mo id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.5" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.5.cmml">≤</mo><mrow id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.2.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.3.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m2.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.2.2" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.1.1.cmml">|</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m2.3b"><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3"><eq id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.2"></eq><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.2">𝑤</ci><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3a.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.3.3">max</mtext></ci></apply><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1"><max id="S3.SS2.SSS2.Px1.p1.3.m2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.2.2"></max><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1"><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.1">:</ci><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3"><and id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3"></and><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3b.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3"><leq id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.3"></leq><cn type="integer" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.2">1</cn><ci id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.4">𝑙</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3c.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3"><leq id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.5"></leq><share href="#S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.4.cmml" id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3d.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3"></share><apply id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.2"><abs id="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.3.3.1.1.1.1.3.6.2.1"></abs><ci id="S3.SS2.SSS2.Px1.p1.3.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m2.1.1">𝒱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m2.3c">w_{\texttt{max}}=\max\{w_{l}:1\leq l\leq\lvert\mathcal{V}\rvert\}</annotation></semantics></math>. <a href="#S3.E4" title="4 ‣ Bottleneck of softmax. ‣ 3.2.2 Approximated optimization ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 4</span></a> requires summing over the size of the vocabulary and finding <math id="S3.SS2.SSS2.Px1.p1.4.m3.1" class="ltx_Math" alttext="w_{\texttt{max}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.4.m3.1a"><msub id="S3.SS2.SSS2.Px1.p1.4.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.2.cmml">w</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m3.1b"><apply id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m3.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m3.1c">w_{\texttt{max}}</annotation></semantics></math>, which makes parallelization on GPUs challenging, since both the summation and <math id="S3.SS2.SSS2.Px1.p1.5.m4.1" class="ltx_Math" alttext="w_{\texttt{max}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.5.m4.1a"><msub id="S3.SS2.SSS2.Px1.p1.5.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.2.cmml">w</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m4.1b"><apply id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m4.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m4.1c">w_{\texttt{max}}</annotation></semantics></math> require keeping track of intermediate values across blocks <cite class="ltx_cite ltx_citemacro_cite">Dao et al. (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>); Rabe and Staats (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>); Wortsman et al. (<a href="#bib.bib66" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S3.SS2.SSS2.Px1.p2" class="ltx_para">
<p id="S3.SS2.SSS2.Px1.p2.1" class="ltx_p">The attention mechanism including its softmax computation has been optimized in FlashAttention <cite class="ltx_cite ltx_citemacro_citep">(Dao et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> by fusing its operations and using an online algorithm <cite class="ltx_cite ltx_citemacro_citep">(Milakov and Gimelshein, <a href="#bib.bib38" title="" class="ltx_ref">2018</a>; Rabe and Staats, <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> that splits the workload into blocks and rescales the output of each block. Unlike FlashAttention, we explore a fully local operation that can run without expensive tracking of intermediate variables across blocks, thus allowing for non-blocking parallel computation.</p>
</div>
</section>
<section id="S3.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Sigmoid approximation.</h5>

<div id="S3.SS2.SSS2.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p1.9" class="ltx_p">Let <math id="S3.SS2.SSS2.Px2.p1.1.m1.1" class="ltx_Math" alttext="{z}_{p}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2.cmml">z</mi><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1"><times id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2">𝑧</ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3">𝑝</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">{z}_{p}(x|x_{&lt;i+c})</annotation></semantics></math> be the logits of the target model <math id="S3.SS2.SSS2.Px2.p1.2.m2.1" class="ltx_Math" alttext="M_{p}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2">𝑀</ci><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m2.1c">M_{p}</annotation></semantics></math> given the prefix <math id="S3.SS2.SSS2.Px2.p1.3.m3.3" class="ltx_Math" alttext="(x_{1},\ldots,x_{i+c-1})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.3.m3.3a"><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.2.cmml">x</mi><mn id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.4" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.5" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.cmml"><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.3.cmml">c</mi></mrow><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.6" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.3.m3.3b"><vector id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2"><apply id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.2">𝑥</ci><cn type="integer" id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3"><minus id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.1"></minus><apply id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2"><plus id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.2.2.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.3.m3.3c">(x_{1},\ldots,x_{i+c-1})</annotation></semantics></math>.
Similarly, let <math id="S3.SS2.SSS2.Px2.p1.4.m4.1" class="ltx_Math" alttext="{z}_{q}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.cmml">z</mi><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1"><times id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2">𝑧</ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3">𝑞</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.4.m4.1c">{z}_{q}(x|x_{&lt;i+c})</annotation></semantics></math> be the logits of the draft model <math id="S3.SS2.SSS2.Px2.p1.5.m5.1" class="ltx_Math" alttext="M_{q}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.5.m5.1a"><msub id="S3.SS2.SSS2.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2.cmml">M</mi><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2">𝑀</ci><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.5.m5.1c">M_{q}</annotation></semantics></math>.
First, we rescale the logits using predefined constant values <math id="S3.SS2.SSS2.Px2.p1.6.m6.1" class="ltx_Math" alttext="\alpha&lt;0" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.6.m6.1a"><mrow id="S3.SS2.SSS2.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2.cmml">α</mi><mo id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.cmml">&lt;</mo><mn id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.6.m6.1b"><apply id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1"><lt id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1"></lt><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2">𝛼</ci><cn type="integer" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.6.m6.1c">\alpha&lt;0</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p1.7.m7.1" class="ltx_Math" alttext="\beta&gt;0" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.7.m7.1a"><mrow id="S3.SS2.SSS2.Px2.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.2" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.2.cmml">β</mi><mo id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.1" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.7.m7.1b"><apply id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1"><gt id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.1"></gt><ci id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.2">𝛽</ci><cn type="integer" id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.7.m7.1c">\beta&gt;0</annotation></semantics></math>, and then apply sigmoid to these scaled logits to approximate <math id="S3.SS2.SSS2.Px2.p1.8.m8.1" class="ltx_Math" alttext="p(x|x_{i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.8.m8.1a"><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.8.m8.1b"><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1"><times id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2"></times><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3">𝑝</ci><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3"><plus id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.8.m8.1c">p(x|x_{i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p1.9.m9.1" class="ltx_Math" alttext="q(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.9.m9.1a"><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.9.m9.1b"><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1"><times id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2"></times><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3">𝑞</ci><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.9.m9.1c">q(x|x_{&lt;i+c})</annotation></semantics></math> as follows:</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E5.m1.29" class="ltx_Math" alttext="\displaystyle\begin{split}\hat{p}(x|x_{&lt;i+c})&amp;=\sigma\left(\frac{z_{p}(x|x_{&lt;i+c})-\alpha}{\beta-\alpha}\right)\\
\hat{q}(x|x_{&lt;i+c})&amp;=\sigma\left(\frac{z_{q}(x|x_{&lt;i+c})-\alpha}{\beta-\alpha}\right),\end{split}" display="inline"><semantics id="S3.E5.m1.29a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E5.m1.29.29.4"><mtr id="S3.E5.m1.29.29.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.29.29.4b"><mrow id="S3.E5.m1.27.27.2.26.13.8"><mover accent="true" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E5.m1.27.27.2.26.13.8.9" xref="S3.E5.m1.26.26.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.27.27.2.26.13.8.8.1"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.26.26.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.27.27.2.26.13.8.8.1.1"><mi id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">x</mi><mo fence="false" id="S3.E5.m1.4.4.4.4.4.4" xref="S3.E5.m1.4.4.4.4.4.4.cmml">|</mo><msub id="S3.E5.m1.27.27.2.26.13.8.8.1.1.1"><mi id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">x</mi><mrow id="S3.E5.m1.6.6.6.6.6.6.1" xref="S3.E5.m1.6.6.6.6.6.6.1.cmml"><mi id="S3.E5.m1.6.6.6.6.6.6.1.2" xref="S3.E5.m1.6.6.6.6.6.6.1.2.cmml"></mi><mo id="S3.E5.m1.6.6.6.6.6.6.1.1" xref="S3.E5.m1.6.6.6.6.6.6.1.1.cmml">&lt;</mo><mrow id="S3.E5.m1.6.6.6.6.6.6.1.3" xref="S3.E5.m1.6.6.6.6.6.6.1.3.cmml"><mi id="S3.E5.m1.6.6.6.6.6.6.1.3.2" xref="S3.E5.m1.6.6.6.6.6.6.1.3.2.cmml">i</mi><mo id="S3.E5.m1.6.6.6.6.6.6.1.3.1" xref="S3.E5.m1.6.6.6.6.6.6.1.3.1.cmml">+</mo><mi id="S3.E5.m1.6.6.6.6.6.6.1.3.3" xref="S3.E5.m1.6.6.6.6.6.6.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E5.m1.7.7.7.7.7.7" xref="S3.E5.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.29.29.4c"><mrow id="S3.E5.m1.12.12.12.12.5a"><mi id="S3.E5.m1.12.12.12.12.5a.6" xref="S3.E5.m1.26.26.1.1.1.cmml"></mi><mo id="S3.E5.m1.8.8.8.8.1.1" xref="S3.E5.m1.8.8.8.8.1.1.cmml">=</mo><mrow id="S3.E5.m1.12.12.12.12.5a.7"><mi id="S3.E5.m1.9.9.9.9.2.2" xref="S3.E5.m1.9.9.9.9.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.12.12.12.12.5a.7.1" xref="S3.E5.m1.26.26.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.12.12.12.12.5a.7.2"><mo id="S3.E5.m1.10.10.10.10.3.3" xref="S3.E5.m1.26.26.1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E5.m1.11.11.11.11.4.4" xref="S3.E5.m1.11.11.11.11.4.4.cmml"><mfrac id="S3.E5.m1.11.11.11.11.4.4a" xref="S3.E5.m1.11.11.11.11.4.4.cmml"><mrow id="S3.E5.m1.11.11.11.11.4.4.1" xref="S3.E5.m1.11.11.11.11.4.4.1.cmml"><mrow id="S3.E5.m1.11.11.11.11.4.4.1.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.cmml"><msub id="S3.E5.m1.11.11.11.11.4.4.1.1.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.3.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3.2.cmml">z</mi><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.3.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.11.11.11.11.4.4.1.1.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.1" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.3" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.11.11.11.11.4.4.1.2" xref="S3.E5.m1.11.11.11.11.4.4.1.2.cmml">−</mo><mi id="S3.E5.m1.11.11.11.11.4.4.1.3" xref="S3.E5.m1.11.11.11.11.4.4.1.3.cmml">α</mi></mrow><mrow id="S3.E5.m1.11.11.11.11.4.4.3" xref="S3.E5.m1.11.11.11.11.4.4.3.cmml"><mi id="S3.E5.m1.11.11.11.11.4.4.3.2" xref="S3.E5.m1.11.11.11.11.4.4.3.2.cmml">β</mi><mo id="S3.E5.m1.11.11.11.11.4.4.3.1" xref="S3.E5.m1.11.11.11.11.4.4.3.1.cmml">−</mo><mi id="S3.E5.m1.11.11.11.11.4.4.3.3" xref="S3.E5.m1.11.11.11.11.4.4.3.3.cmml">α</mi></mrow></mfrac></mstyle><mo id="S3.E5.m1.12.12.12.12.5.5" xref="S3.E5.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.29.29.4d"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.29.29.4e"><mrow id="S3.E5.m1.28.28.3.27.14.8"><mover accent="true" id="S3.E5.m1.13.13.13.1.1.1" xref="S3.E5.m1.13.13.13.1.1.1.cmml"><mi id="S3.E5.m1.13.13.13.1.1.1.2" xref="S3.E5.m1.13.13.13.1.1.1.2.cmml">q</mi><mo id="S3.E5.m1.13.13.13.1.1.1.1" xref="S3.E5.m1.13.13.13.1.1.1.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E5.m1.28.28.3.27.14.8.9" xref="S3.E5.m1.26.26.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.28.28.3.27.14.8.8.1"><mo stretchy="false" id="S3.E5.m1.14.14.14.2.2.2" xref="S3.E5.m1.26.26.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.28.28.3.27.14.8.8.1.1"><mi id="S3.E5.m1.15.15.15.3.3.3" xref="S3.E5.m1.15.15.15.3.3.3.cmml">x</mi><mo fence="false" id="S3.E5.m1.16.16.16.4.4.4" xref="S3.E5.m1.16.16.16.4.4.4.cmml">|</mo><msub id="S3.E5.m1.28.28.3.27.14.8.8.1.1.1"><mi id="S3.E5.m1.17.17.17.5.5.5" xref="S3.E5.m1.17.17.17.5.5.5.cmml">x</mi><mrow id="S3.E5.m1.18.18.18.6.6.6.1" xref="S3.E5.m1.18.18.18.6.6.6.1.cmml"><mi id="S3.E5.m1.18.18.18.6.6.6.1.2" xref="S3.E5.m1.18.18.18.6.6.6.1.2.cmml"></mi><mo id="S3.E5.m1.18.18.18.6.6.6.1.1" xref="S3.E5.m1.18.18.18.6.6.6.1.1.cmml">&lt;</mo><mrow id="S3.E5.m1.18.18.18.6.6.6.1.3" xref="S3.E5.m1.18.18.18.6.6.6.1.3.cmml"><mi id="S3.E5.m1.18.18.18.6.6.6.1.3.2" xref="S3.E5.m1.18.18.18.6.6.6.1.3.2.cmml">i</mi><mo id="S3.E5.m1.18.18.18.6.6.6.1.3.1" xref="S3.E5.m1.18.18.18.6.6.6.1.3.1.cmml">+</mo><mi id="S3.E5.m1.18.18.18.6.6.6.1.3.3" xref="S3.E5.m1.18.18.18.6.6.6.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E5.m1.19.19.19.7.7.7" xref="S3.E5.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.29.29.4f"><mrow id="S3.E5.m1.29.29.4.28.15.7.7"><mrow id="S3.E5.m1.29.29.4.28.15.7.7.1"><mi id="S3.E5.m1.29.29.4.28.15.7.7.1.1" xref="S3.E5.m1.26.26.1.1.1.cmml"></mi><mo id="S3.E5.m1.20.20.20.8.1.1" xref="S3.E5.m1.20.20.20.8.1.1.cmml">=</mo><mrow id="S3.E5.m1.29.29.4.28.15.7.7.1.2"><mi id="S3.E5.m1.21.21.21.9.2.2" xref="S3.E5.m1.21.21.21.9.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.29.29.4.28.15.7.7.1.2.1" xref="S3.E5.m1.26.26.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.29.29.4.28.15.7.7.1.2.2"><mo id="S3.E5.m1.22.22.22.10.3.3" xref="S3.E5.m1.26.26.1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E5.m1.23.23.23.11.4.4" xref="S3.E5.m1.23.23.23.11.4.4.cmml"><mfrac id="S3.E5.m1.23.23.23.11.4.4a" xref="S3.E5.m1.23.23.23.11.4.4.cmml"><mrow id="S3.E5.m1.23.23.23.11.4.4.1" xref="S3.E5.m1.23.23.23.11.4.4.1.cmml"><mrow id="S3.E5.m1.23.23.23.11.4.4.1.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.cmml"><msub id="S3.E5.m1.23.23.23.11.4.4.1.1.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.3.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3.2.cmml">z</mi><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.3.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.23.23.23.11.4.4.1.1.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.1" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.3" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.23.23.23.11.4.4.1.2" xref="S3.E5.m1.23.23.23.11.4.4.1.2.cmml">−</mo><mi id="S3.E5.m1.23.23.23.11.4.4.1.3" xref="S3.E5.m1.23.23.23.11.4.4.1.3.cmml">α</mi></mrow><mrow id="S3.E5.m1.23.23.23.11.4.4.3" xref="S3.E5.m1.23.23.23.11.4.4.3.cmml"><mi id="S3.E5.m1.23.23.23.11.4.4.3.2" xref="S3.E5.m1.23.23.23.11.4.4.3.2.cmml">β</mi><mo id="S3.E5.m1.23.23.23.11.4.4.3.1" xref="S3.E5.m1.23.23.23.11.4.4.3.1.cmml">−</mo><mi id="S3.E5.m1.23.23.23.11.4.4.3.3" xref="S3.E5.m1.23.23.23.11.4.4.3.3.cmml">α</mi></mrow></mfrac></mstyle><mo id="S3.E5.m1.24.24.24.12.5.5" xref="S3.E5.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.25.25.25.13.6.6" xref="S3.E5.m1.26.26.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.29b"><apply id="S3.E5.m1.26.26.1.1.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><and id="S3.E5.m1.26.26.1.1.1a.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"></and><apply id="S3.E5.m1.26.26.1.1.1b.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><eq id="S3.E5.m1.8.8.8.8.1.1.cmml" xref="S3.E5.m1.8.8.8.8.1.1"></eq><apply id="S3.E5.m1.26.26.1.1.1.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><times id="S3.E5.m1.26.26.1.1.1.1.2.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"></times><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><ci id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">𝑝</ci></apply><apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><csymbol cd="latexml" id="S3.E5.m1.4.4.4.4.4.4.cmml" xref="S3.E5.m1.4.4.4.4.4.4">conditional</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">𝑥</ci><apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">𝑥</ci><apply id="S3.E5.m1.6.6.6.6.6.6.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1"><lt id="S3.E5.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.1"></lt><csymbol cd="latexml" id="S3.E5.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.2">absent</csymbol><apply id="S3.E5.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.3"><plus id="S3.E5.m1.6.6.6.6.6.6.1.3.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.3.1"></plus><ci id="S3.E5.m1.6.6.6.6.6.6.1.3.2.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.3.2">𝑖</ci><ci id="S3.E5.m1.6.6.6.6.6.6.1.3.3.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.E5.m1.26.26.1.1.1.2.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><times id="S3.E5.m1.26.26.1.1.1.2.2.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"></times><ci id="S3.E5.m1.9.9.9.9.2.2.cmml" xref="S3.E5.m1.9.9.9.9.2.2">𝜎</ci><apply id="S3.E5.m1.11.11.11.11.4.4.cmml" xref="S3.E5.m1.11.11.11.11.4.4"><divide id="S3.E5.m1.11.11.11.11.4.4.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4"></divide><apply id="S3.E5.m1.11.11.11.11.4.4.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1"><minus id="S3.E5.m1.11.11.11.11.4.4.1.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.2"></minus><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1"><times id="S3.E5.m1.11.11.11.11.4.4.1.1.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.2"></times><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.11.4.4.1.1.3.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3">subscript</csymbol><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.3.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3.2">𝑧</ci><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.3.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.3.3">𝑝</ci></apply><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.2">𝑥</ci><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3"><lt id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3"><plus id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><ci id="S3.E5.m1.11.11.11.11.4.4.1.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.1.3">𝛼</ci></apply><apply id="S3.E5.m1.11.11.11.11.4.4.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.3"><minus id="S3.E5.m1.11.11.11.11.4.4.3.1.cmml" xref="S3.E5.m1.11.11.11.11.4.4.3.1"></minus><ci id="S3.E5.m1.11.11.11.11.4.4.3.2.cmml" xref="S3.E5.m1.11.11.11.11.4.4.3.2">𝛽</ci><ci id="S3.E5.m1.11.11.11.11.4.4.3.3.cmml" xref="S3.E5.m1.11.11.11.11.4.4.3.3">𝛼</ci></apply></apply><apply id="S3.E5.m1.13.13.13.1.1.1.cmml" xref="S3.E5.m1.13.13.13.1.1.1"><ci id="S3.E5.m1.13.13.13.1.1.1.1.cmml" xref="S3.E5.m1.13.13.13.1.1.1.1">^</ci><ci id="S3.E5.m1.13.13.13.1.1.1.2.cmml" xref="S3.E5.m1.13.13.13.1.1.1.2">𝑞</ci></apply><apply id="S3.E5.m1.26.26.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><csymbol cd="latexml" id="S3.E5.m1.16.16.16.4.4.4.cmml" xref="S3.E5.m1.16.16.16.4.4.4">conditional</csymbol><ci id="S3.E5.m1.15.15.15.3.3.3.cmml" xref="S3.E5.m1.15.15.15.3.3.3">𝑥</ci><apply id="S3.E5.m1.26.26.1.1.1.2.1.1.1.3.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9">subscript</csymbol><ci id="S3.E5.m1.17.17.17.5.5.5.cmml" xref="S3.E5.m1.17.17.17.5.5.5">𝑥</ci><apply id="S3.E5.m1.18.18.18.6.6.6.1.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1"><lt id="S3.E5.m1.18.18.18.6.6.6.1.1.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.1"></lt><csymbol cd="latexml" id="S3.E5.m1.18.18.18.6.6.6.1.2.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.2">absent</csymbol><apply id="S3.E5.m1.18.18.18.6.6.6.1.3.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.3"><plus id="S3.E5.m1.18.18.18.6.6.6.1.3.1.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.3.1"></plus><ci id="S3.E5.m1.18.18.18.6.6.6.1.3.2.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.3.2">𝑖</ci><ci id="S3.E5.m1.18.18.18.6.6.6.1.3.3.cmml" xref="S3.E5.m1.18.18.18.6.6.6.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E5.m1.26.26.1.1.1c.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><eq id="S3.E5.m1.20.20.20.8.1.1.cmml" xref="S3.E5.m1.20.20.20.8.1.1"></eq><share href="#S3.E5.m1.26.26.1.1.1.2.cmml" id="S3.E5.m1.26.26.1.1.1d.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"></share><apply id="S3.E5.m1.26.26.1.1.1.6.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"><times id="S3.E5.m1.26.26.1.1.1.6.1.cmml" xref="S3.E5.m1.27.27.2.26.13.8.9"></times><ci id="S3.E5.m1.21.21.21.9.2.2.cmml" xref="S3.E5.m1.21.21.21.9.2.2">𝜎</ci><apply id="S3.E5.m1.23.23.23.11.4.4.cmml" xref="S3.E5.m1.23.23.23.11.4.4"><divide id="S3.E5.m1.23.23.23.11.4.4.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4"></divide><apply id="S3.E5.m1.23.23.23.11.4.4.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1"><minus id="S3.E5.m1.23.23.23.11.4.4.1.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.2"></minus><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1"><times id="S3.E5.m1.23.23.23.11.4.4.1.1.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.2"></times><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.23.11.4.4.1.1.3.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3">subscript</csymbol><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.3.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3.2">𝑧</ci><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.3.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.3.3">𝑞</ci></apply><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.2">𝑥</ci><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3"><lt id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3"><plus id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><ci id="S3.E5.m1.23.23.23.11.4.4.1.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.1.3">𝛼</ci></apply><apply id="S3.E5.m1.23.23.23.11.4.4.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.3"><minus id="S3.E5.m1.23.23.23.11.4.4.3.1.cmml" xref="S3.E5.m1.23.23.23.11.4.4.3.1"></minus><ci id="S3.E5.m1.23.23.23.11.4.4.3.2.cmml" xref="S3.E5.m1.23.23.23.11.4.4.3.2">𝛽</ci><ci id="S3.E5.m1.23.23.23.11.4.4.3.3.cmml" xref="S3.E5.m1.23.23.23.11.4.4.3.3">𝛼</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.29c">\displaystyle\begin{split}\hat{p}(x|x_{&lt;i+c})&amp;=\sigma\left(\frac{z_{p}(x|x_{&lt;i+c})-\alpha}{\beta-\alpha}\right)\\
\hat{q}(x|x_{&lt;i+c})&amp;=\sigma\left(\frac{z_{q}(x|x_{&lt;i+c})-\alpha}{\beta-\alpha}\right),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px2.p1.17" class="ltx_p">where <math id="S3.SS2.SSS2.Px2.p1.10.m1.3" class="ltx_Math" alttext="\sigma(x)=1/(1+\exp(-x))" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.10.m1.3a"><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.cmml"><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.3.2.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p1.10.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.3.2.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.2.cmml">=</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.cmml"><mn id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.3.cmml">1</mn><mo id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.2.cmml">/</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.cmml"><mn id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.3.cmml">1</mn><mo id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.2.cmml">+</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.10.m1.2.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.2.2.cmml">exp</mi><mo id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1a" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1a" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.10.m1.3b"><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3"><eq id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.2"></eq><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3"><times id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.1"></times><ci id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.3.2">𝜎</ci><ci id="S3.SS2.SSS2.Px2.p1.10.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.1.1">𝑥</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1"><divide id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.2"></divide><cn type="integer" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.3">1</cn><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1"><plus id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.2"></plus><cn type="integer" id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.3">1</cn><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1"><exp id="S3.SS2.SSS2.Px2.p1.10.m1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.2.2"></exp><apply id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1"></minus><ci id="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m1.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.10.m1.3c">\sigma(x)=1/(1+\exp(-x))</annotation></semantics></math>.
Although all values of <math id="S3.SS2.SSS2.Px2.p1.11.m2.1" class="ltx_Math" alttext="\hat{p}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.11.m2.1a"><mrow id="S3.SS2.SSS2.Px2.p1.11.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.2.cmml">p</mi><mo id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.11.m2.1b"><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1"><times id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3"><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.1">^</ci><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.3.2">𝑝</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m2.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.11.m2.1c">\hat{p}(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p1.12.m3.1" class="ltx_Math" alttext="\hat{q}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.12.m3.1a"><mrow id="S3.SS2.SSS2.Px2.p1.12.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.2.cmml">q</mi><mo id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.12.m3.1b"><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1"><times id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3"><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.1">^</ci><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.3.2">𝑞</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.12.m3.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.12.m3.1c">\hat{q}(x|x_{&lt;i+c})</annotation></semantics></math> are positive, they do not sum to 1 and thus do not constitute valid probability distributions.
Nonetheless, we rely on these approximations with the hope that they are sufficiently accurate for guiding token acceptance decisions.
Using the approximations <math id="S3.SS2.SSS2.Px2.p1.13.m4.1" class="ltx_Math" alttext="\hat{p}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.13.m4.1a"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.13.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.13.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1.2.cmml">p</mi><mo id="S3.SS2.SSS2.Px2.p1.13.m4.1.1.1" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.13.m4.1b"><apply id="S3.SS2.SSS2.Px2.p1.13.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1"><ci id="S3.SS2.SSS2.Px2.p1.13.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1.1">^</ci><ci id="S3.SS2.SSS2.Px2.p1.13.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.13.m4.1.1.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.13.m4.1c">\hat{p}</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p1.14.m5.1" class="ltx_Math" alttext="\hat{q}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.14.m5.1a"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.14.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.14.m5.1.1.2" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1.2.cmml">q</mi><mo id="S3.SS2.SSS2.Px2.p1.14.m5.1.1.1" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.14.m5.1b"><apply id="S3.SS2.SSS2.Px2.p1.14.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1"><ci id="S3.SS2.SSS2.Px2.p1.14.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1.1">^</ci><ci id="S3.SS2.SSS2.Px2.p1.14.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.14.m5.1.1.2">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.14.m5.1c">\hat{q}</annotation></semantics></math>, we accept the draft token <math id="S3.SS2.SSS2.Px2.p1.15.m6.1" class="ltx_Math" alttext="x_{i+c}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.15.m6.1a"><msub id="S3.SS2.SSS2.Px2.p1.15.m6.1.1" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.2" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.15.m6.1b"><apply id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3"><plus id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.15.m6.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.15.m6.1c">x_{i+c}</annotation></semantics></math> sampled from <math id="S3.SS2.SSS2.Px2.p1.16.m7.1" class="ltx_Math" alttext="M_{q}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.16.m7.1a"><msub id="S3.SS2.SSS2.Px2.p1.16.m7.1.1" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.2" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1.2.cmml">M</mi><mi id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.3" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.16.m7.1b"><apply id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1.2">𝑀</ci><ci id="S3.SS2.SSS2.Px2.p1.16.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.16.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.16.m7.1c">M_{q}</annotation></semantics></math> if <math id="S3.SS2.SSS2.Px2.p1.17.m8.1" class="ltx_Math" alttext="r_{c}\leq\hat{\tau}_{c}(x_{i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.17.m8.1a"><mrow id="S3.SS2.SSS2.Px2.p1.17.m8.1.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.2.cmml">r</mi><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.3.cmml">c</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.2.cmml">≤</mo><mrow id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.17.m8.1b"><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1"><leq id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.2"></leq><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.2">𝑟</ci><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.3.3">𝑐</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1"><times id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2"><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.2.2">𝜏</ci></apply><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.3.3">𝑐</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3"><plus id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.17.m8.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.17.m8.1c">r_{c}\leq\hat{\tau}_{c}(x_{i+c})</annotation></semantics></math>:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.26" class="ltx_Math" alttext="\begin{gathered}\hat{\tau}_{c}(x_{i+c})=\min\left(1,\frac{\hat{p}(x_{i+c}|x_{&lt;i+c})}{\hat{q}(x_{i+c}|x_{&lt;i+c})}\right)\\
r_{c}\sim U(0,1),\end{gathered}" display="block"><semantics id="S3.Ex1.m1.26a"><mtable displaystyle="true" rowspacing="0pt" id="S3.Ex1.m1.26.26.3"><mtr id="S3.Ex1.m1.26.26.3a"><mtd id="S3.Ex1.m1.26.26.3b"><mrow id="S3.Ex1.m1.25.25.2.24.14.14"><mrow id="S3.Ex1.m1.25.25.2.24.14.14.14"><msub id="S3.Ex1.m1.25.25.2.24.14.14.14.3"><mover accent="true" id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S3.Ex1.m1.2.2.2.2.2.2.1" xref="S3.Ex1.m1.2.2.2.2.2.2.1.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.25.25.2.24.14.14.14.2" xref="S3.Ex1.m1.24.24.1.1.1.cmml">​</mo><mrow id="S3.Ex1.m1.25.25.2.24.14.14.14.1.1"><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.3.3" xref="S3.Ex1.m1.24.24.1.1.1.cmml">(</mo><msub id="S3.Ex1.m1.25.25.2.24.14.14.14.1.1.1"><mi id="S3.Ex1.m1.4.4.4.4.4.4" xref="S3.Ex1.m1.4.4.4.4.4.4.cmml">x</mi><mrow id="S3.Ex1.m1.5.5.5.5.5.5.1" xref="S3.Ex1.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.Ex1.m1.5.5.5.5.5.5.1.2" xref="S3.Ex1.m1.5.5.5.5.5.5.1.2.cmml">i</mi><mo id="S3.Ex1.m1.5.5.5.5.5.5.1.1" xref="S3.Ex1.m1.5.5.5.5.5.5.1.1.cmml">+</mo><mi id="S3.Ex1.m1.5.5.5.5.5.5.1.3" xref="S3.Ex1.m1.5.5.5.5.5.5.1.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.Ex1.m1.6.6.6.6.6.6" xref="S3.Ex1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.7.7.7.7.7.7" xref="S3.Ex1.m1.7.7.7.7.7.7.cmml">=</mo><mrow id="S3.Ex1.m1.25.25.2.24.14.14.15"><mi id="S3.Ex1.m1.8.8.8.8.8.8" xref="S3.Ex1.m1.8.8.8.8.8.8.cmml">min</mi><mo id="S3.Ex1.m1.25.25.2.24.14.14.15a" xref="S3.Ex1.m1.24.24.1.1.1.cmml">⁡</mo><mrow id="S3.Ex1.m1.25.25.2.24.14.14.15.1"><mo id="S3.Ex1.m1.9.9.9.9.9.9" xref="S3.Ex1.m1.24.24.1.1.1.cmml">(</mo><mn id="S3.Ex1.m1.10.10.10.10.10.10" xref="S3.Ex1.m1.10.10.10.10.10.10.cmml">1</mn><mo id="S3.Ex1.m1.11.11.11.11.11.11" xref="S3.Ex1.m1.24.24.1.1.1.cmml">,</mo><mfrac id="S3.Ex1.m1.12.12.12.12.12.12" xref="S3.Ex1.m1.12.12.12.12.12.12.cmml"><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.cmml"><mover accent="true" id="S3.Ex1.m1.12.12.12.12.12.12.1.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3.2.cmml">p</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.1.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.12.12.12.12.12.12.1.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.cmml"><msub id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3.cmml">c</mi></mrow></msub><mo fence="false" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.3" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.cmml"><mover accent="true" id="S3.Ex1.m1.12.12.12.12.12.12.2.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3.2.cmml">q</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.2.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.12.12.12.12.12.12.2.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.2.cmml">​</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.cmml"><msub id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.2.cmml">x</mi><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1.cmml">+</mo><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3.cmml">c</mi></mrow></msub><mo fence="false" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.2.cmml">x</mi><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2.cmml"></mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.3" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.Ex1.m1.13.13.13.13.13.13" xref="S3.Ex1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.Ex1.m1.26.26.3c"><mtd id="S3.Ex1.m1.26.26.3d"><mrow id="S3.Ex1.m1.26.26.3.25.11.11.11"><mrow id="S3.Ex1.m1.26.26.3.25.11.11.11.1"><msub id="S3.Ex1.m1.26.26.3.25.11.11.11.1.1"><mi id="S3.Ex1.m1.14.14.14.1.1.1" xref="S3.Ex1.m1.14.14.14.1.1.1.cmml">r</mi><mi id="S3.Ex1.m1.15.15.15.2.2.2.1" xref="S3.Ex1.m1.15.15.15.2.2.2.1.cmml">c</mi></msub><mo id="S3.Ex1.m1.16.16.16.3.3.3" xref="S3.Ex1.m1.16.16.16.3.3.3.cmml">∼</mo><mrow id="S3.Ex1.m1.26.26.3.25.11.11.11.1.2"><mi id="S3.Ex1.m1.17.17.17.4.4.4" xref="S3.Ex1.m1.17.17.17.4.4.4.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.26.26.3.25.11.11.11.1.2.1" xref="S3.Ex1.m1.24.24.1.1.1.cmml">​</mo><mrow id="S3.Ex1.m1.26.26.3.25.11.11.11.1.2.2"><mo stretchy="false" id="S3.Ex1.m1.18.18.18.5.5.5" xref="S3.Ex1.m1.24.24.1.1.1.cmml">(</mo><mn id="S3.Ex1.m1.19.19.19.6.6.6" xref="S3.Ex1.m1.19.19.19.6.6.6.cmml">0</mn><mo id="S3.Ex1.m1.20.20.20.7.7.7" xref="S3.Ex1.m1.24.24.1.1.1.cmml">,</mo><mn id="S3.Ex1.m1.21.21.21.8.8.8" xref="S3.Ex1.m1.21.21.21.8.8.8.cmml">1</mn><mo stretchy="false" id="S3.Ex1.m1.22.22.22.9.9.9" xref="S3.Ex1.m1.24.24.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.23.23.23.10.10.10" xref="S3.Ex1.m1.24.24.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.26b"><apply id="S3.Ex1.m1.24.24.1.1.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><and id="S3.Ex1.m1.24.24.1.1.1a.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"></and><apply id="S3.Ex1.m1.24.24.1.1.1b.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><eq id="S3.Ex1.m1.7.7.7.7.7.7.cmml" xref="S3.Ex1.m1.7.7.7.7.7.7"></eq><apply id="S3.Ex1.m1.24.24.1.1.1.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><times id="S3.Ex1.m1.24.24.1.1.1.1.2.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"></times><apply id="S3.Ex1.m1.24.24.1.1.1.1.3.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.24.24.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">𝜏</ci></apply><ci id="S3.Ex1.m1.2.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.1">𝑐</ci></apply><apply id="S3.Ex1.m1.24.24.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.24.24.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.4.4.4.cmml" xref="S3.Ex1.m1.4.4.4.4.4.4">𝑥</ci><apply id="S3.Ex1.m1.5.5.5.5.5.5.1.cmml" xref="S3.Ex1.m1.5.5.5.5.5.5.1"><plus id="S3.Ex1.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.Ex1.m1.5.5.5.5.5.5.1.1"></plus><ci id="S3.Ex1.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.Ex1.m1.5.5.5.5.5.5.1.2">𝑖</ci><ci id="S3.Ex1.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.Ex1.m1.5.5.5.5.5.5.1.3">𝑐</ci></apply></apply></apply><apply id="S3.Ex1.m1.24.24.1.1.1.4.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><times id="S3.Ex1.m1.24.24.1.1.1.4.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"></times><apply id="S3.Ex1.m1.24.24.1.1.1.4.2.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><min id="S3.Ex1.m1.8.8.8.8.8.8.cmml" xref="S3.Ex1.m1.8.8.8.8.8.8"></min><cn type="integer" id="S3.Ex1.m1.10.10.10.10.10.10.cmml" xref="S3.Ex1.m1.10.10.10.10.10.10">1</cn><apply id="S3.Ex1.m1.12.12.12.12.12.12.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12"><divide id="S3.Ex1.m1.12.12.12.12.12.12.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12"></divide><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1"><times id="S3.Ex1.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.2"></times><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3"><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3.1">^</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.3.2">𝑝</ci></apply><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.2">𝑥</ci><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3"><plus id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.1"></plus><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.2">𝑥</ci><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3"><lt id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3"><plus id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.1"></plus><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2"><times id="S3.Ex1.m1.12.12.12.12.12.12.2.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.2"></times><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3"><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3.1">^</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.3.2">𝑞</ci></apply><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.2">𝑥</ci><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3"><plus id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.1"></plus><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.2">𝑥</ci><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3"><lt id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.2">absent</csymbol><apply id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3"><plus id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.1"></plus><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3.cmml" xref="S3.Ex1.m1.12.12.12.12.12.12.2.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.Ex1.m1.24.24.1.1.1.4.3.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.24.24.1.1.1.4.3.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2">subscript</csymbol><ci id="S3.Ex1.m1.14.14.14.1.1.1.cmml" xref="S3.Ex1.m1.14.14.14.1.1.1">𝑟</ci><ci id="S3.Ex1.m1.15.15.15.2.2.2.1.cmml" xref="S3.Ex1.m1.15.15.15.2.2.2.1">𝑐</ci></apply></apply></apply><apply id="S3.Ex1.m1.24.24.1.1.1c.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><csymbol cd="latexml" id="S3.Ex1.m1.16.16.16.3.3.3.cmml" xref="S3.Ex1.m1.16.16.16.3.3.3">similar-to</csymbol><share href="#S3.Ex1.m1.24.24.1.1.1.4.cmml" id="S3.Ex1.m1.24.24.1.1.1d.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"></share><apply id="S3.Ex1.m1.24.24.1.1.1.6.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><times id="S3.Ex1.m1.24.24.1.1.1.6.1.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"></times><ci id="S3.Ex1.m1.17.17.17.4.4.4.cmml" xref="S3.Ex1.m1.17.17.17.4.4.4">𝑈</ci><interval closure="open" id="S3.Ex1.m1.24.24.1.1.1.6.3.cmml" xref="S3.Ex1.m1.25.25.2.24.14.14.14.2"><cn type="integer" id="S3.Ex1.m1.19.19.19.6.6.6.cmml" xref="S3.Ex1.m1.19.19.19.6.6.6">0</cn><cn type="integer" id="S3.Ex1.m1.21.21.21.8.8.8.cmml" xref="S3.Ex1.m1.21.21.21.8.8.8">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.26c">\begin{gathered}\hat{\tau}_{c}(x_{i+c})=\min\left(1,\frac{\hat{p}(x_{i+c}|x_{&lt;i+c})}{\hat{q}(x_{i+c}|x_{&lt;i+c})}\right)\\
r_{c}\sim U(0,1),\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px2.p1.18" class="ltx_p">which is the approximation of <a href="#S3.E1" title="1 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 1</span></a>.
If the token <math id="S3.SS2.SSS2.Px2.p1.18.m1.1" class="ltx_Math" alttext="x_{i+c}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.18.m1.1a"><msub id="S3.SS2.SSS2.Px2.p1.18.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.18.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3"><plus id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.18.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.18.m1.1c">x_{i+c}</annotation></semantics></math> is rejected, we resample a token from a distribution that approximates <a href="#S3.E2" title="2 ‣ Speculative sampling. ‣ 3.1 Preliminaries ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 2</span></a>:</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.24" class="ltx_Math" alttext="\begin{gathered}{x}_{i+c}\sim\texttt{max\_norm}\left(\hat{p}({x}|{x}_{&lt;i+c})-\hat{q}({x}|{x}_{&lt;i+c})\right).\end{gathered}" display="block"><semantics id="S3.Ex2.m1.24a"><mtable displaystyle="true" id="S3.Ex2.m1.24.24.2"><mtr id="S3.Ex2.m1.24.24.2a"><mtd id="S3.Ex2.m1.24.24.2b"><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23"><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1"><msub id="S3.Ex2.m1.24.24.2.23.23.23.23.1.2"><mi id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">x</mi><mrow id="S3.Ex2.m1.2.2.2.2.2.2.1" xref="S3.Ex2.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.Ex2.m1.2.2.2.2.2.2.1.2" xref="S3.Ex2.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.Ex2.m1.2.2.2.2.2.2.1.1" xref="S3.Ex2.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.Ex2.m1.2.2.2.2.2.2.1.3" xref="S3.Ex2.m1.2.2.2.2.2.2.1.3.cmml">c</mi></mrow></msub><mo id="S3.Ex2.m1.3.3.3.3.3.3" xref="S3.Ex2.m1.3.3.3.3.3.3.cmml">∼</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.Ex2.m1.4.4.4.4.4.4" xref="S3.Ex2.m1.4.4.4.4.4.4a.cmml">max_norm</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2" xref="S3.Ex2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1"><mo id="S3.Ex2.m1.5.5.5.5.5.5" xref="S3.Ex2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1"><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1"><mover accent="true" id="S3.Ex2.m1.6.6.6.6.6.6" xref="S3.Ex2.m1.6.6.6.6.6.6.cmml"><mi id="S3.Ex2.m1.6.6.6.6.6.6.2" xref="S3.Ex2.m1.6.6.6.6.6.6.2.cmml">p</mi><mo id="S3.Ex2.m1.6.6.6.6.6.6.1" xref="S3.Ex2.m1.6.6.6.6.6.6.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.2" xref="S3.Ex2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.Ex2.m1.7.7.7.7.7.7" xref="S3.Ex2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1.1"><mi id="S3.Ex2.m1.8.8.8.8.8.8" xref="S3.Ex2.m1.8.8.8.8.8.8.cmml">x</mi><mo fence="false" id="S3.Ex2.m1.9.9.9.9.9.9" xref="S3.Ex2.m1.9.9.9.9.9.9.cmml">|</mo><msub id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.1.1.1.1.1"><mi id="S3.Ex2.m1.10.10.10.10.10.10" xref="S3.Ex2.m1.10.10.10.10.10.10.cmml">x</mi><mrow id="S3.Ex2.m1.11.11.11.11.11.11.1" xref="S3.Ex2.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.Ex2.m1.11.11.11.11.11.11.1.2" xref="S3.Ex2.m1.11.11.11.11.11.11.1.2.cmml"></mi><mo id="S3.Ex2.m1.11.11.11.11.11.11.1.1" xref="S3.Ex2.m1.11.11.11.11.11.11.1.1.cmml">&lt;</mo><mrow id="S3.Ex2.m1.11.11.11.11.11.11.1.3" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.cmml"><mi id="S3.Ex2.m1.11.11.11.11.11.11.1.3.2" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.2.cmml">i</mi><mo id="S3.Ex2.m1.11.11.11.11.11.11.1.3.1" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.1.cmml">+</mo><mi id="S3.Ex2.m1.11.11.11.11.11.11.1.3.3" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.Ex2.m1.12.12.12.12.12.12" xref="S3.Ex2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.13.13.13.13.13.13" xref="S3.Ex2.m1.13.13.13.13.13.13.cmml">−</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2"><mover accent="true" id="S3.Ex2.m1.14.14.14.14.14.14" xref="S3.Ex2.m1.14.14.14.14.14.14.cmml"><mi id="S3.Ex2.m1.14.14.14.14.14.14.2" xref="S3.Ex2.m1.14.14.14.14.14.14.2.cmml">q</mi><mo id="S3.Ex2.m1.14.14.14.14.14.14.1" xref="S3.Ex2.m1.14.14.14.14.14.14.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.2" xref="S3.Ex2.m1.23.23.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1"><mo stretchy="false" id="S3.Ex2.m1.15.15.15.15.15.15" xref="S3.Ex2.m1.23.23.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1.1"><mi id="S3.Ex2.m1.16.16.16.16.16.16" xref="S3.Ex2.m1.16.16.16.16.16.16.cmml">x</mi><mo fence="false" id="S3.Ex2.m1.17.17.17.17.17.17" xref="S3.Ex2.m1.17.17.17.17.17.17.cmml">|</mo><msub id="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.1.1.1.2.1.1.1.1"><mi id="S3.Ex2.m1.18.18.18.18.18.18" xref="S3.Ex2.m1.18.18.18.18.18.18.cmml">x</mi><mrow id="S3.Ex2.m1.19.19.19.19.19.19.1" xref="S3.Ex2.m1.19.19.19.19.19.19.1.cmml"><mi id="S3.Ex2.m1.19.19.19.19.19.19.1.2" xref="S3.Ex2.m1.19.19.19.19.19.19.1.2.cmml"></mi><mo id="S3.Ex2.m1.19.19.19.19.19.19.1.1" xref="S3.Ex2.m1.19.19.19.19.19.19.1.1.cmml">&lt;</mo><mrow id="S3.Ex2.m1.19.19.19.19.19.19.1.3" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.cmml"><mi id="S3.Ex2.m1.19.19.19.19.19.19.1.3.2" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.2.cmml">i</mi><mo id="S3.Ex2.m1.19.19.19.19.19.19.1.3.1" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.1.cmml">+</mo><mi id="S3.Ex2.m1.19.19.19.19.19.19.1.3.3" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.Ex2.m1.20.20.20.20.20.20" xref="S3.Ex2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex2.m1.21.21.21.21.21.21" xref="S3.Ex2.m1.23.23.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex2.m1.22.22.22.22.22.22" xref="S3.Ex2.m1.23.23.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.24b"><apply id="S3.Ex2.m1.23.23.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.Ex2.m1.3.3.3.3.3.3.cmml" xref="S3.Ex2.m1.3.3.3.3.3.3">similar-to</csymbol><apply id="S3.Ex2.m1.23.23.1.1.1.3.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.23.23.1.1.1.3.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1">𝑥</ci><apply id="S3.Ex2.m1.2.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2.1"><plus id="S3.Ex2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.Ex2.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2.1.2">𝑖</ci><ci id="S3.Ex2.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2.1.3">𝑐</ci></apply></apply><apply id="S3.Ex2.m1.23.23.1.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.Ex2.m1.23.23.1.1.1.1.2.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"></times><ci id="S3.Ex2.m1.4.4.4.4.4.4a.cmml" xref="S3.Ex2.m1.4.4.4.4.4.4"><mtext class="ltx_mathvariant_monospace" id="S3.Ex2.m1.4.4.4.4.4.4.cmml" xref="S3.Ex2.m1.4.4.4.4.4.4">max_norm</mtext></ci><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><minus id="S3.Ex2.m1.13.13.13.13.13.13.cmml" xref="S3.Ex2.m1.13.13.13.13.13.13"></minus><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"></times><apply id="S3.Ex2.m1.6.6.6.6.6.6.cmml" xref="S3.Ex2.m1.6.6.6.6.6.6"><ci id="S3.Ex2.m1.6.6.6.6.6.6.1.cmml" xref="S3.Ex2.m1.6.6.6.6.6.6.1">^</ci><ci id="S3.Ex2.m1.6.6.6.6.6.6.2.cmml" xref="S3.Ex2.m1.6.6.6.6.6.6.2">𝑝</ci></apply><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.Ex2.m1.9.9.9.9.9.9.cmml" xref="S3.Ex2.m1.9.9.9.9.9.9">conditional</csymbol><ci id="S3.Ex2.m1.8.8.8.8.8.8.cmml" xref="S3.Ex2.m1.8.8.8.8.8.8">𝑥</ci><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.10.10.10.10.10.10.cmml" xref="S3.Ex2.m1.10.10.10.10.10.10">𝑥</ci><apply id="S3.Ex2.m1.11.11.11.11.11.11.1.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1"><lt id="S3.Ex2.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.1"></lt><csymbol cd="latexml" id="S3.Ex2.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.2">absent</csymbol><apply id="S3.Ex2.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3"><plus id="S3.Ex2.m1.11.11.11.11.11.11.1.3.1.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.1"></plus><ci id="S3.Ex2.m1.11.11.11.11.11.11.1.3.2.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.2">𝑖</ci><ci id="S3.Ex2.m1.11.11.11.11.11.11.1.3.3.cmml" xref="S3.Ex2.m1.11.11.11.11.11.11.1.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><times id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"></times><apply id="S3.Ex2.m1.14.14.14.14.14.14.cmml" xref="S3.Ex2.m1.14.14.14.14.14.14"><ci id="S3.Ex2.m1.14.14.14.14.14.14.1.cmml" xref="S3.Ex2.m1.14.14.14.14.14.14.1">^</ci><ci id="S3.Ex2.m1.14.14.14.14.14.14.2.cmml" xref="S3.Ex2.m1.14.14.14.14.14.14.2">𝑞</ci></apply><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="latexml" id="S3.Ex2.m1.17.17.17.17.17.17.cmml" xref="S3.Ex2.m1.17.17.17.17.17.17">conditional</csymbol><ci id="S3.Ex2.m1.16.16.16.16.16.16.cmml" xref="S3.Ex2.m1.16.16.16.16.16.16">𝑥</ci><apply id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.23.23.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.Ex2.m1.24.24.2.23.23.23.23.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.18.18.18.18.18.18.cmml" xref="S3.Ex2.m1.18.18.18.18.18.18">𝑥</ci><apply id="S3.Ex2.m1.19.19.19.19.19.19.1.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1"><lt id="S3.Ex2.m1.19.19.19.19.19.19.1.1.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.1"></lt><csymbol cd="latexml" id="S3.Ex2.m1.19.19.19.19.19.19.1.2.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.2">absent</csymbol><apply id="S3.Ex2.m1.19.19.19.19.19.19.1.3.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3"><plus id="S3.Ex2.m1.19.19.19.19.19.19.1.3.1.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.1"></plus><ci id="S3.Ex2.m1.19.19.19.19.19.19.1.3.2.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.2">𝑖</ci><ci id="S3.Ex2.m1.19.19.19.19.19.19.1.3.3.cmml" xref="S3.Ex2.m1.19.19.19.19.19.19.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.24c">\begin{gathered}{x}_{i+c}\sim\texttt{max\_norm}\left(\hat{p}({x}|{x}_{&lt;i+c})-\hat{q}({x}|{x}_{&lt;i+c})\right).\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS2.Px2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p2.25" class="ltx_p"><a href="#S3.F2" title="Figure 2 ‣ 3.2.2 Approximated optimization ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 2</span></a> illustrates the computations with sigmoid approximation executed in parallel within each thread block.
The main changes are highlighted in red rectangles.
 <svg id="S3.SS2.SSS2.Px2.p2.1.pic1" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#F8CECC" stroke="#B85450"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS2.Px2.p2.1.pic1.1.1.1.1.1" class="ltx_text ltx_font_bold">1</span></foreignObject></g></g></svg>
Let <math id="S3.SS2.SSS2.Px2.p2.2.m1.1" class="ltx_Math" alttext="{z}_{p_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.2.m1.1a"><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.2.m1.1b"><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1"><times id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.2.m1.1c">{z}_{p_{k}}(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p2.3.m2.1" class="ltx_Math" alttext="{z}_{q_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.3.m2.1a"><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.2.cmml">q</mi><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.3.m2.1b"><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1"><times id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.2">𝑞</ci><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.3.m2.1c">{z}_{q_{k}}(x|x_{&lt;i+c})</annotation></semantics></math> be restrictions of the logits <math id="S3.SS2.SSS2.Px2.p2.4.m3.1" class="ltx_Math" alttext="{z}_{p}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.4.m3.1a"><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2.cmml">z</mi><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.4.m3.1b"><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1"><times id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2">𝑧</ci><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3">𝑝</ci></apply><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.4.m3.1c">{z}_{p}(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p2.5.m4.1" class="ltx_Math" alttext="{z}_{q}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.5.m4.1a"><mrow id="S3.SS2.SSS2.Px2.p2.5.m4.1.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.2.cmml">z</mi><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.5.m4.1b"><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1"><times id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.2">𝑧</ci><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.3">𝑞</ci></apply><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.5.m4.1c">{z}_{q}(x|x_{&lt;i+c})</annotation></semantics></math> to the sub-vocabulary <math id="S3.SS2.SSS2.Px2.p2.6.m5.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.6.m5.1a"><msub id="S3.SS2.SSS2.Px2.p2.6.m5.1.1" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.2" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.3" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.6.m5.1b"><apply id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.2">𝒱</ci><ci id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.6.m5.1c">\mathcal{V}_{k}</annotation></semantics></math> of the corresponding current tile.
The function values of <math id="S3.SS2.SSS2.Px2.p2.7.m6.1" class="ltx_Math" alttext="{z}_{p_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.7.m6.1a"><mrow id="S3.SS2.SSS2.Px2.p2.7.m6.1.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.7.m6.1b"><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1"><times id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.7.m6.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.7.m6.1c">{z}_{p_{k}}(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p2.8.m7.1" class="ltx_Math" alttext="{z}_{q_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.8.m7.1a"><mrow id="S3.SS2.SSS2.Px2.p2.8.m7.1.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.2.cmml">q</mi><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.8.m7.1b"><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1"><times id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.2">𝑞</ci><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.8.m7.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.8.m7.1c">{z}_{q_{k}}(x|x_{&lt;i+c})</annotation></semantics></math> evaluated on <math id="S3.SS2.SSS2.Px2.p2.9.m8.1" class="ltx_Math" alttext="\mathcal{V}_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.9.m8.1a"><msub id="S3.SS2.SSS2.Px2.p2.9.m8.1.1" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.2" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.3" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.9.m8.1b"><apply id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1.2">𝒱</ci><ci id="S3.SS2.SSS2.Px2.p2.9.m8.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.9.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.9.m8.1c">\mathcal{V}_{k}</annotation></semantics></math> are loaded from HBM into SRAM.
 <svg id="S3.SS2.SSS2.Px2.p2.10.pic2" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#F8CECC" stroke="#B85450"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS2.Px2.p2.10.pic2.1.1.1.1.1" class="ltx_text ltx_font_bold">2</span></foreignObject></g></g></svg>
We apply sigmoid to the rescaled logits <math id="S3.SS2.SSS2.Px2.p2.11.m9.1" class="ltx_Math" alttext="{z}_{p_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.11.m9.1a"><mrow id="S3.SS2.SSS2.Px2.p2.11.m9.1.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.11.m9.1b"><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1"><times id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.11.m9.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.11.m9.1c">{z}_{p_{k}}(x|x_{&lt;i+c})</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p2.12.m10.1" class="ltx_Math" alttext="{z}_{q_{k}}(x|x_{&lt;i+c})" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.12.m10.1a"><mrow id="S3.SS2.SSS2.Px2.p2.12.m10.1.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.2.cmml">z</mi><msub id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.2.cmml">q</mi><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mrow id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.1" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.12.m10.1b"><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1"><times id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.2"></times><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.2">𝑧</ci><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.2">𝑞</ci><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3"><lt id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3"><plus id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.12.m10.1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.12.m10.1c">{z}_{q_{k}}(x|x_{&lt;i+c})</annotation></semantics></math>.
Since the computation of sigmoid is an element-wise operation and does not depend on values from other threads and blocks, we can execute it in parallel, thereby further accelerating speculative sampling. Similar to step  <svg id="S3.SS2.SSS2.Px2.p2.13.pic3" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#DAE8FC" stroke="#6C8EBF"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS2.Px2.p2.13.pic3.1.1.1.1.1" class="ltx_text ltx_font_bold">2</span></foreignObject></g></g></svg>
 of the exact optimization in <a href="#S3.F1" title="Figure 1 ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 1</span></a>, the partial results, <math id="S3.SS2.SSS2.Px2.p2.14.m11.1" class="ltx_Math" alttext="\hat{f}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.14.m11.1a"><mrow id="S3.SS2.SSS2.Px2.p2.14.m11.1.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.2.cmml">f</mi><mo id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.1" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.1" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.14.m11.1.1" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.14.m11.1b"><apply id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2"><times id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2"><ci id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.2.2">𝑓</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.14.m11.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.14.m11.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.14.m11.1c">\hat{f}_{k}(x)</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px2.p2.15.m12.1" class="ltx_Math" alttext="\hat{a}_{k}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.15.m12.1a"><mrow id="S3.SS2.SSS2.Px2.p2.15.m12.1.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.2.cmml">a</mi><mo id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.1" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.1" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.15.m12.1.1" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.15.m12.1b"><apply id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2"><times id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2"><ci id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.2.2">𝑎</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.15.m12.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.15.m12.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.15.m12.1c">\hat{a}_{k}(x)</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px2.p2.16.m13.1" class="ltx_Math" alttext="\hat{b}_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.16.m13.1a"><msub id="S3.SS2.SSS2.Px2.p2.16.m13.1.1" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.2" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.2.cmml">b</mi><mo id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.1" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.3" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.16.m13.1b"><apply id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2"><ci id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.2.2">𝑏</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.16.m13.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.16.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.16.m13.1c">\hat{b}_{k}</annotation></semantics></math>, and <math id="S3.SS2.SSS2.Px2.p2.17.m14.1" class="ltx_Math" alttext="\hat{\tau}_{c_{k}}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.17.m14.1a"><mrow id="S3.SS2.SSS2.Px2.p2.17.m14.1.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.1" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.1.cmml">^</mo></mover><msub id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.2.cmml">c</mi><mi id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.3" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.1" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.17.m14.1.1" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.17.m14.1b"><apply id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2"><times id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2"><ci id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.2.2">𝜏</ci></apply><apply id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.2">𝑐</ci><ci id="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.SSS2.Px2.p2.17.m14.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.17.m14.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.17.m14.1c">\hat{\tau}_{c_{k}}(x)</annotation></semantics></math>, which are approximations of <math id="S3.SS2.SSS2.Px2.p2.18.m15.1" class="ltx_Math" alttext="f_{k}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.18.m15.1a"><mrow id="S3.SS2.SSS2.Px2.p2.18.m15.1.2" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.2.cmml">f</mi><mi id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.1" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.18.m15.1.1" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.18.m15.1b"><apply id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2"><times id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.2">𝑓</ci><ci id="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.18.m15.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.18.m15.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.18.m15.1c">f_{k}(x)</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px2.p2.19.m16.1" class="ltx_Math" alttext="a_{k}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.19.m16.1a"><mrow id="S3.SS2.SSS2.Px2.p2.19.m16.1.2" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.2.cmml">a</mi><mi id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.1" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.19.m16.1.1" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.19.m16.1b"><apply id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2"><times id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.2">𝑎</ci><ci id="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.19.m16.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.19.m16.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.19.m16.1c">a_{k}(x)</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px2.p2.20.m17.1" class="ltx_Math" alttext="b_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.20.m17.1a"><msub id="S3.SS2.SSS2.Px2.p2.20.m17.1.1" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.2" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1.2.cmml">b</mi><mi id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.3" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.20.m17.1b"><apply id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1.2">𝑏</ci><ci id="S3.SS2.SSS2.Px2.p2.20.m17.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.20.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.20.m17.1c">b_{k}</annotation></semantics></math>, and <math id="S3.SS2.SSS2.Px2.p2.21.m18.1" class="ltx_Math" alttext="\tau_{c_{k}}(x)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.21.m18.1a"><mrow id="S3.SS2.SSS2.Px2.p2.21.m18.1.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.cmml"><msub id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.2.cmml">τ</mi><msub id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.2.cmml">c</mi><mi id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.3" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.1" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.3.2.1" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p2.21.m18.1.1" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.3.2.2" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.21.m18.1b"><apply id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2"><times id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.1"></times><apply id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.2">𝜏</ci><apply id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.2">𝑐</ci><ci id="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.SSS2.Px2.p2.21.m18.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.21.m18.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.21.m18.1c">\tau_{c_{k}}(x)</annotation></semantics></math>, respectively, are computed and stored in SRAM.  <svg id="S3.SS2.SSS2.Px2.p2.22.pic4" class="ltx_picture" height="12.97" overflow="visible" version="1.1" width="12.97"><g transform="translate(0,12.97) matrix(1 0 0 -1 0 0) translate(6.48,0) translate(0,6.48)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#F8CECC" stroke="#B85450"><path d="M 6.21 0 C 6.21 3.43 3.43 6.21 0 6.21 C -3.43 6.21 -6.21 3.43 -6.21 0 C -6.21 -3.43 -3.43 -6.21 0 -6.21 C 3.43 -6.21 6.21 -3.43 6.21 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#000000" stroke="#000000"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S3.SS2.SSS2.Px2.p2.22.pic4.1.1.1.1.1" class="ltx_text ltx_font_bold">3</span></foreignObject></g></g></svg>

The partial results are written back to HBM, and for <math id="S3.SS2.SSS2.Px2.p2.23.m19.1" class="ltx_Math" alttext="\hat{b}_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.23.m19.1a"><msub id="S3.SS2.SSS2.Px2.p2.23.m19.1.1" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.2" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.2.cmml">b</mi><mo id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.1" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.3" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.23.m19.1b"><apply id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2"><ci id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.2.2">𝑏</ci></apply><ci id="S3.SS2.SSS2.Px2.p2.23.m19.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.23.m19.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.23.m19.1c">\hat{b}_{k}</annotation></semantics></math>, they are aggregated across blocks to compute the final result <math id="S3.SS2.SSS2.Px2.p2.24.m20.1" class="ltx_Math" alttext="\hat{b}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.24.m20.1a"><mover accent="true" id="S3.SS2.SSS2.Px2.p2.24.m20.1.1" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.24.m20.1.1.2" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1.2.cmml">b</mi><mo id="S3.SS2.SSS2.Px2.p2.24.m20.1.1.1" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.24.m20.1b"><apply id="S3.SS2.SSS2.Px2.p2.24.m20.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1"><ci id="S3.SS2.SSS2.Px2.p2.24.m20.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1.1">^</ci><ci id="S3.SS2.SSS2.Px2.p2.24.m20.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.24.m20.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.24.m20.1c">\hat{b}</annotation></semantics></math>, which is approximation of <math id="S3.SS2.SSS2.Px2.p2.25.m21.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.25.m21.1a"><mi id="S3.SS2.SSS2.Px2.p2.25.m21.1.1" xref="S3.SS2.SSS2.Px2.p2.25.m21.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.25.m21.1b"><ci id="S3.SS2.SSS2.Px2.p2.25.m21.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.25.m21.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.25.m21.1c">b</annotation></semantics></math>.</p>
</div>
</section>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>

<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.4" class="ltx_inline-block ltx_transformed_outer" style="width:504.5pt;height:361pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table id="S4.T1.4.4" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.2.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2.3" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.2.2.2.3.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.2.2.2.4.1" class="ltx_text ltx_font_bold">Subset</span></td>
<td id="S4.T1.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="2"><span id="S4.T1.2.2.2.5.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="3"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">WER <math id="S4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="(\downarrow)" display="inline"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.1.m1.1.2.2"><mo stretchy="false" id="S4.T1.1.1.1.1.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="S4.T1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">↓</mo><mo stretchy="false" id="S4.T1.1.1.1.1.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">(\downarrow)</annotation></semantics></math></span></td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="2">
<math id="S4.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T1.2.2.2.2.m1.1a"><mi mathvariant="normal" id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\Delta</annotation></semantics></math>% <span id="S4.T1.2.2.2.2.1" class="ltx_text ltx_font_bold">Profiling Time</span>
</td>
</tr>
<tr id="S4.T1.4.4.5" class="ltx_tr">
<td id="S4.T1.4.4.5.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Target</td>
<td id="S4.T1.4.4.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Draft</td>
<td id="S4.T1.4.4.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Baseline</td>
<td id="S4.T1.4.4.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Exact</td>
<td id="S4.T1.4.4.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sigmoid</td>
<td id="S4.T1.4.4.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Exact</td>
<td id="S4.T1.4.4.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sigmoid</td>
</tr>
<tr id="S4.T1.4.4.6" class="ltx_tr">
<td id="S4.T1.4.4.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.4.4.6.1.1" class="ltx_text">LibriSpeech</span></td>
<td id="S4.T1.4.4.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">clean</td>
<td id="S4.T1.4.4.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.6.3.1" class="ltx_text">Small.EN</span></td>
<td id="S4.T1.4.4.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.6.4.1" class="ltx_text">Distil Small.EN</span></td>
<td id="S4.T1.4.4.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.08</td>
<td id="S4.T1.4.4.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.08</td>
<td id="S4.T1.4.4.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.09</td>
<td id="S4.T1.4.4.6.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">11.7%</td>
<td id="S4.T1.4.4.6.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">71.9%</td>
</tr>
<tr id="S4.T1.4.4.7" class="ltx_tr">
<td id="S4.T1.4.4.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">other</td>
<td id="S4.T1.4.4.7.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.14</td>
<td id="S4.T1.4.4.7.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.14</td>
<td id="S4.T1.4.4.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.15</td>
<td id="S4.T1.4.4.7.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">10.7%</td>
<td id="S4.T1.4.4.7.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">74.6%</td>
</tr>
<tr id="S4.T1.4.4.8" class="ltx_tr">
<td id="S4.T1.4.4.8.1" class="ltx_td ltx_align_left" style="padding-left:6.5pt;padding-right:6.5pt;">TED-LIUM</td>
<td id="S4.T1.4.4.8.2" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">release3</td>
<td id="S4.T1.4.4.8.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.22</td>
<td id="S4.T1.4.4.8.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.22</td>
<td id="S4.T1.4.4.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.24</td>
<td id="S4.T1.4.4.8.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">12.5%</td>
<td id="S4.T1.4.4.8.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">78.9%</td>
</tr>
<tr id="S4.T1.4.4.9" class="ltx_tr">
<td id="S4.T1.4.4.9.1" class="ltx_td ltx_align_left" style="padding-left:6.5pt;padding-right:6.5pt;">CV16</td>
<td id="S4.T1.4.4.9.2" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">en</td>
<td id="S4.T1.4.4.9.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.22</td>
<td id="S4.T1.4.4.9.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.22</td>
<td id="S4.T1.4.4.9.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.27</td>
<td id="S4.T1.4.4.9.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">10.4%</td>
<td id="S4.T1.4.4.9.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">66.8%</td>
</tr>
<tr id="S4.T1.4.4.10" class="ltx_tr">
<td id="S4.T1.4.4.10.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.4.4.10.1.1" class="ltx_text">LibriSpeech</span></td>
<td id="S4.T1.4.4.10.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">clean</td>
<td id="S4.T1.4.4.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.10.3.1" class="ltx_text">Large V2</span></td>
<td id="S4.T1.4.4.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.10.4.1" class="ltx_text">Distil Large V2</span></td>
<td id="S4.T1.4.4.10.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.07</td>
<td id="S4.T1.4.4.10.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.07</td>
<td id="S4.T1.4.4.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.15</td>
<td id="S4.T1.4.4.10.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">10.8%</td>
<td id="S4.T1.4.4.10.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">83.9%</td>
</tr>
<tr id="S4.T1.4.4.11" class="ltx_tr">
<td id="S4.T1.4.4.11.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">other</td>
<td id="S4.T1.4.4.11.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.12</td>
<td id="S4.T1.4.4.11.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.12</td>
<td id="S4.T1.4.4.11.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.19</td>
<td id="S4.T1.4.4.11.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">11.4%</td>
<td id="S4.T1.4.4.11.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">84.0%</td>
</tr>
<tr id="S4.T1.4.4.12" class="ltx_tr">
<td id="S4.T1.4.4.12.1" class="ltx_td ltx_align_left" style="padding-left:6.5pt;padding-right:6.5pt;">TED-LIUM</td>
<td id="S4.T1.4.4.12.2" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">release3</td>
<td id="S4.T1.4.4.12.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.12.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.23</td>
<td id="S4.T1.4.4.12.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">11.4%</td>
<td id="S4.T1.4.4.12.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">83.3%</td>
</tr>
<tr id="S4.T1.4.4.13" class="ltx_tr">
<td id="S4.T1.4.4.13.1" class="ltx_td ltx_align_left" style="padding-left:6.5pt;padding-right:6.5pt;">CV16</td>
<td id="S4.T1.4.4.13.2" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">en</td>
<td id="S4.T1.4.4.13.3" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.25</td>
<td id="S4.T1.4.4.13.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.25</td>
<td id="S4.T1.4.4.13.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.31</td>
<td id="S4.T1.4.4.13.6" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">
<span id="S4.T1.4.4.13.6.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.7%</td>
<td id="S4.T1.4.4.13.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">78.5%</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<td id="S4.T1.4.4.4.3" class="ltx_td ltx_align_left ltx_border_tt ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.4.4.4.3.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="2"><span id="S4.T1.4.4.4.4.1" class="ltx_text ltx_font_bold">Subset</span></td>
<td id="S4.T1.4.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="2"><span id="S4.T1.4.4.4.5.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T1.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="3"><span id="S4.T1.3.3.3.1.1" class="ltx_text ltx_font_bold">ROUGE-1 <math id="S4.T1.3.3.3.1.1.m1.1" class="ltx_Math" alttext="(\uparrow)" display="inline"><semantics id="S4.T1.3.3.3.1.1.m1.1a"><mrow id="S4.T1.3.3.3.1.1.m1.1.2.2"><mo stretchy="false" id="S4.T1.3.3.3.1.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="S4.T1.3.3.3.1.1.m1.1.1" xref="S4.T1.3.3.3.1.1.m1.1.1.cmml">↑</mo><mo stretchy="false" id="S4.T1.3.3.3.1.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.1.m1.1b"><ci id="S4.T1.3.3.3.1.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.1.m1.1c">(\uparrow)</annotation></semantics></math></span></td>
<td id="S4.T1.4.4.4.2" class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" style="padding-left:6.5pt;padding-right:6.5pt;" colspan="2">
<math id="S4.T1.4.4.4.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T1.4.4.4.2.m1.1a"><mi mathvariant="normal" id="S4.T1.4.4.4.2.m1.1.1" xref="S4.T1.4.4.4.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.2.m1.1b"><ci id="S4.T1.4.4.4.2.m1.1.1.cmml" xref="S4.T1.4.4.4.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.2.m1.1c">\Delta</annotation></semantics></math>% <span id="S4.T1.4.4.4.2.1" class="ltx_text ltx_font_bold">Profiling Time</span>
</td>
</tr>
<tr id="S4.T1.4.4.14" class="ltx_tr">
<td id="S4.T1.4.4.14.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Target</td>
<td id="S4.T1.4.4.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Draft</td>
<td id="S4.T1.4.4.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Baseline</td>
<td id="S4.T1.4.4.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Exact</td>
<td id="S4.T1.4.4.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sigmoid</td>
<td id="S4.T1.4.4.14.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Exact</td>
<td id="S4.T1.4.4.14.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sigmoid</td>
</tr>
<tr id="S4.T1.4.4.15" class="ltx_tr">
<td id="S4.T1.4.4.15.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.15.1.1" class="ltx_text">CNN/DM</span></td>
<td id="S4.T1.4.4.15.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Llama2 7B</td>
<td id="S4.T1.4.4.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sheared Llama 1.3B</td>
<td id="S4.T1.4.4.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.30</td>
<td id="S4.T1.4.4.15.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.30</td>
<td id="S4.T1.4.4.15.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.26</td>
<td id="S4.T1.4.4.15.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">
<span id="S4.T1.4.4.15.8.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>5.7%</td>
<td id="S4.T1.4.4.15.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">78.0%</td>
</tr>
<tr id="S4.T1.4.4.16" class="ltx_tr">
<td id="S4.T1.4.4.16.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.16.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">Llama2 13B</td>
<td id="S4.T1.4.4.16.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Sheared Llama 1.3B</td>
<td id="S4.T1.4.4.16.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.31</td>
<td id="S4.T1.4.4.16.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.31</td>
<td id="S4.T1.4.4.16.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.29</td>
<td id="S4.T1.4.4.16.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">10.1%</td>
<td id="S4.T1.4.4.16.8" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">37.2%</td>
</tr>
<tr id="S4.T1.4.4.17" class="ltx_tr">
<td id="S4.T1.4.4.17.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.17.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">Qwen 7B</td>
<td id="S4.T1.4.4.17.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Qwen 0.5B</td>
<td id="S4.T1.4.4.17.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.31</td>
<td id="S4.T1.4.4.17.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.31</td>
<td id="S4.T1.4.4.17.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.26</td>
<td id="S4.T1.4.4.17.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">
<span id="S4.T1.4.4.17.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>6.8%</td>
<td id="S4.T1.4.4.17.8" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">92.4%</td>
</tr>
<tr id="S4.T1.4.4.18" class="ltx_tr">
<td id="S4.T1.4.4.18.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.18.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">Gemma 7B</td>
<td id="S4.T1.4.4.18.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Gemma 2B</td>
<td id="S4.T1.4.4.18.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.23</td>
<td id="S4.T1.4.4.18.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.23</td>
<td id="S4.T1.4.4.18.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.17</td>
<td id="S4.T1.4.4.18.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">10.6%</td>
<td id="S4.T1.4.4.18.8" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">68.4%</td>
</tr>
<tr id="S4.T1.4.4.19" class="ltx_tr">
<td id="S4.T1.4.4.19.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;" rowspan="4"><span id="S4.T1.4.4.19.1.1" class="ltx_text">XSum</span></td>
<td id="S4.T1.4.4.19.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Llama2 7B</td>
<td id="S4.T1.4.4.19.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">Sheared Llama 1.3B</td>
<td id="S4.T1.4.4.19.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.19.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.19.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">0.18</td>
<td id="S4.T1.4.4.19.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">11.1%</td>
<td id="S4.T1.4.4.19.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.5pt;padding-right:6.5pt;">83.6%</td>
</tr>
<tr id="S4.T1.4.4.20" class="ltx_tr">
<td id="S4.T1.4.4.20.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.20.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">Llama2 13B</td>
<td id="S4.T1.4.4.20.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Sheared Llama 1.3B</td>
<td id="S4.T1.4.4.20.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.20.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.20</td>
<td id="S4.T1.4.4.20.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.17</td>
<td id="S4.T1.4.4.20.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">10.5%</td>
<td id="S4.T1.4.4.20.8" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">45.7%</td>
</tr>
<tr id="S4.T1.4.4.21" class="ltx_tr">
<td id="S4.T1.4.4.21.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.21.2" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">Qwen 7B</td>
<td id="S4.T1.4.4.21.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Qwen 0.5B</td>
<td id="S4.T1.4.4.21.4" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.18</td>
<td id="S4.T1.4.4.21.5" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">0.18</td>
<td id="S4.T1.4.4.21.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.13</td>
<td id="S4.T1.4.4.21.7" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">
<span id="S4.T1.4.4.21.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>7.8%</td>
<td id="S4.T1.4.4.21.8" class="ltx_td ltx_align_center" style="padding-left:6.5pt;padding-right:6.5pt;">93.6%</td>
</tr>
<tr id="S4.T1.4.4.22" class="ltx_tr">
<td id="S4.T1.4.4.22.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">-</td>
<td id="S4.T1.4.4.22.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.5pt;padding-right:6.5pt;">Gemma 7B</td>
<td id="S4.T1.4.4.22.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">Gemma 2B</td>
<td id="S4.T1.4.4.22.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.5pt;padding-right:6.5pt;">0.18</td>
<td id="S4.T1.4.4.22.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.5pt;padding-right:6.5pt;">0.18</td>
<td id="S4.T1.4.4.22.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:6.5pt;padding-right:6.5pt;">0.13</td>
<td id="S4.T1.4.4.22.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.5pt;padding-right:6.5pt;">
<span id="S4.T1.4.4.22.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>9.9%</td>
<td id="S4.T1.4.4.22.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.5pt;padding-right:6.5pt;">63.5%</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy and profiling results on ASR and text summarization.
The column “<math id="S4.T1.6.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T1.6.m1.1b"><mi mathvariant="normal" id="S4.T1.6.m1.1.1" xref="S4.T1.6.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.m1.1c"><ci id="S4.T1.6.m1.1.1.cmml" xref="S4.T1.6.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.m1.1d">\Delta</annotation></semantics></math>% Profiling Time” measures the relative reduction in GPU time achieved with our optimized approaches (<span id="S4.T1.9.1" class="ltx_text ltx_font_italic">exact</span> and <span id="S4.T1.10.2" class="ltx_text ltx_font_italic">sigmoid approximation</span>) compared to the baseline.</figcaption>
</figure>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Datasets and metrics.</h5>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">We evaluate accuracy and inference speed of our optimized speculative sampling on ASR and single-document summarization.
For ASR, we measure word error rates (WERs) on the test portions of three English datasets: CommonVoice 16 (CV16) <cite class="ltx_cite ltx_citemacro_cite">Ardila et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>, LibriSpeech <cite class="ltx_cite ltx_citemacro_cite">Panayotov et al. (<a href="#bib.bib44" title="" class="ltx_ref">2015</a>)</cite>, and TED-LIUM <cite class="ltx_cite ltx_citemacro_cite">Rousseau et al. (<a href="#bib.bib49" title="" class="ltx_ref">2012</a>)</cite>.
For summarization, we use the test portions of Extreme Summarization (XSum) <cite class="ltx_cite ltx_citemacro_cite">Narayan et al. (<a href="#bib.bib42" title="" class="ltx_ref">2018</a>)</cite> and CNN/Daily Mail (CNN/DM) <cite class="ltx_cite ltx_citemacro_cite">Nallapati et al. (<a href="#bib.bib41" title="" class="ltx_ref">2016</a>)</cite> to evaluate the quality of summaries generated by language models with ROUGE-1 <cite class="ltx_cite ltx_citemacro_citep">(Lin, <a href="#bib.bib35" title="" class="ltx_ref">2004</a>)</cite>.
For all tasks, we use the PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a href="#bib.bib45" title="" class="ltx_ref">2019</a>)</cite> profiling tool to obtain execution times for performing speculative sampling.
We measure the execution time within the entire call stack of the speculative sampling function, including any nested function call (<span id="S4.SS1.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, softmax). The profiling times are summed over all decoding steps and examples in a dataset, before the relative improvement is calculated.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyperparameters.</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.10" class="ltx_p">We set the batch size <math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">B</annotation></semantics></math> to 1 and employ the same heuristic used in the baseline speculative sampling implementation in Transformers library <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al., <a href="#bib.bib65" title="" class="ltx_ref">2020</a>)</cite>, to set the number of draft tokens <math id="S4.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">\gamma</annotation></semantics></math>.
Initially, <math id="S4.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.1c">\gamma</annotation></semantics></math> is set to 5 and increases by 2 if all speculative tokens sampled from the draft model are accepted; otherwise, it decreases by 1.
We set the maximum sequence length to 256 tokens for ASR and 100 tokens for summarization.
For ASR, using sigmoid approximation, <math id="S4.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">\alpha</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">\beta</annotation></semantics></math> are set to <math id="S4.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><mrow id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.6.m6.1.1a" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">−</mo><msup id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml"><mn id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml">10</mn><mn id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1"><minus id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1"></minus><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.2">10</cn><cn type="integer" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">-10^{3}</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.1a"><msup id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml"><mn id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml">10</mn><mn id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2">10</cn><cn type="integer" id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.1c">10^{3}</annotation></semantics></math>, respectively.
In summarization experiments, we use <math id="S4.SS1.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="\alpha=-10^{4}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.8.m8.1a"><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml">α</mi><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3a" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml">−</mo><msup id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml"><mn id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.2.cmml">10</mn><mn id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.3.cmml">4</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1"><eq id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1"></eq><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2">𝛼</ci><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3"><minus id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3"></minus><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.2">10</cn><cn type="integer" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.8.m8.1c">\alpha=-10^{4}</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="\beta=10^{4}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.9.m9.1a"><mrow id="S4.SS1.SSS0.Px2.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml">β</mi><mo id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.1" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.1.cmml">=</mo><msup id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml"><mn id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.2.cmml">10</mn><mn id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1"><eq id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.1"></eq><ci id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2">𝛽</ci><apply id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.2">10</cn><cn type="integer" id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.9.m9.1c">\beta=10^{4}</annotation></semantics></math>.
We set <math id="S4.SS1.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="n=1024" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.10.m10.1a"><mrow id="S4.SS1.SSS0.Px2.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml">n</mi><mo id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.1" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.10.m10.1b"><apply id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1"><eq id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.1"></eq><ci id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2">𝑛</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.10.m10.1c">n=1024</annotation></semantics></math>, <span id="S4.SS1.SSS0.Px2.p1.10.1" class="ltx_text ltx_font_italic">i.e.</span>, the maximum available threads per block on the NVIDIA A100 GPU.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Target models.</h5>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.1" class="ltx_p">We employ Whisper <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib48" title="" class="ltx_ref">2022</a>)</cite> as the target model series for the ASR task.
We use both the multilingual 1.55B parameter <span id="S4.SS1.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_typewriter">whisper-large-v2</span> version and the English-only 244M parameter <span id="S4.SS1.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_typewriter">whisper-small.en</span> version.
For the summarization task, we use Llama2 7B/13B <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib62" title="" class="ltx_ref">2023b</a>)</cite>, Qwen 7B <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a href="#bib.bib4" title="" class="ltx_ref">2023a</a>)</cite>, and Gemma 7B <cite class="ltx_cite ltx_citemacro_citep">(Mesnard et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Draft models.</h5>

<div id="S4.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px4.p1.1" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_citet">Leviathan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a href="#bib.bib74" title="" class="ltx_ref">2024</a>)</cite> we either use smaller models of the same series or distilled versions of the target model for drafting.
The draft model family for the ASR task is Distil-Whisper <cite class="ltx_cite ltx_citemacro_citep">(Gandhi et al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>.
In particular, we use the 166M parameter <span id="S4.SS1.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_typewriter">small.en</span> and the 756M parameter <span id="S4.SS1.SSS0.Px4.p1.1.2" class="ltx_text ltx_font_typewriter">distil-large-v2</span> versions.
The draft model for Llama2 is Sheared-LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Xia et al., <a href="#bib.bib69" title="" class="ltx_ref">2024b</a>)</cite>, a version of Llama2 pruned to 1.3B parameters.
The draft models corresponding to Qwen and Gemma are the 500M and 2B parameter versions of the same series.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation details.</h5>

<div id="S4.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p1.1" class="ltx_p">We use the implementation of speculative sampling provided by the Transformers library <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al., <a href="#bib.bib65" title="" class="ltx_ref">2020</a>)</cite> (v4.38.2) in conjunction with PyTorch (v2.2.2) as our baseline.
All models are loaded in FP16 and executed on A100 GPUs with 80GB HBM using the same compute node running CUDA 12.3 and NVIDIA device driver version 545.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.11016/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="158" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.11016/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="164" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Average execution time of the speculative sampling algorithm per decoding step for varying initial <math id="S4.F3.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F3.2.m1.1b"><mi id="S4.F3.2.m1.1.1" xref="S4.F3.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F3.2.m1.1c"><ci id="S4.F3.2.m1.1.1.cmml" xref="S4.F3.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.m1.1d">\gamma</annotation></semantics></math> values on randomly sampled subsets (10%) of Xsum and CV16 test sets.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p"><a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 1</span></a> summarizes accuracy metrics and profiling results for ASR and text summarization tasks.
The table details the datasets, target and draft models used, performance metrics, and the relative reduction in overall GPU profiling time achieved by our optimized approaches (exact and sigmoid approximation) compared to the baseline.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In the ASR task, our exact optimization method maintains the same WER compared to the baseline and achieves reduction in profiling time ranging from 8.7% to 12.5%.
The sigmoid approximation approach results in slightly increased WERs, but yields more significant profiling time improvements, ranging from 71.9% to 84.0%.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">In the text summarization task, our exact optimization method demonstrates a similar trend as observed in the previous ASR experiments, reducing profiling time by 5.7% to 11.1% without affecting ROUGE-1 scores.
The non-exact sigmoid approximation further achieves significant profiling time reductions, reaching up to 93.6%.
However, we also observe an absolute difference in ROUGE-1 of 0.02 to 0.06 points.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Additionally, we provide relative wall-clock time improvements for the overall text generation process in <a href="#A1.T3" title="Table 3 ‣ Sheared-LLaMA. ‣ A.2 Draft model details ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a> of Appendix <a href="#A1.SS5" title="A.5 Average Times per Decoding Step ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">§ A.5</span></a>, showing that the results obtained via exact profiling translate into overall improvements in wall-clock time for both the exact and the sigmoid approximation method.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Analysis and discussion</h3>

<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Execution times remain stable over varying <math id="S4.SS3.SSS0.Px1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px1.1.m1.1b"><mi id="S4.SS3.SSS0.Px1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.1.m1.1c"><ci id="S4.SS3.SSS0.Px1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.1.m1.1d">\gamma</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.3" class="ltx_p">To assess the robustness of our exact and sigmoid optimization methods, we measure execution times across different models and varying numbers of initial draft tokens <math id="S4.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">\gamma</annotation></semantics></math>.
For text summarization, we randomly sample 10% of the Xsum test set and use Gemma, Qwen, and Llama2 model combinations to generate summaries.
For ASR, we use 10% of randomly sampled examples from the CV16 test set.
 <a href="#S4.F3.sf1" title="3(a) ‣ Figure 3 ‣ Implementation details. ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> and  <a href="#S4.F3.sf2" title="3(b) ‣ Figure 3 ‣ Implementation details. ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> illustrate the average execution times of the different implementations profiled per decoding step.
Both figures show average execution times measured in milliseconds (ms) for the number of draft tokens ranging from 1 to 20.
The average execution times for the optimized approaches (exact and sigmoid) are consistently below the baseline across all models and values of <math id="S4.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">\gamma</annotation></semantics></math>.
Furthermore, the execution times of the optimized approaches are stable across different choices of <math id="S4.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">\gamma</annotation></semantics></math> for the Gemma and Qwen models, whereas the Llama2 7B/Sheared LLaMA 1.3B model combination exhibits small sensitivity to the number of draft tokens.</p>
</div>
<div id="S4.SS3.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p2.1" class="ltx_p">As depicted in <a href="#S4.F3.sf2" title="3(b) ‣ Figure 3 ‣ Implementation details. ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, the ASR models also exhibit stable execution times across different <math id="S4.SS3.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">\gamma</annotation></semantics></math>, further validating the robustness of our optimization methods with varying numbers of draft tokens.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2406.11016/assets/x5.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Peak memory usage (HBM) on randomly sampled 10% of the <span id="S4.F4.4.1" class="ltx_text ltx_font_bold">Xsum</span> test set for varying initial values of <math id="S4.F4.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F4.2.m1.1b"><mi id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">\gamma</annotation></semantics></math>.
</figcaption>
</figure>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Optimized sampling does not introduce additional memory overhead.</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px2.p1.1" class="ltx_p">We assess the memory usage of our optimized methods relative to the baseline implementation.
<a href="#S4.F4" title="Figure 4 ‣ Execution times remain stable over varying 𝛾. ‣ 4.3 Analysis and discussion ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 4</span></a> shows the peak memory usage (HBM) on randomly sampled instances of the Xsum test set with various initial values of <math id="S4.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\gamma</annotation></semantics></math> and different language models.
The graph indicates that our optimized approaches do not introduce additional memory overhead compared to the baseline.
For all three model combinations (Llama2, Qwen, and Gemma), the memory usage of the optimized methods fluctuates slightly (within a range of approximately 200MB) around the memory usage of the baseline across all draft tokens.
As illustrated in <a href="#S4.F5" title="Figure 5 ‣ Effect of scaling logits. ‣ 4.3 Analysis and discussion ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 5</span></a>, the memory usage results for the Whisper models display a pattern consistent with the text summarization experiments, showing fluctuation within a range of under 10 MB.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Effect of scaling logits.</h5>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p1.4" class="ltx_p">To study the effect of logit scaling in the sigmoid approximation method, we compare profiling time and performance metrics under varying values of <math id="S4.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S4.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">\beta</annotation></semantics></math> (cf. <a href="#S3.E5" title="5 ‣ Sigmoid approximation. ‣ 3.2.2 Approximated optimization ‣ 3.2 Acceleration of speculative sampling ‣ 3 Method ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Eq. 5</span></a>).
<a href="#S4.T2" title="Table 2 ‣ Effect of scaling logits. ‣ 4.3 Analysis and discussion ‣ 4 Experiments ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 2</span></a> provides a comparison of different scaling factors for subsets (10%) of CV16 and Xsum using Whisper Small and Llama2 7B, respectively.
For each task, the table shows the values of <math id="S4.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">\alpha</annotation></semantics></math> and <math id="S4.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">\beta</annotation></semantics></math> applied, the resulting WER or ROUGE-1 score, and the relative improvement in profiling time over the non-optimized baseline implementation.
Note that scaling is necessary due to the numerical instability induced by the exponentiation in sigmoid.</p>
</div>
<div id="S4.SS3.SSS0.Px3.p2" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p2.3" class="ltx_p">The Llama2 model combination exhibits relative stability across different scaling factors, showing minor fluctuations in ROUGE-1 scores and profiling time improvements, whereas the Whisper model combination is more sensitive, with scaling factors of <math id="S4.SS3.SSS0.Px3.p2.1.m1.1" class="ltx_Math" alttext="\pm 10^{5}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p2.1.m1.1a"><mrow id="S4.SS3.SSS0.Px3.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.cmml"><mo id="S4.SS3.SSS0.Px3.p2.1.m1.1.1a" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.cmml">±</mo><msup id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.cmml"><mn id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.2" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.3" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p2.1.m1.1b"><apply id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1">plus-or-minus</csymbol><apply id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p2.1.m1.1c">\pm 10^{5}</annotation></semantics></math> leading to substantial deterioration of both WER and profiling time.
This can be attributed to the logits of Whisper models being generated in half precision, whereas the logits generated by the Llama models are available in full precision.
However, we also find that scaling factors of <math id="S4.SS3.SSS0.Px3.p2.2.m2.1" class="ltx_Math" alttext="\pm 10^{3}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p2.2.m2.1a"><mrow id="S4.SS3.SSS0.Px3.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.cmml"><mo id="S4.SS3.SSS0.Px3.p2.2.m2.1.1a" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.cmml">±</mo><msup id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.cmml"><mn id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.2" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.2.cmml">10</mn><mn id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.3" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p2.2.m2.1b"><apply id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1">plus-or-minus</csymbol><apply id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.2">10</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px3.p2.2.m2.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p2.2.m2.1c">\pm 10^{3}</annotation></semantics></math> and <math id="S4.SS3.SSS0.Px3.p2.3.m3.1" class="ltx_Math" alttext="\pm 10^{4}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p2.3.m3.1a"><mrow id="S4.SS3.SSS0.Px3.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.cmml"><mo id="S4.SS3.SSS0.Px3.p2.3.m3.1.1a" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.cmml">±</mo><msup id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.cmml"><mn id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.2" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.2.cmml">10</mn><mn id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.3" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p2.3.m3.1b"><apply id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1">plus-or-minus</csymbol><apply id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.2">10</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px3.p2.3.m3.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p2.3.m3.1c">\pm 10^{4}</annotation></semantics></math> generally yield comparable results in both accuracy and profiling time improvement across the model combinations investigated in this work.
The results of the same analysis for the other draft and target model combinations are in <a href="#A1.T5" title="Table 5 ‣ A.6 Effect of Scaling Logits ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 5</span></a> from Appendix <a href="#A1.SS6" title="A.6 Effect of Scaling Logits ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">§ A.6</span></a>.</p>
</div>
<div id="S4.SS3.SSS0.Px3.p3" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p3.1" class="ltx_p">Furthermore, we see a general trend where higher accuracy (lower WER and higher ROUGE-1) coincides with higher profiling time improvements.
This relationship is due to the token acceptance process, where better calibrated models accept more tokens, requiring fewer executions of resampling and fewer overall calls of the speculative sampling kernel.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2406.11016/assets/x6.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="366" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Peak memory usage (HBM) on randomly sampled 10% of the <span id="S4.F5.4.1" class="ltx_text ltx_font_bold">CV16</span> test set for varying initial values of <math id="S4.F5.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F5.2.m1.1b"><mi id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><ci id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">\gamma</annotation></semantics></math>.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.22" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:212.5pt;height:144.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-52.7pt,35.8pt) scale(0.668390855135529,0.668390855135529) ;">
<table id="S4.T2.22.22" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T2.3.3.3.4.1" class="ltx_text ltx_font_bold">Draft/Target</span></td>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">
<span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Scale</span> (<math id="S4.T2.1.1.1.1.m1.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="S4.T2.1.1.1.1.m1.2a"><mrow id="S4.T2.1.1.1.1.m1.2.3.2" xref="S4.T2.1.1.1.1.m1.2.3.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">α</mi><mo id="S4.T2.1.1.1.1.m1.2.3.2.1" xref="S4.T2.1.1.1.1.m1.2.3.1.cmml">,</mo><mi id="S4.T2.1.1.1.1.m1.2.2" xref="S4.T2.1.1.1.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.2b"><list id="S4.T2.1.1.1.1.m1.2.3.1.cmml" xref="S4.T2.1.1.1.1.m1.2.3.2"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝛼</ci><ci id="S4.T2.1.1.1.1.m1.2.2.cmml" xref="S4.T2.1.1.1.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.2c">\alpha,\beta</annotation></semantics></math>)</td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T2.2.2.2.2.1" class="ltx_text ltx_font_bold">WER <math id="S4.T2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="(\downarrow)" display="inline"><semantics id="S4.T2.2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.2.1.m1.1.2.2"><mo stretchy="false" id="S4.T2.2.2.2.2.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="S4.T2.2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.2.1.m1.1.1.cmml">↓</mo><mo stretchy="false" id="S4.T2.2.2.2.2.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.1.m1.1b"><ci id="S4.T2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.1.m1.1c">(\downarrow)</annotation></semantics></math></span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">
<math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mi mathvariant="normal" id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\Delta</annotation></semantics></math>% <span id="S4.T2.3.3.3.3.1" class="ltx_text ltx_font_bold">Prof. Time</span>
</td>
</tr>
<tr id="S4.T2.22.22.23" class="ltx_tr">
<td id="S4.T2.22.22.23.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="S4.T2.22.22.23.1.1" class="ltx_text"><span id="S4.T2.22.22.23.1.1.1" class="ltx_text"></span> <span id="S4.T2.22.22.23.1.1.2" class="ltx_text">
<span id="S4.T2.22.22.23.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.22.22.23.1.1.2.1.1" class="ltx_tr">
<span id="S4.T2.22.22.23.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Whisper Small.EN</span></span>
<span id="S4.T2.22.22.23.1.1.2.1.2" class="ltx_tr">
<span id="S4.T2.22.22.23.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distil Small.EN</span></span>
</span></span> <span id="S4.T2.22.22.23.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T2.22.22.23.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="S4.T2.22.22.23.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.24</td>
<td id="S4.T2.22.22.23.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="S4.T2.5.5.5" class="ltx_tr">
<td id="S4.T2.4.4.4.1" class="ltx_td ltx_align_center"><math id="S4.T2.4.4.4.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="S4.T2.4.4.4.1.m1.1a"><mrow id="S4.T2.4.4.4.1.m1.1.1" xref="S4.T2.4.4.4.1.m1.1.1.cmml"><mo id="S4.T2.4.4.4.1.m1.1.1a" xref="S4.T2.4.4.4.1.m1.1.1.cmml">−</mo><msup id="S4.T2.4.4.4.1.m1.1.1.2" xref="S4.T2.4.4.4.1.m1.1.1.2.cmml"><mn id="S4.T2.4.4.4.1.m1.1.1.2.2" xref="S4.T2.4.4.4.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.4.4.4.1.m1.1.1.2.3" xref="S4.T2.4.4.4.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.1.m1.1b"><apply id="S4.T2.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1"><minus id="S4.T2.4.4.4.1.m1.1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1"></minus><apply id="S4.T2.4.4.4.1.m1.1.1.2.cmml" xref="S4.T2.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.4.4.4.1.m1.1.1.2.2.cmml" xref="S4.T2.4.4.4.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.4.4.4.1.m1.1.1.2.3.cmml" xref="S4.T2.4.4.4.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="S4.T2.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.5.5.5.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="S4.T2.5.5.5.2.m1.1a"><msup id="S4.T2.5.5.5.2.m1.1.1" xref="S4.T2.5.5.5.2.m1.1.1.cmml"><mn id="S4.T2.5.5.5.2.m1.1.1.2" xref="S4.T2.5.5.5.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.5.5.5.2.m1.1.1.3" xref="S4.T2.5.5.5.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.2.m1.1b"><apply id="S4.T2.5.5.5.2.m1.1.1.cmml" xref="S4.T2.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.5.5.5.2.m1.1.1.1.cmml" xref="S4.T2.5.5.5.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.5.5.5.2.m1.1.1.2.cmml" xref="S4.T2.5.5.5.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.5.5.5.2.m1.1.1.3.cmml" xref="S4.T2.5.5.5.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="S4.T2.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r">0.41</td>
<td id="S4.T2.5.5.5.4" class="ltx_td ltx_align_center">24.0%</td>
</tr>
<tr id="S4.T2.7.7.7" class="ltx_tr">
<td id="S4.T2.6.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T2.6.6.6.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="S4.T2.6.6.6.1.m1.1a"><mrow id="S4.T2.6.6.6.1.m1.1.1" xref="S4.T2.6.6.6.1.m1.1.1.cmml"><mo id="S4.T2.6.6.6.1.m1.1.1a" xref="S4.T2.6.6.6.1.m1.1.1.cmml">−</mo><msup id="S4.T2.6.6.6.1.m1.1.1.2" xref="S4.T2.6.6.6.1.m1.1.1.2.cmml"><mn id="S4.T2.6.6.6.1.m1.1.1.2.2" xref="S4.T2.6.6.6.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.6.6.6.1.m1.1.1.2.3" xref="S4.T2.6.6.6.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.1.m1.1b"><apply id="S4.T2.6.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.6.1.m1.1.1"><minus id="S4.T2.6.6.6.1.m1.1.1.1.cmml" xref="S4.T2.6.6.6.1.m1.1.1"></minus><apply id="S4.T2.6.6.6.1.m1.1.1.2.cmml" xref="S4.T2.6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.6.6.6.1.m1.1.1.2.1.cmml" xref="S4.T2.6.6.6.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.6.6.6.1.m1.1.1.2.2.cmml" xref="S4.T2.6.6.6.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.6.6.6.1.m1.1.1.2.3.cmml" xref="S4.T2.6.6.6.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="S4.T2.7.7.7.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.7.7.7.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="S4.T2.7.7.7.2.m1.1a"><msup id="S4.T2.7.7.7.2.m1.1.1" xref="S4.T2.7.7.7.2.m1.1.1.cmml"><mn id="S4.T2.7.7.7.2.m1.1.1.2" xref="S4.T2.7.7.7.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.7.7.7.2.m1.1.1.3" xref="S4.T2.7.7.7.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.2.m1.1b"><apply id="S4.T2.7.7.7.2.m1.1.1.cmml" xref="S4.T2.7.7.7.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.7.7.7.2.m1.1.1.1.cmml" xref="S4.T2.7.7.7.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.7.7.7.2.m1.1.1.2.cmml" xref="S4.T2.7.7.7.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.7.7.7.2.m1.1.1.3.cmml" xref="S4.T2.7.7.7.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="S4.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_border_r">0.28</td>
<td id="S4.T2.7.7.7.4" class="ltx_td ltx_align_center">59.5%</td>
</tr>
<tr id="S4.T2.9.9.9" class="ltx_tr">
<td id="S4.T2.8.8.8.1" class="ltx_td ltx_align_center"><math id="S4.T2.8.8.8.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="S4.T2.8.8.8.1.m1.1a"><mrow id="S4.T2.8.8.8.1.m1.1.1" xref="S4.T2.8.8.8.1.m1.1.1.cmml"><mo id="S4.T2.8.8.8.1.m1.1.1a" xref="S4.T2.8.8.8.1.m1.1.1.cmml">−</mo><msup id="S4.T2.8.8.8.1.m1.1.1.2" xref="S4.T2.8.8.8.1.m1.1.1.2.cmml"><mn id="S4.T2.8.8.8.1.m1.1.1.2.2" xref="S4.T2.8.8.8.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.8.8.8.1.m1.1.1.2.3" xref="S4.T2.8.8.8.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.1.m1.1b"><apply id="S4.T2.8.8.8.1.m1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1"><minus id="S4.T2.8.8.8.1.m1.1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1"></minus><apply id="S4.T2.8.8.8.1.m1.1.1.2.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.8.8.8.1.m1.1.1.2.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.8.8.8.1.m1.1.1.2.2.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.8.8.8.1.m1.1.1.2.3.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="S4.T2.9.9.9.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.9.9.9.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="S4.T2.9.9.9.2.m1.1a"><msup id="S4.T2.9.9.9.2.m1.1.1" xref="S4.T2.9.9.9.2.m1.1.1.cmml"><mn id="S4.T2.9.9.9.2.m1.1.1.2" xref="S4.T2.9.9.9.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.9.9.9.2.m1.1.1.3" xref="S4.T2.9.9.9.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.2.m1.1b"><apply id="S4.T2.9.9.9.2.m1.1.1.cmml" xref="S4.T2.9.9.9.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.9.9.9.2.m1.1.1.1.cmml" xref="S4.T2.9.9.9.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.9.9.9.2.m1.1.1.2.cmml" xref="S4.T2.9.9.9.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.9.9.9.2.m1.1.1.3.cmml" xref="S4.T2.9.9.9.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="S4.T2.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r">0.26</td>
<td id="S4.T2.9.9.9.4" class="ltx_td ltx_align_center">64.6%</td>
</tr>
<tr id="S4.T2.11.11.11" class="ltx_tr">
<td id="S4.T2.10.10.10.1" class="ltx_td ltx_align_center"><math id="S4.T2.10.10.10.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="S4.T2.10.10.10.1.m1.1a"><mrow id="S4.T2.10.10.10.1.m1.1.1" xref="S4.T2.10.10.10.1.m1.1.1.cmml"><mo id="S4.T2.10.10.10.1.m1.1.1a" xref="S4.T2.10.10.10.1.m1.1.1.cmml">−</mo><msup id="S4.T2.10.10.10.1.m1.1.1.2" xref="S4.T2.10.10.10.1.m1.1.1.2.cmml"><mn id="S4.T2.10.10.10.1.m1.1.1.2.2" xref="S4.T2.10.10.10.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.10.10.10.1.m1.1.1.2.3" xref="S4.T2.10.10.10.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.1.m1.1b"><apply id="S4.T2.10.10.10.1.m1.1.1.cmml" xref="S4.T2.10.10.10.1.m1.1.1"><minus id="S4.T2.10.10.10.1.m1.1.1.1.cmml" xref="S4.T2.10.10.10.1.m1.1.1"></minus><apply id="S4.T2.10.10.10.1.m1.1.1.2.cmml" xref="S4.T2.10.10.10.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.10.10.10.1.m1.1.1.2.1.cmml" xref="S4.T2.10.10.10.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.10.10.10.1.m1.1.1.2.2.cmml" xref="S4.T2.10.10.10.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.10.10.10.1.m1.1.1.2.3.cmml" xref="S4.T2.10.10.10.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="S4.T2.11.11.11.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.11.11.11.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="S4.T2.11.11.11.2.m1.1a"><msup id="S4.T2.11.11.11.2.m1.1.1" xref="S4.T2.11.11.11.2.m1.1.1.cmml"><mn id="S4.T2.11.11.11.2.m1.1.1.2" xref="S4.T2.11.11.11.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.11.11.11.2.m1.1.1.3" xref="S4.T2.11.11.11.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.2.m1.1b"><apply id="S4.T2.11.11.11.2.m1.1.1.cmml" xref="S4.T2.11.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.11.11.11.2.m1.1.1.1.cmml" xref="S4.T2.11.11.11.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.11.11.11.2.m1.1.1.2.cmml" xref="S4.T2.11.11.11.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.11.11.11.2.m1.1.1.3.cmml" xref="S4.T2.11.11.11.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="S4.T2.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r">29.34</td>
<td id="S4.T2.11.11.11.4" class="ltx_td ltx_align_center">-10826.1%</td>
</tr>
<tr id="S4.T2.14.14.14" class="ltx_tr">
<td id="S4.T2.14.14.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt"><span id="S4.T2.14.14.14.4.1" class="ltx_text ltx_font_bold">Draft/Target</span></td>
<td id="S4.T2.12.12.12.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" colspan="2">
<span id="S4.T2.12.12.12.1.1" class="ltx_text ltx_font_bold">Scale</span> (<math id="S4.T2.12.12.12.1.m1.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="S4.T2.12.12.12.1.m1.2a"><mrow id="S4.T2.12.12.12.1.m1.2.3.2" xref="S4.T2.12.12.12.1.m1.2.3.1.cmml"><mi id="S4.T2.12.12.12.1.m1.1.1" xref="S4.T2.12.12.12.1.m1.1.1.cmml">α</mi><mo id="S4.T2.12.12.12.1.m1.2.3.2.1" xref="S4.T2.12.12.12.1.m1.2.3.1.cmml">,</mo><mi id="S4.T2.12.12.12.1.m1.2.2" xref="S4.T2.12.12.12.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.1.m1.2b"><list id="S4.T2.12.12.12.1.m1.2.3.1.cmml" xref="S4.T2.12.12.12.1.m1.2.3.2"><ci id="S4.T2.12.12.12.1.m1.1.1.cmml" xref="S4.T2.12.12.12.1.m1.1.1">𝛼</ci><ci id="S4.T2.12.12.12.1.m1.2.2.cmml" xref="S4.T2.12.12.12.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.1.m1.2c">\alpha,\beta</annotation></semantics></math>)</td>
<td id="S4.T2.13.13.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt"><span id="S4.T2.13.13.13.2.1" class="ltx_text ltx_font_bold">ROUGE-1 <math id="S4.T2.13.13.13.2.1.m1.1" class="ltx_Math" alttext="(\uparrow)" display="inline"><semantics id="S4.T2.13.13.13.2.1.m1.1a"><mrow id="S4.T2.13.13.13.2.1.m1.1.2.2"><mo stretchy="false" id="S4.T2.13.13.13.2.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="S4.T2.13.13.13.2.1.m1.1.1" xref="S4.T2.13.13.13.2.1.m1.1.1.cmml">↑</mo><mo stretchy="false" id="S4.T2.13.13.13.2.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.2.1.m1.1b"><ci id="S4.T2.13.13.13.2.1.m1.1.1.cmml" xref="S4.T2.13.13.13.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.2.1.m1.1c">(\uparrow)</annotation></semantics></math></span></td>
<td id="S4.T2.14.14.14.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt">
<math id="S4.T2.14.14.14.3.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T2.14.14.14.3.m1.1a"><mi mathvariant="normal" id="S4.T2.14.14.14.3.m1.1.1" xref="S4.T2.14.14.14.3.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.3.m1.1b"><ci id="S4.T2.14.14.14.3.m1.1.1.cmml" xref="S4.T2.14.14.14.3.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.3.m1.1c">\Delta</annotation></semantics></math>% <span id="S4.T2.14.14.14.3.1" class="ltx_text ltx_font_bold">Prof. Time</span>
</td>
</tr>
<tr id="S4.T2.22.22.24" class="ltx_tr">
<td id="S4.T2.22.22.24.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" rowspan="5"><span id="S4.T2.22.22.24.1.1" class="ltx_text"><span id="S4.T2.22.22.24.1.1.1" class="ltx_text"></span> <span id="S4.T2.22.22.24.1.1.2" class="ltx_text">
<span id="S4.T2.22.22.24.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.22.22.24.1.1.2.1.1" class="ltx_tr">
<span id="S4.T2.22.22.24.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Llama2 7B/</span></span>
<span id="S4.T2.22.22.24.1.1.2.1.2" class="ltx_tr">
<span id="S4.T2.22.22.24.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Sheared 1.3B</span></span>
</span></span> <span id="S4.T2.22.22.24.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T2.22.22.24.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="S4.T2.22.22.24.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.19</td>
<td id="S4.T2.22.22.24.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="S4.T2.16.16.16" class="ltx_tr">
<td id="S4.T2.15.15.15.1" class="ltx_td ltx_align_center"><math id="S4.T2.15.15.15.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="S4.T2.15.15.15.1.m1.1a"><mrow id="S4.T2.15.15.15.1.m1.1.1" xref="S4.T2.15.15.15.1.m1.1.1.cmml"><mo id="S4.T2.15.15.15.1.m1.1.1a" xref="S4.T2.15.15.15.1.m1.1.1.cmml">−</mo><msup id="S4.T2.15.15.15.1.m1.1.1.2" xref="S4.T2.15.15.15.1.m1.1.1.2.cmml"><mn id="S4.T2.15.15.15.1.m1.1.1.2.2" xref="S4.T2.15.15.15.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.15.15.15.1.m1.1.1.2.3" xref="S4.T2.15.15.15.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.1.m1.1b"><apply id="S4.T2.15.15.15.1.m1.1.1.cmml" xref="S4.T2.15.15.15.1.m1.1.1"><minus id="S4.T2.15.15.15.1.m1.1.1.1.cmml" xref="S4.T2.15.15.15.1.m1.1.1"></minus><apply id="S4.T2.15.15.15.1.m1.1.1.2.cmml" xref="S4.T2.15.15.15.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.15.15.15.1.m1.1.1.2.1.cmml" xref="S4.T2.15.15.15.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.15.15.15.1.m1.1.1.2.2.cmml" xref="S4.T2.15.15.15.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.15.15.15.1.m1.1.1.2.3.cmml" xref="S4.T2.15.15.15.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="S4.T2.16.16.16.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.16.16.16.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="S4.T2.16.16.16.2.m1.1a"><msup id="S4.T2.16.16.16.2.m1.1.1" xref="S4.T2.16.16.16.2.m1.1.1.cmml"><mn id="S4.T2.16.16.16.2.m1.1.1.2" xref="S4.T2.16.16.16.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.16.16.16.2.m1.1.1.3" xref="S4.T2.16.16.16.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.16.2.m1.1b"><apply id="S4.T2.16.16.16.2.m1.1.1.cmml" xref="S4.T2.16.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.16.16.16.2.m1.1.1.1.cmml" xref="S4.T2.16.16.16.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.16.16.16.2.m1.1.1.2.cmml" xref="S4.T2.16.16.16.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.16.16.16.2.m1.1.1.3.cmml" xref="S4.T2.16.16.16.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.16.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="S4.T2.16.16.16.3" class="ltx_td ltx_align_center ltx_border_r">0.16</td>
<td id="S4.T2.16.16.16.4" class="ltx_td ltx_align_center">49.8%</td>
</tr>
<tr id="S4.T2.18.18.18" class="ltx_tr">
<td id="S4.T2.17.17.17.1" class="ltx_td ltx_align_center"><math id="S4.T2.17.17.17.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="S4.T2.17.17.17.1.m1.1a"><mrow id="S4.T2.17.17.17.1.m1.1.1" xref="S4.T2.17.17.17.1.m1.1.1.cmml"><mo id="S4.T2.17.17.17.1.m1.1.1a" xref="S4.T2.17.17.17.1.m1.1.1.cmml">−</mo><msup id="S4.T2.17.17.17.1.m1.1.1.2" xref="S4.T2.17.17.17.1.m1.1.1.2.cmml"><mn id="S4.T2.17.17.17.1.m1.1.1.2.2" xref="S4.T2.17.17.17.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.17.17.17.1.m1.1.1.2.3" xref="S4.T2.17.17.17.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.17.1.m1.1b"><apply id="S4.T2.17.17.17.1.m1.1.1.cmml" xref="S4.T2.17.17.17.1.m1.1.1"><minus id="S4.T2.17.17.17.1.m1.1.1.1.cmml" xref="S4.T2.17.17.17.1.m1.1.1"></minus><apply id="S4.T2.17.17.17.1.m1.1.1.2.cmml" xref="S4.T2.17.17.17.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.17.17.17.1.m1.1.1.2.1.cmml" xref="S4.T2.17.17.17.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.17.17.17.1.m1.1.1.2.2.cmml" xref="S4.T2.17.17.17.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.17.17.17.1.m1.1.1.2.3.cmml" xref="S4.T2.17.17.17.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.17.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="S4.T2.18.18.18.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.18.18.18.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="S4.T2.18.18.18.2.m1.1a"><msup id="S4.T2.18.18.18.2.m1.1.1" xref="S4.T2.18.18.18.2.m1.1.1.cmml"><mn id="S4.T2.18.18.18.2.m1.1.1.2" xref="S4.T2.18.18.18.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.18.18.18.2.m1.1.1.3" xref="S4.T2.18.18.18.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.18.2.m1.1b"><apply id="S4.T2.18.18.18.2.m1.1.1.cmml" xref="S4.T2.18.18.18.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.18.18.18.2.m1.1.1.1.cmml" xref="S4.T2.18.18.18.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.18.18.18.2.m1.1.1.2.cmml" xref="S4.T2.18.18.18.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.18.18.18.2.m1.1.1.3.cmml" xref="S4.T2.18.18.18.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.18.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="S4.T2.18.18.18.3" class="ltx_td ltx_align_center ltx_border_r">0.16</td>
<td id="S4.T2.18.18.18.4" class="ltx_td ltx_align_center">53.4%</td>
</tr>
<tr id="S4.T2.20.20.20" class="ltx_tr">
<td id="S4.T2.19.19.19.1" class="ltx_td ltx_align_center"><math id="S4.T2.19.19.19.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="S4.T2.19.19.19.1.m1.1a"><mrow id="S4.T2.19.19.19.1.m1.1.1" xref="S4.T2.19.19.19.1.m1.1.1.cmml"><mo id="S4.T2.19.19.19.1.m1.1.1a" xref="S4.T2.19.19.19.1.m1.1.1.cmml">−</mo><msup id="S4.T2.19.19.19.1.m1.1.1.2" xref="S4.T2.19.19.19.1.m1.1.1.2.cmml"><mn id="S4.T2.19.19.19.1.m1.1.1.2.2" xref="S4.T2.19.19.19.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.19.19.19.1.m1.1.1.2.3" xref="S4.T2.19.19.19.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.19.1.m1.1b"><apply id="S4.T2.19.19.19.1.m1.1.1.cmml" xref="S4.T2.19.19.19.1.m1.1.1"><minus id="S4.T2.19.19.19.1.m1.1.1.1.cmml" xref="S4.T2.19.19.19.1.m1.1.1"></minus><apply id="S4.T2.19.19.19.1.m1.1.1.2.cmml" xref="S4.T2.19.19.19.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.19.19.19.1.m1.1.1.2.1.cmml" xref="S4.T2.19.19.19.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.19.19.19.1.m1.1.1.2.2.cmml" xref="S4.T2.19.19.19.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.19.19.19.1.m1.1.1.2.3.cmml" xref="S4.T2.19.19.19.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.19.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="S4.T2.20.20.20.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.20.20.20.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="S4.T2.20.20.20.2.m1.1a"><msup id="S4.T2.20.20.20.2.m1.1.1" xref="S4.T2.20.20.20.2.m1.1.1.cmml"><mn id="S4.T2.20.20.20.2.m1.1.1.2" xref="S4.T2.20.20.20.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.20.20.20.2.m1.1.1.3" xref="S4.T2.20.20.20.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.20.2.m1.1b"><apply id="S4.T2.20.20.20.2.m1.1.1.cmml" xref="S4.T2.20.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.20.20.20.2.m1.1.1.1.cmml" xref="S4.T2.20.20.20.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.20.20.20.2.m1.1.1.2.cmml" xref="S4.T2.20.20.20.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.20.20.20.2.m1.1.1.3.cmml" xref="S4.T2.20.20.20.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.20.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="S4.T2.20.20.20.3" class="ltx_td ltx_align_center ltx_border_r">0.15</td>
<td id="S4.T2.20.20.20.4" class="ltx_td ltx_align_center">50.0%</td>
</tr>
<tr id="S4.T2.22.22.22" class="ltx_tr">
<td id="S4.T2.21.21.21.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T2.21.21.21.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="S4.T2.21.21.21.1.m1.1a"><mrow id="S4.T2.21.21.21.1.m1.1.1" xref="S4.T2.21.21.21.1.m1.1.1.cmml"><mo id="S4.T2.21.21.21.1.m1.1.1a" xref="S4.T2.21.21.21.1.m1.1.1.cmml">−</mo><msup id="S4.T2.21.21.21.1.m1.1.1.2" xref="S4.T2.21.21.21.1.m1.1.1.2.cmml"><mn id="S4.T2.21.21.21.1.m1.1.1.2.2" xref="S4.T2.21.21.21.1.m1.1.1.2.2.cmml">10</mn><mn id="S4.T2.21.21.21.1.m1.1.1.2.3" xref="S4.T2.21.21.21.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.21.1.m1.1b"><apply id="S4.T2.21.21.21.1.m1.1.1.cmml" xref="S4.T2.21.21.21.1.m1.1.1"><minus id="S4.T2.21.21.21.1.m1.1.1.1.cmml" xref="S4.T2.21.21.21.1.m1.1.1"></minus><apply id="S4.T2.21.21.21.1.m1.1.1.2.cmml" xref="S4.T2.21.21.21.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.21.21.21.1.m1.1.1.2.1.cmml" xref="S4.T2.21.21.21.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="S4.T2.21.21.21.1.m1.1.1.2.2.cmml" xref="S4.T2.21.21.21.1.m1.1.1.2.2">10</cn><cn type="integer" id="S4.T2.21.21.21.1.m1.1.1.2.3.cmml" xref="S4.T2.21.21.21.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.21.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="S4.T2.22.22.22.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S4.T2.22.22.22.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="S4.T2.22.22.22.2.m1.1a"><msup id="S4.T2.22.22.22.2.m1.1.1" xref="S4.T2.22.22.22.2.m1.1.1.cmml"><mn id="S4.T2.22.22.22.2.m1.1.1.2" xref="S4.T2.22.22.22.2.m1.1.1.2.cmml">10</mn><mn id="S4.T2.22.22.22.2.m1.1.1.3" xref="S4.T2.22.22.22.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.22.2.m1.1b"><apply id="S4.T2.22.22.22.2.m1.1.1.cmml" xref="S4.T2.22.22.22.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.22.22.22.2.m1.1.1.1.cmml" xref="S4.T2.22.22.22.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T2.22.22.22.2.m1.1.1.2.cmml" xref="S4.T2.22.22.22.2.m1.1.1.2">10</cn><cn type="integer" id="S4.T2.22.22.22.2.m1.1.1.3.cmml" xref="S4.T2.22.22.22.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.22.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="S4.T2.22.22.22.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">0.16</td>
<td id="S4.T2.22.22.22.4" class="ltx_td ltx_align_center ltx_border_bb">51.9%</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Impact of varying <math id="S4.T2.25.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.25.m1.1b"><mi id="S4.T2.25.m1.1.1" xref="S4.T2.25.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.25.m1.1c"><ci id="S4.T2.25.m1.1.1.cmml" xref="S4.T2.25.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.m1.1d">\alpha</annotation></semantics></math> and <math id="S4.T2.26.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T2.26.m2.1b"><mi id="S4.T2.26.m2.1.1" xref="S4.T2.26.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T2.26.m2.1c"><ci id="S4.T2.26.m2.1.1.cmml" xref="S4.T2.26.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.26.m2.1d">\beta</annotation></semantics></math> on accuracy and profiling time of sigmoid approximation on <span id="S4.T2.29.1" class="ltx_text ltx_font_bold">CV16</span> and <span id="S4.T2.30.2" class="ltx_text ltx_font_bold">Xsum</span>.
</figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We introduced two optimization methods to accelerate speculative sampling for autoregressive models on hardware accelerators.
By computing significant portions of intermediate matrices across multiple GPU threads within thread blocks and by minimizing slow read and write operations across the memory hierarchy, our exact optimization method led to improved sampling speed without compromising accuracy.
Additionally, we employed an approximation technique using element-wise sigmoid instead of softmax, to enable parallel computation of probabilities.
This approximation further accelerated the decoding process but resulted in a small degradation of sampling quality.
</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we study the inference efficiency of speech and language models in the context of speculative decoding using GPU hardware accelerators.
Our investigation includes two optimized speculative sampling algorithms, tested on these models to enhance inference speed.
While GPUs are the most common general-purpose hardware accelerators, there exist purpose-built architectures such as Cerebras’s Wafer Scale Engines, Google’s TPUs, and GraphCore’s IPUs, where the differences in system design may negate or significantly reduce our latency gains.
A key component of our approach relies on minimizing read and write operations between HBM and SRAM.
If this bottleneck is alleviated by the underlying hardware itself, <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, through a much larger SRAM, our approach is unlikely to yield significant improvements.
Additionally, our study evaluates the effectiveness of the optimized algorithm based on decoding time, and our claims may not translate to other metrics, such as energy usage or heat generation, although they play an important role in real-world production settings.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2024)</span>
<span class="ltx_bibblock">
Josh Achiam et al. 2024.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2303.08774" title="" class="ltx_ref ltx_href">GPT-4 technical report</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Preprint</em>, arXiv:2303.08774.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil et al. (2023)</span>
<span class="ltx_bibblock">
Rohan Anil, Sebastian Borgeaud, Yonghui Wu, Jean-Baptiste Alayrac, Jiahui Yu, Radu Soricut, Johan Schalkwyk, Andrew M Dai, Anja Hauth, et al. 2023.

</span>
<span class="ltx_bibblock">Gemini: a family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.11805</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ardila et al. (2020)</span>
<span class="ltx_bibblock">
Rosana Ardila, Megan Branson, Kelly Davis, Michael Kohler, Josh Meyer, Michael Henretty, Reuben Morais, Lindsay Saunders, Francis Tyers, and Gregor Weber. 2020.

</span>
<span class="ltx_bibblock">Common Voice: A massively-multilingual speech corpus.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">LREC</em>, pages 4218–4222.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023a)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, et al. 2023a.

</span>
<span class="ltx_bibblock">Qwen technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16609</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023b)</span>
<span class="ltx_bibblock">
Yu Bai, Fan Chen, Huan Wang, Caiming Xiong, and Song Mei. 2023b.

</span>
<span class="ltx_bibblock">Transformers as statisticians: Provable in-context learning with in-context algorithm selection.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (Neurips)</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bondarenko et al. (2023)</span>
<span class="ltx_bibblock">
Yelysei Bondarenko, Markus Nagel, and Tijmen Blankevoort. 2023.

</span>
<span class="ltx_bibblock">Quantizable transformers: Removing outliers by helping attention heads do nothing.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bridle (1989)</span>
<span class="ltx_bibblock">
John Bridle. 1989.

</span>
<span class="ltx_bibblock">Training stochastic model recognition algorithms as networks can lead to maximum mutual information estimation of parameters.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2024)</span>
<span class="ltx_bibblock">
Tianle Cai, Yuhong Li, Zhengyang Geng, Hongwu Peng, Jason D Lee, Deming Chen, and Tri Dao. 2024.

</span>
<span class="ltx_bibblock">Medusa: Simple LLM inference acceleration framework with multiple decoding heads.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.10774</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Charlie Chen, Sebastian Borgeaud, Geoffrey Irving, Jean-Baptiste Lespiau, Laurent Sifre, and John Jumper. 2023a.

</span>
<span class="ltx_bibblock">Accelerating large language model decoding with speculative sampling.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.01318</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Ke Chen, Yue Gao, Haroon Waris, Weiqiang Liu, and Fabrizio Lombardi. 2023b.

</span>
<span class="ltx_bibblock">Approximate softmax functions for energy-efficient deep neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Very Large Scale Integration (VLSI) Systems</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2014)</span>
<span class="ltx_bibblock">
J. Cheng, M. Grossman, and T. McKercher. 2014.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Professional CUDA C Programming</em>.

</span>
<span class="ltx_bibblock">Wiley.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chi et al. (2023)</span>
<span class="ltx_bibblock">
Ryan A Chi, Jeremy Kim, Scott Hickmann, Siyan Li, Gordon Chi, Thanawan Atchariyachanvanit, Katherine Yu, Nathan A Chi, Gary Dai, Shashank Rammoorthy, et al. 2023.

</span>
<span class="ltx_bibblock">Dialogue distillery: Crafting interpolable, interpretable, and introspectable dialogue from LLMs.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Alexa Prize SocialBot Grand Challenge</em>, 5.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao (2024)</span>
<span class="ltx_bibblock">
Tri Dao. 2024.

</span>
<span class="ltx_bibblock">FlashAttention-2: Faster attention with better parallelism and work partitioning.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Daniel Y Fu, Stefano Ermon, Atri Rudra, and Christopher Re. 2022.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with IO-awareness.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al. (2022)</span>
<span class="ltx_bibblock">
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer. 2022.

</span>
<span class="ltx_bibblock">GPT3.int8(): 8-bit matrix multiplication for transformers at scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fernandez et al. (2023)</span>
<span class="ltx_bibblock">
Jared Fernandez, Jacob Kahn, Clara Na, Yonatan Bisk, and Emma Strubell. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2023.emnlp-main.98" title="" class="ltx_ref ltx_href">The framework tax: Disparities between inference efficiency in NLP research and deployment</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 1588–1600, Singapore. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fischer et al. (2024)</span>
<span class="ltx_bibblock">
Sophie Fischer, Carlos Gemmell, Niklas Tecklenburg, Iain Mackie, Federico Rossetto, and Jeffrey Dalton. 2024.

</span>
<span class="ltx_bibblock">GRILLBot in practice: Lessons and tradeoffs deploying large language models for adaptable conversational task assistants.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.07647</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gandhi et al. (2023)</span>
<span class="ltx_bibblock">
Sanchit Gandhi, Patrick von Platen, and Alexander M Rush. 2023.

</span>
<span class="ltx_bibblock">Distil-whisper: Robust knowledge distillation via large-scale pseudo labelling.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.00430</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. (2018)</span>
<span class="ltx_bibblock">
Xue Geng, Jie Lin, Bin Zhao, Anmin Kong, Mohamed M. Sabry Aly, and Vijay Ramaseshan Chandrasekhar. 2018.

</span>
<span class="ltx_bibblock">Hardware-aware softmax approximation for deep neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Asian Conference on Computer Vision</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grave et al. (2017)</span>
<span class="ltx_bibblock">
Édouard Grave, Armand Joulin, Moustapha Cissé, David Grangier Facebook AI Research, and Hervé Jégou. 2017.

</span>
<span class="ltx_bibblock">Efficient softmax approximation for GPUs.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gromov et al. (2024)</span>
<span class="ltx_bibblock">
Andrey Gromov, Kushal Tirumala, Hassan Shapourian, Paolo Glorioso, and Daniel A Roberts. 2024.

</span>
<span class="ltx_bibblock">The unreasonable ineffectiveness of the deeper layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.17887</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harris (2007)</span>
<span class="ltx_bibblock">
Mark Harris. 2007.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://developer.download.nvidia.com/assets/cuda/files/reduction.pdf" title="" class="ltx_ref ltx_href">Optimizing parallel reduction in cuda</a>.

</span>
<span class="ltx_bibblock">Technical report, NVIDIA.

</span>
<span class="ltx_bibblock">Accessed: 2024-06-12.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al. (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeffrey Dean. 2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">NIPS Deep Learning and Representation Learning Workshop</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hron et al. (2020)</span>
<span class="ltx_bibblock">
Jiri Hron, Yasaman Bahri, Jascha Narain Sohl-Dickstein, and Roman Novak. 2020.

</span>
<span class="ltx_bibblock">Infinite attention: Nngp and ntk for deep attention networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2023)</span>
<span class="ltx_bibblock">
Cheng-Yu Hsieh, Chun-Liang Li, Chih-kuan Yeh, Hootan Nakhost, Yasuhisa Fujii, Alex Ratner, Ranjay Krishna, Chen-Yu Lee, and Tomas Pfister. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2023.findings-acl.507" title="" class="ltx_ref ltx_href">Distilling step-by-step! outperforming larger language models with less training data and smaller model sizes</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: ACL 2023</em>, pages 8003–8017, Toronto, Canada. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2021)</span>
<span class="ltx_bibblock">
Wei-Ning Hsu, Benjamin Bolte, Yao-Hung Hubert Tsai, Kushal Lakhotia, Ruslan Salakhutdinov, and Abdelrahman Mohamed. 2021.

</span>
<span class="ltx_bibblock">Hubert: Self-supervised speech representation learning by masked prediction of hidden units.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM Trans. Audio, Speech and Lang. Proc.</em>, page 3451–3460.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al. (2022)</span>
<span class="ltx_bibblock">
Weizhe Hua, Zihang Dai, Hanxiao Liu, and Quoc Le. 2022.

</span>
<span class="ltx_bibblock">Transformer quality in linear time.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2018)</span>
<span class="ltx_bibblock">
Zhe Jia, Marco Maggioni, Benjamin Staiger, and Daniele P. Scarpazza. 2018.

</span>
<span class="ltx_bibblock">Dissecting the NVIDIA volta GPU architecture via microbenchmarking.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arxiv preprint arXiv:1804.06826</em>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiao et al. (2020)</span>
<span class="ltx_bibblock">
Xiaoqi Jiao, Yichun Yin, Lifeng Shang, Xin Jiang, Xiao Chen, Linlin Li, Fang Wang, and Qun Liu. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2020.findings-emnlp.372" title="" class="ltx_ref ltx_href">TinyBERT: Distilling BERT for natural language understanding</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: EMNLP 2020</em>, pages 4163–4174, Online. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lagunas et al. (2021)</span>
<span class="ltx_bibblock">
François Lagunas, Ella Charlaix, Victor Sanh, and Alexander Rush. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2021.emnlp-main.829" title="" class="ltx_ref ltx_href">Block pruning for faster transformers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 10619–10629, Online and Punta Cana, Dominican Republic. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam et al. (1991)</span>
<span class="ltx_bibblock">
Monica D. Lam, Edward E. Rothberg, and Michael E. Wolf. 1991.

</span>
<span class="ltx_bibblock">The cache performance and optimizations of blocked algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Architectural Support for Programming Languages and Operating Systems (ASPLOS)</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee and Lee (2023)</span>
<span class="ltx_bibblock">
Changhyeon Lee and Seulki Lee. 2023.

</span>
<span class="ltx_bibblock">Softmax output approximation for activation memory-efficient training of attention-based networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>, 36.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leviathan et al. (2023)</span>
<span class="ltx_bibblock">
Yaniv Leviathan, Matan Kalman, and Yossi Matias. 2023.

</span>
<span class="ltx_bibblock">Fast inference from transformers via speculative decoding.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Zhiyuan Li, Srinadh Bhojanapalli, Manzil Zaheer, Sashank Reddi, and Sanjiv Kumar. 2022.

</span>
<span class="ltx_bibblock">Robust training of neural networks using scale invariant architectures.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Chin-Yew Lin. 2004.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/W04-1013" title="" class="ltx_ref ltx_href">ROUGE: A package for automatic evaluation of summaries</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Text Summarization Branches Out</em>, pages 74–81, Barcelona, Spain. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mesnard et al. (2024)</span>
<span class="ltx_bibblock">
Thomas Mesnard, Cassidy Hardin, Robert Dadashi, Surya Bhupatiraju, Shreya Pathak, Laurent Sifre, Morgane Rivière, Mihir Sanjay Kale, Juliette Love, et al. 2024.

</span>
<span class="ltx_bibblock">Gemma: Open models based on gemini research and technology.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.08295</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao et al. (2024)</span>
<span class="ltx_bibblock">
Xupeng Miao, Gabriele Oliaro, Zhihao Zhang, Xinhao Cheng, Zeyu Wang, Zhengxin Zhang, Rae Ying Yee Wong, Alan Zhu, Lijie Yang, Xiaoxiang Shi, Chunan Shi, Zhuoming Chen, Daiyaan Arfeen, Reyna Abhyankar, and Zhihao Jia. 2024.

</span>
<span class="ltx_bibblock">Specinfer: Accelerating large language model serving with tree-based speculative inference and verification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 3</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Milakov and Gimelshein (2018)</span>
<span class="ltx_bibblock">
Maxim Milakov and Natalia Gimelshein. 2018.

</span>
<span class="ltx_bibblock">Online normalizer calculation for softmax.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1805.02867</em>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Monea et al. (2023)</span>
<span class="ltx_bibblock">
Giovanni Monea, Armand Joulin, and Edouard Grave. 2023.

</span>
<span class="ltx_bibblock">PaSS: Parallel speculative sampling.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.13581</em>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nagel et al. (2021)</span>
<span class="ltx_bibblock">
Markus Nagel, Marios Fournarakis, Rana Ali Amjad, Yelysei Bondarenko, Mart Van Baalen, and Tijmen Blankevoort. 2021.

</span>
<span class="ltx_bibblock">A white paper on neural network quantization.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.08295</em>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nallapati et al. (2016)</span>
<span class="ltx_bibblock">
Ramesh Nallapati, Bowen Zhou, Cicero dos Santos, Çağlar Gulçehre, and Bing Xiang. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/K16-1028" title="" class="ltx_ref ltx_href">Abstractive text summarization using sequence-to-sequence RNNs and beyond</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th SIGNLL Conference on Computational Natural Language Learning</em>, pages 280–290, Berlin, Germany. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayan et al. (2018)</span>
<span class="ltx_bibblock">
Shashi Narayan, Shay B. Cohen, and Mirella Lapata. 2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/D18-1206" title="" class="ltx_ref ltx_href">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>, pages 1797–1807, Brussels, Belgium. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">NVIDIA Corporation (2020)</span>
<span class="ltx_bibblock">
NVIDIA Corporation. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://resources.nvidia.com/en-us-genomics-ep/ampere-architecture-white-pape" title="" class="ltx_ref ltx_href">NVIDIA A100 tensor core GPU architecture</a>.

</span>
<span class="ltx_bibblock">Technical report, NVIDIA Corporation.

</span>
<span class="ltx_bibblock">White Paper.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Panayotov et al. (2015)</span>
<span class="ltx_bibblock">
Vassil Panayotov, Guoguo Chen, Daniel Povey, and Sanjeev Khudanpur. 2015.

</span>
<span class="ltx_bibblock">Librispeech: An asr corpus based on public domain audio books.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith Chintala. 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pope et al. (2023)</span>
<span class="ltx_bibblock">
Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Jacob Devlin, James Bradbury, Jonathan Heek, Kefan Xiao, Shivani Agrawal, and Jeff Dean. 2023.

</span>
<span class="ltx_bibblock">Efficiently scaling transformer inference.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Machine Learning and Systems</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rabe and Staats (2021)</span>
<span class="ltx_bibblock">
Markus N Rabe and Charles Staats. 2021.

</span>
<span class="ltx_bibblock">Self-attention does not need <math id="bib.bib47.1.m1.1" class="ltx_Math" alttext="o(n^{2})" display="inline"><semantics id="bib.bib47.1.m1.1a"><mrow id="bib.bib47.1.m1.1.1" xref="bib.bib47.1.m1.1.1.cmml"><mi id="bib.bib47.1.m1.1.1.3" xref="bib.bib47.1.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="bib.bib47.1.m1.1.1.2" xref="bib.bib47.1.m1.1.1.2.cmml">​</mo><mrow id="bib.bib47.1.m1.1.1.1.1" xref="bib.bib47.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="bib.bib47.1.m1.1.1.1.1.2" xref="bib.bib47.1.m1.1.1.1.1.1.cmml">(</mo><msup id="bib.bib47.1.m1.1.1.1.1.1" xref="bib.bib47.1.m1.1.1.1.1.1.cmml"><mi id="bib.bib47.1.m1.1.1.1.1.1.2" xref="bib.bib47.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="bib.bib47.1.m1.1.1.1.1.1.3" xref="bib.bib47.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="bib.bib47.1.m1.1.1.1.1.3" xref="bib.bib47.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="bib.bib47.1.m1.1b"><apply id="bib.bib47.1.m1.1.1.cmml" xref="bib.bib47.1.m1.1.1"><times id="bib.bib47.1.m1.1.1.2.cmml" xref="bib.bib47.1.m1.1.1.2"></times><ci id="bib.bib47.1.m1.1.1.3.cmml" xref="bib.bib47.1.m1.1.1.3">𝑜</ci><apply id="bib.bib47.1.m1.1.1.1.1.1.cmml" xref="bib.bib47.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="bib.bib47.1.m1.1.1.1.1.1.1.cmml" xref="bib.bib47.1.m1.1.1.1.1">superscript</csymbol><ci id="bib.bib47.1.m1.1.1.1.1.1.2.cmml" xref="bib.bib47.1.m1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="bib.bib47.1.m1.1.1.1.1.1.3.cmml" xref="bib.bib47.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib47.1.m1.1c">o(n^{2})</annotation></semantics></math> memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.2.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.05682</em>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2022)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Tao Xu, Greg Brockman, Christine McLeavey, and Ilya Sutskever. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2212.04356" title="" class="ltx_ref ltx_href">Robust speech recognition via large-scale weak supervision</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Preprint</em>, arXiv:2212.04356.

</span>
<span class="ltx_bibblock">ArXiv:2212.04356.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rousseau et al. (2012)</span>
<span class="ltx_bibblock">
Anthony Rousseau, Paul Deléglise, and Yannick Estève. 2012.

</span>
<span class="ltx_bibblock">TED-LIUM: an automatic speech recognition dedicated corpus.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">LREC</em>, pages 125–129.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ryoo et al. (2008)</span>
<span class="ltx_bibblock">
Shane Ryoo, Christopher I Rodrigues, Sam S Stone, Sara S Baghsorkhi, Sain-Zee Ueng, John A Stratton, and Wen-mei W Hwu. 2008.

</span>
<span class="ltx_bibblock">Program optimization space pruning for a multithreaded gpu.

</span>
<span class="ltx_bibblock">In <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM international symposium on Code generation and optimization</em>.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. (2019)</span>
<span class="ltx_bibblock">
Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf. 2019.

</span>
<span class="ltx_bibblock">Distilbert, a distilled version of bert: smaller, faster, cheaper and lighter.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.01108</em>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
Noam Shazeer. 2019.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.02150</em>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2020)</span>
<span class="ltx_bibblock">
Noam Shazeer. 2020.

</span>
<span class="ltx_bibblock">GLU variants improve transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05202</em>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2023)</span>
<span class="ltx_bibblock">
Kai Shen, Junliang Guo, Xu Tan, Siliang Tang, Rui Wang, and Jiang Bian. 2023.

</span>
<span class="ltx_bibblock">A study on relu and softmax in transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.06461</em>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shim et al. (2017)</span>
<span class="ltx_bibblock">
Kyuhong Shim, Minjae Lee, Iksoo Choi, Yoonho Boo, and Wonyong Sung. 2017.

</span>
<span class="ltx_bibblock">Svd-softmax: Fast softmax approximation on large vocabulary neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Spector and Re (2023)</span>
<span class="ltx_bibblock">
Benjamin Spector and Chris Re. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2308.04623" title="" class="ltx_ref ltx_href">Accelerating LLM inference with staged speculative decoding</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.04623</em>.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stern et al. (2018)</span>
<span class="ltx_bibblock">
Mitchell Stern, Noam Shazeer, and Jakob Uszkoreit. 2018.

</span>
<span class="ltx_bibblock">Blockwise parallel decoding for deep autoregressive models.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stock et al. (2021)</span>
<span class="ltx_bibblock">
Pierre Stock, Angela Fan, Benjamin Graham, Edouard Grave, Rémi Gribonval, Herve Jegou, and Armand Joulin. 2021.

</span>
<span class="ltx_bibblock">Training with quantization noise for extreme model compression.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2024)</span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu. 2024.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, 568:127063.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Siqi Sun, Yu Cheng, Zhe Gan, and Jingjing Liu. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/D19-1441" title="" class="ltx_ref ltx_href">Patient knowledge distillation for BERT model compression</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 4323–4332, Hong Kong, China. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al. 2023a.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13971</em>.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron et al. 2023b.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Voita et al. (2019)</span>
<span class="ltx_bibblock">
Elena Voita, David Talbot, Fedor Moiseev, Rico Sennrich, and Ivan Titov. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/P19-1580" title="" class="ltx_ref ltx_href">Analyzing multi-head self-attention: Specialized heads do the heavy lifting, the rest can be pruned</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</em>, pages 5797–5808, Florence, Italy. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2020)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Remi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander Rush. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2020.emnlp-demos.6" title="" class="ltx_ref ltx_href">Transformers: State-of-the-art natural language processing</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 38–45, Online. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wortsman et al. (2023)</span>
<span class="ltx_bibblock">
Mitchell Wortsman, Jaehoon Lee, Justin Gilmer, and Simon Kornblith. 2023.

</span>
<span class="ltx_bibblock">Replacing softmax with relu in vision transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.08586</em>.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2023)</span>
<span class="ltx_bibblock">
Heming Xia, Tao Ge, Peiyi Wang, Si-Qing Chen, Furu Wei, and Zhifang Sui. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2023.findings-emnlp.257" title="" class="ltx_ref ltx_href">Speculative decoding: Exploiting speculative execution for accelerating seq2seq generation</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: EMNLP 2023</em>, pages 3909–3925, Singapore. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2024a)</span>
<span class="ltx_bibblock">
Heming Xia, Zhe Yang, Qingxiu Dong, Peiyi Wang, Yongqi Li, Tao Ge, Tianyu Liu, Wenjie Li, and Zhifang Sui. 2024a.

</span>
<span class="ltx_bibblock">Unlocking efficiency in large language model inference: A comprehensive survey of speculative decoding.

</span>
<span class="ltx_bibblock"><em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.07851</em>.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2024b)</span>
<span class="ltx_bibblock">
Mengzhou Xia, Tianyu Gao, Zhiyuan Zeng, and Danqi Chen. 2024b.

</span>
<span class="ltx_bibblock">Sheared LLaMA: Accelerating language model pre-training via structured pruning.

</span>
<span class="ltx_bibblock"><em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2024)</span>
<span class="ltx_bibblock">
Sen Yang, Shujian Huang, Xinyu Dai, and Jiajun Chen. 2024.

</span>
<span class="ltx_bibblock">Multi-candidate speculative decoding.

</span>
<span class="ltx_bibblock"><em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.06706</em>.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Aonan Zhang, Chong Wang, Yi Wang, Xuanyu Zhang, and Yunfei Cheng. 2024.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2403.09919" title="" class="ltx_ref ltx_href">Recurrent drafter for fast speculative decoding in large language models</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">Preprint</em>, arXiv:2403.09919.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Sennrich (2019)</span>
<span class="ltx_bibblock">
Biao Zhang and Rico Sennrich. 2019.

</span>
<span class="ltx_bibblock">Root mean square layer normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Jun Zhang, Jue Wang, Huan Li, Lidan Shou, Ke Chen, Gang Chen, and Sharad Mehrotra. 2023.

</span>
<span class="ltx_bibblock">Draft &amp; verify: Lossless large language model acceleration via self-speculative decoding.

</span>
<span class="ltx_bibblock"><em id="bib.bib73.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.08168</em>.

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2024)</span>
<span class="ltx_bibblock">
Yongchao Zhou, Kaifeng Lyu, Ankit Singh Rawat, Aditya Krishna Menon, Afshin Rostamizadeh, Sanjiv Kumar, Jean-François Kagy, and Rishabh Agarwal. 2024.

</span>
<span class="ltx_bibblock">Distillspec: Improving speculative decoding via knowledge distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib74.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Target model details</h3>

<section id="A1.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Whisper.</h5>

<div id="A1.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px1.p1.1" class="ltx_p">Whisper <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a href="#bib.bib48" title="" class="ltx_ref">2022</a>)</cite> is a family of models trained to perform multiple tasks such as multilingual ASR, language identification, and speech translation.
The models are trained on <math id="A1.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A1.SS1.SSS0.Px1.p1.1.m1.1a"><mo id="A1.SS1.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p1.1.m1.1b"><csymbol cd="latexml" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p1.1.m1.1c">\sim</annotation></semantics></math>680k hours of labeled audio data retrieved from the world wide web and are available in five sizes ranging from 39M parameters to 1.55B parameters.
Utilizing an encoder-decoder Transformer architecture, Whisper receives 80-channel log-Mel spectrogram representations with a 25ms window and a stride of 10ms as inputs.
We conduct experiments on both the multilingual 1.55B parameter <span id="A1.SS1.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">whisper-large-v2</span> version and the English-only 244M parameter <span id="A1.SS1.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">whisper-small.en</span> version.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Llama2.</h5>

<div id="A1.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px2.p1.1" class="ltx_p">Llama2 <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib62" title="" class="ltx_ref">2023b</a>)</cite> is a collection of LLMs ranging from 7B to 70B parameters.
The models are pretrained on 2 trillion tokens of text data from publicly available sources.
The architecture is based on Llama1 <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib61" title="" class="ltx_ref">2023a</a>)</cite>, utilizing pre-normalization with RMSNorm <cite class="ltx_cite ltx_citemacro_cite">Zhang and Sennrich (<a href="#bib.bib72" title="" class="ltx_ref">2019</a>)</cite>, SwiGLU <cite class="ltx_cite ltx_citemacro_cite">Shazeer (<a href="#bib.bib53" title="" class="ltx_ref">2020</a>)</cite> activation functions, and rotary positional embeddings (RoPE) <cite class="ltx_cite ltx_citemacro_cite">Su et al. (<a href="#bib.bib59" title="" class="ltx_ref">2024</a>)</cite>.
Notable architectural changes include an expanded context length of 4K tokens and the adoption of grouped-query attention (GQA) for the 34B and 70B models.
We employ the 7B and 13B versions of Llama2 as target models.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Qwen.</h5>

<div id="A1.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px3.p1.1" class="ltx_p">The Qwen <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a href="#bib.bib4" title="" class="ltx_ref">2023a</a>)</cite> model series offers a range of decoder-only language models with parameter counts between 500M and 110B.
The models are pretrained on up to 3 trillion tokens of various multilingual text, code, and mathematics resources.
The architecture is similar to Llama2 with small modifications, such as no weight tying between input embeddings and output projection.
We employ Qwen v1.5 in our experiments and use the 7B parameter variant as the target model.
</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Gemma.</h5>

<div id="A1.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px4.p1.1" class="ltx_p">Gemma <cite class="ltx_cite ltx_citemacro_cite">Mesnard et al. (<a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite> comprises two model variants, featuring 2B and 7B parameters, pretrained on 3 trillion and 6 trillion tokens respectively.
Gemma is based on the Gemini <cite class="ltx_cite ltx_citemacro_cite">Anil et al. (<a href="#bib.bib2" title="" class="ltx_ref">2023</a>)</cite> model family.
The focus is primarily on English text from web documents, mathematics, and code, omitting multimodal capabilities and optimization for multilingual tasks.
Similar to Llama2, the Gemma models leverage RoPE and RMSNorm, and embeddings are shared across inputs and outputs to reduce model size.
We use the 7B parameter variant of Gemma v1.0 as the target model.
</p>
</div>
</section>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Draft model details</h3>

<section id="A1.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Distil-Whisper.</h5>

<div id="A1.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px1.p1.1" class="ltx_p">The draft model series for the ASR task is Distil-Whisper <cite class="ltx_cite ltx_citemacro_cite">Gandhi et al. (<a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>, a collection of smaller versions of the Whisper model.
Distil-Whisper applies knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">Hinton et al. (<a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite> to emulate the performance of the original Whisper model using a large (<math id="A1.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="A1.SS2.SSS0.Px1.p1.1.m1.1a"><mo id="A1.SS2.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS0.Px1.p1.1.m1.1b"><approx id="A1.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS0.Px1.p1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS0.Px1.p1.1.m1.1c">\approx</annotation></semantics></math>21k hours) pseudo-labeled training corpus.
The distilled models aim to maintain the robustness of Whisper towards varying audio domains and noisy acoustic conditions and are designed
to be paired with Whisper in a speculative decoding setting.
We use the 166M parameter <span id="A1.SS2.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">small.en</span> version as the draft model for the small 244M parameter target model and the 756M parameter <span id="A1.SS2.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">distil-large-v2</span> version as the draft model for the large 1.55B parameter target model.</p>
</div>
</section>
<section id="A1.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Sheared-LLaMA.</h5>

<div id="A1.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px2.p1.1" class="ltx_p">The draft model series for our experiments with Llama2 is Sheared-LLaMA <cite class="ltx_cite ltx_citemacro_cite">Xia et al. (<a href="#bib.bib69" title="" class="ltx_ref">2024b</a>)</cite>.
Sheared-LLaMA utilizes a structured pruning approach to reduce the size of the 7B parameter Llama 2 model to 1.3B and 2.7B parameters.
The structured pruning approach removes parameters from the source model until a given target configuration is satisfied.
Learned pruning masks representing discrete prune or retain decisions are used to create a smaller sub-network matching the specified target configuration.
We employ the 1.3B version of Sheared-LLaMA in our experiments.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<table id="A1.T3.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T3.1.1" class="ltx_tr">
<td id="A1.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="A1.T3.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="A1.T3.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="A1.T3.1.1.2.1" class="ltx_text ltx_font_bold">Subset</span></td>
<td id="A1.T3.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2"><span id="A1.T3.1.1.3.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="A1.T3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2"><span id="A1.T3.1.1.4.1" class="ltx_text ltx_font_bold">Wall-clock Improvement</span></td>
</tr>
<tr id="A1.T3.1.2" class="ltx_tr">
<td id="A1.T3.1.2.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.2.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Target</td>
<td id="A1.T3.1.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Draft</td>
<td id="A1.T3.1.2.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Exact</td>
<td id="A1.T3.1.2.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Sigmoid</td>
</tr>
<tr id="A1.T3.1.3" class="ltx_tr">
<td id="A1.T3.1.3.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">TED-LIUM</td>
<td id="A1.T3.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">release3</td>
<td id="A1.T3.1.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Small.EN</td>
<td id="A1.T3.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Small.EN</td>
<td id="A1.T3.1.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">8.7%</td>
<td id="A1.T3.1.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">58.7%</td>
</tr>
<tr id="A1.T3.1.4" class="ltx_tr">
<td id="A1.T3.1.4.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">TED-LIUM</td>
<td id="A1.T3.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">release3</td>
<td id="A1.T3.1.4.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Large V2</td>
<td id="A1.T3.1.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Large V2</td>
<td id="A1.T3.1.4.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.6%</td>
<td id="A1.T3.1.4.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">66.3%</td>
</tr>
<tr id="A1.T3.1.5" class="ltx_tr">
<td id="A1.T3.1.5.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">LibriSpeech</td>
<td id="A1.T3.1.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">clean</td>
<td id="A1.T3.1.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Small.EN</td>
<td id="A1.T3.1.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Small.EN</td>
<td id="A1.T3.1.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5.8%</td>
<td id="A1.T3.1.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">49.5%</td>
</tr>
<tr id="A1.T3.1.6" class="ltx_tr">
<td id="A1.T3.1.6.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">LibriSpeech</td>
<td id="A1.T3.1.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">clean</td>
<td id="A1.T3.1.6.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Large V2</td>
<td id="A1.T3.1.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Large V2</td>
<td id="A1.T3.1.6.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">7.4%</td>
<td id="A1.T3.1.6.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">65.3%</td>
</tr>
<tr id="A1.T3.1.7" class="ltx_tr">
<td id="A1.T3.1.7.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">LibriSpeech</td>
<td id="A1.T3.1.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">other</td>
<td id="A1.T3.1.7.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Small.EN</td>
<td id="A1.T3.1.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Small.EN</td>
<td id="A1.T3.1.7.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">7.1%</td>
<td id="A1.T3.1.7.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">54.5%</td>
</tr>
<tr id="A1.T3.1.8" class="ltx_tr">
<td id="A1.T3.1.8.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">LibriSpeech</td>
<td id="A1.T3.1.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">other</td>
<td id="A1.T3.1.8.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Large V2</td>
<td id="A1.T3.1.8.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Large V2</td>
<td id="A1.T3.1.8.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">7.0%</td>
<td id="A1.T3.1.8.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">66.2%</td>
</tr>
<tr id="A1.T3.1.9" class="ltx_tr">
<td id="A1.T3.1.9.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">CV16</td>
<td id="A1.T3.1.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">en</td>
<td id="A1.T3.1.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Small.EN</td>
<td id="A1.T3.1.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Small.EN</td>
<td id="A1.T3.1.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">8.1%</td>
<td id="A1.T3.1.9.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">51.8%</td>
</tr>
<tr id="A1.T3.1.10" class="ltx_tr">
<td id="A1.T3.1.10.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">CV16</td>
<td id="A1.T3.1.10.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">en</td>
<td id="A1.T3.1.10.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Large V2</td>
<td id="A1.T3.1.10.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Distil Large V2</td>
<td id="A1.T3.1.10.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">5.4%</td>
<td id="A1.T3.1.10.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">61.3%</td>
</tr>
<tr id="A1.T3.1.11" class="ltx_tr">
<td id="A1.T3.1.11.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">CNN/DailyMail</td>
<td id="A1.T3.1.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.11.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">Gemma 7B</td>
<td id="A1.T3.1.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">Gemma 2B</td>
<td id="A1.T3.1.11.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">3.0%</td>
<td id="A1.T3.1.11.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">24.2%</td>
</tr>
<tr id="A1.T3.1.12" class="ltx_tr">
<td id="A1.T3.1.12.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">CNN/DailyMail</td>
<td id="A1.T3.1.12.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.12.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Qwen 7B</td>
<td id="A1.T3.1.12.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Qwen 0.5B</td>
<td id="A1.T3.1.12.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">1.6%</td>
<td id="A1.T3.1.12.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">39.8%</td>
</tr>
<tr id="A1.T3.1.13" class="ltx_tr">
<td id="A1.T3.1.13.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">CNN/DailyMail</td>
<td id="A1.T3.1.13.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.13.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Llama2 7B</td>
<td id="A1.T3.1.13.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T3.1.13.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">4.2%</td>
<td id="A1.T3.1.13.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">28.2%</td>
</tr>
<tr id="A1.T3.1.14" class="ltx_tr">
<td id="A1.T3.1.14.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">CNN/DailyMail</td>
<td id="A1.T3.1.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.14.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Llama2 13B</td>
<td id="A1.T3.1.14.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T3.1.14.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">2.6%</td>
<td id="A1.T3.1.14.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">23.5%</td>
</tr>
<tr id="A1.T3.1.15" class="ltx_tr">
<td id="A1.T3.1.15.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">XSum</td>
<td id="A1.T3.1.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Gemma 7B</td>
<td id="A1.T3.1.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Gemma 2B</td>
<td id="A1.T3.1.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.2%</td>
<td id="A1.T3.1.15.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">18.5%</td>
</tr>
<tr id="A1.T3.1.16" class="ltx_tr">
<td id="A1.T3.1.16.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">XSum</td>
<td id="A1.T3.1.16.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.16.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Qwen 7B</td>
<td id="A1.T3.1.16.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Qwen 0.5B</td>
<td id="A1.T3.1.16.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">4.3%</td>
<td id="A1.T3.1.16.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">59.1%</td>
</tr>
<tr id="A1.T3.1.17" class="ltx_tr">
<td id="A1.T3.1.17.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">XSum</td>
<td id="A1.T3.1.17.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.17.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">Llama2 7B</td>
<td id="A1.T3.1.17.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T3.1.17.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.5%</td>
<td id="A1.T3.1.17.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">53.1%</td>
</tr>
<tr id="A1.T3.1.18" class="ltx_tr">
<td id="A1.T3.1.18.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">XSum</td>
<td id="A1.T3.1.18.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
<td id="A1.T3.1.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">Llama2 13B</td>
<td id="A1.T3.1.18.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T3.1.18.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">10.9%</td>
<td id="A1.T3.1.18.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">23.6%</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Relative wall-clock time improvements for both exact and sigmoid sampling on all tasks and model combinations. Wall-clock time measures the total time spent in the speculative decoding loop, including all forward passes through the draft and target models. The relative improvements are computed based on the total time required to perform speculative decoding for the full dataset. </figcaption>
</figure>
</section>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Dataset details</h3>

<section id="A1.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">ASR.</h5>

<div id="A1.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px1.p1.1" class="ltx_p">We used the test sets of three English ASR benchmark datasets: CommonVoice v16 <cite class="ltx_cite ltx_citemacro_cite">Ardila et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>, LibriSpeech <cite class="ltx_cite ltx_citemacro_cite">Panayotov et al. (<a href="#bib.bib44" title="" class="ltx_ref">2015</a>)</cite>, and TED-LIUM <cite class="ltx_cite ltx_citemacro_cite">Rousseau et al. (<a href="#bib.bib49" title="" class="ltx_ref">2012</a>)</cite> for the ASR task.
The data comprises multiple domains such as audiobooks, political speeches, interviews, and narrated Wikipedia articles.
The utterance lengths vary between 0.2 and 330 seconds with an average duration of 7.6<math id="A1.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.SS3.SSS0.Px1.p1.1.m1.1a"><mo id="A1.SS3.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px1.p1.1.m1.1b"><csymbol cd="latexml" id="A1.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px1.p1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px1.p1.1.m1.1c">\pm</annotation></semantics></math>6.6 seconds.</p>
</div>
</section>
<section id="A1.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Text summarization.</h5>

<div id="A1.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px2.p1.1" class="ltx_p">We used two datasets for text summarization: Extreme Summarization (XSum) <cite class="ltx_cite ltx_citemacro_cite">Narayan et al. (<a href="#bib.bib42" title="" class="ltx_ref">2018</a>)</cite> and CNN/Daily Mail (CNN/DM) <cite class="ltx_cite ltx_citemacro_cite">Nallapati et al. (<a href="#bib.bib41" title="" class="ltx_ref">2016</a>)</cite>.
The XSum test set contains 11,334 online articles from the British Broadcasting Corporation (BBC) and the CNN/DM test set contains 11,490 news articles published by CNN and the Daily Mail.
We performed 0-shot evaluation for CNN/DM and XSum, and used the ROUGE-1 metric for comparison.
To prompt the model for a summary, we placed “<span id="A1.SS3.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">Summary:</span>” after each input article.
Summaries were generated with a maximum token length of 100 for both XSum and CNN/DM.</p>
</div>
</section>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Wall-clock Time Improvement</h3>

<div id="A1.SS4.p1" class="ltx_para">
<p id="A1.SS4.p1.1" class="ltx_p">Table <a href="#A1.T3" title="Table 3 ‣ Sheared-LLaMA. ‣ A.2 Draft model details ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> summarizes the relative wall-clock time improvements for the overall text generation process.
Both the exact and the sigmoid approximation method translate into relative improvements compared to the baseline implementation.
Wall-clock times are less precise, since they also include the forward passes through the draft and target models, which may lead to additional overhead introduced by the deep learning framework <cite class="ltx_cite ltx_citemacro_cite">Fernandez et al. (<a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite>, and the time spent on CPU, which does not take varying rates of context switches and stalling due to execution of higher-priority processes into account.</p>
</div>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Average Times per Decoding Step</h3>

<div id="A1.SS5.p1" class="ltx_para">
<p id="A1.SS5.p1.1" class="ltx_p">The average times spent in the speculative sampling procedure per decoding step are summarized in Table <a href="#A1.T4" title="Table 4 ‣ A.5 Average Times per Decoding Step ‣ Appendix A Appendix ‣ Optimized Speculative Sampling for GPU Hardware Accelerators" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Our implementation achieved consistently lower average sampling times than the reference implementation.
While the the average sampling time was generally longer for the text generation tasks, the average times with our implementation were still consistently lower than the reference implementation.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<div id="A1.T4.50" class="ltx_inline-block ltx_transformed_outer" style="width:425.7pt;height:282.8pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.8pt,21.1pt) scale(0.87,0.87) ;">
<table id="A1.T4.50.50" class="ltx_tabular ltx_align_middle">
<tr id="A1.T4.2.2.2" class="ltx_tr">
<td id="A1.T4.2.2.2.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T4.2.2.2.3.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="A1.T4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T4.2.2.2.4.1" class="ltx_text ltx_font_bold">Subset</span></td>
<td id="A1.T4.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;" colspan="2"><span id="A1.T4.2.2.2.5.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;" colspan="3"><span id="A1.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Avg.<math id="A1.T4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.1.1.1.1.1.m1.1a"><mo id="A1.T4.1.1.1.1.1.m1.1.1" xref="A1.T4.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="A1.T4.1.1.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.1.1.m1.1c">\pm</annotation></semantics></math>Std. (ms)</span></td>
<td id="A1.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;" colspan="2">
<math id="A1.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A1.T4.2.2.2.2.m1.1a"><mi mathvariant="normal" id="A1.T4.2.2.2.2.m1.1.1" xref="A1.T4.2.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.2.m1.1b"><ci id="A1.T4.2.2.2.2.m1.1.1.cmml" xref="A1.T4.2.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.2.2.m1.1c">\Delta</annotation></semantics></math>% <span id="A1.T4.2.2.2.2.1" class="ltx_text ltx_font_bold">Profiling Time</span>
</td>
</tr>
<tr id="A1.T4.50.50.51" class="ltx_tr">
<td id="A1.T4.50.50.51.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.50.50.51.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.50.50.51.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Target</td>
<td id="A1.T4.50.50.51.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Draft</td>
<td id="A1.T4.50.50.51.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Baseline</td>
<td id="A1.T4.50.50.51.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Exact</td>
<td id="A1.T4.50.50.51.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Sigmoid</td>
<td id="A1.T4.50.50.51.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Exact</td>
<td id="A1.T4.50.50.51.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Sigmoid</td>
</tr>
<tr id="A1.T4.5.5.5" class="ltx_tr">
<td id="A1.T4.5.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">TED-LIUM</td>
<td id="A1.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">release3</td>
<td id="A1.T4.5.5.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Small.EN</td>
<td id="A1.T4.5.5.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Small.EN</td>
<td id="A1.T4.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">4.17<math id="A1.T4.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.3.3.3.1.m1.1a"><mo id="A1.T4.3.3.3.1.m1.1.1" xref="A1.T4.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.3.1.m1.1b"><csymbol cd="latexml" id="A1.T4.3.3.3.1.m1.1.1.cmml" xref="A1.T4.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.3.1.m1.1c">\pm</annotation></semantics></math>0.81</td>
<td id="A1.T4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.67<math id="A1.T4.4.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.4.4.4.2.m1.1a"><mo id="A1.T4.4.4.4.2.m1.1.1" xref="A1.T4.4.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.4.2.m1.1b"><csymbol cd="latexml" id="A1.T4.4.4.4.2.m1.1.1.cmml" xref="A1.T4.4.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.4.2.m1.1c">\pm</annotation></semantics></math>0.64</td>
<td id="A1.T4.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.12<math id="A1.T4.5.5.5.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.5.5.5.3.m1.1a"><mo id="A1.T4.5.5.5.3.m1.1.1" xref="A1.T4.5.5.5.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.5.5.5.3.m1.1b"><csymbol cd="latexml" id="A1.T4.5.5.5.3.m1.1.1.cmml" xref="A1.T4.5.5.5.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.5.5.5.3.m1.1c">\pm</annotation></semantics></math>1.09</td>
<td id="A1.T4.5.5.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">11.9%</td>
<td id="A1.T4.5.5.5.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">25.1%</td>
</tr>
<tr id="A1.T4.8.8.8" class="ltx_tr">
<td id="A1.T4.8.8.8.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">TED-LIUM</td>
<td id="A1.T4.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">release3</td>
<td id="A1.T4.8.8.8.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Large V2</td>
<td id="A1.T4.8.8.8.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Large V2</td>
<td id="A1.T4.6.6.6.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.37<math id="A1.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.6.6.6.1.m1.1a"><mo id="A1.T4.6.6.6.1.m1.1.1" xref="A1.T4.6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.6.6.6.1.m1.1b"><csymbol cd="latexml" id="A1.T4.6.6.6.1.m1.1.1.cmml" xref="A1.T4.6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.6.6.6.1.m1.1c">\pm</annotation></semantics></math>0.58</td>
<td id="A1.T4.7.7.7.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.88<math id="A1.T4.7.7.7.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.7.7.7.2.m1.1a"><mo id="A1.T4.7.7.7.2.m1.1.1" xref="A1.T4.7.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.7.7.7.2.m1.1b"><csymbol cd="latexml" id="A1.T4.7.7.7.2.m1.1.1.cmml" xref="A1.T4.7.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.7.7.7.2.m1.1c">\pm</annotation></semantics></math>0.46</td>
<td id="A1.T4.8.8.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.62<math id="A1.T4.8.8.8.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.8.8.8.3.m1.1a"><mo id="A1.T4.8.8.8.3.m1.1.1" xref="A1.T4.8.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.8.8.8.3.m1.1b"><csymbol cd="latexml" id="A1.T4.8.8.8.3.m1.1.1.cmml" xref="A1.T4.8.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.8.8.8.3.m1.1c">\pm</annotation></semantics></math>1.09</td>
<td id="A1.T4.8.8.8.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.2%</td>
<td id="A1.T4.8.8.8.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">17.2%</td>
</tr>
<tr id="A1.T4.11.11.11" class="ltx_tr">
<td id="A1.T4.11.11.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">LibriSpeech</td>
<td id="A1.T4.11.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">clean</td>
<td id="A1.T4.11.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Small.EN</td>
<td id="A1.T4.11.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Small.EN</td>
<td id="A1.T4.9.9.9.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">4.31<math id="A1.T4.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.9.9.9.1.m1.1a"><mo id="A1.T4.9.9.9.1.m1.1.1" xref="A1.T4.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.9.9.9.1.m1.1b"><csymbol cd="latexml" id="A1.T4.9.9.9.1.m1.1.1.cmml" xref="A1.T4.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.9.9.9.1.m1.1c">\pm</annotation></semantics></math>1.00</td>
<td id="A1.T4.10.10.10.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.81<math id="A1.T4.10.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.10.10.10.2.m1.1a"><mo id="A1.T4.10.10.10.2.m1.1.1" xref="A1.T4.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.10.10.10.2.m1.1b"><csymbol cd="latexml" id="A1.T4.10.10.10.2.m1.1.1.cmml" xref="A1.T4.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.10.10.10.2.m1.1c">\pm</annotation></semantics></math>0.80</td>
<td id="A1.T4.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.15<math id="A1.T4.11.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.11.11.11.3.m1.1a"><mo id="A1.T4.11.11.11.3.m1.1.1" xref="A1.T4.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.11.11.11.3.m1.1b"><csymbol cd="latexml" id="A1.T4.11.11.11.3.m1.1.1.cmml" xref="A1.T4.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.11.11.11.3.m1.1c">\pm</annotation></semantics></math>1.13</td>
<td id="A1.T4.11.11.11.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">11.7%</td>
<td id="A1.T4.11.11.11.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">27.0%</td>
</tr>
<tr id="A1.T4.14.14.14" class="ltx_tr">
<td id="A1.T4.14.14.14.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">LibriSpeech</td>
<td id="A1.T4.14.14.14.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">clean</td>
<td id="A1.T4.14.14.14.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Large V2</td>
<td id="A1.T4.14.14.14.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Large V2</td>
<td id="A1.T4.12.12.12.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.35<math id="A1.T4.12.12.12.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.12.12.12.1.m1.1a"><mo id="A1.T4.12.12.12.1.m1.1.1" xref="A1.T4.12.12.12.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.12.12.12.1.m1.1b"><csymbol cd="latexml" id="A1.T4.12.12.12.1.m1.1.1.cmml" xref="A1.T4.12.12.12.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.12.12.12.1.m1.1c">\pm</annotation></semantics></math>0.60</td>
<td id="A1.T4.13.13.13.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.88<math id="A1.T4.13.13.13.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.13.13.13.2.m1.1a"><mo id="A1.T4.13.13.13.2.m1.1.1" xref="A1.T4.13.13.13.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.13.13.13.2.m1.1b"><csymbol cd="latexml" id="A1.T4.13.13.13.2.m1.1.1.cmml" xref="A1.T4.13.13.13.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.13.13.13.2.m1.1c">\pm</annotation></semantics></math>0.52</td>
<td id="A1.T4.14.14.14.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.55<math id="A1.T4.14.14.14.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.14.14.14.3.m1.1a"><mo id="A1.T4.14.14.14.3.m1.1.1" xref="A1.T4.14.14.14.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.14.14.14.3.m1.1b"><csymbol cd="latexml" id="A1.T4.14.14.14.3.m1.1.1.cmml" xref="A1.T4.14.14.14.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.14.14.14.3.m1.1c">\pm</annotation></semantics></math>1.08</td>
<td id="A1.T4.14.14.14.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">10.8%</td>
<td id="A1.T4.14.14.14.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">18.4%</td>
</tr>
<tr id="A1.T4.17.17.17" class="ltx_tr">
<td id="A1.T4.17.17.17.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">LibriSpeech</td>
<td id="A1.T4.17.17.17.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">other</td>
<td id="A1.T4.17.17.17.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Small.EN</td>
<td id="A1.T4.17.17.17.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Small.EN</td>
<td id="A1.T4.15.15.15.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.14<math id="A1.T4.15.15.15.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.15.15.15.1.m1.1a"><mo id="A1.T4.15.15.15.1.m1.1.1" xref="A1.T4.15.15.15.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.15.15.15.1.m1.1b"><csymbol cd="latexml" id="A1.T4.15.15.15.1.m1.1.1.cmml" xref="A1.T4.15.15.15.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.15.15.15.1.m1.1c">\pm</annotation></semantics></math>0.84</td>
<td id="A1.T4.16.16.16.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.68<math id="A1.T4.16.16.16.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.16.16.16.2.m1.1a"><mo id="A1.T4.16.16.16.2.m1.1.1" xref="A1.T4.16.16.16.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.16.16.16.2.m1.1b"><csymbol cd="latexml" id="A1.T4.16.16.16.2.m1.1.1.cmml" xref="A1.T4.16.16.16.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.16.16.16.2.m1.1c">\pm</annotation></semantics></math>0.68</td>
<td id="A1.T4.17.17.17.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.20<math id="A1.T4.17.17.17.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.17.17.17.3.m1.1a"><mo id="A1.T4.17.17.17.3.m1.1.1" xref="A1.T4.17.17.17.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.17.17.17.3.m1.1b"><csymbol cd="latexml" id="A1.T4.17.17.17.3.m1.1.1.cmml" xref="A1.T4.17.17.17.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.17.17.17.3.m1.1c">\pm</annotation></semantics></math>1.07</td>
<td id="A1.T4.17.17.17.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.1%</td>
<td id="A1.T4.17.17.17.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">22.7%</td>
</tr>
<tr id="A1.T4.20.20.20" class="ltx_tr">
<td id="A1.T4.20.20.20.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">LibriSpeech</td>
<td id="A1.T4.20.20.20.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">other</td>
<td id="A1.T4.20.20.20.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Large V2</td>
<td id="A1.T4.20.20.20.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Large V2</td>
<td id="A1.T4.18.18.18.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.39<math id="A1.T4.18.18.18.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.18.18.18.1.m1.1a"><mo id="A1.T4.18.18.18.1.m1.1.1" xref="A1.T4.18.18.18.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.18.18.18.1.m1.1b"><csymbol cd="latexml" id="A1.T4.18.18.18.1.m1.1.1.cmml" xref="A1.T4.18.18.18.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.18.18.18.1.m1.1c">\pm</annotation></semantics></math>0.61</td>
<td id="A1.T4.19.19.19.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.90<math id="A1.T4.19.19.19.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.19.19.19.2.m1.1a"><mo id="A1.T4.19.19.19.2.m1.1.1" xref="A1.T4.19.19.19.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.19.19.19.2.m1.1b"><csymbol cd="latexml" id="A1.T4.19.19.19.2.m1.1.1.cmml" xref="A1.T4.19.19.19.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.19.19.19.2.m1.1c">\pm</annotation></semantics></math>0.49</td>
<td id="A1.T4.20.20.20.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.55<math id="A1.T4.20.20.20.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.20.20.20.3.m1.1a"><mo id="A1.T4.20.20.20.3.m1.1.1" xref="A1.T4.20.20.20.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.20.20.20.3.m1.1b"><csymbol cd="latexml" id="A1.T4.20.20.20.3.m1.1.1.cmml" xref="A1.T4.20.20.20.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.20.20.20.3.m1.1c">\pm</annotation></semantics></math>1.07</td>
<td id="A1.T4.20.20.20.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.2%</td>
<td id="A1.T4.20.20.20.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">19.1%</td>
</tr>
<tr id="A1.T4.23.23.23" class="ltx_tr">
<td id="A1.T4.23.23.23.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">CV16</td>
<td id="A1.T4.23.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">en</td>
<td id="A1.T4.23.23.23.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Small.EN</td>
<td id="A1.T4.23.23.23.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Small.EN</td>
<td id="A1.T4.21.21.21.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">4.14<math id="A1.T4.21.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.21.21.21.1.m1.1a"><mo id="A1.T4.21.21.21.1.m1.1.1" xref="A1.T4.21.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.21.21.21.1.m1.1b"><csymbol cd="latexml" id="A1.T4.21.21.21.1.m1.1.1.cmml" xref="A1.T4.21.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.21.21.21.1.m1.1c">\pm</annotation></semantics></math>0.85</td>
<td id="A1.T4.22.22.22.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.71<math id="A1.T4.22.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.22.22.22.2.m1.1a"><mo id="A1.T4.22.22.22.2.m1.1.1" xref="A1.T4.22.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.22.22.22.2.m1.1b"><csymbol cd="latexml" id="A1.T4.22.22.22.2.m1.1.1.cmml" xref="A1.T4.22.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.22.22.22.2.m1.1c">\pm</annotation></semantics></math>0.70</td>
<td id="A1.T4.23.23.23.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">3.33<math id="A1.T4.23.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.23.23.23.3.m1.1a"><mo id="A1.T4.23.23.23.3.m1.1.1" xref="A1.T4.23.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.23.23.23.3.m1.1b"><csymbol cd="latexml" id="A1.T4.23.23.23.3.m1.1.1.cmml" xref="A1.T4.23.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.23.23.23.3.m1.1c">\pm</annotation></semantics></math>1.10</td>
<td id="A1.T4.23.23.23.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">10.4%</td>
<td id="A1.T4.23.23.23.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">19.8%</td>
</tr>
<tr id="A1.T4.26.26.26" class="ltx_tr">
<td id="A1.T4.26.26.26.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">CV16</td>
<td id="A1.T4.26.26.26.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">en</td>
<td id="A1.T4.26.26.26.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Large V2</td>
<td id="A1.T4.26.26.26.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Distil Large V2</td>
<td id="A1.T4.24.24.24.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.37<math id="A1.T4.24.24.24.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.24.24.24.1.m1.1a"><mo id="A1.T4.24.24.24.1.m1.1.1" xref="A1.T4.24.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.24.24.24.1.m1.1b"><csymbol cd="latexml" id="A1.T4.24.24.24.1.m1.1.1.cmml" xref="A1.T4.24.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.24.24.24.1.m1.1c">\pm</annotation></semantics></math>0.61</td>
<td id="A1.T4.25.25.25.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.92<math id="A1.T4.25.25.25.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.25.25.25.2.m1.1a"><mo id="A1.T4.25.25.25.2.m1.1.1" xref="A1.T4.25.25.25.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.25.25.25.2.m1.1b"><csymbol cd="latexml" id="A1.T4.25.25.25.2.m1.1.1.cmml" xref="A1.T4.25.25.25.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.25.25.25.2.m1.1c">\pm</annotation></semantics></math>0.51</td>
<td id="A1.T4.26.26.26.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.62<math id="A1.T4.26.26.26.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.26.26.26.3.m1.1a"><mo id="A1.T4.26.26.26.3.m1.1.1" xref="A1.T4.26.26.26.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.26.26.26.3.m1.1b"><csymbol cd="latexml" id="A1.T4.26.26.26.3.m1.1.1.cmml" xref="A1.T4.26.26.26.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.26.26.26.3.m1.1c">\pm</annotation></semantics></math>1.07</td>
<td id="A1.T4.26.26.26.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">10.4%</td>
<td id="A1.T4.26.26.26.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">17.2%</td>
</tr>
<tr id="A1.T4.29.29.29" class="ltx_tr">
<td id="A1.T4.29.29.29.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">CNN/DailyMail</td>
<td id="A1.T4.29.29.29.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.29.29.29.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Gemma 7B</td>
<td id="A1.T4.29.29.29.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Gemma 2B</td>
<td id="A1.T4.27.27.27.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">6.54<math id="A1.T4.27.27.27.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.27.27.27.1.m1.1a"><mo id="A1.T4.27.27.27.1.m1.1.1" xref="A1.T4.27.27.27.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.27.27.27.1.m1.1b"><csymbol cd="latexml" id="A1.T4.27.27.27.1.m1.1.1.cmml" xref="A1.T4.27.27.27.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.27.27.27.1.m1.1c">\pm</annotation></semantics></math>0.47</td>
<td id="A1.T4.28.28.28.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">5.84<math id="A1.T4.28.28.28.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.28.28.28.2.m1.1a"><mo id="A1.T4.28.28.28.2.m1.1.1" xref="A1.T4.28.28.28.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.28.28.28.2.m1.1b"><csymbol cd="latexml" id="A1.T4.28.28.28.2.m1.1.1.cmml" xref="A1.T4.28.28.28.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.28.28.28.2.m1.1c">\pm</annotation></semantics></math>0.39</td>
<td id="A1.T4.29.29.29.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">4.37<math id="A1.T4.29.29.29.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.29.29.29.3.m1.1a"><mo id="A1.T4.29.29.29.3.m1.1.1" xref="A1.T4.29.29.29.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.29.29.29.3.m1.1b"><csymbol cd="latexml" id="A1.T4.29.29.29.3.m1.1.1.cmml" xref="A1.T4.29.29.29.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.29.29.29.3.m1.1c">\pm</annotation></semantics></math>0.54</td>
<td id="A1.T4.29.29.29.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">10.6%</td>
<td id="A1.T4.29.29.29.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">33.1%</td>
</tr>
<tr id="A1.T4.32.32.32" class="ltx_tr">
<td id="A1.T4.32.32.32.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">CNN/DailyMail</td>
<td id="A1.T4.32.32.32.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.32.32.32.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Qwen 7B</td>
<td id="A1.T4.32.32.32.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Qwen 0.5B</td>
<td id="A1.T4.30.30.30.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">12.01<math id="A1.T4.30.30.30.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.30.30.30.1.m1.1a"><mo id="A1.T4.30.30.30.1.m1.1.1" xref="A1.T4.30.30.30.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.30.30.30.1.m1.1b"><csymbol cd="latexml" id="A1.T4.30.30.30.1.m1.1.1.cmml" xref="A1.T4.30.30.30.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.30.30.30.1.m1.1c">\pm</annotation></semantics></math>1.08</td>
<td id="A1.T4.31.31.31.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.20<math id="A1.T4.31.31.31.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.31.31.31.2.m1.1a"><mo id="A1.T4.31.31.31.2.m1.1.1" xref="A1.T4.31.31.31.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.31.31.31.2.m1.1b"><csymbol cd="latexml" id="A1.T4.31.31.31.2.m1.1.1.cmml" xref="A1.T4.31.31.31.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.31.31.31.2.m1.1c">\pm</annotation></semantics></math>1.03</td>
<td id="A1.T4.32.32.32.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.34<math id="A1.T4.32.32.32.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.32.32.32.3.m1.1a"><mo id="A1.T4.32.32.32.3.m1.1.1" xref="A1.T4.32.32.32.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.32.32.32.3.m1.1b"><csymbol cd="latexml" id="A1.T4.32.32.32.3.m1.1.1.cmml" xref="A1.T4.32.32.32.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.32.32.32.3.m1.1c">\pm</annotation></semantics></math>0.45</td>
<td id="A1.T4.32.32.32.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">6.8%</td>
<td id="A1.T4.32.32.32.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">72.2%</td>
</tr>
<tr id="A1.T4.35.35.35" class="ltx_tr">
<td id="A1.T4.35.35.35.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">CNN/DailyMail</td>
<td id="A1.T4.35.35.35.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.35.35.35.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Llama2 7B</td>
<td id="A1.T4.35.35.35.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T4.33.33.33.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.33<math id="A1.T4.33.33.33.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.33.33.33.1.m1.1a"><mo id="A1.T4.33.33.33.1.m1.1.1" xref="A1.T4.33.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.33.33.33.1.m1.1b"><csymbol cd="latexml" id="A1.T4.33.33.33.1.m1.1.1.cmml" xref="A1.T4.33.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.33.33.33.1.m1.1c">\pm</annotation></semantics></math>0.94</td>
<td id="A1.T4.34.34.34.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">10.69<math id="A1.T4.34.34.34.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.34.34.34.2.m1.1a"><mo id="A1.T4.34.34.34.2.m1.1.1" xref="A1.T4.34.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.34.34.34.2.m1.1b"><csymbol cd="latexml" id="A1.T4.34.34.34.2.m1.1.1.cmml" xref="A1.T4.34.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.34.34.34.2.m1.1c">\pm</annotation></semantics></math>0.83</td>
<td id="A1.T4.35.35.35.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.65<math id="A1.T4.35.35.35.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.35.35.35.3.m1.1a"><mo id="A1.T4.35.35.35.3.m1.1.1" xref="A1.T4.35.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.35.35.35.3.m1.1b"><csymbol cd="latexml" id="A1.T4.35.35.35.3.m1.1.1.cmml" xref="A1.T4.35.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.35.35.35.3.m1.1c">\pm</annotation></semantics></math>0.62</td>
<td id="A1.T4.35.35.35.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">5.7%</td>
<td id="A1.T4.35.35.35.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">67.8%</td>
</tr>
<tr id="A1.T4.38.38.38" class="ltx_tr">
<td id="A1.T4.38.38.38.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">CNN/DailyMail</td>
<td id="A1.T4.38.38.38.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.38.38.38.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Llama2 13B</td>
<td id="A1.T4.38.38.38.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T4.36.36.36.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.99<math id="A1.T4.36.36.36.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.36.36.36.1.m1.1a"><mo id="A1.T4.36.36.36.1.m1.1.1" xref="A1.T4.36.36.36.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.36.36.36.1.m1.1b"><csymbol cd="latexml" id="A1.T4.36.36.36.1.m1.1.1.cmml" xref="A1.T4.36.36.36.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.36.36.36.1.m1.1c">\pm</annotation></semantics></math>0.52</td>
<td id="A1.T4.37.37.37.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">3.59<math id="A1.T4.37.37.37.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.37.37.37.2.m1.1a"><mo id="A1.T4.37.37.37.2.m1.1.1" xref="A1.T4.37.37.37.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.37.37.37.2.m1.1b"><csymbol cd="latexml" id="A1.T4.37.37.37.2.m1.1.1.cmml" xref="A1.T4.37.37.37.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.37.37.37.2.m1.1c">\pm</annotation></semantics></math>1.70</td>
<td id="A1.T4.38.38.38.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.26<math id="A1.T4.38.38.38.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.38.38.38.3.m1.1a"><mo id="A1.T4.38.38.38.3.m1.1.1" xref="A1.T4.38.38.38.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.38.38.38.3.m1.1b"><csymbol cd="latexml" id="A1.T4.38.38.38.3.m1.1.1.cmml" xref="A1.T4.38.38.38.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.38.38.38.3.m1.1c">\pm</annotation></semantics></math>0.26</td>
<td id="A1.T4.38.38.38.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">10.1%</td>
<td id="A1.T4.38.38.38.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">18.3%</td>
</tr>
<tr id="A1.T4.41.41.41" class="ltx_tr">
<td id="A1.T4.41.41.41.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">XSum</td>
<td id="A1.T4.41.41.41.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.41.41.41.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Gemma 7B</td>
<td id="A1.T4.41.41.41.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Gemma 2B</td>
<td id="A1.T4.39.39.39.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">6.39<math id="A1.T4.39.39.39.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.39.39.39.1.m1.1a"><mo id="A1.T4.39.39.39.1.m1.1.1" xref="A1.T4.39.39.39.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.39.39.39.1.m1.1b"><csymbol cd="latexml" id="A1.T4.39.39.39.1.m1.1.1.cmml" xref="A1.T4.39.39.39.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.39.39.39.1.m1.1c">\pm</annotation></semantics></math>0.50</td>
<td id="A1.T4.40.40.40.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">5.76<math id="A1.T4.40.40.40.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.40.40.40.2.m1.1a"><mo id="A1.T4.40.40.40.2.m1.1.1" xref="A1.T4.40.40.40.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.40.40.40.2.m1.1b"><csymbol cd="latexml" id="A1.T4.40.40.40.2.m1.1.1.cmml" xref="A1.T4.40.40.40.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.40.40.40.2.m1.1c">\pm</annotation></semantics></math>0.42</td>
<td id="A1.T4.41.41.41.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">4.61<math id="A1.T4.41.41.41.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.41.41.41.3.m1.1a"><mo id="A1.T4.41.41.41.3.m1.1.1" xref="A1.T4.41.41.41.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.41.41.41.3.m1.1b"><csymbol cd="latexml" id="A1.T4.41.41.41.3.m1.1.1.cmml" xref="A1.T4.41.41.41.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.41.41.41.3.m1.1c">\pm</annotation></semantics></math>0.55</td>
<td id="A1.T4.41.41.41.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">9.9%</td>
<td id="A1.T4.41.41.41.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">27.9%</td>
</tr>
<tr id="A1.T4.44.44.44" class="ltx_tr">
<td id="A1.T4.44.44.44.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">XSum</td>
<td id="A1.T4.44.44.44.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.44.44.44.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Qwen 7B</td>
<td id="A1.T4.44.44.44.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Qwen 0.5B</td>
<td id="A1.T4.42.42.42.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.55<math id="A1.T4.42.42.42.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.42.42.42.1.m1.1a"><mo id="A1.T4.42.42.42.1.m1.1.1" xref="A1.T4.42.42.42.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.42.42.42.1.m1.1b"><csymbol cd="latexml" id="A1.T4.42.42.42.1.m1.1.1.cmml" xref="A1.T4.42.42.42.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.42.42.42.1.m1.1c">\pm</annotation></semantics></math>1.39</td>
<td id="A1.T4.43.43.43.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">10.65<math id="A1.T4.43.43.43.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.43.43.43.2.m1.1a"><mo id="A1.T4.43.43.43.2.m1.1.1" xref="A1.T4.43.43.43.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.43.43.43.2.m1.1b"><csymbol cd="latexml" id="A1.T4.43.43.43.2.m1.1.1.cmml" xref="A1.T4.43.43.43.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.43.43.43.2.m1.1c">\pm</annotation></semantics></math>1.51</td>
<td id="A1.T4.44.44.44.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.20<math id="A1.T4.44.44.44.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.44.44.44.3.m1.1a"><mo id="A1.T4.44.44.44.3.m1.1.1" xref="A1.T4.44.44.44.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.44.44.44.3.m1.1b"><csymbol cd="latexml" id="A1.T4.44.44.44.3.m1.1.1.cmml" xref="A1.T4.44.44.44.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.44.44.44.3.m1.1c">\pm</annotation></semantics></math>0.42</td>
<td id="A1.T4.44.44.44.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">7.8%</td>
<td id="A1.T4.44.44.44.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">72.3%</td>
</tr>
<tr id="A1.T4.47.47.47" class="ltx_tr">
<td id="A1.T4.47.47.47.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">XSum</td>
<td id="A1.T4.47.47.47.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.47.47.47.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Llama2 7B</td>
<td id="A1.T4.47.47.47.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T4.45.45.45.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.66<math id="A1.T4.45.45.45.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.45.45.45.1.m1.1a"><mo id="A1.T4.45.45.45.1.m1.1.1" xref="A1.T4.45.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.45.45.45.1.m1.1b"><csymbol cd="latexml" id="A1.T4.45.45.45.1.m1.1.1.cmml" xref="A1.T4.45.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.45.45.45.1.m1.1c">\pm</annotation></semantics></math>0.42</td>
<td id="A1.T4.46.46.46.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">4.14<math id="A1.T4.46.46.46.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.46.46.46.2.m1.1a"><mo id="A1.T4.46.46.46.2.m1.1.1" xref="A1.T4.46.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.46.46.46.2.m1.1b"><csymbol cd="latexml" id="A1.T4.46.46.46.2.m1.1.1.cmml" xref="A1.T4.46.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.46.46.46.2.m1.1c">\pm</annotation></semantics></math>2.88</td>
<td id="A1.T4.47.47.47.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.64<math id="A1.T4.47.47.47.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.47.47.47.3.m1.1a"><mo id="A1.T4.47.47.47.3.m1.1.1" xref="A1.T4.47.47.47.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.47.47.47.3.m1.1b"><csymbol cd="latexml" id="A1.T4.47.47.47.3.m1.1.1.cmml" xref="A1.T4.47.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.47.47.47.3.m1.1c">\pm</annotation></semantics></math>0.56</td>
<td id="A1.T4.47.47.47.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">11.1%</td>
<td id="A1.T4.47.47.47.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">21.8%</td>
</tr>
<tr id="A1.T4.50.50.50" class="ltx_tr">
<td id="A1.T4.50.50.50.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">XSum</td>
<td id="A1.T4.50.50.50.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td id="A1.T4.50.50.50.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">Llama2 13B</td>
<td id="A1.T4.50.50.50.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">Sheared Llama 1.3B</td>
<td id="A1.T4.48.48.48.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">4.67<math id="A1.T4.48.48.48.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.48.48.48.1.m1.1a"><mo id="A1.T4.48.48.48.1.m1.1.1" xref="A1.T4.48.48.48.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.48.48.48.1.m1.1b"><csymbol cd="latexml" id="A1.T4.48.48.48.1.m1.1.1.cmml" xref="A1.T4.48.48.48.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.48.48.48.1.m1.1c">\pm</annotation></semantics></math>0.41</td>
<td id="A1.T4.49.49.49.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">4.17<math id="A1.T4.49.49.49.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.49.49.49.2.m1.1a"><mo id="A1.T4.49.49.49.2.m1.1.1" xref="A1.T4.49.49.49.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.49.49.49.2.m1.1b"><csymbol cd="latexml" id="A1.T4.49.49.49.2.m1.1.1.cmml" xref="A1.T4.49.49.49.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.49.49.49.2.m1.1c">\pm</annotation></semantics></math>1.70</td>
<td id="A1.T4.50.50.50.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">3.70<math id="A1.T4.50.50.50.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.50.50.50.3.m1.1a"><mo id="A1.T4.50.50.50.3.m1.1.1" xref="A1.T4.50.50.50.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.50.50.50.3.m1.1b"><csymbol cd="latexml" id="A1.T4.50.50.50.3.m1.1.1.cmml" xref="A1.T4.50.50.50.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.50.50.50.3.m1.1c">\pm</annotation></semantics></math>0.44</td>
<td id="A1.T4.50.50.50.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">10.5%</td>
<td id="A1.T4.50.50.50.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">20.7%</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Average time and standard deviation spent within the speculative sampling algorithm <span id="A1.T4.62.1" class="ltx_text ltx_font_bold">per decoding step</span>.
The column “<math id="A1.T4.56.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A1.T4.56.m1.1b"><mi mathvariant="normal" id="A1.T4.56.m1.1.1" xref="A1.T4.56.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.T4.56.m1.1c"><ci id="A1.T4.56.m1.1.1.cmml" xref="A1.T4.56.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.56.m1.1d">\Delta</annotation></semantics></math>% Profiling Time” measures the relative reduction in average time per decoding step (“Baseline” vs. “Exact” and“Sigmoid”). Scaling constants for sigmoid approximation: <math id="A1.T4.57.m2.1" class="ltx_Math" alttext="\alpha=-10^{3}" display="inline"><semantics id="A1.T4.57.m2.1b"><mrow id="A1.T4.57.m2.1.1" xref="A1.T4.57.m2.1.1.cmml"><mi id="A1.T4.57.m2.1.1.2" xref="A1.T4.57.m2.1.1.2.cmml">α</mi><mo id="A1.T4.57.m2.1.1.1" xref="A1.T4.57.m2.1.1.1.cmml">=</mo><mrow id="A1.T4.57.m2.1.1.3" xref="A1.T4.57.m2.1.1.3.cmml"><mo id="A1.T4.57.m2.1.1.3b" xref="A1.T4.57.m2.1.1.3.cmml">−</mo><msup id="A1.T4.57.m2.1.1.3.2" xref="A1.T4.57.m2.1.1.3.2.cmml"><mn id="A1.T4.57.m2.1.1.3.2.2" xref="A1.T4.57.m2.1.1.3.2.2.cmml">10</mn><mn id="A1.T4.57.m2.1.1.3.2.3" xref="A1.T4.57.m2.1.1.3.2.3.cmml">3</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.57.m2.1c"><apply id="A1.T4.57.m2.1.1.cmml" xref="A1.T4.57.m2.1.1"><eq id="A1.T4.57.m2.1.1.1.cmml" xref="A1.T4.57.m2.1.1.1"></eq><ci id="A1.T4.57.m2.1.1.2.cmml" xref="A1.T4.57.m2.1.1.2">𝛼</ci><apply id="A1.T4.57.m2.1.1.3.cmml" xref="A1.T4.57.m2.1.1.3"><minus id="A1.T4.57.m2.1.1.3.1.cmml" xref="A1.T4.57.m2.1.1.3"></minus><apply id="A1.T4.57.m2.1.1.3.2.cmml" xref="A1.T4.57.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.T4.57.m2.1.1.3.2.1.cmml" xref="A1.T4.57.m2.1.1.3.2">superscript</csymbol><cn type="integer" id="A1.T4.57.m2.1.1.3.2.2.cmml" xref="A1.T4.57.m2.1.1.3.2.2">10</cn><cn type="integer" id="A1.T4.57.m2.1.1.3.2.3.cmml" xref="A1.T4.57.m2.1.1.3.2.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.57.m2.1d">\alpha=-10^{3}</annotation></semantics></math> and <math id="A1.T4.58.m3.1" class="ltx_Math" alttext="\beta=10^{3}" display="inline"><semantics id="A1.T4.58.m3.1b"><mrow id="A1.T4.58.m3.1.1" xref="A1.T4.58.m3.1.1.cmml"><mi id="A1.T4.58.m3.1.1.2" xref="A1.T4.58.m3.1.1.2.cmml">β</mi><mo id="A1.T4.58.m3.1.1.1" xref="A1.T4.58.m3.1.1.1.cmml">=</mo><msup id="A1.T4.58.m3.1.1.3" xref="A1.T4.58.m3.1.1.3.cmml"><mn id="A1.T4.58.m3.1.1.3.2" xref="A1.T4.58.m3.1.1.3.2.cmml">10</mn><mn id="A1.T4.58.m3.1.1.3.3" xref="A1.T4.58.m3.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.58.m3.1c"><apply id="A1.T4.58.m3.1.1.cmml" xref="A1.T4.58.m3.1.1"><eq id="A1.T4.58.m3.1.1.1.cmml" xref="A1.T4.58.m3.1.1.1"></eq><ci id="A1.T4.58.m3.1.1.2.cmml" xref="A1.T4.58.m3.1.1.2">𝛽</ci><apply id="A1.T4.58.m3.1.1.3.cmml" xref="A1.T4.58.m3.1.1.3"><csymbol cd="ambiguous" id="A1.T4.58.m3.1.1.3.1.cmml" xref="A1.T4.58.m3.1.1.3">superscript</csymbol><cn type="integer" id="A1.T4.58.m3.1.1.3.2.cmml" xref="A1.T4.58.m3.1.1.3.2">10</cn><cn type="integer" id="A1.T4.58.m3.1.1.3.3.cmml" xref="A1.T4.58.m3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.58.m3.1d">\beta=10^{3}</annotation></semantics></math> for ASR, <math id="A1.T4.59.m4.1" class="ltx_Math" alttext="\alpha=-10^{4}" display="inline"><semantics id="A1.T4.59.m4.1b"><mrow id="A1.T4.59.m4.1.1" xref="A1.T4.59.m4.1.1.cmml"><mi id="A1.T4.59.m4.1.1.2" xref="A1.T4.59.m4.1.1.2.cmml">α</mi><mo id="A1.T4.59.m4.1.1.1" xref="A1.T4.59.m4.1.1.1.cmml">=</mo><mrow id="A1.T4.59.m4.1.1.3" xref="A1.T4.59.m4.1.1.3.cmml"><mo id="A1.T4.59.m4.1.1.3b" xref="A1.T4.59.m4.1.1.3.cmml">−</mo><msup id="A1.T4.59.m4.1.1.3.2" xref="A1.T4.59.m4.1.1.3.2.cmml"><mn id="A1.T4.59.m4.1.1.3.2.2" xref="A1.T4.59.m4.1.1.3.2.2.cmml">10</mn><mn id="A1.T4.59.m4.1.1.3.2.3" xref="A1.T4.59.m4.1.1.3.2.3.cmml">4</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.59.m4.1c"><apply id="A1.T4.59.m4.1.1.cmml" xref="A1.T4.59.m4.1.1"><eq id="A1.T4.59.m4.1.1.1.cmml" xref="A1.T4.59.m4.1.1.1"></eq><ci id="A1.T4.59.m4.1.1.2.cmml" xref="A1.T4.59.m4.1.1.2">𝛼</ci><apply id="A1.T4.59.m4.1.1.3.cmml" xref="A1.T4.59.m4.1.1.3"><minus id="A1.T4.59.m4.1.1.3.1.cmml" xref="A1.T4.59.m4.1.1.3"></minus><apply id="A1.T4.59.m4.1.1.3.2.cmml" xref="A1.T4.59.m4.1.1.3.2"><csymbol cd="ambiguous" id="A1.T4.59.m4.1.1.3.2.1.cmml" xref="A1.T4.59.m4.1.1.3.2">superscript</csymbol><cn type="integer" id="A1.T4.59.m4.1.1.3.2.2.cmml" xref="A1.T4.59.m4.1.1.3.2.2">10</cn><cn type="integer" id="A1.T4.59.m4.1.1.3.2.3.cmml" xref="A1.T4.59.m4.1.1.3.2.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.59.m4.1d">\alpha=-10^{4}</annotation></semantics></math> and <math id="A1.T4.60.m5.1" class="ltx_Math" alttext="\beta=10^{4}" display="inline"><semantics id="A1.T4.60.m5.1b"><mrow id="A1.T4.60.m5.1.1" xref="A1.T4.60.m5.1.1.cmml"><mi id="A1.T4.60.m5.1.1.2" xref="A1.T4.60.m5.1.1.2.cmml">β</mi><mo id="A1.T4.60.m5.1.1.1" xref="A1.T4.60.m5.1.1.1.cmml">=</mo><msup id="A1.T4.60.m5.1.1.3" xref="A1.T4.60.m5.1.1.3.cmml"><mn id="A1.T4.60.m5.1.1.3.2" xref="A1.T4.60.m5.1.1.3.2.cmml">10</mn><mn id="A1.T4.60.m5.1.1.3.3" xref="A1.T4.60.m5.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.60.m5.1c"><apply id="A1.T4.60.m5.1.1.cmml" xref="A1.T4.60.m5.1.1"><eq id="A1.T4.60.m5.1.1.1.cmml" xref="A1.T4.60.m5.1.1.1"></eq><ci id="A1.T4.60.m5.1.1.2.cmml" xref="A1.T4.60.m5.1.1.2">𝛽</ci><apply id="A1.T4.60.m5.1.1.3.cmml" xref="A1.T4.60.m5.1.1.3"><csymbol cd="ambiguous" id="A1.T4.60.m5.1.1.3.1.cmml" xref="A1.T4.60.m5.1.1.3">superscript</csymbol><cn type="integer" id="A1.T4.60.m5.1.1.3.2.cmml" xref="A1.T4.60.m5.1.1.3.2">10</cn><cn type="integer" id="A1.T4.60.m5.1.1.3.3.cmml" xref="A1.T4.60.m5.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.60.m5.1d">\beta=10^{4}</annotation></semantics></math> for summarization.
</figcaption>
</figure>
</section>
<section id="A1.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Effect of Scaling Logits</h3>

<figure id="A1.T5" class="ltx_table">
<div id="A1.T5.54" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:608.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(9.2pt,-16.2pt) scale(1.05608310842547,1.05608310842547) ;">
<table id="A1.T5.54.54" class="ltx_tabular ltx_align_middle">
<tr id="A1.T5.3.3.3" class="ltx_tr">
<td id="A1.T5.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="A1.T5.3.3.3.4.1" class="ltx_text ltx_font_bold">Draft/Target</span></td>
<td id="A1.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">
<span id="A1.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Scale</span> (<math id="A1.T5.1.1.1.1.m1.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="A1.T5.1.1.1.1.m1.2a"><mrow id="A1.T5.1.1.1.1.m1.2.3.2" xref="A1.T5.1.1.1.1.m1.2.3.1.cmml"><mi id="A1.T5.1.1.1.1.m1.1.1" xref="A1.T5.1.1.1.1.m1.1.1.cmml">α</mi><mo id="A1.T5.1.1.1.1.m1.2.3.2.1" xref="A1.T5.1.1.1.1.m1.2.3.1.cmml">,</mo><mi id="A1.T5.1.1.1.1.m1.2.2" xref="A1.T5.1.1.1.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.1.m1.2b"><list id="A1.T5.1.1.1.1.m1.2.3.1.cmml" xref="A1.T5.1.1.1.1.m1.2.3.2"><ci id="A1.T5.1.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.1.m1.1.1">𝛼</ci><ci id="A1.T5.1.1.1.1.m1.2.2.cmml" xref="A1.T5.1.1.1.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.1.1.1.1.m1.2c">\alpha,\beta</annotation></semantics></math>)</td>
<td id="A1.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="A1.T5.2.2.2.2.1" class="ltx_text ltx_font_bold">WER <math id="A1.T5.2.2.2.2.1.m1.1" class="ltx_Math" alttext="(\downarrow)" display="inline"><semantics id="A1.T5.2.2.2.2.1.m1.1a"><mrow id="A1.T5.2.2.2.2.1.m1.1.2.2"><mo stretchy="false" id="A1.T5.2.2.2.2.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="A1.T5.2.2.2.2.1.m1.1.1" xref="A1.T5.2.2.2.2.1.m1.1.1.cmml">↓</mo><mo stretchy="false" id="A1.T5.2.2.2.2.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.2.2.2.2.1.m1.1b"><ci id="A1.T5.2.2.2.2.1.m1.1.1.cmml" xref="A1.T5.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.2.2.2.2.1.m1.1c">(\downarrow)</annotation></semantics></math></span></td>
<td id="A1.T5.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">
<math id="A1.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A1.T5.3.3.3.3.m1.1a"><mi mathvariant="normal" id="A1.T5.3.3.3.3.m1.1.1" xref="A1.T5.3.3.3.3.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.T5.3.3.3.3.m1.1b"><ci id="A1.T5.3.3.3.3.m1.1.1.cmml" xref="A1.T5.3.3.3.3.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.3.3.3.3.m1.1c">\Delta</annotation></semantics></math>% <span id="A1.T5.3.3.3.3.1" class="ltx_text ltx_font_bold">Prof. Time</span>
</td>
</tr>
<tr id="A1.T5.54.54.55" class="ltx_tr">
<td id="A1.T5.54.54.55.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.55.1.1" class="ltx_text"><span id="A1.T5.54.54.55.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.55.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.55.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.55.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.55.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Whisper Small.EN</span></span>
<span id="A1.T5.54.54.55.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.55.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distil Small.EN</span></span>
</span></span> <span id="A1.T5.54.54.55.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.55.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.55.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A1.T5.54.54.55.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.24</td>
<td id="A1.T5.54.54.55.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.5.5.5" class="ltx_tr">
<td id="A1.T5.4.4.4.1" class="ltx_td ltx_align_center"><math id="A1.T5.4.4.4.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.4.4.4.1.m1.1a"><mrow id="A1.T5.4.4.4.1.m1.1.1" xref="A1.T5.4.4.4.1.m1.1.1.cmml"><mo id="A1.T5.4.4.4.1.m1.1.1a" xref="A1.T5.4.4.4.1.m1.1.1.cmml">−</mo><msup id="A1.T5.4.4.4.1.m1.1.1.2" xref="A1.T5.4.4.4.1.m1.1.1.2.cmml"><mn id="A1.T5.4.4.4.1.m1.1.1.2.2" xref="A1.T5.4.4.4.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.4.4.4.1.m1.1.1.2.3" xref="A1.T5.4.4.4.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.4.4.4.1.m1.1b"><apply id="A1.T5.4.4.4.1.m1.1.1.cmml" xref="A1.T5.4.4.4.1.m1.1.1"><minus id="A1.T5.4.4.4.1.m1.1.1.1.cmml" xref="A1.T5.4.4.4.1.m1.1.1"></minus><apply id="A1.T5.4.4.4.1.m1.1.1.2.cmml" xref="A1.T5.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.4.4.4.1.m1.1.1.2.1.cmml" xref="A1.T5.4.4.4.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.4.4.4.1.m1.1.1.2.2.cmml" xref="A1.T5.4.4.4.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.4.4.4.1.m1.1.1.2.3.cmml" xref="A1.T5.4.4.4.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.4.4.4.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.5.5.5.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.5.5.5.2.m1.1a"><msup id="A1.T5.5.5.5.2.m1.1.1" xref="A1.T5.5.5.5.2.m1.1.1.cmml"><mn id="A1.T5.5.5.5.2.m1.1.1.2" xref="A1.T5.5.5.5.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.5.5.5.2.m1.1.1.3" xref="A1.T5.5.5.5.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.5.5.5.2.m1.1b"><apply id="A1.T5.5.5.5.2.m1.1.1.cmml" xref="A1.T5.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.5.5.5.2.m1.1.1.1.cmml" xref="A1.T5.5.5.5.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.5.5.5.2.m1.1.1.2.cmml" xref="A1.T5.5.5.5.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.5.5.5.2.m1.1.1.3.cmml" xref="A1.T5.5.5.5.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.5.5.5.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.5.5.5.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.41</td>
<td id="A1.T5.5.5.5.4" class="ltx_td ltx_align_center">24.0%</td>
</tr>
<tr id="A1.T5.7.7.7" class="ltx_tr">
<td id="A1.T5.6.6.6.1" class="ltx_td ltx_align_center"><math id="A1.T5.6.6.6.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.6.6.6.1.m1.1a"><mrow id="A1.T5.6.6.6.1.m1.1.1" xref="A1.T5.6.6.6.1.m1.1.1.cmml"><mo id="A1.T5.6.6.6.1.m1.1.1a" xref="A1.T5.6.6.6.1.m1.1.1.cmml">−</mo><msup id="A1.T5.6.6.6.1.m1.1.1.2" xref="A1.T5.6.6.6.1.m1.1.1.2.cmml"><mn id="A1.T5.6.6.6.1.m1.1.1.2.2" xref="A1.T5.6.6.6.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.6.6.6.1.m1.1.1.2.3" xref="A1.T5.6.6.6.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.6.6.6.1.m1.1b"><apply id="A1.T5.6.6.6.1.m1.1.1.cmml" xref="A1.T5.6.6.6.1.m1.1.1"><minus id="A1.T5.6.6.6.1.m1.1.1.1.cmml" xref="A1.T5.6.6.6.1.m1.1.1"></minus><apply id="A1.T5.6.6.6.1.m1.1.1.2.cmml" xref="A1.T5.6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.6.6.6.1.m1.1.1.2.1.cmml" xref="A1.T5.6.6.6.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.6.6.6.1.m1.1.1.2.2.cmml" xref="A1.T5.6.6.6.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.6.6.6.1.m1.1.1.2.3.cmml" xref="A1.T5.6.6.6.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.6.6.6.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.7.7.7.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.7.7.7.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.7.7.7.2.m1.1a"><msup id="A1.T5.7.7.7.2.m1.1.1" xref="A1.T5.7.7.7.2.m1.1.1.cmml"><mn id="A1.T5.7.7.7.2.m1.1.1.2" xref="A1.T5.7.7.7.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.7.7.7.2.m1.1.1.3" xref="A1.T5.7.7.7.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.7.7.7.2.m1.1b"><apply id="A1.T5.7.7.7.2.m1.1.1.cmml" xref="A1.T5.7.7.7.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.7.7.7.2.m1.1.1.1.cmml" xref="A1.T5.7.7.7.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.7.7.7.2.m1.1.1.2.cmml" xref="A1.T5.7.7.7.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.7.7.7.2.m1.1.1.3.cmml" xref="A1.T5.7.7.7.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.7.7.7.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.7.7.7.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.7.7.7.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.28</td>
<td id="A1.T5.7.7.7.4" class="ltx_td ltx_align_center">59.5%</td>
</tr>
<tr id="A1.T5.9.9.9" class="ltx_tr">
<td id="A1.T5.8.8.8.1" class="ltx_td ltx_align_center"><math id="A1.T5.8.8.8.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.8.8.8.1.m1.1a"><mrow id="A1.T5.8.8.8.1.m1.1.1" xref="A1.T5.8.8.8.1.m1.1.1.cmml"><mo id="A1.T5.8.8.8.1.m1.1.1a" xref="A1.T5.8.8.8.1.m1.1.1.cmml">−</mo><msup id="A1.T5.8.8.8.1.m1.1.1.2" xref="A1.T5.8.8.8.1.m1.1.1.2.cmml"><mn id="A1.T5.8.8.8.1.m1.1.1.2.2" xref="A1.T5.8.8.8.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.8.8.8.1.m1.1.1.2.3" xref="A1.T5.8.8.8.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.8.8.8.1.m1.1b"><apply id="A1.T5.8.8.8.1.m1.1.1.cmml" xref="A1.T5.8.8.8.1.m1.1.1"><minus id="A1.T5.8.8.8.1.m1.1.1.1.cmml" xref="A1.T5.8.8.8.1.m1.1.1"></minus><apply id="A1.T5.8.8.8.1.m1.1.1.2.cmml" xref="A1.T5.8.8.8.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.8.8.8.1.m1.1.1.2.1.cmml" xref="A1.T5.8.8.8.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.8.8.8.1.m1.1.1.2.2.cmml" xref="A1.T5.8.8.8.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.8.8.8.1.m1.1.1.2.3.cmml" xref="A1.T5.8.8.8.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.8.8.8.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.9.9.9.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.9.9.9.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.9.9.9.2.m1.1a"><msup id="A1.T5.9.9.9.2.m1.1.1" xref="A1.T5.9.9.9.2.m1.1.1.cmml"><mn id="A1.T5.9.9.9.2.m1.1.1.2" xref="A1.T5.9.9.9.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.9.9.9.2.m1.1.1.3" xref="A1.T5.9.9.9.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.9.9.9.2.m1.1b"><apply id="A1.T5.9.9.9.2.m1.1.1.cmml" xref="A1.T5.9.9.9.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.9.9.9.2.m1.1.1.1.cmml" xref="A1.T5.9.9.9.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.9.9.9.2.m1.1.1.2.cmml" xref="A1.T5.9.9.9.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.9.9.9.2.m1.1.1.3.cmml" xref="A1.T5.9.9.9.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.9.9.9.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.9.9.9.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.26</td>
<td id="A1.T5.9.9.9.4" class="ltx_td ltx_align_center">64.6%</td>
</tr>
<tr id="A1.T5.11.11.11" class="ltx_tr">
<td id="A1.T5.10.10.10.1" class="ltx_td ltx_align_center"><math id="A1.T5.10.10.10.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.10.10.10.1.m1.1a"><mrow id="A1.T5.10.10.10.1.m1.1.1" xref="A1.T5.10.10.10.1.m1.1.1.cmml"><mo id="A1.T5.10.10.10.1.m1.1.1a" xref="A1.T5.10.10.10.1.m1.1.1.cmml">−</mo><msup id="A1.T5.10.10.10.1.m1.1.1.2" xref="A1.T5.10.10.10.1.m1.1.1.2.cmml"><mn id="A1.T5.10.10.10.1.m1.1.1.2.2" xref="A1.T5.10.10.10.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.10.10.10.1.m1.1.1.2.3" xref="A1.T5.10.10.10.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.10.10.10.1.m1.1b"><apply id="A1.T5.10.10.10.1.m1.1.1.cmml" xref="A1.T5.10.10.10.1.m1.1.1"><minus id="A1.T5.10.10.10.1.m1.1.1.1.cmml" xref="A1.T5.10.10.10.1.m1.1.1"></minus><apply id="A1.T5.10.10.10.1.m1.1.1.2.cmml" xref="A1.T5.10.10.10.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.10.10.10.1.m1.1.1.2.1.cmml" xref="A1.T5.10.10.10.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.10.10.10.1.m1.1.1.2.2.cmml" xref="A1.T5.10.10.10.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.10.10.10.1.m1.1.1.2.3.cmml" xref="A1.T5.10.10.10.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.10.10.10.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.11.11.11.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.11.11.11.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.11.11.11.2.m1.1a"><msup id="A1.T5.11.11.11.2.m1.1.1" xref="A1.T5.11.11.11.2.m1.1.1.cmml"><mn id="A1.T5.11.11.11.2.m1.1.1.2" xref="A1.T5.11.11.11.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.11.11.11.2.m1.1.1.3" xref="A1.T5.11.11.11.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.11.11.11.2.m1.1b"><apply id="A1.T5.11.11.11.2.m1.1.1.cmml" xref="A1.T5.11.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.11.11.11.2.m1.1.1.1.cmml" xref="A1.T5.11.11.11.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.11.11.11.2.m1.1.1.2.cmml" xref="A1.T5.11.11.11.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.11.11.11.2.m1.1.1.3.cmml" xref="A1.T5.11.11.11.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.11.11.11.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r">29.34</td>
<td id="A1.T5.11.11.11.4" class="ltx_td ltx_align_center">-10826.1%</td>
</tr>
<tr id="A1.T5.54.54.56" class="ltx_tr">
<td id="A1.T5.54.54.56.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.56.1.1" class="ltx_text"><span id="A1.T5.54.54.56.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.56.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.56.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.56.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.56.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Whisper Large V2/</span></span>
<span id="A1.T5.54.54.56.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.56.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distil Large V2</span></span>
</span></span> <span id="A1.T5.54.54.56.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.56.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.56.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A1.T5.54.54.56.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.24</td>
<td id="A1.T5.54.54.56.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.13.13.13" class="ltx_tr">
<td id="A1.T5.12.12.12.1" class="ltx_td ltx_align_center"><math id="A1.T5.12.12.12.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.12.12.12.1.m1.1a"><mrow id="A1.T5.12.12.12.1.m1.1.1" xref="A1.T5.12.12.12.1.m1.1.1.cmml"><mo id="A1.T5.12.12.12.1.m1.1.1a" xref="A1.T5.12.12.12.1.m1.1.1.cmml">−</mo><msup id="A1.T5.12.12.12.1.m1.1.1.2" xref="A1.T5.12.12.12.1.m1.1.1.2.cmml"><mn id="A1.T5.12.12.12.1.m1.1.1.2.2" xref="A1.T5.12.12.12.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.12.12.12.1.m1.1.1.2.3" xref="A1.T5.12.12.12.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.12.12.12.1.m1.1b"><apply id="A1.T5.12.12.12.1.m1.1.1.cmml" xref="A1.T5.12.12.12.1.m1.1.1"><minus id="A1.T5.12.12.12.1.m1.1.1.1.cmml" xref="A1.T5.12.12.12.1.m1.1.1"></minus><apply id="A1.T5.12.12.12.1.m1.1.1.2.cmml" xref="A1.T5.12.12.12.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.12.12.12.1.m1.1.1.2.1.cmml" xref="A1.T5.12.12.12.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.12.12.12.1.m1.1.1.2.2.cmml" xref="A1.T5.12.12.12.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.12.12.12.1.m1.1.1.2.3.cmml" xref="A1.T5.12.12.12.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.12.12.12.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.13.13.13.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.13.13.13.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.13.13.13.2.m1.1a"><msup id="A1.T5.13.13.13.2.m1.1.1" xref="A1.T5.13.13.13.2.m1.1.1.cmml"><mn id="A1.T5.13.13.13.2.m1.1.1.2" xref="A1.T5.13.13.13.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.13.13.13.2.m1.1.1.3" xref="A1.T5.13.13.13.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.13.13.13.2.m1.1b"><apply id="A1.T5.13.13.13.2.m1.1.1.cmml" xref="A1.T5.13.13.13.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.13.13.13.2.m1.1.1.1.cmml" xref="A1.T5.13.13.13.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.13.13.13.2.m1.1.1.2.cmml" xref="A1.T5.13.13.13.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.13.13.13.2.m1.1.1.3.cmml" xref="A1.T5.13.13.13.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.13.13.13.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.13.13.13.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.13.13.13.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.42</td>
<td id="A1.T5.13.13.13.4" class="ltx_td ltx_align_center">64.3%</td>
</tr>
<tr id="A1.T5.15.15.15" class="ltx_tr">
<td id="A1.T5.14.14.14.1" class="ltx_td ltx_align_center"><math id="A1.T5.14.14.14.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.14.14.14.1.m1.1a"><mrow id="A1.T5.14.14.14.1.m1.1.1" xref="A1.T5.14.14.14.1.m1.1.1.cmml"><mo id="A1.T5.14.14.14.1.m1.1.1a" xref="A1.T5.14.14.14.1.m1.1.1.cmml">−</mo><msup id="A1.T5.14.14.14.1.m1.1.1.2" xref="A1.T5.14.14.14.1.m1.1.1.2.cmml"><mn id="A1.T5.14.14.14.1.m1.1.1.2.2" xref="A1.T5.14.14.14.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.14.14.14.1.m1.1.1.2.3" xref="A1.T5.14.14.14.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.14.14.14.1.m1.1b"><apply id="A1.T5.14.14.14.1.m1.1.1.cmml" xref="A1.T5.14.14.14.1.m1.1.1"><minus id="A1.T5.14.14.14.1.m1.1.1.1.cmml" xref="A1.T5.14.14.14.1.m1.1.1"></minus><apply id="A1.T5.14.14.14.1.m1.1.1.2.cmml" xref="A1.T5.14.14.14.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.14.14.14.1.m1.1.1.2.1.cmml" xref="A1.T5.14.14.14.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.14.14.14.1.m1.1.1.2.2.cmml" xref="A1.T5.14.14.14.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.14.14.14.1.m1.1.1.2.3.cmml" xref="A1.T5.14.14.14.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.14.14.14.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.15.15.15.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.15.15.15.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.15.15.15.2.m1.1a"><msup id="A1.T5.15.15.15.2.m1.1.1" xref="A1.T5.15.15.15.2.m1.1.1.cmml"><mn id="A1.T5.15.15.15.2.m1.1.1.2" xref="A1.T5.15.15.15.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.15.15.15.2.m1.1.1.3" xref="A1.T5.15.15.15.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.15.15.15.2.m1.1b"><apply id="A1.T5.15.15.15.2.m1.1.1.cmml" xref="A1.T5.15.15.15.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.15.15.15.2.m1.1.1.1.cmml" xref="A1.T5.15.15.15.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.15.15.15.2.m1.1.1.2.cmml" xref="A1.T5.15.15.15.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.15.15.15.2.m1.1.1.3.cmml" xref="A1.T5.15.15.15.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.15.15.15.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.15.15.15.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.15.15.15.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.34</td>
<td id="A1.T5.15.15.15.4" class="ltx_td ltx_align_center">75.0%</td>
</tr>
<tr id="A1.T5.17.17.17" class="ltx_tr">
<td id="A1.T5.16.16.16.1" class="ltx_td ltx_align_center"><math id="A1.T5.16.16.16.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.16.16.16.1.m1.1a"><mrow id="A1.T5.16.16.16.1.m1.1.1" xref="A1.T5.16.16.16.1.m1.1.1.cmml"><mo id="A1.T5.16.16.16.1.m1.1.1a" xref="A1.T5.16.16.16.1.m1.1.1.cmml">−</mo><msup id="A1.T5.16.16.16.1.m1.1.1.2" xref="A1.T5.16.16.16.1.m1.1.1.2.cmml"><mn id="A1.T5.16.16.16.1.m1.1.1.2.2" xref="A1.T5.16.16.16.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.16.16.16.1.m1.1.1.2.3" xref="A1.T5.16.16.16.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.16.16.16.1.m1.1b"><apply id="A1.T5.16.16.16.1.m1.1.1.cmml" xref="A1.T5.16.16.16.1.m1.1.1"><minus id="A1.T5.16.16.16.1.m1.1.1.1.cmml" xref="A1.T5.16.16.16.1.m1.1.1"></minus><apply id="A1.T5.16.16.16.1.m1.1.1.2.cmml" xref="A1.T5.16.16.16.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.16.16.16.1.m1.1.1.2.1.cmml" xref="A1.T5.16.16.16.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.16.16.16.1.m1.1.1.2.2.cmml" xref="A1.T5.16.16.16.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.16.16.16.1.m1.1.1.2.3.cmml" xref="A1.T5.16.16.16.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.16.16.16.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.17.17.17.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.17.17.17.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.17.17.17.2.m1.1a"><msup id="A1.T5.17.17.17.2.m1.1.1" xref="A1.T5.17.17.17.2.m1.1.1.cmml"><mn id="A1.T5.17.17.17.2.m1.1.1.2" xref="A1.T5.17.17.17.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.17.17.17.2.m1.1.1.3" xref="A1.T5.17.17.17.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.17.17.17.2.m1.1b"><apply id="A1.T5.17.17.17.2.m1.1.1.cmml" xref="A1.T5.17.17.17.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.17.17.17.2.m1.1.1.1.cmml" xref="A1.T5.17.17.17.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.17.17.17.2.m1.1.1.2.cmml" xref="A1.T5.17.17.17.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.17.17.17.2.m1.1.1.3.cmml" xref="A1.T5.17.17.17.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.17.17.17.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.17.17.17.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="A1.T5.17.17.17.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.31</td>
<td id="A1.T5.17.17.17.4" class="ltx_td ltx_align_center">78.6%</td>
</tr>
<tr id="A1.T5.19.19.19" class="ltx_tr">
<td id="A1.T5.18.18.18.1" class="ltx_td ltx_align_center"><math id="A1.T5.18.18.18.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.18.18.18.1.m1.1a"><mrow id="A1.T5.18.18.18.1.m1.1.1" xref="A1.T5.18.18.18.1.m1.1.1.cmml"><mo id="A1.T5.18.18.18.1.m1.1.1a" xref="A1.T5.18.18.18.1.m1.1.1.cmml">−</mo><msup id="A1.T5.18.18.18.1.m1.1.1.2" xref="A1.T5.18.18.18.1.m1.1.1.2.cmml"><mn id="A1.T5.18.18.18.1.m1.1.1.2.2" xref="A1.T5.18.18.18.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.18.18.18.1.m1.1.1.2.3" xref="A1.T5.18.18.18.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.18.18.18.1.m1.1b"><apply id="A1.T5.18.18.18.1.m1.1.1.cmml" xref="A1.T5.18.18.18.1.m1.1.1"><minus id="A1.T5.18.18.18.1.m1.1.1.1.cmml" xref="A1.T5.18.18.18.1.m1.1.1"></minus><apply id="A1.T5.18.18.18.1.m1.1.1.2.cmml" xref="A1.T5.18.18.18.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.18.18.18.1.m1.1.1.2.1.cmml" xref="A1.T5.18.18.18.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.18.18.18.1.m1.1.1.2.2.cmml" xref="A1.T5.18.18.18.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.18.18.18.1.m1.1.1.2.3.cmml" xref="A1.T5.18.18.18.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.18.18.18.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.19.19.19.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.19.19.19.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.19.19.19.2.m1.1a"><msup id="A1.T5.19.19.19.2.m1.1.1" xref="A1.T5.19.19.19.2.m1.1.1.cmml"><mn id="A1.T5.19.19.19.2.m1.1.1.2" xref="A1.T5.19.19.19.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.19.19.19.2.m1.1.1.3" xref="A1.T5.19.19.19.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.19.19.19.2.m1.1b"><apply id="A1.T5.19.19.19.2.m1.1.1.cmml" xref="A1.T5.19.19.19.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.19.19.19.2.m1.1.1.1.cmml" xref="A1.T5.19.19.19.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.19.19.19.2.m1.1.1.2.cmml" xref="A1.T5.19.19.19.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.19.19.19.2.m1.1.1.3.cmml" xref="A1.T5.19.19.19.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.19.19.19.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.19.19.19.3" class="ltx_td ltx_align_center ltx_border_r">30.91</td>
<td id="A1.T5.19.19.19.4" class="ltx_td ltx_align_center">-4458.3%</td>
</tr>
<tr id="A1.T5.22.22.22" class="ltx_tr">
<td id="A1.T5.22.22.22.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt"><span id="A1.T5.22.22.22.4.1" class="ltx_text ltx_font_bold">Draft/Target</span></td>
<td id="A1.T5.20.20.20.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" colspan="2">
<span id="A1.T5.20.20.20.1.1" class="ltx_text ltx_font_bold">Scale</span> (<math id="A1.T5.20.20.20.1.m1.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="A1.T5.20.20.20.1.m1.2a"><mrow id="A1.T5.20.20.20.1.m1.2.3.2" xref="A1.T5.20.20.20.1.m1.2.3.1.cmml"><mi id="A1.T5.20.20.20.1.m1.1.1" xref="A1.T5.20.20.20.1.m1.1.1.cmml">α</mi><mo id="A1.T5.20.20.20.1.m1.2.3.2.1" xref="A1.T5.20.20.20.1.m1.2.3.1.cmml">,</mo><mi id="A1.T5.20.20.20.1.m1.2.2" xref="A1.T5.20.20.20.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.20.20.20.1.m1.2b"><list id="A1.T5.20.20.20.1.m1.2.3.1.cmml" xref="A1.T5.20.20.20.1.m1.2.3.2"><ci id="A1.T5.20.20.20.1.m1.1.1.cmml" xref="A1.T5.20.20.20.1.m1.1.1">𝛼</ci><ci id="A1.T5.20.20.20.1.m1.2.2.cmml" xref="A1.T5.20.20.20.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.20.20.20.1.m1.2c">\alpha,\beta</annotation></semantics></math>)</td>
<td id="A1.T5.21.21.21.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt"><span id="A1.T5.21.21.21.2.1" class="ltx_text ltx_font_bold">ROUGE-1 <math id="A1.T5.21.21.21.2.1.m1.1" class="ltx_Math" alttext="(\uparrow)" display="inline"><semantics id="A1.T5.21.21.21.2.1.m1.1a"><mrow id="A1.T5.21.21.21.2.1.m1.1.2.2"><mo stretchy="false" id="A1.T5.21.21.21.2.1.m1.1.2.2.1">(</mo><mo lspace="0em" rspace="0em" stretchy="false" id="A1.T5.21.21.21.2.1.m1.1.1" xref="A1.T5.21.21.21.2.1.m1.1.1.cmml">↑</mo><mo stretchy="false" id="A1.T5.21.21.21.2.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.21.21.21.2.1.m1.1b"><ci id="A1.T5.21.21.21.2.1.m1.1.1.cmml" xref="A1.T5.21.21.21.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.21.21.21.2.1.m1.1c">(\uparrow)</annotation></semantics></math></span></td>
<td id="A1.T5.22.22.22.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt">
<math id="A1.T5.22.22.22.3.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A1.T5.22.22.22.3.m1.1a"><mi mathvariant="normal" id="A1.T5.22.22.22.3.m1.1.1" xref="A1.T5.22.22.22.3.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.T5.22.22.22.3.m1.1b"><ci id="A1.T5.22.22.22.3.m1.1.1.cmml" xref="A1.T5.22.22.22.3.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.22.22.22.3.m1.1c">\Delta</annotation></semantics></math>% <span id="A1.T5.22.22.22.3.1" class="ltx_text ltx_font_bold">Prof. Time</span>
</td>
</tr>
<tr id="A1.T5.54.54.57" class="ltx_tr">
<td id="A1.T5.54.54.57.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.57.1.1" class="ltx_text"><span id="A1.T5.54.54.57.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.57.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.57.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.57.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.57.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Gemma 7B/</span></span>
<span id="A1.T5.54.54.57.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.57.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Gemma 2B</span></span>
</span></span> <span id="A1.T5.54.54.57.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.57.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.57.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.17</td>
<td id="A1.T5.54.54.57.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.24.24.24" class="ltx_tr">
<td id="A1.T5.23.23.23.1" class="ltx_td ltx_align_center"><math id="A1.T5.23.23.23.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.23.23.23.1.m1.1a"><mrow id="A1.T5.23.23.23.1.m1.1.1" xref="A1.T5.23.23.23.1.m1.1.1.cmml"><mo id="A1.T5.23.23.23.1.m1.1.1a" xref="A1.T5.23.23.23.1.m1.1.1.cmml">−</mo><msup id="A1.T5.23.23.23.1.m1.1.1.2" xref="A1.T5.23.23.23.1.m1.1.1.2.cmml"><mn id="A1.T5.23.23.23.1.m1.1.1.2.2" xref="A1.T5.23.23.23.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.23.23.23.1.m1.1.1.2.3" xref="A1.T5.23.23.23.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.23.23.23.1.m1.1b"><apply id="A1.T5.23.23.23.1.m1.1.1.cmml" xref="A1.T5.23.23.23.1.m1.1.1"><minus id="A1.T5.23.23.23.1.m1.1.1.1.cmml" xref="A1.T5.23.23.23.1.m1.1.1"></minus><apply id="A1.T5.23.23.23.1.m1.1.1.2.cmml" xref="A1.T5.23.23.23.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.23.23.23.1.m1.1.1.2.1.cmml" xref="A1.T5.23.23.23.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.23.23.23.1.m1.1.1.2.2.cmml" xref="A1.T5.23.23.23.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.23.23.23.1.m1.1.1.2.3.cmml" xref="A1.T5.23.23.23.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.23.23.23.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.24.24.24.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.24.24.24.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.24.24.24.2.m1.1a"><msup id="A1.T5.24.24.24.2.m1.1.1" xref="A1.T5.24.24.24.2.m1.1.1.cmml"><mn id="A1.T5.24.24.24.2.m1.1.1.2" xref="A1.T5.24.24.24.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.24.24.24.2.m1.1.1.3" xref="A1.T5.24.24.24.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.24.24.24.2.m1.1b"><apply id="A1.T5.24.24.24.2.m1.1.1.cmml" xref="A1.T5.24.24.24.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.24.24.24.2.m1.1.1.1.cmml" xref="A1.T5.24.24.24.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.24.24.24.2.m1.1.1.2.cmml" xref="A1.T5.24.24.24.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.24.24.24.2.m1.1.1.3.cmml" xref="A1.T5.24.24.24.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.24.24.24.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.24.24.24.3" class="ltx_td ltx_align_center ltx_border_r">0.01</td>
<td id="A1.T5.24.24.24.4" class="ltx_td ltx_align_center">-124.6%</td>
</tr>
<tr id="A1.T5.26.26.26" class="ltx_tr">
<td id="A1.T5.25.25.25.1" class="ltx_td ltx_align_center"><math id="A1.T5.25.25.25.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.25.25.25.1.m1.1a"><mrow id="A1.T5.25.25.25.1.m1.1.1" xref="A1.T5.25.25.25.1.m1.1.1.cmml"><mo id="A1.T5.25.25.25.1.m1.1.1a" xref="A1.T5.25.25.25.1.m1.1.1.cmml">−</mo><msup id="A1.T5.25.25.25.1.m1.1.1.2" xref="A1.T5.25.25.25.1.m1.1.1.2.cmml"><mn id="A1.T5.25.25.25.1.m1.1.1.2.2" xref="A1.T5.25.25.25.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.25.25.25.1.m1.1.1.2.3" xref="A1.T5.25.25.25.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.25.25.25.1.m1.1b"><apply id="A1.T5.25.25.25.1.m1.1.1.cmml" xref="A1.T5.25.25.25.1.m1.1.1"><minus id="A1.T5.25.25.25.1.m1.1.1.1.cmml" xref="A1.T5.25.25.25.1.m1.1.1"></minus><apply id="A1.T5.25.25.25.1.m1.1.1.2.cmml" xref="A1.T5.25.25.25.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.25.25.25.1.m1.1.1.2.1.cmml" xref="A1.T5.25.25.25.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.25.25.25.1.m1.1.1.2.2.cmml" xref="A1.T5.25.25.25.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.25.25.25.1.m1.1.1.2.3.cmml" xref="A1.T5.25.25.25.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.25.25.25.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.26.26.26.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.26.26.26.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.26.26.26.2.m1.1a"><msup id="A1.T5.26.26.26.2.m1.1.1" xref="A1.T5.26.26.26.2.m1.1.1.cmml"><mn id="A1.T5.26.26.26.2.m1.1.1.2" xref="A1.T5.26.26.26.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.26.26.26.2.m1.1.1.3" xref="A1.T5.26.26.26.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.26.26.26.2.m1.1b"><apply id="A1.T5.26.26.26.2.m1.1.1.cmml" xref="A1.T5.26.26.26.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.26.26.26.2.m1.1.1.1.cmml" xref="A1.T5.26.26.26.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.26.26.26.2.m1.1.1.2.cmml" xref="A1.T5.26.26.26.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.26.26.26.2.m1.1.1.3.cmml" xref="A1.T5.26.26.26.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.26.26.26.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.26.26.26.3" class="ltx_td ltx_align_center ltx_border_r">0.13</td>
<td id="A1.T5.26.26.26.4" class="ltx_td ltx_align_center">66.1%</td>
</tr>
<tr id="A1.T5.28.28.28" class="ltx_tr">
<td id="A1.T5.27.27.27.1" class="ltx_td ltx_align_center"><math id="A1.T5.27.27.27.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.27.27.27.1.m1.1a"><mrow id="A1.T5.27.27.27.1.m1.1.1" xref="A1.T5.27.27.27.1.m1.1.1.cmml"><mo id="A1.T5.27.27.27.1.m1.1.1a" xref="A1.T5.27.27.27.1.m1.1.1.cmml">−</mo><msup id="A1.T5.27.27.27.1.m1.1.1.2" xref="A1.T5.27.27.27.1.m1.1.1.2.cmml"><mn id="A1.T5.27.27.27.1.m1.1.1.2.2" xref="A1.T5.27.27.27.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.27.27.27.1.m1.1.1.2.3" xref="A1.T5.27.27.27.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.27.27.27.1.m1.1b"><apply id="A1.T5.27.27.27.1.m1.1.1.cmml" xref="A1.T5.27.27.27.1.m1.1.1"><minus id="A1.T5.27.27.27.1.m1.1.1.1.cmml" xref="A1.T5.27.27.27.1.m1.1.1"></minus><apply id="A1.T5.27.27.27.1.m1.1.1.2.cmml" xref="A1.T5.27.27.27.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.27.27.27.1.m1.1.1.2.1.cmml" xref="A1.T5.27.27.27.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.27.27.27.1.m1.1.1.2.2.cmml" xref="A1.T5.27.27.27.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.27.27.27.1.m1.1.1.2.3.cmml" xref="A1.T5.27.27.27.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.27.27.27.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.28.28.28.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.28.28.28.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.28.28.28.2.m1.1a"><msup id="A1.T5.28.28.28.2.m1.1.1" xref="A1.T5.28.28.28.2.m1.1.1.cmml"><mn id="A1.T5.28.28.28.2.m1.1.1.2" xref="A1.T5.28.28.28.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.28.28.28.2.m1.1.1.3" xref="A1.T5.28.28.28.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.28.28.28.2.m1.1b"><apply id="A1.T5.28.28.28.2.m1.1.1.cmml" xref="A1.T5.28.28.28.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.28.28.28.2.m1.1.1.1.cmml" xref="A1.T5.28.28.28.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.28.28.28.2.m1.1.1.2.cmml" xref="A1.T5.28.28.28.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.28.28.28.2.m1.1.1.3.cmml" xref="A1.T5.28.28.28.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.28.28.28.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.28.28.28.3" class="ltx_td ltx_align_center ltx_border_r">0.13</td>
<td id="A1.T5.28.28.28.4" class="ltx_td ltx_align_center">71.3%</td>
</tr>
<tr id="A1.T5.30.30.30" class="ltx_tr">
<td id="A1.T5.29.29.29.1" class="ltx_td ltx_align_center"><math id="A1.T5.29.29.29.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.29.29.29.1.m1.1a"><mrow id="A1.T5.29.29.29.1.m1.1.1" xref="A1.T5.29.29.29.1.m1.1.1.cmml"><mo id="A1.T5.29.29.29.1.m1.1.1a" xref="A1.T5.29.29.29.1.m1.1.1.cmml">−</mo><msup id="A1.T5.29.29.29.1.m1.1.1.2" xref="A1.T5.29.29.29.1.m1.1.1.2.cmml"><mn id="A1.T5.29.29.29.1.m1.1.1.2.2" xref="A1.T5.29.29.29.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.29.29.29.1.m1.1.1.2.3" xref="A1.T5.29.29.29.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.29.29.29.1.m1.1b"><apply id="A1.T5.29.29.29.1.m1.1.1.cmml" xref="A1.T5.29.29.29.1.m1.1.1"><minus id="A1.T5.29.29.29.1.m1.1.1.1.cmml" xref="A1.T5.29.29.29.1.m1.1.1"></minus><apply id="A1.T5.29.29.29.1.m1.1.1.2.cmml" xref="A1.T5.29.29.29.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.29.29.29.1.m1.1.1.2.1.cmml" xref="A1.T5.29.29.29.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.29.29.29.1.m1.1.1.2.2.cmml" xref="A1.T5.29.29.29.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.29.29.29.1.m1.1.1.2.3.cmml" xref="A1.T5.29.29.29.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.29.29.29.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.30.30.30.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.30.30.30.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.30.30.30.2.m1.1a"><msup id="A1.T5.30.30.30.2.m1.1.1" xref="A1.T5.30.30.30.2.m1.1.1.cmml"><mn id="A1.T5.30.30.30.2.m1.1.1.2" xref="A1.T5.30.30.30.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.30.30.30.2.m1.1.1.3" xref="A1.T5.30.30.30.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.30.30.30.2.m1.1b"><apply id="A1.T5.30.30.30.2.m1.1.1.cmml" xref="A1.T5.30.30.30.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.30.30.30.2.m1.1.1.1.cmml" xref="A1.T5.30.30.30.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.30.30.30.2.m1.1.1.2.cmml" xref="A1.T5.30.30.30.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.30.30.30.2.m1.1.1.3.cmml" xref="A1.T5.30.30.30.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.30.30.30.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.30.30.30.3" class="ltx_td ltx_align_center ltx_border_r">0.14</td>
<td id="A1.T5.30.30.30.4" class="ltx_td ltx_align_center">73.0%</td>
</tr>
<tr id="A1.T5.54.54.58" class="ltx_tr">
<td id="A1.T5.54.54.58.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.58.1.1" class="ltx_text"><span id="A1.T5.54.54.58.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.58.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.58.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.58.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.58.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Qwen 7B/</span></span>
<span id="A1.T5.54.54.58.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.58.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Qwen 0.5B</span></span>
</span></span> <span id="A1.T5.54.54.58.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.58.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.58.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.18</td>
<td id="A1.T5.54.54.58.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.32.32.32" class="ltx_tr">
<td id="A1.T5.31.31.31.1" class="ltx_td ltx_align_center"><math id="A1.T5.31.31.31.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.31.31.31.1.m1.1a"><mrow id="A1.T5.31.31.31.1.m1.1.1" xref="A1.T5.31.31.31.1.m1.1.1.cmml"><mo id="A1.T5.31.31.31.1.m1.1.1a" xref="A1.T5.31.31.31.1.m1.1.1.cmml">−</mo><msup id="A1.T5.31.31.31.1.m1.1.1.2" xref="A1.T5.31.31.31.1.m1.1.1.2.cmml"><mn id="A1.T5.31.31.31.1.m1.1.1.2.2" xref="A1.T5.31.31.31.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.31.31.31.1.m1.1.1.2.3" xref="A1.T5.31.31.31.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.31.31.31.1.m1.1b"><apply id="A1.T5.31.31.31.1.m1.1.1.cmml" xref="A1.T5.31.31.31.1.m1.1.1"><minus id="A1.T5.31.31.31.1.m1.1.1.1.cmml" xref="A1.T5.31.31.31.1.m1.1.1"></minus><apply id="A1.T5.31.31.31.1.m1.1.1.2.cmml" xref="A1.T5.31.31.31.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.31.31.31.1.m1.1.1.2.1.cmml" xref="A1.T5.31.31.31.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.31.31.31.1.m1.1.1.2.2.cmml" xref="A1.T5.31.31.31.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.31.31.31.1.m1.1.1.2.3.cmml" xref="A1.T5.31.31.31.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.31.31.31.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.32.32.32.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.32.32.32.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.32.32.32.2.m1.1a"><msup id="A1.T5.32.32.32.2.m1.1.1" xref="A1.T5.32.32.32.2.m1.1.1.cmml"><mn id="A1.T5.32.32.32.2.m1.1.1.2" xref="A1.T5.32.32.32.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.32.32.32.2.m1.1.1.3" xref="A1.T5.32.32.32.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.32.32.32.2.m1.1b"><apply id="A1.T5.32.32.32.2.m1.1.1.cmml" xref="A1.T5.32.32.32.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.32.32.32.2.m1.1.1.1.cmml" xref="A1.T5.32.32.32.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.32.32.32.2.m1.1.1.2.cmml" xref="A1.T5.32.32.32.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.32.32.32.2.m1.1.1.3.cmml" xref="A1.T5.32.32.32.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.32.32.32.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.32.32.32.3" class="ltx_td ltx_align_center ltx_border_r">0.09</td>
<td id="A1.T5.32.32.32.4" class="ltx_td ltx_align_center">57.6%</td>
</tr>
<tr id="A1.T5.34.34.34" class="ltx_tr">
<td id="A1.T5.33.33.33.1" class="ltx_td ltx_align_center"><math id="A1.T5.33.33.33.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.33.33.33.1.m1.1a"><mrow id="A1.T5.33.33.33.1.m1.1.1" xref="A1.T5.33.33.33.1.m1.1.1.cmml"><mo id="A1.T5.33.33.33.1.m1.1.1a" xref="A1.T5.33.33.33.1.m1.1.1.cmml">−</mo><msup id="A1.T5.33.33.33.1.m1.1.1.2" xref="A1.T5.33.33.33.1.m1.1.1.2.cmml"><mn id="A1.T5.33.33.33.1.m1.1.1.2.2" xref="A1.T5.33.33.33.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.33.33.33.1.m1.1.1.2.3" xref="A1.T5.33.33.33.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.33.33.33.1.m1.1b"><apply id="A1.T5.33.33.33.1.m1.1.1.cmml" xref="A1.T5.33.33.33.1.m1.1.1"><minus id="A1.T5.33.33.33.1.m1.1.1.1.cmml" xref="A1.T5.33.33.33.1.m1.1.1"></minus><apply id="A1.T5.33.33.33.1.m1.1.1.2.cmml" xref="A1.T5.33.33.33.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.33.33.33.1.m1.1.1.2.1.cmml" xref="A1.T5.33.33.33.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.33.33.33.1.m1.1.1.2.2.cmml" xref="A1.T5.33.33.33.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.33.33.33.1.m1.1.1.2.3.cmml" xref="A1.T5.33.33.33.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.33.33.33.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.34.34.34.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.34.34.34.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.34.34.34.2.m1.1a"><msup id="A1.T5.34.34.34.2.m1.1.1" xref="A1.T5.34.34.34.2.m1.1.1.cmml"><mn id="A1.T5.34.34.34.2.m1.1.1.2" xref="A1.T5.34.34.34.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.34.34.34.2.m1.1.1.3" xref="A1.T5.34.34.34.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.34.34.34.2.m1.1b"><apply id="A1.T5.34.34.34.2.m1.1.1.cmml" xref="A1.T5.34.34.34.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.34.34.34.2.m1.1.1.1.cmml" xref="A1.T5.34.34.34.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.34.34.34.2.m1.1.1.2.cmml" xref="A1.T5.34.34.34.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.34.34.34.2.m1.1.1.3.cmml" xref="A1.T5.34.34.34.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.34.34.34.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.34.34.34.3" class="ltx_td ltx_align_center ltx_border_r">0.12</td>
<td id="A1.T5.34.34.34.4" class="ltx_td ltx_align_center">71.4%</td>
</tr>
<tr id="A1.T5.36.36.36" class="ltx_tr">
<td id="A1.T5.35.35.35.1" class="ltx_td ltx_align_center"><math id="A1.T5.35.35.35.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.35.35.35.1.m1.1a"><mrow id="A1.T5.35.35.35.1.m1.1.1" xref="A1.T5.35.35.35.1.m1.1.1.cmml"><mo id="A1.T5.35.35.35.1.m1.1.1a" xref="A1.T5.35.35.35.1.m1.1.1.cmml">−</mo><msup id="A1.T5.35.35.35.1.m1.1.1.2" xref="A1.T5.35.35.35.1.m1.1.1.2.cmml"><mn id="A1.T5.35.35.35.1.m1.1.1.2.2" xref="A1.T5.35.35.35.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.35.35.35.1.m1.1.1.2.3" xref="A1.T5.35.35.35.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.35.35.35.1.m1.1b"><apply id="A1.T5.35.35.35.1.m1.1.1.cmml" xref="A1.T5.35.35.35.1.m1.1.1"><minus id="A1.T5.35.35.35.1.m1.1.1.1.cmml" xref="A1.T5.35.35.35.1.m1.1.1"></minus><apply id="A1.T5.35.35.35.1.m1.1.1.2.cmml" xref="A1.T5.35.35.35.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.35.35.35.1.m1.1.1.2.1.cmml" xref="A1.T5.35.35.35.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.35.35.35.1.m1.1.1.2.2.cmml" xref="A1.T5.35.35.35.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.35.35.35.1.m1.1.1.2.3.cmml" xref="A1.T5.35.35.35.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.35.35.35.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.36.36.36.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.36.36.36.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.36.36.36.2.m1.1a"><msup id="A1.T5.36.36.36.2.m1.1.1" xref="A1.T5.36.36.36.2.m1.1.1.cmml"><mn id="A1.T5.36.36.36.2.m1.1.1.2" xref="A1.T5.36.36.36.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.36.36.36.2.m1.1.1.3" xref="A1.T5.36.36.36.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.36.36.36.2.m1.1b"><apply id="A1.T5.36.36.36.2.m1.1.1.cmml" xref="A1.T5.36.36.36.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.36.36.36.2.m1.1.1.1.cmml" xref="A1.T5.36.36.36.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.36.36.36.2.m1.1.1.2.cmml" xref="A1.T5.36.36.36.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.36.36.36.2.m1.1.1.3.cmml" xref="A1.T5.36.36.36.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.36.36.36.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.36.36.36.3" class="ltx_td ltx_align_center ltx_border_r">0.12</td>
<td id="A1.T5.36.36.36.4" class="ltx_td ltx_align_center">71.5%</td>
</tr>
<tr id="A1.T5.38.38.38" class="ltx_tr">
<td id="A1.T5.37.37.37.1" class="ltx_td ltx_align_center"><math id="A1.T5.37.37.37.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.37.37.37.1.m1.1a"><mrow id="A1.T5.37.37.37.1.m1.1.1" xref="A1.T5.37.37.37.1.m1.1.1.cmml"><mo id="A1.T5.37.37.37.1.m1.1.1a" xref="A1.T5.37.37.37.1.m1.1.1.cmml">−</mo><msup id="A1.T5.37.37.37.1.m1.1.1.2" xref="A1.T5.37.37.37.1.m1.1.1.2.cmml"><mn id="A1.T5.37.37.37.1.m1.1.1.2.2" xref="A1.T5.37.37.37.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.37.37.37.1.m1.1.1.2.3" xref="A1.T5.37.37.37.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.37.37.37.1.m1.1b"><apply id="A1.T5.37.37.37.1.m1.1.1.cmml" xref="A1.T5.37.37.37.1.m1.1.1"><minus id="A1.T5.37.37.37.1.m1.1.1.1.cmml" xref="A1.T5.37.37.37.1.m1.1.1"></minus><apply id="A1.T5.37.37.37.1.m1.1.1.2.cmml" xref="A1.T5.37.37.37.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.37.37.37.1.m1.1.1.2.1.cmml" xref="A1.T5.37.37.37.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.37.37.37.1.m1.1.1.2.2.cmml" xref="A1.T5.37.37.37.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.37.37.37.1.m1.1.1.2.3.cmml" xref="A1.T5.37.37.37.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.37.37.37.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.38.38.38.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.38.38.38.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.38.38.38.2.m1.1a"><msup id="A1.T5.38.38.38.2.m1.1.1" xref="A1.T5.38.38.38.2.m1.1.1.cmml"><mn id="A1.T5.38.38.38.2.m1.1.1.2" xref="A1.T5.38.38.38.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.38.38.38.2.m1.1.1.3" xref="A1.T5.38.38.38.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.38.38.38.2.m1.1b"><apply id="A1.T5.38.38.38.2.m1.1.1.cmml" xref="A1.T5.38.38.38.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.38.38.38.2.m1.1.1.1.cmml" xref="A1.T5.38.38.38.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.38.38.38.2.m1.1.1.2.cmml" xref="A1.T5.38.38.38.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.38.38.38.2.m1.1.1.3.cmml" xref="A1.T5.38.38.38.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.38.38.38.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.38.38.38.3" class="ltx_td ltx_align_center ltx_border_r">0.11</td>
<td id="A1.T5.38.38.38.4" class="ltx_td ltx_align_center">71.7%</td>
</tr>
<tr id="A1.T5.54.54.59" class="ltx_tr">
<td id="A1.T5.54.54.59.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.59.1.1" class="ltx_text"><span id="A1.T5.54.54.59.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.59.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.59.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.59.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.59.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Llama2 7B/</span></span>
<span id="A1.T5.54.54.59.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.59.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Sheared 1.3B</span></span>
</span></span> <span id="A1.T5.54.54.59.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.59.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.59.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.19</td>
<td id="A1.T5.54.54.59.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.40.40.40" class="ltx_tr">
<td id="A1.T5.39.39.39.1" class="ltx_td ltx_align_center"><math id="A1.T5.39.39.39.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.39.39.39.1.m1.1a"><mrow id="A1.T5.39.39.39.1.m1.1.1" xref="A1.T5.39.39.39.1.m1.1.1.cmml"><mo id="A1.T5.39.39.39.1.m1.1.1a" xref="A1.T5.39.39.39.1.m1.1.1.cmml">−</mo><msup id="A1.T5.39.39.39.1.m1.1.1.2" xref="A1.T5.39.39.39.1.m1.1.1.2.cmml"><mn id="A1.T5.39.39.39.1.m1.1.1.2.2" xref="A1.T5.39.39.39.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.39.39.39.1.m1.1.1.2.3" xref="A1.T5.39.39.39.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.39.39.39.1.m1.1b"><apply id="A1.T5.39.39.39.1.m1.1.1.cmml" xref="A1.T5.39.39.39.1.m1.1.1"><minus id="A1.T5.39.39.39.1.m1.1.1.1.cmml" xref="A1.T5.39.39.39.1.m1.1.1"></minus><apply id="A1.T5.39.39.39.1.m1.1.1.2.cmml" xref="A1.T5.39.39.39.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.39.39.39.1.m1.1.1.2.1.cmml" xref="A1.T5.39.39.39.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.39.39.39.1.m1.1.1.2.2.cmml" xref="A1.T5.39.39.39.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.39.39.39.1.m1.1.1.2.3.cmml" xref="A1.T5.39.39.39.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.39.39.39.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.40.40.40.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.40.40.40.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.40.40.40.2.m1.1a"><msup id="A1.T5.40.40.40.2.m1.1.1" xref="A1.T5.40.40.40.2.m1.1.1.cmml"><mn id="A1.T5.40.40.40.2.m1.1.1.2" xref="A1.T5.40.40.40.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.40.40.40.2.m1.1.1.3" xref="A1.T5.40.40.40.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.40.40.40.2.m1.1b"><apply id="A1.T5.40.40.40.2.m1.1.1.cmml" xref="A1.T5.40.40.40.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.40.40.40.2.m1.1.1.1.cmml" xref="A1.T5.40.40.40.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.40.40.40.2.m1.1.1.2.cmml" xref="A1.T5.40.40.40.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.40.40.40.2.m1.1.1.3.cmml" xref="A1.T5.40.40.40.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.40.40.40.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.40.40.40.3" class="ltx_td ltx_align_center ltx_border_r">0.16</td>
<td id="A1.T5.40.40.40.4" class="ltx_td ltx_align_center">49.8%</td>
</tr>
<tr id="A1.T5.42.42.42" class="ltx_tr">
<td id="A1.T5.41.41.41.1" class="ltx_td ltx_align_center"><math id="A1.T5.41.41.41.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.41.41.41.1.m1.1a"><mrow id="A1.T5.41.41.41.1.m1.1.1" xref="A1.T5.41.41.41.1.m1.1.1.cmml"><mo id="A1.T5.41.41.41.1.m1.1.1a" xref="A1.T5.41.41.41.1.m1.1.1.cmml">−</mo><msup id="A1.T5.41.41.41.1.m1.1.1.2" xref="A1.T5.41.41.41.1.m1.1.1.2.cmml"><mn id="A1.T5.41.41.41.1.m1.1.1.2.2" xref="A1.T5.41.41.41.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.41.41.41.1.m1.1.1.2.3" xref="A1.T5.41.41.41.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.41.41.41.1.m1.1b"><apply id="A1.T5.41.41.41.1.m1.1.1.cmml" xref="A1.T5.41.41.41.1.m1.1.1"><minus id="A1.T5.41.41.41.1.m1.1.1.1.cmml" xref="A1.T5.41.41.41.1.m1.1.1"></minus><apply id="A1.T5.41.41.41.1.m1.1.1.2.cmml" xref="A1.T5.41.41.41.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.41.41.41.1.m1.1.1.2.1.cmml" xref="A1.T5.41.41.41.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.41.41.41.1.m1.1.1.2.2.cmml" xref="A1.T5.41.41.41.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.41.41.41.1.m1.1.1.2.3.cmml" xref="A1.T5.41.41.41.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.41.41.41.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.42.42.42.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.42.42.42.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.42.42.42.2.m1.1a"><msup id="A1.T5.42.42.42.2.m1.1.1" xref="A1.T5.42.42.42.2.m1.1.1.cmml"><mn id="A1.T5.42.42.42.2.m1.1.1.2" xref="A1.T5.42.42.42.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.42.42.42.2.m1.1.1.3" xref="A1.T5.42.42.42.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.42.42.42.2.m1.1b"><apply id="A1.T5.42.42.42.2.m1.1.1.cmml" xref="A1.T5.42.42.42.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.42.42.42.2.m1.1.1.1.cmml" xref="A1.T5.42.42.42.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.42.42.42.2.m1.1.1.2.cmml" xref="A1.T5.42.42.42.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.42.42.42.2.m1.1.1.3.cmml" xref="A1.T5.42.42.42.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.42.42.42.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.42.42.42.3" class="ltx_td ltx_align_center ltx_border_r">0.16</td>
<td id="A1.T5.42.42.42.4" class="ltx_td ltx_align_center">53.4%</td>
</tr>
<tr id="A1.T5.44.44.44" class="ltx_tr">
<td id="A1.T5.43.43.43.1" class="ltx_td ltx_align_center"><math id="A1.T5.43.43.43.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.43.43.43.1.m1.1a"><mrow id="A1.T5.43.43.43.1.m1.1.1" xref="A1.T5.43.43.43.1.m1.1.1.cmml"><mo id="A1.T5.43.43.43.1.m1.1.1a" xref="A1.T5.43.43.43.1.m1.1.1.cmml">−</mo><msup id="A1.T5.43.43.43.1.m1.1.1.2" xref="A1.T5.43.43.43.1.m1.1.1.2.cmml"><mn id="A1.T5.43.43.43.1.m1.1.1.2.2" xref="A1.T5.43.43.43.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.43.43.43.1.m1.1.1.2.3" xref="A1.T5.43.43.43.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.43.43.43.1.m1.1b"><apply id="A1.T5.43.43.43.1.m1.1.1.cmml" xref="A1.T5.43.43.43.1.m1.1.1"><minus id="A1.T5.43.43.43.1.m1.1.1.1.cmml" xref="A1.T5.43.43.43.1.m1.1.1"></minus><apply id="A1.T5.43.43.43.1.m1.1.1.2.cmml" xref="A1.T5.43.43.43.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.43.43.43.1.m1.1.1.2.1.cmml" xref="A1.T5.43.43.43.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.43.43.43.1.m1.1.1.2.2.cmml" xref="A1.T5.43.43.43.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.43.43.43.1.m1.1.1.2.3.cmml" xref="A1.T5.43.43.43.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.43.43.43.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.44.44.44.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.44.44.44.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.44.44.44.2.m1.1a"><msup id="A1.T5.44.44.44.2.m1.1.1" xref="A1.T5.44.44.44.2.m1.1.1.cmml"><mn id="A1.T5.44.44.44.2.m1.1.1.2" xref="A1.T5.44.44.44.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.44.44.44.2.m1.1.1.3" xref="A1.T5.44.44.44.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.44.44.44.2.m1.1b"><apply id="A1.T5.44.44.44.2.m1.1.1.cmml" xref="A1.T5.44.44.44.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.44.44.44.2.m1.1.1.1.cmml" xref="A1.T5.44.44.44.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.44.44.44.2.m1.1.1.2.cmml" xref="A1.T5.44.44.44.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.44.44.44.2.m1.1.1.3.cmml" xref="A1.T5.44.44.44.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.44.44.44.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.44.44.44.3" class="ltx_td ltx_align_center ltx_border_r">0.15</td>
<td id="A1.T5.44.44.44.4" class="ltx_td ltx_align_center">50.0%</td>
</tr>
<tr id="A1.T5.46.46.46" class="ltx_tr">
<td id="A1.T5.45.45.45.1" class="ltx_td ltx_align_center"><math id="A1.T5.45.45.45.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.45.45.45.1.m1.1a"><mrow id="A1.T5.45.45.45.1.m1.1.1" xref="A1.T5.45.45.45.1.m1.1.1.cmml"><mo id="A1.T5.45.45.45.1.m1.1.1a" xref="A1.T5.45.45.45.1.m1.1.1.cmml">−</mo><msup id="A1.T5.45.45.45.1.m1.1.1.2" xref="A1.T5.45.45.45.1.m1.1.1.2.cmml"><mn id="A1.T5.45.45.45.1.m1.1.1.2.2" xref="A1.T5.45.45.45.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.45.45.45.1.m1.1.1.2.3" xref="A1.T5.45.45.45.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.45.45.45.1.m1.1b"><apply id="A1.T5.45.45.45.1.m1.1.1.cmml" xref="A1.T5.45.45.45.1.m1.1.1"><minus id="A1.T5.45.45.45.1.m1.1.1.1.cmml" xref="A1.T5.45.45.45.1.m1.1.1"></minus><apply id="A1.T5.45.45.45.1.m1.1.1.2.cmml" xref="A1.T5.45.45.45.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.45.45.45.1.m1.1.1.2.1.cmml" xref="A1.T5.45.45.45.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.45.45.45.1.m1.1.1.2.2.cmml" xref="A1.T5.45.45.45.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.45.45.45.1.m1.1.1.2.3.cmml" xref="A1.T5.45.45.45.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.45.45.45.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.46.46.46.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.46.46.46.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.46.46.46.2.m1.1a"><msup id="A1.T5.46.46.46.2.m1.1.1" xref="A1.T5.46.46.46.2.m1.1.1.cmml"><mn id="A1.T5.46.46.46.2.m1.1.1.2" xref="A1.T5.46.46.46.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.46.46.46.2.m1.1.1.3" xref="A1.T5.46.46.46.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.46.46.46.2.m1.1b"><apply id="A1.T5.46.46.46.2.m1.1.1.cmml" xref="A1.T5.46.46.46.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.46.46.46.2.m1.1.1.1.cmml" xref="A1.T5.46.46.46.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.46.46.46.2.m1.1.1.2.cmml" xref="A1.T5.46.46.46.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.46.46.46.2.m1.1.1.3.cmml" xref="A1.T5.46.46.46.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.46.46.46.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.46.46.46.3" class="ltx_td ltx_align_center ltx_border_r">0.16</td>
<td id="A1.T5.46.46.46.4" class="ltx_td ltx_align_center">51.9%</td>
</tr>
<tr id="A1.T5.54.54.60" class="ltx_tr">
<td id="A1.T5.54.54.60.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" rowspan="5"><span id="A1.T5.54.54.60.1.1" class="ltx_text"><span id="A1.T5.54.54.60.1.1.1" class="ltx_text"></span> <span id="A1.T5.54.54.60.1.1.2" class="ltx_text">
<span id="A1.T5.54.54.60.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.54.54.60.1.1.2.1.1" class="ltx_tr">
<span id="A1.T5.54.54.60.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Llama2 13B/</span></span>
<span id="A1.T5.54.54.60.1.1.2.1.2" class="ltx_tr">
<span id="A1.T5.54.54.60.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Sheared 1.3B</span></span>
</span></span> <span id="A1.T5.54.54.60.1.1.3" class="ltx_text"></span></span></td>
<td id="A1.T5.54.54.60.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Baseline</td>
<td id="A1.T5.54.54.60.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.20</td>
<td id="A1.T5.54.54.60.4" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="A1.T5.48.48.48" class="ltx_tr">
<td id="A1.T5.47.47.47.1" class="ltx_td ltx_align_center"><math id="A1.T5.47.47.47.1.m1.1" class="ltx_Math" alttext="-10^{1}" display="inline"><semantics id="A1.T5.47.47.47.1.m1.1a"><mrow id="A1.T5.47.47.47.1.m1.1.1" xref="A1.T5.47.47.47.1.m1.1.1.cmml"><mo id="A1.T5.47.47.47.1.m1.1.1a" xref="A1.T5.47.47.47.1.m1.1.1.cmml">−</mo><msup id="A1.T5.47.47.47.1.m1.1.1.2" xref="A1.T5.47.47.47.1.m1.1.1.2.cmml"><mn id="A1.T5.47.47.47.1.m1.1.1.2.2" xref="A1.T5.47.47.47.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.47.47.47.1.m1.1.1.2.3" xref="A1.T5.47.47.47.1.m1.1.1.2.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.47.47.47.1.m1.1b"><apply id="A1.T5.47.47.47.1.m1.1.1.cmml" xref="A1.T5.47.47.47.1.m1.1.1"><minus id="A1.T5.47.47.47.1.m1.1.1.1.cmml" xref="A1.T5.47.47.47.1.m1.1.1"></minus><apply id="A1.T5.47.47.47.1.m1.1.1.2.cmml" xref="A1.T5.47.47.47.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.47.47.47.1.m1.1.1.2.1.cmml" xref="A1.T5.47.47.47.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.47.47.47.1.m1.1.1.2.2.cmml" xref="A1.T5.47.47.47.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.47.47.47.1.m1.1.1.2.3.cmml" xref="A1.T5.47.47.47.1.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.47.47.47.1.m1.1c">-10^{1}</annotation></semantics></math></td>
<td id="A1.T5.48.48.48.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.48.48.48.2.m1.1" class="ltx_Math" alttext="10^{1}" display="inline"><semantics id="A1.T5.48.48.48.2.m1.1a"><msup id="A1.T5.48.48.48.2.m1.1.1" xref="A1.T5.48.48.48.2.m1.1.1.cmml"><mn id="A1.T5.48.48.48.2.m1.1.1.2" xref="A1.T5.48.48.48.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.48.48.48.2.m1.1.1.3" xref="A1.T5.48.48.48.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.48.48.48.2.m1.1b"><apply id="A1.T5.48.48.48.2.m1.1.1.cmml" xref="A1.T5.48.48.48.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.48.48.48.2.m1.1.1.1.cmml" xref="A1.T5.48.48.48.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.48.48.48.2.m1.1.1.2.cmml" xref="A1.T5.48.48.48.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.48.48.48.2.m1.1.1.3.cmml" xref="A1.T5.48.48.48.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.48.48.48.2.m1.1c">10^{1}</annotation></semantics></math></td>
<td id="A1.T5.48.48.48.3" class="ltx_td ltx_align_center ltx_border_r">0.15</td>
<td id="A1.T5.48.48.48.4" class="ltx_td ltx_align_center">46.9%</td>
</tr>
<tr id="A1.T5.50.50.50" class="ltx_tr">
<td id="A1.T5.49.49.49.1" class="ltx_td ltx_align_center"><math id="A1.T5.49.49.49.1.m1.1" class="ltx_Math" alttext="-10^{3}" display="inline"><semantics id="A1.T5.49.49.49.1.m1.1a"><mrow id="A1.T5.49.49.49.1.m1.1.1" xref="A1.T5.49.49.49.1.m1.1.1.cmml"><mo id="A1.T5.49.49.49.1.m1.1.1a" xref="A1.T5.49.49.49.1.m1.1.1.cmml">−</mo><msup id="A1.T5.49.49.49.1.m1.1.1.2" xref="A1.T5.49.49.49.1.m1.1.1.2.cmml"><mn id="A1.T5.49.49.49.1.m1.1.1.2.2" xref="A1.T5.49.49.49.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.49.49.49.1.m1.1.1.2.3" xref="A1.T5.49.49.49.1.m1.1.1.2.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.49.49.49.1.m1.1b"><apply id="A1.T5.49.49.49.1.m1.1.1.cmml" xref="A1.T5.49.49.49.1.m1.1.1"><minus id="A1.T5.49.49.49.1.m1.1.1.1.cmml" xref="A1.T5.49.49.49.1.m1.1.1"></minus><apply id="A1.T5.49.49.49.1.m1.1.1.2.cmml" xref="A1.T5.49.49.49.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.49.49.49.1.m1.1.1.2.1.cmml" xref="A1.T5.49.49.49.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.49.49.49.1.m1.1.1.2.2.cmml" xref="A1.T5.49.49.49.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.49.49.49.1.m1.1.1.2.3.cmml" xref="A1.T5.49.49.49.1.m1.1.1.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.49.49.49.1.m1.1c">-10^{3}</annotation></semantics></math></td>
<td id="A1.T5.50.50.50.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.50.50.50.2.m1.1" class="ltx_Math" alttext="10^{3}" display="inline"><semantics id="A1.T5.50.50.50.2.m1.1a"><msup id="A1.T5.50.50.50.2.m1.1.1" xref="A1.T5.50.50.50.2.m1.1.1.cmml"><mn id="A1.T5.50.50.50.2.m1.1.1.2" xref="A1.T5.50.50.50.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.50.50.50.2.m1.1.1.3" xref="A1.T5.50.50.50.2.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.50.50.50.2.m1.1b"><apply id="A1.T5.50.50.50.2.m1.1.1.cmml" xref="A1.T5.50.50.50.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.50.50.50.2.m1.1.1.1.cmml" xref="A1.T5.50.50.50.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.50.50.50.2.m1.1.1.2.cmml" xref="A1.T5.50.50.50.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.50.50.50.2.m1.1.1.3.cmml" xref="A1.T5.50.50.50.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.50.50.50.2.m1.1c">10^{3}</annotation></semantics></math></td>
<td id="A1.T5.50.50.50.3" class="ltx_td ltx_align_center ltx_border_r">0.17</td>
<td id="A1.T5.50.50.50.4" class="ltx_td ltx_align_center">46.8%</td>
</tr>
<tr id="A1.T5.52.52.52" class="ltx_tr">
<td id="A1.T5.51.51.51.1" class="ltx_td ltx_align_center"><math id="A1.T5.51.51.51.1.m1.1" class="ltx_Math" alttext="-10^{4}" display="inline"><semantics id="A1.T5.51.51.51.1.m1.1a"><mrow id="A1.T5.51.51.51.1.m1.1.1" xref="A1.T5.51.51.51.1.m1.1.1.cmml"><mo id="A1.T5.51.51.51.1.m1.1.1a" xref="A1.T5.51.51.51.1.m1.1.1.cmml">−</mo><msup id="A1.T5.51.51.51.1.m1.1.1.2" xref="A1.T5.51.51.51.1.m1.1.1.2.cmml"><mn id="A1.T5.51.51.51.1.m1.1.1.2.2" xref="A1.T5.51.51.51.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.51.51.51.1.m1.1.1.2.3" xref="A1.T5.51.51.51.1.m1.1.1.2.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.51.51.51.1.m1.1b"><apply id="A1.T5.51.51.51.1.m1.1.1.cmml" xref="A1.T5.51.51.51.1.m1.1.1"><minus id="A1.T5.51.51.51.1.m1.1.1.1.cmml" xref="A1.T5.51.51.51.1.m1.1.1"></minus><apply id="A1.T5.51.51.51.1.m1.1.1.2.cmml" xref="A1.T5.51.51.51.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.51.51.51.1.m1.1.1.2.1.cmml" xref="A1.T5.51.51.51.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.51.51.51.1.m1.1.1.2.2.cmml" xref="A1.T5.51.51.51.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.51.51.51.1.m1.1.1.2.3.cmml" xref="A1.T5.51.51.51.1.m1.1.1.2.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.51.51.51.1.m1.1c">-10^{4}</annotation></semantics></math></td>
<td id="A1.T5.52.52.52.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T5.52.52.52.2.m1.1" class="ltx_Math" alttext="10^{4}" display="inline"><semantics id="A1.T5.52.52.52.2.m1.1a"><msup id="A1.T5.52.52.52.2.m1.1.1" xref="A1.T5.52.52.52.2.m1.1.1.cmml"><mn id="A1.T5.52.52.52.2.m1.1.1.2" xref="A1.T5.52.52.52.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.52.52.52.2.m1.1.1.3" xref="A1.T5.52.52.52.2.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.52.52.52.2.m1.1b"><apply id="A1.T5.52.52.52.2.m1.1.1.cmml" xref="A1.T5.52.52.52.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.52.52.52.2.m1.1.1.1.cmml" xref="A1.T5.52.52.52.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.52.52.52.2.m1.1.1.2.cmml" xref="A1.T5.52.52.52.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.52.52.52.2.m1.1.1.3.cmml" xref="A1.T5.52.52.52.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.52.52.52.2.m1.1c">10^{4}</annotation></semantics></math></td>
<td id="A1.T5.52.52.52.3" class="ltx_td ltx_align_center ltx_border_r">0.15</td>
<td id="A1.T5.52.52.52.4" class="ltx_td ltx_align_center">46.7%</td>
</tr>
<tr id="A1.T5.54.54.54" class="ltx_tr">
<td id="A1.T5.53.53.53.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="A1.T5.53.53.53.1.m1.1" class="ltx_Math" alttext="-10^{5}" display="inline"><semantics id="A1.T5.53.53.53.1.m1.1a"><mrow id="A1.T5.53.53.53.1.m1.1.1" xref="A1.T5.53.53.53.1.m1.1.1.cmml"><mo id="A1.T5.53.53.53.1.m1.1.1a" xref="A1.T5.53.53.53.1.m1.1.1.cmml">−</mo><msup id="A1.T5.53.53.53.1.m1.1.1.2" xref="A1.T5.53.53.53.1.m1.1.1.2.cmml"><mn id="A1.T5.53.53.53.1.m1.1.1.2.2" xref="A1.T5.53.53.53.1.m1.1.1.2.2.cmml">10</mn><mn id="A1.T5.53.53.53.1.m1.1.1.2.3" xref="A1.T5.53.53.53.1.m1.1.1.2.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.53.53.53.1.m1.1b"><apply id="A1.T5.53.53.53.1.m1.1.1.cmml" xref="A1.T5.53.53.53.1.m1.1.1"><minus id="A1.T5.53.53.53.1.m1.1.1.1.cmml" xref="A1.T5.53.53.53.1.m1.1.1"></minus><apply id="A1.T5.53.53.53.1.m1.1.1.2.cmml" xref="A1.T5.53.53.53.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.T5.53.53.53.1.m1.1.1.2.1.cmml" xref="A1.T5.53.53.53.1.m1.1.1.2">superscript</csymbol><cn type="integer" id="A1.T5.53.53.53.1.m1.1.1.2.2.cmml" xref="A1.T5.53.53.53.1.m1.1.1.2.2">10</cn><cn type="integer" id="A1.T5.53.53.53.1.m1.1.1.2.3.cmml" xref="A1.T5.53.53.53.1.m1.1.1.2.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.53.53.53.1.m1.1c">-10^{5}</annotation></semantics></math></td>
<td id="A1.T5.54.54.54.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="A1.T5.54.54.54.2.m1.1" class="ltx_Math" alttext="10^{5}" display="inline"><semantics id="A1.T5.54.54.54.2.m1.1a"><msup id="A1.T5.54.54.54.2.m1.1.1" xref="A1.T5.54.54.54.2.m1.1.1.cmml"><mn id="A1.T5.54.54.54.2.m1.1.1.2" xref="A1.T5.54.54.54.2.m1.1.1.2.cmml">10</mn><mn id="A1.T5.54.54.54.2.m1.1.1.3" xref="A1.T5.54.54.54.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="A1.T5.54.54.54.2.m1.1b"><apply id="A1.T5.54.54.54.2.m1.1.1.cmml" xref="A1.T5.54.54.54.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.54.54.54.2.m1.1.1.1.cmml" xref="A1.T5.54.54.54.2.m1.1.1">superscript</csymbol><cn type="integer" id="A1.T5.54.54.54.2.m1.1.1.2.cmml" xref="A1.T5.54.54.54.2.m1.1.1.2">10</cn><cn type="integer" id="A1.T5.54.54.54.2.m1.1.1.3.cmml" xref="A1.T5.54.54.54.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.54.54.54.2.m1.1c">10^{5}</annotation></semantics></math></td>
<td id="A1.T5.54.54.54.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">0.16</td>
<td id="A1.T5.54.54.54.4" class="ltx_td ltx_align_center ltx_border_bb">45.9%</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Impact of varying scaling factors <math id="A1.T5.57.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.T5.57.m1.1b"><mi id="A1.T5.57.m1.1.1" xref="A1.T5.57.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T5.57.m1.1c"><ci id="A1.T5.57.m1.1.1.cmml" xref="A1.T5.57.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.57.m1.1d">\alpha</annotation></semantics></math> and <math id="A1.T5.58.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.T5.58.m2.1b"><mi id="A1.T5.58.m2.1.1" xref="A1.T5.58.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T5.58.m2.1c"><ci id="A1.T5.58.m2.1.1.cmml" xref="A1.T5.58.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.58.m2.1d">\beta</annotation></semantics></math> on performance and profiling time of sigmoid approximation on <span id="A1.T5.61.1" class="ltx_text ltx_font_bold">CV16</span> and <span id="A1.T5.62.2" class="ltx_text ltx_font_bold">Xsum</span>.
The values are computed on a random sample of 10% of each dataset.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.11015" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.11016" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.11016">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.11016" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.11017" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 23:41:09 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
