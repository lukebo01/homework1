<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.12821] FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer</title><meta property="og:description" content="The success of a specific neural network architecture is closely tied to the dataset and task it tackles; there is no one-size-fits-all solution.
Thus, considerable efforts have been made to quickly and accurately esti…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.12821">

<!--Generated on Fri Apr  5 14:10:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FlowerFormer: Empowering Neural Architecture Encoding 
<br class="ltx_break">using a Flow-aware Graph Transformer</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dongyeong Hwang  Hyunju Kim  Sunwoo Kim  Kijung Shin
<br class="ltx_break">Kim Jaechul Graduate School of AI, KAIST, Seoul, Republic of Korea
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{dy.hwang, hyunju.kim, kswoo97, kijungs}@kaist.ac.kr</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">The success of a specific neural network architecture is closely tied to the dataset and task it tackles; there is no one-size-fits-all solution.
Thus, considerable efforts have been made to quickly and accurately estimate the performances of neural architectures, without full training or evaluation, for given tasks and datasets.
Neural architecture encoding has played a crucial role in the estimation, and graph-based methods, which treat an architecture as a graph, have shown prominent performance.
For enhanced representation learning of neural architectures, we introduce <span id="id2.id1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, a powerful graph transformer that incorporates the information flows within a neural architecture.
<span id="id2.id1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> consists of two key components: (a) bidirectional asynchronous message passing, inspired by the flows; (b) global attention built on flow-based masking.
Our extensive experiments demonstrate the superiority of <span id="id2.id1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> over existing neural encoding methods, and its effectiveness extends beyond computer vision models to include graph neural networks and auto speech recognition models.
Our code is available at <a target="_blank" href="http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">While deep learning models have demonstrated their efficacy across various applications,
the performance of a specific neural architecture heavily depends on specific downstream tasks and datasets employed.
As a result, numerous neural architectures have been developed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">14</span></a>, <a href="#bib.bib15" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In response to this dependency, significant efforts have been made to rapidly and accurately predict the performances of neural architectures for given tasks and datasets.
This endeavor is crucial because exhaustively training and/or evaluating many candidate neural architectures is an expensive process.
To this end, researchers have primarily employed machine learning techniques <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib24" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">24</span></a>, <a href="#bib.bib6" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Especially, various neural architecture encoding methods have been proposed since obtaining an accurate representation of each architecture plays a crucial role in the estimation process.
Their focus has mainly revolved around (a) transforming input neural architectures to appropriate data structures <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib25" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">25</span></a>, <a href="#bib.bib47" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">47</span></a>]</cite> and (b) applying representation-learning models to the transformed structures <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib5" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">5</span></a>, <a href="#bib.bib48" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">48</span></a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Some have treated neural architectures as graphs and applied graph representation learning. They, however, share some limitations. For instance, their basic message-passing mechanisms oversimplify neural-architecture characteristics <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib41" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">41</span></a>, <a href="#bib.bib46" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">46</span></a>]</cite> and may suffer from over-smoothing <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib34" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>, over-squashing <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib2" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">2</span></a>]</cite>, or limited expressiveness <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Graph Transformers (GTs), when incorporated with adequate information, are recognized for enhancing basic message passing, making them effective in various graph classification <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib52" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">52</span></a>, <a href="#bib.bib16" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> and regression <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib7" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">7</span></a>, <a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> tasks.
One strength of GTs lies in their global attention mechanisms <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib44" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite>, where all nodes in an input graph contribute directly to forming the representation for each individual node.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">However, without integrating relevant topological or external information of input graphs, the relevance of attention scores, and thus the effectiveness of GTs, might be impaired.
For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Niu et al.</span> [<a href="#bib.bib33" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite> showed the essentiality of using motif-based spatial embedding to incorporate the characteristics of molecule graphs into GTs.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In this work, we propose <span id="S1.p7.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> (<span id="S1.p7.1.2" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Flow</span>-awar<span id="S1.p7.1.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">e</span> g<span id="S1.p7.1.4" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">r</span>aph trans<span id="S1.p7.1.5" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">former</span>), a GT model specialized in capturing <span id="S1.p7.1.6" class="ltx_text ltx_font_italic">information flows</span> within neural architectures, as illustrated in <a href="#S1.F1" title="In 1 Introduction ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
The information flows of a neural architecture contain the characteristics of both forward and backward propagations of the architecture, and thus describe its fundamental properties.
<span id="S1.p7.1.7" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> includes two core modules: the <span id="S1.p7.1.8" class="ltx_text ltx_font_italic">flow encode</span> module and the <span id="S1.p7.1.9" class="ltx_text ltx_font_italic">flow-aware global attention</span> module.
The former conducts bidirectional asynchronous message passing, imitating the forward and backward propagations within the input neural architecture.
The latter applies global attention with masking schemes based on the flow-based dependencies between nodes.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Our extensive experiments on neural architecture performance prediction, conducted using five benchmark datasets,
validate the superiority of <span id="S1.p8.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> over state-of-the-art neural encoding models <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>, <a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>.
The results highlight the effectiveness of incorporating flows into GTs. Our contributions are summarized as follows:</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.12821/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="113" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.6.3.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Information flows within an example neural architecture from the NAS-Bench-101 benchmark <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib51" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite>.
The architecture is represented as a directed graph where each node corresponds to an operation, and
the topological structure of the graph encodes the sequence in which these operations are performed.
For instance, the ‘<math id="S1.F1.3.1.m1.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S1.F1.3.1.m1.1b"><mrow id="S1.F1.3.1.m1.1.1" xref="S1.F1.3.1.m1.1.1.cmml"><mn id="S1.F1.3.1.m1.1.1.2" xref="S1.F1.3.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S1.F1.3.1.m1.1.1.1" xref="S1.F1.3.1.m1.1.1.1.cmml">×</mo><mn id="S1.F1.3.1.m1.1.1.3" xref="S1.F1.3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.3.1.m1.1c"><apply id="S1.F1.3.1.m1.1.1.cmml" xref="S1.F1.3.1.m1.1.1"><times id="S1.F1.3.1.m1.1.1.1.cmml" xref="S1.F1.3.1.m1.1.1.1"></times><cn type="integer" id="S1.F1.3.1.m1.1.1.2.cmml" xref="S1.F1.3.1.m1.1.1.2">1</cn><cn type="integer" id="S1.F1.3.1.m1.1.1.3.cmml" xref="S1.F1.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.1.m1.1d">1\times 1</annotation></semantics></math>’ (convolution) operation is executed only after the ‘<math id="S1.F1.4.2.m2.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S1.F1.4.2.m2.1b"><mrow id="S1.F1.4.2.m2.1.1" xref="S1.F1.4.2.m2.1.1.cmml"><mn id="S1.F1.4.2.m2.1.1.2" xref="S1.F1.4.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S1.F1.4.2.m2.1.1.1" xref="S1.F1.4.2.m2.1.1.1.cmml">×</mo><mn id="S1.F1.4.2.m2.1.1.3" xref="S1.F1.4.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.4.2.m2.1c"><apply id="S1.F1.4.2.m2.1.1.cmml" xref="S1.F1.4.2.m2.1.1"><times id="S1.F1.4.2.m2.1.1.1.cmml" xref="S1.F1.4.2.m2.1.1.1"></times><cn type="integer" id="S1.F1.4.2.m2.1.1.2.cmml" xref="S1.F1.4.2.m2.1.1.2">3</cn><cn type="integer" id="S1.F1.4.2.m2.1.1.3.cmml" xref="S1.F1.4.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.2.m2.1d">3\times 3</annotation></semantics></math>’ (convolution) and ‘mp’ (max pooling) operations have been completed.
The forward pass, depicted by blue arrows, is followed by the backpropagation of the loss, depicted by orange arrows.
The number displayed above each node indicates the processing order within each flow.</span></figcaption>
</figure>
<div id="S1.p9" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, a flow-aware GT-based neural architecture encoding model.
To our best knowledge, <span id="S1.I1.i1.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> is the first GT model specifically designed to capture flows.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> outperforms six baseline architectures, including the most recent ones <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>, <a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>, by a substantial margin across three benchmark datasets in the computer vision domain.
Specifically, in predicting the performance of neural architectures, it outperforms the top-performing baseline method by a margin of up to 4.38% in Kendall’s Tau. Additionally, through ablation studies, we justify the design choices made in <span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Beyond computer vision neural architectures, <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> also excels at performance prediction for graph neural networks and auto speech recognition architectures. In the benchmarks for these architectures, <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> achieves performance gains of up to 4.41% in Kendall’s Tau over baseline models.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">Our code is available at <a target="_blank" href="http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer</a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we briefly review related studies in neural architecture encoding and graph transformers (GTs).</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Neural architecture encoding</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Neural architecture encoding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">24</span></a>, <a href="#bib.bib21" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">21</span></a>, <a href="#bib.bib45" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">45</span></a>, <a href="#bib.bib25" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">25</span></a>, <a href="#bib.bib47" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">47</span></a>]</cite>, which aims to learn representations of neural architectures, has gained considerable attention due to its significant downstream tasks, such as performance prediction (i.e., the prediction of task- and data-specific performance for given architectures without full training or evaluation).</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">One popular class of approaches is graph-based, modeling neural architectures as graphs and using graph neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> for representation learning. These approaches have also introduced topology-based graph similarity and operation-specific embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">8</span></a>, <a href="#bib.bib4" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Another significant approach aims to obtain representations that mimic the forward and/or backward passes within neural architectures.
For instance, GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite> updates operation embeddings by mimicking the application of operations to information (which is also represented as a vector) and thus effectively replicating the forward-pass of convolution operations.
Another method, TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, simulates an iterative process involving both forward and backward passes, with specialized handling for specific operations, e.g., skip-connections.
However, these methods focus on flows only at a local level, by simulating a series of local operations, and may overlook a global-level perspective.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">Transformer-based models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">49</span></a>, <a href="#bib.bib23" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite> are capable of capturing global-level perspectives through attention mechanisms. NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>, a multi-stage fusion transformer, is one of the state-of-the-art methods for predicting neural architecture performance.
They (1) represent a neural architecture as a sequence of operations to employ a transformer-based model and (2) leverage multiple valid sequences from the same architecture for augmentation.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">In this work, we unify all three dimensions—graph learning, flow modeling, and global attention—by introducing a novel flow-aware GT, marking the first instance of such integration to the best of our knowledge.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2403.12821/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="100" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.17.6.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.10.5" class="ltx_text" style="font-size:90%;">Overview of proposed <span id="S2.F2.10.5.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, which contains two key modules in each of its layers: the <span id="S2.F2.10.5.2" class="ltx_text ltx_font_italic">flow encode</span> module and the <span id="S2.F2.10.5.3" class="ltx_text ltx_font_italic">flow-aware global attention</span> module. The <span id="S2.F2.10.5.4" class="ltx_text ltx_font_italic">flow encode</span> module performs bidirectional asynchronous message passing, inspired by forward and backward passes, to produce a node embedding matrix <math id="S2.F2.6.1.m1.1" class="ltx_Math" alttext="H_{\text{flow}}" display="inline"><semantics id="S2.F2.6.1.m1.1b"><msub id="S2.F2.6.1.m1.1.1" xref="S2.F2.6.1.m1.1.1.cmml"><mi id="S2.F2.6.1.m1.1.1.2" xref="S2.F2.6.1.m1.1.1.2.cmml">H</mi><mtext id="S2.F2.6.1.m1.1.1.3" xref="S2.F2.6.1.m1.1.1.3a.cmml">flow</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.1.m1.1c"><apply id="S2.F2.6.1.m1.1.1.cmml" xref="S2.F2.6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.6.1.m1.1.1.1.cmml" xref="S2.F2.6.1.m1.1.1">subscript</csymbol><ci id="S2.F2.6.1.m1.1.1.2.cmml" xref="S2.F2.6.1.m1.1.1.2">𝐻</ci><ci id="S2.F2.6.1.m1.1.1.3a.cmml" xref="S2.F2.6.1.m1.1.1.3"><mtext mathsize="70%" id="S2.F2.6.1.m1.1.1.3.cmml" xref="S2.F2.6.1.m1.1.1.3">flow</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.1.m1.1d">H_{\text{flow}}</annotation></semantics></math>. The <span id="S2.F2.10.5.5" class="ltx_text ltx_font_italic">flow-aware global attention</span> module computes attention with a flow-based masking scheme to yield another node embedding matrix <math id="S2.F2.7.2.m2.1" class="ltx_Math" alttext="H_{\text{global}}" display="inline"><semantics id="S2.F2.7.2.m2.1b"><msub id="S2.F2.7.2.m2.1.1" xref="S2.F2.7.2.m2.1.1.cmml"><mi id="S2.F2.7.2.m2.1.1.2" xref="S2.F2.7.2.m2.1.1.2.cmml">H</mi><mtext id="S2.F2.7.2.m2.1.1.3" xref="S2.F2.7.2.m2.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.2.m2.1c"><apply id="S2.F2.7.2.m2.1.1.cmml" xref="S2.F2.7.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.7.2.m2.1.1.1.cmml" xref="S2.F2.7.2.m2.1.1">subscript</csymbol><ci id="S2.F2.7.2.m2.1.1.2.cmml" xref="S2.F2.7.2.m2.1.1.2">𝐻</ci><ci id="S2.F2.7.2.m2.1.1.3a.cmml" xref="S2.F2.7.2.m2.1.1.3"><mtext mathsize="70%" id="S2.F2.7.2.m2.1.1.3.cmml" xref="S2.F2.7.2.m2.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.2.m2.1d">H_{\text{global}}</annotation></semantics></math>.
These two embedding matrices, <math id="S2.F2.8.3.m3.1" class="ltx_Math" alttext="H_{\text{flow}}" display="inline"><semantics id="S2.F2.8.3.m3.1b"><msub id="S2.F2.8.3.m3.1.1" xref="S2.F2.8.3.m3.1.1.cmml"><mi id="S2.F2.8.3.m3.1.1.2" xref="S2.F2.8.3.m3.1.1.2.cmml">H</mi><mtext id="S2.F2.8.3.m3.1.1.3" xref="S2.F2.8.3.m3.1.1.3a.cmml">flow</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.8.3.m3.1c"><apply id="S2.F2.8.3.m3.1.1.cmml" xref="S2.F2.8.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.8.3.m3.1.1.1.cmml" xref="S2.F2.8.3.m3.1.1">subscript</csymbol><ci id="S2.F2.8.3.m3.1.1.2.cmml" xref="S2.F2.8.3.m3.1.1.2">𝐻</ci><ci id="S2.F2.8.3.m3.1.1.3a.cmml" xref="S2.F2.8.3.m3.1.1.3"><mtext mathsize="70%" id="S2.F2.8.3.m3.1.1.3.cmml" xref="S2.F2.8.3.m3.1.1.3">flow</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.3.m3.1d">H_{\text{flow}}</annotation></semantics></math> and <math id="S2.F2.9.4.m4.1" class="ltx_Math" alttext="H_{\text{global}}" display="inline"><semantics id="S2.F2.9.4.m4.1b"><msub id="S2.F2.9.4.m4.1.1" xref="S2.F2.9.4.m4.1.1.cmml"><mi id="S2.F2.9.4.m4.1.1.2" xref="S2.F2.9.4.m4.1.1.2.cmml">H</mi><mtext id="S2.F2.9.4.m4.1.1.3" xref="S2.F2.9.4.m4.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.9.4.m4.1c"><apply id="S2.F2.9.4.m4.1.1.cmml" xref="S2.F2.9.4.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.9.4.m4.1.1.1.cmml" xref="S2.F2.9.4.m4.1.1">subscript</csymbol><ci id="S2.F2.9.4.m4.1.1.2.cmml" xref="S2.F2.9.4.m4.1.1.2">𝐻</ci><ci id="S2.F2.9.4.m4.1.1.3a.cmml" xref="S2.F2.9.4.m4.1.1.3"><mtext mathsize="70%" id="S2.F2.9.4.m4.1.1.3.cmml" xref="S2.F2.9.4.m4.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.4.m4.1d">H_{\text{global}}</annotation></semantics></math>, are combined and then projected to produce updated node embeddings at each layer. This process is iterated over <math id="S2.F2.10.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.F2.10.5.m5.1b"><mi id="S2.F2.10.5.m5.1.1" xref="S2.F2.10.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.F2.10.5.m5.1c"><ci id="S2.F2.10.5.m5.1.1.cmml" xref="S2.F2.10.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.5.m5.1d">L</annotation></semantics></math> layers, and the output node embeddings are aggregated to form the final architecture embedding, which is fed into a regressor for performance prediction.
</span></figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Graph transformers (GTs)</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Graph transformers (GTs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">11</span></a>, <a href="#bib.bib19" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">19</span></a>, <a href="#bib.bib52" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">52</span></a>, <a href="#bib.bib42" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">42</span></a>, <a href="#bib.bib16" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">16</span></a>, <a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> apply global (i.e., graph-level) attention between all node pairs. Recently, GTs show remarkable performance in various graph-level tasks, including molecular property prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">38</span></a>, <a href="#bib.bib17" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>, image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">30</span></a>, <a href="#bib.bib55" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">55</span></a>]</cite>, and human interaction recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">To further improve their effectiveness, global attention is often supplemented with topological and/or external information. The information includes eigenvectors of adjacency and Laplacian matrices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">42</span></a>, <a href="#bib.bib19" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> and pair-wise node similarity derived from shortest paths, diffusion kernels, random walks, etc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">19</span></a>, <a href="#bib.bib52" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">52</span></a>, <a href="#bib.bib29" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Some GTs are tailored for specific types of graphs. For molecular graphs, where motifs play key roles,
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Niu et al.</span> [<a href="#bib.bib33" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite> employ motif-based spatial embeddings in a GT.
DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite> is designed for directed acyclic graphs (DAGs) and incorporates depth-based positional encodings and reachability-based attention. Note that DAGFormer is designed for general DAGs, and it is not optimized for encoding neural architectures, especially in capturing architecture-specific flows.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed method: <span id="S3.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present <span id="S3.p1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FlowerFormer</span> (<span id="S3.p1.1.2" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Flow</span>-awar<span id="S3.p1.1.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">e</span> g<span id="S3.p1.1.4" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">r</span>aph trans<span id="S3.p1.1.5" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">former</span>), a graph transformer model designed to capture information flows within an input neural architecture.
First, we provide the motivation behind <span id="S3.p1.1.6" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> in <a href="#S3.SS1" title="3.1 Motivation of capturing information flows ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>.
Then, we describe how an input neural architecture is represented as a graph in <a href="#S3.SS2" title="3.2 Input modeling ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>.
After that, we elaborate on how <span id="S3.p1.1.7" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> learns the representation of the neural architecture graph.
Specifically, we describe two core modules of <span id="S3.p1.1.8" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, collectively referred to as <span id="S3.p1.1.9" class="ltx_text ltx_font_smallcaps">Flower</span>, in <a href="#S3.SS3" title="3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.3</span></a>.
Lastly, we present the overall framework (refer to <a href="#S2.F2" title="In 2.1 Neural architecture encoding ‣ 2 Related work ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>) in <a href="#S3.SS4" title="3.4 Overall framework: FlowerFormer ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Motivation of capturing information flows</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Despite the remarkable success of Graph Transformers (GTs) in various graph-level tasks, including graph classification <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib52" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">52</span></a>, <a href="#bib.bib16" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> and regression <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib7" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">7</span></a>, <a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>, their application for encoding neural architectures has received relatively limited attention.
Existing applications of GTs suggest that additional design choices for accurately capturing the underlying characteristics of input graphs (on top of global attention mechanism between all pairs of nodes) are essential for the effectiveness of GTs.
Refer to <a href="#S2.SS2" title="2.2 Graph transformers (GTs) ‣ 2 Related work ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">2.2</span></a> for some examples.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">In this work, we focus on a crucial aspect: capturing <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_italic">information flows</span> within neural architectures (i.e., input graphs).
Information flows include both the forward pass of data and the backpropagation of gradients.
Hence, it is essential to capture information flows for incorporating how neural architectures are trained and conduct inference into their embeddings (i.e., the encoded neural architectures).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Input modeling</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We represent a given neural architecture as a directed acyclic graph (DAG), with each node representing an operation (e.g., pooling or convolution).
Each directional edge between two nodes indicates the information flow between the corresponding operations, aligning with the direction of data propagation during the forward pass. An illustrative example can be found on the left-hand side of Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Input modeling ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2403.12821/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="197" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.8.4.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.6.3" class="ltx_text" style="font-size:90%;">An example neural architecture from the NAS-Bench-101 dataset, represented as a directed acyclic graph (DAG), and its adjacency matrix <math id="S3.F3.4.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.F3.4.1.m1.1b"><mi id="S3.F3.4.1.m1.1.1" xref="S3.F3.4.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.F3.4.1.m1.1c"><ci id="S3.F3.4.1.m1.1.1.cmml" xref="S3.F3.4.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.1.m1.1d">A</annotation></semantics></math>. Each column of the node feature matrix <math id="S3.F3.5.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F3.5.2.m2.1b"><mi id="S3.F3.5.2.m2.1.1" xref="S3.F3.5.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F3.5.2.m2.1c"><ci id="S3.F3.5.2.m2.1.1.cmml" xref="S3.F3.5.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.2.m2.1d">X</annotation></semantics></math> corresponds to a specific operation, and each row in <math id="S3.F3.6.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F3.6.3.m3.1b"><mi id="S3.F3.6.3.m3.1.1" xref="S3.F3.6.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F3.6.3.m3.1c"><ci id="S3.F3.6.3.m3.1.1.cmml" xref="S3.F3.6.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.3.m3.1d">X</annotation></semantics></math> is a one-hot vector indicating the type of operation associated with the corresponding node.</span></figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.12" class="ltx_p">We denote the graph representation of a neural architecture by <math id="S3.SS2.p2.1.m1.2" class="ltx_Math" alttext="G=(A,X)" display="inline"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.3" xref="S3.SS2.p2.1.m1.2.3.cmml"><mi id="S3.SS2.p2.1.m1.2.3.2" xref="S3.SS2.p2.1.m1.2.3.2.cmml">G</mi><mo id="S3.SS2.p2.1.m1.2.3.1" xref="S3.SS2.p2.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.2.3.3.2" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.2.3.3.2.1" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">A</mi><mo id="S3.SS2.p2.1.m1.2.3.3.2.2" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">X</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.2.3.3.2.3" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.3.cmml" xref="S3.SS2.p2.1.m1.2.3"><eq id="S3.SS2.p2.1.m1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.3.1"></eq><ci id="S3.SS2.p2.1.m1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S3.SS2.p2.1.m1.2.3.3.1.cmml" xref="S3.SS2.p2.1.m1.2.3.3.2"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐴</ci><ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">𝑋</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">G=(A,X)</annotation></semantics></math>, a tuple of an adjacency matrix <math id="S3.SS2.p2.2.m2.2" class="ltx_Math" alttext="A\in\{0,1\}^{N\times N}" display="inline"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.3" xref="S3.SS2.p2.2.m2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.3.2" xref="S3.SS2.p2.2.m2.2.3.2.cmml">A</mi><mo id="S3.SS2.p2.2.m2.2.3.1" xref="S3.SS2.p2.2.m2.2.3.1.cmml">∈</mo><msup id="S3.SS2.p2.2.m2.2.3.3" xref="S3.SS2.p2.2.m2.2.3.3.cmml"><mrow id="S3.SS2.p2.2.m2.2.3.3.2.2" xref="S3.SS2.p2.2.m2.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.2.3.3.2.2.1" xref="S3.SS2.p2.2.m2.2.3.3.2.1.cmml">{</mo><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p2.2.m2.2.3.3.2.2.2" xref="S3.SS2.p2.2.m2.2.3.3.2.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p2.2.m2.2.3.3.2.2.3" xref="S3.SS2.p2.2.m2.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p2.2.m2.2.3.3.3" xref="S3.SS2.p2.2.m2.2.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.2.3.3.3.2" xref="S3.SS2.p2.2.m2.2.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.2.m2.2.3.3.3.1" xref="S3.SS2.p2.2.m2.2.3.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.2.m2.2.3.3.3.3" xref="S3.SS2.p2.2.m2.2.3.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><apply id="S3.SS2.p2.2.m2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.3"><in id="S3.SS2.p2.2.m2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3.1"></in><ci id="S3.SS2.p2.2.m2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.3.2">𝐴</ci><apply id="S3.SS2.p2.2.m2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.3.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3.3">superscript</csymbol><set id="S3.SS2.p2.2.m2.2.3.3.2.1.cmml" xref="S3.SS2.p2.2.m2.2.3.3.2.2"><cn type="integer" id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">0</cn><cn type="integer" id="S3.SS2.p2.2.m2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2">1</cn></set><apply id="S3.SS2.p2.2.m2.2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.2.3.3.3"><times id="S3.SS2.p2.2.m2.2.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3.3.3.1"></times><ci id="S3.SS2.p2.2.m2.2.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.2.3.3.3.2">𝑁</ci><ci id="S3.SS2.p2.2.m2.2.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.2.3.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">A\in\{0,1\}^{N\times N}</annotation></semantics></math> and a node (i.e., operation) feature matrix <math id="S3.SS2.p2.3.m3.2" class="ltx_Math" alttext="X\in\{0,1\}^{N\times D}" display="inline"><semantics id="S3.SS2.p2.3.m3.2a"><mrow id="S3.SS2.p2.3.m3.2.3" xref="S3.SS2.p2.3.m3.2.3.cmml"><mi id="S3.SS2.p2.3.m3.2.3.2" xref="S3.SS2.p2.3.m3.2.3.2.cmml">X</mi><mo id="S3.SS2.p2.3.m3.2.3.1" xref="S3.SS2.p2.3.m3.2.3.1.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.2.3.3" xref="S3.SS2.p2.3.m3.2.3.3.cmml"><mrow id="S3.SS2.p2.3.m3.2.3.3.2.2" xref="S3.SS2.p2.3.m3.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.2.3.3.2.2.1" xref="S3.SS2.p2.3.m3.2.3.3.2.1.cmml">{</mo><mn id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">0</mn><mo id="S3.SS2.p2.3.m3.2.3.3.2.2.2" xref="S3.SS2.p2.3.m3.2.3.3.2.1.cmml">,</mo><mn id="S3.SS2.p2.3.m3.2.2" xref="S3.SS2.p2.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p2.3.m3.2.3.3.2.2.3" xref="S3.SS2.p2.3.m3.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p2.3.m3.2.3.3.3" xref="S3.SS2.p2.3.m3.2.3.3.3.cmml"><mi id="S3.SS2.p2.3.m3.2.3.3.3.2" xref="S3.SS2.p2.3.m3.2.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.3.m3.2.3.3.3.1" xref="S3.SS2.p2.3.m3.2.3.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.3.m3.2.3.3.3.3" xref="S3.SS2.p2.3.m3.2.3.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.2b"><apply id="S3.SS2.p2.3.m3.2.3.cmml" xref="S3.SS2.p2.3.m3.2.3"><in id="S3.SS2.p2.3.m3.2.3.1.cmml" xref="S3.SS2.p2.3.m3.2.3.1"></in><ci id="S3.SS2.p2.3.m3.2.3.2.cmml" xref="S3.SS2.p2.3.m3.2.3.2">𝑋</ci><apply id="S3.SS2.p2.3.m3.2.3.3.cmml" xref="S3.SS2.p2.3.m3.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.3.3.1.cmml" xref="S3.SS2.p2.3.m3.2.3.3">superscript</csymbol><set id="S3.SS2.p2.3.m3.2.3.3.2.1.cmml" xref="S3.SS2.p2.3.m3.2.3.3.2.2"><cn type="integer" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">0</cn><cn type="integer" id="S3.SS2.p2.3.m3.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2">1</cn></set><apply id="S3.SS2.p2.3.m3.2.3.3.3.cmml" xref="S3.SS2.p2.3.m3.2.3.3.3"><times id="S3.SS2.p2.3.m3.2.3.3.3.1.cmml" xref="S3.SS2.p2.3.m3.2.3.3.3.1"></times><ci id="S3.SS2.p2.3.m3.2.3.3.3.2.cmml" xref="S3.SS2.p2.3.m3.2.3.3.3.2">𝑁</ci><ci id="S3.SS2.p2.3.m3.2.3.3.3.3.cmml" xref="S3.SS2.p2.3.m3.2.3.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.2c">X\in\{0,1\}^{N\times D}</annotation></semantics></math>, where <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">N</annotation></semantics></math> is the number of nodes and <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">D</annotation></semantics></math> is the number of operations.
The adjacency matrix encodes direct connections between node pairs in a graph. Its binary entries indicate whether a directional edge exists between each pair of nodes. Specifically, the <math id="S3.SS2.p2.6.m6.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS2.p2.6.m6.2a"><mrow id="S3.SS2.p2.6.m6.2.3.2" xref="S3.SS2.p2.6.m6.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.2.3.2.1" xref="S3.SS2.p2.6.m6.2.3.1.cmml">(</mo><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">i</mi><mo id="S3.SS2.p2.6.m6.2.3.2.2" xref="S3.SS2.p2.6.m6.2.3.1.cmml">,</mo><mi id="S3.SS2.p2.6.m6.2.2" xref="S3.SS2.p2.6.m6.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS2.p2.6.m6.2.3.2.3" xref="S3.SS2.p2.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.2b"><interval closure="open" id="S3.SS2.p2.6.m6.2.3.1.cmml" xref="S3.SS2.p2.6.m6.2.3.2"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝑖</ci><ci id="S3.SS2.p2.6.m6.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.2c">(i,j)</annotation></semantics></math>-th entry of <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">A</annotation></semantics></math> is set to 1 if there is a directed edge from the <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">i</annotation></semantics></math>-th node (denoted as <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">v</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝑣</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">v_{i}</annotation></semantics></math>) to the <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">j</annotation></semantics></math>-th node (denoted as <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><msub id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml"><mi id="S3.SS2.p2.11.m11.1.1.2" xref="S3.SS2.p2.11.m11.1.1.2.cmml">v</mi><mi id="S3.SS2.p2.11.m11.1.1.3" xref="S3.SS2.p2.11.m11.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><apply id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2">𝑣</ci><ci id="S3.SS2.p2.11.m11.1.1.3.cmml" xref="S3.SS2.p2.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">v_{j}</annotation></semantics></math>), and 0 otherwise.
Each node is associated with a one-hot feature vector representing its corresponding operation, and these vectors are stacked vertically to form the node feature matrix <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><mi id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><ci id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m12.1c">X</annotation></semantics></math>. Refer to <a href="#S3.F3" title="In 3.2 Input modeling ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> for an example.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">With our general input modeling scheme, <span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> is readily applicable to different domains and neural architectures without such additional modelings or steps.
By contrast, state-of-the-art neural encoding methods often rely on complex modelings and/or preprocessing steps, such as the specialized treatment of specific operations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> and isomorphic augmentations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite> (refer to <a href="#S2.SS1" title="2.1 Neural architecture encoding ‣ 2 Related work ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">2.1</span></a>).
The empirical superiority of <span id="S3.SS2.p3.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> (refer to <a href="#S4" title="4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4</span></a>) despite its straightforward (yet elegant) input modeling is attributed to our novel flow-aware GT architecture, which is described in the following subsection.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">Flower</span> layers</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">In this section, we introduce <span id="S3.SS3.p1.3.1" class="ltx_text ltx_font_smallcaps">Flower</span> layers, the basic units of <span id="S3.SS3.p1.3.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>. A <span id="S3.SS3.p1.3.3" class="ltx_text ltx_font_smallcaps">Flower</span> layer consists of two core components: the <span id="S3.SS3.p1.3.4" class="ltx_text ltx_font_italic">flow encode</span> module and the <span id="S3.SS3.p1.3.5" class="ltx_text ltx_font_italic">flow-aware global attention</span> module.
The flow encode module is a message-passing neural network (MPNN) that asynchronously passes messages in the forward and then the backward orders.
The flow-aware global attention module is a self-attention module based on a flow-aware masking scheme.
The outputs of the flow encode module and the flow-aware global attention module are node embedding matrices, denoted as <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="H^{(l)}_{flow}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><msubsup id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml"><mi id="S3.SS3.p1.1.m1.1.2.2.2.2" xref="S3.SS3.p1.1.m1.1.2.2.2.2.cmml">H</mi><mrow id="S3.SS3.p1.1.m1.1.2.2.3" xref="S3.SS3.p1.1.m1.1.2.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.2.3.2" xref="S3.SS3.p1.1.m1.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.2.2.3.1" xref="S3.SS3.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.2.2.3.3" xref="S3.SS3.p1.1.m1.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.2.2.3.1a" xref="S3.SS3.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.2.2.3.4" xref="S3.SS3.p1.1.m1.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.2.2.3.1b" xref="S3.SS3.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.2.2.3.5" xref="S3.SS3.p1.1.m1.1.2.2.3.5.cmml">w</mi></mrow><mrow id="S3.SS3.p1.1.m1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.1.m1.1.2.1" xref="S3.SS3.p1.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.1.m1.1.2.3" xref="S3.SS3.p1.1.m1.1.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.3.2" xref="S3.SS3.p1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.1.m1.1.2.3.3" xref="S3.SS3.p1.1.m1.1.2.3.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.3.3.2" xref="S3.SS3.p1.1.m1.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.1.m1.1.2.3.3.1" xref="S3.SS3.p1.1.m1.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.1.m1.1.2.3.3.3" xref="S3.SS3.p1.1.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.2"><in id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.1"></in><apply id="S3.SS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2">subscript</csymbol><apply id="S3.SS3.p1.1.m1.1.2.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2.2.2">𝐻</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.SS3.p1.1.m1.1.2.2.3.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3"><times id="S3.SS3.p1.1.m1.1.2.2.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.1"></times><ci id="S3.SS3.p1.1.m1.1.2.2.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.2">𝑓</ci><ci id="S3.SS3.p1.1.m1.1.2.2.3.3.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.3">𝑙</ci><ci id="S3.SS3.p1.1.m1.1.2.2.3.4.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.p1.1.m1.1.2.2.3.5.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.5">𝑤</ci></apply></apply><apply id="S3.SS3.p1.1.m1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.1.m1.1.2.3.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3"><times id="S3.SS3.p1.1.m1.1.2.3.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3.1"></times><ci id="S3.SS3.p1.1.m1.1.2.3.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.p1.1.m1.1.2.3.3.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">H^{(l)}_{flow}\in\mathbb{R}^{N\times d}</annotation></semantics></math> and <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="H^{(l)}_{global}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><msubsup id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.2.2" xref="S3.SS3.p1.2.m2.1.2.2.2.2.cmml">H</mi><mrow id="S3.SS3.p1.2.m2.1.2.2.3" xref="S3.SS3.p1.2.m2.1.2.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.3.2" xref="S3.SS3.p1.2.m2.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.2.3.1" xref="S3.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.2.2.3.3" xref="S3.SS3.p1.2.m2.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.2.3.1a" xref="S3.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.2.2.3.4" xref="S3.SS3.p1.2.m2.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.2.3.1b" xref="S3.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.2.2.3.5" xref="S3.SS3.p1.2.m2.1.2.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.2.3.1c" xref="S3.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.2.2.3.6" xref="S3.SS3.p1.2.m2.1.2.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.2.3.1d" xref="S3.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.2.2.3.7" xref="S3.SS3.p1.2.m2.1.2.2.3.7.cmml">l</mi></mrow><mrow id="S3.SS3.p1.2.m2.1.1.1.3" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.3.1" xref="S3.SS3.p1.2.m2.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.3.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.2.m2.1.2.1" xref="S3.SS3.p1.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.2.m2.1.2.3" xref="S3.SS3.p1.2.m2.1.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.2.m2.1.2.3.3" xref="S3.SS3.p1.2.m2.1.2.3.3.cmml"><mi id="S3.SS3.p1.2.m2.1.2.3.3.2" xref="S3.SS3.p1.2.m2.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.2.m2.1.2.3.3.1" xref="S3.SS3.p1.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.2.m2.1.2.3.3.3" xref="S3.SS3.p1.2.m2.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><in id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1"></in><apply id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2.2">𝐻</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝑙</ci></apply><apply id="S3.SS3.p1.2.m2.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3"><times id="S3.SS3.p1.2.m2.1.2.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.1"></times><ci id="S3.SS3.p1.2.m2.1.2.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.2">𝑔</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.3">𝑙</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.4.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.5.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.5">𝑏</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.6.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.6">𝑎</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.7.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3.7">𝑙</ci></apply></apply><apply id="S3.SS3.p1.2.m2.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.2.m2.1.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3.3"><times id="S3.SS3.p1.2.m2.1.2.3.3.1.cmml" xref="S3.SS3.p1.2.m2.1.2.3.3.1"></times><ci id="S3.SS3.p1.2.m2.1.2.3.3.2.cmml" xref="S3.SS3.p1.2.m2.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.p1.2.m2.1.2.3.3.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">H^{(l)}_{global}\in\mathbb{R}^{N\times d}</annotation></semantics></math>, respectively, for the <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">l</annotation></semantics></math>-th <span id="S3.SS3.p1.3.6" class="ltx_text ltx_font_smallcaps">Flower</span> layer.
Below, we provide a detailed explanation of each module.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.17" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.1.1" class="ltx_listingline">
<span id="algorithm1.1.1.1" class="ltx_text" style="font-size:90%;">


<span id="algorithm1.1.1.1.1" class="ltx_text"><span id="algorithm1.1.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>(1) <math id="algorithm1.1.1.1.m1.2" class="ltx_Math" alttext="G=(A,X)" display="inline"><semantics id="algorithm1.1.1.1.m1.2a"><mrow id="algorithm1.1.1.1.m1.2.3" xref="algorithm1.1.1.1.m1.2.3.cmml"><mi id="algorithm1.1.1.1.m1.2.3.2" xref="algorithm1.1.1.1.m1.2.3.2.cmml">G</mi><mo id="algorithm1.1.1.1.m1.2.3.1" xref="algorithm1.1.1.1.m1.2.3.1.cmml">=</mo><mrow id="algorithm1.1.1.1.m1.2.3.3.2" xref="algorithm1.1.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="algorithm1.1.1.1.m1.2.3.3.2.1" xref="algorithm1.1.1.1.m1.2.3.3.1.cmml">(</mo><mi id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml">A</mi><mo id="algorithm1.1.1.1.m1.2.3.3.2.2" xref="algorithm1.1.1.1.m1.2.3.3.1.cmml">,</mo><mi id="algorithm1.1.1.1.m1.2.2" xref="algorithm1.1.1.1.m1.2.2.cmml">X</mi><mo stretchy="false" id="algorithm1.1.1.1.m1.2.3.3.2.3" xref="algorithm1.1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.2b"><apply id="algorithm1.1.1.1.m1.2.3.cmml" xref="algorithm1.1.1.1.m1.2.3"><eq id="algorithm1.1.1.1.m1.2.3.1.cmml" xref="algorithm1.1.1.1.m1.2.3.1"></eq><ci id="algorithm1.1.1.1.m1.2.3.2.cmml" xref="algorithm1.1.1.1.m1.2.3.2">𝐺</ci><interval closure="open" id="algorithm1.1.1.1.m1.2.3.3.1.cmml" xref="algorithm1.1.1.1.m1.2.3.3.2"><ci id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1">𝐴</ci><ci id="algorithm1.1.1.1.m1.2.2.cmml" xref="algorithm1.1.1.1.m1.2.2">𝑋</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.2c">G=(A,X)</annotation></semantics></math>: an input neural architecture </span>
</div>
<div id="algorithm1.2.2" class="ltx_listingline">
<span id="algorithm1.2.2.1" class="ltx_text" style="font-size:90%;">
   (2) </span><math id="algorithm1.2.2.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="algorithm1.2.2.m1.1a"><mi mathsize="90%" id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><ci id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">H</annotation></semantics></math><span id="algorithm1.2.2.2" class="ltx_text" style="font-size:90%;">: an input node embedding matrix </span>
</div>
<div id="algorithm1.17.18" class="ltx_listingline">
<span id="algorithm1.17.18.1" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
<span id="algorithm1.3.3.1" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.3.3.2" class="ltx_text" style="font-size:90%;"><span id="algorithm1.3.3.2.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm1.3.3.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="algorithm1.3.3.m1.1a"><mi mathsize="90%" id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><ci id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">H</annotation></semantics></math><span id="algorithm1.3.3.3" class="ltx_text" style="font-size:90%;">: updated node embedding matrix </span>
</div>
<div id="algorithm1.17.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.17.19.1.1.1" class="ltx_text" style="font-size:90%;">1</span></span><span id="algorithm1.17.19.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.5.5.2.1.1" class="ltx_text" style="font-size:90%;">2</span></span><span id="algorithm1.5.5.3" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="{/}^{*}" display="inline"><semantics id="algorithm1.4.4.m1.1a"><msup id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><mo mathcolor="#0000FF" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml">/</mo><mo mathcolor="#0000FF" mathsize="90%" id="algorithm1.4.4.m1.1.1.3" xref="algorithm1.4.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1">superscript</csymbol><divide id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2"></divide><times id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">{/}^{*}</annotation></semantics></math><span id="algorithm1.5.5.1" class="ltx_text" style="font-size:90%;color:#0000FF;"> step 1. topological sorting <math id="algorithm1.5.5.1.m1.1" class="ltx_math_unparsed" alttext="{}^{*}/" display="inline"><semantics id="algorithm1.5.5.1.m1.1a"><mmultiscripts id="algorithm1.5.5.1.m1.1.1"><mo mathcolor="#0000FF" id="algorithm1.5.5.1.m1.1.1.2">/</mo><mprescripts id="algorithm1.5.5.1.m1.1.1a"></mprescripts><mrow id="algorithm1.5.5.1.m1.1.1b"></mrow><mo mathcolor="#0000FF" id="algorithm1.5.5.1.m1.1.1.3">∗</mo></mmultiscripts><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1b">{}^{*}/</annotation></semantics></math></span><span id="algorithm1.5.5.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.6.6.1.1.1" class="ltx_text" style="font-size:90%;">3</span></span><span id="algorithm1.6.6.2" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="\mathcal{T}^{G}\leftarrow\text{topological generations of }G" display="inline"><semantics id="algorithm1.6.6.m1.1a"><mrow id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><msup id="algorithm1.6.6.m1.1.1.2" xref="algorithm1.6.6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.6.6.m1.1.1.2.2" xref="algorithm1.6.6.m1.1.1.2.2.cmml">𝒯</mi><mi mathsize="90%" id="algorithm1.6.6.m1.1.1.2.3" xref="algorithm1.6.6.m1.1.1.2.3.cmml">G</mi></msup><mo mathsize="90%" stretchy="false" id="algorithm1.6.6.m1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.6.6.m1.1.1.3" xref="algorithm1.6.6.m1.1.1.3.cmml"><mtext mathsize="90%" id="algorithm1.6.6.m1.1.1.3.2" xref="algorithm1.6.6.m1.1.1.3.2a.cmml">topological generations of </mtext><mo lspace="0em" rspace="0em" id="algorithm1.6.6.m1.1.1.3.1" xref="algorithm1.6.6.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.6.6.m1.1.1.3.3" xref="algorithm1.6.6.m1.1.1.3.3.cmml">G</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><ci id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1">←</ci><apply id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.2.1.cmml" xref="algorithm1.6.6.m1.1.1.2">superscript</csymbol><ci id="algorithm1.6.6.m1.1.1.2.2.cmml" xref="algorithm1.6.6.m1.1.1.2.2">𝒯</ci><ci id="algorithm1.6.6.m1.1.1.2.3.cmml" xref="algorithm1.6.6.m1.1.1.2.3">𝐺</ci></apply><apply id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3"><times id="algorithm1.6.6.m1.1.1.3.1.cmml" xref="algorithm1.6.6.m1.1.1.3.1"></times><ci id="algorithm1.6.6.m1.1.1.3.2a.cmml" xref="algorithm1.6.6.m1.1.1.3.2"><mtext mathsize="90%" id="algorithm1.6.6.m1.1.1.3.2.cmml" xref="algorithm1.6.6.m1.1.1.3.2">topological generations of </mtext></ci><ci id="algorithm1.6.6.m1.1.1.3.3.cmml" xref="algorithm1.6.6.m1.1.1.3.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\mathcal{T}^{G}\leftarrow\text{topological generations of }G</annotation></semantics></math><span id="algorithm1.6.6.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.17.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.17.20.1.1.1" class="ltx_text" style="font-size:90%;">4</span></span><span id="algorithm1.17.20.2" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.8.8.2.1.1" class="ltx_text" style="font-size:90%;">5</span></span><math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="{/}^{*}" display="inline"><semantics id="algorithm1.7.7.m1.1a"><msup id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><mo mathcolor="#0000FF" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml">/</mo><mo mathcolor="#0000FF" mathsize="90%" id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">superscript</csymbol><divide id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2"></divide><times id="algorithm1.7.7.m1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">{/}^{*}</annotation></semantics></math><span id="algorithm1.8.8.1" class="ltx_text" style="font-size:90%;color:#0000FF;"> step 2. asynchronous forward message passing <math id="algorithm1.8.8.1.m1.1" class="ltx_math_unparsed" alttext="{}^{*}/" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mmultiscripts id="algorithm1.8.8.1.m1.1.1"><mo mathcolor="#0000FF" id="algorithm1.8.8.1.m1.1.1.2">/</mo><mprescripts id="algorithm1.8.8.1.m1.1.1a"></mprescripts><mrow id="algorithm1.8.8.1.m1.1.1b"></mrow><mo mathcolor="#0000FF" id="algorithm1.8.8.1.m1.1.1.3">∗</mo></mmultiscripts><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1b">{}^{*}/</annotation></semantics></math></span><span id="algorithm1.8.8.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.9.9.2.1.1" class="ltx_text" style="font-size:90%;">6</span></span><span id="algorithm1.9.9.3" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.9.9.4" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.9.9.5" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.9.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.9.9.1.m1.3" class="ltx_Math" alttext="k=1,\dots,|\mathcal{T}^{G}|" display="inline"><semantics id="algorithm1.9.9.1.m1.3a"><mrow id="algorithm1.9.9.1.m1.3.3" xref="algorithm1.9.9.1.m1.3.3.cmml"><mi id="algorithm1.9.9.1.m1.3.3.3" xref="algorithm1.9.9.1.m1.3.3.3.cmml">k</mi><mo id="algorithm1.9.9.1.m1.3.3.2" xref="algorithm1.9.9.1.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.9.9.1.m1.3.3.1.1" xref="algorithm1.9.9.1.m1.3.3.1.2.cmml"><mn id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml">1</mn><mo id="algorithm1.9.9.1.m1.3.3.1.1.2" xref="algorithm1.9.9.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm1.9.9.1.m1.2.2" xref="algorithm1.9.9.1.m1.2.2.cmml">…</mi><mo id="algorithm1.9.9.1.m1.3.3.1.1.3" xref="algorithm1.9.9.1.m1.3.3.1.2.cmml">,</mo><mrow id="algorithm1.9.9.1.m1.3.3.1.1.1.1" xref="algorithm1.9.9.1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.9.9.1.m1.3.3.1.1.1.1.2" xref="algorithm1.9.9.1.m1.3.3.1.1.1.2.1.cmml">|</mo><msup id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.2" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.2.cmml">𝒯</mi><mi id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.3" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.3.cmml">G</mi></msup><mo stretchy="false" id="algorithm1.9.9.1.m1.3.3.1.1.1.1.3" xref="algorithm1.9.9.1.m1.3.3.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.3b"><apply id="algorithm1.9.9.1.m1.3.3.cmml" xref="algorithm1.9.9.1.m1.3.3"><eq id="algorithm1.9.9.1.m1.3.3.2.cmml" xref="algorithm1.9.9.1.m1.3.3.2"></eq><ci id="algorithm1.9.9.1.m1.3.3.3.cmml" xref="algorithm1.9.9.1.m1.3.3.3">𝑘</ci><list id="algorithm1.9.9.1.m1.3.3.1.2.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1"><cn type="integer" id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1">1</cn><ci id="algorithm1.9.9.1.m1.2.2.cmml" xref="algorithm1.9.9.1.m1.2.2">…</ci><apply id="algorithm1.9.9.1.m1.3.3.1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1"><abs id="algorithm1.9.9.1.m1.3.3.1.1.1.2.1.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.2"></abs><apply id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.2">𝒯</ci><ci id="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.3.cmml" xref="algorithm1.9.9.1.m1.3.3.1.1.1.1.1.3">𝐺</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.3c">k=1,\dots,|\mathcal{T}^{G}|</annotation></semantics></math> </em><span id="algorithm1.9.9.6" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.9.9.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.10.10.2.1.1" class="ltx_text" style="font-size:90%;">7</span></span><span id="algorithm1.10.10.3" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.10.10.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.10.10.5" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.10.10.6" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.10.10.7" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.10.10.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.10.10.1.m1.1" class="ltx_Math" alttext="v_{j}\in T^{G}_{k}" display="inline"><semantics id="algorithm1.10.10.1.m1.1a"><mrow id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml"><msub id="algorithm1.10.10.1.m1.1.1.2" xref="algorithm1.10.10.1.m1.1.1.2.cmml"><mi id="algorithm1.10.10.1.m1.1.1.2.2" xref="algorithm1.10.10.1.m1.1.1.2.2.cmml">v</mi><mi id="algorithm1.10.10.1.m1.1.1.2.3" xref="algorithm1.10.10.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="algorithm1.10.10.1.m1.1.1.1" xref="algorithm1.10.10.1.m1.1.1.1.cmml">∈</mo><msubsup id="algorithm1.10.10.1.m1.1.1.3" xref="algorithm1.10.10.1.m1.1.1.3.cmml"><mi id="algorithm1.10.10.1.m1.1.1.3.2.2" xref="algorithm1.10.10.1.m1.1.1.3.2.2.cmml">T</mi><mi id="algorithm1.10.10.1.m1.1.1.3.3" xref="algorithm1.10.10.1.m1.1.1.3.3.cmml">k</mi><mi id="algorithm1.10.10.1.m1.1.1.3.2.3" xref="algorithm1.10.10.1.m1.1.1.3.2.3.cmml">G</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.1b"><apply id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1"><in id="algorithm1.10.10.1.m1.1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1.1"></in><apply id="algorithm1.10.10.1.m1.1.1.2.cmml" xref="algorithm1.10.10.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.1.1.2.1.cmml" xref="algorithm1.10.10.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.10.10.1.m1.1.1.2.2.cmml" xref="algorithm1.10.10.1.m1.1.1.2.2">𝑣</ci><ci id="algorithm1.10.10.1.m1.1.1.2.3.cmml" xref="algorithm1.10.10.1.m1.1.1.2.3">𝑗</ci></apply><apply id="algorithm1.10.10.1.m1.1.1.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.1.1.3.1.cmml" xref="algorithm1.10.10.1.m1.1.1.3">subscript</csymbol><apply id="algorithm1.10.10.1.m1.1.1.3.2.cmml" xref="algorithm1.10.10.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.1.1.3.2.1.cmml" xref="algorithm1.10.10.1.m1.1.1.3">superscript</csymbol><ci id="algorithm1.10.10.1.m1.1.1.3.2.2.cmml" xref="algorithm1.10.10.1.m1.1.1.3.2.2">𝑇</ci><ci id="algorithm1.10.10.1.m1.1.1.3.2.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3.2.3">𝐺</ci></apply><ci id="algorithm1.10.10.1.m1.1.1.3.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.1c">v_{j}\in T^{G}_{k}</annotation></semantics></math></em><span id="algorithm1.10.10.8" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.10.10.9" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.11.11.1.1.1" class="ltx_text" style="font-size:90%;">8</span></span><span id="algorithm1.11.11.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.11.11.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.11.11.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.11.11.5" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.11.11.m1.4" class="ltx_Math" alttext="h_{j}\leftarrow\operatorname{Comb}(h_{j},\operatorname{Agg}\{m_{e}(h_{j},h_{i}):A_{ij}=1\})" display="inline"><semantics id="algorithm1.11.11.m1.4a"><mrow id="algorithm1.11.11.m1.4.4" xref="algorithm1.11.11.m1.4.4.cmml"><msub id="algorithm1.11.11.m1.4.4.4" xref="algorithm1.11.11.m1.4.4.4.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.4.2" xref="algorithm1.11.11.m1.4.4.4.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.4.3" xref="algorithm1.11.11.m1.4.4.4.3.cmml">j</mi></msub><mo mathsize="90%" stretchy="false" id="algorithm1.11.11.m1.4.4.3" xref="algorithm1.11.11.m1.4.4.3.cmml">←</mo><mrow id="algorithm1.11.11.m1.4.4.2.2" xref="algorithm1.11.11.m1.4.4.2.3.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.2.2" xref="algorithm1.11.11.m1.2.2.cmml">Comb</mi><mo id="algorithm1.11.11.m1.4.4.2.2a" xref="algorithm1.11.11.m1.4.4.2.3.cmml">⁡</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2" xref="algorithm1.11.11.m1.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.3" xref="algorithm1.11.11.m1.4.4.2.3.cmml">(</mo><msub id="algorithm1.11.11.m1.3.3.1.1.1.1" xref="algorithm1.11.11.m1.3.3.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.3.3.1.1.1.1.2" xref="algorithm1.11.11.m1.3.3.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.11.11.m1.3.3.1.1.1.1.3" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.4" xref="algorithm1.11.11.m1.4.4.2.3.cmml">,</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">Agg</mi><mo id="algorithm1.11.11.m1.4.4.2.2.2.2.1a" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml">⁡</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml">{</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.cmml"><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.cmml"><msub id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.2.cmml">m</mi><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.3.cmml">​</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.3.cmml">(</mo><msub id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.4" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.3.cmml">,</mo><msub id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.278em" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.5" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.278em" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.3.cmml">:</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.cmml"><msub id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.2.cmml">A</mi><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.1.cmml">=</mo><mn mathsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.3.cmml">1</mn></mrow></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml">}</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.11.11.m1.4.4.2.2.2.5" xref="algorithm1.11.11.m1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.4b"><apply id="algorithm1.11.11.m1.4.4.cmml" xref="algorithm1.11.11.m1.4.4"><ci id="algorithm1.11.11.m1.4.4.3.cmml" xref="algorithm1.11.11.m1.4.4.3">←</ci><apply id="algorithm1.11.11.m1.4.4.4.cmml" xref="algorithm1.11.11.m1.4.4.4"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.4.1.cmml" xref="algorithm1.11.11.m1.4.4.4">subscript</csymbol><ci id="algorithm1.11.11.m1.4.4.4.2.cmml" xref="algorithm1.11.11.m1.4.4.4.2">ℎ</ci><ci id="algorithm1.11.11.m1.4.4.4.3.cmml" xref="algorithm1.11.11.m1.4.4.4.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.4.4.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2"><ci id="algorithm1.11.11.m1.2.2.cmml" xref="algorithm1.11.11.m1.2.2">Comb</ci><apply id="algorithm1.11.11.m1.3.3.1.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.2">ℎ</ci><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1"><ci id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">Agg</ci><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1"><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.3">:</ci><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2"><times id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.3"></times><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4">subscript</csymbol><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.2">𝑚</ci><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.4.3">𝑒</ci></apply><interval closure="open" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2"><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2">ℎ</ci><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.2">ℎ</ci><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4"><eq id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.1"></eq><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2">subscript</csymbol><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.2">𝐴</ci><apply id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3"><times id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.1"></times><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.2">𝑖</ci><ci id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.1.1.4.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.4c">h_{j}\leftarrow\operatorname{Comb}(h_{j},\operatorname{Agg}\{m_{e}(h_{j},h_{i}):A_{ij}=1\})</annotation></semantics></math><span id="algorithm1.11.11.6" class="ltx_text" style="font-size:90%;"> 
</span>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.13.13.2.1.1" class="ltx_text" style="font-size:90%;">9</span></span><span id="algorithm1.13.13.3" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="{/}^{*}" display="inline"><semantics id="algorithm1.12.12.m1.1a"><msup id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mo mathcolor="#0000FF" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml">/</mo><mo mathcolor="#0000FF" mathsize="90%" id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">superscript</csymbol><divide id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2"></divide><times id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">{/}^{*}</annotation></semantics></math><span id="algorithm1.13.13.1" class="ltx_text" style="font-size:90%;color:#0000FF;"> step 3. asynchronous backward message passing <math id="algorithm1.13.13.1.m1.1" class="ltx_math_unparsed" alttext="{}^{*}/" display="inline"><semantics id="algorithm1.13.13.1.m1.1a"><mmultiscripts id="algorithm1.13.13.1.m1.1.1"><mo mathcolor="#0000FF" id="algorithm1.13.13.1.m1.1.1.2">/</mo><mprescripts id="algorithm1.13.13.1.m1.1.1a"></mprescripts><mrow id="algorithm1.13.13.1.m1.1.1b"></mrow><mo mathcolor="#0000FF" id="algorithm1.13.13.1.m1.1.1.3">∗</mo></mmultiscripts><annotation encoding="application/x-tex" id="algorithm1.13.13.1.m1.1b">{}^{*}/</annotation></semantics></math></span><span id="algorithm1.13.13.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.14.14.2.1.1" class="ltx_text" style="font-size:90%;">10</span></span><span id="algorithm1.14.14.3" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.14.14.4" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.14.14.5" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.14.14.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.14.14.1.m1.3" class="ltx_Math" alttext="k=|\mathcal{T}^{G}|,\dots,1" display="inline"><semantics id="algorithm1.14.14.1.m1.3a"><mrow id="algorithm1.14.14.1.m1.3.3" xref="algorithm1.14.14.1.m1.3.3.cmml"><mi id="algorithm1.14.14.1.m1.3.3.3" xref="algorithm1.14.14.1.m1.3.3.3.cmml">k</mi><mo id="algorithm1.14.14.1.m1.3.3.2" xref="algorithm1.14.14.1.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.14.14.1.m1.3.3.1.1" xref="algorithm1.14.14.1.m1.3.3.1.2.cmml"><mrow id="algorithm1.14.14.1.m1.3.3.1.1.1.1" xref="algorithm1.14.14.1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.14.14.1.m1.3.3.1.1.1.1.2" xref="algorithm1.14.14.1.m1.3.3.1.1.1.2.1.cmml">|</mo><msup id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.2" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.2.cmml">𝒯</mi><mi id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.3" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.3.cmml">G</mi></msup><mo stretchy="false" id="algorithm1.14.14.1.m1.3.3.1.1.1.1.3" xref="algorithm1.14.14.1.m1.3.3.1.1.1.2.1.cmml">|</mo></mrow><mo id="algorithm1.14.14.1.m1.3.3.1.1.2" xref="algorithm1.14.14.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml">…</mi><mo id="algorithm1.14.14.1.m1.3.3.1.1.3" xref="algorithm1.14.14.1.m1.3.3.1.2.cmml">,</mo><mn id="algorithm1.14.14.1.m1.2.2" xref="algorithm1.14.14.1.m1.2.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.3b"><apply id="algorithm1.14.14.1.m1.3.3.cmml" xref="algorithm1.14.14.1.m1.3.3"><eq id="algorithm1.14.14.1.m1.3.3.2.cmml" xref="algorithm1.14.14.1.m1.3.3.2"></eq><ci id="algorithm1.14.14.1.m1.3.3.3.cmml" xref="algorithm1.14.14.1.m1.3.3.3">𝑘</ci><list id="algorithm1.14.14.1.m1.3.3.1.2.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1"><apply id="algorithm1.14.14.1.m1.3.3.1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1"><abs id="algorithm1.14.14.1.m1.3.3.1.1.1.2.1.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.2"></abs><apply id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.2">𝒯</ci><ci id="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.3.cmml" xref="algorithm1.14.14.1.m1.3.3.1.1.1.1.1.3">𝐺</ci></apply></apply><ci id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1">…</ci><cn type="integer" id="algorithm1.14.14.1.m1.2.2.cmml" xref="algorithm1.14.14.1.m1.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.3c">k=|\mathcal{T}^{G}|,\dots,1</annotation></semantics></math> </em><span id="algorithm1.14.14.6" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.14.14.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.15.15.2.1.1" class="ltx_text" style="font-size:90%;">11</span></span><span id="algorithm1.15.15.3" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.15.15.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.15.15.5" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.15.15.6" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.15.15.7" class="ltx_text" style="font-size:90%;"> </span><em id="algorithm1.15.15.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="algorithm1.15.15.1.m1.1" class="ltx_Math" alttext="v_{j}\in T^{G}_{k}" display="inline"><semantics id="algorithm1.15.15.1.m1.1a"><mrow id="algorithm1.15.15.1.m1.1.1" xref="algorithm1.15.15.1.m1.1.1.cmml"><msub id="algorithm1.15.15.1.m1.1.1.2" xref="algorithm1.15.15.1.m1.1.1.2.cmml"><mi id="algorithm1.15.15.1.m1.1.1.2.2" xref="algorithm1.15.15.1.m1.1.1.2.2.cmml">v</mi><mi id="algorithm1.15.15.1.m1.1.1.2.3" xref="algorithm1.15.15.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="algorithm1.15.15.1.m1.1.1.1" xref="algorithm1.15.15.1.m1.1.1.1.cmml">∈</mo><msubsup id="algorithm1.15.15.1.m1.1.1.3" xref="algorithm1.15.15.1.m1.1.1.3.cmml"><mi id="algorithm1.15.15.1.m1.1.1.3.2.2" xref="algorithm1.15.15.1.m1.1.1.3.2.2.cmml">T</mi><mi id="algorithm1.15.15.1.m1.1.1.3.3" xref="algorithm1.15.15.1.m1.1.1.3.3.cmml">k</mi><mi id="algorithm1.15.15.1.m1.1.1.3.2.3" xref="algorithm1.15.15.1.m1.1.1.3.2.3.cmml">G</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.1.m1.1b"><apply id="algorithm1.15.15.1.m1.1.1.cmml" xref="algorithm1.15.15.1.m1.1.1"><in id="algorithm1.15.15.1.m1.1.1.1.cmml" xref="algorithm1.15.15.1.m1.1.1.1"></in><apply id="algorithm1.15.15.1.m1.1.1.2.cmml" xref="algorithm1.15.15.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.1.m1.1.1.2.1.cmml" xref="algorithm1.15.15.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.15.15.1.m1.1.1.2.2.cmml" xref="algorithm1.15.15.1.m1.1.1.2.2">𝑣</ci><ci id="algorithm1.15.15.1.m1.1.1.2.3.cmml" xref="algorithm1.15.15.1.m1.1.1.2.3">𝑗</ci></apply><apply id="algorithm1.15.15.1.m1.1.1.3.cmml" xref="algorithm1.15.15.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.1.m1.1.1.3.1.cmml" xref="algorithm1.15.15.1.m1.1.1.3">subscript</csymbol><apply id="algorithm1.15.15.1.m1.1.1.3.2.cmml" xref="algorithm1.15.15.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.1.m1.1.1.3.2.1.cmml" xref="algorithm1.15.15.1.m1.1.1.3">superscript</csymbol><ci id="algorithm1.15.15.1.m1.1.1.3.2.2.cmml" xref="algorithm1.15.15.1.m1.1.1.3.2.2">𝑇</ci><ci id="algorithm1.15.15.1.m1.1.1.3.2.3.cmml" xref="algorithm1.15.15.1.m1.1.1.3.2.3">𝐺</ci></apply><ci id="algorithm1.15.15.1.m1.1.1.3.3.cmml" xref="algorithm1.15.15.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.1.m1.1c">v_{j}\in T^{G}_{k}</annotation></semantics></math></em><span id="algorithm1.15.15.8" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.15.15.9" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.16.16.1.1.1" class="ltx_text" style="font-size:90%;">12</span></span><span id="algorithm1.16.16.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.16.16.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.16.16.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.16.16.5" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.16.16.m1.2" class="ltx_Math" alttext="h_{j}\leftarrow\text{Comb}(h_{j},\text{Agg}\{m_{e}(h_{j},h_{i}):A_{ji}=1\})" display="inline"><semantics id="algorithm1.16.16.m1.2a"><mrow id="algorithm1.16.16.m1.2.2" xref="algorithm1.16.16.m1.2.2.cmml"><msub id="algorithm1.16.16.m1.2.2.4" xref="algorithm1.16.16.m1.2.2.4.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.4.2" xref="algorithm1.16.16.m1.2.2.4.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.4.3" xref="algorithm1.16.16.m1.2.2.4.3.cmml">j</mi></msub><mo mathsize="90%" stretchy="false" id="algorithm1.16.16.m1.2.2.3" xref="algorithm1.16.16.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.16.16.m1.2.2.2" xref="algorithm1.16.16.m1.2.2.2.cmml"><mtext mathsize="90%" id="algorithm1.16.16.m1.2.2.2.4" xref="algorithm1.16.16.m1.2.2.2.4a.cmml">Comb</mtext><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.16.16.m1.1.1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.16.16.m1.1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.4" xref="algorithm1.16.16.m1.2.2.2.2.3.cmml">,</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.cmml"><mtext mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.4" xref="algorithm1.16.16.m1.2.2.2.2.2.2.4a.cmml">Agg</mtext><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.1.cmml">{</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.cmml"><msub id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.2.cmml">m</mi><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">(</mo><msub id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.4" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">,</mo><msub id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml">h</mi><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.278em" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.5" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.278em" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.4" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.cmml"><msub id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.2.cmml">A</mi><mrow id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.1" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.3.cmml">i</mi></mrow></msub><mo mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.1" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.1.cmml">=</mo><mn mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.5" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.1.cmml">}</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.5" xref="algorithm1.16.16.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.2b"><apply id="algorithm1.16.16.m1.2.2.cmml" xref="algorithm1.16.16.m1.2.2"><ci id="algorithm1.16.16.m1.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.3">←</ci><apply id="algorithm1.16.16.m1.2.2.4.cmml" xref="algorithm1.16.16.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.4.1.cmml" xref="algorithm1.16.16.m1.2.2.4">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.4.2.cmml" xref="algorithm1.16.16.m1.2.2.4.2">ℎ</ci><ci id="algorithm1.16.16.m1.2.2.4.3.cmml" xref="algorithm1.16.16.m1.2.2.4.3">𝑗</ci></apply><apply id="algorithm1.16.16.m1.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2"><times id="algorithm1.16.16.m1.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.3"></times><ci id="algorithm1.16.16.m1.2.2.2.4a.cmml" xref="algorithm1.16.16.m1.2.2.2.4"><mtext mathsize="90%" id="algorithm1.16.16.m1.2.2.2.4.cmml" xref="algorithm1.16.16.m1.2.2.2.4">Comb</mtext></ci><interval closure="open" id="algorithm1.16.16.m1.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2"><apply id="algorithm1.16.16.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.2">ℎ</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2"><times id="algorithm1.16.16.m1.2.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.3"></times><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.4a.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.4"><mtext mathsize="90%" id="algorithm1.16.16.m1.2.2.2.2.2.2.4.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.4">Agg</mtext></ci><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2"><csymbol cd="latexml" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1"><times id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.3"></times><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.2">𝑚</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.4.3">𝑒</ci></apply><interval closure="open" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2"><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.2">ℎ</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2">ℎ</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2"><eq id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.1"></eq><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.2">𝐴</ci><apply id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3"><times id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.1"></times><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.2">𝑗</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2.2.2.2.3">1</cn></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.2c">h_{j}\leftarrow\text{Comb}(h_{j},\text{Agg}\{m_{e}(h_{j},h_{i}):A_{ji}=1\})</annotation></semantics></math><span id="algorithm1.16.16.6" class="ltx_text" style="font-size:90%;"> 
</span>
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.17.17.1.1.1" class="ltx_text" style="font-size:90%;">13</span></span><span id="algorithm1.17.17.2" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="algorithm1.17.17.3" class="ltx_text" style="font-size:90%;"> </span><math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="algorithm1.17.17.m1.1a"><mi mathsize="90%" id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><ci id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">H</annotation></semantics></math><span id="algorithm1.17.17.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.17.21" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.21.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span><span id="algorithm1.22.2" class="ltx_text">Flow encode module</span></figcaption>
</figure>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Flow encode module</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">As discussed in <a href="#S3.SS1" title="3.1 Motivation of capturing information flows ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>, we aim to enable a GT to capture the crucial aspect of neural architectures—<span id="S3.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_italic">information flows</span>. To this end, the flow encode module conducts both asynchronous forward and backward message passing, resembling the forward pass (i.e., inference) and backpropagation (i.e., training) of neural architectures, respectively.
These message-passing procedures are carried out in the (reversed) topological order in the input neural architecture graph, leading to updated node embeddings.</p>
</div>
<div id="S3.SS3.SSS1.p2" class="ltx_para">
<p id="S3.SS3.SSS1.p2.1" class="ltx_p">Pseudocode of the flow encode module is presented in <a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
It includes topological sorting, forward message passing, and backward message passing, in order, and each of these components is described below.</p>
</div>
<div id="S3.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p3.8" class="ltx_p"><span id="S3.SS3.SSS1.p3.8.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Topological sorting (<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>):</span>
The first step is to divide nodes (i.e., operations) into topological generations.
Recall that neural-architecture graphs are directed acyclic graphs (DAGs).
Given a DAG <math id="S3.SS3.SSS1.p3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><mi id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><ci id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">G</annotation></semantics></math>, its first topological generation, denoted as <math id="S3.SS3.SSS1.p3.2.m2.1" class="ltx_Math" alttext="T^{G}_{1}" display="inline"><semantics id="S3.SS3.SSS1.p3.2.m2.1a"><msubsup id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p3.2.m2.1.1.2.2" xref="S3.SS3.SSS1.p3.2.m2.1.1.2.2.cmml">T</mi><mn id="S3.SS3.SSS1.p3.2.m2.1.1.3" xref="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml">1</mn><mi id="S3.SS3.SSS1.p3.2.m2.1.1.2.3" xref="S3.SS3.SSS1.p3.2.m2.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.2.m2.1b"><apply id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.2.2">𝑇</ci><ci id="S3.SS3.SSS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">T^{G}_{1}</annotation></semantics></math>, comprises the nodes without incoming edges in <math id="S3.SS3.SSS1.p3.3.m3.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.SSS1.p3.3.m3.1a"><mi id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.3.m3.1b"><ci id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">G</annotation></semantics></math>.
Then, for each <math id="S3.SS3.SSS1.p3.4.m4.1" class="ltx_Math" alttext="k&gt;1" display="inline"><semantics id="S3.SS3.SSS1.p3.4.m4.1a"><mrow id="S3.SS3.SSS1.p3.4.m4.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.1.1.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml">k</mi><mo id="S3.SS3.SSS1.p3.4.m4.1.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.SSS1.p3.4.m4.1.1.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.4.m4.1b"><apply id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1"><gt id="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.1"></gt><ci id="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2">𝑘</ci><cn type="integer" id="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.1c">k&gt;1</annotation></semantics></math>, the <math id="S3.SS3.SSS1.p3.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSS1.p3.5.m5.1a"><mi id="S3.SS3.SSS1.p3.5.m5.1.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.5.m5.1b"><ci id="S3.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.5.m5.1c">k</annotation></semantics></math>-th topological generation <math id="S3.SS3.SSS1.p3.6.m6.1" class="ltx_Math" alttext="T^{G}_{k}" display="inline"><semantics id="S3.SS3.SSS1.p3.6.m6.1a"><msubsup id="S3.SS3.SSS1.p3.6.m6.1.1" xref="S3.SS3.SSS1.p3.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.p3.6.m6.1.1.2.2" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.2.cmml">T</mi><mi id="S3.SS3.SSS1.p3.6.m6.1.1.3" xref="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml">k</mi><mi id="S3.SS3.SSS1.p3.6.m6.1.1.2.3" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.6.m6.1b"><apply id="S3.SS3.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.2">𝑇</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.3">𝐺</ci></apply><ci id="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.6.m6.1c">T^{G}_{k}</annotation></semantics></math> comprises the nodes without incoming edges when all preceding generations are removed from <math id="S3.SS3.SSS1.p3.7.m7.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.SSS1.p3.7.m7.1a"><mi id="S3.SS3.SSS1.p3.7.m7.1.1" xref="S3.SS3.SSS1.p3.7.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.7.m7.1b"><ci id="S3.SS3.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.7.m7.1c">G</annotation></semantics></math>.
The set of non-empty topological generations is denoted as <math id="S3.SS3.SSS1.p3.8.m8.4" class="ltx_Math" alttext="\mathcal{T}^{G}:=\{T_{1}^{G},\dots,T_{|\mathcal{T}^{G}|}^{G}\}" display="inline"><semantics id="S3.SS3.SSS1.p3.8.m8.4a"><mrow id="S3.SS3.SSS1.p3.8.m8.4.4" xref="S3.SS3.SSS1.p3.8.m8.4.4.cmml"><msup id="S3.SS3.SSS1.p3.8.m8.4.4.4" xref="S3.SS3.SSS1.p3.8.m8.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p3.8.m8.4.4.4.2" xref="S3.SS3.SSS1.p3.8.m8.4.4.4.2.cmml">𝒯</mi><mi id="S3.SS3.SSS1.p3.8.m8.4.4.4.3" xref="S3.SS3.SSS1.p3.8.m8.4.4.4.3.cmml">G</mi></msup><mo lspace="0.278em" rspace="0.278em" id="S3.SS3.SSS1.p3.8.m8.4.4.3" xref="S3.SS3.SSS1.p3.8.m8.4.4.3.cmml">:=</mo><mrow id="S3.SS3.SSS1.p3.8.m8.4.4.2.2" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.3" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml">{</mo><msubsup id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.2" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.2.cmml">T</mi><mn id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.3" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.3" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.3.cmml">G</mi></msubsup><mo id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.4" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.SSS1.p3.8.m8.2.2" xref="S3.SS3.SSS1.p3.8.m8.2.2.cmml">…</mi><mo id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.5" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.cmml"><mi id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.2" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.2.cmml">T</mi><mrow id="S3.SS3.SSS1.p3.8.m8.1.1.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.2" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.2.1.cmml">|</mo><msup id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.2" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.3" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.3.cmml">G</mi></msup><mo stretchy="false" id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.3" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.3" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.3.cmml">G</mi></msubsup><mo stretchy="false" id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.6" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.8.m8.4b"><apply id="S3.SS3.SSS1.p3.8.m8.4.4.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4"><csymbol cd="latexml" id="S3.SS3.SSS1.p3.8.m8.4.4.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.3">assign</csymbol><apply id="S3.SS3.SSS1.p3.8.m8.4.4.4.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.4.4.4.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.4">superscript</csymbol><ci id="S3.SS3.SSS1.p3.8.m8.4.4.4.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.4.2">𝒯</ci><ci id="S3.SS3.SSS1.p3.8.m8.4.4.4.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.4.3">𝐺</ci></apply><set id="S3.SS3.SSS1.p3.8.m8.4.4.2.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2"><apply id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.2">𝑇</ci><cn type="integer" id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.3.3.1.1.1.3">𝐺</ci></apply><ci id="S3.SS3.SSS1.p3.8.m8.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.2.2">…</ci><apply id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.2.2">𝑇</ci><apply id="S3.SS3.SSS1.p3.8.m8.1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1"><abs id="S3.SS3.SSS1.p3.8.m8.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.2"></abs><apply id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.2">𝒯</ci><ci id="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1.1.1.1.3">𝐺</ci></apply></apply></apply><ci id="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.3.cmml" xref="S3.SS3.SSS1.p3.8.m8.4.4.2.2.2.3">𝐺</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.8.m8.4c">\mathcal{T}^{G}:=\{T_{1}^{G},\dots,T_{|\mathcal{T}^{G}|}^{G}\}</annotation></semantics></math>. Refer to <a href="#S3.F4" title="In 3.3.1 Flow encode module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a> for an example.</p>
</div>
<div id="S3.SS3.SSS1.p4" class="ltx_para">
<p id="S3.SS3.SSS1.p4.1" class="ltx_p">These topological generations are closely related to the data flow within a neural architecture. For the operations (i.e., nodes) in each generation to be executed, all operations in the preceding generations need to be complete.
Conversely, during the process of backpropagation, gradients flow from subsequent generations to preceding generations.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2403.12821/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="128" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.4.2" class="ltx_text" style="font-size:90%;">Example topological generations.
Nodes 1 and 2 are devoid of incoming edges, and thus they constitute the first topological generation <math id="S3.F4.3.1.m1.1" class="ltx_Math" alttext="T^{G}_{1}" display="inline"><semantics id="S3.F4.3.1.m1.1b"><msubsup id="S3.F4.3.1.m1.1.1" xref="S3.F4.3.1.m1.1.1.cmml"><mi id="S3.F4.3.1.m1.1.1.2.2" xref="S3.F4.3.1.m1.1.1.2.2.cmml">T</mi><mn id="S3.F4.3.1.m1.1.1.3" xref="S3.F4.3.1.m1.1.1.3.cmml">1</mn><mi id="S3.F4.3.1.m1.1.1.2.3" xref="S3.F4.3.1.m1.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F4.3.1.m1.1c"><apply id="S3.F4.3.1.m1.1.1.cmml" xref="S3.F4.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.3.1.m1.1.1.1.cmml" xref="S3.F4.3.1.m1.1.1">subscript</csymbol><apply id="S3.F4.3.1.m1.1.1.2.cmml" xref="S3.F4.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.3.1.m1.1.1.2.1.cmml" xref="S3.F4.3.1.m1.1.1">superscript</csymbol><ci id="S3.F4.3.1.m1.1.1.2.2.cmml" xref="S3.F4.3.1.m1.1.1.2.2">𝑇</ci><ci id="S3.F4.3.1.m1.1.1.2.3.cmml" xref="S3.F4.3.1.m1.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S3.F4.3.1.m1.1.1.3.cmml" xref="S3.F4.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.3.1.m1.1d">T^{G}_{1}</annotation></semantics></math>.
Upon removal of nodes 1 and 2, nodes 3, 4, and 5 no longer have incoming edges, and thus they compose the second generation <math id="S3.F4.4.2.m2.1" class="ltx_Math" alttext="T^{G}_{2}" display="inline"><semantics id="S3.F4.4.2.m2.1b"><msubsup id="S3.F4.4.2.m2.1.1" xref="S3.F4.4.2.m2.1.1.cmml"><mi id="S3.F4.4.2.m2.1.1.2.2" xref="S3.F4.4.2.m2.1.1.2.2.cmml">T</mi><mn id="S3.F4.4.2.m2.1.1.3" xref="S3.F4.4.2.m2.1.1.3.cmml">2</mn><mi id="S3.F4.4.2.m2.1.1.2.3" xref="S3.F4.4.2.m2.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F4.4.2.m2.1c"><apply id="S3.F4.4.2.m2.1.1.cmml" xref="S3.F4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.4.2.m2.1.1.1.cmml" xref="S3.F4.4.2.m2.1.1">subscript</csymbol><apply id="S3.F4.4.2.m2.1.1.2.cmml" xref="S3.F4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.4.2.m2.1.1.2.1.cmml" xref="S3.F4.4.2.m2.1.1">superscript</csymbol><ci id="S3.F4.4.2.m2.1.1.2.2.cmml" xref="S3.F4.4.2.m2.1.1.2.2">𝑇</ci><ci id="S3.F4.4.2.m2.1.1.2.3.cmml" xref="S3.F4.4.2.m2.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S3.F4.4.2.m2.1.1.3.cmml" xref="S3.F4.4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.2.m2.1d">T^{G}_{2}</annotation></semantics></math>.
Subsequently, nodes 6 and 7 form the third and fourth generations, respectively.</span></figcaption>
</figure>
<div id="S3.SS3.SSS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p5.7" class="ltx_p"><span id="S3.SS3.SSS1.p5.7.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Forward message passing (<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>):</span>
During the forward message passing step, node embeddings are updated asynchronously, following the order of the topological generations, akin to the forward pass within neural architectures.
For each node <math id="S3.SS3.SSS1.p5.1.m1.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS3.SSS1.p5.1.m1.1a"><msub id="S3.SS3.SSS1.p5.1.m1.1.1" xref="S3.SS3.SSS1.p5.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p5.1.m1.1.1.2" xref="S3.SS3.SSS1.p5.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS1.p5.1.m1.1.1.3" xref="S3.SS3.SSS1.p5.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.1.m1.1b"><apply id="S3.SS3.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1.2">𝑣</ci><ci id="S3.SS3.SSS1.p5.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.1.m1.1c">v_{j}</annotation></semantics></math>, its embedding <math id="S3.SS3.SSS1.p5.2.m2.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS3.SSS1.p5.2.m2.1a"><msub id="S3.SS3.SSS1.p5.2.m2.1.1" xref="S3.SS3.SSS1.p5.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p5.2.m2.1.1.2" xref="S3.SS3.SSS1.p5.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p5.2.m2.1.1.3" xref="S3.SS3.SSS1.p5.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.2.m2.1b"><apply id="S3.SS3.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p5.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.2.m2.1c">h_{j}</annotation></semantics></math> (i.e., the <math id="S3.SS3.SSS1.p5.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.SSS1.p5.3.m3.1a"><mi id="S3.SS3.SSS1.p5.3.m3.1.1" xref="S3.SS3.SSS1.p5.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.3.m3.1b"><ci id="S3.SS3.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p5.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.3.m3.1c">j</annotation></semantics></math>-th row vector of <math id="S3.SS3.SSS1.p5.4.m4.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS3.SSS1.p5.4.m4.1a"><mi id="S3.SS3.SSS1.p5.4.m4.1.1" xref="S3.SS3.SSS1.p5.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.4.m4.1b"><ci id="S3.SS3.SSS1.p5.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p5.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.4.m4.1c">H</annotation></semantics></math>) is updated by the following three steps: (1) computing the message <math id="S3.SS3.SSS1.p5.5.m5.2" class="ltx_Math" alttext="m_{e}(h_{j},h_{i})" display="inline"><semantics id="S3.SS3.SSS1.p5.5.m5.2a"><mrow id="S3.SS3.SSS1.p5.5.m5.2.2" xref="S3.SS3.SSS1.p5.5.m5.2.2.cmml"><msub id="S3.SS3.SSS1.p5.5.m5.2.2.4" xref="S3.SS3.SSS1.p5.5.m5.2.2.4.cmml"><mi id="S3.SS3.SSS1.p5.5.m5.2.2.4.2" xref="S3.SS3.SSS1.p5.5.m5.2.2.4.2.cmml">m</mi><mi id="S3.SS3.SSS1.p5.5.m5.2.2.4.3" xref="S3.SS3.SSS1.p5.5.m5.2.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p5.5.m5.2.2.3" xref="S3.SS3.SSS1.p5.5.m5.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS1.p5.5.m5.2.2.2.2" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.3" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.2" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.3" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.4" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.2" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.2.cmml">h</mi><mi id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.3" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.5" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.5.m5.2b"><apply id="S3.SS3.SSS1.p5.5.m5.2.2.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2"><times id="S3.SS3.SSS1.p5.5.m5.2.2.3.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.3"></times><apply id="S3.SS3.SSS1.p5.5.m5.2.2.4.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.5.m5.2.2.4.1.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.p5.5.m5.2.2.4.2.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.4.2">𝑚</ci><ci id="S3.SS3.SSS1.p5.5.m5.2.2.4.3.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.4.3">𝑒</ci></apply><interval closure="open" id="S3.SS3.SSS1.p5.5.m5.2.2.2.3.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2"><apply id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p5.5.m5.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.2">ℎ</ci><ci id="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p5.5.m5.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.5.m5.2c">m_{e}(h_{j},h_{i})</annotation></semantics></math> for each incoming neighbor <math id="S3.SS3.SSS1.p5.6.m6.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS3.SSS1.p5.6.m6.1a"><msub id="S3.SS3.SSS1.p5.6.m6.1.1" xref="S3.SS3.SSS1.p5.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.p5.6.m6.1.1.2" xref="S3.SS3.SSS1.p5.6.m6.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS1.p5.6.m6.1.1.3" xref="S3.SS3.SSS1.p5.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.6.m6.1b"><apply id="S3.SS3.SSS1.p5.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p5.6.m6.1.1.2">𝑣</ci><ci id="S3.SS3.SSS1.p5.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.p5.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.6.m6.1c">v_{i}</annotation></semantics></math>, (2) aggregating these messages, and (3) combining the result with the current embedding <math id="S3.SS3.SSS1.p5.7.m7.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS3.SSS1.p5.7.m7.1a"><msub id="S3.SS3.SSS1.p5.7.m7.1.1" xref="S3.SS3.SSS1.p5.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.p5.7.m7.1.1.2" xref="S3.SS3.SSS1.p5.7.m7.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p5.7.m7.1.1.3" xref="S3.SS3.SSS1.p5.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.7.m7.1b"><apply id="S3.SS3.SSS1.p5.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p5.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.p5.7.m7.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p5.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.p5.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.7.m7.1c">h_{j}</annotation></semantics></math> (<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>).
Note that the embeddings of all incoming neighbors, which belong to preceding generations, have already been updated by the time message calculation occurs.
Also note that this differs from conventional synchronous graph message passing, where all node embeddings are updated simultaneously based on their input embeddings.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2403.12821/assets/x5.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="363" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S3.F5.3.2" class="ltx_text" style="font-size:90%;">Flow encode module. During forward message passing, node embeddings are updated following the order of topological generations. Conversely, during backward message passing, node embeddings are updated in the reverse order of the generations.</span></figcaption>
</figure>
<div id="S3.SS3.SSS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p6.3" class="ltx_p">In our implementation, we use the sum aggregation as the <math id="S3.SS3.SSS1.p6.1.m1.1" class="ltx_Math" alttext="\operatorname{Agg}" display="inline"><semantics id="S3.SS3.SSS1.p6.1.m1.1a"><mi id="S3.SS3.SSS1.p6.1.m1.1.1" xref="S3.SS3.SSS1.p6.1.m1.1.1.cmml">Agg</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.1.m1.1b"><ci id="S3.SS3.SSS1.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p6.1.m1.1.1">Agg</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.1.m1.1c">\operatorname{Agg}</annotation></semantics></math> function. As <math id="S3.SS3.SSS1.p6.2.m2.1" class="ltx_Math" alttext="m_{e}" display="inline"><semantics id="S3.SS3.SSS1.p6.2.m2.1a"><msub id="S3.SS3.SSS1.p6.2.m2.1.1" xref="S3.SS3.SSS1.p6.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p6.2.m2.1.1.2" xref="S3.SS3.SSS1.p6.2.m2.1.1.2.cmml">m</mi><mi id="S3.SS3.SSS1.p6.2.m2.1.1.3" xref="S3.SS3.SSS1.p6.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.2.m2.1b"><apply id="S3.SS3.SSS1.p6.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p6.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p6.2.m2.1.1.2">𝑚</ci><ci id="S3.SS3.SSS1.p6.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p6.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.2.m2.1c">m_{e}</annotation></semantics></math> and <math id="S3.SS3.SSS1.p6.3.m3.1" class="ltx_Math" alttext="\operatorname{Comb}" display="inline"><semantics id="S3.SS3.SSS1.p6.3.m3.1a"><mi id="S3.SS3.SSS1.p6.3.m3.1.1" xref="S3.SS3.SSS1.p6.3.m3.1.1.cmml">Comb</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.3.m3.1b"><ci id="S3.SS3.SSS1.p6.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p6.3.m3.1.1">Comb</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.3.m3.1c">\operatorname{Comb}</annotation></semantics></math>, we adopt the message function and the combine operator used in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>, as follows:</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\displaystyle m_{e}(h_{j},h_{i})=\operatorname{softmax}(w^{\top}_{1}h_{j}+w^{\top}_{2}h_{i})h_{i}," display="inline"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.2.4" xref="S3.E1.m1.2.2.1.1.2.4.cmml"><mi id="S3.E1.m1.2.2.1.1.2.4.2" xref="S3.E1.m1.2.2.1.1.2.4.2.cmml">m</mi><mi id="S3.E1.m1.2.2.1.1.2.4.3" xref="S3.E1.m1.2.2.1.1.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E1.m1.2.2.1.1.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.2.2.1.1.2.2.2.5" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.4" xref="S3.E1.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mrow id="S3.E1.m1.2.2.1.1.3.1.1" xref="S3.E1.m1.2.2.1.1.3.1.2.cmml"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">softmax</mi><mo id="S3.E1.m1.2.2.1.1.3.1.1a" xref="S3.E1.m1.2.2.1.1.3.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.1.1.3.1.1.1" xref="S3.E1.m1.2.2.1.1.3.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.1.1.1.2" xref="S3.E1.m1.2.2.1.1.3.1.2.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.3.1.1.1.1" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.2.cmml">w</mi><mn id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.3.cmml">1</mn><mo id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.1" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E1.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.1.cmml">+</mo><mrow id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.cmml"><msubsup id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.2.cmml">w</mi><mn id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.3.cmml">2</mn><mo id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.1" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.1.1.1.3" xref="S3.E1.m1.2.2.1.1.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">​</mo><msub id="S3.E1.m1.2.2.1.1.3.3" xref="S3.E1.m1.2.2.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.3.3.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.4"></eq><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><times id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3"></times><apply id="S3.E1.m1.2.2.1.1.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2">𝑚</ci><ci id="S3.E1.m1.2.2.1.1.2.4.3.cmml" xref="S3.E1.m1.2.2.1.1.2.4.3">𝑒</ci></apply><interval closure="open" id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><times id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2"></times><apply id="S3.E1.m1.2.2.1.1.3.1.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">softmax</ci><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1"><plus id="S3.E1.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.1"></plus><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2"><times id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.1"></times><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.2">𝑤</ci><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.2.3">top</csymbol></apply><cn type="integer" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.2.3">1</cn></apply><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3"><times id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.1"></times><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.2">𝑤</ci><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.2.3">top</csymbol></apply><cn type="integer" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.3.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\displaystyle m_{e}(h_{j},h_{i})=\operatorname{softmax}(w^{\top}_{1}h_{j}+w^{\top}_{2}h_{i})h_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname{msg}_{j}=\Sigma_{i:A_{ij}=1}m_{e}(h_{j},h_{i})," display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml">msg</mi><mi id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml">j</mi></msub><mo id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.2.4.2" xref="S3.E2.m1.1.1.1.1.2.4.2.cmml">Σ</mi><mrow id="S3.E2.m1.1.1.1.1.2.4.3" xref="S3.E2.m1.1.1.1.1.2.4.3.cmml"><mi id="S3.E2.m1.1.1.1.1.2.4.3.2" xref="S3.E2.m1.1.1.1.1.2.4.3.2.cmml">i</mi><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m1.1.1.1.1.2.4.3.1" xref="S3.E2.m1.1.1.1.1.2.4.3.1.cmml">:</mo><mrow id="S3.E2.m1.1.1.1.1.2.4.3.3" xref="S3.E2.m1.1.1.1.1.2.4.3.3.cmml"><msub id="S3.E2.m1.1.1.1.1.2.4.3.3.2" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.4.3.3.2.2" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.2.cmml">A</mi><mrow id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.2" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.1" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.3" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.2.4.3.3.1" xref="S3.E2.m1.1.1.1.1.2.4.3.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.1.2.4.3.3.3" xref="S3.E2.m1.1.1.1.1.2.4.3.3.3.cmml">1</mn></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.2.5" xref="S3.E2.m1.1.1.1.1.2.5.cmml"><mi id="S3.E2.m1.1.1.1.1.2.5.2" xref="S3.E2.m1.1.1.1.1.2.5.2.cmml">m</mi><mi id="S3.E2.m1.1.1.1.1.2.5.3" xref="S3.E2.m1.1.1.1.1.2.5.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3a" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E2.m1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.5" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"></eq><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2">msg</ci><ci id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3">𝑗</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3"></times><apply id="S3.E2.m1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.4.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.2">Σ</ci><apply id="S3.E2.m1.1.1.1.1.2.4.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3"><ci id="S3.E2.m1.1.1.1.1.2.4.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.1">:</ci><ci id="S3.E2.m1.1.1.1.1.2.4.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.2">𝑖</ci><apply id="S3.E2.m1.1.1.1.1.2.4.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3"><eq id="S3.E2.m1.1.1.1.1.2.4.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.1"></eq><apply id="S3.E2.m1.1.1.1.1.2.4.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.4.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.4.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.2">𝐴</ci><apply id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3"><times id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.2">𝑖</ci><ci id="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.2.4.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.3.3.3">1</cn></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.5.cmml" xref="S3.E2.m1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.5.1.cmml" xref="S3.E2.m1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.5.2.cmml" xref="S3.E2.m1.1.1.1.1.2.5.2">𝑚</ci><ci id="S3.E2.m1.1.1.1.1.2.5.3.cmml" xref="S3.E2.m1.1.1.1.1.2.5.3">𝑒</ci></apply><interval closure="open" id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\operatorname{msg}_{j}=\Sigma_{i:A_{ij}=1}m_{e}(h_{j},h_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\displaystyle\operatorname{Comb}(h_{j},\operatorname{msg}_{j})=\operatorname{GRU}(h_{j},\operatorname{msg}_{j})," display="inline"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">Comb</mi><mo id="S3.E3.m1.3.3.1.1.2.2a" xref="S3.E3.m1.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.1.1.2.2.2.4" xref="S3.E3.m1.3.3.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.cmml">msg</mi><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.5" xref="S3.E3.m1.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.1.1.5" xref="S3.E3.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.4.2" xref="S3.E3.m1.3.3.1.1.4.3.cmml"><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">GRU</mi><mo id="S3.E3.m1.3.3.1.1.4.2a" xref="S3.E3.m1.3.3.1.1.4.3.cmml">⁡</mo><mrow id="S3.E3.m1.3.3.1.1.4.2.2" xref="S3.E3.m1.3.3.1.1.4.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.4.2.2.3" xref="S3.E3.m1.3.3.1.1.4.3.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.3.1.1.1" xref="S3.E3.m1.3.3.1.1.3.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.3.1.1.1.2.cmml">h</mi><mi id="S3.E3.m1.3.3.1.1.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.3.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.1.1.4.2.2.4" xref="S3.E3.m1.3.3.1.1.4.3.cmml">,</mo><msub id="S3.E3.m1.3.3.1.1.4.2.2.2" xref="S3.E3.m1.3.3.1.1.4.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.4.2.2.2.2" xref="S3.E3.m1.3.3.1.1.4.2.2.2.2.cmml">msg</mi><mi id="S3.E3.m1.3.3.1.1.4.2.2.2.3" xref="S3.E3.m1.3.3.1.1.4.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.4.2.2.5" xref="S3.E3.m1.3.3.1.1.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.5.cmml" xref="S3.E3.m1.3.3.1.1.5"></eq><apply id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">Comb</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2">msg</ci><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.4.2"><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">GRU</ci><apply id="S3.E3.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.3.1.1.1.2">ℎ</ci><ci id="S3.E3.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3.1.1.1.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.2.2">msg</ci><ci id="S3.E3.m1.3.3.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle\operatorname{Comb}(h_{j},\operatorname{msg}_{j})=\operatorname{GRU}(h_{j},\operatorname{msg}_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p6.5" class="ltx_p">where <math id="S3.SS3.SSS1.p6.4.m1.1" class="ltx_Math" alttext="w_{1}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS3.SSS1.p6.4.m1.1a"><mrow id="S3.SS3.SSS1.p6.4.m1.1.1" xref="S3.SS3.SSS1.p6.4.m1.1.1.cmml"><msub id="S3.SS3.SSS1.p6.4.m1.1.1.2" xref="S3.SS3.SSS1.p6.4.m1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p6.4.m1.1.1.2.2" xref="S3.SS3.SSS1.p6.4.m1.1.1.2.2.cmml">w</mi><mn id="S3.SS3.SSS1.p6.4.m1.1.1.2.3" xref="S3.SS3.SSS1.p6.4.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p6.4.m1.1.1.1" xref="S3.SS3.SSS1.p6.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p6.4.m1.1.1.3" xref="S3.SS3.SSS1.p6.4.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p6.4.m1.1.1.3.2" xref="S3.SS3.SSS1.p6.4.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p6.4.m1.1.1.3.3" xref="S3.SS3.SSS1.p6.4.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.4.m1.1b"><apply id="S3.SS3.SSS1.p6.4.m1.1.1.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1"><in id="S3.SS3.SSS1.p6.4.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.1"></in><apply id="S3.SS3.SSS1.p6.4.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.4.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p6.4.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.2.2">𝑤</ci><cn type="integer" id="S3.SS3.SSS1.p6.4.m1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.2.3">1</cn></apply><apply id="S3.SS3.SSS1.p6.4.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.4.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p6.4.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p6.4.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p6.4.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.4.m1.1c">w_{1}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="S3.SS3.SSS1.p6.5.m2.1" class="ltx_Math" alttext="w_{2}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS3.SSS1.p6.5.m2.1a"><mrow id="S3.SS3.SSS1.p6.5.m2.1.1" xref="S3.SS3.SSS1.p6.5.m2.1.1.cmml"><msub id="S3.SS3.SSS1.p6.5.m2.1.1.2" xref="S3.SS3.SSS1.p6.5.m2.1.1.2.cmml"><mi id="S3.SS3.SSS1.p6.5.m2.1.1.2.2" xref="S3.SS3.SSS1.p6.5.m2.1.1.2.2.cmml">w</mi><mn id="S3.SS3.SSS1.p6.5.m2.1.1.2.3" xref="S3.SS3.SSS1.p6.5.m2.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p6.5.m2.1.1.1" xref="S3.SS3.SSS1.p6.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p6.5.m2.1.1.3" xref="S3.SS3.SSS1.p6.5.m2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p6.5.m2.1.1.3.2" xref="S3.SS3.SSS1.p6.5.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p6.5.m2.1.1.3.3" xref="S3.SS3.SSS1.p6.5.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.5.m2.1b"><apply id="S3.SS3.SSS1.p6.5.m2.1.1.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1"><in id="S3.SS3.SSS1.p6.5.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.1"></in><apply id="S3.SS3.SSS1.p6.5.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.5.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p6.5.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.2.2">𝑤</ci><cn type="integer" id="S3.SS3.SSS1.p6.5.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.2.3">2</cn></apply><apply id="S3.SS3.SSS1.p6.5.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.5.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p6.5.m2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p6.5.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p6.5.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.5.m2.1c">w_{2}\in\mathbb{R}^{d}</annotation></semantics></math> are learnable parameters.</p>
</div>
<div id="S3.SS3.SSS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p7.1" class="ltx_p"><span id="S3.SS3.SSS1.p7.1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Backward message passing (<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>):</span>
After the forward message passing step, we further update node embeddings through backward message passing, which resembles the process of backpropagation. This aligns with the standard practice in neural architecture training, where backpropagation typically occurs after the forward pass for loss computation.</p>
</div>
<div id="S3.SS3.SSS1.p8" class="ltx_para">
<p id="S3.SS3.SSS1.p8.1" class="ltx_p">During the backward message passing step, node embeddings are updated asynchronously, following the reverse order of the topological generations.
For each node <math id="S3.SS3.SSS1.p8.1.m1.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS3.SSS1.p8.1.m1.1a"><msub id="S3.SS3.SSS1.p8.1.m1.1.1" xref="S3.SS3.SSS1.p8.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p8.1.m1.1.1.2" xref="S3.SS3.SSS1.p8.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS1.p8.1.m1.1.1.3" xref="S3.SS3.SSS1.p8.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p8.1.m1.1b"><apply id="S3.SS3.SSS1.p8.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p8.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p8.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p8.1.m1.1.1.2">𝑣</ci><ci id="S3.SS3.SSS1.p8.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p8.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p8.1.m1.1c">v_{j}</annotation></semantics></math>, the messages from its outgoing neighbors (rather than incoming neighbors) are computed and then aggregated (<a href="#algorithm1" title="In 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>). The other details remain consistent with those of the forward message passing in to <a href="#S3.E1" title="In 3.3.1 Flow encode module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, <a href="#S3.E2" title="In 3.3.1 Flow encode module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, and <a href="#S3.E3" title="In 3.3.1 Flow encode module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS3.SSS1.p9" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS1.p9.2" class="ltx_p"><span id="S3.SS3.SSS1.p9.2.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Outputs:</span>
We denote
the output node-embedding matrix of the flow encode module in the <math id="S3.SS3.SSS1.p9.1.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS3.SSS1.p9.1.m1.1a"><mi mathvariant="normal" id="S3.SS3.SSS1.p9.1.m1.1.1" xref="S3.SS3.SSS1.p9.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p9.1.m1.1b"><ci id="S3.SS3.SSS1.p9.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p9.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p9.1.m1.1c">\ell</annotation></semantics></math>-th <span id="S3.SS3.SSS1.p9.2.2" class="ltx_text ltx_font_smallcaps">Flower</span> layer, as <math id="S3.SS3.SSS1.p9.2.m2.1" class="ltx_Math" alttext="H^{(\ell)}_{flow}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.SSS1.p9.2.m2.1a"><mrow id="S3.SS3.SSS1.p9.2.m2.1.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.cmml"><msubsup id="S3.SS3.SSS1.p9.2.m2.1.2.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.cmml"><mi id="S3.SS3.SSS1.p9.2.m2.1.2.2.2.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.2.2.cmml">H</mi><mrow id="S3.SS3.SSS1.p9.2.m2.1.2.2.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.cmml"><mi id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1a" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.4" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1b" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.5" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.5.cmml">w</mi></mrow><mrow id="S3.SS3.SSS1.p9.2.m2.1.1.1.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p9.2.m2.1.1.1.3.1" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS3.SSS1.p9.2.m2.1.1.1.1" xref="S3.SS3.SSS1.p9.2.m2.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS3.SSS1.p9.2.m2.1.1.1.3.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS1.p9.2.m2.1.2.1" xref="S3.SS3.SSS1.p9.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p9.2.m2.1.2.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.cmml"><mi id="S3.SS3.SSS1.p9.2.m2.1.2.3.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p9.2.m2.1.2.3.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.cmml"><mi id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.2" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.1" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.3" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p9.2.m2.1b"><apply id="S3.SS3.SSS1.p9.2.m2.1.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2"><in id="S3.SS3.SSS1.p9.2.m2.1.2.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.1"></in><apply id="S3.SS3.SSS1.p9.2.m2.1.2.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p9.2.m2.1.2.2.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2">subscript</csymbol><apply id="S3.SS3.SSS1.p9.2.m2.1.2.2.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p9.2.m2.1.2.2.2.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.p9.2.m2.1.2.2.2.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.2.2">𝐻</ci><ci id="S3.SS3.SSS1.p9.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.1.1.1">ℓ</ci></apply><apply id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3"><times id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.1"></times><ci id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.2">𝑓</ci><ci id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.3.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.3">𝑙</ci><ci id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.4.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.SSS1.p9.2.m2.1.2.2.3.5.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.2.3.5">𝑤</ci></apply></apply><apply id="S3.SS3.SSS1.p9.2.m2.1.2.3.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p9.2.m2.1.2.3.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.p9.2.m2.1.2.3.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3"><times id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.1.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.1"></times><ci id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.2.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.SSS1.p9.2.m2.1.2.3.3.3.cmml" xref="S3.SS3.SSS1.p9.2.m2.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p9.2.m2.1c">H^{(\ell)}_{flow}\in\mathbb{R}^{N\times d}</annotation></semantics></math>. That is,</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle H^{(\ell)}_{flow}" display="inline"><semantics id="S3.E4.m1.1a"><msubsup id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><mi id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml">H</mi><mrow id="S3.E4.m1.1.2.3" xref="S3.E4.m1.1.2.3.cmml"><mi id="S3.E4.m1.1.2.3.2" xref="S3.E4.m1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.2.3.1" xref="S3.E4.m1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.2.3.3" xref="S3.E4.m1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.2.3.1a" xref="S3.E4.m1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.2.3.4" xref="S3.E4.m1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.2.3.1b" xref="S3.E4.m1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.2.3.5" xref="S3.E4.m1.1.2.3.5.cmml">w</mi></mrow><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2">subscript</csymbol><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2">superscript</csymbol><ci id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2">𝐻</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">ℓ</ci></apply><apply id="S3.E4.m1.1.2.3.cmml" xref="S3.E4.m1.1.2.3"><times id="S3.E4.m1.1.2.3.1.cmml" xref="S3.E4.m1.1.2.3.1"></times><ci id="S3.E4.m1.1.2.3.2.cmml" xref="S3.E4.m1.1.2.3.2">𝑓</ci><ci id="S3.E4.m1.1.2.3.3.cmml" xref="S3.E4.m1.1.2.3.3">𝑙</ci><ci id="S3.E4.m1.1.2.3.4.cmml" xref="S3.E4.m1.1.2.3.4">𝑜</ci><ci id="S3.E4.m1.1.2.3.5.cmml" xref="S3.E4.m1.1.2.3.5">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle H^{(\ell)}_{flow}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.4" class="ltx_Math" alttext="\displaystyle=\operatorname{FlowEncoder}(G,H^{(\ell-1)})." display="inline"><semantics id="S3.E4.m2.4a"><mrow id="S3.E4.m2.4.4.1" xref="S3.E4.m2.4.4.1.1.cmml"><mrow id="S3.E4.m2.4.4.1.1" xref="S3.E4.m2.4.4.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.3" xref="S3.E4.m2.4.4.1.1.3.cmml"></mi><mo id="S3.E4.m2.4.4.1.1.2" xref="S3.E4.m2.4.4.1.1.2.cmml">=</mo><mrow id="S3.E4.m2.4.4.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.2.cmml"><mi id="S3.E4.m2.2.2" xref="S3.E4.m2.2.2.cmml">FlowEncoder</mi><mo id="S3.E4.m2.4.4.1.1.1.1a" xref="S3.E4.m2.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m2.4.4.1.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.4.4.1.1.1.1.1.2" xref="S3.E4.m2.4.4.1.1.1.2.cmml">(</mo><mi id="S3.E4.m2.3.3" xref="S3.E4.m2.3.3.cmml">G</mi><mo id="S3.E4.m2.4.4.1.1.1.1.1.3" xref="S3.E4.m2.4.4.1.1.1.2.cmml">,</mo><msup id="S3.E4.m2.4.4.1.1.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.cmml">H</mi><mrow id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E4.m2.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.2.cmml">ℓ</mi><mo id="S3.E4.m2.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E4.m2.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E4.m2.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E4.m2.4.4.1.1.1.1.1.4" xref="S3.E4.m2.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m2.4.4.1.2" xref="S3.E4.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.4b"><apply id="S3.E4.m2.4.4.1.1.cmml" xref="S3.E4.m2.4.4.1"><eq id="S3.E4.m2.4.4.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.2"></eq><csymbol cd="latexml" id="S3.E4.m2.4.4.1.1.3.cmml" xref="S3.E4.m2.4.4.1.1.3">absent</csymbol><apply id="S3.E4.m2.4.4.1.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1"><ci id="S3.E4.m2.2.2.cmml" xref="S3.E4.m2.2.2">FlowEncoder</ci><ci id="S3.E4.m2.3.3.cmml" xref="S3.E4.m2.3.3">𝐺</ci><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2">𝐻</ci><apply id="S3.E4.m2.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1"><minus id="S3.E4.m2.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1"></minus><ci id="S3.E4.m2.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.2">ℓ</ci><cn type="integer" id="S3.E4.m2.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.4c">\displaystyle=\operatorname{FlowEncoder}(G,H^{(\ell-1)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p9.4" class="ltx_p">Here, <math id="S3.SS3.SSS1.p9.3.m1.1" class="ltx_Math" alttext="H^{(\ell-1)}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.SSS1.p9.3.m1.1a"><mrow id="S3.SS3.SSS1.p9.3.m1.1.2" xref="S3.SS3.SSS1.p9.3.m1.1.2.cmml"><msup id="S3.SS3.SSS1.p9.3.m1.1.2.2" xref="S3.SS3.SSS1.p9.3.m1.1.2.2.cmml"><mi id="S3.SS3.SSS1.p9.3.m1.1.2.2.2" xref="S3.SS3.SSS1.p9.3.m1.1.2.2.2.cmml">H</mi><mrow id="S3.SS3.SSS1.p9.3.m1.1.1.1.1" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.2" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.2.cmml">ℓ</mi><mo id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.1" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.3" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS1.p9.3.m1.1.2.1" xref="S3.SS3.SSS1.p9.3.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p9.3.m1.1.2.3" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p9.3.m1.1.2.3.2" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p9.3.m1.1.2.3.3" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.cmml"><mi id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.2" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.1" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.3" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p9.3.m1.1b"><apply id="S3.SS3.SSS1.p9.3.m1.1.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2"><in id="S3.SS3.SSS1.p9.3.m1.1.2.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.1"></in><apply id="S3.SS3.SSS1.p9.3.m1.1.2.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p9.3.m1.1.2.2.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS1.p9.3.m1.1.2.2.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.2.2">𝐻</ci><apply id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1"><minus id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.1"></minus><ci id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS3.SSS1.p9.3.m1.1.2.3.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p9.3.m1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.p9.3.m1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3"><times id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.1.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.1"></times><ci id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.2.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.SSS1.p9.3.m1.1.2.3.3.3.cmml" xref="S3.SS3.SSS1.p9.3.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p9.3.m1.1c">H^{(\ell-1)}\in\mathbb{R}^{N\times d}</annotation></semantics></math> is the input node-embedding matrix obtained in layer-<math id="S3.SS3.SSS1.p9.4.m2.1" class="ltx_Math" alttext="(\ell-1)" display="inline"><semantics id="S3.SS3.SSS1.p9.4.m2.1a"><mrow id="S3.SS3.SSS1.p9.4.m2.1.1.1" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p9.4.m2.1.1.1.2" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.p9.4.m2.1.1.1.1" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.2" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.2.cmml">ℓ</mi><mo id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.1" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.3" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS1.p9.4.m2.1.1.1.3" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p9.4.m2.1b"><apply id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p9.4.m2.1.1.1"><minus id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.1"></minus><ci id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS3.SSS1.p9.4.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p9.4.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p9.4.m2.1c">(\ell-1)</annotation></semantics></math>, the previous layer (<a href="#S3.E6" title="In 3.4 Overall framework: FlowerFormer ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>).</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Flow-aware global attention module</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.2" class="ltx_p">The flow-aware global attention module is designed to capture graph-level (i.e., architecture-level) characteristics, complementing the flow encode module which primarily focuses on local-level flows between directly connected operations.
To this end, we employ a global attention mechanism of GTs; moreover, to accurately reflect the flows within architectures, we restrict attention scores to be computed only between nodes connected by at least one path of the flows.
Specifically, we employ a masking strategy <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib49" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">49</span></a>, <a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite> with a mask matrix <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="M\in\mathbb{R}^{N\times N}" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mrow id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p1.1.m1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><in id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1"></in><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">𝑀</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3"><times id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">M\in\mathbb{R}^{N\times N}</annotation></semantics></math> defined as follows (refer to <a href="#S3.F6" title="In 3.3.2 Flow-aware global attention module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a> for an example of <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">M</annotation></semantics></math>):</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.7" class="ltx_Math" alttext="M_{ij}=\begin{cases}1&amp;\text{if $v_{i}$ lies on any directed path from $v_{j}$}\\
&amp;\text{or $v_{j}$ lies on any directed path from $v_{i}$,}\\
0&amp;\text{otherwise.}\end{cases}" display="block"><semantics id="S3.Ex1.m1.7a"><mrow id="S3.Ex1.m1.7.8" xref="S3.Ex1.m1.7.8.cmml"><msub id="S3.Ex1.m1.7.8.2" xref="S3.Ex1.m1.7.8.2.cmml"><mi id="S3.Ex1.m1.7.8.2.2" xref="S3.Ex1.m1.7.8.2.2.cmml">M</mi><mrow id="S3.Ex1.m1.7.8.2.3" xref="S3.Ex1.m1.7.8.2.3.cmml"><mi id="S3.Ex1.m1.7.8.2.3.2" xref="S3.Ex1.m1.7.8.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.7.8.2.3.1" xref="S3.Ex1.m1.7.8.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.7.8.2.3.3" xref="S3.Ex1.m1.7.8.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1.m1.7.8.1" xref="S3.Ex1.m1.7.8.1.cmml">=</mo><mrow id="S3.Ex1.m1.7.7" xref="S3.Ex1.m1.7.8.3.1.cmml"><mo id="S3.Ex1.m1.7.7.8" xref="S3.Ex1.m1.7.8.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.Ex1.m1.7.7.7" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtr id="S3.Ex1.m1.7.7.7a" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.7.7.7b" xref="S3.Ex1.m1.7.8.3.1.cmml"><mn id="S3.Ex1.m1.5.5.5.5.3.1" xref="S3.Ex1.m1.5.5.5.5.3.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.7.7.7c" xref="S3.Ex1.m1.7.8.3.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2c.cmml"><mtext id="S3.Ex1.m1.2.2.2.2.2.2a" xref="S3.Ex1.m1.2.2.2.2.2.2c.cmml">if </mtext><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">v</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><mtext id="S3.Ex1.m1.2.2.2.2.2.2b" xref="S3.Ex1.m1.2.2.2.2.2.2c.cmml"> lies on any directed path from </mtext><msub id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml"><mi id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.2" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.2.cmml">v</mi><mi id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.3" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.3.cmml">j</mi></msub></mrow></mtd></mtr><mtr id="S3.Ex1.m1.7.7.7d" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtd id="S3.Ex1.m1.7.7.7e" xref="S3.Ex1.m1.7.8.3.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.7.7.7f" xref="S3.Ex1.m1.7.8.3.1.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.2" xref="S3.Ex1.m1.4.4.4.4.2.2d.cmml"><mtext id="S3.Ex1.m1.4.4.4.4.2.2a" xref="S3.Ex1.m1.4.4.4.4.2.2d.cmml">or </mtext><msub id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.2.cmml">v</mi><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.3.cmml">j</mi></msub><mtext id="S3.Ex1.m1.4.4.4.4.2.2b" xref="S3.Ex1.m1.4.4.4.4.2.2d.cmml"> lies on any directed path from </mtext><msub id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.2" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.2.cmml">v</mi><mi id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.3" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.3.cmml">i</mi></msub><mtext id="S3.Ex1.m1.4.4.4.4.2.2c" xref="S3.Ex1.m1.4.4.4.4.2.2d.cmml">,</mtext></mrow></mtd></mtr><mtr id="S3.Ex1.m1.7.7.7g" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.7.7.7h" xref="S3.Ex1.m1.7.8.3.1.cmml"><mn id="S3.Ex1.m1.6.6.6.6.1.1" xref="S3.Ex1.m1.6.6.6.6.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.7.7.7i" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtext id="S3.Ex1.m1.7.7.7.7.2.1" xref="S3.Ex1.m1.7.7.7.7.2.1a.cmml">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.7b"><apply id="S3.Ex1.m1.7.8.cmml" xref="S3.Ex1.m1.7.8"><eq id="S3.Ex1.m1.7.8.1.cmml" xref="S3.Ex1.m1.7.8.1"></eq><apply id="S3.Ex1.m1.7.8.2.cmml" xref="S3.Ex1.m1.7.8.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.7.8.2.1.cmml" xref="S3.Ex1.m1.7.8.2">subscript</csymbol><ci id="S3.Ex1.m1.7.8.2.2.cmml" xref="S3.Ex1.m1.7.8.2.2">𝑀</ci><apply id="S3.Ex1.m1.7.8.2.3.cmml" xref="S3.Ex1.m1.7.8.2.3"><times id="S3.Ex1.m1.7.8.2.3.1.cmml" xref="S3.Ex1.m1.7.8.2.3.1"></times><ci id="S3.Ex1.m1.7.8.2.3.2.cmml" xref="S3.Ex1.m1.7.8.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.7.8.2.3.3.cmml" xref="S3.Ex1.m1.7.8.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m1.7.8.3.1.cmml" xref="S3.Ex1.m1.7.7"><csymbol cd="latexml" id="S3.Ex1.m1.7.8.3.1.1.cmml" xref="S3.Ex1.m1.7.7.8">cases</csymbol><cn type="integer" id="S3.Ex1.m1.5.5.5.5.3.1.cmml" xref="S3.Ex1.m1.5.5.5.5.3.1">1</cn><ci id="S3.Ex1.m1.2.2.2.2.2.2c.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2"><mrow id="S3.Ex1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2"><mtext id="S3.Ex1.m1.2.2.2.2.2.2a.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">if </mtext><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2">v</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3">i</mi></msub><mtext id="S3.Ex1.m1.2.2.2.2.2.2b.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2"> lies on any directed path from </mtext><msub id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1"><mi id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.2">v</mi><mi id="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.2.2.m2.1.1.3">j</mi></msub></mrow></ci><ci id="S3.Ex1.m1.7.8.3.1.4a.cmml" xref="S3.Ex1.m1.7.7"><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m1.7.8.3.1.4.cmml" xref="S3.Ex1.m1.7.7.8">otherwise</mtext></ci><ci id="S3.Ex1.m1.4.4.4.4.2.2d.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2"><mrow id="S3.Ex1.m1.4.4.4.4.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2"><mtext id="S3.Ex1.m1.4.4.4.4.2.2a.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2">or </mtext><msub id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.2">v</mi><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.m1.1.1.3">j</mi></msub><mtext id="S3.Ex1.m1.4.4.4.4.2.2b.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2"> lies on any directed path from </mtext><msub id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1"><mi id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.2">v</mi><mi id="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.m2.1.1.3">i</mi></msub><mtext id="S3.Ex1.m1.4.4.4.4.2.2c.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2">,</mtext></mrow></ci><cn type="integer" id="S3.Ex1.m1.6.6.6.6.1.1.cmml" xref="S3.Ex1.m1.6.6.6.6.1.1">0</cn><ci id="S3.Ex1.m1.7.7.7.7.2.1a.cmml" xref="S3.Ex1.m1.7.7.7.7.2.1"><mtext id="S3.Ex1.m1.7.7.7.7.2.1.cmml" xref="S3.Ex1.m1.7.7.7.7.2.1">otherwise.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.7c">M_{ij}=\begin{cases}1&amp;\text{if $v_{i}$ lies on any directed path from $v_{j}$}\\
&amp;\text{or $v_{j}$ lies on any directed path from $v_{i}$,}\\
0&amp;\text{otherwise.}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para">
<p id="S3.SS3.SSS2.p2.3" class="ltx_p">Specifically, given the input node-embedding matrix <math id="S3.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="H^{(\ell-1)}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mrow id="S3.SS3.SSS2.p2.1.m1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.2.cmml"><msup id="S3.SS3.SSS2.p2.1.m1.1.2.2" xref="S3.SS3.SSS2.p2.1.m1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.2.2.2" xref="S3.SS3.SSS2.p2.1.m1.1.2.2.2.cmml">H</mi><mrow id="S3.SS3.SSS2.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.2.cmml">ℓ</mi><mo id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS2.p2.1.m1.1.2.1" xref="S3.SS3.SSS2.p2.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.1.m1.1.2.3" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.2.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.1.m1.1.2.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.1" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2"><in id="S3.SS3.SSS2.p2.1.m1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.1"></in><apply id="S3.SS3.SSS2.p2.1.m1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.2.2">𝐻</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1"><minus id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.1"></minus><ci id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p2.1.m1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3"><times id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.2.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">H^{(\ell-1)}\in\mathbb{R}^{N\times d}</annotation></semantics></math> and the mask matrix <math id="S3.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><mi id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><ci id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">M</annotation></semantics></math>, the flow-aware global attention module computes its output node-embedding matrix <math id="S3.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="H^{(\ell)}_{global}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mrow id="S3.SS3.SSS2.p2.3.m3.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.cmml"><msubsup id="S3.SS3.SSS2.p2.3.m3.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2.2.cmml">H</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1a" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.4" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1b" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.5" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1c" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.6" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1d" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.7" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.7.cmml">l</mi></mrow><mrow id="S3.SS3.SSS2.p2.3.m3.1.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.3.m3.1.1.1.3.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS3.SSS2.p2.3.m3.1.1.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.3.m3.1.1.1.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS2.p2.3.m3.1.2.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.3.m3.1.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2"><in id="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.1"></in><apply id="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.1">ℓ</ci></apply><apply id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3"><times id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2">𝑔</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.3">𝑙</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.5.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.5">𝑏</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.6.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.6">𝑎</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.7.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.3.7">𝑙</ci></apply></apply><apply id="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3"><times id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.1"></times><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.2">𝑁</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">H^{(\ell)}_{global}\in\mathbb{R}^{N\times d}</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.7" class="ltx_Math" alttext="H^{(\ell)}_{global}=\operatorname{MMHA}(H^{(\ell-1)},H^{(\ell-1)},H^{(\ell-1)},M).~{}" display="block"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><msubsup id="S3.E5.m1.7.7.1.1.5" xref="S3.E5.m1.7.7.1.1.5.cmml"><mi id="S3.E5.m1.7.7.1.1.5.2.2" xref="S3.E5.m1.7.7.1.1.5.2.2.cmml">H</mi><mrow id="S3.E5.m1.7.7.1.1.5.3" xref="S3.E5.m1.7.7.1.1.5.3.cmml"><mi id="S3.E5.m1.7.7.1.1.5.3.2" xref="S3.E5.m1.7.7.1.1.5.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.5.3.1" xref="S3.E5.m1.7.7.1.1.5.3.1.cmml">​</mo><mi id="S3.E5.m1.7.7.1.1.5.3.3" xref="S3.E5.m1.7.7.1.1.5.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.5.3.1a" xref="S3.E5.m1.7.7.1.1.5.3.1.cmml">​</mo><mi id="S3.E5.m1.7.7.1.1.5.3.4" xref="S3.E5.m1.7.7.1.1.5.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.5.3.1b" xref="S3.E5.m1.7.7.1.1.5.3.1.cmml">​</mo><mi id="S3.E5.m1.7.7.1.1.5.3.5" xref="S3.E5.m1.7.7.1.1.5.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.5.3.1c" xref="S3.E5.m1.7.7.1.1.5.3.1.cmml">​</mo><mi id="S3.E5.m1.7.7.1.1.5.3.6" xref="S3.E5.m1.7.7.1.1.5.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.5.3.1d" xref="S3.E5.m1.7.7.1.1.5.3.1.cmml">​</mo><mi id="S3.E5.m1.7.7.1.1.5.3.7" xref="S3.E5.m1.7.7.1.1.5.3.7.cmml">l</mi></mrow><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.5.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.3.1" xref="S3.E5.m1.7.7.1.1.5.cmml">(</mo><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.4" xref="S3.E5.m1.7.7.1.1.4.cmml">=</mo><mrow id="S3.E5.m1.7.7.1.1.3.3" xref="S3.E5.m1.7.7.1.1.3.4.cmml"><mi id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">MMHA</mi><mo id="S3.E5.m1.7.7.1.1.3.3a" xref="S3.E5.m1.7.7.1.1.3.4.cmml">⁡</mo><mrow id="S3.E5.m1.7.7.1.1.3.3.3" xref="S3.E5.m1.7.7.1.1.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.7.7.1.1.3.3.3.4" xref="S3.E5.m1.7.7.1.1.3.4.cmml">(</mo><msup id="S3.E5.m1.7.7.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.2.cmml">H</mi><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">ℓ</mi><mo id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E5.m1.7.7.1.1.3.3.3.5" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><msup id="S3.E5.m1.7.7.1.1.2.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.2.2.cmml">H</mi><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">ℓ</mi><mo id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E5.m1.7.7.1.1.3.3.3.6" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><msup id="S3.E5.m1.7.7.1.1.3.3.3.3" xref="S3.E5.m1.7.7.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.3.3.2" xref="S3.E5.m1.7.7.1.1.3.3.3.3.2.cmml">H</mi><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mi mathvariant="normal" id="S3.E5.m1.4.4.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.2.cmml">ℓ</mi><mo id="S3.E5.m1.4.4.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E5.m1.7.7.1.1.3.3.3.7" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><mi id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml">M</mi><mo stretchy="false" id="S3.E5.m1.7.7.1.1.3.3.3.8" xref="S3.E5.m1.7.7.1.1.3.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.7.7.1.2" xref="S3.E5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.4.cmml" xref="S3.E5.m1.7.7.1.1.4"></eq><apply id="S3.E5.m1.7.7.1.1.5.cmml" xref="S3.E5.m1.7.7.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.5.1.cmml" xref="S3.E5.m1.7.7.1.1.5">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.5.2.cmml" xref="S3.E5.m1.7.7.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.5.2.1.cmml" xref="S3.E5.m1.7.7.1.1.5">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.5.2.2.cmml" xref="S3.E5.m1.7.7.1.1.5.2.2">𝐻</ci><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">ℓ</ci></apply><apply id="S3.E5.m1.7.7.1.1.5.3.cmml" xref="S3.E5.m1.7.7.1.1.5.3"><times id="S3.E5.m1.7.7.1.1.5.3.1.cmml" xref="S3.E5.m1.7.7.1.1.5.3.1"></times><ci id="S3.E5.m1.7.7.1.1.5.3.2.cmml" xref="S3.E5.m1.7.7.1.1.5.3.2">𝑔</ci><ci id="S3.E5.m1.7.7.1.1.5.3.3.cmml" xref="S3.E5.m1.7.7.1.1.5.3.3">𝑙</ci><ci id="S3.E5.m1.7.7.1.1.5.3.4.cmml" xref="S3.E5.m1.7.7.1.1.5.3.4">𝑜</ci><ci id="S3.E5.m1.7.7.1.1.5.3.5.cmml" xref="S3.E5.m1.7.7.1.1.5.3.5">𝑏</ci><ci id="S3.E5.m1.7.7.1.1.5.3.6.cmml" xref="S3.E5.m1.7.7.1.1.5.3.6">𝑎</ci><ci id="S3.E5.m1.7.7.1.1.5.3.7.cmml" xref="S3.E5.m1.7.7.1.1.5.3.7">𝑙</ci></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.4.cmml" xref="S3.E5.m1.7.7.1.1.3.3"><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">MMHA</ci><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.2">𝐻</ci><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2">ℓ</ci><cn type="integer" id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.2.2">𝐻</ci><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></minus><ci id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2">ℓ</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.3.2">𝐻</ci><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1"><minus id="S3.E5.m1.4.4.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1"></minus><ci id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2">ℓ</ci><cn type="integer" id="S3.E5.m1.4.4.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3">1</cn></apply></apply><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">H^{(\ell)}_{global}=\operatorname{MMHA}(H^{(\ell-1)},H^{(\ell-1)},H^{(\ell-1)},M).~{}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p2.4" class="ltx_p">Here, <math id="S3.SS3.SSS2.p2.4.m1.1" class="ltx_Math" alttext="\operatorname{MMHA}" display="inline"><semantics id="S3.SS3.SSS2.p2.4.m1.1a"><mi id="S3.SS3.SSS2.p2.4.m1.1.1" xref="S3.SS3.SSS2.p2.4.m1.1.1.cmml">MMHA</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m1.1b"><ci id="S3.SS3.SSS2.p2.4.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m1.1.1">MMHA</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m1.1c">\operatorname{MMHA}</annotation></semantics></math> is the Masked Multi-Head Attention module:</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.8" class="ltx_Math" alttext="\operatorname{MMHA}(Q,K,V,M)=\operatorname{Concat}(\operatorname{head}_{1},\dots,\operatorname{head}_{s})W^{0},~{}" display="block"><semantics id="S3.Ex2.m1.8a"><mrow id="S3.Ex2.m1.8.8.1" xref="S3.Ex2.m1.8.8.1.1.cmml"><mrow id="S3.Ex2.m1.8.8.1.1" xref="S3.Ex2.m1.8.8.1.1.cmml"><mrow id="S3.Ex2.m1.8.8.1.1.4.2" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml"><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">MMHA</mi><mo id="S3.Ex2.m1.8.8.1.1.4.2a" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">⁡</mo><mrow id="S3.Ex2.m1.8.8.1.1.4.2.1" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.8.8.1.1.4.2.1.1" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">(</mo><mi id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml">Q</mi><mo id="S3.Ex2.m1.8.8.1.1.4.2.1.2" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">,</mo><mi id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">K</mi><mo id="S3.Ex2.m1.8.8.1.1.4.2.1.3" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">,</mo><mi id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml">V</mi><mo id="S3.Ex2.m1.8.8.1.1.4.2.1.4" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">,</mo><mi id="S3.Ex2.m1.5.5" xref="S3.Ex2.m1.5.5.cmml">M</mi><mo stretchy="false" id="S3.Ex2.m1.8.8.1.1.4.2.1.5" xref="S3.Ex2.m1.8.8.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.8.8.1.1.3" xref="S3.Ex2.m1.8.8.1.1.3.cmml">=</mo><mrow id="S3.Ex2.m1.8.8.1.1.2" xref="S3.Ex2.m1.8.8.1.1.2.cmml"><mrow id="S3.Ex2.m1.8.8.1.1.2.2.2" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml"><mi id="S3.Ex2.m1.6.6" xref="S3.Ex2.m1.6.6.cmml">Concat</mi><mo id="S3.Ex2.m1.8.8.1.1.2.2.2a" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml">⁡</mo><mrow id="S3.Ex2.m1.8.8.1.1.2.2.2.2" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex2.m1.8.8.1.1.2.2.2.2.3" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml">(</mo><msub id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.2.cmml">head</mi><mn id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex2.m1.8.8.1.1.2.2.2.2.4" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.Ex2.m1.7.7" xref="S3.Ex2.m1.7.7.cmml">…</mi><mo id="S3.Ex2.m1.8.8.1.1.2.2.2.2.5" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml">,</mo><msub id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.cmml"><mi id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.2" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.2.cmml">head</mi><mi id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.3" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.Ex2.m1.8.8.1.1.2.2.2.2.6" xref="S3.Ex2.m1.8.8.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.8.8.1.1.2.3" xref="S3.Ex2.m1.8.8.1.1.2.3.cmml">​</mo><msup id="S3.Ex2.m1.8.8.1.1.2.4" xref="S3.Ex2.m1.8.8.1.1.2.4.cmml"><mi id="S3.Ex2.m1.8.8.1.1.2.4.2" xref="S3.Ex2.m1.8.8.1.1.2.4.2.cmml">W</mi><mn id="S3.Ex2.m1.8.8.1.1.2.4.3" xref="S3.Ex2.m1.8.8.1.1.2.4.3.cmml">0</mn></msup></mrow></mrow><mo id="S3.Ex2.m1.8.8.1.2" xref="S3.Ex2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.8b"><apply id="S3.Ex2.m1.8.8.1.1.cmml" xref="S3.Ex2.m1.8.8.1"><eq id="S3.Ex2.m1.8.8.1.1.3.cmml" xref="S3.Ex2.m1.8.8.1.1.3"></eq><apply id="S3.Ex2.m1.8.8.1.1.4.1.cmml" xref="S3.Ex2.m1.8.8.1.1.4.2"><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">MMHA</ci><ci id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">𝑄</ci><ci id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">𝐾</ci><ci id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.4">𝑉</ci><ci id="S3.Ex2.m1.5.5.cmml" xref="S3.Ex2.m1.5.5">𝑀</ci></apply><apply id="S3.Ex2.m1.8.8.1.1.2.cmml" xref="S3.Ex2.m1.8.8.1.1.2"><times id="S3.Ex2.m1.8.8.1.1.2.3.cmml" xref="S3.Ex2.m1.8.8.1.1.2.3"></times><apply id="S3.Ex2.m1.8.8.1.1.2.2.3.cmml" xref="S3.Ex2.m1.8.8.1.1.2.2.2"><ci id="S3.Ex2.m1.6.6.cmml" xref="S3.Ex2.m1.6.6">Concat</ci><apply id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.2">head</ci><cn type="integer" id="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.8.8.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex2.m1.7.7.cmml" xref="S3.Ex2.m1.7.7">…</ci><apply id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.2">head</ci><ci id="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.3.cmml" xref="S3.Ex2.m1.8.8.1.1.2.2.2.2.2.3">𝑠</ci></apply></apply><apply id="S3.Ex2.m1.8.8.1.1.2.4.cmml" xref="S3.Ex2.m1.8.8.1.1.2.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.8.8.1.1.2.4.1.cmml" xref="S3.Ex2.m1.8.8.1.1.2.4">superscript</csymbol><ci id="S3.Ex2.m1.8.8.1.1.2.4.2.cmml" xref="S3.Ex2.m1.8.8.1.1.2.4.2">𝑊</ci><cn type="integer" id="S3.Ex2.m1.8.8.1.1.2.4.3.cmml" xref="S3.Ex2.m1.8.8.1.1.2.4.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.8c">\operatorname{MMHA}(Q,K,V,M)=\operatorname{Concat}(\operatorname{head}_{1},\dots,\operatorname{head}_{s})W^{0},~{}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p2.6" class="ltx_p">where <math id="S3.SS3.SSS2.p2.5.m1.1" class="ltx_Math" alttext="W^{0}\in\mathbb{R}^{sd_{v}\times d}" display="inline"><semantics id="S3.SS3.SSS2.p2.5.m1.1a"><mrow id="S3.SS3.SSS2.p2.5.m1.1.1" xref="S3.SS3.SSS2.p2.5.m1.1.1.cmml"><msup id="S3.SS3.SSS2.p2.5.m1.1.1.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.5.m1.1.1.2.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.2.2.cmml">W</mi><mn id="S3.SS3.SSS2.p2.5.m1.1.1.2.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.2.3.cmml">0</mn></msup><mo id="S3.SS3.SSS2.p2.5.m1.1.1.1" xref="S3.SS3.SSS2.p2.5.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.5.m1.1.1.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m1.1.1.3.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.5.m1.1.1.3.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.cmml"><mrow id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.1" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.1.cmml">​</mo><msub id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.2" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.3.cmml">v</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.1" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.3" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m1.1b"><apply id="S3.SS3.SSS2.p2.5.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1"><in id="S3.SS3.SSS2.p2.5.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.1"></in><apply id="S3.SS3.SSS2.p2.5.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.2.2">𝑊</ci><cn type="integer" id="S3.SS3.SSS2.p2.5.m1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.2.3">0</cn></apply><apply id="S3.SS3.SSS2.p2.5.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3"><times id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.1"></times><apply id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2"><times id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.1"></times><ci id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.2">𝑠</ci><apply id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.2.3.3">𝑣</ci></apply></apply><ci id="S3.SS3.SSS2.p2.5.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m1.1c">W^{0}\in\mathbb{R}^{sd_{v}\times d}</annotation></semantics></math> is the learnable projection matrix, <math id="S3.SS3.SSS2.p2.6.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.SSS2.p2.6.m2.1a"><mi id="S3.SS3.SSS2.p2.6.m2.1.1" xref="S3.SS3.SSS2.p2.6.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m2.1b"><ci id="S3.SS3.SSS2.p2.6.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m2.1c">s</annotation></semantics></math> is the number of heads, and</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m1.3" class="ltx_Math" alttext="\displaystyle\operatorname{head}_{i}=\operatorname{Attn}(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V},M)," display="inline"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3.1" xref="S3.Ex3.m1.3.3.1.1.cmml"><mrow id="S3.Ex3.m1.3.3.1.1" xref="S3.Ex3.m1.3.3.1.1.cmml"><msub id="S3.Ex3.m1.3.3.1.1.5" xref="S3.Ex3.m1.3.3.1.1.5.cmml"><mi id="S3.Ex3.m1.3.3.1.1.5.2" xref="S3.Ex3.m1.3.3.1.1.5.2.cmml">head</mi><mi id="S3.Ex3.m1.3.3.1.1.5.3" xref="S3.Ex3.m1.3.3.1.1.5.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.3.3.1.1.4" xref="S3.Ex3.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.Ex3.m1.3.3.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml"><mi id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">Attn</mi><mo id="S3.Ex3.m1.3.3.1.1.3.3a" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">⁡</mo><mrow id="S3.Ex3.m1.3.3.1.1.3.3.3" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml"><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.3.3.3.4" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="S3.Ex3.m1.3.3.1.1.3.3.3.5" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">,</mo><mrow id="S3.Ex3.m1.3.3.1.1.2.2.2.2" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.Ex3.m1.3.3.1.1.2.2.2.2.2" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.1.1.2.2.2.2.1" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.1.cmml">​</mo><msubsup id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.3" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.3.cmml">i</mi><mi id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.3" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="S3.Ex3.m1.3.3.1.1.3.3.3.6" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">,</mo><mrow id="S3.Ex3.m1.3.3.1.1.3.3.3.3" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.3.3.3.3.2" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.1.1.3.3.3.3.1" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.1.cmml">​</mo><msubsup id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.2" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.3" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.3.cmml">i</mi><mi id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.3" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo id="S3.Ex3.m1.3.3.1.1.3.3.3.7" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">,</mo><mi id="S3.Ex3.m1.2.2" xref="S3.Ex3.m1.2.2.cmml">M</mi><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.3.3.3.8" xref="S3.Ex3.m1.3.3.1.1.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex3.m1.3.3.1.2" xref="S3.Ex3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.1.1.cmml" xref="S3.Ex3.m1.3.3.1"><eq id="S3.Ex3.m1.3.3.1.1.4.cmml" xref="S3.Ex3.m1.3.3.1.1.4"></eq><apply id="S3.Ex3.m1.3.3.1.1.5.cmml" xref="S3.Ex3.m1.3.3.1.1.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.5.1.cmml" xref="S3.Ex3.m1.3.3.1.1.5">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.5.2.cmml" xref="S3.Ex3.m1.3.3.1.1.5.2">head</ci><ci id="S3.Ex3.m1.3.3.1.1.5.3.cmml" xref="S3.Ex3.m1.3.3.1.1.5.3">𝑖</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.3.4.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3"><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">Attn</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S3.Ex3.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2"><times id="S3.Ex3.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.1"></times><ci id="S3.Ex3.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.2">𝐾</ci><apply id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="S3.Ex3.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3"><times id="S3.Ex3.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.1"></times><ci id="S3.Ex3.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.2">𝑉</ci><apply id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3">superscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3.3.3.3.3">𝑉</ci></apply></apply><ci id="S3.Ex3.m1.2.2.cmml" xref="S3.Ex3.m1.2.2">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">\displaystyle\operatorname{head}_{i}=\operatorname{Attn}(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V},M),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m1.8" class="ltx_Math" alttext="\displaystyle\operatorname{Attn}(Q,K,V,M)=\left(M\odot\operatorname{Softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}}}\right)\right)V." display="inline"><semantics id="S3.Ex4.m1.8a"><mrow id="S3.Ex4.m1.8.8.1" xref="S3.Ex4.m1.8.8.1.1.cmml"><mrow id="S3.Ex4.m1.8.8.1.1" xref="S3.Ex4.m1.8.8.1.1.cmml"><mrow id="S3.Ex4.m1.8.8.1.1.3.2" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml"><mi id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml">Attn</mi><mo id="S3.Ex4.m1.8.8.1.1.3.2a" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">⁡</mo><mrow id="S3.Ex4.m1.8.8.1.1.3.2.1" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.8.8.1.1.3.2.1.1" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">(</mo><mi id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml">Q</mi><mo id="S3.Ex4.m1.8.8.1.1.3.2.1.2" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">,</mo><mi id="S3.Ex4.m1.3.3" xref="S3.Ex4.m1.3.3.cmml">K</mi><mo id="S3.Ex4.m1.8.8.1.1.3.2.1.3" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">,</mo><mi id="S3.Ex4.m1.4.4" xref="S3.Ex4.m1.4.4.cmml">V</mi><mo id="S3.Ex4.m1.8.8.1.1.3.2.1.4" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">,</mo><mi id="S3.Ex4.m1.5.5" xref="S3.Ex4.m1.5.5.cmml">M</mi><mo stretchy="false" id="S3.Ex4.m1.8.8.1.1.3.2.1.5" xref="S3.Ex4.m1.8.8.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.8.8.1.1.2" xref="S3.Ex4.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.Ex4.m1.8.8.1.1.1" xref="S3.Ex4.m1.8.8.1.1.1.cmml"><mrow id="S3.Ex4.m1.8.8.1.1.1.1.1" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.8.8.1.1.1.1.1.2" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.8.8.1.1.1.1.1.1" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.8.8.1.1.1.1.1.1.2" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex4.m1.8.8.1.1.1.1.1.1.1" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.1.cmml">⊙</mo><mrow id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml"><mi id="S3.Ex4.m1.6.6" xref="S3.Ex4.m1.6.6.cmml">Softmax</mi><mo id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2a" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2.1" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml"><mo id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2.1.1" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml">(</mo><mstyle displaystyle="true" id="S3.Ex4.m1.7.7" xref="S3.Ex4.m1.7.7.cmml"><mfrac id="S3.Ex4.m1.7.7a" xref="S3.Ex4.m1.7.7.cmml"><mrow id="S3.Ex4.m1.7.7.2" xref="S3.Ex4.m1.7.7.2.cmml"><mi id="S3.Ex4.m1.7.7.2.2" xref="S3.Ex4.m1.7.7.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.7.7.2.1" xref="S3.Ex4.m1.7.7.2.1.cmml">​</mo><msup id="S3.Ex4.m1.7.7.2.3" xref="S3.Ex4.m1.7.7.2.3.cmml"><mi id="S3.Ex4.m1.7.7.2.3.2" xref="S3.Ex4.m1.7.7.2.3.2.cmml">K</mi><mi id="S3.Ex4.m1.7.7.2.3.3" xref="S3.Ex4.m1.7.7.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex4.m1.7.7.3" xref="S3.Ex4.m1.7.7.3.cmml"><msub id="S3.Ex4.m1.7.7.3.2" xref="S3.Ex4.m1.7.7.3.2.cmml"><mi id="S3.Ex4.m1.7.7.3.2.2" xref="S3.Ex4.m1.7.7.3.2.2.cmml">d</mi><mi id="S3.Ex4.m1.7.7.3.2.3" xref="S3.Ex4.m1.7.7.3.2.3.cmml">k</mi></msub></msqrt></mfrac></mstyle><mo id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2.1.2" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex4.m1.8.8.1.1.1.1.1.3" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.8.8.1.1.1.2" xref="S3.Ex4.m1.8.8.1.1.1.2.cmml">​</mo><mi id="S3.Ex4.m1.8.8.1.1.1.3" xref="S3.Ex4.m1.8.8.1.1.1.3.cmml">V</mi></mrow></mrow><mo lspace="0em" id="S3.Ex4.m1.8.8.1.2" xref="S3.Ex4.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.8b"><apply id="S3.Ex4.m1.8.8.1.1.cmml" xref="S3.Ex4.m1.8.8.1"><eq id="S3.Ex4.m1.8.8.1.1.2.cmml" xref="S3.Ex4.m1.8.8.1.1.2"></eq><apply id="S3.Ex4.m1.8.8.1.1.3.1.cmml" xref="S3.Ex4.m1.8.8.1.1.3.2"><ci id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1">Attn</ci><ci id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2">𝑄</ci><ci id="S3.Ex4.m1.3.3.cmml" xref="S3.Ex4.m1.3.3">𝐾</ci><ci id="S3.Ex4.m1.4.4.cmml" xref="S3.Ex4.m1.4.4">𝑉</ci><ci id="S3.Ex4.m1.5.5.cmml" xref="S3.Ex4.m1.5.5">𝑀</ci></apply><apply id="S3.Ex4.m1.8.8.1.1.1.cmml" xref="S3.Ex4.m1.8.8.1.1.1"><times id="S3.Ex4.m1.8.8.1.1.1.2.cmml" xref="S3.Ex4.m1.8.8.1.1.1.2"></times><apply id="S3.Ex4.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S3.Ex4.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.2">𝑀</ci><apply id="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.8.8.1.1.1.1.1.1.3.2"><ci id="S3.Ex4.m1.6.6.cmml" xref="S3.Ex4.m1.6.6">Softmax</ci><apply id="S3.Ex4.m1.7.7.cmml" xref="S3.Ex4.m1.7.7"><divide id="S3.Ex4.m1.7.7.1.cmml" xref="S3.Ex4.m1.7.7"></divide><apply id="S3.Ex4.m1.7.7.2.cmml" xref="S3.Ex4.m1.7.7.2"><times id="S3.Ex4.m1.7.7.2.1.cmml" xref="S3.Ex4.m1.7.7.2.1"></times><ci id="S3.Ex4.m1.7.7.2.2.cmml" xref="S3.Ex4.m1.7.7.2.2">𝑄</ci><apply id="S3.Ex4.m1.7.7.2.3.cmml" xref="S3.Ex4.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.7.7.2.3.1.cmml" xref="S3.Ex4.m1.7.7.2.3">superscript</csymbol><ci id="S3.Ex4.m1.7.7.2.3.2.cmml" xref="S3.Ex4.m1.7.7.2.3.2">𝐾</ci><ci id="S3.Ex4.m1.7.7.2.3.3.cmml" xref="S3.Ex4.m1.7.7.2.3.3">𝑇</ci></apply></apply><apply id="S3.Ex4.m1.7.7.3.cmml" xref="S3.Ex4.m1.7.7.3"><root id="S3.Ex4.m1.7.7.3a.cmml" xref="S3.Ex4.m1.7.7.3"></root><apply id="S3.Ex4.m1.7.7.3.2.cmml" xref="S3.Ex4.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.7.7.3.2.1.cmml" xref="S3.Ex4.m1.7.7.3.2">subscript</csymbol><ci id="S3.Ex4.m1.7.7.3.2.2.cmml" xref="S3.Ex4.m1.7.7.3.2.2">𝑑</ci><ci id="S3.Ex4.m1.7.7.3.2.3.cmml" xref="S3.Ex4.m1.7.7.3.2.3">𝑘</ci></apply></apply></apply></apply></apply><ci id="S3.Ex4.m1.8.8.1.1.1.3.cmml" xref="S3.Ex4.m1.8.8.1.1.1.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.8c">\displaystyle\operatorname{Attn}(Q,K,V,M)=\left(M\odot\operatorname{Softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}}}\right)\right)V.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p2.12" class="ltx_p">Here, <math id="S3.SS3.SSS2.p2.7.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS3.SSS2.p2.7.m1.1a"><mo id="S3.SS3.SSS2.p2.7.m1.1.1" xref="S3.SS3.SSS2.p2.7.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m1.1b"><csymbol cd="latexml" id="S3.SS3.SSS2.p2.7.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m1.1c">\odot</annotation></semantics></math> is element-wise multiplication; and <math id="S3.SS3.SSS2.p2.8.m2.1" class="ltx_Math" alttext="W_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}" display="inline"><semantics id="S3.SS3.SSS2.p2.8.m2.1a"><mrow id="S3.SS3.SSS2.p2.8.m2.1.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.cmml"><msubsup id="S3.SS3.SSS2.p2.8.m2.1.1.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.8.m2.1.1.2.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.SS3.SSS2.p2.8.m2.1.1.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.8.m2.1.1.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.3.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.8.m2.1.1.3.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m2.1b"><apply id="S3.SS3.SSS2.p2.8.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1"><in id="S3.SS3.SSS2.p2.8.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.1"></in><apply id="S3.SS3.SSS2.p2.8.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.8.m2.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.8.m2.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.3">𝑄</ci></apply><apply id="S3.SS3.SSS2.p2.8.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3"><times id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m2.1c">W_{i}^{Q}\in\mathbb{R}^{d\times d_{k}}</annotation></semantics></math>, <math id="S3.SS3.SSS2.p2.9.m3.1" class="ltx_Math" alttext="W_{i}^{K}\in\mathbb{R}^{d\times d_{k}}" display="inline"><semantics id="S3.SS3.SSS2.p2.9.m3.1a"><mrow id="S3.SS3.SSS2.p2.9.m3.1.1" xref="S3.SS3.SSS2.p2.9.m3.1.1.cmml"><msubsup id="S3.SS3.SSS2.p2.9.m3.1.1.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.9.m3.1.1.2.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.3.cmml">K</mi></msubsup><mo id="S3.SS3.SSS2.p2.9.m3.1.1.1" xref="S3.SS3.SSS2.p2.9.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.9.m3.1.1.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.9.m3.1.1.3.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.9.m3.1.1.3.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.1" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m3.1b"><apply id="S3.SS3.SSS2.p2.9.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1"><in id="S3.SS3.SSS2.p2.9.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.1"></in><apply id="S3.SS3.SSS2.p2.9.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.9.m3.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.9.m3.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.3">𝐾</ci></apply><apply id="S3.SS3.SSS2.p2.9.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m3.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m3.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3"><times id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m3.1c">W_{i}^{K}\in\mathbb{R}^{d\times d_{k}}</annotation></semantics></math>, and <math id="S3.SS3.SSS2.p2.10.m4.1" class="ltx_Math" alttext="W_{i}^{V}\in\mathbb{R}^{d\times d_{v}}" display="inline"><semantics id="S3.SS3.SSS2.p2.10.m4.1a"><mrow id="S3.SS3.SSS2.p2.10.m4.1.1" xref="S3.SS3.SSS2.p2.10.m4.1.1.cmml"><msubsup id="S3.SS3.SSS2.p2.10.m4.1.1.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.10.m4.1.1.2.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.3.cmml">V</mi></msubsup><mo id="S3.SS3.SSS2.p2.10.m4.1.1.1" xref="S3.SS3.SSS2.p2.10.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.10.m4.1.1.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.10.m4.1.1.3.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.1" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m4.1b"><apply id="S3.SS3.SSS2.p2.10.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1"><in id="S3.SS3.SSS2.p2.10.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.1"></in><apply id="S3.SS3.SSS2.p2.10.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m4.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.SSS2.p2.10.m4.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.10.m4.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.3">𝑉</ci></apply><apply id="S3.SS3.SSS2.p2.10.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3"><times id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.2">𝑑</ci><apply id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m4.1c">W_{i}^{V}\in\mathbb{R}^{d\times d_{v}}</annotation></semantics></math> denote <math id="S3.SS3.SSS2.p2.11.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS2.p2.11.m5.1a"><mi id="S3.SS3.SSS2.p2.11.m5.1.1" xref="S3.SS3.SSS2.p2.11.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m5.1b"><ci id="S3.SS3.SSS2.p2.11.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m5.1c">i</annotation></semantics></math>-th head’s learnable query, key, and value projection matrices, respectively. We adhere to the condition <math id="S3.SS3.SSS2.p2.12.m6.1" class="ltx_Math" alttext="d_{k}=d_{v}=d/s" display="inline"><semantics id="S3.SS3.SSS2.p2.12.m6.1a"><mrow id="S3.SS3.SSS2.p2.12.m6.1.1" xref="S3.SS3.SSS2.p2.12.m6.1.1.cmml"><msub id="S3.SS3.SSS2.p2.12.m6.1.1.2" xref="S3.SS3.SSS2.p2.12.m6.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.12.m6.1.1.2.2" xref="S3.SS3.SSS2.p2.12.m6.1.1.2.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.12.m6.1.1.2.3" xref="S3.SS3.SSS2.p2.12.m6.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS2.p2.12.m6.1.1.3" xref="S3.SS3.SSS2.p2.12.m6.1.1.3.cmml">=</mo><msub id="S3.SS3.SSS2.p2.12.m6.1.1.4" xref="S3.SS3.SSS2.p2.12.m6.1.1.4.cmml"><mi id="S3.SS3.SSS2.p2.12.m6.1.1.4.2" xref="S3.SS3.SSS2.p2.12.m6.1.1.4.2.cmml">d</mi><mi id="S3.SS3.SSS2.p2.12.m6.1.1.4.3" xref="S3.SS3.SSS2.p2.12.m6.1.1.4.3.cmml">v</mi></msub><mo id="S3.SS3.SSS2.p2.12.m6.1.1.5" xref="S3.SS3.SSS2.p2.12.m6.1.1.5.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.12.m6.1.1.6" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.cmml"><mi id="S3.SS3.SSS2.p2.12.m6.1.1.6.2" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.2.cmml">d</mi><mo id="S3.SS3.SSS2.p2.12.m6.1.1.6.1" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.1.cmml">/</mo><mi id="S3.SS3.SSS2.p2.12.m6.1.1.6.3" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m6.1b"><apply id="S3.SS3.SSS2.p2.12.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1"><and id="S3.SS3.SSS2.p2.12.m6.1.1a.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1"></and><apply id="S3.SS3.SSS2.p2.12.m6.1.1b.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1"><eq id="S3.SS3.SSS2.p2.12.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.3"></eq><apply id="S3.SS3.SSS2.p2.12.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m6.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.12.m6.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.2.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.12.m6.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.SSS2.p2.12.m6.1.1.4.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m6.1.1.4.1.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.4">subscript</csymbol><ci id="S3.SS3.SSS2.p2.12.m6.1.1.4.2.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.4.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.12.m6.1.1.4.3.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.4.3">𝑣</ci></apply></apply><apply id="S3.SS3.SSS2.p2.12.m6.1.1c.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1"><eq id="S3.SS3.SSS2.p2.12.m6.1.1.5.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.5"></eq><share href="#S3.SS3.SSS2.p2.12.m6.1.1.4.cmml" id="S3.SS3.SSS2.p2.12.m6.1.1d.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1"></share><apply id="S3.SS3.SSS2.p2.12.m6.1.1.6.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.6"><divide id="S3.SS3.SSS2.p2.12.m6.1.1.6.1.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.1"></divide><ci id="S3.SS3.SSS2.p2.12.m6.1.1.6.2.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.12.m6.1.1.6.3.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1.6.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m6.1c">d_{k}=d_{v}=d/s</annotation></semantics></math> for every head.</p>
</div>
<figure id="S3.F6" class="ltx_figure"><img src="/html/2403.12821/assets/x6.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="156" alt="Refer to caption">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F6.18.9.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S3.F6.16.8" class="ltx_text" style="font-size:90%;">An example mask matrix <math id="S3.F6.9.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.F6.9.1.m1.1b"><mi id="S3.F6.9.1.m1.1.1" xref="S3.F6.9.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F6.9.1.m1.1c"><ci id="S3.F6.9.1.m1.1.1.cmml" xref="S3.F6.9.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.9.1.m1.1d">M</annotation></semantics></math>.
Node <math id="S3.F6.10.2.m2.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S3.F6.10.2.m2.1b"><mn id="S3.F6.10.2.m2.1.1" xref="S3.F6.10.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S3.F6.10.2.m2.1c"><cn type="integer" id="S3.F6.10.2.m2.1.1.cmml" xref="S3.F6.10.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.10.2.m2.1d">6</annotation></semantics></math> attends exclusively to nodes that appear in any path involving the node (<math id="S3.F6.11.3.m3.1" class="ltx_Math" alttext="P_{1}" display="inline"><semantics id="S3.F6.11.3.m3.1b"><msub id="S3.F6.11.3.m3.1.1" xref="S3.F6.11.3.m3.1.1.cmml"><mi id="S3.F6.11.3.m3.1.1.2" xref="S3.F6.11.3.m3.1.1.2.cmml">P</mi><mn id="S3.F6.11.3.m3.1.1.3" xref="S3.F6.11.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F6.11.3.m3.1c"><apply id="S3.F6.11.3.m3.1.1.cmml" xref="S3.F6.11.3.m3.1.1"><csymbol cd="ambiguous" id="S3.F6.11.3.m3.1.1.1.cmml" xref="S3.F6.11.3.m3.1.1">subscript</csymbol><ci id="S3.F6.11.3.m3.1.1.2.cmml" xref="S3.F6.11.3.m3.1.1.2">𝑃</ci><cn type="integer" id="S3.F6.11.3.m3.1.1.3.cmml" xref="S3.F6.11.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.11.3.m3.1d">P_{1}</annotation></semantics></math> and <math id="S3.F6.12.4.m4.1" class="ltx_Math" alttext="P_{2}" display="inline"><semantics id="S3.F6.12.4.m4.1b"><msub id="S3.F6.12.4.m4.1.1" xref="S3.F6.12.4.m4.1.1.cmml"><mi id="S3.F6.12.4.m4.1.1.2" xref="S3.F6.12.4.m4.1.1.2.cmml">P</mi><mn id="S3.F6.12.4.m4.1.1.3" xref="S3.F6.12.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F6.12.4.m4.1c"><apply id="S3.F6.12.4.m4.1.1.cmml" xref="S3.F6.12.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F6.12.4.m4.1.1.1.cmml" xref="S3.F6.12.4.m4.1.1">subscript</csymbol><ci id="S3.F6.12.4.m4.1.1.2.cmml" xref="S3.F6.12.4.m4.1.1.2">𝑃</ci><cn type="integer" id="S3.F6.12.4.m4.1.1.3.cmml" xref="S3.F6.12.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.12.4.m4.1d">P_{2}</annotation></semantics></math>).
Nodes 1, 3, and 7 appear in <math id="S3.F6.13.5.m5.1" class="ltx_Math" alttext="P_{1}" display="inline"><semantics id="S3.F6.13.5.m5.1b"><msub id="S3.F6.13.5.m5.1.1" xref="S3.F6.13.5.m5.1.1.cmml"><mi id="S3.F6.13.5.m5.1.1.2" xref="S3.F6.13.5.m5.1.1.2.cmml">P</mi><mn id="S3.F6.13.5.m5.1.1.3" xref="S3.F6.13.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F6.13.5.m5.1c"><apply id="S3.F6.13.5.m5.1.1.cmml" xref="S3.F6.13.5.m5.1.1"><csymbol cd="ambiguous" id="S3.F6.13.5.m5.1.1.1.cmml" xref="S3.F6.13.5.m5.1.1">subscript</csymbol><ci id="S3.F6.13.5.m5.1.1.2.cmml" xref="S3.F6.13.5.m5.1.1.2">𝑃</ci><cn type="integer" id="S3.F6.13.5.m5.1.1.3.cmml" xref="S3.F6.13.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.13.5.m5.1d">P_{1}</annotation></semantics></math>, and nodes 1, 4, and 7 appear in <math id="S3.F6.14.6.m6.1" class="ltx_Math" alttext="P_{2}" display="inline"><semantics id="S3.F6.14.6.m6.1b"><msub id="S3.F6.14.6.m6.1.1" xref="S3.F6.14.6.m6.1.1.cmml"><mi id="S3.F6.14.6.m6.1.1.2" xref="S3.F6.14.6.m6.1.1.2.cmml">P</mi><mn id="S3.F6.14.6.m6.1.1.3" xref="S3.F6.14.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F6.14.6.m6.1c"><apply id="S3.F6.14.6.m6.1.1.cmml" xref="S3.F6.14.6.m6.1.1"><csymbol cd="ambiguous" id="S3.F6.14.6.m6.1.1.1.cmml" xref="S3.F6.14.6.m6.1.1">subscript</csymbol><ci id="S3.F6.14.6.m6.1.1.2.cmml" xref="S3.F6.14.6.m6.1.1.2">𝑃</ci><cn type="integer" id="S3.F6.14.6.m6.1.1.3.cmml" xref="S3.F6.14.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.14.6.m6.1d">P_{2}</annotation></semantics></math>; thus node <math id="S3.F6.15.7.m7.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S3.F6.15.7.m7.1b"><mn id="S3.F6.15.7.m7.1.1" xref="S3.F6.15.7.m7.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S3.F6.15.7.m7.1c"><cn type="integer" id="S3.F6.15.7.m7.1.1.cmml" xref="S3.F6.15.7.m7.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.15.7.m7.1d">6</annotation></semantics></math> attends only to 1, 3, 4, and 7, as indicated by <math id="S3.F6.16.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.F6.16.8.m8.1b"><mi id="S3.F6.16.8.m8.1.1" xref="S3.F6.16.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F6.16.8.m8.1c"><ci id="S3.F6.16.8.m8.1.1.cmml" xref="S3.F6.16.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.16.8.m8.1d">M</annotation></semantics></math>.
</span></figcaption>
</figure>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Overall framework: <span id="S3.SS4.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FlowerFormer</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.5" class="ltx_p">The overall framework of <span id="S3.SS4.p1.5.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> is illustrated in <a href="#S2.F2" title="In 2.1 Neural architecture encoding ‣ 2 Related work ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
For each <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\ell</annotation></semantics></math>, it derives the output node embedding matrix <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="H^{(\ell)}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msup id="S3.SS4.p1.2.m2.1.2" xref="S3.SS4.p1.2.m2.1.2.cmml"><mi id="S3.SS4.p1.2.m2.1.2.2" xref="S3.SS4.p1.2.m2.1.2.2.cmml">H</mi><mrow id="S3.SS4.p1.2.m2.1.1.1.3" xref="S3.SS4.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.1.1.1.3.1" xref="S3.SS4.p1.2.m2.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS4.p1.2.m2.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS4.p1.2.m2.1.1.1.3.2" xref="S3.SS4.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.2.cmml" xref="S3.SS4.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.2">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.2.2.cmml" xref="S3.SS4.p1.2.m2.1.2.2">𝐻</ci><ci id="S3.SS4.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">H^{(\ell)}</annotation></semantics></math> from <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="H^{(\ell)}_{flow}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msubsup id="S3.SS4.p1.3.m3.1.2" xref="S3.SS4.p1.3.m3.1.2.cmml"><mi id="S3.SS4.p1.3.m3.1.2.2.2" xref="S3.SS4.p1.3.m3.1.2.2.2.cmml">H</mi><mrow id="S3.SS4.p1.3.m3.1.2.3" xref="S3.SS4.p1.3.m3.1.2.3.cmml"><mi id="S3.SS4.p1.3.m3.1.2.3.2" xref="S3.SS4.p1.3.m3.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.2.3.1" xref="S3.SS4.p1.3.m3.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.2.3.3" xref="S3.SS4.p1.3.m3.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.2.3.1a" xref="S3.SS4.p1.3.m3.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.2.3.4" xref="S3.SS4.p1.3.m3.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.2.3.1b" xref="S3.SS4.p1.3.m3.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.2.3.5" xref="S3.SS4.p1.3.m3.1.2.3.5.cmml">w</mi></mrow><mrow id="S3.SS4.p1.3.m3.1.1.1.3" xref="S3.SS4.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.3.m3.1.1.1.3.1" xref="S3.SS4.p1.3.m3.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS4.p1.3.m3.1.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS4.p1.3.m3.1.1.1.3.2" xref="S3.SS4.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.2.cmml" xref="S3.SS4.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2">subscript</csymbol><apply id="S3.SS4.p1.3.m3.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.2.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.2.2.2.cmml" xref="S3.SS4.p1.3.m3.1.2.2.2">𝐻</ci><ci id="S3.SS4.p1.3.m3.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1">ℓ</ci></apply><apply id="S3.SS4.p1.3.m3.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.2.3"><times id="S3.SS4.p1.3.m3.1.2.3.1.cmml" xref="S3.SS4.p1.3.m3.1.2.3.1"></times><ci id="S3.SS4.p1.3.m3.1.2.3.2.cmml" xref="S3.SS4.p1.3.m3.1.2.3.2">𝑓</ci><ci id="S3.SS4.p1.3.m3.1.2.3.3.cmml" xref="S3.SS4.p1.3.m3.1.2.3.3">𝑙</ci><ci id="S3.SS4.p1.3.m3.1.2.3.4.cmml" xref="S3.SS4.p1.3.m3.1.2.3.4">𝑜</ci><ci id="S3.SS4.p1.3.m3.1.2.3.5.cmml" xref="S3.SS4.p1.3.m3.1.2.3.5">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">H^{(\ell)}_{flow}</annotation></semantics></math> (<a href="#S3.E4" title="In 3.3.1 Flow encode module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>) and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="H^{(\ell)}_{global}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msubsup id="S3.SS4.p1.4.m4.1.2" xref="S3.SS4.p1.4.m4.1.2.cmml"><mi id="S3.SS4.p1.4.m4.1.2.2.2" xref="S3.SS4.p1.4.m4.1.2.2.2.cmml">H</mi><mrow id="S3.SS4.p1.4.m4.1.2.3" xref="S3.SS4.p1.4.m4.1.2.3.cmml"><mi id="S3.SS4.p1.4.m4.1.2.3.2" xref="S3.SS4.p1.4.m4.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.2.3.1" xref="S3.SS4.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.2.3.3" xref="S3.SS4.p1.4.m4.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.2.3.1a" xref="S3.SS4.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.2.3.4" xref="S3.SS4.p1.4.m4.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.2.3.1b" xref="S3.SS4.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.2.3.5" xref="S3.SS4.p1.4.m4.1.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.2.3.1c" xref="S3.SS4.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.2.3.6" xref="S3.SS4.p1.4.m4.1.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.2.3.1d" xref="S3.SS4.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.2.3.7" xref="S3.SS4.p1.4.m4.1.2.3.7.cmml">l</mi></mrow><mrow id="S3.SS4.p1.4.m4.1.1.1.3" xref="S3.SS4.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.4.m4.1.1.1.3.1" xref="S3.SS4.p1.4.m4.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS4.p1.4.m4.1.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS4.p1.4.m4.1.1.1.3.2" xref="S3.SS4.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.2.cmml" xref="S3.SS4.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.2">subscript</csymbol><apply id="S3.SS4.p1.4.m4.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.2.2.1.cmml" xref="S3.SS4.p1.4.m4.1.2">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.2.2.2.cmml" xref="S3.SS4.p1.4.m4.1.2.2.2">𝐻</ci><ci id="S3.SS4.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1">ℓ</ci></apply><apply id="S3.SS4.p1.4.m4.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.2.3"><times id="S3.SS4.p1.4.m4.1.2.3.1.cmml" xref="S3.SS4.p1.4.m4.1.2.3.1"></times><ci id="S3.SS4.p1.4.m4.1.2.3.2.cmml" xref="S3.SS4.p1.4.m4.1.2.3.2">𝑔</ci><ci id="S3.SS4.p1.4.m4.1.2.3.3.cmml" xref="S3.SS4.p1.4.m4.1.2.3.3">𝑙</ci><ci id="S3.SS4.p1.4.m4.1.2.3.4.cmml" xref="S3.SS4.p1.4.m4.1.2.3.4">𝑜</ci><ci id="S3.SS4.p1.4.m4.1.2.3.5.cmml" xref="S3.SS4.p1.4.m4.1.2.3.5">𝑏</ci><ci id="S3.SS4.p1.4.m4.1.2.3.6.cmml" xref="S3.SS4.p1.4.m4.1.2.3.6">𝑎</ci><ci id="S3.SS4.p1.4.m4.1.2.3.7.cmml" xref="S3.SS4.p1.4.m4.1.2.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">H^{(\ell)}_{global}</annotation></semantics></math> (<a href="#S3.E5" title="In 3.3.2 Flow-aware global attention module ‣ 3.3 Flower layers ‣ 3 Proposed method: FlowerFormer ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a>) for the <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi mathvariant="normal" id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">\ell</annotation></semantics></math>-th layer as follows:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.5" class="ltx_Math" alttext="H^{(\ell)}=\operatorname{FeedForward}(H^{(\ell)}_{flow}+H^{(\ell)}_{global})" display="block"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><msup id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml"><mi id="S3.E6.m1.5.5.3.2" xref="S3.E6.m1.5.5.3.2.cmml">H</mi><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.5.5.3.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.3.1" xref="S3.E6.m1.5.5.3.cmml">(</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.5.5.3.cmml">)</mo></mrow></msup><mo id="S3.E6.m1.5.5.2" xref="S3.E6.m1.5.5.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.2.cmml"><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">FeedForward</mi><mo id="S3.E6.m1.5.5.1.1a" xref="S3.E6.m1.5.5.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.2.cmml">(</mo><mrow id="S3.E6.m1.5.5.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.cmml"><msubsup id="S3.E6.m1.5.5.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.2.2.2" xref="S3.E6.m1.5.5.1.1.1.1.2.2.2.cmml">H</mi><mrow id="S3.E6.m1.5.5.1.1.1.1.2.3" xref="S3.E6.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.2.3.2" xref="S3.E6.m1.5.5.1.1.1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.2.3.1" xref="S3.E6.m1.5.5.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.2.3.3" xref="S3.E6.m1.5.5.1.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.2.3.1a" xref="S3.E6.m1.5.5.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.2.3.4" xref="S3.E6.m1.5.5.1.1.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.2.3.1b" xref="S3.E6.m1.5.5.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.2.3.5" xref="S3.E6.m1.5.5.1.1.1.1.2.3.5.cmml">w</mi></mrow><mrow id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.3.1" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.E6.m1.2.2.1.3.2" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E6.m1.5.5.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.3.2.2" xref="S3.E6.m1.5.5.1.1.1.1.3.2.2.cmml">H</mi><mrow id="S3.E6.m1.5.5.1.1.1.1.3.3" xref="S3.E6.m1.5.5.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.2" xref="S3.E6.m1.5.5.1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.3.3.1" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.3" xref="S3.E6.m1.5.5.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.3.3.1a" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.4" xref="S3.E6.m1.5.5.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.3.3.1b" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.5" xref="S3.E6.m1.5.5.1.1.1.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.3.3.1c" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.6" xref="S3.E6.m1.5.5.1.1.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.1.3.3.1d" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.1.1.3.3.7" xref="S3.E6.m1.5.5.1.1.1.1.3.3.7.cmml">l</mi></mrow><mrow id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.5.5.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.3.1" xref="S3.E6.m1.5.5.1.1.1.1.3.cmml">(</mo><mi mathvariant="normal" id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.3.2" xref="S3.E6.m1.5.5.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5.2"></eq><apply id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.3.1.cmml" xref="S3.E6.m1.5.5.3">superscript</csymbol><ci id="S3.E6.m1.5.5.3.2.cmml" xref="S3.E6.m1.5.5.3.2">𝐻</ci><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">ℓ</ci></apply><apply id="S3.E6.m1.5.5.1.2.cmml" xref="S3.E6.m1.5.5.1.1"><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">FeedForward</ci><apply id="S3.E6.m1.5.5.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1"><plus id="S3.E6.m1.5.5.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"></plus><apply id="S3.E6.m1.5.5.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.2.2">𝐻</ci><ci id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1">ℓ</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3"><times id="S3.E6.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3.2">𝑓</ci><ci id="S3.E6.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3.3">𝑙</ci><ci id="S3.E6.m1.5.5.1.1.1.1.2.3.4.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3.4">𝑜</ci><ci id="S3.E6.m1.5.5.1.1.1.1.2.3.5.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2.3.5">𝑤</ci></apply></apply><apply id="S3.E6.m1.5.5.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.2.2">𝐻</ci><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">ℓ</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3"><times id="S3.E6.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.2">𝑔</ci><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.3">𝑙</ci><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.4">𝑜</ci><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.5.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.5">𝑏</ci><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.6.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.6">𝑎</ci><ci id="S3.E6.m1.5.5.1.1.1.1.3.3.7.cmml" xref="S3.E6.m1.5.5.1.1.1.1.3.3.7">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">H^{(\ell)}=\operatorname{FeedForward}(H^{(\ell)}_{flow}+H^{(\ell)}_{global})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.6" class="ltx_p">In our implementation, we employ a 2-layer MLP with ReLU activation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite> as the feedforward network.
As shown in <a href="#S2.F2" title="In 2.1 Neural architecture encoding ‣ 2 Related work ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, note that we incorporate skip-connection and batch normalization in every module.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">The output <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="H^{(\ell)}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><msup id="S3.SS4.p2.1.m1.1.2" xref="S3.SS4.p2.1.m1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.1.2.2" xref="S3.SS4.p2.1.m1.1.2.2.cmml">H</mi><mrow id="S3.SS4.p2.1.m1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">ℓ</mi><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2">𝐻</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">H^{(\ell)}</annotation></semantics></math> is used as the input of the next <span id="S3.SS4.p2.4.1" class="ltx_text ltx_font_smallcaps">Flower</span> layer, and for the first layer, we utilize a projected input feature matrix as the input by multiplying <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">X</annotation></semantics></math> with a learnable projection matrix <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="P\in\mathbb{R}^{D\times d}" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">P</mi><mo id="S3.SS4.p2.3.m3.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.2" xref="S3.SS4.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.3.m3.1.1.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.3.2" xref="S3.SS4.p2.3.m3.1.1.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p2.3.m3.1.1.3.3.1" xref="S3.SS4.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p2.3.m3.1.1.3.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><in id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1"></in><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝑃</ci><apply id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.3.m3.1.1.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3"><times id="S3.SS4.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.2">𝐷</ci><ci id="S3.SS4.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">P\in\mathbb{R}^{D\times d}</annotation></semantics></math>, i.e., <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="H^{(0)}=XP" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.2" xref="S3.SS4.p2.4.m4.1.2.cmml"><msup id="S3.SS4.p2.4.m4.1.2.2" xref="S3.SS4.p2.4.m4.1.2.2.cmml"><mi id="S3.SS4.p2.4.m4.1.2.2.2" xref="S3.SS4.p2.4.m4.1.2.2.2.cmml">H</mi><mrow id="S3.SS4.p2.4.m4.1.1.1.3" xref="S3.SS4.p2.4.m4.1.2.2.cmml"><mo stretchy="false" id="S3.SS4.p2.4.m4.1.1.1.3.1" xref="S3.SS4.p2.4.m4.1.2.2.cmml">(</mo><mn id="S3.SS4.p2.4.m4.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS4.p2.4.m4.1.1.1.3.2" xref="S3.SS4.p2.4.m4.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS4.p2.4.m4.1.2.1" xref="S3.SS4.p2.4.m4.1.2.1.cmml">=</mo><mrow id="S3.SS4.p2.4.m4.1.2.3" xref="S3.SS4.p2.4.m4.1.2.3.cmml"><mi id="S3.SS4.p2.4.m4.1.2.3.2" xref="S3.SS4.p2.4.m4.1.2.3.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.2.3.1" xref="S3.SS4.p2.4.m4.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.2.3.3" xref="S3.SS4.p2.4.m4.1.2.3.3.cmml">P</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.2.cmml" xref="S3.SS4.p2.4.m4.1.2"><eq id="S3.SS4.p2.4.m4.1.2.1.cmml" xref="S3.SS4.p2.4.m4.1.2.1"></eq><apply id="S3.SS4.p2.4.m4.1.2.2.cmml" xref="S3.SS4.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.2.2.1.cmml" xref="S3.SS4.p2.4.m4.1.2.2">superscript</csymbol><ci id="S3.SS4.p2.4.m4.1.2.2.2.cmml" xref="S3.SS4.p2.4.m4.1.2.2.2">𝐻</ci><cn type="integer" id="S3.SS4.p2.4.m4.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1">0</cn></apply><apply id="S3.SS4.p2.4.m4.1.2.3.cmml" xref="S3.SS4.p2.4.m4.1.2.3"><times id="S3.SS4.p2.4.m4.1.2.3.1.cmml" xref="S3.SS4.p2.4.m4.1.2.3.1"></times><ci id="S3.SS4.p2.4.m4.1.2.3.2.cmml" xref="S3.SS4.p2.4.m4.1.2.3.2">𝑋</ci><ci id="S3.SS4.p2.4.m4.1.2.3.3.cmml" xref="S3.SS4.p2.4.m4.1.2.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">H^{(0)}=XP</annotation></semantics></math>.
Each <span id="S3.SS4.p2.4.2" class="ltx_text ltx_font_smallcaps">Flower</span> layer has a separate set of learnable parameters.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.4" class="ltx_p">The node embeddings in the output <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="H^{(L)}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><msup id="S3.SS4.p3.1.m1.1.2" xref="S3.SS4.p3.1.m1.1.2.cmml"><mi id="S3.SS4.p3.1.m1.1.2.2" xref="S3.SS4.p3.1.m1.1.2.2.cmml">H</mi><mrow id="S3.SS4.p3.1.m1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.1.m1.1.1.1.3.1" xref="S3.SS4.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS4.p3.1.m1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.SS4.p3.1.m1.1.1.1.3.2" xref="S3.SS4.p3.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2">superscript</csymbol><ci id="S3.SS4.p3.1.m1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2">𝐻</ci><ci id="S3.SS4.p3.1.m1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">H^{(L)}</annotation></semantics></math>, where <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">L</annotation></semantics></math> represents the total number of <span id="S3.SS4.p3.4.1" class="ltx_text ltx_font_smallcaps">Flower</span> layers, are aggregated to drive the final embedding <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="z_{G}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><msub id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">z</mi><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">𝑧</ci><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">z_{G}</annotation></semantics></math> of the input neural-architecture graph <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">G</annotation></semantics></math> as follows:</p>
<table id="S3.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex5.m1.3" class="ltx_Math" alttext="z_{G}=\operatorname{READOUT}(H^{(L)}),~{}" display="block"><semantics id="S3.Ex5.m1.3a"><mrow id="S3.Ex5.m1.3.3.1" xref="S3.Ex5.m1.3.3.1.1.cmml"><mrow id="S3.Ex5.m1.3.3.1.1" xref="S3.Ex5.m1.3.3.1.1.cmml"><msub id="S3.Ex5.m1.3.3.1.1.3" xref="S3.Ex5.m1.3.3.1.1.3.cmml"><mi id="S3.Ex5.m1.3.3.1.1.3.2" xref="S3.Ex5.m1.3.3.1.1.3.2.cmml">z</mi><mi id="S3.Ex5.m1.3.3.1.1.3.3" xref="S3.Ex5.m1.3.3.1.1.3.3.cmml">G</mi></msub><mo id="S3.Ex5.m1.3.3.1.1.2" xref="S3.Ex5.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex5.m1.3.3.1.1.1.1" xref="S3.Ex5.m1.3.3.1.1.1.2.cmml"><mi id="S3.Ex5.m1.2.2" xref="S3.Ex5.m1.2.2.cmml">READOUT</mi><mo id="S3.Ex5.m1.3.3.1.1.1.1a" xref="S3.Ex5.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex5.m1.3.3.1.1.1.1.1" xref="S3.Ex5.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex5.m1.3.3.1.1.1.1.1.2" xref="S3.Ex5.m1.3.3.1.1.1.2.cmml">(</mo><msup id="S3.Ex5.m1.3.3.1.1.1.1.1.1" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.2.cmml">H</mi><mrow id="S3.Ex5.m1.1.1.1.3" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex5.m1.1.1.1.3.1" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.Ex5.m1.1.1.1.3.2" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.Ex5.m1.3.3.1.1.1.1.1.3" xref="S3.Ex5.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5.m1.3.3.1.2" xref="S3.Ex5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.3b"><apply id="S3.Ex5.m1.3.3.1.1.cmml" xref="S3.Ex5.m1.3.3.1"><eq id="S3.Ex5.m1.3.3.1.1.2.cmml" xref="S3.Ex5.m1.3.3.1.1.2"></eq><apply id="S3.Ex5.m1.3.3.1.1.3.cmml" xref="S3.Ex5.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.3.3.1.1.3.1.cmml" xref="S3.Ex5.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex5.m1.3.3.1.1.3.2.cmml" xref="S3.Ex5.m1.3.3.1.1.3.2">𝑧</ci><ci id="S3.Ex5.m1.3.3.1.1.3.3.cmml" xref="S3.Ex5.m1.3.3.1.1.3.3">𝐺</ci></apply><apply id="S3.Ex5.m1.3.3.1.1.1.2.cmml" xref="S3.Ex5.m1.3.3.1.1.1.1"><ci id="S3.Ex5.m1.2.2.cmml" xref="S3.Ex5.m1.2.2">READOUT</ci><apply id="S3.Ex5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.3.3.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.3c">z_{G}=\operatorname{READOUT}(H^{(L)}),~{}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.5" class="ltx_p">For aggregation, we use mean pooling as the readout function in our implementation.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para ltx_noindent">
<p id="S3.SS4.p4.2" class="ltx_p"><span id="S3.SS4.p4.2.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Application to performance prediction:</span>
The architecture embedding <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="z_{G}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><msub id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">z</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑧</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">z_{G}</annotation></semantics></math> is used for downstream tasks. For example, for performance prediction, it may serve as input to a regressor that outputs the estimated performance <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="\hat{y}_{G}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><msub id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2.2" xref="S3.SS4.p4.2.m2.1.1.2.2.cmml">y</mi><mo id="S3.SS4.p4.2.m2.1.1.2.1" xref="S3.SS4.p4.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2"><ci id="S3.SS4.p4.2.m2.1.1.2.1.cmml" xref="S3.SS4.p4.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p4.2.m2.1.1.2.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">\hat{y}_{G}</annotation></semantics></math> as follows:</p>
<table id="S3.Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex6.m1.2" class="ltx_Math" alttext="\hat{y}_{G}=\operatorname{Regressor}(z_{G}).~{}" display="block"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2.2.1" xref="S3.Ex6.m1.2.2.1.1.cmml"><mrow id="S3.Ex6.m1.2.2.1.1" xref="S3.Ex6.m1.2.2.1.1.cmml"><msub id="S3.Ex6.m1.2.2.1.1.3" xref="S3.Ex6.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.Ex6.m1.2.2.1.1.3.2" xref="S3.Ex6.m1.2.2.1.1.3.2.cmml"><mi id="S3.Ex6.m1.2.2.1.1.3.2.2" xref="S3.Ex6.m1.2.2.1.1.3.2.2.cmml">y</mi><mo id="S3.Ex6.m1.2.2.1.1.3.2.1" xref="S3.Ex6.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.Ex6.m1.2.2.1.1.3.3" xref="S3.Ex6.m1.2.2.1.1.3.3.cmml">G</mi></msub><mo id="S3.Ex6.m1.2.2.1.1.2" xref="S3.Ex6.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml"><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">Regressor</mi><mo id="S3.Ex6.m1.2.2.1.1.1.1a" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex6.m1.2.2.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml">(</mo><msub id="S3.Ex6.m1.2.2.1.1.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.Ex6.m1.2.2.1.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex6.m1.2.2.1.2" xref="S3.Ex6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.2b"><apply id="S3.Ex6.m1.2.2.1.1.cmml" xref="S3.Ex6.m1.2.2.1"><eq id="S3.Ex6.m1.2.2.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.2"></eq><apply id="S3.Ex6.m1.2.2.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.3.1.cmml" xref="S3.Ex6.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.Ex6.m1.2.2.1.1.3.2.cmml" xref="S3.Ex6.m1.2.2.1.1.3.2"><ci id="S3.Ex6.m1.2.2.1.1.3.2.1.cmml" xref="S3.Ex6.m1.2.2.1.1.3.2.1">^</ci><ci id="S3.Ex6.m1.2.2.1.1.3.2.2.cmml" xref="S3.Ex6.m1.2.2.1.1.3.2.2">𝑦</ci></apply><ci id="S3.Ex6.m1.2.2.1.1.3.3.cmml" xref="S3.Ex6.m1.2.2.1.1.3.3">𝐺</ci></apply><apply id="S3.Ex6.m1.2.2.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1"><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">Regressor</ci><apply id="S3.Ex6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.1.1.3">𝐺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">\hat{y}_{G}=\operatorname{Regressor}(z_{G}).~{}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.14" class="ltx_p">In <a href="#S4" title="4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we employ a fully connected layer as the regressor and utilize the following margin ranking loss for training both <span id="S3.SS4.p4.14.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> and the regressor:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.5" class="ltx_Math" alttext="\mathcal{L}=\sum_{(i,j):y_{i}&gt;y_{j}}\max(0,\text{margin}-(\hat{y}_{i}-\hat{y}_{j}))," display="block"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.3.cmml">ℒ</mi><mo rspace="0.111em" id="S3.E7.m1.5.5.1.1.2" xref="S3.E7.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.cmml"><munder id="S3.E7.m1.5.5.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E7.m1.5.5.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mrow id="S3.E7.m1.2.2.2.4.2" xref="S3.E7.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.4.2.1" xref="S3.E7.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.2.2" xref="S3.E7.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">j</mi><mo rspace="0.278em" stretchy="false" id="S3.E7.m1.2.2.2.4.2.3" xref="S3.E7.m1.2.2.2.4.1.cmml">)</mo></mrow><mo rspace="0.278em" id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">:</mo><mrow id="S3.E7.m1.2.2.2.5" xref="S3.E7.m1.2.2.2.5.cmml"><msub id="S3.E7.m1.2.2.2.5.2" xref="S3.E7.m1.2.2.2.5.2.cmml"><mi id="S3.E7.m1.2.2.2.5.2.2" xref="S3.E7.m1.2.2.2.5.2.2.cmml">y</mi><mi id="S3.E7.m1.2.2.2.5.2.3" xref="S3.E7.m1.2.2.2.5.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.2.5.1" xref="S3.E7.m1.2.2.2.5.1.cmml">&gt;</mo><msub id="S3.E7.m1.2.2.2.5.3" xref="S3.E7.m1.2.2.2.5.3.cmml"><mi id="S3.E7.m1.2.2.2.5.3.2" xref="S3.E7.m1.2.2.2.5.3.2.cmml">y</mi><mi id="S3.E7.m1.2.2.2.5.3.3" xref="S3.E7.m1.2.2.2.5.3.3.cmml">j</mi></msub></mrow></mrow></munder><mrow id="S3.E7.m1.5.5.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">max</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1a" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">(</mo><mn id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">0</mn><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">,</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml"><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.3a.cmml">margin</mtext><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.4" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><eq id="S3.E7.m1.5.5.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2"></eq><ci id="S3.E7.m1.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.3">ℒ</ci><apply id="S3.E7.m1.5.5.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><apply id="S3.E7.m1.5.5.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.5.5.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.2.2"></sum><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><ci id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3">:</ci><interval closure="open" id="S3.E7.m1.2.2.2.4.1.cmml" xref="S3.E7.m1.2.2.2.4.2"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑗</ci></interval><apply id="S3.E7.m1.2.2.2.5.cmml" xref="S3.E7.m1.2.2.2.5"><gt id="S3.E7.m1.2.2.2.5.1.cmml" xref="S3.E7.m1.2.2.2.5.1"></gt><apply id="S3.E7.m1.2.2.2.5.2.cmml" xref="S3.E7.m1.2.2.2.5.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.5.2.1.cmml" xref="S3.E7.m1.2.2.2.5.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.5.2.2.cmml" xref="S3.E7.m1.2.2.2.5.2.2">𝑦</ci><ci id="S3.E7.m1.2.2.2.5.2.3.cmml" xref="S3.E7.m1.2.2.2.5.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.5.3.cmml" xref="S3.E7.m1.2.2.2.5.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.5.3.1.cmml" xref="S3.E7.m1.2.2.2.5.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.5.3.2.cmml" xref="S3.E7.m1.2.2.2.5.3.2">𝑦</ci><ci id="S3.E7.m1.2.2.2.5.3.3.cmml" xref="S3.E7.m1.2.2.2.5.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1"><max id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"></max><cn type="integer" id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">0</cn><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1"><minus id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2"></minus><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3a.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.3"><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.3">margin</mtext></ci><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\mathcal{L}=\sum_{(i,j):y_{i}&gt;y_{j}}\max(0,\text{margin}-(\hat{y}_{i}-\hat{y}_{j})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.13" class="ltx_p">where <math id="S3.SS4.p4.3.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S3.SS4.p4.3.m1.1a"><msub id="S3.SS4.p4.3.m1.1.1" xref="S3.SS4.p4.3.m1.1.1.cmml"><mi id="S3.SS4.p4.3.m1.1.1.2" xref="S3.SS4.p4.3.m1.1.1.2.cmml">y</mi><mi id="S3.SS4.p4.3.m1.1.1.3" xref="S3.SS4.p4.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m1.1b"><apply id="S3.SS4.p4.3.m1.1.1.cmml" xref="S3.SS4.p4.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m1.1.1.1.cmml" xref="S3.SS4.p4.3.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.3.m1.1.1.2.cmml" xref="S3.SS4.p4.3.m1.1.1.2">𝑦</ci><ci id="S3.SS4.p4.3.m1.1.1.3.cmml" xref="S3.SS4.p4.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m1.1c">y_{i}</annotation></semantics></math> and <math id="S3.SS4.p4.4.m2.1" class="ltx_Math" alttext="y_{j}" display="inline"><semantics id="S3.SS4.p4.4.m2.1a"><msub id="S3.SS4.p4.4.m2.1.1" xref="S3.SS4.p4.4.m2.1.1.cmml"><mi id="S3.SS4.p4.4.m2.1.1.2" xref="S3.SS4.p4.4.m2.1.1.2.cmml">y</mi><mi id="S3.SS4.p4.4.m2.1.1.3" xref="S3.SS4.p4.4.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m2.1b"><apply id="S3.SS4.p4.4.m2.1.1.cmml" xref="S3.SS4.p4.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m2.1.1.1.cmml" xref="S3.SS4.p4.4.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.4.m2.1.1.2.cmml" xref="S3.SS4.p4.4.m2.1.1.2">𝑦</ci><ci id="S3.SS4.p4.4.m2.1.1.3.cmml" xref="S3.SS4.p4.4.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m2.1c">y_{j}</annotation></semantics></math> are the ground-truth performances of architectures <math id="S3.SS4.p4.5.m3.1" class="ltx_Math" alttext="G_{i}" display="inline"><semantics id="S3.SS4.p4.5.m3.1a"><msub id="S3.SS4.p4.5.m3.1.1" xref="S3.SS4.p4.5.m3.1.1.cmml"><mi id="S3.SS4.p4.5.m3.1.1.2" xref="S3.SS4.p4.5.m3.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.5.m3.1.1.3" xref="S3.SS4.p4.5.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m3.1b"><apply id="S3.SS4.p4.5.m3.1.1.cmml" xref="S3.SS4.p4.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m3.1.1.1.cmml" xref="S3.SS4.p4.5.m3.1.1">subscript</csymbol><ci id="S3.SS4.p4.5.m3.1.1.2.cmml" xref="S3.SS4.p4.5.m3.1.1.2">𝐺</ci><ci id="S3.SS4.p4.5.m3.1.1.3.cmml" xref="S3.SS4.p4.5.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m3.1c">G_{i}</annotation></semantics></math> and <math id="S3.SS4.p4.6.m4.1" class="ltx_Math" alttext="G_{j}" display="inline"><semantics id="S3.SS4.p4.6.m4.1a"><msub id="S3.SS4.p4.6.m4.1.1" xref="S3.SS4.p4.6.m4.1.1.cmml"><mi id="S3.SS4.p4.6.m4.1.1.2" xref="S3.SS4.p4.6.m4.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.6.m4.1.1.3" xref="S3.SS4.p4.6.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m4.1b"><apply id="S3.SS4.p4.6.m4.1.1.cmml" xref="S3.SS4.p4.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.6.m4.1.1.1.cmml" xref="S3.SS4.p4.6.m4.1.1">subscript</csymbol><ci id="S3.SS4.p4.6.m4.1.1.2.cmml" xref="S3.SS4.p4.6.m4.1.1.2">𝐺</ci><ci id="S3.SS4.p4.6.m4.1.1.3.cmml" xref="S3.SS4.p4.6.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m4.1c">G_{j}</annotation></semantics></math>, respectively.
For each pair of architectures <math id="S3.SS4.p4.7.m5.1" class="ltx_Math" alttext="G_{i}" display="inline"><semantics id="S3.SS4.p4.7.m5.1a"><msub id="S3.SS4.p4.7.m5.1.1" xref="S3.SS4.p4.7.m5.1.1.cmml"><mi id="S3.SS4.p4.7.m5.1.1.2" xref="S3.SS4.p4.7.m5.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.7.m5.1.1.3" xref="S3.SS4.p4.7.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.m5.1b"><apply id="S3.SS4.p4.7.m5.1.1.cmml" xref="S3.SS4.p4.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.7.m5.1.1.1.cmml" xref="S3.SS4.p4.7.m5.1.1">subscript</csymbol><ci id="S3.SS4.p4.7.m5.1.1.2.cmml" xref="S3.SS4.p4.7.m5.1.1.2">𝐺</ci><ci id="S3.SS4.p4.7.m5.1.1.3.cmml" xref="S3.SS4.p4.7.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.m5.1c">G_{i}</annotation></semantics></math> and <math id="S3.SS4.p4.8.m6.1" class="ltx_Math" alttext="G_{j}" display="inline"><semantics id="S3.SS4.p4.8.m6.1a"><msub id="S3.SS4.p4.8.m6.1.1" xref="S3.SS4.p4.8.m6.1.1.cmml"><mi id="S3.SS4.p4.8.m6.1.1.2" xref="S3.SS4.p4.8.m6.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.8.m6.1.1.3" xref="S3.SS4.p4.8.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.8.m6.1b"><apply id="S3.SS4.p4.8.m6.1.1.cmml" xref="S3.SS4.p4.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.8.m6.1.1.1.cmml" xref="S3.SS4.p4.8.m6.1.1">subscript</csymbol><ci id="S3.SS4.p4.8.m6.1.1.2.cmml" xref="S3.SS4.p4.8.m6.1.1.2">𝐺</ci><ci id="S3.SS4.p4.8.m6.1.1.3.cmml" xref="S3.SS4.p4.8.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.8.m6.1c">G_{j}</annotation></semantics></math> in the training set such that <math id="S3.SS4.p4.9.m7.1" class="ltx_Math" alttext="G_{i}" display="inline"><semantics id="S3.SS4.p4.9.m7.1a"><msub id="S3.SS4.p4.9.m7.1.1" xref="S3.SS4.p4.9.m7.1.1.cmml"><mi id="S3.SS4.p4.9.m7.1.1.2" xref="S3.SS4.p4.9.m7.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.9.m7.1.1.3" xref="S3.SS4.p4.9.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.9.m7.1b"><apply id="S3.SS4.p4.9.m7.1.1.cmml" xref="S3.SS4.p4.9.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.9.m7.1.1.1.cmml" xref="S3.SS4.p4.9.m7.1.1">subscript</csymbol><ci id="S3.SS4.p4.9.m7.1.1.2.cmml" xref="S3.SS4.p4.9.m7.1.1.2">𝐺</ci><ci id="S3.SS4.p4.9.m7.1.1.3.cmml" xref="S3.SS4.p4.9.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.9.m7.1c">G_{i}</annotation></semantics></math> outperforms <math id="S3.SS4.p4.10.m8.1" class="ltx_Math" alttext="G_{j}" display="inline"><semantics id="S3.SS4.p4.10.m8.1a"><msub id="S3.SS4.p4.10.m8.1.1" xref="S3.SS4.p4.10.m8.1.1.cmml"><mi id="S3.SS4.p4.10.m8.1.1.2" xref="S3.SS4.p4.10.m8.1.1.2.cmml">G</mi><mi id="S3.SS4.p4.10.m8.1.1.3" xref="S3.SS4.p4.10.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.10.m8.1b"><apply id="S3.SS4.p4.10.m8.1.1.cmml" xref="S3.SS4.p4.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.10.m8.1.1.1.cmml" xref="S3.SS4.p4.10.m8.1.1">subscript</csymbol><ci id="S3.SS4.p4.10.m8.1.1.2.cmml" xref="S3.SS4.p4.10.m8.1.1.2">𝐺</ci><ci id="S3.SS4.p4.10.m8.1.1.3.cmml" xref="S3.SS4.p4.10.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.10.m8.1c">G_{j}</annotation></semantics></math> (i.e., <math id="S3.SS4.p4.11.m9.1" class="ltx_Math" alttext="y_{i}&gt;y_{j}" display="inline"><semantics id="S3.SS4.p4.11.m9.1a"><mrow id="S3.SS4.p4.11.m9.1.1" xref="S3.SS4.p4.11.m9.1.1.cmml"><msub id="S3.SS4.p4.11.m9.1.1.2" xref="S3.SS4.p4.11.m9.1.1.2.cmml"><mi id="S3.SS4.p4.11.m9.1.1.2.2" xref="S3.SS4.p4.11.m9.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p4.11.m9.1.1.2.3" xref="S3.SS4.p4.11.m9.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p4.11.m9.1.1.1" xref="S3.SS4.p4.11.m9.1.1.1.cmml">&gt;</mo><msub id="S3.SS4.p4.11.m9.1.1.3" xref="S3.SS4.p4.11.m9.1.1.3.cmml"><mi id="S3.SS4.p4.11.m9.1.1.3.2" xref="S3.SS4.p4.11.m9.1.1.3.2.cmml">y</mi><mi id="S3.SS4.p4.11.m9.1.1.3.3" xref="S3.SS4.p4.11.m9.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.11.m9.1b"><apply id="S3.SS4.p4.11.m9.1.1.cmml" xref="S3.SS4.p4.11.m9.1.1"><gt id="S3.SS4.p4.11.m9.1.1.1.cmml" xref="S3.SS4.p4.11.m9.1.1.1"></gt><apply id="S3.SS4.p4.11.m9.1.1.2.cmml" xref="S3.SS4.p4.11.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.11.m9.1.1.2.1.cmml" xref="S3.SS4.p4.11.m9.1.1.2">subscript</csymbol><ci id="S3.SS4.p4.11.m9.1.1.2.2.cmml" xref="S3.SS4.p4.11.m9.1.1.2.2">𝑦</ci><ci id="S3.SS4.p4.11.m9.1.1.2.3.cmml" xref="S3.SS4.p4.11.m9.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p4.11.m9.1.1.3.cmml" xref="S3.SS4.p4.11.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.11.m9.1.1.3.1.cmml" xref="S3.SS4.p4.11.m9.1.1.3">subscript</csymbol><ci id="S3.SS4.p4.11.m9.1.1.3.2.cmml" xref="S3.SS4.p4.11.m9.1.1.3.2">𝑦</ci><ci id="S3.SS4.p4.11.m9.1.1.3.3.cmml" xref="S3.SS4.p4.11.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.11.m9.1c">y_{i}&gt;y_{j}</annotation></semantics></math>), the loss encourages <math id="S3.SS4.p4.12.m10.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S3.SS4.p4.12.m10.1a"><msub id="S3.SS4.p4.12.m10.1.1" xref="S3.SS4.p4.12.m10.1.1.cmml"><mover accent="true" id="S3.SS4.p4.12.m10.1.1.2" xref="S3.SS4.p4.12.m10.1.1.2.cmml"><mi id="S3.SS4.p4.12.m10.1.1.2.2" xref="S3.SS4.p4.12.m10.1.1.2.2.cmml">y</mi><mo id="S3.SS4.p4.12.m10.1.1.2.1" xref="S3.SS4.p4.12.m10.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p4.12.m10.1.1.3" xref="S3.SS4.p4.12.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.12.m10.1b"><apply id="S3.SS4.p4.12.m10.1.1.cmml" xref="S3.SS4.p4.12.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.12.m10.1.1.1.cmml" xref="S3.SS4.p4.12.m10.1.1">subscript</csymbol><apply id="S3.SS4.p4.12.m10.1.1.2.cmml" xref="S3.SS4.p4.12.m10.1.1.2"><ci id="S3.SS4.p4.12.m10.1.1.2.1.cmml" xref="S3.SS4.p4.12.m10.1.1.2.1">^</ci><ci id="S3.SS4.p4.12.m10.1.1.2.2.cmml" xref="S3.SS4.p4.12.m10.1.1.2.2">𝑦</ci></apply><ci id="S3.SS4.p4.12.m10.1.1.3.cmml" xref="S3.SS4.p4.12.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.12.m10.1c">\hat{y}_{i}</annotation></semantics></math> to be greater than <math id="S3.SS4.p4.13.m11.1" class="ltx_Math" alttext="\hat{y}_{j}" display="inline"><semantics id="S3.SS4.p4.13.m11.1a"><msub id="S3.SS4.p4.13.m11.1.1" xref="S3.SS4.p4.13.m11.1.1.cmml"><mover accent="true" id="S3.SS4.p4.13.m11.1.1.2" xref="S3.SS4.p4.13.m11.1.1.2.cmml"><mi id="S3.SS4.p4.13.m11.1.1.2.2" xref="S3.SS4.p4.13.m11.1.1.2.2.cmml">y</mi><mo id="S3.SS4.p4.13.m11.1.1.2.1" xref="S3.SS4.p4.13.m11.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p4.13.m11.1.1.3" xref="S3.SS4.p4.13.m11.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.13.m11.1b"><apply id="S3.SS4.p4.13.m11.1.1.cmml" xref="S3.SS4.p4.13.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.13.m11.1.1.1.cmml" xref="S3.SS4.p4.13.m11.1.1">subscript</csymbol><apply id="S3.SS4.p4.13.m11.1.1.2.cmml" xref="S3.SS4.p4.13.m11.1.1.2"><ci id="S3.SS4.p4.13.m11.1.1.2.1.cmml" xref="S3.SS4.p4.13.m11.1.1.2.1">^</ci><ci id="S3.SS4.p4.13.m11.1.1.2.2.cmml" xref="S3.SS4.p4.13.m11.1.1.2.2">𝑦</ci></apply><ci id="S3.SS4.p4.13.m11.1.1.3.cmml" xref="S3.SS4.p4.13.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.13.m11.1c">\hat{y}_{j}</annotation></semantics></math> by at least a specified margin.
Such designs for loss functions are commonly employed when it is important to make relative comparisons among instances (in our case, we compare neural architectures to recommend better ones).</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we review our experiments. For evaluation, we focus on the downstream task of predicting the performance of neural architectures.
In <a href="#S4.SS2" title="4.2 Performance on computer vision benchmarks ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>, we compare the accuracies of <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> and six baseline methods, including two state-of-the-art methods (spec., TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> and NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>) using three performance prediction benchmark datasets composed of computer vision model architectures.
In <a href="#S4.SS3" title="4.3 Ablation studies ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.3</span></a>, we conduct an ablation study to validate each component of <span id="S4.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.
In <a href="#S4.SS4" title="4.4 Performance in various domains ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.4</span></a>, we extend our evaluation to datasets consisting of graph neural networks and auto speech recognition models.
In <a href="#S4.SS5" title="4.5 Training and inference speed ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.5</span></a>, we examine the training and inference speed of <span id="S4.p1.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental settings</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Below, we provide an overview of our experimental setup.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">We evaluate the effectiveness of neural architecture encoding methods using five benchmark datasets designed for performance prediction, spanning three domains:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Computer vision:</span> We use three datasets: NAS-Bench-101 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib51" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">51</span></a>, <a href="#bib.bib53" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">53</span></a>]</cite>, NAS-Bench-201 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib10" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite>, and NAS-Bench-301 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib54" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite>. These datasets contain computer vision models.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Speech recognition:</span> We employ NAS-Bench-ASR <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib28" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite>, which consists of auto speech recognition architectures.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Graph learning:</span> We include NAS-Bench-Graph <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib36" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite>, which consists of graph neural networks.</p>
</div>
</li>
</ul>
<p id="S4.SS1.SSS1.p1.2" class="ltx_p">Refer to <a href="#S4.T1" title="In 4.1.3 Training and Evaluation protocol ‣ 4.1 Experimental settings ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, for basic statistics, and the supplementary material,
for details including our preprocessing methods.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Baseline methods</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We utilize six baseline approaches, categorized as follows:
<span id="S4.SS1.SSS2.p1.1.1" class="ltx_text ltx_font_bold">(a) Graph neural networks:</span> GatedGCN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> and directed acyclic graph neural network (DAGNN) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>, <span id="S4.SS1.SSS2.p1.1.2" class="ltx_text ltx_font_bold">(b) Graph transformers:</span> GraphGPS <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> and DAGFormer <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>, and
<span id="S4.SS1.SSS2.p1.1.3" class="ltx_text ltx_font_bold">(c) Neural architecture encoders:</span> TA-GATES <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> and NAR-Former <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>, which are state-of-the-art methods for neural architecture performance prediction.
We use the official implementations of these methods, and the links can be found in the supplementary material.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Training and Evaluation protocol</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.1" class="ltx_p">For model training and evaluation, we follow the setting in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, including their training and test splits.
We use a subset of the training split as the actual training set, varying the size of this subset: 1%, 5%, 10%, and 50% of the training split.
We use the first 40 architectures in the test split as a validation set for hyperparameter tuning and early stopping, the remaining ones in the split as a test set.
In each setting, we perform 9 trials using the three different splits and three different random seeds, and we report the mean and standard deviation across these trials.
As accuracy metrics, we use Kendall’s Tau <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">40</span></a>]</cite> to assess overall performance and Precision@K (which measures the proportion of correctly predicted top-K architectures among the true top-K outperforming architectures) for the performance of identifying the best architectures.
Note that these metrics are commonly employed in the field of neural architecture encoding <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib31" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">31</span></a>, <a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>, <a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.3.2" class="ltx_text" style="font-size:90%;">Basic information about the benchmark datasets we used. The sizes of the training and test splits used in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> are reported. Refer to <a href="#S4.SS1.SSS3" title="4.1.3 Training and Evaluation protocol ‣ 4.1 Experimental settings ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.1.3</span></a> for details about training and test splits.</span></figcaption>
<div id="S4.T1.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:243.8pt;height:122.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-21.5pt,10.8pt) scale(0.85,0.85) ;">
<table id="S4.T1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.1.1" class="ltx_tr">
<td id="S4.T1.4.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="4"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.4.1.2" class="ltx_tr">
<td id="S4.T1.4.1.2.1" class="ltx_td ltx_align_left ltx_border_r">Dataset</td>
<td id="S4.T1.4.1.2.2" class="ltx_td ltx_align_center ltx_border_r">Domain</td>
<td id="S4.T1.4.1.2.3" class="ltx_td ltx_align_right ltx_border_r"># trains</td>
<td id="S4.T1.4.1.2.4" class="ltx_td ltx_align_right"># tests</td>
</tr>
<tr id="S4.T1.4.1.3" class="ltx_tr">
<td id="S4.T1.4.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NAS-Bench-101</td>
<td id="S4.T1.4.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T1.4.1.3.2.1" class="ltx_text">Computer vision</span></td>
<td id="S4.T1.4.1.3.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">7,290</td>
<td id="S4.T1.4.1.3.4" class="ltx_td ltx_align_right ltx_border_t">7,290</td>
</tr>
<tr id="S4.T1.4.1.4" class="ltx_tr">
<td id="S4.T1.4.1.4.1" class="ltx_td ltx_align_left ltx_border_r">NAS-Bench-201</td>
<td id="S4.T1.4.1.4.2" class="ltx_td ltx_align_right ltx_border_r">7,813</td>
<td id="S4.T1.4.1.4.3" class="ltx_td ltx_align_right">7,812</td>
</tr>
<tr id="S4.T1.4.1.5" class="ltx_tr">
<td id="S4.T1.4.1.5.1" class="ltx_td ltx_align_left ltx_border_r">NAS-Bench-301</td>
<td id="S4.T1.4.1.5.2" class="ltx_td ltx_align_right ltx_border_r">5,896</td>
<td id="S4.T1.4.1.5.3" class="ltx_td ltx_align_right">51,072</td>
</tr>
<tr id="S4.T1.4.1.6" class="ltx_tr">
<td id="S4.T1.4.1.6.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NAS-Bench-ASR</td>
<td id="S4.T1.4.1.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Speech recognition</td>
<td id="S4.T1.4.1.6.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">4,121</td>
<td id="S4.T1.4.1.6.4" class="ltx_td ltx_align_right ltx_border_t">4,121</td>
</tr>
<tr id="S4.T1.4.1.7" class="ltx_tr">
<td id="S4.T1.4.1.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NAS-Bench-Graph</td>
<td id="S4.T1.4.1.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Graph learning</td>
<td id="S4.T1.4.1.7.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">13,103</td>
<td id="S4.T1.4.1.7.4" class="ltx_td ltx_align_right ltx_border_t">13,103</td>
</tr>
<tr id="S4.T1.4.1.8" class="ltx_tr">
<td id="S4.T1.4.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="4"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.6.2" class="ltx_text" style="font-size:90%;">Kendall’s Tau (scaled up by a factor of 100, mean and standard deviation over 9 trials) on three datasets: NAS-Bench-101, NAS-Bench-201, NAS-Bench 301. In each setting, the best performances are highlighted in <span id="S4.T2.6.2.1" class="ltx_text" style="color:#00B300;">green</span>.
<span id="S4.T2.6.2.2" class="ltx_text ltx_font_bold">NA</span>: there is no trivial extension of NAR-Former to NAS-Bench-301, which consists of two-cell architectures.
Note that, in every setting, <span id="S4.T2.6.2.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> performs best.
</span></figcaption>
<div id="S4.T2.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:621.9pt;height:149.3pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-103.7pt,24.8pt) scale(0.75,0.75) ;">
<table id="S4.T2.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.7.1.1" class="ltx_tr">
<td id="S4.T2.7.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="14"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T2.7.1.2" class="ltx_tr">
<td id="S4.T2.7.1.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Datasets</td>
<td id="S4.T2.7.1.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-101</td>
<td id="S4.T2.7.1.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-201</td>
<td id="S4.T2.7.1.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-301</td>
<td id="S4.T2.7.1.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Avg.</td>
</tr>
<tr id="S4.T2.7.1.3" class="ltx_tr">
<td id="S4.T2.7.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Training portions</td>
<td id="S4.T2.7.1.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1%</td>
<td id="S4.T2.7.1.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5%</td>
<td id="S4.T2.7.1.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10%</td>
<td id="S4.T2.7.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50%</td>
<td id="S4.T2.7.1.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1%</td>
<td id="S4.T2.7.1.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5%</td>
<td id="S4.T2.7.1.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10%</td>
<td id="S4.T2.7.1.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50%</td>
<td id="S4.T2.7.1.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1%</td>
<td id="S4.T2.7.1.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5%</td>
<td id="S4.T2.7.1.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10%</td>
<td id="S4.T2.7.1.3.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50%</td>
<td id="S4.T2.7.1.3.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Rank</td>
</tr>
<tr id="S4.T2.7.1.4" class="ltx_tr">
<td id="S4.T2.7.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">GatedGCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>
</td>
<td id="S4.T2.7.1.4.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.4 <span id="S4.T2.7.1.4.2.1" class="ltx_text" style="font-size:70%;">(6.0)</span>
</td>
<td id="S4.T2.7.1.4.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.6 <span id="S4.T2.7.1.4.3.1" class="ltx_text" style="font-size:70%;">(4.1)</span>
</td>
<td id="S4.T2.7.1.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.0 <span id="S4.T2.7.1.4.4.1" class="ltx_text" style="font-size:70%;">(5.1)</span>
</td>
<td id="S4.T2.7.1.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.8 <span id="S4.T2.7.1.4.5.1" class="ltx_text" style="font-size:70%;">(5.9)</span>
</td>
<td id="S4.T2.7.1.4.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.9 <span id="S4.T2.7.1.4.6.1" class="ltx_text" style="font-size:70%;">(1.8)</span>
</td>
<td id="S4.T2.7.1.4.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.1 <span id="S4.T2.7.1.4.7.1" class="ltx_text" style="font-size:70%;">(0.6)</span>
</td>
<td id="S4.T2.7.1.4.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.6 <span id="S4.T2.7.1.4.8.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
<td id="S4.T2.7.1.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.3 <span id="S4.T2.7.1.4.9.1" class="ltx_text" style="font-size:70%;">(0.1)</span>
</td>
<td id="S4.T2.7.1.4.10" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.4.10.1" class="ltx_text" style="background-color:#FFFFFF;">61.8 <span id="S4.T2.7.1.4.10.1.1" class="ltx_text" style="font-size:70%;">(2.4)</span></span></td>
<td id="S4.T2.7.1.4.11" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.0 <span id="S4.T2.7.1.4.11.1" class="ltx_text" style="font-size:70%;">(0.9)</span>
</td>
<td id="S4.T2.7.1.4.12" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.4 <span id="S4.T2.7.1.4.12.1" class="ltx_text" style="font-size:70%;">(1.0)</span>
</td>
<td id="S4.T2.7.1.4.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.7 <span id="S4.T2.7.1.4.13.1" class="ltx_text" style="font-size:70%;">(1.5)</span>
</td>
<td id="S4.T2.7.1.4.14" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.91</td>
</tr>
<tr id="S4.T2.7.1.5" class="ltx_tr">
<td id="S4.T2.7.1.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>
</td>
<td id="S4.T2.7.1.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.4 <span id="S4.T2.7.1.5.2.1" class="ltx_text" style="font-size:70%;">(4.5)</span>
</td>
<td id="S4.T2.7.1.5.3" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.3.1" class="ltx_text" style="background-color:#FFFFFF;">82.9 <span id="S4.T2.7.1.5.3.1.1" class="ltx_text" style="font-size:70%;">(3.1)</span></span></td>
<td id="S4.T2.7.1.5.4" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.4.1" class="ltx_text" style="background-color:#FFFFFF;">84.4 <span id="S4.T2.7.1.5.4.1.1" class="ltx_text" style="font-size:70%;">(4.4)</span></span></td>
<td id="S4.T2.7.1.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.9 <span id="S4.T2.7.1.5.5.1" class="ltx_text" style="font-size:70%;">(5.3)</span>
</td>
<td id="S4.T2.7.1.5.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.8 <span id="S4.T2.7.1.5.6.1" class="ltx_text" style="font-size:70%;">(1.0)</span>
</td>
<td id="S4.T2.7.1.5.7" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.7.1" class="ltx_text" style="background-color:#FFFFFF;">87.5 <span id="S4.T2.7.1.5.7.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
<td id="S4.T2.7.1.5.8" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.8.1" class="ltx_text" style="background-color:#FFFFFF;">90.6 <span id="S4.T2.7.1.5.8.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
<td id="S4.T2.7.1.5.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.6 <span id="S4.T2.7.1.5.9.1" class="ltx_text" style="font-size:70%;">(0.0)</span>
</td>
<td id="S4.T2.7.1.5.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.5 <span id="S4.T2.7.1.5.10.1" class="ltx_text" style="font-size:70%;">(1.9)</span>
</td>
<td id="S4.T2.7.1.5.11" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.11.1" class="ltx_text" style="background-color:#FFFFFF;">70.9 <span id="S4.T2.7.1.5.11.1.1" class="ltx_text" style="font-size:70%;">(0.5)</span></span></td>
<td id="S4.T2.7.1.5.12" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.12.1" class="ltx_text" style="background-color:#FFFFFF;">73.4 <span id="S4.T2.7.1.5.12.1.1" class="ltx_text" style="font-size:70%;">(1.2)</span></span></td>
<td id="S4.T2.7.1.5.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.5.13.1" class="ltx_text" style="background-color:#FFFFFF;">76.1 <span id="S4.T2.7.1.5.13.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T2.7.1.5.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">2.50</td>
</tr>
<tr id="S4.T2.7.1.6" class="ltx_tr">
<td id="S4.T2.7.1.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">GraphGPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>
</td>
<td id="S4.T2.7.1.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.6 <span id="S4.T2.7.1.6.2.1" class="ltx_text" style="font-size:70%;">(4.4)</span>
</td>
<td id="S4.T2.7.1.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.7 <span id="S4.T2.7.1.6.3.1" class="ltx_text" style="font-size:70%;">(3.8)</span>
</td>
<td id="S4.T2.7.1.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.9 <span id="S4.T2.7.1.6.4.1" class="ltx_text" style="font-size:70%;">(4.2)</span>
</td>
<td id="S4.T2.7.1.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.9 <span id="S4.T2.7.1.6.5.1" class="ltx_text" style="font-size:70%;">(5.1)</span>
</td>
<td id="S4.T2.7.1.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.3 <span id="S4.T2.7.1.6.6.1" class="ltx_text" style="font-size:70%;">(1.3)</span>
</td>
<td id="S4.T2.7.1.6.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.5 <span id="S4.T2.7.1.6.7.1" class="ltx_text" style="font-size:70%;">(0.6)</span>
</td>
<td id="S4.T2.7.1.6.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S4.T2.7.1.6.8.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T2.7.1.6.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.6.9.1" class="ltx_text" style="background-color:#FFFFFF;">92.7 <span id="S4.T2.7.1.6.9.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
<td id="S4.T2.7.1.6.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.7 <span id="S4.T2.7.1.6.10.1" class="ltx_text" style="font-size:70%;">(1.8)</span>
</td>
<td id="S4.T2.7.1.6.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.3 <span id="S4.T2.7.1.6.11.1" class="ltx_text" style="font-size:70%;">(0.9)</span>
</td>
<td id="S4.T2.7.1.6.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.7 <span id="S4.T2.7.1.6.12.1" class="ltx_text" style="font-size:70%;">(1.2)</span>
</td>
<td id="S4.T2.7.1.6.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.8 <span id="S4.T2.7.1.6.13.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T2.7.1.6.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.75</td>
</tr>
<tr id="S4.T2.7.1.7" class="ltx_tr">
<td id="S4.T2.7.1.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>
</td>
<td id="S4.T2.7.1.7.2" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.7.2.1" class="ltx_text" style="background-color:#FFFFFF;">73.0 <span id="S4.T2.7.1.7.2.1.1" class="ltx_text" style="font-size:70%;">(4.3)</span></span></td>
<td id="S4.T2.7.1.7.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.6 <span id="S4.T2.7.1.7.3.1" class="ltx_text" style="font-size:70%;">(5.2)</span>
</td>
<td id="S4.T2.7.1.7.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.2 <span id="S4.T2.7.1.7.4.1" class="ltx_text" style="font-size:70%;">(7.0)</span>
</td>
<td id="S4.T2.7.1.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.9 <span id="S4.T2.7.1.7.5.1" class="ltx_text" style="font-size:70%;">(5.9)</span>
</td>
<td id="S4.T2.7.1.7.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.0 <span id="S4.T2.7.1.7.6.1" class="ltx_text" style="font-size:70%;">(73.0)</span>
</td>
<td id="S4.T2.7.1.7.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.9 <span id="S4.T2.7.1.7.7.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T2.7.1.7.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.8 <span id="S4.T2.7.1.7.8.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T2.7.1.7.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.7 <span id="S4.T2.7.1.7.9.1" class="ltx_text" style="font-size:70%;">(0.1)</span>
</td>
<td id="S4.T2.7.1.7.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.3 <span id="S4.T2.7.1.7.10.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T2.7.1.7.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.7 <span id="S4.T2.7.1.7.11.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T2.7.1.7.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.1 <span id="S4.T2.7.1.7.12.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T2.7.1.7.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.8 <span id="S4.T2.7.1.7.13.1" class="ltx_text" style="font-size:70%;">(1.0)</span>
</td>
<td id="S4.T2.7.1.7.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">3.91</td>
</tr>
<tr id="S4.T2.7.1.8" class="ltx_tr">
<td id="S4.T2.7.1.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>
</td>
<td id="S4.T2.7.1.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.4 <span id="S4.T2.7.1.8.2.1" class="ltx_text" style="font-size:70%;">(8.8)</span>
</td>
<td id="S4.T2.7.1.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.0 <span id="S4.T2.7.1.8.3.1" class="ltx_text" style="font-size:70%;">(8.2)</span>
</td>
<td id="S4.T2.7.1.8.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.5 <span id="S4.T2.7.1.8.4.1" class="ltx_text" style="font-size:70%;">(10.2)</span>
</td>
<td id="S4.T2.7.1.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.8 <span id="S4.T2.7.1.8.5.1" class="ltx_text" style="font-size:70%;">(5.9)</span>
</td>
<td id="S4.T2.7.1.8.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.3 <span id="S4.T2.7.1.8.6.1" class="ltx_text" style="font-size:70%;">(4.0)</span>
</td>
<td id="S4.T2.7.1.8.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.7 <span id="S4.T2.7.1.8.7.1" class="ltx_text" style="font-size:70%;">(1.8)</span>
</td>
<td id="S4.T2.7.1.8.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.3 <span id="S4.T2.7.1.8.8.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T2.7.1.8.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.9 <span id="S4.T2.7.1.8.9.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
<td id="S4.T2.7.1.8.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.8.10.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T2.7.1.8.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.8.11.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T2.7.1.8.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.8.12.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T2.7.1.8.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.8.13.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T2.7.1.8.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.8.14.1" class="ltx_text ltx_font_bold">-</span></td>
</tr>
<tr id="S4.T2.7.1.9" class="ltx_tr">
<td id="S4.T2.7.1.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="S4.T2.7.1.9.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.8 <span id="S4.T2.7.1.9.2.1" class="ltx_text" style="font-size:70%;">(6.0)</span>
</td>
<td id="S4.T2.7.1.9.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.3 <span id="S4.T2.7.1.9.3.1" class="ltx_text" style="font-size:70%;">(2.7)</span>
</td>
<td id="S4.T2.7.1.9.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.9 <span id="S4.T2.7.1.9.4.1" class="ltx_text" style="font-size:70%;">(3.5)</span>
</td>
<td id="S4.T2.7.1.9.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.9.5.1" class="ltx_text" style="background-color:#FFFFFF;">86.3 <span id="S4.T2.7.1.9.5.1.1" class="ltx_text" style="font-size:70%;">(3.9)</span></span></td>
<td id="S4.T2.7.1.9.6" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.9.6.1" class="ltx_text" style="background-color:#FFFFFF;">77.7 <span id="S4.T2.7.1.9.6.1.1" class="ltx_text" style="font-size:70%;">(1.7)</span></span></td>
<td id="S4.T2.7.1.9.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.3 <span id="S4.T2.7.1.9.7.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T2.7.1.9.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.7 <span id="S4.T2.7.1.9.8.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
<td id="S4.T2.7.1.9.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.4 <span id="S4.T2.7.1.9.9.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T2.7.1.9.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.3 <span id="S4.T2.7.1.9.10.1" class="ltx_text" style="font-size:70%;">(1.2)</span>
</td>
<td id="S4.T2.7.1.9.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.9 <span id="S4.T2.7.1.9.11.1" class="ltx_text" style="font-size:70%;">(1.6)</span>
</td>
<td id="S4.T2.7.1.9.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.8 <span id="S4.T2.7.1.9.12.1" class="ltx_text" style="font-size:70%;">(1.6)</span>
</td>
<td id="S4.T2.7.1.9.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.4 <span id="S4.T2.7.1.9.13.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T2.7.1.9.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">3.83</td>
</tr>
<tr id="S4.T2.7.1.10" class="ltx_tr">
<td id="S4.T2.7.1.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="S4.T2.7.1.10.2" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.2.1" class="ltx_text" style="background-color:#A8E3A1;">75.0 <span id="S4.T2.7.1.10.2.1.1" class="ltx_text" style="font-size:70%;">(2.9)</span></span></td>
<td id="S4.T2.7.1.10.3" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.3.1" class="ltx_text" style="background-color:#A8E3A1;">86.1 <span id="S4.T2.7.1.10.3.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
<td id="S4.T2.7.1.10.4" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.4.1" class="ltx_text" style="background-color:#A8E3A1;">88.1 <span id="S4.T2.7.1.10.4.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
<td id="S4.T2.7.1.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.5.1" class="ltx_text" style="background-color:#A8E3A1;">89.6 <span id="S4.T2.7.1.10.5.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
<td id="S4.T2.7.1.10.6" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.6.1" class="ltx_text" style="background-color:#A8E3A1;">80.0 <span id="S4.T2.7.1.10.6.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
<td id="S4.T2.7.1.10.7" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.7.1" class="ltx_text" style="background-color:#A8E3A1;">89.8 <span id="S4.T2.7.1.10.7.1.1" class="ltx_text" style="font-size:70%;">(0.3)</span></span></td>
<td id="S4.T2.7.1.10.8" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.8.1" class="ltx_text" style="background-color:#A8E3A1;">91.3 <span id="S4.T2.7.1.10.8.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
<td id="S4.T2.7.1.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.9.1" class="ltx_text" style="background-color:#A8E3A1;">92.9 <span id="S4.T2.7.1.10.9.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
<td id="S4.T2.7.1.10.10" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.10.1" class="ltx_text" style="background-color:#A8E3A1;">64.2 <span id="S4.T2.7.1.10.10.1.1" class="ltx_text" style="font-size:70%;">(1.6)</span></span></td>
<td id="S4.T2.7.1.10.11" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.11.1" class="ltx_text" style="background-color:#A8E3A1;">72.2 <span id="S4.T2.7.1.10.11.1.1" class="ltx_text" style="font-size:70%;">(1.0)</span></span></td>
<td id="S4.T2.7.1.10.12" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.12.1" class="ltx_text" style="background-color:#A8E3A1;">73.6 <span id="S4.T2.7.1.10.12.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T2.7.1.10.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.13.1" class="ltx_text" style="background-color:#A8E3A1;">77.5 <span id="S4.T2.7.1.10.13.1.1" class="ltx_text" style="font-size:70%;">(0.7)</span></span></td>
<td id="S4.T2.7.1.10.14" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T2.7.1.10.14.1" class="ltx_text" style="background-color:#A8E3A1;">1.00</span></td>
</tr>
<tr id="S4.T2.7.1.11" class="ltx_tr">
<td id="S4.T2.7.1.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="14"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.5.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.6.2" class="ltx_text" style="font-size:90%;">Precision@K (scaled up by a factor of 100, mean and standard deviation of 9 trials). The proportion of training samples is fixed to 5%. In each setting, the best performances are highlighted in <span id="S4.T3.6.2.1" class="ltx_text" style="color:#00B300;">green</span>.
<span id="S4.T3.6.2.2" class="ltx_text ltx_font_bold">NA</span>: there is no trivial extension of NAR-Former to NAS-Bench-301, which consists of two-cell architectures.
Note that, in most cases, <span id="S4.T3.6.2.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> identifies top-k architectures most accurately.
</span></figcaption>
<div id="S4.T3.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:619.3pt;height:149.3pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-103.2pt,24.8pt) scale(0.75,0.75) ;">
<table id="S4.T3.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.7.1.1" class="ltx_tr">
<td id="S4.T3.7.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="14"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T3.7.1.2" class="ltx_tr">
<td id="S4.T3.7.1.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Datasets</td>
<td id="S4.T3.7.1.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-101 (5%)</td>
<td id="S4.T3.7.1.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-201 (5%)</td>
<td id="S4.T3.7.1.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">NAS-Bench-301 (5%)</td>
<td id="S4.T3.7.1.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Avg.</td>
</tr>
<tr id="S4.T3.7.1.3" class="ltx_tr">
<td id="S4.T3.7.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">K (for P@Top K%)</td>
<td id="S4.T3.7.1.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</td>
<td id="S4.T3.7.1.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5</td>
<td id="S4.T3.7.1.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10</td>
<td id="S4.T3.7.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50</td>
<td id="S4.T3.7.1.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</td>
<td id="S4.T3.7.1.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5</td>
<td id="S4.T3.7.1.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10</td>
<td id="S4.T3.7.1.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50</td>
<td id="S4.T3.7.1.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</td>
<td id="S4.T3.7.1.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5</td>
<td id="S4.T3.7.1.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10</td>
<td id="S4.T3.7.1.3.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50</td>
<td id="S4.T3.7.1.3.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Rank</td>
</tr>
<tr id="S4.T3.7.1.4" class="ltx_tr">
<td id="S4.T3.7.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">GatedGCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>
</td>
<td id="S4.T3.7.1.4.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.4 <span id="S4.T3.7.1.4.2.1" class="ltx_text" style="font-size:70%;">(7.6)</span>
</td>
<td id="S4.T3.7.1.4.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.6 <span id="S4.T3.7.1.4.3.1" class="ltx_text" style="font-size:70%;">(3.5)</span>
</td>
<td id="S4.T3.7.1.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.2 <span id="S4.T3.7.1.4.4.1" class="ltx_text" style="font-size:70%;">(2.7)</span>
</td>
<td id="S4.T3.7.1.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.5 <span id="S4.T3.7.1.4.5.1" class="ltx_text" style="font-size:70%;">(2.1)</span>
</td>
<td id="S4.T3.7.1.4.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">42.3 <span id="S4.T3.7.1.4.6.1" class="ltx_text" style="font-size:70%;">(3.7)</span>
</td>
<td id="S4.T3.7.1.4.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.5 <span id="S4.T3.7.1.4.7.1" class="ltx_text" style="font-size:70%;">(3.1)</span>
</td>
<td id="S4.T3.7.1.4.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.9 <span id="S4.T3.7.1.4.8.1" class="ltx_text" style="font-size:70%;">(1.9)</span>
</td>
<td id="S4.T3.7.1.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.1 <span id="S4.T3.7.1.4.9.1" class="ltx_text" style="font-size:70%;">(0.6)</span>
</td>
<td id="S4.T3.7.1.4.10" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">19.1 <span id="S4.T3.7.1.4.10.1" class="ltx_text" style="font-size:70%;">(4.1)</span>
</td>
<td id="S4.T3.7.1.4.11" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.2 <span id="S4.T3.7.1.4.11.1" class="ltx_text" style="font-size:70%;">(4.5)</span>
</td>
<td id="S4.T3.7.1.4.12" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.8 <span id="S4.T3.7.1.4.12.1" class="ltx_text" style="font-size:70%;">(2.9)</span>
</td>
<td id="S4.T3.7.1.4.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.4 <span id="S4.T3.7.1.4.13.1" class="ltx_text" style="font-size:70%;">(0.4)</span>
</td>
<td id="S4.T3.7.1.4.14" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.83</td>
</tr>
<tr id="S4.T3.7.1.5" class="ltx_tr">
<td id="S4.T3.7.1.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>
</td>
<td id="S4.T3.7.1.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.7 <span id="S4.T3.7.1.5.2.1" class="ltx_text" style="font-size:70%;">(5.9)</span>
</td>
<td id="S4.T3.7.1.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.4 <span id="S4.T3.7.1.5.3.1" class="ltx_text" style="font-size:70%;">(4.2)</span>
</td>
<td id="S4.T3.7.1.5.4" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.4.1" class="ltx_text" style="background-color:#FFFFFF;">79.3 <span id="S4.T3.7.1.5.4.1.1" class="ltx_text" style="font-size:70%;">(2.9)</span></span></td>
<td id="S4.T3.7.1.5.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.5.1" class="ltx_text" style="background-color:#FFFFFF;">92.0 <span id="S4.T3.7.1.5.5.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T3.7.1.5.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.6 <span id="S4.T3.7.1.5.6.1" class="ltx_text" style="font-size:70%;">(6.2)</span>
</td>
<td id="S4.T3.7.1.5.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.7 <span id="S4.T3.7.1.5.7.1" class="ltx_text" style="font-size:70%;">(3.0)</span>
</td>
<td id="S4.T3.7.1.5.8" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.8.1" class="ltx_text" style="background-color:#FFFFFF;">83.1 <span id="S4.T3.7.1.5.8.1.1" class="ltx_text" style="font-size:70%;">(0.7)</span></span></td>
<td id="S4.T3.7.1.5.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.9.1" class="ltx_text" style="background-color:#FFFFFF;">95.3 <span id="S4.T3.7.1.5.9.1.1" class="ltx_text" style="font-size:70%;">(0.9)</span></span></td>
<td id="S4.T3.7.1.5.10" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.10.1" class="ltx_text" style="background-color:#A8E3A1;">23.1 <span id="S4.T3.7.1.5.10.1.1" class="ltx_text" style="font-size:70%;">(2.1)</span></span></td>
<td id="S4.T3.7.1.5.11" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.11.1" class="ltx_text" style="background-color:#FFFFFF;">58.3 <span id="S4.T3.7.1.5.11.1.1" class="ltx_text" style="font-size:70%;">(3.4)</span></span></td>
<td id="S4.T3.7.1.5.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.1 <span id="S4.T3.7.1.5.12.1" class="ltx_text" style="font-size:70%;">(1.5)</span>
</td>
<td id="S4.T3.7.1.5.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.5.13.1" class="ltx_text" style="background-color:#FFFFFF;">85.8 <span id="S4.T3.7.1.5.13.1.1" class="ltx_text" style="font-size:70%;">(0.4)</span></span></td>
<td id="S4.T3.7.1.5.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">2.75</td>
</tr>
<tr id="S4.T3.7.1.6" class="ltx_tr">
<td id="S4.T3.7.1.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">GraphGPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>
</td>
<td id="S4.T3.7.1.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.3 <span id="S4.T3.7.1.6.2.1" class="ltx_text" style="font-size:70%;">(12.2)</span>
</td>
<td id="S4.T3.7.1.6.3" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.6.3.1" class="ltx_text" style="background-color:#FFFFFF;">67.1 <span id="S4.T3.7.1.6.3.1.1" class="ltx_text" style="font-size:70%;">(2.7)</span></span></td>
<td id="S4.T3.7.1.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.7 <span id="S4.T3.7.1.6.4.1" class="ltx_text" style="font-size:70%;">(1.9)</span>
</td>
<td id="S4.T3.7.1.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.2 <span id="S4.T3.7.1.6.5.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T3.7.1.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.4 <span id="S4.T3.7.1.6.6.1" class="ltx_text" style="font-size:70%;">(4.6)</span>
</td>
<td id="S4.T3.7.1.6.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.9 <span id="S4.T3.7.1.6.7.1" class="ltx_text" style="font-size:70%;">(4.9)</span>
</td>
<td id="S4.T3.7.1.6.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.9 <span id="S4.T3.7.1.6.8.1" class="ltx_text" style="font-size:70%;">(3.4)</span>
</td>
<td id="S4.T3.7.1.6.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.4 <span id="S4.T3.7.1.6.9.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
<td id="S4.T3.7.1.6.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">20.6 <span id="S4.T3.7.1.6.10.1" class="ltx_text" style="font-size:70%;">(2.1)</span>
</td>
<td id="S4.T3.7.1.6.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.2 <span id="S4.T3.7.1.6.11.1" class="ltx_text" style="font-size:70%;">(3.8)</span>
</td>
<td id="S4.T3.7.1.6.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.4 <span id="S4.T3.7.1.6.12.1" class="ltx_text" style="font-size:70%;">(2.5)</span>
</td>
<td id="S4.T3.7.1.6.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.8 <span id="S4.T3.7.1.6.13.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T3.7.1.6.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.17</td>
</tr>
<tr id="S4.T3.7.1.7" class="ltx_tr">
<td id="S4.T3.7.1.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>
</td>
<td id="S4.T3.7.1.7.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">39.4 <span id="S4.T3.7.1.7.2.1" class="ltx_text" style="font-size:70%;">(7.9)</span>
</td>
<td id="S4.T3.7.1.7.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.8 <span id="S4.T3.7.1.7.3.1" class="ltx_text" style="font-size:70%;">(5.6)</span>
</td>
<td id="S4.T3.7.1.7.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.6 <span id="S4.T3.7.1.7.4.1" class="ltx_text" style="font-size:70%;">(5.0)</span>
</td>
<td id="S4.T3.7.1.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.2 <span id="S4.T3.7.1.7.5.1" class="ltx_text" style="font-size:70%;">(2.4)</span>
</td>
<td id="S4.T3.7.1.7.6" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.7.6.1" class="ltx_text" style="background-color:#FFFFFF;">50.7 <span id="S4.T3.7.1.7.6.1.1" class="ltx_text" style="font-size:70%;">(5.8)</span></span></td>
<td id="S4.T3.7.1.7.7" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.7.7.1" class="ltx_text" style="background-color:#FFFFFF;">70.4 <span id="S4.T3.7.1.7.7.1.1" class="ltx_text" style="font-size:70%;">(2.9)</span></span></td>
<td id="S4.T3.7.1.7.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.5 <span id="S4.T3.7.1.7.8.1" class="ltx_text" style="font-size:70%;">(2.3)</span>
</td>
<td id="S4.T3.7.1.7.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.2 <span id="S4.T3.7.1.7.9.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T3.7.1.7.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">20.7 <span id="S4.T3.7.1.7.10.1" class="ltx_text" style="font-size:70%;">(3.4)</span>
</td>
<td id="S4.T3.7.1.7.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.6 <span id="S4.T3.7.1.7.11.1" class="ltx_text" style="font-size:70%;">(3.7)</span>
</td>
<td id="S4.T3.7.1.7.12" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.7.12.1" class="ltx_text" style="background-color:#FFFFFF;">73.4 <span id="S4.T3.7.1.7.12.1.1" class="ltx_text" style="font-size:70%;">(2.5)</span></span></td>
<td id="S4.T3.7.1.7.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.6 <span id="S4.T3.7.1.7.13.1" class="ltx_text" style="font-size:70%;">(0.4)</span>
</td>
<td id="S4.T3.7.1.7.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">3.83</td>
</tr>
<tr id="S4.T3.7.1.8" class="ltx_tr">
<td id="S4.T3.7.1.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>
</td>
<td id="S4.T3.7.1.8.2" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.2.1" class="ltx_text" style="background-color:#A8E3A1;">47.2 <span id="S4.T3.7.1.8.2.1.1" class="ltx_text" style="font-size:70%;">(9.9)</span></span></td>
<td id="S4.T3.7.1.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.6 <span id="S4.T3.7.1.8.3.1" class="ltx_text" style="font-size:70%;">(7.9)</span>
</td>
<td id="S4.T3.7.1.8.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.8 <span id="S4.T3.7.1.8.4.1" class="ltx_text" style="font-size:70%;">(8.4)</span>
</td>
<td id="S4.T3.7.1.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.9 <span id="S4.T3.7.1.8.5.1" class="ltx_text" style="font-size:70%;">(5.2)</span>
</td>
<td id="S4.T3.7.1.8.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.5 <span id="S4.T3.7.1.8.6.1" class="ltx_text" style="font-size:70%;">(6.5)</span>
</td>
<td id="S4.T3.7.1.8.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.7 <span id="S4.T3.7.1.8.7.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T3.7.1.8.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.9 <span id="S4.T3.7.1.8.8.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T3.7.1.8.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.3 <span id="S4.T3.7.1.8.9.1" class="ltx_text" style="font-size:70%;">(1.0)</span>
</td>
<td id="S4.T3.7.1.8.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.10.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T3.7.1.8.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.11.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T3.7.1.8.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.12.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T3.7.1.8.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.13.1" class="ltx_text ltx_font_bold">NA</span></td>
<td id="S4.T3.7.1.8.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.8.14.1" class="ltx_text ltx_font_bold">-</span></td>
</tr>
<tr id="S4.T3.7.1.9" class="ltx_tr">
<td id="S4.T3.7.1.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="S4.T3.7.1.9.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.6 <span id="S4.T3.7.1.9.2.1" class="ltx_text" style="font-size:70%;">(9.7)</span>
</td>
<td id="S4.T3.7.1.9.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.6 <span id="S4.T3.7.1.9.3.1" class="ltx_text" style="font-size:70%;">(4.0)</span>
</td>
<td id="S4.T3.7.1.9.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.1 <span id="S4.T3.7.1.9.4.1" class="ltx_text" style="font-size:70%;">(4.6)</span>
</td>
<td id="S4.T3.7.1.9.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.8 <span id="S4.T3.7.1.9.5.1" class="ltx_text" style="font-size:70%;">(1.2)</span>
</td>
<td id="S4.T3.7.1.9.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.4 <span id="S4.T3.7.1.9.6.1" class="ltx_text" style="font-size:70%;">(3.1)</span>
</td>
<td id="S4.T3.7.1.9.7" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.7 <span id="S4.T3.7.1.9.7.1" class="ltx_text" style="font-size:70%;">(3.3)</span>
</td>
<td id="S4.T3.7.1.9.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.1 <span id="S4.T3.7.1.9.8.1" class="ltx_text" style="font-size:70%;">(2.8)</span>
</td>
<td id="S4.T3.7.1.9.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.8 <span id="S4.T3.7.1.9.9.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T3.7.1.9.10" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">20.1 <span id="S4.T3.7.1.9.10.1" class="ltx_text" style="font-size:70%;">(5.0)</span>
</td>
<td id="S4.T3.7.1.9.11" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">56.2 <span id="S4.T3.7.1.9.11.1" class="ltx_text" style="font-size:70%;">(6.1)</span>
</td>
<td id="S4.T3.7.1.9.12" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.4 <span id="S4.T3.7.1.9.12.1" class="ltx_text" style="font-size:70%;">(3.6)</span>
</td>
<td id="S4.T3.7.1.9.13" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.7 <span id="S4.T3.7.1.9.13.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T3.7.1.9.14" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.33</td>
</tr>
<tr id="S4.T3.7.1.10" class="ltx_tr">
<td id="S4.T3.7.1.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="S4.T3.7.1.10.2" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.2.1" class="ltx_text" style="background-color:#FFFFFF;">46.5 <span id="S4.T3.7.1.10.2.1.1" class="ltx_text" style="font-size:70%;">(11.2)</span></span></td>
<td id="S4.T3.7.1.10.3" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.3.1" class="ltx_text" style="background-color:#A8E3A1;">70.0 <span id="S4.T3.7.1.10.3.1.1" class="ltx_text" style="font-size:70%;">(1.5)</span></span></td>
<td id="S4.T3.7.1.10.4" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.4.1" class="ltx_text" style="background-color:#A8E3A1;">80.9 <span id="S4.T3.7.1.10.4.1.1" class="ltx_text" style="font-size:70%;">(1.8)</span></span></td>
<td id="S4.T3.7.1.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.5.1" class="ltx_text" style="background-color:#A8E3A1;">92.7 <span id="S4.T3.7.1.10.5.1.1" class="ltx_text" style="font-size:70%;">(1.7)</span></span></td>
<td id="S4.T3.7.1.10.6" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.6.1" class="ltx_text" style="background-color:#A8E3A1;">57.0 <span id="S4.T3.7.1.10.6.1.1" class="ltx_text" style="font-size:70%;">(5.4)</span></span></td>
<td id="S4.T3.7.1.10.7" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.7.1" class="ltx_text" style="background-color:#A8E3A1;">74.7 <span id="S4.T3.7.1.10.7.1.1" class="ltx_text" style="font-size:70%;">(1.8)</span></span></td>
<td id="S4.T3.7.1.10.8" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.8.1" class="ltx_text" style="background-color:#A8E3A1;">85.2 <span id="S4.T3.7.1.10.8.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T3.7.1.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.9.1" class="ltx_text" style="background-color:#A8E3A1;">96.9 <span id="S4.T3.7.1.10.9.1.1" class="ltx_text" style="font-size:70%;">(0.7)</span></span></td>
<td id="S4.T3.7.1.10.10" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.10.1" class="ltx_text" style="background-color:#FFFFFF;">20.8 <span id="S4.T3.7.1.10.10.1.1" class="ltx_text" style="font-size:70%;">(3.7)</span></span></td>
<td id="S4.T3.7.1.10.11" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.11.1" class="ltx_text" style="background-color:#A8E3A1;">58.5 <span id="S4.T3.7.1.10.11.1.1" class="ltx_text" style="font-size:70%;">(2.5)</span></span></td>
<td id="S4.T3.7.1.10.12" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.12.1" class="ltx_text" style="background-color:#A8E3A1;">74.7 <span id="S4.T3.7.1.10.12.1.1" class="ltx_text" style="font-size:70%;">(2.4)</span></span></td>
<td id="S4.T3.7.1.10.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.13.1" class="ltx_text" style="background-color:#A8E3A1;">86.6 <span id="S4.T3.7.1.10.13.1.1" class="ltx_text" style="font-size:70%;">(0.6)</span></span></td>
<td id="S4.T3.7.1.10.14" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T3.7.1.10.14.1" class="ltx_text" style="background-color:#A8E3A1;">1.08</span></td>
</tr>
<tr id="S4.T3.7.1.11" class="ltx_tr">
<td id="S4.T3.7.1.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="14"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance on computer vision benchmarks</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this subsection, we focus on the computer vision benchmarks for which we have extensive baseline methods.
In <a href="#S4.T2" title="In 4.1.3 Training and Evaluation protocol ‣ 4.1 Experimental settings ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tabs.</span> <span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S4.T3" title="Table 3 ‣ 4.1.3 Training and Evaluation protocol ‣ 4.1 Experimental settings ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we report the performance prediction accuracies of the considered methods using two metrics across different training instance ratios.
Notably, <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> consistently outperforms all baseline methods across all settings in terms of Kendall’s Tau. In terms of Precision@K, it performs best in 10 out of 12 settings, ranking second in the other settings. Two key observations are as follows.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">The suboptimal performance of GraphGPS indicates that a graph transformer alone is insufficient in effectively representing neural architectures.
Specifically, in terms of Kendall’s Tau, the performance gap can be as large as 8.7 percentage points between <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> and GPS.
We, thus, argue that our incorporation of information flows into a graph transformer, through the introduction of the flow encode module and the flow-aware global attention module, plays a pivotal role in <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>’s success.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The superiority of <span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> over TA-GATES highlights the importance of the global attention mechanism. While TA-GATES may capture the information flow at a local-level through its information propagation scheme, it does not adequately leverage the global context of neural architectures.
<span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, on the other hand, uses the global attention mechanism to capture the graph-level (i.e., architecture-level) characteristics, empowering <span id="S4.SS2.p3.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> to yield better representations of architectures.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">In summary, our empirical findings substantiate that <span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> serves as an effective predictor of neural architecture performance.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.8.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.9.2" class="ltx_text" style="font-size:90%;">
Comparison with four variants of <span id="S4.T4.9.2.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> in terms of Kendall’s Tau, using the same setups as in <a href="#S4.T2" title="In 4.1.3 Training and Evaluation protocol ‣ 4.1 Experimental settings ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. In each setting, the best performances are highlighted in <span id="S4.T4.9.2.2" class="ltx_text" style="color:#00B300;">green</span>. <span id="S4.T4.9.2.3" class="ltx_text ltx_font_bold">AS</span>: Asynchronous message passing. <span id="S4.T4.9.2.4" class="ltx_text ltx_font_bold">FB</span>: Forward-backward message passing. <span id="S4.T4.9.2.5" class="ltx_text ltx_font_bold">GA</span>: Global attention. In most cases, <span id="S4.T4.9.2.6" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, which is equipped with all components, outperforms all of its variants, thereby validating the effectiveness of each component.</span></figcaption>
<div id="S4.T4.10" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:244.2pt;height:226.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-52.3pt,48.6pt) scale(0.7,0.7) ;">
<table id="S4.T4.10.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.10.1.1" class="ltx_tr">
<td id="S4.T4.10.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T4.10.1.2" class="ltx_tr">
<td id="S4.T4.10.1.2.1" class="ltx_td ltx_align_left ltx_border_r" rowspan="2"><span id="S4.T4.10.1.2.1.1" class="ltx_text">Dataset</span></td>
<td id="S4.T4.10.1.2.2" class="ltx_td ltx_align_center ltx_border_r" rowspan="2"><span id="S4.T4.10.1.2.2.1" class="ltx_text">#</span></td>
<td id="S4.T4.10.1.2.3" class="ltx_td ltx_align_center ltx_border_r" colspan="3">Components</td>
<td id="S4.T4.10.1.2.4" class="ltx_td ltx_align_center" colspan="4">Training Portions</td>
</tr>
<tr id="S4.T4.10.1.3" class="ltx_tr">
<td id="S4.T4.10.1.3.1" class="ltx_td ltx_align_center ltx_border_t">AS</td>
<td id="S4.T4.10.1.3.2" class="ltx_td ltx_align_center ltx_border_t">FB</td>
<td id="S4.T4.10.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">GA</td>
<td id="S4.T4.10.1.3.4" class="ltx_td ltx_align_center ltx_border_t">1%</td>
<td id="S4.T4.10.1.3.5" class="ltx_td ltx_align_center ltx_border_t">5%</td>
<td id="S4.T4.10.1.3.6" class="ltx_td ltx_align_center ltx_border_t">10%</td>
<td id="S4.T4.10.1.3.7" class="ltx_td ltx_align_center ltx_border_t">50%</td>
</tr>
<tr id="S4.T4.10.1.4" class="ltx_tr">
<td id="S4.T4.10.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="5"><span id="S4.T4.10.1.4.1.1" class="ltx_text">NB 101</span></td>
<td id="S4.T4.10.1.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T4.10.1.4.2.1" class="ltx_text ltx_font_bold">(1)</span></td>
<td id="S4.T4.10.1.4.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T4.10.1.4.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.4.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T4.10.1.4.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T4.10.1.4.5.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.4.6" class="ltx_td ltx_align_center ltx_border_tt">41.5<span id="S4.T4.10.1.4.6.1" class="ltx_text" style="font-size:70%;">(1.7)</span>
</td>
<td id="S4.T4.10.1.4.7" class="ltx_td ltx_align_center ltx_border_tt">42.5 <span id="S4.T4.10.1.4.7.1" class="ltx_text" style="font-size:70%;">(1.6)</span>
</td>
<td id="S4.T4.10.1.4.8" class="ltx_td ltx_align_center ltx_border_tt">41.1 <span id="S4.T4.10.1.4.8.1" class="ltx_text" style="font-size:70%;">(2.8)</span>
</td>
<td id="S4.T4.10.1.4.9" class="ltx_td ltx_align_center ltx_border_tt">43.1 <span id="S4.T4.10.1.4.9.1" class="ltx_text" style="font-size:70%;">(1.4)</span>
</td>
</tr>
<tr id="S4.T4.10.1.5" class="ltx_tr">
<td id="S4.T4.10.1.5.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.5.1.1" class="ltx_text ltx_font_bold">(2)</span></td>
<td id="S4.T4.10.1.5.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.5.2.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.5.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.5.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.5.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.5.5" class="ltx_td ltx_align_center">65.5 <span id="S4.T4.10.1.5.5.1" class="ltx_text" style="font-size:70%;">(8.8)</span>
</td>
<td id="S4.T4.10.1.5.6" class="ltx_td ltx_align_center">56.8 <span id="S4.T4.10.1.5.6.1" class="ltx_text" style="font-size:70%;">(5.0)</span>
</td>
<td id="S4.T4.10.1.5.7" class="ltx_td ltx_align_center">53.8 <span id="S4.T4.10.1.5.7.1" class="ltx_text" style="font-size:70%;">(7.4)</span>
</td>
<td id="S4.T4.10.1.5.8" class="ltx_td ltx_align_center">69.6 <span id="S4.T4.10.1.5.8.1" class="ltx_text" style="font-size:70%;">(11.6)</span>
</td>
</tr>
<tr id="S4.T4.10.1.6" class="ltx_tr">
<td id="S4.T4.10.1.6.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.6.1.1" class="ltx_text ltx_font_bold">(3)</span></td>
<td id="S4.T4.10.1.6.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.6.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.6.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.6.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.6.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.6.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.6.5" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.6.5.1" class="ltx_text" style="background-color:#A8E3A1;">76.7 <span id="S4.T4.10.1.6.5.1.1" class="ltx_text" style="font-size:70%;">(4.1)</span></span></td>
<td id="S4.T4.10.1.6.6" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.6.6.1" class="ltx_text" style="background-color:#FFFFFF;">83.9 <span id="S4.T4.10.1.6.6.1.1" class="ltx_text" style="font-size:70%;">(2.6)</span></span></td>
<td id="S4.T4.10.1.6.7" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.6.7.1" class="ltx_text" style="background-color:#FFFFFF;">84.6 <span id="S4.T4.10.1.6.7.1.1" class="ltx_text" style="font-size:70%;">(4.0</span></span></td>
<td id="S4.T4.10.1.6.8" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.6.8.1" class="ltx_text" style="background-color:#FFFFFF;">85.6 <span id="S4.T4.10.1.6.8.1.1" class="ltx_text" style="font-size:70%;">(5.4)</span></span></td>
</tr>
<tr id="S4.T4.10.1.7" class="ltx_tr">
<td id="S4.T4.10.1.7.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.7.1.1" class="ltx_text ltx_font_bold">(4)</span></td>
<td id="S4.T4.10.1.7.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.7.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.7.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.7.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.7.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.7.5" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.7.5.1" class="ltx_text" style="background-color:#FFFFFF;">76.5 <span id="S4.T4.10.1.7.5.1.1" class="ltx_text" style="font-size:70%;">(3.0)</span></span></td>
<td id="S4.T4.10.1.7.6" class="ltx_td ltx_align_center">83.2 <span id="S4.T4.10.1.7.6.1" class="ltx_text" style="font-size:70%;">(3.9)</span>
</td>
<td id="S4.T4.10.1.7.7" class="ltx_td ltx_align_center">83.9 <span id="S4.T4.10.1.7.7.1" class="ltx_text" style="font-size:70%;">(5.1)</span>
</td>
<td id="S4.T4.10.1.7.8" class="ltx_td ltx_align_center">85.3 <span id="S4.T4.10.1.7.8.1" class="ltx_text" style="font-size:70%;">(6.3)</span>
</td>
</tr>
<tr id="S4.T4.10.1.8" class="ltx_tr">
<td id="S4.T4.10.1.8.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.8.1.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S4.T4.10.1.8.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.8.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.8.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.8.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.8.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.8.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.8.5" class="ltx_td ltx_align_center">75.0 <span id="S4.T4.10.1.8.5.1" class="ltx_text" style="font-size:70%;">(2.9)</span>
</td>
<td id="S4.T4.10.1.8.6" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.8.6.1" class="ltx_text" style="background-color:#A8E3A1;">86.1 <span id="S4.T4.10.1.8.6.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
<td id="S4.T4.10.1.8.7" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.8.7.1" class="ltx_text" style="background-color:#A8E3A1;">88.1 <span id="S4.T4.10.1.8.7.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
<td id="S4.T4.10.1.8.8" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.8.8.1" class="ltx_text" style="background-color:#A8E3A1;">89.6 <span id="S4.T4.10.1.8.8.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
</tr>
<tr id="S4.T4.10.1.9" class="ltx_tr">
<td id="S4.T4.10.1.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="5"><span id="S4.T4.10.1.9.1.1" class="ltx_text">NB 201</span></td>
<td id="S4.T4.10.1.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.10.1.9.2.1" class="ltx_text ltx_font_bold">(1)</span></td>
<td id="S4.T4.10.1.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.10.1.9.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.10.1.9.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.10.1.9.5.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.9.6" class="ltx_td ltx_align_center ltx_border_t">75.9 <span id="S4.T4.10.1.9.6.1" class="ltx_text" style="font-size:70%;">(1.2)</span>
</td>
<td id="S4.T4.10.1.9.7" class="ltx_td ltx_align_center ltx_border_t">86.5 <span id="S4.T4.10.1.9.7.1" class="ltx_text" style="font-size:70%;">(0.2</span>
</td>
<td id="S4.T4.10.1.9.8" class="ltx_td ltx_align_center ltx_border_t">88.2 <span id="S4.T4.10.1.9.8.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
<td id="S4.T4.10.1.9.9" class="ltx_td ltx_align_center ltx_border_t">89.7 <span id="S4.T4.10.1.9.9.1" class="ltx_text" style="font-size:70%;">(0.1)</span>
</td>
</tr>
<tr id="S4.T4.10.1.10" class="ltx_tr">
<td id="S4.T4.10.1.10.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.10.1.1" class="ltx_text ltx_font_bold">(2)</span></td>
<td id="S4.T4.10.1.10.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.10.2.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.10.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.10.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.10.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.10.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.10.5" class="ltx_td ltx_align_center">73.7 <span id="S4.T4.10.1.10.5.1" class="ltx_text" style="font-size:70%;">(1.1)</span>
</td>
<td id="S4.T4.10.1.10.6" class="ltx_td ltx_align_center">85.6 <span id="S4.T4.10.1.10.6.1" class="ltx_text" style="font-size:70%;">(0.7)</span>
</td>
<td id="S4.T4.10.1.10.7" class="ltx_td ltx_align_center">89.2 <span id="S4.T4.10.1.10.7.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
<td id="S4.T4.10.1.10.8" class="ltx_td ltx_align_center">92.9 <span id="S4.T4.10.1.10.8.1" class="ltx_text" style="font-size:70%;">(0.1)</span>
</td>
</tr>
<tr id="S4.T4.10.1.11" class="ltx_tr">
<td id="S4.T4.10.1.11.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.11.1.1" class="ltx_text ltx_font_bold">(3)</span></td>
<td id="S4.T4.10.1.11.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.11.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.11.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.11.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.11.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.11.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.11.5" class="ltx_td ltx_align_center">76.2 <span id="S4.T4.10.1.11.5.1" class="ltx_text" style="font-size:70%;">(2.1)</span>
</td>
<td id="S4.T4.10.1.11.6" class="ltx_td ltx_align_center">88.6 <span id="S4.T4.10.1.11.6.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T4.10.1.11.7" class="ltx_td ltx_align_center">90.9 <span id="S4.T4.10.1.11.7.1" class="ltx_text" style="font-size:70%;">(0.1)</span>
</td>
<td id="S4.T4.10.1.11.8" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.11.8.1" class="ltx_text" style="background-color:#FFFFFF;">92.9 <span id="S4.T4.10.1.11.8.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
</tr>
<tr id="S4.T4.10.1.12" class="ltx_tr">
<td id="S4.T4.10.1.12.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.12.1.1" class="ltx_text ltx_font_bold">(4)</span></td>
<td id="S4.T4.10.1.12.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.12.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.12.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.12.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.12.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.12.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.12.5" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.12.5.1" class="ltx_text" style="background-color:#A8E3A1;">79.3 <span id="S4.T4.10.1.12.5.1.1" class="ltx_text" style="font-size:70%;">(1.2)</span></span></td>
<td id="S4.T4.10.1.12.6" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.12.6.1" class="ltx_text" style="background-color:#FFFFFF;">89.5 <span id="S4.T4.10.1.12.6.1.1" class="ltx_text" style="font-size:70%;">(0.5)</span></span></td>
<td id="S4.T4.10.1.12.7" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.12.7.1" class="ltx_text" style="background-color:#FFFFFF;">91.1 <span id="S4.T4.10.1.12.7.1.1" class="ltx_text" style="font-size:70%;">(0.3)</span></span></td>
<td id="S4.T4.10.1.12.8" class="ltx_td ltx_align_center">92.9 <span id="S4.T4.10.1.12.8.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
</tr>
<tr id="S4.T4.10.1.13" class="ltx_tr">
<td id="S4.T4.10.1.13.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.13.1.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S4.T4.10.1.13.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.13.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.13.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.13.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.13.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.13.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.13.5" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.13.5.1" class="ltx_text" style="background-color:#FFFFFF;">79.0 <span id="S4.T4.10.1.13.5.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
<td id="S4.T4.10.1.13.6" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.13.6.1" class="ltx_text" style="background-color:#A8E3A1;">89.8 <span id="S4.T4.10.1.13.6.1.1" class="ltx_text" style="font-size:70%;">(0.3)</span></span></td>
<td id="S4.T4.10.1.13.7" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.13.7.1" class="ltx_text" style="background-color:#A8E3A1;">91.3 <span id="S4.T4.10.1.13.7.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
<td id="S4.T4.10.1.13.8" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.13.8.1" class="ltx_text" style="background-color:#A8E3A1;">92.9 <span id="S4.T4.10.1.13.8.1.1" class="ltx_text" style="font-size:70%;">(0.1)</span></span></td>
</tr>
<tr id="S4.T4.10.1.14" class="ltx_tr">
<td id="S4.T4.10.1.14.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T4.10.1.14.1.1" class="ltx_text">NB 301</span></td>
<td id="S4.T4.10.1.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.10.1.14.2.1" class="ltx_text ltx_font_bold">(1)</span></td>
<td id="S4.T4.10.1.14.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.10.1.14.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.14.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.10.1.14.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.10.1.14.5.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.14.6" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.14.6.1" class="ltx_text" style="background-color:#FFFFFF;">63.3<span id="S4.T4.10.1.14.6.1.1" class="ltx_text" style="font-size:70%;">(2.7)</span></span></td>
<td id="S4.T4.10.1.14.7" class="ltx_td ltx_align_center ltx_border_t">69.0 <span id="S4.T4.10.1.14.7.1" class="ltx_text" style="font-size:70%;">(2.8)</span>
</td>
<td id="S4.T4.10.1.14.8" class="ltx_td ltx_align_center ltx_border_t">68.1 <span id="S4.T4.10.1.14.8.1" class="ltx_text" style="font-size:70%;">(2.9)</span>
</td>
<td id="S4.T4.10.1.14.9" class="ltx_td ltx_align_center ltx_border_t">59.8 <span id="S4.T4.10.1.14.9.1" class="ltx_text" style="font-size:70%;">(2.3)</span>
</td>
</tr>
<tr id="S4.T4.10.1.15" class="ltx_tr">
<td id="S4.T4.10.1.15.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.15.1.1" class="ltx_text ltx_font_bold">(3)</span></td>
<td id="S4.T4.10.1.15.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.15.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.15.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.15.3.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.15.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.15.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.15.5" class="ltx_td ltx_align_center">59.5<span id="S4.T4.10.1.15.5.1" class="ltx_text" style="font-size:70%;">(2.6)</span>
</td>
<td id="S4.T4.10.1.15.6" class="ltx_td ltx_align_center">69.0 <span id="S4.T4.10.1.15.6.1" class="ltx_text" style="font-size:70%;">(1.8)</span>
</td>
<td id="S4.T4.10.1.15.7" class="ltx_td ltx_align_center">50.2 <span id="S4.T4.10.1.15.7.1" class="ltx_text" style="font-size:70%;">(15.0)</span>
</td>
<td id="S4.T4.10.1.15.8" class="ltx_td ltx_align_center">45.3 <span id="S4.T4.10.1.15.8.1" class="ltx_text" style="font-size:70%;">(19.4)</span>
</td>
</tr>
<tr id="S4.T4.10.1.16" class="ltx_tr">
<td id="S4.T4.10.1.16.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.16.1.1" class="ltx_text ltx_font_bold">(4)</span></td>
<td id="S4.T4.10.1.16.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.16.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.16.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.16.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.16.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.16.4.1" class="ltx_text ltx_font_bold" style="color:#CF1A42;">✗</span></td>
<td id="S4.T4.10.1.16.5" class="ltx_td ltx_align_center">60.9 <span id="S4.T4.10.1.16.5.1" class="ltx_text" style="font-size:70%;">(3.1)</span>
</td>
<td id="S4.T4.10.1.16.6" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.16.6.1" class="ltx_text" style="background-color:#FFFFFF;">69.8 <span id="S4.T4.10.1.16.6.1.1" class="ltx_text" style="font-size:70%;">(1.4)</span></span></td>
<td id="S4.T4.10.1.16.7" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.16.7.1" class="ltx_text" style="background-color:#FFFFFF;">70.9 <span id="S4.T4.10.1.16.7.1.1" class="ltx_text" style="font-size:70%;">(1.2)</span></span></td>
<td id="S4.T4.10.1.16.8" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T4.10.1.16.8.1" class="ltx_text" style="background-color:#FFFFFF;">67.7 <span id="S4.T4.10.1.16.8.1.1" class="ltx_text" style="font-size:70%;">(3.1)</span></span></td>
</tr>
<tr id="S4.T4.10.1.17" class="ltx_tr">
<td id="S4.T4.10.1.17.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.17.1.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S4.T4.10.1.17.2" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.17.2.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.17.3" class="ltx_td ltx_align_center"><span id="S4.T4.10.1.17.3.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.17.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.10.1.17.4.1" class="ltx_text ltx_font_bold" style="color:#00B300;">✔</span></td>
<td id="S4.T4.10.1.17.5" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.17.5.1" class="ltx_text" style="background-color:#A8E3A1;">64.2 <span id="S4.T4.10.1.17.5.1.1" class="ltx_text" style="font-size:70%;">(1.6)</span></span></td>
<td id="S4.T4.10.1.17.6" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.17.6.1" class="ltx_text" style="background-color:#A8E3A1;">72.2 <span id="S4.T4.10.1.17.6.1.1" class="ltx_text" style="font-size:70%;">(1.0)</span></span></td>
<td id="S4.T4.10.1.17.7" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.17.7.1" class="ltx_text" style="background-color:#A8E3A1;">73.6 <span id="S4.T4.10.1.17.7.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T4.10.1.17.8" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T4.10.1.17.8.1" class="ltx_text" style="background-color:#A8E3A1;">77.5 <span id="S4.T4.10.1.17.8.1.1" class="ltx_text" style="font-size:70%;">(0.7)</span></span></td>
</tr>
<tr id="S4.T4.10.1.18" class="ltx_tr">
<td id="S4.T4.10.1.18.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.4.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T5.5.2" class="ltx_text" style="font-size:90%;">Kendall’s Tau (scaled up by a factor of 100, mean and standard deviation of 9 experiments) on two datasets beyond the computer vision domain: NAS-Bench-Graph (NB-G) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib36" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite> and NAS-Bench-ASR (NB-ASR) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib28" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite>. In each setting, the best performances are highlighted in <span id="S4.T5.5.2.1" class="ltx_text" style="color:#00B300;">green</span>. In most cases, <span id="S4.T5.5.2.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> performs best.
</span></figcaption>
<div id="S4.T5.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:343.0pt;height:162pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-57.2pt,27.0pt) scale(0.75,0.75) ;">
<table id="S4.T5.6.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.6.1.1" class="ltx_tr">
<td id="S4.T5.6.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="6"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T5.6.1.2" class="ltx_tr">
<td id="S4.T5.6.1.2.1" class="ltx_td ltx_align_center ltx_border_r" rowspan="2"><span id="S4.T5.6.1.2.1.1" class="ltx_text">Dataset</span></td>
<td id="S4.T5.6.1.2.2" class="ltx_td ltx_align_left ltx_border_r" rowspan="2"><span id="S4.T5.6.1.2.2.1" class="ltx_text">Encoder</span></td>
<td id="S4.T5.6.1.2.3" class="ltx_td ltx_align_center" colspan="4">Training portions</td>
</tr>
<tr id="S4.T5.6.1.3" class="ltx_tr">
<td id="S4.T5.6.1.3.1" class="ltx_td ltx_align_center ltx_border_t">1%</td>
<td id="S4.T5.6.1.3.2" class="ltx_td ltx_align_center ltx_border_t">5%</td>
<td id="S4.T5.6.1.3.3" class="ltx_td ltx_align_center ltx_border_t">10%</td>
<td id="S4.T5.6.1.3.4" class="ltx_td ltx_align_center ltx_border_t">50%</td>
</tr>
<tr id="S4.T5.6.1.4" class="ltx_tr">
<td id="S4.T5.6.1.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="4"><span id="S4.T5.6.1.4.1.1" class="ltx_text">NB-G</span></td>
<td id="S4.T5.6.1.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">DAGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>
</td>
<td id="S4.T5.6.1.4.3" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.4.3.1" class="ltx_text" style="background-color:#FFFFFF;">48.1 <span id="S4.T5.6.1.4.3.1.1" class="ltx_text" style="font-size:70%;">(3.2)</span></span></td>
<td id="S4.T5.6.1.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.4.4.1" class="ltx_text" style="background-color:#FFFFFF;">64.4 <span id="S4.T5.6.1.4.4.1.1" class="ltx_text" style="font-size:70%;">(1.2)</span></span></td>
<td id="S4.T5.6.1.4.5" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.4.5.1" class="ltx_text" style="background-color:#FFFFFF;">67.4 <span id="S4.T5.6.1.4.5.1.1" class="ltx_text" style="font-size:70%;">(1.1)</span></span></td>
<td id="S4.T5.6.1.4.6" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.4.6.1" class="ltx_text" style="background-color:#A8E3A1;">73.1 <span id="S4.T5.6.1.4.6.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
</tr>
<tr id="S4.T5.6.1.5" class="ltx_tr">
<td id="S4.T5.6.1.5.1" class="ltx_td ltx_align_left ltx_border_r">DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>
</td>
<td id="S4.T5.6.1.5.2" class="ltx_td ltx_align_center">47.9 <span id="S4.T5.6.1.5.2.1" class="ltx_text" style="font-size:70%;">(0.6)</span>
</td>
<td id="S4.T5.6.1.5.3" class="ltx_td ltx_align_center">60.8 <span id="S4.T5.6.1.5.3.1" class="ltx_text" style="font-size:70%;">(1.6)</span>
</td>
<td id="S4.T5.6.1.5.4" class="ltx_td ltx_align_center">64.9 <span id="S4.T5.6.1.5.4.1" class="ltx_text" style="font-size:70%;">(1.0)</span>
</td>
<td id="S4.T5.6.1.5.5" class="ltx_td ltx_align_center">72.4 <span id="S4.T5.6.1.5.5.1" class="ltx_text" style="font-size:70%;">(0.3)</span>
</td>
</tr>
<tr id="S4.T5.6.1.6" class="ltx_tr">
<td id="S4.T5.6.1.6.1" class="ltx_td ltx_align_left ltx_border_r">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="S4.T5.6.1.6.2" class="ltx_td ltx_align_center">33.1 <span id="S4.T5.6.1.6.2.1" class="ltx_text" style="font-size:70%;">(1.4)</span>
</td>
<td id="S4.T5.6.1.6.3" class="ltx_td ltx_align_center">34.1 <span id="S4.T5.6.1.6.3.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T5.6.1.6.4" class="ltx_td ltx_align_center">35.4 <span id="S4.T5.6.1.6.4.1" class="ltx_text" style="font-size:70%;">(0.8)</span>
</td>
<td id="S4.T5.6.1.6.5" class="ltx_td ltx_align_center">35.7 <span id="S4.T5.6.1.6.5.1" class="ltx_text" style="font-size:70%;">(0.5)</span>
</td>
</tr>
<tr id="S4.T5.6.1.7" class="ltx_tr">
<td id="S4.T5.6.1.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T5.6.1.7.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="S4.T5.6.1.7.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.7.2.1" class="ltx_text" style="background-color:#A8E3A1;">49.5 <span id="S4.T5.6.1.7.2.1.1" class="ltx_text" style="font-size:70%;">(1.1)</span></span></td>
<td id="S4.T5.6.1.7.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.7.3.1" class="ltx_text" style="background-color:#A8E3A1;">65.9 <span id="S4.T5.6.1.7.3.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T5.6.1.7.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.7.4.1" class="ltx_text" style="background-color:#A8E3A1;">68.9 <span id="S4.T5.6.1.7.4.1.1" class="ltx_text" style="font-size:70%;">(0.6)</span></span></td>
<td id="S4.T5.6.1.7.5" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.7.5.1" class="ltx_text" style="background-color:#FFFFFF;">72.7 <span id="S4.T5.6.1.7.5.1.1" class="ltx_text" style="font-size:70%;">(0.2)</span></span></td>
</tr>
<tr id="S4.T5.6.1.8" class="ltx_tr">
<td id="S4.T5.6.1.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T5.6.1.8.1.1" class="ltx_text">NB-ASR</span></td>
<td id="S4.T5.6.1.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">DAGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>
</td>
<td id="S4.T5.6.1.8.3" class="ltx_td ltx_align_center ltx_border_t">29.5 <span id="S4.T5.6.1.8.3.1" class="ltx_text" style="font-size:70%;">(3.9)</span>
</td>
<td id="S4.T5.6.1.8.4" class="ltx_td ltx_align_center ltx_border_t">40.9 <span id="S4.T5.6.1.8.4.1" class="ltx_text" style="font-size:70%;">(2.4)</span>
</td>
<td id="S4.T5.6.1.8.5" class="ltx_td ltx_align_center ltx_border_t">45.2 <span id="S4.T5.6.1.8.5.1" class="ltx_text" style="font-size:70%;">(1.3)</span>
</td>
<td id="S4.T5.6.1.8.6" class="ltx_td ltx_align_center ltx_border_t">44.0 <span id="S4.T5.6.1.8.6.1" class="ltx_text" style="font-size:70%;">(0.4)</span>
</td>
</tr>
<tr id="S4.T5.6.1.9" class="ltx_tr">
<td id="S4.T5.6.1.9.1" class="ltx_td ltx_align_left ltx_border_r">DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>
</td>
<td id="S4.T5.6.1.9.2" class="ltx_td ltx_align_center">29.9 <span id="S4.T5.6.1.9.2.1" class="ltx_text" style="font-size:70%;">(5.4)</span>
</td>
<td id="S4.T5.6.1.9.3" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.9.3.1" class="ltx_text" style="background-color:#FFFFFF;">42.5 <span id="S4.T5.6.1.9.3.1.1" class="ltx_text" style="font-size:70%;">(1.1)</span></span></td>
<td id="S4.T5.6.1.9.4" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.9.4.1" class="ltx_text" style="background-color:#FFFFFF;">45.3 <span id="S4.T5.6.1.9.4.1.1" class="ltx_text" style="font-size:70%;">(1.0)</span></span></td>
<td id="S4.T5.6.1.9.5" class="ltx_td ltx_align_center">34.6 <span id="S4.T5.6.1.9.5.1" class="ltx_text" style="font-size:70%;">(5.8)</span>
</td>
</tr>
<tr id="S4.T5.6.1.10" class="ltx_tr">
<td id="S4.T5.6.1.10.1" class="ltx_td ltx_align_left ltx_border_r">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="S4.T5.6.1.10.2" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.10.2.1" class="ltx_text" style="background-color:#A8E3A1;">34.0 <span id="S4.T5.6.1.10.2.1.1" class="ltx_text" style="font-size:70%;">(2.3)</span></span></td>
<td id="S4.T5.6.1.10.3" class="ltx_td ltx_align_center">41.4 <span id="S4.T5.6.1.10.3.1" class="ltx_text" style="font-size:70%;">(2.0)</span>
</td>
<td id="S4.T5.6.1.10.4" class="ltx_td ltx_align_center">44.9 <span id="S4.T5.6.1.10.4.1" class="ltx_text" style="font-size:70%;">(2.2)</span>
</td>
<td id="S4.T5.6.1.10.5" class="ltx_td ltx_align_center" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.10.5.1" class="ltx_text" style="background-color:#FFFFFF;">50.9 <span id="S4.T5.6.1.10.5.1.1" class="ltx_text" style="font-size:70%;">(0.8)</span></span></td>
</tr>
<tr id="S4.T5.6.1.11" class="ltx_tr">
<td id="S4.T5.6.1.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T5.6.1.11.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="S4.T5.6.1.11.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#FFFFFF;"><span id="S4.T5.6.1.11.2.1" class="ltx_text" style="background-color:#FFFFFF;">31.1 <span id="S4.T5.6.1.11.2.1.1" class="ltx_text" style="font-size:70%;">(8.0)</span></span></td>
<td id="S4.T5.6.1.11.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.11.3.1" class="ltx_text" style="background-color:#A8E3A1;">44.0 <span id="S4.T5.6.1.11.3.1.1" class="ltx_text" style="font-size:70%;">(0.9)</span></span></td>
<td id="S4.T5.6.1.11.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.11.4.1" class="ltx_text" style="background-color:#A8E3A1;">47.3 <span id="S4.T5.6.1.11.4.1.1" class="ltx_text" style="font-size:70%;">(1.3)</span></span></td>
<td id="S4.T5.6.1.11.5" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#A8E3A1;"><span id="S4.T5.6.1.11.5.1" class="ltx_text" style="background-color:#A8E3A1;">52.2 <span id="S4.T5.6.1.11.5.1.1" class="ltx_text" style="font-size:70%;">(1.4)</span></span></td>
</tr>
<tr id="S4.T5.6.1.12" class="ltx_tr">
<td id="S4.T5.6.1.12.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="6"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation studies</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this subsection, we conduct ablation studies to validate the design choices made in <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>. Specifically, we aim to analyze the necessity of (a) asynchronous message-passing, (b) forward-backward message-passing, and (c) flow-aware global attention.
To this end, we use four variants of <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> <span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_bold">(1)</span> without the flow encode module (i.e., eliminating both asynchronous and forward-backward message passing), <span id="S4.SS3.p1.1.4" class="ltx_text ltx_font_bold">(2)</span> without asynchronous message passing, <span id="S4.SS3.p1.1.5" class="ltx_text ltx_font_bold">(3)</span> without forward-backward message passing, and <span id="S4.SS3.p1.1.6" class="ltx_text ltx_font_bold">(4)</span> without flow-aware global attention.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">As shown in <a href="#S4.T4" title="In 4.2 Performance on computer vision benchmarks ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, <span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, which is equipped with all the components, consistently outperforms all variants in most settings, confirming the efficacy of our design choices. Further observations deserve attention. First, the necessity of asynchronous message passing for capturing flows is confirmed by the superior performance of <span id="S4.SS3.p2.1.2" class="ltx_text ltx_font_bold">(3)</span> over <span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_bold">(1)</span>, and that of <span id="S4.SS3.p2.1.4" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> over <span id="S4.SS3.p2.1.5" class="ltx_text ltx_font_bold">(2)</span>.
Second, the advantage of forward-backward message passing is demonstrated by <span id="S4.SS3.p2.1.6" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>’s superiority over <span id="S4.SS3.p2.1.7" class="ltx_text ltx_font_bold">(3)</span>.
Lastly, incorporating flow-awareness into global attention is advantageous, as evidenced by <span id="S4.SS3.p2.1.8" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>’s advantage over variant <span id="S4.SS3.p2.1.9" class="ltx_text ltx_font_bold">(4)</span>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Performance in various domains</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Since our input modeling does not require complex preprocessing, it can be readily applied to architectures across various domains.
We apply <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> to graph neural networks on NAS-Bench-Graph and automatic speech recognition architectures on NAS-Bench-ASR. Among the baseline methods used in <a href="#S4.SS2" title="4.2 Performance on computer vision benchmarks ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>, we use the best method of each type: DAGNN, DAGFormer, and TA-GATES.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">As shown in <a href="#S4.T5" title="In 4.2 Performance on computer vision benchmarks ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> consistently performs best in most cases.
These results indicate that <span id="S4.SS4.p2.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> effectively captures important architectural characteristics across various domains. TA-GATES, which is tailored for encoding architectures in the computer vision domain, also shows strong performance in the domain of automatic speech recognition. TA-GATES effectively updates operation embeddings by multiplying operation embeddings and input information vectors, which is akin to convolutional mechanisms prevalent in auto speech recognition architectures. However, its effectiveness diminishes in scenarios where message passing between nodes, a key characteristic of graph neural networks, is required.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Training and inference speed</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">In this subsection, we compare the training and inference speeds of <span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> and two state-of-the-art neural architecture encoding methods: NAR-Former and TA-GATES.
To this end, we train all the models for 200 epochs with a batch size of 128, using an NVIDIA RTX 2080 GPU.
We use NAS-Bench-101 with a training ratio of 1%.
For a fair comparison, we exclude all additional time-consuming training strategies of NAR-Former and TA-GATES (e.g., input augmentation) in this experiment.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.2" class="ltx_p">As shown in <a href="#S4.T6" title="In 4.5 Training and inference speed ‣ 4 Experiments ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, <span id="S4.SS5.p2.2.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> takes the shortest training time among the three methods.
In particular, training <span id="S4.SS5.p2.2.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> is <math id="S4.SS5.p2.1.m1.1" class="ltx_math_unparsed" alttext="4.44\times" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mrow id="S4.SS5.p2.1.m1.1b"><mn id="S4.SS5.p2.1.m1.1.1">4.44</mn><mo lspace="0.222em" id="S4.SS5.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">4.44\times</annotation></semantics></math> faster than training NAR-Former.
This substantial speed advantage stems from the notable difference in model sizes, with NAR-Former having <math id="S4.SS5.p2.2.m2.1" class="ltx_math_unparsed" alttext="5.35\times" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mrow id="S4.SS5.p2.2.m2.1b"><mn id="S4.SS5.p2.2.m2.1.1">5.35</mn><mo lspace="0.222em" id="S4.SS5.p2.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">5.35\times</annotation></semantics></math> the number of parameters compared to <span id="S4.SS5.p2.2.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.
Compared to TA-GATES, <span id="S4.SS5.p2.2.4" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> exhibits a slight speed advantage.
Despite the small model size of TA-GATES, our specialized batch operations boost the training of <span id="S4.SS5.p2.2.5" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.
Refer to the supplementary material for details of the batch operations.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">In terms of inference time, there is not much difference among the three methods, and <span id="S4.SS5.p3.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> ranks second.
In practical scenarios, neural architecture performance prediction involves collecting labels (e.g., ground-truth performance) for the architectures in the training set, which requires time-consuming training of the architectures.
For example, in the case of NAS-Bench-101, training just 1% of the architectures can take up to 24 GPU hours.
Thus, inference speed is not a bottleneck, due to the extensive computational cost of training.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.2.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S4.T6.3.2" class="ltx_text" style="font-size:90%;">Training and inference times on NAS-Bench-101 with a training ratio of 1%, 200 epochs, and a batch size of 128.</span></figcaption>
<div id="S4.T6.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:321.2pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.5pt,13.5pt) scale(0.75,0.75) ;">
<table id="S4.T6.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T6.4.1.1" class="ltx_tr">
<td id="S4.T6.4.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="4"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T6.4.1.2" class="ltx_tr">
<td id="S4.T6.4.1.2.1" class="ltx_td ltx_align_left ltx_border_r">Encoder</td>
<td id="S4.T6.4.1.2.2" class="ltx_td ltx_align_right ltx_border_r">Training time (sec)</td>
<td id="S4.T6.4.1.2.3" class="ltx_td ltx_align_right ltx_border_r">Inference time (sec)</td>
<td id="S4.T6.4.1.2.4" class="ltx_td ltx_align_right"># Params</td>
</tr>
<tr id="S4.T6.4.1.3" class="ltx_tr">
<td id="S4.T6.4.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>
</td>
<td id="S4.T6.4.1.3.2" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">278.13 <span id="S4.T6.4.1.3.2.1" class="ltx_text" style="font-size:70%;">(13.01)</span>
</td>
<td id="S4.T6.4.1.3.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">2.55 <span id="S4.T6.4.1.3.3.1" class="ltx_text" style="font-size:70%;">(0.07)</span>
</td>
<td id="S4.T6.4.1.3.4" class="ltx_td ltx_align_right ltx_border_t">4,882,081</td>
</tr>
<tr id="S4.T6.4.1.4" class="ltx_tr">
<td id="S4.T6.4.1.4.1" class="ltx_td ltx_align_left ltx_border_r">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="S4.T6.4.1.4.2" class="ltx_td ltx_align_right ltx_border_r">62.66 <span id="S4.T6.4.1.4.2.1" class="ltx_text" style="font-size:70%;">(0.54)</span>
</td>
<td id="S4.T6.4.1.4.3" class="ltx_td ltx_align_right ltx_border_r">3.01 <span id="S4.T6.4.1.4.3.1" class="ltx_text" style="font-size:70%;">(0.21)</span>
</td>
<td id="S4.T6.4.1.4.4" class="ltx_td ltx_align_right">348,065</td>
</tr>
<tr id="S4.T6.4.1.5" class="ltx_tr">
<td id="S4.T6.4.1.5.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T6.4.1.5.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="S4.T6.4.1.5.2" class="ltx_td ltx_align_right ltx_border_r">58.08 <span id="S4.T6.4.1.5.2.1" class="ltx_text" style="font-size:70%;">(1.39)</span>
</td>
<td id="S4.T6.4.1.5.3" class="ltx_td ltx_align_right ltx_border_r">2.94 <span id="S4.T6.4.1.5.3.1" class="ltx_text" style="font-size:70%;">(0.07)</span>
</td>
<td id="S4.T6.4.1.5.4" class="ltx_td ltx_align_right">901,459</td>
</tr>
<tr id="S4.T6.4.1.6" class="ltx_tr">
<td id="S4.T6.4.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" colspan="4"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we propose <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, a novel graph transformer model designed for neural architecture encoding.
<span id="S5.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> excels at capturing information flows within neural architectures, considering both local and global aspects.
Through comprehensive evaluations across five benchmarks for architecture performance prediction, <span id="S5.p1.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> exhibits significant and consistent superiority over several state-of-the-art baseline methods, ultimately achieving state-of-the-art performance.
Notably, <span id="S5.p1.1.4" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>’s superiority extends beyond computer-vision architectures, demonstrating its effectiveness for graph-learning and speech-recognition architectures.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p"><span id="Sx1.p1.1.1" class="ltx_text" style="font-size:90%;">This work was supported by Institute of Information &amp; Communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) (No. 2022-0-00871, Development of AI Autonomy and Knowledge Enhancement for AI Agent Collaboration) (No. 2019-0-00075, Artificial Intelligence Graduate School Program (KAIST)).
</span><span id="Sx1.p1.1.2" class="ltx_text"></span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib1.4.4.1" class="ltx_text" style="font-size:90%;">Agarap [2018]</span></span>
<span class="ltx_bibblock"><span id="bib.bib1.6.1" class="ltx_text" style="font-size:90%;">
Abien Fred Agarap.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.7.1" class="ltx_text" style="font-size:90%;">Deep learning using rectified linear units (relu).
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib1.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1803.08375</em><span id="bib.bib1.9.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib2.4.4.1" class="ltx_text" style="font-size:90%;">Alon and Yahav [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib2.6.1" class="ltx_text" style="font-size:90%;">
Uri Alon and Eran Yahav.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.7.1" class="ltx_text" style="font-size:90%;">On the bottleneck of graph neural networks and its practical implications.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib2.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.05205</em><span id="bib.bib2.9.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib3.4.4.1" class="ltx_text" style="font-size:90%;">Bresson and Laurent [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib3.6.1" class="ltx_text" style="font-size:90%;">
Xavier Bresson and Thomas Laurent.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.7.1" class="ltx_text" style="font-size:90%;">Residual gated graph convnets.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib3.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1711.07553</em><span id="bib.bib3.9.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib4.5.5.1" class="ltx_text" style="font-size:90%;">Chatzianastasis et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib4.7.1" class="ltx_text" style="font-size:90%;">
Michail Chatzianastasis, George Dasoulas, Georgios Siolas, and Michalis Vazirgiannis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.8.1" class="ltx_text" style="font-size:90%;">Graph-based neural architecture search with operation embeddings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib4.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICCV</em><span id="bib.bib4.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib5.5.5.1" class="ltx_text" style="font-size:90%;">Chen et al. [2021a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib5.7.1" class="ltx_text" style="font-size:90%;">
Yaofo Chen, Yong Guo, Qi Chen, Minli Li, Wei Zeng, Yaowei Wang, and Mingkui Tan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.8.1" class="ltx_text" style="font-size:90%;">Contrastive neural architecture search with neural architecture comparators.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib5.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">CVPR</em><span id="bib.bib5.11.3" class="ltx_text" style="font-size:90%;">, 2021a.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib6.5.5.1" class="ltx_text" style="font-size:90%;">Chen et al. [2021b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib6.7.1" class="ltx_text" style="font-size:90%;">
Ziye Chen, Yibing Zhan, Baosheng Yu, Mingming Gong, and Bo Du.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.8.1" class="ltx_text" style="font-size:90%;">Not all operations contribute equally: Hierarchical operation-adaptive predictor for neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib6.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICCV</em><span id="bib.bib6.11.3" class="ltx_text" style="font-size:90%;">, 2021b.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib7.5.5.1" class="ltx_text" style="font-size:90%;">Chen et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib7.7.1" class="ltx_text" style="font-size:90%;">
Zhe Chen, Hao Tan, Tao Wang, Tianrun Shen, Tong Lu, Qiuying Peng, Cheng Cheng, and Yue Qi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.8.1" class="ltx_text" style="font-size:90%;">Graph propagation transformer for graph representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib7.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">IJCAI</em><span id="bib.bib7.11.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib8.5.5.1" class="ltx_text" style="font-size:90%;">Cheng et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib8.7.1" class="ltx_text" style="font-size:90%;">
Hsin-Pai Cheng, Tunhou Zhang, Yixing Zhang, Shiyu Li, Feng Liang, Feng Yan, Meng Li, Vikas Chandra, Hai Li, and Yiran Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.8.1" class="ltx_text" style="font-size:90%;">Nasgem: Neural architecture search via graph embedding method.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib8.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">AAAI</em><span id="bib.bib8.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib9.5.5.1" class="ltx_text" style="font-size:90%;">Crouse et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib9.7.1" class="ltx_text" style="font-size:90%;">
Maxwell Crouse, Ibrahim Abdelaziz, Cristina Cornelio, Veronika Thost, Lingfei Wu, Kenneth Forbus, and Achille Fokoue.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.8.1" class="ltx_text" style="font-size:90%;">Improving graph neural network representations of logical formulae with subgraph pooling.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib9.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1911.06904</em><span id="bib.bib9.10.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib10.4.4.1" class="ltx_text" style="font-size:90%;">Dong and Yang [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib10.6.1" class="ltx_text" style="font-size:90%;">
Xuanyi Dong and Yi Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.7.1" class="ltx_text" style="font-size:90%;">Nas-bench-201: Extending the scope of reproducible neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.8.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib10.9.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib10.10.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib11.4.4.1" class="ltx_text" style="font-size:90%;">Dwivedi and Bresson [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib11.6.1" class="ltx_text" style="font-size:90%;">
Vijay Prakash Dwivedi and Xavier Bresson.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.7.1" class="ltx_text" style="font-size:90%;">A generalization of transformer networks to graphs.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib11.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2012.09699</em><span id="bib.bib11.9.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib12.4.4.1" class="ltx_text" style="font-size:90%;">et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib12.6.1" class="ltx_text" style="font-size:90%;">
C. Wei et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.7.1" class="ltx_text" style="font-size:90%;">Npenas: Neural predictor guided evolution for neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib12.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</em><span id="bib.bib12.9.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib13.5.5.1" class="ltx_text" style="font-size:90%;">Garofolo et al. [1993]</span></span>
<span class="ltx_bibblock"><span id="bib.bib13.7.1" class="ltx_text" style="font-size:90%;">
John S Garofolo, Lori F Lamel, William M Fisher, Jonathan G Fiscus, and David S Pallett.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.8.1" class="ltx_text" style="font-size:90%;">Darpa timit acoustic-phonetic continous speech corpus cd-rom. nist speech disc 1-1.1.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib13.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">NASA STI/Recon technical report n</em><span id="bib.bib13.10.2" class="ltx_text" style="font-size:90%;">, 93:27403, 1993.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib14.5.5.1" class="ltx_text" style="font-size:90%;">He et al. [2016]</span></span>
<span class="ltx_bibblock"><span id="bib.bib14.7.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.8.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib14.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">CVPR</em><span id="bib.bib14.11.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib15.5.5.1" class="ltx_text" style="font-size:90%;">Huang et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib15.7.1" class="ltx_text" style="font-size:90%;">
Gao Huang, Zhuang Liu, Laurens Van Der Maaten, and Kilian Q Weinberger.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.8.1" class="ltx_text" style="font-size:90%;">Densely connected convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib15.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">CVPR</em><span id="bib.bib15.11.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib16.5.5.1" class="ltx_text" style="font-size:90%;">Hussain et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib16.7.1" class="ltx_text" style="font-size:90%;">
Md Shamim Hussain, Mohammed J Zaki, and Dharmashankar Subramanian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.8.1" class="ltx_text" style="font-size:90%;">Global self-attention as a replacement for graph convolution.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib16.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">KDD</em><span id="bib.bib16.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib17.5.5.1" class="ltx_text" style="font-size:90%;">Jiang et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib17.7.1" class="ltx_text" style="font-size:90%;">
Yinghui Jiang, Shuting Jin, Xurui Jin, Xianglu Xiao, Wenfan Wu, Xiangrong Liu, Qiang Zhang, Xiangxiang Zeng, Guang Yang, and Zhangming Niu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.8.1" class="ltx_text" style="font-size:90%;">Pharmacophoric-constrained heterogeneous graph transformer model for molecular property prediction.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib17.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Communications Chemistry</em><span id="bib.bib17.10.2" class="ltx_text" style="font-size:90%;">, 6(1):60, 2023.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib18.4.4.1" class="ltx_text" style="font-size:90%;">Kipf and Welling [2016]</span></span>
<span class="ltx_bibblock"><span id="bib.bib18.6.1" class="ltx_text" style="font-size:90%;">
Thomas N Kipf and Max Welling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.7.1" class="ltx_text" style="font-size:90%;">Semi-supervised classification with graph convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib18.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1609.02907</em><span id="bib.bib18.9.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib19.5.5.1" class="ltx_text" style="font-size:90%;">Kreuzer et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib19.7.1" class="ltx_text" style="font-size:90%;">
Devin Kreuzer, Dominique Beaini, Will Hamilton, Vincent Létourneau, and Prudencio Tossou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.8.1" class="ltx_text" style="font-size:90%;">Rethinking graph transformers with spectral attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib19.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib19.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib20.5.5.1" class="ltx_text" style="font-size:90%;">Krizhevsky et al. [2009]</span></span>
<span class="ltx_bibblock"><span id="bib.bib20.7.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Geoffrey Hinton, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.8.1" class="ltx_text" style="font-size:90%;">Learning multiple layers of features from tiny images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.9.1" class="ltx_text" style="font-size:90%;">2009.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib21.5.5.1" class="ltx_text" style="font-size:90%;">Liu et al. [2018]</span></span>
<span class="ltx_bibblock"><span id="bib.bib21.7.1" class="ltx_text" style="font-size:90%;">
Chenxi Liu, Barret Zoph, Maxim Neumann, Jonathon Shlens, Wei Hua, Li-Jia Li, Li Fei-Fei, Alan Yuille, Jonathan Huang, and Kevin Murphy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.8.1" class="ltx_text" style="font-size:90%;">Progressive neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib21.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ECCV</em><span id="bib.bib21.11.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib22.4.4.1" class="ltx_text" style="font-size:90%;">Loshchilov and Hutter [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib22.6.1" class="ltx_text" style="font-size:90%;">
Ilya Loshchilov and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.7.1" class="ltx_text" style="font-size:90%;">Decoupled weight decay regularization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.8.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib22.9.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib22.10.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib23.5.5.1" class="ltx_text" style="font-size:90%;">Lu et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib23.7.1" class="ltx_text" style="font-size:90%;">
Shun Lu, Jixiang Li, Jianchao Tan, Sen Yang, and Ji Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.8.1" class="ltx_text" style="font-size:90%;">Tnasp: A transformer-based nas predictor with a self-evolution framework.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib23.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib23.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib24.5.5.1" class="ltx_text" style="font-size:90%;">Luo et al. [2018]</span></span>
<span class="ltx_bibblock"><span id="bib.bib24.7.1" class="ltx_text" style="font-size:90%;">
Renqian Luo, Fei Tian, Tao Qin, Enhong Chen, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.8.1" class="ltx_text" style="font-size:90%;">Neural architecture optimization.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib24.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib24.10.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib25.5.5.1" class="ltx_text" style="font-size:90%;">Luo et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib25.7.1" class="ltx_text" style="font-size:90%;">
Renqian Luo, Xu Tan, Rui Wang, Tao Qin, Enhong Chen, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.8.1" class="ltx_text" style="font-size:90%;">Semi-supervised neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib25.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib25.11.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib26.5.5.1" class="ltx_text" style="font-size:90%;">Luo et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib26.7.1" class="ltx_text" style="font-size:90%;">
Yuankai Luo, Veronika Thost, and Lei Shi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.8.1" class="ltx_text" style="font-size:90%;">Transformers over directed acyclic graphs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib26.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib26.11.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib27.5.5.1" class="ltx_text" style="font-size:90%;">Ma et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib27.7.1" class="ltx_text" style="font-size:90%;">
Liheng Ma, Chen Lin, Derek Lim, Adriana Romero-Soriano, Puneet K Dokania, Mark Coates, Philip Torr, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.8.1" class="ltx_text" style="font-size:90%;">Graph inductive biases in transformers without message passing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib27.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib27.11.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib28.5.5.1" class="ltx_text" style="font-size:90%;">Mehrotra et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib28.7.1" class="ltx_text" style="font-size:90%;">
Abhinav Mehrotra, Alberto Gil CP Ramos, Sourav Bhattacharya, Łukasz Dudziak, Ravichander Vipperla, Thomas Chau, Mohamed S Abdelfattah, Samin Ishtiaq, and Nicholas Donald Lane.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.8.1" class="ltx_text" style="font-size:90%;">Nas-bench-asr: Reproducible neural architecture search for speech recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib28.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib28.11.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib29.5.5.1" class="ltx_text" style="font-size:90%;">Mialon et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib29.7.1" class="ltx_text" style="font-size:90%;">
Grégoire Mialon, Dexiong Chen, Margot Selosse, and Julien Mairal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.8.1" class="ltx_text" style="font-size:90%;">Graphit: Encoding graph structure in transformers.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib29.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2106.05667</em><span id="bib.bib29.10.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib30.5.5.1" class="ltx_text" style="font-size:90%;">Nguyen et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib30.7.1" class="ltx_text" style="font-size:90%;">
Hoang D Nguyen, Xuan-Son Vu, and Duc-Trong Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.8.1" class="ltx_text" style="font-size:90%;">Modular graph transformer networks for multi-label image classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib30.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">AAAI</em><span id="bib.bib30.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib31.5.5.1" class="ltx_text" style="font-size:90%;">Ning et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib31.7.1" class="ltx_text" style="font-size:90%;">
Xuefei Ning, Yin Zheng, Tianchen Zhao, Yu Wang, and Huazhong Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.8.1" class="ltx_text" style="font-size:90%;">A generic graph-based neural architecture encoding scheme for predictor-based nas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib31.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ECCV</em><span id="bib.bib31.11.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib32.5.5.1" class="ltx_text" style="font-size:90%;">Ning et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib32.7.1" class="ltx_text" style="font-size:90%;">
Xuefei Ning, Zixuan Zhou, Junbo Zhao, Tianchen Zhao, Yiping Deng, Changcheng Tang, Shuang Liang, Huazhong Yang, and Yu Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.8.1" class="ltx_text" style="font-size:90%;">Ta-gates: An encoding scheme for neural network architectures.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib32.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib32.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib33.5.5.1" class="ltx_text" style="font-size:90%;">Niu et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib33.7.1" class="ltx_text" style="font-size:90%;">
Peisong Niu, Tian Zhou, Qingsong Wen, Liang Sun, and Tao Yao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.8.1" class="ltx_text" style="font-size:90%;">Chemistry guided molecular graph transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib33.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS 2022 Workshop: AI for Science: Progress and Promises</em><span id="bib.bib33.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib34.4.4.1" class="ltx_text" style="font-size:90%;">Oono and Suzuki [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib34.6.1" class="ltx_text" style="font-size:90%;">
Kenta Oono and Taiji Suzuki.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.7.1" class="ltx_text" style="font-size:90%;">Graph neural networks exponentially lose expressive power for node classification.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib34.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1905.10947</em><span id="bib.bib34.9.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib35.5.5.1" class="ltx_text" style="font-size:90%;">Pang et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib35.7.1" class="ltx_text" style="font-size:90%;">
Yunsheng Pang, Qiuhong Ke, Hossein Rahmani, James Bailey, and Jun Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.8.1" class="ltx_text" style="font-size:90%;">Igformer: Interaction graph transformer for skeleton-based human interaction recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib35.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ECCV</em><span id="bib.bib35.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib36.5.5.1" class="ltx_text" style="font-size:90%;">Qin et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib36.7.1" class="ltx_text" style="font-size:90%;">
Yijian Qin, Ziwei Zhang, Xin Wang, Zeyang Zhang, and Wenwu Zhu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.8.1" class="ltx_text" style="font-size:90%;">Nas-bench-graph: Benchmarking graph neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib36.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib36.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib37.5.5.1" class="ltx_text" style="font-size:90%;">Rampášek et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib37.7.1" class="ltx_text" style="font-size:90%;">
Ladislav Rampášek, Michael Galkin, Vijay Prakash Dwivedi, Anh Tuan Luu, Guy Wolf, and Dominique Beaini.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.8.1" class="ltx_text" style="font-size:90%;">Recipe for a general, powerful, scalable graph transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib37.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib37.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib38.5.5.1" class="ltx_text" style="font-size:90%;">Rong et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib38.7.1" class="ltx_text" style="font-size:90%;">
Yu Rong, Yatao Bian, Tingyang Xu, Weiyang Xie, Ying Wei, Wenbing Huang, and Junzhou Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.8.1" class="ltx_text" style="font-size:90%;">Self-supervised graph transformer on large-scale molecular data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib38.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib38.11.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib39.5.5.1" class="ltx_text" style="font-size:90%;">Sen et al. [2008]</span></span>
<span class="ltx_bibblock"><span id="bib.bib39.7.1" class="ltx_text" style="font-size:90%;">
Prithviraj Sen, Galileo Namata, Mustafa Bilgic, Lise Getoor, Brian Galligher, and Tina Eliassi-Rad.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.8.1" class="ltx_text" style="font-size:90%;">Collective classification in network data.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib39.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">AI magazine</em><span id="bib.bib39.10.2" class="ltx_text" style="font-size:90%;">, 29(3):93–93, 2008.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib40.4.4.1" class="ltx_text" style="font-size:90%;">Sen [1968]</span></span>
<span class="ltx_bibblock"><span id="bib.bib40.6.1" class="ltx_text" style="font-size:90%;">
Pranab Kumar Sen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.7.1" class="ltx_text" style="font-size:90%;">Estimates of the regression coefficient based on kendall’s tau.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib40.8.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Journal of the American statistical association</em><span id="bib.bib40.9.2" class="ltx_text" style="font-size:90%;">, 63(324):1379–1389, 1968.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib41.5.5.1" class="ltx_text" style="font-size:90%;">Shi et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib41.7.1" class="ltx_text" style="font-size:90%;">
Han Shi, Renjie Pi, Hang Xu, Zhenguo Li, James Kwok, and Tong Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.8.1" class="ltx_text" style="font-size:90%;">Bridging the gap between sample-based and one-shot neural architecture search with bonas.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib41.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib41.10.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib42.5.5.1" class="ltx_text" style="font-size:90%;">Shi et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib42.7.1" class="ltx_text" style="font-size:90%;">
Yu Shi, Shuxin Zheng, Guolin Ke, Yifei Shen, Jiacheng You, Jiyan He, Shengjie Luo, Chang Liu, Di He, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.8.1" class="ltx_text" style="font-size:90%;">Benchmarking graphormer on large-scale molecular modeling datasets.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib42.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2203.04810</em><span id="bib.bib42.10.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib43.4.4.1" class="ltx_text" style="font-size:90%;">Thost and Chen [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib43.6.1" class="ltx_text" style="font-size:90%;">
Veronika Thost and Jie Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.7.1" class="ltx_text" style="font-size:90%;">Directed acyclic graph neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.8.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib43.9.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib43.10.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib44.5.5.1" class="ltx_text" style="font-size:90%;">Vaswani et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib44.7.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.8.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib44.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib44.11.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib45.5.5.1" class="ltx_text" style="font-size:90%;">Wang et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib45.7.1" class="ltx_text" style="font-size:90%;">
Linnan Wang, Yiyang Zhao, Yuu Jinnai, Yuandong Tian, and Rodrigo Fonseca.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.8.1" class="ltx_text" style="font-size:90%;">Alphax: exploring neural architectures with deep neural networks and monte carlo tree search.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib45.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1903.11059</em><span id="bib.bib45.10.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib46.5.5.1" class="ltx_text" style="font-size:90%;">Wen et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib46.7.1" class="ltx_text" style="font-size:90%;">
Wei Wen, Hanxiao Liu, Yiran Chen, Hai Li, Gabriel Bender, and Pieter-Jan Kindermans.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.8.1" class="ltx_text" style="font-size:90%;">Neural predictor for neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib46.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ECCV</em><span id="bib.bib46.11.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib47.5.5.1" class="ltx_text" style="font-size:90%;">White et al. [2021a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib47.7.1" class="ltx_text" style="font-size:90%;">
Colin White, Willie Neiswanger, and Yash Savani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.8.1" class="ltx_text" style="font-size:90%;">Bananas: Bayesian optimization with neural architectures for neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib47.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">AAAI</em><span id="bib.bib47.11.3" class="ltx_text" style="font-size:90%;">, 2021a.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib48.5.5.1" class="ltx_text" style="font-size:90%;">White et al. [2021b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib48.7.1" class="ltx_text" style="font-size:90%;">
Colin White, Arber Zela, Robin Ru, Yang Liu, and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.8.1" class="ltx_text" style="font-size:90%;">How powerful are performance predictors in neural architecture search?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib48.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib48.11.3" class="ltx_text" style="font-size:90%;">, 2021b.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib49.5.5.1" class="ltx_text" style="font-size:90%;">Yan et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib49.7.1" class="ltx_text" style="font-size:90%;">
Shen Yan, Kaiqiang Song, Fei Liu, and Mi Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.8.1" class="ltx_text" style="font-size:90%;">Cate: Computation-aware neural architecture encoding with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib49.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib49.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib50.5.5.1" class="ltx_text" style="font-size:90%;">Yi et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib50.7.1" class="ltx_text" style="font-size:90%;">
Yun Yi, Haokui Zhang, Wenze Hu, Nannan Wang, and Xiaoyu Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.8.1" class="ltx_text" style="font-size:90%;">Nar-former: Neural architecture representation learning towards holistic attributes prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib50.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">CVPR</em><span id="bib.bib50.11.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib51.5.5.1" class="ltx_text" style="font-size:90%;">Ying et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib51.7.1" class="ltx_text" style="font-size:90%;">
Chris Ying, Aaron Klein, Eric Christiansen, Esteban Real, Kevin Murphy, and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.8.1" class="ltx_text" style="font-size:90%;">Nas-bench-101: Towards reproducible neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib51.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib51.11.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib52.5.5.1" class="ltx_text" style="font-size:90%;">Ying et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib52.7.1" class="ltx_text" style="font-size:90%;">
Chengxuan Ying, Tianle Cai, Shengjie Luo, Shuxin Zheng, Guolin Ke, Di He, Yanming Shen, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.8.1" class="ltx_text" style="font-size:90%;">Do transformers really perform badly for graph representation?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib52.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NeurIPS</em><span id="bib.bib52.11.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib53.5.5.1" class="ltx_text" style="font-size:90%;">Zela et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib53.7.1" class="ltx_text" style="font-size:90%;">
Arber Zela, Julien Siems, and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.8.1" class="ltx_text" style="font-size:90%;">Nas-bench-1shot1: Benchmarking and dissecting one-shot neural architecture search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib53.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib53.11.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib54.5.5.1" class="ltx_text" style="font-size:90%;">Zela et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib54.7.1" class="ltx_text" style="font-size:90%;">
Arber Zela, Julien Siems, Lucas Zimmer, Jovita Lukasik, Margret Keuper, and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.8.1" class="ltx_text" style="font-size:90%;">Surrogate nas benchmarks: Going beyond the limited search spaces of tabular nas benchmarks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib54.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib54.11.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib55.5.5.1" class="ltx_text" style="font-size:90%;">Zheng et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib55.7.1" class="ltx_text" style="font-size:90%;">
Yi Zheng, Rushin H Gindra, Emily J Green, Eric J Burks, Margrit Betke, Jennifer E Beane, and Vijaya B Kolachalama.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.8.1" class="ltx_text" style="font-size:90%;">A graph-transformer for whole slide image classification.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib55.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">IEEE transactions on medical imaging</em><span id="bib.bib55.10.2" class="ltx_text" style="font-size:90%;">, 41(11):3003–3015, 2022.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Dataset description</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">In this section, we provide detailed descriptions of the datasets used.</p>
</div>
<div id="A1.p2" class="ltx_para">
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p"><span id="A1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">NAS-Bench-101 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib51" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite></span>
is a dataset with 423K architectures trained on the CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib20" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> dataset.
NAS-Bench-101 has an operation-on-node (OON) search space <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">31</span></a>, <a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>.
Following <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Ning et al.</span> [<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, we used the same subset of the NAS-Bench-101 dataset.
This subset consists of 14,580 architectures.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p"><span id="A1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">NAS-Bench-201 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib10" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite></span>
is a dataset with 15K architectures trained on the CIFAR-10 dataset.
We transformed the dataset, which is originally operation-on-edge (OOE)-based, into the OON format.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p"><span id="A1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">NAS-Bench-301 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib54" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite></span>
is a surrogate benchmark with 57K architectures each of which consists of two cells (spec., normal and reduction cells).
This dataset is originally OOE-based, and we converted the dataset into the OON format.
Following <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Ning et al.</span> [<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, we only used the anchor architecture-performance pairs.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p"><span id="A1.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">NAS-Bench-ASR <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib28" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite></span>
is a dataset with 8K architectures of auto speech recognition models, trained on the TIMIT audio dataset <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib13" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>.
We transformed the dataset, which is originally OOE-based, into the OON format.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i5.p1" class="ltx_para">
<p id="A1.I1.i5.p1.1" class="ltx_p"><span id="A1.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">NAS-Bench-Graph <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib36" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite></span>
is a dataset with 26K architectures of graph neural networks, trained on the Cora dataset <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib39" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">39</span></a>]</cite>.
Since the dataset is originally OON-based, no additional transformation is required.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experimental Details</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Implementation details</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">In this subsection, we provide several implementation details of <span id="A2.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>.</p>
</div>
<div id="A2.SS1.p2" class="ltx_para ltx_noindent">
<p id="A2.SS1.p2.1" class="ltx_p"><span id="A2.SS1.p2.1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Code implementation:</span>
We employed the framework of GraphGPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> as the backbone to implement <span id="A2.SS1.p2.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> with Python 3.10, Pytorch 1.13.1, and Pytorch Geometric 2.2.0.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para ltx_noindent">
<p id="A2.SS1.p3.1" class="ltx_p"><span id="A2.SS1.p3.1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Obtaining representations in two-cell datasets:</span>
To obtain representations in two-cell-based datasets (e.g., NAS-Bench-301), we used the following projection strategy:</p>
</div>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.5" class="ltx_p">Let <math id="A2.SS1.p4.1.m1.2" class="ltx_Math" alttext="h_{1,o}\in\mathbb{R}^{d}" display="inline"><semantics id="A2.SS1.p4.1.m1.2a"><mrow id="A2.SS1.p4.1.m1.2.3" xref="A2.SS1.p4.1.m1.2.3.cmml"><msub id="A2.SS1.p4.1.m1.2.3.2" xref="A2.SS1.p4.1.m1.2.3.2.cmml"><mi id="A2.SS1.p4.1.m1.2.3.2.2" xref="A2.SS1.p4.1.m1.2.3.2.2.cmml">h</mi><mrow id="A2.SS1.p4.1.m1.2.2.2.4" xref="A2.SS1.p4.1.m1.2.2.2.3.cmml"><mn id="A2.SS1.p4.1.m1.1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.1.cmml">1</mn><mo id="A2.SS1.p4.1.m1.2.2.2.4.1" xref="A2.SS1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.1.m1.2.2.2.2" xref="A2.SS1.p4.1.m1.2.2.2.2.cmml">o</mi></mrow></msub><mo id="A2.SS1.p4.1.m1.2.3.1" xref="A2.SS1.p4.1.m1.2.3.1.cmml">∈</mo><msup id="A2.SS1.p4.1.m1.2.3.3" xref="A2.SS1.p4.1.m1.2.3.3.cmml"><mi id="A2.SS1.p4.1.m1.2.3.3.2" xref="A2.SS1.p4.1.m1.2.3.3.2.cmml">ℝ</mi><mi id="A2.SS1.p4.1.m1.2.3.3.3" xref="A2.SS1.p4.1.m1.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.2b"><apply id="A2.SS1.p4.1.m1.2.3.cmml" xref="A2.SS1.p4.1.m1.2.3"><in id="A2.SS1.p4.1.m1.2.3.1.cmml" xref="A2.SS1.p4.1.m1.2.3.1"></in><apply id="A2.SS1.p4.1.m1.2.3.2.cmml" xref="A2.SS1.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.2.3.2.1.cmml" xref="A2.SS1.p4.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS1.p4.1.m1.2.3.2.2.cmml" xref="A2.SS1.p4.1.m1.2.3.2.2">ℎ</ci><list id="A2.SS1.p4.1.m1.2.2.2.3.cmml" xref="A2.SS1.p4.1.m1.2.2.2.4"><cn type="integer" id="A2.SS1.p4.1.m1.1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1">1</cn><ci id="A2.SS1.p4.1.m1.2.2.2.2.cmml" xref="A2.SS1.p4.1.m1.2.2.2.2">𝑜</ci></list></apply><apply id="A2.SS1.p4.1.m1.2.3.3.cmml" xref="A2.SS1.p4.1.m1.2.3.3"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.2.3.3.1.cmml" xref="A2.SS1.p4.1.m1.2.3.3">superscript</csymbol><ci id="A2.SS1.p4.1.m1.2.3.3.2.cmml" xref="A2.SS1.p4.1.m1.2.3.3.2">ℝ</ci><ci id="A2.SS1.p4.1.m1.2.3.3.3.cmml" xref="A2.SS1.p4.1.m1.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.2c">h_{1,o}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="A2.SS1.p4.2.m2.2" class="ltx_Math" alttext="h_{2,o}\in\mathbb{R}^{d}" display="inline"><semantics id="A2.SS1.p4.2.m2.2a"><mrow id="A2.SS1.p4.2.m2.2.3" xref="A2.SS1.p4.2.m2.2.3.cmml"><msub id="A2.SS1.p4.2.m2.2.3.2" xref="A2.SS1.p4.2.m2.2.3.2.cmml"><mi id="A2.SS1.p4.2.m2.2.3.2.2" xref="A2.SS1.p4.2.m2.2.3.2.2.cmml">h</mi><mrow id="A2.SS1.p4.2.m2.2.2.2.4" xref="A2.SS1.p4.2.m2.2.2.2.3.cmml"><mn id="A2.SS1.p4.2.m2.1.1.1.1" xref="A2.SS1.p4.2.m2.1.1.1.1.cmml">2</mn><mo id="A2.SS1.p4.2.m2.2.2.2.4.1" xref="A2.SS1.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.2.m2.2.2.2.2" xref="A2.SS1.p4.2.m2.2.2.2.2.cmml">o</mi></mrow></msub><mo id="A2.SS1.p4.2.m2.2.3.1" xref="A2.SS1.p4.2.m2.2.3.1.cmml">∈</mo><msup id="A2.SS1.p4.2.m2.2.3.3" xref="A2.SS1.p4.2.m2.2.3.3.cmml"><mi id="A2.SS1.p4.2.m2.2.3.3.2" xref="A2.SS1.p4.2.m2.2.3.3.2.cmml">ℝ</mi><mi id="A2.SS1.p4.2.m2.2.3.3.3" xref="A2.SS1.p4.2.m2.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.2b"><apply id="A2.SS1.p4.2.m2.2.3.cmml" xref="A2.SS1.p4.2.m2.2.3"><in id="A2.SS1.p4.2.m2.2.3.1.cmml" xref="A2.SS1.p4.2.m2.2.3.1"></in><apply id="A2.SS1.p4.2.m2.2.3.2.cmml" xref="A2.SS1.p4.2.m2.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.2.3.2.1.cmml" xref="A2.SS1.p4.2.m2.2.3.2">subscript</csymbol><ci id="A2.SS1.p4.2.m2.2.3.2.2.cmml" xref="A2.SS1.p4.2.m2.2.3.2.2">ℎ</ci><list id="A2.SS1.p4.2.m2.2.2.2.3.cmml" xref="A2.SS1.p4.2.m2.2.2.2.4"><cn type="integer" id="A2.SS1.p4.2.m2.1.1.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1">2</cn><ci id="A2.SS1.p4.2.m2.2.2.2.2.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2">𝑜</ci></list></apply><apply id="A2.SS1.p4.2.m2.2.3.3.cmml" xref="A2.SS1.p4.2.m2.2.3.3"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.2.3.3.1.cmml" xref="A2.SS1.p4.2.m2.2.3.3">superscript</csymbol><ci id="A2.SS1.p4.2.m2.2.3.3.2.cmml" xref="A2.SS1.p4.2.m2.2.3.3.2">ℝ</ci><ci id="A2.SS1.p4.2.m2.2.3.3.3.cmml" xref="A2.SS1.p4.2.m2.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.2c">h_{2,o}\in\mathbb{R}^{d}</annotation></semantics></math> denote the embeddings of the output nodes of cell 1 and cell 2 after forward message passing.
Then, we concatenated <math id="A2.SS1.p4.3.m3.2" class="ltx_Math" alttext="h_{1,o}" display="inline"><semantics id="A2.SS1.p4.3.m3.2a"><msub id="A2.SS1.p4.3.m3.2.3" xref="A2.SS1.p4.3.m3.2.3.cmml"><mi id="A2.SS1.p4.3.m3.2.3.2" xref="A2.SS1.p4.3.m3.2.3.2.cmml">h</mi><mrow id="A2.SS1.p4.3.m3.2.2.2.4" xref="A2.SS1.p4.3.m3.2.2.2.3.cmml"><mn id="A2.SS1.p4.3.m3.1.1.1.1" xref="A2.SS1.p4.3.m3.1.1.1.1.cmml">1</mn><mo id="A2.SS1.p4.3.m3.2.2.2.4.1" xref="A2.SS1.p4.3.m3.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.3.m3.2.2.2.2" xref="A2.SS1.p4.3.m3.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.3.m3.2b"><apply id="A2.SS1.p4.3.m3.2.3.cmml" xref="A2.SS1.p4.3.m3.2.3"><csymbol cd="ambiguous" id="A2.SS1.p4.3.m3.2.3.1.cmml" xref="A2.SS1.p4.3.m3.2.3">subscript</csymbol><ci id="A2.SS1.p4.3.m3.2.3.2.cmml" xref="A2.SS1.p4.3.m3.2.3.2">ℎ</ci><list id="A2.SS1.p4.3.m3.2.2.2.3.cmml" xref="A2.SS1.p4.3.m3.2.2.2.4"><cn type="integer" id="A2.SS1.p4.3.m3.1.1.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1.1.1">1</cn><ci id="A2.SS1.p4.3.m3.2.2.2.2.cmml" xref="A2.SS1.p4.3.m3.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.3.m3.2c">h_{1,o}</annotation></semantics></math> and <math id="A2.SS1.p4.4.m4.2" class="ltx_Math" alttext="h_{2,o}" display="inline"><semantics id="A2.SS1.p4.4.m4.2a"><msub id="A2.SS1.p4.4.m4.2.3" xref="A2.SS1.p4.4.m4.2.3.cmml"><mi id="A2.SS1.p4.4.m4.2.3.2" xref="A2.SS1.p4.4.m4.2.3.2.cmml">h</mi><mrow id="A2.SS1.p4.4.m4.2.2.2.4" xref="A2.SS1.p4.4.m4.2.2.2.3.cmml"><mn id="A2.SS1.p4.4.m4.1.1.1.1" xref="A2.SS1.p4.4.m4.1.1.1.1.cmml">2</mn><mo id="A2.SS1.p4.4.m4.2.2.2.4.1" xref="A2.SS1.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.4.m4.2.2.2.2" xref="A2.SS1.p4.4.m4.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.4.m4.2b"><apply id="A2.SS1.p4.4.m4.2.3.cmml" xref="A2.SS1.p4.4.m4.2.3"><csymbol cd="ambiguous" id="A2.SS1.p4.4.m4.2.3.1.cmml" xref="A2.SS1.p4.4.m4.2.3">subscript</csymbol><ci id="A2.SS1.p4.4.m4.2.3.2.cmml" xref="A2.SS1.p4.4.m4.2.3.2">ℎ</ci><list id="A2.SS1.p4.4.m4.2.2.2.3.cmml" xref="A2.SS1.p4.4.m4.2.2.2.4"><cn type="integer" id="A2.SS1.p4.4.m4.1.1.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1.1.1">2</cn><ci id="A2.SS1.p4.4.m4.2.2.2.2.cmml" xref="A2.SS1.p4.4.m4.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.4.m4.2c">h_{2,o}</annotation></semantics></math> and projected the concatenated embeddings with a learnable projection matrix <math id="A2.SS1.p4.5.m5.1" class="ltx_Math" alttext="W^{P}\in\mathbb{R}^{2d\times 2d}" display="inline"><semantics id="A2.SS1.p4.5.m5.1a"><mrow id="A2.SS1.p4.5.m5.1.1" xref="A2.SS1.p4.5.m5.1.1.cmml"><msup id="A2.SS1.p4.5.m5.1.1.2" xref="A2.SS1.p4.5.m5.1.1.2.cmml"><mi id="A2.SS1.p4.5.m5.1.1.2.2" xref="A2.SS1.p4.5.m5.1.1.2.2.cmml">W</mi><mi id="A2.SS1.p4.5.m5.1.1.2.3" xref="A2.SS1.p4.5.m5.1.1.2.3.cmml">P</mi></msup><mo id="A2.SS1.p4.5.m5.1.1.1" xref="A2.SS1.p4.5.m5.1.1.1.cmml">∈</mo><msup id="A2.SS1.p4.5.m5.1.1.3" xref="A2.SS1.p4.5.m5.1.1.3.cmml"><mi id="A2.SS1.p4.5.m5.1.1.3.2" xref="A2.SS1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="A2.SS1.p4.5.m5.1.1.3.3" xref="A2.SS1.p4.5.m5.1.1.3.3.cmml"><mrow id="A2.SS1.p4.5.m5.1.1.3.3.2" xref="A2.SS1.p4.5.m5.1.1.3.3.2.cmml"><mrow id="A2.SS1.p4.5.m5.1.1.3.3.2.2" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.cmml"><mn id="A2.SS1.p4.5.m5.1.1.3.3.2.2.2" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.SS1.p4.5.m5.1.1.3.3.2.2.1" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.1.cmml">​</mo><mi id="A2.SS1.p4.5.m5.1.1.3.3.2.2.3" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p4.5.m5.1.1.3.3.2.1" xref="A2.SS1.p4.5.m5.1.1.3.3.2.1.cmml">×</mo><mn id="A2.SS1.p4.5.m5.1.1.3.3.2.3" xref="A2.SS1.p4.5.m5.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="A2.SS1.p4.5.m5.1.1.3.3.1" xref="A2.SS1.p4.5.m5.1.1.3.3.1.cmml">​</mo><mi id="A2.SS1.p4.5.m5.1.1.3.3.3" xref="A2.SS1.p4.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.5.m5.1b"><apply id="A2.SS1.p4.5.m5.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1"><in id="A2.SS1.p4.5.m5.1.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1.1"></in><apply id="A2.SS1.p4.5.m5.1.1.2.cmml" xref="A2.SS1.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p4.5.m5.1.1.2.1.cmml" xref="A2.SS1.p4.5.m5.1.1.2">superscript</csymbol><ci id="A2.SS1.p4.5.m5.1.1.2.2.cmml" xref="A2.SS1.p4.5.m5.1.1.2.2">𝑊</ci><ci id="A2.SS1.p4.5.m5.1.1.2.3.cmml" xref="A2.SS1.p4.5.m5.1.1.2.3">𝑃</ci></apply><apply id="A2.SS1.p4.5.m5.1.1.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p4.5.m5.1.1.3.1.cmml" xref="A2.SS1.p4.5.m5.1.1.3">superscript</csymbol><ci id="A2.SS1.p4.5.m5.1.1.3.2.cmml" xref="A2.SS1.p4.5.m5.1.1.3.2">ℝ</ci><apply id="A2.SS1.p4.5.m5.1.1.3.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3"><times id="A2.SS1.p4.5.m5.1.1.3.3.1.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.1"></times><apply id="A2.SS1.p4.5.m5.1.1.3.3.2.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2"><times id="A2.SS1.p4.5.m5.1.1.3.3.2.1.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.1"></times><apply id="A2.SS1.p4.5.m5.1.1.3.3.2.2.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2"><times id="A2.SS1.p4.5.m5.1.1.3.3.2.2.1.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.1"></times><cn type="integer" id="A2.SS1.p4.5.m5.1.1.3.3.2.2.2.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.2">2</cn><ci id="A2.SS1.p4.5.m5.1.1.3.3.2.2.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.2.3">𝑑</ci></apply><cn type="integer" id="A2.SS1.p4.5.m5.1.1.3.3.2.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.2.3">2</cn></apply><ci id="A2.SS1.p4.5.m5.1.1.3.3.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.5.m5.1c">W^{P}\in\mathbb{R}^{2d\times 2d}</annotation></semantics></math>, as follows:</p>
<table id="A2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E8.m1.6" class="ltx_Math" alttext="h^{\prime}=\operatorname{concat}{(h_{1,o},h_{2,o})}W^{\text{P}}." display="block"><semantics id="A2.E8.m1.6a"><mrow id="A2.E8.m1.6.6.1" xref="A2.E8.m1.6.6.1.1.cmml"><mrow id="A2.E8.m1.6.6.1.1" xref="A2.E8.m1.6.6.1.1.cmml"><msup id="A2.E8.m1.6.6.1.1.4" xref="A2.E8.m1.6.6.1.1.4.cmml"><mi id="A2.E8.m1.6.6.1.1.4.2" xref="A2.E8.m1.6.6.1.1.4.2.cmml">h</mi><mo id="A2.E8.m1.6.6.1.1.4.3" xref="A2.E8.m1.6.6.1.1.4.3.cmml">′</mo></msup><mo id="A2.E8.m1.6.6.1.1.3" xref="A2.E8.m1.6.6.1.1.3.cmml">=</mo><mrow id="A2.E8.m1.6.6.1.1.2" xref="A2.E8.m1.6.6.1.1.2.cmml"><mrow id="A2.E8.m1.6.6.1.1.2.2.2" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml"><mi id="A2.E8.m1.5.5" xref="A2.E8.m1.5.5.cmml">concat</mi><mo id="A2.E8.m1.6.6.1.1.2.2.2a" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml">⁡</mo><mrow id="A2.E8.m1.6.6.1.1.2.2.2.2" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml"><mo stretchy="false" id="A2.E8.m1.6.6.1.1.2.2.2.2.3" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml">(</mo><msub id="A2.E8.m1.6.6.1.1.1.1.1.1.1" xref="A2.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="A2.E8.m1.6.6.1.1.1.1.1.1.1.2" xref="A2.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="A2.E8.m1.2.2.2.4" xref="A2.E8.m1.2.2.2.3.cmml"><mn id="A2.E8.m1.1.1.1.1" xref="A2.E8.m1.1.1.1.1.cmml">1</mn><mo id="A2.E8.m1.2.2.2.4.1" xref="A2.E8.m1.2.2.2.3.cmml">,</mo><mi id="A2.E8.m1.2.2.2.2" xref="A2.E8.m1.2.2.2.2.cmml">o</mi></mrow></msub><mo id="A2.E8.m1.6.6.1.1.2.2.2.2.4" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml">,</mo><msub id="A2.E8.m1.6.6.1.1.2.2.2.2.2" xref="A2.E8.m1.6.6.1.1.2.2.2.2.2.cmml"><mi id="A2.E8.m1.6.6.1.1.2.2.2.2.2.2" xref="A2.E8.m1.6.6.1.1.2.2.2.2.2.2.cmml">h</mi><mrow id="A2.E8.m1.4.4.2.4" xref="A2.E8.m1.4.4.2.3.cmml"><mn id="A2.E8.m1.3.3.1.1" xref="A2.E8.m1.3.3.1.1.cmml">2</mn><mo id="A2.E8.m1.4.4.2.4.1" xref="A2.E8.m1.4.4.2.3.cmml">,</mo><mi id="A2.E8.m1.4.4.2.2" xref="A2.E8.m1.4.4.2.2.cmml">o</mi></mrow></msub><mo stretchy="false" id="A2.E8.m1.6.6.1.1.2.2.2.2.5" xref="A2.E8.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A2.E8.m1.6.6.1.1.2.3" xref="A2.E8.m1.6.6.1.1.2.3.cmml">​</mo><msup id="A2.E8.m1.6.6.1.1.2.4" xref="A2.E8.m1.6.6.1.1.2.4.cmml"><mi id="A2.E8.m1.6.6.1.1.2.4.2" xref="A2.E8.m1.6.6.1.1.2.4.2.cmml">W</mi><mtext id="A2.E8.m1.6.6.1.1.2.4.3" xref="A2.E8.m1.6.6.1.1.2.4.3a.cmml">P</mtext></msup></mrow></mrow><mo lspace="0em" id="A2.E8.m1.6.6.1.2" xref="A2.E8.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E8.m1.6b"><apply id="A2.E8.m1.6.6.1.1.cmml" xref="A2.E8.m1.6.6.1"><eq id="A2.E8.m1.6.6.1.1.3.cmml" xref="A2.E8.m1.6.6.1.1.3"></eq><apply id="A2.E8.m1.6.6.1.1.4.cmml" xref="A2.E8.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="A2.E8.m1.6.6.1.1.4.1.cmml" xref="A2.E8.m1.6.6.1.1.4">superscript</csymbol><ci id="A2.E8.m1.6.6.1.1.4.2.cmml" xref="A2.E8.m1.6.6.1.1.4.2">ℎ</ci><ci id="A2.E8.m1.6.6.1.1.4.3.cmml" xref="A2.E8.m1.6.6.1.1.4.3">′</ci></apply><apply id="A2.E8.m1.6.6.1.1.2.cmml" xref="A2.E8.m1.6.6.1.1.2"><times id="A2.E8.m1.6.6.1.1.2.3.cmml" xref="A2.E8.m1.6.6.1.1.2.3"></times><apply id="A2.E8.m1.6.6.1.1.2.2.3.cmml" xref="A2.E8.m1.6.6.1.1.2.2.2"><ci id="A2.E8.m1.5.5.cmml" xref="A2.E8.m1.5.5">concat</ci><apply id="A2.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A2.E8.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A2.E8.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A2.E8.m1.6.6.1.1.1.1.1.1.1.2">ℎ</ci><list id="A2.E8.m1.2.2.2.3.cmml" xref="A2.E8.m1.2.2.2.4"><cn type="integer" id="A2.E8.m1.1.1.1.1.cmml" xref="A2.E8.m1.1.1.1.1">1</cn><ci id="A2.E8.m1.2.2.2.2.cmml" xref="A2.E8.m1.2.2.2.2">𝑜</ci></list></apply><apply id="A2.E8.m1.6.6.1.1.2.2.2.2.2.cmml" xref="A2.E8.m1.6.6.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E8.m1.6.6.1.1.2.2.2.2.2.1.cmml" xref="A2.E8.m1.6.6.1.1.2.2.2.2.2">subscript</csymbol><ci id="A2.E8.m1.6.6.1.1.2.2.2.2.2.2.cmml" xref="A2.E8.m1.6.6.1.1.2.2.2.2.2.2">ℎ</ci><list id="A2.E8.m1.4.4.2.3.cmml" xref="A2.E8.m1.4.4.2.4"><cn type="integer" id="A2.E8.m1.3.3.1.1.cmml" xref="A2.E8.m1.3.3.1.1">2</cn><ci id="A2.E8.m1.4.4.2.2.cmml" xref="A2.E8.m1.4.4.2.2">𝑜</ci></list></apply></apply><apply id="A2.E8.m1.6.6.1.1.2.4.cmml" xref="A2.E8.m1.6.6.1.1.2.4"><csymbol cd="ambiguous" id="A2.E8.m1.6.6.1.1.2.4.1.cmml" xref="A2.E8.m1.6.6.1.1.2.4">superscript</csymbol><ci id="A2.E8.m1.6.6.1.1.2.4.2.cmml" xref="A2.E8.m1.6.6.1.1.2.4.2">𝑊</ci><ci id="A2.E8.m1.6.6.1.1.2.4.3a.cmml" xref="A2.E8.m1.6.6.1.1.2.4.3"><mtext mathsize="70%" id="A2.E8.m1.6.6.1.1.2.4.3.cmml" xref="A2.E8.m1.6.6.1.1.2.4.3">P</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E8.m1.6c">h^{\prime}=\operatorname{concat}{(h_{1,o},h_{2,o})}W^{\text{P}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="A2.SS1.p4.6" class="ltx_p">Then, we split <math id="A2.SS1.p4.6.m1.1" class="ltx_Math" alttext="h^{\prime}\in\mathbb{R}^{2d}" display="inline"><semantics id="A2.SS1.p4.6.m1.1a"><mrow id="A2.SS1.p4.6.m1.1.1" xref="A2.SS1.p4.6.m1.1.1.cmml"><msup id="A2.SS1.p4.6.m1.1.1.2" xref="A2.SS1.p4.6.m1.1.1.2.cmml"><mi id="A2.SS1.p4.6.m1.1.1.2.2" xref="A2.SS1.p4.6.m1.1.1.2.2.cmml">h</mi><mo id="A2.SS1.p4.6.m1.1.1.2.3" xref="A2.SS1.p4.6.m1.1.1.2.3.cmml">′</mo></msup><mo id="A2.SS1.p4.6.m1.1.1.1" xref="A2.SS1.p4.6.m1.1.1.1.cmml">∈</mo><msup id="A2.SS1.p4.6.m1.1.1.3" xref="A2.SS1.p4.6.m1.1.1.3.cmml"><mi id="A2.SS1.p4.6.m1.1.1.3.2" xref="A2.SS1.p4.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A2.SS1.p4.6.m1.1.1.3.3" xref="A2.SS1.p4.6.m1.1.1.3.3.cmml"><mn id="A2.SS1.p4.6.m1.1.1.3.3.2" xref="A2.SS1.p4.6.m1.1.1.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.SS1.p4.6.m1.1.1.3.3.1" xref="A2.SS1.p4.6.m1.1.1.3.3.1.cmml">​</mo><mi id="A2.SS1.p4.6.m1.1.1.3.3.3" xref="A2.SS1.p4.6.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.6.m1.1b"><apply id="A2.SS1.p4.6.m1.1.1.cmml" xref="A2.SS1.p4.6.m1.1.1"><in id="A2.SS1.p4.6.m1.1.1.1.cmml" xref="A2.SS1.p4.6.m1.1.1.1"></in><apply id="A2.SS1.p4.6.m1.1.1.2.cmml" xref="A2.SS1.p4.6.m1.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p4.6.m1.1.1.2.1.cmml" xref="A2.SS1.p4.6.m1.1.1.2">superscript</csymbol><ci id="A2.SS1.p4.6.m1.1.1.2.2.cmml" xref="A2.SS1.p4.6.m1.1.1.2.2">ℎ</ci><ci id="A2.SS1.p4.6.m1.1.1.2.3.cmml" xref="A2.SS1.p4.6.m1.1.1.2.3">′</ci></apply><apply id="A2.SS1.p4.6.m1.1.1.3.cmml" xref="A2.SS1.p4.6.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p4.6.m1.1.1.3.1.cmml" xref="A2.SS1.p4.6.m1.1.1.3">superscript</csymbol><ci id="A2.SS1.p4.6.m1.1.1.3.2.cmml" xref="A2.SS1.p4.6.m1.1.1.3.2">ℝ</ci><apply id="A2.SS1.p4.6.m1.1.1.3.3.cmml" xref="A2.SS1.p4.6.m1.1.1.3.3"><times id="A2.SS1.p4.6.m1.1.1.3.3.1.cmml" xref="A2.SS1.p4.6.m1.1.1.3.3.1"></times><cn type="integer" id="A2.SS1.p4.6.m1.1.1.3.3.2.cmml" xref="A2.SS1.p4.6.m1.1.1.3.3.2">2</cn><ci id="A2.SS1.p4.6.m1.1.1.3.3.3.cmml" xref="A2.SS1.p4.6.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.6.m1.1c">h^{\prime}\in\mathbb{R}^{2d}</annotation></semantics></math> into two and regarded each split as an embedding of the output nodes:</p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E9.m1.2" class="ltx_Math" alttext="\displaystyle h_{1,o}" display="inline"><semantics id="A2.E9.m1.2a"><msub id="A2.E9.m1.2.3" xref="A2.E9.m1.2.3.cmml"><mi id="A2.E9.m1.2.3.2" xref="A2.E9.m1.2.3.2.cmml">h</mi><mrow id="A2.E9.m1.2.2.2.4" xref="A2.E9.m1.2.2.2.3.cmml"><mn id="A2.E9.m1.1.1.1.1" xref="A2.E9.m1.1.1.1.1.cmml">1</mn><mo id="A2.E9.m1.2.2.2.4.1" xref="A2.E9.m1.2.2.2.3.cmml">,</mo><mi id="A2.E9.m1.2.2.2.2" xref="A2.E9.m1.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.E9.m1.2b"><apply id="A2.E9.m1.2.3.cmml" xref="A2.E9.m1.2.3"><csymbol cd="ambiguous" id="A2.E9.m1.2.3.1.cmml" xref="A2.E9.m1.2.3">subscript</csymbol><ci id="A2.E9.m1.2.3.2.cmml" xref="A2.E9.m1.2.3.2">ℎ</ci><list id="A2.E9.m1.2.2.2.3.cmml" xref="A2.E9.m1.2.2.2.4"><cn type="integer" id="A2.E9.m1.1.1.1.1.cmml" xref="A2.E9.m1.1.1.1.1">1</cn><ci id="A2.E9.m1.2.2.2.2.cmml" xref="A2.E9.m1.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.m1.2c">\displaystyle h_{1,o}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9.m2.2" class="ltx_Math" alttext="\displaystyle=(h^{\prime}_{1},h^{\prime}_{2},\cdots,h^{\prime}_{d})," display="inline"><semantics id="A2.E9.m2.2a"><mrow id="A2.E9.m2.2.2.1" xref="A2.E9.m2.2.2.1.1.cmml"><mrow id="A2.E9.m2.2.2.1.1" xref="A2.E9.m2.2.2.1.1.cmml"><mi id="A2.E9.m2.2.2.1.1.5" xref="A2.E9.m2.2.2.1.1.5.cmml"></mi><mo id="A2.E9.m2.2.2.1.1.4" xref="A2.E9.m2.2.2.1.1.4.cmml">=</mo><mrow id="A2.E9.m2.2.2.1.1.3.3" xref="A2.E9.m2.2.2.1.1.3.4.cmml"><mo stretchy="false" id="A2.E9.m2.2.2.1.1.3.3.4" xref="A2.E9.m2.2.2.1.1.3.4.cmml">(</mo><msubsup id="A2.E9.m2.2.2.1.1.1.1.1" xref="A2.E9.m2.2.2.1.1.1.1.1.cmml"><mi id="A2.E9.m2.2.2.1.1.1.1.1.2.2" xref="A2.E9.m2.2.2.1.1.1.1.1.2.2.cmml">h</mi><mn id="A2.E9.m2.2.2.1.1.1.1.1.3" xref="A2.E9.m2.2.2.1.1.1.1.1.3.cmml">1</mn><mo id="A2.E9.m2.2.2.1.1.1.1.1.2.3" xref="A2.E9.m2.2.2.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A2.E9.m2.2.2.1.1.3.3.5" xref="A2.E9.m2.2.2.1.1.3.4.cmml">,</mo><msubsup id="A2.E9.m2.2.2.1.1.2.2.2" xref="A2.E9.m2.2.2.1.1.2.2.2.cmml"><mi id="A2.E9.m2.2.2.1.1.2.2.2.2.2" xref="A2.E9.m2.2.2.1.1.2.2.2.2.2.cmml">h</mi><mn id="A2.E9.m2.2.2.1.1.2.2.2.3" xref="A2.E9.m2.2.2.1.1.2.2.2.3.cmml">2</mn><mo id="A2.E9.m2.2.2.1.1.2.2.2.2.3" xref="A2.E9.m2.2.2.1.1.2.2.2.2.3.cmml">′</mo></msubsup><mo id="A2.E9.m2.2.2.1.1.3.3.6" xref="A2.E9.m2.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="A2.E9.m2.1.1" xref="A2.E9.m2.1.1.cmml">⋯</mi><mo id="A2.E9.m2.2.2.1.1.3.3.7" xref="A2.E9.m2.2.2.1.1.3.4.cmml">,</mo><msubsup id="A2.E9.m2.2.2.1.1.3.3.3" xref="A2.E9.m2.2.2.1.1.3.3.3.cmml"><mi id="A2.E9.m2.2.2.1.1.3.3.3.2.2" xref="A2.E9.m2.2.2.1.1.3.3.3.2.2.cmml">h</mi><mi id="A2.E9.m2.2.2.1.1.3.3.3.3" xref="A2.E9.m2.2.2.1.1.3.3.3.3.cmml">d</mi><mo id="A2.E9.m2.2.2.1.1.3.3.3.2.3" xref="A2.E9.m2.2.2.1.1.3.3.3.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="A2.E9.m2.2.2.1.1.3.3.8" xref="A2.E9.m2.2.2.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="A2.E9.m2.2.2.1.2" xref="A2.E9.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E9.m2.2b"><apply id="A2.E9.m2.2.2.1.1.cmml" xref="A2.E9.m2.2.2.1"><eq id="A2.E9.m2.2.2.1.1.4.cmml" xref="A2.E9.m2.2.2.1.1.4"></eq><csymbol cd="latexml" id="A2.E9.m2.2.2.1.1.5.cmml" xref="A2.E9.m2.2.2.1.1.5">absent</csymbol><vector id="A2.E9.m2.2.2.1.1.3.4.cmml" xref="A2.E9.m2.2.2.1.1.3.3"><apply id="A2.E9.m2.2.2.1.1.1.1.1.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.1.1.1.1.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="A2.E9.m2.2.2.1.1.1.1.1.2.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.1.1.1.2.1.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="A2.E9.m2.2.2.1.1.1.1.1.2.2.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1.2.2">ℎ</ci><ci id="A2.E9.m2.2.2.1.1.1.1.1.2.3.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1.2.3">′</ci></apply><cn type="integer" id="A2.E9.m2.2.2.1.1.1.1.1.3.cmml" xref="A2.E9.m2.2.2.1.1.1.1.1.3">1</cn></apply><apply id="A2.E9.m2.2.2.1.1.2.2.2.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.2.2.2.1.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2">subscript</csymbol><apply id="A2.E9.m2.2.2.1.1.2.2.2.2.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.2.2.2.2.1.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2">superscript</csymbol><ci id="A2.E9.m2.2.2.1.1.2.2.2.2.2.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2.2.2">ℎ</ci><ci id="A2.E9.m2.2.2.1.1.2.2.2.2.3.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2.2.3">′</ci></apply><cn type="integer" id="A2.E9.m2.2.2.1.1.2.2.2.3.cmml" xref="A2.E9.m2.2.2.1.1.2.2.2.3">2</cn></apply><ci id="A2.E9.m2.1.1.cmml" xref="A2.E9.m2.1.1">⋯</ci><apply id="A2.E9.m2.2.2.1.1.3.3.3.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.3.3.3.1.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3">subscript</csymbol><apply id="A2.E9.m2.2.2.1.1.3.3.3.2.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.E9.m2.2.2.1.1.3.3.3.2.1.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3">superscript</csymbol><ci id="A2.E9.m2.2.2.1.1.3.3.3.2.2.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3.2.2">ℎ</ci><ci id="A2.E9.m2.2.2.1.1.3.3.3.2.3.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3.2.3">′</ci></apply><ci id="A2.E9.m2.2.2.1.1.3.3.3.3.cmml" xref="A2.E9.m2.2.2.1.1.3.3.3.3">𝑑</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.m2.2c">\displaystyle=(h^{\prime}_{1},h^{\prime}_{2},\cdots,h^{\prime}_{d}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="A2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E10.m1.2" class="ltx_Math" alttext="\displaystyle h_{2,o}" display="inline"><semantics id="A2.E10.m1.2a"><msub id="A2.E10.m1.2.3" xref="A2.E10.m1.2.3.cmml"><mi id="A2.E10.m1.2.3.2" xref="A2.E10.m1.2.3.2.cmml">h</mi><mrow id="A2.E10.m1.2.2.2.4" xref="A2.E10.m1.2.2.2.3.cmml"><mn id="A2.E10.m1.1.1.1.1" xref="A2.E10.m1.1.1.1.1.cmml">2</mn><mo id="A2.E10.m1.2.2.2.4.1" xref="A2.E10.m1.2.2.2.3.cmml">,</mo><mi id="A2.E10.m1.2.2.2.2" xref="A2.E10.m1.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.E10.m1.2b"><apply id="A2.E10.m1.2.3.cmml" xref="A2.E10.m1.2.3"><csymbol cd="ambiguous" id="A2.E10.m1.2.3.1.cmml" xref="A2.E10.m1.2.3">subscript</csymbol><ci id="A2.E10.m1.2.3.2.cmml" xref="A2.E10.m1.2.3.2">ℎ</ci><list id="A2.E10.m1.2.2.2.3.cmml" xref="A2.E10.m1.2.2.2.4"><cn type="integer" id="A2.E10.m1.1.1.1.1.cmml" xref="A2.E10.m1.1.1.1.1">2</cn><ci id="A2.E10.m1.2.2.2.2.cmml" xref="A2.E10.m1.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E10.m1.2c">\displaystyle h_{2,o}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E10.m2.2" class="ltx_Math" alttext="\displaystyle=(h^{\prime}_{d+1},h^{\prime}_{d+2},\cdots,h^{\prime}_{2d})," display="inline"><semantics id="A2.E10.m2.2a"><mrow id="A2.E10.m2.2.2.1" xref="A2.E10.m2.2.2.1.1.cmml"><mrow id="A2.E10.m2.2.2.1.1" xref="A2.E10.m2.2.2.1.1.cmml"><mi id="A2.E10.m2.2.2.1.1.5" xref="A2.E10.m2.2.2.1.1.5.cmml"></mi><mo id="A2.E10.m2.2.2.1.1.4" xref="A2.E10.m2.2.2.1.1.4.cmml">=</mo><mrow id="A2.E10.m2.2.2.1.1.3.3" xref="A2.E10.m2.2.2.1.1.3.4.cmml"><mo stretchy="false" id="A2.E10.m2.2.2.1.1.3.3.4" xref="A2.E10.m2.2.2.1.1.3.4.cmml">(</mo><msubsup id="A2.E10.m2.2.2.1.1.1.1.1" xref="A2.E10.m2.2.2.1.1.1.1.1.cmml"><mi id="A2.E10.m2.2.2.1.1.1.1.1.2.2" xref="A2.E10.m2.2.2.1.1.1.1.1.2.2.cmml">h</mi><mrow id="A2.E10.m2.2.2.1.1.1.1.1.3" xref="A2.E10.m2.2.2.1.1.1.1.1.3.cmml"><mi id="A2.E10.m2.2.2.1.1.1.1.1.3.2" xref="A2.E10.m2.2.2.1.1.1.1.1.3.2.cmml">d</mi><mo id="A2.E10.m2.2.2.1.1.1.1.1.3.1" xref="A2.E10.m2.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="A2.E10.m2.2.2.1.1.1.1.1.3.3" xref="A2.E10.m2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="A2.E10.m2.2.2.1.1.1.1.1.2.3" xref="A2.E10.m2.2.2.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A2.E10.m2.2.2.1.1.3.3.5" xref="A2.E10.m2.2.2.1.1.3.4.cmml">,</mo><msubsup id="A2.E10.m2.2.2.1.1.2.2.2" xref="A2.E10.m2.2.2.1.1.2.2.2.cmml"><mi id="A2.E10.m2.2.2.1.1.2.2.2.2.2" xref="A2.E10.m2.2.2.1.1.2.2.2.2.2.cmml">h</mi><mrow id="A2.E10.m2.2.2.1.1.2.2.2.3" xref="A2.E10.m2.2.2.1.1.2.2.2.3.cmml"><mi id="A2.E10.m2.2.2.1.1.2.2.2.3.2" xref="A2.E10.m2.2.2.1.1.2.2.2.3.2.cmml">d</mi><mo id="A2.E10.m2.2.2.1.1.2.2.2.3.1" xref="A2.E10.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="A2.E10.m2.2.2.1.1.2.2.2.3.3" xref="A2.E10.m2.2.2.1.1.2.2.2.3.3.cmml">2</mn></mrow><mo id="A2.E10.m2.2.2.1.1.2.2.2.2.3" xref="A2.E10.m2.2.2.1.1.2.2.2.2.3.cmml">′</mo></msubsup><mo id="A2.E10.m2.2.2.1.1.3.3.6" xref="A2.E10.m2.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="A2.E10.m2.1.1" xref="A2.E10.m2.1.1.cmml">⋯</mi><mo id="A2.E10.m2.2.2.1.1.3.3.7" xref="A2.E10.m2.2.2.1.1.3.4.cmml">,</mo><msubsup id="A2.E10.m2.2.2.1.1.3.3.3" xref="A2.E10.m2.2.2.1.1.3.3.3.cmml"><mi id="A2.E10.m2.2.2.1.1.3.3.3.2.2" xref="A2.E10.m2.2.2.1.1.3.3.3.2.2.cmml">h</mi><mrow id="A2.E10.m2.2.2.1.1.3.3.3.3" xref="A2.E10.m2.2.2.1.1.3.3.3.3.cmml"><mn id="A2.E10.m2.2.2.1.1.3.3.3.3.2" xref="A2.E10.m2.2.2.1.1.3.3.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.E10.m2.2.2.1.1.3.3.3.3.1" xref="A2.E10.m2.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi id="A2.E10.m2.2.2.1.1.3.3.3.3.3" xref="A2.E10.m2.2.2.1.1.3.3.3.3.3.cmml">d</mi></mrow><mo id="A2.E10.m2.2.2.1.1.3.3.3.2.3" xref="A2.E10.m2.2.2.1.1.3.3.3.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="A2.E10.m2.2.2.1.1.3.3.8" xref="A2.E10.m2.2.2.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="A2.E10.m2.2.2.1.2" xref="A2.E10.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E10.m2.2b"><apply id="A2.E10.m2.2.2.1.1.cmml" xref="A2.E10.m2.2.2.1"><eq id="A2.E10.m2.2.2.1.1.4.cmml" xref="A2.E10.m2.2.2.1.1.4"></eq><csymbol cd="latexml" id="A2.E10.m2.2.2.1.1.5.cmml" xref="A2.E10.m2.2.2.1.1.5">absent</csymbol><vector id="A2.E10.m2.2.2.1.1.3.4.cmml" xref="A2.E10.m2.2.2.1.1.3.3"><apply id="A2.E10.m2.2.2.1.1.1.1.1.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.1.1.1.1.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="A2.E10.m2.2.2.1.1.1.1.1.2.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.1.1.1.2.1.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="A2.E10.m2.2.2.1.1.1.1.1.2.2.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.2.2">ℎ</ci><ci id="A2.E10.m2.2.2.1.1.1.1.1.2.3.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.2.3">′</ci></apply><apply id="A2.E10.m2.2.2.1.1.1.1.1.3.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.3"><plus id="A2.E10.m2.2.2.1.1.1.1.1.3.1.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.3.1"></plus><ci id="A2.E10.m2.2.2.1.1.1.1.1.3.2.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.3.2">𝑑</ci><cn type="integer" id="A2.E10.m2.2.2.1.1.1.1.1.3.3.cmml" xref="A2.E10.m2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A2.E10.m2.2.2.1.1.2.2.2.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.2.2.2.1.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2">subscript</csymbol><apply id="A2.E10.m2.2.2.1.1.2.2.2.2.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.2.2.2.2.1.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2">superscript</csymbol><ci id="A2.E10.m2.2.2.1.1.2.2.2.2.2.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.2.2">ℎ</ci><ci id="A2.E10.m2.2.2.1.1.2.2.2.2.3.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.2.3">′</ci></apply><apply id="A2.E10.m2.2.2.1.1.2.2.2.3.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.3"><plus id="A2.E10.m2.2.2.1.1.2.2.2.3.1.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.3.1"></plus><ci id="A2.E10.m2.2.2.1.1.2.2.2.3.2.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.3.2">𝑑</ci><cn type="integer" id="A2.E10.m2.2.2.1.1.2.2.2.3.3.cmml" xref="A2.E10.m2.2.2.1.1.2.2.2.3.3">2</cn></apply></apply><ci id="A2.E10.m2.1.1.cmml" xref="A2.E10.m2.1.1">⋯</ci><apply id="A2.E10.m2.2.2.1.1.3.3.3.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.3.3.3.1.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3">subscript</csymbol><apply id="A2.E10.m2.2.2.1.1.3.3.3.2.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.E10.m2.2.2.1.1.3.3.3.2.1.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3">superscript</csymbol><ci id="A2.E10.m2.2.2.1.1.3.3.3.2.2.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.2.2">ℎ</ci><ci id="A2.E10.m2.2.2.1.1.3.3.3.2.3.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.2.3">′</ci></apply><apply id="A2.E10.m2.2.2.1.1.3.3.3.3.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.3"><times id="A2.E10.m2.2.2.1.1.3.3.3.3.1.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.3.1"></times><cn type="integer" id="A2.E10.m2.2.2.1.1.3.3.3.3.2.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.3.2">2</cn><ci id="A2.E10.m2.2.2.1.1.3.3.3.3.3.cmml" xref="A2.E10.m2.2.2.1.1.3.3.3.3.3">𝑑</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E10.m2.2c">\displaystyle=(h^{\prime}_{d+1},h^{\prime}_{d+2},\cdots,h^{\prime}_{2d}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="A2.SS1.p4.11" class="ltx_p">where <math id="A2.SS1.p4.7.m1.1" class="ltx_Math" alttext="h^{\prime}_{i}" display="inline"><semantics id="A2.SS1.p4.7.m1.1a"><msubsup id="A2.SS1.p4.7.m1.1.1" xref="A2.SS1.p4.7.m1.1.1.cmml"><mi id="A2.SS1.p4.7.m1.1.1.2.2" xref="A2.SS1.p4.7.m1.1.1.2.2.cmml">h</mi><mi id="A2.SS1.p4.7.m1.1.1.3" xref="A2.SS1.p4.7.m1.1.1.3.cmml">i</mi><mo id="A2.SS1.p4.7.m1.1.1.2.3" xref="A2.SS1.p4.7.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.7.m1.1b"><apply id="A2.SS1.p4.7.m1.1.1.cmml" xref="A2.SS1.p4.7.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.7.m1.1.1.1.cmml" xref="A2.SS1.p4.7.m1.1.1">subscript</csymbol><apply id="A2.SS1.p4.7.m1.1.1.2.cmml" xref="A2.SS1.p4.7.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.7.m1.1.1.2.1.cmml" xref="A2.SS1.p4.7.m1.1.1">superscript</csymbol><ci id="A2.SS1.p4.7.m1.1.1.2.2.cmml" xref="A2.SS1.p4.7.m1.1.1.2.2">ℎ</ci><ci id="A2.SS1.p4.7.m1.1.1.2.3.cmml" xref="A2.SS1.p4.7.m1.1.1.2.3">′</ci></apply><ci id="A2.SS1.p4.7.m1.1.1.3.cmml" xref="A2.SS1.p4.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.7.m1.1c">h^{\prime}_{i}</annotation></semantics></math> is the <math id="A2.SS1.p4.8.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.SS1.p4.8.m2.1a"><mi id="A2.SS1.p4.8.m2.1.1" xref="A2.SS1.p4.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.8.m2.1b"><ci id="A2.SS1.p4.8.m2.1.1.cmml" xref="A2.SS1.p4.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.8.m2.1c">i</annotation></semantics></math>-th entry of <math id="A2.SS1.p4.9.m3.1" class="ltx_Math" alttext="h^{\prime}" display="inline"><semantics id="A2.SS1.p4.9.m3.1a"><msup id="A2.SS1.p4.9.m3.1.1" xref="A2.SS1.p4.9.m3.1.1.cmml"><mi id="A2.SS1.p4.9.m3.1.1.2" xref="A2.SS1.p4.9.m3.1.1.2.cmml">h</mi><mo id="A2.SS1.p4.9.m3.1.1.3" xref="A2.SS1.p4.9.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.9.m3.1b"><apply id="A2.SS1.p4.9.m3.1.1.cmml" xref="A2.SS1.p4.9.m3.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.9.m3.1.1.1.cmml" xref="A2.SS1.p4.9.m3.1.1">superscript</csymbol><ci id="A2.SS1.p4.9.m3.1.1.2.cmml" xref="A2.SS1.p4.9.m3.1.1.2">ℎ</ci><ci id="A2.SS1.p4.9.m3.1.1.3.cmml" xref="A2.SS1.p4.9.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.9.m3.1c">h^{\prime}</annotation></semantics></math>. Finally, we started asynchronous backward message passing (step 3 in Algorithm 1 of the main paper) with updated <math id="A2.SS1.p4.10.m4.2" class="ltx_Math" alttext="h_{1,o}" display="inline"><semantics id="A2.SS1.p4.10.m4.2a"><msub id="A2.SS1.p4.10.m4.2.3" xref="A2.SS1.p4.10.m4.2.3.cmml"><mi id="A2.SS1.p4.10.m4.2.3.2" xref="A2.SS1.p4.10.m4.2.3.2.cmml">h</mi><mrow id="A2.SS1.p4.10.m4.2.2.2.4" xref="A2.SS1.p4.10.m4.2.2.2.3.cmml"><mn id="A2.SS1.p4.10.m4.1.1.1.1" xref="A2.SS1.p4.10.m4.1.1.1.1.cmml">1</mn><mo id="A2.SS1.p4.10.m4.2.2.2.4.1" xref="A2.SS1.p4.10.m4.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.10.m4.2.2.2.2" xref="A2.SS1.p4.10.m4.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.10.m4.2b"><apply id="A2.SS1.p4.10.m4.2.3.cmml" xref="A2.SS1.p4.10.m4.2.3"><csymbol cd="ambiguous" id="A2.SS1.p4.10.m4.2.3.1.cmml" xref="A2.SS1.p4.10.m4.2.3">subscript</csymbol><ci id="A2.SS1.p4.10.m4.2.3.2.cmml" xref="A2.SS1.p4.10.m4.2.3.2">ℎ</ci><list id="A2.SS1.p4.10.m4.2.2.2.3.cmml" xref="A2.SS1.p4.10.m4.2.2.2.4"><cn type="integer" id="A2.SS1.p4.10.m4.1.1.1.1.cmml" xref="A2.SS1.p4.10.m4.1.1.1.1">1</cn><ci id="A2.SS1.p4.10.m4.2.2.2.2.cmml" xref="A2.SS1.p4.10.m4.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.10.m4.2c">h_{1,o}</annotation></semantics></math> and <math id="A2.SS1.p4.11.m5.2" class="ltx_Math" alttext="h_{2,o}" display="inline"><semantics id="A2.SS1.p4.11.m5.2a"><msub id="A2.SS1.p4.11.m5.2.3" xref="A2.SS1.p4.11.m5.2.3.cmml"><mi id="A2.SS1.p4.11.m5.2.3.2" xref="A2.SS1.p4.11.m5.2.3.2.cmml">h</mi><mrow id="A2.SS1.p4.11.m5.2.2.2.4" xref="A2.SS1.p4.11.m5.2.2.2.3.cmml"><mn id="A2.SS1.p4.11.m5.1.1.1.1" xref="A2.SS1.p4.11.m5.1.1.1.1.cmml">2</mn><mo id="A2.SS1.p4.11.m5.2.2.2.4.1" xref="A2.SS1.p4.11.m5.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p4.11.m5.2.2.2.2" xref="A2.SS1.p4.11.m5.2.2.2.2.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.11.m5.2b"><apply id="A2.SS1.p4.11.m5.2.3.cmml" xref="A2.SS1.p4.11.m5.2.3"><csymbol cd="ambiguous" id="A2.SS1.p4.11.m5.2.3.1.cmml" xref="A2.SS1.p4.11.m5.2.3">subscript</csymbol><ci id="A2.SS1.p4.11.m5.2.3.2.cmml" xref="A2.SS1.p4.11.m5.2.3.2">ℎ</ci><list id="A2.SS1.p4.11.m5.2.2.2.3.cmml" xref="A2.SS1.p4.11.m5.2.2.2.4"><cn type="integer" id="A2.SS1.p4.11.m5.1.1.1.1.cmml" xref="A2.SS1.p4.11.m5.1.1.1.1">2</cn><ci id="A2.SS1.p4.11.m5.2.2.2.2.cmml" xref="A2.SS1.p4.11.m5.2.2.2.2">𝑜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.11.m5.2c">h_{2,o}</annotation></semantics></math>.</p>
</div>
<div id="A2.SS1.p5" class="ltx_para ltx_noindent">
<p id="A2.SS1.p5.1" class="ltx_p"><span id="A2.SS1.p5.1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Training and hyperparameters:</span>
We used the AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib22" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite> to train the models, and the best parameters were selected using early stopping. The hyperparameter search space was as follows:</p>
<ul id="A2.I1" class="ltx_itemize">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.1" class="ltx_p"><math id="A2.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="\text{lr}\in[10^{-4},10^{-2}]" display="inline"><semantics id="A2.I1.i1.p1.1.m1.2a"><mrow id="A2.I1.i1.p1.1.m1.2.2" xref="A2.I1.i1.p1.1.m1.2.2.cmml"><mtext id="A2.I1.i1.p1.1.m1.2.2.4" xref="A2.I1.i1.p1.1.m1.2.2.4a.cmml">lr</mtext><mo id="A2.I1.i1.p1.1.m1.2.2.3" xref="A2.I1.i1.p1.1.m1.2.2.3.cmml">∈</mo><mrow id="A2.I1.i1.p1.1.m1.2.2.2.2" xref="A2.I1.i1.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="A2.I1.i1.p1.1.m1.2.2.2.2.3" xref="A2.I1.i1.p1.1.m1.2.2.2.3.cmml">[</mo><msup id="A2.I1.i1.p1.1.m1.1.1.1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mn id="A2.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">10</mn><mrow id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml"><mo id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3a" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">−</mo><mn id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.2" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml">4</mn></mrow></msup><mo id="A2.I1.i1.p1.1.m1.2.2.2.2.4" xref="A2.I1.i1.p1.1.m1.2.2.2.3.cmml">,</mo><msup id="A2.I1.i1.p1.1.m1.2.2.2.2.2" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.cmml"><mn id="A2.I1.i1.p1.1.m1.2.2.2.2.2.2" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml">10</mn><mrow id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml"><mo id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3a" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml">−</mo><mn id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.2" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.2.cmml">2</mn></mrow></msup><mo stretchy="false" id="A2.I1.i1.p1.1.m1.2.2.2.2.5" xref="A2.I1.i1.p1.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.2b"><apply id="A2.I1.i1.p1.1.m1.2.2.cmml" xref="A2.I1.i1.p1.1.m1.2.2"><in id="A2.I1.i1.p1.1.m1.2.2.3.cmml" xref="A2.I1.i1.p1.1.m1.2.2.3"></in><ci id="A2.I1.i1.p1.1.m1.2.2.4a.cmml" xref="A2.I1.i1.p1.1.m1.2.2.4"><mtext id="A2.I1.i1.p1.1.m1.2.2.4.cmml" xref="A2.I1.i1.p1.1.m1.2.2.4">lr</mtext></ci><interval closure="closed" id="A2.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2"><apply id="A2.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.2">10</cn><apply id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3"><minus id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3"></minus><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1.1.1.3.2">4</cn></apply></apply><apply id="A2.I1.i1.p1.1.m1.2.2.2.2.2.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2">superscript</csymbol><cn type="integer" id="A2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.2">10</cn><apply id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3"><minus id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3"></minus><cn type="integer" id="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="A2.I1.i1.p1.1.m1.2.2.2.2.2.3.2">2</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.2c">\text{lr}\in[10^{-4},10^{-2}]</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.1" class="ltx_p"><math id="A2.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="\text{weight decay}\in[10^{-10},10^{-3}]" display="inline"><semantics id="A2.I1.i2.p1.1.m1.2a"><mrow id="A2.I1.i2.p1.1.m1.2.2" xref="A2.I1.i2.p1.1.m1.2.2.cmml"><mtext id="A2.I1.i2.p1.1.m1.2.2.4" xref="A2.I1.i2.p1.1.m1.2.2.4a.cmml">weight decay</mtext><mo id="A2.I1.i2.p1.1.m1.2.2.3" xref="A2.I1.i2.p1.1.m1.2.2.3.cmml">∈</mo><mrow id="A2.I1.i2.p1.1.m1.2.2.2.2" xref="A2.I1.i2.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="A2.I1.i2.p1.1.m1.2.2.2.2.3" xref="A2.I1.i2.p1.1.m1.2.2.2.3.cmml">[</mo><msup id="A2.I1.i2.p1.1.m1.1.1.1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mn id="A2.I1.i2.p1.1.m1.1.1.1.1.1.2" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml">10</mn><mrow id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml"><mo id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3a" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml">−</mo><mn id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.2" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.2.cmml">10</mn></mrow></msup><mo id="A2.I1.i2.p1.1.m1.2.2.2.2.4" xref="A2.I1.i2.p1.1.m1.2.2.2.3.cmml">,</mo><msup id="A2.I1.i2.p1.1.m1.2.2.2.2.2" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.cmml"><mn id="A2.I1.i2.p1.1.m1.2.2.2.2.2.2" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml">10</mn><mrow id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.cmml"><mo id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3a" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.cmml">−</mo><mn id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.2" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.2.cmml">3</mn></mrow></msup><mo stretchy="false" id="A2.I1.i2.p1.1.m1.2.2.2.2.5" xref="A2.I1.i2.p1.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.2b"><apply id="A2.I1.i2.p1.1.m1.2.2.cmml" xref="A2.I1.i2.p1.1.m1.2.2"><in id="A2.I1.i2.p1.1.m1.2.2.3.cmml" xref="A2.I1.i2.p1.1.m1.2.2.3"></in><ci id="A2.I1.i2.p1.1.m1.2.2.4a.cmml" xref="A2.I1.i2.p1.1.m1.2.2.4"><mtext id="A2.I1.i2.p1.1.m1.2.2.4.cmml" xref="A2.I1.i2.p1.1.m1.2.2.4">weight decay</mtext></ci><interval closure="closed" id="A2.I1.i2.p1.1.m1.2.2.2.3.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2"><apply id="A2.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="A2.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.2">10</cn><apply id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3"><minus id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3"></minus><cn type="integer" id="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1.1.1.3.2">10</cn></apply></apply><apply id="A2.I1.i2.p1.1.m1.2.2.2.2.2.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.1.m1.2.2.2.2.2.1.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2">superscript</csymbol><cn type="integer" id="A2.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.2">10</cn><apply id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3"><minus id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3"></minus><cn type="integer" id="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="A2.I1.i2.p1.1.m1.2.2.2.2.2.3.2">3</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.2c">\text{weight decay}\in[10^{-10},10^{-3}]</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.1" class="ltx_p"><math id="A2.I1.i3.p1.1.m1.5" class="ltx_Math" alttext="\text{margin}\in\{0.01,0.05,0.1,0.5,1.0\}" display="inline"><semantics id="A2.I1.i3.p1.1.m1.5a"><mrow id="A2.I1.i3.p1.1.m1.5.6" xref="A2.I1.i3.p1.1.m1.5.6.cmml"><mtext id="A2.I1.i3.p1.1.m1.5.6.2" xref="A2.I1.i3.p1.1.m1.5.6.2a.cmml">margin</mtext><mo id="A2.I1.i3.p1.1.m1.5.6.1" xref="A2.I1.i3.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="A2.I1.i3.p1.1.m1.5.6.3.2" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="A2.I1.i3.p1.1.m1.5.6.3.2.1" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="A2.I1.i3.p1.1.m1.1.1" xref="A2.I1.i3.p1.1.m1.1.1.cmml">0.01</mn><mo id="A2.I1.i3.p1.1.m1.5.6.3.2.2" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i3.p1.1.m1.2.2" xref="A2.I1.i3.p1.1.m1.2.2.cmml">0.05</mn><mo id="A2.I1.i3.p1.1.m1.5.6.3.2.3" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i3.p1.1.m1.3.3" xref="A2.I1.i3.p1.1.m1.3.3.cmml">0.1</mn><mo id="A2.I1.i3.p1.1.m1.5.6.3.2.4" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i3.p1.1.m1.4.4" xref="A2.I1.i3.p1.1.m1.4.4.cmml">0.5</mn><mo id="A2.I1.i3.p1.1.m1.5.6.3.2.5" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i3.p1.1.m1.5.5" xref="A2.I1.i3.p1.1.m1.5.5.cmml">1.0</mn><mo stretchy="false" id="A2.I1.i3.p1.1.m1.5.6.3.2.6" xref="A2.I1.i3.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i3.p1.1.m1.5b"><apply id="A2.I1.i3.p1.1.m1.5.6.cmml" xref="A2.I1.i3.p1.1.m1.5.6"><in id="A2.I1.i3.p1.1.m1.5.6.1.cmml" xref="A2.I1.i3.p1.1.m1.5.6.1"></in><ci id="A2.I1.i3.p1.1.m1.5.6.2a.cmml" xref="A2.I1.i3.p1.1.m1.5.6.2"><mtext id="A2.I1.i3.p1.1.m1.5.6.2.cmml" xref="A2.I1.i3.p1.1.m1.5.6.2">margin</mtext></ci><set id="A2.I1.i3.p1.1.m1.5.6.3.1.cmml" xref="A2.I1.i3.p1.1.m1.5.6.3.2"><cn type="float" id="A2.I1.i3.p1.1.m1.1.1.cmml" xref="A2.I1.i3.p1.1.m1.1.1">0.01</cn><cn type="float" id="A2.I1.i3.p1.1.m1.2.2.cmml" xref="A2.I1.i3.p1.1.m1.2.2">0.05</cn><cn type="float" id="A2.I1.i3.p1.1.m1.3.3.cmml" xref="A2.I1.i3.p1.1.m1.3.3">0.1</cn><cn type="float" id="A2.I1.i3.p1.1.m1.4.4.cmml" xref="A2.I1.i3.p1.1.m1.4.4">0.5</cn><cn type="float" id="A2.I1.i3.p1.1.m1.5.5.cmml" xref="A2.I1.i3.p1.1.m1.5.5">1.0</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i3.p1.1.m1.5c">\text{margin}\in\{0.01,0.05,0.1,0.5,1.0\}</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i4.p1" class="ltx_para">
<p id="A2.I1.i4.p1.1" class="ltx_p"><math id="A2.I1.i4.p1.1.m1.7" class="ltx_Math" alttext="L\in\{4,5,6,7,8,9,10\}" display="inline"><semantics id="A2.I1.i4.p1.1.m1.7a"><mrow id="A2.I1.i4.p1.1.m1.7.8" xref="A2.I1.i4.p1.1.m1.7.8.cmml"><mi id="A2.I1.i4.p1.1.m1.7.8.2" xref="A2.I1.i4.p1.1.m1.7.8.2.cmml">L</mi><mo id="A2.I1.i4.p1.1.m1.7.8.1" xref="A2.I1.i4.p1.1.m1.7.8.1.cmml">∈</mo><mrow id="A2.I1.i4.p1.1.m1.7.8.3.2" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml"><mo stretchy="false" id="A2.I1.i4.p1.1.m1.7.8.3.2.1" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">{</mo><mn id="A2.I1.i4.p1.1.m1.1.1" xref="A2.I1.i4.p1.1.m1.1.1.cmml">4</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.2" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.2.2" xref="A2.I1.i4.p1.1.m1.2.2.cmml">5</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.3" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.3.3" xref="A2.I1.i4.p1.1.m1.3.3.cmml">6</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.4" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.4.4" xref="A2.I1.i4.p1.1.m1.4.4.cmml">7</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.5" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.5.5" xref="A2.I1.i4.p1.1.m1.5.5.cmml">8</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.6" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.6.6" xref="A2.I1.i4.p1.1.m1.6.6.cmml">9</mn><mo id="A2.I1.i4.p1.1.m1.7.8.3.2.7" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">,</mo><mn id="A2.I1.i4.p1.1.m1.7.7" xref="A2.I1.i4.p1.1.m1.7.7.cmml">10</mn><mo stretchy="false" id="A2.I1.i4.p1.1.m1.7.8.3.2.8" xref="A2.I1.i4.p1.1.m1.7.8.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.1.m1.7b"><apply id="A2.I1.i4.p1.1.m1.7.8.cmml" xref="A2.I1.i4.p1.1.m1.7.8"><in id="A2.I1.i4.p1.1.m1.7.8.1.cmml" xref="A2.I1.i4.p1.1.m1.7.8.1"></in><ci id="A2.I1.i4.p1.1.m1.7.8.2.cmml" xref="A2.I1.i4.p1.1.m1.7.8.2">𝐿</ci><set id="A2.I1.i4.p1.1.m1.7.8.3.1.cmml" xref="A2.I1.i4.p1.1.m1.7.8.3.2"><cn type="integer" id="A2.I1.i4.p1.1.m1.1.1.cmml" xref="A2.I1.i4.p1.1.m1.1.1">4</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.2.2.cmml" xref="A2.I1.i4.p1.1.m1.2.2">5</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.3.3.cmml" xref="A2.I1.i4.p1.1.m1.3.3">6</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.4.4.cmml" xref="A2.I1.i4.p1.1.m1.4.4">7</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.5.5.cmml" xref="A2.I1.i4.p1.1.m1.5.5">8</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.6.6.cmml" xref="A2.I1.i4.p1.1.m1.6.6">9</cn><cn type="integer" id="A2.I1.i4.p1.1.m1.7.7.cmml" xref="A2.I1.i4.p1.1.m1.7.7">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.p1.1.m1.7c">L\in\{4,5,6,7,8,9,10\}</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i5.p1" class="ltx_para">
<p id="A2.I1.i5.p1.1" class="ltx_p"><math id="A2.I1.i5.p1.1.m1.4" class="ltx_Math" alttext="d\in\{64,128,256,512\}" display="inline"><semantics id="A2.I1.i5.p1.1.m1.4a"><mrow id="A2.I1.i5.p1.1.m1.4.5" xref="A2.I1.i5.p1.1.m1.4.5.cmml"><mi id="A2.I1.i5.p1.1.m1.4.5.2" xref="A2.I1.i5.p1.1.m1.4.5.2.cmml">d</mi><mo id="A2.I1.i5.p1.1.m1.4.5.1" xref="A2.I1.i5.p1.1.m1.4.5.1.cmml">∈</mo><mrow id="A2.I1.i5.p1.1.m1.4.5.3.2" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="A2.I1.i5.p1.1.m1.4.5.3.2.1" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml">{</mo><mn id="A2.I1.i5.p1.1.m1.1.1" xref="A2.I1.i5.p1.1.m1.1.1.cmml">64</mn><mo id="A2.I1.i5.p1.1.m1.4.5.3.2.2" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="A2.I1.i5.p1.1.m1.2.2" xref="A2.I1.i5.p1.1.m1.2.2.cmml">128</mn><mo id="A2.I1.i5.p1.1.m1.4.5.3.2.3" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="A2.I1.i5.p1.1.m1.3.3" xref="A2.I1.i5.p1.1.m1.3.3.cmml">256</mn><mo id="A2.I1.i5.p1.1.m1.4.5.3.2.4" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="A2.I1.i5.p1.1.m1.4.4" xref="A2.I1.i5.p1.1.m1.4.4.cmml">512</mn><mo stretchy="false" id="A2.I1.i5.p1.1.m1.4.5.3.2.5" xref="A2.I1.i5.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.1.m1.4b"><apply id="A2.I1.i5.p1.1.m1.4.5.cmml" xref="A2.I1.i5.p1.1.m1.4.5"><in id="A2.I1.i5.p1.1.m1.4.5.1.cmml" xref="A2.I1.i5.p1.1.m1.4.5.1"></in><ci id="A2.I1.i5.p1.1.m1.4.5.2.cmml" xref="A2.I1.i5.p1.1.m1.4.5.2">𝑑</ci><set id="A2.I1.i5.p1.1.m1.4.5.3.1.cmml" xref="A2.I1.i5.p1.1.m1.4.5.3.2"><cn type="integer" id="A2.I1.i5.p1.1.m1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.1.1">64</cn><cn type="integer" id="A2.I1.i5.p1.1.m1.2.2.cmml" xref="A2.I1.i5.p1.1.m1.2.2">128</cn><cn type="integer" id="A2.I1.i5.p1.1.m1.3.3.cmml" xref="A2.I1.i5.p1.1.m1.3.3">256</cn><cn type="integer" id="A2.I1.i5.p1.1.m1.4.4.cmml" xref="A2.I1.i5.p1.1.m1.4.4">512</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.1.m1.4c">d\in\{64,128,256,512\}</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i6.p1" class="ltx_para">
<p id="A2.I1.i6.p1.1" class="ltx_p"><math id="A2.I1.i6.p1.1.m1.2" class="ltx_Math" alttext="s\in\{4,8\}" display="inline"><semantics id="A2.I1.i6.p1.1.m1.2a"><mrow id="A2.I1.i6.p1.1.m1.2.3" xref="A2.I1.i6.p1.1.m1.2.3.cmml"><mi id="A2.I1.i6.p1.1.m1.2.3.2" xref="A2.I1.i6.p1.1.m1.2.3.2.cmml">s</mi><mo id="A2.I1.i6.p1.1.m1.2.3.1" xref="A2.I1.i6.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="A2.I1.i6.p1.1.m1.2.3.3.2" xref="A2.I1.i6.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A2.I1.i6.p1.1.m1.2.3.3.2.1" xref="A2.I1.i6.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="A2.I1.i6.p1.1.m1.1.1" xref="A2.I1.i6.p1.1.m1.1.1.cmml">4</mn><mo id="A2.I1.i6.p1.1.m1.2.3.3.2.2" xref="A2.I1.i6.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A2.I1.i6.p1.1.m1.2.2" xref="A2.I1.i6.p1.1.m1.2.2.cmml">8</mn><mo stretchy="false" id="A2.I1.i6.p1.1.m1.2.3.3.2.3" xref="A2.I1.i6.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.1.m1.2b"><apply id="A2.I1.i6.p1.1.m1.2.3.cmml" xref="A2.I1.i6.p1.1.m1.2.3"><in id="A2.I1.i6.p1.1.m1.2.3.1.cmml" xref="A2.I1.i6.p1.1.m1.2.3.1"></in><ci id="A2.I1.i6.p1.1.m1.2.3.2.cmml" xref="A2.I1.i6.p1.1.m1.2.3.2">𝑠</ci><set id="A2.I1.i6.p1.1.m1.2.3.3.1.cmml" xref="A2.I1.i6.p1.1.m1.2.3.3.2"><cn type="integer" id="A2.I1.i6.p1.1.m1.1.1.cmml" xref="A2.I1.i6.p1.1.m1.1.1">4</cn><cn type="integer" id="A2.I1.i6.p1.1.m1.2.2.cmml" xref="A2.I1.i6.p1.1.m1.2.2">8</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i6.p1.1.m1.2c">s\in\{4,8\}</annotation></semantics></math></p>
</div>
</li>
<li id="A2.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i7.p1" class="ltx_para">
<p id="A2.I1.i7.p1.1" class="ltx_p"><math id="A2.I1.i7.p1.1.m1.5" class="ltx_Math" alttext="\text{dropout}\in\{0.1,0.2,0.3,0.4,0.5\}" display="inline"><semantics id="A2.I1.i7.p1.1.m1.5a"><mrow id="A2.I1.i7.p1.1.m1.5.6" xref="A2.I1.i7.p1.1.m1.5.6.cmml"><mtext id="A2.I1.i7.p1.1.m1.5.6.2" xref="A2.I1.i7.p1.1.m1.5.6.2a.cmml">dropout</mtext><mo id="A2.I1.i7.p1.1.m1.5.6.1" xref="A2.I1.i7.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="A2.I1.i7.p1.1.m1.5.6.3.2" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="A2.I1.i7.p1.1.m1.5.6.3.2.1" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="A2.I1.i7.p1.1.m1.1.1" xref="A2.I1.i7.p1.1.m1.1.1.cmml">0.1</mn><mo id="A2.I1.i7.p1.1.m1.5.6.3.2.2" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i7.p1.1.m1.2.2" xref="A2.I1.i7.p1.1.m1.2.2.cmml">0.2</mn><mo id="A2.I1.i7.p1.1.m1.5.6.3.2.3" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i7.p1.1.m1.3.3" xref="A2.I1.i7.p1.1.m1.3.3.cmml">0.3</mn><mo id="A2.I1.i7.p1.1.m1.5.6.3.2.4" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i7.p1.1.m1.4.4" xref="A2.I1.i7.p1.1.m1.4.4.cmml">0.4</mn><mo id="A2.I1.i7.p1.1.m1.5.6.3.2.5" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A2.I1.i7.p1.1.m1.5.5" xref="A2.I1.i7.p1.1.m1.5.5.cmml">0.5</mn><mo stretchy="false" id="A2.I1.i7.p1.1.m1.5.6.3.2.6" xref="A2.I1.i7.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.1.m1.5b"><apply id="A2.I1.i7.p1.1.m1.5.6.cmml" xref="A2.I1.i7.p1.1.m1.5.6"><in id="A2.I1.i7.p1.1.m1.5.6.1.cmml" xref="A2.I1.i7.p1.1.m1.5.6.1"></in><ci id="A2.I1.i7.p1.1.m1.5.6.2a.cmml" xref="A2.I1.i7.p1.1.m1.5.6.2"><mtext id="A2.I1.i7.p1.1.m1.5.6.2.cmml" xref="A2.I1.i7.p1.1.m1.5.6.2">dropout</mtext></ci><set id="A2.I1.i7.p1.1.m1.5.6.3.1.cmml" xref="A2.I1.i7.p1.1.m1.5.6.3.2"><cn type="float" id="A2.I1.i7.p1.1.m1.1.1.cmml" xref="A2.I1.i7.p1.1.m1.1.1">0.1</cn><cn type="float" id="A2.I1.i7.p1.1.m1.2.2.cmml" xref="A2.I1.i7.p1.1.m1.2.2">0.2</cn><cn type="float" id="A2.I1.i7.p1.1.m1.3.3.cmml" xref="A2.I1.i7.p1.1.m1.3.3">0.3</cn><cn type="float" id="A2.I1.i7.p1.1.m1.4.4.cmml" xref="A2.I1.i7.p1.1.m1.4.4">0.4</cn><cn type="float" id="A2.I1.i7.p1.1.m1.5.5.cmml" xref="A2.I1.i7.p1.1.m1.5.5">0.5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.1.m1.5c">\text{dropout}\in\{0.1,0.2,0.3,0.4,0.5\}</annotation></semantics></math></p>
</div>
</li>
</ul>
<p id="A2.SS1.p5.2" class="ltx_p">Further details regarding hyperparameters, including the best hyperparameter combination in each dataset, are available at <a target="_blank" href="http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://github.com/y0ngjaenius/CVPR2024_FLOWERFormer</a>.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Batch operation</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Asynchronous message passing inevitably introduces some delay, since each operation should be performed in a sequential manner.
In order to accelerate the computation, we employed group-based batch processing. Specifically, we used the topological batching strategy <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib9" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">9</span></a>, <a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>, which is specialized in handling asynchronous operations.
First, we grouped nodes that belong to the same topological generation and regarded each group as a single batch.
Then, instead of updating a representation of a single node at a time, we updated representations of nodes that belong to the same batch simultaneously.
Note that this simultaneous update process ensures the same result as updating each node in a batch one by one since the updating processes of nodes in the same topological generation are independent of each other.
In this manner, for a one-way message passing, we performed <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="|\mathcal{T}^{G}|" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mrow id="A2.SS2.p1.1.m1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="A2.SS2.p1.1.m1.1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.1.cmml">|</mo><msup id="A2.SS2.p1.1.m1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS2.p1.1.m1.1.1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.1.1.2.cmml">𝒯</mi><mi id="A2.SS2.p1.1.m1.1.1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.1.1.3.cmml">G</mi></msup><mo stretchy="false" id="A2.SS2.p1.1.m1.1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1"><abs id="A2.SS2.p1.1.m1.1.1.2.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.2"></abs><apply id="A2.SS2.p1.1.m1.1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="A2.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.2">𝒯</ci><ci id="A2.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">|\mathcal{T}^{G}|</annotation></semantics></math> operations, which is generally smaller than the number of nodes.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Baseline methods</h3>

<div id="A2.SS3.p1" class="ltx_para">
<ul id="A2.I2" class="ltx_itemize">
<li id="A2.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i1.p1" class="ltx_para">
<p id="A2.I2.i1.p1.1" class="ltx_p"><span id="A2.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">GatedGCN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> and GraphGPS <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>:</span>
We used the GatedGCN implementation provided by the GraphGPS repository. For GraphGPS, we used GatedGCN and Performer as the MPNN and attention modules, respectively. We followed the choice used for OGBG-CODE2, which is the only dataset modeled as a DAG in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>. The GitHub repository is <a target="_blank" href="https://github.com/rampasek/GraphGPS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/rampasek/GraphGPS</a></p>
</div>
</li>
<li id="A2.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i2.p1" class="ltx_para">
<p id="A2.I2.i2.p1.1" class="ltx_p"><span id="A2.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">DAGNN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>:</span>
This model has a bidirectional option, and we considered whether to use it or not as a hyperparameter. The GitHub repository is <a target="_blank" href="https://github.com/vthost/DAGNN" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/vthost/DAGNN</a></p>
</div>
</li>
<li id="A2.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i3.p1" class="ltx_para">
<p id="A2.I2.i3.p1.1" class="ltx_p"><span id="A2.I2.i3.p1.1.1" class="ltx_text ltx_font_bold">DAGFormer <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>:</span>
DAGFormer introduces a framework that is applicable to existing graph transformers, We used the DAG+GraphGPS setting, which uses depth positional encoding and replaces the attention module of GraphGPS with reachability attention. The GitHub repository is <a target="_blank" href="https://github.com/LUOyk1999/DAGformer" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/LUOyk1999/DAGformer</a></p>
</div>
</li>
<li id="A2.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i4.p1" class="ltx_para">
<p id="A2.I2.i4.p1.1" class="ltx_p"><span id="A2.I2.i4.p1.1.1" class="ltx_text ltx_font_bold">NAR-Former <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>:</span>
We followed the augmentation technique and hyperparameter setting of NAR-Former used in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite> for each dataset. The GitHub repository is <a target="_blank" href="https://github.com/yuny220/NAR-Former" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/yuny220/NAR-Former</a></p>
</div>
</li>
<li id="A2.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i5.p1" class="ltx_para">
<p id="A2.I2.i5.p1.1" class="ltx_p"><span id="A2.I2.i5.p1.1.1" class="ltx_text ltx_font_bold">TA-GATES <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>:</span>
We followed the hyperparameter setting of TA-GATES used in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> for each dataset. While the NAS-Bench-ASR dataset is OOE-based with multi-edges, the original TA-GATES implementation does not support multi-edges. Therefore, we converted the dataset into the OON format. The GitHub repository is <a target="_blank" href="https://github.com/walkerning/aw_nas" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/walkerning/aw_nas</a></p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Experiments and Results</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Neural architectures search experiments</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">To validate the practical utility of <span id="A3.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>, we conduct a series of Neural Architecture Search (NAS) experiments. We employ NPENAS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite> as the backbone search algorithm, using TA-GATES, DAGNN, NAR-Former, and <span id="A3.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> as performance predictors.
We follow the experimental setup suggested in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib12" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite>,with the modification of conducting 100 trials.
The results in Figure <a href="#A3.F7" title="Figure 7 ‣ C.1 Neural architectures search experiments ‣ Appendix C Additional Experiments and Results ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> substantiate <span id="A3.SS1.p1.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span>’s superior performance compared to baseline methods.</p>
</div>
<figure id="A3.F7" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F7.3.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A3.F7.4.2" class="ltx_text" style="font-size:90%;">The average test error of the best neural architectures obtained by the NPENAS algorithm using different performance predictors on the NAS-Bench-101 dataset over 100 trials. The plot shows that <span id="A3.F7.4.2.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> consistently outperforms other predictors in achieving lower test error rates, establishing its superiority in guiding the NAS process toward more accurate architectural choices.</span></figcaption><img src="/html/2403.12821/assets/x7.png" id="A3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="160" alt="Refer to caption">
<br class="ltx_break ltx_centering">
</figure>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Latency prediction experiments</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p">To measure the encoding quality of <span id="A3.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> in various aspects and validate its effectiveness, we conduct a latency prediction experiment on NAS-Bench-201, comparing <span id="A3.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> with NAR-Former <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite>.
For this comparison, we utilize Mean Absolute Percentage Error (MAPE) and Error Bound Accuracy (Acc(<math id="A3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="A3.SS2.p1.1.m1.1a"><mi id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><ci id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">\delta</annotation></semantics></math>)), the same metrics employed by <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Yi et al.</span> [<a href="#bib.bib50" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">50</span></a>]</cite> for latency prediction.
As shown in Table <a href="#A3.T7" title="Table 7 ‣ C.2 Latency prediction experiments ‣ Appendix C Additional Experiments and Results ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, <span id="A3.SS2.p1.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> outperforms NAR-Former in the latency prediction task.</p>
</div>
<figure id="A3.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A3.T7.9.2.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="A3.T7.2.1" class="ltx_text" style="font-size:90%;">Mean Absolute Percentage Error (MAPE) and Error Bound Accuracy (ACC) at <math id="A3.T7.2.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="A3.T7.2.1.m1.1b"><mi id="A3.T7.2.1.m1.1.1" xref="A3.T7.2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A3.T7.2.1.m1.1c"><ci id="A3.T7.2.1.m1.1.1.cmml" xref="A3.T7.2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T7.2.1.m1.1d">\delta</annotation></semantics></math> (scaled up by a factor of 100, mean over 9 trials) of latency prediction on the NAS-Bench-201 dataset. In each setting, the best performances are highlighted in <span id="A3.T7.2.1.1" class="ltx_text" style="color:#00B300;">green</span>.</span></figcaption>
<div id="A3.T7.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:188.7pt;height:64.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-62.9pt,21.6pt) scale(0.6,0.6) ;">
<table id="A3.T7.6.4" class="ltx_tabular ltx_align_middle">
<tr id="A3.T7.6.4.5" class="ltx_tr">
<td id="A3.T7.6.4.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A3.T7.6.4.4" class="ltx_tr">
<td id="A3.T7.6.4.4.5" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Metric</td>
<td id="A3.T7.3.1.1.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">MAPE<math id="A3.T7.3.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A3.T7.3.1.1.1.m1.1a"><mo stretchy="false" id="A3.T7.3.1.1.1.m1.1.1" xref="A3.T7.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A3.T7.3.1.1.1.m1.1b"><ci id="A3.T7.3.1.1.1.m1.1.1.cmml" xref="A3.T7.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T7.3.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</td>
<td id="A3.T7.4.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">ACC (<math id="A3.T7.4.2.2.2.m1.1" class="ltx_math_unparsed" alttext="\delta=0.1\%)\uparrow" display="inline"><semantics id="A3.T7.4.2.2.2.m1.1a"><mrow id="A3.T7.4.2.2.2.m1.1b"><mi id="A3.T7.4.2.2.2.m1.1.1">δ</mi><mo id="A3.T7.4.2.2.2.m1.1.2">=</mo><mn id="A3.T7.4.2.2.2.m1.1.3">0.1</mn><mo id="A3.T7.4.2.2.2.m1.1.4">%</mo><mo stretchy="false" id="A3.T7.4.2.2.2.m1.1.5">)</mo><mo stretchy="false" id="A3.T7.4.2.2.2.m1.1.6">↑</mo></mrow><annotation encoding="application/x-tex" id="A3.T7.4.2.2.2.m1.1c">\delta=0.1\%)\uparrow</annotation></semantics></math>
</td>
<td id="A3.T7.5.3.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">ACC (<math id="A3.T7.5.3.3.3.m1.1" class="ltx_math_unparsed" alttext="\delta=1\%)\uparrow" display="inline"><semantics id="A3.T7.5.3.3.3.m1.1a"><mrow id="A3.T7.5.3.3.3.m1.1b"><mi id="A3.T7.5.3.3.3.m1.1.1">δ</mi><mo id="A3.T7.5.3.3.3.m1.1.2">=</mo><mn id="A3.T7.5.3.3.3.m1.1.3">1</mn><mo id="A3.T7.5.3.3.3.m1.1.4">%</mo><mo stretchy="false" id="A3.T7.5.3.3.3.m1.1.5">)</mo><mo stretchy="false" id="A3.T7.5.3.3.3.m1.1.6">↑</mo></mrow><annotation encoding="application/x-tex" id="A3.T7.5.3.3.3.m1.1c">\delta=1\%)\uparrow</annotation></semantics></math>
</td>
<td id="A3.T7.6.4.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">ACC (<math id="A3.T7.6.4.4.4.m1.1" class="ltx_math_unparsed" alttext="\delta=5\%)\uparrow" display="inline"><semantics id="A3.T7.6.4.4.4.m1.1a"><mrow id="A3.T7.6.4.4.4.m1.1b"><mi id="A3.T7.6.4.4.4.m1.1.1">δ</mi><mo id="A3.T7.6.4.4.4.m1.1.2">=</mo><mn id="A3.T7.6.4.4.4.m1.1.3">5</mn><mo id="A3.T7.6.4.4.4.m1.1.4">%</mo><mo stretchy="false" id="A3.T7.6.4.4.4.m1.1.5">)</mo><mo stretchy="false" id="A3.T7.6.4.4.4.m1.1.6">↑</mo></mrow><annotation encoding="application/x-tex" id="A3.T7.6.4.4.4.m1.1c">\delta=5\%)\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T7.6.4.6" class="ltx_tr">
<td id="A3.T7.6.4.6.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Training ratio</td>
<td id="A3.T7.6.4.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T7.6.4.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
<td id="A3.T7.6.4.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T7.6.4.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
<td id="A3.T7.6.4.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T7.6.4.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
<td id="A3.T7.6.4.6.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T7.6.4.6.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
</tr>
<tr id="A3.T7.6.4.7" class="ltx_tr">
<td id="A3.T7.6.4.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">NAR-Former</td>
<td id="A3.T7.6.4.7.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">3.1</td>
<td id="A3.T7.6.4.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">3.0</td>
<td id="A3.T7.6.4.7.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">2.3</td>
<td id="A3.T7.6.4.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">2.3</td>
<td id="A3.T7.6.4.7.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">21.9</td>
<td id="A3.T7.6.4.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">22.9</td>
<td id="A3.T7.6.4.7.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">80.8</td>
<td id="A3.T7.6.4.7.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">82.2</td>
</tr>
<tr id="A3.T7.6.4.8" class="ltx_tr">
<td id="A3.T7.6.4.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="A3.T7.6.4.8.2" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.2.1" class="ltx_text" style="background-color:#A8E3A1;">1.1</span></td>
<td id="A3.T7.6.4.8.3" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.3.1" class="ltx_text" style="background-color:#A8E3A1;">0.9</span></td>
<td id="A3.T7.6.4.8.4" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.4.1" class="ltx_text" style="background-color:#A8E3A1;">8.6</span></td>
<td id="A3.T7.6.4.8.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.5.1" class="ltx_text" style="background-color:#A8E3A1;">12.7</span></td>
<td id="A3.T7.6.4.8.6" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.6.1" class="ltx_text" style="background-color:#A8E3A1;">67.2</span></td>
<td id="A3.T7.6.4.8.7" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.7.1" class="ltx_text" style="background-color:#A8E3A1;">78.3</span></td>
<td id="A3.T7.6.4.8.8" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.8.1" class="ltx_text" style="background-color:#A8E3A1;">97.4</span></td>
<td id="A3.T7.6.4.8.9" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T7.6.4.8.9.1" class="ltx_text" style="background-color:#A8E3A1;">97.0</span></td>
</tr>
<tr id="A3.T7.6.4.9" class="ltx_tr">
<td id="A3.T7.6.4.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="A3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Evaluation with additional metrics</h3>

<div id="A3.SS3.p1" class="ltx_para">
<p id="A3.SS3.p1.1" class="ltx_p">To evaluate the superior performance of <span id="A3.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> across different evaluation criteria, we examine performance on NAS-Bench-101 using the Pearson Coefficient of Linear Correlation (LC) and Root Mean Squared Error (RMSE).
As shown in Table <a href="#A3.T8" title="Table 8 ‣ C.3 Evaluation with additional metrics ‣ Appendix C Additional Experiments and Results ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, <span id="A3.SS3.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> shows the best performance in all the settings.</p>
</div>
<figure id="A3.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A3.T8.5.1.1" class="ltx_text" style="font-size:90%;">Table 8</span>: </span><span id="A3.T8.6.2" class="ltx_text" style="font-size:90%;">Linear Correlation (LC) and Root Mean Squared Error (RMSE) (mean over 9 trials) on the NAS-Bench-101 dataset. In each setting, the best performances are highlighted in <span id="A3.T8.6.2.1" class="ltx_text" style="color:#00B300;">green</span>.</span></figcaption>
<div id="A3.T8.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:232.6pt;height:73.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-84.2pt,26.5pt) scale(0.58,0.58) ;">
<table id="A3.T8.2.2" class="ltx_tabular ltx_align_middle">
<tr id="A3.T8.2.2.3" class="ltx_tr">
<td id="A3.T8.2.2.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A3.T8.2.2.2" class="ltx_tr">
<td id="A3.T8.2.2.2.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Metric</td>
<td id="A3.T8.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="4">LC<math id="A3.T8.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A3.T8.1.1.1.1.m1.1a"><mo stretchy="false" id="A3.T8.1.1.1.1.m1.1.1" xref="A3.T8.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A3.T8.1.1.1.1.m1.1b"><ci id="A3.T8.1.1.1.1.m1.1.1.cmml" xref="A3.T8.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="A3.T8.2.2.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;" colspan="4">RMSE<math id="A3.T8.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A3.T8.2.2.2.2.m1.1a"><mo stretchy="false" id="A3.T8.2.2.2.2.m1.1.1" xref="A3.T8.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A3.T8.2.2.2.2.m1.1b"><ci id="A3.T8.2.2.2.2.m1.1.1.cmml" xref="A3.T8.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</td>
</tr>
<tr id="A3.T8.2.2.4" class="ltx_tr">
<td id="A3.T8.2.2.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Training ratio</td>
<td id="A3.T8.2.2.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1%</td>
<td id="A3.T8.2.2.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T8.2.2.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
<td id="A3.T8.2.2.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">50%</td>
<td id="A3.T8.2.2.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1%</td>
<td id="A3.T8.2.2.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5%</td>
<td id="A3.T8.2.2.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10%</td>
<td id="A3.T8.2.2.4.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">50%</td>
</tr>
<tr id="A3.T8.2.2.5" class="ltx_tr">
<td id="A3.T8.2.2.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">DAGNN</td>
<td id="A3.T8.2.2.5.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.4381</td>
<td id="A3.T8.2.2.5.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.4919</td>
<td id="A3.T8.2.2.5.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.5201</td>
<td id="A3.T8.2.2.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.5876</td>
<td id="A3.T8.2.2.5.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.0813</td>
<td id="A3.T8.2.2.5.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.0802</td>
<td id="A3.T8.2.2.5.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.0791</td>
<td id="A3.T8.2.2.5.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">0.0755</td>
</tr>
<tr id="A3.T8.2.2.6" class="ltx_tr">
<td id="A3.T8.2.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">TA-GATES</td>
<td id="A3.T8.2.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.3303</td>
<td id="A3.T8.2.2.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.3432</td>
<td id="A3.T8.2.2.6.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.5087</td>
<td id="A3.T8.2.2.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">0.5677</td>
<td id="A3.T8.2.2.6.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.0834</td>
<td id="A3.T8.2.2.6.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.0831</td>
<td id="A3.T8.2.2.6.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.0803</td>
<td id="A3.T8.2.2.6.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">0.0777</td>
</tr>
<tr id="A3.T8.2.2.7" class="ltx_tr">
<td id="A3.T8.2.2.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="A3.T8.2.2.7.2" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.2.1" class="ltx_text" style="background-color:#A8E3A1;">0.5636</span></td>
<td id="A3.T8.2.2.7.3" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.3.1" class="ltx_text" style="background-color:#A8E3A1;">0.6583</span></td>
<td id="A3.T8.2.2.7.4" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.4.1" class="ltx_text" style="background-color:#A8E3A1;">0.6605</span></td>
<td id="A3.T8.2.2.7.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.5.1" class="ltx_text" style="background-color:#A8E3A1;">0.7483</span></td>
<td id="A3.T8.2.2.7.6" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.6.1" class="ltx_text" style="background-color:#A8E3A1;">0.0768</span></td>
<td id="A3.T8.2.2.7.7" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.7.1" class="ltx_text" style="background-color:#A8E3A1;">0.0694</span></td>
<td id="A3.T8.2.2.7.8" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.8.1" class="ltx_text" style="background-color:#A8E3A1;">0.0670</span></td>
<td id="A3.T8.2.2.7.9" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:1pt;padding-bottom:1pt;"><span id="A3.T8.2.2.7.9.1" class="ltx_text" style="background-color:#A8E3A1;">0.0614</span></td>
</tr>
<tr id="A3.T8.2.2.8" class="ltx_tr">
<td id="A3.T8.2.2.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="9"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="A3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Extended evaluation on additional dataset</h3>

<div id="A3.SS4.p1" class="ltx_para">
<p id="A3.SS4.p1.1" class="ltx_p">In this section, we analyze the performance of <span id="A3.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> on ENAS, an additional dataset consisting of two cells. As shown in Table <a href="#A3.T9" title="Table 9 ‣ C.4 Extended evaluation on additional dataset ‣ Appendix C Additional Experiments and Results ‣ FlowerFormer: Empowering Neural Architecture Encoding using a Flow-aware Graph Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, <span id="A3.SS4.p1.1.2" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> achieves the second-best performance in the dataset.
We hypothesize that the sub-optimal performance of <span id="A3.SS4.p1.1.3" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> stems from its failure to account for interactions between two cells. Although there is information flow between two cells, <span id="A3.SS4.p1.1.4" class="ltx_text ltx_font_smallcaps">FlowerFormer</span> lacks a dedicated global attention module that can capture their interactions.
This limitation suggests that enhancing the global attention module to incorporate strategies like cross-attention could be a valuable future research direction.</p>
</div>
<figure id="A3.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A3.T9.3.1.1" class="ltx_text" style="font-size:90%;">Table 9</span>: </span><span id="A3.T9.4.2" class="ltx_text" style="font-size:90%;">Kendall’s Tau (scaled up by a factor of 100, mean over 9 trials) on the ENAS dataset. In each setting, the best performances are highlighted in <span id="A3.T9.4.2.1" class="ltx_text" style="color:#00B300;">green</span>.
</span></figcaption>
<div id="A3.T9.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:281.9pt;height:135pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-47.0pt,22.5pt) scale(0.75,0.75) ;">
<table id="A3.T9.5.1" class="ltx_tabular ltx_align_middle">
<tr id="A3.T9.5.1.1" class="ltx_tr">
<td id="A3.T9.5.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="6"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A3.T9.5.1.2" class="ltx_tr">
<td id="A3.T9.5.1.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Datasets</td>
<td id="A3.T9.5.1.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="4">ENAS</td>
<td id="A3.T9.5.1.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Avg.</td>
</tr>
<tr id="A3.T9.5.1.3" class="ltx_tr">
<td id="A3.T9.5.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Training portions</td>
<td id="A3.T9.5.1.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1%</td>
<td id="A3.T9.5.1.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">5%</td>
<td id="A3.T9.5.1.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">10%</td>
<td id="A3.T9.5.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50%</td>
<td id="A3.T9.5.1.3.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">Rank</td>
</tr>
<tr id="A3.T9.5.1.4" class="ltx_tr">
<td id="A3.T9.5.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">GatedGCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>
</td>
<td id="A3.T9.5.1.4.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">15.0</td>
<td id="A3.T9.5.1.4.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">36.1</td>
<td id="A3.T9.5.1.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.2</td>
<td id="A3.T9.5.1.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">54.7</td>
<td id="A3.T9.5.1.4.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.75</td>
</tr>
<tr id="A3.T9.5.1.5" class="ltx_tr">
<td id="A3.T9.5.1.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>
</td>
<td id="A3.T9.5.1.5.2" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A3.T9.5.1.5.2.1" class="ltx_text" style="background-color:#A8E3A1;">31.0</span></td>
<td id="A3.T9.5.1.5.3" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A3.T9.5.1.5.3.1" class="ltx_text" style="background-color:#A8E3A1;">47.0</span></td>
<td id="A3.T9.5.1.5.4" class="ltx_td ltx_align_center" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A3.T9.5.1.5.4.1" class="ltx_text" style="background-color:#A8E3A1;">52.6</span></td>
<td id="A3.T9.5.1.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.3</td>
<td id="A3.T9.5.1.5.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">1.25</td>
</tr>
<tr id="A3.T9.5.1.6" class="ltx_tr">
<td id="A3.T9.5.1.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">GraphGPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>
</td>
<td id="A3.T9.5.1.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">6.9</td>
<td id="A3.T9.5.1.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.5</td>
<td id="A3.T9.5.1.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">34.2</td>
<td id="A3.T9.5.1.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">51.2</td>
<td id="A3.T9.5.1.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">6.00</td>
</tr>
<tr id="A3.T9.5.1.7" class="ltx_tr">
<td id="A3.T9.5.1.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DAGFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>
</td>
<td id="A3.T9.5.1.7.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">12.2</td>
<td id="A3.T9.5.1.7.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.4</td>
<td id="A3.T9.5.1.7.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.5</td>
<td id="A3.T9.5.1.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.9</td>
<td id="A3.T9.5.1.7.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">4.25</td>
</tr>
<tr id="A3.T9.5.1.8" class="ltx_tr">
<td id="A3.T9.5.1.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">TA-GATES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>
</td>
<td id="A3.T9.5.1.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">22.9</td>
<td id="A3.T9.5.1.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">45.2</td>
<td id="A3.T9.5.1.8.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.4</td>
<td id="A3.T9.5.1.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.2</td>
<td id="A3.T9.5.1.8.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">2.50</td>
</tr>
<tr id="A3.T9.5.1.9" class="ltx_tr">
<td id="A3.T9.5.1.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A3.T9.5.1.9.1.1" class="ltx_text ltx_font_smallcaps">FlowerFormer</span></td>
<td id="A3.T9.5.1.9.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">18.8</td>
<td id="A3.T9.5.1.9.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.3</td>
<td id="A3.T9.5.1.9.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.5</td>
<td id="A3.T9.5.1.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="background-color:#A8E3A1;padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A3.T9.5.1.9.5.1" class="ltx_text" style="background-color:#A8E3A1;">64.7</span></td>
<td id="A3.T9.5.1.9.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">2.25</td>
</tr>
<tr id="A3.T9.5.1.10" class="ltx_tr">
<td id="A3.T9.5.1.10.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="6"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.12820" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.12821" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.12821">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.12821" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.12822" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 14:10:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
