<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.02921] Text Injection for Neural Contextual Biasing</title><meta property="og:description" content="Neural contextual biasing effectively improves automatic speech recognition (ASR) for crucial phrases within a speaker's context, particularly those that are infrequent in the training data. This work proposes contextu…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Text Injection for Neural Contextual Biasing">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Text Injection for Neural Contextual Biasing">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.02921">

<!--Generated on Fri Jul  5 23:41:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">[affiliation=]ZhongMeng
<span id="p1.3.1" class="ltx_ERROR undefined">\name</span>[affiliation=]ZelinWu
<span id="p1.3.2" class="ltx_ERROR undefined">\name</span>[affiliation=]RohitPrabhavalkar
<span id="p1.3.3" class="ltx_ERROR undefined">\name</span>[affiliation=]CalPeyser
<span id="p1.3.4" class="ltx_ERROR undefined">\name</span>[affiliation=]WeiranWang
<span id="p1.3.5" class="ltx_ERROR undefined">\name</span>[affiliation=]NanxinChen
<span id="p1.3.6" class="ltx_ERROR undefined">\name</span>[affiliation=]
<br class="ltx_break">Tara N.Sainath
<span id="p1.3.7" class="ltx_ERROR undefined">\name</span>[affiliation=]BhuvanaRamabhadran</p>
</div>
<h1 class="ltx_title ltx_title_document">Text Injection for Neural Contextual Biasing</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Neural contextual biasing effectively improves automatic speech recognition (ASR) for crucial phrases within a speaker's context, particularly those that are infrequent in the training data. This work proposes contextual text injection (CTI) to enhance contextual ASR. CTI leverages not only the paired speech-text data, but also a much larger corpus of unpaired text to optimize the ASR model and its neural biasing component.
Unpaired text is converted into speech-like representations and used to guide the model's attention towards relevant bias phrases.
Moreover, we introduce a contextual text-injected (CTI) minimum word error rate (MWER) training, which minimizes the expected WER caused by contextual biasing when unpaired text is injected into the model.
Experiments show that CTI with 100 billion text sentences can achieve up to 43.3% relative WER reduction from a strong neural biasing model. CTI-MWER provides a further relative improvement of 23.5%.
</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>ASR, text injection, contextual biasing
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">End-to-end (E2E) models excel in automatic speech recognition (ASR) by directly mapping speech signals to word sequences <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
Despite training on large audio-transcript datasets, E2E ASR on contextually relevant words that appear infrequently in the training data remains challenging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Such phrases include user's contact names, songs, applications, and current locations, etc.
Contextual biasing offers an effective solution to mitigate this training-inference mismatch, improving ASR performance on contextual long-tail words.
</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Traditional contextual biasing approaches train an external language model (LM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> or construct a contextual finite state transducer (FST) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, and combine their scores with the ASR model during inference. These methods separately optimizes the ASR model and biasing component, requiring extensive tuning for the interpolation weights. E2E neural biasing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> addresses this by directly integrating the biasing component into the ASR model, enabling joint optimization towards a single ASR objective.
These methods employ attention mechanism to associate bias phrases with the decoder or the acoustic encoder of the ASR model, generating a context vector that adapts the ASR model towards the biasing context. Neural biasing shows improved ASR performance compared to the FST-based approach.
However, these methods face a scalability challenge: as the number of biasing phrases increases, both the computational latency and word error rate (WER) tend to rise.
To address this, neural associate memory (NAM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> utilizes a two-pass hierarchical biasing scheme: the 1st pass identifies the top-K bias phrases that are most likely to occur in the speech signal via correlation, and the 2nd pass restricts the acoustic encoder's attention into only the selected K phrases.
Deferred NAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> further improves the 1st pass top-K search by introducing a retrieval loss, and has achieved the state-of-the-art (SOTA) performance on multi-context biasing sets.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, training neural biasing models requires paired audio-transcript data, which is limited by the cost of human transcription. Moreover, bias phrases sampled from such transcripts are neither rare phrases for the model nor contextually relevant to the test utterances.
To address this, we propose a novel <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">contextual text injection (CTI)</em>.
CTI transforms large-scale <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">unpaired text</em> into speech-like representations through an ASR acoustic encoder, and associates them with bias phrases extracted from the <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">unpaired text</em> via an attention mechanism. This enhances the model's ability to identify the most relevant bias phrases and bias its predictions towards them. CTI offers significant advantages: 1) unpaired text is readily accessible, and is far more plentiful than audio-transcript pairs; 2) unpaired text contains a wealth of rare phrases that are infrequent or even absent in audio-transcript pairs.
Further, we propose contextual text-injected (CTI) minimum word error rate (MWER) training, where unpaired text, after undergoing contextual neural biasing, is used to generate N-best hypotheses.
Minimizing an extra text-based MWER loss computed from such hypotheses effectively reduces ASR errors introduced by contextual biasing.
Experimented with 100 billion (B) text sentences, CTI reduces WER by up to 43.3% relatively compared to a SOTA deferred NAM on voice search multi-context biasing sets.
CTI MWER leads to an additional 23.5% relative WER reduction from CTI.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Text Injection</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Various studies have explored incorporating unpaired text into E2E model training.
One approach is to fine-tune the decoder of an E2E model with unpaired text to minimize an additional cross-entropy LM loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
By zeroing out the encoder output, the decoder acts as an internal LM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. However, the decoder's limited capability restricts the effectiveness of these methods.
Text injection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> addresses this by directly feeding unpaired text into the ASR acoustic encoder, where the text is mapped to a shared latent space with speech, either explicitly or implicitly. The latent embeddings are then used to train the E2E models.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Text injection is initially applied to contextual biasing in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Building upon JOIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> injects contextually relevant, unpaired text directly
into an ASR model that does <em id="S2.SS1.p2.1.1" class="ltx_emph ltx_font_italic">not</em> contain any biasing component. This improves performance when combined with an FST-based context model during inference.
Our CTI method differs by applying JOIST-like text injection to a neural biasing model. This allows joint optimization of ASR model and its biasing component using unpaired text towards text-based ASR and retrieval objectives. Consequently, CTI integrates the advantages of both powerful neural biasing and text injection, while eliminating the need for FST or any other external biasing component during inference.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Neural Contextual Biasing with Deferred NAM</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.10" class="ltx_p">Upon removing red lines and red boxes, Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts a speech transducer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> with a neural biaser, deferred NAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
The transducer consists of an acoustic encoder, a decoder and a joint network. The acoustic encoder transforms input speech features <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathbf{X}</annotation></semantics></math> into acoustic embeddings.
To recognize named entities in speaker's context,
each speech utterance <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathbf{X}</annotation></semantics></math> is assigned <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">N</annotation></semantics></math> bias phrases <math id="S2.SS2.p1.4.m4.3" class="ltx_Math" alttext="Z=\{z_{1},...,z_{N}\}" display="inline"><semantics id="S2.SS2.p1.4.m4.3a"><mrow id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml"><mi id="S2.SS2.p1.4.m4.3.3.4" xref="S2.SS2.p1.4.m4.3.3.4.cmml">Z</mi><mo id="S2.SS2.p1.4.m4.3.3.3" xref="S2.SS2.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.3.3.2.2" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.4.m4.3.3.2.2.3" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">{</mo><msub id="S2.SS2.p1.4.m4.2.2.1.1.1" xref="S2.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.2.2.1.1.1.2" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml">z</mi><mn id="S2.SS2.p1.4.m4.2.2.1.1.1.3" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.4.m4.3.3.2.2.4" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.p1.4.m4.3.3.2.2.5" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.4.m4.3.3.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml">z</mi><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.3" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.SS2.p1.4.m4.3.3.2.2.6" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.3b"><apply id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3"><eq id="S2.SS2.p1.4.m4.3.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.3"></eq><ci id="S2.SS2.p1.4.m4.3.3.4.cmml" xref="S2.SS2.p1.4.m4.3.3.4">𝑍</ci><set id="S2.SS2.p1.4.m4.3.3.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2"><apply id="S2.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">…</ci><apply id="S2.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2">𝑧</ci><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.3c">Z=\{z_{1},...,z_{N}\}</annotation></semantics></math>. <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="z_{n}" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">z</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝑧</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">z_{n}</annotation></semantics></math> may or may not exist in <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\mathbf{Y}</annotation></semantics></math>. Deferred NAM performs 2-pass hierarchical biasing at layer <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">l</annotation></semantics></math> of the acoustic encoder.
In Pass 1, we retrieve the K most relevant biasing phrases based on the correlations between acoustic embeddings <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{H}_{l}" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><msub id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">𝐇</mi><mi id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2">𝐇</ci><ci id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\mathbf{H}_{l}</annotation></semantics></math> and bias phrase embeddings <math id="S2.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="S2.SS2.p1.9.m9.1a"><mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\mathbf{P}</annotation></semantics></math>, followed by a max-pooling over <math id="S2.SS2.p1.10.m10.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">T</annotation></semantics></math>:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\displaystyle\mathbf{a}=\text{MaxPool}_{t=1}^{T}\left(\mathbf{h}_{l,t}{\mathbf{P}}^{\top}/\sqrt{d}\right)," display="inline"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">𝐚</mi><mo id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><msubsup id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.3.cmml"><mtext id="S2.E1.m1.3.3.1.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.1.3.2.2a.cmml">MaxPool</mtext><mrow id="S2.E1.m1.3.3.1.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.3.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.3.2.3.2" xref="S2.E1.m1.3.3.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.E1.m1.3.3.1.1.1.3.2.3.1" xref="S2.E1.m1.3.3.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.1.3.2.3.3" xref="S2.E1.m1.3.3.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">l</mi><mo id="S2.E1.m1.2.2.2.4.1" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.1.cmml">​</mo><msup id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">𝐏</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">/</mo><msqrt id="S2.E1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"></eq><ci id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3">𝐚</ci><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.3">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.3.2.2a.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.2"><mtext id="S2.E1.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.2">MaxPool</mtext></ci><apply id="S2.E1.m1.3.3.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.3"><eq id="S2.E1.m1.3.3.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.1.3.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3.3">𝑇</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"><divide id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"></divide><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.1"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2">𝐡</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑙</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2">𝐏</ci><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3">top</csymbol></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3"><root id="S2.E1.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3"></root><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle\mathbf{a}=\text{MaxPool}_{t=1}^{T}\left(\mathbf{h}_{l,t}{\mathbf{P}}^{\top}/\sqrt{d}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.20" class="ltx_p">where <math id="S2.SS2.p1.11.m1.1" class="ltx_Math" alttext="\mathbf{a}\in\mathbb{R}^{N+1}" display="inline"><semantics id="S2.SS2.p1.11.m1.1a"><mrow id="S2.SS2.p1.11.m1.1.1" xref="S2.SS2.p1.11.m1.1.1.cmml"><mi id="S2.SS2.p1.11.m1.1.1.2" xref="S2.SS2.p1.11.m1.1.1.2.cmml">𝐚</mi><mo id="S2.SS2.p1.11.m1.1.1.1" xref="S2.SS2.p1.11.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.11.m1.1.1.3" xref="S2.SS2.p1.11.m1.1.1.3.cmml"><mi id="S2.SS2.p1.11.m1.1.1.3.2" xref="S2.SS2.p1.11.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.11.m1.1.1.3.3" xref="S2.SS2.p1.11.m1.1.1.3.3.cmml"><mi id="S2.SS2.p1.11.m1.1.1.3.3.2" xref="S2.SS2.p1.11.m1.1.1.3.3.2.cmml">N</mi><mo id="S2.SS2.p1.11.m1.1.1.3.3.1" xref="S2.SS2.p1.11.m1.1.1.3.3.1.cmml">+</mo><mn id="S2.SS2.p1.11.m1.1.1.3.3.3" xref="S2.SS2.p1.11.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m1.1b"><apply id="S2.SS2.p1.11.m1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1"><in id="S2.SS2.p1.11.m1.1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1.1"></in><ci id="S2.SS2.p1.11.m1.1.1.2.cmml" xref="S2.SS2.p1.11.m1.1.1.2">𝐚</ci><apply id="S2.SS2.p1.11.m1.1.1.3.cmml" xref="S2.SS2.p1.11.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m1.1.1.3.1.cmml" xref="S2.SS2.p1.11.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.11.m1.1.1.3.2.cmml" xref="S2.SS2.p1.11.m1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p1.11.m1.1.1.3.3.cmml" xref="S2.SS2.p1.11.m1.1.1.3.3"><plus id="S2.SS2.p1.11.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.11.m1.1.1.3.3.1"></plus><ci id="S2.SS2.p1.11.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.11.m1.1.1.3.3.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.11.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.11.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m1.1c">\mathbf{a}\in\mathbb{R}^{N+1}</annotation></semantics></math>, <math id="S2.SS2.p1.12.m2.9" class="ltx_Math" alttext="\mathbf{H}_{l}=\{\mathbf{h}_{l,1},\ldots,\mathbf{h}_{l,T}\},\mathbf{h}_{l,t}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.SS2.p1.12.m2.9a"><mrow id="S2.SS2.p1.12.m2.9.9.2" xref="S2.SS2.p1.12.m2.9.9.3.cmml"><mrow id="S2.SS2.p1.12.m2.8.8.1.1" xref="S2.SS2.p1.12.m2.8.8.1.1.cmml"><msub id="S2.SS2.p1.12.m2.8.8.1.1.4" xref="S2.SS2.p1.12.m2.8.8.1.1.4.cmml"><mi id="S2.SS2.p1.12.m2.8.8.1.1.4.2" xref="S2.SS2.p1.12.m2.8.8.1.1.4.2.cmml">𝐇</mi><mi id="S2.SS2.p1.12.m2.8.8.1.1.4.3" xref="S2.SS2.p1.12.m2.8.8.1.1.4.3.cmml">l</mi></msub><mo id="S2.SS2.p1.12.m2.8.8.1.1.3" xref="S2.SS2.p1.12.m2.8.8.1.1.3.cmml">=</mo><mrow id="S2.SS2.p1.12.m2.8.8.1.1.2.2" xref="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.12.m2.8.8.1.1.2.2.3" xref="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml">{</mo><msub id="S2.SS2.p1.12.m2.8.8.1.1.1.1.1" xref="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.2" xref="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.2.cmml">𝐡</mi><mrow id="S2.SS2.p1.12.m2.2.2.2.4" xref="S2.SS2.p1.12.m2.2.2.2.3.cmml"><mi id="S2.SS2.p1.12.m2.1.1.1.1" xref="S2.SS2.p1.12.m2.1.1.1.1.cmml">l</mi><mo id="S2.SS2.p1.12.m2.2.2.2.4.1" xref="S2.SS2.p1.12.m2.2.2.2.3.cmml">,</mo><mn id="S2.SS2.p1.12.m2.2.2.2.2" xref="S2.SS2.p1.12.m2.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S2.SS2.p1.12.m2.8.8.1.1.2.2.4" xref="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.12.m2.7.7" xref="S2.SS2.p1.12.m2.7.7.cmml">…</mi><mo id="S2.SS2.p1.12.m2.8.8.1.1.2.2.5" xref="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml">,</mo><msub id="S2.SS2.p1.12.m2.8.8.1.1.2.2.2" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.2" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.2.cmml">𝐡</mi><mrow id="S2.SS2.p1.12.m2.4.4.2.4" xref="S2.SS2.p1.12.m2.4.4.2.3.cmml"><mi id="S2.SS2.p1.12.m2.3.3.1.1" xref="S2.SS2.p1.12.m2.3.3.1.1.cmml">l</mi><mo id="S2.SS2.p1.12.m2.4.4.2.4.1" xref="S2.SS2.p1.12.m2.4.4.2.3.cmml">,</mo><mi id="S2.SS2.p1.12.m2.4.4.2.2" xref="S2.SS2.p1.12.m2.4.4.2.2.cmml">T</mi></mrow></msub><mo stretchy="false" id="S2.SS2.p1.12.m2.8.8.1.1.2.2.6" xref="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="S2.SS2.p1.12.m2.9.9.2.3" xref="S2.SS2.p1.12.m2.9.9.3a.cmml">,</mo><mrow id="S2.SS2.p1.12.m2.9.9.2.2" xref="S2.SS2.p1.12.m2.9.9.2.2.cmml"><msub id="S2.SS2.p1.12.m2.9.9.2.2.2" xref="S2.SS2.p1.12.m2.9.9.2.2.2.cmml"><mi id="S2.SS2.p1.12.m2.9.9.2.2.2.2" xref="S2.SS2.p1.12.m2.9.9.2.2.2.2.cmml">𝐡</mi><mrow id="S2.SS2.p1.12.m2.6.6.2.4" xref="S2.SS2.p1.12.m2.6.6.2.3.cmml"><mi id="S2.SS2.p1.12.m2.5.5.1.1" xref="S2.SS2.p1.12.m2.5.5.1.1.cmml">l</mi><mo id="S2.SS2.p1.12.m2.6.6.2.4.1" xref="S2.SS2.p1.12.m2.6.6.2.3.cmml">,</mo><mi id="S2.SS2.p1.12.m2.6.6.2.2" xref="S2.SS2.p1.12.m2.6.6.2.2.cmml">t</mi></mrow></msub><mo id="S2.SS2.p1.12.m2.9.9.2.2.1" xref="S2.SS2.p1.12.m2.9.9.2.2.1.cmml">∈</mo><msup id="S2.SS2.p1.12.m2.9.9.2.2.3" xref="S2.SS2.p1.12.m2.9.9.2.2.3.cmml"><mi id="S2.SS2.p1.12.m2.9.9.2.2.3.2" xref="S2.SS2.p1.12.m2.9.9.2.2.3.2.cmml">ℝ</mi><mi id="S2.SS2.p1.12.m2.9.9.2.2.3.3" xref="S2.SS2.p1.12.m2.9.9.2.2.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m2.9b"><apply id="S2.SS2.p1.12.m2.9.9.3.cmml" xref="S2.SS2.p1.12.m2.9.9.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.9.9.3a.cmml" xref="S2.SS2.p1.12.m2.9.9.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.12.m2.8.8.1.1.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1"><eq id="S2.SS2.p1.12.m2.8.8.1.1.3.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.3"></eq><apply id="S2.SS2.p1.12.m2.8.8.1.1.4.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.8.8.1.1.4.1.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.4">subscript</csymbol><ci id="S2.SS2.p1.12.m2.8.8.1.1.4.2.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.4.2">𝐇</ci><ci id="S2.SS2.p1.12.m2.8.8.1.1.4.3.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.4.3">𝑙</ci></apply><set id="S2.SS2.p1.12.m2.8.8.1.1.2.3.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2"><apply id="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.1.1.1.2">𝐡</ci><list id="S2.SS2.p1.12.m2.2.2.2.3.cmml" xref="S2.SS2.p1.12.m2.2.2.2.4"><ci id="S2.SS2.p1.12.m2.1.1.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1.1.1">𝑙</ci><cn type="integer" id="S2.SS2.p1.12.m2.2.2.2.2.cmml" xref="S2.SS2.p1.12.m2.2.2.2.2">1</cn></list></apply><ci id="S2.SS2.p1.12.m2.7.7.cmml" xref="S2.SS2.p1.12.m2.7.7">…</ci><apply id="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.12.m2.8.8.1.1.2.2.2.2">𝐡</ci><list id="S2.SS2.p1.12.m2.4.4.2.3.cmml" xref="S2.SS2.p1.12.m2.4.4.2.4"><ci id="S2.SS2.p1.12.m2.3.3.1.1.cmml" xref="S2.SS2.p1.12.m2.3.3.1.1">𝑙</ci><ci id="S2.SS2.p1.12.m2.4.4.2.2.cmml" xref="S2.SS2.p1.12.m2.4.4.2.2">𝑇</ci></list></apply></set></apply><apply id="S2.SS2.p1.12.m2.9.9.2.2.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2"><in id="S2.SS2.p1.12.m2.9.9.2.2.1.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.1"></in><apply id="S2.SS2.p1.12.m2.9.9.2.2.2.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.9.9.2.2.2.1.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.12.m2.9.9.2.2.2.2.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.2.2">𝐡</ci><list id="S2.SS2.p1.12.m2.6.6.2.3.cmml" xref="S2.SS2.p1.12.m2.6.6.2.4"><ci id="S2.SS2.p1.12.m2.5.5.1.1.cmml" xref="S2.SS2.p1.12.m2.5.5.1.1">𝑙</ci><ci id="S2.SS2.p1.12.m2.6.6.2.2.cmml" xref="S2.SS2.p1.12.m2.6.6.2.2">𝑡</ci></list></apply><apply id="S2.SS2.p1.12.m2.9.9.2.2.3.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.9.9.2.2.3.1.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.3">superscript</csymbol><ci id="S2.SS2.p1.12.m2.9.9.2.2.3.2.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.3.2">ℝ</ci><ci id="S2.SS2.p1.12.m2.9.9.2.2.3.3.cmml" xref="S2.SS2.p1.12.m2.9.9.2.2.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m2.9c">\mathbf{H}_{l}=\{\mathbf{h}_{l,1},\ldots,\mathbf{h}_{l,T}\},\mathbf{h}_{l,t}\in\mathbb{R}^{d}</annotation></semantics></math> is the sequence of acoustic embeddings at the biasing layer <math id="S2.SS2.p1.13.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS2.p1.13.m3.1a"><mi id="S2.SS2.p1.13.m3.1.1" xref="S2.SS2.p1.13.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m3.1b"><ci id="S2.SS2.p1.13.m3.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m3.1c">l</annotation></semantics></math>. <math id="S2.SS2.p1.14.m4.1" class="ltx_Math" alttext="\mathbf{P}\in\mathbb{R}^{(N+1)\times d}" display="inline"><semantics id="S2.SS2.p1.14.m4.1a"><mrow id="S2.SS2.p1.14.m4.1.2" xref="S2.SS2.p1.14.m4.1.2.cmml"><mi id="S2.SS2.p1.14.m4.1.2.2" xref="S2.SS2.p1.14.m4.1.2.2.cmml">𝐏</mi><mo id="S2.SS2.p1.14.m4.1.2.1" xref="S2.SS2.p1.14.m4.1.2.1.cmml">∈</mo><msup id="S2.SS2.p1.14.m4.1.2.3" xref="S2.SS2.p1.14.m4.1.2.3.cmml"><mi id="S2.SS2.p1.14.m4.1.2.3.2" xref="S2.SS2.p1.14.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.14.m4.1.1.1" xref="S2.SS2.p1.14.m4.1.1.1.cmml"><mrow id="S2.SS2.p1.14.m4.1.1.1.1.1" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.14.m4.1.1.1.1.1.2" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.14.m4.1.1.1.1.1.1" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.14.m4.1.1.1.1.1.1.2" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.2.cmml">N</mi><mo id="S2.SS2.p1.14.m4.1.1.1.1.1.1.1" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.p1.14.m4.1.1.1.1.1.1.3" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS2.p1.14.m4.1.1.1.1.1.3" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS2.p1.14.m4.1.1.1.2" xref="S2.SS2.p1.14.m4.1.1.1.2.cmml">×</mo><mi id="S2.SS2.p1.14.m4.1.1.1.3" xref="S2.SS2.p1.14.m4.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m4.1b"><apply id="S2.SS2.p1.14.m4.1.2.cmml" xref="S2.SS2.p1.14.m4.1.2"><in id="S2.SS2.p1.14.m4.1.2.1.cmml" xref="S2.SS2.p1.14.m4.1.2.1"></in><ci id="S2.SS2.p1.14.m4.1.2.2.cmml" xref="S2.SS2.p1.14.m4.1.2.2">𝐏</ci><apply id="S2.SS2.p1.14.m4.1.2.3.cmml" xref="S2.SS2.p1.14.m4.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m4.1.2.3.1.cmml" xref="S2.SS2.p1.14.m4.1.2.3">superscript</csymbol><ci id="S2.SS2.p1.14.m4.1.2.3.2.cmml" xref="S2.SS2.p1.14.m4.1.2.3.2">ℝ</ci><apply id="S2.SS2.p1.14.m4.1.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1.1"><times id="S2.SS2.p1.14.m4.1.1.1.2.cmml" xref="S2.SS2.p1.14.m4.1.1.1.2"></times><apply id="S2.SS2.p1.14.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1.1.1.1"><plus id="S2.SS2.p1.14.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.1"></plus><ci id="S2.SS2.p1.14.m4.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.14.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.14.m4.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.14.m4.1.1.1.3.cmml" xref="S2.SS2.p1.14.m4.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m4.1c">\mathbf{P}\in\mathbb{R}^{(N+1)\times d}</annotation></semantics></math> is generated by feeding <math id="S2.SS2.p1.15.m5.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S2.SS2.p1.15.m5.1a"><mi id="S2.SS2.p1.15.m5.1.1" xref="S2.SS2.p1.15.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m5.1b"><ci id="S2.SS2.p1.15.m5.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m5.1c">Z</annotation></semantics></math> through a phrase encoder and appending the output with a <math id="S2.SS2.p1.16.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS2.p1.16.m6.1a"><mi id="S2.SS2.p1.16.m6.1.1" xref="S2.SS2.p1.16.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m6.1b"><ci id="S2.SS2.p1.16.m6.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m6.1c">d</annotation></semantics></math>-dim NO_BIAS embedding. <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For simplicity, we assume all encoder embeddings in this work have the same dimension <math id="footnote1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">d</annotation></semantics></math> and omit projection matrices.</span></span></span>
We select top-K phrases from <math id="S2.SS2.p1.17.m7.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S2.SS2.p1.17.m7.1a"><mi id="S2.SS2.p1.17.m7.1.1" xref="S2.SS2.p1.17.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m7.1b"><ci id="S2.SS2.p1.17.m7.1.1.cmml" xref="S2.SS2.p1.17.m7.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m7.1c">Z</annotation></semantics></math> corresponding to the K largest values of the correlation vector <math id="S2.SS2.p1.18.m8.1" class="ltx_Math" alttext="\mathbf{a}" display="inline"><semantics id="S2.SS2.p1.18.m8.1a"><mi id="S2.SS2.p1.18.m8.1.1" xref="S2.SS2.p1.18.m8.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m8.1b"><ci id="S2.SS2.p1.18.m8.1.1.cmml" xref="S2.SS2.p1.18.m8.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m8.1c">\mathbf{a}</annotation></semantics></math>, and tokenize them into word-pieces <math id="S2.SS2.p1.19.m9.3" class="ltx_Math" alttext="Z^{\text{w}}=\{z^{\text{w}}_{1},\ldots,z^{\text{w}}_{M}\}" display="inline"><semantics id="S2.SS2.p1.19.m9.3a"><mrow id="S2.SS2.p1.19.m9.3.3" xref="S2.SS2.p1.19.m9.3.3.cmml"><msup id="S2.SS2.p1.19.m9.3.3.4" xref="S2.SS2.p1.19.m9.3.3.4.cmml"><mi id="S2.SS2.p1.19.m9.3.3.4.2" xref="S2.SS2.p1.19.m9.3.3.4.2.cmml">Z</mi><mtext id="S2.SS2.p1.19.m9.3.3.4.3" xref="S2.SS2.p1.19.m9.3.3.4.3a.cmml">w</mtext></msup><mo id="S2.SS2.p1.19.m9.3.3.3" xref="S2.SS2.p1.19.m9.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.19.m9.3.3.2.2" xref="S2.SS2.p1.19.m9.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.19.m9.3.3.2.2.3" xref="S2.SS2.p1.19.m9.3.3.2.3.cmml">{</mo><msubsup id="S2.SS2.p1.19.m9.2.2.1.1.1" xref="S2.SS2.p1.19.m9.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.19.m9.2.2.1.1.1.2.2" xref="S2.SS2.p1.19.m9.2.2.1.1.1.2.2.cmml">z</mi><mn id="S2.SS2.p1.19.m9.2.2.1.1.1.3" xref="S2.SS2.p1.19.m9.2.2.1.1.1.3.cmml">1</mn><mtext id="S2.SS2.p1.19.m9.2.2.1.1.1.2.3" xref="S2.SS2.p1.19.m9.2.2.1.1.1.2.3a.cmml">w</mtext></msubsup><mo id="S2.SS2.p1.19.m9.3.3.2.2.4" xref="S2.SS2.p1.19.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.19.m9.1.1" xref="S2.SS2.p1.19.m9.1.1.cmml">…</mi><mo id="S2.SS2.p1.19.m9.3.3.2.2.5" xref="S2.SS2.p1.19.m9.3.3.2.3.cmml">,</mo><msubsup id="S2.SS2.p1.19.m9.3.3.2.2.2" xref="S2.SS2.p1.19.m9.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.19.m9.3.3.2.2.2.2.2" xref="S2.SS2.p1.19.m9.3.3.2.2.2.2.2.cmml">z</mi><mi id="S2.SS2.p1.19.m9.3.3.2.2.2.3" xref="S2.SS2.p1.19.m9.3.3.2.2.2.3.cmml">M</mi><mtext id="S2.SS2.p1.19.m9.3.3.2.2.2.2.3" xref="S2.SS2.p1.19.m9.3.3.2.2.2.2.3a.cmml">w</mtext></msubsup><mo stretchy="false" id="S2.SS2.p1.19.m9.3.3.2.2.6" xref="S2.SS2.p1.19.m9.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m9.3b"><apply id="S2.SS2.p1.19.m9.3.3.cmml" xref="S2.SS2.p1.19.m9.3.3"><eq id="S2.SS2.p1.19.m9.3.3.3.cmml" xref="S2.SS2.p1.19.m9.3.3.3"></eq><apply id="S2.SS2.p1.19.m9.3.3.4.cmml" xref="S2.SS2.p1.19.m9.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m9.3.3.4.1.cmml" xref="S2.SS2.p1.19.m9.3.3.4">superscript</csymbol><ci id="S2.SS2.p1.19.m9.3.3.4.2.cmml" xref="S2.SS2.p1.19.m9.3.3.4.2">𝑍</ci><ci id="S2.SS2.p1.19.m9.3.3.4.3a.cmml" xref="S2.SS2.p1.19.m9.3.3.4.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m9.3.3.4.3.cmml" xref="S2.SS2.p1.19.m9.3.3.4.3">w</mtext></ci></apply><set id="S2.SS2.p1.19.m9.3.3.2.3.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2"><apply id="S2.SS2.p1.19.m9.2.2.1.1.1.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m9.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.p1.19.m9.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m9.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.19.m9.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1.2.2">𝑧</ci><ci id="S2.SS2.p1.19.m9.2.2.1.1.1.2.3a.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m9.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1.2.3">w</mtext></ci></apply><cn type="integer" id="S2.SS2.p1.19.m9.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.19.m9.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.19.m9.1.1.cmml" xref="S2.SS2.p1.19.m9.1.1">…</ci><apply id="S2.SS2.p1.19.m9.3.3.2.2.2.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m9.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2">subscript</csymbol><apply id="S2.SS2.p1.19.m9.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m9.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.19.m9.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2.2.2">𝑧</ci><ci id="S2.SS2.p1.19.m9.3.3.2.2.2.2.3a.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S2.SS2.p1.19.m9.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2.2.3">w</mtext></ci></apply><ci id="S2.SS2.p1.19.m9.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.19.m9.3.3.2.2.2.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m9.3c">Z^{\text{w}}=\{z^{\text{w}}_{1},\ldots,z^{\text{w}}_{M}\}</annotation></semantics></math>, <math id="S2.SS2.p1.20.m10.1" class="ltx_Math" alttext="M\geq K" display="inline"><semantics id="S2.SS2.p1.20.m10.1a"><mrow id="S2.SS2.p1.20.m10.1.1" xref="S2.SS2.p1.20.m10.1.1.cmml"><mi id="S2.SS2.p1.20.m10.1.1.2" xref="S2.SS2.p1.20.m10.1.1.2.cmml">M</mi><mo id="S2.SS2.p1.20.m10.1.1.1" xref="S2.SS2.p1.20.m10.1.1.1.cmml">≥</mo><mi id="S2.SS2.p1.20.m10.1.1.3" xref="S2.SS2.p1.20.m10.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m10.1b"><apply id="S2.SS2.p1.20.m10.1.1.cmml" xref="S2.SS2.p1.20.m10.1.1"><geq id="S2.SS2.p1.20.m10.1.1.1.cmml" xref="S2.SS2.p1.20.m10.1.1.1"></geq><ci id="S2.SS2.p1.20.m10.1.1.2.cmml" xref="S2.SS2.p1.20.m10.1.1.2">𝑀</ci><ci id="S2.SS2.p1.20.m10.1.1.3.cmml" xref="S2.SS2.p1.20.m10.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m10.1c">M\geq K</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.3" class="ltx_p">Then in Pass 2, we compute the cross-attention between acoustic embeddings <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{H}_{l}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">𝐇</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝐇</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathbf{H}_{l}</annotation></semantics></math> (as queries) and the word-piece embeddings
<math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{W}\in\mathbb{R}^{M\times d}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">𝐖</mi><mo id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS2.p2.2.m2.1.1.3.2" xref="S2.SS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.2.m2.1.1.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S2.SS2.p2.2.m2.1.1.3.3.2" xref="S2.SS2.p2.2.m2.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.2.m2.1.1.3.3.1" xref="S2.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.2.m2.1.1.3.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><in id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></in><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝐖</ci><apply id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.2.m2.1.1.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3"><times id="S2.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S2.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.2">𝑀</ci><ci id="S2.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathbf{W}\in\mathbb{R}^{M\times d}</annotation></semantics></math> of <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="Z^{\text{w}}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msup id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">Z</mi><mtext id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3a.cmml">w</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝑍</ci><ci id="S2.SS2.p2.3.m3.1.1.3a.cmml" xref="S2.SS2.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">w</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">Z^{\text{w}}</annotation></semantics></math> (as keys and values
<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For better biasing performance, values are typically obtained by left-shifting keys by one token and appending a zero-embedding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</span></span></span>):
</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{C}=\text{CrossAttention}(Q=\mathbf{H}_{l};K,V=\mathbf{W})," display="inline"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml">𝐂</mi><mo id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mtext id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3a.cmml">CrossAttention</mtext><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">Q</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">K</mi></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">𝐖</mi></mrow></mrow><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"></eq><ci id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3">𝐂</ci><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><ci id="S2.E2.m1.2.2.1.1.1.3a.cmml" xref="S2.E2.m1.2.2.1.1.1.3"><mtext id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3">CrossAttention</mtext></ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1"><eq id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2"></eq><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑄</ci><list id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐇</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝐾</ci></list></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2"><eq id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.1"></eq><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2">𝑉</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.3">𝐖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\displaystyle\mathbf{C}=\text{CrossAttention}(Q=\mathbf{H}_{l};K,V=\mathbf{W}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.6" class="ltx_p">where <math id="S2.SS2.p2.4.m1.1" class="ltx_Math" alttext="\mathbf{C}\in\mathbb{R}^{T\times d}" display="inline"><semantics id="S2.SS2.p2.4.m1.1a"><mrow id="S2.SS2.p2.4.m1.1.1" xref="S2.SS2.p2.4.m1.1.1.cmml"><mi id="S2.SS2.p2.4.m1.1.1.2" xref="S2.SS2.p2.4.m1.1.1.2.cmml">𝐂</mi><mo id="S2.SS2.p2.4.m1.1.1.1" xref="S2.SS2.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.4.m1.1.1.3" xref="S2.SS2.p2.4.m1.1.1.3.cmml"><mi id="S2.SS2.p2.4.m1.1.1.3.2" xref="S2.SS2.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.4.m1.1.1.3.3" xref="S2.SS2.p2.4.m1.1.1.3.3.cmml"><mi id="S2.SS2.p2.4.m1.1.1.3.3.2" xref="S2.SS2.p2.4.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m1.1.1.3.3.1" xref="S2.SS2.p2.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.4.m1.1.1.3.3.3" xref="S2.SS2.p2.4.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m1.1b"><apply id="S2.SS2.p2.4.m1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1"><in id="S2.SS2.p2.4.m1.1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1.1"></in><ci id="S2.SS2.p2.4.m1.1.1.2.cmml" xref="S2.SS2.p2.4.m1.1.1.2">𝐂</ci><apply id="S2.SS2.p2.4.m1.1.1.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m1.1.1.3.1.cmml" xref="S2.SS2.p2.4.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.4.m1.1.1.3.2.cmml" xref="S2.SS2.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.4.m1.1.1.3.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3"><times id="S2.SS2.p2.4.m1.1.1.3.3.1.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3.1"></times><ci id="S2.SS2.p2.4.m1.1.1.3.3.2.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3.2">𝑇</ci><ci id="S2.SS2.p2.4.m1.1.1.3.3.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m1.1c">\mathbf{C}\in\mathbb{R}^{T\times d}</annotation></semantics></math> contains the <math id="S2.SS2.p2.5.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p2.5.m2.1a"><mi id="S2.SS2.p2.5.m2.1.1" xref="S2.SS2.p2.5.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m2.1b"><ci id="S2.SS2.p2.5.m2.1.1.cmml" xref="S2.SS2.p2.5.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m2.1c">T</annotation></semantics></math> context vectors generated by the cross-attention <math id="S2.SS2.p2.6.m3.1" class="ltx_Math" alttext="\text{Softmax}(QK^{\top}/\sqrt{d})V" display="inline"><semantics id="S2.SS2.p2.6.m3.1a"><mrow id="S2.SS2.p2.6.m3.1.1" xref="S2.SS2.p2.6.m3.1.1.cmml"><mtext id="S2.SS2.p2.6.m3.1.1.3" xref="S2.SS2.p2.6.m3.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m3.1.1.2" xref="S2.SS2.p2.6.m3.1.1.2.cmml">​</mo><mrow id="S2.SS2.p2.6.m3.1.1.1.1" xref="S2.SS2.p2.6.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m3.1.1.1.1.2" xref="S2.SS2.p2.6.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.6.m3.1.1.1.1.1" xref="S2.SS2.p2.6.m3.1.1.1.1.1.cmml"><mrow id="S2.SS2.p2.6.m3.1.1.1.1.1.2" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.6.m3.1.1.1.1.1.2.2" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m3.1.1.1.1.1.2.1" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.1.cmml">​</mo><msup id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.2" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.2.cmml">K</mi><mo id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.3" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><mo id="S2.SS2.p2.6.m3.1.1.1.1.1.1" xref="S2.SS2.p2.6.m3.1.1.1.1.1.1.cmml">/</mo><msqrt id="S2.SS2.p2.6.m3.1.1.1.1.1.3" xref="S2.SS2.p2.6.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.6.m3.1.1.1.1.1.3.2" xref="S2.SS2.p2.6.m3.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo stretchy="false" id="S2.SS2.p2.6.m3.1.1.1.1.3" xref="S2.SS2.p2.6.m3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m3.1.1.2a" xref="S2.SS2.p2.6.m3.1.1.2.cmml">​</mo><mi id="S2.SS2.p2.6.m3.1.1.4" xref="S2.SS2.p2.6.m3.1.1.4.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m3.1b"><apply id="S2.SS2.p2.6.m3.1.1.cmml" xref="S2.SS2.p2.6.m3.1.1"><times id="S2.SS2.p2.6.m3.1.1.2.cmml" xref="S2.SS2.p2.6.m3.1.1.2"></times><ci id="S2.SS2.p2.6.m3.1.1.3a.cmml" xref="S2.SS2.p2.6.m3.1.1.3"><mtext id="S2.SS2.p2.6.m3.1.1.3.cmml" xref="S2.SS2.p2.6.m3.1.1.3">Softmax</mtext></ci><apply id="S2.SS2.p2.6.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1"><divide id="S2.SS2.p2.6.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.1"></divide><apply id="S2.SS2.p2.6.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2"><times id="S2.SS2.p2.6.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.1"></times><ci id="S2.SS2.p2.6.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.2">𝑄</ci><apply id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.2.3.3">top</csymbol></apply></apply><apply id="S2.SS2.p2.6.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.3"><root id="S2.SS2.p2.6.m3.1.1.1.1.1.3a.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.3"></root><ci id="S2.SS2.p2.6.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.6.m3.1.1.1.1.1.3.2">𝑑</ci></apply></apply><ci id="S2.SS2.p2.6.m3.1.1.4.cmml" xref="S2.SS2.p2.6.m3.1.1.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m3.1c">\text{Softmax}(QK^{\top}/\sqrt{d})V</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.15" class="ltx_p">The <em id="S2.SS2.p3.15.1" class="ltx_emph ltx_font_italic">biased</em> acoustic embeddings are obtained by <math id="S2.SS2.p3.1.m1.2" class="ltx_Math" alttext="\mathbf{H}^{\text{bias}}_{l}=\mathbf{H}_{l}+\lambda_{c}\mathbf{C},\lambda_{c}\in\mathbb{R}" display="inline"><semantics id="S2.SS2.p3.1.m1.2a"><mrow id="S2.SS2.p3.1.m1.2.2.2" xref="S2.SS2.p3.1.m1.2.2.3.cmml"><mrow id="S2.SS2.p3.1.m1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.cmml"><msubsup id="S2.SS2.p3.1.m1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.2.2.2" xref="S2.SS2.p3.1.m1.1.1.1.1.2.2.2.cmml">𝐇</mi><mi id="S2.SS2.p3.1.m1.1.1.1.1.2.3" xref="S2.SS2.p3.1.m1.1.1.1.1.2.3.cmml">l</mi><mtext id="S2.SS2.p3.1.m1.1.1.1.1.2.2.3" xref="S2.SS2.p3.1.m1.1.1.1.1.2.2.3a.cmml">bias</mtext></msubsup><mo id="S2.SS2.p3.1.m1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.3.cmml"><msub id="S2.SS2.p3.1.m1.1.1.1.1.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.3.2.2" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2.2.cmml">𝐇</mi><mi id="S2.SS2.p3.1.m1.1.1.1.1.3.2.3" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="S2.SS2.p3.1.m1.1.1.1.1.3.1" xref="S2.SS2.p3.1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.cmml"><msub id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.2" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.3" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.1.m1.1.1.1.1.3.3.1" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p3.1.m1.1.1.1.1.3.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.3.cmml">𝐂</mi></mrow></mrow></mrow><mo id="S2.SS2.p3.1.m1.2.2.2.3" xref="S2.SS2.p3.1.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p3.1.m1.2.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.cmml"><msub id="S2.SS2.p3.1.m1.2.2.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.2.2.cmml">λ</mi><mi id="S2.SS2.p3.1.m1.2.2.2.2.2.3" xref="S2.SS2.p3.1.m1.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S2.SS2.p3.1.m1.2.2.2.2.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.cmml">∈</mo><mi id="S2.SS2.p3.1.m1.2.2.2.2.3" xref="S2.SS2.p3.1.m1.2.2.2.2.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.2b"><apply id="S2.SS2.p3.1.m1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.3a.cmml" xref="S2.SS2.p3.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p3.1.m1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1"><eq id="S2.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1"></eq><apply id="S2.SS2.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2">subscript</csymbol><apply id="S2.SS2.p3.1.m1.1.1.1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2.2.2">𝐇</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.2.2.3a.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S2.SS2.p3.1.m1.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2.2.3">bias</mtext></ci></apply><ci id="S2.SS2.p3.1.m1.1.1.1.1.2.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.SS2.p3.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3"><plus id="S2.SS2.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.1"></plus><apply id="S2.SS2.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2.2">𝐇</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S2.SS2.p3.1.m1.1.1.1.1.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3"><times id="S2.SS2.p3.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.1"></times><apply id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.2.3">𝑐</ci></apply><ci id="S2.SS2.p3.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.3.3.3">𝐂</ci></apply></apply></apply><apply id="S2.SS2.p3.1.m1.2.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2"><in id="S2.SS2.p3.1.m1.2.2.2.2.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1"></in><apply id="S2.SS2.p3.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2.2">𝜆</ci><ci id="S2.SS2.p3.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2.3">𝑐</ci></apply><ci id="S2.SS2.p3.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.2c">\mathbf{H}^{\text{bias}}_{l}=\mathbf{H}_{l}+\lambda_{c}\mathbf{C},\lambda_{c}\in\mathbb{R}</annotation></semantics></math>,
which are then propagated through the upper acoustic encoder layers. The decoder takes in previous labels to generate the current label embedding. The joint network combines the top-layer acoustic and label embeddings
via a feed-forward network, and estimates posteriors of the ground-truth transcript <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\mathbf{Y}</annotation></semantics></math>.
A transducer loss <math id="S2.SS2.p3.3.m3.7" class="ltx_Math" alttext="\mathcal{L}^{\text{ASR}}(\mathcal{D})=-\sum_{(\mathbf{X},\mathbf{Y},Z)\in\mathcal{D}}\log P(\mathbf{Y}|\mathbf{X},Z)" display="inline"><semantics id="S2.SS2.p3.3.m3.7a"><mrow id="S2.SS2.p3.3.m3.7.7" xref="S2.SS2.p3.3.m3.7.7.cmml"><mrow id="S2.SS2.p3.3.m3.7.7.3" xref="S2.SS2.p3.3.m3.7.7.3.cmml"><msup id="S2.SS2.p3.3.m3.7.7.3.2" xref="S2.SS2.p3.3.m3.7.7.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.7.7.3.2.2" xref="S2.SS2.p3.3.m3.7.7.3.2.2.cmml">ℒ</mi><mtext id="S2.SS2.p3.3.m3.7.7.3.2.3" xref="S2.SS2.p3.3.m3.7.7.3.2.3a.cmml">ASR</mtext></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.3.m3.7.7.3.1" xref="S2.SS2.p3.3.m3.7.7.3.1.cmml">​</mo><mrow id="S2.SS2.p3.3.m3.7.7.3.3.2" xref="S2.SS2.p3.3.m3.7.7.3.cmml"><mo stretchy="false" id="S2.SS2.p3.3.m3.7.7.3.3.2.1" xref="S2.SS2.p3.3.m3.7.7.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.4.4" xref="S2.SS2.p3.3.m3.4.4.cmml">𝒟</mi><mo stretchy="false" id="S2.SS2.p3.3.m3.7.7.3.3.2.2" xref="S2.SS2.p3.3.m3.7.7.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.3.m3.7.7.2" xref="S2.SS2.p3.3.m3.7.7.2.cmml">=</mo><mrow id="S2.SS2.p3.3.m3.7.7.1" xref="S2.SS2.p3.3.m3.7.7.1.cmml"><mo id="S2.SS2.p3.3.m3.7.7.1a" xref="S2.SS2.p3.3.m3.7.7.1.cmml">−</mo><mrow id="S2.SS2.p3.3.m3.7.7.1.1" xref="S2.SS2.p3.3.m3.7.7.1.1.cmml"><msub id="S2.SS2.p3.3.m3.7.7.1.1.2" xref="S2.SS2.p3.3.m3.7.7.1.1.2.cmml"><mo id="S2.SS2.p3.3.m3.7.7.1.1.2.2" xref="S2.SS2.p3.3.m3.7.7.1.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p3.3.m3.3.3.3" xref="S2.SS2.p3.3.m3.3.3.3.cmml"><mrow id="S2.SS2.p3.3.m3.3.3.3.5.2" xref="S2.SS2.p3.3.m3.3.3.3.5.1.cmml"><mo stretchy="false" id="S2.SS2.p3.3.m3.3.3.3.5.2.1" xref="S2.SS2.p3.3.m3.3.3.3.5.1.cmml">(</mo><mi id="S2.SS2.p3.3.m3.1.1.1.1" xref="S2.SS2.p3.3.m3.1.1.1.1.cmml">𝐗</mi><mo id="S2.SS2.p3.3.m3.3.3.3.5.2.2" xref="S2.SS2.p3.3.m3.3.3.3.5.1.cmml">,</mo><mi id="S2.SS2.p3.3.m3.2.2.2.2" xref="S2.SS2.p3.3.m3.2.2.2.2.cmml">𝐘</mi><mo id="S2.SS2.p3.3.m3.3.3.3.5.2.3" xref="S2.SS2.p3.3.m3.3.3.3.5.1.cmml">,</mo><mi id="S2.SS2.p3.3.m3.3.3.3.3" xref="S2.SS2.p3.3.m3.3.3.3.3.cmml">Z</mi><mo stretchy="false" id="S2.SS2.p3.3.m3.3.3.3.5.2.4" xref="S2.SS2.p3.3.m3.3.3.3.5.1.cmml">)</mo></mrow><mo id="S2.SS2.p3.3.m3.3.3.3.4" xref="S2.SS2.p3.3.m3.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.3.3.3.6" xref="S2.SS2.p3.3.m3.3.3.3.6.cmml">𝒟</mi></mrow></msub><mrow id="S2.SS2.p3.3.m3.7.7.1.1.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.cmml"><mrow id="S2.SS2.p3.3.m3.7.7.1.1.1.3" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.cmml"><mi id="S2.SS2.p3.3.m3.7.7.1.1.1.3.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p3.3.m3.7.7.1.1.1.3a" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.cmml">⁡</mo><mi id="S2.SS2.p3.3.m3.7.7.1.1.1.3.2" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p3.3.m3.7.7.1.1.1.2" xref="S2.SS2.p3.3.m3.7.7.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.2" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.2" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.2.cmml">𝐘</mi><mo fence="false" id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.2" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.1.cmml"><mi id="S2.SS2.p3.3.m3.5.5" xref="S2.SS2.p3.3.m3.5.5.cmml">𝐗</mi><mo id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.2.1" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.SS2.p3.3.m3.6.6" xref="S2.SS2.p3.3.m3.6.6.cmml">Z</mi></mrow></mrow><mo stretchy="false" id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.3" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.7b"><apply id="S2.SS2.p3.3.m3.7.7.cmml" xref="S2.SS2.p3.3.m3.7.7"><eq id="S2.SS2.p3.3.m3.7.7.2.cmml" xref="S2.SS2.p3.3.m3.7.7.2"></eq><apply id="S2.SS2.p3.3.m3.7.7.3.cmml" xref="S2.SS2.p3.3.m3.7.7.3"><times id="S2.SS2.p3.3.m3.7.7.3.1.cmml" xref="S2.SS2.p3.3.m3.7.7.3.1"></times><apply id="S2.SS2.p3.3.m3.7.7.3.2.cmml" xref="S2.SS2.p3.3.m3.7.7.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.7.7.3.2.1.cmml" xref="S2.SS2.p3.3.m3.7.7.3.2">superscript</csymbol><ci id="S2.SS2.p3.3.m3.7.7.3.2.2.cmml" xref="S2.SS2.p3.3.m3.7.7.3.2.2">ℒ</ci><ci id="S2.SS2.p3.3.m3.7.7.3.2.3a.cmml" xref="S2.SS2.p3.3.m3.7.7.3.2.3"><mtext mathsize="70%" id="S2.SS2.p3.3.m3.7.7.3.2.3.cmml" xref="S2.SS2.p3.3.m3.7.7.3.2.3">ASR</mtext></ci></apply><ci id="S2.SS2.p3.3.m3.4.4.cmml" xref="S2.SS2.p3.3.m3.4.4">𝒟</ci></apply><apply id="S2.SS2.p3.3.m3.7.7.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1"><minus id="S2.SS2.p3.3.m3.7.7.1.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1"></minus><apply id="S2.SS2.p3.3.m3.7.7.1.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1"><apply id="S2.SS2.p3.3.m3.7.7.1.1.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.7.7.1.1.2.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.2">subscript</csymbol><sum id="S2.SS2.p3.3.m3.7.7.1.1.2.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.2.2"></sum><apply id="S2.SS2.p3.3.m3.3.3.3.cmml" xref="S2.SS2.p3.3.m3.3.3.3"><in id="S2.SS2.p3.3.m3.3.3.3.4.cmml" xref="S2.SS2.p3.3.m3.3.3.3.4"></in><vector id="S2.SS2.p3.3.m3.3.3.3.5.1.cmml" xref="S2.SS2.p3.3.m3.3.3.3.5.2"><ci id="S2.SS2.p3.3.m3.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1">𝐗</ci><ci id="S2.SS2.p3.3.m3.2.2.2.2.cmml" xref="S2.SS2.p3.3.m3.2.2.2.2">𝐘</ci><ci id="S2.SS2.p3.3.m3.3.3.3.3.cmml" xref="S2.SS2.p3.3.m3.3.3.3.3">𝑍</ci></vector><ci id="S2.SS2.p3.3.m3.3.3.3.6.cmml" xref="S2.SS2.p3.3.m3.3.3.3.6">𝒟</ci></apply></apply><apply id="S2.SS2.p3.3.m3.7.7.1.1.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1"><times id="S2.SS2.p3.3.m3.7.7.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.2"></times><apply id="S2.SS2.p3.3.m3.7.7.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3"><log id="S2.SS2.p3.3.m3.7.7.1.1.1.3.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.1"></log><ci id="S2.SS2.p3.3.m3.7.7.1.1.1.3.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.3.2">𝑃</ci></apply><apply id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.2">𝐘</ci><list id="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p3.3.m3.7.7.1.1.1.1.1.1.3.2"><ci id="S2.SS2.p3.3.m3.5.5.cmml" xref="S2.SS2.p3.3.m3.5.5">𝐗</ci><ci id="S2.SS2.p3.3.m3.6.6.cmml" xref="S2.SS2.p3.3.m3.6.6">𝑍</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.7c">\mathcal{L}^{\text{ASR}}(\mathcal{D})=-\sum_{(\mathbf{X},\mathbf{Y},Z)\in\mathcal{D}}\log P(\mathbf{Y}|\mathbf{X},Z)</annotation></semantics></math> is calculated on supervised audio-transcript data <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\mathcal{D}</annotation></semantics></math>.
In addition, to ensure the K phrases selected in Pass 1 are most relevant to <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><mi id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">\mathbf{X}</annotation></semantics></math>, we minimize a retrieval loss
<math id="S2.SS2.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{L}^{\text{retr}}" display="inline"><semantics id="S2.SS2.p3.6.m6.1a"><msup id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.6.m6.1.1.2" xref="S2.SS2.p3.6.m6.1.1.2.cmml">ℒ</mi><mtext id="S2.SS2.p3.6.m6.1.1.3" xref="S2.SS2.p3.6.m6.1.1.3a.cmml">retr</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><apply id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">superscript</csymbol><ci id="S2.SS2.p3.6.m6.1.1.2.cmml" xref="S2.SS2.p3.6.m6.1.1.2">ℒ</ci><ci id="S2.SS2.p3.6.m6.1.1.3a.cmml" xref="S2.SS2.p3.6.m6.1.1.3"><mtext mathsize="70%" id="S2.SS2.p3.6.m6.1.1.3.cmml" xref="S2.SS2.p3.6.m6.1.1.3">retr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">\mathcal{L}^{\text{retr}}</annotation></semantics></math> computed by a cross-entropy between
<math id="S2.SS2.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{a}" display="inline"><semantics id="S2.SS2.p3.7.m7.1a"><mi id="S2.SS2.p3.7.m7.1.1" xref="S2.SS2.p3.7.m7.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m7.1b"><ci id="S2.SS2.p3.7.m7.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m7.1c">\mathbf{a}</annotation></semantics></math> and the ground-truth label <math id="S2.SS2.p3.8.m8.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p3.8.m8.1a"><mi id="S2.SS2.p3.8.m8.1.1" xref="S2.SS2.p3.8.m8.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.8.m8.1b"><ci id="S2.SS2.p3.8.m8.1.1.cmml" xref="S2.SS2.p3.8.m8.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.8.m8.1c">r</annotation></semantics></math>.
<math id="S2.SS2.p3.9.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p3.9.m9.1a"><mi id="S2.SS2.p3.9.m9.1.1" xref="S2.SS2.p3.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.9.m9.1b"><ci id="S2.SS2.p3.9.m9.1.1.cmml" xref="S2.SS2.p3.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.9.m9.1c">r</annotation></semantics></math> indicates the longest bias phrase present in <math id="S2.SS2.p3.10.m10.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S2.SS2.p3.10.m10.1a"><mi id="S2.SS2.p3.10.m10.1.1" xref="S2.SS2.p3.10.m10.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.10.m10.1b"><ci id="S2.SS2.p3.10.m10.1.1.cmml" xref="S2.SS2.p3.10.m10.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.10.m10.1c">\mathbf{Y}</annotation></semantics></math>, or NO_BIAS if none exists.
Likewise, we calculate a word-piece retrieval loss based on the correlations between <math id="S2.SS2.p3.11.m11.1" class="ltx_Math" alttext="\mathbf{H}_{l}" display="inline"><semantics id="S2.SS2.p3.11.m11.1a"><msub id="S2.SS2.p3.11.m11.1.1" xref="S2.SS2.p3.11.m11.1.1.cmml"><mi id="S2.SS2.p3.11.m11.1.1.2" xref="S2.SS2.p3.11.m11.1.1.2.cmml">𝐇</mi><mi id="S2.SS2.p3.11.m11.1.1.3" xref="S2.SS2.p3.11.m11.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.11.m11.1b"><apply id="S2.SS2.p3.11.m11.1.1.cmml" xref="S2.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.11.m11.1.1.1.cmml" xref="S2.SS2.p3.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p3.11.m11.1.1.2.cmml" xref="S2.SS2.p3.11.m11.1.1.2">𝐇</ci><ci id="S2.SS2.p3.11.m11.1.1.3.cmml" xref="S2.SS2.p3.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.11.m11.1c">\mathbf{H}_{l}</annotation></semantics></math> and <math id="S2.SS2.p3.12.m12.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S2.SS2.p3.12.m12.1a"><mi id="S2.SS2.p3.12.m12.1.1" xref="S2.SS2.p3.12.m12.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.12.m12.1b"><ci id="S2.SS2.p3.12.m12.1.1.cmml" xref="S2.SS2.p3.12.m12.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.12.m12.1c">\mathbf{W}</annotation></semantics></math>,
and add it to <math id="S2.SS2.p3.13.m13.1" class="ltx_Math" alttext="\mathcal{L}^{\text{retr}}(\mathcal{D})" display="inline"><semantics id="S2.SS2.p3.13.m13.1a"><mrow id="S2.SS2.p3.13.m13.1.2" xref="S2.SS2.p3.13.m13.1.2.cmml"><msup id="S2.SS2.p3.13.m13.1.2.2" xref="S2.SS2.p3.13.m13.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.13.m13.1.2.2.2" xref="S2.SS2.p3.13.m13.1.2.2.2.cmml">ℒ</mi><mtext id="S2.SS2.p3.13.m13.1.2.2.3" xref="S2.SS2.p3.13.m13.1.2.2.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m13.1.2.1" xref="S2.SS2.p3.13.m13.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.13.m13.1.2.3.2" xref="S2.SS2.p3.13.m13.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.13.m13.1.2.3.2.1" xref="S2.SS2.p3.13.m13.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.13.m13.1.1" xref="S2.SS2.p3.13.m13.1.1.cmml">𝒟</mi><mo stretchy="false" id="S2.SS2.p3.13.m13.1.2.3.2.2" xref="S2.SS2.p3.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.13.m13.1b"><apply id="S2.SS2.p3.13.m13.1.2.cmml" xref="S2.SS2.p3.13.m13.1.2"><times id="S2.SS2.p3.13.m13.1.2.1.cmml" xref="S2.SS2.p3.13.m13.1.2.1"></times><apply id="S2.SS2.p3.13.m13.1.2.2.cmml" xref="S2.SS2.p3.13.m13.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m13.1.2.2.1.cmml" xref="S2.SS2.p3.13.m13.1.2.2">superscript</csymbol><ci id="S2.SS2.p3.13.m13.1.2.2.2.cmml" xref="S2.SS2.p3.13.m13.1.2.2.2">ℒ</ci><ci id="S2.SS2.p3.13.m13.1.2.2.3a.cmml" xref="S2.SS2.p3.13.m13.1.2.2.3"><mtext mathsize="70%" id="S2.SS2.p3.13.m13.1.2.2.3.cmml" xref="S2.SS2.p3.13.m13.1.2.2.3">retr</mtext></ci></apply><ci id="S2.SS2.p3.13.m13.1.1.cmml" xref="S2.SS2.p3.13.m13.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.13.m13.1c">\mathcal{L}^{\text{retr}}(\mathcal{D})</annotation></semantics></math>.
We jointly minimize the transducer loss and the retrieval loss <math id="S2.SS2.p3.14.m14.2" class="ltx_Math" alttext="\lambda_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D})+\lambda_{d}\mathcal{L}^{\text{retr}}(\mathcal{D})" display="inline"><semantics id="S2.SS2.p3.14.m14.2a"><mrow id="S2.SS2.p3.14.m14.2.3" xref="S2.SS2.p3.14.m14.2.3.cmml"><mrow id="S2.SS2.p3.14.m14.2.3.2" xref="S2.SS2.p3.14.m14.2.3.2.cmml"><msub id="S2.SS2.p3.14.m14.2.3.2.2" xref="S2.SS2.p3.14.m14.2.3.2.2.cmml"><mi id="S2.SS2.p3.14.m14.2.3.2.2.2" xref="S2.SS2.p3.14.m14.2.3.2.2.2.cmml">λ</mi><mi id="S2.SS2.p3.14.m14.2.3.2.2.3" xref="S2.SS2.p3.14.m14.2.3.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.14.m14.2.3.2.1" xref="S2.SS2.p3.14.m14.2.3.2.1.cmml">​</mo><msup id="S2.SS2.p3.14.m14.2.3.2.3" xref="S2.SS2.p3.14.m14.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.14.m14.2.3.2.3.2" xref="S2.SS2.p3.14.m14.2.3.2.3.2.cmml">ℒ</mi><mtext id="S2.SS2.p3.14.m14.2.3.2.3.3" xref="S2.SS2.p3.14.m14.2.3.2.3.3a.cmml">ASR</mtext></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.14.m14.2.3.2.1a" xref="S2.SS2.p3.14.m14.2.3.2.1.cmml">​</mo><mrow id="S2.SS2.p3.14.m14.2.3.2.4.2" xref="S2.SS2.p3.14.m14.2.3.2.cmml"><mo stretchy="false" id="S2.SS2.p3.14.m14.2.3.2.4.2.1" xref="S2.SS2.p3.14.m14.2.3.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.14.m14.1.1" xref="S2.SS2.p3.14.m14.1.1.cmml">𝒟</mi><mo stretchy="false" id="S2.SS2.p3.14.m14.2.3.2.4.2.2" xref="S2.SS2.p3.14.m14.2.3.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.14.m14.2.3.1" xref="S2.SS2.p3.14.m14.2.3.1.cmml">+</mo><mrow id="S2.SS2.p3.14.m14.2.3.3" xref="S2.SS2.p3.14.m14.2.3.3.cmml"><msub id="S2.SS2.p3.14.m14.2.3.3.2" xref="S2.SS2.p3.14.m14.2.3.3.2.cmml"><mi id="S2.SS2.p3.14.m14.2.3.3.2.2" xref="S2.SS2.p3.14.m14.2.3.3.2.2.cmml">λ</mi><mi id="S2.SS2.p3.14.m14.2.3.3.2.3" xref="S2.SS2.p3.14.m14.2.3.3.2.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.14.m14.2.3.3.1" xref="S2.SS2.p3.14.m14.2.3.3.1.cmml">​</mo><msup id="S2.SS2.p3.14.m14.2.3.3.3" xref="S2.SS2.p3.14.m14.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.14.m14.2.3.3.3.2" xref="S2.SS2.p3.14.m14.2.3.3.3.2.cmml">ℒ</mi><mtext id="S2.SS2.p3.14.m14.2.3.3.3.3" xref="S2.SS2.p3.14.m14.2.3.3.3.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.14.m14.2.3.3.1a" xref="S2.SS2.p3.14.m14.2.3.3.1.cmml">​</mo><mrow id="S2.SS2.p3.14.m14.2.3.3.4.2" xref="S2.SS2.p3.14.m14.2.3.3.cmml"><mo stretchy="false" id="S2.SS2.p3.14.m14.2.3.3.4.2.1" xref="S2.SS2.p3.14.m14.2.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.14.m14.2.2" xref="S2.SS2.p3.14.m14.2.2.cmml">𝒟</mi><mo stretchy="false" id="S2.SS2.p3.14.m14.2.3.3.4.2.2" xref="S2.SS2.p3.14.m14.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.14.m14.2b"><apply id="S2.SS2.p3.14.m14.2.3.cmml" xref="S2.SS2.p3.14.m14.2.3"><plus id="S2.SS2.p3.14.m14.2.3.1.cmml" xref="S2.SS2.p3.14.m14.2.3.1"></plus><apply id="S2.SS2.p3.14.m14.2.3.2.cmml" xref="S2.SS2.p3.14.m14.2.3.2"><times id="S2.SS2.p3.14.m14.2.3.2.1.cmml" xref="S2.SS2.p3.14.m14.2.3.2.1"></times><apply id="S2.SS2.p3.14.m14.2.3.2.2.cmml" xref="S2.SS2.p3.14.m14.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.14.m14.2.3.2.2.1.cmml" xref="S2.SS2.p3.14.m14.2.3.2.2">subscript</csymbol><ci id="S2.SS2.p3.14.m14.2.3.2.2.2.cmml" xref="S2.SS2.p3.14.m14.2.3.2.2.2">𝜆</ci><ci id="S2.SS2.p3.14.m14.2.3.2.2.3.cmml" xref="S2.SS2.p3.14.m14.2.3.2.2.3">𝑎</ci></apply><apply id="S2.SS2.p3.14.m14.2.3.2.3.cmml" xref="S2.SS2.p3.14.m14.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.14.m14.2.3.2.3.1.cmml" xref="S2.SS2.p3.14.m14.2.3.2.3">superscript</csymbol><ci id="S2.SS2.p3.14.m14.2.3.2.3.2.cmml" xref="S2.SS2.p3.14.m14.2.3.2.3.2">ℒ</ci><ci id="S2.SS2.p3.14.m14.2.3.2.3.3a.cmml" xref="S2.SS2.p3.14.m14.2.3.2.3.3"><mtext mathsize="70%" id="S2.SS2.p3.14.m14.2.3.2.3.3.cmml" xref="S2.SS2.p3.14.m14.2.3.2.3.3">ASR</mtext></ci></apply><ci id="S2.SS2.p3.14.m14.1.1.cmml" xref="S2.SS2.p3.14.m14.1.1">𝒟</ci></apply><apply id="S2.SS2.p3.14.m14.2.3.3.cmml" xref="S2.SS2.p3.14.m14.2.3.3"><times id="S2.SS2.p3.14.m14.2.3.3.1.cmml" xref="S2.SS2.p3.14.m14.2.3.3.1"></times><apply id="S2.SS2.p3.14.m14.2.3.3.2.cmml" xref="S2.SS2.p3.14.m14.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.14.m14.2.3.3.2.1.cmml" xref="S2.SS2.p3.14.m14.2.3.3.2">subscript</csymbol><ci id="S2.SS2.p3.14.m14.2.3.3.2.2.cmml" xref="S2.SS2.p3.14.m14.2.3.3.2.2">𝜆</ci><ci id="S2.SS2.p3.14.m14.2.3.3.2.3.cmml" xref="S2.SS2.p3.14.m14.2.3.3.2.3">𝑑</ci></apply><apply id="S2.SS2.p3.14.m14.2.3.3.3.cmml" xref="S2.SS2.p3.14.m14.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.14.m14.2.3.3.3.1.cmml" xref="S2.SS2.p3.14.m14.2.3.3.3">superscript</csymbol><ci id="S2.SS2.p3.14.m14.2.3.3.3.2.cmml" xref="S2.SS2.p3.14.m14.2.3.3.3.2">ℒ</ci><ci id="S2.SS2.p3.14.m14.2.3.3.3.3a.cmml" xref="S2.SS2.p3.14.m14.2.3.3.3.3"><mtext mathsize="70%" id="S2.SS2.p3.14.m14.2.3.3.3.3.cmml" xref="S2.SS2.p3.14.m14.2.3.3.3.3">retr</mtext></ci></apply><ci id="S2.SS2.p3.14.m14.2.2.cmml" xref="S2.SS2.p3.14.m14.2.2">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.14.m14.2c">\lambda_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D})+\lambda_{d}\mathcal{L}^{\text{retr}}(\mathcal{D})</annotation></semantics></math>, <math id="S2.SS2.p3.15.m15.2" class="ltx_Math" alttext="\lambda_{a},\lambda_{d}\in\mathbb{R}" display="inline"><semantics id="S2.SS2.p3.15.m15.2a"><mrow id="S2.SS2.p3.15.m15.2.2" xref="S2.SS2.p3.15.m15.2.2.cmml"><mrow id="S2.SS2.p3.15.m15.2.2.2.2" xref="S2.SS2.p3.15.m15.2.2.2.3.cmml"><msub id="S2.SS2.p3.15.m15.1.1.1.1.1" xref="S2.SS2.p3.15.m15.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.15.m15.1.1.1.1.1.2" xref="S2.SS2.p3.15.m15.1.1.1.1.1.2.cmml">λ</mi><mi id="S2.SS2.p3.15.m15.1.1.1.1.1.3" xref="S2.SS2.p3.15.m15.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S2.SS2.p3.15.m15.2.2.2.2.3" xref="S2.SS2.p3.15.m15.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p3.15.m15.2.2.2.2.2" xref="S2.SS2.p3.15.m15.2.2.2.2.2.cmml"><mi id="S2.SS2.p3.15.m15.2.2.2.2.2.2" xref="S2.SS2.p3.15.m15.2.2.2.2.2.2.cmml">λ</mi><mi id="S2.SS2.p3.15.m15.2.2.2.2.2.3" xref="S2.SS2.p3.15.m15.2.2.2.2.2.3.cmml">d</mi></msub></mrow><mo id="S2.SS2.p3.15.m15.2.2.3" xref="S2.SS2.p3.15.m15.2.2.3.cmml">∈</mo><mi id="S2.SS2.p3.15.m15.2.2.4" xref="S2.SS2.p3.15.m15.2.2.4.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.15.m15.2b"><apply id="S2.SS2.p3.15.m15.2.2.cmml" xref="S2.SS2.p3.15.m15.2.2"><in id="S2.SS2.p3.15.m15.2.2.3.cmml" xref="S2.SS2.p3.15.m15.2.2.3"></in><list id="S2.SS2.p3.15.m15.2.2.2.3.cmml" xref="S2.SS2.p3.15.m15.2.2.2.2"><apply id="S2.SS2.p3.15.m15.1.1.1.1.1.cmml" xref="S2.SS2.p3.15.m15.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.15.m15.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.15.m15.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.15.m15.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.15.m15.1.1.1.1.1.2">𝜆</ci><ci id="S2.SS2.p3.15.m15.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.15.m15.1.1.1.1.1.3">𝑎</ci></apply><apply id="S2.SS2.p3.15.m15.2.2.2.2.2.cmml" xref="S2.SS2.p3.15.m15.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.15.m15.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.15.m15.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.15.m15.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.15.m15.2.2.2.2.2.2">𝜆</ci><ci id="S2.SS2.p3.15.m15.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.15.m15.2.2.2.2.2.3">𝑑</ci></apply></list><ci id="S2.SS2.p3.15.m15.2.2.4.cmml" xref="S2.SS2.p3.15.m15.2.2.4">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.15.m15.2c">\lambda_{a},\lambda_{d}\in\mathbb{R}</annotation></semantics></math> are loss weights.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Contextual Text Injection</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">In this work, we propose <em id="S3.p1.2.1" class="ltx_emph ltx_font_italic">contextual text injection (CTI)</em>, in which a large corpus of unpaired text <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}\in\mathcal{D}^{\text{text}}" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><msup id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml"><mi id="S3.p1.1.m1.1.1.2.2" xref="S3.p1.1.m1.1.1.2.2.cmml">𝐘</mi><mtext id="S3.p1.1.m1.1.1.2.3" xref="S3.p1.1.m1.1.1.2.3a.cmml">text</mtext></msup><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">𝒟</mi><mtext id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3a.cmml">text</mtext></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><apply id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.2.1.cmml" xref="S3.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.p1.1.m1.1.1.2.2.cmml" xref="S3.p1.1.m1.1.1.2.2">𝐘</ci><ci id="S3.p1.1.m1.1.1.2.3a.cmml" xref="S3.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.p1.1.m1.1.1.2.3.cmml" xref="S3.p1.1.m1.1.1.2.3">text</mtext></ci></apply><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">𝒟</ci><ci id="S3.p1.1.m1.1.1.3.3a.cmml" xref="S3.p1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{Y}^{\text{text}}\in\mathcal{D}^{\text{text}}</annotation></semantics></math> together with its contextual bias phrases <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p1.2.m2.1a"><msup id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">Z</mi><mtext id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑍</ci><ci id="S3.p1.2.m2.1.1.3a.cmml" xref="S3.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">Z^{\text{text}}</annotation></semantics></math> are injected into an ASR model and its neural biasing component to enhance its biasing capability.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.02921/assets/cti5.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="640" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Contextual text injection (CTI) for a speech transducer with neural biasing. Blue and red arrows show the forward propagation paths for paired audio-transcript data and unpaired text, respectively. </figcaption>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.10" class="ltx_p">As shown in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we first tokenize unpaired text into phoneme sequences and then replicate each token a fixed or random number of times to get an upsampled sequence <math id="S3.p2.1.m1.3" class="ltx_Math" alttext="\mathbf{Y}^{\text{phn}}=\{y^{\text{phn}}_{1},\ldots,y^{\text{phn}}_{I}\}" display="inline"><semantics id="S3.p2.1.m1.3a"><mrow id="S3.p2.1.m1.3.3" xref="S3.p2.1.m1.3.3.cmml"><msup id="S3.p2.1.m1.3.3.4" xref="S3.p2.1.m1.3.3.4.cmml"><mi id="S3.p2.1.m1.3.3.4.2" xref="S3.p2.1.m1.3.3.4.2.cmml">𝐘</mi><mtext id="S3.p2.1.m1.3.3.4.3" xref="S3.p2.1.m1.3.3.4.3a.cmml">phn</mtext></msup><mo id="S3.p2.1.m1.3.3.3" xref="S3.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S3.p2.1.m1.3.3.2.2" xref="S3.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.3.3.2.2.3" xref="S3.p2.1.m1.3.3.2.3.cmml">{</mo><msubsup id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.2.2" xref="S3.p2.1.m1.2.2.1.1.1.2.2.cmml">y</mi><mn id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn><mtext id="S3.p2.1.m1.2.2.1.1.1.2.3" xref="S3.p2.1.m1.2.2.1.1.1.2.3a.cmml">phn</mtext></msubsup><mo id="S3.p2.1.m1.3.3.2.2.4" xref="S3.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.p2.1.m1.3.3.2.2.5" xref="S3.p2.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.p2.1.m1.3.3.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.p2.1.m1.3.3.2.2.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.2.2.cmml">y</mi><mi id="S3.p2.1.m1.3.3.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.3.cmml">I</mi><mtext id="S3.p2.1.m1.3.3.2.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.2.3a.cmml">phn</mtext></msubsup><mo stretchy="false" id="S3.p2.1.m1.3.3.2.2.6" xref="S3.p2.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.3b"><apply id="S3.p2.1.m1.3.3.cmml" xref="S3.p2.1.m1.3.3"><eq id="S3.p2.1.m1.3.3.3.cmml" xref="S3.p2.1.m1.3.3.3"></eq><apply id="S3.p2.1.m1.3.3.4.cmml" xref="S3.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.4.1.cmml" xref="S3.p2.1.m1.3.3.4">superscript</csymbol><ci id="S3.p2.1.m1.3.3.4.2.cmml" xref="S3.p2.1.m1.3.3.4.2">𝐘</ci><ci id="S3.p2.1.m1.3.3.4.3a.cmml" xref="S3.p2.1.m1.3.3.4.3"><mtext mathsize="70%" id="S3.p2.1.m1.3.3.4.3.cmml" xref="S3.p2.1.m1.3.3.4.3">phn</mtext></ci></apply><set id="S3.p2.1.m1.3.3.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2"><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2.2">𝑦</ci><ci id="S3.p2.1.m1.2.2.1.1.1.2.3a.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S3.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2.3">phn</mtext></ci></apply><cn type="integer" id="S3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">…</ci><apply id="S3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2.2">𝑦</ci><ci id="S3.p2.1.m1.3.3.2.2.2.2.3a.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S3.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2.3">phn</mtext></ci></apply><ci id="S3.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3">𝐼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.3c">\mathbf{Y}^{\text{phn}}=\{y^{\text{phn}}_{1},\ldots,y^{\text{phn}}_{I}\}</annotation></semantics></math>.
<math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{phn}}" display="inline"><semantics id="S3.p2.2.m2.1a"><msup id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">𝐘</mi><mtext id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3a.cmml">phn</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝐘</ci><ci id="S3.p2.2.m2.1.1.3a.cmml" xref="S3.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">phn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathbf{Y}^{\text{phn}}</annotation></semantics></math> is then fed into a phoneme encoder to generate phoneme embeddings <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{E}^{\text{phn}}\in\mathbb{R}^{I\times d}" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><msup id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml"><mi id="S3.p2.3.m3.1.1.2.2" xref="S3.p2.3.m3.1.1.2.2.cmml">𝐄</mi><mtext id="S3.p2.3.m3.1.1.2.3" xref="S3.p2.3.m3.1.1.2.3a.cmml">phn</mtext></msup><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.3.2" xref="S3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p2.3.m3.1.1.3.3" xref="S3.p2.3.m3.1.1.3.3.cmml"><mi id="S3.p2.3.m3.1.1.3.3.2" xref="S3.p2.3.m3.1.1.3.3.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.3.m3.1.1.3.3.1" xref="S3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.p2.3.m3.1.1.3.3.3" xref="S3.p2.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><in id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></in><apply id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.2.1.cmml" xref="S3.p2.3.m3.1.1.2">superscript</csymbol><ci id="S3.p2.3.m3.1.1.2.2.cmml" xref="S3.p2.3.m3.1.1.2.2">𝐄</ci><ci id="S3.p2.3.m3.1.1.2.3a.cmml" xref="S3.p2.3.m3.1.1.2.3"><mtext mathsize="70%" id="S3.p2.3.m3.1.1.2.3.cmml" xref="S3.p2.3.m3.1.1.2.3">phn</mtext></ci></apply><apply id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.p2.3.m3.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.p2.3.m3.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3"><times id="S3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.p2.3.m3.1.1.3.3.1"></times><ci id="S3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.p2.3.m3.1.1.3.3.2">𝐼</ci><ci id="S3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathbf{E}^{\text{phn}}\in\mathbb{R}^{I\times d}</annotation></semantics></math>.
To utilize unpaired text for neural biasing,
the phoneme embeddings need to be injected to an acoustic encoder layer <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="l^{\text{text}}" display="inline"><semantics id="S3.p2.4.m4.1a"><msup id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">l</mi><mtext id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑙</ci><ci id="S3.p2.4.m4.1.1.3a.cmml" xref="S3.p2.4.m4.1.1.3"><mtext mathsize="70%" id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">l^{\text{text}}</annotation></semantics></math> that precedes the biasing layer <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">l</annotation></semantics></math>, i.e., <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="l^{\text{text}}&lt;l" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><msup id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml"><mi id="S3.p2.6.m6.1.1.2.2" xref="S3.p2.6.m6.1.1.2.2.cmml">l</mi><mtext id="S3.p2.6.m6.1.1.2.3" xref="S3.p2.6.m6.1.1.2.3a.cmml">text</mtext></msup><mo id="S3.p2.6.m6.1.1.1" xref="S3.p2.6.m6.1.1.1.cmml">&lt;</mo><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><lt id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1"></lt><apply id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.2.1.cmml" xref="S3.p2.6.m6.1.1.2">superscript</csymbol><ci id="S3.p2.6.m6.1.1.2.2.cmml" xref="S3.p2.6.m6.1.1.2.2">𝑙</ci><ci id="S3.p2.6.m6.1.1.2.3a.cmml" xref="S3.p2.6.m6.1.1.2.3"><mtext mathsize="70%" id="S3.p2.6.m6.1.1.2.3.cmml" xref="S3.p2.6.m6.1.1.2.3">text</mtext></ci></apply><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">l^{\text{text}}&lt;l</annotation></semantics></math>. Therefore, different from JOIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, the masking in CTI has to be performed after the biasing layer instead of before the phoneme encoder.
We propagate <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{E}^{\text{phn}}" display="inline"><semantics id="S3.p2.7.m7.1a"><msup id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">𝐄</mi><mtext id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3a.cmml">phn</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">superscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝐄</ci><ci id="S3.p2.7.m7.1.1.3a.cmml" xref="S3.p2.7.m7.1.1.3"><mtext mathsize="70%" id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">phn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\mathbf{E}^{\text{phn}}</annotation></semantics></math> through layer <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="l^{\text{text}}" display="inline"><semantics id="S3.p2.8.m8.1a"><msup id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">l</mi><mtext id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">superscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑙</ci><ci id="S3.p2.8.m8.1.1.3a.cmml" xref="S3.p2.8.m8.1.1.3"><mtext mathsize="70%" id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">l^{\text{text}}</annotation></semantics></math> to layer <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">l</annotation></semantics></math> of the acoustic encoder to generate <em id="S3.p2.10.1" class="ltx_emph ltx_font_italic">text-based</em> acoustic embeddings <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}\in\mathbb{R}^{I\times d}" display="inline"><semantics id="S3.p2.10.m10.1a"><mrow id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml"><msubsup id="S3.p2.10.m10.1.1.2" xref="S3.p2.10.m10.1.1.2.cmml"><mi id="S3.p2.10.m10.1.1.2.2.2" xref="S3.p2.10.m10.1.1.2.2.2.cmml">𝐇</mi><mi id="S3.p2.10.m10.1.1.2.3" xref="S3.p2.10.m10.1.1.2.3.cmml">l</mi><mtext id="S3.p2.10.m10.1.1.2.2.3" xref="S3.p2.10.m10.1.1.2.2.3a.cmml">text</mtext></msubsup><mo id="S3.p2.10.m10.1.1.1" xref="S3.p2.10.m10.1.1.1.cmml">∈</mo><msup id="S3.p2.10.m10.1.1.3" xref="S3.p2.10.m10.1.1.3.cmml"><mi id="S3.p2.10.m10.1.1.3.2" xref="S3.p2.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p2.10.m10.1.1.3.3" xref="S3.p2.10.m10.1.1.3.3.cmml"><mi id="S3.p2.10.m10.1.1.3.3.2" xref="S3.p2.10.m10.1.1.3.3.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.10.m10.1.1.3.3.1" xref="S3.p2.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.p2.10.m10.1.1.3.3.3" xref="S3.p2.10.m10.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><apply id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1"><in id="S3.p2.10.m10.1.1.1.cmml" xref="S3.p2.10.m10.1.1.1"></in><apply id="S3.p2.10.m10.1.1.2.cmml" xref="S3.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.2.1.cmml" xref="S3.p2.10.m10.1.1.2">subscript</csymbol><apply id="S3.p2.10.m10.1.1.2.2.cmml" xref="S3.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.2.2.1.cmml" xref="S3.p2.10.m10.1.1.2">superscript</csymbol><ci id="S3.p2.10.m10.1.1.2.2.2.cmml" xref="S3.p2.10.m10.1.1.2.2.2">𝐇</ci><ci id="S3.p2.10.m10.1.1.2.2.3a.cmml" xref="S3.p2.10.m10.1.1.2.2.3"><mtext mathsize="70%" id="S3.p2.10.m10.1.1.2.2.3.cmml" xref="S3.p2.10.m10.1.1.2.2.3">text</mtext></ci></apply><ci id="S3.p2.10.m10.1.1.2.3.cmml" xref="S3.p2.10.m10.1.1.2.3">𝑙</ci></apply><apply id="S3.p2.10.m10.1.1.3.cmml" xref="S3.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.3.1.cmml" xref="S3.p2.10.m10.1.1.3">superscript</csymbol><ci id="S3.p2.10.m10.1.1.3.2.cmml" xref="S3.p2.10.m10.1.1.3.2">ℝ</ci><apply id="S3.p2.10.m10.1.1.3.3.cmml" xref="S3.p2.10.m10.1.1.3.3"><times id="S3.p2.10.m10.1.1.3.3.1.cmml" xref="S3.p2.10.m10.1.1.3.3.1"></times><ci id="S3.p2.10.m10.1.1.3.3.2.cmml" xref="S3.p2.10.m10.1.1.3.3.2">𝐼</ci><ci id="S3.p2.10.m10.1.1.3.3.3.cmml" xref="S3.p2.10.m10.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">\mathbf{H}^{\text{text}}_{l}\in\mathbb{R}^{I\times d}</annotation></semantics></math>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.12" class="ltx_p">Each text sentence <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S3.p3.1.m1.1a"><msup id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝐘</mi><mtext id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝐘</ci><ci id="S3.p3.1.m1.1.1.3a.cmml" xref="S3.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math> is associated with <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">N</annotation></semantics></math> bias phrases <math id="S3.p3.3.m3.3" class="ltx_Math" alttext="Z^{\text{text}}=\{z^{\text{text}}_{1},\ldots,z^{\text{text}}_{N}\}" display="inline"><semantics id="S3.p3.3.m3.3a"><mrow id="S3.p3.3.m3.3.3" xref="S3.p3.3.m3.3.3.cmml"><msup id="S3.p3.3.m3.3.3.4" xref="S3.p3.3.m3.3.3.4.cmml"><mi id="S3.p3.3.m3.3.3.4.2" xref="S3.p3.3.m3.3.3.4.2.cmml">Z</mi><mtext id="S3.p3.3.m3.3.3.4.3" xref="S3.p3.3.m3.3.3.4.3a.cmml">text</mtext></msup><mo id="S3.p3.3.m3.3.3.3" xref="S3.p3.3.m3.3.3.3.cmml">=</mo><mrow id="S3.p3.3.m3.3.3.2.2" xref="S3.p3.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.p3.3.m3.3.3.2.2.3" xref="S3.p3.3.m3.3.3.2.3.cmml">{</mo><msubsup id="S3.p3.3.m3.2.2.1.1.1" xref="S3.p3.3.m3.2.2.1.1.1.cmml"><mi id="S3.p3.3.m3.2.2.1.1.1.2.2" xref="S3.p3.3.m3.2.2.1.1.1.2.2.cmml">z</mi><mn id="S3.p3.3.m3.2.2.1.1.1.3" xref="S3.p3.3.m3.2.2.1.1.1.3.cmml">1</mn><mtext id="S3.p3.3.m3.2.2.1.1.1.2.3" xref="S3.p3.3.m3.2.2.1.1.1.2.3a.cmml">text</mtext></msubsup><mo id="S3.p3.3.m3.3.3.2.2.4" xref="S3.p3.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">…</mi><mo id="S3.p3.3.m3.3.3.2.2.5" xref="S3.p3.3.m3.3.3.2.3.cmml">,</mo><msubsup id="S3.p3.3.m3.3.3.2.2.2" xref="S3.p3.3.m3.3.3.2.2.2.cmml"><mi id="S3.p3.3.m3.3.3.2.2.2.2.2" xref="S3.p3.3.m3.3.3.2.2.2.2.2.cmml">z</mi><mi id="S3.p3.3.m3.3.3.2.2.2.3" xref="S3.p3.3.m3.3.3.2.2.2.3.cmml">N</mi><mtext id="S3.p3.3.m3.3.3.2.2.2.2.3" xref="S3.p3.3.m3.3.3.2.2.2.2.3a.cmml">text</mtext></msubsup><mo stretchy="false" id="S3.p3.3.m3.3.3.2.2.6" xref="S3.p3.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.3b"><apply id="S3.p3.3.m3.3.3.cmml" xref="S3.p3.3.m3.3.3"><eq id="S3.p3.3.m3.3.3.3.cmml" xref="S3.p3.3.m3.3.3.3"></eq><apply id="S3.p3.3.m3.3.3.4.cmml" xref="S3.p3.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.p3.3.m3.3.3.4.1.cmml" xref="S3.p3.3.m3.3.3.4">superscript</csymbol><ci id="S3.p3.3.m3.3.3.4.2.cmml" xref="S3.p3.3.m3.3.3.4.2">𝑍</ci><ci id="S3.p3.3.m3.3.3.4.3a.cmml" xref="S3.p3.3.m3.3.3.4.3"><mtext mathsize="70%" id="S3.p3.3.m3.3.3.4.3.cmml" xref="S3.p3.3.m3.3.3.4.3">text</mtext></ci></apply><set id="S3.p3.3.m3.3.3.2.3.cmml" xref="S3.p3.3.m3.3.3.2.2"><apply id="S3.p3.3.m3.2.2.1.1.1.cmml" xref="S3.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.p3.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.p3.3.m3.2.2.1.1.1.2.cmml" xref="S3.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.p3.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S3.p3.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.p3.3.m3.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.p3.3.m3.2.2.1.1.1.2.3a.cmml" xref="S3.p3.3.m3.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S3.p3.3.m3.2.2.1.1.1.2.3.cmml" xref="S3.p3.3.m3.2.2.1.1.1.2.3">text</mtext></ci></apply><cn type="integer" id="S3.p3.3.m3.2.2.1.1.1.3.cmml" xref="S3.p3.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">…</ci><apply id="S3.p3.3.m3.3.3.2.2.2.cmml" xref="S3.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.3.3.2.2.2.1.cmml" xref="S3.p3.3.m3.3.3.2.2.2">subscript</csymbol><apply id="S3.p3.3.m3.3.3.2.2.2.2.cmml" xref="S3.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.p3.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S3.p3.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.p3.3.m3.3.3.2.2.2.2.2">𝑧</ci><ci id="S3.p3.3.m3.3.3.2.2.2.2.3a.cmml" xref="S3.p3.3.m3.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S3.p3.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.p3.3.m3.3.3.2.2.2.2.3">text</mtext></ci></apply><ci id="S3.p3.3.m3.3.3.2.2.2.3.cmml" xref="S3.p3.3.m3.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.3c">Z^{\text{text}}=\{z^{\text{text}}_{1},\ldots,z^{\text{text}}_{N}\}</annotation></semantics></math>, sampled from sentences within <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S3.p3.4.m4.1a"><msup id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">𝐘</mi><mtext id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">superscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝐘</ci><ci id="S3.p3.4.m4.1.1.3a.cmml" xref="S3.p3.4.m4.1.1.3"><mtext mathsize="70%" id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math>'s training mini-batch. <math id="S3.p3.5.m5.1" class="ltx_Math" alttext="z^{\text{text}}_{n}" display="inline"><semantics id="S3.p3.5.m5.1a"><msubsup id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2.2" xref="S3.p3.5.m5.1.1.2.2.cmml">z</mi><mi id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">n</mi><mtext id="S3.p3.5.m5.1.1.2.3" xref="S3.p3.5.m5.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1">subscript</csymbol><apply id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1">superscript</csymbol><ci id="S3.p3.5.m5.1.1.2.2.cmml" xref="S3.p3.5.m5.1.1.2.2">𝑧</ci><ci id="S3.p3.5.m5.1.1.2.3a.cmml" xref="S3.p3.5.m5.1.1.2.3"><mtext mathsize="70%" id="S3.p3.5.m5.1.1.2.3.cmml" xref="S3.p3.5.m5.1.1.2.3">text</mtext></ci></apply><ci id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">z^{\text{text}}_{n}</annotation></semantics></math> may or may not exist in <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S3.p3.6.m6.1a"><msup id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml">𝐘</mi><mtext id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">superscript</csymbol><ci id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2">𝐘</ci><ci id="S3.p3.6.m6.1.1.3a.cmml" xref="S3.p3.6.m6.1.1.3"><mtext mathsize="70%" id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math>.
<math id="S3.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p3.7.m7.1a"><msubsup id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2.2" xref="S3.p3.7.m7.1.1.2.2.cmml">𝐇</mi><mi id="S3.p3.7.m7.1.1.3" xref="S3.p3.7.m7.1.1.3.cmml">l</mi><mtext id="S3.p3.7.m7.1.1.2.3" xref="S3.p3.7.m7.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1">subscript</csymbol><apply id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.1.2.1.cmml" xref="S3.p3.7.m7.1.1">superscript</csymbol><ci id="S3.p3.7.m7.1.1.2.2.cmml" xref="S3.p3.7.m7.1.1.2.2">𝐇</ci><ci id="S3.p3.7.m7.1.1.2.3a.cmml" xref="S3.p3.7.m7.1.1.2.3"><mtext mathsize="70%" id="S3.p3.7.m7.1.1.2.3.cmml" xref="S3.p3.7.m7.1.1.2.3">text</mtext></ci></apply><ci id="S3.p3.7.m7.1.1.3.cmml" xref="S3.p3.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> and <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p3.8.m8.1a"><msup id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><mi id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml">Z</mi><mtext id="S3.p3.8.m8.1.1.3" xref="S3.p3.8.m8.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1">superscript</csymbol><ci id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2">𝑍</ci><ci id="S3.p3.8.m8.1.1.3a.cmml" xref="S3.p3.8.m8.1.1.3"><mtext mathsize="70%" id="S3.p3.8.m8.1.1.3.cmml" xref="S3.p3.8.m8.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">Z^{\text{text}}</annotation></semantics></math> undergo the two-pass contextual biasing procedure similar to Section <a href="#S2.SS2" title="2.2 Neural Contextual Biasing with Deferred NAM ‣ 2 Related Work ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>.
In Pass 1, correlations between <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p3.9.m9.1a"><msubsup id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml"><mi id="S3.p3.9.m9.1.1.2.2" xref="S3.p3.9.m9.1.1.2.2.cmml">𝐇</mi><mi id="S3.p3.9.m9.1.1.3" xref="S3.p3.9.m9.1.1.3.cmml">l</mi><mtext id="S3.p3.9.m9.1.1.2.3" xref="S3.p3.9.m9.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><apply id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.1.cmml" xref="S3.p3.9.m9.1.1">subscript</csymbol><apply id="S3.p3.9.m9.1.1.2.cmml" xref="S3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.2.1.cmml" xref="S3.p3.9.m9.1.1">superscript</csymbol><ci id="S3.p3.9.m9.1.1.2.2.cmml" xref="S3.p3.9.m9.1.1.2.2">𝐇</ci><ci id="S3.p3.9.m9.1.1.2.3a.cmml" xref="S3.p3.9.m9.1.1.2.3"><mtext mathsize="70%" id="S3.p3.9.m9.1.1.2.3.cmml" xref="S3.p3.9.m9.1.1.2.3">text</mtext></ci></apply><ci id="S3.p3.9.m9.1.1.3.cmml" xref="S3.p3.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> and <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p3.10.m10.1a"><msup id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mi id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml">Z</mi><mtext id="S3.p3.10.m10.1.1.3" xref="S3.p3.10.m10.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1">superscript</csymbol><ci id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2">𝑍</ci><ci id="S3.p3.10.m10.1.1.3a.cmml" xref="S3.p3.10.m10.1.1.3"><mtext mathsize="70%" id="S3.p3.10.m10.1.1.3.cmml" xref="S3.p3.10.m10.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">Z^{\text{text}}</annotation></semantics></math> are used to select the top-K bias phrases for each text sentence and to compute a retrieval loss. In Pass 2, cross-attention between <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p3.11.m11.1a"><msubsup id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml"><mi id="S3.p3.11.m11.1.1.2.2" xref="S3.p3.11.m11.1.1.2.2.cmml">𝐇</mi><mi id="S3.p3.11.m11.1.1.3" xref="S3.p3.11.m11.1.1.3.cmml">l</mi><mtext id="S3.p3.11.m11.1.1.2.3" xref="S3.p3.11.m11.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.1.cmml" xref="S3.p3.11.m11.1.1">subscript</csymbol><apply id="S3.p3.11.m11.1.1.2.cmml" xref="S3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.2.1.cmml" xref="S3.p3.11.m11.1.1">superscript</csymbol><ci id="S3.p3.11.m11.1.1.2.2.cmml" xref="S3.p3.11.m11.1.1.2.2">𝐇</ci><ci id="S3.p3.11.m11.1.1.2.3a.cmml" xref="S3.p3.11.m11.1.1.2.3"><mtext mathsize="70%" id="S3.p3.11.m11.1.1.2.3.cmml" xref="S3.p3.11.m11.1.1.2.3">text</mtext></ci></apply><ci id="S3.p3.11.m11.1.1.3.cmml" xref="S3.p3.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> and only the selected bias phrases is computed to generate <em id="S3.p3.12.1" class="ltx_emph ltx_font_italic">text-based</em> biased acoustic embeddings <math id="S3.p3.12.m12.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text, bias}}_{l}" display="inline"><semantics id="S3.p3.12.m12.1a"><msubsup id="S3.p3.12.m12.1.1" xref="S3.p3.12.m12.1.1.cmml"><mi id="S3.p3.12.m12.1.1.2.2" xref="S3.p3.12.m12.1.1.2.2.cmml">𝐇</mi><mi id="S3.p3.12.m12.1.1.3" xref="S3.p3.12.m12.1.1.3.cmml">l</mi><mtext id="S3.p3.12.m12.1.1.2.3" xref="S3.p3.12.m12.1.1.2.3a.cmml">text, bias</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.12.m12.1b"><apply id="S3.p3.12.m12.1.1.cmml" xref="S3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.1.cmml" xref="S3.p3.12.m12.1.1">subscript</csymbol><apply id="S3.p3.12.m12.1.1.2.cmml" xref="S3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.2.1.cmml" xref="S3.p3.12.m12.1.1">superscript</csymbol><ci id="S3.p3.12.m12.1.1.2.2.cmml" xref="S3.p3.12.m12.1.1.2.2">𝐇</ci><ci id="S3.p3.12.m12.1.1.2.3a.cmml" xref="S3.p3.12.m12.1.1.2.3"><mtext mathsize="70%" id="S3.p3.12.m12.1.1.2.3.cmml" xref="S3.p3.12.m12.1.1.2.3">text, bias</mtext></ci></apply><ci id="S3.p3.12.m12.1.1.3.cmml" xref="S3.p3.12.m12.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m12.1c">\mathbf{H}^{\text{text, bias}}_{l}</annotation></semantics></math>.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.7" class="ltx_p">Specifically, in Pass 1, we generate phrase embeddings <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{P}^{\text{text}}\in\mathbb{R}^{(N+1)\times d}" display="inline"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.2" xref="S3.p4.1.m1.1.2.cmml"><msup id="S3.p4.1.m1.1.2.2" xref="S3.p4.1.m1.1.2.2.cmml"><mi id="S3.p4.1.m1.1.2.2.2" xref="S3.p4.1.m1.1.2.2.2.cmml">𝐏</mi><mtext id="S3.p4.1.m1.1.2.2.3" xref="S3.p4.1.m1.1.2.2.3a.cmml">text</mtext></msup><mo id="S3.p4.1.m1.1.2.1" xref="S3.p4.1.m1.1.2.1.cmml">∈</mo><msup id="S3.p4.1.m1.1.2.3" xref="S3.p4.1.m1.1.2.3.cmml"><mi id="S3.p4.1.m1.1.2.3.2" xref="S3.p4.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.p4.1.m1.1.1.1" xref="S3.p4.1.m1.1.1.1.cmml"><mrow id="S3.p4.1.m1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p4.1.m1.1.1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p4.1.m1.1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S3.p4.1.m1.1.1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.p4.1.m1.1.1.1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.p4.1.m1.1.1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.p4.1.m1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.p4.1.m1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.2.cmml" xref="S3.p4.1.m1.1.2"><in id="S3.p4.1.m1.1.2.1.cmml" xref="S3.p4.1.m1.1.2.1"></in><apply id="S3.p4.1.m1.1.2.2.cmml" xref="S3.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.2.2.1.cmml" xref="S3.p4.1.m1.1.2.2">superscript</csymbol><ci id="S3.p4.1.m1.1.2.2.2.cmml" xref="S3.p4.1.m1.1.2.2.2">𝐏</ci><ci id="S3.p4.1.m1.1.2.2.3a.cmml" xref="S3.p4.1.m1.1.2.2.3"><mtext mathsize="70%" id="S3.p4.1.m1.1.2.2.3.cmml" xref="S3.p4.1.m1.1.2.2.3">text</mtext></ci></apply><apply id="S3.p4.1.m1.1.2.3.cmml" xref="S3.p4.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.2.3.1.cmml" xref="S3.p4.1.m1.1.2.3">superscript</csymbol><ci id="S3.p4.1.m1.1.2.3.2.cmml" xref="S3.p4.1.m1.1.2.3.2">ℝ</ci><apply id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1"><times id="S3.p4.1.m1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.2"></times><apply id="S3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1"><plus id="S3.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.1"></plus><ci id="S3.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S3.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.p4.1.m1.1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathbf{P}^{\text{text}}\in\mathbb{R}^{(N+1)\times d}</annotation></semantics></math> by feeding <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p4.2.m2.1a"><msup id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">Z</mi><mtext id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑍</ci><ci id="S3.p4.2.m2.1.1.3a.cmml" xref="S3.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">Z^{\text{text}}</annotation></semantics></math> into the phrase encoder and appending a <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">d</annotation></semantics></math>-dim NO_BIAS embedding to the output. We then calculate <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{a}^{\text{text}}\in\mathbb{R}^{N+1}" display="inline"><semantics id="S3.p4.4.m4.1a"><mrow id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><msup id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml"><mi id="S3.p4.4.m4.1.1.2.2" xref="S3.p4.4.m4.1.1.2.2.cmml">𝐚</mi><mtext id="S3.p4.4.m4.1.1.2.3" xref="S3.p4.4.m4.1.1.2.3a.cmml">text</mtext></msup><mo id="S3.p4.4.m4.1.1.1" xref="S3.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml"><mi id="S3.p4.4.m4.1.1.3.2" xref="S3.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p4.4.m4.1.1.3.3" xref="S3.p4.4.m4.1.1.3.3.cmml"><mi id="S3.p4.4.m4.1.1.3.3.2" xref="S3.p4.4.m4.1.1.3.3.2.cmml">N</mi><mo id="S3.p4.4.m4.1.1.3.3.1" xref="S3.p4.4.m4.1.1.3.3.1.cmml">+</mo><mn id="S3.p4.4.m4.1.1.3.3.3" xref="S3.p4.4.m4.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><in id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1.1"></in><apply id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.2.1.cmml" xref="S3.p4.4.m4.1.1.2">superscript</csymbol><ci id="S3.p4.4.m4.1.1.2.2.cmml" xref="S3.p4.4.m4.1.1.2.2">𝐚</ci><ci id="S3.p4.4.m4.1.1.2.3a.cmml" xref="S3.p4.4.m4.1.1.2.3"><mtext mathsize="70%" id="S3.p4.4.m4.1.1.2.3.cmml" xref="S3.p4.4.m4.1.1.2.3">text</mtext></ci></apply><apply id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.3.1.cmml" xref="S3.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.p4.4.m4.1.1.3.2.cmml" xref="S3.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.p4.4.m4.1.1.3.3.cmml" xref="S3.p4.4.m4.1.1.3.3"><plus id="S3.p4.4.m4.1.1.3.3.1.cmml" xref="S3.p4.4.m4.1.1.3.3.1"></plus><ci id="S3.p4.4.m4.1.1.3.3.2.cmml" xref="S3.p4.4.m4.1.1.3.3.2">𝑁</ci><cn type="integer" id="S3.p4.4.m4.1.1.3.3.3.cmml" xref="S3.p4.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\mathbf{a}^{\text{text}}\in\mathbb{R}^{N+1}</annotation></semantics></math> by max-pooling the correlations between <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p4.5.m5.1a"><msubsup id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2.2" xref="S3.p4.5.m5.1.1.2.2.cmml">𝐇</mi><mi id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">l</mi><mtext id="S3.p4.5.m5.1.1.2.3" xref="S3.p4.5.m5.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">subscript</csymbol><apply id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.2.1.cmml" xref="S3.p4.5.m5.1.1">superscript</csymbol><ci id="S3.p4.5.m5.1.1.2.2.cmml" xref="S3.p4.5.m5.1.1.2.2">𝐇</ci><ci id="S3.p4.5.m5.1.1.2.3a.cmml" xref="S3.p4.5.m5.1.1.2.3"><mtext mathsize="70%" id="S3.p4.5.m5.1.1.2.3.cmml" xref="S3.p4.5.m5.1.1.2.3">text</mtext></ci></apply><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> and <math id="S3.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{P}^{\text{text}}" display="inline"><semantics id="S3.p4.6.m6.1a"><msup id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><mi id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml">𝐏</mi><mtext id="S3.p4.6.m6.1.1.3" xref="S3.p4.6.m6.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1">superscript</csymbol><ci id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2">𝐏</ci><ci id="S3.p4.6.m6.1.1.3a.cmml" xref="S3.p4.6.m6.1.1.3"><mtext mathsize="70%" id="S3.p4.6.m6.1.1.3.cmml" xref="S3.p4.6.m6.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">\mathbf{P}^{\text{text}}</annotation></semantics></math> over <math id="S3.p4.7.m7.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.p4.7.m7.1a"><mi id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><ci id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">I</annotation></semantics></math>:
</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\displaystyle\mathbf{a}^{\text{text}}=\text{MaxPool}_{i=1}^{I}\left(\mathbf{h}^{\text{text}}_{l,i}{\mathbf{P}^{\text{text}}}^{\top}/\sqrt{d}\right)," display="inline"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msup id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">𝐚</mi><mtext id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3a.cmml">text</mtext></msup><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><msubsup id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml"><mtext id="S3.E3.m1.3.3.1.1.1.3.2.2" xref="S3.E3.m1.3.3.1.1.1.3.2.2a.cmml">MaxPool</mtext><mrow id="S3.E3.m1.3.3.1.1.1.3.2.3" xref="S3.E3.m1.3.3.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.3.2.3.2" xref="S3.E3.m1.3.3.1.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.1.1.1.3.2.3.1" xref="S3.E3.m1.3.3.1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.1.1.1.3.2.3.3" xref="S3.E3.m1.3.3.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.3.3.cmml">I</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">l</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">i</mi></mrow><mtext id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3a.cmml">text</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml">​</mo><mmultiscripts id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.2.cmml">𝐏</mi><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3a" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml"></mrow><mtext id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3a.cmml">text</mtext><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3b" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml"></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">⊤</mo></mmultiscripts></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml">/</mo><msqrt id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></eq><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">𝐚</ci><ci id="S3.E3.m1.3.3.1.1.3.3a.cmml" xref="S3.E3.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3">text</mtext></ci></apply><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.3.2.2a.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.2"><mtext id="S3.E3.m1.3.3.1.1.1.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.2">MaxPool</mtext></ci><apply id="S3.E3.m1.3.3.1.1.1.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.3"><eq id="S3.E3.m1.3.3.1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.3.1"></eq><ci id="S3.E3.m1.3.3.1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.3.3.1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><divide id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1"></divide><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝐡</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3">text</mtext></ci></apply><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑙</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.2">𝐏</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3a.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3"><mtext mathsize="70%" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.2.3">text</mtext></ci></apply><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.3">top</csymbol></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"><root id="S3.E3.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"></root><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle\mathbf{a}^{\text{text}}=\text{MaxPool}_{i=1}^{I}\left(\mathbf{h}^{\text{text}}_{l,i}{\mathbf{P}^{\text{text}}}^{\top}/\sqrt{d}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.21" class="ltx_p">where <math id="S3.p4.8.m1.1" class="ltx_Math" alttext="\mathbf{a}^{\text{text}}" display="inline"><semantics id="S3.p4.8.m1.1a"><msup id="S3.p4.8.m1.1.1" xref="S3.p4.8.m1.1.1.cmml"><mi id="S3.p4.8.m1.1.1.2" xref="S3.p4.8.m1.1.1.2.cmml">𝐚</mi><mtext id="S3.p4.8.m1.1.1.3" xref="S3.p4.8.m1.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.8.m1.1b"><apply id="S3.p4.8.m1.1.1.cmml" xref="S3.p4.8.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m1.1.1.1.cmml" xref="S3.p4.8.m1.1.1">superscript</csymbol><ci id="S3.p4.8.m1.1.1.2.cmml" xref="S3.p4.8.m1.1.1.2">𝐚</ci><ci id="S3.p4.8.m1.1.1.3a.cmml" xref="S3.p4.8.m1.1.1.3"><mtext mathsize="70%" id="S3.p4.8.m1.1.1.3.cmml" xref="S3.p4.8.m1.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m1.1c">\mathbf{a}^{\text{text}}</annotation></semantics></math> signifies the correlations between <math id="S3.p4.9.m2.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p4.9.m2.1a"><msubsup id="S3.p4.9.m2.1.1" xref="S3.p4.9.m2.1.1.cmml"><mi id="S3.p4.9.m2.1.1.2.2" xref="S3.p4.9.m2.1.1.2.2.cmml">𝐇</mi><mi id="S3.p4.9.m2.1.1.3" xref="S3.p4.9.m2.1.1.3.cmml">l</mi><mtext id="S3.p4.9.m2.1.1.2.3" xref="S3.p4.9.m2.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.9.m2.1b"><apply id="S3.p4.9.m2.1.1.cmml" xref="S3.p4.9.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m2.1.1.1.cmml" xref="S3.p4.9.m2.1.1">subscript</csymbol><apply id="S3.p4.9.m2.1.1.2.cmml" xref="S3.p4.9.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m2.1.1.2.1.cmml" xref="S3.p4.9.m2.1.1">superscript</csymbol><ci id="S3.p4.9.m2.1.1.2.2.cmml" xref="S3.p4.9.m2.1.1.2.2">𝐇</ci><ci id="S3.p4.9.m2.1.1.2.3a.cmml" xref="S3.p4.9.m2.1.1.2.3"><mtext mathsize="70%" id="S3.p4.9.m2.1.1.2.3.cmml" xref="S3.p4.9.m2.1.1.2.3">text</mtext></ci></apply><ci id="S3.p4.9.m2.1.1.3.cmml" xref="S3.p4.9.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m2.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> and each bias phrase (and NO_BIAS) in <math id="S3.p4.10.m3.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.p4.10.m3.1a"><mi id="S3.p4.10.m3.1.1" xref="S3.p4.10.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.p4.10.m3.1b"><ci id="S3.p4.10.m3.1.1.cmml" xref="S3.p4.10.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m3.1c">Z</annotation></semantics></math>.
From set <math id="S3.p4.11.m4.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p4.11.m4.1a"><msup id="S3.p4.11.m4.1.1" xref="S3.p4.11.m4.1.1.cmml"><mi id="S3.p4.11.m4.1.1.2" xref="S3.p4.11.m4.1.1.2.cmml">Z</mi><mtext id="S3.p4.11.m4.1.1.3" xref="S3.p4.11.m4.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.11.m4.1b"><apply id="S3.p4.11.m4.1.1.cmml" xref="S3.p4.11.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.11.m4.1.1.1.cmml" xref="S3.p4.11.m4.1.1">superscript</csymbol><ci id="S3.p4.11.m4.1.1.2.cmml" xref="S3.p4.11.m4.1.1.2">𝑍</ci><ci id="S3.p4.11.m4.1.1.3a.cmml" xref="S3.p4.11.m4.1.1.3"><mtext mathsize="70%" id="S3.p4.11.m4.1.1.3.cmml" xref="S3.p4.11.m4.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m4.1c">Z^{\text{text}}</annotation></semantics></math>, we select the top-K bias phrases that have the K largest correlation values in <math id="S3.p4.12.m5.1" class="ltx_Math" alttext="\mathbf{a}^{\text{text}}" display="inline"><semantics id="S3.p4.12.m5.1a"><msup id="S3.p4.12.m5.1.1" xref="S3.p4.12.m5.1.1.cmml"><mi id="S3.p4.12.m5.1.1.2" xref="S3.p4.12.m5.1.1.2.cmml">𝐚</mi><mtext id="S3.p4.12.m5.1.1.3" xref="S3.p4.12.m5.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.12.m5.1b"><apply id="S3.p4.12.m5.1.1.cmml" xref="S3.p4.12.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.12.m5.1.1.1.cmml" xref="S3.p4.12.m5.1.1">superscript</csymbol><ci id="S3.p4.12.m5.1.1.2.cmml" xref="S3.p4.12.m5.1.1.2">𝐚</ci><ci id="S3.p4.12.m5.1.1.3a.cmml" xref="S3.p4.12.m5.1.1.3"><mtext mathsize="70%" id="S3.p4.12.m5.1.1.3.cmml" xref="S3.p4.12.m5.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.12.m5.1c">\mathbf{a}^{\text{text}}</annotation></semantics></math>, and tokenize them into word-pieces <math id="S3.p4.13.m6.3" class="ltx_Math" alttext="Z^{\text{text, w}}=\{z^{\text{text, w}}_{1},\ldots,z^{\text{text, w}}_{M}\}" display="inline"><semantics id="S3.p4.13.m6.3a"><mrow id="S3.p4.13.m6.3.3" xref="S3.p4.13.m6.3.3.cmml"><msup id="S3.p4.13.m6.3.3.4" xref="S3.p4.13.m6.3.3.4.cmml"><mi id="S3.p4.13.m6.3.3.4.2" xref="S3.p4.13.m6.3.3.4.2.cmml">Z</mi><mtext id="S3.p4.13.m6.3.3.4.3" xref="S3.p4.13.m6.3.3.4.3a.cmml">text, w</mtext></msup><mo id="S3.p4.13.m6.3.3.3" xref="S3.p4.13.m6.3.3.3.cmml">=</mo><mrow id="S3.p4.13.m6.3.3.2.2" xref="S3.p4.13.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.p4.13.m6.3.3.2.2.3" xref="S3.p4.13.m6.3.3.2.3.cmml">{</mo><msubsup id="S3.p4.13.m6.2.2.1.1.1" xref="S3.p4.13.m6.2.2.1.1.1.cmml"><mi id="S3.p4.13.m6.2.2.1.1.1.2.2" xref="S3.p4.13.m6.2.2.1.1.1.2.2.cmml">z</mi><mn id="S3.p4.13.m6.2.2.1.1.1.3" xref="S3.p4.13.m6.2.2.1.1.1.3.cmml">1</mn><mtext id="S3.p4.13.m6.2.2.1.1.1.2.3" xref="S3.p4.13.m6.2.2.1.1.1.2.3a.cmml">text, w</mtext></msubsup><mo id="S3.p4.13.m6.3.3.2.2.4" xref="S3.p4.13.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p4.13.m6.1.1" xref="S3.p4.13.m6.1.1.cmml">…</mi><mo id="S3.p4.13.m6.3.3.2.2.5" xref="S3.p4.13.m6.3.3.2.3.cmml">,</mo><msubsup id="S3.p4.13.m6.3.3.2.2.2" xref="S3.p4.13.m6.3.3.2.2.2.cmml"><mi id="S3.p4.13.m6.3.3.2.2.2.2.2" xref="S3.p4.13.m6.3.3.2.2.2.2.2.cmml">z</mi><mi id="S3.p4.13.m6.3.3.2.2.2.3" xref="S3.p4.13.m6.3.3.2.2.2.3.cmml">M</mi><mtext id="S3.p4.13.m6.3.3.2.2.2.2.3" xref="S3.p4.13.m6.3.3.2.2.2.2.3a.cmml">text, w</mtext></msubsup><mo stretchy="false" id="S3.p4.13.m6.3.3.2.2.6" xref="S3.p4.13.m6.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.13.m6.3b"><apply id="S3.p4.13.m6.3.3.cmml" xref="S3.p4.13.m6.3.3"><eq id="S3.p4.13.m6.3.3.3.cmml" xref="S3.p4.13.m6.3.3.3"></eq><apply id="S3.p4.13.m6.3.3.4.cmml" xref="S3.p4.13.m6.3.3.4"><csymbol cd="ambiguous" id="S3.p4.13.m6.3.3.4.1.cmml" xref="S3.p4.13.m6.3.3.4">superscript</csymbol><ci id="S3.p4.13.m6.3.3.4.2.cmml" xref="S3.p4.13.m6.3.3.4.2">𝑍</ci><ci id="S3.p4.13.m6.3.3.4.3a.cmml" xref="S3.p4.13.m6.3.3.4.3"><mtext mathsize="70%" id="S3.p4.13.m6.3.3.4.3.cmml" xref="S3.p4.13.m6.3.3.4.3">text, w</mtext></ci></apply><set id="S3.p4.13.m6.3.3.2.3.cmml" xref="S3.p4.13.m6.3.3.2.2"><apply id="S3.p4.13.m6.2.2.1.1.1.cmml" xref="S3.p4.13.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p4.13.m6.2.2.1.1.1.1.cmml" xref="S3.p4.13.m6.2.2.1.1.1">subscript</csymbol><apply id="S3.p4.13.m6.2.2.1.1.1.2.cmml" xref="S3.p4.13.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p4.13.m6.2.2.1.1.1.2.1.cmml" xref="S3.p4.13.m6.2.2.1.1.1">superscript</csymbol><ci id="S3.p4.13.m6.2.2.1.1.1.2.2.cmml" xref="S3.p4.13.m6.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.p4.13.m6.2.2.1.1.1.2.3a.cmml" xref="S3.p4.13.m6.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S3.p4.13.m6.2.2.1.1.1.2.3.cmml" xref="S3.p4.13.m6.2.2.1.1.1.2.3">text, w</mtext></ci></apply><cn type="integer" id="S3.p4.13.m6.2.2.1.1.1.3.cmml" xref="S3.p4.13.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.p4.13.m6.1.1.cmml" xref="S3.p4.13.m6.1.1">…</ci><apply id="S3.p4.13.m6.3.3.2.2.2.cmml" xref="S3.p4.13.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p4.13.m6.3.3.2.2.2.1.cmml" xref="S3.p4.13.m6.3.3.2.2.2">subscript</csymbol><apply id="S3.p4.13.m6.3.3.2.2.2.2.cmml" xref="S3.p4.13.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p4.13.m6.3.3.2.2.2.2.1.cmml" xref="S3.p4.13.m6.3.3.2.2.2">superscript</csymbol><ci id="S3.p4.13.m6.3.3.2.2.2.2.2.cmml" xref="S3.p4.13.m6.3.3.2.2.2.2.2">𝑧</ci><ci id="S3.p4.13.m6.3.3.2.2.2.2.3a.cmml" xref="S3.p4.13.m6.3.3.2.2.2.2.3"><mtext mathsize="70%" id="S3.p4.13.m6.3.3.2.2.2.2.3.cmml" xref="S3.p4.13.m6.3.3.2.2.2.2.3">text, w</mtext></ci></apply><ci id="S3.p4.13.m6.3.3.2.2.2.3.cmml" xref="S3.p4.13.m6.3.3.2.2.2.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.13.m6.3c">Z^{\text{text, w}}=\{z^{\text{text, w}}_{1},\ldots,z^{\text{text, w}}_{M}\}</annotation></semantics></math>, <math id="S3.p4.14.m7.1" class="ltx_Math" alttext="M\geq K" display="inline"><semantics id="S3.p4.14.m7.1a"><mrow id="S3.p4.14.m7.1.1" xref="S3.p4.14.m7.1.1.cmml"><mi id="S3.p4.14.m7.1.1.2" xref="S3.p4.14.m7.1.1.2.cmml">M</mi><mo id="S3.p4.14.m7.1.1.1" xref="S3.p4.14.m7.1.1.1.cmml">≥</mo><mi id="S3.p4.14.m7.1.1.3" xref="S3.p4.14.m7.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.14.m7.1b"><apply id="S3.p4.14.m7.1.1.cmml" xref="S3.p4.14.m7.1.1"><geq id="S3.p4.14.m7.1.1.1.cmml" xref="S3.p4.14.m7.1.1.1"></geq><ci id="S3.p4.14.m7.1.1.2.cmml" xref="S3.p4.14.m7.1.1.2">𝑀</ci><ci id="S3.p4.14.m7.1.1.3.cmml" xref="S3.p4.14.m7.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.14.m7.1c">M\geq K</annotation></semantics></math>.
In Pass 2, <math id="S3.p4.15.m8.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p4.15.m8.1a"><msubsup id="S3.p4.15.m8.1.1" xref="S3.p4.15.m8.1.1.cmml"><mi id="S3.p4.15.m8.1.1.2.2" xref="S3.p4.15.m8.1.1.2.2.cmml">𝐇</mi><mi id="S3.p4.15.m8.1.1.3" xref="S3.p4.15.m8.1.1.3.cmml">l</mi><mtext id="S3.p4.15.m8.1.1.2.3" xref="S3.p4.15.m8.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.15.m8.1b"><apply id="S3.p4.15.m8.1.1.cmml" xref="S3.p4.15.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.15.m8.1.1.1.cmml" xref="S3.p4.15.m8.1.1">subscript</csymbol><apply id="S3.p4.15.m8.1.1.2.cmml" xref="S3.p4.15.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.15.m8.1.1.2.1.cmml" xref="S3.p4.15.m8.1.1">superscript</csymbol><ci id="S3.p4.15.m8.1.1.2.2.cmml" xref="S3.p4.15.m8.1.1.2.2">𝐇</ci><ci id="S3.p4.15.m8.1.1.2.3a.cmml" xref="S3.p4.15.m8.1.1.2.3"><mtext mathsize="70%" id="S3.p4.15.m8.1.1.2.3.cmml" xref="S3.p4.15.m8.1.1.2.3">text</mtext></ci></apply><ci id="S3.p4.15.m8.1.1.3.cmml" xref="S3.p4.15.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.15.m8.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math> first cross-attends into the word-piece embeddings <math id="S3.p4.16.m9.1" class="ltx_Math" alttext="\mathbf{W}^{\text{text}}\in\mathbb{R}^{M\times d}" display="inline"><semantics id="S3.p4.16.m9.1a"><mrow id="S3.p4.16.m9.1.1" xref="S3.p4.16.m9.1.1.cmml"><msup id="S3.p4.16.m9.1.1.2" xref="S3.p4.16.m9.1.1.2.cmml"><mi id="S3.p4.16.m9.1.1.2.2" xref="S3.p4.16.m9.1.1.2.2.cmml">𝐖</mi><mtext id="S3.p4.16.m9.1.1.2.3" xref="S3.p4.16.m9.1.1.2.3a.cmml">text</mtext></msup><mo id="S3.p4.16.m9.1.1.1" xref="S3.p4.16.m9.1.1.1.cmml">∈</mo><msup id="S3.p4.16.m9.1.1.3" xref="S3.p4.16.m9.1.1.3.cmml"><mi id="S3.p4.16.m9.1.1.3.2" xref="S3.p4.16.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p4.16.m9.1.1.3.3" xref="S3.p4.16.m9.1.1.3.3.cmml"><mi id="S3.p4.16.m9.1.1.3.3.2" xref="S3.p4.16.m9.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p4.16.m9.1.1.3.3.1" xref="S3.p4.16.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.p4.16.m9.1.1.3.3.3" xref="S3.p4.16.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.16.m9.1b"><apply id="S3.p4.16.m9.1.1.cmml" xref="S3.p4.16.m9.1.1"><in id="S3.p4.16.m9.1.1.1.cmml" xref="S3.p4.16.m9.1.1.1"></in><apply id="S3.p4.16.m9.1.1.2.cmml" xref="S3.p4.16.m9.1.1.2"><csymbol cd="ambiguous" id="S3.p4.16.m9.1.1.2.1.cmml" xref="S3.p4.16.m9.1.1.2">superscript</csymbol><ci id="S3.p4.16.m9.1.1.2.2.cmml" xref="S3.p4.16.m9.1.1.2.2">𝐖</ci><ci id="S3.p4.16.m9.1.1.2.3a.cmml" xref="S3.p4.16.m9.1.1.2.3"><mtext mathsize="70%" id="S3.p4.16.m9.1.1.2.3.cmml" xref="S3.p4.16.m9.1.1.2.3">text</mtext></ci></apply><apply id="S3.p4.16.m9.1.1.3.cmml" xref="S3.p4.16.m9.1.1.3"><csymbol cd="ambiguous" id="S3.p4.16.m9.1.1.3.1.cmml" xref="S3.p4.16.m9.1.1.3">superscript</csymbol><ci id="S3.p4.16.m9.1.1.3.2.cmml" xref="S3.p4.16.m9.1.1.3.2">ℝ</ci><apply id="S3.p4.16.m9.1.1.3.3.cmml" xref="S3.p4.16.m9.1.1.3.3"><times id="S3.p4.16.m9.1.1.3.3.1.cmml" xref="S3.p4.16.m9.1.1.3.3.1"></times><ci id="S3.p4.16.m9.1.1.3.3.2.cmml" xref="S3.p4.16.m9.1.1.3.3.2">𝑀</ci><ci id="S3.p4.16.m9.1.1.3.3.3.cmml" xref="S3.p4.16.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.16.m9.1c">\mathbf{W}^{\text{text}}\in\mathbb{R}^{M\times d}</annotation></semantics></math> of <math id="S3.p4.17.m10.1" class="ltx_Math" alttext="Z^{\text{text, w}}" display="inline"><semantics id="S3.p4.17.m10.1a"><msup id="S3.p4.17.m10.1.1" xref="S3.p4.17.m10.1.1.cmml"><mi id="S3.p4.17.m10.1.1.2" xref="S3.p4.17.m10.1.1.2.cmml">Z</mi><mtext id="S3.p4.17.m10.1.1.3" xref="S3.p4.17.m10.1.1.3a.cmml">text, w</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.17.m10.1b"><apply id="S3.p4.17.m10.1.1.cmml" xref="S3.p4.17.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.17.m10.1.1.1.cmml" xref="S3.p4.17.m10.1.1">superscript</csymbol><ci id="S3.p4.17.m10.1.1.2.cmml" xref="S3.p4.17.m10.1.1.2">𝑍</ci><ci id="S3.p4.17.m10.1.1.3a.cmml" xref="S3.p4.17.m10.1.1.3"><mtext mathsize="70%" id="S3.p4.17.m10.1.1.3.cmml" xref="S3.p4.17.m10.1.1.3">text, w</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.17.m10.1c">Z^{\text{text, w}}</annotation></semantics></math> to compute text-based context vectors <math id="S3.p4.18.m11.1" class="ltx_Math" alttext="\mathbf{C}^{\text{text}}\in\mathbb{R}^{I\times d}" display="inline"><semantics id="S3.p4.18.m11.1a"><mrow id="S3.p4.18.m11.1.1" xref="S3.p4.18.m11.1.1.cmml"><msup id="S3.p4.18.m11.1.1.2" xref="S3.p4.18.m11.1.1.2.cmml"><mi id="S3.p4.18.m11.1.1.2.2" xref="S3.p4.18.m11.1.1.2.2.cmml">𝐂</mi><mtext id="S3.p4.18.m11.1.1.2.3" xref="S3.p4.18.m11.1.1.2.3a.cmml">text</mtext></msup><mo id="S3.p4.18.m11.1.1.1" xref="S3.p4.18.m11.1.1.1.cmml">∈</mo><msup id="S3.p4.18.m11.1.1.3" xref="S3.p4.18.m11.1.1.3.cmml"><mi id="S3.p4.18.m11.1.1.3.2" xref="S3.p4.18.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p4.18.m11.1.1.3.3" xref="S3.p4.18.m11.1.1.3.3.cmml"><mi id="S3.p4.18.m11.1.1.3.3.2" xref="S3.p4.18.m11.1.1.3.3.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p4.18.m11.1.1.3.3.1" xref="S3.p4.18.m11.1.1.3.3.1.cmml">×</mo><mi id="S3.p4.18.m11.1.1.3.3.3" xref="S3.p4.18.m11.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.18.m11.1b"><apply id="S3.p4.18.m11.1.1.cmml" xref="S3.p4.18.m11.1.1"><in id="S3.p4.18.m11.1.1.1.cmml" xref="S3.p4.18.m11.1.1.1"></in><apply id="S3.p4.18.m11.1.1.2.cmml" xref="S3.p4.18.m11.1.1.2"><csymbol cd="ambiguous" id="S3.p4.18.m11.1.1.2.1.cmml" xref="S3.p4.18.m11.1.1.2">superscript</csymbol><ci id="S3.p4.18.m11.1.1.2.2.cmml" xref="S3.p4.18.m11.1.1.2.2">𝐂</ci><ci id="S3.p4.18.m11.1.1.2.3a.cmml" xref="S3.p4.18.m11.1.1.2.3"><mtext mathsize="70%" id="S3.p4.18.m11.1.1.2.3.cmml" xref="S3.p4.18.m11.1.1.2.3">text</mtext></ci></apply><apply id="S3.p4.18.m11.1.1.3.cmml" xref="S3.p4.18.m11.1.1.3"><csymbol cd="ambiguous" id="S3.p4.18.m11.1.1.3.1.cmml" xref="S3.p4.18.m11.1.1.3">superscript</csymbol><ci id="S3.p4.18.m11.1.1.3.2.cmml" xref="S3.p4.18.m11.1.1.3.2">ℝ</ci><apply id="S3.p4.18.m11.1.1.3.3.cmml" xref="S3.p4.18.m11.1.1.3.3"><times id="S3.p4.18.m11.1.1.3.3.1.cmml" xref="S3.p4.18.m11.1.1.3.3.1"></times><ci id="S3.p4.18.m11.1.1.3.3.2.cmml" xref="S3.p4.18.m11.1.1.3.3.2">𝐼</ci><ci id="S3.p4.18.m11.1.1.3.3.3.cmml" xref="S3.p4.18.m11.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.18.m11.1c">\mathbf{C}^{\text{text}}\in\mathbb{R}^{I\times d}</annotation></semantics></math>. <math id="S3.p4.19.m12.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text, bias}}_{l}\in\mathbb{R}^{I\times d}" display="inline"><semantics id="S3.p4.19.m12.1a"><mrow id="S3.p4.19.m12.1.1" xref="S3.p4.19.m12.1.1.cmml"><msubsup id="S3.p4.19.m12.1.1.2" xref="S3.p4.19.m12.1.1.2.cmml"><mi id="S3.p4.19.m12.1.1.2.2.2" xref="S3.p4.19.m12.1.1.2.2.2.cmml">𝐇</mi><mi id="S3.p4.19.m12.1.1.2.3" xref="S3.p4.19.m12.1.1.2.3.cmml">l</mi><mtext id="S3.p4.19.m12.1.1.2.2.3" xref="S3.p4.19.m12.1.1.2.2.3a.cmml">text, bias</mtext></msubsup><mo id="S3.p4.19.m12.1.1.1" xref="S3.p4.19.m12.1.1.1.cmml">∈</mo><msup id="S3.p4.19.m12.1.1.3" xref="S3.p4.19.m12.1.1.3.cmml"><mi id="S3.p4.19.m12.1.1.3.2" xref="S3.p4.19.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p4.19.m12.1.1.3.3" xref="S3.p4.19.m12.1.1.3.3.cmml"><mi id="S3.p4.19.m12.1.1.3.3.2" xref="S3.p4.19.m12.1.1.3.3.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p4.19.m12.1.1.3.3.1" xref="S3.p4.19.m12.1.1.3.3.1.cmml">×</mo><mi id="S3.p4.19.m12.1.1.3.3.3" xref="S3.p4.19.m12.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.19.m12.1b"><apply id="S3.p4.19.m12.1.1.cmml" xref="S3.p4.19.m12.1.1"><in id="S3.p4.19.m12.1.1.1.cmml" xref="S3.p4.19.m12.1.1.1"></in><apply id="S3.p4.19.m12.1.1.2.cmml" xref="S3.p4.19.m12.1.1.2"><csymbol cd="ambiguous" id="S3.p4.19.m12.1.1.2.1.cmml" xref="S3.p4.19.m12.1.1.2">subscript</csymbol><apply id="S3.p4.19.m12.1.1.2.2.cmml" xref="S3.p4.19.m12.1.1.2"><csymbol cd="ambiguous" id="S3.p4.19.m12.1.1.2.2.1.cmml" xref="S3.p4.19.m12.1.1.2">superscript</csymbol><ci id="S3.p4.19.m12.1.1.2.2.2.cmml" xref="S3.p4.19.m12.1.1.2.2.2">𝐇</ci><ci id="S3.p4.19.m12.1.1.2.2.3a.cmml" xref="S3.p4.19.m12.1.1.2.2.3"><mtext mathsize="70%" id="S3.p4.19.m12.1.1.2.2.3.cmml" xref="S3.p4.19.m12.1.1.2.2.3">text, bias</mtext></ci></apply><ci id="S3.p4.19.m12.1.1.2.3.cmml" xref="S3.p4.19.m12.1.1.2.3">𝑙</ci></apply><apply id="S3.p4.19.m12.1.1.3.cmml" xref="S3.p4.19.m12.1.1.3"><csymbol cd="ambiguous" id="S3.p4.19.m12.1.1.3.1.cmml" xref="S3.p4.19.m12.1.1.3">superscript</csymbol><ci id="S3.p4.19.m12.1.1.3.2.cmml" xref="S3.p4.19.m12.1.1.3.2">ℝ</ci><apply id="S3.p4.19.m12.1.1.3.3.cmml" xref="S3.p4.19.m12.1.1.3.3"><times id="S3.p4.19.m12.1.1.3.3.1.cmml" xref="S3.p4.19.m12.1.1.3.3.1"></times><ci id="S3.p4.19.m12.1.1.3.3.2.cmml" xref="S3.p4.19.m12.1.1.3.3.2">𝐼</ci><ci id="S3.p4.19.m12.1.1.3.3.3.cmml" xref="S3.p4.19.m12.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.19.m12.1c">\mathbf{H}^{\text{text, bias}}_{l}\in\mathbb{R}^{I\times d}</annotation></semantics></math> is then obtained by adding <math id="S3.p4.20.m13.1" class="ltx_Math" alttext="\mathbf{C}^{\text{text}}" display="inline"><semantics id="S3.p4.20.m13.1a"><msup id="S3.p4.20.m13.1.1" xref="S3.p4.20.m13.1.1.cmml"><mi id="S3.p4.20.m13.1.1.2" xref="S3.p4.20.m13.1.1.2.cmml">𝐂</mi><mtext id="S3.p4.20.m13.1.1.3" xref="S3.p4.20.m13.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.20.m13.1b"><apply id="S3.p4.20.m13.1.1.cmml" xref="S3.p4.20.m13.1.1"><csymbol cd="ambiguous" id="S3.p4.20.m13.1.1.1.cmml" xref="S3.p4.20.m13.1.1">superscript</csymbol><ci id="S3.p4.20.m13.1.1.2.cmml" xref="S3.p4.20.m13.1.1.2">𝐂</ci><ci id="S3.p4.20.m13.1.1.3a.cmml" xref="S3.p4.20.m13.1.1.3"><mtext mathsize="70%" id="S3.p4.20.m13.1.1.3.cmml" xref="S3.p4.20.m13.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.20.m13.1c">\mathbf{C}^{\text{text}}</annotation></semantics></math> to <math id="S3.p4.21.m14.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text}}_{l}" display="inline"><semantics id="S3.p4.21.m14.1a"><msubsup id="S3.p4.21.m14.1.1" xref="S3.p4.21.m14.1.1.cmml"><mi id="S3.p4.21.m14.1.1.2.2" xref="S3.p4.21.m14.1.1.2.2.cmml">𝐇</mi><mi id="S3.p4.21.m14.1.1.3" xref="S3.p4.21.m14.1.1.3.cmml">l</mi><mtext id="S3.p4.21.m14.1.1.2.3" xref="S3.p4.21.m14.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.21.m14.1b"><apply id="S3.p4.21.m14.1.1.cmml" xref="S3.p4.21.m14.1.1"><csymbol cd="ambiguous" id="S3.p4.21.m14.1.1.1.cmml" xref="S3.p4.21.m14.1.1">subscript</csymbol><apply id="S3.p4.21.m14.1.1.2.cmml" xref="S3.p4.21.m14.1.1"><csymbol cd="ambiguous" id="S3.p4.21.m14.1.1.2.1.cmml" xref="S3.p4.21.m14.1.1">superscript</csymbol><ci id="S3.p4.21.m14.1.1.2.2.cmml" xref="S3.p4.21.m14.1.1.2.2">𝐇</ci><ci id="S3.p4.21.m14.1.1.2.3a.cmml" xref="S3.p4.21.m14.1.1.2.3"><mtext mathsize="70%" id="S3.p4.21.m14.1.1.2.3.cmml" xref="S3.p4.21.m14.1.1.2.3">text</mtext></ci></apply><ci id="S3.p4.21.m14.1.1.3.cmml" xref="S3.p4.21.m14.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.21.m14.1c">\mathbf{H}^{\text{text}}_{l}</annotation></semantics></math>:</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{C}^{\text{text}}=\text{CrossAttention}(Q=\mathbf{H}^{\text{text}}_{l};K,V=\mathbf{W}^{\text{text}})," display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msup id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">𝐂</mi><mtext id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3a.cmml">text</mtext></msup><mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mtext id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3a.cmml">CrossAttention</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">Q</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">text</mtext></msubsup><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">K</mi></mrow></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.1.cmml">=</mo><msup id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.2.cmml">𝐖</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3a.cmml">text</mtext></msup></mrow></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"></eq><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">𝐂</ci><ci id="S3.E4.m1.2.2.1.1.3.3a.cmml" xref="S3.E4.m1.2.2.1.1.3.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3">text</mtext></ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></times><ci id="S3.E4.m1.2.2.1.1.1.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.3"><mtext id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">CrossAttention</mtext></ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1"><eq id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2"></eq><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3">𝑄</ci><list id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">text</mtext></ci></apply><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝐾</ci></list></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2"><eq id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.1"></eq><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.2">𝑉</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.2">𝐖</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.3.3">text</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle\mathbf{C}^{\text{text}}=\text{CrossAttention}(Q=\mathbf{H}^{\text{text}}_{l};K,V=\mathbf{W}^{\text{text}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{H}^{\text{text, bias}}_{l}=\mathbf{H}^{\text{text}}_{l}+\lambda_{c}\mathbf{C}^{\text{text}}," display="inline"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.cmml">𝐇</mi><mi id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml">l</mi><mtext id="S3.E5.m1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3a.cmml">text, bias</mtext></msubsup><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><msubsup id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.2.cmml">𝐇</mi><mi id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml">l</mi><mtext id="S3.E5.m1.1.1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.1.1.3.2.2.3a.cmml">text</mtext></msubsup><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="S3.E5.m1.1.1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><msup id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.cmml">𝐂</mi><mtext id="S3.E5.m1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3a.cmml">text</mtext></msup></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2">𝐇</ci><ci id="S3.E5.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E5.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3">text, bias</mtext></ci></apply><ci id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.2">𝐇</ci><ci id="S3.E5.m1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E5.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.3">text</mtext></ci></apply><ci id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><times id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1"></times><apply id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E5.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2.3">𝑐</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2">𝐂</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3a.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3"><mtext mathsize="70%" id="S3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3">text</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\mathbf{H}^{\text{text, bias}}_{l}=\mathbf{H}^{\text{text}}_{l}+\lambda_{c}\mathbf{C}^{\text{text}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.22" class="ltx_p">where <math id="S3.p4.22.m1.1" class="ltx_Math" alttext="\lambda_{c}\in\mathbb{R}" display="inline"><semantics id="S3.p4.22.m1.1a"><mrow id="S3.p4.22.m1.1.1" xref="S3.p4.22.m1.1.1.cmml"><msub id="S3.p4.22.m1.1.1.2" xref="S3.p4.22.m1.1.1.2.cmml"><mi id="S3.p4.22.m1.1.1.2.2" xref="S3.p4.22.m1.1.1.2.2.cmml">λ</mi><mi id="S3.p4.22.m1.1.1.2.3" xref="S3.p4.22.m1.1.1.2.3.cmml">c</mi></msub><mo id="S3.p4.22.m1.1.1.1" xref="S3.p4.22.m1.1.1.1.cmml">∈</mo><mi id="S3.p4.22.m1.1.1.3" xref="S3.p4.22.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.22.m1.1b"><apply id="S3.p4.22.m1.1.1.cmml" xref="S3.p4.22.m1.1.1"><in id="S3.p4.22.m1.1.1.1.cmml" xref="S3.p4.22.m1.1.1.1"></in><apply id="S3.p4.22.m1.1.1.2.cmml" xref="S3.p4.22.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p4.22.m1.1.1.2.1.cmml" xref="S3.p4.22.m1.1.1.2">subscript</csymbol><ci id="S3.p4.22.m1.1.1.2.2.cmml" xref="S3.p4.22.m1.1.1.2.2">𝜆</ci><ci id="S3.p4.22.m1.1.1.2.3.cmml" xref="S3.p4.22.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.p4.22.m1.1.1.3.cmml" xref="S3.p4.22.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.22.m1.1c">\lambda_{c}\in\mathbb{R}</annotation></semantics></math> is the biasing strength.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.4" class="ltx_p">To make the task sufficiently difficult for the model with text input,
we mask a portion of text-based biased acoustic embeddings <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}}" display="inline"><semantics id="S3.p5.1.m1.1a"><msubsup id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi id="S3.p5.1.m1.1.1.2.2" xref="S3.p5.1.m1.1.1.2.2.cmml">𝐇</mi><msup id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml"><mi id="S3.p5.1.m1.1.1.3.2" xref="S3.p5.1.m1.1.1.3.2.cmml">l</mi><mtext id="S3.p5.1.m1.1.1.3.3" xref="S3.p5.1.m1.1.1.3.3a.cmml">mask</mtext></msup><mtext id="S3.p5.1.m1.1.1.2.3" xref="S3.p5.1.m1.1.1.2.3a.cmml">text, bias</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">subscript</csymbol><apply id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.2.1.cmml" xref="S3.p5.1.m1.1.1">superscript</csymbol><ci id="S3.p5.1.m1.1.1.2.2.cmml" xref="S3.p5.1.m1.1.1.2.2">𝐇</ci><ci id="S3.p5.1.m1.1.1.2.3a.cmml" xref="S3.p5.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.p5.1.m1.1.1.2.3.cmml" xref="S3.p5.1.m1.1.1.2.3">text, bias</mtext></ci></apply><apply id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.3.1.cmml" xref="S3.p5.1.m1.1.1.3">superscript</csymbol><ci id="S3.p5.1.m1.1.1.3.2.cmml" xref="S3.p5.1.m1.1.1.3.2">𝑙</ci><ci id="S3.p5.1.m1.1.1.3.3a.cmml" xref="S3.p5.1.m1.1.1.3.3"><mtext mathsize="50%" id="S3.p5.1.m1.1.1.3.3.cmml" xref="S3.p5.1.m1.1.1.3.3">mask</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}}</annotation></semantics></math> at layer <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="l^{\text{mask}}" display="inline"><semantics id="S3.p5.2.m2.1a"><msup id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">l</mi><mtext id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3a.cmml">mask</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">superscript</csymbol><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝑙</ci><ci id="S3.p5.2.m2.1.1.3a.cmml" xref="S3.p5.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3">mask</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">l^{\text{mask}}</annotation></semantics></math>
after the biasing layer <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p5.3.m3.1a"><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">l</annotation></semantics></math>, i.e., <math id="S3.p5.4.m4.1" class="ltx_Math" alttext="l^{\text{mask}}&gt;l" display="inline"><semantics id="S3.p5.4.m4.1a"><mrow id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><msup id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml"><mi id="S3.p5.4.m4.1.1.2.2" xref="S3.p5.4.m4.1.1.2.2.cmml">l</mi><mtext id="S3.p5.4.m4.1.1.2.3" xref="S3.p5.4.m4.1.1.2.3a.cmml">mask</mtext></msup><mo id="S3.p5.4.m4.1.1.1" xref="S3.p5.4.m4.1.1.1.cmml">&gt;</mo><mi id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><gt id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1.1"></gt><apply id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p5.4.m4.1.1.2.1.cmml" xref="S3.p5.4.m4.1.1.2">superscript</csymbol><ci id="S3.p5.4.m4.1.1.2.2.cmml" xref="S3.p5.4.m4.1.1.2.2">𝑙</ci><ci id="S3.p5.4.m4.1.1.2.3a.cmml" xref="S3.p5.4.m4.1.1.2.3"><mtext mathsize="70%" id="S3.p5.4.m4.1.1.2.3.cmml" xref="S3.p5.4.m4.1.1.2.3">mask</mtext></ci></apply><ci id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">l^{\text{mask}}&gt;l</annotation></semantics></math>, by following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.
The masked embeddings are then propagated through the rest of the transducer,
contributing to the calculation of a text-based transducer loss:
</p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\text{ASR}}(\mathcal{D}^{\text{text}})=-\log P(\mathbf{Y}^{\text{text}}|\text{Mask}(\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}}),Z^{\text{text}})." display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3a.cmml">ASR</mtext></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="S3.E6.m1.1.1.1.1.2a" xref="S3.E6.m1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.2.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.2.1.3" xref="S3.E6.m1.1.1.1.1.2.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.1.3.1" xref="S3.E6.m1.1.1.1.1.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.1.1.1.1.2.1.3a" xref="S3.E6.m1.1.1.1.1.2.1.3.cmml">⁡</mo><mi id="S3.E6.m1.1.1.1.1.2.1.3.2" xref="S3.E6.m1.1.1.1.1.2.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2.1.2" xref="S3.E6.m1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.2.1.1.1" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.2.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.2.cmml">𝐘</mi><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3a.cmml">text</mtext></msup><mo fence="false" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.3.cmml"><mrow id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3a.cmml">Mask</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><msup id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">mask</mtext></msup><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">text, bias</mtext></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml">Z</mi><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3a.cmml">text</mtext></msup></mrow></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"></eq><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3">ASR</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">text</mtext></ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><minus id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></minus><apply id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1"><times id="S3.E6.m1.1.1.1.1.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.2"></times><apply id="S3.E6.m1.1.1.1.1.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.3"><log id="S3.E6.m1.1.1.1.1.2.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.3.1"></log><ci id="S3.E6.m1.1.1.1.1.2.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.3.2">𝑃</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.3">conditional</csymbol><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.2">𝐘</ci><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.4.3">text</mtext></ci></apply><list id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2"><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3"><mtext id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.3">Mask</mtext></ci><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3">text, bias</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="50%" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3">mask</mtext></ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.2">𝑍</ci><ci id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.1.1.1.1.2.2.2.3">text</mtext></ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathcal{L}^{\text{ASR}}(\mathcal{D}^{\text{text}})=-\log P(\mathbf{Y}^{\text{text}}|\text{Mask}(\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}}),Z^{\text{text}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.p5.13" class="ltx_p">To accurately identify the K most relevant bias phrases from the unpaired text, we minimize a retrieval loss <math id="S3.p5.5.m1.1" class="ltx_Math" alttext="\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}})" display="inline"><semantics id="S3.p5.5.m1.1a"><mrow id="S3.p5.5.m1.1.1" xref="S3.p5.5.m1.1.1.cmml"><msup id="S3.p5.5.m1.1.1.3" xref="S3.p5.5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.5.m1.1.1.3.2" xref="S3.p5.5.m1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.p5.5.m1.1.1.3.3" xref="S3.p5.5.m1.1.1.3.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S3.p5.5.m1.1.1.2" xref="S3.p5.5.m1.1.1.2.cmml">​</mo><mrow id="S3.p5.5.m1.1.1.1.1" xref="S3.p5.5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p5.5.m1.1.1.1.1.2" xref="S3.p5.5.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.p5.5.m1.1.1.1.1.1" xref="S3.p5.5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.5.m1.1.1.1.1.1.2" xref="S3.p5.5.m1.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S3.p5.5.m1.1.1.1.1.1.3" xref="S3.p5.5.m1.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S3.p5.5.m1.1.1.1.1.3" xref="S3.p5.5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.5.m1.1b"><apply id="S3.p5.5.m1.1.1.cmml" xref="S3.p5.5.m1.1.1"><times id="S3.p5.5.m1.1.1.2.cmml" xref="S3.p5.5.m1.1.1.2"></times><apply id="S3.p5.5.m1.1.1.3.cmml" xref="S3.p5.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p5.5.m1.1.1.3.1.cmml" xref="S3.p5.5.m1.1.1.3">superscript</csymbol><ci id="S3.p5.5.m1.1.1.3.2.cmml" xref="S3.p5.5.m1.1.1.3.2">ℒ</ci><ci id="S3.p5.5.m1.1.1.3.3a.cmml" xref="S3.p5.5.m1.1.1.3.3"><mtext mathsize="70%" id="S3.p5.5.m1.1.1.3.3.cmml" xref="S3.p5.5.m1.1.1.3.3">retr</mtext></ci></apply><apply id="S3.p5.5.m1.1.1.1.1.1.cmml" xref="S3.p5.5.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p5.5.m1.1.1.1.1.1.1.cmml" xref="S3.p5.5.m1.1.1.1.1">superscript</csymbol><ci id="S3.p5.5.m1.1.1.1.1.1.2.cmml" xref="S3.p5.5.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.p5.5.m1.1.1.1.1.1.3a.cmml" xref="S3.p5.5.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.p5.5.m1.1.1.1.1.1.3.cmml" xref="S3.p5.5.m1.1.1.1.1.1.3">text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m1.1c">\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}})</annotation></semantics></math> computed as a cross-entropy between the correlation <math id="S3.p5.6.m2.1" class="ltx_Math" alttext="\mathbf{a}^{\text{text}}" display="inline"><semantics id="S3.p5.6.m2.1a"><msup id="S3.p5.6.m2.1.1" xref="S3.p5.6.m2.1.1.cmml"><mi id="S3.p5.6.m2.1.1.2" xref="S3.p5.6.m2.1.1.2.cmml">𝐚</mi><mtext id="S3.p5.6.m2.1.1.3" xref="S3.p5.6.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.6.m2.1b"><apply id="S3.p5.6.m2.1.1.cmml" xref="S3.p5.6.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.6.m2.1.1.1.cmml" xref="S3.p5.6.m2.1.1">superscript</csymbol><ci id="S3.p5.6.m2.1.1.2.cmml" xref="S3.p5.6.m2.1.1.2">𝐚</ci><ci id="S3.p5.6.m2.1.1.3a.cmml" xref="S3.p5.6.m2.1.1.3"><mtext mathsize="70%" id="S3.p5.6.m2.1.1.3.cmml" xref="S3.p5.6.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.m2.1c">\mathbf{a}^{\text{text}}</annotation></semantics></math> and ground-truth label <math id="S3.p5.7.m3.1" class="ltx_Math" alttext="r^{\text{text}}" display="inline"><semantics id="S3.p5.7.m3.1a"><msup id="S3.p5.7.m3.1.1" xref="S3.p5.7.m3.1.1.cmml"><mi id="S3.p5.7.m3.1.1.2" xref="S3.p5.7.m3.1.1.2.cmml">r</mi><mtext id="S3.p5.7.m3.1.1.3" xref="S3.p5.7.m3.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.7.m3.1b"><apply id="S3.p5.7.m3.1.1.cmml" xref="S3.p5.7.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.7.m3.1.1.1.cmml" xref="S3.p5.7.m3.1.1">superscript</csymbol><ci id="S3.p5.7.m3.1.1.2.cmml" xref="S3.p5.7.m3.1.1.2">𝑟</ci><ci id="S3.p5.7.m3.1.1.3a.cmml" xref="S3.p5.7.m3.1.1.3"><mtext mathsize="70%" id="S3.p5.7.m3.1.1.3.cmml" xref="S3.p5.7.m3.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.m3.1c">r^{\text{text}}</annotation></semantics></math>.
<math id="S3.p5.8.m4.1" class="ltx_Math" alttext="r^{\text{text}}" display="inline"><semantics id="S3.p5.8.m4.1a"><msup id="S3.p5.8.m4.1.1" xref="S3.p5.8.m4.1.1.cmml"><mi id="S3.p5.8.m4.1.1.2" xref="S3.p5.8.m4.1.1.2.cmml">r</mi><mtext id="S3.p5.8.m4.1.1.3" xref="S3.p5.8.m4.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.8.m4.1b"><apply id="S3.p5.8.m4.1.1.cmml" xref="S3.p5.8.m4.1.1"><csymbol cd="ambiguous" id="S3.p5.8.m4.1.1.1.cmml" xref="S3.p5.8.m4.1.1">superscript</csymbol><ci id="S3.p5.8.m4.1.1.2.cmml" xref="S3.p5.8.m4.1.1.2">𝑟</ci><ci id="S3.p5.8.m4.1.1.3a.cmml" xref="S3.p5.8.m4.1.1.3"><mtext mathsize="70%" id="S3.p5.8.m4.1.1.3.cmml" xref="S3.p5.8.m4.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.8.m4.1c">r^{\text{text}}</annotation></semantics></math> is assigned the longest bias phrase from <math id="S3.p5.9.m5.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S3.p5.9.m5.1a"><msup id="S3.p5.9.m5.1.1" xref="S3.p5.9.m5.1.1.cmml"><mi id="S3.p5.9.m5.1.1.2" xref="S3.p5.9.m5.1.1.2.cmml">Z</mi><mtext id="S3.p5.9.m5.1.1.3" xref="S3.p5.9.m5.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.9.m5.1b"><apply id="S3.p5.9.m5.1.1.cmml" xref="S3.p5.9.m5.1.1"><csymbol cd="ambiguous" id="S3.p5.9.m5.1.1.1.cmml" xref="S3.p5.9.m5.1.1">superscript</csymbol><ci id="S3.p5.9.m5.1.1.2.cmml" xref="S3.p5.9.m5.1.1.2">𝑍</ci><ci id="S3.p5.9.m5.1.1.3a.cmml" xref="S3.p5.9.m5.1.1.3"><mtext mathsize="70%" id="S3.p5.9.m5.1.1.3.cmml" xref="S3.p5.9.m5.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.9.m5.1c">Z^{\text{text}}</annotation></semantics></math> that appears in <math id="S3.p5.10.m6.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S3.p5.10.m6.1a"><msup id="S3.p5.10.m6.1.1" xref="S3.p5.10.m6.1.1.cmml"><mi id="S3.p5.10.m6.1.1.2" xref="S3.p5.10.m6.1.1.2.cmml">𝐘</mi><mtext id="S3.p5.10.m6.1.1.3" xref="S3.p5.10.m6.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.10.m6.1b"><apply id="S3.p5.10.m6.1.1.cmml" xref="S3.p5.10.m6.1.1"><csymbol cd="ambiguous" id="S3.p5.10.m6.1.1.1.cmml" xref="S3.p5.10.m6.1.1">superscript</csymbol><ci id="S3.p5.10.m6.1.1.2.cmml" xref="S3.p5.10.m6.1.1.2">𝐘</ci><ci id="S3.p5.10.m6.1.1.3a.cmml" xref="S3.p5.10.m6.1.1.3"><mtext mathsize="70%" id="S3.p5.10.m6.1.1.3.cmml" xref="S3.p5.10.m6.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.10.m6.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math>. Otherwise, <math id="S3.p5.11.m7.1" class="ltx_Math" alttext="r^{\text{text}}" display="inline"><semantics id="S3.p5.11.m7.1a"><msup id="S3.p5.11.m7.1.1" xref="S3.p5.11.m7.1.1.cmml"><mi id="S3.p5.11.m7.1.1.2" xref="S3.p5.11.m7.1.1.2.cmml">r</mi><mtext id="S3.p5.11.m7.1.1.3" xref="S3.p5.11.m7.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.11.m7.1b"><apply id="S3.p5.11.m7.1.1.cmml" xref="S3.p5.11.m7.1.1"><csymbol cd="ambiguous" id="S3.p5.11.m7.1.1.1.cmml" xref="S3.p5.11.m7.1.1">superscript</csymbol><ci id="S3.p5.11.m7.1.1.2.cmml" xref="S3.p5.11.m7.1.1.2">𝑟</ci><ci id="S3.p5.11.m7.1.1.3a.cmml" xref="S3.p5.11.m7.1.1.3"><mtext mathsize="70%" id="S3.p5.11.m7.1.1.3.cmml" xref="S3.p5.11.m7.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.11.m7.1c">r^{\text{text}}</annotation></semantics></math> is assigned NO_BIAS if none of the bias phrases are present in <math id="S3.p5.12.m8.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S3.p5.12.m8.1a"><msup id="S3.p5.12.m8.1.1" xref="S3.p5.12.m8.1.1.cmml"><mi id="S3.p5.12.m8.1.1.2" xref="S3.p5.12.m8.1.1.2.cmml">𝐘</mi><mtext id="S3.p5.12.m8.1.1.3" xref="S3.p5.12.m8.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p5.12.m8.1b"><apply id="S3.p5.12.m8.1.1.cmml" xref="S3.p5.12.m8.1.1"><csymbol cd="ambiguous" id="S3.p5.12.m8.1.1.1.cmml" xref="S3.p5.12.m8.1.1">superscript</csymbol><ci id="S3.p5.12.m8.1.1.2.cmml" xref="S3.p5.12.m8.1.1.2">𝐘</ci><ci id="S3.p5.12.m8.1.1.3a.cmml" xref="S3.p5.12.m8.1.1.3"><mtext mathsize="70%" id="S3.p5.12.m8.1.1.3.cmml" xref="S3.p5.12.m8.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.12.m8.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math>.
Similarly,
a word-piece retrieval loss based on the same unpaired text is computed and then added to <math id="S3.p5.13.m9.1" class="ltx_Math" alttext="\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}})" display="inline"><semantics id="S3.p5.13.m9.1a"><mrow id="S3.p5.13.m9.1.1" xref="S3.p5.13.m9.1.1.cmml"><msup id="S3.p5.13.m9.1.1.3" xref="S3.p5.13.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.13.m9.1.1.3.2" xref="S3.p5.13.m9.1.1.3.2.cmml">ℒ</mi><mtext id="S3.p5.13.m9.1.1.3.3" xref="S3.p5.13.m9.1.1.3.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S3.p5.13.m9.1.1.2" xref="S3.p5.13.m9.1.1.2.cmml">​</mo><mrow id="S3.p5.13.m9.1.1.1.1" xref="S3.p5.13.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p5.13.m9.1.1.1.1.2" xref="S3.p5.13.m9.1.1.1.1.1.cmml">(</mo><msup id="S3.p5.13.m9.1.1.1.1.1" xref="S3.p5.13.m9.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.13.m9.1.1.1.1.1.2" xref="S3.p5.13.m9.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S3.p5.13.m9.1.1.1.1.1.3" xref="S3.p5.13.m9.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S3.p5.13.m9.1.1.1.1.3" xref="S3.p5.13.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.13.m9.1b"><apply id="S3.p5.13.m9.1.1.cmml" xref="S3.p5.13.m9.1.1"><times id="S3.p5.13.m9.1.1.2.cmml" xref="S3.p5.13.m9.1.1.2"></times><apply id="S3.p5.13.m9.1.1.3.cmml" xref="S3.p5.13.m9.1.1.3"><csymbol cd="ambiguous" id="S3.p5.13.m9.1.1.3.1.cmml" xref="S3.p5.13.m9.1.1.3">superscript</csymbol><ci id="S3.p5.13.m9.1.1.3.2.cmml" xref="S3.p5.13.m9.1.1.3.2">ℒ</ci><ci id="S3.p5.13.m9.1.1.3.3a.cmml" xref="S3.p5.13.m9.1.1.3.3"><mtext mathsize="70%" id="S3.p5.13.m9.1.1.3.3.cmml" xref="S3.p5.13.m9.1.1.3.3">retr</mtext></ci></apply><apply id="S3.p5.13.m9.1.1.1.1.1.cmml" xref="S3.p5.13.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.p5.13.m9.1.1.1.1.1.1.cmml" xref="S3.p5.13.m9.1.1.1.1">superscript</csymbol><ci id="S3.p5.13.m9.1.1.1.1.1.2.cmml" xref="S3.p5.13.m9.1.1.1.1.1.2">𝒟</ci><ci id="S3.p5.13.m9.1.1.1.1.1.3a.cmml" xref="S3.p5.13.m9.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.p5.13.m9.1.1.1.1.1.3.cmml" xref="S3.p5.13.m9.1.1.1.1.1.3">text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.13.m9.1c">\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}})</annotation></semantics></math>.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.2" class="ltx_p">The speech transducer, phoneme encoder, and neural biaser are jointly trained
from scratch to minimize two ASR losses and two retrieval losses using audio-transcript paired data <math id="S3.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><ci id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">\mathcal{D}</annotation></semantics></math> and unpaired text <math id="S3.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{\text{text}}" display="inline"><semantics id="S3.p6.2.m2.1a"><msup id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p6.2.m2.1.1.2" xref="S3.p6.2.m2.1.1.2.cmml">𝒟</mi><mtext id="S3.p6.2.m2.1.1.3" xref="S3.p6.2.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p6.2.m2.1.1.1.cmml" xref="S3.p6.2.m2.1.1">superscript</csymbol><ci id="S3.p6.2.m2.1.1.2.cmml" xref="S3.p6.2.m2.1.1.2">𝒟</ci><ci id="S3.p6.2.m2.1.1.3a.cmml" xref="S3.p6.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p6.2.m2.1.1.3.cmml" xref="S3.p6.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">\mathcal{D}^{\text{text}}</annotation></semantics></math>:</p>
<table id="S6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\text{CTI}}=" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msup id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.2.2" xref="S3.Ex1.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.Ex1.m1.1.1.2.3" xref="S3.Ex1.m1.1.1.2.3a.cmml">CTI</mtext></msup><mo id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml">=</mo><mi id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"></eq><apply id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.2">superscript</csymbol><ci id="S3.Ex1.m1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.2.2">ℒ</ci><ci id="S3.Ex1.m1.1.1.2.3a.cmml" xref="S3.Ex1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.Ex1.m1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.2.3">CTI</mtext></ci></apply><csymbol cd="latexml" id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\mathcal{L}^{\text{CTI}}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.2" class="ltx_Math" alttext="\displaystyle\lambda_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D})+\lambda_{d}\mathcal{L}^{\text{retr}}(\mathcal{D})" display="inline"><semantics id="S3.Ex1.m2.2a"><mrow id="S3.Ex1.m2.2.3" xref="S3.Ex1.m2.2.3.cmml"><mrow id="S3.Ex1.m2.2.3.2" xref="S3.Ex1.m2.2.3.2.cmml"><msub id="S3.Ex1.m2.2.3.2.2" xref="S3.Ex1.m2.2.3.2.2.cmml"><mi id="S3.Ex1.m2.2.3.2.2.2" xref="S3.Ex1.m2.2.3.2.2.2.cmml">λ</mi><mi id="S3.Ex1.m2.2.3.2.2.3" xref="S3.Ex1.m2.2.3.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.3.2.1" xref="S3.Ex1.m2.2.3.2.1.cmml">​</mo><msup id="S3.Ex1.m2.2.3.2.3" xref="S3.Ex1.m2.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.2.3.2.3.2" xref="S3.Ex1.m2.2.3.2.3.2.cmml">ℒ</mi><mtext id="S3.Ex1.m2.2.3.2.3.3" xref="S3.Ex1.m2.2.3.2.3.3a.cmml">ASR</mtext></msup><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.3.2.1a" xref="S3.Ex1.m2.2.3.2.1.cmml">​</mo><mrow id="S3.Ex1.m2.2.3.2.4.2" xref="S3.Ex1.m2.2.3.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.3.2.4.2.1" xref="S3.Ex1.m2.2.3.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">𝒟</mi><mo stretchy="false" id="S3.Ex1.m2.2.3.2.4.2.2" xref="S3.Ex1.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.2.3.1" xref="S3.Ex1.m2.2.3.1.cmml">+</mo><mrow id="S3.Ex1.m2.2.3.3" xref="S3.Ex1.m2.2.3.3.cmml"><msub id="S3.Ex1.m2.2.3.3.2" xref="S3.Ex1.m2.2.3.3.2.cmml"><mi id="S3.Ex1.m2.2.3.3.2.2" xref="S3.Ex1.m2.2.3.3.2.2.cmml">λ</mi><mi id="S3.Ex1.m2.2.3.3.2.3" xref="S3.Ex1.m2.2.3.3.2.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.3.3.1" xref="S3.Ex1.m2.2.3.3.1.cmml">​</mo><msup id="S3.Ex1.m2.2.3.3.3" xref="S3.Ex1.m2.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.2.3.3.3.2" xref="S3.Ex1.m2.2.3.3.3.2.cmml">ℒ</mi><mtext id="S3.Ex1.m2.2.3.3.3.3" xref="S3.Ex1.m2.2.3.3.3.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.3.3.1a" xref="S3.Ex1.m2.2.3.3.1.cmml">​</mo><mrow id="S3.Ex1.m2.2.3.3.4.2" xref="S3.Ex1.m2.2.3.3.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.3.3.4.2.1" xref="S3.Ex1.m2.2.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.2.2" xref="S3.Ex1.m2.2.2.cmml">𝒟</mi><mo stretchy="false" id="S3.Ex1.m2.2.3.3.4.2.2" xref="S3.Ex1.m2.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.2b"><apply id="S3.Ex1.m2.2.3.cmml" xref="S3.Ex1.m2.2.3"><plus id="S3.Ex1.m2.2.3.1.cmml" xref="S3.Ex1.m2.2.3.1"></plus><apply id="S3.Ex1.m2.2.3.2.cmml" xref="S3.Ex1.m2.2.3.2"><times id="S3.Ex1.m2.2.3.2.1.cmml" xref="S3.Ex1.m2.2.3.2.1"></times><apply id="S3.Ex1.m2.2.3.2.2.cmml" xref="S3.Ex1.m2.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.3.2.2.1.cmml" xref="S3.Ex1.m2.2.3.2.2">subscript</csymbol><ci id="S3.Ex1.m2.2.3.2.2.2.cmml" xref="S3.Ex1.m2.2.3.2.2.2">𝜆</ci><ci id="S3.Ex1.m2.2.3.2.2.3.cmml" xref="S3.Ex1.m2.2.3.2.2.3">𝑎</ci></apply><apply id="S3.Ex1.m2.2.3.2.3.cmml" xref="S3.Ex1.m2.2.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.3.2.3.1.cmml" xref="S3.Ex1.m2.2.3.2.3">superscript</csymbol><ci id="S3.Ex1.m2.2.3.2.3.2.cmml" xref="S3.Ex1.m2.2.3.2.3.2">ℒ</ci><ci id="S3.Ex1.m2.2.3.2.3.3a.cmml" xref="S3.Ex1.m2.2.3.2.3.3"><mtext mathsize="70%" id="S3.Ex1.m2.2.3.2.3.3.cmml" xref="S3.Ex1.m2.2.3.2.3.3">ASR</mtext></ci></apply><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝒟</ci></apply><apply id="S3.Ex1.m2.2.3.3.cmml" xref="S3.Ex1.m2.2.3.3"><times id="S3.Ex1.m2.2.3.3.1.cmml" xref="S3.Ex1.m2.2.3.3.1"></times><apply id="S3.Ex1.m2.2.3.3.2.cmml" xref="S3.Ex1.m2.2.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.3.3.2.1.cmml" xref="S3.Ex1.m2.2.3.3.2">subscript</csymbol><ci id="S3.Ex1.m2.2.3.3.2.2.cmml" xref="S3.Ex1.m2.2.3.3.2.2">𝜆</ci><ci id="S3.Ex1.m2.2.3.3.2.3.cmml" xref="S3.Ex1.m2.2.3.3.2.3">𝑑</ci></apply><apply id="S3.Ex1.m2.2.3.3.3.cmml" xref="S3.Ex1.m2.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.3.3.3.1.cmml" xref="S3.Ex1.m2.2.3.3.3">superscript</csymbol><ci id="S3.Ex1.m2.2.3.3.3.2.cmml" xref="S3.Ex1.m2.2.3.3.3.2">ℒ</ci><ci id="S3.Ex1.m2.2.3.3.3.3a.cmml" xref="S3.Ex1.m2.2.3.3.3.3"><mtext mathsize="70%" id="S3.Ex1.m2.2.3.3.3.3.cmml" xref="S3.Ex1.m2.2.3.3.3.3">retr</mtext></ci></apply><ci id="S3.Ex1.m2.2.2.cmml" xref="S3.Ex1.m2.2.2">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.2c">\displaystyle\lambda_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D})+\lambda_{d}\mathcal{L}^{\text{retr}}(\mathcal{D})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle\quad+\lambda^{\text{text}}_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D}^{\text{text}})+\lambda^{\text{text}}_{d}\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}})." display="inline"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1a" xref="S3.E7.m1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.3.2.2.cmml">λ</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.3.3.cmml">a</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.1.1.3.2.3a.cmml">text</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E7.m1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.4.3" xref="S3.E7.m1.1.1.1.1.1.1.4.3a.cmml">ASR</mtext></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><msubsup id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.2.3.2.2" xref="S3.E7.m1.1.1.1.1.2.3.2.2.cmml">λ</mi><mi id="S3.E7.m1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.2.3.3.cmml">d</mi><mtext id="S3.E7.m1.1.1.1.1.2.3.2.3" xref="S3.E7.m1.1.1.1.1.2.3.2.3a.cmml">text</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml">​</mo><msup id="S3.E7.m1.1.1.1.1.2.4" xref="S3.E7.m1.1.1.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.2.4.2" xref="S3.E7.m1.1.1.1.1.2.4.2.cmml">ℒ</mi><mtext id="S3.E7.m1.1.1.1.1.2.4.3" xref="S3.E7.m1.1.1.1.1.2.4.3a.cmml">retr</mtext></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2a" xref="S3.E7.m1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.2.1.1" xref="S3.E7.m1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.2.1.1.2" xref="S3.E7.m1.1.1.1.1.2.1.1.1.cmml">(</mo><msup id="S3.E7.m1.1.1.1.1.2.1.1.1" xref="S3.E7.m1.1.1.1.1.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.2.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.1.1.1.2.cmml">𝒟</mi><mtext id="S3.E7.m1.1.1.1.1.2.1.1.1.3" xref="S3.E7.m1.1.1.1.1.2.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S3.E7.m1.1.1.1.1.2.1.1.3" xref="S3.E7.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"></plus><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1"></plus><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.2.2">𝜆</ci><ci id="S3.E7.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.2.3">text</mtext></ci></apply><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3">𝑎</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4.2">ℒ</ci><ci id="S3.E7.m1.1.1.1.1.1.1.4.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4.3">ASR</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3">text</mtext></ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><times id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2"></times><apply id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.3.2.2">𝜆</ci><ci id="S3.E7.m1.1.1.1.1.2.3.2.3a.cmml" xref="S3.E7.m1.1.1.1.1.2.3.2.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.2.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3.2.3">text</mtext></ci></apply><ci id="S3.E7.m1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3.3">𝑑</ci></apply><apply id="S3.E7.m1.1.1.1.1.2.4.cmml" xref="S3.E7.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.4.1.cmml" xref="S3.E7.m1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.4.2.cmml" xref="S3.E7.m1.1.1.1.1.2.4.2">ℒ</ci><ci id="S3.E7.m1.1.1.1.1.2.4.3a.cmml" xref="S3.E7.m1.1.1.1.1.2.4.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.2.4.3.cmml" xref="S3.E7.m1.1.1.1.1.2.4.3">retr</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.2.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.2.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2.1.1.1.2">𝒟</ci><ci id="S3.E7.m1.1.1.1.1.2.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.2.1.1.1.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.2.1.1.1.3">text</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\quad+\lambda^{\text{text}}_{a}\mathcal{L}^{\text{ASR}}(\mathcal{D}^{\text{text}})+\lambda^{\text{text}}_{d}\mathcal{L}^{\text{retr}}(\mathcal{D}^{\text{text}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.p6.3" class="ltx_p">where <math id="S3.p6.3.m1.2" class="ltx_Math" alttext="\lambda^{\text{text}}_{a},\lambda^{\text{text}}_{d}\in\mathbb{R}" display="inline"><semantics id="S3.p6.3.m1.2a"><mrow id="S3.p6.3.m1.2.2" xref="S3.p6.3.m1.2.2.cmml"><mrow id="S3.p6.3.m1.2.2.2.2" xref="S3.p6.3.m1.2.2.2.3.cmml"><msubsup id="S3.p6.3.m1.1.1.1.1.1" xref="S3.p6.3.m1.1.1.1.1.1.cmml"><mi id="S3.p6.3.m1.1.1.1.1.1.2.2" xref="S3.p6.3.m1.1.1.1.1.1.2.2.cmml">λ</mi><mi id="S3.p6.3.m1.1.1.1.1.1.3" xref="S3.p6.3.m1.1.1.1.1.1.3.cmml">a</mi><mtext id="S3.p6.3.m1.1.1.1.1.1.2.3" xref="S3.p6.3.m1.1.1.1.1.1.2.3a.cmml">text</mtext></msubsup><mo id="S3.p6.3.m1.2.2.2.2.3" xref="S3.p6.3.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.p6.3.m1.2.2.2.2.2" xref="S3.p6.3.m1.2.2.2.2.2.cmml"><mi id="S3.p6.3.m1.2.2.2.2.2.2.2" xref="S3.p6.3.m1.2.2.2.2.2.2.2.cmml">λ</mi><mi id="S3.p6.3.m1.2.2.2.2.2.3" xref="S3.p6.3.m1.2.2.2.2.2.3.cmml">d</mi><mtext id="S3.p6.3.m1.2.2.2.2.2.2.3" xref="S3.p6.3.m1.2.2.2.2.2.2.3a.cmml">text</mtext></msubsup></mrow><mo id="S3.p6.3.m1.2.2.3" xref="S3.p6.3.m1.2.2.3.cmml">∈</mo><mi id="S3.p6.3.m1.2.2.4" xref="S3.p6.3.m1.2.2.4.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.3.m1.2b"><apply id="S3.p6.3.m1.2.2.cmml" xref="S3.p6.3.m1.2.2"><in id="S3.p6.3.m1.2.2.3.cmml" xref="S3.p6.3.m1.2.2.3"></in><list id="S3.p6.3.m1.2.2.2.3.cmml" xref="S3.p6.3.m1.2.2.2.2"><apply id="S3.p6.3.m1.1.1.1.1.1.cmml" xref="S3.p6.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p6.3.m1.1.1.1.1.1.1.cmml" xref="S3.p6.3.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.p6.3.m1.1.1.1.1.1.2.cmml" xref="S3.p6.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p6.3.m1.1.1.1.1.1.2.1.cmml" xref="S3.p6.3.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.p6.3.m1.1.1.1.1.1.2.2.cmml" xref="S3.p6.3.m1.1.1.1.1.1.2.2">𝜆</ci><ci id="S3.p6.3.m1.1.1.1.1.1.2.3a.cmml" xref="S3.p6.3.m1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.p6.3.m1.1.1.1.1.1.2.3.cmml" xref="S3.p6.3.m1.1.1.1.1.1.2.3">text</mtext></ci></apply><ci id="S3.p6.3.m1.1.1.1.1.1.3.cmml" xref="S3.p6.3.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.p6.3.m1.2.2.2.2.2.cmml" xref="S3.p6.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p6.3.m1.2.2.2.2.2.1.cmml" xref="S3.p6.3.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.p6.3.m1.2.2.2.2.2.2.cmml" xref="S3.p6.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p6.3.m1.2.2.2.2.2.2.1.cmml" xref="S3.p6.3.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.p6.3.m1.2.2.2.2.2.2.2.cmml" xref="S3.p6.3.m1.2.2.2.2.2.2.2">𝜆</ci><ci id="S3.p6.3.m1.2.2.2.2.2.2.3a.cmml" xref="S3.p6.3.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.p6.3.m1.2.2.2.2.2.2.3.cmml" xref="S3.p6.3.m1.2.2.2.2.2.2.3">text</mtext></ci></apply><ci id="S3.p6.3.m1.2.2.2.2.2.3.cmml" xref="S3.p6.3.m1.2.2.2.2.2.3">𝑑</ci></apply></list><ci id="S3.p6.3.m1.2.2.4.cmml" xref="S3.p6.3.m1.2.2.4">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m1.2c">\lambda^{\text{text}}_{a},\lambda^{\text{text}}_{d}\in\mathbb{R}</annotation></semantics></math> are weights for the text-based losses.
With CTI, the model can learn from significantly larger pool of unpaired text the ability to extract relevant bias phrases and improve the accuracy of named entity recognition based on them.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Contextual Text-Injected MWER</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.2" class="ltx_p">Conventional MWER training minimizes the expected number of word errors on supervised training data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, optionally including unpaired text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. However, these methods reply on N-best hypotheses produced by a non-contextualized ASR system, limiting its ability to correct errors caused by contextual biasing.
To overcome this, we propose <em id="S4.p1.2.1" class="ltx_emph ltx_font_italic">contextual text-injected (CTI) MWER</em> training. This approach generates N-best hypotheses by feeding both audio-transcript pairs <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> and unpaired text <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{\text{text}}" display="inline"><semantics id="S4.p1.2.m2.1a"><msup id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">𝒟</mi><mtext id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">superscript</csymbol><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝒟</ci><ci id="S4.p1.2.m2.1.1.3a.cmml" xref="S4.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\mathcal{D}^{\text{text}}</annotation></semantics></math> through an ASR model with neural biasing, then computes MWER losses based on these hypotheses.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.3" class="ltx_p">With CTI MWER, we first generate the N-best hypotheses <math id="S4.p2.1.m1.3" class="ltx_Math" alttext="\{\mathbf{Y}_{1},\ldots,\mathbf{Y}_{N}\}" display="inline"><semantics id="S4.p2.1.m1.3a"><mrow id="S4.p2.1.m1.3.3.2" xref="S4.p2.1.m1.3.3.3.cmml"><mo stretchy="false" id="S4.p2.1.m1.3.3.2.3" xref="S4.p2.1.m1.3.3.3.cmml">{</mo><msub id="S4.p2.1.m1.2.2.1.1" xref="S4.p2.1.m1.2.2.1.1.cmml"><mi id="S4.p2.1.m1.2.2.1.1.2" xref="S4.p2.1.m1.2.2.1.1.2.cmml">𝐘</mi><mn id="S4.p2.1.m1.2.2.1.1.3" xref="S4.p2.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.p2.1.m1.3.3.2.4" xref="S4.p2.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">…</mi><mo id="S4.p2.1.m1.3.3.2.5" xref="S4.p2.1.m1.3.3.3.cmml">,</mo><msub id="S4.p2.1.m1.3.3.2.2" xref="S4.p2.1.m1.3.3.2.2.cmml"><mi id="S4.p2.1.m1.3.3.2.2.2" xref="S4.p2.1.m1.3.3.2.2.2.cmml">𝐘</mi><mi id="S4.p2.1.m1.3.3.2.2.3" xref="S4.p2.1.m1.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S4.p2.1.m1.3.3.2.6" xref="S4.p2.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.3b"><set id="S4.p2.1.m1.3.3.3.cmml" xref="S4.p2.1.m1.3.3.2"><apply id="S4.p2.1.m1.2.2.1.1.cmml" xref="S4.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.2.2.1.1.1.cmml" xref="S4.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.p2.1.m1.2.2.1.1.2.cmml" xref="S4.p2.1.m1.2.2.1.1.2">𝐘</ci><cn type="integer" id="S4.p2.1.m1.2.2.1.1.3.cmml" xref="S4.p2.1.m1.2.2.1.1.3">1</cn></apply><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">…</ci><apply id="S4.p2.1.m1.3.3.2.2.cmml" xref="S4.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.3.3.2.2.1.cmml" xref="S4.p2.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.p2.1.m1.3.3.2.2.2.cmml" xref="S4.p2.1.m1.3.3.2.2.2">𝐘</ci><ci id="S4.p2.1.m1.3.3.2.2.3.cmml" xref="S4.p2.1.m1.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.3c">\{\mathbf{Y}_{1},\ldots,\mathbf{Y}_{N}\}</annotation></semantics></math> by inputting speech <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\mathbf{X}</annotation></semantics></math> and the bias phrases <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">Z</annotation></semantics></math> into the model and applying the two-pass neural contextual biasing outlined in Section <a href="#S2.SS2" title="2.2 Neural Contextual Biasing with Deferred NAM ‣ 2 Related Work ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>.
This aligns the N-best generation with the actual inference, empowering the MWER training to rectify errors introduced by contextual biasing.
The contextual MWER loss on supervised data is computed as the expected number of word errors on these N-best hypotheses:</p>
<table id="S6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\text{MWER}}(\mathcal{D})=" display="inline"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.2" xref="S4.E8.m1.1.2.cmml"><mrow id="S4.E8.m1.1.2.2" xref="S4.E8.m1.1.2.2.cmml"><msup id="S4.E8.m1.1.2.2.2" xref="S4.E8.m1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.2.2.2.2" xref="S4.E8.m1.1.2.2.2.2.cmml">ℒ</mi><mtext id="S4.E8.m1.1.2.2.2.3" xref="S4.E8.m1.1.2.2.2.3a.cmml">MWER</mtext></msup><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.2.2.1" xref="S4.E8.m1.1.2.2.1.cmml">​</mo><mrow id="S4.E8.m1.1.2.2.3.2" xref="S4.E8.m1.1.2.2.cmml"><mo stretchy="false" id="S4.E8.m1.1.2.2.3.2.1" xref="S4.E8.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">𝒟</mi><mo stretchy="false" id="S4.E8.m1.1.2.2.3.2.2" xref="S4.E8.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.1.2.1" xref="S4.E8.m1.1.2.1.cmml">=</mo><mi id="S4.E8.m1.1.2.3" xref="S4.E8.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.2.cmml" xref="S4.E8.m1.1.2"><eq id="S4.E8.m1.1.2.1.cmml" xref="S4.E8.m1.1.2.1"></eq><apply id="S4.E8.m1.1.2.2.cmml" xref="S4.E8.m1.1.2.2"><times id="S4.E8.m1.1.2.2.1.cmml" xref="S4.E8.m1.1.2.2.1"></times><apply id="S4.E8.m1.1.2.2.2.cmml" xref="S4.E8.m1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.2.2.2.1.cmml" xref="S4.E8.m1.1.2.2.2">superscript</csymbol><ci id="S4.E8.m1.1.2.2.2.2.cmml" xref="S4.E8.m1.1.2.2.2.2">ℒ</ci><ci id="S4.E8.m1.1.2.2.2.3a.cmml" xref="S4.E8.m1.1.2.2.2.3"><mtext mathsize="70%" id="S4.E8.m1.1.2.2.2.3.cmml" xref="S4.E8.m1.1.2.2.2.3">MWER</mtext></ci></apply><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝒟</ci></apply><csymbol cd="latexml" id="S4.E8.m1.1.2.3.cmml" xref="S4.E8.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\mathcal{L}^{\text{MWER}}(\mathcal{D})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E8.m2.8" class="ltx_Math" alttext="\displaystyle\sum_{n=1}^{N}\frac{P(\mathbf{Y}_{n}|\mathbf{X},Z)}{\sum_{n=1}^{N}P(\mathbf{Y}_{n}|\mathbf{X},Z)}R(\mathbf{Y}_{n},\mathbf{Y})," display="inline"><semantics id="S4.E8.m2.8a"><mrow id="S4.E8.m2.8.8.1" xref="S4.E8.m2.8.8.1.1.cmml"><mrow id="S4.E8.m2.8.8.1.1" xref="S4.E8.m2.8.8.1.1.cmml"><mstyle displaystyle="true" id="S4.E8.m2.8.8.1.1.2" xref="S4.E8.m2.8.8.1.1.2.cmml"><munderover id="S4.E8.m2.8.8.1.1.2a" xref="S4.E8.m2.8.8.1.1.2.cmml"><mo movablelimits="false" id="S4.E8.m2.8.8.1.1.2.2.2" xref="S4.E8.m2.8.8.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E8.m2.8.8.1.1.2.2.3" xref="S4.E8.m2.8.8.1.1.2.2.3.cmml"><mi id="S4.E8.m2.8.8.1.1.2.2.3.2" xref="S4.E8.m2.8.8.1.1.2.2.3.2.cmml">n</mi><mo id="S4.E8.m2.8.8.1.1.2.2.3.1" xref="S4.E8.m2.8.8.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E8.m2.8.8.1.1.2.2.3.3" xref="S4.E8.m2.8.8.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m2.8.8.1.1.2.3" xref="S4.E8.m2.8.8.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E8.m2.8.8.1.1.1" xref="S4.E8.m2.8.8.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E8.m2.6.6" xref="S4.E8.m2.6.6.cmml"><mfrac id="S4.E8.m2.6.6a" xref="S4.E8.m2.6.6.cmml"><mrow id="S4.E8.m2.3.3.3" xref="S4.E8.m2.3.3.3.cmml"><mi id="S4.E8.m2.3.3.3.5" xref="S4.E8.m2.3.3.3.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.3.3.3.4" xref="S4.E8.m2.3.3.3.4.cmml">​</mo><mrow id="S4.E8.m2.3.3.3.3.1" xref="S4.E8.m2.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S4.E8.m2.3.3.3.3.1.2" xref="S4.E8.m2.3.3.3.3.1.1.cmml">(</mo><mrow id="S4.E8.m2.3.3.3.3.1.1" xref="S4.E8.m2.3.3.3.3.1.1.cmml"><msub id="S4.E8.m2.3.3.3.3.1.1.2" xref="S4.E8.m2.3.3.3.3.1.1.2.cmml"><mi id="S4.E8.m2.3.3.3.3.1.1.2.2" xref="S4.E8.m2.3.3.3.3.1.1.2.2.cmml">𝐘</mi><mi id="S4.E8.m2.3.3.3.3.1.1.2.3" xref="S4.E8.m2.3.3.3.3.1.1.2.3.cmml">n</mi></msub><mo fence="false" id="S4.E8.m2.3.3.3.3.1.1.1" xref="S4.E8.m2.3.3.3.3.1.1.1.cmml">|</mo><mrow id="S4.E8.m2.3.3.3.3.1.1.3.2" xref="S4.E8.m2.3.3.3.3.1.1.3.1.cmml"><mi id="S4.E8.m2.1.1.1.1" xref="S4.E8.m2.1.1.1.1.cmml">𝐗</mi><mo id="S4.E8.m2.3.3.3.3.1.1.3.2.1" xref="S4.E8.m2.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S4.E8.m2.2.2.2.2" xref="S4.E8.m2.2.2.2.2.cmml">Z</mi></mrow></mrow><mo stretchy="false" id="S4.E8.m2.3.3.3.3.1.3" xref="S4.E8.m2.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E8.m2.6.6.6" xref="S4.E8.m2.6.6.6.cmml"><msubsup id="S4.E8.m2.6.6.6.4" xref="S4.E8.m2.6.6.6.4.cmml"><mo id="S4.E8.m2.6.6.6.4.2.2" xref="S4.E8.m2.6.6.6.4.2.2.cmml">∑</mo><mrow id="S4.E8.m2.6.6.6.4.2.3" xref="S4.E8.m2.6.6.6.4.2.3.cmml"><mi id="S4.E8.m2.6.6.6.4.2.3.2" xref="S4.E8.m2.6.6.6.4.2.3.2.cmml">n</mi><mo id="S4.E8.m2.6.6.6.4.2.3.1" xref="S4.E8.m2.6.6.6.4.2.3.1.cmml">=</mo><mn id="S4.E8.m2.6.6.6.4.2.3.3" xref="S4.E8.m2.6.6.6.4.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m2.6.6.6.4.3" xref="S4.E8.m2.6.6.6.4.3.cmml">N</mi></msubsup><mrow id="S4.E8.m2.6.6.6.3" xref="S4.E8.m2.6.6.6.3.cmml"><mi id="S4.E8.m2.6.6.6.3.3" xref="S4.E8.m2.6.6.6.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.6.6.6.3.2" xref="S4.E8.m2.6.6.6.3.2.cmml">​</mo><mrow id="S4.E8.m2.6.6.6.3.1.1" xref="S4.E8.m2.6.6.6.3.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m2.6.6.6.3.1.1.2" xref="S4.E8.m2.6.6.6.3.1.1.1.cmml">(</mo><mrow id="S4.E8.m2.6.6.6.3.1.1.1" xref="S4.E8.m2.6.6.6.3.1.1.1.cmml"><msub id="S4.E8.m2.6.6.6.3.1.1.1.2" xref="S4.E8.m2.6.6.6.3.1.1.1.2.cmml"><mi id="S4.E8.m2.6.6.6.3.1.1.1.2.2" xref="S4.E8.m2.6.6.6.3.1.1.1.2.2.cmml">𝐘</mi><mi id="S4.E8.m2.6.6.6.3.1.1.1.2.3" xref="S4.E8.m2.6.6.6.3.1.1.1.2.3.cmml">n</mi></msub><mo fence="false" id="S4.E8.m2.6.6.6.3.1.1.1.1" xref="S4.E8.m2.6.6.6.3.1.1.1.1.cmml">|</mo><mrow id="S4.E8.m2.6.6.6.3.1.1.1.3.2" xref="S4.E8.m2.6.6.6.3.1.1.1.3.1.cmml"><mi id="S4.E8.m2.4.4.4.1" xref="S4.E8.m2.4.4.4.1.cmml">𝐗</mi><mo id="S4.E8.m2.6.6.6.3.1.1.1.3.2.1" xref="S4.E8.m2.6.6.6.3.1.1.1.3.1.cmml">,</mo><mi id="S4.E8.m2.5.5.5.2" xref="S4.E8.m2.5.5.5.2.cmml">Z</mi></mrow></mrow><mo stretchy="false" id="S4.E8.m2.6.6.6.3.1.1.3" xref="S4.E8.m2.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E8.m2.8.8.1.1.1.2" xref="S4.E8.m2.8.8.1.1.1.2.cmml">​</mo><mi id="S4.E8.m2.8.8.1.1.1.3" xref="S4.E8.m2.8.8.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.8.8.1.1.1.2a" xref="S4.E8.m2.8.8.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m2.8.8.1.1.1.1.1" xref="S4.E8.m2.8.8.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m2.8.8.1.1.1.1.1.2" xref="S4.E8.m2.8.8.1.1.1.1.2.cmml">(</mo><msub id="S4.E8.m2.8.8.1.1.1.1.1.1" xref="S4.E8.m2.8.8.1.1.1.1.1.1.cmml"><mi id="S4.E8.m2.8.8.1.1.1.1.1.1.2" xref="S4.E8.m2.8.8.1.1.1.1.1.1.2.cmml">𝐘</mi><mi id="S4.E8.m2.8.8.1.1.1.1.1.1.3" xref="S4.E8.m2.8.8.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E8.m2.8.8.1.1.1.1.1.3" xref="S4.E8.m2.8.8.1.1.1.1.2.cmml">,</mo><mi id="S4.E8.m2.7.7" xref="S4.E8.m2.7.7.cmml">𝐘</mi><mo stretchy="false" id="S4.E8.m2.8.8.1.1.1.1.1.4" xref="S4.E8.m2.8.8.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m2.8.8.1.2" xref="S4.E8.m2.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m2.8b"><apply id="S4.E8.m2.8.8.1.1.cmml" xref="S4.E8.m2.8.8.1"><apply id="S4.E8.m2.8.8.1.1.2.cmml" xref="S4.E8.m2.8.8.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m2.8.8.1.1.2.1.cmml" xref="S4.E8.m2.8.8.1.1.2">superscript</csymbol><apply id="S4.E8.m2.8.8.1.1.2.2.cmml" xref="S4.E8.m2.8.8.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m2.8.8.1.1.2.2.1.cmml" xref="S4.E8.m2.8.8.1.1.2">subscript</csymbol><sum id="S4.E8.m2.8.8.1.1.2.2.2.cmml" xref="S4.E8.m2.8.8.1.1.2.2.2"></sum><apply id="S4.E8.m2.8.8.1.1.2.2.3.cmml" xref="S4.E8.m2.8.8.1.1.2.2.3"><eq id="S4.E8.m2.8.8.1.1.2.2.3.1.cmml" xref="S4.E8.m2.8.8.1.1.2.2.3.1"></eq><ci id="S4.E8.m2.8.8.1.1.2.2.3.2.cmml" xref="S4.E8.m2.8.8.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S4.E8.m2.8.8.1.1.2.2.3.3.cmml" xref="S4.E8.m2.8.8.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m2.8.8.1.1.2.3.cmml" xref="S4.E8.m2.8.8.1.1.2.3">𝑁</ci></apply><apply id="S4.E8.m2.8.8.1.1.1.cmml" xref="S4.E8.m2.8.8.1.1.1"><times id="S4.E8.m2.8.8.1.1.1.2.cmml" xref="S4.E8.m2.8.8.1.1.1.2"></times><apply id="S4.E8.m2.6.6.cmml" xref="S4.E8.m2.6.6"><divide id="S4.E8.m2.6.6.7.cmml" xref="S4.E8.m2.6.6"></divide><apply id="S4.E8.m2.3.3.3.cmml" xref="S4.E8.m2.3.3.3"><times id="S4.E8.m2.3.3.3.4.cmml" xref="S4.E8.m2.3.3.3.4"></times><ci id="S4.E8.m2.3.3.3.5.cmml" xref="S4.E8.m2.3.3.3.5">𝑃</ci><apply id="S4.E8.m2.3.3.3.3.1.1.cmml" xref="S4.E8.m2.3.3.3.3.1"><csymbol cd="latexml" id="S4.E8.m2.3.3.3.3.1.1.1.cmml" xref="S4.E8.m2.3.3.3.3.1.1.1">conditional</csymbol><apply id="S4.E8.m2.3.3.3.3.1.1.2.cmml" xref="S4.E8.m2.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m2.3.3.3.3.1.1.2.1.cmml" xref="S4.E8.m2.3.3.3.3.1.1.2">subscript</csymbol><ci id="S4.E8.m2.3.3.3.3.1.1.2.2.cmml" xref="S4.E8.m2.3.3.3.3.1.1.2.2">𝐘</ci><ci id="S4.E8.m2.3.3.3.3.1.1.2.3.cmml" xref="S4.E8.m2.3.3.3.3.1.1.2.3">𝑛</ci></apply><list id="S4.E8.m2.3.3.3.3.1.1.3.1.cmml" xref="S4.E8.m2.3.3.3.3.1.1.3.2"><ci id="S4.E8.m2.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1">𝐗</ci><ci id="S4.E8.m2.2.2.2.2.cmml" xref="S4.E8.m2.2.2.2.2">𝑍</ci></list></apply></apply><apply id="S4.E8.m2.6.6.6.cmml" xref="S4.E8.m2.6.6.6"><apply id="S4.E8.m2.6.6.6.4.cmml" xref="S4.E8.m2.6.6.6.4"><csymbol cd="ambiguous" id="S4.E8.m2.6.6.6.4.1.cmml" xref="S4.E8.m2.6.6.6.4">superscript</csymbol><apply id="S4.E8.m2.6.6.6.4.2.cmml" xref="S4.E8.m2.6.6.6.4"><csymbol cd="ambiguous" id="S4.E8.m2.6.6.6.4.2.1.cmml" xref="S4.E8.m2.6.6.6.4">subscript</csymbol><sum id="S4.E8.m2.6.6.6.4.2.2.cmml" xref="S4.E8.m2.6.6.6.4.2.2"></sum><apply id="S4.E8.m2.6.6.6.4.2.3.cmml" xref="S4.E8.m2.6.6.6.4.2.3"><eq id="S4.E8.m2.6.6.6.4.2.3.1.cmml" xref="S4.E8.m2.6.6.6.4.2.3.1"></eq><ci id="S4.E8.m2.6.6.6.4.2.3.2.cmml" xref="S4.E8.m2.6.6.6.4.2.3.2">𝑛</ci><cn type="integer" id="S4.E8.m2.6.6.6.4.2.3.3.cmml" xref="S4.E8.m2.6.6.6.4.2.3.3">1</cn></apply></apply><ci id="S4.E8.m2.6.6.6.4.3.cmml" xref="S4.E8.m2.6.6.6.4.3">𝑁</ci></apply><apply id="S4.E8.m2.6.6.6.3.cmml" xref="S4.E8.m2.6.6.6.3"><times id="S4.E8.m2.6.6.6.3.2.cmml" xref="S4.E8.m2.6.6.6.3.2"></times><ci id="S4.E8.m2.6.6.6.3.3.cmml" xref="S4.E8.m2.6.6.6.3.3">𝑃</ci><apply id="S4.E8.m2.6.6.6.3.1.1.1.cmml" xref="S4.E8.m2.6.6.6.3.1.1"><csymbol cd="latexml" id="S4.E8.m2.6.6.6.3.1.1.1.1.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.1">conditional</csymbol><apply id="S4.E8.m2.6.6.6.3.1.1.1.2.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m2.6.6.6.3.1.1.1.2.1.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.2">subscript</csymbol><ci id="S4.E8.m2.6.6.6.3.1.1.1.2.2.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.2.2">𝐘</ci><ci id="S4.E8.m2.6.6.6.3.1.1.1.2.3.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.2.3">𝑛</ci></apply><list id="S4.E8.m2.6.6.6.3.1.1.1.3.1.cmml" xref="S4.E8.m2.6.6.6.3.1.1.1.3.2"><ci id="S4.E8.m2.4.4.4.1.cmml" xref="S4.E8.m2.4.4.4.1">𝐗</ci><ci id="S4.E8.m2.5.5.5.2.cmml" xref="S4.E8.m2.5.5.5.2">𝑍</ci></list></apply></apply></apply></apply><ci id="S4.E8.m2.8.8.1.1.1.3.cmml" xref="S4.E8.m2.8.8.1.1.1.3">𝑅</ci><interval closure="open" id="S4.E8.m2.8.8.1.1.1.1.2.cmml" xref="S4.E8.m2.8.8.1.1.1.1.1"><apply id="S4.E8.m2.8.8.1.1.1.1.1.1.cmml" xref="S4.E8.m2.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m2.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m2.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E8.m2.8.8.1.1.1.1.1.1.2">𝐘</ci><ci id="S4.E8.m2.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E8.m2.8.8.1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S4.E8.m2.7.7.cmml" xref="S4.E8.m2.7.7">𝐘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m2.8c">\displaystyle\sum_{n=1}^{N}\frac{P(\mathbf{Y}_{n}|\mathbf{X},Z)}{\sum_{n=1}^{N}P(\mathbf{Y}_{n}|\mathbf{X},Z)}R(\mathbf{Y}_{n},\mathbf{Y}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.6" class="ltx_p">where <math id="S4.p2.4.m1.2" class="ltx_Math" alttext="R(\mathbf{Y}_{n},\mathbf{Y})" display="inline"><semantics id="S4.p2.4.m1.2a"><mrow id="S4.p2.4.m1.2.2" xref="S4.p2.4.m1.2.2.cmml"><mi id="S4.p2.4.m1.2.2.3" xref="S4.p2.4.m1.2.2.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.p2.4.m1.2.2.2" xref="S4.p2.4.m1.2.2.2.cmml">​</mo><mrow id="S4.p2.4.m1.2.2.1.1" xref="S4.p2.4.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.p2.4.m1.2.2.1.1.2" xref="S4.p2.4.m1.2.2.1.2.cmml">(</mo><msub id="S4.p2.4.m1.2.2.1.1.1" xref="S4.p2.4.m1.2.2.1.1.1.cmml"><mi id="S4.p2.4.m1.2.2.1.1.1.2" xref="S4.p2.4.m1.2.2.1.1.1.2.cmml">𝐘</mi><mi id="S4.p2.4.m1.2.2.1.1.1.3" xref="S4.p2.4.m1.2.2.1.1.1.3.cmml">n</mi></msub><mo id="S4.p2.4.m1.2.2.1.1.3" xref="S4.p2.4.m1.2.2.1.2.cmml">,</mo><mi id="S4.p2.4.m1.1.1" xref="S4.p2.4.m1.1.1.cmml">𝐘</mi><mo stretchy="false" id="S4.p2.4.m1.2.2.1.1.4" xref="S4.p2.4.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m1.2b"><apply id="S4.p2.4.m1.2.2.cmml" xref="S4.p2.4.m1.2.2"><times id="S4.p2.4.m1.2.2.2.cmml" xref="S4.p2.4.m1.2.2.2"></times><ci id="S4.p2.4.m1.2.2.3.cmml" xref="S4.p2.4.m1.2.2.3">𝑅</ci><interval closure="open" id="S4.p2.4.m1.2.2.1.2.cmml" xref="S4.p2.4.m1.2.2.1.1"><apply id="S4.p2.4.m1.2.2.1.1.1.cmml" xref="S4.p2.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m1.2.2.1.1.1.1.cmml" xref="S4.p2.4.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.p2.4.m1.2.2.1.1.1.2.cmml" xref="S4.p2.4.m1.2.2.1.1.1.2">𝐘</ci><ci id="S4.p2.4.m1.2.2.1.1.1.3.cmml" xref="S4.p2.4.m1.2.2.1.1.1.3">𝑛</ci></apply><ci id="S4.p2.4.m1.1.1.cmml" xref="S4.p2.4.m1.1.1">𝐘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m1.2c">R(\mathbf{Y}_{n},\mathbf{Y})</annotation></semantics></math> is the number of word errors in a hypothesis <math id="S4.p2.5.m2.1" class="ltx_Math" alttext="\mathbf{Y}_{n}" display="inline"><semantics id="S4.p2.5.m2.1a"><msub id="S4.p2.5.m2.1.1" xref="S4.p2.5.m2.1.1.cmml"><mi id="S4.p2.5.m2.1.1.2" xref="S4.p2.5.m2.1.1.2.cmml">𝐘</mi><mi id="S4.p2.5.m2.1.1.3" xref="S4.p2.5.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.5.m2.1b"><apply id="S4.p2.5.m2.1.1.cmml" xref="S4.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m2.1.1.1.cmml" xref="S4.p2.5.m2.1.1">subscript</csymbol><ci id="S4.p2.5.m2.1.1.2.cmml" xref="S4.p2.5.m2.1.1.2">𝐘</ci><ci id="S4.p2.5.m2.1.1.3.cmml" xref="S4.p2.5.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m2.1c">\mathbf{Y}_{n}</annotation></semantics></math> compared to the ground-truth transcript <math id="S4.p2.6.m3.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S4.p2.6.m3.1a"><mi id="S4.p2.6.m3.1.1" xref="S4.p2.6.m3.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S4.p2.6.m3.1b"><ci id="S4.p2.6.m3.1.1.cmml" xref="S4.p2.6.m3.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m3.1c">\mathbf{Y}</annotation></semantics></math>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.2" class="ltx_p">Further, we inject unpaired text <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{Y}^{\text{text}}" display="inline"><semantics id="S4.p3.1.m1.1a"><msup id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">𝐘</mi><mtext id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">superscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝐘</ci><ci id="S4.p3.1.m1.1.1.3a.cmml" xref="S4.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\mathbf{Y}^{\text{text}}</annotation></semantics></math> and bias phrases <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="Z^{\text{text}}" display="inline"><semantics id="S4.p3.2.m2.1a"><msup id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">Z</mi><mtext id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1">superscript</csymbol><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑍</ci><ci id="S4.p3.2.m2.1.1.3a.cmml" xref="S4.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">Z^{\text{text}}</annotation></semantics></math> into the ASR and its neural biasing model to
calculate an text-based MWER loss:</p>
<table id="S6.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\text{MWER}}(\mathcal{D}^{\text{text}})=\sum_{n=1}^{N}\frac{P(\mathbf{Y}^{\text{text}}_{n}|\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}})}{\sum_{n=1}^{N}P(\mathbf{Y}^{\text{text}}_{n}|\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}})}R(\mathbf{Y}^{\text{text}}_{n},\mathbf{Y}^{\text{text}})," display="inline"><semantics id="S4.Ex2.m1.3a"><mrow id="S4.Ex2.m1.3.3.1" xref="S4.Ex2.m1.3.3.1.1.cmml"><mrow id="S4.Ex2.m1.3.3.1.1" xref="S4.Ex2.m1.3.3.1.1.cmml"><mrow id="S4.Ex2.m1.3.3.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.cmml"><msup id="S4.Ex2.m1.3.3.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.3.3.1.1.1.3.2" xref="S4.Ex2.m1.3.3.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.Ex2.m1.3.3.1.1.1.3.3" xref="S4.Ex2.m1.3.3.1.1.1.3.3a.cmml">MWER</mtext></msup><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.3.3.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="S4.Ex2.m1.3.3.1.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.3.3.1.1.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S4.Ex2.m1.3.3.1.1.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.3.3.1.1.4" xref="S4.Ex2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.Ex2.m1.3.3.1.1.3" xref="S4.Ex2.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S4.Ex2.m1.3.3.1.1.3.3" xref="S4.Ex2.m1.3.3.1.1.3.3.cmml"><munderover id="S4.Ex2.m1.3.3.1.1.3.3a" xref="S4.Ex2.m1.3.3.1.1.3.3.cmml"><mo movablelimits="false" id="S4.Ex2.m1.3.3.1.1.3.3.2.2" xref="S4.Ex2.m1.3.3.1.1.3.3.2.2.cmml">∑</mo><mrow id="S4.Ex2.m1.3.3.1.1.3.3.2.3" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.cmml"><mi id="S4.Ex2.m1.3.3.1.1.3.3.2.3.2" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.2.cmml">n</mi><mo id="S4.Ex2.m1.3.3.1.1.3.3.2.3.1" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.1.cmml">=</mo><mn id="S4.Ex2.m1.3.3.1.1.3.3.2.3.3" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex2.m1.3.3.1.1.3.3.3" xref="S4.Ex2.m1.3.3.1.1.3.3.3.cmml">N</mi></munderover></mstyle><mrow id="S4.Ex2.m1.3.3.1.1.3.2" xref="S4.Ex2.m1.3.3.1.1.3.2.cmml"><mstyle displaystyle="true" id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml"><mfrac id="S4.Ex2.m1.2.2a" xref="S4.Ex2.m1.2.2.cmml"><mrow id="S4.Ex2.m1.1.1.1" xref="S4.Ex2.m1.1.1.1.cmml"><mi id="S4.Ex2.m1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.1.1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex2.m1.1.1.1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.1.1.1.1.1.1.2.2.2" xref="S4.Ex2.m1.1.1.1.1.1.1.2.2.2.cmml">𝐘</mi><mi id="S4.Ex2.m1.1.1.1.1.1.1.2.3" xref="S4.Ex2.m1.1.1.1.1.1.1.2.3.cmml">n</mi><mtext id="S4.Ex2.m1.1.1.1.1.1.1.2.2.3" xref="S4.Ex2.m1.1.1.1.1.1.1.2.2.3a.cmml">text</mtext></msubsup><mo fence="false" id="S4.Ex2.m1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="S4.Ex2.m1.1.1.1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex2.m1.1.1.1.1.1.1.3.2.2" xref="S4.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml">𝐇</mi><msup id="S4.Ex2.m1.1.1.1.1.1.1.3.3" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex2.m1.1.1.1.1.1.1.3.3.2" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mtext id="S4.Ex2.m1.1.1.1.1.1.1.3.3.3" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.3a.cmml">mask</mtext></msup><mtext id="S4.Ex2.m1.1.1.1.1.1.1.3.2.3" xref="S4.Ex2.m1.1.1.1.1.1.1.3.2.3a.cmml">text, bias</mtext></msubsup></mrow><mo stretchy="false" id="S4.Ex2.m1.1.1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.Ex2.m1.2.2.2" xref="S4.Ex2.m1.2.2.2.cmml"><msubsup id="S4.Ex2.m1.2.2.2.2" xref="S4.Ex2.m1.2.2.2.2.cmml"><mo id="S4.Ex2.m1.2.2.2.2.2.2" xref="S4.Ex2.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S4.Ex2.m1.2.2.2.2.2.3" xref="S4.Ex2.m1.2.2.2.2.2.3.cmml"><mi id="S4.Ex2.m1.2.2.2.2.2.3.2" xref="S4.Ex2.m1.2.2.2.2.2.3.2.cmml">n</mi><mo id="S4.Ex2.m1.2.2.2.2.2.3.1" xref="S4.Ex2.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S4.Ex2.m1.2.2.2.2.2.3.3" xref="S4.Ex2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex2.m1.2.2.2.2.3" xref="S4.Ex2.m1.2.2.2.2.3.cmml">N</mi></msubsup><mrow id="S4.Ex2.m1.2.2.2.1" xref="S4.Ex2.m1.2.2.2.1.cmml"><mi id="S4.Ex2.m1.2.2.2.1.3" xref="S4.Ex2.m1.2.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.2.2.2.1.2" xref="S4.Ex2.m1.2.2.2.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.2.2.2.1.1.1" xref="S4.Ex2.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.2.2.2.1.1.1.2" xref="S4.Ex2.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.2.2.2.1.1.1.1" xref="S4.Ex2.m1.2.2.2.1.1.1.1.cmml"><msubsup id="S4.Ex2.m1.2.2.2.1.1.1.1.2" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.2" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.2.cmml">𝐘</mi><mi id="S4.Ex2.m1.2.2.2.1.1.1.1.2.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.3.cmml">n</mi><mtext id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3a.cmml">text</mtext></msubsup><mo fence="false" id="S4.Ex2.m1.2.2.2.1.1.1.1.1" xref="S4.Ex2.m1.2.2.2.1.1.1.1.1.cmml">|</mo><msubsup id="S4.Ex2.m1.2.2.2.1.1.1.1.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.2" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.2.cmml">𝐇</mi><msup id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.cmml"><mi id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.2" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.2.cmml">l</mi><mtext id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3a.cmml">mask</mtext></msup><mtext id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3a.cmml">text, bias</mtext></msubsup></mrow><mo stretchy="false" id="S4.Ex2.m1.2.2.2.1.1.1.3" xref="S4.Ex2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.1.1.3.2.3" xref="S4.Ex2.m1.3.3.1.1.3.2.3.cmml">​</mo><mi id="S4.Ex2.m1.3.3.1.1.3.2.4" xref="S4.Ex2.m1.3.3.1.1.3.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.1.1.3.2.3a" xref="S4.Ex2.m1.3.3.1.1.3.2.3.cmml">​</mo><mrow id="S4.Ex2.m1.3.3.1.1.3.2.2.2" xref="S4.Ex2.m1.3.3.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.3.2.2.2.3" xref="S4.Ex2.m1.3.3.1.1.3.2.2.3.cmml">(</mo><msubsup id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.2" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.2.cmml">𝐘</mi><mi id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.3.cmml">n</mi><mtext id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3a.cmml">text</mtext></msubsup><mo id="S4.Ex2.m1.3.3.1.1.3.2.2.2.4" xref="S4.Ex2.m1.3.3.1.1.3.2.2.3.cmml">,</mo><msup id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.2" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.2.cmml">𝐘</mi><mtext id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3a.cmml">text</mtext></msup><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.3.2.2.2.5" xref="S4.Ex2.m1.3.3.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex2.m1.3.3.1.2" xref="S4.Ex2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.3b"><apply id="S4.Ex2.m1.3.3.1.1.cmml" xref="S4.Ex2.m1.3.3.1"><eq id="S4.Ex2.m1.3.3.1.1.4.cmml" xref="S4.Ex2.m1.3.3.1.1.4"></eq><apply id="S4.Ex2.m1.3.3.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1"><times id="S4.Ex2.m1.3.3.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.2"></times><apply id="S4.Ex2.m1.3.3.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.1.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.1.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.3.2">ℒ</ci><ci id="S4.Ex2.m1.3.3.1.1.1.3.3a.cmml" xref="S4.Ex2.m1.3.3.1.1.1.3.3"><mtext mathsize="70%" id="S4.Ex2.m1.3.3.1.1.1.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.3.3">MWER</mtext></ci></apply><apply id="S4.Ex2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.2">𝒟</ci><ci id="S4.Ex2.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.Ex2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1.1.3">text</mtext></ci></apply></apply><apply id="S4.Ex2.m1.3.3.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3"><apply id="S4.Ex2.m1.3.3.1.1.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.3.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3">superscript</csymbol><apply id="S4.Ex2.m1.3.3.1.1.3.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.3.3.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3">subscript</csymbol><sum id="S4.Ex2.m1.3.3.1.1.3.3.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.2.2"></sum><apply id="S4.Ex2.m1.3.3.1.1.3.3.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3"><eq id="S4.Ex2.m1.3.3.1.1.3.3.2.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.1"></eq><ci id="S4.Ex2.m1.3.3.1.1.3.3.2.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.2">𝑛</ci><cn type="integer" id="S4.Ex2.m1.3.3.1.1.3.3.2.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m1.3.3.1.1.3.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.3.3">𝑁</ci></apply><apply id="S4.Ex2.m1.3.3.1.1.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2"><times id="S4.Ex2.m1.3.3.1.1.3.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.3"></times><apply id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2"><divide id="S4.Ex2.m1.2.2.3.cmml" xref="S4.Ex2.m1.2.2"></divide><apply id="S4.Ex2.m1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1"><times id="S4.Ex2.m1.1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.1.2"></times><ci id="S4.Ex2.m1.1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.1.3">𝑃</ci><apply id="S4.Ex2.m1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.Ex2.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2.2.2">𝐘</ci><ci id="S4.Ex2.m1.1.1.1.1.1.1.2.2.3a.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2.2.3">text</mtext></ci></apply><ci id="S4.Ex2.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.2.2">𝐇</ci><ci id="S4.Ex2.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.2.3">text, bias</mtext></ci></apply><apply id="S4.Ex2.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.Ex2.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.2">𝑙</ci><ci id="S4.Ex2.m1.1.1.1.1.1.1.3.3.3a.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.3"><mtext mathsize="50%" id="S4.Ex2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1.3.3.3">mask</mtext></ci></apply></apply></apply></apply><apply id="S4.Ex2.m1.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2"><apply id="S4.Ex2.m1.2.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.2.1.cmml" xref="S4.Ex2.m1.2.2.2.2">superscript</csymbol><apply id="S4.Ex2.m1.2.2.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.2.2.1.cmml" xref="S4.Ex2.m1.2.2.2.2">subscript</csymbol><sum id="S4.Ex2.m1.2.2.2.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.2.2.2"></sum><apply id="S4.Ex2.m1.2.2.2.2.2.3.cmml" xref="S4.Ex2.m1.2.2.2.2.2.3"><eq id="S4.Ex2.m1.2.2.2.2.2.3.1.cmml" xref="S4.Ex2.m1.2.2.2.2.2.3.1"></eq><ci id="S4.Ex2.m1.2.2.2.2.2.3.2.cmml" xref="S4.Ex2.m1.2.2.2.2.2.3.2">𝑛</ci><cn type="integer" id="S4.Ex2.m1.2.2.2.2.2.3.3.cmml" xref="S4.Ex2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m1.2.2.2.2.3.cmml" xref="S4.Ex2.m1.2.2.2.2.3">𝑁</ci></apply><apply id="S4.Ex2.m1.2.2.2.1.cmml" xref="S4.Ex2.m1.2.2.2.1"><times id="S4.Ex2.m1.2.2.2.1.2.cmml" xref="S4.Ex2.m1.2.2.2.1.2"></times><ci id="S4.Ex2.m1.2.2.2.1.3.cmml" xref="S4.Ex2.m1.2.2.2.1.3">𝑃</ci><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2">subscript</csymbol><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.2">𝐘</ci><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3a.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.2.3">text</mtext></ci></apply><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3">subscript</csymbol><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.2">𝐇</ci><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3a.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.2.3">text, bias</mtext></ci></apply><apply id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.1.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3">superscript</csymbol><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.2.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.2">𝑙</ci><ci id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3a.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3"><mtext mathsize="50%" id="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3.cmml" xref="S4.Ex2.m1.2.2.2.1.1.1.1.3.3.3">mask</mtext></ci></apply></apply></apply></apply></apply></apply><ci id="S4.Ex2.m1.3.3.1.1.3.2.4.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.4">𝑅</ci><interval closure="open" id="S4.Ex2.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2"><apply id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1">subscript</csymbol><apply id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1">superscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.2">𝐘</ci><ci id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3a.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.2.3">text</mtext></ci></apply><ci id="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.1.1.1.1.3">𝑛</ci></apply><apply id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2">superscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.2">𝐘</ci><ci id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3a.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3"><mtext mathsize="70%" id="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.3.2.2.2.2.3">text</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.3c">\displaystyle\mathcal{L}^{\text{MWER}}(\mathcal{D}^{\text{text}})=\sum_{n=1}^{N}\frac{P(\mathbf{Y}^{\text{text}}_{n}|\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}})}{\sum_{n=1}^{N}P(\mathbf{Y}^{\text{text}}_{n}|\mathbf{H}^{\text{text, bias}}_{l^{\text{mask}}})}R(\mathbf{Y}^{\text{text}}_{n},\mathbf{Y}^{\text{text}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.p3.5" class="ltx_p">where <math id="S4.p3.3.m1.3" class="ltx_Math" alttext="\{\mathbf{Y}^{\text{text}}_{1},\ldots,\mathbf{Y}^{\text{text}}_{N}\}" display="inline"><semantics id="S4.p3.3.m1.3a"><mrow id="S4.p3.3.m1.3.3.2" xref="S4.p3.3.m1.3.3.3.cmml"><mo stretchy="false" id="S4.p3.3.m1.3.3.2.3" xref="S4.p3.3.m1.3.3.3.cmml">{</mo><msubsup id="S4.p3.3.m1.2.2.1.1" xref="S4.p3.3.m1.2.2.1.1.cmml"><mi id="S4.p3.3.m1.2.2.1.1.2.2" xref="S4.p3.3.m1.2.2.1.1.2.2.cmml">𝐘</mi><mn id="S4.p3.3.m1.2.2.1.1.3" xref="S4.p3.3.m1.2.2.1.1.3.cmml">1</mn><mtext id="S4.p3.3.m1.2.2.1.1.2.3" xref="S4.p3.3.m1.2.2.1.1.2.3a.cmml">text</mtext></msubsup><mo id="S4.p3.3.m1.3.3.2.4" xref="S4.p3.3.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S4.p3.3.m1.1.1" xref="S4.p3.3.m1.1.1.cmml">…</mi><mo id="S4.p3.3.m1.3.3.2.5" xref="S4.p3.3.m1.3.3.3.cmml">,</mo><msubsup id="S4.p3.3.m1.3.3.2.2" xref="S4.p3.3.m1.3.3.2.2.cmml"><mi id="S4.p3.3.m1.3.3.2.2.2.2" xref="S4.p3.3.m1.3.3.2.2.2.2.cmml">𝐘</mi><mi id="S4.p3.3.m1.3.3.2.2.3" xref="S4.p3.3.m1.3.3.2.2.3.cmml">N</mi><mtext id="S4.p3.3.m1.3.3.2.2.2.3" xref="S4.p3.3.m1.3.3.2.2.2.3a.cmml">text</mtext></msubsup><mo stretchy="false" id="S4.p3.3.m1.3.3.2.6" xref="S4.p3.3.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m1.3b"><set id="S4.p3.3.m1.3.3.3.cmml" xref="S4.p3.3.m1.3.3.2"><apply id="S4.p3.3.m1.2.2.1.1.cmml" xref="S4.p3.3.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m1.2.2.1.1.1.cmml" xref="S4.p3.3.m1.2.2.1.1">subscript</csymbol><apply id="S4.p3.3.m1.2.2.1.1.2.cmml" xref="S4.p3.3.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m1.2.2.1.1.2.1.cmml" xref="S4.p3.3.m1.2.2.1.1">superscript</csymbol><ci id="S4.p3.3.m1.2.2.1.1.2.2.cmml" xref="S4.p3.3.m1.2.2.1.1.2.2">𝐘</ci><ci id="S4.p3.3.m1.2.2.1.1.2.3a.cmml" xref="S4.p3.3.m1.2.2.1.1.2.3"><mtext mathsize="70%" id="S4.p3.3.m1.2.2.1.1.2.3.cmml" xref="S4.p3.3.m1.2.2.1.1.2.3">text</mtext></ci></apply><cn type="integer" id="S4.p3.3.m1.2.2.1.1.3.cmml" xref="S4.p3.3.m1.2.2.1.1.3">1</cn></apply><ci id="S4.p3.3.m1.1.1.cmml" xref="S4.p3.3.m1.1.1">…</ci><apply id="S4.p3.3.m1.3.3.2.2.cmml" xref="S4.p3.3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.p3.3.m1.3.3.2.2.1.cmml" xref="S4.p3.3.m1.3.3.2.2">subscript</csymbol><apply id="S4.p3.3.m1.3.3.2.2.2.cmml" xref="S4.p3.3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.p3.3.m1.3.3.2.2.2.1.cmml" xref="S4.p3.3.m1.3.3.2.2">superscript</csymbol><ci id="S4.p3.3.m1.3.3.2.2.2.2.cmml" xref="S4.p3.3.m1.3.3.2.2.2.2">𝐘</ci><ci id="S4.p3.3.m1.3.3.2.2.2.3a.cmml" xref="S4.p3.3.m1.3.3.2.2.2.3"><mtext mathsize="70%" id="S4.p3.3.m1.3.3.2.2.2.3.cmml" xref="S4.p3.3.m1.3.3.2.2.2.3">text</mtext></ci></apply><ci id="S4.p3.3.m1.3.3.2.2.3.cmml" xref="S4.p3.3.m1.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m1.3c">\{\mathbf{Y}^{\text{text}}_{1},\ldots,\mathbf{Y}^{\text{text}}_{N}\}</annotation></semantics></math> are N-best hypotheses generated via the text-based two-pass neural biasing in Section <a href="#S3" title="3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Finally, we minimize the CTI-MWER loss across both <math id="S4.p3.4.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.p3.4.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p3.4.m2.1.1" xref="S4.p3.4.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.p3.4.m2.1b"><ci id="S4.p3.4.m2.1.1.cmml" xref="S4.p3.4.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m2.1c">\mathcal{D}</annotation></semantics></math> and <math id="S4.p3.5.m3.1" class="ltx_Math" alttext="\mathcal{D}^{\text{text}}" display="inline"><semantics id="S4.p3.5.m3.1a"><msup id="S4.p3.5.m3.1.1" xref="S4.p3.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.5.m3.1.1.2" xref="S4.p3.5.m3.1.1.2.cmml">𝒟</mi><mtext id="S4.p3.5.m3.1.1.3" xref="S4.p3.5.m3.1.1.3a.cmml">text</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p3.5.m3.1b"><apply id="S4.p3.5.m3.1.1.cmml" xref="S4.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m3.1.1.1.cmml" xref="S4.p3.5.m3.1.1">superscript</csymbol><ci id="S4.p3.5.m3.1.1.2.cmml" xref="S4.p3.5.m3.1.1.2">𝒟</ci><ci id="S4.p3.5.m3.1.1.3a.cmml" xref="S4.p3.5.m3.1.1.3"><mtext mathsize="70%" id="S4.p3.5.m3.1.1.3.cmml" xref="S4.p3.5.m3.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m3.1c">\mathcal{D}^{\text{text}}</annotation></semantics></math>:
</p>
<table id="S6.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\text{CTI-MWER}}=\lambda_{m}\mathcal{L}^{\text{MWER}}(\mathcal{D})+\lambda^{\text{text}}_{m}\mathcal{L}^{\text{MWER}}(\mathcal{D}^{\text{text}})," display="inline"><semantics id="S4.E9.m1.2a"><mrow id="S4.E9.m1.2.2.1" xref="S4.E9.m1.2.2.1.1.cmml"><mrow id="S4.E9.m1.2.2.1.1" xref="S4.E9.m1.2.2.1.1.cmml"><msup id="S4.E9.m1.2.2.1.1.3" xref="S4.E9.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.3.2" xref="S4.E9.m1.2.2.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E9.m1.2.2.1.1.3.3" xref="S4.E9.m1.2.2.1.1.3.3a.cmml">CTI-MWER</mtext></msup><mo id="S4.E9.m1.2.2.1.1.2" xref="S4.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.2.2.1.1.1" xref="S4.E9.m1.2.2.1.1.1.cmml"><mrow id="S4.E9.m1.2.2.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.3.cmml"><msub id="S4.E9.m1.2.2.1.1.1.3.2" xref="S4.E9.m1.2.2.1.1.1.3.2.cmml"><mi id="S4.E9.m1.2.2.1.1.1.3.2.2" xref="S4.E9.m1.2.2.1.1.1.3.2.2.cmml">λ</mi><mi id="S4.E9.m1.2.2.1.1.1.3.2.3" xref="S4.E9.m1.2.2.1.1.1.3.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.3.1" xref="S4.E9.m1.2.2.1.1.1.3.1.cmml">​</mo><msup id="S4.E9.m1.2.2.1.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.1.3.3.2" xref="S4.E9.m1.2.2.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S4.E9.m1.2.2.1.1.1.3.3.3" xref="S4.E9.m1.2.2.1.1.1.3.3.3a.cmml">MWER</mtext></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.3.1a" xref="S4.E9.m1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1.1.3.4.2" xref="S4.E9.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.3.4.2.1" xref="S4.E9.m1.2.2.1.1.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">𝒟</mi><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.3.4.2.2" xref="S4.E9.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.2.2.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S4.E9.m1.2.2.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.cmml"><msubsup id="S4.E9.m1.2.2.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.3.2.2" xref="S4.E9.m1.2.2.1.1.1.1.3.2.2.cmml">λ</mi><mi id="S4.E9.m1.2.2.1.1.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.3.3.cmml">m</mi><mtext id="S4.E9.m1.2.2.1.1.1.1.3.2.3" xref="S4.E9.m1.2.2.1.1.1.1.3.2.3a.cmml">text</mtext></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.2.cmml">​</mo><msup id="S4.E9.m1.2.2.1.1.1.1.4" xref="S4.E9.m1.2.2.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.1.1.4.2" xref="S4.E9.m1.2.2.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S4.E9.m1.2.2.1.1.1.1.4.3" xref="S4.E9.m1.2.2.1.1.1.1.4.3a.cmml">MWER</mtext></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.2a" xref="S4.E9.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E9.m1.2.2.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mtext id="S4.E9.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.3a.cmml">text</mtext></msup><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.2.2.1.2" xref="S4.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.2b"><apply id="S4.E9.m1.2.2.1.1.cmml" xref="S4.E9.m1.2.2.1"><eq id="S4.E9.m1.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.2"></eq><apply id="S4.E9.m1.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.3">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.3.2">ℒ</ci><ci id="S4.E9.m1.2.2.1.1.3.3a.cmml" xref="S4.E9.m1.2.2.1.1.3.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.3.3">CTI-MWER</mtext></ci></apply><apply id="S4.E9.m1.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1"><plus id="S4.E9.m1.2.2.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.2"></plus><apply id="S4.E9.m1.2.2.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3"><times id="S4.E9.m1.2.2.1.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3.1"></times><apply id="S4.E9.m1.2.2.1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.2.2">𝜆</ci><ci id="S4.E9.m1.2.2.1.1.1.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.2.3">𝑚</ci></apply><apply id="S4.E9.m1.2.2.1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.2">ℒ</ci><ci id="S4.E9.m1.2.2.1.1.1.3.3.3a.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3">MWER</mtext></ci></apply><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">𝒟</ci></apply><apply id="S4.E9.m1.2.2.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1"><times id="S4.E9.m1.2.2.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.2"></times><apply id="S4.E9.m1.2.2.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3">subscript</csymbol><apply id="S4.E9.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3.2.2">𝜆</ci><ci id="S4.E9.m1.2.2.1.1.1.1.3.2.3a.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3.2.3">text</mtext></ci></apply><ci id="S4.E9.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.3.3">𝑚</ci></apply><apply id="S4.E9.m1.2.2.1.1.1.1.4.cmml" xref="S4.E9.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.4.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.4">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.4.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.4.2">ℒ</ci><ci id="S4.E9.m1.2.2.1.1.1.1.4.3a.cmml" xref="S4.E9.m1.2.2.1.1.1.1.4.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.1.1.1.1.4.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.4.3">MWER</mtext></ci></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.3">text</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.2c">\displaystyle\mathcal{L}^{\text{CTI-MWER}}=\lambda_{m}\mathcal{L}^{\text{MWER}}(\mathcal{D})+\lambda^{\text{text}}_{m}\mathcal{L}^{\text{MWER}}(\mathcal{D}^{\text{text}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.p3.6" class="ltx_p">where <math id="S4.p3.6.m1.2" class="ltx_Math" alttext="\lambda_{m},\lambda^{\text{text}}_{m}\in\mathbb{R}" display="inline"><semantics id="S4.p3.6.m1.2a"><mrow id="S4.p3.6.m1.2.2" xref="S4.p3.6.m1.2.2.cmml"><mrow id="S4.p3.6.m1.2.2.2.2" xref="S4.p3.6.m1.2.2.2.3.cmml"><msub id="S4.p3.6.m1.1.1.1.1.1" xref="S4.p3.6.m1.1.1.1.1.1.cmml"><mi id="S4.p3.6.m1.1.1.1.1.1.2" xref="S4.p3.6.m1.1.1.1.1.1.2.cmml">λ</mi><mi id="S4.p3.6.m1.1.1.1.1.1.3" xref="S4.p3.6.m1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.p3.6.m1.2.2.2.2.3" xref="S4.p3.6.m1.2.2.2.3.cmml">,</mo><msubsup id="S4.p3.6.m1.2.2.2.2.2" xref="S4.p3.6.m1.2.2.2.2.2.cmml"><mi id="S4.p3.6.m1.2.2.2.2.2.2.2" xref="S4.p3.6.m1.2.2.2.2.2.2.2.cmml">λ</mi><mi id="S4.p3.6.m1.2.2.2.2.2.3" xref="S4.p3.6.m1.2.2.2.2.2.3.cmml">m</mi><mtext id="S4.p3.6.m1.2.2.2.2.2.2.3" xref="S4.p3.6.m1.2.2.2.2.2.2.3a.cmml">text</mtext></msubsup></mrow><mo id="S4.p3.6.m1.2.2.3" xref="S4.p3.6.m1.2.2.3.cmml">∈</mo><mi id="S4.p3.6.m1.2.2.4" xref="S4.p3.6.m1.2.2.4.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.6.m1.2b"><apply id="S4.p3.6.m1.2.2.cmml" xref="S4.p3.6.m1.2.2"><in id="S4.p3.6.m1.2.2.3.cmml" xref="S4.p3.6.m1.2.2.3"></in><list id="S4.p3.6.m1.2.2.2.3.cmml" xref="S4.p3.6.m1.2.2.2.2"><apply id="S4.p3.6.m1.1.1.1.1.1.cmml" xref="S4.p3.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m1.1.1.1.1.1.1.cmml" xref="S4.p3.6.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.p3.6.m1.1.1.1.1.1.2.cmml" xref="S4.p3.6.m1.1.1.1.1.1.2">𝜆</ci><ci id="S4.p3.6.m1.1.1.1.1.1.3.cmml" xref="S4.p3.6.m1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S4.p3.6.m1.2.2.2.2.2.cmml" xref="S4.p3.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p3.6.m1.2.2.2.2.2.1.cmml" xref="S4.p3.6.m1.2.2.2.2.2">subscript</csymbol><apply id="S4.p3.6.m1.2.2.2.2.2.2.cmml" xref="S4.p3.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p3.6.m1.2.2.2.2.2.2.1.cmml" xref="S4.p3.6.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.p3.6.m1.2.2.2.2.2.2.2.cmml" xref="S4.p3.6.m1.2.2.2.2.2.2.2">𝜆</ci><ci id="S4.p3.6.m1.2.2.2.2.2.2.3a.cmml" xref="S4.p3.6.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.p3.6.m1.2.2.2.2.2.2.3.cmml" xref="S4.p3.6.m1.2.2.2.2.2.2.3">text</mtext></ci></apply><ci id="S4.p3.6.m1.2.2.2.2.2.3.cmml" xref="S4.p3.6.m1.2.2.2.2.2.3">𝑚</ci></apply></list><ci id="S4.p3.6.m1.2.2.4.cmml" xref="S4.p3.6.m1.2.2.4">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m1.2c">\lambda_{m},\lambda^{\text{text}}_{m}\in\mathbb{R}</annotation></semantics></math> are loss weights.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">To enhance the ASR performance in the <em id="S4.p4.1.1" class="ltx_emph ltx_font_italic">absence</em> of bias phrases, we selectively activate the biasing component during CTI MWER training. We do this by feeding in empty bias phrases for a specific percentage of the training data.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Data</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Our supervised training data comprises 520 million multi-domain English audio-transcript pairs (490 thousand (K) hours) from voice search (VS) traffic as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
In addition, we leverage a much larger corpus of unpaired text for text injection, exceeding the size of audio-transcript pairs by two orders of magnitude. This corpus consists of 100B anonymized sentences drawn from Maps, Google Play, Web, and YouTube domains as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">We assess our models across various test sets.
The head common-word test set comprises roughly 12K anonymized and hand-transcribed VS utterances with an average duration of 5.5 seconds.
For rare-word evaluation, we utilize a multi-context biasing corpus from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, consisting of three sets:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">NO_PRE</span>: 1.3K utterances matching prefix-less patterns from <span id="S5.I1.i1.p1.1.2" class="ltx_text ltx_font_typewriter">$APPS</span>, <span id="S5.I1.i1.p1.1.3" class="ltx_text ltx_font_typewriter">$CONTACTS</span>, <span id="S5.I1.i1.p1.1.4" class="ltx_text ltx_font_typewriter">$SONGS</span> categories (i.e., ACS).</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">PRE</span>: 2.6K utterances matching prefixed patterns like ``open <span id="S5.I1.i2.p1.1.2" class="ltx_text ltx_font_typewriter">$APPS</span>'', ``call <span id="S5.I1.i2.p1.1.3" class="ltx_text ltx_font_typewriter">$CONTACTS</span>'', ``play <span id="S5.I1.i2.p1.1.4" class="ltx_text ltx_font_typewriter">$SONGS</span>''.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">ANTI</span>: 1K utterances from general voice assistant queries.</p>
</div>
</li>
</ul>
<p id="S5.SS1.p2.2" class="ltx_p">In all three sets, each utterance is assigned 150, 300, 600, 1500, 3000 ACS bias phrases. The NO_PRE and PRE sets evaluate <em id="S5.SS1.p2.2.1" class="ltx_emph ltx_font_italic">in-context</em> performance where one bias phrase actually appears in the transcript truth, while the ANTI set assesses <em id="S5.SS1.p2.2.2" class="ltx_emph ltx_font_italic">anti-context</em> performance where only distractor bias phrases are assigned.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Modeling Architecture</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">This work utilizes a non-streaming hybrid autoregressive transducer (HAT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> for ASR.
We extract 128-dim log Mel filterbanks from speech and subsample it with two 2D-convolution layers, resulting a 512-dim feature every 40 ms.
The HAT acoustic encoder is based on the architecture of Google USM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.
It starts with 2 convolution layers, followed by 12 conformer layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Each conformer layer uses a 8-head local self-attention with 512 dimensions and a convolution kernel of size 10. Funnel pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> reduces the computation latency, resulting in a frame rate of 320ms at the encoder output <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
The HAT decoder is a 640-dim <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="|V|^{2}" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><msup id="S5.SS2.p1.1.m1.1.2" xref="S5.SS2.p1.1.m1.1.2.cmml"><mrow id="S5.SS2.p1.1.m1.1.2.2.2" xref="S5.SS2.p1.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="S5.SS2.p1.1.m1.1.2.2.2.1" xref="S5.SS2.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">V</mi><mo stretchy="false" id="S5.SS2.p1.1.m1.1.2.2.2.2" xref="S5.SS2.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mn id="S5.SS2.p1.1.m1.1.2.3" xref="S5.SS2.p1.1.m1.1.2.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.2.1.cmml" xref="S5.SS2.p1.1.m1.1.2">superscript</csymbol><apply id="S5.SS2.p1.1.m1.1.2.2.1.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2"><abs id="S5.SS2.p1.1.m1.1.2.2.1.1.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.1"></abs><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑉</ci></apply><cn type="integer" id="S5.SS2.p1.1.m1.1.2.3.cmml" xref="S5.SS2.p1.1.m1.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">|V|^{2}</annotation></semantics></math> embedding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>.
The output vocabulary consists of 4096 lowercase word-pieces. HAT has 857M parameters in total.
</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.2" class="ltx_p">The neural biasing is applied at 4th encoder layer of HAT (<math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="l=4" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><eq id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></eq><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">l=4</annotation></semantics></math>). The phrase encoder is a 4-layer deep averaging network with
256 hidden units (788K parameters). The word-piece encoder is a 1-layer conformer with 256 hidden units (1M parameters).
The projection layers in correlation and cross-attention have 7.3M parameters.
All biasing components are significantly smaller than the main HAT.
The bias strength <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="\lambda_{c}" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">λ</mi><mi id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝜆</ci><ci id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">\lambda_{c}</annotation></semantics></math> is set to 1.0 during training and 0.6 during inference.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Text injection for Neural Contextual Biasing</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We first train a baseline HAT with deferred NAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> using only the supervised data, and show its results in Table <a href="#footnote3" title="footnote 3 ‣ Table 1 ‣ 5.3 Text injection for Neural Contextual Biasing ‣ 5 Experiments ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
<math id="S5.SS3.p1.1.m1.2" class="ltx_Math" alttext="\lambda_{a}=0.9,\lambda_{r}=0.1,K=32" display="inline"><semantics id="S5.SS3.p1.1.m1.2a"><mrow id="S5.SS3.p1.1.m1.2.2.2" xref="S5.SS3.p1.1.m1.2.2.3.cmml"><mrow id="S5.SS3.p1.1.m1.1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.1.cmml"><msub id="S5.SS3.p1.1.m1.1.1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.1.1.2.cmml"><mi id="S5.SS3.p1.1.m1.1.1.1.1.2.2" xref="S5.SS3.p1.1.m1.1.1.1.1.2.2.cmml">λ</mi><mi id="S5.SS3.p1.1.m1.1.1.1.1.2.3" xref="S5.SS3.p1.1.m1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S5.SS3.p1.1.m1.1.1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.1.1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="S5.SS3.p1.1.m1.2.2.2.3" xref="S5.SS3.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p1.1.m1.2.2.2.2.2" xref="S5.SS3.p1.1.m1.2.2.2.2.3.cmml"><mrow id="S5.SS3.p1.1.m1.2.2.2.2.1.1" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.cmml"><msub id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.2" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.2.cmml">λ</mi><mi id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.3" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.3.cmml">r</mi></msub><mo id="S5.SS3.p1.1.m1.2.2.2.2.1.1.1" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.2.2.2.2.1.1.3" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.3.cmml">0.1</mn></mrow><mo id="S5.SS3.p1.1.m1.2.2.2.2.2.3" xref="S5.SS3.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p1.1.m1.2.2.2.2.2.2" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="S5.SS3.p1.1.m1.2.2.2.2.2.2.2" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.2.cmml">K</mi><mo id="S5.SS3.p1.1.m1.2.2.2.2.2.2.1" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.2.2.2.2.2.2.3" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.3.cmml">32</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.2b"><apply id="S5.SS3.p1.1.m1.2.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.2.2.3a.cmml" xref="S5.SS3.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p1.1.m1.1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1"><eq id="S5.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.1"></eq><apply id="S5.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.1.2.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.1.1.2.2.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.2.2">𝜆</ci><ci id="S5.SS3.p1.1.m1.1.1.1.1.2.3.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.2.3">𝑎</ci></apply><cn type="float" id="S5.SS3.p1.1.m1.1.1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.3">0.9</cn></apply><apply id="S5.SS3.p1.1.m1.2.2.2.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.2.2.2.2.3a.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p1.1.m1.2.2.2.2.1.1.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1"><eq id="S5.SS3.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.1"></eq><apply id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.2">𝜆</ci><ci id="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.2.3">𝑟</ci></apply><cn type="float" id="S5.SS3.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.1.1.3">0.1</cn></apply><apply id="S5.SS3.p1.1.m1.2.2.2.2.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2"><eq id="S5.SS3.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.1"></eq><ci id="S5.SS3.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.2">𝐾</ci><cn type="integer" id="S5.SS3.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2.2.2.3">32</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.2c">\lambda_{a}=0.9,\lambda_{r}=0.1,K=32</annotation></semantics></math> for all the experiments. Note that, for each biasing test set, the reported WER is the average across 5 different scenarios where the model receives varying number of bias entities.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S5.T1.1.1.1.1.1" class="ltx_text">
<span id="S5.T1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S5.T1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Method</span></span>
</span></span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_tt" rowspan="2"><span id="S5.T1.1.1.1.2.1" class="ltx_text">
<span id="S5.T1.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.1.1.2.1.1.1" class="ltx_tr">
<span id="S5.T1.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">    VS</span></span>
</span></span></th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">In-Context</th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S5.T1.1.1.1.4.1" class="ltx_text">
<span id="S5.T1.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.1.1.4.1.1.1" class="ltx_tr">
<span id="S5.T1.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">  ANTI</span></span>
</span></span></th>
</tr>
<tr id="S5.T1.1.2.2" class="ltx_tr">
<th id="S5.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">NO_PRE</th>
<th id="S5.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">   PRE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.3.1" class="ltx_tr">
<th id="S5.T1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Sup</th>
<th id="S5.T1.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t">4.1</th>
<td id="S5.T1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.0</td>
<td id="S5.T1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.3</td>
<td id="S5.T1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">1.8</td>
</tr>
<tr id="S5.T1.1.4.2" class="ltx_tr">
<th id="S5.T1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">JOIST</th>
<th id="S5.T1.1.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr">4.0</th>
<td id="S5.T1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">2.2</td>
<td id="S5.T1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">2.1</td>
<td id="S5.T1.1.4.2.5" class="ltx_td ltx_align_center">1.9</td>
</tr>
<tr id="S5.T1.1.5.3" class="ltx_tr">
<th id="S5.T1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">CTI</th>
<th id="S5.T1.1.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_rr"><span id="S5.T1.1.5.3.2.1" class="ltx_text ltx_font_bold">3.9</span></th>
<td id="S5.T1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T1.1.5.3.3.1" class="ltx_text ltx_font_bold">1.7</span></td>
<td id="S5.T1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T1.1.5.3.4.1" class="ltx_text ltx_font_bold">1.7</span></td>
<td id="S5.T1.1.5.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.5.3.5.1" class="ltx_text ltx_font_bold">1.6</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>WERs (%) for HAT with neural contextual biasing.<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Without contextual biasing, HAT with JOIST and text-injected MWER achieves 4.0%, 22.1%, 10.5% and 1.6% WERs on VS, NO_PRE, PRE and ANTI, respectively.</span></span></span> The models are trained from scratch using supervised data (Sup), JOIST or contextual text injection (CTI).</figcaption>
</figure>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.2" class="ltx_p">Then we perform JOIST training of HAT with deferred NAM by injecting unpaired text <em id="S5.SS3.p2.2.1" class="ltx_emph ltx_font_italic">only</em> to the acoustic encoder of HAT. No neural biasing (Eqs. (<a href="#S3.E3" title="In 3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) – (<a href="#S3.E5" title="In 3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)) is performed with unpaired text. The settings are consistent with those used for JOIST on HAT:
the unpaired text is tokenized into phoneme sequences. Each token is repeated a random number of times. The random number is sampled from a uniform distribution between 1 and 2. We mask 30% of the upsampled tokens with spans of <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="S=10" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">S</mi><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><eq id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></eq><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝑆</ci><cn type="integer" id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">S=10</annotation></semantics></math> and feed it into a phoneme encoder. The phoneme embeddings are finally inputted to the 3rd conformer layer of the acoustic encoder. <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="\lambda^{\text{text}}_{a}" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><msubsup id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2.2" xref="S5.SS3.p2.2.m2.1.1.2.2.cmml">λ</mi><mi id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">a</mi><mtext id="S5.SS3.p2.2.m2.1.1.2.3" xref="S5.SS3.p2.2.m2.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">subscript</csymbol><apply id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.2.1.cmml" xref="S5.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.2.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2.2">𝜆</ci><ci id="S5.SS3.p2.2.m2.1.1.2.3a.cmml" xref="S5.SS3.p2.2.m2.1.1.2.3"><mtext mathsize="70%" id="S5.SS3.p2.2.m2.1.1.2.3.cmml" xref="S5.SS3.p2.2.m2.1.1.2.3">text</mtext></ci></apply><ci id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\lambda^{\text{text}}_{a}</annotation></semantics></math> is set to 0.1 for all the experiments.
JOIST improves the in-context biasing by 26.7% and 8.7% relatively on PRE and NO_PRE, but degrades the anti-context set by 5.5%.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.4" class="ltx_p">Further, we conduct contextual text injection as described in Section <a href="#S3" title="3 Contextual Text Injection ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We follow the same tokenization and upsampling procedure for unpaired text as used in JOIST.
Without any masking, we directly embed these upsampled phoneme tokens via a phoneme encoder and fed them into the 3rd conformer layer of the acoustic encoder (<math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="l^{\text{text}}=3" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><msup id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2.2" xref="S5.SS3.p3.1.m1.1.1.2.2.cmml">l</mi><mtext id="S5.SS3.p3.1.m1.1.1.2.3" xref="S5.SS3.p3.1.m1.1.1.2.3a.cmml">text</mtext></msup><mo id="S5.SS3.p3.1.m1.1.1.1" xref="S5.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><eq id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1.1"></eq><apply id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p3.1.m1.1.1.2.1.cmml" xref="S5.SS3.p3.1.m1.1.1.2">superscript</csymbol><ci id="S5.SS3.p3.1.m1.1.1.2.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2.2">𝑙</ci><ci id="S5.SS3.p3.1.m1.1.1.2.3a.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3"><mtext mathsize="70%" id="S5.SS3.p3.1.m1.1.1.2.3.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3">text</mtext></ci></apply><cn type="integer" id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">l^{\text{text}}=3</annotation></semantics></math>). The neural biasing is then performed with both real and text-based acoustic embeddings at the output of the 5th conformer layer (<math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="l=5" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><mi id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml">l</mi><mo id="S5.SS3.p3.2.m2.1.1.1" xref="S5.SS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.2.m2.1.1.3" xref="S5.SS3.p3.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><eq id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1.1"></eq><ci id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S5.SS3.p3.2.m2.1.1.3.cmml" xref="S5.SS3.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">l=5</annotation></semantics></math>). The text-based biased acoustic embeddings are masked at the 7th conformer layer (<math id="S5.SS3.p3.3.m3.1" class="ltx_Math" alttext="l^{\text{mask}}" display="inline"><semantics id="S5.SS3.p3.3.m3.1a"><msup id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml"><mi id="S5.SS3.p3.3.m3.1.1.2" xref="S5.SS3.p3.3.m3.1.1.2.cmml">l</mi><mtext id="S5.SS3.p3.3.m3.1.1.3" xref="S5.SS3.p3.3.m3.1.1.3a.cmml">mask</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.3.m3.1.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S5.SS3.p3.3.m3.1.1.2.cmml" xref="S5.SS3.p3.3.m3.1.1.2">𝑙</ci><ci id="S5.SS3.p3.3.m3.1.1.3a.cmml" xref="S5.SS3.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S5.SS3.p3.3.m3.1.1.3.cmml" xref="S5.SS3.p3.3.m3.1.1.3">mask</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">l^{\text{mask}}</annotation></semantics></math>=7). <math id="S5.SS3.p3.4.m4.1" class="ltx_Math" alttext="\lambda^{\text{text}}_{r}" display="inline"><semantics id="S5.SS3.p3.4.m4.1a"><msubsup id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.2.2" xref="S5.SS3.p3.4.m4.1.1.2.2.cmml">λ</mi><mi id="S5.SS3.p3.4.m4.1.1.3" xref="S5.SS3.p3.4.m4.1.1.3.cmml">r</mi><mtext id="S5.SS3.p3.4.m4.1.1.2.3" xref="S5.SS3.p3.4.m4.1.1.2.3a.cmml">text</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><apply id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1">subscript</csymbol><apply id="S5.SS3.p3.4.m4.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.4.m4.1.1.2.1.cmml" xref="S5.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S5.SS3.p3.4.m4.1.1.2.2.cmml" xref="S5.SS3.p3.4.m4.1.1.2.2">𝜆</ci><ci id="S5.SS3.p3.4.m4.1.1.2.3a.cmml" xref="S5.SS3.p3.4.m4.1.1.2.3"><mtext mathsize="70%" id="S5.SS3.p3.4.m4.1.1.2.3.cmml" xref="S5.SS3.p3.4.m4.1.1.2.3">text</mtext></ci></apply><ci id="S5.SS3.p3.4.m4.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">\lambda^{\text{text}}_{r}</annotation></semantics></math> is set to 0.1.
CTI demonstrates substantial and consistent improvement over JOIST on all biasing test sets and VS, resulting in total relative WER reductions of 43.3%, 26.1% on in-context sets, 11.1% on the anti-context set, and 4.9% on head VS from the supervised baseline.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>MWER Training for Neural Contextual Biasing</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We initialize all the MWER training with the CTI model which has achieved the best WERs so far.
We first perform MWER training with only supervised data to minimize the loss in Eq. (<a href="#S4.E8" title="In 4 Contextual Text-Injected MWER ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;" rowspan="2"><span id="S5.T2.1.1.1.1.1" class="ltx_text">
<span id="S5.T2.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S5.T2.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;">     Method</span></span>
</span></span></th>
<th id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;" rowspan="2"><span id="S5.T2.1.1.1.2.1" class="ltx_text">
<span id="S5.T2.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.1.1.2.1.1.1" class="ltx_tr">
<span id="S5.T2.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;">    VS</span></span>
</span></span></th>
<th id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;" colspan="2">In-Context</th>
<th id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;" rowspan="2"><span id="S5.T2.1.1.1.4.1" class="ltx_text">
<span id="S5.T2.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.1.1.4.1.1.1" class="ltx_tr">
<span id="S5.T2.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;">  ANTI</span></span>
</span></span></th>
</tr>
<tr id="S5.T2.1.2.2" class="ltx_tr">
<th id="S5.T2.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">NO_PRE</th>
<th id="S5.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">   PRE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.3.1" class="ltx_tr">
<th id="S5.T2.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">CTI</th>
<th id="S5.T2.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">3.9</th>
<td id="S5.T2.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">1.7</td>
<td id="S5.T2.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">1.7</td>
<td id="S5.T2.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S5.T2.1.3.1.5.1" class="ltx_text ltx_font_bold">1.6</span></td>
</tr>
<tr id="S5.T2.1.4.2" class="ltx_tr">
<th id="S5.T2.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">+ MWER</th>
<th id="S5.T2.1.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr" style="padding-left:4.5pt;padding-right:4.5pt;">3.9</th>
<td id="S5.T2.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">1.7</td>
<td id="S5.T2.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">1.5</td>
<td id="S5.T2.1.4.2.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;">1.9</td>
</tr>
<tr id="S5.T2.1.5.3" class="ltx_tr">
<th id="S5.T2.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">+ JOIST MWER</th>
<th id="S5.T2.1.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S5.T2.1.5.3.2.1" class="ltx_text ltx_font_bold">3.8</span></th>
<td id="S5.T2.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">1.5</td>
<td id="S5.T2.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">1.4</td>
<td id="S5.T2.1.5.3.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;">1.9</td>
</tr>
<tr id="S5.T2.1.6.4" class="ltx_tr">
<th id="S5.T2.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;">+ CTI MWER</th>
<th id="S5.T2.1.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_rr" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S5.T2.1.6.4.2.1" class="ltx_text ltx_font_bold">3.8</span></th>
<td id="S5.T2.1.6.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S5.T2.1.6.4.3.1" class="ltx_text ltx_font_bold">1.3</span></td>
<td id="S5.T2.1.6.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S5.T2.1.6.4.4.1" class="ltx_text ltx_font_bold">1.3</span></td>
<td id="S5.T2.1.6.4.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.5pt;padding-right:4.5pt;">1.8</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>WERs (%) for HAT with neural contextual biasing. The models are trained in two stages: first with contextual text injection (CTI), and then fine-tuned using MWER, JOIST-based MWER, or contextual text-injected (CTI) MWER training.</figcaption>
</figure>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">As in Table <a href="#S5.T2" title="Table 2 ‣ 5.4 MWER Training for Neural Contextual Biasing ‣ 5 Experiments ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, MWER significantly improves over CTI on the in-context PRE and the head VS, but degrades on the anti-context test set. We then perform JOIST-based MWER <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> by injecting text into only the HAT encoder. During this process, the biasing modules are updated with only the supervised data. Compared to the MWER training, JOIST-based MWER dramatically reduces WERs on NO_PRE. Finally, we perform contextual text-injected MWER (Section <a href="#S4" title="4 Contextual Text-Injected MWER ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), updating both HAT and biasing modules with supervised data and unpaired text. CTI MWER significantly outperforms JOIST-based MWER across VS and all biasing sets.
Moreover, CTI MWER offers remarkable improvement over CTI on all test sets, achieving total relative WER reductions of a 56.7%, 43.5% on in-context biasing sets, and 7.3% on head VS from the supervised baseline.
Note that, to reduce the WER also on head VS, we selectively drop out the neural biasing component for 30% of the training mini-batches.
</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Scalability to Number of Bias Phrases</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">We gradually increase the number of bias phrases assigned to each test utterance (0-3,000) when evaluating HAT with deferred NAM on the NO_PRE in-context biasing set in Table <a href="#S5.T3" title="Table 3 ‣ 5.5 Scalability to Number of Bias Phrases ‣ 5 Experiments ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Despite the consistent increase in WER with more bias phrases, CTI and CTI MWER remarkably maintain WER below 1.8% even at the maximum 3000 bias phrases. Importantly, the performance trends observed in Sections <a href="#S5.SS3" title="5.3 Text injection for Neural Contextual Biasing ‣ 5 Experiments ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>, <a href="#S5.SS4" title="5.4 MWER Training for Neural Contextual Biasing ‣ 5 Experiments ‣ Text Injection for Neural Contextual Biasing" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a> persist across all bias phrase counts: CTI and CTI MWER outperform the baseline supervised model, with their advantage increasing as the number of phrases decreases. These trends hold consistently for PRE and ANTI biasing sets as well.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.8pt;padding-right:3.8pt;" rowspan="2"><span id="S5.T3.1.1.1.1.1" class="ltx_text">
<span id="S5.T3.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S5.T3.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.8pt;padding-right:3.8pt;">    Method</span></span>
</span></span></th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_tt" style="padding-left:3.8pt;padding-right:3.8pt;">VS</th>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.8pt;padding-right:3.8pt;" colspan="6">In-Context: NO_PRE</td>
</tr>
<tr id="S5.T3.1.2.2" class="ltx_tr">
<th id="S5.T3.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">  0</th>
<td id="S5.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">0</td>
<td id="S5.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;"> 150</td>
<td id="S5.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;"> 300</td>
<td id="S5.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;"> 600</td>
<td id="S5.T3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">1500</td>
<td id="S5.T3.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">3000</td>
</tr>
<tr id="S5.T3.1.3.3" class="ltx_tr">
<th id="S5.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">Sup</th>
<th id="S5.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">4.1</th>
<td id="S5.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">22.2</td>
<td id="S5.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">2.7</td>
<td id="S5.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">2.7</td>
<td id="S5.T3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">2.8</td>
<td id="S5.T3.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">3.4</td>
<td id="S5.T3.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">3.5</td>
</tr>
<tr id="S5.T3.1.4.4" class="ltx_tr">
<th id="S5.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">CTI</th>
<th id="S5.T3.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">3.9</th>
<td id="S5.T3.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.4.4.3.1" class="ltx_text ltx_font_bold">21.8</span></td>
<td id="S5.T3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">1.3</td>
<td id="S5.T3.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">1.4</td>
<td id="S5.T3.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">1.7</td>
<td id="S5.T3.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">1.8</td>
<td id="S5.T3.1.4.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.8pt;padding-right:3.8pt;">2.1</td>
</tr>
<tr id="S5.T3.1.5.5" class="ltx_tr">
<th id="S5.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;">+ CTI MWER</th>
<th id="S5.T3.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_rr" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.2.1" class="ltx_text ltx_font_bold">3.8</span></th>
<td id="S5.T3.1.5.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.3.1" class="ltx_text ltx_font_bold">21.8</span></td>
<td id="S5.T3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.4.1" class="ltx_text ltx_font_bold">1.1</span></td>
<td id="S5.T3.1.5.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.5.1" class="ltx_text ltx_font_bold">1.2</span></td>
<td id="S5.T3.1.5.5.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.6.1" class="ltx_text ltx_font_bold">1.2</span></td>
<td id="S5.T3.1.5.5.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.7.1" class="ltx_text ltx_font_bold">1.4</span></td>
<td id="S5.T3.1.5.5.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.8pt;padding-right:3.8pt;"><span id="S5.T3.1.5.5.8.1" class="ltx_text ltx_font_bold">1.8</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>WERs (%) for supervised training, contextual text injection (CTI) and contextual text-injected (CTI) MWER training with respect to the number of bias phrases (0-3000) assigned to each test utterance.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We propose a novel contextual text injection that injects unpaired text to not only the ASR encoder, but also its biasing component. We further introduce contextual text-injected MWER training, a method that fine-tunes the ASR model with neural biasing to minimize an additional text-based MWER objective. CTI reduces the WER of a HAT with deferred NAM by 26.1%-43.3% relatively on in-context biasing sets, 11.1% relatively on the anti-context set, and 4.9% on voice search. Further, CTI MWER achieves additional 23.5% relative WER reductions over CTI on in-context biasing sets.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C.-C. Chiu, T. N. Sainath, and Y. Wu, ``State-of-the-art speech recognition with sequence-to-sequence models,'' in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Jain, K. Schubert, J. Mahadeokar <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``RNN-T for latency controlled ASR with improved beam search,'' <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.01629</em>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T. Sainath, Y. He, B. Li <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``A streaming on-device end-to-end model surpassing server-side conventional model quality and latency,'' in <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Li, R. Zhao, Z. Meng <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Developing RNN-T models surpassing high-performance hybrid models with customization capability,'' in <em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic">Interspeech</em>, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Zeyer, A. Merboldt, R. Schlüter <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``A new training pipeline for an improved neural transducer,'' <em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
T. Sainath, Y. He, A. Narayanan <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``An efficient streaming non-recurrent on-device end-to-end model with improvements to rare-word modeling,'' <em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Vasserman, B. Haynor, and P. Aleksic, ``Contextual language model adaptation using dynamic classes,'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. SLT</em>.   IEEE, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
P. Aleksic, M. Ghodsi, A. Michaely <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Bringing contextual information to google speech recognition,'' in <em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
I. McGraw, R. Prabhavalkar, R. Alvarez <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Personalized speech recognition on mobile devices,'' in <em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
D. Zhao, T. Sainath, D. Rybach <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Shallow-fusion end-to-end contextual biasing.'' in <em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic">Interspeech</em>, 2019, pp. 1418–1422.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
W. Wang, Z. Wu, D. Caseiro <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Contextual biasing with the Knuth-Morris-Pratt matching algorithm,'' <em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.00178</em>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Pundak, T. N. Sainath, R. Prabhavalkar <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Deep context: end-to-end contextual speech recognition,'' in <em id="bib.bib12.2.2" class="ltx_emph ltx_font_italic">Proc. SLT</em>.   IEEE, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Jain, G. Keren, J. Mahadeokar <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Contextual RNN-T for open domain asr,'' <em id="bib.bib13.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
F.-J. Chang, J. Liu, M. Radfar <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Context-aware transformer transducer for speech recognition,'' in <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Proc. ASRU</em>.   IEEE, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
T. Munkhdalai, K. C. Sim, A. Chandorkar <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Fast contextual adaptation with neural associative memory for on-device personalized speech recognition,'' in <em id="bib.bib15.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
T. Munkhdalai, Z. Wu, G. Pundak <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``NAM+: Towards scalable end-to-end contextual biasing for adaptive asr,'' in <em id="bib.bib16.2.2" class="ltx_emph ltx_font_italic">Proc. SLT</em>.   IEEE, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Z. Wu, T. Munkhdalai, P. Rondon <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Dual-mode NAM: Effective top-k context injection for end-to-end asr,'' <em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Z. Wu, G. Song, C. Li <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Deferred NAM: Low-latency top-K context injection via deferred context encoding for non-streaming ASR,'' <em id="bib.bib18.2.2" class="ltx_emph ltx_font_italic">Proc. NAACL 2024 - Industry Track</em>, 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
J. Pylkkönen, A. Ukkonen, J. Kilpikoski <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Fast text-only domain adaptation of RNN-transducer prediction network,'' <em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Z. Meng, Y. Gaur, N. Kanda <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Internal language model adaptation with text-only data for end-to-end speech recognition,'' in <em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic">Interspeech</em>, 2022.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
X. Chen, Z. Meng <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Factorized neural transducer for efficient language model adaptation,'' in <em id="bib.bib21.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Z. Meng, T. Chen, R. Prabhavalkar <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Modular hybrid autoregressive transducer,'' in <em id="bib.bib22.2.2" class="ltx_emph ltx_font_italic">Proc. SLT</em>.   IEEE, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Z. Meng, W. Wang, R. Prabhavalkar <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``JEIT: Joint end-to-end model and internal language model training for speech recognition,'' in <em id="bib.bib23.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2023.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
S. Bijwadia, S.-y. Chang, W. Wang <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Text injection for capitalization and turn-taking prediction in speech models,'' <em id="bib.bib24.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
X. Gong, Y. Wu, J. Li <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Advanced long-content speech recognition with factorized neural transducer,'' <em id="bib.bib25.2.2" class="ltx_emph ltx_font_italic">TASLP</em>, 2024.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
E. Variani, D. Rybach, C. Allauzen <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Hybrid autoregressive transducer (HAT),'' in <em id="bib.bib26.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z. Meng, S. Parthasarathy, E. Sun <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Internal language model estimation for domain-adaptive end-to-end speech recognition,'' in <em id="bib.bib27.2.2" class="ltx_emph ltx_font_italic">Proc. SLT</em>.   IEEE, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Meng, N. Kanda, Y. Gaur <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Internal language model training for domain-adaptive end-to-end speech recognition,'' in <em id="bib.bib28.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
A. Bapna, Y.-A. Chung, N. Wu <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``SLAM: A unified encoder for speech and language modeling via speech-text joint pre-training,'' <em id="bib.bib29.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.10329</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Tang, H. Gong, N. Dong <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Unified speech-text pre-training for speech translation and recognition,'' in <em id="bib.bib30.2.2" class="ltx_emph ltx_font_italic">Proc. ACL</em>, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
S. Thomas, H. J. Kuo, B. Kingsbury <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Towards reducing the need for speech training data to build spoken language understanding systems,'' in <em id="bib.bib31.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Z. Chen, Y. Zhang, A. Rosenberg <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``MAESTRO: Matched speech text representations through modality matching,'' in <em id="bib.bib32.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
T. Sainath, R. Prabhavalkar <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``JOIST: A joint speech and text streaming model for ASR,'' <em id="bib.bib33.2.2" class="ltx_emph ltx_font_italic">Proc. SLT</em>, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
C. Peyser, Z. Meng, K. Hu <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Improving joint speech-text representations without alignment,'' <em id="bib.bib34.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2023.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
K. Wei, B. Li, H. Lv <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Conversational speech recognition by learning audio-textual cross-modal contextual representation,'' <em id="bib.bib35.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.14278</em>, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
T. N. Sainath, R. Prabhavalkar, D. Caseiro <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Improving contextual biasing with text injection,'' in <em id="bib.bib36.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Graves, ``Sequence transduction with recurrent neural networks,'' <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proc. ICML</em>, 2012.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
A. Baevski, Y. Zhou, A. Mohamed <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``wav2vec 2.0: A framework for self-supervised learning of speech representations,'' <em id="bib.bib38.2.2" class="ltx_emph ltx_font_italic">Proc. NeurlIPS</em>, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
R. Prabhavalkar, T. Sainath, Y. Wu <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Minimum word error rate training for attention-based sequence-to-sequence models,'' in <em id="bib.bib39.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>.   IEEE, 2018.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
L. Lu, Z. Meng, N. Kanda <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``On minimum word error rate training of the hybrid autoregressive transducer,'' <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.12673</em>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Z. Meng, Y. Wu, N. Kanda <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Minimum word error rate training with language model fusion for end-to-end speech recognition,'' <em id="bib.bib41.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
R. Prabhavalkar, Z. Meng, W. Wang <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Extreme encoder output frame rate reduction: Improving computational latencies of large end-to-end models,'' <em id="bib.bib42.2.2" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2024.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Y. Zhang, W. Han, J. Qin <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Google USM: Scaling automatic speech recognition beyond 100 languages,'' <em id="bib.bib43.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.01037</em>, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
A. Gulati, J. Qin, C. Chiu <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Conformer: Convolution-augmented transformer for speech recognition,'' <em id="bib.bib44.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Z. Dai, G. Lai, Y. Yang <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Funnel-transformer: Filtering out sequential redundancy for efficient language processing,'' <em id="bib.bib45.2.2" class="ltx_emph ltx_font_italic">Proc. NeurlIPS</em>, 2020.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
W. Wang, R. Prabhavalkar, D. Hwang <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Massive end-to-end models for short search queries,'' <em id="bib.bib46.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.12963</em>, 2023.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
R. Botros, T. N. Sainath, R. David <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">et al.</em>, ``Tied &amp; reduced RNN-T decoder,'' <em id="bib.bib47.2.2" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.02919" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.02921" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.02921">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.02921" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.02922" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 23:41:22 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
