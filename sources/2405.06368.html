<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.06368] DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation</title><meta property="og:description" content="Federated learning (FL) allows clients in an Internet of Things (IoT) system to collaboratively train a global model without sharing their local data with a server.
However, clients’ contributions to the server can sti…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.06368">

<!--Generated on Wed Jun  5 18:45:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated learning,  differential privacy,  parameter-efficient fine-tuning.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jie Xu, Karthikeyan Saravanan,
Rogier van Dalen,
Haaris Mehmood,
David Tuckey,
Mete Ozay
</span><span class="ltx_author_notes">Manuscript received MM DD, YY; revised MM DD, YY.Jie Xu, Karthikeyan Saravanan, Haaris Mehmood, David Tuckey and Mete Ozay are with Samsung R&amp;D Institute UK.Rogier van Dalen is with Samsung AI Center Cambridge.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Federated learning (FL) allows clients in an Internet of Things (IoT) system to collaboratively train a global model without sharing their local data with a server.
However, clients’ contributions to the server can still leak sensitive information.
Differential privacy (DP) addresses such leakage by providing formal privacy guarantees, with mechanisms that add randomness to the clients’ contributions.
The randomness makes it infeasible to train large transformer-based models, common in modern IoT systems.
In this work, we empirically evaluate the practicality of fine-tuning large scale on-device transformer-based models with differential privacy in a federated learning system.
We conduct comprehensive experiments on various system properties for tasks spanning a multitude of domains: speech recognition, computer vision (CV) and natural language understanding (NLU).
Our results show that full fine-tuning under differentially private federated learning (DP-FL) generally leads to huge performance degradation which can be alleviated by reducing the dimensionality of contributions through parameter-efficient fine-tuning (PEFT).
Our benchmarks of existing DP-PEFT methods show that DP-Low-Rank Adaptation (DP-LoRA) consistently outperforms other methods.
An even more promising approach, DyLoRA, which makes the low rank variable, when naively combined with FL would straightforwardly break differential privacy.
We therefore propose an adaptation method that can be combined with differential privacy and call it DP-DyLoRA.
Finally, we are able to reduce the accuracy degradation and word error rate (WER) increase due to DP to less than 2% and 7% respectively with 1 million clients and a stringent privacy budget of <math id="id1.1.m1.1" class="ltx_Math" alttext="\bm{\epsilon}=2" display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml">ϵ</mi><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">=</mo><mn id="id1.1.m1.1.1.3" xref="id1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><eq id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1"></eq><ci id="id1.1.m1.1.1.2.cmml" xref="id1.1.m1.1.1.2">bold-italic-ϵ</ci><cn type="integer" id="id1.1.m1.1.1.3.cmml" xref="id1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\bm{\epsilon}=2</annotation></semantics></math>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated learning, differential privacy, parameter-efficient fine-tuning.

</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_publicationid"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">publicationid: </span>pubid: 0000–0000/00$00.00 © 2021 IEEE</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Today, transformer-based models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> are becoming increasingly common in Internet of Things (IoT) systems for a wide range of applications such as natural language understanding (NLU), automatic speech recognition (ASR) and image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Compared to models such as recurrent neural networks (RNNs) and convolutional neural networks (CNNs), transformer-based models are known to have several advantages such as being better at handling long-range input dependencies and more efficient for training and inference due to parallel input processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Pre-training and fine-tuning transformers is the dominant approach for building models with state-of-the-art performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. These models are particularly suitable for deployment in IoT systems since they can be pre-trained on massive unlabelled data at the central server without much human effort, and only a small amount of data is required per client when fine-tuning in collaboration with other IoT clients for downstream tasks.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> keeps data on clients and sends only statistics about the data to a central server, to train a centrally-held model.
Though it sounds like user privacy would be improved, much information about the data is revealed through the statistics.
To address potential privacy leakage of clients’ training data, further guarantees are required.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2405.06368/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="142" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Privacy-utility trade-offs of DP-LoRA and DP-DyLoRA on six datasets across three different domains under DP-FL. The utility is computed as the average of accuracy.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Differential privacy (DP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is the gold standard for providing such privacy guarantees.
Very briefly, it adds so much randomness that the data gives very little away about the presence of any individual.
Naively applied to the federated learning setting, it would involve adding noise to each individual’s statistics (“local DP”).
In this case, the noise would overwhelm the signal.
The alternative is to add Gaussian noise once to a sum of many contributions (“central DP”) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, and use a secure sum algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to hide individual contributions from the server.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, this may still add too much noise.
An important lever to change this is the size of the statistics that each client sends to the server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
First, if the vector with statistics is longer, its <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\ell_{2}</annotation></semantics></math> norm will tend to be greater, and then more noise is required to hide the data.
Second, the noise needs to be added to each element of the vector, and therefore the total amount of noise increases with the length of the statistics.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To forgo the need to send a vector of the size of the model, recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> utilise parameter-efficient fine-tuning (PEFT) methods such as Adapters and Low-Rank Adaptation (LoRA) to fine-tune transformer-based models under differentially private federated learning (DP-FL).
Only the values of a lower-rank matrix, or only the Adapter parameters, then need to be sent.
This results in much less noise being added while maintaining the same privacy guarantee, which in turn improves model performance.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Comprehensive experiments for DP-PEFT methods are missing from the literature.
Experiments in existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> fail to address realistic system properties such as a massive number (millions) of clients in an IoT system <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.
Works such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> show experiments for only a single domain and a single type of DP-PEFT method.
Only speech is considered in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, but it only evaluates Partial Embedding Updates with a combination of LoRA, without considering DP-PEFT methods such as DP-Adapter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, DP-Compacter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and DP-BitFit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> which are often considered in works regarding PEFT and DP-PEFT methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">This work, on the other hand, presents a comprehensive set of experiments.
We start by empirically studying the training dynamics of fine-tuning such models via full fine-tuning on datasets of several domains including natural language understanding, computer vision and speech recognition.
We then show with empirical results that parameter-efficient fine-tuning can achieve much better privacy-utility trade-offs than full fine-tuning, and comprehensively benchmark existing DP-PEFT methods on three different domains under DP-FL.
The most successful PEFT scheme for DP-FL turns out to be LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, which learns low-rank matrices to add to existing weight matrices.
It is fairly obvious how to use it within DP-FL, where it is called DP-LoRA.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">A recent improvement, DyLoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, proposed for NLP, does away with the manual choice of rank.
This would make it highly suitable for DP-FL, where privacy budget gets used up by hyperparameter searching.
However, a naive adaptation of DyLoRA to DP-FL straightforwardly breaks differential privacy, since users would be sending up vectors of different lengths.
In this work, we solve this conundrum by tweaking the form of LoRA so that each cohort uses one vector length.
We show that this scheme yields the same expected value of updates as the original DyLoRA.
We call the scheme DP-DyLoRA.
Our results show that DP-DyLoRA significantly outperforms existing DP-PEFT methods including DP-Adapter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, DP-Compacter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, DP-BitFit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and DP-LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> under DP-FL on datasets across three different domains.
Specifically, we show that DP-DyLoRA achieves less than 2% accuracy drop and 7% word error rate (WER) increase from non-private LoRA (or DyLoRA) with a strong DP guarantee (<math id="S1.p8.1.m1.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S1.p8.1.m1.1a"><mrow id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml"><mi id="S1.p8.1.m1.1.1.2" xref="S1.p8.1.m1.1.1.2.cmml">ϵ</mi><mo id="S1.p8.1.m1.1.1.1" xref="S1.p8.1.m1.1.1.1.cmml">=</mo><mn id="S1.p8.1.m1.1.1.3" xref="S1.p8.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><apply id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1"><eq id="S1.p8.1.m1.1.1.1.cmml" xref="S1.p8.1.m1.1.1.1"></eq><ci id="S1.p8.1.m1.1.1.2.cmml" xref="S1.p8.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S1.p8.1.m1.1.1.3.cmml" xref="S1.p8.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">\epsilon=2</annotation></semantics></math>) and 1 million clients.
DP-DyLoRA achieves noticeably better privacy-utility trade-offs than state-of-the-art DP-PEFT method DP-LoRA as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">In short, the main contributions of this article are:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Benchmarking existing DP-PEFT methods under DP-FL for a detailed comparison under this learning paradigm.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Proposing a novel DP-FL algorithm DP-DyLoRA to further improve privacy-utility trade-offs over DP-LoRA by optimising for a range of ranks instead of a fixed rank.</p>
</div>
</li>
</ol>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">In the remainder of this article, we first present an overview of the related work in Section <a href="#S2" title="II Related Work ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, which is followed by preliminaries in Section <a href="#S3" title="III Federated learning with differential privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Next, we describe parameter-efficient fine-tuning with differential privacy and introduce our novel DP-FL algorithm DP-DyLoRA in Section <a href="#S4" title="IV Parameter-Efficient Fine-tuning with Differential Privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. We then describe our experimental setup in Section <a href="#S5" title="V Experimental Setup ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> and discuss our results and findings in Section <a href="#S6" title="VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>. Finally, we summarise our findings in Section <a href="#S7" title="VII Conclusion ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">FederatedAveraging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> which served as a generalisation of FederatedSGD (FedSGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> became a common baseline for federated learning soon after being proposed back in 2017. Following the success of FedAvg, numerous works focusing on different aspects of this learning paradigm have been published. As an important research topic for federated learning, various optimisation approaches were proposed to reduce the communication cost and improve robustness against non-independent and identically distributed (non-IID) data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. These methods typically attempt to tackle the communication bottleneck of federated learning by either reducing the number of communication rounds required for models to converge or the percentage of clients being sampled at each communication round. Works including <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> focus more on model convergence with large heterogeneity in the data which is a more realistic setting for federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Although federated learning allows clients to contribute to a global model without sharing local data therefore protecting data privacy to some extent, adversaries are still able to infer sensitive information from gradients sent from clients to the server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. In order to improve privacy protection in federated learning, DP-FedAvg was proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> which adds differential privacy to the FedAvg algorithm. This is achieved by introducing noise to the uploaded gradients by using the moments accountant <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> originally proposed for differentially private stochastic gradient descent (DP-SGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> with Gaussian mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and privacy amplification via subsampling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The moments accountant provides tight privacy bounds for the sampled Gaussian mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. There have also been recent works on training transformer models via DP-SGD which primarily focus on reducing memory and computation complexities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The magnitude of the noise added to achieve differential privacy increases as the model size grows <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. With the current trend of developing and deploying ever larger models, parameter-efficient fine-tuning turns out to be an intuitive solution for sample-level DP-SGD as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> which potentially allows us to fine-tune less than 1% parameters while preserving most of the model performance. Adapter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and Low-Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> are examples of such methods which can be categorised into sequential and parallel approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, respectively. This approach has been applied also to differentially private federated learning as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Federated learning with differential privacy</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we describe federated learning with differential privacy, and explain why the number of parameters that are updated is such a crucial quantity.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Main nomenclature employed.</figcaption>
<table id="S3.T1.14" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.14.15.1" class="ltx_tr">
<th id="S3.T1.14.15.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T1.14.15.1.1.1" class="ltx_text ltx_font_bold">Notation</span></th>
<th id="S3.T1.14.15.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S3.T1.14.15.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.14.15.1.2.1.1" class="ltx_p" style="width:184.9pt;"><span id="S3.T1.14.15.1.2.1.1.1" class="ltx_text ltx_font_bold">Meaning</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\eta</annotation></semantics></math></th>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.2.1.1" class="ltx_p" style="width:184.9pt;">Learning rate</span>
</span>
</td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<th id="S3.T1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><mi mathvariant="normal" id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">\ell</annotation></semantics></math></th>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.2.2.1.1" class="ltx_p" style="width:184.9pt;">Loss</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.3" class="ltx_tr">
<th id="S3.T1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="\triangledown" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><mi mathvariant="normal" id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml">▽</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><ci id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">▽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">\triangledown</annotation></semantics></math></th>
<td id="S3.T1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.2.1.1" class="ltx_p" style="width:184.9pt;">Gradient operator</span>
</span>
</td>
</tr>
<tr id="S3.T1.5.5" class="ltx_tr">
<th id="S3.T1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><msup id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml"><mi id="S3.T1.4.4.1.m1.1.1.2" xref="S3.T1.4.4.1.m1.1.1.2.cmml">W</mi><mi id="S3.T1.4.4.1.m1.1.1.3" xref="S3.T1.4.4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><apply id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.1.m1.1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">superscript</csymbol><ci id="S3.T1.4.4.1.m1.1.1.2.cmml" xref="S3.T1.4.4.1.m1.1.1.2">𝑊</ci><ci id="S3.T1.4.4.1.m1.1.1.3.cmml" xref="S3.T1.4.4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">W^{t}</annotation></semantics></math></th>
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.5.5.2.1.1" class="ltx_p" style="width:184.9pt;">Model parameters of the global model at the start of round <math id="S3.T1.5.5.2.1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.5.5.2.1.1.m1.1a"><mi id="S3.T1.5.5.2.1.1.m1.1.1" xref="S3.T1.5.5.2.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.1.1.m1.1b"><ci id="S3.T1.5.5.2.1.1.m1.1.1.cmml" xref="S3.T1.5.5.2.1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.1.1.m1.1c">t</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<th id="S3.T1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.6.6.1.m1.1" class="ltx_Math" alttext="\triangledown\ell(W)" display="inline"><semantics id="S3.T1.6.6.1.m1.1a"><mrow id="S3.T1.6.6.1.m1.1.2" xref="S3.T1.6.6.1.m1.1.2.cmml"><mi mathvariant="normal" id="S3.T1.6.6.1.m1.1.2.2" xref="S3.T1.6.6.1.m1.1.2.2.cmml">▽</mi><mo lspace="0em" rspace="0em" id="S3.T1.6.6.1.m1.1.2.1" xref="S3.T1.6.6.1.m1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.T1.6.6.1.m1.1.2.3" xref="S3.T1.6.6.1.m1.1.2.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.T1.6.6.1.m1.1.2.1a" xref="S3.T1.6.6.1.m1.1.2.1.cmml">​</mo><mrow id="S3.T1.6.6.1.m1.1.2.4.2" xref="S3.T1.6.6.1.m1.1.2.cmml"><mo stretchy="false" id="S3.T1.6.6.1.m1.1.2.4.2.1" xref="S3.T1.6.6.1.m1.1.2.cmml">(</mo><mi id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml">W</mi><mo stretchy="false" id="S3.T1.6.6.1.m1.1.2.4.2.2" xref="S3.T1.6.6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><apply id="S3.T1.6.6.1.m1.1.2.cmml" xref="S3.T1.6.6.1.m1.1.2"><times id="S3.T1.6.6.1.m1.1.2.1.cmml" xref="S3.T1.6.6.1.m1.1.2.1"></times><ci id="S3.T1.6.6.1.m1.1.2.2.cmml" xref="S3.T1.6.6.1.m1.1.2.2">▽</ci><ci id="S3.T1.6.6.1.m1.1.2.3.cmml" xref="S3.T1.6.6.1.m1.1.2.3">ℓ</ci><ci id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">\triangledown\ell(W)</annotation></semantics></math></th>
<td id="S3.T1.7.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.7.7.2.1.1" class="ltx_p" style="width:184.9pt;">Gradients with respect to the weights <math id="S3.T1.7.7.2.1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.T1.7.7.2.1.1.m1.1a"><mi id="S3.T1.7.7.2.1.1.m1.1.1" xref="S3.T1.7.7.2.1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.2.1.1.m1.1b"><ci id="S3.T1.7.7.2.1.1.m1.1.1.cmml" xref="S3.T1.7.7.2.1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.2.1.1.m1.1c">W</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<th id="S3.T1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.8.8.1.m1.1" class="ltx_Math" alttext="\Delta_{k}" display="inline"><semantics id="S3.T1.8.8.1.m1.1a"><msub id="S3.T1.8.8.1.m1.1.1" xref="S3.T1.8.8.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T1.8.8.1.m1.1.1.2" xref="S3.T1.8.8.1.m1.1.1.2.cmml">Δ</mi><mi id="S3.T1.8.8.1.m1.1.1.3" xref="S3.T1.8.8.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><apply id="S3.T1.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1">subscript</csymbol><ci id="S3.T1.8.8.1.m1.1.1.2.cmml" xref="S3.T1.8.8.1.m1.1.1.2">Δ</ci><ci id="S3.T1.8.8.1.m1.1.1.3.cmml" xref="S3.T1.8.8.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">\Delta_{k}</annotation></semantics></math></th>
<td id="S3.T1.9.9.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.9.9.2.1.1" class="ltx_p" style="width:184.9pt;">Model updates of the <math id="S3.T1.9.9.2.1.1.m1.1" class="ltx_Math" alttext="k^{\text{th}}" display="inline"><semantics id="S3.T1.9.9.2.1.1.m1.1a"><msup id="S3.T1.9.9.2.1.1.m1.1.1" xref="S3.T1.9.9.2.1.1.m1.1.1.cmml"><mi id="S3.T1.9.9.2.1.1.m1.1.1.2" xref="S3.T1.9.9.2.1.1.m1.1.1.2.cmml">k</mi><mtext id="S3.T1.9.9.2.1.1.m1.1.1.3" xref="S3.T1.9.9.2.1.1.m1.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.2.1.1.m1.1b"><apply id="S3.T1.9.9.2.1.1.m1.1.1.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.2.1.1.m1.1.1.1.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.T1.9.9.2.1.1.m1.1.1.2.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1.2">𝑘</ci><ci id="S3.T1.9.9.2.1.1.m1.1.1.3a.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.T1.9.9.2.1.1.m1.1.1.3.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.2.1.1.m1.1c">k^{\text{th}}</annotation></semantics></math>client</span>
</span>
</td>
</tr>
<tr id="S3.T1.11.11" class="ltx_tr">
<th id="S3.T1.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><msub id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml"><mi id="S3.T1.10.10.1.m1.1.1.2" xref="S3.T1.10.10.1.m1.1.1.2.cmml">n</mi><mi id="S3.T1.10.10.1.m1.1.1.3" xref="S3.T1.10.10.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><apply id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">subscript</csymbol><ci id="S3.T1.10.10.1.m1.1.1.2.cmml" xref="S3.T1.10.10.1.m1.1.1.2">𝑛</ci><ci id="S3.T1.10.10.1.m1.1.1.3.cmml" xref="S3.T1.10.10.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">n_{k}</annotation></semantics></math></th>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.11.11.2.1.1" class="ltx_p" style="width:184.9pt;">Number of samples that the <math id="S3.T1.11.11.2.1.1.m1.1" class="ltx_Math" alttext="k^{\text{th}}" display="inline"><semantics id="S3.T1.11.11.2.1.1.m1.1a"><msup id="S3.T1.11.11.2.1.1.m1.1.1" xref="S3.T1.11.11.2.1.1.m1.1.1.cmml"><mi id="S3.T1.11.11.2.1.1.m1.1.1.2" xref="S3.T1.11.11.2.1.1.m1.1.1.2.cmml">k</mi><mtext id="S3.T1.11.11.2.1.1.m1.1.1.3" xref="S3.T1.11.11.2.1.1.m1.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.2.1.1.m1.1b"><apply id="S3.T1.11.11.2.1.1.m1.1.1.cmml" xref="S3.T1.11.11.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.2.1.1.m1.1.1.1.cmml" xref="S3.T1.11.11.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.T1.11.11.2.1.1.m1.1.1.2.cmml" xref="S3.T1.11.11.2.1.1.m1.1.1.2">𝑘</ci><ci id="S3.T1.11.11.2.1.1.m1.1.1.3a.cmml" xref="S3.T1.11.11.2.1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.T1.11.11.2.1.1.m1.1.1.3.cmml" xref="S3.T1.11.11.2.1.1.m1.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.2.1.1.m1.1c">k^{\text{th}}</annotation></semantics></math>client possesses</span>
</span>
</td>
</tr>
<tr id="S3.T1.14.14" class="ltx_tr">
<th id="S3.T1.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><math id="S3.T1.12.12.1.m1.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="S3.T1.12.12.1.m1.1a"><msub id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml"><mi id="S3.T1.12.12.1.m1.1.1.2" xref="S3.T1.12.12.1.m1.1.1.2.cmml">a</mi><mrow id="S3.T1.12.12.1.m1.1.1.3" xref="S3.T1.12.12.1.m1.1.1.3.cmml"><mi id="S3.T1.12.12.1.m1.1.1.3.2" xref="S3.T1.12.12.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.12.12.1.m1.1.1.3.1" xref="S3.T1.12.12.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.12.12.1.m1.1.1.3.3" xref="S3.T1.12.12.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><apply id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.1.m1.1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1">subscript</csymbol><ci id="S3.T1.12.12.1.m1.1.1.2.cmml" xref="S3.T1.12.12.1.m1.1.1.2">𝑎</ci><apply id="S3.T1.12.12.1.m1.1.1.3.cmml" xref="S3.T1.12.12.1.m1.1.1.3"><times id="S3.T1.12.12.1.m1.1.1.3.1.cmml" xref="S3.T1.12.12.1.m1.1.1.3.1"></times><ci id="S3.T1.12.12.1.m1.1.1.3.2.cmml" xref="S3.T1.12.12.1.m1.1.1.3.2">𝑖</ci><ci id="S3.T1.12.12.1.m1.1.1.3.3.cmml" xref="S3.T1.12.12.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">a_{ij}</annotation></semantics></math></th>
<td id="S3.T1.14.14.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S3.T1.14.14.3.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.14.14.3.2.2" class="ltx_p" style="width:184.9pt;">Number of samples that belong to class <math id="S3.T1.13.13.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.T1.13.13.2.1.1.m1.1a"><mi id="S3.T1.13.13.2.1.1.m1.1.1" xref="S3.T1.13.13.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.2.1.1.m1.1b"><ci id="S3.T1.13.13.2.1.1.m1.1.1.cmml" xref="S3.T1.13.13.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.2.1.1.m1.1c">i</annotation></semantics></math> and cluster <math id="S3.T1.14.14.3.2.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.T1.14.14.3.2.2.m2.1a"><mi id="S3.T1.14.14.3.2.2.m2.1.1" xref="S3.T1.14.14.3.2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.3.2.2.m2.1b"><ci id="S3.T1.14.14.3.2.2.m2.1.1.cmml" xref="S3.T1.14.14.3.2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.3.2.2.m2.1c">j</annotation></semantics></math></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Federated learning is a machine learning paradigm where a central server aims to train a model on data that is distributed over many clients.
What the clients send is not the actual data, but instead statistics about the data.
This normally works iteratively: in each round, the server sends the most recent model to a cohort of clients.
In Federated Averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, the clients trains for multiple local iterations on local data, and sends the difference between the resulting model and the original one to the server.
On the server, the average of updates from all clients turns out to form a good update for the central model, which is the key insight that allows Federated Averaging.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The local training data in a federated learning system is not necessarily independent and identically distributed (IID) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. In practice, it is very likely that individual clients train on highly skewed non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. Data heterogeneity can come from different factors such as label distribution and user habit.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Differentially Private Federated Learning</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Even though in federated learning no data leaves the clients, the statistics can give away too much personal information.
The standard method for preventing this is <em id="S3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">differential privacy</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>.
The following is a high-level introduction to differential privacy and its use in federated learning.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.9" class="ltx_p">Differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> (DP) prevents a <em id="S3.SS2.p2.9.1" class="ltx_emph ltx_font_italic">membership attack</em>, where an attacker already knows what an individual is sending, but tries to work out whether or not they are included in the data.
This seems like a high bar, but no meaningful lower bars have been found.
In practice, in federated learning, enough noise must be added to mask any one individual’s statistics.
To do this, first the <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\ell_{2}</annotation></semantics></math> sensitivity must be constrained, which means making sure that every individual’s contribution <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\Delta_{k}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">Δ</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">Δ</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\Delta_{k}</annotation></semantics></math> has <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\lVert\Delta_{k}\rVert_{2}&lt;S" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml"><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.2.1.cmml">∥</mo><msub id="S3.SS2.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="S3.SS2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS2.p2.3.m3.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">&lt;</mo><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><lt id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"></lt><apply id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.2">Δ</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="S3.SS2.p2.3.m3.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3">2</cn></apply><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\lVert\Delta_{k}\rVert_{2}&lt;S</annotation></semantics></math>, where <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">S</annotation></semantics></math> is a scalar constant, the clipping bound.
Then, noise must be added.
The amount of noise is determined ultimately by the privacy budget <math id="S3.SS2.p2.5.m5.2" class="ltx_Math" alttext="(\epsilon,\delta)" display="inline"><semantics id="S3.SS2.p2.5.m5.2a"><mrow id="S3.SS2.p2.5.m5.2.3.2" xref="S3.SS2.p2.5.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m5.2.3.2.1" xref="S3.SS2.p2.5.m5.2.3.1.cmml">(</mo><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">ϵ</mi><mo id="S3.SS2.p2.5.m5.2.3.2.2" xref="S3.SS2.p2.5.m5.2.3.1.cmml">,</mo><mi id="S3.SS2.p2.5.m5.2.2" xref="S3.SS2.p2.5.m5.2.2.cmml">δ</mi><mo stretchy="false" id="S3.SS2.p2.5.m5.2.3.2.3" xref="S3.SS2.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.2b"><interval closure="open" id="S3.SS2.p2.5.m5.2.3.1.cmml" xref="S3.SS2.p2.5.m5.2.3.2"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">italic-ϵ</ci><ci id="S3.SS2.p2.5.m5.2.2.cmml" xref="S3.SS2.p2.5.m5.2.2">𝛿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.2c">(\epsilon,\delta)</annotation></semantics></math>, with <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\epsilon</annotation></semantics></math> usually being a single-digit value, here <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mn id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><cn type="integer" id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">2</annotation></semantics></math>, and <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\delta</annotation></semantics></math> being a small fraction, here <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="10^{-6}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msup id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mn id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">10</mn><mrow id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml"><mo id="S3.SS2.p2.9.m9.1.1.3a" xref="S3.SS2.p2.9.m9.1.1.3.cmml">−</mo><mn id="S3.SS2.p2.9.m9.1.1.3.2" xref="S3.SS2.p2.9.m9.1.1.3.2.cmml">6</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">superscript</csymbol><cn type="integer" id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">10</cn><apply id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3"><minus id="S3.SS2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS2.p2.9.m9.1.1.3"></minus><cn type="integer" id="S3.SS2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS2.p2.9.m9.1.1.3.2">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">10^{-6}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">It would seem natural in federated learning for each client to add noise to their own data.
This is called “local DP” but the amount of noise would then be so high as to prevent anything from being learned.
Instead, a trick is necessary.
As originally proposed, in its “central” guise, DP would involve a trusted third party that would take individuals’ stats in the clear, and output aggregated statistics, with noise added to each aggregate.
In the federated learning case, where the third party would merely compute a vector sum, the role of the trusted third party can be played by cryptography.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">The “Secure Aggregation” algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> allows many clients to contribute to a vector sum, where no one, not even the server receiving the sum, sees the individual contributions.
To guarantee central differential privacy, each client adds their part of the correct overall noise to the sum <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
Existing secure summing algorithms are also designed to be robust to client dropouts to some extent. For simplicity, we do not consider client dropouts in this work. We also do not explicitly mention such algorithm in our experiments as results would be identical either with or without secure summing implemented. Previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> have shown that the server is able to receive the exact sum of client updates without access to individual updates using secure summing algorithms such as SecAgg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and SecAgg+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Assuming such a secure summing algorithm, the differential privacy analysis first proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> can be used.
It assumed a large population of individuals, and at each round of Federated Averaging a subset of them is sampled i.i.d. to contribute.
The individual contributions from the selected cohort are summed with added Gaussian noise, and this is used to update the central model.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> proposed a DP analysis of the algorithm called the “moments accountant”, which was much more efficient in terms of privacy budget than previous analyses, and this analysis has since been improved <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
In the rest of this article a budget of <math id="S3.SS2.p5.1.m1.2" class="ltx_Math" alttext="(2,10^{-6})" display="inline"><semantics id="S3.SS2.p5.1.m1.2a"><mrow id="S3.SS2.p5.1.m1.2.2.1" xref="S3.SS2.p5.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p5.1.m1.2.2.1.2" xref="S3.SS2.p5.1.m1.2.2.2.cmml">(</mo><mn id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">2</mn><mo id="S3.SS2.p5.1.m1.2.2.1.3" xref="S3.SS2.p5.1.m1.2.2.2.cmml">,</mo><msup id="S3.SS2.p5.1.m1.2.2.1.1" xref="S3.SS2.p5.1.m1.2.2.1.1.cmml"><mn id="S3.SS2.p5.1.m1.2.2.1.1.2" xref="S3.SS2.p5.1.m1.2.2.1.1.2.cmml">10</mn><mrow id="S3.SS2.p5.1.m1.2.2.1.1.3" xref="S3.SS2.p5.1.m1.2.2.1.1.3.cmml"><mo id="S3.SS2.p5.1.m1.2.2.1.1.3a" xref="S3.SS2.p5.1.m1.2.2.1.1.3.cmml">−</mo><mn id="S3.SS2.p5.1.m1.2.2.1.1.3.2" xref="S3.SS2.p5.1.m1.2.2.1.1.3.2.cmml">6</mn></mrow></msup><mo stretchy="false" id="S3.SS2.p5.1.m1.2.2.1.4" xref="S3.SS2.p5.1.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.2b"><interval closure="open" id="S3.SS2.p5.1.m1.2.2.2.cmml" xref="S3.SS2.p5.1.m1.2.2.1"><cn type="integer" id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">2</cn><apply id="S3.SS2.p5.1.m1.2.2.1.1.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1">superscript</csymbol><cn type="integer" id="S3.SS2.p5.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.2">10</cn><apply id="S3.SS2.p5.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.3"><minus id="S3.SS2.p5.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.3"></minus><cn type="integer" id="S3.SS2.p5.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.3.2">6</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.2c">(2,10^{-6})</annotation></semantics></math> is used.
The Gaussian noise will be chosen to remain within this budget.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> DP-FedAvg with <span id="alg1.4.2" class="ltx_text" style="background-color:#FFBFBF;">SecureSum</span>.</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.2.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.1" class="ltx_text ltx_font_smallcaps">Server</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>       <span id="alg1.l2.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>           number of communication rounds <math id="alg1.l3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">T</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>           total users <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="alg1.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{K}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>           user sampling rate <math id="alg1.l5.m1.2" class="ltx_Math" alttext="q\in(0,1]" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.3" xref="alg1.l5.m1.2.3.cmml"><mi id="alg1.l5.m1.2.3.2" xref="alg1.l5.m1.2.3.2.cmml">q</mi><mo id="alg1.l5.m1.2.3.1" xref="alg1.l5.m1.2.3.1.cmml">∈</mo><mrow id="alg1.l5.m1.2.3.3.2" xref="alg1.l5.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l5.m1.2.3.3.2.1" xref="alg1.l5.m1.2.3.3.1.cmml">(</mo><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">0</mn><mo id="alg1.l5.m1.2.3.3.2.2" xref="alg1.l5.m1.2.3.3.1.cmml">,</mo><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l5.m1.2.3.3.2.3" xref="alg1.l5.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.3.cmml" xref="alg1.l5.m1.2.3"><in id="alg1.l5.m1.2.3.1.cmml" xref="alg1.l5.m1.2.3.1"></in><ci id="alg1.l5.m1.2.3.2.cmml" xref="alg1.l5.m1.2.3.2">𝑞</ci><interval closure="open-closed" id="alg1.l5.m1.2.3.3.1.cmml" xref="alg1.l5.m1.2.3.3.2"><cn type="integer" id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">0</cn><cn type="integer" id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">q\in(0,1]</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>           noise multiplier <math id="alg1.l6.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">z</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           clip norm <math id="alg1.l7.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">S</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>       <span id="alg1.l8.2" class="ltx_text ltx_font_bold">initialise</span> model weights <math id="alg1.l8.m1.1" class="ltx_Math" alttext="W^{0}" display="inline"><semantics id="alg1.l8.m1.1a"><msup id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">W</mi><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑊</ci><cn type="integer" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">W^{0}</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>       <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l9.m1.3" class="ltx_Math" alttext="t=1,2,\ldots T" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mi id="alg1.l9.m1.3.3.3" xref="alg1.l9.m1.3.3.3.cmml">t</mi><mo id="alg1.l9.m1.3.3.2" xref="alg1.l9.m1.3.3.2.cmml">=</mo><mrow id="alg1.l9.m1.3.3.1.1" xref="alg1.l9.m1.3.3.1.2.cmml"><mn id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">1</mn><mo id="alg1.l9.m1.3.3.1.1.2" xref="alg1.l9.m1.3.3.1.2.cmml">,</mo><mn id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">2</mn><mo id="alg1.l9.m1.3.3.1.1.3" xref="alg1.l9.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l9.m1.3.3.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l9.m1.3.3.1.1.1.2" xref="alg1.l9.m1.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.1.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.1.1.3" xref="alg1.l9.m1.3.3.1.1.1.3.cmml">T</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><eq id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2"></eq><ci id="alg1.l9.m1.3.3.3.cmml" xref="alg1.l9.m1.3.3.3">𝑡</ci><list id="alg1.l9.m1.3.3.1.2.cmml" xref="alg1.l9.m1.3.3.1.1"><cn type="integer" id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">1</cn><cn type="integer" id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">2</cn><apply id="alg1.l9.m1.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1"><times id="alg1.l9.m1.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1.1"></times><ci id="alg1.l9.m1.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.1.1.1.2">…</ci><ci id="alg1.l9.m1.3.3.1.1.1.3.cmml" xref="alg1.l9.m1.3.3.1.1.1.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">t=1,2,\ldots T</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>           Sample a subset <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathcal{C}^{t}\subseteq\mathcal{K}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msup id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">𝒞</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">t</mi></msup><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><subset id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></subset><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝒞</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathcal{C}^{t}\subseteq\mathcal{K}</annotation></semantics></math> of users uniformly at          random with probability <math id="alg1.l10.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">q</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>           <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\sigma=z\cdot S" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">σ</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">=</mo><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">⋅</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><eq id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></eq><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝜎</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><ci id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1">⋅</ci><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑧</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\sigma=z\cdot S</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           <math id="alg1.l12.m1.1" class="ltx_math_unparsed" alttext="W^{t+1}\leftarrow W^{t}+\frac{1}{\lvert\mathcal{C}^{t}\rvert}\textsc{SecureSumDP}\big{(}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1b"><msup id="alg1.l12.m1.1.2"><mi id="alg1.l12.m1.1.2.2">W</mi><mrow id="alg1.l12.m1.1.2.3"><mi id="alg1.l12.m1.1.2.3.2">t</mi><mo id="alg1.l12.m1.1.2.3.1">+</mo><mn id="alg1.l12.m1.1.2.3.3">1</mn></mrow></msup><mo stretchy="false" id="alg1.l12.m1.1.3">←</mo><msup id="alg1.l12.m1.1.4"><mi id="alg1.l12.m1.1.4.2">W</mi><mi id="alg1.l12.m1.1.4.3">t</mi></msup><mo id="alg1.l12.m1.1.5">+</mo><mfrac id="alg1.l12.m1.1.1"><mn id="alg1.l12.m1.1.1.3">1</mn><mrow id="alg1.l12.m1.1.1.1.1"><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.2">|</mo><msup id="alg1.l12.m1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.1.1.1.2">𝒞</mi><mi id="alg1.l12.m1.1.1.1.1.1.3">t</mi></msup><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.3">|</mo></mrow></mfrac><mtext class="ltx_font_smallcaps" id="alg1.l12.m1.1.6">SecureSumDP</mtext><mo maxsize="120%" minsize="120%" id="alg1.l12.m1.1.7">(</mo></mrow><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">W^{t+1}\leftarrow W^{t}+\frac{1}{\lvert\mathcal{C}^{t}\rvert}\textsc{SecureSumDP}\big{(}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>                <math id="alg1.l13.m1.3" class="ltx_math_unparsed" alttext="\{\textsc{UserUpdate}(k,W^{t})\}_{k\in\mathcal{C}^{t}},z,S\big{)}" display="inline"><semantics id="alg1.l13.m1.3a"><mrow id="alg1.l13.m1.3b"><msub id="alg1.l13.m1.3.4"><mrow id="alg1.l13.m1.3.4.2"><mo stretchy="false" id="alg1.l13.m1.3.4.2.1">{</mo><mtext class="ltx_font_smallcaps" id="alg1.l13.m1.3.4.2.2">UserUpdate</mtext><mrow id="alg1.l13.m1.3.4.2.3"><mo stretchy="false" id="alg1.l13.m1.3.4.2.3.1">(</mo><mi id="alg1.l13.m1.1.1">k</mi><mo id="alg1.l13.m1.3.4.2.3.2">,</mo><msup id="alg1.l13.m1.3.4.2.3.3"><mi id="alg1.l13.m1.3.4.2.3.3.2">W</mi><mi id="alg1.l13.m1.3.4.2.3.3.3">t</mi></msup><mo stretchy="false" id="alg1.l13.m1.3.4.2.3.4">)</mo></mrow><mo stretchy="false" id="alg1.l13.m1.3.4.2.4">}</mo></mrow><mrow id="alg1.l13.m1.3.4.3"><mi id="alg1.l13.m1.3.4.3.2">k</mi><mo id="alg1.l13.m1.3.4.3.1">∈</mo><msup id="alg1.l13.m1.3.4.3.3"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.3.4.3.3.2">𝒞</mi><mi id="alg1.l13.m1.3.4.3.3.3">t</mi></msup></mrow></msub><mo id="alg1.l13.m1.3.5">,</mo><mi id="alg1.l13.m1.2.2">z</mi><mo id="alg1.l13.m1.3.6">,</mo><mi id="alg1.l13.m1.3.3">S</mi><mo maxsize="120%" minsize="120%" id="alg1.l13.m1.3.7">)</mo></mrow><annotation encoding="application/x-tex" id="alg1.l13.m1.3c">\{\textsc{UserUpdate}(k,W^{t})\}_{k\in\mathcal{C}^{t}},z,S\big{)}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.2.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  <span id="alg1.l15.1" class="ltx_text ltx_font_smallcaps" style="background-color:#FFBFBF;">SecureSumDP<math id="alg1.l15.1.1.m1.3" class="ltx_Math" alttext="(\{\Delta_{k}\}_{k\in\mathcal{C}^{{}^{\prime}}},z,S)" display="inline"><semantics id="alg1.l15.1.1.m1.3a"><mrow id="alg1.l15.1.1.m1.3.3.1" xref="alg1.l15.1.1.m1.3.3.2.cmml"><mo mathbackground="#FFBFBF" stretchy="false" id="alg1.l15.1.1.m1.3.3.1.2" xref="alg1.l15.1.1.m1.3.3.2.cmml">(</mo><msub id="alg1.l15.1.1.m1.3.3.1.1" xref="alg1.l15.1.1.m1.3.3.1.1.cmml"><mrow id="alg1.l15.1.1.m1.3.3.1.1.1.1" xref="alg1.l15.1.1.m1.3.3.1.1.1.2.cmml"><mo mathbackground="#FFBFBF" stretchy="false" id="alg1.l15.1.1.m1.3.3.1.1.1.1.2" xref="alg1.l15.1.1.m1.3.3.1.1.1.2.cmml">{</mo><msub id="alg1.l15.1.1.m1.3.3.1.1.1.1.1" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1.cmml"><mi mathbackground="#FFBFBF" mathvariant="normal" id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.2" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1.2.cmml">Δ</mi><mi mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.3" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1.3.cmml">k</mi></msub><mo mathbackground="#FFBFBF" stretchy="false" id="alg1.l15.1.1.m1.3.3.1.1.1.1.3" xref="alg1.l15.1.1.m1.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l15.1.1.m1.3.3.1.1.3" xref="alg1.l15.1.1.m1.3.3.1.1.3.cmml"><mi mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.1.3.2" xref="alg1.l15.1.1.m1.3.3.1.1.3.2.cmml">k</mi><mo mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.1.3.1" xref="alg1.l15.1.1.m1.3.3.1.1.3.1.cmml">∈</mo><msup id="alg1.l15.1.1.m1.3.3.1.1.3.3" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.1.3.3.2" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.2.cmml">𝒞</mi><msup id="alg1.l15.1.1.m1.3.3.1.1.3.3.3" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.3.cmml"><mi id="alg1.l15.1.1.m1.3.3.1.1.3.3.3a" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.3.cmml"></mi><mo mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.1.3.3.3.1" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.3.1.cmml">′</mo></msup></msup></mrow></msub><mo mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.3" xref="alg1.l15.1.1.m1.3.3.2.cmml">,</mo><mi mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.1.1" xref="alg1.l15.1.1.m1.1.1.cmml">z</mi><mo mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.3.3.1.4" xref="alg1.l15.1.1.m1.3.3.2.cmml">,</mo><mi mathbackground="#FFBFBF" id="alg1.l15.1.1.m1.2.2" xref="alg1.l15.1.1.m1.2.2.cmml">S</mi><mo mathbackground="#FFBFBF" stretchy="false" id="alg1.l15.1.1.m1.3.3.1.5" xref="alg1.l15.1.1.m1.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.1.1.m1.3b"><vector id="alg1.l15.1.1.m1.3.3.2.cmml" xref="alg1.l15.1.1.m1.3.3.1"><apply id="alg1.l15.1.1.m1.3.3.1.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l15.1.1.m1.3.3.1.1.2.cmml" xref="alg1.l15.1.1.m1.3.3.1.1">subscript</csymbol><set id="alg1.l15.1.1.m1.3.3.1.1.1.2.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.1.1"><apply id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1.2">Δ</ci><ci id="alg1.l15.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg1.l15.1.1.m1.3.3.1.1.3.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3"><in id="alg1.l15.1.1.m1.3.3.1.1.3.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.1"></in><ci id="alg1.l15.1.1.m1.3.3.1.1.3.2.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.2">𝑘</ci><apply id="alg1.l15.1.1.m1.3.3.1.1.3.3.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.1.1.m1.3.3.1.1.3.3.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.3">superscript</csymbol><ci id="alg1.l15.1.1.m1.3.3.1.1.3.3.2.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.2">𝒞</ci><apply id="alg1.l15.1.1.m1.3.3.1.1.3.3.3.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.3"><ci id="alg1.l15.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="alg1.l15.1.1.m1.3.3.1.1.3.3.3.1">′</ci></apply></apply></apply></apply><ci id="alg1.l15.1.1.m1.1.1.cmml" xref="alg1.l15.1.1.m1.1.1">𝑧</ci><ci id="alg1.l15.1.1.m1.2.2.cmml" xref="alg1.l15.1.1.m1.2.2">𝑆</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.1.m1.3c">(\{\Delta_{k}\}_{k\in\mathcal{C}^{{}^{\prime}}},z,S)</annotation></semantics></math></span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>       <span id="alg1.l16.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>            <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\sigma=z\cdot S" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">σ</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">=</mo><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">⋅</mo><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></eq><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝜎</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><ci id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1">⋅</ci><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝑧</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\sigma=z\cdot S</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>       <span id="alg1.l18.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l18.m1.5" class="ltx_Math" alttext="\mathcal{N}(0,I\sigma^{2})+\sum_{k\in C^{{}^{\prime}}}\Delta_{k}\cdot\min\big{(}1,\frac{S}{\lVert\Delta_{k}\rVert_{2}}\big{)}" display="inline"><semantics id="alg1.l18.m1.5a"><mrow id="alg1.l18.m1.5.5" xref="alg1.l18.m1.5.5.cmml"><mrow id="alg1.l18.m1.5.5.1" xref="alg1.l18.m1.5.5.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.5.5.1.3" xref="alg1.l18.m1.5.5.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.5.5.1.2" xref="alg1.l18.m1.5.5.1.2.cmml">​</mo><mrow id="alg1.l18.m1.5.5.1.1.1" xref="alg1.l18.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="alg1.l18.m1.5.5.1.1.1.2" xref="alg1.l18.m1.5.5.1.1.2.cmml">(</mo><mn id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml">0</mn><mo id="alg1.l18.m1.5.5.1.1.1.3" xref="alg1.l18.m1.5.5.1.1.2.cmml">,</mo><mrow id="alg1.l18.m1.5.5.1.1.1.1" xref="alg1.l18.m1.5.5.1.1.1.1.cmml"><mi id="alg1.l18.m1.5.5.1.1.1.1.2" xref="alg1.l18.m1.5.5.1.1.1.1.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.5.5.1.1.1.1.1" xref="alg1.l18.m1.5.5.1.1.1.1.1.cmml">​</mo><msup id="alg1.l18.m1.5.5.1.1.1.1.3" xref="alg1.l18.m1.5.5.1.1.1.1.3.cmml"><mi id="alg1.l18.m1.5.5.1.1.1.1.3.2" xref="alg1.l18.m1.5.5.1.1.1.1.3.2.cmml">σ</mi><mn id="alg1.l18.m1.5.5.1.1.1.1.3.3" xref="alg1.l18.m1.5.5.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="alg1.l18.m1.5.5.1.1.1.4" xref="alg1.l18.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="alg1.l18.m1.5.5.2" xref="alg1.l18.m1.5.5.2.cmml">+</mo><mrow id="alg1.l18.m1.5.5.3" xref="alg1.l18.m1.5.5.3.cmml"><msub id="alg1.l18.m1.5.5.3.1" xref="alg1.l18.m1.5.5.3.1.cmml"><mo id="alg1.l18.m1.5.5.3.1.2" xref="alg1.l18.m1.5.5.3.1.2.cmml">∑</mo><mrow id="alg1.l18.m1.5.5.3.1.3" xref="alg1.l18.m1.5.5.3.1.3.cmml"><mi id="alg1.l18.m1.5.5.3.1.3.2" xref="alg1.l18.m1.5.5.3.1.3.2.cmml">k</mi><mo id="alg1.l18.m1.5.5.3.1.3.1" xref="alg1.l18.m1.5.5.3.1.3.1.cmml">∈</mo><msup id="alg1.l18.m1.5.5.3.1.3.3" xref="alg1.l18.m1.5.5.3.1.3.3.cmml"><mi id="alg1.l18.m1.5.5.3.1.3.3.2" xref="alg1.l18.m1.5.5.3.1.3.3.2.cmml">C</mi><msup id="alg1.l18.m1.5.5.3.1.3.3.3" xref="alg1.l18.m1.5.5.3.1.3.3.3.cmml"><mi id="alg1.l18.m1.5.5.3.1.3.3.3a" xref="alg1.l18.m1.5.5.3.1.3.3.3.cmml"></mi><mo id="alg1.l18.m1.5.5.3.1.3.3.3.1" xref="alg1.l18.m1.5.5.3.1.3.3.3.1.cmml">′</mo></msup></msup></mrow></msub><mrow id="alg1.l18.m1.5.5.3.2" xref="alg1.l18.m1.5.5.3.2.cmml"><msub id="alg1.l18.m1.5.5.3.2.2" xref="alg1.l18.m1.5.5.3.2.2.cmml"><mi mathvariant="normal" id="alg1.l18.m1.5.5.3.2.2.2" xref="alg1.l18.m1.5.5.3.2.2.2.cmml">Δ</mi><mi id="alg1.l18.m1.5.5.3.2.2.3" xref="alg1.l18.m1.5.5.3.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l18.m1.5.5.3.2.1" xref="alg1.l18.m1.5.5.3.2.1.cmml">⋅</mo><mrow id="alg1.l18.m1.5.5.3.2.3.2" xref="alg1.l18.m1.5.5.3.2.3.1.cmml"><mi id="alg1.l18.m1.3.3" xref="alg1.l18.m1.3.3.cmml">min</mi><mo id="alg1.l18.m1.5.5.3.2.3.2a" xref="alg1.l18.m1.5.5.3.2.3.1.cmml">⁡</mo><mrow id="alg1.l18.m1.5.5.3.2.3.2.1" xref="alg1.l18.m1.5.5.3.2.3.1.cmml"><mo maxsize="120%" minsize="120%" id="alg1.l18.m1.5.5.3.2.3.2.1.1" xref="alg1.l18.m1.5.5.3.2.3.1.cmml">(</mo><mn id="alg1.l18.m1.4.4" xref="alg1.l18.m1.4.4.cmml">1</mn><mo id="alg1.l18.m1.5.5.3.2.3.2.1.2" xref="alg1.l18.m1.5.5.3.2.3.1.cmml">,</mo><mfrac id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml">S</mi><msub id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml"><mrow id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.2.1.cmml">∥</mo><msub id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l18.m1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="alg1.l18.m1.1.1.1.3" xref="alg1.l18.m1.1.1.1.3.cmml">2</mn></msub></mfrac><mo maxsize="120%" minsize="120%" id="alg1.l18.m1.5.5.3.2.3.2.1.3" xref="alg1.l18.m1.5.5.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.5b"><apply id="alg1.l18.m1.5.5.cmml" xref="alg1.l18.m1.5.5"><plus id="alg1.l18.m1.5.5.2.cmml" xref="alg1.l18.m1.5.5.2"></plus><apply id="alg1.l18.m1.5.5.1.cmml" xref="alg1.l18.m1.5.5.1"><times id="alg1.l18.m1.5.5.1.2.cmml" xref="alg1.l18.m1.5.5.1.2"></times><ci id="alg1.l18.m1.5.5.1.3.cmml" xref="alg1.l18.m1.5.5.1.3">𝒩</ci><interval closure="open" id="alg1.l18.m1.5.5.1.1.2.cmml" xref="alg1.l18.m1.5.5.1.1.1"><cn type="integer" id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2">0</cn><apply id="alg1.l18.m1.5.5.1.1.1.1.cmml" xref="alg1.l18.m1.5.5.1.1.1.1"><times id="alg1.l18.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.1"></times><ci id="alg1.l18.m1.5.5.1.1.1.1.2.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.2">𝐼</ci><apply id="alg1.l18.m1.5.5.1.1.1.1.3.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="alg1.l18.m1.5.5.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.3.2">𝜎</ci><cn type="integer" id="alg1.l18.m1.5.5.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.5.5.1.1.1.1.3.3">2</cn></apply></apply></interval></apply><apply id="alg1.l18.m1.5.5.3.cmml" xref="alg1.l18.m1.5.5.3"><apply id="alg1.l18.m1.5.5.3.1.cmml" xref="alg1.l18.m1.5.5.3.1"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.3.1.1.cmml" xref="alg1.l18.m1.5.5.3.1">subscript</csymbol><sum id="alg1.l18.m1.5.5.3.1.2.cmml" xref="alg1.l18.m1.5.5.3.1.2"></sum><apply id="alg1.l18.m1.5.5.3.1.3.cmml" xref="alg1.l18.m1.5.5.3.1.3"><in id="alg1.l18.m1.5.5.3.1.3.1.cmml" xref="alg1.l18.m1.5.5.3.1.3.1"></in><ci id="alg1.l18.m1.5.5.3.1.3.2.cmml" xref="alg1.l18.m1.5.5.3.1.3.2">𝑘</ci><apply id="alg1.l18.m1.5.5.3.1.3.3.cmml" xref="alg1.l18.m1.5.5.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.3.1.3.3.1.cmml" xref="alg1.l18.m1.5.5.3.1.3.3">superscript</csymbol><ci id="alg1.l18.m1.5.5.3.1.3.3.2.cmml" xref="alg1.l18.m1.5.5.3.1.3.3.2">𝐶</ci><apply id="alg1.l18.m1.5.5.3.1.3.3.3.cmml" xref="alg1.l18.m1.5.5.3.1.3.3.3"><ci id="alg1.l18.m1.5.5.3.1.3.3.3.1.cmml" xref="alg1.l18.m1.5.5.3.1.3.3.3.1">′</ci></apply></apply></apply></apply><apply id="alg1.l18.m1.5.5.3.2.cmml" xref="alg1.l18.m1.5.5.3.2"><ci id="alg1.l18.m1.5.5.3.2.1.cmml" xref="alg1.l18.m1.5.5.3.2.1">⋅</ci><apply id="alg1.l18.m1.5.5.3.2.2.cmml" xref="alg1.l18.m1.5.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.3.2.2.1.cmml" xref="alg1.l18.m1.5.5.3.2.2">subscript</csymbol><ci id="alg1.l18.m1.5.5.3.2.2.2.cmml" xref="alg1.l18.m1.5.5.3.2.2.2">Δ</ci><ci id="alg1.l18.m1.5.5.3.2.2.3.cmml" xref="alg1.l18.m1.5.5.3.2.2.3">𝑘</ci></apply><apply id="alg1.l18.m1.5.5.3.2.3.1.cmml" xref="alg1.l18.m1.5.5.3.2.3.2"><min id="alg1.l18.m1.3.3.cmml" xref="alg1.l18.m1.3.3"></min><cn type="integer" id="alg1.l18.m1.4.4.cmml" xref="alg1.l18.m1.4.4">1</cn><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><divide id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1"></divide><ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">𝑆</ci><apply id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1">subscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l18.m1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.2">Δ</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="alg1.l18.m1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.5c">\mathcal{N}(0,I\sigma^{2})+\sum_{k\in C^{{}^{\prime}}}\Delta_{k}\cdot\min\big{(}1,\frac{S}{\lVert\Delta_{k}\rVert_{2}}\big{)}</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>  
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.2.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>  <span id="alg1.l20.1" class="ltx_text ltx_font_smallcaps">UserUpdate<math id="alg1.l20.1.m1.1" class="ltx_Math" alttext="(W^{{}^{\prime}})" display="inline"><semantics id="alg1.l20.1.m1.1a"><mrow id="alg1.l20.1.m1.1.1.1" xref="alg1.l20.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l20.1.m1.1.1.1.2" xref="alg1.l20.1.m1.1.1.1.1.cmml">(</mo><msup id="alg1.l20.1.m1.1.1.1.1" xref="alg1.l20.1.m1.1.1.1.1.cmml"><mi id="alg1.l20.1.m1.1.1.1.1.2" xref="alg1.l20.1.m1.1.1.1.1.2.cmml">W</mi><msup id="alg1.l20.1.m1.1.1.1.1.3" xref="alg1.l20.1.m1.1.1.1.1.3.cmml"><mi id="alg1.l20.1.m1.1.1.1.1.3a" xref="alg1.l20.1.m1.1.1.1.1.3.cmml"></mi><mo id="alg1.l20.1.m1.1.1.1.1.3.1" xref="alg1.l20.1.m1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="alg1.l20.1.m1.1.1.1.3" xref="alg1.l20.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.1.m1.1b"><apply id="alg1.l20.1.m1.1.1.1.1.cmml" xref="alg1.l20.1.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.1.m1.1.1.1.1.1.cmml" xref="alg1.l20.1.m1.1.1.1">superscript</csymbol><ci id="alg1.l20.1.m1.1.1.1.1.2.cmml" xref="alg1.l20.1.m1.1.1.1.1.2">𝑊</ci><apply id="alg1.l20.1.m1.1.1.1.1.3.cmml" xref="alg1.l20.1.m1.1.1.1.1.3"><ci id="alg1.l20.1.m1.1.1.1.1.3.1.cmml" xref="alg1.l20.1.m1.1.1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.1.m1.1c">(W^{{}^{\prime}})</annotation></semantics></math></span>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>       <span id="alg1.l21.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>           number of local epochs <math id="alg1.l22.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l22.m1.1a"><mi id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">E</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>           minibatch size <math id="alg1.l23.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg1.l23.m1.1a"><mi id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">\beta</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>           learning rate <math id="alg1.l24.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l24.m1.1a"><mi id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><ci id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\eta</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>       <math id="alg1.l25.m1.1" class="ltx_Math" alttext="W^{+}\leftarrow W^{{}^{\prime}}" display="inline"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><msup id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.2.2" xref="alg1.l25.m1.1.1.2.2.cmml">W</mi><mo id="alg1.l25.m1.1.1.2.3" xref="alg1.l25.m1.1.1.2.3.cmml">+</mo></msup><mo stretchy="false" id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1.cmml">←</mo><msup id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml"><mi id="alg1.l25.m1.1.1.3.2" xref="alg1.l25.m1.1.1.3.2.cmml">W</mi><msup id="alg1.l25.m1.1.1.3.3" xref="alg1.l25.m1.1.1.3.3.cmml"><mi id="alg1.l25.m1.1.1.3.3a" xref="alg1.l25.m1.1.1.3.3.cmml"></mi><mo id="alg1.l25.m1.1.1.3.3.1" xref="alg1.l25.m1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><ci id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">←</ci><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.2">superscript</csymbol><ci id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2.2">𝑊</ci><plus id="alg1.l25.m1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.2.3"></plus></apply><apply id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.3">superscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.3.2">𝑊</ci><apply id="alg1.l25.m1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.3.3"><ci id="alg1.l25.m1.1.1.3.3.1.cmml" xref="alg1.l25.m1.1.1.3.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">W^{+}\leftarrow W^{{}^{\prime}}</annotation></semantics></math>

</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>       <span id="alg1.l26.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l26.m1.3" class="ltx_Math" alttext="e=1,2,\ldots E" display="inline"><semantics id="alg1.l26.m1.3a"><mrow id="alg1.l26.m1.3.3" xref="alg1.l26.m1.3.3.cmml"><mi id="alg1.l26.m1.3.3.3" xref="alg1.l26.m1.3.3.3.cmml">e</mi><mo id="alg1.l26.m1.3.3.2" xref="alg1.l26.m1.3.3.2.cmml">=</mo><mrow id="alg1.l26.m1.3.3.1.1" xref="alg1.l26.m1.3.3.1.2.cmml"><mn id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml">1</mn><mo id="alg1.l26.m1.3.3.1.1.2" xref="alg1.l26.m1.3.3.1.2.cmml">,</mo><mn id="alg1.l26.m1.2.2" xref="alg1.l26.m1.2.2.cmml">2</mn><mo id="alg1.l26.m1.3.3.1.1.3" xref="alg1.l26.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l26.m1.3.3.1.1.1" xref="alg1.l26.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l26.m1.3.3.1.1.1.2" xref="alg1.l26.m1.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.3.3.1.1.1.1" xref="alg1.l26.m1.3.3.1.1.1.1.cmml">​</mo><mi id="alg1.l26.m1.3.3.1.1.1.3" xref="alg1.l26.m1.3.3.1.1.1.3.cmml">E</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.3b"><apply id="alg1.l26.m1.3.3.cmml" xref="alg1.l26.m1.3.3"><eq id="alg1.l26.m1.3.3.2.cmml" xref="alg1.l26.m1.3.3.2"></eq><ci id="alg1.l26.m1.3.3.3.cmml" xref="alg1.l26.m1.3.3.3">𝑒</ci><list id="alg1.l26.m1.3.3.1.2.cmml" xref="alg1.l26.m1.3.3.1.1"><cn type="integer" id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">1</cn><cn type="integer" id="alg1.l26.m1.2.2.cmml" xref="alg1.l26.m1.2.2">2</cn><apply id="alg1.l26.m1.3.3.1.1.1.cmml" xref="alg1.l26.m1.3.3.1.1.1"><times id="alg1.l26.m1.3.3.1.1.1.1.cmml" xref="alg1.l26.m1.3.3.1.1.1.1"></times><ci id="alg1.l26.m1.3.3.1.1.1.2.cmml" xref="alg1.l26.m1.3.3.1.1.1.2">…</ci><ci id="alg1.l26.m1.3.3.1.1.1.3.cmml" xref="alg1.l26.m1.3.3.1.1.1.3">𝐸</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.3c">e=1,2,\ldots E</annotation></semantics></math> <span id="alg1.l26.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span>           <math id="alg1.l27.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow" display="inline"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l27.m1.1.1.2" xref="alg1.l27.m1.1.1.2.cmml">ℬ</mi><mo stretchy="false" id="alg1.l27.m1.1.1.1" xref="alg1.l27.m1.1.1.1.cmml">←</mo><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><ci id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1">←</ci><ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">ℬ</ci><csymbol cd="latexml" id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">\mathcal{B}\leftarrow</annotation></semantics></math> (split local data into batches of size <math id="alg1.l27.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg1.l27.m2.1a"><mi id="alg1.l27.m2.1.1" xref="alg1.l27.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l27.m2.1b"><ci id="alg1.l27.m2.1.1.cmml" xref="alg1.l27.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m2.1c">\beta</annotation></semantics></math>)

</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span>           <span id="alg1.l28.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l28.m1.1" class="ltx_Math" alttext="b\in\mathcal{B}" display="inline"><semantics id="alg1.l28.m1.1a"><mrow id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml"><mi id="alg1.l28.m1.1.1.2" xref="alg1.l28.m1.1.1.2.cmml">b</mi><mo id="alg1.l28.m1.1.1.1" xref="alg1.l28.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.1.1.3" xref="alg1.l28.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><apply id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1"><in id="alg1.l28.m1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1"></in><ci id="alg1.l28.m1.1.1.2.cmml" xref="alg1.l28.m1.1.1.2">𝑏</ci><ci id="alg1.l28.m1.1.1.3.cmml" xref="alg1.l28.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">b\in\mathcal{B}</annotation></semantics></math> <span id="alg1.l28.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span>               <math id="alg1.l29.m1.1" class="ltx_Math" alttext="W^{+}\leftarrow W^{+}-\eta\triangledown\ell(W^{+})" display="inline"><semantics id="alg1.l29.m1.1a"><mrow id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml"><msup id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml"><mi id="alg1.l29.m1.1.1.3.2" xref="alg1.l29.m1.1.1.3.2.cmml">W</mi><mo id="alg1.l29.m1.1.1.3.3" xref="alg1.l29.m1.1.1.3.3.cmml">+</mo></msup><mo stretchy="false" id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2.cmml">←</mo><mrow id="alg1.l29.m1.1.1.1" xref="alg1.l29.m1.1.1.1.cmml"><msup id="alg1.l29.m1.1.1.1.3" xref="alg1.l29.m1.1.1.1.3.cmml"><mi id="alg1.l29.m1.1.1.1.3.2" xref="alg1.l29.m1.1.1.1.3.2.cmml">W</mi><mo id="alg1.l29.m1.1.1.1.3.3" xref="alg1.l29.m1.1.1.1.3.3.cmml">+</mo></msup><mo id="alg1.l29.m1.1.1.1.2" xref="alg1.l29.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l29.m1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.cmml"><mi id="alg1.l29.m1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg1.l29.m1.1.1.1.1.4" xref="alg1.l29.m1.1.1.1.1.4.cmml">▽</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.2a" xref="alg1.l29.m1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg1.l29.m1.1.1.1.1.5" xref="alg1.l29.m1.1.1.1.1.5.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg1.l29.m1.1.1.1.1.2b" xref="alg1.l29.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l29.m1.1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mo id="alg1.l29.m1.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo stretchy="false" id="alg1.l29.m1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b"><apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1"><ci id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2">←</ci><apply id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.3">superscript</csymbol><ci id="alg1.l29.m1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.3.2">𝑊</ci><plus id="alg1.l29.m1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.3.3"></plus></apply><apply id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1"><minus id="alg1.l29.m1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.2"></minus><apply id="alg1.l29.m1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.1.3">superscript</csymbol><ci id="alg1.l29.m1.1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.1.3.2">𝑊</ci><plus id="alg1.l29.m1.1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.1.3.3"></plus></apply><apply id="alg1.l29.m1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1"><times id="alg1.l29.m1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.2"></times><ci id="alg1.l29.m1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.3">𝜂</ci><ci id="alg1.l29.m1.1.1.1.1.4.cmml" xref="alg1.l29.m1.1.1.1.1.4">▽</ci><ci id="alg1.l29.m1.1.1.1.1.5.cmml" xref="alg1.l29.m1.1.1.1.1.5">ℓ</ci><apply id="alg1.l29.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.2">𝑊</ci><plus id="alg1.l29.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.1c">W^{+}\leftarrow W^{+}-\eta\triangledown\ell(W^{+})</annotation></semantics></math>

</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l30.1.1.1" class="ltx_text" style="font-size:80%;">30:</span></span>       <span id="alg1.l30.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l30.m1.1" class="ltx_Math" alttext="W^{+}-W^{{}^{\prime}}" display="inline"><semantics id="alg1.l30.m1.1a"><mrow id="alg1.l30.m1.1.1" xref="alg1.l30.m1.1.1.cmml"><msup id="alg1.l30.m1.1.1.2" xref="alg1.l30.m1.1.1.2.cmml"><mi id="alg1.l30.m1.1.1.2.2" xref="alg1.l30.m1.1.1.2.2.cmml">W</mi><mo id="alg1.l30.m1.1.1.2.3" xref="alg1.l30.m1.1.1.2.3.cmml">+</mo></msup><mo id="alg1.l30.m1.1.1.1" xref="alg1.l30.m1.1.1.1.cmml">−</mo><msup id="alg1.l30.m1.1.1.3" xref="alg1.l30.m1.1.1.3.cmml"><mi id="alg1.l30.m1.1.1.3.2" xref="alg1.l30.m1.1.1.3.2.cmml">W</mi><msup id="alg1.l30.m1.1.1.3.3" xref="alg1.l30.m1.1.1.3.3.cmml"><mi id="alg1.l30.m1.1.1.3.3a" xref="alg1.l30.m1.1.1.3.3.cmml"></mi><mo id="alg1.l30.m1.1.1.3.3.1" xref="alg1.l30.m1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.1b"><apply id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1"><minus id="alg1.l30.m1.1.1.1.cmml" xref="alg1.l30.m1.1.1.1"></minus><apply id="alg1.l30.m1.1.1.2.cmml" xref="alg1.l30.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l30.m1.1.1.2.1.cmml" xref="alg1.l30.m1.1.1.2">superscript</csymbol><ci id="alg1.l30.m1.1.1.2.2.cmml" xref="alg1.l30.m1.1.1.2.2">𝑊</ci><plus id="alg1.l30.m1.1.1.2.3.cmml" xref="alg1.l30.m1.1.1.2.3"></plus></apply><apply id="alg1.l30.m1.1.1.3.cmml" xref="alg1.l30.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l30.m1.1.1.3.1.cmml" xref="alg1.l30.m1.1.1.3">superscript</csymbol><ci id="alg1.l30.m1.1.1.3.2.cmml" xref="alg1.l30.m1.1.1.3.2">𝑊</ci><apply id="alg1.l30.m1.1.1.3.3.cmml" xref="alg1.l30.m1.1.1.3.3"><ci id="alg1.l30.m1.1.1.3.3.1.cmml" xref="alg1.l30.m1.1.1.3.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.1c">W^{+}-W^{{}^{\prime}}</annotation></semantics></math>

</div>
</div>
</figure>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.5" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ III-B Differentially Private Federated Learning ‣ III Federated learning with differential privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the algorithm for DP-FedAvg with secure summing.
Note that the standard deviation of the noise (<math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="z\cdot S" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">⋅</mo><mi id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><ci id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1">⋅</ci><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝑧</ci><ci id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">z\cdot S</annotation></semantics></math>) is proportional to the clipping bound <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mi id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">S</annotation></semantics></math>, which bounds the norm of each individual contribution vector.
Also, independent noise is added to each element of the vector.
To improve the signal-to-noise ratio, then, and to make training work better, reducing the dimensionality of what each client sends up is a good strategy.
First, the vectors will tend to have a lower <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><msub id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\ell_{2}</annotation></semantics></math> norm <math id="S3.SS2.p6.4.m4.1" class="ltx_Math" alttext="\lVert\Delta_{k}\rVert_{2}" display="inline"><semantics id="S3.SS2.p6.4.m4.1a"><msub id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml"><mrow id="S3.SS2.p6.4.m4.1.1.1.1" xref="S3.SS2.p6.4.m4.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S3.SS2.p6.4.m4.1.1.1.1.2" xref="S3.SS2.p6.4.m4.1.1.1.2.1.cmml">∥</mo><msub id="S3.SS2.p6.4.m4.1.1.1.1.1" xref="S3.SS2.p6.4.m4.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p6.4.m4.1.1.1.1.1.2" xref="S3.SS2.p6.4.m4.1.1.1.1.1.2.cmml">Δ</mi><mi id="S3.SS2.p6.4.m4.1.1.1.1.1.3" xref="S3.SS2.p6.4.m4.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="S3.SS2.p6.4.m4.1.1.1.1.3" xref="S3.SS2.p6.4.m4.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS2.p6.4.m4.1.1.3" xref="S3.SS2.p6.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><apply id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m4.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p6.4.m4.1.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p6.4.m4.1.1.1.2.1.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS2.p6.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p6.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1.1.2">Δ</ci><ci id="S3.SS2.p6.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p6.4.m4.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="S3.SS2.p6.4.m4.1.1.3.cmml" xref="S3.SS2.p6.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">\lVert\Delta_{k}\rVert_{2}</annotation></semantics></math>, so the clipping bound <math id="S3.SS2.p6.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p6.5.m5.1a"><mi id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><ci id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">S</annotation></semantics></math> can be lowered, and second, the noise is added to fewer elements.
The rest of this article will focus on demonstrating the power of this approach.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Parameter-Efficient Fine-tuning with Differential Privacy</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Parameter-efficient fine-tuning (PEFT) is a technique designed for efficient adaptation of pre-trained models to downstream tasks.
Instead of fine-tuning all parameters of a model, parameter-efficient fine-tuning methods aim to train only a small number of parameters.
Especially for large pre-trained models, this makes training much cheaper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">When applied to differentially private federated learning (DP-FL), there are additional benefits to parameter-efficient fine-tuning over training the whole model.
Clients now need to send up only a smaller vector.
Less communication is then required, and the signal-to-noise ratio improves.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Adapter</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">Adapter was originally proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> as an early attempt to adapter-based fine-tuning of large pre-trained models. This method reduces the number of trainable parameters by inserting a compact bottleneck adapter layer after each attention and feed-forward layer while freezing all the weights of the pre-trained model. Given a <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">d</annotation></semantics></math>-dimensional feature <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">x</annotation></semantics></math>, an adapter layer can be represented as:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.3" class="ltx_Math" alttext="\text{adapter}(x)=U(\tau(D(x)))+x," display="block"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml"><mtext id="S4.E1.m1.3.3.1.1.3.2" xref="S4.E1.m1.3.3.1.1.3.2a.cmml">adapter</mtext><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.3.1" xref="S4.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.3.3.2" xref="S4.E1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.1.1.3.3.2.1" xref="S4.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E1.m1.3.3.1.1.3.3.2.2" xref="S4.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.3.3.1.1.2" xref="S4.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">x</mi><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml">+</mo><mi id="S4.E1.m1.3.3.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.3.cmml">x</mi></mrow></mrow><mo id="S4.E1.m1.3.3.1.2" xref="S4.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1"><eq id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2"></eq><apply id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3"><times id="S4.E1.m1.3.3.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.3.1"></times><ci id="S4.E1.m1.3.3.1.1.3.2a.cmml" xref="S4.E1.m1.3.3.1.1.3.2"><mtext id="S4.E1.m1.3.3.1.1.3.2.cmml" xref="S4.E1.m1.3.3.1.1.3.2">adapter</mtext></ci><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑥</ci></apply><apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1"><plus id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2"></plus><apply id="S4.E1.m1.3.3.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.3">𝑈</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.3">𝜏</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝐷</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑥</ci></apply></apply></apply><ci id="S4.E1.m1.3.3.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\text{adapter}(x)=U(\tau(D(x)))+x,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.8" class="ltx_p">where <math id="S4.SS1.p1.3.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{k}" display="inline"><semantics id="S4.SS1.p1.3.m1.1a"><mrow id="S4.SS1.p1.3.m1.1.1" xref="S4.SS1.p1.3.m1.1.1.cmml"><mi id="S4.SS1.p1.3.m1.1.1.2" xref="S4.SS1.p1.3.m1.1.1.2.cmml">x</mi><mo id="S4.SS1.p1.3.m1.1.1.1" xref="S4.SS1.p1.3.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.3.m1.1.1.3" xref="S4.SS1.p1.3.m1.1.1.3.cmml"><mi id="S4.SS1.p1.3.m1.1.1.3.2" xref="S4.SS1.p1.3.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p1.3.m1.1.1.3.3" xref="S4.SS1.p1.3.m1.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.1b"><apply id="S4.SS1.p1.3.m1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1"><in id="S4.SS1.p1.3.m1.1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1.1"></in><ci id="S4.SS1.p1.3.m1.1.1.2.cmml" xref="S4.SS1.p1.3.m1.1.1.2">𝑥</ci><apply id="S4.SS1.p1.3.m1.1.1.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m1.1.1.3.1.cmml" xref="S4.SS1.p1.3.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.3.m1.1.1.3.2.cmml" xref="S4.SS1.p1.3.m1.1.1.3.2">ℝ</ci><ci id="S4.SS1.p1.3.m1.1.1.3.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.1c">x\in\mathbb{R}^{k}</annotation></semantics></math> is the input, <math id="S4.SS1.p1.4.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.4.m2.1a"><mi id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.1b"><ci id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.1c">k</annotation></semantics></math> is the input dimension, <math id="S4.SS1.p1.5.m3.1" class="ltx_Math" alttext="U\in\mathbb{R}^{r\times k}" display="inline"><semantics id="S4.SS1.p1.5.m3.1a"><mrow id="S4.SS1.p1.5.m3.1.1" xref="S4.SS1.p1.5.m3.1.1.cmml"><mi id="S4.SS1.p1.5.m3.1.1.2" xref="S4.SS1.p1.5.m3.1.1.2.cmml">U</mi><mo id="S4.SS1.p1.5.m3.1.1.1" xref="S4.SS1.p1.5.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.5.m3.1.1.3" xref="S4.SS1.p1.5.m3.1.1.3.cmml"><mi id="S4.SS1.p1.5.m3.1.1.3.2" xref="S4.SS1.p1.5.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.5.m3.1.1.3.3" xref="S4.SS1.p1.5.m3.1.1.3.3.cmml"><mi id="S4.SS1.p1.5.m3.1.1.3.3.2" xref="S4.SS1.p1.5.m3.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.5.m3.1.1.3.3.1" xref="S4.SS1.p1.5.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.5.m3.1.1.3.3.3" xref="S4.SS1.p1.5.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.1b"><apply id="S4.SS1.p1.5.m3.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1"><in id="S4.SS1.p1.5.m3.1.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1.1"></in><ci id="S4.SS1.p1.5.m3.1.1.2.cmml" xref="S4.SS1.p1.5.m3.1.1.2">𝑈</ci><apply id="S4.SS1.p1.5.m3.1.1.3.cmml" xref="S4.SS1.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m3.1.1.3.1.cmml" xref="S4.SS1.p1.5.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.5.m3.1.1.3.2.cmml" xref="S4.SS1.p1.5.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.5.m3.1.1.3.3.cmml" xref="S4.SS1.p1.5.m3.1.1.3.3"><times id="S4.SS1.p1.5.m3.1.1.3.3.1.cmml" xref="S4.SS1.p1.5.m3.1.1.3.3.1"></times><ci id="S4.SS1.p1.5.m3.1.1.3.3.2.cmml" xref="S4.SS1.p1.5.m3.1.1.3.3.2">𝑟</ci><ci id="S4.SS1.p1.5.m3.1.1.3.3.3.cmml" xref="S4.SS1.p1.5.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.1c">U\in\mathbb{R}^{r\times k}</annotation></semantics></math> is a linear up-projection map with rank <math id="S4.SS1.p1.6.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p1.6.m4.1a"><mi id="S4.SS1.p1.6.m4.1.1" xref="S4.SS1.p1.6.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m4.1b"><ci id="S4.SS1.p1.6.m4.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m4.1c">r</annotation></semantics></math>, <math id="S4.SS1.p1.7.m5.1" class="ltx_Math" alttext="D\in\mathbb{R}^{k\times r}" display="inline"><semantics id="S4.SS1.p1.7.m5.1a"><mrow id="S4.SS1.p1.7.m5.1.1" xref="S4.SS1.p1.7.m5.1.1.cmml"><mi id="S4.SS1.p1.7.m5.1.1.2" xref="S4.SS1.p1.7.m5.1.1.2.cmml">D</mi><mo id="S4.SS1.p1.7.m5.1.1.1" xref="S4.SS1.p1.7.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.7.m5.1.1.3" xref="S4.SS1.p1.7.m5.1.1.3.cmml"><mi id="S4.SS1.p1.7.m5.1.1.3.2" xref="S4.SS1.p1.7.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.7.m5.1.1.3.3" xref="S4.SS1.p1.7.m5.1.1.3.3.cmml"><mi id="S4.SS1.p1.7.m5.1.1.3.3.2" xref="S4.SS1.p1.7.m5.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.7.m5.1.1.3.3.1" xref="S4.SS1.p1.7.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.7.m5.1.1.3.3.3" xref="S4.SS1.p1.7.m5.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m5.1b"><apply id="S4.SS1.p1.7.m5.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1"><in id="S4.SS1.p1.7.m5.1.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1.1"></in><ci id="S4.SS1.p1.7.m5.1.1.2.cmml" xref="S4.SS1.p1.7.m5.1.1.2">𝐷</ci><apply id="S4.SS1.p1.7.m5.1.1.3.cmml" xref="S4.SS1.p1.7.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m5.1.1.3.1.cmml" xref="S4.SS1.p1.7.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.7.m5.1.1.3.2.cmml" xref="S4.SS1.p1.7.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.7.m5.1.1.3.3.cmml" xref="S4.SS1.p1.7.m5.1.1.3.3"><times id="S4.SS1.p1.7.m5.1.1.3.3.1.cmml" xref="S4.SS1.p1.7.m5.1.1.3.3.1"></times><ci id="S4.SS1.p1.7.m5.1.1.3.3.2.cmml" xref="S4.SS1.p1.7.m5.1.1.3.3.2">𝑘</ci><ci id="S4.SS1.p1.7.m5.1.1.3.3.3.cmml" xref="S4.SS1.p1.7.m5.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m5.1c">D\in\mathbb{R}^{k\times r}</annotation></semantics></math> is a linear down-projection map and <math id="S4.SS1.p1.8.m6.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p1.8.m6.1a"><mi id="S4.SS1.p1.8.m6.1.1" xref="S4.SS1.p1.8.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m6.1b"><ci id="S4.SS1.p1.8.m6.1.1.cmml" xref="S4.SS1.p1.8.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m6.1c">\tau</annotation></semantics></math> is a non-linear activation function. After the initial attempt, a few variants of Adapter have been proposed such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> which only adds an adapter layer after the feed-forward layer. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, we only consider the approach proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> in our experiments.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Compacter</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">Compacter proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> introduces a more parameter-efficient version of adapter layers. This is done by replacing the dense matrices for the up-projection <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">U</annotation></semantics></math> and down-projection <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">D</annotation></semantics></math> with low-rank parameterised hypercomplex multiplication layer (LPHM) while removing the nonlinearity and residual connection. Each Compacter layer therefore can be represented as the sum of <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">n</annotation></semantics></math> Kronecker products as follows:</p>
<table id="S4.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{compacter}(x)" display="inline"><semantics id="S4.E2X.2.1.1.m1.1a"><mrow id="S4.E2X.2.1.1.m1.1.2" xref="S4.E2X.2.1.1.m1.1.2.cmml"><mtext id="S4.E2X.2.1.1.m1.1.2.2" xref="S4.E2X.2.1.1.m1.1.2.2a.cmml">compacter</mtext><mo lspace="0em" rspace="0em" id="S4.E2X.2.1.1.m1.1.2.1" xref="S4.E2X.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.E2X.2.1.1.m1.1.2.3.2" xref="S4.E2X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.E2X.2.1.1.m1.1.2.3.2.1" xref="S4.E2X.2.1.1.m1.1.2.cmml">(</mo><mi id="S4.E2X.2.1.1.m1.1.1" xref="S4.E2X.2.1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E2X.2.1.1.m1.1.2.3.2.2" xref="S4.E2X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2X.2.1.1.m1.1b"><apply id="S4.E2X.2.1.1.m1.1.2.cmml" xref="S4.E2X.2.1.1.m1.1.2"><times id="S4.E2X.2.1.1.m1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.2.1"></times><ci id="S4.E2X.2.1.1.m1.1.2.2a.cmml" xref="S4.E2X.2.1.1.m1.1.2.2"><mtext id="S4.E2X.2.1.1.m1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.2.2">compacter</mtext></ci><ci id="S4.E2X.2.1.1.m1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.2.1.1.m1.1c">\displaystyle\text{compacter}(x)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=W_{\text{compacter}}x+b" display="inline"><semantics id="S4.E2X.3.2.2.m1.1a"><mrow id="S4.E2X.3.2.2.m1.1.1" xref="S4.E2X.3.2.2.m1.1.1.cmml"><mi id="S4.E2X.3.2.2.m1.1.1.2" xref="S4.E2X.3.2.2.m1.1.1.2.cmml"></mi><mo id="S4.E2X.3.2.2.m1.1.1.1" xref="S4.E2X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S4.E2X.3.2.2.m1.1.1.3" xref="S4.E2X.3.2.2.m1.1.1.3.cmml"><mrow id="S4.E2X.3.2.2.m1.1.1.3.2" xref="S4.E2X.3.2.2.m1.1.1.3.2.cmml"><msub id="S4.E2X.3.2.2.m1.1.1.3.2.2" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.cmml"><mi id="S4.E2X.3.2.2.m1.1.1.3.2.2.2" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.2.cmml">W</mi><mtext id="S4.E2X.3.2.2.m1.1.1.3.2.2.3" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.3a.cmml">compacter</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E2X.3.2.2.m1.1.1.3.2.1" xref="S4.E2X.3.2.2.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.E2X.3.2.2.m1.1.1.3.2.3" xref="S4.E2X.3.2.2.m1.1.1.3.2.3.cmml">x</mi></mrow><mo id="S4.E2X.3.2.2.m1.1.1.3.1" xref="S4.E2X.3.2.2.m1.1.1.3.1.cmml">+</mo><mi id="S4.E2X.3.2.2.m1.1.1.3.3" xref="S4.E2X.3.2.2.m1.1.1.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2X.3.2.2.m1.1b"><apply id="S4.E2X.3.2.2.m1.1.1.cmml" xref="S4.E2X.3.2.2.m1.1.1"><eq id="S4.E2X.3.2.2.m1.1.1.1.cmml" xref="S4.E2X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S4.E2X.3.2.2.m1.1.1.2.cmml" xref="S4.E2X.3.2.2.m1.1.1.2">absent</csymbol><apply id="S4.E2X.3.2.2.m1.1.1.3.cmml" xref="S4.E2X.3.2.2.m1.1.1.3"><plus id="S4.E2X.3.2.2.m1.1.1.3.1.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.1"></plus><apply id="S4.E2X.3.2.2.m1.1.1.3.2.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2"><times id="S4.E2X.3.2.2.m1.1.1.3.2.1.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.1"></times><apply id="S4.E2X.3.2.2.m1.1.1.3.2.2.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E2X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.E2X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.2">𝑊</ci><ci id="S4.E2X.3.2.2.m1.1.1.3.2.2.3a.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.3"><mtext mathsize="70%" id="S4.E2X.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.2.3">compacter</mtext></ci></apply><ci id="S4.E2X.3.2.2.m1.1.1.3.2.3.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.2.3">𝑥</ci></apply><ci id="S4.E2X.3.2.2.m1.1.1.3.3.cmml" xref="S4.E2X.3.2.2.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.3.2.2.m1.1c">\displaystyle=W_{\text{compacter}}x+b</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S4.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\bigg{(}\sum_{i=1}^{n}A_{i}\otimes B_{i}\bigg{)}x+b" display="inline"><semantics id="S4.E2Xa.2.1.1.m1.1a"><mrow id="S4.E2Xa.2.1.1.m1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S4.E2Xa.2.1.1.m1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.E2Xa.2.1.1.m1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.cmml"><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><munderover id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1a" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></munderover></mstyle><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">A</mi><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">⊗</mo><msub id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.2.cmml">B</mi><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo maxsize="210%" minsize="210%" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E2Xa.2.1.1.m1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.2.cmml">​</mo><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E2Xa.2.1.1.m1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.2.cmml">+</mo><mi id="S4.E2Xa.2.1.1.m1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2Xa.2.1.1.m1.1b"><apply id="S4.E2Xa.2.1.1.m1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1"><eq id="S4.E2Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S4.E2Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S4.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1"><plus id="S4.E2Xa.2.1.1.m1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.2"></plus><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1"><times id="S4.E2Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.2"></times><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1"><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><eq id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1">tensor-product</csymbol><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2">𝐴</ci><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.2">𝐵</ci><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3">𝑥</ci></apply><ci id="S4.E2Xa.2.1.1.m1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2Xa.2.1.1.m1.1c">\displaystyle=\bigg{(}\sum_{i=1}^{n}A_{i}\otimes B_{i}\bigg{)}x+b</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S4.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\bigg{(}\sum_{i=1}^{n}A_{i}\otimes\big{(}s_{i}t_{i}^{\top}\big{)}\bigg{)}x+b," display="inline"><semantics id="S4.E2Xb.2.1.1.m1.1a"><mrow id="S4.E2Xb.2.1.1.m1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.3.cmml"></mi><mo id="S4.E2Xb.2.1.1.m1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2a" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover></mstyle><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">A</mi><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⊗</mo><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo maxsize="120%" minsize="120%" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.2.cmml">+</mo><mi id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.3" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.3.cmml">b</mi></mrow></mrow><mo id="S4.E2Xb.2.1.1.m1.1.1.1.2" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2Xb.2.1.1.m1.1b"><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1"><eq id="S4.E2Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E2Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.3">absent</csymbol><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1"><plus id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.2"></plus><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1"><times id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.2"></times><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1"><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">tensor-product</csymbol><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐴</ci><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply></apply><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S4.E2Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E2Xb.2.1.1.m1.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2Xb.2.1.1.m1.1c">\displaystyle=\bigg{(}\sum_{i=1}^{n}A_{i}\otimes\big{(}s_{i}t_{i}^{\top}\big{)}\bigg{)}x+b,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p1.15" class="ltx_p">where <math id="S4.SS2.p1.4.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.4.m1.1a"><mi id="S4.SS2.p1.4.m1.1.1" xref="S4.SS2.p1.4.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m1.1b"><ci id="S4.SS2.p1.4.m1.1.1.cmml" xref="S4.SS2.p1.4.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m1.1c">n</annotation></semantics></math> is a user-defined hyperparameter, <math id="S4.SS2.p1.5.m2.1" class="ltx_Math" alttext="\otimes" display="inline"><semantics id="S4.SS2.p1.5.m2.1a"><mo id="S4.SS2.p1.5.m2.1.1" xref="S4.SS2.p1.5.m2.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m2.1b"><csymbol cd="latexml" id="S4.SS2.p1.5.m2.1.1.cmml" xref="S4.SS2.p1.5.m2.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m2.1c">\otimes</annotation></semantics></math> is the matrix Kronecker product, <math id="S4.SS2.p1.6.m3.1" class="ltx_Math" alttext="W_{\text{compacter}}\in\mathbb{R}^{a\times b}" display="inline"><semantics id="S4.SS2.p1.6.m3.1a"><mrow id="S4.SS2.p1.6.m3.1.1" xref="S4.SS2.p1.6.m3.1.1.cmml"><msub id="S4.SS2.p1.6.m3.1.1.2" xref="S4.SS2.p1.6.m3.1.1.2.cmml"><mi id="S4.SS2.p1.6.m3.1.1.2.2" xref="S4.SS2.p1.6.m3.1.1.2.2.cmml">W</mi><mtext id="S4.SS2.p1.6.m3.1.1.2.3" xref="S4.SS2.p1.6.m3.1.1.2.3a.cmml">compacter</mtext></msub><mo id="S4.SS2.p1.6.m3.1.1.1" xref="S4.SS2.p1.6.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.6.m3.1.1.3" xref="S4.SS2.p1.6.m3.1.1.3.cmml"><mi id="S4.SS2.p1.6.m3.1.1.3.2" xref="S4.SS2.p1.6.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.6.m3.1.1.3.3" xref="S4.SS2.p1.6.m3.1.1.3.3.cmml"><mi id="S4.SS2.p1.6.m3.1.1.3.3.2" xref="S4.SS2.p1.6.m3.1.1.3.3.2.cmml">a</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.6.m3.1.1.3.3.1" xref="S4.SS2.p1.6.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.6.m3.1.1.3.3.3" xref="S4.SS2.p1.6.m3.1.1.3.3.3.cmml">b</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m3.1b"><apply id="S4.SS2.p1.6.m3.1.1.cmml" xref="S4.SS2.p1.6.m3.1.1"><in id="S4.SS2.p1.6.m3.1.1.1.cmml" xref="S4.SS2.p1.6.m3.1.1.1"></in><apply id="S4.SS2.p1.6.m3.1.1.2.cmml" xref="S4.SS2.p1.6.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m3.1.1.2.1.cmml" xref="S4.SS2.p1.6.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.6.m3.1.1.2.2.cmml" xref="S4.SS2.p1.6.m3.1.1.2.2">𝑊</ci><ci id="S4.SS2.p1.6.m3.1.1.2.3a.cmml" xref="S4.SS2.p1.6.m3.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.p1.6.m3.1.1.2.3.cmml" xref="S4.SS2.p1.6.m3.1.1.2.3">compacter</mtext></ci></apply><apply id="S4.SS2.p1.6.m3.1.1.3.cmml" xref="S4.SS2.p1.6.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m3.1.1.3.1.cmml" xref="S4.SS2.p1.6.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.6.m3.1.1.3.2.cmml" xref="S4.SS2.p1.6.m3.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.6.m3.1.1.3.3.cmml" xref="S4.SS2.p1.6.m3.1.1.3.3"><times id="S4.SS2.p1.6.m3.1.1.3.3.1.cmml" xref="S4.SS2.p1.6.m3.1.1.3.3.1"></times><ci id="S4.SS2.p1.6.m3.1.1.3.3.2.cmml" xref="S4.SS2.p1.6.m3.1.1.3.3.2">𝑎</ci><ci id="S4.SS2.p1.6.m3.1.1.3.3.3.cmml" xref="S4.SS2.p1.6.m3.1.1.3.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m3.1c">W_{\text{compacter}}\in\mathbb{R}^{a\times b}</annotation></semantics></math> is a Compacter layer, <math id="S4.SS2.p1.7.m4.1" class="ltx_Math" alttext="A_{i}" display="inline"><semantics id="S4.SS2.p1.7.m4.1a"><msub id="S4.SS2.p1.7.m4.1.1" xref="S4.SS2.p1.7.m4.1.1.cmml"><mi id="S4.SS2.p1.7.m4.1.1.2" xref="S4.SS2.p1.7.m4.1.1.2.cmml">A</mi><mi id="S4.SS2.p1.7.m4.1.1.3" xref="S4.SS2.p1.7.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m4.1b"><apply id="S4.SS2.p1.7.m4.1.1.cmml" xref="S4.SS2.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m4.1.1.1.cmml" xref="S4.SS2.p1.7.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m4.1.1.2.cmml" xref="S4.SS2.p1.7.m4.1.1.2">𝐴</ci><ci id="S4.SS2.p1.7.m4.1.1.3.cmml" xref="S4.SS2.p1.7.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m4.1c">A_{i}</annotation></semantics></math> are parameters shared across all Compacter layers, <math id="S4.SS2.p1.8.m5.1" class="ltx_Math" alttext="B_{i}" display="inline"><semantics id="S4.SS2.p1.8.m5.1a"><msub id="S4.SS2.p1.8.m5.1.1" xref="S4.SS2.p1.8.m5.1.1.cmml"><mi id="S4.SS2.p1.8.m5.1.1.2" xref="S4.SS2.p1.8.m5.1.1.2.cmml">B</mi><mi id="S4.SS2.p1.8.m5.1.1.3" xref="S4.SS2.p1.8.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m5.1b"><apply id="S4.SS2.p1.8.m5.1.1.cmml" xref="S4.SS2.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m5.1.1.1.cmml" xref="S4.SS2.p1.8.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m5.1.1.2.cmml" xref="S4.SS2.p1.8.m5.1.1.2">𝐵</ci><ci id="S4.SS2.p1.8.m5.1.1.3.cmml" xref="S4.SS2.p1.8.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m5.1c">B_{i}</annotation></semantics></math> is a low-rank matrix with non-shared parameters which is the product of two low-rank matrices <math id="S4.SS2.p1.9.m6.1" class="ltx_Math" alttext="s_{i}\in\mathbb{R}^{\frac{a}{n}\times r}" display="inline"><semantics id="S4.SS2.p1.9.m6.1a"><mrow id="S4.SS2.p1.9.m6.1.1" xref="S4.SS2.p1.9.m6.1.1.cmml"><msub id="S4.SS2.p1.9.m6.1.1.2" xref="S4.SS2.p1.9.m6.1.1.2.cmml"><mi id="S4.SS2.p1.9.m6.1.1.2.2" xref="S4.SS2.p1.9.m6.1.1.2.2.cmml">s</mi><mi id="S4.SS2.p1.9.m6.1.1.2.3" xref="S4.SS2.p1.9.m6.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.9.m6.1.1.1" xref="S4.SS2.p1.9.m6.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.9.m6.1.1.3" xref="S4.SS2.p1.9.m6.1.1.3.cmml"><mi id="S4.SS2.p1.9.m6.1.1.3.2" xref="S4.SS2.p1.9.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.9.m6.1.1.3.3" xref="S4.SS2.p1.9.m6.1.1.3.3.cmml"><mfrac id="S4.SS2.p1.9.m6.1.1.3.3.2" xref="S4.SS2.p1.9.m6.1.1.3.3.2.cmml"><mi id="S4.SS2.p1.9.m6.1.1.3.3.2.2" xref="S4.SS2.p1.9.m6.1.1.3.3.2.2.cmml">a</mi><mi id="S4.SS2.p1.9.m6.1.1.3.3.2.3" xref="S4.SS2.p1.9.m6.1.1.3.3.2.3.cmml">n</mi></mfrac><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.9.m6.1.1.3.3.1" xref="S4.SS2.p1.9.m6.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.9.m6.1.1.3.3.3" xref="S4.SS2.p1.9.m6.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m6.1b"><apply id="S4.SS2.p1.9.m6.1.1.cmml" xref="S4.SS2.p1.9.m6.1.1"><in id="S4.SS2.p1.9.m6.1.1.1.cmml" xref="S4.SS2.p1.9.m6.1.1.1"></in><apply id="S4.SS2.p1.9.m6.1.1.2.cmml" xref="S4.SS2.p1.9.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m6.1.1.2.1.cmml" xref="S4.SS2.p1.9.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.9.m6.1.1.2.2.cmml" xref="S4.SS2.p1.9.m6.1.1.2.2">𝑠</ci><ci id="S4.SS2.p1.9.m6.1.1.2.3.cmml" xref="S4.SS2.p1.9.m6.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.9.m6.1.1.3.cmml" xref="S4.SS2.p1.9.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m6.1.1.3.1.cmml" xref="S4.SS2.p1.9.m6.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.9.m6.1.1.3.2.cmml" xref="S4.SS2.p1.9.m6.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.9.m6.1.1.3.3.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3"><times id="S4.SS2.p1.9.m6.1.1.3.3.1.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.1"></times><apply id="S4.SS2.p1.9.m6.1.1.3.3.2.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.2"><divide id="S4.SS2.p1.9.m6.1.1.3.3.2.1.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.2"></divide><ci id="S4.SS2.p1.9.m6.1.1.3.3.2.2.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.2.2">𝑎</ci><ci id="S4.SS2.p1.9.m6.1.1.3.3.2.3.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.2.3">𝑛</ci></apply><ci id="S4.SS2.p1.9.m6.1.1.3.3.3.cmml" xref="S4.SS2.p1.9.m6.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m6.1c">s_{i}\in\mathbb{R}^{\frac{a}{n}\times r}</annotation></semantics></math> and <math id="S4.SS2.p1.10.m7.1" class="ltx_Math" alttext="t_{i}\in\mathbb{R}^{r\times\frac{b}{n}}" display="inline"><semantics id="S4.SS2.p1.10.m7.1a"><mrow id="S4.SS2.p1.10.m7.1.1" xref="S4.SS2.p1.10.m7.1.1.cmml"><msub id="S4.SS2.p1.10.m7.1.1.2" xref="S4.SS2.p1.10.m7.1.1.2.cmml"><mi id="S4.SS2.p1.10.m7.1.1.2.2" xref="S4.SS2.p1.10.m7.1.1.2.2.cmml">t</mi><mi id="S4.SS2.p1.10.m7.1.1.2.3" xref="S4.SS2.p1.10.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.10.m7.1.1.1" xref="S4.SS2.p1.10.m7.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.10.m7.1.1.3" xref="S4.SS2.p1.10.m7.1.1.3.cmml"><mi id="S4.SS2.p1.10.m7.1.1.3.2" xref="S4.SS2.p1.10.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.10.m7.1.1.3.3" xref="S4.SS2.p1.10.m7.1.1.3.3.cmml"><mi id="S4.SS2.p1.10.m7.1.1.3.3.2" xref="S4.SS2.p1.10.m7.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.10.m7.1.1.3.3.1" xref="S4.SS2.p1.10.m7.1.1.3.3.1.cmml">×</mo><mfrac id="S4.SS2.p1.10.m7.1.1.3.3.3" xref="S4.SS2.p1.10.m7.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.10.m7.1.1.3.3.3.2" xref="S4.SS2.p1.10.m7.1.1.3.3.3.2.cmml">b</mi><mi id="S4.SS2.p1.10.m7.1.1.3.3.3.3" xref="S4.SS2.p1.10.m7.1.1.3.3.3.3.cmml">n</mi></mfrac></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m7.1b"><apply id="S4.SS2.p1.10.m7.1.1.cmml" xref="S4.SS2.p1.10.m7.1.1"><in id="S4.SS2.p1.10.m7.1.1.1.cmml" xref="S4.SS2.p1.10.m7.1.1.1"></in><apply id="S4.SS2.p1.10.m7.1.1.2.cmml" xref="S4.SS2.p1.10.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m7.1.1.2.1.cmml" xref="S4.SS2.p1.10.m7.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.10.m7.1.1.2.2.cmml" xref="S4.SS2.p1.10.m7.1.1.2.2">𝑡</ci><ci id="S4.SS2.p1.10.m7.1.1.2.3.cmml" xref="S4.SS2.p1.10.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.10.m7.1.1.3.cmml" xref="S4.SS2.p1.10.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m7.1.1.3.1.cmml" xref="S4.SS2.p1.10.m7.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.10.m7.1.1.3.2.cmml" xref="S4.SS2.p1.10.m7.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.10.m7.1.1.3.3.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3"><times id="S4.SS2.p1.10.m7.1.1.3.3.1.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.1"></times><ci id="S4.SS2.p1.10.m7.1.1.3.3.2.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.2">𝑟</ci><apply id="S4.SS2.p1.10.m7.1.1.3.3.3.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.3"><divide id="S4.SS2.p1.10.m7.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.3"></divide><ci id="S4.SS2.p1.10.m7.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.3.2">𝑏</ci><ci id="S4.SS2.p1.10.m7.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.10.m7.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m7.1c">t_{i}\in\mathbb{R}^{r\times\frac{b}{n}}</annotation></semantics></math>. Here, only <math id="S4.SS2.p1.11.m8.1" class="ltx_Math" alttext="B_{i}" display="inline"><semantics id="S4.SS2.p1.11.m8.1a"><msub id="S4.SS2.p1.11.m8.1.1" xref="S4.SS2.p1.11.m8.1.1.cmml"><mi id="S4.SS2.p1.11.m8.1.1.2" xref="S4.SS2.p1.11.m8.1.1.2.cmml">B</mi><mi id="S4.SS2.p1.11.m8.1.1.3" xref="S4.SS2.p1.11.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m8.1b"><apply id="S4.SS2.p1.11.m8.1.1.cmml" xref="S4.SS2.p1.11.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m8.1.1.1.cmml" xref="S4.SS2.p1.11.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.11.m8.1.1.2.cmml" xref="S4.SS2.p1.11.m8.1.1.2">𝐵</ci><ci id="S4.SS2.p1.11.m8.1.1.3.cmml" xref="S4.SS2.p1.11.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m8.1c">B_{i}</annotation></semantics></math> is factorised since <math id="S4.SS2.p1.12.m9.1" class="ltx_Math" alttext="A_{i}" display="inline"><semantics id="S4.SS2.p1.12.m9.1a"><msub id="S4.SS2.p1.12.m9.1.1" xref="S4.SS2.p1.12.m9.1.1.cmml"><mi id="S4.SS2.p1.12.m9.1.1.2" xref="S4.SS2.p1.12.m9.1.1.2.cmml">A</mi><mi id="S4.SS2.p1.12.m9.1.1.3" xref="S4.SS2.p1.12.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m9.1b"><apply id="S4.SS2.p1.12.m9.1.1.cmml" xref="S4.SS2.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m9.1.1.1.cmml" xref="S4.SS2.p1.12.m9.1.1">subscript</csymbol><ci id="S4.SS2.p1.12.m9.1.1.2.cmml" xref="S4.SS2.p1.12.m9.1.1.2">𝐴</ci><ci id="S4.SS2.p1.12.m9.1.1.3.cmml" xref="S4.SS2.p1.12.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m9.1c">A_{i}</annotation></semantics></math> are small and shared across all Compacter layers. Factorising <math id="S4.SS2.p1.13.m10.1" class="ltx_Math" alttext="A_{i}" display="inline"><semantics id="S4.SS2.p1.13.m10.1a"><msub id="S4.SS2.p1.13.m10.1.1" xref="S4.SS2.p1.13.m10.1.1.cmml"><mi id="S4.SS2.p1.13.m10.1.1.2" xref="S4.SS2.p1.13.m10.1.1.2.cmml">A</mi><mi id="S4.SS2.p1.13.m10.1.1.3" xref="S4.SS2.p1.13.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m10.1b"><apply id="S4.SS2.p1.13.m10.1.1.cmml" xref="S4.SS2.p1.13.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m10.1.1.1.cmml" xref="S4.SS2.p1.13.m10.1.1">subscript</csymbol><ci id="S4.SS2.p1.13.m10.1.1.2.cmml" xref="S4.SS2.p1.13.m10.1.1.2">𝐴</ci><ci id="S4.SS2.p1.13.m10.1.1.3.cmml" xref="S4.SS2.p1.13.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m10.1c">A_{i}</annotation></semantics></math> therefore would degrade model performance. Since <math id="S4.SS2.p1.14.m11.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.14.m11.1a"><mi id="S4.SS2.p1.14.m11.1.1" xref="S4.SS2.p1.14.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m11.1b"><ci id="S4.SS2.p1.14.m11.1.1.cmml" xref="S4.SS2.p1.14.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m11.1c">n</annotation></semantics></math> is typically set to a small value such as <math id="S4.SS2.p1.15.m12.1" class="ltx_Math" alttext="n=2" display="inline"><semantics id="S4.SS2.p1.15.m12.1a"><mrow id="S4.SS2.p1.15.m12.1.1" xref="S4.SS2.p1.15.m12.1.1.cmml"><mi id="S4.SS2.p1.15.m12.1.1.2" xref="S4.SS2.p1.15.m12.1.1.2.cmml">n</mi><mo id="S4.SS2.p1.15.m12.1.1.1" xref="S4.SS2.p1.15.m12.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.15.m12.1.1.3" xref="S4.SS2.p1.15.m12.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m12.1b"><apply id="S4.SS2.p1.15.m12.1.1.cmml" xref="S4.SS2.p1.15.m12.1.1"><eq id="S4.SS2.p1.15.m12.1.1.1.cmml" xref="S4.SS2.p1.15.m12.1.1.1"></eq><ci id="S4.SS2.p1.15.m12.1.1.2.cmml" xref="S4.SS2.p1.15.m12.1.1.2">𝑛</ci><cn type="integer" id="S4.SS2.p1.15.m12.1.1.3.cmml" xref="S4.SS2.p1.15.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m12.1c">n=2</annotation></semantics></math>, Compacter layers therefore usually contain much fewer parameters than adapter layers.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">BitFit</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">BitFit is a simple and intuitive parameter-efficient fine-tuning method where only the bias-terms of the pre-trained model are fine-tuned. This method is comprehensively studied in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and is often used as a baseline method for PEFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">LoRA</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.4" class="ltx_p">Low-Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is a parameter-efficient fine-tuning method designed for transformer-based pre-trained models. LoRA can significantly reduce the number of trainable parameters during fine-tuning by freezing the pre-trained weights and adding trainable rank decomposition matrices into each transformer layer. Let <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="W_{\text{pt}}^{i}\in\mathbb{R}^{b\times a}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><msubsup id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2.2.2" xref="S4.SS4.p1.1.m1.1.1.2.2.2.cmml">W</mi><mtext id="S4.SS4.p1.1.m1.1.1.2.2.3" xref="S4.SS4.p1.1.m1.1.1.2.2.3a.cmml">pt</mtext><mi id="S4.SS4.p1.1.m1.1.1.2.3" xref="S4.SS4.p1.1.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.3.2" xref="S4.SS4.p1.1.m1.1.1.3.3.2.cmml">b</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p1.1.m1.1.1.3.3.1" xref="S4.SS4.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.p1.1.m1.1.1.3.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.3.cmml">a</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><in id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1"></in><apply id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.2.1.cmml" xref="S4.SS4.p1.1.m1.1.1.2">superscript</csymbol><apply id="S4.SS4.p1.1.m1.1.1.2.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.2.2.1.cmml" xref="S4.SS4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.2.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2.2.2">𝑊</ci><ci id="S4.SS4.p1.1.m1.1.1.2.2.3a.cmml" xref="S4.SS4.p1.1.m1.1.1.2.2.3"><mtext mathsize="70%" id="S4.SS4.p1.1.m1.1.1.2.2.3.cmml" xref="S4.SS4.p1.1.m1.1.1.2.2.3">pt</mtext></ci></apply><ci id="S4.SS4.p1.1.m1.1.1.2.3.cmml" xref="S4.SS4.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3"><times id="S4.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3.1"></times><ci id="S4.SS4.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3.2">𝑏</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">W_{\text{pt}}^{i}\in\mathbb{R}^{b\times a}</annotation></semantics></math> be a pre-trained weight matrix of the <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="i^{\text{th}}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><msup id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">i</mi><mtext id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑖</ci><ci id="S4.SS4.p1.2.m2.1.1.3a.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">i^{\text{th}}</annotation></semantics></math> layer, LoRA adds a low-rank term <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="B^{i}A^{i}" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><msup id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2.2" xref="S4.SS4.p1.3.m3.1.1.2.2.cmml">B</mi><mi id="S4.SS4.p1.3.m3.1.1.2.3" xref="S4.SS4.p1.3.m3.1.1.2.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">​</mo><msup id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">A</mi><mi id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml">i</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><times id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></times><apply id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS4.p1.3.m3.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2.2">𝐵</ci><ci id="S4.SS4.p1.3.m3.1.1.2.3.cmml" xref="S4.SS4.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">𝐴</ci><ci id="S4.SS4.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">B^{i}A^{i}</annotation></semantics></math> with rank <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">r</annotation></semantics></math> by:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="W^{i}_{\text{LoRA}}=W_{\text{pt}}^{i}+B^{i}A^{i}," display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.cmml">W</mi><mtext id="S4.E3.m1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.2.3a.cmml">LoRA</mtext><mi id="S4.E3.m1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><msubsup id="S4.E3.m1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.3.2.cmml"><mi id="S4.E3.m1.1.1.1.1.3.2.2.2" xref="S4.E3.m1.1.1.1.1.3.2.2.2.cmml">W</mi><mtext id="S4.E3.m1.1.1.1.1.3.2.2.3" xref="S4.E3.m1.1.1.1.1.3.2.2.3a.cmml">pt</mtext><mi id="S4.E3.m1.1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.1.3.2.3.cmml">i</mi></msubsup><mo id="S4.E3.m1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml"><msup id="S4.E3.m1.1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.2.2" xref="S4.E3.m1.1.1.1.1.3.3.2.2.cmml">B</mi><mi id="S4.E3.m1.1.1.1.1.3.3.2.3" xref="S4.E3.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.3.3.1" xref="S4.E3.m1.1.1.1.1.3.3.1.cmml">​</mo><msup id="S4.E3.m1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.3.2.cmml">A</mi><mi id="S4.E3.m1.1.1.1.1.3.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.3.cmml">i</mi></msup></mrow></mrow></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"></eq><apply id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2">𝑊</ci><ci id="S4.E3.m1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E3.m1.1.1.1.1.2.3a.cmml" xref="S4.E3.m1.1.1.1.1.2.3"><mtext mathsize="70%" id="S4.E3.m1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.3">LoRA</mtext></ci></apply><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><plus id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1"></plus><apply id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2.2.2">𝑊</ci><ci id="S4.E3.m1.1.1.1.1.3.2.2.3a.cmml" xref="S4.E3.m1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S4.E3.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.2.2.3">pt</mtext></ci></apply><ci id="S4.E3.m1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3"><times id="S4.E3.m1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.1"></times><apply id="S4.E3.m1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2.2">𝐵</ci><ci id="S4.E3.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S4.E3.m1.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.2">𝐴</ci><ci id="S4.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">W^{i}_{\text{LoRA}}=W_{\text{pt}}^{i}+B^{i}A^{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p1.11" class="ltx_p">where <math id="S4.SS4.p1.5.m1.1" class="ltx_Math" alttext="B^{i}\in\mathbb{R}^{b\times r}" display="inline"><semantics id="S4.SS4.p1.5.m1.1a"><mrow id="S4.SS4.p1.5.m1.1.1" xref="S4.SS4.p1.5.m1.1.1.cmml"><msup id="S4.SS4.p1.5.m1.1.1.2" xref="S4.SS4.p1.5.m1.1.1.2.cmml"><mi id="S4.SS4.p1.5.m1.1.1.2.2" xref="S4.SS4.p1.5.m1.1.1.2.2.cmml">B</mi><mi id="S4.SS4.p1.5.m1.1.1.2.3" xref="S4.SS4.p1.5.m1.1.1.2.3.cmml">i</mi></msup><mo id="S4.SS4.p1.5.m1.1.1.1" xref="S4.SS4.p1.5.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.p1.5.m1.1.1.3" xref="S4.SS4.p1.5.m1.1.1.3.cmml"><mi id="S4.SS4.p1.5.m1.1.1.3.2" xref="S4.SS4.p1.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.p1.5.m1.1.1.3.3" xref="S4.SS4.p1.5.m1.1.1.3.3.cmml"><mi id="S4.SS4.p1.5.m1.1.1.3.3.2" xref="S4.SS4.p1.5.m1.1.1.3.3.2.cmml">b</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p1.5.m1.1.1.3.3.1" xref="S4.SS4.p1.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.p1.5.m1.1.1.3.3.3" xref="S4.SS4.p1.5.m1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m1.1b"><apply id="S4.SS4.p1.5.m1.1.1.cmml" xref="S4.SS4.p1.5.m1.1.1"><in id="S4.SS4.p1.5.m1.1.1.1.cmml" xref="S4.SS4.p1.5.m1.1.1.1"></in><apply id="S4.SS4.p1.5.m1.1.1.2.cmml" xref="S4.SS4.p1.5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m1.1.1.2.1.cmml" xref="S4.SS4.p1.5.m1.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.5.m1.1.1.2.2.cmml" xref="S4.SS4.p1.5.m1.1.1.2.2">𝐵</ci><ci id="S4.SS4.p1.5.m1.1.1.2.3.cmml" xref="S4.SS4.p1.5.m1.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.5.m1.1.1.3.cmml" xref="S4.SS4.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m1.1.1.3.1.cmml" xref="S4.SS4.p1.5.m1.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.5.m1.1.1.3.2.cmml" xref="S4.SS4.p1.5.m1.1.1.3.2">ℝ</ci><apply id="S4.SS4.p1.5.m1.1.1.3.3.cmml" xref="S4.SS4.p1.5.m1.1.1.3.3"><times id="S4.SS4.p1.5.m1.1.1.3.3.1.cmml" xref="S4.SS4.p1.5.m1.1.1.3.3.1"></times><ci id="S4.SS4.p1.5.m1.1.1.3.3.2.cmml" xref="S4.SS4.p1.5.m1.1.1.3.3.2">𝑏</ci><ci id="S4.SS4.p1.5.m1.1.1.3.3.3.cmml" xref="S4.SS4.p1.5.m1.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m1.1c">B^{i}\in\mathbb{R}^{b\times r}</annotation></semantics></math> is an up-projection and <math id="S4.SS4.p1.6.m2.1" class="ltx_Math" alttext="A^{i}\in\mathbb{R}^{r\times a}" display="inline"><semantics id="S4.SS4.p1.6.m2.1a"><mrow id="S4.SS4.p1.6.m2.1.1" xref="S4.SS4.p1.6.m2.1.1.cmml"><msup id="S4.SS4.p1.6.m2.1.1.2" xref="S4.SS4.p1.6.m2.1.1.2.cmml"><mi id="S4.SS4.p1.6.m2.1.1.2.2" xref="S4.SS4.p1.6.m2.1.1.2.2.cmml">A</mi><mi id="S4.SS4.p1.6.m2.1.1.2.3" xref="S4.SS4.p1.6.m2.1.1.2.3.cmml">i</mi></msup><mo id="S4.SS4.p1.6.m2.1.1.1" xref="S4.SS4.p1.6.m2.1.1.1.cmml">∈</mo><msup id="S4.SS4.p1.6.m2.1.1.3" xref="S4.SS4.p1.6.m2.1.1.3.cmml"><mi id="S4.SS4.p1.6.m2.1.1.3.2" xref="S4.SS4.p1.6.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.p1.6.m2.1.1.3.3" xref="S4.SS4.p1.6.m2.1.1.3.3.cmml"><mi id="S4.SS4.p1.6.m2.1.1.3.3.2" xref="S4.SS4.p1.6.m2.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p1.6.m2.1.1.3.3.1" xref="S4.SS4.p1.6.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.p1.6.m2.1.1.3.3.3" xref="S4.SS4.p1.6.m2.1.1.3.3.3.cmml">a</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m2.1b"><apply id="S4.SS4.p1.6.m2.1.1.cmml" xref="S4.SS4.p1.6.m2.1.1"><in id="S4.SS4.p1.6.m2.1.1.1.cmml" xref="S4.SS4.p1.6.m2.1.1.1"></in><apply id="S4.SS4.p1.6.m2.1.1.2.cmml" xref="S4.SS4.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m2.1.1.2.1.cmml" xref="S4.SS4.p1.6.m2.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.6.m2.1.1.2.2.cmml" xref="S4.SS4.p1.6.m2.1.1.2.2">𝐴</ci><ci id="S4.SS4.p1.6.m2.1.1.2.3.cmml" xref="S4.SS4.p1.6.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.6.m2.1.1.3.cmml" xref="S4.SS4.p1.6.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m2.1.1.3.1.cmml" xref="S4.SS4.p1.6.m2.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.6.m2.1.1.3.2.cmml" xref="S4.SS4.p1.6.m2.1.1.3.2">ℝ</ci><apply id="S4.SS4.p1.6.m2.1.1.3.3.cmml" xref="S4.SS4.p1.6.m2.1.1.3.3"><times id="S4.SS4.p1.6.m2.1.1.3.3.1.cmml" xref="S4.SS4.p1.6.m2.1.1.3.3.1"></times><ci id="S4.SS4.p1.6.m2.1.1.3.3.2.cmml" xref="S4.SS4.p1.6.m2.1.1.3.3.2">𝑟</ci><ci id="S4.SS4.p1.6.m2.1.1.3.3.3.cmml" xref="S4.SS4.p1.6.m2.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m2.1c">A^{i}\in\mathbb{R}^{r\times a}</annotation></semantics></math> is a down-projection. Here, <math id="S4.SS4.p1.7.m3.1" class="ltx_Math" alttext="A^{i}" display="inline"><semantics id="S4.SS4.p1.7.m3.1a"><msup id="S4.SS4.p1.7.m3.1.1" xref="S4.SS4.p1.7.m3.1.1.cmml"><mi id="S4.SS4.p1.7.m3.1.1.2" xref="S4.SS4.p1.7.m3.1.1.2.cmml">A</mi><mi id="S4.SS4.p1.7.m3.1.1.3" xref="S4.SS4.p1.7.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m3.1b"><apply id="S4.SS4.p1.7.m3.1.1.cmml" xref="S4.SS4.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.7.m3.1.1.1.cmml" xref="S4.SS4.p1.7.m3.1.1">superscript</csymbol><ci id="S4.SS4.p1.7.m3.1.1.2.cmml" xref="S4.SS4.p1.7.m3.1.1.2">𝐴</ci><ci id="S4.SS4.p1.7.m3.1.1.3.cmml" xref="S4.SS4.p1.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m3.1c">A^{i}</annotation></semantics></math> and <math id="S4.SS4.p1.8.m4.1" class="ltx_Math" alttext="B^{i}" display="inline"><semantics id="S4.SS4.p1.8.m4.1a"><msup id="S4.SS4.p1.8.m4.1.1" xref="S4.SS4.p1.8.m4.1.1.cmml"><mi id="S4.SS4.p1.8.m4.1.1.2" xref="S4.SS4.p1.8.m4.1.1.2.cmml">B</mi><mi id="S4.SS4.p1.8.m4.1.1.3" xref="S4.SS4.p1.8.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m4.1b"><apply id="S4.SS4.p1.8.m4.1.1.cmml" xref="S4.SS4.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.8.m4.1.1.1.cmml" xref="S4.SS4.p1.8.m4.1.1">superscript</csymbol><ci id="S4.SS4.p1.8.m4.1.1.2.cmml" xref="S4.SS4.p1.8.m4.1.1.2">𝐵</ci><ci id="S4.SS4.p1.8.m4.1.1.3.cmml" xref="S4.SS4.p1.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m4.1c">B^{i}</annotation></semantics></math> are initialised to random Gaussian noise and zero, respectively. <math id="S4.SS4.p1.9.m5.1" class="ltx_Math" alttext="B^{i}A^{i}" display="inline"><semantics id="S4.SS4.p1.9.m5.1a"><mrow id="S4.SS4.p1.9.m5.1.1" xref="S4.SS4.p1.9.m5.1.1.cmml"><msup id="S4.SS4.p1.9.m5.1.1.2" xref="S4.SS4.p1.9.m5.1.1.2.cmml"><mi id="S4.SS4.p1.9.m5.1.1.2.2" xref="S4.SS4.p1.9.m5.1.1.2.2.cmml">B</mi><mi id="S4.SS4.p1.9.m5.1.1.2.3" xref="S4.SS4.p1.9.m5.1.1.2.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS4.p1.9.m5.1.1.1" xref="S4.SS4.p1.9.m5.1.1.1.cmml">​</mo><msup id="S4.SS4.p1.9.m5.1.1.3" xref="S4.SS4.p1.9.m5.1.1.3.cmml"><mi id="S4.SS4.p1.9.m5.1.1.3.2" xref="S4.SS4.p1.9.m5.1.1.3.2.cmml">A</mi><mi id="S4.SS4.p1.9.m5.1.1.3.3" xref="S4.SS4.p1.9.m5.1.1.3.3.cmml">i</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m5.1b"><apply id="S4.SS4.p1.9.m5.1.1.cmml" xref="S4.SS4.p1.9.m5.1.1"><times id="S4.SS4.p1.9.m5.1.1.1.cmml" xref="S4.SS4.p1.9.m5.1.1.1"></times><apply id="S4.SS4.p1.9.m5.1.1.2.cmml" xref="S4.SS4.p1.9.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.9.m5.1.1.2.1.cmml" xref="S4.SS4.p1.9.m5.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.9.m5.1.1.2.2.cmml" xref="S4.SS4.p1.9.m5.1.1.2.2">𝐵</ci><ci id="S4.SS4.p1.9.m5.1.1.2.3.cmml" xref="S4.SS4.p1.9.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.9.m5.1.1.3.cmml" xref="S4.SS4.p1.9.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.9.m5.1.1.3.1.cmml" xref="S4.SS4.p1.9.m5.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.9.m5.1.1.3.2.cmml" xref="S4.SS4.p1.9.m5.1.1.3.2">𝐴</ci><ci id="S4.SS4.p1.9.m5.1.1.3.3.cmml" xref="S4.SS4.p1.9.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m5.1c">B^{i}A^{i}</annotation></semantics></math> is therefore zero at the start of training. The pre-trained weights <math id="S4.SS4.p1.10.m6.1" class="ltx_Math" alttext="W_{\text{pt}}^{i}" display="inline"><semantics id="S4.SS4.p1.10.m6.1a"><msubsup id="S4.SS4.p1.10.m6.1.1" xref="S4.SS4.p1.10.m6.1.1.cmml"><mi id="S4.SS4.p1.10.m6.1.1.2.2" xref="S4.SS4.p1.10.m6.1.1.2.2.cmml">W</mi><mtext id="S4.SS4.p1.10.m6.1.1.2.3" xref="S4.SS4.p1.10.m6.1.1.2.3a.cmml">pt</mtext><mi id="S4.SS4.p1.10.m6.1.1.3" xref="S4.SS4.p1.10.m6.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m6.1b"><apply id="S4.SS4.p1.10.m6.1.1.cmml" xref="S4.SS4.p1.10.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.10.m6.1.1.1.cmml" xref="S4.SS4.p1.10.m6.1.1">superscript</csymbol><apply id="S4.SS4.p1.10.m6.1.1.2.cmml" xref="S4.SS4.p1.10.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.10.m6.1.1.2.1.cmml" xref="S4.SS4.p1.10.m6.1.1">subscript</csymbol><ci id="S4.SS4.p1.10.m6.1.1.2.2.cmml" xref="S4.SS4.p1.10.m6.1.1.2.2">𝑊</ci><ci id="S4.SS4.p1.10.m6.1.1.2.3a.cmml" xref="S4.SS4.p1.10.m6.1.1.2.3"><mtext mathsize="70%" id="S4.SS4.p1.10.m6.1.1.2.3.cmml" xref="S4.SS4.p1.10.m6.1.1.2.3">pt</mtext></ci></apply><ci id="S4.SS4.p1.10.m6.1.1.3.cmml" xref="S4.SS4.p1.10.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m6.1c">W_{\text{pt}}^{i}</annotation></semantics></math> are then frozen and the added term <math id="S4.SS4.p1.11.m7.1" class="ltx_Math" alttext="B^{i}A^{i}" display="inline"><semantics id="S4.SS4.p1.11.m7.1a"><mrow id="S4.SS4.p1.11.m7.1.1" xref="S4.SS4.p1.11.m7.1.1.cmml"><msup id="S4.SS4.p1.11.m7.1.1.2" xref="S4.SS4.p1.11.m7.1.1.2.cmml"><mi id="S4.SS4.p1.11.m7.1.1.2.2" xref="S4.SS4.p1.11.m7.1.1.2.2.cmml">B</mi><mi id="S4.SS4.p1.11.m7.1.1.2.3" xref="S4.SS4.p1.11.m7.1.1.2.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS4.p1.11.m7.1.1.1" xref="S4.SS4.p1.11.m7.1.1.1.cmml">​</mo><msup id="S4.SS4.p1.11.m7.1.1.3" xref="S4.SS4.p1.11.m7.1.1.3.cmml"><mi id="S4.SS4.p1.11.m7.1.1.3.2" xref="S4.SS4.p1.11.m7.1.1.3.2.cmml">A</mi><mi id="S4.SS4.p1.11.m7.1.1.3.3" xref="S4.SS4.p1.11.m7.1.1.3.3.cmml">i</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.11.m7.1b"><apply id="S4.SS4.p1.11.m7.1.1.cmml" xref="S4.SS4.p1.11.m7.1.1"><times id="S4.SS4.p1.11.m7.1.1.1.cmml" xref="S4.SS4.p1.11.m7.1.1.1"></times><apply id="S4.SS4.p1.11.m7.1.1.2.cmml" xref="S4.SS4.p1.11.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.11.m7.1.1.2.1.cmml" xref="S4.SS4.p1.11.m7.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.11.m7.1.1.2.2.cmml" xref="S4.SS4.p1.11.m7.1.1.2.2">𝐵</ci><ci id="S4.SS4.p1.11.m7.1.1.2.3.cmml" xref="S4.SS4.p1.11.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS4.p1.11.m7.1.1.3.cmml" xref="S4.SS4.p1.11.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.11.m7.1.1.3.1.cmml" xref="S4.SS4.p1.11.m7.1.1.3">superscript</csymbol><ci id="S4.SS4.p1.11.m7.1.1.3.2.cmml" xref="S4.SS4.p1.11.m7.1.1.3.2">𝐴</ci><ci id="S4.SS4.p1.11.m7.1.1.3.3.cmml" xref="S4.SS4.p1.11.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.11.m7.1c">B^{i}A^{i}</annotation></semantics></math> becomes the new trainable parameters.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">LoRA has demonstrated superior performance in DP-FL both in central <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> settings when compared to other parameter-efficient fine-tuning methods such as adapter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and reparametrised gradient perturbation (RGP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">DyLoRA</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.4" class="ltx_p">A recent work of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> introduces a dynamic low-rank adaptation (DyLoRA), a method which aims to address two problems of the original LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, namely, the rank of the LoRA layers are fixed after training and find an optimal rank requires an exhaustive search. This is done by training LoRA modules for a range of ranks <math id="S4.SS5.p1.1.m1.2" class="ltx_Math" alttext="r\in[r_{min},r_{max}]" display="inline"><semantics id="S4.SS5.p1.1.m1.2a"><mrow id="S4.SS5.p1.1.m1.2.2" xref="S4.SS5.p1.1.m1.2.2.cmml"><mi id="S4.SS5.p1.1.m1.2.2.4" xref="S4.SS5.p1.1.m1.2.2.4.cmml">r</mi><mo id="S4.SS5.p1.1.m1.2.2.3" xref="S4.SS5.p1.1.m1.2.2.3.cmml">∈</mo><mrow id="S4.SS5.p1.1.m1.2.2.2.2" xref="S4.SS5.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p1.1.m1.2.2.2.2.3" xref="S4.SS5.p1.1.m1.2.2.2.3.cmml">[</mo><msub id="S4.SS5.p1.1.m1.1.1.1.1.1" xref="S4.SS5.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS5.p1.1.m1.1.1.1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.1.1.1.2.cmml">r</mi><mrow id="S4.SS5.p1.1.m1.1.1.1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS5.p1.1.m1.1.1.1.1.1.3.2" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.1.m1.1.1.1.1.1.3.1" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p1.1.m1.1.1.1.1.1.3.3" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.1.m1.1.1.1.1.1.3.1a" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p1.1.m1.1.1.1.1.1.3.4" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS5.p1.1.m1.2.2.2.2.4" xref="S4.SS5.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS5.p1.1.m1.2.2.2.2.2" xref="S4.SS5.p1.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS5.p1.1.m1.2.2.2.2.2.2" xref="S4.SS5.p1.1.m1.2.2.2.2.2.2.cmml">r</mi><mrow id="S4.SS5.p1.1.m1.2.2.2.2.2.3" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.cmml"><mi id="S4.SS5.p1.1.m1.2.2.2.2.2.3.2" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.1.m1.2.2.2.2.2.3.1" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p1.1.m1.2.2.2.2.2.3.3" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.1.m1.2.2.2.2.2.3.1a" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p1.1.m1.2.2.2.2.2.3.4" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.4.cmml">x</mi></mrow></msub><mo stretchy="false" id="S4.SS5.p1.1.m1.2.2.2.2.5" xref="S4.SS5.p1.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.2b"><apply id="S4.SS5.p1.1.m1.2.2.cmml" xref="S4.SS5.p1.1.m1.2.2"><in id="S4.SS5.p1.1.m1.2.2.3.cmml" xref="S4.SS5.p1.1.m1.2.2.3"></in><ci id="S4.SS5.p1.1.m1.2.2.4.cmml" xref="S4.SS5.p1.1.m1.2.2.4">𝑟</ci><interval closure="closed" id="S4.SS5.p1.1.m1.2.2.2.3.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2"><apply id="S4.SS5.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.2">𝑟</ci><apply id="S4.SS5.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3"><times id="S4.SS5.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.1"></times><ci id="S4.SS5.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.SS5.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.3">𝑖</ci><ci id="S4.SS5.p1.1.m1.1.1.1.1.1.3.4.cmml" xref="S4.SS5.p1.1.m1.1.1.1.1.1.3.4">𝑛</ci></apply></apply><apply id="S4.SS5.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS5.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.2">𝑟</ci><apply id="S4.SS5.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3"><times id="S4.SS5.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.1"></times><ci id="S4.SS5.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.2">𝑚</ci><ci id="S4.SS5.p1.1.m1.2.2.2.2.2.3.3.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="S4.SS5.p1.1.m1.2.2.2.2.2.3.4.cmml" xref="S4.SS5.p1.1.m1.2.2.2.2.2.3.4">𝑥</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.2c">r\in[r_{min},r_{max}]</annotation></semantics></math> instead of a single rank. To achieve this, DyLoRA samples <math id="S4.SS5.p1.2.m2.1" class="ltx_math_unparsed" alttext="b\sim p_{B}(.),b\in\{r_{min},r_{min}+1,...,r_{max}\}" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mrow id="S4.SS5.p1.2.m2.1b"><mi id="S4.SS5.p1.2.m2.1.1">b</mi><mo id="S4.SS5.p1.2.m2.1.2">∼</mo><msub id="S4.SS5.p1.2.m2.1.3"><mi id="S4.SS5.p1.2.m2.1.3.2">p</mi><mi id="S4.SS5.p1.2.m2.1.3.3">B</mi></msub><mrow id="S4.SS5.p1.2.m2.1.4"><mo stretchy="false" id="S4.SS5.p1.2.m2.1.4.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS5.p1.2.m2.1.4.2">.</mo><mo stretchy="false" id="S4.SS5.p1.2.m2.1.4.3">)</mo></mrow><mo id="S4.SS5.p1.2.m2.1.5">,</mo><mi id="S4.SS5.p1.2.m2.1.6">b</mi><mo id="S4.SS5.p1.2.m2.1.7">∈</mo><mrow id="S4.SS5.p1.2.m2.1.8"><mo stretchy="false" id="S4.SS5.p1.2.m2.1.8.1">{</mo><msub id="S4.SS5.p1.2.m2.1.8.2"><mi id="S4.SS5.p1.2.m2.1.8.2.2">r</mi><mrow id="S4.SS5.p1.2.m2.1.8.2.3"><mi id="S4.SS5.p1.2.m2.1.8.2.3.2">m</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.2.3.1">​</mo><mi id="S4.SS5.p1.2.m2.1.8.2.3.3">i</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.2.3.1a">​</mo><mi id="S4.SS5.p1.2.m2.1.8.2.3.4">n</mi></mrow></msub><mo id="S4.SS5.p1.2.m2.1.8.3">,</mo><msub id="S4.SS5.p1.2.m2.1.8.4"><mi id="S4.SS5.p1.2.m2.1.8.4.2">r</mi><mrow id="S4.SS5.p1.2.m2.1.8.4.3"><mi id="S4.SS5.p1.2.m2.1.8.4.3.2">m</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.4.3.1">​</mo><mi id="S4.SS5.p1.2.m2.1.8.4.3.3">i</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.4.3.1a">​</mo><mi id="S4.SS5.p1.2.m2.1.8.4.3.4">n</mi></mrow></msub><mo id="S4.SS5.p1.2.m2.1.8.5">+</mo><mn id="S4.SS5.p1.2.m2.1.8.6">1</mn><mo id="S4.SS5.p1.2.m2.1.8.7">,</mo><mi mathvariant="normal" id="S4.SS5.p1.2.m2.1.8.8">…</mi><mo id="S4.SS5.p1.2.m2.1.8.9">,</mo><msub id="S4.SS5.p1.2.m2.1.8.10"><mi id="S4.SS5.p1.2.m2.1.8.10.2">r</mi><mrow id="S4.SS5.p1.2.m2.1.8.10.3"><mi id="S4.SS5.p1.2.m2.1.8.10.3.2">m</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.10.3.1">​</mo><mi id="S4.SS5.p1.2.m2.1.8.10.3.3">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m2.1.8.10.3.1a">​</mo><mi id="S4.SS5.p1.2.m2.1.8.10.3.4">x</mi></mrow></msub><mo stretchy="false" id="S4.SS5.p1.2.m2.1.8.11">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">b\sim p_{B}(.),b\in\{r_{min},r_{min}+1,...,r_{max}\}</annotation></semantics></math> at each training step and truncates up-projection <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mi id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><ci id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">B</annotation></semantics></math> and down-projection <math id="S4.SS5.p1.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS5.p1.4.m4.1a"><mi id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><ci id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">A</annotation></semantics></math> such that:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.23" class="ltx_math_unparsed" alttext="\begin{split}B_{b}&amp;=B[:,1:b]\\
A_{b}&amp;=A[1:b,:],\end{split}" display="block"><semantics id="S4.E4.m1.23a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E4.m1.23.23"><mtr id="S4.E4.m1.23.23a"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.23.23b"><msub id="S4.E4.m1.2.2.2.2.2"><mi id="S4.E4.m1.1.1.1.1.1.1">B</mi><mi id="S4.E4.m1.2.2.2.2.2.2.1">b</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.23.23c"><mrow id="S4.E4.m1.11.11.11.11.9"><mo id="S4.E4.m1.3.3.3.3.1.1">=</mo><mi id="S4.E4.m1.4.4.4.4.2.2">B</mi><mrow id="S4.E4.m1.11.11.11.11.9.10"><mo stretchy="false" id="S4.E4.m1.5.5.5.5.3.3">[</mo><mo rspace="0em" id="S4.E4.m1.6.6.6.6.4.4">:</mo><mo id="S4.E4.m1.7.7.7.7.5.5">,</mo><mn id="S4.E4.m1.8.8.8.8.6.6">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m1.9.9.9.9.7.7">:</mo><mi id="S4.E4.m1.10.10.10.10.8.8">b</mi><mo stretchy="false" id="S4.E4.m1.11.11.11.11.9.9">]</mo></mrow></mrow></mtd></mtr><mtr id="S4.E4.m1.23.23d"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.23.23e"><msub id="S4.E4.m1.13.13.13.2.2"><mi id="S4.E4.m1.12.12.12.1.1.1">A</mi><mi id="S4.E4.m1.13.13.13.2.2.2.1">b</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.23.23f"><mrow id="S4.E4.m1.23.23.23.12.10"><mo id="S4.E4.m1.14.14.14.3.1.1">=</mo><mi id="S4.E4.m1.15.15.15.4.2.2">A</mi><mrow id="S4.E4.m1.23.23.23.12.10.11"><mo stretchy="false" id="S4.E4.m1.16.16.16.5.3.3">[</mo><mn id="S4.E4.m1.17.17.17.6.4.4">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m1.18.18.18.7.5.5">:</mo><mi id="S4.E4.m1.19.19.19.8.6.6">b</mi><mo id="S4.E4.m1.20.20.20.9.7.7">,</mo><mo rspace="0em" id="S4.E4.m1.21.21.21.10.8.8">:</mo><mo stretchy="false" id="S4.E4.m1.22.22.22.11.9.9">]</mo></mrow><mo id="S4.E4.m1.23.23.23.12.10.10">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E4.m1.23b">\begin{split}B_{b}&amp;=B[:,1:b]\\
A_{b}&amp;=A[1:b,:],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS5.p1.6" class="ltx_p">where <math id="S4.SS5.p1.5.m1.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S4.SS5.p1.5.m1.1a"><msub id="S4.SS5.p1.5.m1.1.1" xref="S4.SS5.p1.5.m1.1.1.cmml"><mi id="S4.SS5.p1.5.m1.1.1.2" xref="S4.SS5.p1.5.m1.1.1.2.cmml">B</mi><mi id="S4.SS5.p1.5.m1.1.1.3" xref="S4.SS5.p1.5.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m1.1b"><apply id="S4.SS5.p1.5.m1.1.1.cmml" xref="S4.SS5.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.5.m1.1.1.1.cmml" xref="S4.SS5.p1.5.m1.1.1">subscript</csymbol><ci id="S4.SS5.p1.5.m1.1.1.2.cmml" xref="S4.SS5.p1.5.m1.1.1.2">𝐵</ci><ci id="S4.SS5.p1.5.m1.1.1.3.cmml" xref="S4.SS5.p1.5.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m1.1c">B_{b}</annotation></semantics></math> is the b-truncated up-projection and <math id="S4.SS5.p1.6.m2.1" class="ltx_Math" alttext="A_{b}" display="inline"><semantics id="S4.SS5.p1.6.m2.1a"><msub id="S4.SS5.p1.6.m2.1.1" xref="S4.SS5.p1.6.m2.1.1.cmml"><mi id="S4.SS5.p1.6.m2.1.1.2" xref="S4.SS5.p1.6.m2.1.1.2.cmml">A</mi><mi id="S4.SS5.p1.6.m2.1.1.3" xref="S4.SS5.p1.6.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.6.m2.1b"><apply id="S4.SS5.p1.6.m2.1.1.cmml" xref="S4.SS5.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.6.m2.1.1.1.cmml" xref="S4.SS5.p1.6.m2.1.1">subscript</csymbol><ci id="S4.SS5.p1.6.m2.1.1.2.cmml" xref="S4.SS5.p1.6.m2.1.1.2">𝐴</ci><ci id="S4.SS5.p1.6.m2.1.1.3.cmml" xref="S4.SS5.p1.6.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.6.m2.1c">A_{b}</annotation></semantics></math> is the b-truncated down-projection.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS6.5.1.1" class="ltx_text">IV-F</span> </span><span id="S4.SS6.6.2" class="ltx_text ltx_font_italic">DP-DyLoRA</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">Here, we propose to apply DyLoRA in a federated setting with differential privacy (DP).
This runs up against a problem: the choice of rank <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">b</annotation></semantics></math> would naturally be made per client, but this would not work with DP.
If different clients were to send up different-length vectors, this would immediate break DP.
If instead clients padded the statistics they sent up with zeros, this would decrease the signal-to-noise-ratio on the highest ranks significantly.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.8" class="ltx_p">Instead, we propose that the server draws one <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="b^{t}" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><msup id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml"><mi id="S4.SS6.p2.1.m1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.2.cmml">b</mi><mi id="S4.SS6.p2.1.m1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><apply id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.1.m1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS6.p2.1.m1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.2">𝑏</ci><ci id="S4.SS6.p2.1.m1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">b^{t}</annotation></semantics></math> per round <math id="S4.SS6.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS6.p2.2.m2.1a"><mi id="S4.SS6.p2.2.m2.1.1" xref="S4.SS6.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.2.m2.1b"><ci id="S4.SS6.p2.2.m2.1.1.cmml" xref="S4.SS6.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.2.m2.1c">t</annotation></semantics></math> for the whole cohort, and all devices train <math id="S4.SS6.p2.3.m3.1" class="ltx_Math" alttext="B_{b^{t}}" display="inline"><semantics id="S4.SS6.p2.3.m3.1a"><msub id="S4.SS6.p2.3.m3.1.1" xref="S4.SS6.p2.3.m3.1.1.cmml"><mi id="S4.SS6.p2.3.m3.1.1.2" xref="S4.SS6.p2.3.m3.1.1.2.cmml">B</mi><msup id="S4.SS6.p2.3.m3.1.1.3" xref="S4.SS6.p2.3.m3.1.1.3.cmml"><mi id="S4.SS6.p2.3.m3.1.1.3.2" xref="S4.SS6.p2.3.m3.1.1.3.2.cmml">b</mi><mi id="S4.SS6.p2.3.m3.1.1.3.3" xref="S4.SS6.p2.3.m3.1.1.3.3.cmml">t</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.3.m3.1b"><apply id="S4.SS6.p2.3.m3.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.3.m3.1.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p2.3.m3.1.1.2.cmml" xref="S4.SS6.p2.3.m3.1.1.2">𝐵</ci><apply id="S4.SS6.p2.3.m3.1.1.3.cmml" xref="S4.SS6.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p2.3.m3.1.1.3.1.cmml" xref="S4.SS6.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS6.p2.3.m3.1.1.3.2.cmml" xref="S4.SS6.p2.3.m3.1.1.3.2">𝑏</ci><ci id="S4.SS6.p2.3.m3.1.1.3.3.cmml" xref="S4.SS6.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.3.m3.1c">B_{b^{t}}</annotation></semantics></math> and <math id="S4.SS6.p2.4.m4.1" class="ltx_Math" alttext="A_{b^{t}}" display="inline"><semantics id="S4.SS6.p2.4.m4.1a"><msub id="S4.SS6.p2.4.m4.1.1" xref="S4.SS6.p2.4.m4.1.1.cmml"><mi id="S4.SS6.p2.4.m4.1.1.2" xref="S4.SS6.p2.4.m4.1.1.2.cmml">A</mi><msup id="S4.SS6.p2.4.m4.1.1.3" xref="S4.SS6.p2.4.m4.1.1.3.cmml"><mi id="S4.SS6.p2.4.m4.1.1.3.2" xref="S4.SS6.p2.4.m4.1.1.3.2.cmml">b</mi><mi id="S4.SS6.p2.4.m4.1.1.3.3" xref="S4.SS6.p2.4.m4.1.1.3.3.cmml">t</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.4.m4.1b"><apply id="S4.SS6.p2.4.m4.1.1.cmml" xref="S4.SS6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.4.m4.1.1.1.cmml" xref="S4.SS6.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS6.p2.4.m4.1.1.2.cmml" xref="S4.SS6.p2.4.m4.1.1.2">𝐴</ci><apply id="S4.SS6.p2.4.m4.1.1.3.cmml" xref="S4.SS6.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p2.4.m4.1.1.3.1.cmml" xref="S4.SS6.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS6.p2.4.m4.1.1.3.2.cmml" xref="S4.SS6.p2.4.m4.1.1.3.2">𝑏</ci><ci id="S4.SS6.p2.4.m4.1.1.3.3.cmml" xref="S4.SS6.p2.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.4.m4.1c">A_{b^{t}}</annotation></semantics></math> as in (<a href="#S4.E4" title="In IV-E DyLoRA ‣ IV Parameter-Efficient Fine-tuning with Differential Privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
We do not consider the secondary truncation mode described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> where only the <math id="S4.SS6.p2.5.m5.1" class="ltx_Math" alttext="b^{\text{th}}" display="inline"><semantics id="S4.SS6.p2.5.m5.1a"><msup id="S4.SS6.p2.5.m5.1.1" xref="S4.SS6.p2.5.m5.1.1.cmml"><mi id="S4.SS6.p2.5.m5.1.1.2" xref="S4.SS6.p2.5.m5.1.1.2.cmml">b</mi><mtext id="S4.SS6.p2.5.m5.1.1.3" xref="S4.SS6.p2.5.m5.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.5.m5.1b"><apply id="S4.SS6.p2.5.m5.1.1.cmml" xref="S4.SS6.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.5.m5.1.1.1.cmml" xref="S4.SS6.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS6.p2.5.m5.1.1.2.cmml" xref="S4.SS6.p2.5.m5.1.1.2">𝑏</ci><ci id="S4.SS6.p2.5.m5.1.1.3a.cmml" xref="S4.SS6.p2.5.m5.1.1.3"><mtext mathsize="70%" id="S4.SS6.p2.5.m5.1.1.3.cmml" xref="S4.SS6.p2.5.m5.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.5.m5.1c">b^{\text{th}}</annotation></semantics></math> rows and columns are updated since it is known to cause noticeable performance drop.
Note that the expectation of the change in parameters <math id="S4.SS6.p2.6.m6.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS6.p2.6.m6.1a"><mi id="S4.SS6.p2.6.m6.1.1" xref="S4.SS6.p2.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.6.m6.1b"><ci id="S4.SS6.p2.6.m6.1.1.cmml" xref="S4.SS6.p2.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.6.m6.1c">B</annotation></semantics></math> and <math id="S4.SS6.p2.7.m7.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS6.p2.7.m7.1a"><mi id="S4.SS6.p2.7.m7.1.1" xref="S4.SS6.p2.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.7.m7.1b"><ci id="S4.SS6.p2.7.m7.1.1.cmml" xref="S4.SS6.p2.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.7.m7.1c">A</annotation></semantics></math> in one round is the same whether rank <math id="S4.SS6.p2.8.m8.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS6.p2.8.m8.1a"><mi id="S4.SS6.p2.8.m8.1.1" xref="S4.SS6.p2.8.m8.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.8.m8.1b"><ci id="S4.SS6.p2.8.m8.1.1.cmml" xref="S4.SS6.p2.8.m8.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.8.m8.1c">b</annotation></semantics></math> is sampled separately on each client or once on the server.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para">
<p id="S4.SS6.p3.2" class="ltx_p">The complete DP-DyLoRA algorithm we propose is in Algorithm <a href="#alg2" title="Algorithm 2 ‣ IV-F DP-DyLoRA ‣ IV Parameter-Efficient Fine-tuning with Differential Privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Similar to standard DP-FL algorithms such as DP-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, DP-DyLoRA samples a portion of users at the start of each communication round before sending the latest global model to sampled users from the central server. Next, the sampled users train the model, here <math id="S4.SS6.p3.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS6.p3.1.m1.1a"><mi id="S4.SS6.p3.1.m1.1.1" xref="S4.SS6.p3.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p3.1.m1.1b"><ci id="S4.SS6.p3.1.m1.1.1.cmml" xref="S4.SS6.p3.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p3.1.m1.1c">B</annotation></semantics></math>s and <math id="S4.SS6.p3.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS6.p3.2.m2.1a"><mi id="S4.SS6.p3.2.m2.1.1" xref="S4.SS6.p3.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p3.2.m2.1b"><ci id="S4.SS6.p3.2.m2.1.1.cmml" xref="S4.SS6.p3.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p3.2.m2.1c">A</annotation></semantics></math>s, on their local data and clip the model updates to a predefined threshold before sending the clipped model updates back to the server. The clipped updates are then aggregated, noised and applied to the global model.</p>
</div>
<div id="S4.SS6.p4" class="ltx_para">
<p id="S4.SS6.p4.12" class="ltx_p">DP-DyLoRA freezes all pre-trained weights and adds new trainable LoRA modules to the model and to make fine-tuning large pre-trained models more parameter-efficient.
At client side, users train on their local data with a modified forward pass:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="h=W_{\text{pt}}x+\Delta Wx=W_{\text{pt}}x+B_{b}A_{b}x." display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">h</mi><mo id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml"><mrow id="S4.E5.m1.1.1.1.1.4.2" xref="S4.E5.m1.1.1.1.1.4.2.cmml"><msub id="S4.E5.m1.1.1.1.1.4.2.2" xref="S4.E5.m1.1.1.1.1.4.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.4.2.2.2" xref="S4.E5.m1.1.1.1.1.4.2.2.2.cmml">W</mi><mtext id="S4.E5.m1.1.1.1.1.4.2.2.3" xref="S4.E5.m1.1.1.1.1.4.2.2.3a.cmml">pt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.2.1" xref="S4.E5.m1.1.1.1.1.4.2.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.2.3" xref="S4.E5.m1.1.1.1.1.4.2.3.cmml">x</mi></mrow><mo id="S4.E5.m1.1.1.1.1.4.1" xref="S4.E5.m1.1.1.1.1.4.1.cmml">+</mo><mrow id="S4.E5.m1.1.1.1.1.4.3" xref="S4.E5.m1.1.1.1.1.4.3.cmml"><mi mathvariant="normal" id="S4.E5.m1.1.1.1.1.4.3.2" xref="S4.E5.m1.1.1.1.1.4.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.3.1" xref="S4.E5.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.3.3" xref="S4.E5.m1.1.1.1.1.4.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.3.1a" xref="S4.E5.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.3.4" xref="S4.E5.m1.1.1.1.1.4.3.4.cmml">x</mi></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.5" xref="S4.E5.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.6" xref="S4.E5.m1.1.1.1.1.6.cmml"><mrow id="S4.E5.m1.1.1.1.1.6.2" xref="S4.E5.m1.1.1.1.1.6.2.cmml"><msub id="S4.E5.m1.1.1.1.1.6.2.2" xref="S4.E5.m1.1.1.1.1.6.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.6.2.2.2" xref="S4.E5.m1.1.1.1.1.6.2.2.2.cmml">W</mi><mtext id="S4.E5.m1.1.1.1.1.6.2.2.3" xref="S4.E5.m1.1.1.1.1.6.2.2.3a.cmml">pt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.6.2.1" xref="S4.E5.m1.1.1.1.1.6.2.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.6.2.3" xref="S4.E5.m1.1.1.1.1.6.2.3.cmml">x</mi></mrow><mo id="S4.E5.m1.1.1.1.1.6.1" xref="S4.E5.m1.1.1.1.1.6.1.cmml">+</mo><mrow id="S4.E5.m1.1.1.1.1.6.3" xref="S4.E5.m1.1.1.1.1.6.3.cmml"><msub id="S4.E5.m1.1.1.1.1.6.3.2" xref="S4.E5.m1.1.1.1.1.6.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.6.3.2.2" xref="S4.E5.m1.1.1.1.1.6.3.2.2.cmml">B</mi><mi id="S4.E5.m1.1.1.1.1.6.3.2.3" xref="S4.E5.m1.1.1.1.1.6.3.2.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.6.3.1" xref="S4.E5.m1.1.1.1.1.6.3.1.cmml">​</mo><msub id="S4.E5.m1.1.1.1.1.6.3.3" xref="S4.E5.m1.1.1.1.1.6.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.6.3.3.2" xref="S4.E5.m1.1.1.1.1.6.3.3.2.cmml">A</mi><mi id="S4.E5.m1.1.1.1.1.6.3.3.3" xref="S4.E5.m1.1.1.1.1.6.3.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.6.3.1a" xref="S4.E5.m1.1.1.1.1.6.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.6.3.4" xref="S4.E5.m1.1.1.1.1.6.3.4.cmml">x</mi></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><and id="S4.E5.m1.1.1.1.1a.cmml" xref="S4.E5.m1.1.1.1"></and><apply id="S4.E5.m1.1.1.1.1b.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"></eq><ci id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2">ℎ</ci><apply id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4"><plus id="S4.E5.m1.1.1.1.1.4.1.cmml" xref="S4.E5.m1.1.1.1.1.4.1"></plus><apply id="S4.E5.m1.1.1.1.1.4.2.cmml" xref="S4.E5.m1.1.1.1.1.4.2"><times id="S4.E5.m1.1.1.1.1.4.2.1.cmml" xref="S4.E5.m1.1.1.1.1.4.2.1"></times><apply id="S4.E5.m1.1.1.1.1.4.2.2.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.4.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.4.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2.2">𝑊</ci><ci id="S4.E5.m1.1.1.1.1.4.2.2.3a.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2.3"><mtext mathsize="70%" id="S4.E5.m1.1.1.1.1.4.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2.3">pt</mtext></ci></apply><ci id="S4.E5.m1.1.1.1.1.4.2.3.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3">𝑥</ci></apply><apply id="S4.E5.m1.1.1.1.1.4.3.cmml" xref="S4.E5.m1.1.1.1.1.4.3"><times id="S4.E5.m1.1.1.1.1.4.3.1.cmml" xref="S4.E5.m1.1.1.1.1.4.3.1"></times><ci id="S4.E5.m1.1.1.1.1.4.3.2.cmml" xref="S4.E5.m1.1.1.1.1.4.3.2">Δ</ci><ci id="S4.E5.m1.1.1.1.1.4.3.3.cmml" xref="S4.E5.m1.1.1.1.1.4.3.3">𝑊</ci><ci id="S4.E5.m1.1.1.1.1.4.3.4.cmml" xref="S4.E5.m1.1.1.1.1.4.3.4">𝑥</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1c.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.5.cmml" xref="S4.E5.m1.1.1.1.1.5"></eq><share href="#S4.E5.m1.1.1.1.1.4.cmml" id="S4.E5.m1.1.1.1.1d.cmml" xref="S4.E5.m1.1.1.1"></share><apply id="S4.E5.m1.1.1.1.1.6.cmml" xref="S4.E5.m1.1.1.1.1.6"><plus id="S4.E5.m1.1.1.1.1.6.1.cmml" xref="S4.E5.m1.1.1.1.1.6.1"></plus><apply id="S4.E5.m1.1.1.1.1.6.2.cmml" xref="S4.E5.m1.1.1.1.1.6.2"><times id="S4.E5.m1.1.1.1.1.6.2.1.cmml" xref="S4.E5.m1.1.1.1.1.6.2.1"></times><apply id="S4.E5.m1.1.1.1.1.6.2.2.cmml" xref="S4.E5.m1.1.1.1.1.6.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.6.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.6.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.6.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.6.2.2.2">𝑊</ci><ci id="S4.E5.m1.1.1.1.1.6.2.2.3a.cmml" xref="S4.E5.m1.1.1.1.1.6.2.2.3"><mtext mathsize="70%" id="S4.E5.m1.1.1.1.1.6.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.6.2.2.3">pt</mtext></ci></apply><ci id="S4.E5.m1.1.1.1.1.6.2.3.cmml" xref="S4.E5.m1.1.1.1.1.6.2.3">𝑥</ci></apply><apply id="S4.E5.m1.1.1.1.1.6.3.cmml" xref="S4.E5.m1.1.1.1.1.6.3"><times id="S4.E5.m1.1.1.1.1.6.3.1.cmml" xref="S4.E5.m1.1.1.1.1.6.3.1"></times><apply id="S4.E5.m1.1.1.1.1.6.3.2.cmml" xref="S4.E5.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.6.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.6.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.6.3.2.2">𝐵</ci><ci id="S4.E5.m1.1.1.1.1.6.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.6.3.2.3">𝑏</ci></apply><apply id="S4.E5.m1.1.1.1.1.6.3.3.cmml" xref="S4.E5.m1.1.1.1.1.6.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.6.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.6.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.6.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.6.3.3.2">𝐴</ci><ci id="S4.E5.m1.1.1.1.1.6.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.6.3.3.3">𝑏</ci></apply><ci id="S4.E5.m1.1.1.1.1.6.3.4.cmml" xref="S4.E5.m1.1.1.1.1.6.3.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">h=W_{\text{pt}}x+\Delta Wx=W_{\text{pt}}x+B_{b}A_{b}x.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS6.p4.11" class="ltx_p">Here, <math id="S4.SS6.p4.1.m1.1" class="ltx_Math" alttext="W_{\text{pt}}" display="inline"><semantics id="S4.SS6.p4.1.m1.1a"><msub id="S4.SS6.p4.1.m1.1.1" xref="S4.SS6.p4.1.m1.1.1.cmml"><mi id="S4.SS6.p4.1.m1.1.1.2" xref="S4.SS6.p4.1.m1.1.1.2.cmml">W</mi><mtext id="S4.SS6.p4.1.m1.1.1.3" xref="S4.SS6.p4.1.m1.1.1.3a.cmml">pt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.1.m1.1b"><apply id="S4.SS6.p4.1.m1.1.1.cmml" xref="S4.SS6.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.1.m1.1.1.1.cmml" xref="S4.SS6.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p4.1.m1.1.1.2.cmml" xref="S4.SS6.p4.1.m1.1.1.2">𝑊</ci><ci id="S4.SS6.p4.1.m1.1.1.3a.cmml" xref="S4.SS6.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS6.p4.1.m1.1.1.3.cmml" xref="S4.SS6.p4.1.m1.1.1.3">pt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.1.m1.1c">W_{\text{pt}}</annotation></semantics></math> is frozen and only <math id="S4.SS6.p4.2.m2.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S4.SS6.p4.2.m2.1a"><msub id="S4.SS6.p4.2.m2.1.1" xref="S4.SS6.p4.2.m2.1.1.cmml"><mi id="S4.SS6.p4.2.m2.1.1.2" xref="S4.SS6.p4.2.m2.1.1.2.cmml">B</mi><mi id="S4.SS6.p4.2.m2.1.1.3" xref="S4.SS6.p4.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.2.m2.1b"><apply id="S4.SS6.p4.2.m2.1.1.cmml" xref="S4.SS6.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.2.m2.1.1.1.cmml" xref="S4.SS6.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p4.2.m2.1.1.2.cmml" xref="S4.SS6.p4.2.m2.1.1.2">𝐵</ci><ci id="S4.SS6.p4.2.m2.1.1.3.cmml" xref="S4.SS6.p4.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.2.m2.1c">B_{b}</annotation></semantics></math> and <math id="S4.SS6.p4.3.m3.1" class="ltx_Math" alttext="A_{b}" display="inline"><semantics id="S4.SS6.p4.3.m3.1a"><msub id="S4.SS6.p4.3.m3.1.1" xref="S4.SS6.p4.3.m3.1.1.cmml"><mi id="S4.SS6.p4.3.m3.1.1.2" xref="S4.SS6.p4.3.m3.1.1.2.cmml">A</mi><mi id="S4.SS6.p4.3.m3.1.1.3" xref="S4.SS6.p4.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.3.m3.1b"><apply id="S4.SS6.p4.3.m3.1.1.cmml" xref="S4.SS6.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.3.m3.1.1.1.cmml" xref="S4.SS6.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p4.3.m3.1.1.2.cmml" xref="S4.SS6.p4.3.m3.1.1.2">𝐴</ci><ci id="S4.SS6.p4.3.m3.1.1.3.cmml" xref="S4.SS6.p4.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.3.m3.1c">A_{b}</annotation></semantics></math> are trainable. The outputs of <math id="S4.SS6.p4.4.m4.1" class="ltx_Math" alttext="W_{\text{pt}}x" display="inline"><semantics id="S4.SS6.p4.4.m4.1a"><mrow id="S4.SS6.p4.4.m4.1.1" xref="S4.SS6.p4.4.m4.1.1.cmml"><msub id="S4.SS6.p4.4.m4.1.1.2" xref="S4.SS6.p4.4.m4.1.1.2.cmml"><mi id="S4.SS6.p4.4.m4.1.1.2.2" xref="S4.SS6.p4.4.m4.1.1.2.2.cmml">W</mi><mtext id="S4.SS6.p4.4.m4.1.1.2.3" xref="S4.SS6.p4.4.m4.1.1.2.3a.cmml">pt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS6.p4.4.m4.1.1.1" xref="S4.SS6.p4.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS6.p4.4.m4.1.1.3" xref="S4.SS6.p4.4.m4.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.4.m4.1b"><apply id="S4.SS6.p4.4.m4.1.1.cmml" xref="S4.SS6.p4.4.m4.1.1"><times id="S4.SS6.p4.4.m4.1.1.1.cmml" xref="S4.SS6.p4.4.m4.1.1.1"></times><apply id="S4.SS6.p4.4.m4.1.1.2.cmml" xref="S4.SS6.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p4.4.m4.1.1.2.1.cmml" xref="S4.SS6.p4.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS6.p4.4.m4.1.1.2.2.cmml" xref="S4.SS6.p4.4.m4.1.1.2.2">𝑊</ci><ci id="S4.SS6.p4.4.m4.1.1.2.3a.cmml" xref="S4.SS6.p4.4.m4.1.1.2.3"><mtext mathsize="70%" id="S4.SS6.p4.4.m4.1.1.2.3.cmml" xref="S4.SS6.p4.4.m4.1.1.2.3">pt</mtext></ci></apply><ci id="S4.SS6.p4.4.m4.1.1.3.cmml" xref="S4.SS6.p4.4.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.4.m4.1c">W_{\text{pt}}x</annotation></semantics></math> and <math id="S4.SS6.p4.5.m5.1" class="ltx_Math" alttext="B_{b}A_{b}x" display="inline"><semantics id="S4.SS6.p4.5.m5.1a"><mrow id="S4.SS6.p4.5.m5.1.1" xref="S4.SS6.p4.5.m5.1.1.cmml"><msub id="S4.SS6.p4.5.m5.1.1.2" xref="S4.SS6.p4.5.m5.1.1.2.cmml"><mi id="S4.SS6.p4.5.m5.1.1.2.2" xref="S4.SS6.p4.5.m5.1.1.2.2.cmml">B</mi><mi id="S4.SS6.p4.5.m5.1.1.2.3" xref="S4.SS6.p4.5.m5.1.1.2.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS6.p4.5.m5.1.1.1" xref="S4.SS6.p4.5.m5.1.1.1.cmml">​</mo><msub id="S4.SS6.p4.5.m5.1.1.3" xref="S4.SS6.p4.5.m5.1.1.3.cmml"><mi id="S4.SS6.p4.5.m5.1.1.3.2" xref="S4.SS6.p4.5.m5.1.1.3.2.cmml">A</mi><mi id="S4.SS6.p4.5.m5.1.1.3.3" xref="S4.SS6.p4.5.m5.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS6.p4.5.m5.1.1.1a" xref="S4.SS6.p4.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS6.p4.5.m5.1.1.4" xref="S4.SS6.p4.5.m5.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.5.m5.1b"><apply id="S4.SS6.p4.5.m5.1.1.cmml" xref="S4.SS6.p4.5.m5.1.1"><times id="S4.SS6.p4.5.m5.1.1.1.cmml" xref="S4.SS6.p4.5.m5.1.1.1"></times><apply id="S4.SS6.p4.5.m5.1.1.2.cmml" xref="S4.SS6.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p4.5.m5.1.1.2.1.cmml" xref="S4.SS6.p4.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS6.p4.5.m5.1.1.2.2.cmml" xref="S4.SS6.p4.5.m5.1.1.2.2">𝐵</ci><ci id="S4.SS6.p4.5.m5.1.1.2.3.cmml" xref="S4.SS6.p4.5.m5.1.1.2.3">𝑏</ci></apply><apply id="S4.SS6.p4.5.m5.1.1.3.cmml" xref="S4.SS6.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p4.5.m5.1.1.3.1.cmml" xref="S4.SS6.p4.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS6.p4.5.m5.1.1.3.2.cmml" xref="S4.SS6.p4.5.m5.1.1.3.2">𝐴</ci><ci id="S4.SS6.p4.5.m5.1.1.3.3.cmml" xref="S4.SS6.p4.5.m5.1.1.3.3">𝑏</ci></apply><ci id="S4.SS6.p4.5.m5.1.1.4.cmml" xref="S4.SS6.p4.5.m5.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.5.m5.1c">B_{b}A_{b}x</annotation></semantics></math> are summed coordinate-wise and are given the same input for the forward pass. The updates to the trainable parameters <math id="S4.SS6.p4.6.m6.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S4.SS6.p4.6.m6.1a"><msub id="S4.SS6.p4.6.m6.1.1" xref="S4.SS6.p4.6.m6.1.1.cmml"><mi id="S4.SS6.p4.6.m6.1.1.2" xref="S4.SS6.p4.6.m6.1.1.2.cmml">B</mi><mi id="S4.SS6.p4.6.m6.1.1.3" xref="S4.SS6.p4.6.m6.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.6.m6.1b"><apply id="S4.SS6.p4.6.m6.1.1.cmml" xref="S4.SS6.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.6.m6.1.1.1.cmml" xref="S4.SS6.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS6.p4.6.m6.1.1.2.cmml" xref="S4.SS6.p4.6.m6.1.1.2">𝐵</ci><ci id="S4.SS6.p4.6.m6.1.1.3.cmml" xref="S4.SS6.p4.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.6.m6.1c">B_{b}</annotation></semantics></math> and <math id="S4.SS6.p4.7.m7.1" class="ltx_Math" alttext="A_{b}" display="inline"><semantics id="S4.SS6.p4.7.m7.1a"><msub id="S4.SS6.p4.7.m7.1.1" xref="S4.SS6.p4.7.m7.1.1.cmml"><mi id="S4.SS6.p4.7.m7.1.1.2" xref="S4.SS6.p4.7.m7.1.1.2.cmml">A</mi><mi id="S4.SS6.p4.7.m7.1.1.3" xref="S4.SS6.p4.7.m7.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.7.m7.1b"><apply id="S4.SS6.p4.7.m7.1.1.cmml" xref="S4.SS6.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.7.m7.1.1.1.cmml" xref="S4.SS6.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS6.p4.7.m7.1.1.2.cmml" xref="S4.SS6.p4.7.m7.1.1.2">𝐴</ci><ci id="S4.SS6.p4.7.m7.1.1.3.cmml" xref="S4.SS6.p4.7.m7.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.7.m7.1c">A_{b}</annotation></semantics></math> are then clipped and sent back to the server for aggregation and noise addition as in DP-FedAvg. The communication cost apart from the initial transfer of <math id="S4.SS6.p4.8.m8.1" class="ltx_Math" alttext="W_{\text{pt}}" display="inline"><semantics id="S4.SS6.p4.8.m8.1a"><msub id="S4.SS6.p4.8.m8.1.1" xref="S4.SS6.p4.8.m8.1.1.cmml"><mi id="S4.SS6.p4.8.m8.1.1.2" xref="S4.SS6.p4.8.m8.1.1.2.cmml">W</mi><mtext id="S4.SS6.p4.8.m8.1.1.3" xref="S4.SS6.p4.8.m8.1.1.3a.cmml">pt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.8.m8.1b"><apply id="S4.SS6.p4.8.m8.1.1.cmml" xref="S4.SS6.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS6.p4.8.m8.1.1.1.cmml" xref="S4.SS6.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS6.p4.8.m8.1.1.2.cmml" xref="S4.SS6.p4.8.m8.1.1.2">𝑊</ci><ci id="S4.SS6.p4.8.m8.1.1.3a.cmml" xref="S4.SS6.p4.8.m8.1.1.3"><mtext mathsize="70%" id="S4.SS6.p4.8.m8.1.1.3.cmml" xref="S4.SS6.p4.8.m8.1.1.3">pt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.8.m8.1c">W_{\text{pt}}</annotation></semantics></math> is therefore equivalent to DP-LoRA with <math id="S4.SS6.p4.9.m9.1" class="ltx_Math" alttext="r=\frac{r_{min}+r_{max}}{2}" display="inline"><semantics id="S4.SS6.p4.9.m9.1a"><mrow id="S4.SS6.p4.9.m9.1.1" xref="S4.SS6.p4.9.m9.1.1.cmml"><mi id="S4.SS6.p4.9.m9.1.1.2" xref="S4.SS6.p4.9.m9.1.1.2.cmml">r</mi><mo id="S4.SS6.p4.9.m9.1.1.1" xref="S4.SS6.p4.9.m9.1.1.1.cmml">=</mo><mfrac id="S4.SS6.p4.9.m9.1.1.3" xref="S4.SS6.p4.9.m9.1.1.3.cmml"><mrow id="S4.SS6.p4.9.m9.1.1.3.2" xref="S4.SS6.p4.9.m9.1.1.3.2.cmml"><msub id="S4.SS6.p4.9.m9.1.1.3.2.2" xref="S4.SS6.p4.9.m9.1.1.3.2.2.cmml"><mi id="S4.SS6.p4.9.m9.1.1.3.2.2.2" xref="S4.SS6.p4.9.m9.1.1.3.2.2.2.cmml">r</mi><mrow id="S4.SS6.p4.9.m9.1.1.3.2.2.3" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.cmml"><mi id="S4.SS6.p4.9.m9.1.1.3.2.2.3.2" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.9.m9.1.1.3.2.2.3.1" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.1.cmml">​</mo><mi id="S4.SS6.p4.9.m9.1.1.3.2.2.3.3" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.9.m9.1.1.3.2.2.3.1a" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.1.cmml">​</mo><mi id="S4.SS6.p4.9.m9.1.1.3.2.2.3.4" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS6.p4.9.m9.1.1.3.2.1" xref="S4.SS6.p4.9.m9.1.1.3.2.1.cmml">+</mo><msub id="S4.SS6.p4.9.m9.1.1.3.2.3" xref="S4.SS6.p4.9.m9.1.1.3.2.3.cmml"><mi id="S4.SS6.p4.9.m9.1.1.3.2.3.2" xref="S4.SS6.p4.9.m9.1.1.3.2.3.2.cmml">r</mi><mrow id="S4.SS6.p4.9.m9.1.1.3.2.3.3" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.cmml"><mi id="S4.SS6.p4.9.m9.1.1.3.2.3.3.2" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.9.m9.1.1.3.2.3.3.1" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.1.cmml">​</mo><mi id="S4.SS6.p4.9.m9.1.1.3.2.3.3.3" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.9.m9.1.1.3.2.3.3.1a" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.1.cmml">​</mo><mi id="S4.SS6.p4.9.m9.1.1.3.2.3.3.4" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.4.cmml">x</mi></mrow></msub></mrow><mn id="S4.SS6.p4.9.m9.1.1.3.3" xref="S4.SS6.p4.9.m9.1.1.3.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.9.m9.1b"><apply id="S4.SS6.p4.9.m9.1.1.cmml" xref="S4.SS6.p4.9.m9.1.1"><eq id="S4.SS6.p4.9.m9.1.1.1.cmml" xref="S4.SS6.p4.9.m9.1.1.1"></eq><ci id="S4.SS6.p4.9.m9.1.1.2.cmml" xref="S4.SS6.p4.9.m9.1.1.2">𝑟</ci><apply id="S4.SS6.p4.9.m9.1.1.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3"><divide id="S4.SS6.p4.9.m9.1.1.3.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3"></divide><apply id="S4.SS6.p4.9.m9.1.1.3.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2"><plus id="S4.SS6.p4.9.m9.1.1.3.2.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.1"></plus><apply id="S4.SS6.p4.9.m9.1.1.3.2.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS6.p4.9.m9.1.1.3.2.2.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2">subscript</csymbol><ci id="S4.SS6.p4.9.m9.1.1.3.2.2.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.2">𝑟</ci><apply id="S4.SS6.p4.9.m9.1.1.3.2.2.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3"><times id="S4.SS6.p4.9.m9.1.1.3.2.2.3.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.1"></times><ci id="S4.SS6.p4.9.m9.1.1.3.2.2.3.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.2">𝑚</ci><ci id="S4.SS6.p4.9.m9.1.1.3.2.2.3.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.3">𝑖</ci><ci id="S4.SS6.p4.9.m9.1.1.3.2.2.3.4.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.2.3.4">𝑛</ci></apply></apply><apply id="S4.SS6.p4.9.m9.1.1.3.2.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS6.p4.9.m9.1.1.3.2.3.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3">subscript</csymbol><ci id="S4.SS6.p4.9.m9.1.1.3.2.3.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.2">𝑟</ci><apply id="S4.SS6.p4.9.m9.1.1.3.2.3.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3"><times id="S4.SS6.p4.9.m9.1.1.3.2.3.3.1.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.1"></times><ci id="S4.SS6.p4.9.m9.1.1.3.2.3.3.2.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.2">𝑚</ci><ci id="S4.SS6.p4.9.m9.1.1.3.2.3.3.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.3">𝑎</ci><ci id="S4.SS6.p4.9.m9.1.1.3.2.3.3.4.cmml" xref="S4.SS6.p4.9.m9.1.1.3.2.3.3.4">𝑥</ci></apply></apply></apply><cn type="integer" id="S4.SS6.p4.9.m9.1.1.3.3.cmml" xref="S4.SS6.p4.9.m9.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.9.m9.1c">r=\frac{r_{min}+r_{max}}{2}</annotation></semantics></math> on average which is approximately half of that of DP-LoRA with <math id="S4.SS6.p4.10.m10.1" class="ltx_Math" alttext="r=r_{max}" display="inline"><semantics id="S4.SS6.p4.10.m10.1a"><mrow id="S4.SS6.p4.10.m10.1.1" xref="S4.SS6.p4.10.m10.1.1.cmml"><mi id="S4.SS6.p4.10.m10.1.1.2" xref="S4.SS6.p4.10.m10.1.1.2.cmml">r</mi><mo id="S4.SS6.p4.10.m10.1.1.1" xref="S4.SS6.p4.10.m10.1.1.1.cmml">=</mo><msub id="S4.SS6.p4.10.m10.1.1.3" xref="S4.SS6.p4.10.m10.1.1.3.cmml"><mi id="S4.SS6.p4.10.m10.1.1.3.2" xref="S4.SS6.p4.10.m10.1.1.3.2.cmml">r</mi><mrow id="S4.SS6.p4.10.m10.1.1.3.3" xref="S4.SS6.p4.10.m10.1.1.3.3.cmml"><mi id="S4.SS6.p4.10.m10.1.1.3.3.2" xref="S4.SS6.p4.10.m10.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.10.m10.1.1.3.3.1" xref="S4.SS6.p4.10.m10.1.1.3.3.1.cmml">​</mo><mi id="S4.SS6.p4.10.m10.1.1.3.3.3" xref="S4.SS6.p4.10.m10.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.10.m10.1.1.3.3.1a" xref="S4.SS6.p4.10.m10.1.1.3.3.1.cmml">​</mo><mi id="S4.SS6.p4.10.m10.1.1.3.3.4" xref="S4.SS6.p4.10.m10.1.1.3.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.10.m10.1b"><apply id="S4.SS6.p4.10.m10.1.1.cmml" xref="S4.SS6.p4.10.m10.1.1"><eq id="S4.SS6.p4.10.m10.1.1.1.cmml" xref="S4.SS6.p4.10.m10.1.1.1"></eq><ci id="S4.SS6.p4.10.m10.1.1.2.cmml" xref="S4.SS6.p4.10.m10.1.1.2">𝑟</ci><apply id="S4.SS6.p4.10.m10.1.1.3.cmml" xref="S4.SS6.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p4.10.m10.1.1.3.1.cmml" xref="S4.SS6.p4.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS6.p4.10.m10.1.1.3.2.cmml" xref="S4.SS6.p4.10.m10.1.1.3.2">𝑟</ci><apply id="S4.SS6.p4.10.m10.1.1.3.3.cmml" xref="S4.SS6.p4.10.m10.1.1.3.3"><times id="S4.SS6.p4.10.m10.1.1.3.3.1.cmml" xref="S4.SS6.p4.10.m10.1.1.3.3.1"></times><ci id="S4.SS6.p4.10.m10.1.1.3.3.2.cmml" xref="S4.SS6.p4.10.m10.1.1.3.3.2">𝑚</ci><ci id="S4.SS6.p4.10.m10.1.1.3.3.3.cmml" xref="S4.SS6.p4.10.m10.1.1.3.3.3">𝑎</ci><ci id="S4.SS6.p4.10.m10.1.1.3.3.4.cmml" xref="S4.SS6.p4.10.m10.1.1.3.3.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.10.m10.1c">r=r_{max}</annotation></semantics></math> assuming that <math id="S4.SS6.p4.11.m11.1" class="ltx_Math" alttext="r_{min}=1" display="inline"><semantics id="S4.SS6.p4.11.m11.1a"><mrow id="S4.SS6.p4.11.m11.1.1" xref="S4.SS6.p4.11.m11.1.1.cmml"><msub id="S4.SS6.p4.11.m11.1.1.2" xref="S4.SS6.p4.11.m11.1.1.2.cmml"><mi id="S4.SS6.p4.11.m11.1.1.2.2" xref="S4.SS6.p4.11.m11.1.1.2.2.cmml">r</mi><mrow id="S4.SS6.p4.11.m11.1.1.2.3" xref="S4.SS6.p4.11.m11.1.1.2.3.cmml"><mi id="S4.SS6.p4.11.m11.1.1.2.3.2" xref="S4.SS6.p4.11.m11.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.11.m11.1.1.2.3.1" xref="S4.SS6.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S4.SS6.p4.11.m11.1.1.2.3.3" xref="S4.SS6.p4.11.m11.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p4.11.m11.1.1.2.3.1a" xref="S4.SS6.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S4.SS6.p4.11.m11.1.1.2.3.4" xref="S4.SS6.p4.11.m11.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS6.p4.11.m11.1.1.1" xref="S4.SS6.p4.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS6.p4.11.m11.1.1.3" xref="S4.SS6.p4.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.11.m11.1b"><apply id="S4.SS6.p4.11.m11.1.1.cmml" xref="S4.SS6.p4.11.m11.1.1"><eq id="S4.SS6.p4.11.m11.1.1.1.cmml" xref="S4.SS6.p4.11.m11.1.1.1"></eq><apply id="S4.SS6.p4.11.m11.1.1.2.cmml" xref="S4.SS6.p4.11.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p4.11.m11.1.1.2.1.cmml" xref="S4.SS6.p4.11.m11.1.1.2">subscript</csymbol><ci id="S4.SS6.p4.11.m11.1.1.2.2.cmml" xref="S4.SS6.p4.11.m11.1.1.2.2">𝑟</ci><apply id="S4.SS6.p4.11.m11.1.1.2.3.cmml" xref="S4.SS6.p4.11.m11.1.1.2.3"><times id="S4.SS6.p4.11.m11.1.1.2.3.1.cmml" xref="S4.SS6.p4.11.m11.1.1.2.3.1"></times><ci id="S4.SS6.p4.11.m11.1.1.2.3.2.cmml" xref="S4.SS6.p4.11.m11.1.1.2.3.2">𝑚</ci><ci id="S4.SS6.p4.11.m11.1.1.2.3.3.cmml" xref="S4.SS6.p4.11.m11.1.1.2.3.3">𝑖</ci><ci id="S4.SS6.p4.11.m11.1.1.2.3.4.cmml" xref="S4.SS6.p4.11.m11.1.1.2.3.4">𝑛</ci></apply></apply><cn type="integer" id="S4.SS6.p4.11.m11.1.1.3.cmml" xref="S4.SS6.p4.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.11.m11.1c">r_{min}=1</annotation></semantics></math>. Since the magnitude of the added noise grows with the number of parameters updated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, DP-DyLoRA also achieves higher signal-to-noise ratio than DP-LoRA under the same DP-FL setting. Meanwhile, the same level of model expressiveness is preserved as the model architecture and number of trainable parameters remain the same for the global model.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.3.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> DP-DyLoRA with <span id="alg2.4.2" class="ltx_text" style="background-color:#FFBFBF;">SecureSum</span>.</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.2.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg2.l1.1" class="ltx_text ltx_font_smallcaps">Server</span>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>       <span id="alg2.l2.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>           number of communication rounds <math id="alg2.l3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l3.m1.1a"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">T</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>           all users <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="alg2.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{K}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>           user sampling rate <math id="alg2.l5.m1.2" class="ltx_Math" alttext="q\in(0,1]" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.3" xref="alg2.l5.m1.2.3.cmml"><mi id="alg2.l5.m1.2.3.2" xref="alg2.l5.m1.2.3.2.cmml">q</mi><mo id="alg2.l5.m1.2.3.1" xref="alg2.l5.m1.2.3.1.cmml">∈</mo><mrow id="alg2.l5.m1.2.3.3.2" xref="alg2.l5.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l5.m1.2.3.3.2.1" xref="alg2.l5.m1.2.3.3.1.cmml">(</mo><mn id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">0</mn><mo id="alg2.l5.m1.2.3.3.2.2" xref="alg2.l5.m1.2.3.3.1.cmml">,</mo><mn id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg2.l5.m1.2.3.3.2.3" xref="alg2.l5.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.3.cmml" xref="alg2.l5.m1.2.3"><in id="alg2.l5.m1.2.3.1.cmml" xref="alg2.l5.m1.2.3.1"></in><ci id="alg2.l5.m1.2.3.2.cmml" xref="alg2.l5.m1.2.3.2">𝑞</ci><interval closure="open-closed" id="alg2.l5.m1.2.3.3.1.cmml" xref="alg2.l5.m1.2.3.3.2"><cn type="integer" id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">0</cn><cn type="integer" id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">q\in(0,1]</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>           noise multiplier <math id="alg2.l6.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">z</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           clip norm <math id="alg2.l7.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">S</annotation></semantics></math>

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>           minimum rank <math id="alg2.l8.m1.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="alg2.l8.m1.1a"><msub id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">r</mi><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.1a" xref="alg2.l8.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.4" xref="alg2.l8.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑟</ci><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><times id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></times><ci id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2">𝑚</ci><ci id="alg2.l8.m1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.3.3">𝑖</ci><ci id="alg2.l8.m1.1.1.3.4.cmml" xref="alg2.l8.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">r_{min}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>           maximum rank <math id="alg2.l9.m1.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="alg2.l9.m1.1a"><msub id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">r</mi><mrow id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"><mi id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.1.1.3.1" xref="alg2.l9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.1.1.3.1a" xref="alg2.l9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l9.m1.1.1.3.4" xref="alg2.l9.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑟</ci><apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"><times id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3.1"></times><ci id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3.2">𝑚</ci><ci id="alg2.l9.m1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.3.3">𝑎</ci><ci id="alg2.l9.m1.1.1.3.4.cmml" xref="alg2.l9.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">r_{max}</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>           pre-trained model weights <math id="alg2.l10.m1.1" class="ltx_Math" alttext="W^{\text{0}}" display="inline"><semantics id="alg2.l10.m1.1a"><msup id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">W</mi><mtext id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3a.cmml">0</mtext></msup><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1">superscript</csymbol><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝑊</ci><ci id="alg2.l10.m1.1.1.3a.cmml" xref="alg2.l10.m1.1.1.3"><mtext mathsize="70%" id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">W^{\text{0}}</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>       <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span> each dense weight matrix <math id="alg2.l11.m1.1" class="ltx_Math" alttext="W_{i}^{0}" display="inline"><semantics id="alg2.l11.m1.1a"><msubsup id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi id="alg2.l11.m1.1.1.2.2" xref="alg2.l11.m1.1.1.2.2.cmml">W</mi><mi id="alg2.l11.m1.1.1.2.3" xref="alg2.l11.m1.1.1.2.3.cmml">i</mi><mn id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1">superscript</csymbol><apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">𝑊</ci><ci id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">W_{i}^{0}</annotation></semantics></math> in <math id="alg2.l11.m2.1" class="ltx_Math" alttext="W^{\text{0}}" display="inline"><semantics id="alg2.l11.m2.1a"><msup id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml">W</mi><mtext id="alg2.l11.m2.1.1.3" xref="alg2.l11.m2.1.1.3a.cmml">0</mtext></msup><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1">superscript</csymbol><ci id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">𝑊</ci><ci id="alg2.l11.m2.1.1.3a.cmml" xref="alg2.l11.m2.1.1.3"><mtext mathsize="70%" id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3">0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">W^{\text{0}}</annotation></semantics></math> <span id="alg2.l11.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           <math id="alg2.l12.m1.1" class="ltx_Math" alttext="B_{i}^{0}\leftarrow" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><msubsup id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml"><mi id="alg2.l12.m1.1.1.2.2.2" xref="alg2.l12.m1.1.1.2.2.2.cmml">B</mi><mi id="alg2.l12.m1.1.1.2.2.3" xref="alg2.l12.m1.1.1.2.2.3.cmml">i</mi><mn id="alg2.l12.m1.1.1.2.3" xref="alg2.l12.m1.1.1.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml">←</mo><mi id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><ci id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1">←</ci><apply id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.2.1.cmml" xref="alg2.l12.m1.1.1.2">superscript</csymbol><apply id="alg2.l12.m1.1.1.2.2.cmml" xref="alg2.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.2.2.1.cmml" xref="alg2.l12.m1.1.1.2">subscript</csymbol><ci id="alg2.l12.m1.1.1.2.2.2.cmml" xref="alg2.l12.m1.1.1.2.2.2">𝐵</ci><ci id="alg2.l12.m1.1.1.2.2.3.cmml" xref="alg2.l12.m1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l12.m1.1.1.2.3.cmml" xref="alg2.l12.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">B_{i}^{0}\leftarrow</annotation></semantics></math> (random Gaussian initialization)

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>           <math id="alg2.l13.m1.1" class="ltx_Math" alttext="A_{i}^{0}\leftarrow" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msubsup id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.2.2.2" xref="alg2.l13.m1.1.1.2.2.2.cmml">A</mi><mi id="alg2.l13.m1.1.1.2.2.3" xref="alg2.l13.m1.1.1.2.2.3.cmml">i</mi><mn id="alg2.l13.m1.1.1.2.3" xref="alg2.l13.m1.1.1.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">←</mo><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><ci id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1">←</ci><apply id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.2">superscript</csymbol><apply id="alg2.l13.m1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.2.1.cmml" xref="alg2.l13.m1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.2.2.cmml" xref="alg2.l13.m1.1.1.2.2.2">𝐴</ci><ci id="alg2.l13.m1.1.1.2.2.3.cmml" xref="alg2.l13.m1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l13.m1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">A_{i}^{0}\leftarrow</annotation></semantics></math> (zero initialization)

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>           <math id="alg2.l14.m1.1" class="ltx_Math" alttext="W_{i}^{0}=W_{i}^{0}+B_{i}^{0}A_{i}^{0}" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msubsup id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2.2" xref="alg2.l14.m1.1.1.2.2.2.cmml">W</mi><mi id="alg2.l14.m1.1.1.2.2.3" xref="alg2.l14.m1.1.1.2.2.3.cmml">i</mi><mn id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">0</mn></msubsup><mo id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">=</mo><mrow id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><msubsup id="alg2.l14.m1.1.1.3.2" xref="alg2.l14.m1.1.1.3.2.cmml"><mi id="alg2.l14.m1.1.1.3.2.2.2" xref="alg2.l14.m1.1.1.3.2.2.2.cmml">W</mi><mi id="alg2.l14.m1.1.1.3.2.2.3" xref="alg2.l14.m1.1.1.3.2.2.3.cmml">i</mi><mn id="alg2.l14.m1.1.1.3.2.3" xref="alg2.l14.m1.1.1.3.2.3.cmml">0</mn></msubsup><mo id="alg2.l14.m1.1.1.3.1" xref="alg2.l14.m1.1.1.3.1.cmml">+</mo><mrow id="alg2.l14.m1.1.1.3.3" xref="alg2.l14.m1.1.1.3.3.cmml"><msubsup id="alg2.l14.m1.1.1.3.3.2" xref="alg2.l14.m1.1.1.3.3.2.cmml"><mi id="alg2.l14.m1.1.1.3.3.2.2.2" xref="alg2.l14.m1.1.1.3.3.2.2.2.cmml">B</mi><mi id="alg2.l14.m1.1.1.3.3.2.2.3" xref="alg2.l14.m1.1.1.3.3.2.2.3.cmml">i</mi><mn id="alg2.l14.m1.1.1.3.3.2.3" xref="alg2.l14.m1.1.1.3.3.2.3.cmml">0</mn></msubsup><mo lspace="0em" rspace="0em" id="alg2.l14.m1.1.1.3.3.1" xref="alg2.l14.m1.1.1.3.3.1.cmml">​</mo><msubsup id="alg2.l14.m1.1.1.3.3.3" xref="alg2.l14.m1.1.1.3.3.3.cmml"><mi id="alg2.l14.m1.1.1.3.3.3.2.2" xref="alg2.l14.m1.1.1.3.3.3.2.2.cmml">A</mi><mi id="alg2.l14.m1.1.1.3.3.3.2.3" xref="alg2.l14.m1.1.1.3.3.3.2.3.cmml">i</mi><mn id="alg2.l14.m1.1.1.3.3.3.3" xref="alg2.l14.m1.1.1.3.3.3.3.cmml">0</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><eq id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1"></eq><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.2.cmml" xref="alg2.l14.m1.1.1.2.2.2">𝑊</ci><ci id="alg2.l14.m1.1.1.2.2.3.cmml" xref="alg2.l14.m1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">0</cn></apply><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><plus id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3.1"></plus><apply id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.2.2.1.cmml" xref="alg2.l14.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.2.2.cmml" xref="alg2.l14.m1.1.1.3.2.2.2">𝑊</ci><ci id="alg2.l14.m1.1.1.3.2.2.3.cmml" xref="alg2.l14.m1.1.1.3.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l14.m1.1.1.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.2.3">0</cn></apply><apply id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3"><times id="alg2.l14.m1.1.1.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3.1"></times><apply id="alg2.l14.m1.1.1.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.3.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.2.2.1.cmml" xref="alg2.l14.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.3.2.2.2.cmml" xref="alg2.l14.m1.1.1.3.3.2.2.2">𝐵</ci><ci id="alg2.l14.m1.1.1.3.3.2.2.3.cmml" xref="alg2.l14.m1.1.1.3.3.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l14.m1.1.1.3.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.3.2.3">0</cn></apply><apply id="alg2.l14.m1.1.1.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3.3">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.3.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.3.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.3.3.2.2">𝐴</ci><ci id="alg2.l14.m1.1.1.3.3.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.3.3.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l14.m1.1.1.3.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">W_{i}^{0}=W_{i}^{0}+B_{i}^{0}A_{i}^{0}</annotation></semantics></math>

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>       Freeze all pre-trained weights <math id="alg2.l15.m1.1" class="ltx_Math" alttext="W^{0}" display="inline"><semantics id="alg2.l15.m1.1a"><msup id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">W</mi><mn id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1">superscript</csymbol><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑊</ci><cn type="integer" id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">W^{0}</annotation></semantics></math>

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>       <span id="alg2.l16.2" class="ltx_text ltx_font_bold">for</span> each round <math id="alg2.l16.m1.3" class="ltx_Math" alttext="t=1,2,\ldots T" display="inline"><semantics id="alg2.l16.m1.3a"><mrow id="alg2.l16.m1.3.3" xref="alg2.l16.m1.3.3.cmml"><mi id="alg2.l16.m1.3.3.3" xref="alg2.l16.m1.3.3.3.cmml">t</mi><mo id="alg2.l16.m1.3.3.2" xref="alg2.l16.m1.3.3.2.cmml">=</mo><mrow id="alg2.l16.m1.3.3.1.1" xref="alg2.l16.m1.3.3.1.2.cmml"><mn id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml">1</mn><mo id="alg2.l16.m1.3.3.1.1.2" xref="alg2.l16.m1.3.3.1.2.cmml">,</mo><mn id="alg2.l16.m1.2.2" xref="alg2.l16.m1.2.2.cmml">2</mn><mo id="alg2.l16.m1.3.3.1.1.3" xref="alg2.l16.m1.3.3.1.2.cmml">,</mo><mrow id="alg2.l16.m1.3.3.1.1.1" xref="alg2.l16.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="alg2.l16.m1.3.3.1.1.1.2" xref="alg2.l16.m1.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.3.3.1.1.1.1" xref="alg2.l16.m1.3.3.1.1.1.1.cmml">​</mo><mi id="alg2.l16.m1.3.3.1.1.1.3" xref="alg2.l16.m1.3.3.1.1.1.3.cmml">T</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.3b"><apply id="alg2.l16.m1.3.3.cmml" xref="alg2.l16.m1.3.3"><eq id="alg2.l16.m1.3.3.2.cmml" xref="alg2.l16.m1.3.3.2"></eq><ci id="alg2.l16.m1.3.3.3.cmml" xref="alg2.l16.m1.3.3.3">𝑡</ci><list id="alg2.l16.m1.3.3.1.2.cmml" xref="alg2.l16.m1.3.3.1.1"><cn type="integer" id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1">1</cn><cn type="integer" id="alg2.l16.m1.2.2.cmml" xref="alg2.l16.m1.2.2">2</cn><apply id="alg2.l16.m1.3.3.1.1.1.cmml" xref="alg2.l16.m1.3.3.1.1.1"><times id="alg2.l16.m1.3.3.1.1.1.1.cmml" xref="alg2.l16.m1.3.3.1.1.1.1"></times><ci id="alg2.l16.m1.3.3.1.1.1.2.cmml" xref="alg2.l16.m1.3.3.1.1.1.2">…</ci><ci id="alg2.l16.m1.3.3.1.1.1.3.cmml" xref="alg2.l16.m1.3.3.1.1.1.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.3c">t=1,2,\ldots T</annotation></semantics></math> <span id="alg2.l16.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>           Sample rank <math id="alg2.l17.m1.4" class="ltx_Math" alttext="b^{t}\in\{r_{min},r_{min}+1,\ldots,r_{max}\}" display="inline"><semantics id="alg2.l17.m1.4a"><mrow id="alg2.l17.m1.4.4" xref="alg2.l17.m1.4.4.cmml"><msup id="alg2.l17.m1.4.4.5" xref="alg2.l17.m1.4.4.5.cmml"><mi id="alg2.l17.m1.4.4.5.2" xref="alg2.l17.m1.4.4.5.2.cmml">b</mi><mi id="alg2.l17.m1.4.4.5.3" xref="alg2.l17.m1.4.4.5.3.cmml">t</mi></msup><mo id="alg2.l17.m1.4.4.4" xref="alg2.l17.m1.4.4.4.cmml">∈</mo><mrow id="alg2.l17.m1.4.4.3.3" xref="alg2.l17.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg2.l17.m1.4.4.3.3.4" xref="alg2.l17.m1.4.4.3.4.cmml">{</mo><msub id="alg2.l17.m1.2.2.1.1.1" xref="alg2.l17.m1.2.2.1.1.1.cmml"><mi id="alg2.l17.m1.2.2.1.1.1.2" xref="alg2.l17.m1.2.2.1.1.1.2.cmml">r</mi><mrow id="alg2.l17.m1.2.2.1.1.1.3" xref="alg2.l17.m1.2.2.1.1.1.3.cmml"><mi id="alg2.l17.m1.2.2.1.1.1.3.2" xref="alg2.l17.m1.2.2.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.2.2.1.1.1.3.1" xref="alg2.l17.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="alg2.l17.m1.2.2.1.1.1.3.3" xref="alg2.l17.m1.2.2.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.2.2.1.1.1.3.1a" xref="alg2.l17.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="alg2.l17.m1.2.2.1.1.1.3.4" xref="alg2.l17.m1.2.2.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="alg2.l17.m1.4.4.3.3.5" xref="alg2.l17.m1.4.4.3.4.cmml">,</mo><mrow id="alg2.l17.m1.3.3.2.2.2" xref="alg2.l17.m1.3.3.2.2.2.cmml"><msub id="alg2.l17.m1.3.3.2.2.2.2" xref="alg2.l17.m1.3.3.2.2.2.2.cmml"><mi id="alg2.l17.m1.3.3.2.2.2.2.2" xref="alg2.l17.m1.3.3.2.2.2.2.2.cmml">r</mi><mrow id="alg2.l17.m1.3.3.2.2.2.2.3" xref="alg2.l17.m1.3.3.2.2.2.2.3.cmml"><mi id="alg2.l17.m1.3.3.2.2.2.2.3.2" xref="alg2.l17.m1.3.3.2.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.3.3.2.2.2.2.3.1" xref="alg2.l17.m1.3.3.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l17.m1.3.3.2.2.2.2.3.3" xref="alg2.l17.m1.3.3.2.2.2.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.3.3.2.2.2.2.3.1a" xref="alg2.l17.m1.3.3.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l17.m1.3.3.2.2.2.2.3.4" xref="alg2.l17.m1.3.3.2.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="alg2.l17.m1.3.3.2.2.2.1" xref="alg2.l17.m1.3.3.2.2.2.1.cmml">+</mo><mn id="alg2.l17.m1.3.3.2.2.2.3" xref="alg2.l17.m1.3.3.2.2.2.3.cmml">1</mn></mrow><mo id="alg2.l17.m1.4.4.3.3.6" xref="alg2.l17.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">…</mi><mo id="alg2.l17.m1.4.4.3.3.7" xref="alg2.l17.m1.4.4.3.4.cmml">,</mo><msub id="alg2.l17.m1.4.4.3.3.3" xref="alg2.l17.m1.4.4.3.3.3.cmml"><mi id="alg2.l17.m1.4.4.3.3.3.2" xref="alg2.l17.m1.4.4.3.3.3.2.cmml">r</mi><mrow id="alg2.l17.m1.4.4.3.3.3.3" xref="alg2.l17.m1.4.4.3.3.3.3.cmml"><mi id="alg2.l17.m1.4.4.3.3.3.3.2" xref="alg2.l17.m1.4.4.3.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.4.4.3.3.3.3.1" xref="alg2.l17.m1.4.4.3.3.3.3.1.cmml">​</mo><mi id="alg2.l17.m1.4.4.3.3.3.3.3" xref="alg2.l17.m1.4.4.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.4.4.3.3.3.3.1a" xref="alg2.l17.m1.4.4.3.3.3.3.1.cmml">​</mo><mi id="alg2.l17.m1.4.4.3.3.3.3.4" xref="alg2.l17.m1.4.4.3.3.3.3.4.cmml">x</mi></mrow></msub><mo stretchy="false" id="alg2.l17.m1.4.4.3.3.8" xref="alg2.l17.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.4b"><apply id="alg2.l17.m1.4.4.cmml" xref="alg2.l17.m1.4.4"><in id="alg2.l17.m1.4.4.4.cmml" xref="alg2.l17.m1.4.4.4"></in><apply id="alg2.l17.m1.4.4.5.cmml" xref="alg2.l17.m1.4.4.5"><csymbol cd="ambiguous" id="alg2.l17.m1.4.4.5.1.cmml" xref="alg2.l17.m1.4.4.5">superscript</csymbol><ci id="alg2.l17.m1.4.4.5.2.cmml" xref="alg2.l17.m1.4.4.5.2">𝑏</ci><ci id="alg2.l17.m1.4.4.5.3.cmml" xref="alg2.l17.m1.4.4.5.3">𝑡</ci></apply><set id="alg2.l17.m1.4.4.3.4.cmml" xref="alg2.l17.m1.4.4.3.3"><apply id="alg2.l17.m1.2.2.1.1.1.cmml" xref="alg2.l17.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.2.2.1.1.1.1.cmml" xref="alg2.l17.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.l17.m1.2.2.1.1.1.2.cmml" xref="alg2.l17.m1.2.2.1.1.1.2">𝑟</ci><apply id="alg2.l17.m1.2.2.1.1.1.3.cmml" xref="alg2.l17.m1.2.2.1.1.1.3"><times id="alg2.l17.m1.2.2.1.1.1.3.1.cmml" xref="alg2.l17.m1.2.2.1.1.1.3.1"></times><ci id="alg2.l17.m1.2.2.1.1.1.3.2.cmml" xref="alg2.l17.m1.2.2.1.1.1.3.2">𝑚</ci><ci id="alg2.l17.m1.2.2.1.1.1.3.3.cmml" xref="alg2.l17.m1.2.2.1.1.1.3.3">𝑖</ci><ci id="alg2.l17.m1.2.2.1.1.1.3.4.cmml" xref="alg2.l17.m1.2.2.1.1.1.3.4">𝑛</ci></apply></apply><apply id="alg2.l17.m1.3.3.2.2.2.cmml" xref="alg2.l17.m1.3.3.2.2.2"><plus id="alg2.l17.m1.3.3.2.2.2.1.cmml" xref="alg2.l17.m1.3.3.2.2.2.1"></plus><apply id="alg2.l17.m1.3.3.2.2.2.2.cmml" xref="alg2.l17.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l17.m1.3.3.2.2.2.2.1.cmml" xref="alg2.l17.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg2.l17.m1.3.3.2.2.2.2.2.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.2">𝑟</ci><apply id="alg2.l17.m1.3.3.2.2.2.2.3.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.3"><times id="alg2.l17.m1.3.3.2.2.2.2.3.1.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.3.1"></times><ci id="alg2.l17.m1.3.3.2.2.2.2.3.2.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.3.2">𝑚</ci><ci id="alg2.l17.m1.3.3.2.2.2.2.3.3.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.3.3">𝑖</ci><ci id="alg2.l17.m1.3.3.2.2.2.2.3.4.cmml" xref="alg2.l17.m1.3.3.2.2.2.2.3.4">𝑛</ci></apply></apply><cn type="integer" id="alg2.l17.m1.3.3.2.2.2.3.cmml" xref="alg2.l17.m1.3.3.2.2.2.3">1</cn></apply><ci id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1">…</ci><apply id="alg2.l17.m1.4.4.3.3.3.cmml" xref="alg2.l17.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.4.4.3.3.3.1.cmml" xref="alg2.l17.m1.4.4.3.3.3">subscript</csymbol><ci id="alg2.l17.m1.4.4.3.3.3.2.cmml" xref="alg2.l17.m1.4.4.3.3.3.2">𝑟</ci><apply id="alg2.l17.m1.4.4.3.3.3.3.cmml" xref="alg2.l17.m1.4.4.3.3.3.3"><times id="alg2.l17.m1.4.4.3.3.3.3.1.cmml" xref="alg2.l17.m1.4.4.3.3.3.3.1"></times><ci id="alg2.l17.m1.4.4.3.3.3.3.2.cmml" xref="alg2.l17.m1.4.4.3.3.3.3.2">𝑚</ci><ci id="alg2.l17.m1.4.4.3.3.3.3.3.cmml" xref="alg2.l17.m1.4.4.3.3.3.3.3">𝑎</ci><ci id="alg2.l17.m1.4.4.3.3.3.3.4.cmml" xref="alg2.l17.m1.4.4.3.3.3.3.4">𝑥</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.4c">b^{t}\in\{r_{min},r_{min}+1,\ldots,r_{max}\}</annotation></semantics></math>           uniformly at random

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>           <span id="alg2.l18.2" class="ltx_text ltx_font_bold">for</span> each dense weight matrix <math id="alg2.l18.m1.1" class="ltx_Math" alttext="W_{i}^{t}" display="inline"><semantics id="alg2.l18.m1.1a"><msubsup id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2.2" xref="alg2.l18.m1.1.1.2.2.cmml">W</mi><mi id="alg2.l18.m1.1.1.2.3" xref="alg2.l18.m1.1.1.2.3.cmml">i</mi><mi id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1">superscript</csymbol><apply id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.2.2">𝑊</ci><ci id="alg2.l18.m1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">W_{i}^{t}</annotation></semantics></math> in <math id="alg2.l18.m2.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg2.l18.m2.1a"><msup id="alg2.l18.m2.1.1" xref="alg2.l18.m2.1.1.cmml"><mi id="alg2.l18.m2.1.1.2" xref="alg2.l18.m2.1.1.2.cmml">W</mi><mi id="alg2.l18.m2.1.1.3" xref="alg2.l18.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l18.m2.1b"><apply id="alg2.l18.m2.1.1.cmml" xref="alg2.l18.m2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m2.1.1.1.cmml" xref="alg2.l18.m2.1.1">superscript</csymbol><ci id="alg2.l18.m2.1.1.2.cmml" xref="alg2.l18.m2.1.1.2">𝑊</ci><ci id="alg2.l18.m2.1.1.3.cmml" xref="alg2.l18.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m2.1c">W^{t}</annotation></semantics></math> <span id="alg2.l18.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>               <math id="alg2.l19.m1.2" class="ltx_math_unparsed" alttext="\hat{W}^{t}_{i}=B_{i}^{t}[:,1:b]A_{i}^{t}[1:b,:]" display="inline"><semantics id="alg2.l19.m1.2a"><mrow id="alg2.l19.m1.2b"><msubsup id="alg2.l19.m1.2.3"><mover accent="true" id="alg2.l19.m1.2.3.2.2"><mi id="alg2.l19.m1.2.3.2.2.2">W</mi><mo id="alg2.l19.m1.2.3.2.2.1">^</mo></mover><mi id="alg2.l19.m1.2.3.3">i</mi><mi id="alg2.l19.m1.2.3.2.3">t</mi></msubsup><mo id="alg2.l19.m1.2.4">=</mo><msubsup id="alg2.l19.m1.2.5"><mi id="alg2.l19.m1.2.5.2.2">B</mi><mi id="alg2.l19.m1.2.5.2.3">i</mi><mi id="alg2.l19.m1.2.5.3">t</mi></msubsup><mrow id="alg2.l19.m1.2.6"><mo stretchy="false" id="alg2.l19.m1.2.6.1">[</mo><mo rspace="0em" id="alg2.l19.m1.1.1">:</mo><mo id="alg2.l19.m1.2.6.2">,</mo><mn id="alg2.l19.m1.2.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg2.l19.m1.2.6.3">:</mo><mi id="alg2.l19.m1.2.6.4">b</mi><mo stretchy="false" id="alg2.l19.m1.2.6.5">]</mo></mrow><msubsup id="alg2.l19.m1.2.7"><mi id="alg2.l19.m1.2.7.2.2">A</mi><mi id="alg2.l19.m1.2.7.2.3">i</mi><mi id="alg2.l19.m1.2.7.3">t</mi></msubsup><mrow id="alg2.l19.m1.2.8"><mo stretchy="false" id="alg2.l19.m1.2.8.1">[</mo><mn id="alg2.l19.m1.2.8.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg2.l19.m1.2.8.3">:</mo><mi id="alg2.l19.m1.2.8.4">b</mi><mo id="alg2.l19.m1.2.8.5">,</mo><mo rspace="0em" id="alg2.l19.m1.2.8.6">:</mo><mo stretchy="false" id="alg2.l19.m1.2.8.7">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l19.m1.2c">\hat{W}^{t}_{i}=B_{i}^{t}[:,1:b]A_{i}^{t}[1:b,:]</annotation></semantics></math>

</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>           Sample a subset <math id="alg2.l20.m1.1" class="ltx_Math" alttext="\mathcal{C}^{t}\subseteq\mathcal{K}" display="inline"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml"><msup id="alg2.l20.m1.1.1.2" xref="alg2.l20.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1.2.2" xref="alg2.l20.m1.1.1.2.2.cmml">𝒞</mi><mi id="alg2.l20.m1.1.1.2.3" xref="alg2.l20.m1.1.1.2.3.cmml">t</mi></msup><mo id="alg2.l20.m1.1.1.1" xref="alg2.l20.m1.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1.3" xref="alg2.l20.m1.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1"><subset id="alg2.l20.m1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1"></subset><apply id="alg2.l20.m1.1.1.2.cmml" xref="alg2.l20.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.2.1.cmml" xref="alg2.l20.m1.1.1.2">superscript</csymbol><ci id="alg2.l20.m1.1.1.2.2.cmml" xref="alg2.l20.m1.1.1.2.2">𝒞</ci><ci id="alg2.l20.m1.1.1.2.3.cmml" xref="alg2.l20.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l20.m1.1.1.3.cmml" xref="alg2.l20.m1.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\mathcal{C}^{t}\subseteq\mathcal{K}</annotation></semantics></math> of users uniformly at          random with probability <math id="alg2.l20.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg2.l20.m2.1a"><mi id="alg2.l20.m2.1.1" xref="alg2.l20.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg2.l20.m2.1b"><ci id="alg2.l20.m2.1.1.cmml" xref="alg2.l20.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m2.1c">q</annotation></semantics></math>

</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>           <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\sigma=z\cdot S" display="inline"><semantics id="alg2.l21.m1.1a"><mrow id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml"><mi id="alg2.l21.m1.1.1.2" xref="alg2.l21.m1.1.1.2.cmml">σ</mi><mo id="alg2.l21.m1.1.1.1" xref="alg2.l21.m1.1.1.1.cmml">=</mo><mrow id="alg2.l21.m1.1.1.3" xref="alg2.l21.m1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.3.2" xref="alg2.l21.m1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l21.m1.1.1.3.1" xref="alg2.l21.m1.1.1.3.1.cmml">⋅</mo><mi id="alg2.l21.m1.1.1.3.3" xref="alg2.l21.m1.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><apply id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1"><eq id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1"></eq><ci id="alg2.l21.m1.1.1.2.cmml" xref="alg2.l21.m1.1.1.2">𝜎</ci><apply id="alg2.l21.m1.1.1.3.cmml" xref="alg2.l21.m1.1.1.3"><ci id="alg2.l21.m1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.3.1">⋅</ci><ci id="alg2.l21.m1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.3.2">𝑧</ci><ci id="alg2.l21.m1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\sigma=z\cdot S</annotation></semantics></math>

</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>           <math id="alg2.l22.m1.1" class="ltx_math_unparsed" alttext="W^{t+1}\leftarrow W^{t}+\frac{1}{\lvert\mathcal{C}^{t}\rvert}\textsc{SecureSumDP}\big{(}" display="inline"><semantics id="alg2.l22.m1.1a"><mrow id="alg2.l22.m1.1b"><msup id="alg2.l22.m1.1.2"><mi id="alg2.l22.m1.1.2.2">W</mi><mrow id="alg2.l22.m1.1.2.3"><mi id="alg2.l22.m1.1.2.3.2">t</mi><mo id="alg2.l22.m1.1.2.3.1">+</mo><mn id="alg2.l22.m1.1.2.3.3">1</mn></mrow></msup><mo stretchy="false" id="alg2.l22.m1.1.3">←</mo><msup id="alg2.l22.m1.1.4"><mi id="alg2.l22.m1.1.4.2">W</mi><mi id="alg2.l22.m1.1.4.3">t</mi></msup><mo id="alg2.l22.m1.1.5">+</mo><mfrac id="alg2.l22.m1.1.1"><mn id="alg2.l22.m1.1.1.3">1</mn><mrow id="alg2.l22.m1.1.1.1.1"><mo stretchy="false" id="alg2.l22.m1.1.1.1.1.2">|</mo><msup id="alg2.l22.m1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="alg2.l22.m1.1.1.1.1.1.2">𝒞</mi><mi id="alg2.l22.m1.1.1.1.1.1.3">t</mi></msup><mo stretchy="false" id="alg2.l22.m1.1.1.1.1.3">|</mo></mrow></mfrac><mtext class="ltx_font_smallcaps" id="alg2.l22.m1.1.6">SecureSumDP</mtext><mo maxsize="120%" minsize="120%" id="alg2.l22.m1.1.7">(</mo></mrow><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">W^{t+1}\leftarrow W^{t}+\frac{1}{\lvert\mathcal{C}^{t}\rvert}\textsc{SecureSumDP}\big{(}</annotation></semantics></math>

</div>
<div id="alg2.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>                <math id="alg2.l23.m1.3" class="ltx_math_unparsed" alttext="\{\textsc{UserUpdate}(k,\hat{W}^{t})\}_{k\in\mathcal{C}^{t}},z,S\big{)}" display="inline"><semantics id="alg2.l23.m1.3a"><mrow id="alg2.l23.m1.3b"><msub id="alg2.l23.m1.3.4"><mrow id="alg2.l23.m1.3.4.2"><mo stretchy="false" id="alg2.l23.m1.3.4.2.1">{</mo><mtext class="ltx_font_smallcaps" id="alg2.l23.m1.3.4.2.2">UserUpdate</mtext><mrow id="alg2.l23.m1.3.4.2.3"><mo stretchy="false" id="alg2.l23.m1.3.4.2.3.1">(</mo><mi id="alg2.l23.m1.1.1">k</mi><mo id="alg2.l23.m1.3.4.2.3.2">,</mo><msup id="alg2.l23.m1.3.4.2.3.3"><mover accent="true" id="alg2.l23.m1.3.4.2.3.3.2"><mi id="alg2.l23.m1.3.4.2.3.3.2.2">W</mi><mo id="alg2.l23.m1.3.4.2.3.3.2.1">^</mo></mover><mi id="alg2.l23.m1.3.4.2.3.3.3">t</mi></msup><mo stretchy="false" id="alg2.l23.m1.3.4.2.3.4">)</mo></mrow><mo stretchy="false" id="alg2.l23.m1.3.4.2.4">}</mo></mrow><mrow id="alg2.l23.m1.3.4.3"><mi id="alg2.l23.m1.3.4.3.2">k</mi><mo id="alg2.l23.m1.3.4.3.1">∈</mo><msup id="alg2.l23.m1.3.4.3.3"><mi class="ltx_font_mathcaligraphic" id="alg2.l23.m1.3.4.3.3.2">𝒞</mi><mi id="alg2.l23.m1.3.4.3.3.3">t</mi></msup></mrow></msub><mo id="alg2.l23.m1.3.5">,</mo><mi id="alg2.l23.m1.2.2">z</mi><mo id="alg2.l23.m1.3.6">,</mo><mi id="alg2.l23.m1.3.3">S</mi><mo maxsize="120%" minsize="120%" id="alg2.l23.m1.3.7">)</mo></mrow><annotation encoding="application/x-tex" id="alg2.l23.m1.3c">\{\textsc{UserUpdate}(k,\hat{W}^{t})\}_{k\in\mathcal{C}^{t}},z,S\big{)}</annotation></semantics></math>

</div>
<div id="alg2.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>  
</div>
<div id="alg2.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l25.2.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>  <span id="alg2.l25.1" class="ltx_text ltx_font_smallcaps" style="background-color:#FFBFBF;">SecureSumDP<math id="alg2.l25.1.1.m1.3" class="ltx_Math" alttext="(\{\Delta_{k}\}_{k\in\mathcal{C}^{{}^{\prime}}},z,S)" display="inline"><semantics id="alg2.l25.1.1.m1.3a"><mrow id="alg2.l25.1.1.m1.3.3.1" xref="alg2.l25.1.1.m1.3.3.2.cmml"><mo mathbackground="#FFBFBF" stretchy="false" id="alg2.l25.1.1.m1.3.3.1.2" xref="alg2.l25.1.1.m1.3.3.2.cmml">(</mo><msub id="alg2.l25.1.1.m1.3.3.1.1" xref="alg2.l25.1.1.m1.3.3.1.1.cmml"><mrow id="alg2.l25.1.1.m1.3.3.1.1.1.1" xref="alg2.l25.1.1.m1.3.3.1.1.1.2.cmml"><mo mathbackground="#FFBFBF" stretchy="false" id="alg2.l25.1.1.m1.3.3.1.1.1.1.2" xref="alg2.l25.1.1.m1.3.3.1.1.1.2.cmml">{</mo><msub id="alg2.l25.1.1.m1.3.3.1.1.1.1.1" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1.cmml"><mi mathbackground="#FFBFBF" mathvariant="normal" id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.2" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1.2.cmml">Δ</mi><mi mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.3" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1.3.cmml">k</mi></msub><mo mathbackground="#FFBFBF" stretchy="false" id="alg2.l25.1.1.m1.3.3.1.1.1.1.3" xref="alg2.l25.1.1.m1.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l25.1.1.m1.3.3.1.1.3" xref="alg2.l25.1.1.m1.3.3.1.1.3.cmml"><mi mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.1.3.2" xref="alg2.l25.1.1.m1.3.3.1.1.3.2.cmml">k</mi><mo mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.1.3.1" xref="alg2.l25.1.1.m1.3.3.1.1.3.1.cmml">∈</mo><msup id="alg2.l25.1.1.m1.3.3.1.1.3.3" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.1.3.3.2" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.2.cmml">𝒞</mi><msup id="alg2.l25.1.1.m1.3.3.1.1.3.3.3" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.3.cmml"><mi id="alg2.l25.1.1.m1.3.3.1.1.3.3.3a" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.3.cmml"></mi><mo mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.1.3.3.3.1" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.3.1.cmml">′</mo></msup></msup></mrow></msub><mo mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.3" xref="alg2.l25.1.1.m1.3.3.2.cmml">,</mo><mi mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.1.1" xref="alg2.l25.1.1.m1.1.1.cmml">z</mi><mo mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.3.3.1.4" xref="alg2.l25.1.1.m1.3.3.2.cmml">,</mo><mi mathbackground="#FFBFBF" id="alg2.l25.1.1.m1.2.2" xref="alg2.l25.1.1.m1.2.2.cmml">S</mi><mo mathbackground="#FFBFBF" stretchy="false" id="alg2.l25.1.1.m1.3.3.1.5" xref="alg2.l25.1.1.m1.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l25.1.1.m1.3b"><vector id="alg2.l25.1.1.m1.3.3.2.cmml" xref="alg2.l25.1.1.m1.3.3.1"><apply id="alg2.l25.1.1.m1.3.3.1.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg2.l25.1.1.m1.3.3.1.1.2.cmml" xref="alg2.l25.1.1.m1.3.3.1.1">subscript</csymbol><set id="alg2.l25.1.1.m1.3.3.1.1.1.2.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.1.1"><apply id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1.2">Δ</ci><ci id="alg2.l25.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg2.l25.1.1.m1.3.3.1.1.3.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3"><in id="alg2.l25.1.1.m1.3.3.1.1.3.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.1"></in><ci id="alg2.l25.1.1.m1.3.3.1.1.3.2.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.2">𝑘</ci><apply id="alg2.l25.1.1.m1.3.3.1.1.3.3.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l25.1.1.m1.3.3.1.1.3.3.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.3">superscript</csymbol><ci id="alg2.l25.1.1.m1.3.3.1.1.3.3.2.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.2">𝒞</ci><apply id="alg2.l25.1.1.m1.3.3.1.1.3.3.3.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.3"><ci id="alg2.l25.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="alg2.l25.1.1.m1.3.3.1.1.3.3.3.1">′</ci></apply></apply></apply></apply><ci id="alg2.l25.1.1.m1.1.1.cmml" xref="alg2.l25.1.1.m1.1.1">𝑧</ci><ci id="alg2.l25.1.1.m1.2.2.cmml" xref="alg2.l25.1.1.m1.2.2">𝑆</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.1.1.m1.3c">(\{\Delta_{k}\}_{k\in\mathcal{C}^{{}^{\prime}}},z,S)</annotation></semantics></math></span>

</div>
<div id="alg2.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>       <span id="alg2.l26.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg2.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span>           <math id="alg2.l27.m1.1" class="ltx_Math" alttext="\sigma=z\cdot S" display="inline"><semantics id="alg2.l27.m1.1a"><mrow id="alg2.l27.m1.1.1" xref="alg2.l27.m1.1.1.cmml"><mi id="alg2.l27.m1.1.1.2" xref="alg2.l27.m1.1.1.2.cmml">σ</mi><mo id="alg2.l27.m1.1.1.1" xref="alg2.l27.m1.1.1.1.cmml">=</mo><mrow id="alg2.l27.m1.1.1.3" xref="alg2.l27.m1.1.1.3.cmml"><mi id="alg2.l27.m1.1.1.3.2" xref="alg2.l27.m1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l27.m1.1.1.3.1" xref="alg2.l27.m1.1.1.3.1.cmml">⋅</mo><mi id="alg2.l27.m1.1.1.3.3" xref="alg2.l27.m1.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l27.m1.1b"><apply id="alg2.l27.m1.1.1.cmml" xref="alg2.l27.m1.1.1"><eq id="alg2.l27.m1.1.1.1.cmml" xref="alg2.l27.m1.1.1.1"></eq><ci id="alg2.l27.m1.1.1.2.cmml" xref="alg2.l27.m1.1.1.2">𝜎</ci><apply id="alg2.l27.m1.1.1.3.cmml" xref="alg2.l27.m1.1.1.3"><ci id="alg2.l27.m1.1.1.3.1.cmml" xref="alg2.l27.m1.1.1.3.1">⋅</ci><ci id="alg2.l27.m1.1.1.3.2.cmml" xref="alg2.l27.m1.1.1.3.2">𝑧</ci><ci id="alg2.l27.m1.1.1.3.3.cmml" xref="alg2.l27.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l27.m1.1c">\sigma=z\cdot S</annotation></semantics></math>

</div>
<div id="alg2.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span>       <span id="alg2.l28.2" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l28.m1.5" class="ltx_Math" alttext="\mathcal{N}(0,I\sigma^{2})+\sum_{k\in C^{{}^{\prime}}}\Delta_{k}\cdot\min\big{(}1,\frac{S}{\lVert\Delta_{k}\rVert_{2}}\big{)}" display="inline"><semantics id="alg2.l28.m1.5a"><mrow id="alg2.l28.m1.5.5" xref="alg2.l28.m1.5.5.cmml"><mrow id="alg2.l28.m1.5.5.1" xref="alg2.l28.m1.5.5.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l28.m1.5.5.1.3" xref="alg2.l28.m1.5.5.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg2.l28.m1.5.5.1.2" xref="alg2.l28.m1.5.5.1.2.cmml">​</mo><mrow id="alg2.l28.m1.5.5.1.1.1" xref="alg2.l28.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="alg2.l28.m1.5.5.1.1.1.2" xref="alg2.l28.m1.5.5.1.1.2.cmml">(</mo><mn id="alg2.l28.m1.2.2" xref="alg2.l28.m1.2.2.cmml">0</mn><mo id="alg2.l28.m1.5.5.1.1.1.3" xref="alg2.l28.m1.5.5.1.1.2.cmml">,</mo><mrow id="alg2.l28.m1.5.5.1.1.1.1" xref="alg2.l28.m1.5.5.1.1.1.1.cmml"><mi id="alg2.l28.m1.5.5.1.1.1.1.2" xref="alg2.l28.m1.5.5.1.1.1.1.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg2.l28.m1.5.5.1.1.1.1.1" xref="alg2.l28.m1.5.5.1.1.1.1.1.cmml">​</mo><msup id="alg2.l28.m1.5.5.1.1.1.1.3" xref="alg2.l28.m1.5.5.1.1.1.1.3.cmml"><mi id="alg2.l28.m1.5.5.1.1.1.1.3.2" xref="alg2.l28.m1.5.5.1.1.1.1.3.2.cmml">σ</mi><mn id="alg2.l28.m1.5.5.1.1.1.1.3.3" xref="alg2.l28.m1.5.5.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="alg2.l28.m1.5.5.1.1.1.4" xref="alg2.l28.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="alg2.l28.m1.5.5.2" xref="alg2.l28.m1.5.5.2.cmml">+</mo><mrow id="alg2.l28.m1.5.5.3" xref="alg2.l28.m1.5.5.3.cmml"><msub id="alg2.l28.m1.5.5.3.1" xref="alg2.l28.m1.5.5.3.1.cmml"><mo id="alg2.l28.m1.5.5.3.1.2" xref="alg2.l28.m1.5.5.3.1.2.cmml">∑</mo><mrow id="alg2.l28.m1.5.5.3.1.3" xref="alg2.l28.m1.5.5.3.1.3.cmml"><mi id="alg2.l28.m1.5.5.3.1.3.2" xref="alg2.l28.m1.5.5.3.1.3.2.cmml">k</mi><mo id="alg2.l28.m1.5.5.3.1.3.1" xref="alg2.l28.m1.5.5.3.1.3.1.cmml">∈</mo><msup id="alg2.l28.m1.5.5.3.1.3.3" xref="alg2.l28.m1.5.5.3.1.3.3.cmml"><mi id="alg2.l28.m1.5.5.3.1.3.3.2" xref="alg2.l28.m1.5.5.3.1.3.3.2.cmml">C</mi><msup id="alg2.l28.m1.5.5.3.1.3.3.3" xref="alg2.l28.m1.5.5.3.1.3.3.3.cmml"><mi id="alg2.l28.m1.5.5.3.1.3.3.3a" xref="alg2.l28.m1.5.5.3.1.3.3.3.cmml"></mi><mo id="alg2.l28.m1.5.5.3.1.3.3.3.1" xref="alg2.l28.m1.5.5.3.1.3.3.3.1.cmml">′</mo></msup></msup></mrow></msub><mrow id="alg2.l28.m1.5.5.3.2" xref="alg2.l28.m1.5.5.3.2.cmml"><msub id="alg2.l28.m1.5.5.3.2.2" xref="alg2.l28.m1.5.5.3.2.2.cmml"><mi mathvariant="normal" id="alg2.l28.m1.5.5.3.2.2.2" xref="alg2.l28.m1.5.5.3.2.2.2.cmml">Δ</mi><mi id="alg2.l28.m1.5.5.3.2.2.3" xref="alg2.l28.m1.5.5.3.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg2.l28.m1.5.5.3.2.1" xref="alg2.l28.m1.5.5.3.2.1.cmml">⋅</mo><mrow id="alg2.l28.m1.5.5.3.2.3.2" xref="alg2.l28.m1.5.5.3.2.3.1.cmml"><mi id="alg2.l28.m1.3.3" xref="alg2.l28.m1.3.3.cmml">min</mi><mo id="alg2.l28.m1.5.5.3.2.3.2a" xref="alg2.l28.m1.5.5.3.2.3.1.cmml">⁡</mo><mrow id="alg2.l28.m1.5.5.3.2.3.2.1" xref="alg2.l28.m1.5.5.3.2.3.1.cmml"><mo maxsize="120%" minsize="120%" id="alg2.l28.m1.5.5.3.2.3.2.1.1" xref="alg2.l28.m1.5.5.3.2.3.1.cmml">(</mo><mn id="alg2.l28.m1.4.4" xref="alg2.l28.m1.4.4.cmml">1</mn><mo id="alg2.l28.m1.5.5.3.2.3.2.1.2" xref="alg2.l28.m1.5.5.3.2.3.1.cmml">,</mo><mfrac id="alg2.l28.m1.1.1" xref="alg2.l28.m1.1.1.cmml"><mi id="alg2.l28.m1.1.1.3" xref="alg2.l28.m1.1.1.3.cmml">S</mi><msub id="alg2.l28.m1.1.1.1" xref="alg2.l28.m1.1.1.1.cmml"><mrow id="alg2.l28.m1.1.1.1.1.1" xref="alg2.l28.m1.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="alg2.l28.m1.1.1.1.1.1.2" xref="alg2.l28.m1.1.1.1.1.2.1.cmml">∥</mo><msub id="alg2.l28.m1.1.1.1.1.1.1" xref="alg2.l28.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg2.l28.m1.1.1.1.1.1.1.2" xref="alg2.l28.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="alg2.l28.m1.1.1.1.1.1.1.3" xref="alg2.l28.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="alg2.l28.m1.1.1.1.1.1.3" xref="alg2.l28.m1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="alg2.l28.m1.1.1.1.3" xref="alg2.l28.m1.1.1.1.3.cmml">2</mn></msub></mfrac><mo maxsize="120%" minsize="120%" id="alg2.l28.m1.5.5.3.2.3.2.1.3" xref="alg2.l28.m1.5.5.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l28.m1.5b"><apply id="alg2.l28.m1.5.5.cmml" xref="alg2.l28.m1.5.5"><plus id="alg2.l28.m1.5.5.2.cmml" xref="alg2.l28.m1.5.5.2"></plus><apply id="alg2.l28.m1.5.5.1.cmml" xref="alg2.l28.m1.5.5.1"><times id="alg2.l28.m1.5.5.1.2.cmml" xref="alg2.l28.m1.5.5.1.2"></times><ci id="alg2.l28.m1.5.5.1.3.cmml" xref="alg2.l28.m1.5.5.1.3">𝒩</ci><interval closure="open" id="alg2.l28.m1.5.5.1.1.2.cmml" xref="alg2.l28.m1.5.5.1.1.1"><cn type="integer" id="alg2.l28.m1.2.2.cmml" xref="alg2.l28.m1.2.2">0</cn><apply id="alg2.l28.m1.5.5.1.1.1.1.cmml" xref="alg2.l28.m1.5.5.1.1.1.1"><times id="alg2.l28.m1.5.5.1.1.1.1.1.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.1"></times><ci id="alg2.l28.m1.5.5.1.1.1.1.2.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.2">𝐼</ci><apply id="alg2.l28.m1.5.5.1.1.1.1.3.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l28.m1.5.5.1.1.1.1.3.1.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="alg2.l28.m1.5.5.1.1.1.1.3.2.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.3.2">𝜎</ci><cn type="integer" id="alg2.l28.m1.5.5.1.1.1.1.3.3.cmml" xref="alg2.l28.m1.5.5.1.1.1.1.3.3">2</cn></apply></apply></interval></apply><apply id="alg2.l28.m1.5.5.3.cmml" xref="alg2.l28.m1.5.5.3"><apply id="alg2.l28.m1.5.5.3.1.cmml" xref="alg2.l28.m1.5.5.3.1"><csymbol cd="ambiguous" id="alg2.l28.m1.5.5.3.1.1.cmml" xref="alg2.l28.m1.5.5.3.1">subscript</csymbol><sum id="alg2.l28.m1.5.5.3.1.2.cmml" xref="alg2.l28.m1.5.5.3.1.2"></sum><apply id="alg2.l28.m1.5.5.3.1.3.cmml" xref="alg2.l28.m1.5.5.3.1.3"><in id="alg2.l28.m1.5.5.3.1.3.1.cmml" xref="alg2.l28.m1.5.5.3.1.3.1"></in><ci id="alg2.l28.m1.5.5.3.1.3.2.cmml" xref="alg2.l28.m1.5.5.3.1.3.2">𝑘</ci><apply id="alg2.l28.m1.5.5.3.1.3.3.cmml" xref="alg2.l28.m1.5.5.3.1.3.3"><csymbol cd="ambiguous" id="alg2.l28.m1.5.5.3.1.3.3.1.cmml" xref="alg2.l28.m1.5.5.3.1.3.3">superscript</csymbol><ci id="alg2.l28.m1.5.5.3.1.3.3.2.cmml" xref="alg2.l28.m1.5.5.3.1.3.3.2">𝐶</ci><apply id="alg2.l28.m1.5.5.3.1.3.3.3.cmml" xref="alg2.l28.m1.5.5.3.1.3.3.3"><ci id="alg2.l28.m1.5.5.3.1.3.3.3.1.cmml" xref="alg2.l28.m1.5.5.3.1.3.3.3.1">′</ci></apply></apply></apply></apply><apply id="alg2.l28.m1.5.5.3.2.cmml" xref="alg2.l28.m1.5.5.3.2"><ci id="alg2.l28.m1.5.5.3.2.1.cmml" xref="alg2.l28.m1.5.5.3.2.1">⋅</ci><apply id="alg2.l28.m1.5.5.3.2.2.cmml" xref="alg2.l28.m1.5.5.3.2.2"><csymbol cd="ambiguous" id="alg2.l28.m1.5.5.3.2.2.1.cmml" xref="alg2.l28.m1.5.5.3.2.2">subscript</csymbol><ci id="alg2.l28.m1.5.5.3.2.2.2.cmml" xref="alg2.l28.m1.5.5.3.2.2.2">Δ</ci><ci id="alg2.l28.m1.5.5.3.2.2.3.cmml" xref="alg2.l28.m1.5.5.3.2.2.3">𝑘</ci></apply><apply id="alg2.l28.m1.5.5.3.2.3.1.cmml" xref="alg2.l28.m1.5.5.3.2.3.2"><min id="alg2.l28.m1.3.3.cmml" xref="alg2.l28.m1.3.3"></min><cn type="integer" id="alg2.l28.m1.4.4.cmml" xref="alg2.l28.m1.4.4">1</cn><apply id="alg2.l28.m1.1.1.cmml" xref="alg2.l28.m1.1.1"><divide id="alg2.l28.m1.1.1.2.cmml" xref="alg2.l28.m1.1.1"></divide><ci id="alg2.l28.m1.1.1.3.cmml" xref="alg2.l28.m1.1.1.3">𝑆</ci><apply id="alg2.l28.m1.1.1.1.cmml" xref="alg2.l28.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l28.m1.1.1.1.2.cmml" xref="alg2.l28.m1.1.1.1">subscript</csymbol><apply id="alg2.l28.m1.1.1.1.1.2.cmml" xref="alg2.l28.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l28.m1.1.1.1.1.2.1.cmml" xref="alg2.l28.m1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="alg2.l28.m1.1.1.1.1.1.1.cmml" xref="alg2.l28.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l28.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l28.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l28.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l28.m1.1.1.1.1.1.1.2">Δ</ci><ci id="alg2.l28.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l28.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="alg2.l28.m1.1.1.1.3.cmml" xref="alg2.l28.m1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l28.m1.5c">\mathcal{N}(0,I\sigma^{2})+\sum_{k\in C^{{}^{\prime}}}\Delta_{k}\cdot\min\big{(}1,\frac{S}{\lVert\Delta_{k}\rVert_{2}}\big{)}</annotation></semantics></math>

</div>
<div id="alg2.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span>  
</div>
<div id="alg2.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l30.2.1.1" class="ltx_text" style="font-size:80%;">30:</span></span>  <span id="alg2.l30.1" class="ltx_text ltx_font_smallcaps">UserUpdate<math id="alg2.l30.1.m1.1" class="ltx_Math" alttext="(\hat{W}^{{}^{\prime}})" display="inline"><semantics id="alg2.l30.1.m1.1a"><mrow id="alg2.l30.1.m1.1.1.1" xref="alg2.l30.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l30.1.m1.1.1.1.2" xref="alg2.l30.1.m1.1.1.1.1.cmml">(</mo><msup id="alg2.l30.1.m1.1.1.1.1" xref="alg2.l30.1.m1.1.1.1.1.cmml"><mover accent="true" id="alg2.l30.1.m1.1.1.1.1.2" xref="alg2.l30.1.m1.1.1.1.1.2.cmml"><mi id="alg2.l30.1.m1.1.1.1.1.2.2" xref="alg2.l30.1.m1.1.1.1.1.2.2.cmml">W</mi><mo id="alg2.l30.1.m1.1.1.1.1.2.1" xref="alg2.l30.1.m1.1.1.1.1.2.1.cmml">^</mo></mover><msup id="alg2.l30.1.m1.1.1.1.1.3" xref="alg2.l30.1.m1.1.1.1.1.3.cmml"><mi id="alg2.l30.1.m1.1.1.1.1.3a" xref="alg2.l30.1.m1.1.1.1.1.3.cmml"></mi><mo id="alg2.l30.1.m1.1.1.1.1.3.1" xref="alg2.l30.1.m1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="alg2.l30.1.m1.1.1.1.3" xref="alg2.l30.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l30.1.m1.1b"><apply id="alg2.l30.1.m1.1.1.1.1.cmml" xref="alg2.l30.1.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l30.1.m1.1.1.1.1.1.cmml" xref="alg2.l30.1.m1.1.1.1">superscript</csymbol><apply id="alg2.l30.1.m1.1.1.1.1.2.cmml" xref="alg2.l30.1.m1.1.1.1.1.2"><ci id="alg2.l30.1.m1.1.1.1.1.2.1.cmml" xref="alg2.l30.1.m1.1.1.1.1.2.1">^</ci><ci id="alg2.l30.1.m1.1.1.1.1.2.2.cmml" xref="alg2.l30.1.m1.1.1.1.1.2.2">𝑊</ci></apply><apply id="alg2.l30.1.m1.1.1.1.1.3.cmml" xref="alg2.l30.1.m1.1.1.1.1.3"><ci id="alg2.l30.1.m1.1.1.1.1.3.1.cmml" xref="alg2.l30.1.m1.1.1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l30.1.m1.1c">(\hat{W}^{{}^{\prime}})</annotation></semantics></math></span>

</div>
<div id="alg2.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l31.1.1.1" class="ltx_text" style="font-size:80%;">31:</span></span>       <span id="alg2.l31.2" class="ltx_text ltx_font_bold">parameters</span>

</div>
<div id="alg2.l32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l32.1.1.1" class="ltx_text" style="font-size:80%;">32:</span></span>           number of local epochs <math id="alg2.l32.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l32.m1.1a"><mi id="alg2.l32.m1.1.1" xref="alg2.l32.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l32.m1.1b"><ci id="alg2.l32.m1.1.1.cmml" xref="alg2.l32.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l32.m1.1c">E</annotation></semantics></math>

</div>
<div id="alg2.l33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l33.1.1.1" class="ltx_text" style="font-size:80%;">33:</span></span>           minibatch size <math id="alg2.l33.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l33.m1.1a"><mi id="alg2.l33.m1.1.1" xref="alg2.l33.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l33.m1.1b"><ci id="alg2.l33.m1.1.1.cmml" xref="alg2.l33.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l33.m1.1c">\beta</annotation></semantics></math>

</div>
<div id="alg2.l34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l34.1.1.1" class="ltx_text" style="font-size:80%;">34:</span></span>           learning rate <math id="alg2.l34.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg2.l34.m1.1a"><mi id="alg2.l34.m1.1.1" xref="alg2.l34.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg2.l34.m1.1b"><ci id="alg2.l34.m1.1.1.cmml" xref="alg2.l34.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l34.m1.1c">\eta</annotation></semantics></math>

</div>
<div id="alg2.l35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l35.1.1.1" class="ltx_text" style="font-size:80%;">35:</span></span>       <math id="alg2.l35.m1.1" class="ltx_Math" alttext="\hat{W}^{+}\leftarrow\hat{W}^{{}^{\prime}}" display="inline"><semantics id="alg2.l35.m1.1a"><mrow id="alg2.l35.m1.1.1" xref="alg2.l35.m1.1.1.cmml"><msup id="alg2.l35.m1.1.1.2" xref="alg2.l35.m1.1.1.2.cmml"><mover accent="true" id="alg2.l35.m1.1.1.2.2" xref="alg2.l35.m1.1.1.2.2.cmml"><mi id="alg2.l35.m1.1.1.2.2.2" xref="alg2.l35.m1.1.1.2.2.2.cmml">W</mi><mo id="alg2.l35.m1.1.1.2.2.1" xref="alg2.l35.m1.1.1.2.2.1.cmml">^</mo></mover><mo id="alg2.l35.m1.1.1.2.3" xref="alg2.l35.m1.1.1.2.3.cmml">+</mo></msup><mo stretchy="false" id="alg2.l35.m1.1.1.1" xref="alg2.l35.m1.1.1.1.cmml">←</mo><msup id="alg2.l35.m1.1.1.3" xref="alg2.l35.m1.1.1.3.cmml"><mover accent="true" id="alg2.l35.m1.1.1.3.2" xref="alg2.l35.m1.1.1.3.2.cmml"><mi id="alg2.l35.m1.1.1.3.2.2" xref="alg2.l35.m1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l35.m1.1.1.3.2.1" xref="alg2.l35.m1.1.1.3.2.1.cmml">^</mo></mover><msup id="alg2.l35.m1.1.1.3.3" xref="alg2.l35.m1.1.1.3.3.cmml"><mi id="alg2.l35.m1.1.1.3.3a" xref="alg2.l35.m1.1.1.3.3.cmml"></mi><mo id="alg2.l35.m1.1.1.3.3.1" xref="alg2.l35.m1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l35.m1.1b"><apply id="alg2.l35.m1.1.1.cmml" xref="alg2.l35.m1.1.1"><ci id="alg2.l35.m1.1.1.1.cmml" xref="alg2.l35.m1.1.1.1">←</ci><apply id="alg2.l35.m1.1.1.2.cmml" xref="alg2.l35.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.1.2.1.cmml" xref="alg2.l35.m1.1.1.2">superscript</csymbol><apply id="alg2.l35.m1.1.1.2.2.cmml" xref="alg2.l35.m1.1.1.2.2"><ci id="alg2.l35.m1.1.1.2.2.1.cmml" xref="alg2.l35.m1.1.1.2.2.1">^</ci><ci id="alg2.l35.m1.1.1.2.2.2.cmml" xref="alg2.l35.m1.1.1.2.2.2">𝑊</ci></apply><plus id="alg2.l35.m1.1.1.2.3.cmml" xref="alg2.l35.m1.1.1.2.3"></plus></apply><apply id="alg2.l35.m1.1.1.3.cmml" xref="alg2.l35.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l35.m1.1.1.3.1.cmml" xref="alg2.l35.m1.1.1.3">superscript</csymbol><apply id="alg2.l35.m1.1.1.3.2.cmml" xref="alg2.l35.m1.1.1.3.2"><ci id="alg2.l35.m1.1.1.3.2.1.cmml" xref="alg2.l35.m1.1.1.3.2.1">^</ci><ci id="alg2.l35.m1.1.1.3.2.2.cmml" xref="alg2.l35.m1.1.1.3.2.2">𝑊</ci></apply><apply id="alg2.l35.m1.1.1.3.3.cmml" xref="alg2.l35.m1.1.1.3.3"><ci id="alg2.l35.m1.1.1.3.3.1.cmml" xref="alg2.l35.m1.1.1.3.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l35.m1.1c">\hat{W}^{+}\leftarrow\hat{W}^{{}^{\prime}}</annotation></semantics></math>

</div>
<div id="alg2.l36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l36.1.1.1" class="ltx_text" style="font-size:80%;">36:</span></span>       <span id="alg2.l36.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg2.l36.m1.3" class="ltx_Math" alttext="e=1,2,\ldots E" display="inline"><semantics id="alg2.l36.m1.3a"><mrow id="alg2.l36.m1.3.3" xref="alg2.l36.m1.3.3.cmml"><mi id="alg2.l36.m1.3.3.3" xref="alg2.l36.m1.3.3.3.cmml">e</mi><mo id="alg2.l36.m1.3.3.2" xref="alg2.l36.m1.3.3.2.cmml">=</mo><mrow id="alg2.l36.m1.3.3.1.1" xref="alg2.l36.m1.3.3.1.2.cmml"><mn id="alg2.l36.m1.1.1" xref="alg2.l36.m1.1.1.cmml">1</mn><mo id="alg2.l36.m1.3.3.1.1.2" xref="alg2.l36.m1.3.3.1.2.cmml">,</mo><mn id="alg2.l36.m1.2.2" xref="alg2.l36.m1.2.2.cmml">2</mn><mo id="alg2.l36.m1.3.3.1.1.3" xref="alg2.l36.m1.3.3.1.2.cmml">,</mo><mrow id="alg2.l36.m1.3.3.1.1.1" xref="alg2.l36.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="alg2.l36.m1.3.3.1.1.1.2" xref="alg2.l36.m1.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l36.m1.3.3.1.1.1.1" xref="alg2.l36.m1.3.3.1.1.1.1.cmml">​</mo><mi id="alg2.l36.m1.3.3.1.1.1.3" xref="alg2.l36.m1.3.3.1.1.1.3.cmml">E</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l36.m1.3b"><apply id="alg2.l36.m1.3.3.cmml" xref="alg2.l36.m1.3.3"><eq id="alg2.l36.m1.3.3.2.cmml" xref="alg2.l36.m1.3.3.2"></eq><ci id="alg2.l36.m1.3.3.3.cmml" xref="alg2.l36.m1.3.3.3">𝑒</ci><list id="alg2.l36.m1.3.3.1.2.cmml" xref="alg2.l36.m1.3.3.1.1"><cn type="integer" id="alg2.l36.m1.1.1.cmml" xref="alg2.l36.m1.1.1">1</cn><cn type="integer" id="alg2.l36.m1.2.2.cmml" xref="alg2.l36.m1.2.2">2</cn><apply id="alg2.l36.m1.3.3.1.1.1.cmml" xref="alg2.l36.m1.3.3.1.1.1"><times id="alg2.l36.m1.3.3.1.1.1.1.cmml" xref="alg2.l36.m1.3.3.1.1.1.1"></times><ci id="alg2.l36.m1.3.3.1.1.1.2.cmml" xref="alg2.l36.m1.3.3.1.1.1.2">…</ci><ci id="alg2.l36.m1.3.3.1.1.1.3.cmml" xref="alg2.l36.m1.3.3.1.1.1.3">𝐸</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l36.m1.3c">e=1,2,\ldots E</annotation></semantics></math> <span id="alg2.l36.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l37.1.1.1" class="ltx_text" style="font-size:80%;">37:</span></span>           <math id="alg2.l37.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow" display="inline"><semantics id="alg2.l37.m1.1a"><mrow id="alg2.l37.m1.1.1" xref="alg2.l37.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l37.m1.1.1.2" xref="alg2.l37.m1.1.1.2.cmml">ℬ</mi><mo stretchy="false" id="alg2.l37.m1.1.1.1" xref="alg2.l37.m1.1.1.1.cmml">←</mo><mi id="alg2.l37.m1.1.1.3" xref="alg2.l37.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l37.m1.1b"><apply id="alg2.l37.m1.1.1.cmml" xref="alg2.l37.m1.1.1"><ci id="alg2.l37.m1.1.1.1.cmml" xref="alg2.l37.m1.1.1.1">←</ci><ci id="alg2.l37.m1.1.1.2.cmml" xref="alg2.l37.m1.1.1.2">ℬ</ci><csymbol cd="latexml" id="alg2.l37.m1.1.1.3.cmml" xref="alg2.l37.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l37.m1.1c">\mathcal{B}\leftarrow</annotation></semantics></math> (split local data into batches of size <math id="alg2.l37.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l37.m2.1a"><mi id="alg2.l37.m2.1.1" xref="alg2.l37.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l37.m2.1b"><ci id="alg2.l37.m2.1.1.cmml" xref="alg2.l37.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l37.m2.1c">\beta</annotation></semantics></math>)

</div>
<div id="alg2.l38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l38.1.1.1" class="ltx_text" style="font-size:80%;">38:</span></span>           <span id="alg2.l38.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg2.l38.m1.1" class="ltx_Math" alttext="b\in\mathcal{B}" display="inline"><semantics id="alg2.l38.m1.1a"><mrow id="alg2.l38.m1.1.1" xref="alg2.l38.m1.1.1.cmml"><mi id="alg2.l38.m1.1.1.2" xref="alg2.l38.m1.1.1.2.cmml">b</mi><mo id="alg2.l38.m1.1.1.1" xref="alg2.l38.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l38.m1.1.1.3" xref="alg2.l38.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l38.m1.1b"><apply id="alg2.l38.m1.1.1.cmml" xref="alg2.l38.m1.1.1"><in id="alg2.l38.m1.1.1.1.cmml" xref="alg2.l38.m1.1.1.1"></in><ci id="alg2.l38.m1.1.1.2.cmml" xref="alg2.l38.m1.1.1.2">𝑏</ci><ci id="alg2.l38.m1.1.1.3.cmml" xref="alg2.l38.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l38.m1.1c">b\in\mathcal{B}</annotation></semantics></math> <span id="alg2.l38.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l39.1.1.1" class="ltx_text" style="font-size:80%;">39:</span></span>               <math id="alg2.l39.m1.1" class="ltx_Math" alttext="\hat{W}^{+}\leftarrow\hat{W}^{+}-\eta\triangledown\ell(\hat{W}^{+})" display="inline"><semantics id="alg2.l39.m1.1a"><mrow id="alg2.l39.m1.1.1" xref="alg2.l39.m1.1.1.cmml"><msup id="alg2.l39.m1.1.1.3" xref="alg2.l39.m1.1.1.3.cmml"><mover accent="true" id="alg2.l39.m1.1.1.3.2" xref="alg2.l39.m1.1.1.3.2.cmml"><mi id="alg2.l39.m1.1.1.3.2.2" xref="alg2.l39.m1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l39.m1.1.1.3.2.1" xref="alg2.l39.m1.1.1.3.2.1.cmml">^</mo></mover><mo id="alg2.l39.m1.1.1.3.3" xref="alg2.l39.m1.1.1.3.3.cmml">+</mo></msup><mo stretchy="false" id="alg2.l39.m1.1.1.2" xref="alg2.l39.m1.1.1.2.cmml">←</mo><mrow id="alg2.l39.m1.1.1.1" xref="alg2.l39.m1.1.1.1.cmml"><msup id="alg2.l39.m1.1.1.1.3" xref="alg2.l39.m1.1.1.1.3.cmml"><mover accent="true" id="alg2.l39.m1.1.1.1.3.2" xref="alg2.l39.m1.1.1.1.3.2.cmml"><mi id="alg2.l39.m1.1.1.1.3.2.2" xref="alg2.l39.m1.1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l39.m1.1.1.1.3.2.1" xref="alg2.l39.m1.1.1.1.3.2.1.cmml">^</mo></mover><mo id="alg2.l39.m1.1.1.1.3.3" xref="alg2.l39.m1.1.1.1.3.3.cmml">+</mo></msup><mo id="alg2.l39.m1.1.1.1.2" xref="alg2.l39.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l39.m1.1.1.1.1" xref="alg2.l39.m1.1.1.1.1.cmml"><mi id="alg2.l39.m1.1.1.1.1.3" xref="alg2.l39.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg2.l39.m1.1.1.1.1.2" xref="alg2.l39.m1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg2.l39.m1.1.1.1.1.4" xref="alg2.l39.m1.1.1.1.1.4.cmml">▽</mi><mo lspace="0em" rspace="0em" id="alg2.l39.m1.1.1.1.1.2a" xref="alg2.l39.m1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg2.l39.m1.1.1.1.1.5" xref="alg2.l39.m1.1.1.1.1.5.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg2.l39.m1.1.1.1.1.2b" xref="alg2.l39.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l39.m1.1.1.1.1.1.1" xref="alg2.l39.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l39.m1.1.1.1.1.1.1.2" xref="alg2.l39.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l39.m1.1.1.1.1.1.1.1" xref="alg2.l39.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l39.m1.1.1.1.1.1.1.1.2" xref="alg2.l39.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l39.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l39.m1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mo id="alg2.l39.m1.1.1.1.1.1.1.1.2.1" xref="alg2.l39.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="alg2.l39.m1.1.1.1.1.1.1.1.3" xref="alg2.l39.m1.1.1.1.1.1.1.1.3.cmml">+</mo></msup><mo stretchy="false" id="alg2.l39.m1.1.1.1.1.1.1.3" xref="alg2.l39.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l39.m1.1b"><apply id="alg2.l39.m1.1.1.cmml" xref="alg2.l39.m1.1.1"><ci id="alg2.l39.m1.1.1.2.cmml" xref="alg2.l39.m1.1.1.2">←</ci><apply id="alg2.l39.m1.1.1.3.cmml" xref="alg2.l39.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l39.m1.1.1.3.1.cmml" xref="alg2.l39.m1.1.1.3">superscript</csymbol><apply id="alg2.l39.m1.1.1.3.2.cmml" xref="alg2.l39.m1.1.1.3.2"><ci id="alg2.l39.m1.1.1.3.2.1.cmml" xref="alg2.l39.m1.1.1.3.2.1">^</ci><ci id="alg2.l39.m1.1.1.3.2.2.cmml" xref="alg2.l39.m1.1.1.3.2.2">𝑊</ci></apply><plus id="alg2.l39.m1.1.1.3.3.cmml" xref="alg2.l39.m1.1.1.3.3"></plus></apply><apply id="alg2.l39.m1.1.1.1.cmml" xref="alg2.l39.m1.1.1.1"><minus id="alg2.l39.m1.1.1.1.2.cmml" xref="alg2.l39.m1.1.1.1.2"></minus><apply id="alg2.l39.m1.1.1.1.3.cmml" xref="alg2.l39.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l39.m1.1.1.1.3.1.cmml" xref="alg2.l39.m1.1.1.1.3">superscript</csymbol><apply id="alg2.l39.m1.1.1.1.3.2.cmml" xref="alg2.l39.m1.1.1.1.3.2"><ci id="alg2.l39.m1.1.1.1.3.2.1.cmml" xref="alg2.l39.m1.1.1.1.3.2.1">^</ci><ci id="alg2.l39.m1.1.1.1.3.2.2.cmml" xref="alg2.l39.m1.1.1.1.3.2.2">𝑊</ci></apply><plus id="alg2.l39.m1.1.1.1.3.3.cmml" xref="alg2.l39.m1.1.1.1.3.3"></plus></apply><apply id="alg2.l39.m1.1.1.1.1.cmml" xref="alg2.l39.m1.1.1.1.1"><times id="alg2.l39.m1.1.1.1.1.2.cmml" xref="alg2.l39.m1.1.1.1.1.2"></times><ci id="alg2.l39.m1.1.1.1.1.3.cmml" xref="alg2.l39.m1.1.1.1.1.3">𝜂</ci><ci id="alg2.l39.m1.1.1.1.1.4.cmml" xref="alg2.l39.m1.1.1.1.1.4">▽</ci><ci id="alg2.l39.m1.1.1.1.1.5.cmml" xref="alg2.l39.m1.1.1.1.1.5">ℓ</ci><apply id="alg2.l39.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l39.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l39.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l39.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l39.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l39.m1.1.1.1.1.1.1.1.2"><ci id="alg2.l39.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l39.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l39.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l39.m1.1.1.1.1.1.1.1.2.2">𝑊</ci></apply><plus id="alg2.l39.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l39.m1.1.1.1.1.1.1.1.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l39.m1.1c">\hat{W}^{+}\leftarrow\hat{W}^{+}-\eta\triangledown\ell(\hat{W}^{+})</annotation></semantics></math>

</div>
<div id="alg2.l40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l40.1.1.1" class="ltx_text" style="font-size:80%;">40:</span></span>       <span id="alg2.l40.2" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l40.m1.1" class="ltx_Math" alttext="\hat{W}^{+}-\hat{W}^{{}^{\prime}}" display="inline"><semantics id="alg2.l40.m1.1a"><mrow id="alg2.l40.m1.1.1" xref="alg2.l40.m1.1.1.cmml"><msup id="alg2.l40.m1.1.1.2" xref="alg2.l40.m1.1.1.2.cmml"><mover accent="true" id="alg2.l40.m1.1.1.2.2" xref="alg2.l40.m1.1.1.2.2.cmml"><mi id="alg2.l40.m1.1.1.2.2.2" xref="alg2.l40.m1.1.1.2.2.2.cmml">W</mi><mo id="alg2.l40.m1.1.1.2.2.1" xref="alg2.l40.m1.1.1.2.2.1.cmml">^</mo></mover><mo id="alg2.l40.m1.1.1.2.3" xref="alg2.l40.m1.1.1.2.3.cmml">+</mo></msup><mo id="alg2.l40.m1.1.1.1" xref="alg2.l40.m1.1.1.1.cmml">−</mo><msup id="alg2.l40.m1.1.1.3" xref="alg2.l40.m1.1.1.3.cmml"><mover accent="true" id="alg2.l40.m1.1.1.3.2" xref="alg2.l40.m1.1.1.3.2.cmml"><mi id="alg2.l40.m1.1.1.3.2.2" xref="alg2.l40.m1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l40.m1.1.1.3.2.1" xref="alg2.l40.m1.1.1.3.2.1.cmml">^</mo></mover><msup id="alg2.l40.m1.1.1.3.3" xref="alg2.l40.m1.1.1.3.3.cmml"><mi id="alg2.l40.m1.1.1.3.3a" xref="alg2.l40.m1.1.1.3.3.cmml"></mi><mo id="alg2.l40.m1.1.1.3.3.1" xref="alg2.l40.m1.1.1.3.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l40.m1.1b"><apply id="alg2.l40.m1.1.1.cmml" xref="alg2.l40.m1.1.1"><minus id="alg2.l40.m1.1.1.1.cmml" xref="alg2.l40.m1.1.1.1"></minus><apply id="alg2.l40.m1.1.1.2.cmml" xref="alg2.l40.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l40.m1.1.1.2.1.cmml" xref="alg2.l40.m1.1.1.2">superscript</csymbol><apply id="alg2.l40.m1.1.1.2.2.cmml" xref="alg2.l40.m1.1.1.2.2"><ci id="alg2.l40.m1.1.1.2.2.1.cmml" xref="alg2.l40.m1.1.1.2.2.1">^</ci><ci id="alg2.l40.m1.1.1.2.2.2.cmml" xref="alg2.l40.m1.1.1.2.2.2">𝑊</ci></apply><plus id="alg2.l40.m1.1.1.2.3.cmml" xref="alg2.l40.m1.1.1.2.3"></plus></apply><apply id="alg2.l40.m1.1.1.3.cmml" xref="alg2.l40.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l40.m1.1.1.3.1.cmml" xref="alg2.l40.m1.1.1.3">superscript</csymbol><apply id="alg2.l40.m1.1.1.3.2.cmml" xref="alg2.l40.m1.1.1.3.2"><ci id="alg2.l40.m1.1.1.3.2.1.cmml" xref="alg2.l40.m1.1.1.3.2.1">^</ci><ci id="alg2.l40.m1.1.1.3.2.2.cmml" xref="alg2.l40.m1.1.1.3.2.2">𝑊</ci></apply><apply id="alg2.l40.m1.1.1.3.3.cmml" xref="alg2.l40.m1.1.1.3.3"><ci id="alg2.l40.m1.1.1.3.3.1.cmml" xref="alg2.l40.m1.1.1.3.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l40.m1.1c">\hat{W}^{+}-\hat{W}^{{}^{\prime}}</annotation></semantics></math>

</div>
</div>
</figure>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2405.06368/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="269" height="268" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The optimal rank values of DP-DyLoRA for the last communication round as opposed to that of DyLoRA under non-private federated learning.</figcaption>
</figure>
<div id="S4.SS6.p5" class="ltx_para">
<p id="S4.SS6.p5.8" class="ltx_p">At each communication round, only the <math id="S4.SS6.p5.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS6.p5.1.m1.1a"><mi id="S4.SS6.p5.1.m1.1.1" xref="S4.SS6.p5.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.1.m1.1b"><ci id="S4.SS6.p5.1.m1.1.1.cmml" xref="S4.SS6.p5.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.1.m1.1c">b</annotation></semantics></math>-truncated up-projection <math id="S4.SS6.p5.2.m2.1" class="ltx_Math" alttext="B_{b}" display="inline"><semantics id="S4.SS6.p5.2.m2.1a"><msub id="S4.SS6.p5.2.m2.1.1" xref="S4.SS6.p5.2.m2.1.1.cmml"><mi id="S4.SS6.p5.2.m2.1.1.2" xref="S4.SS6.p5.2.m2.1.1.2.cmml">B</mi><mi id="S4.SS6.p5.2.m2.1.1.3" xref="S4.SS6.p5.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.2.m2.1b"><apply id="S4.SS6.p5.2.m2.1.1.cmml" xref="S4.SS6.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p5.2.m2.1.1.1.cmml" xref="S4.SS6.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p5.2.m2.1.1.2.cmml" xref="S4.SS6.p5.2.m2.1.1.2">𝐵</ci><ci id="S4.SS6.p5.2.m2.1.1.3.cmml" xref="S4.SS6.p5.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.2.m2.1c">B_{b}</annotation></semantics></math> and down-projection <math id="S4.SS6.p5.3.m3.1" class="ltx_Math" alttext="A_{b}" display="inline"><semantics id="S4.SS6.p5.3.m3.1a"><msub id="S4.SS6.p5.3.m3.1.1" xref="S4.SS6.p5.3.m3.1.1.cmml"><mi id="S4.SS6.p5.3.m3.1.1.2" xref="S4.SS6.p5.3.m3.1.1.2.cmml">A</mi><mi id="S4.SS6.p5.3.m3.1.1.3" xref="S4.SS6.p5.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.3.m3.1b"><apply id="S4.SS6.p5.3.m3.1.1.cmml" xref="S4.SS6.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p5.3.m3.1.1.1.cmml" xref="S4.SS6.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p5.3.m3.1.1.2.cmml" xref="S4.SS6.p5.3.m3.1.1.2">𝐴</ci><ci id="S4.SS6.p5.3.m3.1.1.3.cmml" xref="S4.SS6.p5.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.3.m3.1c">A_{b}</annotation></semantics></math> are updated. This means that parameters of lower ranks are updated more often than those of higher ranks. For example, since <math id="S4.SS6.p5.4.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS6.p5.4.m4.1a"><mi id="S4.SS6.p5.4.m4.1.1" xref="S4.SS6.p5.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.4.m4.1b"><ci id="S4.SS6.p5.4.m4.1.1.cmml" xref="S4.SS6.p5.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.4.m4.1c">b</annotation></semantics></math> is sampled uniformly at random from <math id="S4.SS6.p5.5.m5.4" class="ltx_Math" alttext="\{r_{min},r_{min}+1,\ldots,r_{max}\}" display="inline"><semantics id="S4.SS6.p5.5.m5.4a"><mrow id="S4.SS6.p5.5.m5.4.4.3" xref="S4.SS6.p5.5.m5.4.4.4.cmml"><mo stretchy="false" id="S4.SS6.p5.5.m5.4.4.3.4" xref="S4.SS6.p5.5.m5.4.4.4.cmml">{</mo><msub id="S4.SS6.p5.5.m5.2.2.1.1" xref="S4.SS6.p5.5.m5.2.2.1.1.cmml"><mi id="S4.SS6.p5.5.m5.2.2.1.1.2" xref="S4.SS6.p5.5.m5.2.2.1.1.2.cmml">r</mi><mrow id="S4.SS6.p5.5.m5.2.2.1.1.3" xref="S4.SS6.p5.5.m5.2.2.1.1.3.cmml"><mi id="S4.SS6.p5.5.m5.2.2.1.1.3.2" xref="S4.SS6.p5.5.m5.2.2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.2.2.1.1.3.1" xref="S4.SS6.p5.5.m5.2.2.1.1.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.2.2.1.1.3.3" xref="S4.SS6.p5.5.m5.2.2.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.2.2.1.1.3.1a" xref="S4.SS6.p5.5.m5.2.2.1.1.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.2.2.1.1.3.4" xref="S4.SS6.p5.5.m5.2.2.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS6.p5.5.m5.4.4.3.5" xref="S4.SS6.p5.5.m5.4.4.4.cmml">,</mo><mrow id="S4.SS6.p5.5.m5.3.3.2.2" xref="S4.SS6.p5.5.m5.3.3.2.2.cmml"><msub id="S4.SS6.p5.5.m5.3.3.2.2.2" xref="S4.SS6.p5.5.m5.3.3.2.2.2.cmml"><mi id="S4.SS6.p5.5.m5.3.3.2.2.2.2" xref="S4.SS6.p5.5.m5.3.3.2.2.2.2.cmml">r</mi><mrow id="S4.SS6.p5.5.m5.3.3.2.2.2.3" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.cmml"><mi id="S4.SS6.p5.5.m5.3.3.2.2.2.3.2" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.3.3.2.2.2.3.1" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.3.3.2.2.2.3.3" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.3.3.2.2.2.3.1a" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.3.3.2.2.2.3.4" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS6.p5.5.m5.3.3.2.2.1" xref="S4.SS6.p5.5.m5.3.3.2.2.1.cmml">+</mo><mn id="S4.SS6.p5.5.m5.3.3.2.2.3" xref="S4.SS6.p5.5.m5.3.3.2.2.3.cmml">1</mn></mrow><mo id="S4.SS6.p5.5.m5.4.4.3.6" xref="S4.SS6.p5.5.m5.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS6.p5.5.m5.1.1" xref="S4.SS6.p5.5.m5.1.1.cmml">…</mi><mo id="S4.SS6.p5.5.m5.4.4.3.7" xref="S4.SS6.p5.5.m5.4.4.4.cmml">,</mo><msub id="S4.SS6.p5.5.m5.4.4.3.3" xref="S4.SS6.p5.5.m5.4.4.3.3.cmml"><mi id="S4.SS6.p5.5.m5.4.4.3.3.2" xref="S4.SS6.p5.5.m5.4.4.3.3.2.cmml">r</mi><mrow id="S4.SS6.p5.5.m5.4.4.3.3.3" xref="S4.SS6.p5.5.m5.4.4.3.3.3.cmml"><mi id="S4.SS6.p5.5.m5.4.4.3.3.3.2" xref="S4.SS6.p5.5.m5.4.4.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.4.4.3.3.3.1" xref="S4.SS6.p5.5.m5.4.4.3.3.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.4.4.3.3.3.3" xref="S4.SS6.p5.5.m5.4.4.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.5.m5.4.4.3.3.3.1a" xref="S4.SS6.p5.5.m5.4.4.3.3.3.1.cmml">​</mo><mi id="S4.SS6.p5.5.m5.4.4.3.3.3.4" xref="S4.SS6.p5.5.m5.4.4.3.3.3.4.cmml">x</mi></mrow></msub><mo stretchy="false" id="S4.SS6.p5.5.m5.4.4.3.8" xref="S4.SS6.p5.5.m5.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.5.m5.4b"><set id="S4.SS6.p5.5.m5.4.4.4.cmml" xref="S4.SS6.p5.5.m5.4.4.3"><apply id="S4.SS6.p5.5.m5.2.2.1.1.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p5.5.m5.2.2.1.1.1.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1">subscript</csymbol><ci id="S4.SS6.p5.5.m5.2.2.1.1.2.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.2">𝑟</ci><apply id="S4.SS6.p5.5.m5.2.2.1.1.3.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.3"><times id="S4.SS6.p5.5.m5.2.2.1.1.3.1.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.3.1"></times><ci id="S4.SS6.p5.5.m5.2.2.1.1.3.2.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.3.2">𝑚</ci><ci id="S4.SS6.p5.5.m5.2.2.1.1.3.3.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.3.3">𝑖</ci><ci id="S4.SS6.p5.5.m5.2.2.1.1.3.4.cmml" xref="S4.SS6.p5.5.m5.2.2.1.1.3.4">𝑛</ci></apply></apply><apply id="S4.SS6.p5.5.m5.3.3.2.2.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2"><plus id="S4.SS6.p5.5.m5.3.3.2.2.1.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.1"></plus><apply id="S4.SS6.p5.5.m5.3.3.2.2.2.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS6.p5.5.m5.3.3.2.2.2.1.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S4.SS6.p5.5.m5.3.3.2.2.2.2.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.2">𝑟</ci><apply id="S4.SS6.p5.5.m5.3.3.2.2.2.3.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3"><times id="S4.SS6.p5.5.m5.3.3.2.2.2.3.1.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.1"></times><ci id="S4.SS6.p5.5.m5.3.3.2.2.2.3.2.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.2">𝑚</ci><ci id="S4.SS6.p5.5.m5.3.3.2.2.2.3.3.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.3">𝑖</ci><ci id="S4.SS6.p5.5.m5.3.3.2.2.2.3.4.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.2.3.4">𝑛</ci></apply></apply><cn type="integer" id="S4.SS6.p5.5.m5.3.3.2.2.3.cmml" xref="S4.SS6.p5.5.m5.3.3.2.2.3">1</cn></apply><ci id="S4.SS6.p5.5.m5.1.1.cmml" xref="S4.SS6.p5.5.m5.1.1">…</ci><apply id="S4.SS6.p5.5.m5.4.4.3.3.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS6.p5.5.m5.4.4.3.3.1.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3">subscript</csymbol><ci id="S4.SS6.p5.5.m5.4.4.3.3.2.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.2">𝑟</ci><apply id="S4.SS6.p5.5.m5.4.4.3.3.3.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.3"><times id="S4.SS6.p5.5.m5.4.4.3.3.3.1.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.3.1"></times><ci id="S4.SS6.p5.5.m5.4.4.3.3.3.2.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.3.2">𝑚</ci><ci id="S4.SS6.p5.5.m5.4.4.3.3.3.3.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.3.3">𝑎</ci><ci id="S4.SS6.p5.5.m5.4.4.3.3.3.4.cmml" xref="S4.SS6.p5.5.m5.4.4.3.3.3.4">𝑥</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.5.m5.4c">\{r_{min},r_{min}+1,\ldots,r_{max}\}</annotation></semantics></math>, parameters of <math id="S4.SS6.p5.6.m6.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="S4.SS6.p5.6.m6.1a"><msub id="S4.SS6.p5.6.m6.1.1" xref="S4.SS6.p5.6.m6.1.1.cmml"><mi id="S4.SS6.p5.6.m6.1.1.2" xref="S4.SS6.p5.6.m6.1.1.2.cmml">r</mi><mrow id="S4.SS6.p5.6.m6.1.1.3" xref="S4.SS6.p5.6.m6.1.1.3.cmml"><mi id="S4.SS6.p5.6.m6.1.1.3.2" xref="S4.SS6.p5.6.m6.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.6.m6.1.1.3.1" xref="S4.SS6.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS6.p5.6.m6.1.1.3.3" xref="S4.SS6.p5.6.m6.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p5.6.m6.1.1.3.1a" xref="S4.SS6.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS6.p5.6.m6.1.1.3.4" xref="S4.SS6.p5.6.m6.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.6.m6.1b"><apply id="S4.SS6.p5.6.m6.1.1.cmml" xref="S4.SS6.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS6.p5.6.m6.1.1.1.cmml" xref="S4.SS6.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS6.p5.6.m6.1.1.2.cmml" xref="S4.SS6.p5.6.m6.1.1.2">𝑟</ci><apply id="S4.SS6.p5.6.m6.1.1.3.cmml" xref="S4.SS6.p5.6.m6.1.1.3"><times id="S4.SS6.p5.6.m6.1.1.3.1.cmml" xref="S4.SS6.p5.6.m6.1.1.3.1"></times><ci id="S4.SS6.p5.6.m6.1.1.3.2.cmml" xref="S4.SS6.p5.6.m6.1.1.3.2">𝑚</ci><ci id="S4.SS6.p5.6.m6.1.1.3.3.cmml" xref="S4.SS6.p5.6.m6.1.1.3.3">𝑖</ci><ci id="S4.SS6.p5.6.m6.1.1.3.4.cmml" xref="S4.SS6.p5.6.m6.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.6.m6.1c">r_{min}</annotation></semantics></math> are always updated. As we can see from Figure <a href="#S4.F2" title="Figure 2 ‣ IV-F DP-DyLoRA ‣ IV Parameter-Efficient Fine-tuning with Differential Privacy ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the best rank values tend to increase when differential privacy is applied. On the six chosen datasets, the best rank values under non-private FL are smaller on five and equal on one compared to DP-FL. This aligns with results from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for DP-SGD in which the optimal rank for DP-LoRA (<math id="S4.SS6.p5.7.m7.1" class="ltx_Math" alttext="r=16" display="inline"><semantics id="S4.SS6.p5.7.m7.1a"><mrow id="S4.SS6.p5.7.m7.1.1" xref="S4.SS6.p5.7.m7.1.1.cmml"><mi id="S4.SS6.p5.7.m7.1.1.2" xref="S4.SS6.p5.7.m7.1.1.2.cmml">r</mi><mo id="S4.SS6.p5.7.m7.1.1.1" xref="S4.SS6.p5.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS6.p5.7.m7.1.1.3" xref="S4.SS6.p5.7.m7.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.7.m7.1b"><apply id="S4.SS6.p5.7.m7.1.1.cmml" xref="S4.SS6.p5.7.m7.1.1"><eq id="S4.SS6.p5.7.m7.1.1.1.cmml" xref="S4.SS6.p5.7.m7.1.1.1"></eq><ci id="S4.SS6.p5.7.m7.1.1.2.cmml" xref="S4.SS6.p5.7.m7.1.1.2">𝑟</ci><cn type="integer" id="S4.SS6.p5.7.m7.1.1.3.cmml" xref="S4.SS6.p5.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.7.m7.1c">r=16</annotation></semantics></math>) is higher than that of non-private LoRA (<math id="S4.SS6.p5.8.m8.1" class="ltx_Math" alttext="r=4" display="inline"><semantics id="S4.SS6.p5.8.m8.1a"><mrow id="S4.SS6.p5.8.m8.1.1" xref="S4.SS6.p5.8.m8.1.1.cmml"><mi id="S4.SS6.p5.8.m8.1.1.2" xref="S4.SS6.p5.8.m8.1.1.2.cmml">r</mi><mo id="S4.SS6.p5.8.m8.1.1.1" xref="S4.SS6.p5.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS6.p5.8.m8.1.1.3" xref="S4.SS6.p5.8.m8.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p5.8.m8.1b"><apply id="S4.SS6.p5.8.m8.1.1.cmml" xref="S4.SS6.p5.8.m8.1.1"><eq id="S4.SS6.p5.8.m8.1.1.1.cmml" xref="S4.SS6.p5.8.m8.1.1.1"></eq><ci id="S4.SS6.p5.8.m8.1.1.2.cmml" xref="S4.SS6.p5.8.m8.1.1.2">𝑟</ci><cn type="integer" id="S4.SS6.p5.8.m8.1.1.3.cmml" xref="S4.SS6.p5.8.m8.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p5.8.m8.1c">r=4</annotation></semantics></math>).</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experimental Setup</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we present a comprehensive description of our experimental setup. This includes the details of the datasets and models used in our experiments as well as baseline and novel methods implemented.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Datasets and Tasks</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We set up our experiments to ensure that our results will be applicable to a wide range of domains and tasks. As shown in Table <a href="#S5.T2" title="TABLE II ‣ V-A Datasets and Tasks ‣ V Experimental Setup ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, six different datasets are used in our experiments covering various tasks in Artificial Intelligence (AI) domains including computer vision, natural language understanding and speech, which are briefly described below:</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Details of the datasets used in our experiments.</figcaption>
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Task</span></th>
<th id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Total Num. Clients</span></th>
<th id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Sampled Num. Clients</span></th>
<th id="S5.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">Num. Rounds</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.2.1" class="ltx_tr">
<td id="S5.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Sentiment140</td>
<td id="S5.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Text classification</td>
<td id="S5.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21876</td>
<td id="S5.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">300</td>
</tr>
<tr id="S5.T2.1.3.2" class="ltx_tr">
<td id="S5.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">R8</td>
<td id="S5.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Text classification</td>
<td id="S5.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1000</td>
<td id="S5.T2.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">200</td>
</tr>
<tr id="S5.T2.1.4.3" class="ltx_tr">
<td id="S5.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CIFAR-10</td>
<td id="S5.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Image classification</td>
<td id="S5.T2.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1000</td>
<td id="S5.T2.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
</tr>
<tr id="S5.T2.1.5.4" class="ltx_tr">
<td id="S5.T2.1.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">WikiArt</td>
<td id="S5.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Image classification</td>
<td id="S5.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1000</td>
<td id="S5.T2.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">200</td>
</tr>
<tr id="S5.T2.1.6.5" class="ltx_tr">
<td id="S5.T2.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Speech Commands V1</td>
<td id="S5.T2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Keyword spotting</td>
<td id="S5.T2.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1503</td>
<td id="S5.T2.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">300</td>
</tr>
<tr id="S5.T2.1.7.6" class="ltx_tr">
<td id="S5.T2.1.7.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">MINDS-14</td>
<td id="S5.T2.1.7.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">Automatic speech recognition</td>
<td id="S5.T2.1.7.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">100</td>
<td id="S5.T2.1.7.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">10</td>
<td id="S5.T2.1.7.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2000</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Natural Language Understanding: </span> Sentiment140 (sent140) is used for sentiment analysis. It consists of 1.6 million tweets from over 660,000 users. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>, we remove users with less than 10 samples each, leaving us with 21,876 users.</p>
</div>
<div id="S5.I1.i1.p2" class="ltx_para">
<p id="S5.I1.i1.p2.1" class="ltx_p">R8 is another text classification dataset which is a subset of the Reuters-21578 dataset of news articles <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> with 8 classes and over 7,000 samples.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Computer Vision: </span> CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> and WikiArt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> are used for the task of image classification. CIFAR-10 contains 60,000 32x32 images in 10 classes, each of which with 10% of the images. It is a labeled subset of the 80 million tiny images dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>.</p>
</div>
<div id="S5.I1.i2.p2" class="ltx_para">
<p id="S5.I1.i2.p2.1" class="ltx_p">WikiArt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> consists of over 81,000 images of artworks taken from <a href="WikiArt.org" title="" class="ltx_ref ltx_url ltx_font_typewriter">WikiArt.org</a>. Each artwork is labeled by its artist, genre and style. We use the artist label only and remove images belonging to artists with less than 100 artworks in the dataset, leaving us with 23 artists and hence 23 classes.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Speech Recognition: </span></p>
</div>
<div id="S5.I1.i3.p2" class="ltx_para">
<p id="S5.I1.i3.p2.1" class="ltx_p">Speech Commands V1 (SC V1) is a keyword spotting dataset with over 64,000 audio samples produced by 1,503 different speakers. We consider each of the available labels as a different class, therefore making it a 30-class classification task.</p>
</div>
<div id="S5.I1.i3.p3" class="ltx_para">
<p id="S5.I1.i3.p3.1" class="ltx_p">MINDS-14 is an automatic speech recognition dataset consisting of over 1,800 audio recordings in English. Each sample in the MINDS-14 dataset is also labeled by its intent with a total of 14 intent classes.</p>
</div>
</li>
</ul>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">The metric we use for MINDS-14 is word error rate (WER) which is defined as the ratio of errors made in a transcript to the total number of words. More specifically, it is computed as follows:</p>
<table id="S5.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E6.m1.1" class="ltx_Math" alttext="\text{WER}=\frac{S+D+I}{N}," display="block"><semantics id="S5.E6.m1.1a"><mrow id="S5.E6.m1.1.1.1" xref="S5.E6.m1.1.1.1.1.cmml"><mrow id="S5.E6.m1.1.1.1.1" xref="S5.E6.m1.1.1.1.1.cmml"><mtext id="S5.E6.m1.1.1.1.1.2" xref="S5.E6.m1.1.1.1.1.2a.cmml">WER</mtext><mo id="S5.E6.m1.1.1.1.1.1" xref="S5.E6.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S5.E6.m1.1.1.1.1.3" xref="S5.E6.m1.1.1.1.1.3.cmml"><mrow id="S5.E6.m1.1.1.1.1.3.2" xref="S5.E6.m1.1.1.1.1.3.2.cmml"><mi id="S5.E6.m1.1.1.1.1.3.2.2" xref="S5.E6.m1.1.1.1.1.3.2.2.cmml">S</mi><mo id="S5.E6.m1.1.1.1.1.3.2.1" xref="S5.E6.m1.1.1.1.1.3.2.1.cmml">+</mo><mi id="S5.E6.m1.1.1.1.1.3.2.3" xref="S5.E6.m1.1.1.1.1.3.2.3.cmml">D</mi><mo id="S5.E6.m1.1.1.1.1.3.2.1a" xref="S5.E6.m1.1.1.1.1.3.2.1.cmml">+</mo><mi id="S5.E6.m1.1.1.1.1.3.2.4" xref="S5.E6.m1.1.1.1.1.3.2.4.cmml">I</mi></mrow><mi id="S5.E6.m1.1.1.1.1.3.3" xref="S5.E6.m1.1.1.1.1.3.3.cmml">N</mi></mfrac></mrow><mo id="S5.E6.m1.1.1.1.2" xref="S5.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E6.m1.1b"><apply id="S5.E6.m1.1.1.1.1.cmml" xref="S5.E6.m1.1.1.1"><eq id="S5.E6.m1.1.1.1.1.1.cmml" xref="S5.E6.m1.1.1.1.1.1"></eq><ci id="S5.E6.m1.1.1.1.1.2a.cmml" xref="S5.E6.m1.1.1.1.1.2"><mtext id="S5.E6.m1.1.1.1.1.2.cmml" xref="S5.E6.m1.1.1.1.1.2">WER</mtext></ci><apply id="S5.E6.m1.1.1.1.1.3.cmml" xref="S5.E6.m1.1.1.1.1.3"><divide id="S5.E6.m1.1.1.1.1.3.1.cmml" xref="S5.E6.m1.1.1.1.1.3"></divide><apply id="S5.E6.m1.1.1.1.1.3.2.cmml" xref="S5.E6.m1.1.1.1.1.3.2"><plus id="S5.E6.m1.1.1.1.1.3.2.1.cmml" xref="S5.E6.m1.1.1.1.1.3.2.1"></plus><ci id="S5.E6.m1.1.1.1.1.3.2.2.cmml" xref="S5.E6.m1.1.1.1.1.3.2.2">𝑆</ci><ci id="S5.E6.m1.1.1.1.1.3.2.3.cmml" xref="S5.E6.m1.1.1.1.1.3.2.3">𝐷</ci><ci id="S5.E6.m1.1.1.1.1.3.2.4.cmml" xref="S5.E6.m1.1.1.1.1.3.2.4">𝐼</ci></apply><ci id="S5.E6.m1.1.1.1.1.3.3.cmml" xref="S5.E6.m1.1.1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m1.1c">\text{WER}=\frac{S+D+I}{N},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S5.SS1.p3.2" class="ltx_p">where S, D, and I denote the number of substitutions, deletions and insertions, respectively, and N represents the total number of words.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">For all other datasets, we use accuracy as the performance measurement which is defined as:</p>
<table id="S5.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E7.m1.1" class="ltx_Math" alttext="\text{Accuracy}=\frac{TP+TN}{TP+TN+FP+FN}," display="block"><semantics id="S5.E7.m1.1a"><mrow id="S5.E7.m1.1.1.1" xref="S5.E7.m1.1.1.1.1.cmml"><mrow id="S5.E7.m1.1.1.1.1" xref="S5.E7.m1.1.1.1.1.cmml"><mtext id="S5.E7.m1.1.1.1.1.2" xref="S5.E7.m1.1.1.1.1.2a.cmml">Accuracy</mtext><mo id="S5.E7.m1.1.1.1.1.1" xref="S5.E7.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S5.E7.m1.1.1.1.1.3" xref="S5.E7.m1.1.1.1.1.3.cmml"><mrow id="S5.E7.m1.1.1.1.1.3.2" xref="S5.E7.m1.1.1.1.1.3.2.cmml"><mrow id="S5.E7.m1.1.1.1.1.3.2.2" xref="S5.E7.m1.1.1.1.1.3.2.2.cmml"><mi id="S5.E7.m1.1.1.1.1.3.2.2.2" xref="S5.E7.m1.1.1.1.1.3.2.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.2.2.1" xref="S5.E7.m1.1.1.1.1.3.2.2.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.2.2.3" xref="S5.E7.m1.1.1.1.1.3.2.2.3.cmml">P</mi></mrow><mo id="S5.E7.m1.1.1.1.1.3.2.1" xref="S5.E7.m1.1.1.1.1.3.2.1.cmml">+</mo><mrow id="S5.E7.m1.1.1.1.1.3.2.3" xref="S5.E7.m1.1.1.1.1.3.2.3.cmml"><mi id="S5.E7.m1.1.1.1.1.3.2.3.2" xref="S5.E7.m1.1.1.1.1.3.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.2.3.1" xref="S5.E7.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.2.3.3" xref="S5.E7.m1.1.1.1.1.3.2.3.3.cmml">N</mi></mrow></mrow><mrow id="S5.E7.m1.1.1.1.1.3.3" xref="S5.E7.m1.1.1.1.1.3.3.cmml"><mrow id="S5.E7.m1.1.1.1.1.3.3.2" xref="S5.E7.m1.1.1.1.1.3.3.2.cmml"><mi id="S5.E7.m1.1.1.1.1.3.3.2.2" xref="S5.E7.m1.1.1.1.1.3.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.3.2.1" xref="S5.E7.m1.1.1.1.1.3.3.2.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.3.2.3" xref="S5.E7.m1.1.1.1.1.3.3.2.3.cmml">P</mi></mrow><mo id="S5.E7.m1.1.1.1.1.3.3.1" xref="S5.E7.m1.1.1.1.1.3.3.1.cmml">+</mo><mrow id="S5.E7.m1.1.1.1.1.3.3.3" xref="S5.E7.m1.1.1.1.1.3.3.3.cmml"><mi id="S5.E7.m1.1.1.1.1.3.3.3.2" xref="S5.E7.m1.1.1.1.1.3.3.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.3.3.1" xref="S5.E7.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.3.3.3" xref="S5.E7.m1.1.1.1.1.3.3.3.3.cmml">N</mi></mrow><mo id="S5.E7.m1.1.1.1.1.3.3.1a" xref="S5.E7.m1.1.1.1.1.3.3.1.cmml">+</mo><mrow id="S5.E7.m1.1.1.1.1.3.3.4" xref="S5.E7.m1.1.1.1.1.3.3.4.cmml"><mi id="S5.E7.m1.1.1.1.1.3.3.4.2" xref="S5.E7.m1.1.1.1.1.3.3.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.3.4.1" xref="S5.E7.m1.1.1.1.1.3.3.4.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.3.4.3" xref="S5.E7.m1.1.1.1.1.3.3.4.3.cmml">P</mi></mrow><mo id="S5.E7.m1.1.1.1.1.3.3.1b" xref="S5.E7.m1.1.1.1.1.3.3.1.cmml">+</mo><mrow id="S5.E7.m1.1.1.1.1.3.3.5" xref="S5.E7.m1.1.1.1.1.3.3.5.cmml"><mi id="S5.E7.m1.1.1.1.1.3.3.5.2" xref="S5.E7.m1.1.1.1.1.3.3.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.1.3.3.5.1" xref="S5.E7.m1.1.1.1.1.3.3.5.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.1.3.3.5.3" xref="S5.E7.m1.1.1.1.1.3.3.5.3.cmml">N</mi></mrow></mrow></mfrac></mrow><mo id="S5.E7.m1.1.1.1.2" xref="S5.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m1.1b"><apply id="S5.E7.m1.1.1.1.1.cmml" xref="S5.E7.m1.1.1.1"><eq id="S5.E7.m1.1.1.1.1.1.cmml" xref="S5.E7.m1.1.1.1.1.1"></eq><ci id="S5.E7.m1.1.1.1.1.2a.cmml" xref="S5.E7.m1.1.1.1.1.2"><mtext id="S5.E7.m1.1.1.1.1.2.cmml" xref="S5.E7.m1.1.1.1.1.2">Accuracy</mtext></ci><apply id="S5.E7.m1.1.1.1.1.3.cmml" xref="S5.E7.m1.1.1.1.1.3"><divide id="S5.E7.m1.1.1.1.1.3.1.cmml" xref="S5.E7.m1.1.1.1.1.3"></divide><apply id="S5.E7.m1.1.1.1.1.3.2.cmml" xref="S5.E7.m1.1.1.1.1.3.2"><plus id="S5.E7.m1.1.1.1.1.3.2.1.cmml" xref="S5.E7.m1.1.1.1.1.3.2.1"></plus><apply id="S5.E7.m1.1.1.1.1.3.2.2.cmml" xref="S5.E7.m1.1.1.1.1.3.2.2"><times id="S5.E7.m1.1.1.1.1.3.2.2.1.cmml" xref="S5.E7.m1.1.1.1.1.3.2.2.1"></times><ci id="S5.E7.m1.1.1.1.1.3.2.2.2.cmml" xref="S5.E7.m1.1.1.1.1.3.2.2.2">𝑇</ci><ci id="S5.E7.m1.1.1.1.1.3.2.2.3.cmml" xref="S5.E7.m1.1.1.1.1.3.2.2.3">𝑃</ci></apply><apply id="S5.E7.m1.1.1.1.1.3.2.3.cmml" xref="S5.E7.m1.1.1.1.1.3.2.3"><times id="S5.E7.m1.1.1.1.1.3.2.3.1.cmml" xref="S5.E7.m1.1.1.1.1.3.2.3.1"></times><ci id="S5.E7.m1.1.1.1.1.3.2.3.2.cmml" xref="S5.E7.m1.1.1.1.1.3.2.3.2">𝑇</ci><ci id="S5.E7.m1.1.1.1.1.3.2.3.3.cmml" xref="S5.E7.m1.1.1.1.1.3.2.3.3">𝑁</ci></apply></apply><apply id="S5.E7.m1.1.1.1.1.3.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3"><plus id="S5.E7.m1.1.1.1.1.3.3.1.cmml" xref="S5.E7.m1.1.1.1.1.3.3.1"></plus><apply id="S5.E7.m1.1.1.1.1.3.3.2.cmml" xref="S5.E7.m1.1.1.1.1.3.3.2"><times id="S5.E7.m1.1.1.1.1.3.3.2.1.cmml" xref="S5.E7.m1.1.1.1.1.3.3.2.1"></times><ci id="S5.E7.m1.1.1.1.1.3.3.2.2.cmml" xref="S5.E7.m1.1.1.1.1.3.3.2.2">𝑇</ci><ci id="S5.E7.m1.1.1.1.1.3.3.2.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3.2.3">𝑃</ci></apply><apply id="S5.E7.m1.1.1.1.1.3.3.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3.3"><times id="S5.E7.m1.1.1.1.1.3.3.3.1.cmml" xref="S5.E7.m1.1.1.1.1.3.3.3.1"></times><ci id="S5.E7.m1.1.1.1.1.3.3.3.2.cmml" xref="S5.E7.m1.1.1.1.1.3.3.3.2">𝑇</ci><ci id="S5.E7.m1.1.1.1.1.3.3.3.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3.3.3">𝑁</ci></apply><apply id="S5.E7.m1.1.1.1.1.3.3.4.cmml" xref="S5.E7.m1.1.1.1.1.3.3.4"><times id="S5.E7.m1.1.1.1.1.3.3.4.1.cmml" xref="S5.E7.m1.1.1.1.1.3.3.4.1"></times><ci id="S5.E7.m1.1.1.1.1.3.3.4.2.cmml" xref="S5.E7.m1.1.1.1.1.3.3.4.2">𝐹</ci><ci id="S5.E7.m1.1.1.1.1.3.3.4.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3.4.3">𝑃</ci></apply><apply id="S5.E7.m1.1.1.1.1.3.3.5.cmml" xref="S5.E7.m1.1.1.1.1.3.3.5"><times id="S5.E7.m1.1.1.1.1.3.3.5.1.cmml" xref="S5.E7.m1.1.1.1.1.3.3.5.1"></times><ci id="S5.E7.m1.1.1.1.1.3.3.5.2.cmml" xref="S5.E7.m1.1.1.1.1.3.3.5.2">𝐹</ci><ci id="S5.E7.m1.1.1.1.1.3.3.5.3.cmml" xref="S5.E7.m1.1.1.1.1.3.3.5.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m1.1c">\text{Accuracy}=\frac{TP+TN}{TP+TN+FP+FN},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S5.SS1.p4.2" class="ltx_p">where TP, TN, FP, FN denote the number of true positives, true negatives, false positives and false negatives, respectively.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Models</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We use transformer-based pre-trained models of similar numbers of parameters (over 20 million) for our experiments as shown in Table <a href="#S5.T3" title="TABLE III ‣ V-B Models ‣ V Experimental Setup ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Memory consumption and speed are calculated using a single NVIDIA A10, a batch size of 1 and a maximum duration of 1 second for DistilHuBERT. In this work, we consider large models to be around 25 million parameters for deployment on edge devices as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> due to memory limitations of such devices. Transformer models of similar sizes are used in works including <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> for non-private federated learning and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> for differentially private federated learning, and are suitable for deployment on mobile devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Smaller models such as convolutional neural networks (CNNs) and recurrent neural networks (RNNs) are used in previous works including <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>. These models are however less capable than larger transformer-based pre-trained models and deliver sub-optimal performance for a wide range of tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">The same model is used for tasks of the same domain. Therefore, we use BERT-small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for experiments on Sentiment140 and R8, ViT-small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> for CIFAR-10 and WikiArt, and DistilHuBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> for Speech Commands and MINDS-14. Despite the fact that these models are extremely small compared to state-of-the-art large language models with rapidly increasing sizes such as LLaMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite> with 70 billion parameters and GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> with 1.7 trillion parameters, models with over 20 million parameters are considered large for either on-device deployment or differentially private federated learning.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Datasets and models used for our experiments.</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.1.1.1.2.1" class="ltx_text ltx_font_bold">Datasets</span></th>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">Num. Parameters</span></td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.1.1.1.4.1" class="ltx_text ltx_font_bold">Memory (Training)</span></td>
<td id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.1.1.1.5.1" class="ltx_text ltx_font_bold">Time (Training)</span></td>
</tr>
<tr id="S5.T3.1.2.2" class="ltx_tr">
<th id="S5.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Bert-small</th>
<th id="S5.T3.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Sentiment140 &amp; R8</th>
<td id="S5.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">28.7M</td>
<td id="S5.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.1GB</td>
<td id="S5.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.02s</td>
</tr>
<tr id="S5.T3.1.3.3" class="ltx_tr">
<th id="S5.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">ViT-small</th>
<th id="S5.T3.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">CIFAR-10 &amp; WikiArt</th>
<td id="S5.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.1M</td>
<td id="S5.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.1GB</td>
<td id="S5.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.04s</td>
</tr>
<tr id="S5.T3.1.4.4" class="ltx_tr">
<th id="S5.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">DistilHuBERT</th>
<th id="S5.T3.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Speech Commands &amp; MINDS-14</th>
<td id="S5.T3.1.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">23.5M</td>
<td id="S5.T3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2.3GB</td>
<td id="S5.T3.1.4.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.03s</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">For all our experiments, we consider a centralised and cross-device federated learning setting with a central server coordinating the training process and a subset of the clients being sampled at each communication round. We do not address resolving client drift caused by data heterogeneity, client dropouts, or continual learning in which client data is not necessarily stationary.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">We developed our method in PyTorch. We simulate non-private and differentially private federated learning setups on 2 NVIDIA A100s or 8 NVIDIA A10s.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.5.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.6.2" class="ltx_text ltx_font_italic">Non-IID Partitioning</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We use non-independent and identically distributed (non-IID) data partitioning for all our experiments unless stated otherwise. As we can see from Table <a href="#S5.T2" title="TABLE II ‣ V-A Datasets and Tasks ‣ V Experimental Setup ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, Sentiment140 and Speech Commands V1 are naturally non-IID. These datasets provide user ID for each sample which allows us to assign data produced by each unique person (e.g., speaker) to each client. It is also possible to set up the WikiArt dataset in a similar fashion by using artist as the prediction target. However, this would leave us with only 23 clients in total, making the experiments unrealistically small-scale.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">We therefore choose to utilise Dirichlet distribution to artificially achieve non-IID label distribution for the remaining four datasets, including R8, CIFAR-10, WikiArt and MINDS-14. For these datasets, we partition by drawing from a Dirichlet distribution with <math id="S5.SS4.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS4.p2.1.m1.1a"><mrow id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml"><mi id="S5.SS4.p2.1.m1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS4.p2.1.m1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.1.m1.1.1.3" xref="S5.SS4.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><apply id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1"><eq id="S5.SS4.p2.1.m1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1"></eq><ci id="S5.SS4.p2.1.m1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS4.p2.1.m1.1.1.3.cmml" xref="S5.SS4.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">\alpha=0.1</annotation></semantics></math> by default following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib70" title="" class="ltx_ref">70</a>, <a href="#bib.bib71" title="" class="ltx_ref">71</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> which results in each client holding samples from very few classes.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS5.5.1.1" class="ltx_text">V-E</span> </span><span id="S5.SS5.6.2" class="ltx_text ltx_font_italic">Noise Mechanism</span>
</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.5" class="ltx_p">For model training with user-level differential privacy, we only consider the Gaussian mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. We exclude the Laplace mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib73" title="" class="ltx_ref">73</a>]</cite> from our experiments because it relies on the <math id="S5.SS5.p1.1.m1.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S5.SS5.p1.1.m1.1a"><mrow id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml"><mi id="S5.SS5.p1.1.m1.1.1.2" xref="S5.SS5.p1.1.m1.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.1.m1.1.1.1" xref="S5.SS5.p1.1.m1.1.1.1.cmml">​</mo><mn id="S5.SS5.p1.1.m1.1.1.3" xref="S5.SS5.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><apply id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1"><times id="S5.SS5.p1.1.m1.1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1.1"></times><ci id="S5.SS5.p1.1.m1.1.1.2.cmml" xref="S5.SS5.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p1.1.m1.1.1.3.cmml" xref="S5.SS5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">L1</annotation></semantics></math> sensitivity. That is, the magnitude of the client updates has to be computed using the <math id="S5.SS5.p1.2.m2.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S5.SS5.p1.2.m2.1a"><mrow id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml"><mi id="S5.SS5.p1.2.m2.1.1.2" xref="S5.SS5.p1.2.m2.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.2.m2.1.1.1" xref="S5.SS5.p1.2.m2.1.1.1.cmml">​</mo><mn id="S5.SS5.p1.2.m2.1.1.3" xref="S5.SS5.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><apply id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1"><times id="S5.SS5.p1.2.m2.1.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1.1"></times><ci id="S5.SS5.p1.2.m2.1.1.2.cmml" xref="S5.SS5.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p1.2.m2.1.1.3.cmml" xref="S5.SS5.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">L1</annotation></semantics></math> norm of the vector. On the other hand, the Gaussian mechanism allows the use of either the <math id="S5.SS5.p1.3.m3.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S5.SS5.p1.3.m3.1a"><mrow id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml"><mi id="S5.SS5.p1.3.m3.1.1.2" xref="S5.SS5.p1.3.m3.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.3.m3.1.1.1" xref="S5.SS5.p1.3.m3.1.1.1.cmml">​</mo><mn id="S5.SS5.p1.3.m3.1.1.3" xref="S5.SS5.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.1b"><apply id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1"><times id="S5.SS5.p1.3.m3.1.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1.1"></times><ci id="S5.SS5.p1.3.m3.1.1.2.cmml" xref="S5.SS5.p1.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p1.3.m3.1.1.3.cmml" xref="S5.SS5.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.1c">L1</annotation></semantics></math> or <math id="S5.SS5.p1.4.m4.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S5.SS5.p1.4.m4.1a"><mrow id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml"><mi id="S5.SS5.p1.4.m4.1.1.2" xref="S5.SS5.p1.4.m4.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.4.m4.1.1.1" xref="S5.SS5.p1.4.m4.1.1.1.cmml">​</mo><mn id="S5.SS5.p1.4.m4.1.1.3" xref="S5.SS5.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.1b"><apply id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1"><times id="S5.SS5.p1.4.m4.1.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1.1"></times><ci id="S5.SS5.p1.4.m4.1.1.2.cmml" xref="S5.SS5.p1.4.m4.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p1.4.m4.1.1.3.cmml" xref="S5.SS5.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.1c">L2</annotation></semantics></math> sensitivity. For both mechanisms the standard deviation of the added noise grows linearly with the sensitivity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>]</cite>. Since we use large models of around 25 million parameters in our experiments, the <math id="S5.SS5.p1.5.m5.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S5.SS5.p1.5.m5.1a"><mrow id="S5.SS5.p1.5.m5.1.1" xref="S5.SS5.p1.5.m5.1.1.cmml"><mi id="S5.SS5.p1.5.m5.1.1.2" xref="S5.SS5.p1.5.m5.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.5.m5.1.1.1" xref="S5.SS5.p1.5.m5.1.1.1.cmml">​</mo><mn id="S5.SS5.p1.5.m5.1.1.3" xref="S5.SS5.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.5.m5.1b"><apply id="S5.SS5.p1.5.m5.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1"><times id="S5.SS5.p1.5.m5.1.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1.1"></times><ci id="S5.SS5.p1.5.m5.1.1.2.cmml" xref="S5.SS5.p1.5.m5.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p1.5.m5.1.1.3.cmml" xref="S5.SS5.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.5.m5.1c">L1</annotation></semantics></math> norm of the model update would be extremely large which would make it impossible for the model to learn effectively.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.9" class="ltx_p">This is true even if we apply parameter-efficient fine-tuning. For example, assuming that the model has 25 million parameters and we reduce the number of trainable parameters to <math id="S5.SS5.p2.1.m1.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S5.SS5.p2.1.m1.1a"><mrow id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml"><mn id="S5.SS5.p2.1.m1.1.1.2" xref="S5.SS5.p2.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS5.p2.1.m1.1.1.1" xref="S5.SS5.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><apply id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS5.p2.1.m1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS5.p2.1.m1.1.1.2.cmml" xref="S5.SS5.p2.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">1\%</annotation></semantics></math> by applying parameter-efficient fine-tuning. The model update from client <math id="S5.SS5.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS5.p2.2.m2.1a"><mi id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><ci id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">k</annotation></semantics></math> will then be a vector <math id="S5.SS5.p2.3.m3.1" class="ltx_Math" alttext="\Delta_{k}" display="inline"><semantics id="S5.SS5.p2.3.m3.1a"><msub id="S5.SS5.p2.3.m3.1.1" xref="S5.SS5.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S5.SS5.p2.3.m3.1.1.2" xref="S5.SS5.p2.3.m3.1.1.2.cmml">Δ</mi><mi id="S5.SS5.p2.3.m3.1.1.3" xref="S5.SS5.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.3.m3.1b"><apply id="S5.SS5.p2.3.m3.1.1.cmml" xref="S5.SS5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.3.m3.1.1.1.cmml" xref="S5.SS5.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS5.p2.3.m3.1.1.2.cmml" xref="S5.SS5.p2.3.m3.1.1.2">Δ</ci><ci id="S5.SS5.p2.3.m3.1.1.3.cmml" xref="S5.SS5.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.3.m3.1c">\Delta_{k}</annotation></semantics></math> of size 250 thousand. For simplicity, let’s also assume that <math id="S5.SS5.p2.4.m4.1" class="ltx_Math" alttext="\Delta_{k}" display="inline"><semantics id="S5.SS5.p2.4.m4.1a"><msub id="S5.SS5.p2.4.m4.1.1" xref="S5.SS5.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S5.SS5.p2.4.m4.1.1.2" xref="S5.SS5.p2.4.m4.1.1.2.cmml">Δ</mi><mi id="S5.SS5.p2.4.m4.1.1.3" xref="S5.SS5.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.4.m4.1b"><apply id="S5.SS5.p2.4.m4.1.1.cmml" xref="S5.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.4.m4.1.1.1.cmml" xref="S5.SS5.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS5.p2.4.m4.1.1.2.cmml" xref="S5.SS5.p2.4.m4.1.1.2">Δ</ci><ci id="S5.SS5.p2.4.m4.1.1.3.cmml" xref="S5.SS5.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.4.m4.1c">\Delta_{k}</annotation></semantics></math> is a vector of all <math id="S5.SS5.p2.5.m5.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.SS5.p2.5.m5.1a"><mn id="S5.SS5.p2.5.m5.1.1" xref="S5.SS5.p2.5.m5.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.5.m5.1b"><cn type="float" id="S5.SS5.p2.5.m5.1.1.cmml" xref="S5.SS5.p2.5.m5.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.5.m5.1c">0.01</annotation></semantics></math>. The <math id="S5.SS5.p2.6.m6.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S5.SS5.p2.6.m6.1a"><mrow id="S5.SS5.p2.6.m6.1.1" xref="S5.SS5.p2.6.m6.1.1.cmml"><mi id="S5.SS5.p2.6.m6.1.1.2" xref="S5.SS5.p2.6.m6.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p2.6.m6.1.1.1" xref="S5.SS5.p2.6.m6.1.1.1.cmml">​</mo><mn id="S5.SS5.p2.6.m6.1.1.3" xref="S5.SS5.p2.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.6.m6.1b"><apply id="S5.SS5.p2.6.m6.1.1.cmml" xref="S5.SS5.p2.6.m6.1.1"><times id="S5.SS5.p2.6.m6.1.1.1.cmml" xref="S5.SS5.p2.6.m6.1.1.1"></times><ci id="S5.SS5.p2.6.m6.1.1.2.cmml" xref="S5.SS5.p2.6.m6.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p2.6.m6.1.1.3.cmml" xref="S5.SS5.p2.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.6.m6.1c">L1</annotation></semantics></math> norm is then <math id="S5.SS5.p2.7.m7.1" class="ltx_Math" alttext="\lVert\Delta_{k}\rVert_{1}=2500" display="inline"><semantics id="S5.SS5.p2.7.m7.1a"><mrow id="S5.SS5.p2.7.m7.1.1" xref="S5.SS5.p2.7.m7.1.1.cmml"><msub id="S5.SS5.p2.7.m7.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.cmml"><mrow id="S5.SS5.p2.7.m7.1.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S5.SS5.p2.7.m7.1.1.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.1.2.1.cmml">∥</mo><msub id="S5.SS5.p2.7.m7.1.1.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S5.SS5.p2.7.m7.1.1.1.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="S5.SS5.p2.7.m7.1.1.1.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="S5.SS5.p2.7.m7.1.1.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS5.p2.7.m7.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.3.cmml">1</mn></msub><mo id="S5.SS5.p2.7.m7.1.1.2" xref="S5.SS5.p2.7.m7.1.1.2.cmml">=</mo><mn id="S5.SS5.p2.7.m7.1.1.3" xref="S5.SS5.p2.7.m7.1.1.3.cmml">2500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.7.m7.1b"><apply id="S5.SS5.p2.7.m7.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1"><eq id="S5.SS5.p2.7.m7.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.2"></eq><apply id="S5.SS5.p2.7.m7.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1">subscript</csymbol><apply id="S5.SS5.p2.7.m7.1.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS5.p2.7.m7.1.1.1.1.2.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS5.p2.7.m7.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS5.p2.7.m7.1.1.1.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.2">Δ</ci><ci id="S5.SS5.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="S5.SS5.p2.7.m7.1.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3">1</cn></apply><cn type="integer" id="S5.SS5.p2.7.m7.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.3">2500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.7.m7.1c">\lVert\Delta_{k}\rVert_{1}=2500</annotation></semantics></math> which is much bigger than the <math id="S5.SS5.p2.8.m8.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S5.SS5.p2.8.m8.1a"><mrow id="S5.SS5.p2.8.m8.1.1" xref="S5.SS5.p2.8.m8.1.1.cmml"><mi id="S5.SS5.p2.8.m8.1.1.2" xref="S5.SS5.p2.8.m8.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p2.8.m8.1.1.1" xref="S5.SS5.p2.8.m8.1.1.1.cmml">​</mo><mn id="S5.SS5.p2.8.m8.1.1.3" xref="S5.SS5.p2.8.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.8.m8.1b"><apply id="S5.SS5.p2.8.m8.1.1.cmml" xref="S5.SS5.p2.8.m8.1.1"><times id="S5.SS5.p2.8.m8.1.1.1.cmml" xref="S5.SS5.p2.8.m8.1.1.1"></times><ci id="S5.SS5.p2.8.m8.1.1.2.cmml" xref="S5.SS5.p2.8.m8.1.1.2">𝐿</ci><cn type="integer" id="S5.SS5.p2.8.m8.1.1.3.cmml" xref="S5.SS5.p2.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.8.m8.1c">L2</annotation></semantics></math> norm <math id="S5.SS5.p2.9.m9.1" class="ltx_Math" alttext="\lVert\Delta_{k}\rVert_{2}=5" display="inline"><semantics id="S5.SS5.p2.9.m9.1a"><mrow id="S5.SS5.p2.9.m9.1.1" xref="S5.SS5.p2.9.m9.1.1.cmml"><msub id="S5.SS5.p2.9.m9.1.1.1" xref="S5.SS5.p2.9.m9.1.1.1.cmml"><mrow id="S5.SS5.p2.9.m9.1.1.1.1.1" xref="S5.SS5.p2.9.m9.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S5.SS5.p2.9.m9.1.1.1.1.1.2" xref="S5.SS5.p2.9.m9.1.1.1.1.2.1.cmml">∥</mo><msub id="S5.SS5.p2.9.m9.1.1.1.1.1.1" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S5.SS5.p2.9.m9.1.1.1.1.1.1.2" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="S5.SS5.p2.9.m9.1.1.1.1.1.1.3" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" lspace="0em" id="S5.SS5.p2.9.m9.1.1.1.1.1.3" xref="S5.SS5.p2.9.m9.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS5.p2.9.m9.1.1.1.3" xref="S5.SS5.p2.9.m9.1.1.1.3.cmml">2</mn></msub><mo id="S5.SS5.p2.9.m9.1.1.2" xref="S5.SS5.p2.9.m9.1.1.2.cmml">=</mo><mn id="S5.SS5.p2.9.m9.1.1.3" xref="S5.SS5.p2.9.m9.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.9.m9.1b"><apply id="S5.SS5.p2.9.m9.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1"><eq id="S5.SS5.p2.9.m9.1.1.2.cmml" xref="S5.SS5.p2.9.m9.1.1.2"></eq><apply id="S5.SS5.p2.9.m9.1.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.9.m9.1.1.1.2.cmml" xref="S5.SS5.p2.9.m9.1.1.1">subscript</csymbol><apply id="S5.SS5.p2.9.m9.1.1.1.1.2.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS5.p2.9.m9.1.1.1.1.2.1.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS5.p2.9.m9.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.9.m9.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS5.p2.9.m9.1.1.1.1.1.1.2.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1.2">Δ</ci><ci id="S5.SS5.p2.9.m9.1.1.1.1.1.1.3.cmml" xref="S5.SS5.p2.9.m9.1.1.1.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="S5.SS5.p2.9.m9.1.1.1.3.cmml" xref="S5.SS5.p2.9.m9.1.1.1.3">2</cn></apply><cn type="integer" id="S5.SS5.p2.9.m9.1.1.3.cmml" xref="S5.SS5.p2.9.m9.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.9.m9.1c">\lVert\Delta_{k}\rVert_{2}=5</annotation></semantics></math>. We therefore do not consider the Laplace mechanism in our experiments.</p>
</div>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS6.5.1.1" class="ltx_text">V-F</span> </span><span id="S5.SS6.6.2" class="ltx_text ltx_font_italic">Large Cohort Noise-Level Simulation</span>
</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.7" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib75" title="" class="ltx_ref">75</a>]</cite>, we simulate the noise-level of larger cohort sizes with smaller ones. In practice, differentially private federated learning (DP-FL) is applied to IoT systems with millions of clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. However, it is infeasible to simulate this many clients due to resource constraints. Since a larger cohort size <math id="S5.SS6.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS6.p1.1.m1.1a"><mi id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><ci id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">C</annotation></semantics></math> leads to less noise added for the same privacy guarantee, we simulate realistically large cohort size <math id="S5.SS6.p1.2.m2.1" class="ltx_Math" alttext="C_{\text{large}}" display="inline"><semantics id="S5.SS6.p1.2.m2.1a"><msub id="S5.SS6.p1.2.m2.1.1" xref="S5.SS6.p1.2.m2.1.1.cmml"><mi id="S5.SS6.p1.2.m2.1.1.2" xref="S5.SS6.p1.2.m2.1.1.2.cmml">C</mi><mtext id="S5.SS6.p1.2.m2.1.1.3" xref="S5.SS6.p1.2.m2.1.1.3a.cmml">large</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.2.m2.1b"><apply id="S5.SS6.p1.2.m2.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.2.m2.1.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p1.2.m2.1.1.2.cmml" xref="S5.SS6.p1.2.m2.1.1.2">𝐶</ci><ci id="S5.SS6.p1.2.m2.1.1.3a.cmml" xref="S5.SS6.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S5.SS6.p1.2.m2.1.1.3.cmml" xref="S5.SS6.p1.2.m2.1.1.3">large</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.2.m2.1c">C_{\text{large}}</annotation></semantics></math> with smaller cohort size <math id="S5.SS6.p1.3.m3.1" class="ltx_Math" alttext="C_{\text{small}}" display="inline"><semantics id="S5.SS6.p1.3.m3.1a"><msub id="S5.SS6.p1.3.m3.1.1" xref="S5.SS6.p1.3.m3.1.1.cmml"><mi id="S5.SS6.p1.3.m3.1.1.2" xref="S5.SS6.p1.3.m3.1.1.2.cmml">C</mi><mtext id="S5.SS6.p1.3.m3.1.1.3" xref="S5.SS6.p1.3.m3.1.1.3a.cmml">small</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.3.m3.1b"><apply id="S5.SS6.p1.3.m3.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.3.m3.1.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p1.3.m3.1.1.2.cmml" xref="S5.SS6.p1.3.m3.1.1.2">𝐶</ci><ci id="S5.SS6.p1.3.m3.1.1.3a.cmml" xref="S5.SS6.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S5.SS6.p1.3.m3.1.1.3.cmml" xref="S5.SS6.p1.3.m3.1.1.3">small</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.3.m3.1c">C_{\text{small}}</annotation></semantics></math>. This makes our results more meaningful in terms of deployment of DP-FL in IoT systems. We follow the approach in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib75" title="" class="ltx_ref">75</a>]</cite> for achieving this. The noise <math id="S5.SS6.p1.4.m4.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.SS6.p1.4.m4.1a"><mi id="S5.SS6.p1.4.m4.1.1" xref="S5.SS6.p1.4.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.4.m4.1b"><ci id="S5.SS6.p1.4.m4.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.4.m4.1c">\sigma</annotation></semantics></math> we use for simulation is then computed as <math id="S5.SS6.p1.5.m5.1" class="ltx_Math" alttext="\sigma=\frac{C_{\text{small}}}{C_{\text{large}}}z_{\text{large}}\cdot S" display="inline"><semantics id="S5.SS6.p1.5.m5.1a"><mrow id="S5.SS6.p1.5.m5.1.1" xref="S5.SS6.p1.5.m5.1.1.cmml"><mi id="S5.SS6.p1.5.m5.1.1.2" xref="S5.SS6.p1.5.m5.1.1.2.cmml">σ</mi><mo id="S5.SS6.p1.5.m5.1.1.1" xref="S5.SS6.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S5.SS6.p1.5.m5.1.1.3" xref="S5.SS6.p1.5.m5.1.1.3.cmml"><mrow id="S5.SS6.p1.5.m5.1.1.3.2" xref="S5.SS6.p1.5.m5.1.1.3.2.cmml"><mfrac id="S5.SS6.p1.5.m5.1.1.3.2.2" xref="S5.SS6.p1.5.m5.1.1.3.2.2.cmml"><msub id="S5.SS6.p1.5.m5.1.1.3.2.2.2" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.cmml"><mi id="S5.SS6.p1.5.m5.1.1.3.2.2.2.2" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.2.cmml">C</mi><mtext id="S5.SS6.p1.5.m5.1.1.3.2.2.2.3" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.3a.cmml">small</mtext></msub><msub id="S5.SS6.p1.5.m5.1.1.3.2.2.3" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.cmml"><mi id="S5.SS6.p1.5.m5.1.1.3.2.2.3.2" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.2.cmml">C</mi><mtext id="S5.SS6.p1.5.m5.1.1.3.2.2.3.3" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.3a.cmml">large</mtext></msub></mfrac><mo lspace="0em" rspace="0em" id="S5.SS6.p1.5.m5.1.1.3.2.1" xref="S5.SS6.p1.5.m5.1.1.3.2.1.cmml">​</mo><msub id="S5.SS6.p1.5.m5.1.1.3.2.3" xref="S5.SS6.p1.5.m5.1.1.3.2.3.cmml"><mi id="S5.SS6.p1.5.m5.1.1.3.2.3.2" xref="S5.SS6.p1.5.m5.1.1.3.2.3.2.cmml">z</mi><mtext id="S5.SS6.p1.5.m5.1.1.3.2.3.3" xref="S5.SS6.p1.5.m5.1.1.3.2.3.3a.cmml">large</mtext></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.SS6.p1.5.m5.1.1.3.1" xref="S5.SS6.p1.5.m5.1.1.3.1.cmml">⋅</mo><mi id="S5.SS6.p1.5.m5.1.1.3.3" xref="S5.SS6.p1.5.m5.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.5.m5.1b"><apply id="S5.SS6.p1.5.m5.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1"><eq id="S5.SS6.p1.5.m5.1.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1.1"></eq><ci id="S5.SS6.p1.5.m5.1.1.2.cmml" xref="S5.SS6.p1.5.m5.1.1.2">𝜎</ci><apply id="S5.SS6.p1.5.m5.1.1.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3"><ci id="S5.SS6.p1.5.m5.1.1.3.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.1">⋅</ci><apply id="S5.SS6.p1.5.m5.1.1.3.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2"><times id="S5.SS6.p1.5.m5.1.1.3.2.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.1"></times><apply id="S5.SS6.p1.5.m5.1.1.3.2.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2"><divide id="S5.SS6.p1.5.m5.1.1.3.2.2.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2"></divide><apply id="S5.SS6.p1.5.m5.1.1.3.2.2.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p1.5.m5.1.1.3.2.2.2.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2">subscript</csymbol><ci id="S5.SS6.p1.5.m5.1.1.3.2.2.2.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.2">𝐶</ci><ci id="S5.SS6.p1.5.m5.1.1.3.2.2.2.3a.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.3"><mtext mathsize="50%" id="S5.SS6.p1.5.m5.1.1.3.2.2.2.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.2.3">small</mtext></ci></apply><apply id="S5.SS6.p1.5.m5.1.1.3.2.2.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S5.SS6.p1.5.m5.1.1.3.2.2.3.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3">subscript</csymbol><ci id="S5.SS6.p1.5.m5.1.1.3.2.2.3.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.2">𝐶</ci><ci id="S5.SS6.p1.5.m5.1.1.3.2.2.3.3a.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.3"><mtext mathsize="50%" id="S5.SS6.p1.5.m5.1.1.3.2.2.3.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.2.3.3">large</mtext></ci></apply></apply><apply id="S5.SS6.p1.5.m5.1.1.3.2.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.SS6.p1.5.m5.1.1.3.2.3.1.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.3">subscript</csymbol><ci id="S5.SS6.p1.5.m5.1.1.3.2.3.2.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.3.2">𝑧</ci><ci id="S5.SS6.p1.5.m5.1.1.3.2.3.3a.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.3.3"><mtext mathsize="70%" id="S5.SS6.p1.5.m5.1.1.3.2.3.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.2.3.3">large</mtext></ci></apply></apply><ci id="S5.SS6.p1.5.m5.1.1.3.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.5.m5.1c">\sigma=\frac{C_{\text{small}}}{C_{\text{large}}}z_{\text{large}}\cdot S</annotation></semantics></math> where <math id="S5.SS6.p1.6.m6.1" class="ltx_Math" alttext="z_{\text{large}}" display="inline"><semantics id="S5.SS6.p1.6.m6.1a"><msub id="S5.SS6.p1.6.m6.1.1" xref="S5.SS6.p1.6.m6.1.1.cmml"><mi id="S5.SS6.p1.6.m6.1.1.2" xref="S5.SS6.p1.6.m6.1.1.2.cmml">z</mi><mtext id="S5.SS6.p1.6.m6.1.1.3" xref="S5.SS6.p1.6.m6.1.1.3a.cmml">large</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.6.m6.1b"><apply id="S5.SS6.p1.6.m6.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.6.m6.1.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS6.p1.6.m6.1.1.2.cmml" xref="S5.SS6.p1.6.m6.1.1.2">𝑧</ci><ci id="S5.SS6.p1.6.m6.1.1.3a.cmml" xref="S5.SS6.p1.6.m6.1.1.3"><mtext mathsize="70%" id="S5.SS6.p1.6.m6.1.1.3.cmml" xref="S5.SS6.p1.6.m6.1.1.3">large</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.6.m6.1c">z_{\text{large}}</annotation></semantics></math> is the noise multiplier calculated based on <math id="S5.SS6.p1.7.m7.1" class="ltx_Math" alttext="C_{\text{large}}" display="inline"><semantics id="S5.SS6.p1.7.m7.1a"><msub id="S5.SS6.p1.7.m7.1.1" xref="S5.SS6.p1.7.m7.1.1.cmml"><mi id="S5.SS6.p1.7.m7.1.1.2" xref="S5.SS6.p1.7.m7.1.1.2.cmml">C</mi><mtext id="S5.SS6.p1.7.m7.1.1.3" xref="S5.SS6.p1.7.m7.1.1.3a.cmml">large</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.7.m7.1b"><apply id="S5.SS6.p1.7.m7.1.1.cmml" xref="S5.SS6.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.7.m7.1.1.1.cmml" xref="S5.SS6.p1.7.m7.1.1">subscript</csymbol><ci id="S5.SS6.p1.7.m7.1.1.2.cmml" xref="S5.SS6.p1.7.m7.1.1.2">𝐶</ci><ci id="S5.SS6.p1.7.m7.1.1.3a.cmml" xref="S5.SS6.p1.7.m7.1.1.3"><mtext mathsize="70%" id="S5.SS6.p1.7.m7.1.1.3.cmml" xref="S5.SS6.p1.7.m7.1.1.3">large</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.7.m7.1c">C_{\text{large}}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We experimentally investigate full fine-tuning, existing parameter-efficient fine-tuning (PEFT) methods and our proposed method DP-DyLoRA under differentially private federated learning (DP-FL) unless otherwise stated. Our experiments cover three different domains, namely, natural language understanding, computer vision and speech in order to ensure that our results are applicable to a wide range of tasks and a variety of scenarios in terms of deployment in IoT systems. We additionally study the impact of data heterogeneity on DP-FL with full fine-tuning to investigate the root causes of the significant performance drop in such learning paradigm.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS1.5.1.1" class="ltx_text">VI-A</span> </span><span id="S6.SS1.6.2" class="ltx_text ltx_font_italic">Full Fine-tuning</span>
</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">DP-FL tends to degrade model performance due to the noise added to model updates. Previous works have proven that there is a proportional relationship between the number of updated parameters and the magnitude of the added noise <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Hence, it is particularly challenging to train large models with differential privacy. Together with the potential non-independent and identically distributed (non-IID) data distribution challenge, large transformer models are likely to fail when learning under DP-FL.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">The lower signal-to-noise ratio can be remedied by sampling more clients at each communication round <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>. Therefore, assuming a constant subsampling rate of 1%, we study the relationship between total number of clients and performance drop from FL to DP-FL for models such as BERT-small which is relatively large for deployment on edge devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>. Similar participation rates have been used in works including <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite>. In contrast, previous works on on-device DP-FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> utilise models such as recurrent neural networks (RNNs) and convolutional neural networks (CNNs) which are much smaller in size than our chosen models.</p>
</div>
<figure id="S6.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2405.06368/assets/x3.png" id="S6.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="253" height="170" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2405.06368/assets/x4.png" id="S6.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="253" height="278" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Model performance with different number of clients in production and privacy budgets. All datasets are produced using non-IID partitioning and <math id="S6.F3.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S6.F3.2.m1.1b"><mrow id="S6.F3.2.m1.1.1" xref="S6.F3.2.m1.1.1.cmml"><mi id="S6.F3.2.m1.1.1.2" xref="S6.F3.2.m1.1.1.2.cmml">α</mi><mo id="S6.F3.2.m1.1.1.1" xref="S6.F3.2.m1.1.1.1.cmml">=</mo><mn id="S6.F3.2.m1.1.1.3" xref="S6.F3.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F3.2.m1.1c"><apply id="S6.F3.2.m1.1.1.cmml" xref="S6.F3.2.m1.1.1"><eq id="S6.F3.2.m1.1.1.1.cmml" xref="S6.F3.2.m1.1.1.1"></eq><ci id="S6.F3.2.m1.1.1.2.cmml" xref="S6.F3.2.m1.1.1.2">𝛼</ci><cn type="float" id="S6.F3.2.m1.1.1.3.cmml" xref="S6.F3.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.m1.1d">\alpha=0.1</annotation></semantics></math> for Dirichlet distribution if applicable. CL, FL, DP-FL denote central learning, federated learning and differentially private federated learning, respectively.</figcaption>
</figure>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.3" class="ltx_p">From Figure <a href="#S6.F3" title="Figure 3 ‣ VI-A Full Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we can see that different tasks require utterly different settings with regard to differential privacy in order to achieve most performance of non-private federated learning. The results indicate that Sentiment140 is the most challenging task here under privacy constraints since signal seems to be completely dominated by added noise even with 50 million clients and <math id="S6.SS1.p3.1.m1.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S6.SS1.p3.1.m1.1a"><mrow id="S6.SS1.p3.1.m1.1.1" xref="S6.SS1.p3.1.m1.1.1.cmml"><mi id="S6.SS1.p3.1.m1.1.1.2" xref="S6.SS1.p3.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.p3.1.m1.1.1.1" xref="S6.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.p3.1.m1.1.1.3" xref="S6.SS1.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.1b"><apply id="S6.SS1.p3.1.m1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1"><eq id="S6.SS1.p3.1.m1.1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1.1"></eq><ci id="S6.SS1.p3.1.m1.1.1.2.cmml" xref="S6.SS1.p3.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS1.p3.1.m1.1.1.3.cmml" xref="S6.SS1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.1c">\epsilon=2</annotation></semantics></math>. The model only starts to learn after increasing the privacy budget to <math id="S6.SS1.p3.2.m2.1" class="ltx_Math" alttext="\epsilon=10" display="inline"><semantics id="S6.SS1.p3.2.m2.1a"><mrow id="S6.SS1.p3.2.m2.1.1" xref="S6.SS1.p3.2.m2.1.1.cmml"><mi id="S6.SS1.p3.2.m2.1.1.2" xref="S6.SS1.p3.2.m2.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.p3.2.m2.1.1.1" xref="S6.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.p3.2.m2.1.1.3" xref="S6.SS1.p3.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.2.m2.1b"><apply id="S6.SS1.p3.2.m2.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1"><eq id="S6.SS1.p3.2.m2.1.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1.1"></eq><ci id="S6.SS1.p3.2.m2.1.1.2.cmml" xref="S6.SS1.p3.2.m2.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS1.p3.2.m2.1.1.3.cmml" xref="S6.SS1.p3.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.2.m2.1c">\epsilon=10</annotation></semantics></math>. On the R8 dataset, the result is relatively close to that of non-private federated learning after increasing the number of clients to 50 million with a stringent privacy budget of <math id="S6.SS1.p3.3.m3.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S6.SS1.p3.3.m3.1a"><mrow id="S6.SS1.p3.3.m3.1.1" xref="S6.SS1.p3.3.m3.1.1.cmml"><mi id="S6.SS1.p3.3.m3.1.1.2" xref="S6.SS1.p3.3.m3.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.p3.3.m3.1.1.1" xref="S6.SS1.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.p3.3.m3.1.1.3" xref="S6.SS1.p3.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.3.m3.1b"><apply id="S6.SS1.p3.3.m3.1.1.cmml" xref="S6.SS1.p3.3.m3.1.1"><eq id="S6.SS1.p3.3.m3.1.1.1.cmml" xref="S6.SS1.p3.3.m3.1.1.1"></eq><ci id="S6.SS1.p3.3.m3.1.1.2.cmml" xref="S6.SS1.p3.3.m3.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS1.p3.3.m3.1.1.3.cmml" xref="S6.SS1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.3.m3.1c">\epsilon=2</annotation></semantics></math>.</p>
</div>
<div id="S6.SS1.p4" class="ltx_para">
<p id="S6.SS1.p4.2" class="ltx_p">For the image classification task, the model achieves nearly identical result to that of non-private federated learning with only 1 million clients and <math id="S6.SS1.p4.1.m1.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S6.SS1.p4.1.m1.1a"><mrow id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml"><mi id="S6.SS1.p4.1.m1.1.1.2" xref="S6.SS1.p4.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.p4.1.m1.1.1.1" xref="S6.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.1.m1.1.1.3" xref="S6.SS1.p4.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.1b"><apply id="S6.SS1.p4.1.m1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1"><eq id="S6.SS1.p4.1.m1.1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1.1"></eq><ci id="S6.SS1.p4.1.m1.1.1.2.cmml" xref="S6.SS1.p4.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS1.p4.1.m1.1.1.3.cmml" xref="S6.SS1.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.1c">\epsilon=2</annotation></semantics></math> on the CIFAR-10 dataset. This indicates that CIFAR-10 is the least challenging task amongst all we have chosen in DP-FL setting. On the other hand, the DP-FL result on WikiArt is fairly poor with 1 million clients even with a more generous privacy budget of <math id="S6.SS1.p4.2.m2.1" class="ltx_Math" alttext="\epsilon=10" display="inline"><semantics id="S6.SS1.p4.2.m2.1a"><mrow id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml"><mi id="S6.SS1.p4.2.m2.1.1.2" xref="S6.SS1.p4.2.m2.1.1.2.cmml">ϵ</mi><mo id="S6.SS1.p4.2.m2.1.1.1" xref="S6.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.2.m2.1.1.3" xref="S6.SS1.p4.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.1b"><apply id="S6.SS1.p4.2.m2.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1"><eq id="S6.SS1.p4.2.m2.1.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1.1"></eq><ci id="S6.SS1.p4.2.m2.1.1.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS1.p4.2.m2.1.1.3.cmml" xref="S6.SS1.p4.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.1c">\epsilon=10</annotation></semantics></math>, and the model only produces reasonable results after increasing the number of clients to 10 million. The two datasets in the speech domain, namely, Speech Commands and MINDS-14 show similar behaviour to that of WikiArt with poor initial performance and results close to those of non-private federated learning after increasing the number of clients to 10 million.</p>
</div>
<div id="S6.SS1.p5" class="ltx_para ltx_noindent">
<p id="S6.SS1.p5.1" class="ltx_p"><span id="S6.SS1.p5.1.1" class="ltx_text ltx_font_bold">Take-aways</span></p>
</div>
<div id="S6.SS1.p6" class="ltx_para">
<ul id="S6.SS1.p6.1" class="ltx_itemize">
<li id="S6.I1.i1" class="ltx_item" style="list-style-type:none;"> 
<div id="S6.I1.i1.p1" class="ltx_para">
<p id="S6.I1.i1.p1.1" class="ltx_p">When training large models on-device in an IoT system using full fine-tuning under DP-FL, tens of millions of clients may be required for the model to learn effectively.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS2.5.1.1" class="ltx_text">VI-B</span> </span><span id="S6.SS2.6.2" class="ltx_text ltx_font_italic">Data Heterogeneity</span>
</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">In real-world scenarios, users possess different characteristics such as voice, interest and habit. These differences results in a highly non-independent and identically distributed (non-IID) distribution of client data in almost all cases. It is therefore essential to study the impact of data heterogeneity on model training in DP-FL.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.6" class="ltx_p">As shown in Figure <a href="#S6.F5" title="Figure 5 ‣ VI-B Data Heterogeneity ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#S6.F4" title="Figure 4 ‣ VI-B Data Heterogeneity ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we train the model on each task with both IID and non-IID data partitioning using a single combination of client number and privacy budget taken from Q1. In Figure <a href="#S6.F4" title="Figure 4 ‣ VI-B Data Heterogeneity ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we show results with <math id="S6.SS2.p2.1.m1.3" class="ltx_Math" alttext="\alpha=[0.01,0.1,1000]" display="inline"><semantics id="S6.SS2.p2.1.m1.3a"><mrow id="S6.SS2.p2.1.m1.3.4" xref="S6.SS2.p2.1.m1.3.4.cmml"><mi id="S6.SS2.p2.1.m1.3.4.2" xref="S6.SS2.p2.1.m1.3.4.2.cmml">α</mi><mo id="S6.SS2.p2.1.m1.3.4.1" xref="S6.SS2.p2.1.m1.3.4.1.cmml">=</mo><mrow id="S6.SS2.p2.1.m1.3.4.3.2" xref="S6.SS2.p2.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S6.SS2.p2.1.m1.3.4.3.2.1" xref="S6.SS2.p2.1.m1.3.4.3.1.cmml">[</mo><mn id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">0.01</mn><mo id="S6.SS2.p2.1.m1.3.4.3.2.2" xref="S6.SS2.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S6.SS2.p2.1.m1.2.2" xref="S6.SS2.p2.1.m1.2.2.cmml">0.1</mn><mo id="S6.SS2.p2.1.m1.3.4.3.2.3" xref="S6.SS2.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S6.SS2.p2.1.m1.3.3" xref="S6.SS2.p2.1.m1.3.3.cmml">1000</mn><mo stretchy="false" id="S6.SS2.p2.1.m1.3.4.3.2.4" xref="S6.SS2.p2.1.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.3b"><apply id="S6.SS2.p2.1.m1.3.4.cmml" xref="S6.SS2.p2.1.m1.3.4"><eq id="S6.SS2.p2.1.m1.3.4.1.cmml" xref="S6.SS2.p2.1.m1.3.4.1"></eq><ci id="S6.SS2.p2.1.m1.3.4.2.cmml" xref="S6.SS2.p2.1.m1.3.4.2">𝛼</ci><list id="S6.SS2.p2.1.m1.3.4.3.1.cmml" xref="S6.SS2.p2.1.m1.3.4.3.2"><cn type="float" id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">0.01</cn><cn type="float" id="S6.SS2.p2.1.m1.2.2.cmml" xref="S6.SS2.p2.1.m1.2.2">0.1</cn><cn type="integer" id="S6.SS2.p2.1.m1.3.3.cmml" xref="S6.SS2.p2.1.m1.3.3">1000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.3c">\alpha=[0.01,0.1,1000]</annotation></semantics></math> for R8, CIFAR-10, WikiArt and MINDS-14 following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib70" title="" class="ltx_ref">70</a>, <a href="#bib.bib71" title="" class="ltx_ref">71</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> which are non-IID by drawing labels from a Dirichlet distribution. When <math id="S6.SS2.p2.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS2.p2.2.m2.1a"><mi id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><ci id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">\alpha</annotation></semantics></math> is set to <math id="S6.SS2.p2.3.m3.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S6.SS2.p2.3.m3.1a"><mn id="S6.SS2.p2.3.m3.1.1" xref="S6.SS2.p2.3.m3.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.3.m3.1b"><cn type="float" id="S6.SS2.p2.3.m3.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.3.m3.1c">0.1</annotation></semantics></math>, there is hardly any difference from IID distribution with <math id="S6.SS2.p2.4.m4.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S6.SS2.p2.4.m4.1a"><mrow id="S6.SS2.p2.4.m4.1.1" xref="S6.SS2.p2.4.m4.1.1.cmml"><mi id="S6.SS2.p2.4.m4.1.1.2" xref="S6.SS2.p2.4.m4.1.1.2.cmml">α</mi><mo id="S6.SS2.p2.4.m4.1.1.1" xref="S6.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.4.m4.1.1.3" xref="S6.SS2.p2.4.m4.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.4.m4.1b"><apply id="S6.SS2.p2.4.m4.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1"><eq id="S6.SS2.p2.4.m4.1.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1.1"></eq><ci id="S6.SS2.p2.4.m4.1.1.2.cmml" xref="S6.SS2.p2.4.m4.1.1.2">𝛼</ci><cn type="integer" id="S6.SS2.p2.4.m4.1.1.3.cmml" xref="S6.SS2.p2.4.m4.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.4.m4.1c">\alpha=1000</annotation></semantics></math> except for WikiArt on which the accuracy drops by approximately 3%. After further increasing the level of data heterogeneity by decreasing <math id="S6.SS2.p2.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS2.p2.5.m5.1a"><mi id="S6.SS2.p2.5.m5.1.1" xref="S6.SS2.p2.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.5.m5.1b"><ci id="S6.SS2.p2.5.m5.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.5.m5.1c">\alpha</annotation></semantics></math> to <math id="S6.SS2.p2.6.m6.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S6.SS2.p2.6.m6.1a"><mn id="S6.SS2.p2.6.m6.1.1" xref="S6.SS2.p2.6.m6.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.6.m6.1b"><cn type="float" id="S6.SS2.p2.6.m6.1.1.cmml" xref="S6.SS2.p2.6.m6.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.6.m6.1c">0.01</annotation></semantics></math>, results are roughly the same on R8 and WikiArt. However, on CIFAR-10 and MINDS-14, model performance degrades by approximately 14% in accuracy and 10% in word error rate, respectively. This is caused by severe client drift due to data heterogeneity as shown previously in Appendix A.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p">For Sentiment140 and Speech Commands which are both non-IID by natural factors, we can see from Figure <a href="#S6.F5" title="Figure 5 ‣ VI-B Data Heterogeneity ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that the model achieves similar performance on the latter with both IID and non-IID distributions. This is likely due to the similar sample distributions by class shown in Appendix A. However, on the Sentiment140 dataset, the model performs noticeably better under IID data partitioning with approximately 4% improvement. Since Sentiment140 is a binary classification dataset, some clients may only hold samples of a single class even if it is not partitioned to have a non-IID label distribution. This leads to a relatively high level of data heterogeneity which is realistic in practice due to users having different interests and habits.</p>
</div>
<figure id="S6.F4" class="ltx_figure"><img src="/html/2405.06368/assets/x5.png" id="S6.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="253" height="278" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Model performance with IID and non-IID data partitioning with the level of data heterogeneity being controlled by sampling from Dirichlet distribution.</figcaption>
</figure>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2405.06368/assets/x6.png" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="253" height="138" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Model performance with IID and non-IID data partitioning with the level of data heterogeneity being controlled by natural factors.</figcaption>
</figure>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.1" class="ltx_p">These results indicate that on most datasets such as R8, CIFAR-10 and Speech Commands, there is no noticeable gap between model performance with IID and non-IID data distribution under DP-FL assuming a reasonable level of data heterogeneity. When working with extremely skewed non-IID data where each client possesses samples of a single class only, a significant performance drop can sometimes be observed such as in the case of CIFAR-10 and MINDS-14. Other than this special case, our results show that the performance drop in DP-FL is mainly caused by the added noise for DP guarantee rather than data heterogeneity.</p>
</div>
<div id="S6.SS2.p5" class="ltx_para ltx_noindent">
<p id="S6.SS2.p5.1" class="ltx_p"><span id="S6.SS2.p5.1.1" class="ltx_text ltx_font_bold">Take-aways</span></p>
</div>
<div id="S6.SS2.p6" class="ltx_para">
<ul id="S6.SS2.p6.1" class="ltx_itemize">
<li id="S6.I2.i1" class="ltx_item" style="list-style-type:none;"> 
<div id="S6.I2.i1.p1" class="ltx_para">
<p id="S6.I2.i1.p1.1" class="ltx_p">Data heterogeneity may further degrade model performance under DP-FL. This leads to worse privacy-utility trade-offs.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS3.5.1.1" class="ltx_text">VI-C</span> </span><span id="S6.SS3.6.2" class="ltx_text ltx_font_italic">Parameter-efficient Fine-tuning</span>
</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> have started utilising parameter-efficient fine-tuning (PEFT) methods to fine-tune transformer models with differential privacy via both central and federate learning. Apart from the obvious benefits of lower computation and communication cost, the primary motivation originates from the proven fact that fewer trainable parameters lead to better privacy-utility trade-offs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.1" class="ltx_p">We thereby start with comparing model training via full fine-tuning and parameter-efficient fine-tuning with the same number of clients and privacy budget. Here, we use LoRA as an example of PEFT methods as it’s empirically proven to be superior to other popular PEFT methods on natural language understanding tasks in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and is used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> for research on DP-FL.</p>
</div>
<figure id="S6.F6" class="ltx_figure"><img src="/html/2405.06368/assets/x7.png" id="S6.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="253" height="407" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Model performance with different number of clients in production and privacy budgets.</figcaption>
</figure>
<div id="S6.SS3.p3" class="ltx_para">
<p id="S6.SS3.p3.1" class="ltx_p">As shown in Figure <a href="#S6.F6" title="Figure 6 ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, private models fine-tuned with LoRA significantly outperform those obtained via full fine-tuning on all tasks except for CIFAR-10, where the performance gap between non-private and differentially private training is relatively small. However, on other tasks such as Sentiment140, R8 and Speech Commands, parameter-efficient fine-tuning unlike full fine-tuning allows us to achieve most performance of non-private federated learning with only 1 million clients and a stringent privacy budget of <math id="S6.SS3.p3.1.m1.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S6.SS3.p3.1.m1.1a"><mrow id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml"><mi id="S6.SS3.p3.1.m1.1.1.2" xref="S6.SS3.p3.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS3.p3.1.m1.1.1.1" xref="S6.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS3.p3.1.m1.1.1.3" xref="S6.SS3.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.m1.1b"><apply id="S6.SS3.p3.1.m1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1"><eq id="S6.SS3.p3.1.m1.1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1.1"></eq><ci id="S6.SS3.p3.1.m1.1.1.2.cmml" xref="S6.SS3.p3.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS3.p3.1.m1.1.1.3.cmml" xref="S6.SS3.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.m1.1c">\epsilon=2</annotation></semantics></math>. Moreover, when LoRA is applied, the number of trainable parameters decreases to approximately 1% of that of full fine-tuning. This not only helps reduce computation cost on both the server and client devices but also makes communication between the server and clients much cheaper. Since only the trainable parameters need to be shared, this also serves as an effective solution for potential communication bottleneck when deploying large models in IoT systems.</p>
</div>
<div id="S6.SS3.p4" class="ltx_para">
<p id="S6.SS3.p4.1" class="ltx_p">Next, we benchmark exising PEFT methods under DP-FL. We experiment with PEFT methods including Adapter, Compacter, BitFit and LoRA which are often considered in existing works on parameter-efficient fine-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. Our benchmark covers three different domains including natural language understanding (NLU), computer vision (CV) and speech, similar to our previous experiments. Regarding datasets, we again choose to use Sentiment140/R8 for NLU, CIFAR-10/WikiArt for CV and Speech Commands V1/MINDS-14 for the speech domain.</p>
</div>
<div id="S6.SS3.p5" class="ltx_para">
<p id="S6.SS3.p5.4" class="ltx_p"><span id="S6.SS3.p5.4.1" class="ltx_text ltx_font_bold">Hyperparameter:</span> For federated learning and privacy parameters, we use 1 million users, a subsampling rate of 1%, <math id="S6.SS3.p5.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS3.p5.1.m1.1a"><mi id="S6.SS3.p5.1.m1.1.1" xref="S6.SS3.p5.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.1.m1.1b"><ci id="S6.SS3.p5.1.m1.1.1.cmml" xref="S6.SS3.p5.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.1.m1.1c">\epsilon</annotation></semantics></math>=2, and <math id="S6.SS3.p5.2.m2.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S6.SS3.p5.2.m2.1a"><mi id="S6.SS3.p5.2.m2.1.1" xref="S6.SS3.p5.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.2.m2.1b"><ci id="S6.SS3.p5.2.m2.1.1.cmml" xref="S6.SS3.p5.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.2.m2.1c">\delta</annotation></semantics></math>=1e-6 for all five datasets. For clipping threshold, we search over three values {0.1, 1.0, 10.0}. For Sentiment140, we train for 300 rounds and search over five learning rates {5e-2, 1e-1, 2e-1, 5e-1, 1e-0}. For R8, we train for 200 rounds and search over four learning rates {1e-1, 2e-1, 5e-1, 1e-0}. For CIFAR-10, we train for 100 rounds and search over four learning rates {2e-2, 5e-2, 1e-1, 2e-1}. For WikiArt, we train for 200 rounds and search over four learning rates {5e-2, 1e-1, 2e-1, 5e-1}. For Speech Commands V1, we train for 300 rounds and search over four learning rates {2e-1, 5e-1, 1e-0, 2e-0}. For MINDS-14, we train for 2000 rounds and search over four learning rates {2e-2, 5e-2, 1e-1, 2e-1}. Regarding parameters for DP-Adapter, DP-Compacter and DP-LoRA, we choose to use <math id="S6.SS3.p5.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS3.p5.3.m3.1a"><mi id="S6.SS3.p5.3.m3.1.1" xref="S6.SS3.p5.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.3.m3.1b"><ci id="S6.SS3.p5.3.m3.1.1.cmml" xref="S6.SS3.p5.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.3.m3.1c">r</annotation></semantics></math>=16 for all three methods and additionally <math id="S6.SS3.p5.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.SS3.p5.4.m4.1a"><mi id="S6.SS3.p5.4.m4.1.1" xref="S6.SS3.p5.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.4.m4.1b"><ci id="S6.SS3.p5.4.m4.1.1.cmml" xref="S6.SS3.p5.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.4.m4.1c">n</annotation></semantics></math>=8 for DP-Compacter which are derived from previous works including <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.</p>
</div>
<figure id="S6.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Accuracy of parameter-efficient fine-tuning methods on five classification datasets.</figcaption>
<table id="S6.T4.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T4.1.1.1" class="ltx_tr">
<td id="S6.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S6.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">Sent140</span></td>
<td id="S6.T4.1.1.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">R8</span></td>
<td id="S6.T4.1.1.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.4.1" class="ltx_text ltx_font_bold">Trained params</span></td>
<td id="S6.T4.1.1.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.5.1" class="ltx_text ltx_font_bold">CIFAR-10</span></td>
<td id="S6.T4.1.1.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.6.1" class="ltx_text ltx_font_bold">WikiArt</span></td>
<td id="S6.T4.1.1.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.7.1" class="ltx_text ltx_font_bold">Trained params</span></td>
<td id="S6.T4.1.1.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.8.1" class="ltx_text ltx_font_bold">SC V1</span></td>
<td id="S6.T4.1.1.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.9.1" class="ltx_text ltx_font_bold">Trained params</span></td>
<td id="S6.T4.1.1.1.10" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.10.1" class="ltx_text ltx_font_bold">Avg.</span></td>
</tr>
<tr id="S6.T4.1.2.2" class="ltx_tr">
<td id="S6.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">DP-Adapter</td>
<td id="S6.T4.1.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">70.7</td>
<td id="S6.T4.1.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">86.0</td>
<td id="S6.T4.1.2.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">0.93%</td>
<td id="S6.T4.1.2.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">45.2</td>
<td id="S6.T4.1.2.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">47.7</td>
<td id="S6.T4.1.2.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.06%</td>
<td id="S6.T4.1.2.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">87.9</td>
<td id="S6.T4.1.2.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.09%</td>
<td id="S6.T4.1.2.2.10" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">67.5</td>
</tr>
<tr id="S6.T4.1.3.3" class="ltx_tr">
<td id="S6.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">DP-Compacter</td>
<td id="S6.T4.1.3.3.2" class="ltx_td ltx_align_left ltx_border_r">65.3</td>
<td id="S6.T4.1.3.3.3" class="ltx_td ltx_align_left ltx_border_r">76.2</td>
<td id="S6.T4.1.3.3.4" class="ltx_td ltx_align_left ltx_border_r">0.059%</td>
<td id="S6.T4.1.3.3.5" class="ltx_td ltx_align_left ltx_border_r">35.1</td>
<td id="S6.T4.1.3.3.6" class="ltx_td ltx_align_left ltx_border_r">43.6</td>
<td id="S6.T4.1.3.3.7" class="ltx_td ltx_align_left ltx_border_r">0.15%</td>
<td id="S6.T4.1.3.3.8" class="ltx_td ltx_align_left ltx_border_r">86.9</td>
<td id="S6.T4.1.3.3.9" class="ltx_td ltx_align_left ltx_border_r">0.90%</td>
<td id="S6.T4.1.3.3.10" class="ltx_td ltx_align_left ltx_border_r">61.4</td>
</tr>
<tr id="S6.T4.1.4.4" class="ltx_tr">
<td id="S6.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">DP-BitFit</td>
<td id="S6.T4.1.4.4.2" class="ltx_td ltx_align_left ltx_border_r">66.3</td>
<td id="S6.T4.1.4.4.3" class="ltx_td ltx_align_left ltx_border_r">77.6</td>
<td id="S6.T4.1.4.4.4" class="ltx_td ltx_align_left ltx_border_r">0.096%</td>
<td id="S6.T4.1.4.4.5" class="ltx_td ltx_align_left ltx_border_r">89.9</td>
<td id="S6.T4.1.4.4.6" class="ltx_td ltx_align_left ltx_border_r">49.7</td>
<td id="S6.T4.1.4.4.7" class="ltx_td ltx_align_left ltx_border_r">0.25%</td>
<td id="S6.T4.1.4.4.8" class="ltx_td ltx_align_left ltx_border_r">59.7</td>
<td id="S6.T4.1.4.4.9" class="ltx_td ltx_align_left ltx_border_r">0.94%</td>
<td id="S6.T4.1.4.4.10" class="ltx_td ltx_align_left ltx_border_r">68.6</td>
</tr>
<tr id="S6.T4.1.5.5" class="ltx_tr">
<td id="S6.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">LoRA (r=16, w/o DP)</td>
<td id="S6.T4.1.5.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">73.6</td>
<td id="S6.T4.1.5.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">96.0</td>
<td id="S6.T4.1.5.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">0.48%</td>
<td id="S6.T4.1.5.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">95.3</td>
<td id="S6.T4.1.5.5.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">81.0</td>
<td id="S6.T4.1.5.5.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1.37%</td>
<td id="S6.T4.1.5.5.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">95.5</td>
<td id="S6.T4.1.5.5.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.11%</td>
<td id="S6.T4.1.5.5.10" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">88.2</td>
</tr>
<tr id="S6.T4.1.6.6" class="ltx_tr">
<td id="S6.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">DP-LoRA (r=16)</td>
<td id="S6.T4.1.6.6.2" class="ltx_td ltx_align_left ltx_border_r">70.4</td>
<td id="S6.T4.1.6.6.3" class="ltx_td ltx_align_left ltx_border_r">90.0</td>
<td id="S6.T4.1.6.6.4" class="ltx_td ltx_align_left ltx_border_r">0.48%</td>
<td id="S6.T4.1.6.6.5" class="ltx_td ltx_align_left ltx_border_r">90.6</td>
<td id="S6.T4.1.6.6.6" class="ltx_td ltx_align_left ltx_border_r">61.7</td>
<td id="S6.T4.1.6.6.7" class="ltx_td ltx_align_left ltx_border_r">1.37%</td>
<td id="S6.T4.1.6.6.8" class="ltx_td ltx_align_left ltx_border_r">92.5</td>
<td id="S6.T4.1.6.6.9" class="ltx_td ltx_align_left ltx_border_r">2.11%</td>
<td id="S6.T4.1.6.6.10" class="ltx_td ltx_align_left ltx_border_r">81.0</td>
</tr>
<tr id="S6.T4.1.7.7" class="ltx_tr">
<td id="S6.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">LoRA (r=8, w/o DP)</td>
<td id="S6.T4.1.7.7.2" class="ltx_td ltx_align_left ltx_border_r">73.3</td>
<td id="S6.T4.1.7.7.3" class="ltx_td ltx_align_left ltx_border_r">97.0</td>
<td id="S6.T4.1.7.7.4" class="ltx_td ltx_align_left ltx_border_r">0.25%</td>
<td id="S6.T4.1.7.7.5" class="ltx_td ltx_align_left ltx_border_r">94.9</td>
<td id="S6.T4.1.7.7.6" class="ltx_td ltx_align_left ltx_border_r">81.1</td>
<td id="S6.T4.1.7.7.7" class="ltx_td ltx_align_left ltx_border_r">0.71%</td>
<td id="S6.T4.1.7.7.8" class="ltx_td ltx_align_left ltx_border_r">96.3</td>
<td id="S6.T4.1.7.7.9" class="ltx_td ltx_align_left ltx_border_r">1.91%</td>
<td id="S6.T4.1.7.7.10" class="ltx_td ltx_align_left ltx_border_r">88.1</td>
</tr>
<tr id="S6.T4.1.8.8" class="ltx_tr">
<td id="S6.T4.1.8.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">DP-LoRA (r=8)</td>
<td id="S6.T4.1.8.8.2" class="ltx_td ltx_align_left ltx_border_r">70.7</td>
<td id="S6.T4.1.8.8.3" class="ltx_td ltx_align_left ltx_border_r">92.0</td>
<td id="S6.T4.1.8.8.4" class="ltx_td ltx_align_left ltx_border_r">0.25%</td>
<td id="S6.T4.1.8.8.5" class="ltx_td ltx_align_left ltx_border_r">92.6</td>
<td id="S6.T4.1.8.8.6" class="ltx_td ltx_align_left ltx_border_r">63.5</td>
<td id="S6.T4.1.8.8.7" class="ltx_td ltx_align_left ltx_border_r">0.71%</td>
<td id="S6.T4.1.8.8.8" class="ltx_td ltx_align_left ltx_border_r">92.9</td>
<td id="S6.T4.1.8.8.9" class="ltx_td ltx_align_left ltx_border_r">1.91%</td>
<td id="S6.T4.1.8.8.10" class="ltx_td ltx_align_left ltx_border_r">82.3</td>
</tr>
<tr id="S6.T4.1.9.9" class="ltx_tr">
<td id="S6.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">LoRA (r=1, w/o DP)</td>
<td id="S6.T4.1.9.9.2" class="ltx_td ltx_align_left ltx_border_r">73.0</td>
<td id="S6.T4.1.9.9.3" class="ltx_td ltx_align_left ltx_border_r">81.4</td>
<td id="S6.T4.1.9.9.4" class="ltx_td ltx_align_left ltx_border_r">0.056%</td>
<td id="S6.T4.1.9.9.5" class="ltx_td ltx_align_left ltx_border_r">95.2</td>
<td id="S6.T4.1.9.9.6" class="ltx_td ltx_align_left ltx_border_r">82.2</td>
<td id="S6.T4.1.9.9.7" class="ltx_td ltx_align_left ltx_border_r">0.12%</td>
<td id="S6.T4.1.9.9.8" class="ltx_td ltx_align_left ltx_border_r">96.1</td>
<td id="S6.T4.1.9.9.9" class="ltx_td ltx_align_left ltx_border_r">1.73%</td>
<td id="S6.T4.1.9.9.10" class="ltx_td ltx_align_left ltx_border_r">85.5</td>
</tr>
<tr id="S6.T4.1.10.10" class="ltx_tr">
<td id="S6.T4.1.10.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">DP-LoRA (r=1)</td>
<td id="S6.T4.1.10.10.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T4.1.10.10.2.1" class="ltx_text ltx_font_bold">72.5</span></td>
<td id="S6.T4.1.10.10.3" class="ltx_td ltx_align_left ltx_border_r">80.3</td>
<td id="S6.T4.1.10.10.4" class="ltx_td ltx_align_left ltx_border_r">0.056%</td>
<td id="S6.T4.1.10.10.5" class="ltx_td ltx_align_left ltx_border_r">90.3</td>
<td id="S6.T4.1.10.10.6" class="ltx_td ltx_align_left ltx_border_r">58.8</td>
<td id="S6.T4.1.10.10.7" class="ltx_td ltx_align_left ltx_border_r">0.12%</td>
<td id="S6.T4.1.10.10.8" class="ltx_td ltx_align_left ltx_border_r">85.1</td>
<td id="S6.T4.1.10.10.9" class="ltx_td ltx_align_left ltx_border_r">1.73%</td>
<td id="S6.T4.1.10.10.10" class="ltx_td ltx_align_left ltx_border_r">77.4</td>
</tr>
<tr id="S6.T4.1.11.11" class="ltx_tr">
<td id="S6.T4.1.11.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">DyLoRA (w/o DP)</td>
<td id="S6.T4.1.11.11.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">72.0</td>
<td id="S6.T4.1.11.11.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">96.6</td>
<td id="S6.T4.1.11.11.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">0.48%</td>
<td id="S6.T4.1.11.11.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">94.8</td>
<td id="S6.T4.1.11.11.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">77.4</td>
<td id="S6.T4.1.11.11.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1.37%</td>
<td id="S6.T4.1.11.11.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">95.5</td>
<td id="S6.T4.1.11.11.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.11%</td>
<td id="S6.T4.1.11.11.10" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">87.2</td>
</tr>
<tr id="S6.T4.1.12.12" class="ltx_tr">
<td id="S6.T4.1.12.12.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">DP-DyLoRA</td>
<td id="S6.T4.1.12.12.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">72.0</td>
<td id="S6.T4.1.12.12.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T4.1.12.12.3.1" class="ltx_text ltx_font_bold">96.2</span></td>
<td id="S6.T4.1.12.12.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">0.48%</td>
<td id="S6.T4.1.12.12.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T4.1.12.12.5.1" class="ltx_text ltx_font_bold">94.4</span></td>
<td id="S6.T4.1.12.12.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T4.1.12.12.6.1" class="ltx_text ltx_font_bold">75.5</span></td>
<td id="S6.T4.1.12.12.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">1.37%</td>
<td id="S6.T4.1.12.12.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T4.1.12.12.8.1" class="ltx_text ltx_font_bold">93.9</span></td>
<td id="S6.T4.1.12.12.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">2.11%</td>
<td id="S6.T4.1.12.12.10" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T4.1.12.12.10.1" class="ltx_text ltx_font_bold">86.4</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>WER of parameter-efficient fine-tuning methods on the MINDS-14 dataset for automatic speech recognition.</figcaption>
<table id="S6.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T5.1.1.1" class="ltx_tr">
<th id="S6.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S6.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S6.T5.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S6.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">MINDS-14</span></th>
<th id="S6.T5.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S6.T5.1.1.1.3.1" class="ltx_text ltx_font_bold">Trained params</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T5.1.2.1" class="ltx_tr">
<th id="S6.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">DP-Adapter</th>
<td id="S6.T5.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">68.7</td>
<td id="S6.T5.1.2.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1.35%</td>
</tr>
<tr id="S6.T5.1.3.2" class="ltx_tr">
<th id="S6.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DP-Compacter</th>
<td id="S6.T5.1.3.2.2" class="ltx_td ltx_align_left ltx_border_r">67.6</td>
<td id="S6.T5.1.3.2.3" class="ltx_td ltx_align_left ltx_border_r">0.14%</td>
</tr>
<tr id="S6.T5.1.4.3" class="ltx_tr">
<th id="S6.T5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DP-BitFit</th>
<td id="S6.T5.1.4.3.2" class="ltx_td ltx_align_left ltx_border_r">85.2</td>
<td id="S6.T5.1.4.3.3" class="ltx_td ltx_align_left ltx_border_r">0.18%</td>
</tr>
<tr id="S6.T5.1.5.4" class="ltx_tr">
<th id="S6.T5.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">LoRA (r=16, w/o DP)</th>
<td id="S6.T5.1.5.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">51.7</td>
<td id="S6.T5.1.5.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">0.62%</td>
</tr>
<tr id="S6.T5.1.6.5" class="ltx_tr">
<th id="S6.T5.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DP-LoRA (r=16)</th>
<td id="S6.T5.1.6.5.2" class="ltx_td ltx_align_left ltx_border_r">69.3</td>
<td id="S6.T5.1.6.5.3" class="ltx_td ltx_align_left ltx_border_r">0.62%</td>
</tr>
<tr id="S6.T5.1.7.6" class="ltx_tr">
<th id="S6.T5.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">LoRA (r=8, w/o DP)</th>
<td id="S6.T5.1.7.6.2" class="ltx_td ltx_align_left ltx_border_r">53.1</td>
<td id="S6.T5.1.7.6.3" class="ltx_td ltx_align_left ltx_border_r">0.41%</td>
</tr>
<tr id="S6.T5.1.8.7" class="ltx_tr">
<th id="S6.T5.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DP-LoRA (r=8)</th>
<td id="S6.T5.1.8.7.2" class="ltx_td ltx_align_left ltx_border_r">75.9</td>
<td id="S6.T5.1.8.7.3" class="ltx_td ltx_align_left ltx_border_r">0.41%</td>
</tr>
<tr id="S6.T5.1.9.8" class="ltx_tr">
<th id="S6.T5.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">LoRA (r=1, w/o DP)</th>
<td id="S6.T5.1.9.8.2" class="ltx_td ltx_align_left ltx_border_r">80.8</td>
<td id="S6.T5.1.9.8.3" class="ltx_td ltx_align_left ltx_border_r">0.23%</td>
</tr>
<tr id="S6.T5.1.10.9" class="ltx_tr">
<th id="S6.T5.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DP-LoRA (r=1)</th>
<td id="S6.T5.1.10.9.2" class="ltx_td ltx_align_left ltx_border_r">81.6</td>
<td id="S6.T5.1.10.9.3" class="ltx_td ltx_align_left ltx_border_r">0.23%</td>
</tr>
<tr id="S6.T5.1.11.10" class="ltx_tr">
<th id="S6.T5.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">DyLoRA (w/o DP)</th>
<td id="S6.T5.1.11.10.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">55.6</td>
<td id="S6.T5.1.11.10.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">0.62%</td>
</tr>
<tr id="S6.T5.1.12.11" class="ltx_tr">
<th id="S6.T5.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">DP-DyLoRA</th>
<td id="S6.T5.1.12.11.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><span id="S6.T5.1.12.11.2.1" class="ltx_text ltx_font_bold">58.0</span></td>
<td id="S6.T5.1.12.11.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">0.62%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS3.p6" class="ltx_para">
<p id="S6.SS3.p6.1" class="ltx_p"><span id="S6.SS3.p6.1.1" class="ltx_text ltx_font_bold">Results:</span> Our benchmarking results covering DP-Adapter, DP-Compacter, DP-BitFit and DP-LoRA across three different domains are shown in Table <a href="#S6.T4" title="TABLE IV ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and <a href="#S6.T5" title="TABLE V ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>. On Sentiment140, DP-Adapter achieves the best accuracy of 70.7% which is marginally higher than an accuracy of 70.4% achieved by DP-LoRA. On R8, DP-LoRA gives the best accuracy of 90.0%. The accuracy achieved by DP-Compacter and DP-BitFit are noticeably worse on the two text classification datasets. For image classification on CIFAR-10 and WikiArt, DP-LoRA achieves the best accuracy of 90.6% and 61.7% respectively, followed by 89.9% on CIFAR-10 and 49.7% on WikiArt produced by DP-BitFit. On CIFAR-10, both DP-Adapter and DP-Compacter suffer from slow and unstable convergence which subsequently leads to much worse accuracy achieved. On Speech Commands V1, DP-LoRA once again achieves the best accuracy of 92.5%. The performance of the other three DP-PEFT methods are all worse than DP-LoRA by a noticeable gap on this dataset. The word error rates (WERs) of 68.7% and 67.6% achieved by DP-Adapter and DP-Compacter respectively are slightly better than DP-LoRA with 69.3%.</p>
</div>
<div id="S6.SS3.p7" class="ltx_para">
<p id="S6.SS3.p7.1" class="ltx_p">Since our benchmarking results from Section <a href="#S6.SS3" title="VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a> show that DP-LoRA achieves the best performance under DP-FL amongst all DP-PEFT methods, we run additionally experiments for LoRA under non-private federated learning to investigate the performance drop caused by providing DP guarantee. As we can see from Table <a href="#S6.T4" title="TABLE IV ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and <a href="#S6.T5" title="TABLE V ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, the average accuracy of 81.0% achieved by DP-LoRA is noticeably lower than the average accuracy of 88.2% under non-private FL.</p>
</div>
<div id="S6.SS3.p8" class="ltx_para ltx_noindent">
<p id="S6.SS3.p8.1" class="ltx_p"><span id="S6.SS3.p8.1.1" class="ltx_text ltx_font_bold">Take-aways</span></p>
</div>
<div id="S6.SS3.p9" class="ltx_para">
<ul id="S6.SS3.p9.1" class="ltx_itemize">
<li id="S6.I3.i1" class="ltx_item" style="list-style-type:none;"> 
<div id="S6.I3.i1.p1" class="ltx_para">
<p id="S6.I3.i1.p1.1" class="ltx_p">Overall, DP-LoRA outperforms other existing DP-PEFT methods under DP-FL for training large transformer-based models on-device. However, noticeable performance degradation can still be observed with a strong privacy budget of <math id="S6.I3.i1.p1.1.m1.1" class="ltx_Math" alttext="\bm{\epsilon}" display="inline"><semantics id="S6.I3.i1.p1.1.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S6.I3.i1.p1.1.m1.1.1" xref="S6.I3.i1.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.I3.i1.p1.1.m1.1b"><ci id="S6.I3.i1.p1.1.m1.1.1.cmml" xref="S6.I3.i1.p1.1.m1.1.1">bold-italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I3.i1.p1.1.m1.1c">\bm{\epsilon}</annotation></semantics></math>=2 and 1 million clients (over 7% in accuracy and over 17% in WER).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS4.5.1.1" class="ltx_text">VI-D</span> </span><span id="S6.SS4.6.2" class="ltx_text ltx_font_italic">DP-DyLoRA</span>
</h3>

<div id="S6.SS4.p1" class="ltx_para">
<p id="S6.SS4.p1.1" class="ltx_p">We therefore propose DP-DyLoRA, which has better privacy-utility trade-offs than DP-LoRA under DP-FL due to fewer trainable parameters to be shared in most communication rounds.</p>
</div>
<div id="S6.SS4.p2" class="ltx_para">
<p id="S6.SS4.p2.1" class="ltx_p">Like DyLoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, DP-DyLoRA trains LoRA weights for a variable rank instead of a fixed rank. When applied to DP-FL, each sampled client will train the LoRA weights for the same rank that is within a predefined range at each communication round. This means that all clients sampled at the same round will update exactly the same parameters of the model in order to provide DP guarantee. We empirically prove that DP-DyLoRA outperforms existing DP-PEFT methods including DP-LoRA under DP-FL.</p>
</div>
<div id="S6.SS4.p3" class="ltx_para">
<p id="S6.SS4.p3.6" class="ltx_p"><span id="S6.SS4.p3.6.1" class="ltx_text ltx_font_bold">Hyperparameter:</span> We opt for the same federated learning and privacy parameters, and search over the same clipping thresholds and learning rates as in Section <a href="#S6.SS3" title="VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a>. As for parameters specific to DyLoRA, we set minimum and maximum ranks to <math id="S6.SS4.p3.1.m1.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="S6.SS4.p3.1.m1.1a"><msub id="S6.SS4.p3.1.m1.1.1" xref="S6.SS4.p3.1.m1.1.1.cmml"><mi id="S6.SS4.p3.1.m1.1.1.2" xref="S6.SS4.p3.1.m1.1.1.2.cmml">r</mi><mrow id="S6.SS4.p3.1.m1.1.1.3" xref="S6.SS4.p3.1.m1.1.1.3.cmml"><mi id="S6.SS4.p3.1.m1.1.1.3.2" xref="S6.SS4.p3.1.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.1.m1.1.1.3.1" xref="S6.SS4.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.1.m1.1.1.3.3" xref="S6.SS4.p3.1.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.1.m1.1.1.3.1a" xref="S6.SS4.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.1.m1.1.1.3.4" xref="S6.SS4.p3.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.1.m1.1b"><apply id="S6.SS4.p3.1.m1.1.1.cmml" xref="S6.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS4.p3.1.m1.1.1.1.cmml" xref="S6.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S6.SS4.p3.1.m1.1.1.2.cmml" xref="S6.SS4.p3.1.m1.1.1.2">𝑟</ci><apply id="S6.SS4.p3.1.m1.1.1.3.cmml" xref="S6.SS4.p3.1.m1.1.1.3"><times id="S6.SS4.p3.1.m1.1.1.3.1.cmml" xref="S6.SS4.p3.1.m1.1.1.3.1"></times><ci id="S6.SS4.p3.1.m1.1.1.3.2.cmml" xref="S6.SS4.p3.1.m1.1.1.3.2">𝑚</ci><ci id="S6.SS4.p3.1.m1.1.1.3.3.cmml" xref="S6.SS4.p3.1.m1.1.1.3.3">𝑖</ci><ci id="S6.SS4.p3.1.m1.1.1.3.4.cmml" xref="S6.SS4.p3.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.1.m1.1c">r_{min}</annotation></semantics></math>=1 and <math id="S6.SS4.p3.2.m2.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="S6.SS4.p3.2.m2.1a"><msub id="S6.SS4.p3.2.m2.1.1" xref="S6.SS4.p3.2.m2.1.1.cmml"><mi id="S6.SS4.p3.2.m2.1.1.2" xref="S6.SS4.p3.2.m2.1.1.2.cmml">r</mi><mrow id="S6.SS4.p3.2.m2.1.1.3" xref="S6.SS4.p3.2.m2.1.1.3.cmml"><mi id="S6.SS4.p3.2.m2.1.1.3.2" xref="S6.SS4.p3.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.2.m2.1.1.3.1" xref="S6.SS4.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.2.m2.1.1.3.3" xref="S6.SS4.p3.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.2.m2.1.1.3.1a" xref="S6.SS4.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.2.m2.1.1.3.4" xref="S6.SS4.p3.2.m2.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.2.m2.1b"><apply id="S6.SS4.p3.2.m2.1.1.cmml" xref="S6.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS4.p3.2.m2.1.1.1.cmml" xref="S6.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S6.SS4.p3.2.m2.1.1.2.cmml" xref="S6.SS4.p3.2.m2.1.1.2">𝑟</ci><apply id="S6.SS4.p3.2.m2.1.1.3.cmml" xref="S6.SS4.p3.2.m2.1.1.3"><times id="S6.SS4.p3.2.m2.1.1.3.1.cmml" xref="S6.SS4.p3.2.m2.1.1.3.1"></times><ci id="S6.SS4.p3.2.m2.1.1.3.2.cmml" xref="S6.SS4.p3.2.m2.1.1.3.2">𝑚</ci><ci id="S6.SS4.p3.2.m2.1.1.3.3.cmml" xref="S6.SS4.p3.2.m2.1.1.3.3">𝑎</ci><ci id="S6.SS4.p3.2.m2.1.1.3.4.cmml" xref="S6.SS4.p3.2.m2.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.2.m2.1c">r_{max}</annotation></semantics></math>=16. For DyLoRA, we perform evaluation at the server side at the end of every 10 rounds since each rank between <math id="S6.SS4.p3.3.m3.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="S6.SS4.p3.3.m3.1a"><msub id="S6.SS4.p3.3.m3.1.1" xref="S6.SS4.p3.3.m3.1.1.cmml"><mi id="S6.SS4.p3.3.m3.1.1.2" xref="S6.SS4.p3.3.m3.1.1.2.cmml">r</mi><mrow id="S6.SS4.p3.3.m3.1.1.3" xref="S6.SS4.p3.3.m3.1.1.3.cmml"><mi id="S6.SS4.p3.3.m3.1.1.3.2" xref="S6.SS4.p3.3.m3.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.3.m3.1.1.3.1" xref="S6.SS4.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.3.m3.1.1.3.3" xref="S6.SS4.p3.3.m3.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.3.m3.1.1.3.1a" xref="S6.SS4.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.3.m3.1.1.3.4" xref="S6.SS4.p3.3.m3.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.3.m3.1b"><apply id="S6.SS4.p3.3.m3.1.1.cmml" xref="S6.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS4.p3.3.m3.1.1.1.cmml" xref="S6.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S6.SS4.p3.3.m3.1.1.2.cmml" xref="S6.SS4.p3.3.m3.1.1.2">𝑟</ci><apply id="S6.SS4.p3.3.m3.1.1.3.cmml" xref="S6.SS4.p3.3.m3.1.1.3"><times id="S6.SS4.p3.3.m3.1.1.3.1.cmml" xref="S6.SS4.p3.3.m3.1.1.3.1"></times><ci id="S6.SS4.p3.3.m3.1.1.3.2.cmml" xref="S6.SS4.p3.3.m3.1.1.3.2">𝑚</ci><ci id="S6.SS4.p3.3.m3.1.1.3.3.cmml" xref="S6.SS4.p3.3.m3.1.1.3.3">𝑖</ci><ci id="S6.SS4.p3.3.m3.1.1.3.4.cmml" xref="S6.SS4.p3.3.m3.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.3.m3.1c">r_{min}</annotation></semantics></math> and <math id="S6.SS4.p3.4.m4.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="S6.SS4.p3.4.m4.1a"><msub id="S6.SS4.p3.4.m4.1.1" xref="S6.SS4.p3.4.m4.1.1.cmml"><mi id="S6.SS4.p3.4.m4.1.1.2" xref="S6.SS4.p3.4.m4.1.1.2.cmml">r</mi><mrow id="S6.SS4.p3.4.m4.1.1.3" xref="S6.SS4.p3.4.m4.1.1.3.cmml"><mi id="S6.SS4.p3.4.m4.1.1.3.2" xref="S6.SS4.p3.4.m4.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.4.m4.1.1.3.1" xref="S6.SS4.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.4.m4.1.1.3.3" xref="S6.SS4.p3.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p3.4.m4.1.1.3.1a" xref="S6.SS4.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p3.4.m4.1.1.3.4" xref="S6.SS4.p3.4.m4.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.4.m4.1b"><apply id="S6.SS4.p3.4.m4.1.1.cmml" xref="S6.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS4.p3.4.m4.1.1.1.cmml" xref="S6.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S6.SS4.p3.4.m4.1.1.2.cmml" xref="S6.SS4.p3.4.m4.1.1.2">𝑟</ci><apply id="S6.SS4.p3.4.m4.1.1.3.cmml" xref="S6.SS4.p3.4.m4.1.1.3"><times id="S6.SS4.p3.4.m4.1.1.3.1.cmml" xref="S6.SS4.p3.4.m4.1.1.3.1"></times><ci id="S6.SS4.p3.4.m4.1.1.3.2.cmml" xref="S6.SS4.p3.4.m4.1.1.3.2">𝑚</ci><ci id="S6.SS4.p3.4.m4.1.1.3.3.cmml" xref="S6.SS4.p3.4.m4.1.1.3.3">𝑎</ci><ci id="S6.SS4.p3.4.m4.1.1.3.4.cmml" xref="S6.SS4.p3.4.m4.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.4.m4.1c">r_{max}</annotation></semantics></math> needs to be evaluated. On Sentiment140 and R8, we apply gradient clipping to DyLoRA under non-private FL as well since the model fails to converge otherwise. We additionally experiment with <math id="S6.SS4.p3.5.m5.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p3.5.m5.1a"><mi id="S6.SS4.p3.5.m5.1.1" xref="S6.SS4.p3.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.5.m5.1b"><ci id="S6.SS4.p3.5.m5.1.1.cmml" xref="S6.SS4.p3.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.5.m5.1c">r</annotation></semantics></math>={1, 8} with <math id="S6.SS4.p3.6.m6.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS4.p3.6.m6.1a"><mi id="S6.SS4.p3.6.m6.1.1" xref="S6.SS4.p3.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.6.m6.1b"><ci id="S6.SS4.p3.6.m6.1.1.cmml" xref="S6.SS4.p3.6.m6.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.6.m6.1c">\epsilon</annotation></semantics></math>=2 for both DP-LoRA and DP-DyLoRA for a more comprehensive comparison.</p>
</div>
<div id="S6.SS4.p4" class="ltx_para">
<p id="S6.SS4.p4.4" class="ltx_p"><span id="S6.SS4.p4.4.1" class="ltx_text ltx_font_bold">Results:</span> As we can see from Table <a href="#S6.T4" title="TABLE IV ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and <a href="#S6.T5" title="TABLE V ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, DP-DyLoRA achieves an accuracy of 72.0% on Sentiment140 which is noticeably better than all existing DP-PEFT methods except for DP-LoRA with <math id="S6.SS4.p4.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p4.1.m1.1a"><mi id="S6.SS4.p4.1.m1.1.1" xref="S6.SS4.p4.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p4.1.m1.1b"><ci id="S6.SS4.p4.1.m1.1.1.cmml" xref="S6.SS4.p4.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p4.1.m1.1c">r</annotation></semantics></math>=1 which achieves a marginally better accuracy of 72.5%. On the other datasets including R8, CIFAR-10, WikiArt, Speech Commands V1 and MINDS-14, DP-DyLoRA outperforms all other DP-PEFT methods including DP-LoRA with <math id="S6.SS4.p4.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p4.2.m2.1a"><mi id="S6.SS4.p4.2.m2.1.1" xref="S6.SS4.p4.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p4.2.m2.1b"><ci id="S6.SS4.p4.2.m2.1.1.cmml" xref="S6.SS4.p4.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p4.2.m2.1c">r</annotation></semantics></math>={1, 8, 16}. Overall, DP-DyLoRA achieves a much better performance under DP-FL with an average accuracy of 86.4% as opposed to the 77.4%, 82.2% and 81.0% average accuracy achieved by DP-LoRA with <math id="S6.SS4.p4.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p4.3.m3.1a"><mi id="S6.SS4.p4.3.m3.1.1" xref="S6.SS4.p4.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p4.3.m3.1b"><ci id="S6.SS4.p4.3.m3.1.1.cmml" xref="S6.SS4.p4.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p4.3.m3.1c">r</annotation></semantics></math>={1, 8, 16}, respectively. Similarly, for automatic speech recognition (ASR) on MINDS-14, the WERs of 81.6%, 53.1% and 51.7% achieved by DP-LoRA with <math id="S6.SS4.p4.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p4.4.m4.1a"><mi id="S6.SS4.p4.4.m4.1.1" xref="S6.SS4.p4.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p4.4.m4.1b"><ci id="S6.SS4.p4.4.m4.1.1.cmml" xref="S6.SS4.p4.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p4.4.m4.1c">r</annotation></semantics></math>={1, 8, 16} respectively are significantly outperformed by DP-DyLoRA with a WER of 58.0%. We highlight the best accuracy or WER under DP-FL for each task and the best average accuracy across all five tasks in Table <a href="#S6.T4" title="TABLE IV ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and <a href="#S6.T5" title="TABLE V ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
<figure id="S6.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x8.png" id="S6.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="180" height="117" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x9.png" id="S6.F7.sf2.g1" class="ltx_graphics ltx_img_landscape" width="180" height="100" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x10.png" id="S6.F7.sf3.g1" class="ltx_graphics ltx_img_portrait" width="87" height="125" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>(a) and (b): LoRA performance on five different classification datasets under non-private and differentially private federated learning with increasing rank values; (c): Signal-to-noise ratio for LoRA with increasing rank values.</figcaption>
</figure>
<div id="S6.SS4.p5" class="ltx_para">
<p id="S6.SS4.p5.10" class="ltx_p">To better understand why DP-DyLoRA outperforms DP-LoRA, we plot the accuracy and WERs achieved by DP-LoRA with increasing rank values as well as the corresponding signal-to-noise ratio in Figure <a href="#S6.F7" title="Figure 7 ‣ VI-D DP-DyLoRA ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. As we can see, the best performance is achieved with <math id="S6.SS4.p5.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.1.m1.1a"><mi id="S6.SS4.p5.1.m1.1.1" xref="S6.SS4.p5.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.1.m1.1b"><ci id="S6.SS4.p5.1.m1.1.1.cmml" xref="S6.SS4.p5.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.1.m1.1c">r</annotation></semantics></math>=8 in most cases. Although the model has the fewest number of trainable parameters with <math id="S6.SS4.p5.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.2.m2.1a"><mi id="S6.SS4.p5.2.m2.1.1" xref="S6.SS4.p5.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.2.m2.1b"><ci id="S6.SS4.p5.2.m2.1.1.cmml" xref="S6.SS4.p5.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.2.m2.1c">r</annotation></semantics></math>=1 which subsequently leads to a higher signal-to-noise ratio as in Figure <a href="#S6.F7" title="Figure 7 ‣ VI-D DP-DyLoRA ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, the number of trainable parameters may also be insufficient for a given downstream task. This is especially the case when it comes to on-device models which are relatively small in size. On the other hand, with <math id="S6.SS4.p5.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.3.m3.1a"><mi id="S6.SS4.p5.3.m3.1.1" xref="S6.SS4.p5.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.3.m3.1b"><ci id="S6.SS4.p5.3.m3.1.1.cmml" xref="S6.SS4.p5.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.3.m3.1c">r</annotation></semantics></math>=16 or <math id="S6.SS4.p5.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.4.m4.1a"><mi id="S6.SS4.p5.4.m4.1.1" xref="S6.SS4.p5.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.4.m4.1b"><ci id="S6.SS4.p5.4.m4.1.1.cmml" xref="S6.SS4.p5.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.4.m4.1c">r</annotation></semantics></math>=32 as in the case of MINDS-14, the amount of added noise increases together with the number of trainable parameters which also hurts model performance. In other words, with our experimental settings, DP-LoRA with <math id="S6.SS4.p5.5.m5.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.5.m5.1a"><mi id="S6.SS4.p5.5.m5.1.1" xref="S6.SS4.p5.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.5.m5.1b"><ci id="S6.SS4.p5.5.m5.1.1.cmml" xref="S6.SS4.p5.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.5.m5.1c">r</annotation></semantics></math>=8 has a better balance between model expressiveness and the amount of added noise than other rank values. Regrading DP-DyLoRA, for <math id="S6.SS4.p5.6.m6.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="S6.SS4.p5.6.m6.1a"><msub id="S6.SS4.p5.6.m6.1.1" xref="S6.SS4.p5.6.m6.1.1.cmml"><mi id="S6.SS4.p5.6.m6.1.1.2" xref="S6.SS4.p5.6.m6.1.1.2.cmml">r</mi><mrow id="S6.SS4.p5.6.m6.1.1.3" xref="S6.SS4.p5.6.m6.1.1.3.cmml"><mi id="S6.SS4.p5.6.m6.1.1.3.2" xref="S6.SS4.p5.6.m6.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p5.6.m6.1.1.3.1" xref="S6.SS4.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p5.6.m6.1.1.3.3" xref="S6.SS4.p5.6.m6.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p5.6.m6.1.1.3.1a" xref="S6.SS4.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p5.6.m6.1.1.3.4" xref="S6.SS4.p5.6.m6.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.6.m6.1b"><apply id="S6.SS4.p5.6.m6.1.1.cmml" xref="S6.SS4.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S6.SS4.p5.6.m6.1.1.1.cmml" xref="S6.SS4.p5.6.m6.1.1">subscript</csymbol><ci id="S6.SS4.p5.6.m6.1.1.2.cmml" xref="S6.SS4.p5.6.m6.1.1.2">𝑟</ci><apply id="S6.SS4.p5.6.m6.1.1.3.cmml" xref="S6.SS4.p5.6.m6.1.1.3"><times id="S6.SS4.p5.6.m6.1.1.3.1.cmml" xref="S6.SS4.p5.6.m6.1.1.3.1"></times><ci id="S6.SS4.p5.6.m6.1.1.3.2.cmml" xref="S6.SS4.p5.6.m6.1.1.3.2">𝑚</ci><ci id="S6.SS4.p5.6.m6.1.1.3.3.cmml" xref="S6.SS4.p5.6.m6.1.1.3.3">𝑖</ci><ci id="S6.SS4.p5.6.m6.1.1.3.4.cmml" xref="S6.SS4.p5.6.m6.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.6.m6.1c">r_{min}</annotation></semantics></math>=1 and <math id="S6.SS4.p5.7.m7.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="S6.SS4.p5.7.m7.1a"><msub id="S6.SS4.p5.7.m7.1.1" xref="S6.SS4.p5.7.m7.1.1.cmml"><mi id="S6.SS4.p5.7.m7.1.1.2" xref="S6.SS4.p5.7.m7.1.1.2.cmml">r</mi><mrow id="S6.SS4.p5.7.m7.1.1.3" xref="S6.SS4.p5.7.m7.1.1.3.cmml"><mi id="S6.SS4.p5.7.m7.1.1.3.2" xref="S6.SS4.p5.7.m7.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p5.7.m7.1.1.3.1" xref="S6.SS4.p5.7.m7.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p5.7.m7.1.1.3.3" xref="S6.SS4.p5.7.m7.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S6.SS4.p5.7.m7.1.1.3.1a" xref="S6.SS4.p5.7.m7.1.1.3.1.cmml">​</mo><mi id="S6.SS4.p5.7.m7.1.1.3.4" xref="S6.SS4.p5.7.m7.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.7.m7.1b"><apply id="S6.SS4.p5.7.m7.1.1.cmml" xref="S6.SS4.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS4.p5.7.m7.1.1.1.cmml" xref="S6.SS4.p5.7.m7.1.1">subscript</csymbol><ci id="S6.SS4.p5.7.m7.1.1.2.cmml" xref="S6.SS4.p5.7.m7.1.1.2">𝑟</ci><apply id="S6.SS4.p5.7.m7.1.1.3.cmml" xref="S6.SS4.p5.7.m7.1.1.3"><times id="S6.SS4.p5.7.m7.1.1.3.1.cmml" xref="S6.SS4.p5.7.m7.1.1.3.1"></times><ci id="S6.SS4.p5.7.m7.1.1.3.2.cmml" xref="S6.SS4.p5.7.m7.1.1.3.2">𝑚</ci><ci id="S6.SS4.p5.7.m7.1.1.3.3.cmml" xref="S6.SS4.p5.7.m7.1.1.3.3">𝑎</ci><ci id="S6.SS4.p5.7.m7.1.1.3.4.cmml" xref="S6.SS4.p5.7.m7.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.7.m7.1c">r_{max}</annotation></semantics></math>=16, DP-DyLoRA has the same number of trainable parameters at the server side as DP-LoRA with <math id="S6.SS4.p5.8.m8.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.8.m8.1a"><mi id="S6.SS4.p5.8.m8.1.1" xref="S6.SS4.p5.8.m8.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.8.m8.1b"><ci id="S6.SS4.p5.8.m8.1.1.cmml" xref="S6.SS4.p5.8.m8.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.8.m8.1c">r</annotation></semantics></math>=16 and only updates a portion of the trainable weights. This makes it so that DP-DyLoRA has the same level of model expressiveness as DP-LoRA with <math id="S6.SS4.p5.9.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.9.m9.1a"><mi id="S6.SS4.p5.9.m9.1.1" xref="S6.SS4.p5.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.9.m9.1b"><ci id="S6.SS4.p5.9.m9.1.1.cmml" xref="S6.SS4.p5.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.9.m9.1c">r</annotation></semantics></math>=16 while having similar signal-to-noise ratio as DP-LoRA with <math id="S6.SS4.p5.10.m10.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S6.SS4.p5.10.m10.1a"><mi id="S6.SS4.p5.10.m10.1.1" xref="S6.SS4.p5.10.m10.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p5.10.m10.1b"><ci id="S6.SS4.p5.10.m10.1.1.cmml" xref="S6.SS4.p5.10.m10.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p5.10.m10.1c">r</annotation></semantics></math>=8. Hence, DP-DyLoRA achieves a better privacy-utility trade-off then DP-LoRA which leads to better DP-FL performance.</p>
</div>
<div id="S6.SS4.p6" class="ltx_para">
<p id="S6.SS4.p6.1" class="ltx_p">Another interesting finding from our results shown in Table <a href="#S6.T4" title="TABLE IV ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and <a href="#S6.T5" title="TABLE V ‣ VI-C Parameter-efficient Fine-tuning ‣ VI Experiments ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> is that DyLoRA actually performs slightly worse than LoRA in non-private FL. We notice that DyLoRA training tends to be unstable in FL setting with a reasonably large learning rate. This is especially obvious during the early training stage. These results therefore show that the partial update of LoRA weights makes DyLoRA more sensitive to data heterogeneity. One possible remedy is to apply gradient clipping, which is mandatory under DP-FL. We show DyLoRA training under non-private FL on Sentiment140 both with and without gradient clipping applied in Appendix B.</p>
</div>
<div id="S6.SS4.p7" class="ltx_para ltx_noindent">
<p id="S6.SS4.p7.1" class="ltx_p"><span id="S6.SS4.p7.1.1" class="ltx_text ltx_font_bold">Take-aways</span></p>
</div>
<div id="S6.SS4.p8" class="ltx_para">
<ul id="S6.SS4.p8.1" class="ltx_itemize">
<li id="S6.I4.i1" class="ltx_item" style="list-style-type:none;"> 
<div id="S6.I4.i1.p1" class="ltx_para">
<p id="S6.I4.i1.p1.1" class="ltx_p">DP-DyLoRA significantly outperforms existing DP-PEFT methods including DP-LoRA. Compared to LoRA or DyLoRA under non-private FL, DP-DyLoRA achieves less than 2% accuracy drop for CV and NLU and less than 7% WER increase for ASR with a strong privacy budget of <math id="S6.I4.i1.p1.1.m1.1" class="ltx_Math" alttext="\bm{\epsilon}" display="inline"><semantics id="S6.I4.i1.p1.1.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S6.I4.i1.p1.1.m1.1.1" xref="S6.I4.i1.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.I4.i1.p1.1.m1.1b"><ci id="S6.I4.i1.p1.1.m1.1.1.cmml" xref="S6.I4.i1.p1.1.m1.1.1">bold-italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I4.i1.p1.1.m1.1c">\bm{\epsilon}</annotation></semantics></math>=2 and 1 million clients.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this article, we present DP-DyLoRA, a novel differentially private federated learning (DP-FL) algorithm to mitigate the impact of noise addition under DP constraints. We show with empirical results that DP-DyLoRA outperforms the state-of-the-art method DP-LoRA on six datasets across three different domains with less than 2% accuracy loss and 7% word error rate (WER) increase from non-private LoRA (or DyLoRA) with a stringent privacy budget of <math id="S7.p1.1.m1.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S7.p1.1.m1.1a"><mrow id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mi id="S7.p1.1.m1.1.1.2" xref="S7.p1.1.m1.1.1.2.cmml">ϵ</mi><mo id="S7.p1.1.m1.1.1.1" xref="S7.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.p1.1.m1.1.1.3" xref="S7.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><eq id="S7.p1.1.m1.1.1.1.cmml" xref="S7.p1.1.m1.1.1.1"></eq><ci id="S7.p1.1.m1.1.1.2.cmml" xref="S7.p1.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S7.p1.1.m1.1.1.3.cmml" xref="S7.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">\epsilon=2</annotation></semantics></math> and 1 million clients. In particular, our analysis shows that DP-DyLoRA suffers less from the trade-off between model expressiveness and amount of noise added due to DP guarantees which leads to better privacy-utility trade-offs under DP-FL.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Sample Distribution</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">Figures <a href="#A1.F8" title="Figure 8 ‣ Appendix A Sample Distribution ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#A1.F9" title="Figure 9 ‣ Appendix A Sample Distribution ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> visualise the sample distribution per client of all datasets we use on randomly chosen clients. In Figure <a href="#A1.F8" title="Figure 8 ‣ Appendix A Sample Distribution ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, both Sentiment140 and Speech Commands are non-IID by natural factors and therefore only have IID and non-IID settings. For both IID and non-IID distributions, the sample distributions appear to be fairly even across all classes which is the expected behaviour since neither of the two datasets is non-IID by label.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.8" class="ltx_p">The sample distributions of the remaining four datasets are shown in Figure <a href="#A1.F9" title="Figure 9 ‣ Appendix A Sample Distribution ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> with <math id="A1.p2.1.m1.3" class="ltx_Math" alttext="\alpha=[0.01,0.1,1000]" display="inline"><semantics id="A1.p2.1.m1.3a"><mrow id="A1.p2.1.m1.3.4" xref="A1.p2.1.m1.3.4.cmml"><mi id="A1.p2.1.m1.3.4.2" xref="A1.p2.1.m1.3.4.2.cmml">α</mi><mo id="A1.p2.1.m1.3.4.1" xref="A1.p2.1.m1.3.4.1.cmml">=</mo><mrow id="A1.p2.1.m1.3.4.3.2" xref="A1.p2.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.p2.1.m1.3.4.3.2.1" xref="A1.p2.1.m1.3.4.3.1.cmml">[</mo><mn id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">0.01</mn><mo id="A1.p2.1.m1.3.4.3.2.2" xref="A1.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.p2.1.m1.2.2" xref="A1.p2.1.m1.2.2.cmml">0.1</mn><mo id="A1.p2.1.m1.3.4.3.2.3" xref="A1.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.p2.1.m1.3.3" xref="A1.p2.1.m1.3.3.cmml">1000</mn><mo stretchy="false" id="A1.p2.1.m1.3.4.3.2.4" xref="A1.p2.1.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.3b"><apply id="A1.p2.1.m1.3.4.cmml" xref="A1.p2.1.m1.3.4"><eq id="A1.p2.1.m1.3.4.1.cmml" xref="A1.p2.1.m1.3.4.1"></eq><ci id="A1.p2.1.m1.3.4.2.cmml" xref="A1.p2.1.m1.3.4.2">𝛼</ci><list id="A1.p2.1.m1.3.4.3.1.cmml" xref="A1.p2.1.m1.3.4.3.2"><cn type="float" id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">0.01</cn><cn type="float" id="A1.p2.1.m1.2.2.cmml" xref="A1.p2.1.m1.2.2">0.1</cn><cn type="integer" id="A1.p2.1.m1.3.3.cmml" xref="A1.p2.1.m1.3.3">1000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.3c">\alpha=[0.01,0.1,1000]</annotation></semantics></math>. When <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\alpha</annotation></semantics></math> is set to 1000, the dataset will have an IID label distribution which is why we can see an even distribution across all classes on these datasets with <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">α</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">=</mo><mn id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><eq id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1"></eq><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝛼</ci><cn type="integer" id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\alpha=1000</annotation></semantics></math>. As <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">\alpha</annotation></semantics></math> approaches <math id="A1.p2.5.m5.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.p2.5.m5.1a"><mn id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><cn type="integer" id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">0</cn></annotation-xml></semantics></math>, the distribution becomes more and more non-IID. Hence, with <math id="A1.p2.6.m6.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.p2.6.m6.1a"><mrow id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">α</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">=</mo><mn id="A1.p2.6.m6.1.1.3" xref="A1.p2.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><eq id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1"></eq><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝛼</ci><cn type="float" id="A1.p2.6.m6.1.1.3.cmml" xref="A1.p2.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\alpha=0.1</annotation></semantics></math>, most clients only possess samples from two to three classes. After further decreasing <math id="A1.p2.7.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.p2.7.m7.1a"><mi id="A1.p2.7.m7.1.1" xref="A1.p2.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.p2.7.m7.1b"><ci id="A1.p2.7.m7.1.1.cmml" xref="A1.p2.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.7.m7.1c">\alpha</annotation></semantics></math> to <math id="A1.p2.8.m8.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.p2.8.m8.1a"><mn id="A1.p2.8.m8.1.1" xref="A1.p2.8.m8.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.p2.8.m8.1b"><cn type="float" id="A1.p2.8.m8.1.1.cmml" xref="A1.p2.8.m8.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.8.m8.1c">0.01</annotation></semantics></math>, nearly all clients hold samples of a single class, leading to an extremely non-IID label distribution.</p>
</div>
<figure id="A1.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x11.png" id="A1.F8.sf1.g1" class="ltx_graphics ltx_img_square" width="100" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Sentiment140 (IID)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x12.png" id="A1.F8.sf2.g1" class="ltx_graphics ltx_img_square" width="100" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Sentiment140 (Non-IID)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x13.png" id="A1.F8.sf3.g1" class="ltx_graphics ltx_img_square" width="100" height="100" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Speech Commands V1 (IID)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x14.png" id="A1.F8.sf4.g1" class="ltx_graphics ltx_img_square" width="100" height="100" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Speech Commands V1 (Non-IID)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Sample distribution with IID and non-IID partitioning for datasets which are non-IID by natural factors.</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x15.png" id="A1.F9.sf1.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>R8 (<math id="A1.F9.sf1.2.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A1.F9.sf1.2.m1.1b"><mrow id="A1.F9.sf1.2.m1.1.1" xref="A1.F9.sf1.2.m1.1.1.cmml"><mi id="A1.F9.sf1.2.m1.1.1.2" xref="A1.F9.sf1.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf1.2.m1.1.1.1" xref="A1.F9.sf1.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf1.2.m1.1.1.3" xref="A1.F9.sf1.2.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf1.2.m1.1c"><apply id="A1.F9.sf1.2.m1.1.1.cmml" xref="A1.F9.sf1.2.m1.1.1"><eq id="A1.F9.sf1.2.m1.1.1.1.cmml" xref="A1.F9.sf1.2.m1.1.1.1"></eq><ci id="A1.F9.sf1.2.m1.1.1.2.cmml" xref="A1.F9.sf1.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F9.sf1.2.m1.1.1.3.cmml" xref="A1.F9.sf1.2.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf1.2.m1.1d">\alpha=1000</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x16.png" id="A1.F9.sf2.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>R8 (<math id="A1.F9.sf2.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F9.sf2.2.m1.1b"><mrow id="A1.F9.sf2.2.m1.1.1" xref="A1.F9.sf2.2.m1.1.1.cmml"><mi id="A1.F9.sf2.2.m1.1.1.2" xref="A1.F9.sf2.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf2.2.m1.1.1.1" xref="A1.F9.sf2.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf2.2.m1.1.1.3" xref="A1.F9.sf2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf2.2.m1.1c"><apply id="A1.F9.sf2.2.m1.1.1.cmml" xref="A1.F9.sf2.2.m1.1.1"><eq id="A1.F9.sf2.2.m1.1.1.1.cmml" xref="A1.F9.sf2.2.m1.1.1.1"></eq><ci id="A1.F9.sf2.2.m1.1.1.2.cmml" xref="A1.F9.sf2.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf2.2.m1.1.1.3.cmml" xref="A1.F9.sf2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf2.2.m1.1d">\alpha=0.1</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x17.png" id="A1.F9.sf3.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>R8 (<math id="A1.F9.sf3.2.m1.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="A1.F9.sf3.2.m1.1b"><mrow id="A1.F9.sf3.2.m1.1.1" xref="A1.F9.sf3.2.m1.1.1.cmml"><mi id="A1.F9.sf3.2.m1.1.1.2" xref="A1.F9.sf3.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf3.2.m1.1.1.1" xref="A1.F9.sf3.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf3.2.m1.1.1.3" xref="A1.F9.sf3.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf3.2.m1.1c"><apply id="A1.F9.sf3.2.m1.1.1.cmml" xref="A1.F9.sf3.2.m1.1.1"><eq id="A1.F9.sf3.2.m1.1.1.1.cmml" xref="A1.F9.sf3.2.m1.1.1.1"></eq><ci id="A1.F9.sf3.2.m1.1.1.2.cmml" xref="A1.F9.sf3.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf3.2.m1.1.1.3.cmml" xref="A1.F9.sf3.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf3.2.m1.1d">\alpha=0.01</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x18.png" id="A1.F9.sf4.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>CIFAR-10 (<math id="A1.F9.sf4.2.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A1.F9.sf4.2.m1.1b"><mrow id="A1.F9.sf4.2.m1.1.1" xref="A1.F9.sf4.2.m1.1.1.cmml"><mi id="A1.F9.sf4.2.m1.1.1.2" xref="A1.F9.sf4.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf4.2.m1.1.1.1" xref="A1.F9.sf4.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf4.2.m1.1.1.3" xref="A1.F9.sf4.2.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf4.2.m1.1c"><apply id="A1.F9.sf4.2.m1.1.1.cmml" xref="A1.F9.sf4.2.m1.1.1"><eq id="A1.F9.sf4.2.m1.1.1.1.cmml" xref="A1.F9.sf4.2.m1.1.1.1"></eq><ci id="A1.F9.sf4.2.m1.1.1.2.cmml" xref="A1.F9.sf4.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F9.sf4.2.m1.1.1.3.cmml" xref="A1.F9.sf4.2.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf4.2.m1.1d">\alpha=1000</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x19.png" id="A1.F9.sf5.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>CIFAR-10 (<math id="A1.F9.sf5.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F9.sf5.2.m1.1b"><mrow id="A1.F9.sf5.2.m1.1.1" xref="A1.F9.sf5.2.m1.1.1.cmml"><mi id="A1.F9.sf5.2.m1.1.1.2" xref="A1.F9.sf5.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf5.2.m1.1.1.1" xref="A1.F9.sf5.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf5.2.m1.1.1.3" xref="A1.F9.sf5.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf5.2.m1.1c"><apply id="A1.F9.sf5.2.m1.1.1.cmml" xref="A1.F9.sf5.2.m1.1.1"><eq id="A1.F9.sf5.2.m1.1.1.1.cmml" xref="A1.F9.sf5.2.m1.1.1.1"></eq><ci id="A1.F9.sf5.2.m1.1.1.2.cmml" xref="A1.F9.sf5.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf5.2.m1.1.1.3.cmml" xref="A1.F9.sf5.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf5.2.m1.1d">\alpha=0.1</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F9.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x20.png" id="A1.F9.sf6.g1" class="ltx_graphics ltx_img_square" width="102" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>CIFAR-10 (<math id="A1.F9.sf6.2.m1.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="A1.F9.sf6.2.m1.1b"><mrow id="A1.F9.sf6.2.m1.1.1" xref="A1.F9.sf6.2.m1.1.1.cmml"><mi id="A1.F9.sf6.2.m1.1.1.2" xref="A1.F9.sf6.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf6.2.m1.1.1.1" xref="A1.F9.sf6.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf6.2.m1.1.1.3" xref="A1.F9.sf6.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf6.2.m1.1c"><apply id="A1.F9.sf6.2.m1.1.1.cmml" xref="A1.F9.sf6.2.m1.1.1"><eq id="A1.F9.sf6.2.m1.1.1.1.cmml" xref="A1.F9.sf6.2.m1.1.1.1"></eq><ci id="A1.F9.sf6.2.m1.1.1.2.cmml" xref="A1.F9.sf6.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf6.2.m1.1.1.3.cmml" xref="A1.F9.sf6.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf6.2.m1.1d">\alpha=0.01</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf7" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x21.png" id="A1.F9.sf7.g1" class="ltx_graphics ltx_img_square" width="102" height="101" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span>WikiArt (<math id="A1.F9.sf7.2.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A1.F9.sf7.2.m1.1b"><mrow id="A1.F9.sf7.2.m1.1.1" xref="A1.F9.sf7.2.m1.1.1.cmml"><mi id="A1.F9.sf7.2.m1.1.1.2" xref="A1.F9.sf7.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf7.2.m1.1.1.1" xref="A1.F9.sf7.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf7.2.m1.1.1.3" xref="A1.F9.sf7.2.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf7.2.m1.1c"><apply id="A1.F9.sf7.2.m1.1.1.cmml" xref="A1.F9.sf7.2.m1.1.1"><eq id="A1.F9.sf7.2.m1.1.1.1.cmml" xref="A1.F9.sf7.2.m1.1.1.1"></eq><ci id="A1.F9.sf7.2.m1.1.1.2.cmml" xref="A1.F9.sf7.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F9.sf7.2.m1.1.1.3.cmml" xref="A1.F9.sf7.2.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf7.2.m1.1d">\alpha=1000</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf8" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x22.png" id="A1.F9.sf8.g1" class="ltx_graphics ltx_img_square" width="102" height="101" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span>WikiArt (<math id="A1.F9.sf8.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F9.sf8.2.m1.1b"><mrow id="A1.F9.sf8.2.m1.1.1" xref="A1.F9.sf8.2.m1.1.1.cmml"><mi id="A1.F9.sf8.2.m1.1.1.2" xref="A1.F9.sf8.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf8.2.m1.1.1.1" xref="A1.F9.sf8.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf8.2.m1.1.1.3" xref="A1.F9.sf8.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf8.2.m1.1c"><apply id="A1.F9.sf8.2.m1.1.1.cmml" xref="A1.F9.sf8.2.m1.1.1"><eq id="A1.F9.sf8.2.m1.1.1.1.cmml" xref="A1.F9.sf8.2.m1.1.1.1"></eq><ci id="A1.F9.sf8.2.m1.1.1.2.cmml" xref="A1.F9.sf8.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf8.2.m1.1.1.3.cmml" xref="A1.F9.sf8.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf8.2.m1.1d">\alpha=0.1</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F9.sf9" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x23.png" id="A1.F9.sf9.g1" class="ltx_graphics ltx_img_square" width="102" height="101" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(i) </span>WikiArt (<math id="A1.F9.sf9.2.m1.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="A1.F9.sf9.2.m1.1b"><mrow id="A1.F9.sf9.2.m1.1.1" xref="A1.F9.sf9.2.m1.1.1.cmml"><mi id="A1.F9.sf9.2.m1.1.1.2" xref="A1.F9.sf9.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf9.2.m1.1.1.1" xref="A1.F9.sf9.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf9.2.m1.1.1.3" xref="A1.F9.sf9.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf9.2.m1.1c"><apply id="A1.F9.sf9.2.m1.1.1.cmml" xref="A1.F9.sf9.2.m1.1.1"><eq id="A1.F9.sf9.2.m1.1.1.1.cmml" xref="A1.F9.sf9.2.m1.1.1.1"></eq><ci id="A1.F9.sf9.2.m1.1.1.2.cmml" xref="A1.F9.sf9.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf9.2.m1.1.1.3.cmml" xref="A1.F9.sf9.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf9.2.m1.1d">\alpha=0.01</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf10" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x24.png" id="A1.F9.sf10.g1" class="ltx_graphics ltx_img_square" width="102" height="102" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(j) </span>MINDS-14 (<math id="A1.F9.sf10.2.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A1.F9.sf10.2.m1.1b"><mrow id="A1.F9.sf10.2.m1.1.1" xref="A1.F9.sf10.2.m1.1.1.cmml"><mi id="A1.F9.sf10.2.m1.1.1.2" xref="A1.F9.sf10.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf10.2.m1.1.1.1" xref="A1.F9.sf10.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf10.2.m1.1.1.3" xref="A1.F9.sf10.2.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf10.2.m1.1c"><apply id="A1.F9.sf10.2.m1.1.1.cmml" xref="A1.F9.sf10.2.m1.1.1"><eq id="A1.F9.sf10.2.m1.1.1.1.cmml" xref="A1.F9.sf10.2.m1.1.1.1"></eq><ci id="A1.F9.sf10.2.m1.1.1.2.cmml" xref="A1.F9.sf10.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F9.sf10.2.m1.1.1.3.cmml" xref="A1.F9.sf10.2.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf10.2.m1.1d">\alpha=1000</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf11" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x25.png" id="A1.F9.sf11.g1" class="ltx_graphics ltx_img_square" width="102" height="102" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(k) </span>MINDS-14 (<math id="A1.F9.sf11.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F9.sf11.2.m1.1b"><mrow id="A1.F9.sf11.2.m1.1.1" xref="A1.F9.sf11.2.m1.1.1.cmml"><mi id="A1.F9.sf11.2.m1.1.1.2" xref="A1.F9.sf11.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf11.2.m1.1.1.1" xref="A1.F9.sf11.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf11.2.m1.1.1.3" xref="A1.F9.sf11.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf11.2.m1.1c"><apply id="A1.F9.sf11.2.m1.1.1.cmml" xref="A1.F9.sf11.2.m1.1.1"><eq id="A1.F9.sf11.2.m1.1.1.1.cmml" xref="A1.F9.sf11.2.m1.1.1.1"></eq><ci id="A1.F9.sf11.2.m1.1.1.2.cmml" xref="A1.F9.sf11.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf11.2.m1.1.1.3.cmml" xref="A1.F9.sf11.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf11.2.m1.1d">\alpha=0.1</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F9.sf12" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.06368/assets/x26.png" id="A1.F9.sf12.g1" class="ltx_graphics ltx_img_square" width="102" height="102" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(l) </span>MINDS-14 (<math id="A1.F9.sf12.2.m1.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="A1.F9.sf12.2.m1.1b"><mrow id="A1.F9.sf12.2.m1.1.1" xref="A1.F9.sf12.2.m1.1.1.cmml"><mi id="A1.F9.sf12.2.m1.1.1.2" xref="A1.F9.sf12.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf12.2.m1.1.1.1" xref="A1.F9.sf12.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf12.2.m1.1.1.3" xref="A1.F9.sf12.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf12.2.m1.1c"><apply id="A1.F9.sf12.2.m1.1.1.cmml" xref="A1.F9.sf12.2.m1.1.1"><eq id="A1.F9.sf12.2.m1.1.1.1.cmml" xref="A1.F9.sf12.2.m1.1.1.1"></eq><ci id="A1.F9.sf12.2.m1.1.1.2.cmml" xref="A1.F9.sf12.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf12.2.m1.1.1.3.cmml" xref="A1.F9.sf12.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf12.2.m1.1d">\alpha=0.01</annotation></semantics></math>)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Sample distribution with IID and non-IID partitioning for datasets which are non-IID by sampling from Dirichlet distribution.</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>DyLoRA with Gradient Clipping</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">Figures <a href="#A2.F10" title="Figure 10 ‣ Appendix B DyLoRA with Gradient Clipping ‣ DP-DyLoRA: Fine-Tuning Transformer-Based Models On-Device under Differentially Private Federated Learning using Dynamic Low-Rank Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> shows the convergence of DyLoRA under non-private federated learning. The model only starts to learn after gradient clipping is applied.</p>
</div>
<figure id="A2.F10" class="ltx_figure"><img src="" id="A2.F10.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>DyLoRA performance on Sentiment140 under non-private federated learning both with and without gradient clipping applied.</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, L. u.
Kaiser, and I. Polosukhin, “Attention is all you need,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Advances
in Neural Information Processing Systems</em>, I. Guyon, U. V. Luxburg,
S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, Eds.,
vol. 30.   Curran Associates, Inc.,
2017. [Online]. Available:
<a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. Mehta and M. Rastegari, “Mobilevit: Light-weight, general-purpose, and
mobile-friendly vision transformer,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on
Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
I. Gim and J. Ko, “Memory-efficient dnn training on mobile devices,” in
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th Annual International Conference on Mobile
Systems, Applications and Services</em>, ser. MobiSys ’22.   New York, NY, USA: Association for Computing Machinery,
2022, p. 464–476. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/3498361.3539765" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3498361.3539765</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “BERT: Pre-training of
deep bidirectional transformers for language understanding,” in
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American Chapter of
the Association for Computational Linguistics: Human Language Technologies,
Volume 1 (Long and Short Papers)</em>, J. Burstein, C. Doran, and T. Solorio,
Eds.   Minneapolis, Minnesota:
Association for Computational Linguistics, Jun. 2019, pp. 4171–4186.
[Online]. Available: <a target="_blank" href="https://aclanthology.org/N19-1423" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/N19-1423</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Radford, K. Narasimhan, T. Salimans, I. Sutskever <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Improving
language understanding by generative pre-training,” 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y. Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
C. Dwork, F. McSherry, K. Nissim, and A. Smith, “Calibrating noise to
sensitivity in private data analysis,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Theory of Cryptography</em>,
S. Halevi and T. Rabin, Eds.   Berlin,
Heidelberg: Springer Berlin Heidelberg, 2006, pp. 265–284.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 2016 ACM SIGSAC Conference on Computer and Communications Security</em>,
ser. CCS ’16.   New York, NY, USA:
Association for Computing Machinery, 2016, p. 308–318. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/2976749.2978318" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/2976749.2978318</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
B. Balle, G. Barthe, and M. Gaboardi, “Privacy amplification by subsampling:
Tight analyses via couplings and divergences,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural
Information Processing Systems</em>, S. Bengio, H. Wallach, H. Larochelle,
K. Grauman, N. Cesa-Bianchi, and R. Garnett, Eds., vol. 31.   Curran Associates, Inc., 2018. [Online]. Available:
<a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2018/file/3b5020bb891119b9f5130f1fea9bd773-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2018/file/3b5020bb891119b9f5130f1fea9bd773-Paper.pdf</a>

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y.-X. Wang, B. Balle, and S. P. Kasiviswanathan, “Subsampled renyi
differential privacy and analytical moments accountant,” in
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twenty-Second International Conference on Artificial
Intelligence and Statistics</em>, ser. Proceedings of Machine Learning Research,
K. Chaudhuri and M. Sugiyama, Eds., vol. 89.   PMLR, 16–18 Apr 2019, pp. 1226–1235. [Online]. Available:
<a target="_blank" href="https://proceedings.mlr.press/v89/wang19b.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v89/wang19b.html</a>

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Zhu and Y.-X. Wang, “Poission subsampled rényi differential privacy,” in
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, K. Chaudhuri and
R. Salakhutdinov, Eds., vol. 97.   PMLR,
09–15 Jun 2019, pp. 7634–7642. [Online]. Available:
<a target="_blank" href="https://proceedings.mlr.press/v97/zhu19c.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v97/zhu19c.html</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
I. Mironov, K. Talwar, and L. Zhang, “Rényi differential privacy of the
sampled Gaussian mechanism,” 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
K. Bonawitz, V. Ivanov, B. Kreuter, A. Marcedone, H. B. McMahan, S. Patel,
D. Ramage, A. Segal, and K. Seth, “Practical secure aggregation for
privacy-preserving machine learning,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 ACM
SIGSAC Conference on Computer and Communications Security</em>, ser. CCS
’17.   New York, NY, USA: Association
for Computing Machinery, 2017. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/3133956.3133982" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3133956.3133982</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
J. Bell, K. A. Bonawitz, A. Gascon, T. Lepoint, and M. Raykova, “Secure
single-server vector aggregation with (poly)logarithmic overhead,” in
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM SIGSAC Conference on Computer and Communications
Security</em>, 2020. [Online]. Available: <a target="_blank" href="https://eprint.iacr.org/2020/704" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://eprint.iacr.org/2020/704</a>

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Goryczka and L. Xiong, “A comprehensive comparison of multiparty secure
additions with differential privacy,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Dependable
and Secure Computing</em>, vol. 14, no. 5, pp. 463–477, 2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
R. Bassily, A. Smith, and A. Thakurta, “Private empirical risk minimization:
Efficient algorithms and tight error bounds,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">2014 IEEE 55th Annual
Symposium on Foundations of Computer Science</em>, 2014, pp. 464–473.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Bun, J. Ullman, and S. Vadhan, “Fingerprinting codes and the price of
approximate differential privacy,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Forty-Sixth
Annual ACM Symposium on Theory of Computing</em>, ser. STOC ’14.   New York, NY, USA: Association for Computing
Machinery, 2014, p. 1–10. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/2591796.2591877" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/2591796.2591877</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 2016 ACM SIGSAC Conference on Computer and Communications Security</em>,
ser. CCS ’16.   New York, NY, USA:
Association for Computing Machinery, 2016, p. 308–318. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/2976749.2978318" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/2976749.2978318</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M. Xu, C. Song, Y. Tian, N. Agrawal, F. Granqvist, R. van Dalen, X. Zhang,
A. Argueta, S. Han, Y. Deng, L. Liu, A. Walia, and A. Jin, “Training
large-vocabulary neural language models by private federated learning for
resource-constrained devices,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ICASSP 2023 - 2023 IEEE
International Conference on Acoustics, Speech and Signal Processing
(ICASSP)</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Zhao, W. Du, F. Li, P. Li, and G. Liu, “Fedprompt: Communication-efficient
and privacy-preserving prompt tuning in federated learning,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICASSP
2023-2023 IEEE International Conference on Acoustics, Speech and Signal
Processing (ICASSP)</em>.   IEEE, 2023, pp.
1–5.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
C. Xie, D.-A. Huang, W. Chu, D. Xu, C. Xiao, B. Li, and A. Anandkumar,
“Perada: Parameter-efficient and generalizable federated learning
personalization with guarantees,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.06637</em>,
2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
M. Yun and B. Yuxin, “Research on the architecture and key technology of
internet of things (iot) applied on smart grid,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">2010 International
Conference on Advances in Energy Engineering</em>, 2010, pp. 69–72.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
N. Houlsby, A. Giurgiu, S. Jastrzebski, B. Morrone, Q. De Laroussilhe,
A. Gesmundo, M. Attariyan, and S. Gelly, “Parameter-efficient transfer
learning for NLP,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th International
Conference on Machine Learning</em>, ser. Proceedings of Machine Learning
Research, K. Chaudhuri and R. Salakhutdinov, Eds., vol. 97.   PMLR, 09–15 Jun 2019, pp. 2790–2799. [Online].
Available: <a target="_blank" href="https://proceedings.mlr.press/v97/houlsby19a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v97/houlsby19a.html</a>

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Bapna and O. Firat, “Simple, scalable adaptation for neural machine
translation,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical
Methods in Natural Language Processing and the 9th International Joint
Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, K. Inui, J. Jiang,
V. Ng, and X. Wan, Eds.   Hong Kong,
China: Association for Computational Linguistics, Nov. 2019, pp. 1538–1548.
[Online]. Available: <a target="_blank" href="https://aclanthology.org/D19-1165" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/D19-1165</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
J. Pfeiffer, A. Rücklé, C. Poth, A. Kamath, I. Vulić, S. Ruder,
K. Cho, and I. Gurevych, “AdapterHub: A framework for adapting
transformers,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 Conference on Empirical
Methods in Natural Language Processing: System Demonstrations</em>, Q. Liu and
D. Schlangen, Eds.   Online: Association
for Computational Linguistics, Oct. 2020, pp. 46–54. [Online]. Available:
<a target="_blank" href="https://aclanthology.org/2020.emnlp-demos.7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2020.emnlp-demos.7</a>

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
J. Pfeiffer, A. Kamath, A. Rücklé, K. Cho, and I. Gurevych,
“AdapterFusion: Non-destructive task composition for transfer
learning,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 16th Conference of the European
Chapter of the Association for Computational Linguistics: Main Volume</em>,
P. Merlo, J. Tiedemann, and R. Tsarfaty, Eds.   Online: Association for Computational Linguistics, Apr. 2021, pp.
487–503. [Online]. Available:
<a target="_blank" href="https://aclanthology.org/2021.eacl-main.39" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2021.eacl-main.39</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
R. K. mahabadi, J. Henderson, and S. Ruder, “Compacter: Efficient low-rank
hypercomplex adapter layers,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, A. Beygelzimer, Y. Dauphin, P. Liang, and J. W. Vaughan,
Eds., 2021. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=bqGK5PyI6-N" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=bqGK5PyI6-N</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
E. Ben Zaken, Y. Goldberg, and S. Ravfogel, “BitFit: Simple
parameter-efficient fine-tuning for transformer-based masked
language-models,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the
Association for Computational Linguistics (Volume 2: Short Papers)</em>,
S. Muresan, P. Nakov, and A. Villavicencio, Eds.   Dublin, Ireland: Association for Computational Linguistics, May
2022, pp. 1–9. [Online]. Available:
<a target="_blank" href="https://aclanthology.org/2022.acl-short.1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2022.acl-short.1</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and
W. Chen, “LoRA: Low-rank adaptation of large language models,” in
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022. [Online].
Available: <a target="_blank" href="https://openreview.net/forum?id=nZeVKeeFYf9" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=nZeVKeeFYf9</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
D. Yu, S. Naik, A. Backurs, S. Gopi, H. A. Inan, G. Kamath, J. Kulkarni, Y. T.
Lee, A. Manoel, L. Wutschitz, S. Yekhanin, and H. Zhang, “Differentially
private fine-tuning of language models,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International Conference
on Learning Representations</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=Q42f0dfjECO" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=Q42f0dfjECO</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
J. Chen, W. Xu, S. Guo, J. Wang, J. Zhang, and H. Wang, “Fedtune: A deep dive
into efficient federated fine-tuning with pre-trained transformers,”
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.08025</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
M. Valipour, M. Rezagholizadeh, I. Kobyzev, and A. Ghodsi, “DyLoRA:
Parameter-efficient tuning of pre-trained models using dynamic search-free
low-rank adaptation,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 17th Conference of the
European Chapter of the Association for Computational Linguistics</em>,
A. Vlachos and I. Augenstein, Eds.   Dubrovnik, Croatia: Association for Computational Linguistics, May 2023, pp.
3274–3287. [Online]. Available:
<a target="_blank" href="https://aclanthology.org/2023.eacl-main.239" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2023.eacl-main.239</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y. Arcas,
“Communication-Efficient Learning of Deep Networks from Decentralized
Data,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, ser. Proceedings of Machine Learning
Research, A. Singh and J. Zhu, Eds., vol. 54.   PMLR, 20–22 Apr 2017, pp. 1273–1282. [Online]. Available:
<a target="_blank" href="https://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v54/mcmahan17a.html</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Chen*, X. Pan*, R. Monga, S. Bengio, and R. Jozefowicz, “Revisiting
distributed synchronous SGD,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ICLR Workshop Track</em>, 2017.
[Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=D1VDZ5kMAu5jEJ1zfEWL" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=D1VDZ5kMAu5jEJ1zfEWL</a>

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. Reddi, S. Stich, and A. T. Suresh,
“Scaffold: Stochastic controlled averaging for federated learning,” in
<em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
T. Li, M. Sanjabi, A. Beirami, and V. Smith, “Fair resource allocation in
federated learning,” in <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, 2020. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=ByexElSYDr" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=ByexElSYDr</a>

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine learning and systems</em>, vol. 2, pp. 429–450, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
S. J. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečný,
S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” in
<em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021. [Online].
Available: <a target="_blank" href="https://openreview.net/forum?id=LkFG3lB13U5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=LkFG3lB13U5</a>

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
X. Li, K. Huang, W. Yang, S. Wang, and Z. Zhang, “On the convergence of fedavg
on non-iid data,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, 2020. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=HJxNAnVtDS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HJxNAnVtDS</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
J. Konečný, H. McMahan, D. Ramage, and P. Richtárik,
“Federated optimization: Distributed machine
learning for on-device intelligence,” ArXiv, WorkingPaper, Oct. 2016, 38
pages.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
M. Nasr, R. Shokri, and A. Houmansadr, “Comprehensive privacy analysis of deep
learning: Passive and active white-box inference attacks against centralized
and federated learning,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">2019 IEEE symposium on security and
privacy (SP)</em>.   IEEE, 2019, pp.
739–753.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
L. Zhu, Z. Liu, and S. Han, “Deep leakage from gradients,” in <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Advances
in Neural Information Processing Systems</em>, H. Wallach, H. Larochelle,
A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett,
Eds., vol. 32.   Curran Associates,
Inc., 2019. [Online]. Available:
<a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2019/file/60a6c4002cc7b29142def8871531281a-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2019/file/60a6c4002cc7b29142def8871531281a-Paper.pdf</a>

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
J. Geiping, H. Bauermeister, H. Dröge, and M. Moeller, “Inverting
gradients - how easy is it to break privacy in federated learning?” in
<em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, H. Larochelle,
M. Ranzato, R. Hadsell, M. Balcan, and H. Lin, Eds., vol. 33.   Curran Associates, Inc., 2020, pp. 16 937–16 947.
[Online]. Available:
<a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/c4ede56bbd98819ae6112b20ac6bf145-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2020/file/c4ede56bbd98819ae6112b20ac6bf145-Paper.pdf</a>

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
H. B. McMahan, D. Ramage, K. Talwar, and L. Zhang, “Learning differentially
private recurrent language models,” in <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">International Conference on
Learning Representations</em>, 2018. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=BJ0hF1Z0b" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=BJ0hF1Z0b</a>

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 2016 ACM SIGSAC Conference on Computer and Communications
Security</em>.   New York, NY, USA:
Association for Computing Machinery, 2016, p. 308–318. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1145/2976749.2978318" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/2976749.2978318</a>

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
C. Dwork, A. Roth <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “The algorithmic foundations of differential
privacy,” <em id="bib.bib47.2.2" class="ltx_emph ltx_font_italic">Foundations and Trends® in Theoretical
Computer Science</em>, vol. 9, no. 3–4, pp. 211–407, 2014.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
X. Li, F. Tramer, P. Liang, and T. Hashimoto, “Large language models can be
strong differentially private learners,” in <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">International Conference
on Learning Representations</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=bVuP3ltATMz" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=bVuP3ltATMz</a>

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
J. He, C. Zhou, X. Ma, T. Berg-Kirkpatrick, and G. Neubig, “Towards a unified
view of parameter-efficient transfer learning,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">International
Conference on Learning Representations</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=0RDcd5Axok" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=0RDcd5Axok</a>

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
C. Dwork, “Differential privacy,” in <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">International colloquium on
automata, languages, and programming</em>.   Springer, 2006, pp. 1–12.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
C. Dwork, A. Roth <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “The algorithmic foundations of differential
privacy,” <em id="bib.bib51.2.2" class="ltx_emph ltx_font_italic">Foundations and Trends® in Theoretical
Computer Science</em>, vol. 9, no. 3–4, pp. 211–407, 2014.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
P. Kairouz, Z. Liu, and T. Steinke, “The distributed discrete gaussian
mechanism for federated learning with secure aggregation,” in
<em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, M. Meila and T. Zhang, Eds.,
vol. 139.   PMLR, 18–24 Jul 2021, pp.
5201–5212. [Online]. Available:
<a target="_blank" href="https://proceedings.mlr.press/v139/kairouz21a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/kairouz21a.html</a>

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
D. Yu, H. Zhang, W. Chen, J. Yin, and T.-Y. Liu, “Large scale private learning
via low-rank reparametrization,” in <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</em>, ser. Proceedings of Machine
Learning Research, M. Meila and T. Zhang, Eds., vol. 139.   PMLR, 18–24 Jul 2021, pp. 12 208–12 218.
[Online]. Available: <a target="_blank" href="https://proceedings.mlr.press/v139/yu21f.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/yu21f.html</a>

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
R. Hönig, Y. Zhao, and R. Mullins, “DAdaQuant: Doubly-adaptive
quantization for communication-efficient federated learning,” in
<em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, K. Chaudhuri, S. Jegelka,
L. Song, C. Szepesvari, G. Niu, and S. Sabato, Eds., vol. 162.   PMLR, 17–23 Jul 2022, pp. 8852–8866. [Online].
Available: <a target="_blank" href="https://proceedings.mlr.press/v162/honig22a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/honig22a.html</a>

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
D. Lewis, “Reuters-21578 Text Categorization Collection,” UCI Machine
Learning Repository, 1997, DOI: https://doi.org/10.24432/C52G6M.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
A. Krizhevsky, G. Hinton <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning multiple layers of features
from tiny images,” 2009.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
B. Saleh and A. Elgammal, “Large-scale classification of fine-art paintings:
Learning the right metric on the right feature,” <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1505.00855</em>, 2015.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
A. Torralba, R. Fergus, and W. T. Freeman, “80 million tiny images: A large
data set for nonparametric object and scene recognition,” <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Pattern Analysis and Machine Intelligence</em>, vol. 30, no. 11,
pp. 1958–1970, 2008.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
J. H. Ro, T. Breiner, L. McConnaughey, M. Chen, A. T. Suresh, S. Kumar, and
R. Mathews, “Scaling language model size in cross-device federated
learning,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">ACL 2022 Workshop on Federated Learning for Natural
Language Processing</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=ShNG29KGF-c" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=ShNG29KGF-c</a>

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
X. Zhang, B. Song, M. Honarkhah, J. Ding, and M. Hong, “Building large machine
learning models from small distributed models: A layer matching approach,”
in <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Workshop on Federated Learning: Recent Advances and New Challenges
(in Conjunction with NeurIPS 2022)</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=vpXExByg5e5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=vpXExByg5e5</a>

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
M. Noble, A. Bellet, and A. Dieuleveut, “Differentially private federated
learning on heterogeneous data,” in <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Proceedings of The 25th
International Conference on Artificial Intelligence and Statistics</em>, ser.
Proceedings of Machine Learning Research, G. Camps-Valls, F. J. R. Ruiz, and
I. Valera, Eds., vol. 151.   PMLR,
28–30 Mar 2022, pp. 10 110–10 145. [Online]. Available:
<a target="_blank" href="https://proceedings.mlr.press/v151/noble22a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v151/noble22a.html</a>

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Z. Xu, Y. Zhang, G. Andrew, C. Choquette, P. Kairouz, B. Mcmahan,
J. Rosenstock, and Y. Zhang, “Federated learning of gboard language models
with differential privacy,” in <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 61st Annual Meeting
of the Association for Computational Linguistics (Volume 5: Industry Track)</em>,
S. Sitaram, B. Beigman Klebanov, and J. D. Williams, Eds.   Toronto, Canada: Association for Computational
Linguistics, Jul. 2023, pp. 629–639. [Online]. Available:
<a target="_blank" href="https://aclanthology.org/2023.acl-industry.60" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2023.acl-industry.60</a>

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai,
T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, J. Uszkoreit,
and N. Houlsby, “An image is worth 16x16 words: Transformers for image
recognition at scale,” in <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, 2021. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=YicbFdNTTy" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=YicbFdNTTy</a>

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
W.-N. Hsu, B. Bolte, Y.-H. H. Tsai, K. Lakhotia, R. Salakhutdinov, and
A. Mohamed, “Hubert: Self-supervised speech representation learning by
masked prediction of hidden units,” <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM Trans. Audio, Speech and
Lang. Proc.</em>, vol. 29, p. 3451–3460, oct 2021. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1109/TASLP.2021.3122291" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/TASLP.2021.3122291</a>

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
H.-J. Chang, S.-w. Yang, and H.-y. Lee, “Distilhubert: Speech representation
learning by layer-wise distillation of hidden-unit bert,” in <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">ICASSP
2022 - 2022 IEEE International Conference on Acoustics, Speech and Signal
Processing (ICASSP)</em>, 2022, pp. 7087–7091.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix,
B. Rozière, N. Goyal, E. Hambro, F. Azhar <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Llama: Open
and efficient foundation language models,” <em id="bib.bib66.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2302.13971</em>, 2023.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
H. Touvron, L. Martin, K. Stone, P. Albert, A. Almahairi, Y. Babaei,
N. Bashlykov, S. Batra, P. Bhargava, S. Bhosale <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Llama 2:
Open foundation and fine-tuned chat models,” <em id="bib.bib67.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2307.09288</em>, 2023.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
OpenAI, “Gpt-4 technical report,” <em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2303.08774, 2023.
[Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:257532815" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:257532815</a>

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
T. Lin, L. Kong, S. U. Stich, and M. Jaggi, “Ensemble distillation for robust
model fusion in federated learning,” vol. 33, 2020, pp. 2351–2363.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
M. Luo, F. Chen, D. Hu, Y. Zhang, J. Liang, and J. Feng, “No fear of
heterogeneity: Classifier calibration for federated learning with non-IID
data,” in <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
A. Beygelzimer, Y. Dauphin, P. Liang, and J. W. Vaughan, Eds., 2021.
[Online]. Available: <a target="_blank" href="https://openreview.net/forum?id=AFiH_CNnVhS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=AFiH_CNnVhS</a>

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
H.-Y. Chen and W.-L. Chao, “On bridging generic and personalized federated
learning for image classification,” in <em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Y.-T. Cao, Y. Shi, B. Yu, J. Wang, and D. Tao, “Knowledge-aware federated
active learning with non-iid data,” in <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
International Conference on Computer Vision</em>, 2023, pp. 22 279–22 289.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
C. Dwork, F. McSherry, K. Nissim, and A. Smith, “Calibrating noise to
sensitivity in private data analysis,” in <em id="bib.bib73.1.1" class="ltx_emph ltx_font_italic">Theory of Cryptography</em>,
S. Halevi and T. Rabin, Eds.   Berlin,
Heidelberg: Springer Berlin Heidelberg, 2006, pp. 265–284.

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
S. Casacuberta, M. Shoemate, S. Vadhan, and C. Wagaman, “Widespread
underestimation of sensitivity in differentially private libraries and how to
fix it,” in <em id="bib.bib74.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 ACM SIGSAC Conference on Computer
and Communications Security</em>, ser. CCS ’22.   New York, NY, USA: Association for Computing Machinery, 2022, p.
471–484. [Online]. Available: <a target="_blank" href="https://doi.org/10.1145/3548606.3560708" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3548606.3560708</a>

</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
C. Song, F. Granqvist, and K. Talwar, “FLAIR: Federated learning annotated
image repository,” in <em id="bib.bib75.1.1" class="ltx_emph ltx_font_italic">Thirty-sixth Conference on Neural Information
Processing Systems Datasets and Benchmarks Track</em>, 2022. [Online]. Available:
<a target="_blank" href="https://openreview.net/forum?id=1kIZiRelqFt" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=1kIZiRelqFt</a>

</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
Y. Yeganeh, A. Farshad, N. Navab, and S. Albarqouni, “Inverse distance
aggregation for federated learning with non-iid data,” in <em id="bib.bib76.1.1" class="ltx_emph ltx_font_italic">Domain
Adaptation and Representation Transfer, and Distributed and Collaborative
Learning: Second MICCAI Workshop, DART 2020, and First MICCAI Workshop, DCL
2020, Held in Conjunction with MICCAI 2020, Lima, Peru, October 4–8, 2020,
Proceedings 2</em>.   Springer, 2020, pp.
150–159.

</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
J. Hernandez <em id="bib.bib77.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Privacy-first health research with federated
learning,” <em id="bib.bib77.2.2" class="ltx_emph ltx_font_italic">medRxiv</em>, 2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.06367" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.06368" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.06368">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.06368" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.06369" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 18:45:37 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
