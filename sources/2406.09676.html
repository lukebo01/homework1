<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.09676] Optimizing Byte-level Representation for End-to-end ASR</title><meta property="og:description" content="We propose a novel approach to optimizing a byte-level representation for end-to-end automatic speech recognition (ASR). Byte-level representation is often used by large scale multilingual ASR systems when the characte…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Optimizing Byte-level Representation for End-to-end ASR">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Optimizing Byte-level Representation for End-to-end ASR">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.09676">

<!--Generated on Fri Jul  5 17:45:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\ninept</span><span id="p1.2" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.3" class="ltx_ERROR undefined">\name</span>
<p id="p1.4" class="ltx_p">RogerHsiao
<span id="p1.4.1" class="ltx_ERROR undefined">\name</span>LiuhuiDeng
<span id="p1.4.2" class="ltx_ERROR undefined">\name</span>ErikMcDermott
<span id="p1.4.3" class="ltx_ERROR undefined">\name</span>RuchirTravadi
<span id="p1.4.4" class="ltx_ERROR undefined">\name</span>XiaodanZhuang</p>
</div>
<h1 class="ltx_title ltx_title_document">Optimizing Byte-level Representation for End-to-end ASR</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">We propose a novel approach to optimizing a byte-level representation for end-to-end automatic speech recognition (ASR). Byte-level representation is often used by large scale multilingual ASR systems when the character set of the supported languages is large. The compactness and universality of byte-level representation allow the ASR models to use smaller output vocabularies and therefore, provide more flexibility. UTF-8 is a commonly used byte-level representation for multilingual ASR, but it is not designed to optimize machine learning tasks directly. By using auto-encoder and vector quantization, we show that we can optimize a byte-level representation for ASR and achieve better accuracy. Our proposed framework can incorporate information from different modalities, and provides an error correction mechanism. In an English/Mandarin dictation task, we show that a bilingual ASR model built with this approach can outperform UTF-8 representation by 5% relative in error rate.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>byte-level representation, speech recognition
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">End-to-end (E2E) neural networks are flexible and accurate models for multilingual automatic speech recognition (ASR). The output of such a multilingual model is often
unions of characters or subwords of the supported languages. However, as the number of languages increases, the size of the output layer increases, which can
negatively affect compute, memory usage and asset size. This problem is more prominent when the system supports languages that have large character sets, such as Chinese, Japanese and
Korean (CJK). To tackle this problem, previous work proposed the use of byte level representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. By
using UTF-8 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> codewords as the underlying base tokens, the output vocabulary is no longer constrained by the character sets of each language, allowing developers to choose
a vocabulary size based on compute, and memory constraints. One well-known multilingual ASR system that uses UTF-8 subwords is Whisper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">UTF-8 aims to represent all the characters used in major languages. The encoding and decoding processes are designed to be simple and efficient. UTF-8 is a
variable length prefix code where each character is represented by one to four bytes. Most byte sequences are not valid UTF-8 strings, and the UTF-8 decoder needs to detect invalid sequences. UTF-8 also provides backward compatibility, where ASCII characters are represented by a single byte and they are the same as the ASCII encoding.
While UTF-8 has proven to be an effective output representation for ASR, it is unclear whether it is optimal.
For example, characters with similar pronunciations or meaning are not guaranteed to share the same prefixes.
In addition, the large number of invalid byte sequences means the model needs to identify valid UTF-8 strings, an additional burden.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we explore the possibility of optimizing a byte level representation for E2E ASR with a data driven approach.
We believe an ideal byte level representation should:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Be optimized for target recognition/classification task;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Consider all available information;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Provide error correction.</p>
</div>
</li>
</ol>
<p id="S1.p3.2" class="ltx_p">For the first point, we think the representation should be optimized for the target machine learning task. The design of the representation should
boost accuracy, and be data driven. For the second point, we think the design should
take advantage of all available information. For example, if the representation is designed for ASR, it should incorporate the information from both text and audio.
Ideally, the framework should be flexible enough to incorporate any available information. For ASR, it means it should be able to take
lexicon, phonemes or other useful information into account. For the last property, we believe the representation should provide an error correction mechanism
to handle the cases when the model produces an invalid sequence, and the recovery should aim for minimal error.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a novel representation learning approach with a vector quantized auto-encoder. We show that
we can optimize the byte level representation for ASR with available text and audio data. The framework is flexible enough so it can be extended to incorporate
side information, such as a lexicon. Similar to UTF-8, we also provide a mechanism to recover from invalid sequences, and the recovery is optimized for accuracy
instead of other metrics.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>UTF-8 based representation</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">UTF-8 based models have been proposed for natural language processing (NLP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
The idea is to convert text to a sequence of variable-length UTF-8 codewords, and to have the model predict one byte at each decoding step.
The advantages of byte-level representation are compactness and universality, as any combination of languages may be represented with an output dimension of only 256.
However, a sequence represented at byte level is often longer than its character-level counterpart, especially for CJK languages <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
This is because while Latin characters are represented by a single byte, many CJK characters and accented characters are represented by multiple bytes.
As a result, a byte-level model can be error-prone since it needs to make multiple predictions for many single characters,
and each prediction might make a mistake.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">To compensate for the drawback of making byte level mistakes, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> propose byte-level subwords for E2E ASR.
The idea is to apply byte pair encoding (BPE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> to UTF-8 codeword sequences to create UTF-8 subwords. As subwords are in general longer than
byte-level tokens, this approach reduces the number of steps required by the decoding process.
However, BPE does not guarantee that the output will be a valid UTF-8 sequence. To repair an invalid byte sequence,
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> proposes a dynamic programming algorithm to recover as many characters as possible given any byte sequence.
While this dynamic programming approach ensures the output sequence is always valid, it optimizes for the number of valid characters, not ASR quality.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Optimizing byte-level representation</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Formulation as a latent variable optimization problem</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">We first formulate the representation problem as an optimization problem with latent variables.
Suppose <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">W</annotation></semantics></math> is a sequence of label tokens (e.g. words, subwords or characters),
<math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">X</annotation></semantics></math> is a sequence of acoustic features and <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">Q</annotation></semantics></math> is a sequence of discrete latent variables, <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="[\cdots,q_{i},\cdots]" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3.1" xref="S3.SS1.p1.4.m4.3.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.1.2" xref="S3.SS1.p1.4.m4.3.3.2.cmml">[</mo><mi mathvariant="normal" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.4.m4.3.3.1.3" xref="S3.SS1.p1.4.m4.3.3.2.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.2.cmml">q</mi><mi id="S3.SS1.p1.4.m4.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.3.3.1.4" xref="S3.SS1.p1.4.m4.3.3.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">⋯</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.1.5" xref="S3.SS1.p1.4.m4.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><list id="S3.SS1.p1.4.m4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">⋯</ci><apply id="S3.SS1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.2">𝑞</ci><ci id="S3.SS1.p1.4.m4.3.3.1.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3">𝑖</ci></apply><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">⋯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">[\cdots,q_{i},\cdots]</annotation></semantics></math>, from a vocabulary <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="{\cal V_{Q}}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝒱</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">𝒬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝒱</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">{\cal V_{Q}}</annotation></semantics></math>,
then we can write the formula of posterior probability as,</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="P(W|X)=\sum_{Q}P(W|Q,X)P(Q|X)\ ." display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><munder id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml">∑</mo><mi id="S3.E1.m1.3.3.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.cmml">Q</mi></munder><mrow id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.4" xref="S3.E1.m1.3.3.1.1.3.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.1.cmml"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">Q</mi><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">X</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.2.3a" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.3.2.5" xref="S3.E1.m1.3.3.1.1.3.2.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.2.3b" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.2.2.1" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.2.2.1.2" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.3.2.2.1.1" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.1.1.2" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.2.cmml">Q</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.3.2.2.1.1.1" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.1.cmml">|</mo><mi id="S3.E1.m1.3.3.1.1.3.2.2.1.1.3" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.3.cmml">X</mi></mrow><mo rspace="0.222em" stretchy="false" id="S3.E1.m1.3.3.1.1.3.2.2.1.3" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝑃</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">𝑋</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><apply id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2"></sum><ci id="S3.E1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3">𝑄</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><times id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3"></times><ci id="S3.E1.m1.3.3.1.1.3.2.4.cmml" xref="S3.E1.m1.3.3.1.1.3.2.4">𝑃</ci><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2">𝑊</ci><list id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑄</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑋</ci></list></apply><ci id="S3.E1.m1.3.3.1.1.3.2.5.cmml" xref="S3.E1.m1.3.3.1.1.3.2.5">𝑃</ci><apply id="S3.E1.m1.3.3.1.1.3.2.2.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.3.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.2">𝑄</ci><ci id="S3.E1.m1.3.3.1.1.3.2.2.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.1.1.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">P(W|X)=\sum_{Q}P(W|Q,X)P(Q|X)\ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.7" class="ltx_p">Assuming <math id="S3.SS1.p1.6.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.6.m1.1a"><mi id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><ci id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">Q</annotation></semantics></math> captures sufficient information to infer <math id="S3.SS1.p1.7.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p1.7.m2.1a"><mi id="S3.SS1.p1.7.m2.1.1" xref="S3.SS1.p1.7.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m2.1b"><ci id="S3.SS1.p1.7.m2.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m2.1c">W</annotation></semantics></math>, we can then simplify Equation <a href="#S3.E1" title="In 3.1 Formulation as a latent variable optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="P(W|X)=\sum_{Q}P(W|Q)P(Q|X)\ ." display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><munder id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml">∑</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml">Q</mi></munder><mrow id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.4" xref="S3.E2.m1.1.1.1.1.3.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.2.1.1.1.1" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.E2.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E2.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.3.cmml">Q</mi></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3a" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.2.5" xref="S3.E2.m1.1.1.1.1.3.2.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.2.3b" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.3.2.2.1" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3.2.2.1.2" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.3.2.2.1.1" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.2.1.1.2" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.2.cmml">Q</mi><mo fence="false" id="S3.E2.m1.1.1.1.1.3.2.2.1.1.1" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.1.cmml">|</mo><mi id="S3.E2.m1.1.1.1.1.3.2.2.1.1.3" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.3.cmml">X</mi></mrow><mo rspace="0.222em" stretchy="false" id="S3.E2.m1.1.1.1.1.3.2.2.1.3" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"></eq><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑃</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">𝑋</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2"></sum><ci id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3">𝑄</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><times id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3"></times><ci id="S3.E2.m1.1.1.1.1.3.2.4.cmml" xref="S3.E2.m1.1.1.1.1.3.2.4">𝑃</ci><apply id="S3.E2.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E2.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.2">𝑊</ci><ci id="S3.E2.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2.1.1.1.1.3">𝑄</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.2.5.cmml" xref="S3.E2.m1.1.1.1.1.3.2.5">𝑃</ci><apply id="S3.E2.m1.1.1.1.1.3.2.2.1.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.3.2.2.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.1">conditional</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.2">𝑄</ci><ci id="S3.E2.m1.1.1.1.1.3.2.2.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.1.1.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">P(W|X)=\sum_{Q}P(W|Q)P(Q|X)\ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.15" class="ltx_p">The representation problem becomes the optimization problem of finding the set of latent variables <math id="S3.SS1.p1.8.m1.1" class="ltx_Math" alttext="{\cal V_{Q}}" display="inline"><semantics id="S3.SS1.p1.8.m1.1a"><msub id="S3.SS1.p1.8.m1.1.1" xref="S3.SS1.p1.8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m1.1.1.2" xref="S3.SS1.p1.8.m1.1.1.2.cmml">𝒱</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m1.1.1.3" xref="S3.SS1.p1.8.m1.1.1.3.cmml">𝒬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m1.1b"><apply id="S3.SS1.p1.8.m1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m1.1.1.2.cmml" xref="S3.SS1.p1.8.m1.1.1.2">𝒱</ci><ci id="S3.SS1.p1.8.m1.1.1.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m1.1c">{\cal V_{Q}}</annotation></semantics></math>,
such that the posterior probability of Equation <a href="#S3.E2" title="In 3.1 Formulation as a latent variable optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is maximized.
In our case, the sequence <math id="S3.SS1.p1.9.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.9.m2.1a"><mi id="S3.SS1.p1.9.m2.1.1" xref="S3.SS1.p1.9.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m2.1b"><ci id="S3.SS1.p1.9.m2.1.1.cmml" xref="S3.SS1.p1.9.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m2.1c">Q</annotation></semantics></math> is the byte-level representation to be optimized for ASR, and it forms the output of the ASR model. In this formulation, <math id="S3.SS1.p1.10.m3.1" class="ltx_Math" alttext="P(Q|X)" display="inline"><semantics id="S3.SS1.p1.10.m3.1a"><mrow id="S3.SS1.p1.10.m3.1.1" xref="S3.SS1.p1.10.m3.1.1.cmml"><mi id="S3.SS1.p1.10.m3.1.1.3" xref="S3.SS1.p1.10.m3.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m3.1.1.2" xref="S3.SS1.p1.10.m3.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.10.m3.1.1.1.1" xref="S3.SS1.p1.10.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m3.1.1.1.1.2" xref="S3.SS1.p1.10.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.10.m3.1.1.1.1.1" xref="S3.SS1.p1.10.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.10.m3.1.1.1.1.1.2" xref="S3.SS1.p1.10.m3.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.SS1.p1.10.m3.1.1.1.1.1.1" xref="S3.SS1.p1.10.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p1.10.m3.1.1.1.1.1.3" xref="S3.SS1.p1.10.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.SS1.p1.10.m3.1.1.1.1.3" xref="S3.SS1.p1.10.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m3.1b"><apply id="S3.SS1.p1.10.m3.1.1.cmml" xref="S3.SS1.p1.10.m3.1.1"><times id="S3.SS1.p1.10.m3.1.1.2.cmml" xref="S3.SS1.p1.10.m3.1.1.2"></times><ci id="S3.SS1.p1.10.m3.1.1.3.cmml" xref="S3.SS1.p1.10.m3.1.1.3">𝑃</ci><apply id="S3.SS1.p1.10.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.10.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.10.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m3.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS1.p1.10.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m3.1c">P(Q|X)</annotation></semantics></math> is the ASR model that
describes how acoustic features will be mapped to these latent variables.
<math id="S3.SS1.p1.11.m4.1" class="ltx_Math" alttext="P(W|Q)" display="inline"><semantics id="S3.SS1.p1.11.m4.1a"><mrow id="S3.SS1.p1.11.m4.1.1" xref="S3.SS1.p1.11.m4.1.1.cmml"><mi id="S3.SS1.p1.11.m4.1.1.3" xref="S3.SS1.p1.11.m4.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m4.1.1.2" xref="S3.SS1.p1.11.m4.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.11.m4.1.1.1.1" xref="S3.SS1.p1.11.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m4.1.1.1.1.2" xref="S3.SS1.p1.11.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.11.m4.1.1.1.1.1" xref="S3.SS1.p1.11.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m4.1.1.1.1.1.2" xref="S3.SS1.p1.11.m4.1.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.SS1.p1.11.m4.1.1.1.1.1.1" xref="S3.SS1.p1.11.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p1.11.m4.1.1.1.1.1.3" xref="S3.SS1.p1.11.m4.1.1.1.1.1.3.cmml">Q</mi></mrow><mo stretchy="false" id="S3.SS1.p1.11.m4.1.1.1.1.3" xref="S3.SS1.p1.11.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m4.1b"><apply id="S3.SS1.p1.11.m4.1.1.cmml" xref="S3.SS1.p1.11.m4.1.1"><times id="S3.SS1.p1.11.m4.1.1.2.cmml" xref="S3.SS1.p1.11.m4.1.1.2"></times><ci id="S3.SS1.p1.11.m4.1.1.3.cmml" xref="S3.SS1.p1.11.m4.1.1.3">𝑃</ci><apply id="S3.SS1.p1.11.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.11.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.11.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m4.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS1.p1.11.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m4.1.1.1.1.1.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m4.1c">P(W|Q)</annotation></semantics></math> plays a role similar to a lexicon, which describes how <math id="S3.SS1.p1.12.m5.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.12.m5.1a"><mi id="S3.SS1.p1.12.m5.1.1" xref="S3.SS1.p1.12.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m5.1b"><ci id="S3.SS1.p1.12.m5.1.1.cmml" xref="S3.SS1.p1.12.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m5.1c">Q</annotation></semantics></math> can be used to infer <math id="S3.SS1.p1.13.m6.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p1.13.m6.1a"><mi id="S3.SS1.p1.13.m6.1.1" xref="S3.SS1.p1.13.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m6.1b"><ci id="S3.SS1.p1.13.m6.1.1.cmml" xref="S3.SS1.p1.13.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m6.1c">W</annotation></semantics></math>.
One difference is that this lexicon will be jointly optimized.
In this work, we assume that the relationship between <math id="S3.SS1.p1.14.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p1.14.m7.1a"><mi id="S3.SS1.p1.14.m7.1.1" xref="S3.SS1.p1.14.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m7.1b"><ci id="S3.SS1.p1.14.m7.1.1.cmml" xref="S3.SS1.p1.14.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m7.1c">W</annotation></semantics></math> and <math id="S3.SS1.p1.15.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.15.m8.1a"><mi id="S3.SS1.p1.15.m8.1.1" xref="S3.SS1.p1.15.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m8.1b"><ci id="S3.SS1.p1.15.m8.1.1.cmml" xref="S3.SS1.p1.15.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m8.1c">Q</annotation></semantics></math> is deterministic,
so we can convert label tokens to and from latent variables.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">Optimizing Equation <a href="#S3.E2" title="In 3.1 Formulation as a latent variable optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> directly is not trivial since <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">Q</annotation></semantics></math> is hidden
and this equation marginalizes over all possible <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">Q</annotation></semantics></math>.
In practice, it means we would need to sample <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">Q</annotation></semantics></math> from <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="P(Q|X)" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></times><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑃</ci><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">P(Q|X)</annotation></semantics></math> to
approximate the equation, which is still expensive and difficult.
At a high level, the challenge here is to solve the representation problem, <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="P(W|Q)" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.5.m5.1.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.SS1.p2.5.m5.1.1.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.cmml">Q</mi></mrow><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><times id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"></times><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑃</ci><apply id="S3.SS1.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">P(W|Q)</annotation></semantics></math>,
and the alignment problem, <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="P(Q|X)" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.1.2" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.6.m6.1.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.1.1.1.2" xref="S3.SS1.p2.6.m6.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.SS1.p2.6.m6.1.1.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.6.m6.1.1.1.1.1.3" xref="S3.SS1.p2.6.m6.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.1.3" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><times id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2"></times><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑃</ci><apply id="S3.SS1.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS1.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">P(Q|X)</annotation></semantics></math>, at the same time.
To circumvent this challenge, we propose to reformulate the task as an auto-encoding problem.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Formulation as auto-encoding optimization problem</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The auto-encoder consists of the following components:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">a label encoder, <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="P_{L}(Q|W)" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><msub id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.cmml">P</mi><mi id="S3.I1.i1.p1.1.m1.1.1.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.I1.i1.p1.1.m1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i1.p1.1.m1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.1.m1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.I1.i1.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S3.I1.i1.p1.1.m1.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><times id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2"></times><apply id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2">𝑃</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3">𝐿</ci></apply><apply id="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2">𝑄</ci><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">P_{L}(Q|W)</annotation></semantics></math>;</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">an acoustic encoder, <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="P_{A}(Q|X)" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><msub id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.cmml">P</mi><mi id="S3.I1.i2.p1.1.m1.1.1.3.3" xref="S3.I1.i2.p1.1.m1.1.1.3.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.I1.i2.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><times id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2"></times><apply id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2">𝑃</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.3">𝐴</ci></apply><apply id="S3.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.2">𝑄</ci><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">P_{A}(Q|X)</annotation></semantics></math>;</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">a label decoder, <math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="P_{D}(W|Q)" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><mrow id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><msub id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.3.2" xref="S3.I1.i3.p1.1.m1.1.1.3.2.cmml">P</mi><mi id="S3.I1.i3.p1.1.m1.1.1.3.3" xref="S3.I1.i3.p1.1.m1.1.1.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.I1.i3.p1.1.m1.1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i3.p1.1.m1.1.1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i3.p1.1.m1.1.1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.2.cmml">W</mi><mo fence="false" id="S3.I1.i3.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.I1.i3.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml">Q</mi></mrow><mo stretchy="false" id="S3.I1.i3.p1.1.m1.1.1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><times id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2"></times><apply id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.2">𝑃</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.3">𝐷</ci></apply><apply id="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.2">𝑊</ci><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.1.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">P_{D}(W|Q)</annotation></semantics></math>;</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">a vector quantizer, <math id="S3.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="VQ" display="inline"><semantics id="S3.I1.i4.p1.1.m1.1a"><mrow id="S3.I1.i4.p1.1.m1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.cmml"><mi id="S3.I1.i4.p1.1.m1.1.1.2" xref="S3.I1.i4.p1.1.m1.1.1.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.I1.i4.p1.1.m1.1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.I1.i4.p1.1.m1.1.1.3" xref="S3.I1.i4.p1.1.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.1.m1.1b"><apply id="S3.I1.i4.p1.1.m1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1"><times id="S3.I1.i4.p1.1.m1.1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1.1"></times><ci id="S3.I1.i4.p1.1.m1.1.1.2.cmml" xref="S3.I1.i4.p1.1.m1.1.1.2">𝑉</ci><ci id="S3.I1.i4.p1.1.m1.1.1.3.cmml" xref="S3.I1.i4.p1.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.1.m1.1c">VQ</annotation></semantics></math>.</p>
</div>
</li>
</ol>
<p id="S3.SS2.p1.2" class="ltx_p">Figure <a href="#S3.F1" title="Figure 1 ‣ 3.2 Formulation as auto-encoding optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the architecture of this auto-encoder.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.09676/assets/fig/latent_representation.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="314" height="87" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of the proposed auto-encoder</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">This auto-encoder uses vector quantization (VQ) as its bottleneck, with the indices of the quantized embeddings serving as the latent variables.
We use <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">Q</annotation></semantics></math> to represent the sequence of embedding indices and define <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="e(q)" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.2.2" xref="S3.SS2.p2.2.m2.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.1.2.1" xref="S3.SS2.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.2.m2.1.2.3.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.1.2.3.2.1" xref="S3.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">q</mi><mo stretchy="false" id="S3.SS2.p2.2.m2.1.2.3.2.2" xref="S3.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.2.cmml" xref="S3.SS2.p2.2.m2.1.2"><times id="S3.SS2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.2.1"></times><ci id="S3.SS2.p2.2.m2.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.2.2">𝑒</ci><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">e(q)</annotation></semantics></math> as a function that returns the quantized embedding vector given an embedding index <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">q</annotation></semantics></math>.
Each encoder branch represents the information that contributes to building the latent representation,
and the decoder would recover the label sequences from the latent variables. This auto-encoder can be optimized by the loss function,</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E3">
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle L_{AE}" display="inline"><semantics id="S3.Ex1.m1.1a"><msub id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">L</mi><mrow id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.3.1" xref="S3.Ex1.m1.1.1.3.1.cmml">​</mo><mi id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝐿</ci><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><times id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3.1"></times><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">𝐴</ci><ci id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle L_{AE}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.Ex1.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.Ex1.m2.1a"><mo id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.1b"><eq id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m3.3" class="ltx_Math" alttext="\displaystyle H[\tilde{P}(W),P_{D}(W|e(Q_{L}))]" display="inline"><semantics id="S3.Ex1.m3.3a"><mrow id="S3.Ex1.m3.3.3" xref="S3.Ex1.m3.3.3.cmml"><mi id="S3.Ex1.m3.3.3.4" xref="S3.Ex1.m3.3.3.4.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m3.3.3.3" xref="S3.Ex1.m3.3.3.3.cmml">​</mo><mrow id="S3.Ex1.m3.3.3.2.2" xref="S3.Ex1.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.3" xref="S3.Ex1.m3.3.3.2.3.cmml">[</mo><mrow id="S3.Ex1.m3.2.2.1.1.1" xref="S3.Ex1.m3.2.2.1.1.1.cmml"><mover accent="true" id="S3.Ex1.m3.2.2.1.1.1.2" xref="S3.Ex1.m3.2.2.1.1.1.2.cmml"><mi id="S3.Ex1.m3.2.2.1.1.1.2.2" xref="S3.Ex1.m3.2.2.1.1.1.2.2.cmml">P</mi><mo id="S3.Ex1.m3.2.2.1.1.1.2.1" xref="S3.Ex1.m3.2.2.1.1.1.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex1.m3.2.2.1.1.1.1" xref="S3.Ex1.m3.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.Ex1.m3.2.2.1.1.1.3.2" xref="S3.Ex1.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m3.2.2.1.1.1.3.2.1" xref="S3.Ex1.m3.2.2.1.1.1.cmml">(</mo><mi id="S3.Ex1.m3.1.1" xref="S3.Ex1.m3.1.1.cmml">W</mi><mo stretchy="false" id="S3.Ex1.m3.2.2.1.1.1.3.2.2" xref="S3.Ex1.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m3.3.3.2.2.4" xref="S3.Ex1.m3.3.3.2.3.cmml">,</mo><mrow id="S3.Ex1.m3.3.3.2.2.2" xref="S3.Ex1.m3.3.3.2.2.2.cmml"><msub id="S3.Ex1.m3.3.3.2.2.2.3" xref="S3.Ex1.m3.3.3.2.2.2.3.cmml"><mi id="S3.Ex1.m3.3.3.2.2.2.3.2" xref="S3.Ex1.m3.3.3.2.2.2.3.2.cmml">P</mi><mi id="S3.Ex1.m3.3.3.2.2.2.3.3" xref="S3.Ex1.m3.3.3.2.2.2.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m3.3.3.2.2.2.2" xref="S3.Ex1.m3.3.3.2.2.2.2.cmml">​</mo><mrow id="S3.Ex1.m3.3.3.2.2.2.1.1" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.2.1.1.2" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m3.3.3.2.2.2.1.1.1" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.cmml"><mi id="S3.Ex1.m3.3.3.2.2.2.1.1.1.3" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.3.cmml">W</mi><mo fence="false" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.2" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.cmml"><mi id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.3" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.2" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.2.1.1.3" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex1.m3.3.3.2.2.5" xref="S3.Ex1.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m3.3b"><apply id="S3.Ex1.m3.3.3.cmml" xref="S3.Ex1.m3.3.3"><times id="S3.Ex1.m3.3.3.3.cmml" xref="S3.Ex1.m3.3.3.3"></times><ci id="S3.Ex1.m3.3.3.4.cmml" xref="S3.Ex1.m3.3.3.4">𝐻</ci><interval closure="closed" id="S3.Ex1.m3.3.3.2.3.cmml" xref="S3.Ex1.m3.3.3.2.2"><apply id="S3.Ex1.m3.2.2.1.1.1.cmml" xref="S3.Ex1.m3.2.2.1.1.1"><times id="S3.Ex1.m3.2.2.1.1.1.1.cmml" xref="S3.Ex1.m3.2.2.1.1.1.1"></times><apply id="S3.Ex1.m3.2.2.1.1.1.2.cmml" xref="S3.Ex1.m3.2.2.1.1.1.2"><ci id="S3.Ex1.m3.2.2.1.1.1.2.1.cmml" xref="S3.Ex1.m3.2.2.1.1.1.2.1">~</ci><ci id="S3.Ex1.m3.2.2.1.1.1.2.2.cmml" xref="S3.Ex1.m3.2.2.1.1.1.2.2">𝑃</ci></apply><ci id="S3.Ex1.m3.1.1.cmml" xref="S3.Ex1.m3.1.1">𝑊</ci></apply><apply id="S3.Ex1.m3.3.3.2.2.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2"><times id="S3.Ex1.m3.3.3.2.2.2.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2.2"></times><apply id="S3.Ex1.m3.3.3.2.2.2.3.cmml" xref="S3.Ex1.m3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m3.3.3.2.2.2.3.1.cmml" xref="S3.Ex1.m3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m3.3.3.2.2.2.3.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2.3.2">𝑃</ci><ci id="S3.Ex1.m3.3.3.2.2.2.3.3.cmml" xref="S3.Ex1.m3.3.3.2.2.2.3.3">𝐷</ci></apply><apply id="S3.Ex1.m3.3.3.2.2.2.1.1.1.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1"><csymbol cd="latexml" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.2">conditional</csymbol><ci id="S3.Ex1.m3.3.3.2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.3">𝑊</ci><apply id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1"><times id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.2"></times><ci id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.3">𝑒</ci><apply id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m3.3.3.2.2.2.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m3.3c">\displaystyle H[\tilde{P}(W),P_{D}(W|e(Q_{L}))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle+" display="inline"><semantics id="S3.Ex2.m1.1a"><mo id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><plus id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle+</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m2.3" class="ltx_Math" alttext="\displaystyle H[\tilde{P}(W),P_{D}(W|e(Q_{A}))]" display="inline"><semantics id="S3.Ex2.m2.3a"><mrow id="S3.Ex2.m2.3.3" xref="S3.Ex2.m2.3.3.cmml"><mi id="S3.Ex2.m2.3.3.4" xref="S3.Ex2.m2.3.3.4.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.3" xref="S3.Ex2.m2.3.3.3.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.2.2" xref="S3.Ex2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.3" xref="S3.Ex2.m2.3.3.2.3.cmml">[</mo><mrow id="S3.Ex2.m2.2.2.1.1.1" xref="S3.Ex2.m2.2.2.1.1.1.cmml"><mover accent="true" id="S3.Ex2.m2.2.2.1.1.1.2" xref="S3.Ex2.m2.2.2.1.1.1.2.cmml"><mi id="S3.Ex2.m2.2.2.1.1.1.2.2" xref="S3.Ex2.m2.2.2.1.1.1.2.2.cmml">P</mi><mo id="S3.Ex2.m2.2.2.1.1.1.2.1" xref="S3.Ex2.m2.2.2.1.1.1.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.2.2.1.1.1.1" xref="S3.Ex2.m2.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m2.2.2.1.1.1.3.2" xref="S3.Ex2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m2.2.2.1.1.1.3.2.1" xref="S3.Ex2.m2.2.2.1.1.1.cmml">(</mo><mi id="S3.Ex2.m2.1.1" xref="S3.Ex2.m2.1.1.cmml">W</mi><mo stretchy="false" id="S3.Ex2.m2.2.2.1.1.1.3.2.2" xref="S3.Ex2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m2.3.3.2.2.4" xref="S3.Ex2.m2.3.3.2.3.cmml">,</mo><mrow id="S3.Ex2.m2.3.3.2.2.2" xref="S3.Ex2.m2.3.3.2.2.2.cmml"><msub id="S3.Ex2.m2.3.3.2.2.2.3" xref="S3.Ex2.m2.3.3.2.2.2.3.cmml"><mi id="S3.Ex2.m2.3.3.2.2.2.3.2" xref="S3.Ex2.m2.3.3.2.2.2.3.2.cmml">P</mi><mi id="S3.Ex2.m2.3.3.2.2.2.3.3" xref="S3.Ex2.m2.3.3.2.2.2.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.2.2.2.2" xref="S3.Ex2.m2.3.3.2.2.2.2.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.2.2.2.1.1" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.2.1.1.2" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m2.3.3.2.2.2.1.1.1" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.cmml"><mi id="S3.Ex2.m2.3.3.2.2.2.1.1.1.3" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.3.cmml">W</mi><mo fence="false" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.2" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.cmml"><mi id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.3" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.2" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.3.cmml">A</mi></msub><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.3" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.2.1.1.3" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex2.m2.3.3.2.2.5" xref="S3.Ex2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.3b"><apply id="S3.Ex2.m2.3.3.cmml" xref="S3.Ex2.m2.3.3"><times id="S3.Ex2.m2.3.3.3.cmml" xref="S3.Ex2.m2.3.3.3"></times><ci id="S3.Ex2.m2.3.3.4.cmml" xref="S3.Ex2.m2.3.3.4">𝐻</ci><interval closure="closed" id="S3.Ex2.m2.3.3.2.3.cmml" xref="S3.Ex2.m2.3.3.2.2"><apply id="S3.Ex2.m2.2.2.1.1.1.cmml" xref="S3.Ex2.m2.2.2.1.1.1"><times id="S3.Ex2.m2.2.2.1.1.1.1.cmml" xref="S3.Ex2.m2.2.2.1.1.1.1"></times><apply id="S3.Ex2.m2.2.2.1.1.1.2.cmml" xref="S3.Ex2.m2.2.2.1.1.1.2"><ci id="S3.Ex2.m2.2.2.1.1.1.2.1.cmml" xref="S3.Ex2.m2.2.2.1.1.1.2.1">~</ci><ci id="S3.Ex2.m2.2.2.1.1.1.2.2.cmml" xref="S3.Ex2.m2.2.2.1.1.1.2.2">𝑃</ci></apply><ci id="S3.Ex2.m2.1.1.cmml" xref="S3.Ex2.m2.1.1">𝑊</ci></apply><apply id="S3.Ex2.m2.3.3.2.2.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2"><times id="S3.Ex2.m2.3.3.2.2.2.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2.2"></times><apply id="S3.Ex2.m2.3.3.2.2.2.3.cmml" xref="S3.Ex2.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.2.2.2.3.1.cmml" xref="S3.Ex2.m2.3.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex2.m2.3.3.2.2.2.3.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2.3.2">𝑃</ci><ci id="S3.Ex2.m2.3.3.2.2.2.3.3.cmml" xref="S3.Ex2.m2.3.3.2.2.2.3.3">𝐷</ci></apply><apply id="S3.Ex2.m2.3.3.2.2.2.1.1.1.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1"><csymbol cd="latexml" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.2">conditional</csymbol><ci id="S3.Ex2.m2.3.3.2.2.2.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.3">𝑊</ci><apply id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1"><times id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.2"></times><ci id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.3">𝑒</ci><apply id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.2.2.2.1.1.1.1.1.1.1.3">𝐴</ci></apply></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.3c">\displaystyle H[\tilde{P}(W),P_{D}(W|e(Q_{A}))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle+" display="inline"><semantics id="S3.Ex3.m1.1a"><mo id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><plus id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle+</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m2.1" class="ltx_Math" alttext="\displaystyle L_{\textit{CTC}}[P_{A}(Q_{L}|X)]" display="inline"><semantics id="S3.Ex3.m2.1a"><mrow id="S3.Ex3.m2.1.1" xref="S3.Ex3.m2.1.1.cmml"><msub id="S3.Ex3.m2.1.1.3" xref="S3.Ex3.m2.1.1.3.cmml"><mi id="S3.Ex3.m2.1.1.3.2" xref="S3.Ex3.m2.1.1.3.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="S3.Ex3.m2.1.1.3.3" xref="S3.Ex3.m2.1.1.3.3a.cmml">CTC</mtext></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.1.1.2" xref="S3.Ex3.m2.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m2.1.1.1.1" xref="S3.Ex3.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex3.m2.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.cmml"><msub id="S3.Ex3.m2.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m2.1.1.1.1.1.3.2" xref="S3.Ex3.m2.1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.Ex3.m2.1.1.1.1.1.3.3" xref="S3.Ex3.m2.1.1.1.1.1.3.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m2.1.1.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m2.1.1.1.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mi id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.3.cmml">L</mi></msub><mo fence="false" id="S3.Ex3.m2.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex3.m2.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex3.m2.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m2.1b"><apply id="S3.Ex3.m2.1.1.cmml" xref="S3.Ex3.m2.1.1"><times id="S3.Ex3.m2.1.1.2.cmml" xref="S3.Ex3.m2.1.1.2"></times><apply id="S3.Ex3.m2.1.1.3.cmml" xref="S3.Ex3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m2.1.1.3.1.cmml" xref="S3.Ex3.m2.1.1.3">subscript</csymbol><ci id="S3.Ex3.m2.1.1.3.2.cmml" xref="S3.Ex3.m2.1.1.3.2">𝐿</ci><ci id="S3.Ex3.m2.1.1.3.3a.cmml" xref="S3.Ex3.m2.1.1.3.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.Ex3.m2.1.1.3.3.cmml" xref="S3.Ex3.m2.1.1.3.3">CTC</mtext></ci></apply><apply id="S3.Ex3.m2.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m2.1.1.1.2.1.cmml" xref="S3.Ex3.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m2.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1"><times id="S3.Ex3.m2.1.1.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.2"></times><apply id="S3.Ex3.m2.1.1.1.1.1.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m2.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m2.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3.2">𝑃</ci><ci id="S3.Ex3.m2.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3.3">𝐴</ci></apply><apply id="S3.Ex3.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.2">𝑄</ci><ci id="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><ci id="S3.Ex3.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.1.1.1.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m2.1c">\displaystyle L_{\textit{CTC}}[P_{A}(Q_{L}|X)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle+" display="inline"><semantics id="S3.E3.m1.1a"><mo id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><plus id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle+</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.1" class="ltx_Math" alttext="\displaystyle L_{\textit{VQ}}\ ." display="inline"><semantics id="S3.E3.m2.1a"><mrow id="S3.E3.m2.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml"><msub id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml"><mi id="S3.E3.m2.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="S3.E3.m2.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.3a.cmml">VQ</mtext></msub><mo lspace="0.500em" id="S3.E3.m2.1.1.1.2" xref="S3.E3.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.1b"><apply id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.2">𝐿</ci><ci id="S3.E3.m2.1.1.1.1.3a.cmml" xref="S3.E3.m2.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.E3.m2.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.3">VQ</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.1c">\displaystyle L_{\textit{VQ}}\ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.5" class="ltx_p">This loss function consists of four terms. The first term is the cross entropy loss between the empirical distribution of the reference word sequence and the distribution induced by the label decoder given the output of the label encoder, <math id="S3.SS2.p3.1.m1.3" class="ltx_Math" alttext="Q_{L}=[\cdots,q_{i},\cdots]" display="inline"><semantics id="S3.SS2.p3.1.m1.3a"><mrow id="S3.SS2.p3.1.m1.3.3" xref="S3.SS2.p3.1.m1.3.3.cmml"><msub id="S3.SS2.p3.1.m1.3.3.3" xref="S3.SS2.p3.1.m1.3.3.3.cmml"><mi id="S3.SS2.p3.1.m1.3.3.3.2" xref="S3.SS2.p3.1.m1.3.3.3.2.cmml">Q</mi><mi id="S3.SS2.p3.1.m1.3.3.3.3" xref="S3.SS2.p3.1.m1.3.3.3.3.cmml">L</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.2" xref="S3.SS2.p3.1.m1.3.3.2.cmml">=</mo><mrow id="S3.SS2.p3.1.m1.3.3.1.1" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.3.3.1.1.2" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS2.p3.1.m1.3.3.1.1.3" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml">,</mo><msub id="S3.SS2.p3.1.m1.3.3.1.1.1" xref="S3.SS2.p3.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.3.3.1.1.1.2" xref="S3.SS2.p3.1.m1.3.3.1.1.1.2.cmml">q</mi><mi id="S3.SS2.p3.1.m1.3.3.1.1.1.3" xref="S3.SS2.p3.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.1.1.4" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.1.m1.2.2" xref="S3.SS2.p3.1.m1.2.2.cmml">⋯</mi><mo stretchy="false" id="S3.SS2.p3.1.m1.3.3.1.1.5" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.3b"><apply id="S3.SS2.p3.1.m1.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3"><eq id="S3.SS2.p3.1.m1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2"></eq><apply id="S3.SS2.p3.1.m1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.3.1.cmml" xref="S3.SS2.p3.1.m1.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.3.2.cmml" xref="S3.SS2.p3.1.m1.3.3.3.2">𝑄</ci><ci id="S3.SS2.p3.1.m1.3.3.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3">𝐿</ci></apply><list id="S3.SS2.p3.1.m1.3.3.1.2.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">⋯</ci><apply id="S3.SS2.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1.2">𝑞</ci><ci id="S3.SS2.p3.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p3.1.m1.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2">⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.3c">Q_{L}=[\cdots,q_{i},\cdots]</annotation></semantics></math>. This term is the standard loss of an auto-encoder, where it first uses the label encoder, <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="P_{L}(Q|W)" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.2.m2.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.1.1.1.1.2" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.2.m2.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.2" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.SS2.p3.2.m2.1.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S3.SS2.p3.2.m2.1.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><times id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"></times><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">𝑃</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">𝐿</ci></apply><apply id="S3.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">P_{L}(Q|W)</annotation></semantics></math>, to decide <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="Q_{L}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">Q</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑄</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">Q_{L}</annotation></semantics></math>. Then, the corresponding sequence of
embeddings, <math id="S3.SS2.p3.4.m4.4" class="ltx_Math" alttext="e(Q_{L})=[\cdots,e(q_{i}),\cdots]" display="inline"><semantics id="S3.SS2.p3.4.m4.4a"><mrow id="S3.SS2.p3.4.m4.4.4" xref="S3.SS2.p3.4.m4.4.4.cmml"><mrow id="S3.SS2.p3.4.m4.3.3.1" xref="S3.SS2.p3.4.m4.3.3.1.cmml"><mi id="S3.SS2.p3.4.m4.3.3.1.3" xref="S3.SS2.p3.4.m4.3.3.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.3.3.1.2" xref="S3.SS2.p3.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.3.3.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.2" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.4.m4.3.3.1.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.3.3.1.1.1.1.2" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p3.4.m4.3.3.1.1.1.1.3" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.3" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.4.m4.4.4.3" xref="S3.SS2.p3.4.m4.4.4.3.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.4.4.2.1" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.4.4.2.1.2" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">⋯</mi><mo id="S3.SS2.p3.4.m4.4.4.2.1.3" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml">,</mo><mrow id="S3.SS2.p3.4.m4.4.4.2.1.1" xref="S3.SS2.p3.4.m4.4.4.2.1.1.cmml"><mi id="S3.SS2.p3.4.m4.4.4.2.1.1.3" xref="S3.SS2.p3.4.m4.4.4.2.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.4.4.2.1.1.2" xref="S3.SS2.p3.4.m4.4.4.2.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.2" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.2" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.3" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.3" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.4.m4.4.4.2.1.4" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.4.m4.2.2" xref="S3.SS2.p3.4.m4.2.2.cmml">⋯</mi><mo stretchy="false" id="S3.SS2.p3.4.m4.4.4.2.1.5" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.4b"><apply id="S3.SS2.p3.4.m4.4.4.cmml" xref="S3.SS2.p3.4.m4.4.4"><eq id="S3.SS2.p3.4.m4.4.4.3.cmml" xref="S3.SS2.p3.4.m4.4.4.3"></eq><apply id="S3.SS2.p3.4.m4.3.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1"><times id="S3.SS2.p3.4.m4.3.3.1.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.2"></times><ci id="S3.SS2.p3.4.m4.3.3.1.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3">𝑒</ci><apply id="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p3.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.3">𝐿</ci></apply></apply><list id="S3.SS2.p3.4.m4.4.4.2.2.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">⋯</ci><apply id="S3.SS2.p3.4.m4.4.4.2.1.1.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1"><times id="S3.SS2.p3.4.m4.4.4.2.1.1.2.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.2"></times><ci id="S3.SS2.p3.4.m4.4.4.2.1.1.3.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.3">𝑒</ci><apply id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.4.4.2.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.SS2.p3.4.m4.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2">⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.4c">e(Q_{L})=[\cdots,e(q_{i}),\cdots]</annotation></semantics></math>, is fed to the label decoder to compute <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="P_{D}(W|e(Q_{L}))" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><msub id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.5.m5.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.5.m5.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3.cmml">W</mi><mo fence="false" id="S3.SS2.p3.5.m5.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.SS2.p3.5.m5.1.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><times id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2"></times><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑃</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">𝐷</ci></apply><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2">conditional</csymbol><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3">𝑊</ci><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1"><times id="S3.SS2.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.3">𝑒</ci><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">P_{D}(W|e(Q_{L}))</annotation></semantics></math>. This term would optimize the label decoder and the label encoder end-to-end.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.6" class="ltx_p">The second cross entropy loss in Equation <a href="#S3.E3" title="In 3.2 Formulation as auto-encoding optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> represents the loss of the decoder when it uses the information
from the acoustic encoder. <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="Q_{A}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑄</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">Q_{A}</annotation></semantics></math> is a sequence of latent variables chosen by the acoustic encoder, and has the same length as <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="Q_{L}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑄</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">Q_{L}</annotation></semantics></math>.
However, instead of sampling from <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="P_{A}(Q|X)" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><msub id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p4.3.m3.1.1.3.3" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.3.m3.1.1.1.1.2" xref="S3.SS2.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.3.m3.1.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.1.1.1.2" xref="S3.SS2.p4.3.m3.1.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.SS2.p4.3.m3.1.1.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p4.3.m3.1.1.1.1.1.3" xref="S3.SS2.p4.3.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.SS2.p4.3.m3.1.1.1.1.3" xref="S3.SS2.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><times id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2"></times><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">𝑃</ci><ci id="S3.SS2.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3.3">𝐴</ci></apply><apply id="S3.SS2.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p4.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p4.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">P_{A}(Q|X)</annotation></semantics></math> to obtain <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="Q_{A}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑄</ci><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">Q_{A}</annotation></semantics></math> explicitly, a sequence of corresponding embeddings, <math id="S3.SS2.p4.5.m5.3" class="ltx_Math" alttext="[\cdots,e_{i}(Q_{A}),\cdots]" display="inline"><semantics id="S3.SS2.p4.5.m5.3a"><mrow id="S3.SS2.p4.5.m5.3.3.1" xref="S3.SS2.p4.5.m5.3.3.2.cmml"><mo stretchy="false" id="S3.SS2.p4.5.m5.3.3.1.2" xref="S3.SS2.p4.5.m5.3.3.2.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">⋯</mi><mo id="S3.SS2.p4.5.m5.3.3.1.3" xref="S3.SS2.p4.5.m5.3.3.2.cmml">,</mo><mrow id="S3.SS2.p4.5.m5.3.3.1.1" xref="S3.SS2.p4.5.m5.3.3.1.1.cmml"><msub id="S3.SS2.p4.5.m5.3.3.1.1.3" xref="S3.SS2.p4.5.m5.3.3.1.1.3.cmml"><mi id="S3.SS2.p4.5.m5.3.3.1.1.3.2" xref="S3.SS2.p4.5.m5.3.3.1.1.3.2.cmml">e</mi><mi id="S3.SS2.p4.5.m5.3.3.1.1.3.3" xref="S3.SS2.p4.5.m5.3.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.3.3.1.1.2" xref="S3.SS2.p4.5.m5.3.3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.5.m5.3.3.1.1.1.1" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.5.m5.3.3.1.1.1.1.2" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.2" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.3" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.3.cmml">A</mi></msub><mo stretchy="false" id="S3.SS2.p4.5.m5.3.3.1.1.1.1.3" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p4.5.m5.3.3.1.4" xref="S3.SS2.p4.5.m5.3.3.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p4.5.m5.2.2" xref="S3.SS2.p4.5.m5.2.2.cmml">⋯</mi><mo stretchy="false" id="S3.SS2.p4.5.m5.3.3.1.5" xref="S3.SS2.p4.5.m5.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.3b"><list id="S3.SS2.p4.5.m5.3.3.2.cmml" xref="S3.SS2.p4.5.m5.3.3.1"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">⋯</ci><apply id="S3.SS2.p4.5.m5.3.3.1.1.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1"><times id="S3.SS2.p4.5.m5.3.3.1.1.2.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.2"></times><apply id="S3.SS2.p4.5.m5.3.3.1.1.3.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.3.3.1.1.3.1.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.5.m5.3.3.1.1.3.2.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.3.2">𝑒</ci><ci id="S3.SS2.p4.5.m5.3.3.1.1.3.3.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.5.m5.3.3.1.1.1.1.1.3">𝐴</ci></apply></apply><ci id="S3.SS2.p4.5.m5.2.2.cmml" xref="S3.SS2.p4.5.m5.2.2">⋯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.3c">[\cdots,e_{i}(Q_{A}),\cdots]</annotation></semantics></math>, is obtained via alignment of the acoustic features with <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="Q_{L}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝑄</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">Q_{L}</annotation></semantics></math> from the label encoder, followed by a linear combination of the label embeddings,</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="\underbrace{[\cdots,e_{i}(Q_{A}),\cdots]}_{\text{same length as $Q_{L}$}}=[\cdots,\sum_{q\in{\cal V_{Q}}}P(q|x_{t(i)})e(q),\cdots]\ ." display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1" xref="S3.E4.m1.9.9.1.1.cmml"><munder id="S3.E4.m1.9.9.1.1.3" xref="S3.E4.m1.9.9.1.1.3.cmml"><munder accentunder="true" id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.3.3.2" xref="S3.E4.m1.4.4.3.4.cmml">[</mo><mi mathvariant="normal" id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">⋯</mi><mo id="S3.E4.m1.4.4.3.3.3" xref="S3.E4.m1.4.4.3.4.cmml">,</mo><mrow id="S3.E4.m1.4.4.3.3.1" xref="S3.E4.m1.4.4.3.3.1.cmml"><msub id="S3.E4.m1.4.4.3.3.1.3" xref="S3.E4.m1.4.4.3.3.1.3.cmml"><mi id="S3.E4.m1.4.4.3.3.1.3.2" xref="S3.E4.m1.4.4.3.3.1.3.2.cmml">e</mi><mi id="S3.E4.m1.4.4.3.3.1.3.3" xref="S3.E4.m1.4.4.3.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.3.3.1.2" xref="S3.E4.m1.4.4.3.3.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.3.3.1.1.1" xref="S3.E4.m1.4.4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.3.3.1.1.1.2" xref="S3.E4.m1.4.4.3.3.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.4.4.3.3.1.1.1.1" xref="S3.E4.m1.4.4.3.3.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.3.3.1.1.1.1.2" xref="S3.E4.m1.4.4.3.3.1.1.1.1.2.cmml">Q</mi><mi id="S3.E4.m1.4.4.3.3.1.1.1.1.3" xref="S3.E4.m1.4.4.3.3.1.1.1.1.3.cmml">A</mi></msub><mo stretchy="false" id="S3.E4.m1.4.4.3.3.1.1.1.3" xref="S3.E4.m1.4.4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.3.3.4" xref="S3.E4.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">⋯</mi><mo stretchy="false" id="S3.E4.m1.4.4.3.3.5" xref="S3.E4.m1.4.4.3.4.cmml">]</mo></mrow><mo id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml">⏟</mo></munder><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1b.cmml"><mtext id="S3.E4.m1.1.1.1a" xref="S3.E4.m1.1.1.1b.cmml">same length as </mtext><msub id="S3.E4.m1.1.1.1.1.1.m1.1.1" xref="S3.E4.m1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.m1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.m1.1.1.2.cmml">Q</mi><mi mathsize="98%" id="S3.E4.m1.1.1.1.1.1.m1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.m1.1.1.3.cmml">L</mi></msub></mrow></munder><mo id="S3.E4.m1.9.9.1.1.2" xref="S3.E4.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.9.9.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.2.cmml">[</mo><mi mathvariant="normal" id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">⋯</mi><mo rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.2.cmml">,</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml"><munder id="S3.E4.m1.9.9.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.9.9.1.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.2.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.2.cmml">q</mi><mo id="S3.E4.m1.9.9.1.1.1.1.1.2.3.1" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.2.cmml">𝒱</mi><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.3.cmml">𝒬</mi></msub></mrow></munder><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo fence="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.cmml"><mi id="S3.E4.m1.5.5.1.3" xref="S3.E4.m1.5.5.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.4.2" xref="S3.E4.m1.5.5.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.4.2.1" xref="S3.E4.m1.5.5.1.cmml">(</mo><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.5.5.1.4.2.2" xref="S3.E4.m1.5.5.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.1.2a" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.4" xref="S3.E4.m1.9.9.1.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.1.2b" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.5.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.5.2.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">q</mi><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.5.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.9.9.1.1.1.1.4" xref="S3.E4.m1.9.9.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml">⋯</mi><mo rspace="0.222em" stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.5" xref="S3.E4.m1.9.9.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.9.9.1.2" xref="S3.E4.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.1.1.cmml" xref="S3.E4.m1.9.9.1"><eq id="S3.E4.m1.9.9.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2"></eq><apply id="S3.E4.m1.9.9.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.3">subscript</csymbol><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><ci id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4">⏟</ci><list id="S3.E4.m1.4.4.3.4.cmml" xref="S3.E4.m1.4.4.3.3"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">⋯</ci><apply id="S3.E4.m1.4.4.3.3.1.cmml" xref="S3.E4.m1.4.4.3.3.1"><times id="S3.E4.m1.4.4.3.3.1.2.cmml" xref="S3.E4.m1.4.4.3.3.1.2"></times><apply id="S3.E4.m1.4.4.3.3.1.3.cmml" xref="S3.E4.m1.4.4.3.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.1.3.1.cmml" xref="S3.E4.m1.4.4.3.3.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.3.3.1.3.2.cmml" xref="S3.E4.m1.4.4.3.3.1.3.2">𝑒</ci><ci id="S3.E4.m1.4.4.3.3.1.3.3.cmml" xref="S3.E4.m1.4.4.3.3.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.3.3.1.1.1.1.cmml" xref="S3.E4.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.3.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.3.3.1.1.1.1.2">𝑄</ci><ci id="S3.E4.m1.4.4.3.3.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.3.3.1.1.1.1.3">𝐴</ci></apply></apply><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">⋯</ci></list></apply><ci id="S3.E4.m1.1.1.1b.cmml" xref="S3.E4.m1.1.1.1"><mrow id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><mtext mathsize="70%" id="S3.E4.m1.1.1.1a.cmml" xref="S3.E4.m1.1.1.1">same length as </mtext><msub id="S3.E4.m1.1.1.1.1.1.m1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.m1.1.1"><mi mathsize="70%" id="S3.E4.m1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.m1.1.1.2">Q</mi><mi mathsize="70%" id="S3.E4.m1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.m1.1.1.3">L</mi></msub></mrow></ci></apply><list id="S3.E4.m1.9.9.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1"><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">⋯</ci><apply id="S3.E4.m1.9.9.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2"></sum><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3"><in id="S3.E4.m1.9.9.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.1"></in><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.2">𝑞</ci><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.2">𝒱</ci><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.3">𝒬</ci></apply></apply></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.3">𝑃</ci><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2">𝑞</ci><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E4.m1.5.5.1.cmml" xref="S3.E4.m1.5.5.1"><times id="S3.E4.m1.5.5.1.2.cmml" xref="S3.E4.m1.5.5.1.2"></times><ci id="S3.E4.m1.5.5.1.3.cmml" xref="S3.E4.m1.5.5.1.3">𝑡</ci><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑖</ci></apply></apply></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.4">𝑒</ci><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑞</ci></apply></apply><ci id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8">⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\underbrace{[\cdots,e_{i}(Q_{A}),\cdots]}_{\text{same length as $Q_{L}$}}=[\cdots,\sum_{q\in{\cal V_{Q}}}P(q|x_{t(i)})e(q),\cdots]\ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.11" class="ltx_p">Here, for each token <math id="S3.SS2.p4.7.m1.1" class="ltx_Math" alttext="q_{i}\in Q_{L}" display="inline"><semantics id="S3.SS2.p4.7.m1.1a"><mrow id="S3.SS2.p4.7.m1.1.1" xref="S3.SS2.p4.7.m1.1.1.cmml"><msub id="S3.SS2.p4.7.m1.1.1.2" xref="S3.SS2.p4.7.m1.1.1.2.cmml"><mi id="S3.SS2.p4.7.m1.1.1.2.2" xref="S3.SS2.p4.7.m1.1.1.2.2.cmml">q</mi><mi id="S3.SS2.p4.7.m1.1.1.2.3" xref="S3.SS2.p4.7.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p4.7.m1.1.1.1" xref="S3.SS2.p4.7.m1.1.1.1.cmml">∈</mo><msub id="S3.SS2.p4.7.m1.1.1.3" xref="S3.SS2.p4.7.m1.1.1.3.cmml"><mi id="S3.SS2.p4.7.m1.1.1.3.2" xref="S3.SS2.p4.7.m1.1.1.3.2.cmml">Q</mi><mi id="S3.SS2.p4.7.m1.1.1.3.3" xref="S3.SS2.p4.7.m1.1.1.3.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m1.1b"><apply id="S3.SS2.p4.7.m1.1.1.cmml" xref="S3.SS2.p4.7.m1.1.1"><in id="S3.SS2.p4.7.m1.1.1.1.cmml" xref="S3.SS2.p4.7.m1.1.1.1"></in><apply id="S3.SS2.p4.7.m1.1.1.2.cmml" xref="S3.SS2.p4.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m1.1.1.2.1.cmml" xref="S3.SS2.p4.7.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.7.m1.1.1.2.2.cmml" xref="S3.SS2.p4.7.m1.1.1.2.2">𝑞</ci><ci id="S3.SS2.p4.7.m1.1.1.2.3.cmml" xref="S3.SS2.p4.7.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p4.7.m1.1.1.3.cmml" xref="S3.SS2.p4.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m1.1.1.3.1.cmml" xref="S3.SS2.p4.7.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.7.m1.1.1.3.2.cmml" xref="S3.SS2.p4.7.m1.1.1.3.2">𝑄</ci><ci id="S3.SS2.p4.7.m1.1.1.3.3.cmml" xref="S3.SS2.p4.7.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m1.1c">q_{i}\in Q_{L}</annotation></semantics></math>, we use the aligned feature, <math id="S3.SS2.p4.8.m2.1" class="ltx_Math" alttext="x_{t(i)}" display="inline"><semantics id="S3.SS2.p4.8.m2.1a"><msub id="S3.SS2.p4.8.m2.1.2" xref="S3.SS2.p4.8.m2.1.2.cmml"><mi id="S3.SS2.p4.8.m2.1.2.2" xref="S3.SS2.p4.8.m2.1.2.2.cmml">x</mi><mrow id="S3.SS2.p4.8.m2.1.1.1" xref="S3.SS2.p4.8.m2.1.1.1.cmml"><mi id="S3.SS2.p4.8.m2.1.1.1.3" xref="S3.SS2.p4.8.m2.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.8.m2.1.1.1.2" xref="S3.SS2.p4.8.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.8.m2.1.1.1.4.2" xref="S3.SS2.p4.8.m2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.8.m2.1.1.1.4.2.1" xref="S3.SS2.p4.8.m2.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.8.m2.1.1.1.1" xref="S3.SS2.p4.8.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p4.8.m2.1.1.1.4.2.2" xref="S3.SS2.p4.8.m2.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m2.1b"><apply id="S3.SS2.p4.8.m2.1.2.cmml" xref="S3.SS2.p4.8.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m2.1.2.1.cmml" xref="S3.SS2.p4.8.m2.1.2">subscript</csymbol><ci id="S3.SS2.p4.8.m2.1.2.2.cmml" xref="S3.SS2.p4.8.m2.1.2.2">𝑥</ci><apply id="S3.SS2.p4.8.m2.1.1.1.cmml" xref="S3.SS2.p4.8.m2.1.1.1"><times id="S3.SS2.p4.8.m2.1.1.1.2.cmml" xref="S3.SS2.p4.8.m2.1.1.1.2"></times><ci id="S3.SS2.p4.8.m2.1.1.1.3.cmml" xref="S3.SS2.p4.8.m2.1.1.1.3">𝑡</ci><ci id="S3.SS2.p4.8.m2.1.1.1.1.cmml" xref="S3.SS2.p4.8.m2.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m2.1c">x_{t(i)}</annotation></semantics></math>, for which <math id="S3.SS2.p4.9.m3.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="S3.SS2.p4.9.m3.1a"><msub id="S3.SS2.p4.9.m3.1.1" xref="S3.SS2.p4.9.m3.1.1.cmml"><mi id="S3.SS2.p4.9.m3.1.1.2" xref="S3.SS2.p4.9.m3.1.1.2.cmml">q</mi><mi id="S3.SS2.p4.9.m3.1.1.3" xref="S3.SS2.p4.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m3.1b"><apply id="S3.SS2.p4.9.m3.1.1.cmml" xref="S3.SS2.p4.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m3.1.1.1.cmml" xref="S3.SS2.p4.9.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.9.m3.1.1.2.cmml" xref="S3.SS2.p4.9.m3.1.1.2">𝑞</ci><ci id="S3.SS2.p4.9.m3.1.1.3.cmml" xref="S3.SS2.p4.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m3.1c">q_{i}</annotation></semantics></math> is first emitted.
Then, we compute the posterior probabilities across all embedding vectors in the VQ codebook, <math id="S3.SS2.p4.10.m4.2" class="ltx_Math" alttext="P(q|x_{t(i)})" display="inline"><semantics id="S3.SS2.p4.10.m4.2a"><mrow id="S3.SS2.p4.10.m4.2.2" xref="S3.SS2.p4.10.m4.2.2.cmml"><mi id="S3.SS2.p4.10.m4.2.2.3" xref="S3.SS2.p4.10.m4.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.10.m4.2.2.2" xref="S3.SS2.p4.10.m4.2.2.2.cmml">​</mo><mrow id="S3.SS2.p4.10.m4.2.2.1.1" xref="S3.SS2.p4.10.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.10.m4.2.2.1.1.2" xref="S3.SS2.p4.10.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.10.m4.2.2.1.1.1" xref="S3.SS2.p4.10.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p4.10.m4.2.2.1.1.1.2" xref="S3.SS2.p4.10.m4.2.2.1.1.1.2.cmml">q</mi><mo fence="false" id="S3.SS2.p4.10.m4.2.2.1.1.1.1" xref="S3.SS2.p4.10.m4.2.2.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p4.10.m4.2.2.1.1.1.3" xref="S3.SS2.p4.10.m4.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p4.10.m4.2.2.1.1.1.3.2" xref="S3.SS2.p4.10.m4.2.2.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS2.p4.10.m4.1.1.1" xref="S3.SS2.p4.10.m4.1.1.1.cmml"><mi id="S3.SS2.p4.10.m4.1.1.1.3" xref="S3.SS2.p4.10.m4.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.10.m4.1.1.1.2" xref="S3.SS2.p4.10.m4.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.10.m4.1.1.1.4.2" xref="S3.SS2.p4.10.m4.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.10.m4.1.1.1.4.2.1" xref="S3.SS2.p4.10.m4.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.10.m4.1.1.1.1" xref="S3.SS2.p4.10.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p4.10.m4.1.1.1.4.2.2" xref="S3.SS2.p4.10.m4.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.p4.10.m4.2.2.1.1.3" xref="S3.SS2.p4.10.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m4.2b"><apply id="S3.SS2.p4.10.m4.2.2.cmml" xref="S3.SS2.p4.10.m4.2.2"><times id="S3.SS2.p4.10.m4.2.2.2.cmml" xref="S3.SS2.p4.10.m4.2.2.2"></times><ci id="S3.SS2.p4.10.m4.2.2.3.cmml" xref="S3.SS2.p4.10.m4.2.2.3">𝑃</ci><apply id="S3.SS2.p4.10.m4.2.2.1.1.1.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p4.10.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p4.10.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1.1.2">𝑞</ci><apply id="S3.SS2.p4.10.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.10.m4.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.10.m4.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p4.10.m4.2.2.1.1.1.3.2">𝑥</ci><apply id="S3.SS2.p4.10.m4.1.1.1.cmml" xref="S3.SS2.p4.10.m4.1.1.1"><times id="S3.SS2.p4.10.m4.1.1.1.2.cmml" xref="S3.SS2.p4.10.m4.1.1.1.2"></times><ci id="S3.SS2.p4.10.m4.1.1.1.3.cmml" xref="S3.SS2.p4.10.m4.1.1.1.3">𝑡</ci><ci id="S3.SS2.p4.10.m4.1.1.1.1.cmml" xref="S3.SS2.p4.10.m4.1.1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m4.2c">P(q|x_{t(i)})</annotation></semantics></math>,
and use them to construct the embedding to be fed to the label decoder, <math id="S3.SS2.p4.11.m5.1" class="ltx_Math" alttext="e_{i}(Q_{A})" display="inline"><semantics id="S3.SS2.p4.11.m5.1a"><mrow id="S3.SS2.p4.11.m5.1.1" xref="S3.SS2.p4.11.m5.1.1.cmml"><msub id="S3.SS2.p4.11.m5.1.1.3" xref="S3.SS2.p4.11.m5.1.1.3.cmml"><mi id="S3.SS2.p4.11.m5.1.1.3.2" xref="S3.SS2.p4.11.m5.1.1.3.2.cmml">e</mi><mi id="S3.SS2.p4.11.m5.1.1.3.3" xref="S3.SS2.p4.11.m5.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p4.11.m5.1.1.2" xref="S3.SS2.p4.11.m5.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.11.m5.1.1.1.1" xref="S3.SS2.p4.11.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.11.m5.1.1.1.1.2" xref="S3.SS2.p4.11.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p4.11.m5.1.1.1.1.1" xref="S3.SS2.p4.11.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.11.m5.1.1.1.1.1.2" xref="S3.SS2.p4.11.m5.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p4.11.m5.1.1.1.1.1.3" xref="S3.SS2.p4.11.m5.1.1.1.1.1.3.cmml">A</mi></msub><mo stretchy="false" id="S3.SS2.p4.11.m5.1.1.1.1.3" xref="S3.SS2.p4.11.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m5.1b"><apply id="S3.SS2.p4.11.m5.1.1.cmml" xref="S3.SS2.p4.11.m5.1.1"><times id="S3.SS2.p4.11.m5.1.1.2.cmml" xref="S3.SS2.p4.11.m5.1.1.2"></times><apply id="S3.SS2.p4.11.m5.1.1.3.cmml" xref="S3.SS2.p4.11.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.11.m5.1.1.3.1.cmml" xref="S3.SS2.p4.11.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.11.m5.1.1.3.2.cmml" xref="S3.SS2.p4.11.m5.1.1.3.2">𝑒</ci><ci id="S3.SS2.p4.11.m5.1.1.3.3.cmml" xref="S3.SS2.p4.11.m5.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p4.11.m5.1.1.1.1.1.cmml" xref="S3.SS2.p4.11.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.11.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.11.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.11.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.11.m5.1.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p4.11.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.11.m5.1.1.1.1.1.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m5.1c">e_{i}(Q_{A})</annotation></semantics></math>.
This term would optimize the label decoder and the acoustic encoder end-to-end.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">The third term is a CTC loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for the acoustic encoder.
This term computes how well the acoustic features are aligned to the latent variables, <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="Q_{L}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑄</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">Q_{L}</annotation></semantics></math>, which are decided by
the label encoder. The CTC loss would also produce the alignment information required to compute the second term. This term would optimize only
the acoustic encoder. Finally, the fourth term is the quantization loss for VQ.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Vector quantization variational auto-encoder</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.4" class="ltx_p">In this work, we use a vector quantization variational auto-encoder (VQ-VAE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> as our vector quantizer. VQ-VAE discretizes real-valued vectors into some discrete
variables while still allowing a neural network to be trained end-to-end. Standard version of VQ-VAE consists of a codebook of <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">M</annotation></semantics></math> embedding vectors. During inference,
an input vector, <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">z</annotation></semantics></math>, will be compared to all embedding vectors in the codebook. The closest one
based on euclidean distance will be chosen and VQ-VAE would output the embedding vector <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="e(q)" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.2" xref="S3.SS3.p1.3.m3.1.2.cmml"><mi id="S3.SS3.p1.3.m3.1.2.2" xref="S3.SS3.p1.3.m3.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.1.2.1" xref="S3.SS3.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.3.m3.1.2.3.2" xref="S3.SS3.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.1.2.3.2.1" xref="S3.SS3.p1.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">q</mi><mo stretchy="false" id="S3.SS3.p1.3.m3.1.2.3.2.2" xref="S3.SS3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.2.cmml" xref="S3.SS3.p1.3.m3.1.2"><times id="S3.SS3.p1.3.m3.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.2.1"></times><ci id="S3.SS3.p1.3.m3.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.2.2">𝑒</ci><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">e(q)</annotation></semantics></math> and its index <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">q</annotation></semantics></math>.
During training, it optimizes the following loss function,</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\textit{VQLoss}(z)=||\textit{sg}[z]-e(q_{z})||_{2}+\beta||z-\textit{sg}[e(q_{z})]||_{2}\ ," display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.4" xref="S3.E5.m1.3.3.1.1.4.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.4.2" xref="S3.E5.m1.3.3.1.1.4.2a.cmml">VQLoss</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.4.1" xref="S3.E5.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.4.3.2" xref="S3.E5.m1.3.3.1.1.4.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.4.3.2.1" xref="S3.E5.m1.3.3.1.1.4.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.1.4.3.2.2" xref="S3.E5.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml">sg</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E5.m1.3.3.1.1.2.3" xref="S3.E5.m1.3.3.1.1.2.3.cmml">+</mo><mrow id="S3.E5.m1.3.3.1.1.2.2" xref="S3.E5.m1.3.3.1.1.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.3.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml">​</mo><msub id="S3.E5.m1.3.3.1.1.2.2.1" xref="S3.E5.m1.3.3.1.1.2.2.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.3.cmml">z</mi><mo id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3a.cmml">sg</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m1.3.3.1.1.2.2.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.3.cmml">2</mn></msub></mrow></mrow></mrow><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3"></eq><apply id="S3.E5.m1.3.3.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.4"><times id="S3.E5.m1.3.3.1.1.4.1.cmml" xref="S3.E5.m1.3.3.1.1.4.1"></times><ci id="S3.E5.m1.3.3.1.1.4.2a.cmml" xref="S3.E5.m1.3.3.1.1.4.2"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.4.2.cmml" xref="S3.E5.m1.3.3.1.1.4.2">VQLoss</mtext></ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑧</ci></apply><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><plus id="S3.E5.m1.3.3.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.3"></plus><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.2"></minus><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3"><times id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.2">sg</mtext></ci><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑧</ci></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3">𝑒</ci><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">2</cn></apply><apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2"><times id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2"></times><ci id="S3.E5.m1.3.3.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3">𝛽</ci><apply id="S3.E5.m1.3.3.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1">subscript</csymbol><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1"><minus id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2"></minus><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.3">𝑧</ci><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3">sg</mtext></ci><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">𝑒</ci><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></apply></apply><cn type="integer" id="S3.E5.m1.3.3.1.1.2.2.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\textit{VQLoss}(z)=||\textit{sg}[z]-e(q_{z})||_{2}+\beta||z-\textit{sg}[e(q_{z})]||_{2}\ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.10" class="ltx_p">where <math id="S3.SS3.p1.5.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.p1.5.m1.1a"><mi id="S3.SS3.p1.5.m1.1.1" xref="S3.SS3.p1.5.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m1.1b"><ci id="S3.SS3.p1.5.m1.1.1.cmml" xref="S3.SS3.p1.5.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m1.1c">z</annotation></semantics></math> is the input to the VQ module; <math id="S3.SS3.p1.6.m2.1" class="ltx_Math" alttext="q_{z}" display="inline"><semantics id="S3.SS3.p1.6.m2.1a"><msub id="S3.SS3.p1.6.m2.1.1" xref="S3.SS3.p1.6.m2.1.1.cmml"><mi id="S3.SS3.p1.6.m2.1.1.2" xref="S3.SS3.p1.6.m2.1.1.2.cmml">q</mi><mi id="S3.SS3.p1.6.m2.1.1.3" xref="S3.SS3.p1.6.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m2.1b"><apply id="S3.SS3.p1.6.m2.1.1.cmml" xref="S3.SS3.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m2.1.1.1.cmml" xref="S3.SS3.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m2.1.1.2.cmml" xref="S3.SS3.p1.6.m2.1.1.2">𝑞</ci><ci id="S3.SS3.p1.6.m2.1.1.3.cmml" xref="S3.SS3.p1.6.m2.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m2.1c">q_{z}</annotation></semantics></math> is the index of the closest embedding vector <math id="S3.SS3.p1.7.m3.1" class="ltx_Math" alttext="e(q_{z})" display="inline"><semantics id="S3.SS3.p1.7.m3.1a"><mrow id="S3.SS3.p1.7.m3.1.1" xref="S3.SS3.p1.7.m3.1.1.cmml"><mi id="S3.SS3.p1.7.m3.1.1.3" xref="S3.SS3.p1.7.m3.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.7.m3.1.1.2" xref="S3.SS3.p1.7.m3.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.7.m3.1.1.1.1" xref="S3.SS3.p1.7.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.7.m3.1.1.1.1.2" xref="S3.SS3.p1.7.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.7.m3.1.1.1.1.1" xref="S3.SS3.p1.7.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.7.m3.1.1.1.1.1.2" xref="S3.SS3.p1.7.m3.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS3.p1.7.m3.1.1.1.1.1.3" xref="S3.SS3.p1.7.m3.1.1.1.1.1.3.cmml">z</mi></msub><mo stretchy="false" id="S3.SS3.p1.7.m3.1.1.1.1.3" xref="S3.SS3.p1.7.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m3.1b"><apply id="S3.SS3.p1.7.m3.1.1.cmml" xref="S3.SS3.p1.7.m3.1.1"><times id="S3.SS3.p1.7.m3.1.1.2.cmml" xref="S3.SS3.p1.7.m3.1.1.2"></times><ci id="S3.SS3.p1.7.m3.1.1.3.cmml" xref="S3.SS3.p1.7.m3.1.1.3">𝑒</ci><apply id="S3.SS3.p1.7.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.7.m3.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.p1.7.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.7.m3.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m3.1c">e(q_{z})</annotation></semantics></math> to <math id="S3.SS3.p1.8.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.p1.8.m4.1a"><mi id="S3.SS3.p1.8.m4.1.1" xref="S3.SS3.p1.8.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m4.1b"><ci id="S3.SS3.p1.8.m4.1.1.cmml" xref="S3.SS3.p1.8.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m4.1c">z</annotation></semantics></math>; <math id="S3.SS3.p1.9.m5.1" class="ltx_Math" alttext="sg" display="inline"><semantics id="S3.SS3.p1.9.m5.1a"><mrow id="S3.SS3.p1.9.m5.1.1" xref="S3.SS3.p1.9.m5.1.1.cmml"><mi id="S3.SS3.p1.9.m5.1.1.2" xref="S3.SS3.p1.9.m5.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m5.1.1.1" xref="S3.SS3.p1.9.m5.1.1.1.cmml">​</mo><mi id="S3.SS3.p1.9.m5.1.1.3" xref="S3.SS3.p1.9.m5.1.1.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m5.1b"><apply id="S3.SS3.p1.9.m5.1.1.cmml" xref="S3.SS3.p1.9.m5.1.1"><times id="S3.SS3.p1.9.m5.1.1.1.cmml" xref="S3.SS3.p1.9.m5.1.1.1"></times><ci id="S3.SS3.p1.9.m5.1.1.2.cmml" xref="S3.SS3.p1.9.m5.1.1.2">𝑠</ci><ci id="S3.SS3.p1.9.m5.1.1.3.cmml" xref="S3.SS3.p1.9.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m5.1c">sg</annotation></semantics></math> is the stop gradient operator and <math id="S3.SS3.p1.10.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS3.p1.10.m6.1a"><mi id="S3.SS3.p1.10.m6.1.1" xref="S3.SS3.p1.10.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m6.1b"><ci id="S3.SS3.p1.10.m6.1.1.cmml" xref="S3.SS3.p1.10.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m6.1c">\beta</annotation></semantics></math> is a tunable parameter.
This loss function aims to keep the embedding vectors close to the inputs, and this design helps the training to be more stable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
To enable back-propagation, it uses a straight-through estimator that copies the gradient from the downstream to the upstream directly,
as if the VQ component does not exist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.5" class="ltx_p">The representational power of VQ-VAE depends on the size of the codebook. Given a codebook of <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">M</annotation></semantics></math> embeddings, it assumes the inputs can be grouped into <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">M</annotation></semantics></math> clusters.
Residual VQ-VAE (RVQ-VAE) improves by applying multiple VQ-VAE iteratively to an input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
For RVQ-VAE, we have <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">N</annotation></semantics></math> codebooks and each codebook has <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">M</annotation></semantics></math> embeddings. Given an input, it is quantized by the first VQ-VAE module and the difference between the input and quantized embedding would then be quantized by the next VQ-VAE module. This process continues until it has used all the codebooks in RVQ-VAE. Theoretically, RVQ-VAE
can represent up to <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="M^{N}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msup id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">M</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑀</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">M^{N}</annotation></semantics></math> different inputs.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.3" class="ltx_p">In this paper, we use RVQ-VAE with two or three (<math id="S3.SS3.p3.1.m1.2" class="ltx_Math" alttext="N=2,3" display="inline"><semantics id="S3.SS3.p3.1.m1.2a"><mrow id="S3.SS3.p3.1.m1.2.3" xref="S3.SS3.p3.1.m1.2.3.cmml"><mi id="S3.SS3.p3.1.m1.2.3.2" xref="S3.SS3.p3.1.m1.2.3.2.cmml">N</mi><mo id="S3.SS3.p3.1.m1.2.3.1" xref="S3.SS3.p3.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p3.1.m1.2.3.3.2" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml"><mn id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">2</mn><mo id="S3.SS3.p3.1.m1.2.3.3.2.1" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p3.1.m1.2.2" xref="S3.SS3.p3.1.m1.2.2.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.2b"><apply id="S3.SS3.p3.1.m1.2.3.cmml" xref="S3.SS3.p3.1.m1.2.3"><eq id="S3.SS3.p3.1.m1.2.3.1.cmml" xref="S3.SS3.p3.1.m1.2.3.1"></eq><ci id="S3.SS3.p3.1.m1.2.3.2.cmml" xref="S3.SS3.p3.1.m1.2.3.2">𝑁</ci><list id="S3.SS3.p3.1.m1.2.3.3.1.cmml" xref="S3.SS3.p3.1.m1.2.3.3.2"><cn type="integer" id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">2</cn><cn type="integer" id="S3.SS3.p3.1.m1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.2c">N=2,3</annotation></semantics></math>) codebooks and the codebook size <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">M</annotation></semantics></math> is always 256.
Therefore, each embedding index can be represented by one byte, and each label token is represented by <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">N</annotation></semantics></math> bytes.
We choose this setting so we can compare to UTF-8 encoding, though in practice, one can pick any number of codebooks and codebook size.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Convert bytes to labels with error correction</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">When using a byte-level representation, errors made by the ASR model could create invalid byte sequences. For example, the byte sequence might contain substitution, deletion or insertion errors.
Therefore, we need an error correction mechanism, and such a mechanism should optimize for accuracy.
In our proposed VQ representation, the label decoder at inference time can perform error correction by estimating the most likely label sequence, as shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.4 Convert bytes to labels with error correction ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
In this algorithm, errors in a byte sequence would affect the quality of the embeddings, but the label decoder still has the potential to map those embeddings to the correct label.
Note that this algorithm is also used at training time with the multiple bytes per label token produced by RVQ-VAE, but since the byte sequence is decided by the label encoder applied to the reference text, optimization does not directly target insertion or deletion errors.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> The bytes to labels conversion procedure for our proposed VQ based representation. The label decoder would produce the most likely labels even if the input byte sequence contains errors</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text ltx_font_bold">function</span> <span id="alg1.l1.2" class="ltx_text ltx_font_smallcaps">bytes_to_labels</span>(Q: List[int])

</div>
<div id="alg1.l2" class="ltx_listingline">     <math id="alg1.l2.m1.1" class="ltx_Math" alttext="W\leftarrow[]" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">W</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mrow id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.1" xref="alg1.l2.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.2" xref="alg1.l2.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑊</ci><list id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">W\leftarrow[]</annotation></semantics></math> <span id="alg1.l2.1" class="ltx_text" style="float:right;"><math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation></semantics></math> the label sequence to be returned
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">     <math id="alg1.l3.m1.1" class="ltx_Math" alttext="v\leftarrow\overrightarrow{0}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">v</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mover accent="true" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mn id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">0</mn><mo stretchy="false" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">→</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑣</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><ci id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1">→</ci><cn type="integer" id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">v\leftarrow\overrightarrow{0}</annotation></semantics></math> <span id="alg1.l3.1" class="ltx_text" style="float:right;"><math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation></semantics></math> a variable to store the embedding
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="k\leftarrow-1" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">k</mi><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mo id="alg1.l4.m1.1.1.3a" xref="alg1.l4.m1.1.1.3.cmml">−</mo><mn id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑘</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><minus id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3"></minus><cn type="integer" id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">k\leftarrow-1</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.4" class="ltx_Math" alttext="i=1,\dots,len(Q)" display="inline"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mi id="alg1.l5.m1.4.4.3" xref="alg1.l5.m1.4.4.3.cmml">i</mi><mo id="alg1.l5.m1.4.4.2" xref="alg1.l5.m1.4.4.2.cmml">=</mo><mrow id="alg1.l5.m1.4.4.1.1" xref="alg1.l5.m1.4.4.1.2.cmml"><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">1</mn><mo id="alg1.l5.m1.4.4.1.1.2" xref="alg1.l5.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">…</mi><mo id="alg1.l5.m1.4.4.1.1.3" xref="alg1.l5.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l5.m1.4.4.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.2" xref="alg1.l5.m1.4.4.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.4.4.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l5.m1.4.4.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.4.4.1.1.1.1a" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l5.m1.4.4.1.1.1.4" xref="alg1.l5.m1.4.4.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.4.4.1.1.1.1b" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">​</mo><mrow id="alg1.l5.m1.4.4.1.1.1.5.2" xref="alg1.l5.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.4.4.1.1.1.5.2.1" xref="alg1.l5.m1.4.4.1.1.1.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">Q</mi><mo stretchy="false" id="alg1.l5.m1.4.4.1.1.1.5.2.2" xref="alg1.l5.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><eq id="alg1.l5.m1.4.4.2.cmml" xref="alg1.l5.m1.4.4.2"></eq><ci id="alg1.l5.m1.4.4.3.cmml" xref="alg1.l5.m1.4.4.3">𝑖</ci><list id="alg1.l5.m1.4.4.1.2.cmml" xref="alg1.l5.m1.4.4.1.1"><cn type="integer" id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">1</cn><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">…</ci><apply id="alg1.l5.m1.4.4.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1"><times id="alg1.l5.m1.4.4.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1"></times><ci id="alg1.l5.m1.4.4.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.2">𝑙</ci><ci id="alg1.l5.m1.4.4.1.1.1.3.cmml" xref="alg1.l5.m1.4.4.1.1.1.3">𝑒</ci><ci id="alg1.l5.m1.4.4.1.1.1.4.cmml" xref="alg1.l5.m1.4.4.1.1.1.4">𝑛</ci><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑄</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">i=1,\dots,len(Q)</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l6" class="ltx_listingline">         <math id="alg1.l6.m1.2" class="ltx_Math" alttext="j\leftarrow cb(Q[i])" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mi id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">j</mi><mo stretchy="false" id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml">←</mo><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml"><mi id="alg1.l6.m1.2.2.1.3" xref="alg1.l6.m1.2.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l6.m1.2.2.1.4" xref="alg1.l6.m1.2.2.1.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.2a" xref="alg1.l6.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.1.3.2.1" xref="alg1.l6.m1.2.2.1.1.1.1.3.1.1.cmml">[</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.1.3.2.2" xref="alg1.l6.m1.2.2.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2">←</ci><ci id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3">𝑗</ci><apply id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1"><times id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.2"></times><ci id="alg1.l6.m1.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.1.3">𝑐</ci><ci id="alg1.l6.m1.2.2.1.4.cmml" xref="alg1.l6.m1.2.2.1.4">𝑏</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><times id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1"></times><ci id="alg1.l6.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2">𝑄</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3.2"><csymbol cd="latexml" id="alg1.l6.m1.2.2.1.1.1.1.3.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">j\leftarrow cb(Q[i])</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text" style="float:right;"><math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation></semantics></math> get the codebook index of <math id="alg1.l6.2.m2.1" class="ltx_Math" alttext="Q[i]" display="inline"><semantics id="alg1.l6.2.m2.1a"><mrow id="alg1.l6.2.m2.1.2" xref="alg1.l6.2.m2.1.2.cmml"><mi id="alg1.l6.2.m2.1.2.2" xref="alg1.l6.2.m2.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l6.2.m2.1.2.1" xref="alg1.l6.2.m2.1.2.1.cmml">​</mo><mrow id="alg1.l6.2.m2.1.2.3.2" xref="alg1.l6.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="alg1.l6.2.m2.1.2.3.2.1" xref="alg1.l6.2.m2.1.2.3.1.1.cmml">[</mo><mi id="alg1.l6.2.m2.1.1" xref="alg1.l6.2.m2.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l6.2.m2.1.2.3.2.2" xref="alg1.l6.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.2.m2.1b"><apply id="alg1.l6.2.m2.1.2.cmml" xref="alg1.l6.2.m2.1.2"><times id="alg1.l6.2.m2.1.2.1.cmml" xref="alg1.l6.2.m2.1.2.1"></times><ci id="alg1.l6.2.m2.1.2.2.cmml" xref="alg1.l6.2.m2.1.2.2">𝑄</ci><apply id="alg1.l6.2.m2.1.2.3.1.cmml" xref="alg1.l6.2.m2.1.2.3.2"><csymbol cd="latexml" id="alg1.l6.2.m2.1.2.3.1.1.cmml" xref="alg1.l6.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l6.2.m2.1.1.cmml" xref="alg1.l6.2.m2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.2.m2.1c">Q[i]</annotation></semantics></math>
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">         <span id="alg1.l7.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l7.m1.1" class="ltx_math_unparsed" alttext="k==-1\textit{ or }k&lt;j" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1b"><mi id="alg1.l7.m1.1.1">k</mi><mo rspace="0em" id="alg1.l7.m1.1.2">=</mo><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.3">=</mo><mo lspace="0em" id="alg1.l7.m1.1.4">−</mo><mn id="alg1.l7.m1.1.5">1</mn><mtext class="ltx_mathvariant_italic" id="alg1.l7.m1.1.6"> or </mtext><mi id="alg1.l7.m1.1.7">k</mi><mo id="alg1.l7.m1.1.8">&lt;</mo><mi id="alg1.l7.m1.1.9">j</mi></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">k==-1\textit{ or }k&lt;j</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg1.l8" class="ltx_listingline">              <math id="alg1.l8.m1.2" class="ltx_Math" alttext="v\leftarrow v+e(Q[i])" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mi id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">v</mi><mo stretchy="false" id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">←</mo><mrow id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.1.cmml"><mi id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.2.2.1.3.cmml">v</mi><mo id="alg1.l8.m1.2.2.1.2" xref="alg1.l8.m1.2.2.1.2.cmml">+</mo><mrow id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.3" xref="alg1.l8.m1.2.2.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.1.1.2" xref="alg1.l8.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.2.2.1.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.1.1.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l8.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.1.3.2.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.1.3.2.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2">←</ci><ci id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3">𝑣</ci><apply id="alg1.l8.m1.2.2.1.cmml" xref="alg1.l8.m1.2.2.1"><plus id="alg1.l8.m1.2.2.1.2.cmml" xref="alg1.l8.m1.2.2.1.2"></plus><ci id="alg1.l8.m1.2.2.1.3.cmml" xref="alg1.l8.m1.2.2.1.3">𝑣</ci><apply id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1"><times id="alg1.l8.m1.2.2.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.2"></times><ci id="alg1.l8.m1.2.2.1.1.3.cmml" xref="alg1.l8.m1.2.2.1.1.3">𝑒</ci><apply id="alg1.l8.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1"><times id="alg1.l8.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.1"></times><ci id="alg1.l8.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.2">𝑄</ci><apply id="alg1.l8.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="latexml" id="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">v\leftarrow v+e(Q[i])</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> add the <math id="alg1.l8.2.m2.1" class="ltx_Math" alttext="Q[i]" display="inline"><semantics id="alg1.l8.2.m2.1a"><mrow id="alg1.l8.2.m2.1.2" xref="alg1.l8.2.m2.1.2.cmml"><mi id="alg1.l8.2.m2.1.2.2" xref="alg1.l8.2.m2.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l8.2.m2.1.2.1" xref="alg1.l8.2.m2.1.2.1.cmml">​</mo><mrow id="alg1.l8.2.m2.1.2.3.2" xref="alg1.l8.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="alg1.l8.2.m2.1.2.3.2.1" xref="alg1.l8.2.m2.1.2.3.1.1.cmml">[</mo><mi id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l8.2.m2.1.2.3.2.2" xref="alg1.l8.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b"><apply id="alg1.l8.2.m2.1.2.cmml" xref="alg1.l8.2.m2.1.2"><times id="alg1.l8.2.m2.1.2.1.cmml" xref="alg1.l8.2.m2.1.2.1"></times><ci id="alg1.l8.2.m2.1.2.2.cmml" xref="alg1.l8.2.m2.1.2.2">𝑄</ci><apply id="alg1.l8.2.m2.1.2.3.1.cmml" xref="alg1.l8.2.m2.1.2.3.2"><csymbol cd="latexml" id="alg1.l8.2.m2.1.2.3.1.1.cmml" xref="alg1.l8.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">Q[i]</annotation></semantics></math>'s emb to <math id="alg1.l8.3.m3.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg1.l8.3.m3.1a"><mi id="alg1.l8.3.m3.1.1" xref="alg1.l8.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.3.m3.1b"><ci id="alg1.l8.3.m3.1.1.cmml" xref="alg1.l8.3.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.3.m3.1c">v</annotation></semantics></math>
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">         <span id="alg1.l9.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg1.l10" class="ltx_listingline">              <math id="alg1.l10.m1.1" class="ltx_Math" alttext="w\leftarrow\operatorname*{arg\,max}_{w}P_{D}(w|v)" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">w</mi><mo stretchy="false" id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">←</mo><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.3.cmml"><msub id="alg1.l10.m1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.3.1.cmml"><mrow id="alg1.l10.m1.1.1.1.3.1.2" xref="alg1.l10.m1.1.1.1.3.1.2.cmml"><mi id="alg1.l10.m1.1.1.1.3.1.2.2" xref="alg1.l10.m1.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="alg1.l10.m1.1.1.1.3.1.2.1" xref="alg1.l10.m1.1.1.1.3.1.2.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.3.1.2.3" xref="alg1.l10.m1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="alg1.l10.m1.1.1.1.3.1.3" xref="alg1.l10.m1.1.1.1.3.1.3.cmml">w</mi></msub><mo id="alg1.l10.m1.1.1.1.3a" xref="alg1.l10.m1.1.1.1.3.cmml">⁡</mo><msub id="alg1.l10.m1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.3.2.cmml"><mi id="alg1.l10.m1.1.1.1.3.2.2" xref="alg1.l10.m1.1.1.1.3.2.2.cmml">P</mi><mi id="alg1.l10.m1.1.1.1.3.2.3" xref="alg1.l10.m1.1.1.1.3.2.3.cmml">D</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">w</mi><mo fence="false" id="alg1.l10.m1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">←</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑤</ci><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><apply id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3"><apply id="alg1.l10.m1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.3.1.1.cmml" xref="alg1.l10.m1.1.1.1.3.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.3.1.2.cmml" xref="alg1.l10.m1.1.1.1.3.1.2"><times id="alg1.l10.m1.1.1.1.3.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.3.1.2.1"></times><ci id="alg1.l10.m1.1.1.1.3.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.3.1.2.2">arg</ci><ci id="alg1.l10.m1.1.1.1.3.1.2.3.cmml" xref="alg1.l10.m1.1.1.1.3.1.2.3">max</ci></apply><ci id="alg1.l10.m1.1.1.1.3.1.3.cmml" xref="alg1.l10.m1.1.1.1.3.1.3">𝑤</ci></apply><apply id="alg1.l10.m1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.1.3.2.2">𝑃</ci><ci id="alg1.l10.m1.1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.1.3.2.3">𝐷</ci></apply></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">w\leftarrow\operatorname*{arg\,max}_{w}P_{D}(w|v)</annotation></semantics></math> <span id="alg1.l10.1" class="ltx_text" style="float:right;"><math id="alg1.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation></semantics></math> label decoder
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">              <math id="alg1.l11.m1.1" class="ltx_Math" alttext="W\leftarrow W\cdot w" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">W</mi><mo stretchy="false" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">⋅</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">w</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑊</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><ci id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1">⋅</ci><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑊</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">W\leftarrow W\cdot w</annotation></semantics></math> <span id="alg1.l11.3" class="ltx_text" style="float:right;"><math id="alg1.l11.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation></semantics></math> append <math id="alg1.l11.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l11.2.m2.1a"><mi id="alg1.l11.2.m2.1.1" xref="alg1.l11.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.2.m2.1b"><ci id="alg1.l11.2.m2.1.1.cmml" xref="alg1.l11.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.2.m2.1c">w</annotation></semantics></math> to <math id="alg1.l11.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="alg1.l11.3.m3.1a"><mi id="alg1.l11.3.m3.1.1" xref="alg1.l11.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.3.m3.1b"><ci id="alg1.l11.3.m3.1.1.cmml" xref="alg1.l11.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.3.m3.1c">W</annotation></semantics></math>
</span>
</div>
<div id="alg1.l12" class="ltx_listingline">              <math id="alg1.l12.m1.2" class="ltx_Math" alttext="v\leftarrow e[Q[i]]" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml"><mi id="alg1.l12.m1.2.2.3" xref="alg1.l12.m1.2.2.3.cmml">v</mi><mo stretchy="false" id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml">←</mo><mrow id="alg1.l12.m1.2.2.1" xref="alg1.l12.m1.2.2.1.cmml"><mi id="alg1.l12.m1.2.2.1.3" xref="alg1.l12.m1.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l12.m1.2.2.1.1.1" xref="alg1.l12.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="alg1.l12.m1.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l12.m1.2.2.1.1.1.1.3.2" xref="alg1.l12.m1.2.2.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.1.3.2.1" xref="alg1.l12.m1.2.2.1.1.1.1.3.1.1.cmml">[</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.1.3.2.2" xref="alg1.l12.m1.2.2.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2"><ci id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2">←</ci><ci id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.3">𝑣</ci><apply id="alg1.l12.m1.2.2.1.cmml" xref="alg1.l12.m1.2.2.1"><times id="alg1.l12.m1.2.2.1.2.cmml" xref="alg1.l12.m1.2.2.1.2"></times><ci id="alg1.l12.m1.2.2.1.3.cmml" xref="alg1.l12.m1.2.2.1.3">𝑒</ci><apply id="alg1.l12.m1.2.2.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1"><csymbol cd="latexml" id="alg1.l12.m1.2.2.1.1.2.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1"><times id="alg1.l12.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1"></times><ci id="alg1.l12.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.2">𝑄</ci><apply id="alg1.l12.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.3.2"><csymbol cd="latexml" id="alg1.l12.m1.2.2.1.1.1.1.3.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">v\leftarrow e[Q[i]]</annotation></semantics></math> <span id="alg1.l12.3" class="ltx_text" style="float:right;"><math id="alg1.l12.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation></semantics></math> reset <math id="alg1.l12.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg1.l12.2.m2.1a"><mi id="alg1.l12.2.m2.1.1" xref="alg1.l12.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.2.m2.1b"><ci id="alg1.l12.2.m2.1.1.cmml" xref="alg1.l12.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.2.m2.1c">v</annotation></semantics></math> to <math id="alg1.l12.3.m3.1" class="ltx_Math" alttext="Q[i]" display="inline"><semantics id="alg1.l12.3.m3.1a"><mrow id="alg1.l12.3.m3.1.2" xref="alg1.l12.3.m3.1.2.cmml"><mi id="alg1.l12.3.m3.1.2.2" xref="alg1.l12.3.m3.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l12.3.m3.1.2.1" xref="alg1.l12.3.m3.1.2.1.cmml">​</mo><mrow id="alg1.l12.3.m3.1.2.3.2" xref="alg1.l12.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="alg1.l12.3.m3.1.2.3.2.1" xref="alg1.l12.3.m3.1.2.3.1.1.cmml">[</mo><mi id="alg1.l12.3.m3.1.1" xref="alg1.l12.3.m3.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l12.3.m3.1.2.3.2.2" xref="alg1.l12.3.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.3.m3.1b"><apply id="alg1.l12.3.m3.1.2.cmml" xref="alg1.l12.3.m3.1.2"><times id="alg1.l12.3.m3.1.2.1.cmml" xref="alg1.l12.3.m3.1.2.1"></times><ci id="alg1.l12.3.m3.1.2.2.cmml" xref="alg1.l12.3.m3.1.2.2">𝑄</ci><apply id="alg1.l12.3.m3.1.2.3.1.cmml" xref="alg1.l12.3.m3.1.2.3.2"><csymbol cd="latexml" id="alg1.l12.3.m3.1.2.3.1.1.cmml" xref="alg1.l12.3.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l12.3.m3.1.1.cmml" xref="alg1.l12.3.m3.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.3.m3.1c">Q[i]</annotation></semantics></math>'s emb
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">         <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l14" class="ltx_listingline">         <math id="alg1.l14.m1.1" class="ltx_Math" alttext="k\leftarrow j" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">k</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑘</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">k\leftarrow j</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">     <span id="alg1.l15.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">     <math id="alg1.l16.m1.1" class="ltx_Math" alttext="w\leftarrow\operatorname*{arg\,max}_{w}P_{D}(w|v)" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">w</mi><mo stretchy="false" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><msub id="alg1.l16.m1.1.1.1.3.1" xref="alg1.l16.m1.1.1.1.3.1.cmml"><mrow id="alg1.l16.m1.1.1.1.3.1.2" xref="alg1.l16.m1.1.1.1.3.1.2.cmml"><mi id="alg1.l16.m1.1.1.1.3.1.2.2" xref="alg1.l16.m1.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="alg1.l16.m1.1.1.1.3.1.2.1" xref="alg1.l16.m1.1.1.1.3.1.2.1.cmml">​</mo><mi id="alg1.l16.m1.1.1.1.3.1.2.3" xref="alg1.l16.m1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="alg1.l16.m1.1.1.1.3.1.3" xref="alg1.l16.m1.1.1.1.3.1.3.cmml">w</mi></msub><mo id="alg1.l16.m1.1.1.1.3a" xref="alg1.l16.m1.1.1.1.3.cmml">⁡</mo><msub id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml"><mi id="alg1.l16.m1.1.1.1.3.2.2" xref="alg1.l16.m1.1.1.1.3.2.2.cmml">P</mi><mi id="alg1.l16.m1.1.1.1.3.2.3" xref="alg1.l16.m1.1.1.1.3.2.3.cmml">D</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml">w</mi><mo fence="false" id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝑤</ci><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><apply id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.1.1.cmml" xref="alg1.l16.m1.1.1.1.3.1">subscript</csymbol><apply id="alg1.l16.m1.1.1.1.3.1.2.cmml" xref="alg1.l16.m1.1.1.1.3.1.2"><times id="alg1.l16.m1.1.1.1.3.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.3.1.2.1"></times><ci id="alg1.l16.m1.1.1.1.3.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.3.1.2.2">arg</ci><ci id="alg1.l16.m1.1.1.1.3.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.3.1.2.3">max</ci></apply><ci id="alg1.l16.m1.1.1.1.3.1.3.cmml" xref="alg1.l16.m1.1.1.1.3.1.3">𝑤</ci></apply><apply id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.1.3.2.2">𝑃</ci><ci id="alg1.l16.m1.1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.1.3.2.3">𝐷</ci></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">w\leftarrow\operatorname*{arg\,max}_{w}P_{D}(w|v)</annotation></semantics></math> <span id="alg1.l16.1" class="ltx_text" style="float:right;"><math id="alg1.l16.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l16.1.m1.1a"><mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\triangleright</annotation></semantics></math> label decoder
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">     <math id="alg1.l17.m1.1" class="ltx_Math" alttext="W\leftarrow W\cdot w" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">W</mi><mo stretchy="false" id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">←</mo><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">⋅</mo><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">w</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1">←</ci><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑊</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><ci id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1">⋅</ci><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝑊</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">W\leftarrow W\cdot w</annotation></semantics></math> <span id="alg1.l17.3" class="ltx_text" style="float:right;"><math id="alg1.l17.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l17.1.m1.1a"><mo id="alg1.l17.1.m1.1.1" xref="alg1.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l17.1.m1.1b"><ci id="alg1.l17.1.m1.1.1.cmml" xref="alg1.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.1.m1.1c">\triangleright</annotation></semantics></math> append <math id="alg1.l17.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l17.2.m2.1a"><mi id="alg1.l17.2.m2.1.1" xref="alg1.l17.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.2.m2.1b"><ci id="alg1.l17.2.m2.1.1.cmml" xref="alg1.l17.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.2.m2.1c">w</annotation></semantics></math> to <math id="alg1.l17.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="alg1.l17.3.m3.1a"><mi id="alg1.l17.3.m3.1.1" xref="alg1.l17.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.3.m3.1b"><ci id="alg1.l17.3.m3.1.1.cmml" xref="alg1.l17.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.3.m3.1c">W</annotation></semantics></math>
</span>
</div>
<div id="alg1.l18" class="ltx_listingline">     <span id="alg1.l18.1" class="ltx_text ltx_font_bold">return</span> W

</div>
<div id="alg1.l19" class="ltx_listingline">
<span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Comparing UTF-8 and VQ based representation</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">While UTF-8 and our proposed VQ based representations are both byte-level representations, they have a few key differences. First, UTF-8 is a variable length prefix code,
but our proposed VQ representation is a fixed length code. Second, VQ representation can be optimized for a specific machine learning task while UTF-8 is fixed and
not optimized for machine learning. Third, UTF-8 recovers invalid sequences with the sequences with most characters, while VQ's label decoder would try to
find the most likely output given any input sequence. Finally, as a learned representation, it is possible to have collision, i.e. different characters can
be mapped to the same byte sequences, which would not be the case for UTF-8.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate our approach through our proprietary English and Mandarin dictation tasks. We build bilingual English and Mandarin ASR models
using a mixture of monolingual English and Mandarin supervised data, which is randomly sampled and anonymized.
The English training set consists of 10k hours of data while the Mandarin training set has 14k hours of data.
Our training sets cover domains like dictation and assistant use cases. For test sets, we use the dictation test sets for English and Mandarin, which
are randomly sampled and anonymized. The English test set consists of 27 hours of data and the Mandarin test set has 13 hours of data. Both train and test sets
cover platforms like smart phones, tablets and laptops. When we report accuracy numbers on these test sets, we report word error rate (WER) for English
and character error rate (CER) for Mandarin. We use the term token error rate (TER) when we discuss the error rates of both languages.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">The model we built is a CTC-AED model similar to the one described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The model consists of an acoustic encoder
and a cross attention decoder (AED). The input to the CTC-AED model is 80 dimensional
mel filterbank features with 25ms window and 10ms shift. A depthwise separable convolutional layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> would downsample the features by 6x.
The acoustic encoder consists of 12 conformer blocks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> with eight attention heads and the hidden dimension is 512.
The attention decoder consists of six layers of bi-directional transformer blocks.
Each transformer block has eight attention heads and the hidden dimension is also 512.
The entire model has around 120M parameters. The decoding process consists of two passes.
In the first pass, we perform CTC prefix beam search with the acoustic encoder to generate N-best hypotheses. Then,
these hypotheses are rescored by the attention decoder for the final output.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">We compare three types of output representations for this bilingual setup,</p>
<ol id="S4.I1" class="ltx_enumerate">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">Character based output</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">UTF-8 subword output with BPE</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">Our proposed VQ based subword output with BPE</p>
</div>
</li>
</ol>
<p id="S4.p3.2" class="ltx_p">Both UTF-8 and VQ representation use BPE to create subword outputs. The character based representation has all English and simplified Chinese characters,
and the size is around 8000.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">For VQ based representation, the auto-encoder consists of three components: acoustic encoder, label encoder and label decoder.
The acoustic encoder has the same model architecture as the acoustic encoder of the CTC-AED model.
It has an output layer that predicts the embeddings used in the VQ module. This output layer is used for the CTC loss in Equation <a href="#S3.E3" title="In 3.2 Formulation as auto-encoding optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
The label encoder consists of six uni-directional transformer blocks, and the label decoder is a linear transform that converts the input embedding to the output tokens.
The label encoder and decoder are connected by the VQ module. After we train the auto-encoder,
we use the label encoder to convert all the transcripts in our training data into byte sequences. Then, we run BPE with SentencePiece to create byte-level subwords
similar to the UTF-8 approach. These byte-level subwords will be used as the output of the CTC-AED model.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4 Experimental results ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the results of the three bilingual CTC-AED models built with these output representations. Across different number of subwords
in the ASR output, VQ based representation has improvement over UTF-8 based representation. With 8000 subwords, proposed VQ based approach has 5.8% relative reduction
in WER for English and 3.7% relative reduction in CER for Mandarin. This suggests it is possible to optimize a byte-level representation
for a target task. Compared to character based representation, both VQ and UTF-8 are better on English but similar accuracy on Chinese.
With 8000 subwords, which has the same size as the character based output, VQ has 14.8% and 2.3% relative reduction in error rate for English and Mandarin respectively.
Character based output is expected to have worse English accuracy since it does not have common English subwords in the output.
In comparison, VQ and UTF-8 can have an output dimension smaller than the size of the character set. They provide more flexibility to system design.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span> TER(%) of CTC-AED model using character based, UTF-8 and our proposed VQ based representation. The VQ based representation has three codebooks and each codebook has 256 embeddings (<math id="S4.T1.3.m1.1" class="ltx_Math" alttext="N=3" display="inline"><semantics id="S4.T1.3.m1.1b"><mrow id="S4.T1.3.m1.1.1" xref="S4.T1.3.m1.1.1.cmml"><mi id="S4.T1.3.m1.1.1.2" xref="S4.T1.3.m1.1.1.2.cmml">N</mi><mo id="S4.T1.3.m1.1.1.1" xref="S4.T1.3.m1.1.1.1.cmml">=</mo><mn id="S4.T1.3.m1.1.1.3" xref="S4.T1.3.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.m1.1c"><apply id="S4.T1.3.m1.1.1.cmml" xref="S4.T1.3.m1.1.1"><eq id="S4.T1.3.m1.1.1.1.cmml" xref="S4.T1.3.m1.1.1.1"></eq><ci id="S4.T1.3.m1.1.1.2.cmml" xref="S4.T1.3.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.T1.3.m1.1.1.3.cmml" xref="S4.T1.3.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.m1.1d">N=3</annotation></semantics></math>, <math id="S4.T1.4.m2.1" class="ltx_Math" alttext="M=256" display="inline"><semantics id="S4.T1.4.m2.1b"><mrow id="S4.T1.4.m2.1.1" xref="S4.T1.4.m2.1.1.cmml"><mi id="S4.T1.4.m2.1.1.2" xref="S4.T1.4.m2.1.1.2.cmml">M</mi><mo id="S4.T1.4.m2.1.1.1" xref="S4.T1.4.m2.1.1.1.cmml">=</mo><mn id="S4.T1.4.m2.1.1.3" xref="S4.T1.4.m2.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.m2.1c"><apply id="S4.T1.4.m2.1.1.cmml" xref="S4.T1.4.m2.1.1"><eq id="S4.T1.4.m2.1.1.1.cmml" xref="S4.T1.4.m2.1.1.1"></eq><ci id="S4.T1.4.m2.1.1.2.cmml" xref="S4.T1.4.m2.1.1.2">𝑀</ci><cn type="integer" id="S4.T1.4.m2.1.1.3.cmml" xref="S4.T1.4.m2.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m2.1d">M=256</annotation></semantics></math>). Both UTF-8 and VQ use BPE to create subword output, and each column uses different number of subwords in the ASR output.</figcaption>
<table id="S4.T1.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.5.1.1" class="ltx_tr">
<th id="S4.T1.5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">rep.</th>
<th id="S4.T1.5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">lang</th>
<th id="S4.T1.5.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">2000</th>
<th id="S4.T1.5.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">4000</th>
<th id="S4.T1.5.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">8000</th>
<th id="S4.T1.5.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">16000</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.5.2.1" class="ltx_tr">
<td id="S4.T1.5.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">Char</td>
<td id="S4.T1.5.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">EN</td>
<td id="S4.T1.5.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">-</td>
<td id="S4.T1.5.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">-</td>
<td id="S4.T1.5.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">9.61</td>
<td id="S4.T1.5.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">-</td>
</tr>
<tr id="S4.T1.5.3.2" class="ltx_tr">
<td id="S4.T1.5.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">UTF-8</td>
<td id="S4.T1.5.3.2.2" class="ltx_td ltx_align_center ltx_border_r">EN</td>
<td id="S4.T1.5.3.2.3" class="ltx_td ltx_align_center ltx_border_r">9.25</td>
<td id="S4.T1.5.3.2.4" class="ltx_td ltx_align_center ltx_border_r">8.84</td>
<td id="S4.T1.5.3.2.5" class="ltx_td ltx_align_center ltx_border_r">8.70</td>
<td id="S4.T1.5.3.2.6" class="ltx_td ltx_align_center ltx_border_r">8.41</td>
</tr>
<tr id="S4.T1.5.4.3" class="ltx_tr">
<td id="S4.T1.5.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">VQ</td>
<td id="S4.T1.5.4.3.2" class="ltx_td ltx_align_center ltx_border_r">EN</td>
<td id="S4.T1.5.4.3.3" class="ltx_td ltx_align_center ltx_border_r">8.77</td>
<td id="S4.T1.5.4.3.4" class="ltx_td ltx_align_center ltx_border_r">8.29</td>
<td id="S4.T1.5.4.3.5" class="ltx_td ltx_align_center ltx_border_r">8.19</td>
<td id="S4.T1.5.4.3.6" class="ltx_td ltx_align_center ltx_border_r">8.14</td>
</tr>
<tr id="S4.T1.5.5.4" class="ltx_tr">
<td id="S4.T1.5.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Char</td>
<td id="S4.T1.5.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ZH</td>
<td id="S4.T1.5.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T1.5.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T1.5.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.77</td>
<td id="S4.T1.5.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
</tr>
<tr id="S4.T1.5.6.5" class="ltx_tr">
<td id="S4.T1.5.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">UTF-8</td>
<td id="S4.T1.5.6.5.2" class="ltx_td ltx_align_center ltx_border_r">ZH</td>
<td id="S4.T1.5.6.5.3" class="ltx_td ltx_align_center ltx_border_r">10.53</td>
<td id="S4.T1.5.6.5.4" class="ltx_td ltx_align_center ltx_border_r">10.27</td>
<td id="S4.T1.5.6.5.5" class="ltx_td ltx_align_center ltx_border_r">9.92</td>
<td id="S4.T1.5.6.5.6" class="ltx_td ltx_align_center ltx_border_r">9.43</td>
</tr>
<tr id="S4.T1.5.7.6" class="ltx_tr">
<td id="S4.T1.5.7.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r">VQ</td>
<td id="S4.T1.5.7.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">ZH</td>
<td id="S4.T1.5.7.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10.48</td>
<td id="S4.T1.5.7.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10.06</td>
<td id="S4.T1.5.7.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.55</td>
<td id="S4.T1.5.7.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.14</td>
</tr>
</tbody>
</table>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Ablation study</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We would like to look at how factors, like the number of codebooks in VQ, and the four losses used in training the auto-encoder would affect the ASR accuracy.
Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Ablation study ‣ 4 Experimental results ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results of comparing different number of codebooks. We are interested in the case of two codebooks since effectively,
each label token would be represented by two bytes and theoretically, it should be enough to cover 8000 English and Chinese characters. However, as shown by the
results, two codebooks are not enough and give suboptimal accuracy. It is due to the low utilization rate of the codebooks,
where many embeddings in the codebooks are inactive. This problem, known as index collapse <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, is thoroughly studied in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
and we will explore those techniques in our future work.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span> TER(%) of CTC-AED model using our proposed VQ based representation with different VQ configurations. </figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.5.1" class="ltx_tr">
<th id="S4.T2.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">VQ config</th>
<th id="S4.T2.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">lang</th>
<th id="S4.T2.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">2000</th>
<th id="S4.T2.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">4000</th>
<th id="S4.T2.4.5.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">8000</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt"><math id="S4.T2.1.1.1.m1.2" class="ltx_Math" alttext="N=2,M=256" display="inline"><semantics id="S4.T2.1.1.1.m1.2a"><mrow id="S4.T2.1.1.1.m1.2.2.2" xref="S4.T2.1.1.1.m1.2.2.3.cmml"><mrow id="S4.T2.1.1.1.m1.1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.1.cmml"><mi id="S4.T2.1.1.1.m1.1.1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.1.1.2.cmml">N</mi><mo id="S4.T2.1.1.1.m1.1.1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.T2.1.1.1.m1.1.1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S4.T2.1.1.1.m1.2.2.2.3" xref="S4.T2.1.1.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.T2.1.1.1.m1.2.2.2.2" xref="S4.T2.1.1.1.m1.2.2.2.2.cmml"><mi id="S4.T2.1.1.1.m1.2.2.2.2.2" xref="S4.T2.1.1.1.m1.2.2.2.2.2.cmml">M</mi><mo id="S4.T2.1.1.1.m1.2.2.2.2.1" xref="S4.T2.1.1.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.T2.1.1.1.m1.2.2.2.2.3" xref="S4.T2.1.1.1.m1.2.2.2.2.3.cmml">256</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.2b"><apply id="S4.T2.1.1.1.m1.2.2.3.cmml" xref="S4.T2.1.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.2.2.3a.cmml" xref="S4.T2.1.1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.T2.1.1.1.m1.1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1"><eq id="S4.T2.1.1.1.m1.1.1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1"></eq><ci id="S4.T2.1.1.1.m1.1.1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S4.T2.1.1.1.m1.1.1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.3">2</cn></apply><apply id="S4.T2.1.1.1.m1.2.2.2.2.cmml" xref="S4.T2.1.1.1.m1.2.2.2.2"><eq id="S4.T2.1.1.1.m1.2.2.2.2.1.cmml" xref="S4.T2.1.1.1.m1.2.2.2.2.1"></eq><ci id="S4.T2.1.1.1.m1.2.2.2.2.2.cmml" xref="S4.T2.1.1.1.m1.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.T2.1.1.1.m1.2.2.2.2.3.cmml" xref="S4.T2.1.1.1.m1.2.2.2.2.3">256</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.2c">N=2,M=256</annotation></semantics></math></th>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">EN</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.51</td>
<td id="S4.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.30</td>
<td id="S4.T2.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.40</td>
</tr>
<tr id="S4.T2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r"><math id="S4.T2.2.2.1.m1.2" class="ltx_Math" alttext="N=3,M=256" display="inline"><semantics id="S4.T2.2.2.1.m1.2a"><mrow id="S4.T2.2.2.1.m1.2.2.2" xref="S4.T2.2.2.1.m1.2.2.3.cmml"><mrow id="S4.T2.2.2.1.m1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.1.1.2.cmml">N</mi><mo id="S4.T2.2.2.1.m1.1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.T2.2.2.1.m1.1.1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.T2.2.2.1.m1.2.2.2.3" xref="S4.T2.2.2.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.T2.2.2.1.m1.2.2.2.2" xref="S4.T2.2.2.1.m1.2.2.2.2.cmml"><mi id="S4.T2.2.2.1.m1.2.2.2.2.2" xref="S4.T2.2.2.1.m1.2.2.2.2.2.cmml">M</mi><mo id="S4.T2.2.2.1.m1.2.2.2.2.1" xref="S4.T2.2.2.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.T2.2.2.1.m1.2.2.2.2.3" xref="S4.T2.2.2.1.m1.2.2.2.2.3.cmml">256</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.2b"><apply id="S4.T2.2.2.1.m1.2.2.3.cmml" xref="S4.T2.2.2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.2.2.3a.cmml" xref="S4.T2.2.2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.T2.2.2.1.m1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1"><eq id="S4.T2.2.2.1.m1.1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1"></eq><ci id="S4.T2.2.2.1.m1.1.1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S4.T2.2.2.1.m1.1.1.1.1.3.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.3">3</cn></apply><apply id="S4.T2.2.2.1.m1.2.2.2.2.cmml" xref="S4.T2.2.2.1.m1.2.2.2.2"><eq id="S4.T2.2.2.1.m1.2.2.2.2.1.cmml" xref="S4.T2.2.2.1.m1.2.2.2.2.1"></eq><ci id="S4.T2.2.2.1.m1.2.2.2.2.2.cmml" xref="S4.T2.2.2.1.m1.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.T2.2.2.1.m1.2.2.2.2.3.cmml" xref="S4.T2.2.2.1.m1.2.2.2.2.3">256</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.2c">N=3,M=256</annotation></semantics></math></th>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_r">EN</td>
<td id="S4.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_r">8.77</td>
<td id="S4.T2.2.2.4" class="ltx_td ltx_align_center ltx_border_r">8.29</td>
<td id="S4.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_r">8.19</td>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<th id="S4.T2.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.3.3.1.m1.2" class="ltx_Math" alttext="N=2,M=256" display="inline"><semantics id="S4.T2.3.3.1.m1.2a"><mrow id="S4.T2.3.3.1.m1.2.2.2" xref="S4.T2.3.3.1.m1.2.2.3.cmml"><mrow id="S4.T2.3.3.1.m1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.1.1.2.cmml">N</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.T2.3.3.1.m1.1.1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S4.T2.3.3.1.m1.2.2.2.3" xref="S4.T2.3.3.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.T2.3.3.1.m1.2.2.2.2" xref="S4.T2.3.3.1.m1.2.2.2.2.cmml"><mi id="S4.T2.3.3.1.m1.2.2.2.2.2" xref="S4.T2.3.3.1.m1.2.2.2.2.2.cmml">M</mi><mo id="S4.T2.3.3.1.m1.2.2.2.2.1" xref="S4.T2.3.3.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.T2.3.3.1.m1.2.2.2.2.3" xref="S4.T2.3.3.1.m1.2.2.2.2.3.cmml">256</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.2b"><apply id="S4.T2.3.3.1.m1.2.2.3.cmml" xref="S4.T2.3.3.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.2.2.3a.cmml" xref="S4.T2.3.3.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.T2.3.3.1.m1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1"><eq id="S4.T2.3.3.1.m1.1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1"></eq><ci id="S4.T2.3.3.1.m1.1.1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S4.T2.3.3.1.m1.1.1.1.1.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.3">2</cn></apply><apply id="S4.T2.3.3.1.m1.2.2.2.2.cmml" xref="S4.T2.3.3.1.m1.2.2.2.2"><eq id="S4.T2.3.3.1.m1.2.2.2.2.1.cmml" xref="S4.T2.3.3.1.m1.2.2.2.2.1"></eq><ci id="S4.T2.3.3.1.m1.2.2.2.2.2.cmml" xref="S4.T2.3.3.1.m1.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.T2.3.3.1.m1.2.2.2.2.3.cmml" xref="S4.T2.3.3.1.m1.2.2.2.2.3">256</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.2c">N=2,M=256</annotation></semantics></math></th>
<td id="S4.T2.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ZH</td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.32</td>
<td id="S4.T2.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.96</td>
<td id="S4.T2.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.70</td>
</tr>
<tr id="S4.T2.4.4" class="ltx_tr">
<th id="S4.T2.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r"><math id="S4.T2.4.4.1.m1.2" class="ltx_Math" alttext="N=3,M=256" display="inline"><semantics id="S4.T2.4.4.1.m1.2a"><mrow id="S4.T2.4.4.1.m1.2.2.2" xref="S4.T2.4.4.1.m1.2.2.3.cmml"><mrow id="S4.T2.4.4.1.m1.1.1.1.1" xref="S4.T2.4.4.1.m1.1.1.1.1.cmml"><mi id="S4.T2.4.4.1.m1.1.1.1.1.2" xref="S4.T2.4.4.1.m1.1.1.1.1.2.cmml">N</mi><mo id="S4.T2.4.4.1.m1.1.1.1.1.1" xref="S4.T2.4.4.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.T2.4.4.1.m1.1.1.1.1.3" xref="S4.T2.4.4.1.m1.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.T2.4.4.1.m1.2.2.2.3" xref="S4.T2.4.4.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.T2.4.4.1.m1.2.2.2.2" xref="S4.T2.4.4.1.m1.2.2.2.2.cmml"><mi id="S4.T2.4.4.1.m1.2.2.2.2.2" xref="S4.T2.4.4.1.m1.2.2.2.2.2.cmml">M</mi><mo id="S4.T2.4.4.1.m1.2.2.2.2.1" xref="S4.T2.4.4.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.T2.4.4.1.m1.2.2.2.2.3" xref="S4.T2.4.4.1.m1.2.2.2.2.3.cmml">256</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.2b"><apply id="S4.T2.4.4.1.m1.2.2.3.cmml" xref="S4.T2.4.4.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.T2.4.4.1.m1.2.2.3a.cmml" xref="S4.T2.4.4.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.T2.4.4.1.m1.1.1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1.1.1"><eq id="S4.T2.4.4.1.m1.1.1.1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1.1.1.1"></eq><ci id="S4.T2.4.4.1.m1.1.1.1.1.2.cmml" xref="S4.T2.4.4.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S4.T2.4.4.1.m1.1.1.1.1.3.cmml" xref="S4.T2.4.4.1.m1.1.1.1.1.3">3</cn></apply><apply id="S4.T2.4.4.1.m1.2.2.2.2.cmml" xref="S4.T2.4.4.1.m1.2.2.2.2"><eq id="S4.T2.4.4.1.m1.2.2.2.2.1.cmml" xref="S4.T2.4.4.1.m1.2.2.2.2.1"></eq><ci id="S4.T2.4.4.1.m1.2.2.2.2.2.cmml" xref="S4.T2.4.4.1.m1.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.T2.4.4.1.m1.2.2.2.2.3.cmml" xref="S4.T2.4.4.1.m1.2.2.2.2.3">256</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.2c">N=3,M=256</annotation></semantics></math></th>
<td id="S4.T2.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">ZH</td>
<td id="S4.T2.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10.48</td>
<td id="S4.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10.06</td>
<td id="S4.T2.4.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.55</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Ablation study ‣ 4 Experimental results ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results of applying different weights to the cross entropy loss
with respect to the acoustic encoder (the second term of Equation <a href="#S3.E3" title="In 3.2 Formulation as auto-encoding optimization problem ‣ 3 Optimizing byte-level representation ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). When the weight is zero, it means the acoustic encoder
would not contribute to representation learning. In this case, the auto-encoder would ignore acoustic information and the acoustic encoder would fit to the
latent variables decided by the label encoder. The results in Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Ablation study ‣ 4 Experimental results ‣ Optimizing Byte-level Representation for End-to-end ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> show that acoustic information helps.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span> TER(%) of CTC-AED model when the underlying VQ representations are trained with different weights to the cross entropy loss with respect to the acoustic encoder. For this experiment, the VQ module has three codebooks and each codebook has 256 embeddings (<math id="S4.T3.2.m1.2" class="ltx_Math" alttext="N=3,M=256" display="inline"><semantics id="S4.T3.2.m1.2b"><mrow id="S4.T3.2.m1.2.2.2" xref="S4.T3.2.m1.2.2.3.cmml"><mrow id="S4.T3.2.m1.1.1.1.1" xref="S4.T3.2.m1.1.1.1.1.cmml"><mi id="S4.T3.2.m1.1.1.1.1.2" xref="S4.T3.2.m1.1.1.1.1.2.cmml">N</mi><mo id="S4.T3.2.m1.1.1.1.1.1" xref="S4.T3.2.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.T3.2.m1.1.1.1.1.3" xref="S4.T3.2.m1.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.T3.2.m1.2.2.2.3" xref="S4.T3.2.m1.2.2.3a.cmml">,</mo><mrow id="S4.T3.2.m1.2.2.2.2" xref="S4.T3.2.m1.2.2.2.2.cmml"><mi id="S4.T3.2.m1.2.2.2.2.2" xref="S4.T3.2.m1.2.2.2.2.2.cmml">M</mi><mo id="S4.T3.2.m1.2.2.2.2.1" xref="S4.T3.2.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.T3.2.m1.2.2.2.2.3" xref="S4.T3.2.m1.2.2.2.2.3.cmml">256</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.2c"><apply id="S4.T3.2.m1.2.2.3.cmml" xref="S4.T3.2.m1.2.2.2"><csymbol cd="ambiguous" id="S4.T3.2.m1.2.2.3a.cmml" xref="S4.T3.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.T3.2.m1.1.1.1.1.cmml" xref="S4.T3.2.m1.1.1.1.1"><eq id="S4.T3.2.m1.1.1.1.1.1.cmml" xref="S4.T3.2.m1.1.1.1.1.1"></eq><ci id="S4.T3.2.m1.1.1.1.1.2.cmml" xref="S4.T3.2.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S4.T3.2.m1.1.1.1.1.3.cmml" xref="S4.T3.2.m1.1.1.1.1.3">3</cn></apply><apply id="S4.T3.2.m1.2.2.2.2.cmml" xref="S4.T3.2.m1.2.2.2.2"><eq id="S4.T3.2.m1.2.2.2.2.1.cmml" xref="S4.T3.2.m1.2.2.2.2.1"></eq><ci id="S4.T3.2.m1.2.2.2.2.2.cmml" xref="S4.T3.2.m1.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.T3.2.m1.2.2.2.2.3.cmml" xref="S4.T3.2.m1.2.2.2.2.3">256</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.2d">N=3,M=256</annotation></semantics></math>). BPE is performed to generate 8000 byte-level subwords</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">lang</th>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">0.0</th>
<th id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">0.5</th>
<th id="S4.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">1.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.2.1" class="ltx_tr">
<td id="S4.T3.3.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">EN</td>
<td id="S4.T3.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.61</td>
<td id="S4.T3.3.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.49</td>
<td id="S4.T3.3.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8.19</td>
</tr>
<tr id="S4.T3.3.3.2" class="ltx_tr">
<td id="S4.T3.3.3.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r">ZH</td>
<td id="S4.T3.3.3.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.71</td>
<td id="S4.T3.3.3.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.89</td>
<td id="S4.T3.3.3.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.55</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions and future work</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose an algorithm to optimize a byte-level representation for ASR and compare it with UTF-8 representation.
Our proposed representation can be optimized with both audio and text data, and the error correction mechanism is optimized for accuracy.
On our English/Mandarin dictation test sets, our auto-encoder and VQ based approach can achieve 5% relative reduction in TER.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">While our proposed approach has accuracy advantages, UTF-8 has some desirable properties, such as, being a prefix code, not having a collision issue.
In addition, the variable length design is more flexible, though ideally, the length would be correlated with token frequency.
In the future, we will explore VQ methods that allow variable length. If code length can be optimized jointly, we would be able to bypass
BPE and use that to generate target subwords directly. While as a machine learning approach,
it cannot guarantee no collision in the learned representation, we will look into whether we can derive a prefix code from the auto-encoder.
This would also make encoding and decoding more efficient. Last, but not least, we will also look into using other side information, such as a phonemic lexicon, to improve the representation.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgment</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">The authors would like to thank Pawel Swietojanski, Ossama Abdelhamid, Takaaki Hori, and Barry Theobald for their support and useful discussions.</p>
</div>
<div id="S6.p2" class="ltx_para">
<span id="S6.p2.1" class="ltx_ERROR undefined">\eightpt</span>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. Li, Y. Zhang, T. Sainath, Y. Wu, and W. Chan, ``Bytes are all you need:
End-to-end multilingual speech recognition and synthesis with bytes,'' in
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Acoustics, Speech,
and Signal Processing</em>, 2019, pp. 5621–5625.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
L. Deng, R. Hsiao, and A. Ghoshal, ``Bilingual end-to-end ASR with byte-level
subwords,'' in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on
Acoustics, Speech, and Signal Processing</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
J. D. Allen, D. Anderson, J. Becker, R. Cook, M. Davis, P. Edberg, A. Freytag,
R. Ishida, J. H. Jenkins, R. McGowan, L. Moore, E. Muller, A. Phillips,
M. Suignard, and K. Whistler, ``The unicode standard version 6.0 – core
specification,'' The Unicode Consortium, Tech. Rep., 2011.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, T. Xu, G. Brockman, C. Mcleavey, and I. Sutskever,
``Robust speech recognition via large-scale weak supervision,'' in
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 40th International Conference on Machine Learning</em>,
ser. Proceedings of Machine Learning Research, A. Krause, E. Brunskill,
K. Cho, B. Engelhardt, S. Sabato, and J. Scarlett, Eds., vol. 202.   PMLR, 23–29 Jul 2023, pp. 28 492–28 518.
[Online]. Available: <a target="_blank" href="https://proceedings.mlr.press/v202/radford23a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v202/radford23a.html</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. Gillick, C. Brunk, O. Vinyals, and A. Subramanya, ``Multilingual language
processing from bytes,'' in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference of the North
American Chapter of the Association for Computational Linguistics - Human
Language Technologies</em>, 2016, pp. 1296–1306.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Ruiz Costa-Jussà, C. Escolano Peinado, and J. A.
Rodríguez Fonollosa, ``Byte-based neural machine translation,'' in
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the First Workshop on Subword and Character Level Models
in NLP</em>, 2017, pp. 154–158.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Xue, A. Barua, N. Constant, R. Al-Rfou, S. Narang, M. Kale, A. Roberts, and
C. Raffel, ``Byt5: Towards a token-free future with pre-trained byte-to-byte
models,'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2105.13626</em>, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
C. Wang, K. Cho, and J. Gu, ``Neural machine translation with byte-level
subwords,'' in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, 2020, pp. 9154–9160.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
R. Sennrich, B. Haddow, and A. Birch, ``Neural machine translation of rare
words with subword units,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Annual Meeting of the
Association for Computational Linguistics</em>, 2016, pp. 1715–1725.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Graves, S. Fernández, F. Gomez, and J. Schmidhuber, ``Connectionist
temporal classification: labelling unsegmented sequence data with recurrent
neural networks,'' in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on
Machine Learning</em>, 2006, pp. 369–376.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
A. van den Oord, O. Vinyals, and K. Kavukcuoglu, ``Neural discrete
representation learning,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
D. Lee, C. Kim, S. Kim, M. Cho, and W.-S. Han, ``Autoregressive image
generation using residual quantization,'' in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, June
2022, pp. 11 523–11 532.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Z. Yao, D. Wu, X. Wang, B. Zhang, F. Yu, C. Yang, Z. Peng, X. Chen, L. Xie, and
X. Lei, ``Wenet: Production oriented streaming and non-streaming end-to-end
speech recognition toolkit,'' in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>.   Brno, Czech Republic: IEEE, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
F. Chollet, ``Xception: Deep learning with depthwise separable convolutions,''
in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition</em>, 2017,
pp. 1800–1807.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Gulati, J. Qin, C.-C. Chiu, N. Parmar, Y. Zhang, J. Yu, W. Han, S. Wang,
Z. Zhang, Y. Wu, and R. Pang, ``Conformer: Convolution-augmented Transformer
for Speech Recognition,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp.
5036–5040.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
L. Kaiser, S. Bengio, A. Roy, A. Vaswani, N. Parmar, J. Uszkoreit, and
N. Shazeer, ``Fast decoding in sequence models using discrete latent
variables,'' in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Machine
Learning</em>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Huh, B. Cheung, P. Agrawal, and P. Isola, ``Straightening out the
straight-through estimator: Overcoming optimization challenges in vector
quantized networks,'' in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 40th International
Conference on Machine Learning</em>, 2023.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.09675" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.09676" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.09676">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.09676" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.09677" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 17:45:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
