<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.18811] Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment</title><meta property="og:description" content="We introduce a novel task within the field of 3D dance generation, termed dance accompaniment, which necessitates the generation of responsive movements from a dance partner, the "follower", synchronized with the lead …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.18811">

<!--Generated on Fri Apr  5 17:08:29 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id16.id1" class="ltx_text ltx_font_italic">Duolando</span>: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Li Siyao<sup id="id17.16.id1" class="ltx_sup"><span id="id17.16.id1.1" class="ltx_text ltx_font_italic">1</span></sup>   Tianpei Gu<sup id="id18.17.id2" class="ltx_sup"><span id="id18.17.id2.1" class="ltx_text ltx_font_italic">2∗</span></sup>   Zhengyu Lin<sup id="id19.18.id3" class="ltx_sup"><span id="id19.18.id3.1" class="ltx_text ltx_font_italic">3</span></sup>   Zhitao Yang<sup id="id20.19.id4" class="ltx_sup"><span id="id20.19.id4.1" class="ltx_text ltx_font_italic">3</span></sup>   Ziwei Liu<sup id="id21.20.id5" class="ltx_sup"><span id="id21.20.id5.1" class="ltx_text ltx_font_italic">1</span></sup> 
<br class="ltx_break"><span id="id6.6.1" class="ltx_text ltx_font_bold">Henghui Ding<sup id="id6.6.1.1" class="ltx_sup"><span id="id6.6.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">1</span></sup></span>  <span id="id7.7.2" class="ltx_text ltx_font_bold">Lei Yang<math id="id7.7.2.m1.2" class="ltx_Math" alttext="{}^{3,4\,}" display="inline"><semantics id="id7.7.2.m1.2a"><msup id="id7.7.2.m1.2.2" xref="id7.7.2.m1.2.2.cmml"><mi id="id7.7.2.m1.2.2a" xref="id7.7.2.m1.2.2.cmml"></mi><mrow id="id7.7.2.m1.2.2.2.4" xref="id7.7.2.m1.2.2.2.3.cmml"><mn id="id7.7.2.m1.1.1.1.1" xref="id7.7.2.m1.1.1.1.1.cmml">3</mn><mo id="id7.7.2.m1.2.2.2.4.1" xref="id7.7.2.m1.2.2.2.3.cmml">,</mo><mn id="id7.7.2.m1.2.2.2.2" xref="id7.7.2.m1.2.2.2.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id7.7.2.m1.2b"><apply id="id7.7.2.m1.2.2.cmml" xref="id7.7.2.m1.2.2"><list id="id7.7.2.m1.2.2.2.3.cmml" xref="id7.7.2.m1.2.2.2.4"><cn type="integer" id="id7.7.2.m1.1.1.1.1.cmml" xref="id7.7.2.m1.1.1.1.1">3</cn><cn type="integer" id="id7.7.2.m1.2.2.2.2.cmml" xref="id7.7.2.m1.2.2.2.2">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.2.m1.2c">{}^{3,4\,}</annotation></semantics></math><sup id="id7.7.2.1" class="ltx_sup"><span id="id7.7.2.1.1" class="ltx_text ltx_font_medium">🖂</span></sup></span>   <span id="id8.8.3" class="ltx_text ltx_font_bold">Chen Change Loy<math id="id8.8.3.m1.1" class="ltx_Math" alttext="{}^{1\,}" display="inline"><semantics id="id8.8.3.m1.1a"><msup id="id8.8.3.m1.1.1" xref="id8.8.3.m1.1.1.cmml"><mi id="id8.8.3.m1.1.1a" xref="id8.8.3.m1.1.1.cmml"></mi><mn id="id8.8.3.m1.1.1.1" xref="id8.8.3.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.3.m1.1b"><apply id="id8.8.3.m1.1.1.cmml" xref="id8.8.3.m1.1.1"><cn type="integer" id="id8.8.3.m1.1.1.1.cmml" xref="id8.8.3.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.3.m1.1c">{}^{1\,}</annotation></semantics></math><sup id="id8.8.3.1" class="ltx_sup"><span id="id8.8.3.1.1" class="ltx_text ltx_font_medium">🖂</span></sup></span> 
<br class="ltx_break"><sup id="id22.21.id6" class="ltx_sup">1</sup>S-Lab, Nanyang Technological University     <sup id="id23.22.id7" class="ltx_sup">2</sup>Lexica    
<sup id="id24.23.id8" class="ltx_sup">3</sup>SenseTime    <sup id="id25.24.id9" class="ltx_sup">4</sup>Shanghai AI Laboratory
<br class="ltx_break"><a target="_blank" href="https://lisiyao21.github.io/projects/Duolando" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://lisiyao21.github.io/projects/Duolando</a>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id26.id1" class="ltx_p">We introduce a novel task within the field of 3D dance generation, termed <span id="id26.id1.1" class="ltx_text ltx_font_italic">dance accompaniment</span>, which necessitates the generation of responsive movements from a dance partner, the "follower", synchronized with the lead dancer’s movements and the underlying musical rhythm.
Unlike existing solo or group dance generation tasks, a duet dance scenario entails a heightened degree of interaction between the two participants, requiring delicate coordination in both pose and position.
To support this task, we first build a large-scale and diverse duet interactive dance dataset, <span id="id26.id1.2" class="ltx_text ltx_font_typewriter ltx_font_italic">DD100</span>, by recording about 117 minutes
of professional dancers’ performances.
To address the challenges inherent in this task, we propose a GPT-based model, <span id="id26.id1.3" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span>, which autoregressively predicts the subsequent tokenized motion conditioned on the coordinated information of the music, the leader’s and the follower’s movements.
To further enhance the GPT’s capabilities of generating stable results on unseen conditions (music and leader motions), we devise an off-policy reinforcement learning strategy that allows the model to explore viable trajectories from <span id="id26.id1.4" class="ltx_text ltx_font_italic">out-of-distribution</span> samplings, guided by human-defined rewards.
Based on the collected dataset and proposed method, we establish a benchmark with several carefully designed metrics.</p>
</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2403.18811/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S0.F1.2.1" class="ltx_text ltx_font_bold">Example of <span id="S0.F1.2.1.1" class="ltx_text ltx_font_italic">Duolando</span>’s results.</span> The female avatar (red arrow) is driven by the proposed method to accompany real human’s (white) dancing. </figcaption>
</figure><span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span><sup id="footnotex1.1" class="ltx_sup">🖂</sup> Corresponding authors. * Work mostly completed at UCLA.</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Duet dancing is an interactive art involving coordination between two individuals’ body movements under background music.
In the context of ballroom dancing, the duet dancers typically comprise a <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">leader</em> and a <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">follower</em>:
the leader is responsible for initiating and guiding the movements, while the follower responds to the leader’s cues and follows his/her lead.
Developing a computational model that enables virtual agents to accompany the dance with the user-controlled leader has great potential in a wide range of virtual reality (VR) and augmented reality (AR) applications.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Although the dance accompaniment task has broad academic and practical value,
there is no currently available duet dance data in public.
To facilitate this task, we build a large-scale dataset named <span id="S1.p2.1.1" class="ltx_text ltx_font_typewriter">DD100</span> (<span id="S1.p2.1.2" class="ltx_text ltx_font_bold ltx_font_italic">D<span id="S1.p2.1.2.1" class="ltx_text ltx_font_medium">uet</span>D<span id="S1.p2.1.2.2" class="ltx_text ltx_font_medium">ance</span>100</span>).
Specifically, we record data of 10 different genres of ballroom dancing, including 5 kinds of Latin (Cha Cha, Rumba, Samba, Paso Doble and Jive), 4 Moderns (Foxtrot, Tango, Quickstep and Waltz) and <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">Pas de Deux</span> of ballet performed by 5 pairs of professional dancers under unique background music.
For each genre, the performers play 10 distinct clips, within a duration of 36 to 107 seconds, resulting in a total duration of around 117 minutes.
As duet dances usually involve significant parts of occlusion and rotations, we collect the 3D motion data using professional MoCap equipment to ensure data quality.
The final data consists of SMPL-X <cite class="ltx_cite ltx_citemacro_citep">(Pavlakos et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite> sequences, with body poses reconstructed from the point clouds by and hand gestures deduced from meta glove records.
<span id="S1.p2.1.4" class="ltx_text ltx_font_typewriter">DD100</span> provides a rich context of interactive coordination between two dancers, including either physical connections (such as steps with hand holding) or strong semantic relations (such as leader-centered surrounding), which serves as a fundamental basis for the study of related to duet interactive dance.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2403.18811/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="442" height="268" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S1.F2.5.1" class="ltx_text ltx_font_bold">Samples of <span id="S1.F2.5.1.1" class="ltx_text ltx_font_typewriter">DD100</span> dataset.</span> The leader and the follower are colored in <span id="S1.F2.6.2" class="ltx_text" style="color:#0AA344;">green</span> and <span id="S1.F2.7.3" class="ltx_text" style="color:#C93756;">red</span>, respectively. <span id="S1.F2.8.4" class="ltx_text ltx_font_typewriter">DD100</span> contains 10 dance genres, featuring a diverse range of poses and interactions, with intricate hand gestures.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Despite having a high-quality duet dance dataset, the dance accompaniment task cannot be solved by applying existing solo dance methods  <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a href="#bib.bib40" title="" class="ltx_ref">2020</a>; Sun et al., <a href="#bib.bib44" title="" class="ltx_ref">2020</a>; Vaswani et al., <a href="#bib.bib52" title="" class="ltx_ref">2017</a>; Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>; Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Sun et al., <a href="#bib.bib45" title="" class="ltx_ref">2022</a>; Tseng et al., <a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite>.
As an interactive art, a duet dance not only requires the follower to maintain the aesthetics and the sense of rhythm of his/her own movements, but also demands a high level of interactive coordination with the leader.
Such requirements make existing works on solo dancing inadequate for this task as they lack the scope of the partner.
Meanwhile, generating a single agent’s motion in response to a pre-conditioned leader’s movement presents more significant challenges than simultaneously synthesizing multiple agents <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>, since the latter can retrieve well-coordinated motion patterns from the training data, which simplifies the task.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a two-stage framework to generate follower motion in harmony with both the background music and the leader’s movements.
In the first stage, we train VQ-VAEs to embed and quantize the dance movements of different body parts and the relative translation between the two dancers.
Then, in the second stage, we devise an interaction-coordinated GPT to autoregressively predict the next token, conditioned on the amalgamated information of the music signal, the leader’s motion, and the previous follower sequence.
Stability issues arise when confronted with unheard music or unseen leader motion patterns. A common observation is that the lower body movement appears incompatible with the global displacement, resulting in skating artifacts.
To address this challenge, we introduce an off-policy reinforcement learning strategy for GPT, enabling our method to handle out-of-distribution instances robustly based on human-defined rewards.
The above modules contribute to <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">Duolando</span>, which can generate reasonable movement responding to the leader’s movement and serves as a strong baseline of dance accompaniment.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">The contributions of our paper are three-fold:
<span id="S1.p5.1.1" class="ltx_text ltx_font_bold">(1)</span> We introduce a novel multi-modal task, dance accompaniment, and provide a large-scale and diverse dataset for both training and testing purposes. Leveraging this data, we establish a new benchmark with metrics reflecting both the quality of isolated dancers and the interaction between partners.
<span id="S1.p5.1.2" class="ltx_text ltx_font_bold">(2)</span> We construct a GPT-based network capable of generating motion sequences, taking into account the coordination between partners, which serves as a robust baseline for this task.
<span id="S1.p5.1.3" class="ltx_text ltx_font_bold">(3)</span> We introduce an off-policy reinforcement learning strategy for GPT to address out-of-distribution challenges, and demonstrate its successful application in our task.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_typewriter">DD100</span>: A Large-scale Duet Dance Mocap Dataset</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Data Statistics.</span>
To facilitate research in the dance accompaniment task, a large-scale dataset of duet dances, named <span id="S2.p1.1.2" class="ltx_text ltx_font_typewriter">DD100</span>, was collected.
<span id="S2.p1.1.3" class="ltx_text ltx_font_typewriter">DD100</span> comprises ten distinct genres of duet dances, all featuring strong interaction between the dancers.
The genres include five Latin dances (Cha Cha, Rumba, Samba, Paso Doble, and Jive), four Modern (a.k.a. Standard) dances (Foxtrot, Tango, Quickstep, and Waltz), and <span id="S2.p1.1.4" class="ltx_text ltx_font_italic">Pas-de-Deux</span> ballet.
The dances were performed by five pairs of professional dancers, while each dance sequence was accompanied by unique background music. Each dance genre was recorded by ten distinct clips, with clip durations ranging from 49 to 96 seconds, resulting in a total duration of approximately 1.9 hours (or approximately 115.4 minutes).
In the experiment, we randomly split the dataset into the 80% training set and 20% test set, with the training set of 168,176 frames (5605.9 seconds) and the test set of 42,496 frames (1416.5 seconds).
During the recording, nearly 80% sequences are <span id="S2.p1.1.5" class="ltx_text" style="color:#000000;">performed</span> twice. <span id="S2.p1.1.6" class="ltx_text" style="color:#000000;">If counting these duplicated takes,</span> the total duration will be 3.24 hours.
Considering the diversity in moving direction and difference in motion details at each take, we use all these data for training and testing in practice.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S2.T1.13.1" class="ltx_text ltx_font_bold">Comparison with human-human interaction and music-to-dance datasets.</span>
HHI denotes Human-Human Interaction, where S represents <span id="S2.T1.14.2" class="ltx_text ltx_font_italic">Strong</span> interaction with physical contact while W means <span id="S2.T1.15.3" class="ltx_text ltx_font_italic">Weak</span> interaction like repeated motion in group dance.

<div id="S2.T1.16.4" class="ltx_inline-block ltx_transformed_outer" style="width:14.0pt;height:4.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.7pt,1.4pt) scale(0.6,0.6) ;"><span id="S2.T1.16.4.1" class="ltx_ERROR undefined">\AchtBR</span><span id="S2.T1.16.4.2" class="ltx_ERROR undefined">\AchtBL</span>
</span></div> indicates whether having accompanied music modality.
<span id="S2.T1.17.5" class="ltx_ERROR undefined">\faHandStopO</span> denotes whether having hand (finger-level) motions.
# Subj. denotes the number of performers.
<math id="S2.T1.3.m1.1" class="ltx_Math" alttext="\overline{T}" display="inline"><semantics id="S2.T1.3.m1.1b"><mover accent="true" id="S2.T1.3.m1.1.1" xref="S2.T1.3.m1.1.1.cmml"><mi id="S2.T1.3.m1.1.1.2" xref="S2.T1.3.m1.1.1.2.cmml">T</mi><mo id="S2.T1.3.m1.1.1.1" xref="S2.T1.3.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.T1.3.m1.1c"><apply id="S2.T1.3.m1.1.1.cmml" xref="S2.T1.3.m1.1.1"><ci id="S2.T1.3.m1.1.1.1.cmml" xref="S2.T1.3.m1.1.1.1">¯</ci><ci id="S2.T1.3.m1.1.1.2.cmml" xref="S2.T1.3.m1.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.m1.1d">\overline{T}</annotation></semantics></math> denotes average duration and <math id="S2.T1.4.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.T1.4.m2.1b"><mi id="S2.T1.4.m2.1.1" xref="S2.T1.4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.T1.4.m2.1c"><ci id="S2.T1.4.m2.1.1.cmml" xref="S2.T1.4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.m2.1d">T</annotation></semantics></math> is the total duration of all sequences.
MV stands for capturing with multi-view cameras.
Genres for human-human interaction dataset means the type of interactions, while it indicates the music and dance styles for music-to-dance datasts.
n/a means that the exact information is missed in the original paper.
<span id="S2.T1.18.6" class="ltx_text" style="color:#000000;">*Interactions without physical contact appear in partial data (Showcase, Cypher and Battle) in AIST++.</span>
</figcaption>
<table id="S2.T1.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S2.T1.6.2" class="ltx_tr">
<td id="S2.T1.6.2.3" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">Dataset</td>
<td id="S2.T1.6.2.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">HHI</td>
<td id="S2.T1.6.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">
<div id="S2.T1.6.2.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:11.0pt;height:4.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-3.7pt,1.4pt) scale(0.6,0.6) ;"><span id="S2.T1.6.2.5.1.1" class="ltx_ERROR undefined">\AchtBR</span><span id="S2.T1.6.2.5.1.2" class="ltx_ERROR undefined">\AchtBL</span>
</span></div>
</td>
<td id="S2.T1.6.2.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="S2.T1.6.2.6.1" class="ltx_ERROR undefined">\faHandStopO</span></td>
<td id="S2.T1.6.2.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"># Genres</td>
<td id="S2.T1.6.2.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"># Subj.</td>
<td id="S2.T1.5.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"><math id="S2.T1.5.1.1.m1.1" class="ltx_Math" alttext="\overline{T}" display="inline"><semantics id="S2.T1.5.1.1.m1.1a"><mover accent="true" id="S2.T1.5.1.1.m1.1.1" xref="S2.T1.5.1.1.m1.1.1.cmml"><mi id="S2.T1.5.1.1.m1.1.1.2" xref="S2.T1.5.1.1.m1.1.1.2.cmml">T</mi><mo id="S2.T1.5.1.1.m1.1.1.1" xref="S2.T1.5.1.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.T1.5.1.1.m1.1b"><apply id="S2.T1.5.1.1.m1.1.1.cmml" xref="S2.T1.5.1.1.m1.1.1"><ci id="S2.T1.5.1.1.m1.1.1.1.cmml" xref="S2.T1.5.1.1.m1.1.1.1">¯</ci><ci id="S2.T1.5.1.1.m1.1.1.2.cmml" xref="S2.T1.5.1.1.m1.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.1.1.m1.1c">\overline{T}</annotation></semantics></math></td>
<td id="S2.T1.6.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"><math id="S2.T1.6.2.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.T1.6.2.2.m1.1a"><mi id="S2.T1.6.2.2.m1.1.1" xref="S2.T1.6.2.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.T1.6.2.2.m1.1b"><ci id="S2.T1.6.2.2.m1.1.1.cmml" xref="S2.T1.6.2.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.2.2.m1.1c">T</annotation></semantics></math></td>
<td id="S2.T1.6.2.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">Acquisition</td>
<td id="S2.T1.6.2.10" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">GT</td>
</tr>
<tr id="S2.T1.6.3" class="ltx_tr">
<td id="S2.T1.6.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">CMU-MoCap (interactive) <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">cmu, </a>)</cite>
</td>
<td id="S2.T1.6.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">W</td>
<td id="S2.T1.6.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S2.T1.6.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">8</td>
<td id="S2.T1.6.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">5.2s</td>
<td id="S2.T1.6.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">285.5s</td>
<td id="S2.T1.6.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">MoCap</td>
<td id="S2.T1.6.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.4" class="ltx_tr">
<td id="S2.T1.6.4.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">UMPM <cite class="ltx_cite ltx_citemacro_citep">(Van der Aa et al., <a href="#bib.bib51" title="" class="ltx_ref">2011</a>)</cite>
</td>
<td id="S2.T1.6.4.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">W</td>
<td id="S2.T1.6.4.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.4.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.4.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">7</td>
<td id="S2.T1.6.4.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">30</td>
<td id="S2.T1.6.4.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">222s</td>
<td id="S2.T1.6.4.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">2.2h</td>
<td id="S2.T1.6.4.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">MoCap</td>
<td id="S2.T1.6.4.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.5" class="ltx_tr">
<td id="S2.T1.6.5.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">NTU-RGB+D 120 <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>
</td>
<td id="S2.T1.6.5.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">S</td>
<td id="S2.T1.6.5.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.5.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.5.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">26</td>
<td id="S2.T1.6.5.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">106</td>
<td id="S2.T1.6.5.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">2.7s</td>
<td id="S2.T1.6.5.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.47h</td>
<td id="S2.T1.6.5.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">Kinect</td>
<td id="S2.T1.6.5.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.6" class="ltx_tr">
<td id="S2.T1.6.6.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">You2Me <cite class="ltx_cite ltx_citemacro_citep">(Ng et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>
</td>
<td id="S2.T1.6.6.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">S</td>
<td id="S2.T1.6.6.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.6.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.6.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">4</td>
<td id="S2.T1.6.6.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S2.T1.6.6.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">120s</td>
<td id="S2.T1.6.6.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">1.4h</td>
<td id="S2.T1.6.6.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">MV &amp; Kinect</td>
<td id="S2.T1.6.6.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.7" class="ltx_tr">
<td id="S2.T1.6.7.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">InterHuman <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>
</td>
<td id="S2.T1.6.7.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">S</td>
<td id="S2.T1.6.7.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.7.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.7.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">11</td>
<td id="S2.T1.6.7.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.7.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3.9s</td>
<td id="S2.T1.6.7.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">6.56h</td>
<td id="S2.T1.6.7.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">MV</td>
<td id="S2.T1.6.7.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">SMPL</td>
</tr>
<tr id="S2.T1.6.8" class="ltx_tr">
<td id="S2.T1.6.8.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">DanceNet <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al., <a href="#bib.bib62" title="" class="ltx_ref">2022</a>)</cite>
</td>
<td id="S2.T1.6.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S2.T1.6.8.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S2.T1.6.8.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.96h</td>
<td id="S2.T1.6.8.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">MoCap</td>
<td id="S2.T1.6.8.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.9" class="ltx_tr">
<td id="S2.T1.6.9.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">Dancing2Music <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>
</td>
<td id="S2.T1.6.9.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.9.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.9.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.9.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3</td>
<td id="S2.T1.6.9.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.9.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">6s</td>
<td id="S2.T1.6.9.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">71h</td>
<td id="S2.T1.6.9.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">Pseudo</td>
<td id="S2.T1.6.9.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">2D Joints</td>
</tr>
<tr id="S2.T1.6.10" class="ltx_tr">
<td id="S2.T1.6.10.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">DanceRevolusion <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>
</td>
<td id="S2.T1.6.10.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.10.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.10.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.10.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3</td>
<td id="S2.T1.6.10.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.10.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">60s</td>
<td id="S2.T1.6.10.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">12h</td>
<td id="S2.T1.6.10.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">Pseudo</td>
<td id="S2.T1.6.10.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">2D Joints</td>
</tr>
<tr id="S2.T1.6.11" class="ltx_tr">
<td id="S2.T1.6.11.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">PMSD <cite class="ltx_cite ltx_citemacro_citep">(Valle-Pérez et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>)</cite>
</td>
<td id="S2.T1.6.11.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.11.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.11.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.11.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3</td>
<td id="S2.T1.6.11.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">1</td>
<td id="S2.T1.6.11.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.11.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3.1h</td>
<td id="S2.T1.6.11.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">MoCap</td>
<td id="S2.T1.6.11.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.12" class="ltx_tr">
<td id="S2.T1.6.12.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">SMVR <cite class="ltx_cite ltx_citemacro_citep">(Valle-Pérez et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>)</cite>
</td>
<td id="S2.T1.6.12.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.12.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.12.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.12.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S2.T1.6.12.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">8</td>
<td id="S2.T1.6.12.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.12.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">9h</td>
<td id="S2.T1.6.12.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">VR Tracker</td>
<td id="S2.T1.6.12.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">3D Joints</td>
</tr>
<tr id="S2.T1.6.13" class="ltx_tr">
<td id="S2.T1.6.13.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">AIST++ <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>)</cite>
</td>
<td id="S2.T1.6.13.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">  <span id="S2.T1.6.13.2.1" class="ltx_text" style="color:#000000;">W*</span>
</td>
<td id="S2.T1.6.13.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.13.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.13.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S2.T1.6.13.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">30</td>
<td id="S2.T1.6.13.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">13s</td>
<td id="S2.T1.6.13.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">5.2h</td>
<td id="S2.T1.6.13.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">Pseudo</td>
<td id="S2.T1.6.13.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">SMPL</td>
</tr>
<tr id="S2.T1.6.14" class="ltx_tr">
<td id="S2.T1.6.14.1" class="ltx_td ltx_align_left" style="padding-left:5.7pt;padding-right:5.7pt;">AIOZ-GDANCE <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>
</td>
<td id="S2.T1.6.14.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">W</td>
<td id="S2.T1.6.14.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.14.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">✗</td>
<td id="S2.T1.6.14.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">n/a</td>
<td id="S2.T1.6.14.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">4000+</td>
<td id="S2.T1.6.14.7" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">37.5s</td>
<td id="S2.T1.6.14.8" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">16.7h</td>
<td id="S2.T1.6.14.9" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">Pseudo</td>
<td id="S2.T1.6.14.10" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">SMPL</td>
</tr>
<tr id="S2.T1.6.15" class="ltx_tr">
<td id="S2.T1.6.15.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="S2.T1.6.15.1.1" class="ltx_text ltx_font_typewriter">DD100</span></td>
<td id="S2.T1.6.15.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">S</td>
<td id="S2.T1.6.15.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.15.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">✓</td>
<td id="S2.T1.6.15.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S2.T1.6.15.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S2.T1.6.15.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">70.2s</td>
<td id="S2.T1.6.15.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">1.95h</td>
<td id="S2.T1.6.15.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">MoCap</td>
<td id="S2.T1.6.15.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" style="padding-left:5.7pt;padding-right:5.7pt;">SMPL-X</td>
</tr>
</table>
</figure>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.3" class="ltx_p"><span id="S2.p2.3.1" class="ltx_text ltx_font_bold">Data Collection.</span>
To obtain high-quality data, we used 20 optical MoCap cameras to capture body data for two dancers at 120 FPS.
The raw Mocap data consist of the 3D positions of 53 marker points on body surface in each frame. To process these data into SMPL-X <cite class="ltx_cite ltx_citemacro_citep">(Pavlakos et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite> format, we first select a clip for each dancer to fit his/her body shape parameters (<span id="S2.p2.3.2" class="ltx_text ltx_font_typewriter">beta</span>), following the pipeline of SOMA <cite class="ltx_cite ltx_citemacro_citep">(Ghorbani &amp; Black, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>. Then, we use the pre-processed body shape to assist pose parameters (<span id="S2.p2.3.3" class="ltx_text ltx_font_typewriter">theta</span>) regression in each frame after filtering out those invisible points with confidence scores lower than a threshold to keep the robustness of the regression results.
During this procedure, we do not fit the hand movement.
Since the hands are prone to self-occlusion or inter-occlusions between two individuals, we employed inertial motion capture gloves (meta gloves) to capture these data.
The raw data of meta gloves are stored in BioVision Motion Capture (BVH) format, describing hierarchical rotations of finger joints in Euler angles.
We transfer those Euler angles to axis angles aligning the MANO <cite class="ltx_cite ltx_citemacro_citep">(Romero et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>)</cite> model initialized with “flat” gestures for both hands.
As the “flat” pose of MANO differs from the initial one in BVH format with fingers apart in specific angles, we subtract this difference while mapping from BVH to MANO.
Finally, we combine the body and hand parameters with the wrist rotations from MoCap regression.
Each dance clip data in <span id="S2.p2.3.4" class="ltx_text ltx_font_typewriter">DD100</span> consists of the SMPL-X <cite class="ltx_cite ltx_citemacro_citep">(Pavlakos et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite> sequences for both the leader and follower, along with the corresponding music within an average rhythmical beat of <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="118" display="inline"><semantics id="S2.p2.1.m1.1a"><mn id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">118</mn><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><cn type="integer" id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">118</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">118</annotation></semantics></math> beat per minute (BPM) from <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="72" display="inline"><semantics id="S2.p2.2.m2.1a"><mn id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><cn type="integer" id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">72</annotation></semantics></math> BPM to <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="163" display="inline"><semantics id="S2.p2.3.m3.1a"><mn id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">163</mn><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><cn type="integer" id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">163</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">163</annotation></semantics></math> BPM.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Comparison to Related Datasets.</span>
As shown in Table <a href="#S2.T1" title="Table 1 ‣ 2 DD100: A Large-scale Duet Dance Mocap Dataset ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <span id="S2.p3.1.2" class="ltx_text ltx_font_typewriter">DD100</span> stands out from existing datasets by simultaneously incorporating the following distinct features:
<span id="S2.p3.1.3" class="ltx_text ltx_font_bold">(1)</span> <span id="S2.p3.1.4" class="ltx_text ltx_font_bold">Complex and Strong Interaction.</span> Existing solo dance datasets <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al., <a href="#bib.bib62" title="" class="ltx_ref">2022</a>; Lee et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Huang et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Valle-Pérez et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>; Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> overlook the element of interaction, while existing group dance datasets <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> primarily emphasize group movement coordination with similar motions replicated to different agents with minimal
physical contact.
Furthermore, current human-human interaction datasets <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">cmu, </a>; Van der Aa et al., <a href="#bib.bib51" title="" class="ltx_ref">2011</a>; Liu et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> typically feature simpler actions and weaker interactions, such as handshakes and hugs.
In contrary, as depicted in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, duet dances in <span id="S2.p3.1.5" class="ltx_text ltx_font_typewriter">DD100</span> involve more complex motions and intense interactions between various body parts.
<span id="S2.p3.1.6" class="ltx_text ltx_font_bold">(2)</span> <span id="S2.p3.1.7" class="ltx_text ltx_font_bold">Multimodal.</span> Unlike datasets <cite class="ltx_cite ltx_citemacro_citep">(Ng et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Liang et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> focusing on human-human interaction, <span id="S2.p3.1.8" class="ltx_text ltx_font_typewriter">DD100</span> incorporates a musical modality, which is a crucial factor to consider during the generation process to ensure synchrony with the music.
<span id="S2.p3.1.9" class="ltx_text ltx_font_bold">(3)</span> <span id="S2.p3.1.10" class="ltx_text ltx_font_bold">Extended Duration.</span> Many existing human motion datasets feature short durations.
For example, dances in AIST++ <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>)</cite> typically last around 10 seconds.
In contrast, each dance clip in <span id="S2.p3.1.11" class="ltx_text ltx_font_typewriter">DD100</span> extends over one minute.
This not only supplies a higher-level choreography reference for model training but also poses the proposed dance accompaniment problem to be more realistic and challenging.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Our Approach</h2>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2403.18811/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="200" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.8.1" class="ltx_text ltx_font_bold">(a) Structures of Motion VQ-VAEs and (b) Relative Translation VQ-VAE.</span> The quantization is to substitute a encoded feature to the most similar one <math id="S3.F3.4.m1.1" class="ltx_Math" alttext="z_{k}" display="inline"><semantics id="S3.F3.4.m1.1b"><msub id="S3.F3.4.m1.1.1" xref="S3.F3.4.m1.1.1.cmml"><mi id="S3.F3.4.m1.1.1.2" xref="S3.F3.4.m1.1.1.2.cmml">z</mi><mi id="S3.F3.4.m1.1.1.3" xref="S3.F3.4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.4.m1.1c"><apply id="S3.F3.4.m1.1.1.cmml" xref="S3.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.4.m1.1.1.1.cmml" xref="S3.F3.4.m1.1.1">subscript</csymbol><ci id="S3.F3.4.m1.1.1.2.cmml" xref="S3.F3.4.m1.1.1.2">𝑧</ci><ci id="S3.F3.4.m1.1.1.3.cmml" xref="S3.F3.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m1.1d">z_{k}</annotation></semantics></math> in the codebook <math id="S3.F3.5.m2.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.F3.5.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F3.5.m2.1.1" xref="S3.F3.5.m2.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.F3.5.m2.1c"><ci id="S3.F3.5.m2.1.1.cmml" xref="S3.F3.5.m2.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.m2.1d">\mathcal{Z}</annotation></semantics></math> such that <math id="S3.F3.6.m3.1" class="ltx_Math" alttext="z_{k}=\arg\min_{z\in\mathcal{Z}}\|f_{i}-z\|." display="inline"><semantics id="S3.F3.6.m3.1b"><mrow id="S3.F3.6.m3.1.1.1" xref="S3.F3.6.m3.1.1.1.1.cmml"><mrow id="S3.F3.6.m3.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.cmml"><msub id="S3.F3.6.m3.1.1.1.1.3" xref="S3.F3.6.m3.1.1.1.1.3.cmml"><mi id="S3.F3.6.m3.1.1.1.1.3.2" xref="S3.F3.6.m3.1.1.1.1.3.2.cmml">z</mi><mi id="S3.F3.6.m3.1.1.1.1.3.3" xref="S3.F3.6.m3.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.F3.6.m3.1.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.2.cmml">=</mo><mrow id="S3.F3.6.m3.1.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.1.cmml"><mi id="S3.F3.6.m3.1.1.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.1.2.cmml">arg</mi><mo lspace="0.167em" id="S3.F3.6.m3.1.1.1.1.1b" xref="S3.F3.6.m3.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.F3.6.m3.1.1.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.1.1.cmml"><msub id="S3.F3.6.m3.1.1.1.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.F3.6.m3.1.1.1.1.1.1.2.2" xref="S3.F3.6.m3.1.1.1.1.1.1.2.2.cmml">min</mi><mrow id="S3.F3.6.m3.1.1.1.1.1.1.2.3" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.F3.6.m3.1.1.1.1.1.1.2.3.2" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.2.cmml">z</mi><mo id="S3.F3.6.m3.1.1.1.1.1.1.2.3.1" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.F3.6.m3.1.1.1.1.1.1.2.3.3" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.3.cmml">𝒵</mi></mrow></msub><mo id="S3.F3.6.m3.1.1.1.1.1.1b" xref="S3.F3.6.m3.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.F3.6.m3.1.1.1.1.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.F3.6.m3.1.1.1.1.1.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.1" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.F3.6.m3.1.1.1.1.1.1.1.1.3" xref="S3.F3.6.m3.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.F3.6.m3.1.1.1.2" xref="S3.F3.6.m3.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.6.m3.1c"><apply id="S3.F3.6.m3.1.1.1.1.cmml" xref="S3.F3.6.m3.1.1.1"><eq id="S3.F3.6.m3.1.1.1.1.2.cmml" xref="S3.F3.6.m3.1.1.1.1.2"></eq><apply id="S3.F3.6.m3.1.1.1.1.3.cmml" xref="S3.F3.6.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.6.m3.1.1.1.1.3.1.cmml" xref="S3.F3.6.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.F3.6.m3.1.1.1.1.3.2.cmml" xref="S3.F3.6.m3.1.1.1.1.3.2">𝑧</ci><ci id="S3.F3.6.m3.1.1.1.1.3.3.cmml" xref="S3.F3.6.m3.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.F3.6.m3.1.1.1.1.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1"><arg id="S3.F3.6.m3.1.1.1.1.1.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.2"></arg><apply id="S3.F3.6.m3.1.1.1.1.1.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1"><apply id="S3.F3.6.m3.1.1.1.1.1.1.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.F3.6.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2">subscript</csymbol><min id="S3.F3.6.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2.2"></min><apply id="S3.F3.6.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3"><in id="S3.F3.6.m3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.1"></in><ci id="S3.F3.6.m3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.2">𝑧</ci><ci id="S3.F3.6.m3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.2.3.3">𝒵</ci></apply></apply><apply id="S3.F3.6.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.F3.6.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1"><minus id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.F3.6.m3.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.m3.1d">z_{k}=\arg\min_{z\in\mathcal{Z}}\|f_{i}-z\|.</annotation></semantics></math></figcaption>
</figure>
<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">To address the dance accompaniment task, we propose a baseline method, <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">Duolando</span>, a GPT-based network enhanced with off-policy reinforcement learning to improve its generalization ability.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Quantizing Motion and Relative Translation</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.6" class="ltx_p">Previous studies <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Ng et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite> has viewed dance as a sequential combination of reusable dance positions, capturing the essence of movement in a rhythmic context. To efficiently distill and quantize these basic dance components into a deep feature space in an unsupervised manner, we draw on VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al., <a href="#bib.bib50" title="" class="ltx_ref">2017</a>)</cite>. This provides a tokenized and interpretable representation of the dance motion sequence. Our approach incorporates a 1D CNN-based VQ-VAE to preserve the spatio-temporal continuity of dance movement.
Inspired by  <cite class="ltx_cite ltx_citemacro_citet">Siyao et al. (<a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>, we use four VQ-VAEs to encode and quantize the motion of four body parts (upper half body, lower half body, left hand, and right hand) into code sequences <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{z}^{up}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msup id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒛</mi><mrow id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">p</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒛</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><times id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">𝑢</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bm{z}^{up}</annotation></semantics></math>, <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{z}^{down}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msup id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝒛</mi><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.3.1a" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3.4" xref="S3.SS1.p1.2.m2.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.3.1b" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3.5" xref="S3.SS1.p1.2.m2.1.1.3.5.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝒛</ci><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">𝑑</ci><ci id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS1.p1.2.m2.1.1.3.4">𝑤</ci><ci id="S3.SS1.p1.2.m2.1.1.3.5.cmml" xref="S3.SS1.p1.2.m2.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\bm{z}^{down}</annotation></semantics></math>, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{z}^{lhand}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒛</mi><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1a" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.4" xref="S3.SS1.p1.3.m3.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1b" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.5" xref="S3.SS1.p1.3.m3.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1c" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.6" xref="S3.SS1.p1.3.m3.1.1.3.6.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒛</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑙</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">ℎ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.4">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.3.5.cmml" xref="S3.SS1.p1.3.m3.1.1.3.5">𝑛</ci><ci id="S3.SS1.p1.3.m3.1.1.3.6.cmml" xref="S3.SS1.p1.3.m3.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\bm{z}^{lhand}</annotation></semantics></math>, and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\bm{z}^{rhand}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝒛</mi><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.1.3.1a" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.1.1.3.4" xref="S3.SS1.p1.4.m4.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.1.3.1b" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.1.1.3.5" xref="S3.SS1.p1.4.m4.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.1.3.1c" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.1.1.3.6" xref="S3.SS1.p1.4.m4.1.1.3.6.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝒛</ci><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><times id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></times><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑟</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">ℎ</ci><ci id="S3.SS1.p1.4.m4.1.1.3.4.cmml" xref="S3.SS1.p1.4.m4.1.1.3.4">𝑎</ci><ci id="S3.SS1.p1.4.m4.1.1.3.5.cmml" xref="S3.SS1.p1.4.m4.1.1.3.5">𝑛</ci><ci id="S3.SS1.p1.4.m4.1.1.3.6.cmml" xref="S3.SS1.p1.4.m4.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\bm{z}^{rhand}</annotation></semantics></math>. Additionally, we employ another VQ-VAE <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathrm{VQ}^{\bm{tr}}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msup id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">VQ</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">𝒓</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">VQ</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝒕</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathrm{VQ}^{\bm{tr}}</annotation></semantics></math> to model the relative translation <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\bm{tr}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">𝒓</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><times id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></times><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝒕</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝒓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\bm{tr}</annotation></semantics></math> between the follower and leader. This allows the GPT model to explicitly output the relative positions of the follower by subtracting the root point of the follower from that of the leader. Please see Figure <a href="#S3.F3" title="Figure 3 ‣ 3 Our Approach ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for details.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.17" class="ltx_p">In the case of motion VQ-VAEs, a <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="T\times J\times 3" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.1a" xref="S3.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS1.p2.1.m1.1.1.4" xref="S3.SS1.p2.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></times><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑇</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝐽</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.4.cmml" xref="S3.SS1.p2.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">T\times J\times 3</annotation></semantics></math> sequence of 3D joint positions is fed into a 1D-CNN encoder <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">E</annotation></semantics></math>, where <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">T</annotation></semantics></math> is the frame length and <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">J</annotation></semantics></math> is the joint count. This is then translated to a temporally downsampled deep feature <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\bm{f}\in{\mathbb{R}}^{T^{\prime}\times C}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">𝒇</mi><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml"><msup id="S3.SS1.p2.5.m5.1.1.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml">T</mi><mo id="S3.SS1.p2.5.m5.1.1.3.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.1.1.3.3.1" xref="S3.SS1.p2.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.5.m5.1.1.3.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><in id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></in><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝒇</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3"><times id="S3.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.1"></times><apply id="S3.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2">𝑇</ci><ci id="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3">′</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\bm{f}\in{\mathbb{R}}^{T^{\prime}\times C}</annotation></semantics></math>, where <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="T^{\prime}=T/d" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><msup id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">T</mi><mo id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.p2.6.m6.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml">T</mi><mo id="S3.SS1.p2.6.m6.1.1.3.1" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p2.6.m6.1.1.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><eq id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1"></eq><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">𝑇</ci><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">′</ci></apply><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><divide id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.1"></divide><ci id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">𝑇</ci><ci id="S3.SS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">T^{\prime}=T/d</annotation></semantics></math> and <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">C</annotation></semantics></math> is the number of channels. Subsequently, deep feature <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\bm{f}</annotation></semantics></math> is quantized into code sequence <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\bm{z}</annotation></semantics></math> by replacing each element <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝑓</ci><ci id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">f_{i}</annotation></semantics></math> with an element <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="z_{k}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">z</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝑧</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">z_{k}</annotation></semantics></math> in codebook <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><ci id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mathcal{Z}</annotation></semantics></math> that shows the smallest difference <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="\|f_{i}-z_{k}\|" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mrow id="S3.SS1.p2.13.m13.1.1.1" xref="S3.SS1.p2.13.m13.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.13.m13.1.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p2.13.m13.1.1.1.1" xref="S3.SS1.p2.13.m13.1.1.1.1.cmml"><msub id="S3.SS1.p2.13.m13.1.1.1.1.2" xref="S3.SS1.p2.13.m13.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.13.m13.1.1.1.1.2.2" xref="S3.SS1.p2.13.m13.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p2.13.m13.1.1.1.1.2.3" xref="S3.SS1.p2.13.m13.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.13.m13.1.1.1.1.1" xref="S3.SS1.p2.13.m13.1.1.1.1.1.cmml">−</mo><msub id="S3.SS1.p2.13.m13.1.1.1.1.3" xref="S3.SS1.p2.13.m13.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.13.m13.1.1.1.1.3.2" xref="S3.SS1.p2.13.m13.1.1.1.1.3.2.cmml">z</mi><mi id="S3.SS1.p2.13.m13.1.1.1.1.3.3" xref="S3.SS1.p2.13.m13.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p2.13.m13.1.1.1.3" xref="S3.SS1.p2.13.m13.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.13.m13.1.1.2.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1.2">norm</csymbol><apply id="S3.SS1.p2.13.m13.1.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1"><minus id="S3.SS1.p2.13.m13.1.1.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.1"></minus><apply id="S3.SS1.p2.13.m13.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS1.p2.13.m13.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.13.m13.1.1.1.1.3.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.3.2">𝑧</ci><ci id="S3.SS1.p2.13.m13.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.13.m13.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\|f_{i}-z_{k}\|</annotation></semantics></math>.
For training the motion VQ-VAE, we use two decoders, <math id="S3.SS1.p2.14.m14.1" class="ltx_Math" alttext="D_{P}" display="inline"><semantics id="S3.SS1.p2.14.m14.1a"><msub id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml"><mi id="S3.SS1.p2.14.m14.1.1.2" xref="S3.SS1.p2.14.m14.1.1.2.cmml">D</mi><mi id="S3.SS1.p2.14.m14.1.1.3" xref="S3.SS1.p2.14.m14.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><apply id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.1.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p2.14.m14.1.1.2.cmml" xref="S3.SS1.p2.14.m14.1.1.2">𝐷</ci><ci id="S3.SS1.p2.14.m14.1.1.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">D_{P}</annotation></semantics></math> and <math id="S3.SS1.p2.15.m15.1" class="ltx_Math" alttext="D_{M}" display="inline"><semantics id="S3.SS1.p2.15.m15.1a"><msub id="S3.SS1.p2.15.m15.1.1" xref="S3.SS1.p2.15.m15.1.1.cmml"><mi id="S3.SS1.p2.15.m15.1.1.2" xref="S3.SS1.p2.15.m15.1.1.2.cmml">D</mi><mi id="S3.SS1.p2.15.m15.1.1.3" xref="S3.SS1.p2.15.m15.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m15.1b"><apply id="S3.SS1.p2.15.m15.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m15.1.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m15.1.1.2.cmml" xref="S3.SS1.p2.15.m15.1.1.2">𝐷</ci><ci id="S3.SS1.p2.15.m15.1.1.3.cmml" xref="S3.SS1.p2.15.m15.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">D_{M}</annotation></semantics></math>, which translate the quantized code back to 3D joint positions <math id="S3.SS1.p2.16.m16.1" class="ltx_Math" alttext="\hat{p}" display="inline"><semantics id="S3.SS1.p2.16.m16.1a"><mover accent="true" id="S3.SS1.p2.16.m16.1.1" xref="S3.SS1.p2.16.m16.1.1.cmml"><mi id="S3.SS1.p2.16.m16.1.1.2" xref="S3.SS1.p2.16.m16.1.1.2.cmml">p</mi><mo id="S3.SS1.p2.16.m16.1.1.1" xref="S3.SS1.p2.16.m16.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m16.1b"><apply id="S3.SS1.p2.16.m16.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1"><ci id="S3.SS1.p2.16.m16.1.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1.1">^</ci><ci id="S3.SS1.p2.16.m16.1.1.2.cmml" xref="S3.SS1.p2.16.m16.1.1.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m16.1c">\hat{p}</annotation></semantics></math> and rotation matrix <math id="S3.SS1.p2.17.m17.1" class="ltx_Math" alttext="\hat{M}" display="inline"><semantics id="S3.SS1.p2.17.m17.1a"><mover accent="true" id="S3.SS1.p2.17.m17.1.1" xref="S3.SS1.p2.17.m17.1.1.cmml"><mi id="S3.SS1.p2.17.m17.1.1.2" xref="S3.SS1.p2.17.m17.1.1.2.cmml">M</mi><mo id="S3.SS1.p2.17.m17.1.1.1" xref="S3.SS1.p2.17.m17.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m17.1b"><apply id="S3.SS1.p2.17.m17.1.1.cmml" xref="S3.SS1.p2.17.m17.1.1"><ci id="S3.SS1.p2.17.m17.1.1.1.cmml" xref="S3.SS1.p2.17.m17.1.1.1">^</ci><ci id="S3.SS1.p2.17.m17.1.1.2.cmml" xref="S3.SS1.p2.17.m17.1.1.2">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m17.1c">\hat{M}</annotation></semantics></math>, respectively, allowing us to generate rotations that can directly animate avatars without the need for inverse kinematics.
The training loss of the motion VQ-VAE is computed as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.7" class="ltx_Math" alttext="\mathcal{L}_{VQ}=\mathcal{L}_{rec}(\hat{\bm{p}},\bm{p})+\mathcal{L}_{rec}(\hat{M},M)+\|\text{sg}(\bm{f})-\bm{z}\|+\lambda\|{\bm{f}}-\text{sg}({\bm{z}})\|," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msub id="S3.E1.m1.7.7.1.1.4" xref="S3.E1.m1.7.7.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.4.2" xref="S3.E1.m1.7.7.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E1.m1.7.7.1.1.4.3" xref="S3.E1.m1.7.7.1.1.4.3.cmml"><mi id="S3.E1.m1.7.7.1.1.4.3.2" xref="S3.E1.m1.7.7.1.1.4.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.4.3.1" xref="S3.E1.m1.7.7.1.1.4.3.1.cmml">​</mo><mi id="S3.E1.m1.7.7.1.1.4.3.3" xref="S3.E1.m1.7.7.1.1.4.3.3.cmml">Q</mi></mrow></msub><mo id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mrow id="S3.E1.m1.7.7.1.1.2.4" xref="S3.E1.m1.7.7.1.1.2.4.cmml"><msub id="S3.E1.m1.7.7.1.1.2.4.2" xref="S3.E1.m1.7.7.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.2.4.2.2" xref="S3.E1.m1.7.7.1.1.2.4.2.2.cmml">ℒ</mi><mrow id="S3.E1.m1.7.7.1.1.2.4.2.3" xref="S3.E1.m1.7.7.1.1.2.4.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.2.4.2.3.2" xref="S3.E1.m1.7.7.1.1.2.4.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.4.2.3.1" xref="S3.E1.m1.7.7.1.1.2.4.2.3.1.cmml">​</mo><mi id="S3.E1.m1.7.7.1.1.2.4.2.3.3" xref="S3.E1.m1.7.7.1.1.2.4.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.4.2.3.1a" xref="S3.E1.m1.7.7.1.1.2.4.2.3.1.cmml">​</mo><mi id="S3.E1.m1.7.7.1.1.2.4.2.3.4" xref="S3.E1.m1.7.7.1.1.2.4.2.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.4.1" xref="S3.E1.m1.7.7.1.1.2.4.1.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.4.3.2" xref="S3.E1.m1.7.7.1.1.2.4.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.4.3.2.1" xref="S3.E1.m1.7.7.1.1.2.4.3.1.cmml">(</mo><mover accent="true" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">𝒑</mi><mo id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E1.m1.7.7.1.1.2.4.3.2.2" xref="S3.E1.m1.7.7.1.1.2.4.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒑</mi><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.4.3.2.3" xref="S3.E1.m1.7.7.1.1.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.2.3" xref="S3.E1.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S3.E1.m1.7.7.1.1.2.5" xref="S3.E1.m1.7.7.1.1.2.5.cmml"><msub id="S3.E1.m1.7.7.1.1.2.5.2" xref="S3.E1.m1.7.7.1.1.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.2.5.2.2" xref="S3.E1.m1.7.7.1.1.2.5.2.2.cmml">ℒ</mi><mrow id="S3.E1.m1.7.7.1.1.2.5.2.3" xref="S3.E1.m1.7.7.1.1.2.5.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.2.5.2.3.2" xref="S3.E1.m1.7.7.1.1.2.5.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.5.2.3.1" xref="S3.E1.m1.7.7.1.1.2.5.2.3.1.cmml">​</mo><mi id="S3.E1.m1.7.7.1.1.2.5.2.3.3" xref="S3.E1.m1.7.7.1.1.2.5.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.5.2.3.1a" xref="S3.E1.m1.7.7.1.1.2.5.2.3.1.cmml">​</mo><mi id="S3.E1.m1.7.7.1.1.2.5.2.3.4" xref="S3.E1.m1.7.7.1.1.2.5.2.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.5.1" xref="S3.E1.m1.7.7.1.1.2.5.1.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.5.3.2" xref="S3.E1.m1.7.7.1.1.2.5.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.5.3.2.1" xref="S3.E1.m1.7.7.1.1.2.5.3.1.cmml">(</mo><mover accent="true" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mi id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">M</mi><mo id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml">^</mo></mover><mo id="S3.E1.m1.7.7.1.1.2.5.3.2.2" xref="S3.E1.m1.7.7.1.1.2.5.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">M</mi><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.5.3.2.3" xref="S3.E1.m1.7.7.1.1.2.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.2.3a" xref="S3.E1.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml"><mtext id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2a.cmml">sg</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.3.2.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">𝒇</mi><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.3.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E1.m1.7.7.1.1.2.3b" xref="S3.E1.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S3.E1.m1.7.7.1.1.2.2" xref="S3.E1.m1.7.7.1.1.2.2.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.3" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.1.1" xref="S3.E1.m1.7.7.1.1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.1.1.1" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.1.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.2.cmml">𝒇</mi><mo id="S3.E1.m1.7.7.1.1.2.2.1.1.1.1" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.cmml"><mtext id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2a.cmml">sg</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.1" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.3.2" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.3.2.1" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.cmml">(</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">𝒛</mi><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.3.2.2" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"></eq><apply id="S3.E1.m1.7.7.1.1.4.cmml" xref="S3.E1.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.4.1.cmml" xref="S3.E1.m1.7.7.1.1.4">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.4.2.cmml" xref="S3.E1.m1.7.7.1.1.4.2">ℒ</ci><apply id="S3.E1.m1.7.7.1.1.4.3.cmml" xref="S3.E1.m1.7.7.1.1.4.3"><times id="S3.E1.m1.7.7.1.1.4.3.1.cmml" xref="S3.E1.m1.7.7.1.1.4.3.1"></times><ci id="S3.E1.m1.7.7.1.1.4.3.2.cmml" xref="S3.E1.m1.7.7.1.1.4.3.2">𝑉</ci><ci id="S3.E1.m1.7.7.1.1.4.3.3.cmml" xref="S3.E1.m1.7.7.1.1.4.3.3">𝑄</ci></apply></apply><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><plus id="S3.E1.m1.7.7.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.3"></plus><apply id="S3.E1.m1.7.7.1.1.2.4.cmml" xref="S3.E1.m1.7.7.1.1.2.4"><times id="S3.E1.m1.7.7.1.1.2.4.1.cmml" xref="S3.E1.m1.7.7.1.1.2.4.1"></times><apply id="S3.E1.m1.7.7.1.1.2.4.2.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.4.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.4.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.2">ℒ</ci><apply id="S3.E1.m1.7.7.1.1.2.4.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.3"><times id="S3.E1.m1.7.7.1.1.2.4.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.3.1"></times><ci id="S3.E1.m1.7.7.1.1.2.4.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.3.2">𝑟</ci><ci id="S3.E1.m1.7.7.1.1.2.4.2.3.3.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.3.3">𝑒</ci><ci id="S3.E1.m1.7.7.1.1.2.4.2.3.4.cmml" xref="S3.E1.m1.7.7.1.1.2.4.2.3.4">𝑐</ci></apply></apply><interval closure="open" id="S3.E1.m1.7.7.1.1.2.4.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.4.3.2"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><ci id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1">^</ci><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝒑</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒑</ci></interval></apply><apply id="S3.E1.m1.7.7.1.1.2.5.cmml" xref="S3.E1.m1.7.7.1.1.2.5"><times id="S3.E1.m1.7.7.1.1.2.5.1.cmml" xref="S3.E1.m1.7.7.1.1.2.5.1"></times><apply id="S3.E1.m1.7.7.1.1.2.5.2.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.5.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.5.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.2">ℒ</ci><apply id="S3.E1.m1.7.7.1.1.2.5.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.3"><times id="S3.E1.m1.7.7.1.1.2.5.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.3.1"></times><ci id="S3.E1.m1.7.7.1.1.2.5.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.3.2">𝑟</ci><ci id="S3.E1.m1.7.7.1.1.2.5.2.3.3.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.3.3">𝑒</ci><ci id="S3.E1.m1.7.7.1.1.2.5.2.3.4.cmml" xref="S3.E1.m1.7.7.1.1.2.5.2.3.4">𝑐</ci></apply></apply><interval closure="open" id="S3.E1.m1.7.7.1.1.2.5.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.5.3.2"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><ci id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1">^</ci><ci id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2">𝑀</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑀</ci></interval></apply><apply id="S3.E1.m1.7.7.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1"><minus id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2"><times id="S3.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.1"></times><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2"><mtext id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2">sg</mtext></ci><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝒇</ci></apply><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3">𝒛</ci></apply></apply><apply id="S3.E1.m1.7.7.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2"><times id="S3.E1.m1.7.7.1.1.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2"></times><ci id="S3.E1.m1.7.7.1.1.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.3">𝜆</ci><apply id="S3.E1.m1.7.7.1.1.2.2.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.1.1.2.2.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.2">norm</csymbol><apply id="S3.E1.m1.7.7.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1"><minus id="S3.E1.m1.7.7.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.1"></minus><ci id="S3.E1.m1.7.7.1.1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.2">𝒇</ci><apply id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3"><times id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.1"></times><ci id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2a.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2"><mtext id="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.1.1.3.2">sg</mtext></ci><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">𝒛</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">\mathcal{L}_{VQ}=\mathcal{L}_{rec}(\hat{\bm{p}},\bm{p})+\mathcal{L}_{rec}(\hat{M},M)+\|\text{sg}(\bm{f})-\bm{z}\|+\lambda\|{\bm{f}}-\text{sg}({\bm{z}})\|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.23" class="ltx_p">where <math id="S3.SS1.p2.18.m1.1" class="ltx_Math" alttext="\mathcal{L}_{rec}" display="inline"><semantics id="S3.SS1.p2.18.m1.1a"><msub id="S3.SS1.p2.18.m1.1.1" xref="S3.SS1.p2.18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.18.m1.1.1.2" xref="S3.SS1.p2.18.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS1.p2.18.m1.1.1.3" xref="S3.SS1.p2.18.m1.1.1.3.cmml"><mi id="S3.SS1.p2.18.m1.1.1.3.2" xref="S3.SS1.p2.18.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.18.m1.1.1.3.1" xref="S3.SS1.p2.18.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.18.m1.1.1.3.3" xref="S3.SS1.p2.18.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.18.m1.1.1.3.1a" xref="S3.SS1.p2.18.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.18.m1.1.1.3.4" xref="S3.SS1.p2.18.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m1.1b"><apply id="S3.SS1.p2.18.m1.1.1.cmml" xref="S3.SS1.p2.18.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m1.1.1.1.cmml" xref="S3.SS1.p2.18.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.18.m1.1.1.2.cmml" xref="S3.SS1.p2.18.m1.1.1.2">ℒ</ci><apply id="S3.SS1.p2.18.m1.1.1.3.cmml" xref="S3.SS1.p2.18.m1.1.1.3"><times id="S3.SS1.p2.18.m1.1.1.3.1.cmml" xref="S3.SS1.p2.18.m1.1.1.3.1"></times><ci id="S3.SS1.p2.18.m1.1.1.3.2.cmml" xref="S3.SS1.p2.18.m1.1.1.3.2">𝑟</ci><ci id="S3.SS1.p2.18.m1.1.1.3.3.cmml" xref="S3.SS1.p2.18.m1.1.1.3.3">𝑒</ci><ci id="S3.SS1.p2.18.m1.1.1.3.4.cmml" xref="S3.SS1.p2.18.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m1.1c">\mathcal{L}_{rec}</annotation></semantics></math> is the sum of <math id="S3.SS1.p2.19.m2.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S3.SS1.p2.19.m2.1a"><msub id="S3.SS1.p2.19.m2.1.1" xref="S3.SS1.p2.19.m2.1.1.cmml"><mi id="S3.SS1.p2.19.m2.1.1.2" xref="S3.SS1.p2.19.m2.1.1.2.cmml">l</mi><mn id="S3.SS1.p2.19.m2.1.1.3" xref="S3.SS1.p2.19.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m2.1b"><apply id="S3.SS1.p2.19.m2.1.1.cmml" xref="S3.SS1.p2.19.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m2.1.1.1.cmml" xref="S3.SS1.p2.19.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.19.m2.1.1.2.cmml" xref="S3.SS1.p2.19.m2.1.1.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.19.m2.1.1.3.cmml" xref="S3.SS1.p2.19.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m2.1c">l_{1}</annotation></semantics></math>-reconstruction losses for the values, the first (velocity) and the second derivatives (acceleration) of the reconstructed motion sequence and the ground truth. <math id="S3.SS1.p2.20.m3.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S3.SS1.p2.20.m3.1a"><mi id="S3.SS1.p2.20.m3.1.1" xref="S3.SS1.p2.20.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.20.m3.1b"><ci id="S3.SS1.p2.20.m3.1.1.cmml" xref="S3.SS1.p2.20.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.20.m3.1c">\bm{p}</annotation></semantics></math> and <math id="S3.SS1.p2.21.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p2.21.m4.1a"><mi id="S3.SS1.p2.21.m4.1.1" xref="S3.SS1.p2.21.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.21.m4.1b"><ci id="S3.SS1.p2.21.m4.1.1.cmml" xref="S3.SS1.p2.21.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.21.m4.1c">M</annotation></semantics></math> denote the ground-truth 3D joint positions and rotation matrix, respectively, while “sg” denotes “stop gradient” <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; He, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> and <math id="S3.SS1.p2.22.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS1.p2.22.m5.1a"><mi id="S3.SS1.p2.22.m5.1.1" xref="S3.SS1.p2.22.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.22.m5.1b"><ci id="S3.SS1.p2.22.m5.1.1.cmml" xref="S3.SS1.p2.22.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.22.m5.1c">\lambda</annotation></semantics></math> is the trade-off “commitment” parameter <cite class="ltx_cite ltx_citemacro_citep">(Dhariwal et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>.
The training loss of the relative translation VQ-VAE follows the same formula but only includes one reconstruction loss, specifically <math id="S3.SS1.p2.23.m6.2" class="ltx_Math" alttext="\mathcal{L}_{rec}(\bm{tr},\hat{\bm{tr}})" display="inline"><semantics id="S3.SS1.p2.23.m6.2a"><mrow id="S3.SS1.p2.23.m6.2.2" xref="S3.SS1.p2.23.m6.2.2.cmml"><msub id="S3.SS1.p2.23.m6.2.2.3" xref="S3.SS1.p2.23.m6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.23.m6.2.2.3.2" xref="S3.SS1.p2.23.m6.2.2.3.2.cmml">ℒ</mi><mrow id="S3.SS1.p2.23.m6.2.2.3.3" xref="S3.SS1.p2.23.m6.2.2.3.3.cmml"><mi id="S3.SS1.p2.23.m6.2.2.3.3.2" xref="S3.SS1.p2.23.m6.2.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.23.m6.2.2.3.3.1" xref="S3.SS1.p2.23.m6.2.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p2.23.m6.2.2.3.3.3" xref="S3.SS1.p2.23.m6.2.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.23.m6.2.2.3.3.1a" xref="S3.SS1.p2.23.m6.2.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p2.23.m6.2.2.3.3.4" xref="S3.SS1.p2.23.m6.2.2.3.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.23.m6.2.2.2" xref="S3.SS1.p2.23.m6.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.23.m6.2.2.1.1" xref="S3.SS1.p2.23.m6.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.23.m6.2.2.1.1.2" xref="S3.SS1.p2.23.m6.2.2.1.2.cmml">(</mo><mrow id="S3.SS1.p2.23.m6.2.2.1.1.1" xref="S3.SS1.p2.23.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.23.m6.2.2.1.1.1.2" xref="S3.SS1.p2.23.m6.2.2.1.1.1.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.23.m6.2.2.1.1.1.1" xref="S3.SS1.p2.23.m6.2.2.1.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.23.m6.2.2.1.1.1.3" xref="S3.SS1.p2.23.m6.2.2.1.1.1.3.cmml">𝒓</mi></mrow><mo id="S3.SS1.p2.23.m6.2.2.1.1.3" xref="S3.SS1.p2.23.m6.2.2.1.2.cmml">,</mo><mover accent="true" id="S3.SS1.p2.23.m6.1.1" xref="S3.SS1.p2.23.m6.1.1.cmml"><mrow id="S3.SS1.p2.23.m6.1.1.2" xref="S3.SS1.p2.23.m6.1.1.2.cmml"><mi id="S3.SS1.p2.23.m6.1.1.2.2" xref="S3.SS1.p2.23.m6.1.1.2.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.23.m6.1.1.2.1" xref="S3.SS1.p2.23.m6.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.23.m6.1.1.2.3" xref="S3.SS1.p2.23.m6.1.1.2.3.cmml">𝒓</mi></mrow><mo id="S3.SS1.p2.23.m6.1.1.1" xref="S3.SS1.p2.23.m6.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.SS1.p2.23.m6.2.2.1.1.4" xref="S3.SS1.p2.23.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.23.m6.2b"><apply id="S3.SS1.p2.23.m6.2.2.cmml" xref="S3.SS1.p2.23.m6.2.2"><times id="S3.SS1.p2.23.m6.2.2.2.cmml" xref="S3.SS1.p2.23.m6.2.2.2"></times><apply id="S3.SS1.p2.23.m6.2.2.3.cmml" xref="S3.SS1.p2.23.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.23.m6.2.2.3.1.cmml" xref="S3.SS1.p2.23.m6.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.23.m6.2.2.3.2.cmml" xref="S3.SS1.p2.23.m6.2.2.3.2">ℒ</ci><apply id="S3.SS1.p2.23.m6.2.2.3.3.cmml" xref="S3.SS1.p2.23.m6.2.2.3.3"><times id="S3.SS1.p2.23.m6.2.2.3.3.1.cmml" xref="S3.SS1.p2.23.m6.2.2.3.3.1"></times><ci id="S3.SS1.p2.23.m6.2.2.3.3.2.cmml" xref="S3.SS1.p2.23.m6.2.2.3.3.2">𝑟</ci><ci id="S3.SS1.p2.23.m6.2.2.3.3.3.cmml" xref="S3.SS1.p2.23.m6.2.2.3.3.3">𝑒</ci><ci id="S3.SS1.p2.23.m6.2.2.3.3.4.cmml" xref="S3.SS1.p2.23.m6.2.2.3.3.4">𝑐</ci></apply></apply><interval closure="open" id="S3.SS1.p2.23.m6.2.2.1.2.cmml" xref="S3.SS1.p2.23.m6.2.2.1.1"><apply id="S3.SS1.p2.23.m6.2.2.1.1.1.cmml" xref="S3.SS1.p2.23.m6.2.2.1.1.1"><times id="S3.SS1.p2.23.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.23.m6.2.2.1.1.1.1"></times><ci id="S3.SS1.p2.23.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.23.m6.2.2.1.1.1.2">𝒕</ci><ci id="S3.SS1.p2.23.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.23.m6.2.2.1.1.1.3">𝒓</ci></apply><apply id="S3.SS1.p2.23.m6.1.1.cmml" xref="S3.SS1.p2.23.m6.1.1"><ci id="S3.SS1.p2.23.m6.1.1.1.cmml" xref="S3.SS1.p2.23.m6.1.1.1">^</ci><apply id="S3.SS1.p2.23.m6.1.1.2.cmml" xref="S3.SS1.p2.23.m6.1.1.2"><times id="S3.SS1.p2.23.m6.1.1.2.1.cmml" xref="S3.SS1.p2.23.m6.1.1.2.1"></times><ci id="S3.SS1.p2.23.m6.1.1.2.2.cmml" xref="S3.SS1.p2.23.m6.1.1.2.2">𝒕</ci><ci id="S3.SS1.p2.23.m6.1.1.2.3.cmml" xref="S3.SS1.p2.23.m6.1.1.2.3">𝒓</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.23.m6.2c">\mathcal{L}_{rec}(\bm{tr},\hat{\bm{tr}})</annotation></semantics></math>.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2403.18811/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="373" height="192" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S3.F4.2.1" class="ltx_text ltx_font_bold">Structure of follower GPT.</span> The GPT takes ten inputs and autoregressively predicts the subsequent tokens of follower’s motion and the relative translation. Preconditions (music signals and leader’s motion) are integrated with Look-Ahead Transformers (LAT).</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Interaction Coordinate GPT</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.9" class="ltx_p"><span id="S3.SS2.p1.9.1" class="ltx_text ltx_font_bold">Formulation.</span>
With the pretrained VQ-VAE, the 3D dancing movement can be transferred into a sequence of quantized code numbers.
The goal of using GPT is to generate the follower’s dance sequence in the quantized code domain with
the maximum likelihood:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{up\heartsuit}},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{down\heartsuit}},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{lhand\heartsuit},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{rhand\heartsuit}},\bm{z}^{tr})=\operatorname*{arg\,max}_{\bm{z}}\,\mathrm{Pr}\,(\bm{z}|\bm{m},{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{up\spadesuit}}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{down\spadesuit}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{lhand\spadesuit}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{rhand\spadesuit}})." display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.5.5" xref="S3.E2.m1.2.2.1.1.5.6.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.5.5.6" xref="S3.E2.m1.2.2.1.1.5.6.cmml">(</mo><msup id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.3.1a" xref="S3.E2.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E2.m1.2.2.1.1.1.1.1.3.4" xref="S3.E2.m1.2.2.1.1.1.1.1.3.4.cmml">♡</mi></mrow></msup><mo mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.5.5.7" xref="S3.E2.m1.2.2.1.1.5.6.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.2.2.2.3.2" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.2.2.3.1" xref="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.2.2.2.3.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.2.2.3.1a" xref="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.2.2.2.3.4" xref="S3.E2.m1.2.2.1.1.2.2.2.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.2.2.3.1b" xref="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.2.2.2.3.5" xref="S3.E2.m1.2.2.1.1.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.2.2.3.1c" xref="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E2.m1.2.2.1.1.2.2.2.3.6" xref="S3.E2.m1.2.2.1.1.2.2.2.3.6.cmml">♡</mi></mrow></msup><mo mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.5.5.8" xref="S3.E2.m1.2.2.1.1.5.6.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.2" xref="S3.E2.m1.2.2.1.1.3.3.3.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.3.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.3.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.3.2" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.3.3.3.1" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.3.3.3.1a" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.3.4" xref="S3.E2.m1.2.2.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.3.3.3.1b" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.3.5" xref="S3.E2.m1.2.2.1.1.3.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.3.3.3.1c" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.3.3.3.3.6" xref="S3.E2.m1.2.2.1.1.3.3.3.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.3.3.3.1d" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E2.m1.2.2.1.1.3.3.3.3.7" xref="S3.E2.m1.2.2.1.1.3.3.3.3.7.cmml">♡</mi></mrow></msup><mo mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.5.5.9" xref="S3.E2.m1.2.2.1.1.5.6.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.4.4.4" xref="S3.E2.m1.2.2.1.1.4.4.4.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.2" xref="S3.E2.m1.2.2.1.1.4.4.4.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.4.4.4.3" xref="S3.E2.m1.2.2.1.1.4.4.4.3.cmml"><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.3.2" xref="S3.E2.m1.2.2.1.1.4.4.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.4.4.3.1" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.3.3" xref="S3.E2.m1.2.2.1.1.4.4.4.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.4.4.3.1a" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.3.4" xref="S3.E2.m1.2.2.1.1.4.4.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.4.4.3.1b" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.3.5" xref="S3.E2.m1.2.2.1.1.4.4.4.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.4.4.3.1c" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E2.m1.2.2.1.1.4.4.4.3.6" xref="S3.E2.m1.2.2.1.1.4.4.4.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.4.4.3.1d" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E2.m1.2.2.1.1.4.4.4.3.7" xref="S3.E2.m1.2.2.1.1.4.4.4.3.7.cmml">♡</mi></mrow></msup><mo id="S3.E2.m1.2.2.1.1.5.5.10" xref="S3.E2.m1.2.2.1.1.5.6.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.5.5.5" xref="S3.E2.m1.2.2.1.1.5.5.5.cmml"><mi id="S3.E2.m1.2.2.1.1.5.5.5.2" xref="S3.E2.m1.2.2.1.1.5.5.5.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.5.5.5.3" xref="S3.E2.m1.2.2.1.1.5.5.5.3.cmml"><mi id="S3.E2.m1.2.2.1.1.5.5.5.3.2" xref="S3.E2.m1.2.2.1.1.5.5.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.5.5.5.3.1" xref="S3.E2.m1.2.2.1.1.5.5.5.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.5.5.5.3.3" xref="S3.E2.m1.2.2.1.1.5.5.5.3.3.cmml">r</mi></mrow></msup><mo stretchy="false" id="S3.E2.m1.2.2.1.1.5.5.11" xref="S3.E2.m1.2.2.1.1.5.6.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.1.1.7" xref="S3.E2.m1.2.2.1.1.7.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.6" xref="S3.E2.m1.2.2.1.1.6.cmml"><mrow id="S3.E2.m1.2.2.1.1.6.3" xref="S3.E2.m1.2.2.1.1.6.3.cmml"><munder id="S3.E2.m1.2.2.1.1.6.3.1" xref="S3.E2.m1.2.2.1.1.6.3.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.6.3.1.2" xref="S3.E2.m1.2.2.1.1.6.3.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.6.3.1.2.2" xref="S3.E2.m1.2.2.1.1.6.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.3.1.2.1" xref="S3.E2.m1.2.2.1.1.6.3.1.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.6.3.1.2.3" xref="S3.E2.m1.2.2.1.1.6.3.1.2.3.cmml">max</mi></mrow><mi id="S3.E2.m1.2.2.1.1.6.3.1.3" xref="S3.E2.m1.2.2.1.1.6.3.1.3.cmml">𝒛</mi></munder><mo id="S3.E2.m1.2.2.1.1.6.3a" xref="S3.E2.m1.2.2.1.1.6.3.cmml">⁡</mo><mi id="S3.E2.m1.2.2.1.1.6.3.2" xref="S3.E2.m1.2.2.1.1.6.3.2.cmml">Pr</mi></mrow><mo lspace="0.170em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.2" xref="S3.E2.m1.2.2.1.1.6.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.6.1.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.6.1.1.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.6.1.1.1.6" xref="S3.E2.m1.2.2.1.1.6.1.1.1.6.cmml">𝒛</mi><mo fence="false" id="S3.E2.m1.2.2.1.1.6.1.1.1.5" xref="S3.E2.m1.2.2.1.1.6.1.1.1.5.cmml">|</mo><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝒎</mi><mo id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.5" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1a" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.4.cmml">♠</mi></mrow></msup><mo id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.6" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1a" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1b" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.5" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1c" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.6" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.6.cmml">♠</mi></mrow></msup><mo id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.7" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1a" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1b" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.5" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1c" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.6" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1d" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.7" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.7.cmml">♠</mi></mrow></msup><mo id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.8" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml">,</mo><msup id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.2.cmml">𝒛</mi><mrow id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.cmml"><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.2" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1a" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.4" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1b" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.5" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1c" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#0AA344" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.6" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1d" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.7" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.7.cmml">♠</mi></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.6.1.1.3" xref="S3.E2.m1.2.2.1.1.6.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.7.cmml" xref="S3.E2.m1.2.2.1.1.7"></eq><vector id="S3.E2.m1.2.2.1.1.5.6.cmml" xref="S3.E2.m1.2.2.1.1.5.5"><apply id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3"><times id="S3.E2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.2">𝑢</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3">𝑝</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.4">♡</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3"><times id="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.1"></times><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.4.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.4">𝑤</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.5.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.6.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.6">♡</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3"><times id="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.1"></times><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2">𝑙</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.3">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.4.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.5.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.6.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.6">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.7.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.7">♡</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.4.4.4.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.4.4.1.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.4.4.2.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.4.4.4.3.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3"><times id="S3.E2.m1.2.2.1.1.4.4.4.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.1"></times><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.2">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.3">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.4.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.4">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.5.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.6.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.6">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.3.7.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.3.7">♡</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.5.5.5.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.5.5.5.1.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.5.5.5.2.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.5.5.5.3.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5.3"><times id="S3.E2.m1.2.2.1.1.5.5.5.3.1.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5.3.1"></times><ci id="S3.E2.m1.2.2.1.1.5.5.5.3.2.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5.3.2">𝑡</ci><ci id="S3.E2.m1.2.2.1.1.5.5.5.3.3.cmml" xref="S3.E2.m1.2.2.1.1.5.5.5.3.3">𝑟</ci></apply></apply></vector><apply id="S3.E2.m1.2.2.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.6"><times id="S3.E2.m1.2.2.1.1.6.2.cmml" xref="S3.E2.m1.2.2.1.1.6.2"></times><apply id="S3.E2.m1.2.2.1.1.6.3.cmml" xref="S3.E2.m1.2.2.1.1.6.3"><apply id="S3.E2.m1.2.2.1.1.6.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.3.1.1.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.6.3.1.2.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1.2"><times id="S3.E2.m1.2.2.1.1.6.3.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1.2.1"></times><ci id="S3.E2.m1.2.2.1.1.6.3.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1.2.2">arg</ci><ci id="S3.E2.m1.2.2.1.1.6.3.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1.2.3">max</ci></apply><ci id="S3.E2.m1.2.2.1.1.6.3.1.3.cmml" xref="S3.E2.m1.2.2.1.1.6.3.1.3">𝒛</ci></apply><ci id="S3.E2.m1.2.2.1.1.6.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.3.2">Pr</ci></apply><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.6.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.5">conditional</csymbol><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.6">𝒛</ci><list id="S3.E2.m1.2.2.1.1.6.1.1.1.4.5.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝒎</ci><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3"><times id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.3">𝑝</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.1.1.1.3.4">♠</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3"><times id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.1"></times><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.2">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.3">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.4.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.4">𝑤</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.5.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.6.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.2.2.2.3.6">♠</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3"><times id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.1"></times><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.2">𝑙</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.3">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.4.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.5.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.6.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.6">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.7.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.3.3.3.3.7">♠</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.2">𝒛</ci><apply id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3"><times id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.1"></times><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.2.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.2">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.3.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.3">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.4.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.4">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.5.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.5">𝑛</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.6.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.6">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.7.cmml" xref="S3.E2.m1.2.2.1.1.6.1.1.1.4.4.4.3.7">♠</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{up\heartsuit}},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{down\heartsuit}},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{lhand\heartsuit},\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{rhand\heartsuit}},\bm{z}^{tr})=\operatorname*{arg\,max}_{\bm{z}}\,\mathrm{Pr}\,(\bm{z}|\bm{m},{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{up\spadesuit}}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{down\spadesuit}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{lhand\spadesuit}},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}}^{rhand\spadesuit}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.8" class="ltx_p">We use shared VQ-VAEs to generate the code sequences for the dancers. The leader’s movement is represented in green (<math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}^{\spadesuit}}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒛</mi><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">♠</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒛</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">♠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{\bm{z}^{\spadesuit}}}</annotation></semantics></math>) with notion <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\spadesuit" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">♠</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">♠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\spadesuit</annotation></semantics></math> while the follower’s movement is represented in pink (<math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{\heartsuit}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝒛</mi><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">♡</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝒛</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">♡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{\heartsuit}}</annotation></semantics></math>) with notion <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\heartsuit" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi mathvariant="normal" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">♡</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">♡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\heartsuit</annotation></semantics></math> . The generated code sequences are then decoded by <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="D_{M}({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{\heartsuit}})" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><msub id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">D</mi><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p1.5.m5.1.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS2.p1.5.m5.1.1.1.1.1.2" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2.cmml">𝒛</mi><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS2.p1.5.m5.1.1.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.1.1.3.cmml">♡</mi></msup><mo stretchy="false" id="S3.SS2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><times id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"></times><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝐷</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2">𝒛</ci><ci id="S3.SS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1.3">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">D_{M}({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{z}^{\heartsuit}})</annotation></semantics></math> to reconstruct the 3D joint rotation and drive the follower’s motion with global root position <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{q}^{\heartsuit}}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">𝒒</mi><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">♡</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝒒</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">♡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{q}^{\heartsuit}}</annotation></semantics></math> computed by <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{q}^{\heartsuit}}=D_{T}(\bm{z}^{\bm{tr}})+{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{q}^{\spadesuit}}}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><msup id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi mathcolor="#C93756" id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">𝒒</mi><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">♡</mi></msup><mo id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml"><mrow id="S3.SS2.p1.7.m7.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.cmml"><msub id="S3.SS2.p1.7.m7.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.1.1.3.2.cmml">D</mi><mi id="S3.SS2.p1.7.m7.1.1.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.1.1.3.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.3.cmml">𝒓</mi></mrow></msup><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.7.m7.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.2.cmml">+</mo><msup id="S3.SS2.p1.7.m7.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.3.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p1.7.m7.1.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.1.3.2.cmml">𝒒</mi><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p1.7.m7.1.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.1.3.3.cmml">♠</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2"></eq><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝒒</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">♡</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"><plus id="S3.SS2.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.2"></plus><apply id="S3.SS2.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1"><times id="S3.SS2.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.2"></times><apply id="S3.SS2.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3.2">𝐷</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3.3">𝑇</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2">𝒛</ci><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.2">𝒕</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.3">𝒓</ci></apply></apply></apply><apply id="S3.SS2.p1.7.m7.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3.2">𝒒</ci><ci id="S3.SS2.p1.7.m7.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3.3">♠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\bm{q}^{\heartsuit}}=D_{T}(\bm{z}^{\bm{tr}})+{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{q}^{\spadesuit}}}</annotation></semantics></math>, where <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{q}^{\spadesuit}}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">𝒒</mi><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">♠</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝒒</ci><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">♠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{q}^{\spadesuit}}</annotation></semantics></math> is the root position of the leading dancer. For more details on the follower GPT structure, refer to Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1 Quantizing Motion and Relative Translation ‣ 3 Our Approach ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.9" class="ltx_p"><span id="S3.SS2.p2.9.1" class="ltx_text ltx_font_bold">Looking-Ahead Conditions.</span>
In a duet dance, the follower needs not only to respond to the leader’s current movements but also to anticipate future changes in the dance dynamics.
To fulfill this requirement, we implement a <span id="S3.SS2.p2.9.2" class="ltx_text ltx_font_italic">look-ahead</span> mechanism that allows the GPT to be aware of future conditional signals.
Specifically, when sampling the conditional inputs (music <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bm{m}</annotation></semantics></math> and leader motion <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{z}^{\spadesuit}}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">𝒛</mi><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">♠</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝒛</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">♠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\bm{z}^{\spadesuit}}</annotation></semantics></math>), we extract an additional <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">L</annotation></semantics></math> tokens beyond the GPT’s block size <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">T</annotation></semantics></math>, leading to conditioning sequences of length (<math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="T+L" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">T</mi><mo id="S3.SS2.p2.5.m5.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.cmml">+</mo><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><plus id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1"></plus><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑇</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">T+L</annotation></semantics></math>).
These extended conditioning sequences are then processed through Look-Ahead Transformers (LAT) to derive deep embeddings, denoted as <math id="S3.SS2.p2.6.m6.4" class="ltx_Math" alttext="\widetilde{\bm{m}}=\mathrm{LAT}(m_{0,...,T+L-1})" display="inline"><semantics id="S3.SS2.p2.6.m6.4a"><mrow id="S3.SS2.p2.6.m6.4.4" xref="S3.SS2.p2.6.m6.4.4.cmml"><mover accent="true" id="S3.SS2.p2.6.m6.4.4.3" xref="S3.SS2.p2.6.m6.4.4.3.cmml"><mi id="S3.SS2.p2.6.m6.4.4.3.2" xref="S3.SS2.p2.6.m6.4.4.3.2.cmml">𝒎</mi><mo id="S3.SS2.p2.6.m6.4.4.3.1" xref="S3.SS2.p2.6.m6.4.4.3.1.cmml">~</mo></mover><mo id="S3.SS2.p2.6.m6.4.4.2" xref="S3.SS2.p2.6.m6.4.4.2.cmml">=</mo><mrow id="S3.SS2.p2.6.m6.4.4.1" xref="S3.SS2.p2.6.m6.4.4.1.cmml"><mi id="S3.SS2.p2.6.m6.4.4.1.3" xref="S3.SS2.p2.6.m6.4.4.1.3.cmml">LAT</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.4.4.1.2" xref="S3.SS2.p2.6.m6.4.4.1.2.cmml">​</mo><mrow id="S3.SS2.p2.6.m6.4.4.1.1.1" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.4.4.1.1.1.2" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.6.m6.4.4.1.1.1.1" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml"><mi id="S3.SS2.p2.6.m6.4.4.1.1.1.1.2" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p2.6.m6.3.3.3.3" xref="S3.SS2.p2.6.m6.3.3.3.4.cmml"><mn id="S3.SS2.p2.6.m6.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.cmml">0</mn><mo id="S3.SS2.p2.6.m6.3.3.3.3.2" xref="S3.SS2.p2.6.m6.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.6.m6.2.2.2.2" xref="S3.SS2.p2.6.m6.2.2.2.2.cmml">…</mi><mo id="S3.SS2.p2.6.m6.3.3.3.3.3" xref="S3.SS2.p2.6.m6.3.3.3.4.cmml">,</mo><mrow id="S3.SS2.p2.6.m6.3.3.3.3.1" xref="S3.SS2.p2.6.m6.3.3.3.3.1.cmml"><mrow id="S3.SS2.p2.6.m6.3.3.3.3.1.2" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.cmml"><mi id="S3.SS2.p2.6.m6.3.3.3.3.1.2.2" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.2.cmml">T</mi><mo id="S3.SS2.p2.6.m6.3.3.3.3.1.2.1" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.1.cmml">+</mo><mi id="S3.SS2.p2.6.m6.3.3.3.3.1.2.3" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.3.cmml">L</mi></mrow><mo id="S3.SS2.p2.6.m6.3.3.3.3.1.1" xref="S3.SS2.p2.6.m6.3.3.3.3.1.1.cmml">−</mo><mn id="S3.SS2.p2.6.m6.3.3.3.3.1.3" xref="S3.SS2.p2.6.m6.3.3.3.3.1.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S3.SS2.p2.6.m6.4.4.1.1.1.3" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.4b"><apply id="S3.SS2.p2.6.m6.4.4.cmml" xref="S3.SS2.p2.6.m6.4.4"><eq id="S3.SS2.p2.6.m6.4.4.2.cmml" xref="S3.SS2.p2.6.m6.4.4.2"></eq><apply id="S3.SS2.p2.6.m6.4.4.3.cmml" xref="S3.SS2.p2.6.m6.4.4.3"><ci id="S3.SS2.p2.6.m6.4.4.3.1.cmml" xref="S3.SS2.p2.6.m6.4.4.3.1">~</ci><ci id="S3.SS2.p2.6.m6.4.4.3.2.cmml" xref="S3.SS2.p2.6.m6.4.4.3.2">𝒎</ci></apply><apply id="S3.SS2.p2.6.m6.4.4.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1"><times id="S3.SS2.p2.6.m6.4.4.1.2.cmml" xref="S3.SS2.p2.6.m6.4.4.1.2"></times><ci id="S3.SS2.p2.6.m6.4.4.1.3.cmml" xref="S3.SS2.p2.6.m6.4.4.1.3">LAT</ci><apply id="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.2">𝑚</ci><list id="S3.SS2.p2.6.m6.3.3.3.4.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3"><cn type="integer" id="S3.SS2.p2.6.m6.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1">0</cn><ci id="S3.SS2.p2.6.m6.2.2.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2.2.2">…</ci><apply id="S3.SS2.p2.6.m6.3.3.3.3.1.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1"><minus id="S3.SS2.p2.6.m6.3.3.3.3.1.1.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.1"></minus><apply id="S3.SS2.p2.6.m6.3.3.3.3.1.2.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2"><plus id="S3.SS2.p2.6.m6.3.3.3.3.1.2.1.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.1"></plus><ci id="S3.SS2.p2.6.m6.3.3.3.3.1.2.2.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.2">𝑇</ci><ci id="S3.SS2.p2.6.m6.3.3.3.3.1.2.3.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.2.3">𝐿</ci></apply><cn type="integer" id="S3.SS2.p2.6.m6.3.3.3.3.1.3.cmml" xref="S3.SS2.p2.6.m6.3.3.3.3.1.3">1</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.4c">\widetilde{\bm{m}}=\mathrm{LAT}(m_{0,...,T+L-1})</annotation></semantics></math> and <math id="S3.SS2.p2.7.m7.4" class="ltx_Math" alttext="{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{\bm{z}}^{\spadesuit}}=\mathrm{LAT}({\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}z^{\spadesuit}}_{0,...,T+L-1})" display="inline"><semantics id="S3.SS2.p2.7.m7.4a"><mrow id="S3.SS2.p2.7.m7.4.4" xref="S3.SS2.p2.7.m7.4.4.cmml"><msup id="S3.SS2.p2.7.m7.4.4.3" xref="S3.SS2.p2.7.m7.4.4.3.cmml"><mover accent="true" id="S3.SS2.p2.7.m7.4.4.3.2" xref="S3.SS2.p2.7.m7.4.4.3.2.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p2.7.m7.4.4.3.2.2" xref="S3.SS2.p2.7.m7.4.4.3.2.2.cmml">𝒛</mi><mo mathcolor="#0AA344" id="S3.SS2.p2.7.m7.4.4.3.2.1" xref="S3.SS2.p2.7.m7.4.4.3.2.1.cmml">~</mo></mover><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p2.7.m7.4.4.3.3" xref="S3.SS2.p2.7.m7.4.4.3.3.cmml">♠</mi></msup><mo id="S3.SS2.p2.7.m7.4.4.2" xref="S3.SS2.p2.7.m7.4.4.2.cmml">=</mo><mrow id="S3.SS2.p2.7.m7.4.4.1" xref="S3.SS2.p2.7.m7.4.4.1.cmml"><mi id="S3.SS2.p2.7.m7.4.4.1.3" xref="S3.SS2.p2.7.m7.4.4.1.3.cmml">LAT</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m7.4.4.1.2" xref="S3.SS2.p2.7.m7.4.4.1.2.cmml">​</mo><mrow id="S3.SS2.p2.7.m7.4.4.1.1.1" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m7.4.4.1.1.1.2" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.SS2.p2.7.m7.4.4.1.1.1.1" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.2" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.2.cmml">z</mi><mrow id="S3.SS2.p2.7.m7.4.4.1.1.1.1a" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml"></mrow><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.3" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.3.cmml">♠</mi><mrow id="S3.SS2.p2.7.m7.3.3.3.3" xref="S3.SS2.p2.7.m7.3.3.3.4.cmml"><mn id="S3.SS2.p2.7.m7.1.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.1.cmml">0</mn><mo id="S3.SS2.p2.7.m7.3.3.3.3.2" xref="S3.SS2.p2.7.m7.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.7.m7.2.2.2.2" xref="S3.SS2.p2.7.m7.2.2.2.2.cmml">…</mi><mo id="S3.SS2.p2.7.m7.3.3.3.3.3" xref="S3.SS2.p2.7.m7.3.3.3.4.cmml">,</mo><mrow id="S3.SS2.p2.7.m7.3.3.3.3.1" xref="S3.SS2.p2.7.m7.3.3.3.3.1.cmml"><mrow id="S3.SS2.p2.7.m7.3.3.3.3.1.2" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.cmml"><mi id="S3.SS2.p2.7.m7.3.3.3.3.1.2.2" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.2.cmml">T</mi><mo id="S3.SS2.p2.7.m7.3.3.3.3.1.2.1" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.1.cmml">+</mo><mi id="S3.SS2.p2.7.m7.3.3.3.3.1.2.3" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.3.cmml">L</mi></mrow><mo id="S3.SS2.p2.7.m7.3.3.3.3.1.1" xref="S3.SS2.p2.7.m7.3.3.3.3.1.1.cmml">−</mo><mn id="S3.SS2.p2.7.m7.3.3.3.3.1.3" xref="S3.SS2.p2.7.m7.3.3.3.3.1.3.cmml">1</mn></mrow></mrow><mrow id="S3.SS2.p2.7.m7.4.4.1.1.1.1b" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml"></mrow></mmultiscripts><mo stretchy="false" id="S3.SS2.p2.7.m7.4.4.1.1.1.3" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.4b"><apply id="S3.SS2.p2.7.m7.4.4.cmml" xref="S3.SS2.p2.7.m7.4.4"><eq id="S3.SS2.p2.7.m7.4.4.2.cmml" xref="S3.SS2.p2.7.m7.4.4.2"></eq><apply id="S3.SS2.p2.7.m7.4.4.3.cmml" xref="S3.SS2.p2.7.m7.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.4.4.3.1.cmml" xref="S3.SS2.p2.7.m7.4.4.3">superscript</csymbol><apply id="S3.SS2.p2.7.m7.4.4.3.2.cmml" xref="S3.SS2.p2.7.m7.4.4.3.2"><ci id="S3.SS2.p2.7.m7.4.4.3.2.1.cmml" xref="S3.SS2.p2.7.m7.4.4.3.2.1">~</ci><ci id="S3.SS2.p2.7.m7.4.4.3.2.2.cmml" xref="S3.SS2.p2.7.m7.4.4.3.2.2">𝒛</ci></apply><ci id="S3.SS2.p2.7.m7.4.4.3.3.cmml" xref="S3.SS2.p2.7.m7.4.4.3.3">♠</ci></apply><apply id="S3.SS2.p2.7.m7.4.4.1.cmml" xref="S3.SS2.p2.7.m7.4.4.1"><times id="S3.SS2.p2.7.m7.4.4.1.2.cmml" xref="S3.SS2.p2.7.m7.4.4.1.2"></times><ci id="S3.SS2.p2.7.m7.4.4.1.3.cmml" xref="S3.SS2.p2.7.m7.4.4.1.3">LAT</ci><apply id="S3.SS2.p2.7.m7.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.2">𝑧</ci><ci id="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.7.m7.4.4.1.1.1.1.2.3">♠</ci></apply><list id="S3.SS2.p2.7.m7.3.3.3.4.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3"><cn type="integer" id="S3.SS2.p2.7.m7.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1">0</cn><ci id="S3.SS2.p2.7.m7.2.2.2.2.cmml" xref="S3.SS2.p2.7.m7.2.2.2.2">…</ci><apply id="S3.SS2.p2.7.m7.3.3.3.3.1.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1"><minus id="S3.SS2.p2.7.m7.3.3.3.3.1.1.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.1"></minus><apply id="S3.SS2.p2.7.m7.3.3.3.3.1.2.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2"><plus id="S3.SS2.p2.7.m7.3.3.3.3.1.2.1.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.1"></plus><ci id="S3.SS2.p2.7.m7.3.3.3.3.1.2.2.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.2">𝑇</ci><ci id="S3.SS2.p2.7.m7.3.3.3.3.1.2.3.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.2.3">𝐿</ci></apply><cn type="integer" id="S3.SS2.p2.7.m7.3.3.3.3.1.3.cmml" xref="S3.SS2.p2.7.m7.3.3.3.3.1.3">1</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.4c">{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{\bm{z}}^{\spadesuit}}=\mathrm{LAT}({\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}z^{\spadesuit}}_{0,...,T+L-1})</annotation></semantics></math>.
Within the LATs, we use look-ahead attention layers to propagate information from <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">L</annotation></semantics></math> future tokens to the current one, which is achieved through a banded mask of attention with a window size of <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><mi id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><ci id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">L</annotation></semantics></math>.
By incorporating future rhythms and leader movements, the GPT predicts more synchronized and stable follower dance positions.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.9" class="ltx_p"><span id="S3.SS2.p3.9.1" class="ltx_text ltx_font_bold">Interaction Coordination.</span>
After the look-ahead expansion is completed, we truncate the first <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">T</annotation></semantics></math> embeddings of <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\widetilde{\bm{m}}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mover accent="true" id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝒎</mi><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><ci id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1">~</ci><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝒎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\widetilde{\bm{m}}</annotation></semantics></math> and <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{\bm{z}}^{\spadesuit}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml"><mi mathcolor="#0AA344" id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">𝒛</mi><mo mathcolor="#0AA344" id="S3.SS2.p3.3.m3.1.1.2.1" xref="S3.SS2.p3.3.m3.1.1.2.1.cmml">~</mo></mover><mi mathcolor="#0AA344" mathvariant="normal" id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">♠</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><ci id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.1">~</ci><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">𝒛</ci></apply><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">♠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{\bm{z}}^{\spadesuit}</annotation></semantics></math>, and use them together with the follower motion <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\widetilde{\bm{z}}^{\heartsuit}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mi mathcolor="#C93756" id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">𝒛</mi><mo mathcolor="#C93756" id="S3.SS2.p3.4.m4.1.1.2.1" xref="S3.SS2.p3.4.m4.1.1.2.1.cmml">~</mo></mover><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">♡</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2"><ci id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.1">~</ci><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝒛</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">♡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\widetilde{\bm{z}}^{\heartsuit}</annotation></semantics></math> and relative translation <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="\bm{z}^{\bm{t}r}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msup id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">𝒛</mi><mrow id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝒛</ci><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><times id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝒕</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\bm{z}^{\bm{t}r}</annotation></semantics></math> indexed from <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mn id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><cn type="integer" id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">0</cn></annotation-xml></semantics></math> to <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="T-1" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">T</mi><mo id="S3.SS2.p3.7.m7.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><minus id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1"></minus><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑇</ci><cn type="integer" id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">T-1</annotation></semantics></math> as input for our model.
The GPT then incrementally generates predictions for subsequent tokens, which correspond to indices ranging from <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mn id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><cn type="integer" id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">1</annotation></semantics></math> to <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">T</annotation></semantics></math>.
Formally,</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.20" class="ltx_Math" alttext="\displaystyle\,\,\,{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}up\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}down\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}lhand\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}rhand\heartsuit}}_{1,...,T},{z}^{{tr}}_{1,...,T}" display="inline"><semantics id="S3.E3X.2.1.1.m1.20a"><mrow id="S3.E3X.2.1.1.m1.20.20.5" xref="S3.E3X.2.1.1.m1.20.20.6.cmml"><msubsup id="S3.E3X.2.1.1.m1.16.16.1.1" xref="S3.E3X.2.1.1.m1.16.16.1.1.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.16.16.1.1.2.2" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.3.3.3.5" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml"><mn id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.3.3.3.5.1" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.2.2.2.2" xref="S3.E3X.2.1.1.m1.2.2.2.2.cmml">…</mi><mo id="S3.E3X.2.1.1.m1.3.3.3.5.2" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.3.3.3.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.cmml">T</mi></mrow><mrow id="S3.E3X.2.1.1.m1.16.16.1.1.2.3" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.2" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.3" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1a" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.4" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.4.cmml">♡</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.20.20.5.6" xref="S3.E3X.2.1.1.m1.20.20.6.cmml">,</mo><msubsup id="S3.E3X.2.1.1.m1.17.17.2.2" xref="S3.E3X.2.1.1.m1.17.17.2.2.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.17.17.2.2.2.2" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.6.6.3.5" xref="S3.E3X.2.1.1.m1.6.6.3.4.cmml"><mn id="S3.E3X.2.1.1.m1.4.4.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.6.6.3.5.1" xref="S3.E3X.2.1.1.m1.6.6.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.5.5.2.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.cmml">…</mi><mo id="S3.E3X.2.1.1.m1.6.6.3.5.2" xref="S3.E3X.2.1.1.m1.6.6.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.6.6.3.3" xref="S3.E3X.2.1.1.m1.6.6.3.3.cmml">T</mi></mrow><mrow id="S3.E3X.2.1.1.m1.17.17.2.2.2.3" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.2" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.3" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1a" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.4" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1b" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.5" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1c" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.6" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.6.cmml">♡</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.20.20.5.7" xref="S3.E3X.2.1.1.m1.20.20.6.cmml">,</mo><msubsup id="S3.E3X.2.1.1.m1.18.18.3.3" xref="S3.E3X.2.1.1.m1.18.18.3.3.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.2" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.9.9.3.5" xref="S3.E3X.2.1.1.m1.9.9.3.4.cmml"><mn id="S3.E3X.2.1.1.m1.7.7.1.1" xref="S3.E3X.2.1.1.m1.7.7.1.1.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.9.9.3.5.1" xref="S3.E3X.2.1.1.m1.9.9.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.8.8.2.2" xref="S3.E3X.2.1.1.m1.8.8.2.2.cmml">…</mi><mo id="S3.E3X.2.1.1.m1.9.9.3.5.2" xref="S3.E3X.2.1.1.m1.9.9.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.9.9.3.3" xref="S3.E3X.2.1.1.m1.9.9.3.3.cmml">T</mi></mrow><mrow id="S3.E3X.2.1.1.m1.18.18.3.3.2.3" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.2" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.3" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1a" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.4" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1b" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.5" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1c" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.6" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1d" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.7" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.7.cmml">♡</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.20.20.5.8" xref="S3.E3X.2.1.1.m1.20.20.6.cmml">,</mo><msubsup id="S3.E3X.2.1.1.m1.19.19.4.4" xref="S3.E3X.2.1.1.m1.19.19.4.4.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.2" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.12.12.3.5" xref="S3.E3X.2.1.1.m1.12.12.3.4.cmml"><mn id="S3.E3X.2.1.1.m1.10.10.1.1" xref="S3.E3X.2.1.1.m1.10.10.1.1.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.12.12.3.5.1" xref="S3.E3X.2.1.1.m1.12.12.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.11.11.2.2" xref="S3.E3X.2.1.1.m1.11.11.2.2.cmml">…</mi><mo id="S3.E3X.2.1.1.m1.12.12.3.5.2" xref="S3.E3X.2.1.1.m1.12.12.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.12.12.3.3" xref="S3.E3X.2.1.1.m1.12.12.3.3.cmml">T</mi></mrow><mrow id="S3.E3X.2.1.1.m1.19.19.4.4.2.3" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.cmml"><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.2" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.3" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1a" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.4" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1b" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.5" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1c" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.6" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1d" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.7" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.7.cmml">♡</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.20.20.5.9" xref="S3.E3X.2.1.1.m1.20.20.6.cmml">,</mo><msubsup id="S3.E3X.2.1.1.m1.20.20.5.5" xref="S3.E3X.2.1.1.m1.20.20.5.5.cmml"><mi id="S3.E3X.2.1.1.m1.20.20.5.5.2.2" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.15.15.3.5" xref="S3.E3X.2.1.1.m1.15.15.3.4.cmml"><mn id="S3.E3X.2.1.1.m1.13.13.1.1" xref="S3.E3X.2.1.1.m1.13.13.1.1.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.15.15.3.5.1" xref="S3.E3X.2.1.1.m1.15.15.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.14.14.2.2" xref="S3.E3X.2.1.1.m1.14.14.2.2.cmml">…</mi><mo id="S3.E3X.2.1.1.m1.15.15.3.5.2" xref="S3.E3X.2.1.1.m1.15.15.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.15.15.3.3" xref="S3.E3X.2.1.1.m1.15.15.3.3.cmml">T</mi></mrow><mrow id="S3.E3X.2.1.1.m1.20.20.5.5.2.3" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.2" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.1" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.3" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.3.cmml">r</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.20b"><list id="S3.E3X.2.1.1.m1.20.20.6.cmml" xref="S3.E3X.2.1.1.m1.20.20.5"><apply id="S3.E3X.2.1.1.m1.16.16.1.1.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.16.16.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.16.16.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.16.16.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.16.16.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3"><times id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.2">𝑢</ci><ci id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.3">𝑝</ci><ci id="S3.E3X.2.1.1.m1.16.16.1.1.2.3.4.cmml" xref="S3.E3X.2.1.1.m1.16.16.1.1.2.3.4">♡</ci></apply></apply><list id="S3.E3X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.5"><cn type="integer" id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1">1</cn><ci id="S3.E3X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2">…</ci><ci id="S3.E3X.2.1.1.m1.3.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3">𝑇</ci></list></apply><apply id="S3.E3X.2.1.1.m1.17.17.2.2.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.17.17.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.17.17.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.17.17.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3"><times id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.2">𝑑</ci><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.3">𝑜</ci><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.4.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.4">𝑤</ci><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.5.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.5">𝑛</ci><ci id="S3.E3X.2.1.1.m1.17.17.2.2.2.3.6.cmml" xref="S3.E3X.2.1.1.m1.17.17.2.2.2.3.6">♡</ci></apply></apply><list id="S3.E3X.2.1.1.m1.6.6.3.4.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.5"><cn type="integer" id="S3.E3X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1">1</cn><ci id="S3.E3X.2.1.1.m1.5.5.2.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2">…</ci><ci id="S3.E3X.2.1.1.m1.6.6.3.3.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.3">𝑇</ci></list></apply><apply id="S3.E3X.2.1.1.m1.18.18.3.3.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.18.18.3.3.1.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.18.18.3.3.2.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.18.18.3.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.2.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3"><times id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.2">𝑙</ci><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.3">ℎ</ci><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.4.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.4">𝑎</ci><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.5.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.5">𝑛</ci><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.6.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.6">𝑑</ci><ci id="S3.E3X.2.1.1.m1.18.18.3.3.2.3.7.cmml" xref="S3.E3X.2.1.1.m1.18.18.3.3.2.3.7">♡</ci></apply></apply><list id="S3.E3X.2.1.1.m1.9.9.3.4.cmml" xref="S3.E3X.2.1.1.m1.9.9.3.5"><cn type="integer" id="S3.E3X.2.1.1.m1.7.7.1.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.1.1">1</cn><ci id="S3.E3X.2.1.1.m1.8.8.2.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.2.2">…</ci><ci id="S3.E3X.2.1.1.m1.9.9.3.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.3.3">𝑇</ci></list></apply><apply id="S3.E3X.2.1.1.m1.19.19.4.4.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.19.19.4.4.1.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.19.19.4.4.2.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.19.19.4.4.2.1.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.2.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3"><times id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.2">𝑟</ci><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.3">ℎ</ci><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.4.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.4">𝑎</ci><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.5.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.5">𝑛</ci><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.6.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.6">𝑑</ci><ci id="S3.E3X.2.1.1.m1.19.19.4.4.2.3.7.cmml" xref="S3.E3X.2.1.1.m1.19.19.4.4.2.3.7">♡</ci></apply></apply><list id="S3.E3X.2.1.1.m1.12.12.3.4.cmml" xref="S3.E3X.2.1.1.m1.12.12.3.5"><cn type="integer" id="S3.E3X.2.1.1.m1.10.10.1.1.cmml" xref="S3.E3X.2.1.1.m1.10.10.1.1">1</cn><ci id="S3.E3X.2.1.1.m1.11.11.2.2.cmml" xref="S3.E3X.2.1.1.m1.11.11.2.2">…</ci><ci id="S3.E3X.2.1.1.m1.12.12.3.3.cmml" xref="S3.E3X.2.1.1.m1.12.12.3.3">𝑇</ci></list></apply><apply id="S3.E3X.2.1.1.m1.20.20.5.5.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.20.20.5.5.1.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.20.20.5.5.2.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.20.20.5.5.2.1.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.20.20.5.5.2.2.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3"><times id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.2">𝑡</ci><ci id="S3.E3X.2.1.1.m1.20.20.5.5.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.20.20.5.5.2.3.3">𝑟</ci></apply></apply><list id="S3.E3X.2.1.1.m1.15.15.3.4.cmml" xref="S3.E3X.2.1.1.m1.15.15.3.5"><cn type="integer" id="S3.E3X.2.1.1.m1.13.13.1.1.cmml" xref="S3.E3X.2.1.1.m1.13.13.1.1">1</cn><ci id="S3.E3X.2.1.1.m1.14.14.2.2.cmml" xref="S3.E3X.2.1.1.m1.14.14.2.2">…</ci><ci id="S3.E3X.2.1.1.m1.15.15.3.3.cmml" xref="S3.E3X.2.1.1.m1.15.15.3.3">𝑇</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.20c">\displaystyle\,\,\,{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}up\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}down\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}lhand\heartsuit}}_{1,...,T},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}rhand\heartsuit}}_{1,...,T},{z}^{{tr}}_{1,...,T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E3Xa.2.1.1.m1.1a"><mo id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><eq id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.3.2.2.m1.15" class="ltx_math_unparsed" alttext="\displaystyle\,\,\,\mathrm{GPT}(\widetilde{m}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}up\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}down\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}lhand\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}rhand\spadesuit}}_{0,...,T-1}," display="inline"><semantics id="S3.E3Xa.3.2.2.m1.15a"><mrow id="S3.E3Xa.3.2.2.m1.15b"><mi id="S3.E3Xa.3.2.2.m1.15.16">GPT</mi><mrow id="S3.E3Xa.3.2.2.m1.15.17"><mo stretchy="false" id="S3.E3Xa.3.2.2.m1.15.17.1">(</mo><msub id="S3.E3Xa.3.2.2.m1.15.17.2"><mover accent="true" id="S3.E3Xa.3.2.2.m1.15.17.2.2"><mi id="S3.E3Xa.3.2.2.m1.15.17.2.2.2">m</mi><mo id="S3.E3Xa.3.2.2.m1.15.17.2.2.1">~</mo></mover><mrow id="S3.E3Xa.3.2.2.m1.3.3.3.3"><mn id="S3.E3Xa.3.2.2.m1.1.1.1.1">0</mn><mo id="S3.E3Xa.3.2.2.m1.3.3.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xa.3.2.2.m1.2.2.2.2">…</mi><mo id="S3.E3Xa.3.2.2.m1.3.3.3.3.3">,</mo><mrow id="S3.E3Xa.3.2.2.m1.3.3.3.3.1"><mi id="S3.E3Xa.3.2.2.m1.3.3.3.3.1.2">T</mi><mo id="S3.E3Xa.3.2.2.m1.3.3.3.3.1.1">−</mo><mn id="S3.E3Xa.3.2.2.m1.3.3.3.3.1.3">1</mn></mrow></mrow></msub><mo id="S3.E3Xa.3.2.2.m1.15.17.3">,</mo><msubsup id="S3.E3Xa.3.2.2.m1.15.17.4"><mover accent="true" id="S3.E3Xa.3.2.2.m1.15.17.4.2.2"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.4.2.2.2">z</mi><mo mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.4.2.2.1">~</mo></mover><mrow id="S3.E3Xa.3.2.2.m1.6.6.3.3"><mn id="S3.E3Xa.3.2.2.m1.4.4.1.1">0</mn><mo id="S3.E3Xa.3.2.2.m1.6.6.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xa.3.2.2.m1.5.5.2.2">…</mi><mo id="S3.E3Xa.3.2.2.m1.6.6.3.3.3">,</mo><mrow id="S3.E3Xa.3.2.2.m1.6.6.3.3.1"><mi id="S3.E3Xa.3.2.2.m1.6.6.3.3.1.2">T</mi><mo id="S3.E3Xa.3.2.2.m1.6.6.3.3.1.1">−</mo><mn id="S3.E3Xa.3.2.2.m1.6.6.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xa.3.2.2.m1.15.17.4.2.3"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.4.2.3.2">u</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.4.2.3.1">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.4.2.3.3">p</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.4.2.3.1a">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E3Xa.3.2.2.m1.15.17.4.2.3.4">♠</mi></mrow></msubsup><mo id="S3.E3Xa.3.2.2.m1.15.17.5">,</mo><msubsup id="S3.E3Xa.3.2.2.m1.15.17.6"><mover accent="true" id="S3.E3Xa.3.2.2.m1.15.17.6.2.2"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.2.2">z</mi><mo mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.2.1">~</mo></mover><mrow id="S3.E3Xa.3.2.2.m1.9.9.3.3"><mn id="S3.E3Xa.3.2.2.m1.7.7.1.1">0</mn><mo id="S3.E3Xa.3.2.2.m1.9.9.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xa.3.2.2.m1.8.8.2.2">…</mi><mo id="S3.E3Xa.3.2.2.m1.9.9.3.3.3">,</mo><mrow id="S3.E3Xa.3.2.2.m1.9.9.3.3.1"><mi id="S3.E3Xa.3.2.2.m1.9.9.3.3.1.2">T</mi><mo id="S3.E3Xa.3.2.2.m1.9.9.3.3.1.1">−</mo><mn id="S3.E3Xa.3.2.2.m1.9.9.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xa.3.2.2.m1.15.17.6.2.3"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.2">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.1">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.1a">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.4">w</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.1b">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.1c">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E3Xa.3.2.2.m1.15.17.6.2.3.6">♠</mi></mrow></msubsup><mo id="S3.E3Xa.3.2.2.m1.15.17.7">,</mo><msubsup id="S3.E3Xa.3.2.2.m1.15.17.8"><mover accent="true" id="S3.E3Xa.3.2.2.m1.15.17.8.2.2"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.2.2">z</mi><mo mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.2.1">~</mo></mover><mrow id="S3.E3Xa.3.2.2.m1.12.12.3.3"><mn id="S3.E3Xa.3.2.2.m1.10.10.1.1">0</mn><mo id="S3.E3Xa.3.2.2.m1.12.12.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xa.3.2.2.m1.11.11.2.2">…</mi><mo id="S3.E3Xa.3.2.2.m1.12.12.3.3.3">,</mo><mrow id="S3.E3Xa.3.2.2.m1.12.12.3.3.1"><mi id="S3.E3Xa.3.2.2.m1.12.12.3.3.1.2">T</mi><mo id="S3.E3Xa.3.2.2.m1.12.12.3.3.1.1">−</mo><mn id="S3.E3Xa.3.2.2.m1.12.12.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xa.3.2.2.m1.15.17.8.2.3"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.2">l</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.1">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.3">h</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.1a">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.4">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.1b">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.1c">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.6">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.1d">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E3Xa.3.2.2.m1.15.17.8.2.3.7">♠</mi></mrow></msubsup><mo id="S3.E3Xa.3.2.2.m1.15.17.9">,</mo><msubsup id="S3.E3Xa.3.2.2.m1.15.17.10"><mover accent="true" id="S3.E3Xa.3.2.2.m1.15.17.10.2.2"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.2.2">z</mi><mo mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.2.1">~</mo></mover><mrow id="S3.E3Xa.3.2.2.m1.15.15.3.3"><mn id="S3.E3Xa.3.2.2.m1.13.13.1.1">0</mn><mo id="S3.E3Xa.3.2.2.m1.15.15.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xa.3.2.2.m1.14.14.2.2">…</mi><mo id="S3.E3Xa.3.2.2.m1.15.15.3.3.3">,</mo><mrow id="S3.E3Xa.3.2.2.m1.15.15.3.3.1"><mi id="S3.E3Xa.3.2.2.m1.15.15.3.3.1.2">T</mi><mo id="S3.E3Xa.3.2.2.m1.15.15.3.3.1.1">−</mo><mn id="S3.E3Xa.3.2.2.m1.15.15.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xa.3.2.2.m1.15.17.10.2.3"><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.2">r</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.1">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.3">h</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.1a">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.4">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.1b">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.1c">​</mo><mi mathcolor="#0AA344" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.6">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.1d">​</mo><mi mathcolor="#0AA344" mathvariant="normal" id="S3.E3Xa.3.2.2.m1.15.17.10.2.3.7">♠</mi></mrow></msubsup><mo id="S3.E3Xa.3.2.2.m1.15.17.11">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3Xa.3.2.2.m1.15c">\displaystyle\,\,\,\mathrm{GPT}(\widetilde{m}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}up\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}down\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}lhand\spadesuit}}_{0,...,T-1},{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}\widetilde{z}}^{{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}rhand\spadesuit}}_{0,...,T-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.2.1.1.m1.15" class="ltx_math_unparsed" alttext="\displaystyle\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}up\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}down\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}lhand\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}rhand\heartsuit}}_{0,...,T-1},{z}^{{tr}}_{0,...,T-1})." display="inline"><semantics id="S3.E3Xb.2.1.1.m1.15a"><mrow id="S3.E3Xb.2.1.1.m1.15b"><msubsup id="S3.E3Xb.2.1.1.m1.15.16"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.16.2.2">z</mi><mrow id="S3.E3Xb.2.1.1.m1.3.3.3.3"><mn id="S3.E3Xb.2.1.1.m1.1.1.1.1">0</mn><mo id="S3.E3Xb.2.1.1.m1.3.3.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xb.2.1.1.m1.2.2.2.2">…</mi><mo id="S3.E3Xb.2.1.1.m1.3.3.3.3.3">,</mo><mrow id="S3.E3Xb.2.1.1.m1.3.3.3.3.1"><mi id="S3.E3Xb.2.1.1.m1.3.3.3.3.1.2">T</mi><mo id="S3.E3Xb.2.1.1.m1.3.3.3.3.1.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.3.3.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xb.2.1.1.m1.15.16.2.3"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.16.2.3.2">u</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.16.2.3.1">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.16.2.3.3">p</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.16.2.3.1a">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3Xb.2.1.1.m1.15.16.2.3.4">♡</mi></mrow></msubsup><mo id="S3.E3Xb.2.1.1.m1.15.17">,</mo><msubsup id="S3.E3Xb.2.1.1.m1.15.18"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.18.2.2">z</mi><mrow id="S3.E3Xb.2.1.1.m1.6.6.3.3"><mn id="S3.E3Xb.2.1.1.m1.4.4.1.1">0</mn><mo id="S3.E3Xb.2.1.1.m1.6.6.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xb.2.1.1.m1.5.5.2.2">…</mi><mo id="S3.E3Xb.2.1.1.m1.6.6.3.3.3">,</mo><mrow id="S3.E3Xb.2.1.1.m1.6.6.3.3.1"><mi id="S3.E3Xb.2.1.1.m1.6.6.3.3.1.2">T</mi><mo id="S3.E3Xb.2.1.1.m1.6.6.3.3.1.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.6.6.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xb.2.1.1.m1.15.18.2.3"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.18.2.3.2">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.18.2.3.1">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.18.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.18.2.3.1a">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.18.2.3.4">w</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.18.2.3.1b">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.18.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.18.2.3.1c">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3Xb.2.1.1.m1.15.18.2.3.6">♡</mi></mrow></msubsup><mo id="S3.E3Xb.2.1.1.m1.15.19">,</mo><msubsup id="S3.E3Xb.2.1.1.m1.15.20"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.2">z</mi><mrow id="S3.E3Xb.2.1.1.m1.9.9.3.3"><mn id="S3.E3Xb.2.1.1.m1.7.7.1.1">0</mn><mo id="S3.E3Xb.2.1.1.m1.9.9.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xb.2.1.1.m1.8.8.2.2">…</mi><mo id="S3.E3Xb.2.1.1.m1.9.9.3.3.3">,</mo><mrow id="S3.E3Xb.2.1.1.m1.9.9.3.3.1"><mi id="S3.E3Xb.2.1.1.m1.9.9.3.3.1.2">T</mi><mo id="S3.E3Xb.2.1.1.m1.9.9.3.3.1.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.9.9.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xb.2.1.1.m1.15.20.2.3"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.3.2">l</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.20.2.3.1">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.3.3">h</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.20.2.3.1a">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.3.4">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.20.2.3.1b">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.20.2.3.1c">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.20.2.3.6">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.20.2.3.1d">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3Xb.2.1.1.m1.15.20.2.3.7">♡</mi></mrow></msubsup><mo id="S3.E3Xb.2.1.1.m1.15.21">,</mo><msubsup id="S3.E3Xb.2.1.1.m1.15.22"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.2">z</mi><mrow id="S3.E3Xb.2.1.1.m1.12.12.3.3"><mn id="S3.E3Xb.2.1.1.m1.10.10.1.1">0</mn><mo id="S3.E3Xb.2.1.1.m1.12.12.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xb.2.1.1.m1.11.11.2.2">…</mi><mo id="S3.E3Xb.2.1.1.m1.12.12.3.3.3">,</mo><mrow id="S3.E3Xb.2.1.1.m1.12.12.3.3.1"><mi id="S3.E3Xb.2.1.1.m1.12.12.3.3.1.2">T</mi><mo id="S3.E3Xb.2.1.1.m1.12.12.3.3.1.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.12.12.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xb.2.1.1.m1.15.22.2.3"><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.3.2">r</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.22.2.3.1">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.3.3">h</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.22.2.3.1a">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.3.4">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.22.2.3.1b">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.3.5">n</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.22.2.3.1c">​</mo><mi mathcolor="#C93756" id="S3.E3Xb.2.1.1.m1.15.22.2.3.6">d</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.22.2.3.1d">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.E3Xb.2.1.1.m1.15.22.2.3.7">♡</mi></mrow></msubsup><mo id="S3.E3Xb.2.1.1.m1.15.23">,</mo><msubsup id="S3.E3Xb.2.1.1.m1.15.24"><mi id="S3.E3Xb.2.1.1.m1.15.24.2.2">z</mi><mrow id="S3.E3Xb.2.1.1.m1.15.15.3.3"><mn id="S3.E3Xb.2.1.1.m1.13.13.1.1">0</mn><mo id="S3.E3Xb.2.1.1.m1.15.15.3.3.2">,</mo><mi mathvariant="normal" id="S3.E3Xb.2.1.1.m1.14.14.2.2">…</mi><mo id="S3.E3Xb.2.1.1.m1.15.15.3.3.3">,</mo><mrow id="S3.E3Xb.2.1.1.m1.15.15.3.3.1"><mi id="S3.E3Xb.2.1.1.m1.15.15.3.3.1.2">T</mi><mo id="S3.E3Xb.2.1.1.m1.15.15.3.3.1.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.15.15.3.3.1.3">1</mn></mrow></mrow><mrow id="S3.E3Xb.2.1.1.m1.15.24.2.3"><mi id="S3.E3Xb.2.1.1.m1.15.24.2.3.2">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.15.24.2.3.1">​</mo><mi id="S3.E3Xb.2.1.1.m1.15.24.2.3.3">r</mi></mrow></msubsup><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.15.25">)</mo><mo lspace="0em" id="S3.E3Xb.2.1.1.m1.15.26">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.15c">\displaystyle\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}up\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}down\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}lhand\heartsuit}}_{0,...,T-1},{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}z}^{{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}rhand\heartsuit}}_{0,...,T-1},{z}^{{tr}}_{0,...,T-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p3.10" class="ltx_p">To effectively integrate the information of the 10 input items in Equation <a href="#S3.E3" title="In 3.2 Interaction Coordinate GPT ‣ 3 Our Approach ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we use a 10-by-10 block-wise lower-triangular matrix as the mask of interaction-coordinated attention.
Since the lower triangular matrix masks off the future information, this preserves the causal order of inference, ensuring that past tokens do not have access to future ones, and maintain the integrity and coherence of these items during the prediction process.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Off-Policy GPT Reinforcement Learning</h3>

<figure id="S3.F5" class="ltx_figure"><img src="/html/2403.18811/assets/x5.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="373" height="163" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S3.F5.6.1" class="ltx_text ltx_font_bold">GPT’s supervised training (a) <span id="S3.F5.6.1.1" class="ltx_text ltx_font_italic">vs</span> off-policy RL stage (b).</span> For ST, supervising labels are sequences <math id="S3.F5.3.m1.1" class="ltx_Math" alttext="\{\bm{z}\}" display="inline"><semantics id="S3.F5.3.m1.1b"><mrow id="S3.F5.3.m1.1.2.2" xref="S3.F5.3.m1.1.2.1.cmml"><mo stretchy="false" id="S3.F5.3.m1.1.2.2.1" xref="S3.F5.3.m1.1.2.1.cmml">{</mo><mi id="S3.F5.3.m1.1.1" xref="S3.F5.3.m1.1.1.cmml">𝒛</mi><mo stretchy="false" id="S3.F5.3.m1.1.2.2.2" xref="S3.F5.3.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F5.3.m1.1c"><set id="S3.F5.3.m1.1.2.1.cmml" xref="S3.F5.3.m1.1.2.2"><ci id="S3.F5.3.m1.1.1.cmml" xref="S3.F5.3.m1.1.1">𝒛</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.3.m1.1d">\{\bm{z}\}</annotation></semantics></math> quantized from the in-domain data in training set. In RL stage, network weight is optimized based on human-defined rewards (scores) on GPT’s generated samples <math id="S3.F5.4.m2.1" class="ltx_Math" alttext="\{\hat{\bm{z}}\}" display="inline"><semantics id="S3.F5.4.m2.1b"><mrow id="S3.F5.4.m2.1.2.2" xref="S3.F5.4.m2.1.2.1.cmml"><mo stretchy="false" id="S3.F5.4.m2.1.2.2.1" xref="S3.F5.4.m2.1.2.1.cmml">{</mo><mover accent="true" id="S3.F5.4.m2.1.1" xref="S3.F5.4.m2.1.1.cmml"><mi id="S3.F5.4.m2.1.1.2" xref="S3.F5.4.m2.1.1.2.cmml">𝒛</mi><mo id="S3.F5.4.m2.1.1.1" xref="S3.F5.4.m2.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.F5.4.m2.1.2.2.2" xref="S3.F5.4.m2.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F5.4.m2.1c"><set id="S3.F5.4.m2.1.2.1.cmml" xref="S3.F5.4.m2.1.2.2"><apply id="S3.F5.4.m2.1.1.cmml" xref="S3.F5.4.m2.1.1"><ci id="S3.F5.4.m2.1.1.1.cmml" xref="S3.F5.4.m2.1.1.1">^</ci><ci id="S3.F5.4.m2.1.1.2.cmml" xref="S3.F5.4.m2.1.1.2">𝒛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.4.m2.1d">\{\hat{\bm{z}}\}</annotation></semantics></math> on OOD conditions.</figcaption>
</figure>
<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Although GPT is powerful, it is still prone to generate unsatisfactory results when confronted with <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">out-of-distribution</span> (OOD) scenarios.
In our task, specifically, when the leader presents unseen motion patterns, the follower may displace to response without proper foot steps thus yielding skating artifacts.
To better adapt GPT models to this challenge, we employ an off-policy reinforcement learning (RL) to finetune the network.
Unlike the supervised training stage, there is no ground truth labels to regress in RL stage.
As shown in Figure <a href="#S3.F5" title="Figure 5 ‣ 3.3 Off-Policy GPT Reinforcement Learning ‣ 3 Our Approach ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, for RL, the inputs of GPT model are code sequences <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\{\hat{\bm{z}}\}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.2.2.1" xref="S3.SS3.p1.1.m1.1.2.1.cmml">{</mo><mover accent="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">𝒛</mi><mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.SS3.p1.1.m1.1.2.2.2" xref="S3.SS3.p1.1.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><set id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">^</ci><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝒛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\{\hat{\bm{z}}\}</annotation></semantics></math> generated by the GPT itself on OOD conditions, either using the current network weight or the past ones.
The network weight is then optimized according to a loss based on human-defined rewards.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.10" class="ltx_p">From an RL standpoint, the act of predicting the next token at step <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">t</annotation></semantics></math> is construed as an <span id="S3.SS3.p2.10.1" class="ltx_text ltx_font_italic">action</span> <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">a</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑎</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">a_{t}</annotation></semantics></math>, which involves selecting an appropriate token <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="z_{t+1}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">z</mi><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑧</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><plus id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></plus><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">z_{t+1}</annotation></semantics></math> from the dictionary.
Concurrently, the GPT model with weight <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\theta</annotation></semantics></math> is considered a policy network <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">π</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝜋</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\pi_{\theta}</annotation></semantics></math> that predicts a probability distribution <math id="S3.SS3.p2.6.m6.1" class="ltx_math_unparsed" alttext="\pi_{\theta}(\cdot|s_{t})" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1b"><msub id="S3.SS3.p2.6.m6.1.1"><mi id="S3.SS3.p2.6.m6.1.1.2">π</mi><mi id="S3.SS3.p2.6.m6.1.1.3">θ</mi></msub><mrow id="S3.SS3.p2.6.m6.1.2"><mo stretchy="false" id="S3.SS3.p2.6.m6.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.2.2">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.6.m6.1.2.3">|</mo><msub id="S3.SS3.p2.6.m6.1.2.4"><mi id="S3.SS3.p2.6.m6.1.2.4.2">s</mi><mi id="S3.SS3.p2.6.m6.1.2.4.3">t</mi></msub><mo stretchy="false" id="S3.SS3.p2.6.m6.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\pi_{\theta}(\cdot|s_{t})</annotation></semantics></math> for each candidate <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="k\in\mathcal{Z}" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><in id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1"></in><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝑘</ci><ci id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">k\in\mathcal{Z}</annotation></semantics></math> at step <math id="S3.SS3.p2.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p2.8.m8.1a"><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">t</annotation></semantics></math>, with the state <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="s_{t}" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">s</mi><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑠</ci><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">s_{t}</annotation></semantics></math> perceived as the preceding sequence <math id="S3.SS3.p2.10.m10.4" class="ltx_Math" alttext="\{z_{0},z_{1},...,z_{t}\}" display="inline"><semantics id="S3.SS3.p2.10.m10.4a"><mrow id="S3.SS3.p2.10.m10.4.4.3" xref="S3.SS3.p2.10.m10.4.4.4.cmml"><mo stretchy="false" id="S3.SS3.p2.10.m10.4.4.3.4" xref="S3.SS3.p2.10.m10.4.4.4.cmml">{</mo><msub id="S3.SS3.p2.10.m10.2.2.1.1" xref="S3.SS3.p2.10.m10.2.2.1.1.cmml"><mi id="S3.SS3.p2.10.m10.2.2.1.1.2" xref="S3.SS3.p2.10.m10.2.2.1.1.2.cmml">z</mi><mn id="S3.SS3.p2.10.m10.2.2.1.1.3" xref="S3.SS3.p2.10.m10.2.2.1.1.3.cmml">0</mn></msub><mo id="S3.SS3.p2.10.m10.4.4.3.5" xref="S3.SS3.p2.10.m10.4.4.4.cmml">,</mo><msub id="S3.SS3.p2.10.m10.3.3.2.2" xref="S3.SS3.p2.10.m10.3.3.2.2.cmml"><mi id="S3.SS3.p2.10.m10.3.3.2.2.2" xref="S3.SS3.p2.10.m10.3.3.2.2.2.cmml">z</mi><mn id="S3.SS3.p2.10.m10.3.3.2.2.3" xref="S3.SS3.p2.10.m10.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p2.10.m10.4.4.3.6" xref="S3.SS3.p2.10.m10.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">…</mi><mo id="S3.SS3.p2.10.m10.4.4.3.7" xref="S3.SS3.p2.10.m10.4.4.4.cmml">,</mo><msub id="S3.SS3.p2.10.m10.4.4.3.3" xref="S3.SS3.p2.10.m10.4.4.3.3.cmml"><mi id="S3.SS3.p2.10.m10.4.4.3.3.2" xref="S3.SS3.p2.10.m10.4.4.3.3.2.cmml">z</mi><mi id="S3.SS3.p2.10.m10.4.4.3.3.3" xref="S3.SS3.p2.10.m10.4.4.3.3.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS3.p2.10.m10.4.4.3.8" xref="S3.SS3.p2.10.m10.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.4b"><set id="S3.SS3.p2.10.m10.4.4.4.cmml" xref="S3.SS3.p2.10.m10.4.4.3"><apply id="S3.SS3.p2.10.m10.2.2.1.1.cmml" xref="S3.SS3.p2.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.2.2.1.1.1.cmml" xref="S3.SS3.p2.10.m10.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.2.2.1.1.2.cmml" xref="S3.SS3.p2.10.m10.2.2.1.1.2">𝑧</ci><cn type="integer" id="S3.SS3.p2.10.m10.2.2.1.1.3.cmml" xref="S3.SS3.p2.10.m10.2.2.1.1.3">0</cn></apply><apply id="S3.SS3.p2.10.m10.3.3.2.2.cmml" xref="S3.SS3.p2.10.m10.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.3.3.2.2.1.cmml" xref="S3.SS3.p2.10.m10.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.10.m10.3.3.2.2.2.cmml" xref="S3.SS3.p2.10.m10.3.3.2.2.2">𝑧</ci><cn type="integer" id="S3.SS3.p2.10.m10.3.3.2.2.3.cmml" xref="S3.SS3.p2.10.m10.3.3.2.2.3">1</cn></apply><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">…</ci><apply id="S3.SS3.p2.10.m10.4.4.3.3.cmml" xref="S3.SS3.p2.10.m10.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.4.4.3.3.1.cmml" xref="S3.SS3.p2.10.m10.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p2.10.m10.4.4.3.3.2.cmml" xref="S3.SS3.p2.10.m10.4.4.3.3.2">𝑧</ci><ci id="S3.SS3.p2.10.m10.4.4.3.3.3.cmml" xref="S3.SS3.p2.10.m10.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.4c">\{z_{0},z_{1},...,z_{t}\}</annotation></semantics></math>.
At present, a majority of the publicly documented RL implementations <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a href="#bib.bib36" title="" class="ltx_ref">2022</a>; Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>
for GPT employ on-policy actor-critic (AC) strategy, where the update of the policy network hinges on the sequences generated by the <span id="S3.SS3.p2.10.2" class="ltx_text ltx_font_italic">current</span> GPT weight.
Basically, AC uses a loss function as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\mathcal{L}^{\mathrm{o}n}_{AC}(\theta)=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(\hat{a}_{t}^{\theta}|\hat{s}^{\theta}_{t})\right)\cdot A," display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><msubsup id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.3.2.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.cmml">ℒ</mi><mrow id="S3.E4.m1.3.3.1.1.3.2.3" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.2.3.1" xref="S3.E4.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.3.2.3.3" xref="S3.E4.m1.3.3.1.1.3.2.3.3.cmml">C</mi></mrow><mrow id="S3.E4.m1.3.3.1.1.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.3.cmml"><mi mathvariant="normal" id="S3.E4.m1.3.3.1.1.3.2.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.2.2.3.1" xref="S3.E4.m1.3.3.1.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.3.2.2.3.3" xref="S3.E4.m1.3.3.1.1.3.2.2.3.3.cmml">n</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.1" xref="S3.E4.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.3.2.1" xref="S3.E4.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><munderover id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.3.3.1.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.1.3.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.1.1.1.3.2.3" xref="S3.E4.m1.3.3.1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3.2.3.2" xref="S3.E4.m1.3.3.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.1.3.2.3.1" xref="S3.E4.m1.3.3.1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.E4.m1.3.3.1.1.1.3.2.3.3" xref="S3.E4.m1.3.3.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="S3.E4.m1.3.3.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.1.3.3.2.cmml">T</mi><mo id="S3.E4.m1.3.3.1.1.1.3.3.1" xref="S3.E4.m1.3.3.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.1.1.1.3.3.3" xref="S3.E4.m1.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></munderover><mo lspace="0em" id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">log</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1a" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo fence="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">s</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msubsup></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">⋅</mo><mi id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml">A</mi></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"></eq><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><times id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1"></times><apply id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2">ℒ</ci><apply id="S3.E4.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3"><times id="S3.E4.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3.2">o</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3.3">𝑛</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3"><times id="S3.E4.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3.2">𝐴</ci><ci id="S3.E4.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3.3">𝐶</ci></apply></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝜃</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><minus id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"></minus><apply id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3">subscript</csymbol><sum id="S3.E4.m1.3.3.1.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2.2"></sum><apply id="S3.E4.m1.3.3.1.1.1.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2.3"><eq id="S3.E4.m1.3.3.1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2.3.1"></eq><ci id="S3.E4.m1.3.3.1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.3.3.1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3.3"><minus id="S3.E4.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3.3.2">𝑇</ci><cn type="integer" id="S3.E4.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"><ci id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">⋅</ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"><log id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"></log><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑎</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑠</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><ci id="S3.E4.m1.3.3.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\mathcal{L}^{\mathrm{o}n}_{AC}(\theta)=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(\hat{a}_{t}^{\theta}|\hat{s}^{\theta}_{t})\right)\cdot A,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.18" class="ltx_p">where <math id="S3.SS3.p2.11.m1.1" class="ltx_Math" alttext="\{\hat{a}_{t}^{\theta}\}" display="inline"><semantics id="S3.SS3.p2.11.m1.1a"><mrow id="S3.SS3.p2.11.m1.1.1.1" xref="S3.SS3.p2.11.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.11.m1.1.1.1.2" xref="S3.SS3.p2.11.m1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p2.11.m1.1.1.1.1" xref="S3.SS3.p2.11.m1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.11.m1.1.1.1.1.2.2" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.11.m1.1.1.1.1.2.2.2" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2.2.cmml">a</mi><mo id="S3.SS3.p2.11.m1.1.1.1.1.2.2.1" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.11.m1.1.1.1.1.2.3" xref="S3.SS3.p2.11.m1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.11.m1.1.1.1.1.3" xref="S3.SS3.p2.11.m1.1.1.1.1.3.cmml">θ</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.11.m1.1.1.1.3" xref="S3.SS3.p2.11.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m1.1b"><set id="S3.SS3.p2.11.m1.1.1.2.cmml" xref="S3.SS3.p2.11.m1.1.1.1"><apply id="S3.SS3.p2.11.m1.1.1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.11.m1.1.1.1.1.2.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.11.m1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2"><ci id="S3.SS3.p2.11.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p2.11.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="S3.SS3.p2.11.m1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.11.m1.1.1.1.1.3.cmml" xref="S3.SS3.p2.11.m1.1.1.1.1.3">𝜃</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m1.1c">\{\hat{a}_{t}^{\theta}\}</annotation></semantics></math> denotes the trajectory sampled by the <span id="S3.SS3.p2.18.1" class="ltx_text ltx_font_italic">immediate</span> GPT weight <math id="S3.SS3.p2.12.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p2.12.m2.1a"><mi id="S3.SS3.p2.12.m2.1.1" xref="S3.SS3.p2.12.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m2.1b"><ci id="S3.SS3.p2.12.m2.1.1.cmml" xref="S3.SS3.p2.12.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m2.1c">\theta</annotation></semantics></math>.
The term <math id="S3.SS3.p2.13.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS3.p2.13.m3.1a"><mi id="S3.SS3.p2.13.m3.1.1" xref="S3.SS3.p2.13.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m3.1b"><ci id="S3.SS3.p2.13.m3.1.1.cmml" xref="S3.SS3.p2.13.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m3.1c">A</annotation></semantics></math> represents the “advantage”, which reveals the increment after taking action <math id="S3.SS3.p2.14.m4.1" class="ltx_Math" alttext="a^{\theta}_{t}" display="inline"><semantics id="S3.SS3.p2.14.m4.1a"><msubsup id="S3.SS3.p2.14.m4.1.1" xref="S3.SS3.p2.14.m4.1.1.cmml"><mi id="S3.SS3.p2.14.m4.1.1.2.2" xref="S3.SS3.p2.14.m4.1.1.2.2.cmml">a</mi><mi id="S3.SS3.p2.14.m4.1.1.3" xref="S3.SS3.p2.14.m4.1.1.3.cmml">t</mi><mi id="S3.SS3.p2.14.m4.1.1.2.3" xref="S3.SS3.p2.14.m4.1.1.2.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m4.1b"><apply id="S3.SS3.p2.14.m4.1.1.cmml" xref="S3.SS3.p2.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.14.m4.1.1.1.cmml" xref="S3.SS3.p2.14.m4.1.1">subscript</csymbol><apply id="S3.SS3.p2.14.m4.1.1.2.cmml" xref="S3.SS3.p2.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.14.m4.1.1.2.1.cmml" xref="S3.SS3.p2.14.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.14.m4.1.1.2.2.cmml" xref="S3.SS3.p2.14.m4.1.1.2.2">𝑎</ci><ci id="S3.SS3.p2.14.m4.1.1.2.3.cmml" xref="S3.SS3.p2.14.m4.1.1.2.3">𝜃</ci></apply><ci id="S3.SS3.p2.14.m4.1.1.3.cmml" xref="S3.SS3.p2.14.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m4.1c">a^{\theta}_{t}</annotation></semantics></math> (see Appendix <a href="#A3.SS1" title="C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C.1</span></a>).
A positive advantage increases the probability <math id="S3.SS3.p2.15.m5.1" class="ltx_Math" alttext="\pi(\hat{a}_{t}^{\theta}|\hat{s}_{t}^{\theta})" display="inline"><semantics id="S3.SS3.p2.15.m5.1a"><mrow id="S3.SS3.p2.15.m5.1.1" xref="S3.SS3.p2.15.m5.1.1.cmml"><mi id="S3.SS3.p2.15.m5.1.1.3" xref="S3.SS3.p2.15.m5.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.15.m5.1.1.2" xref="S3.SS3.p2.15.m5.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.15.m5.1.1.1.1" xref="S3.SS3.p2.15.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.15.m5.1.1.1.1.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.15.m5.1.1.1.1.1" xref="S3.SS3.p2.15.m5.1.1.1.1.1.cmml"><msubsup id="S3.SS3.p2.15.m5.1.1.1.1.1.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.1" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.2.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo fence="false" id="S3.SS3.p2.15.m5.1.1.1.1.1.1" xref="S3.SS3.p2.15.m5.1.1.1.1.1.1.cmml">|</mo><msubsup id="S3.SS3.p2.15.m5.1.1.1.1.1.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.cmml"><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.2" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.2.cmml">s</mi><mo id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.1" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S3.SS3.p2.15.m5.1.1.1.1.1.3.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.3.cmml">θ</mi></msubsup></mrow><mo stretchy="false" id="S3.SS3.p2.15.m5.1.1.1.1.3" xref="S3.SS3.p2.15.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m5.1b"><apply id="S3.SS3.p2.15.m5.1.1.cmml" xref="S3.SS3.p2.15.m5.1.1"><times id="S3.SS3.p2.15.m5.1.1.2.cmml" xref="S3.SS3.p2.15.m5.1.1.2"></times><ci id="S3.SS3.p2.15.m5.1.1.3.cmml" xref="S3.SS3.p2.15.m5.1.1.3">𝜋</ci><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.15.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2"><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.2.2">𝑎</ci></apply><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3">superscript</csymbol><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2"><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.1">^</ci><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.2.2">𝑠</ci></apply><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.15.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.15.m5.1.1.1.1.1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m5.1c">\pi(\hat{a}_{t}^{\theta}|\hat{s}_{t}^{\theta})</annotation></semantics></math> of the currently sampled action <math id="S3.SS3.p2.16.m6.1" class="ltx_Math" alttext="\hat{a}_{t}^{\theta}" display="inline"><semantics id="S3.SS3.p2.16.m6.1a"><msubsup id="S3.SS3.p2.16.m6.1.1" xref="S3.SS3.p2.16.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p2.16.m6.1.1.2.2" xref="S3.SS3.p2.16.m6.1.1.2.2.cmml"><mi id="S3.SS3.p2.16.m6.1.1.2.2.2" xref="S3.SS3.p2.16.m6.1.1.2.2.2.cmml">a</mi><mo id="S3.SS3.p2.16.m6.1.1.2.2.1" xref="S3.SS3.p2.16.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.16.m6.1.1.2.3" xref="S3.SS3.p2.16.m6.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.16.m6.1.1.3" xref="S3.SS3.p2.16.m6.1.1.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m6.1b"><apply id="S3.SS3.p2.16.m6.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m6.1.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1">superscript</csymbol><apply id="S3.SS3.p2.16.m6.1.1.2.cmml" xref="S3.SS3.p2.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m6.1.1.2.1.cmml" xref="S3.SS3.p2.16.m6.1.1">subscript</csymbol><apply id="S3.SS3.p2.16.m6.1.1.2.2.cmml" xref="S3.SS3.p2.16.m6.1.1.2.2"><ci id="S3.SS3.p2.16.m6.1.1.2.2.1.cmml" xref="S3.SS3.p2.16.m6.1.1.2.2.1">^</ci><ci id="S3.SS3.p2.16.m6.1.1.2.2.2.cmml" xref="S3.SS3.p2.16.m6.1.1.2.2.2">𝑎</ci></apply><ci id="S3.SS3.p2.16.m6.1.1.2.3.cmml" xref="S3.SS3.p2.16.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.16.m6.1.1.3.cmml" xref="S3.SS3.p2.16.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m6.1c">\hat{a}_{t}^{\theta}</annotation></semantics></math>, whereas a negative advantage reduces it.
This indiscriminate mechanism of increasing or decreasing hinders the ability of RL to reuse past data.
For example, when the advantage of a previous sampling <math id="S3.SS3.p2.17.m7.2" class="ltx_Math" alttext="(\hat{s}^{\theta_{\text{old}}}_{t},\hat{a}^{\theta_{\text{old}}}_{t})" display="inline"><semantics id="S3.SS3.p2.17.m7.2a"><mrow id="S3.SS3.p2.17.m7.2.2.2" xref="S3.SS3.p2.17.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.17.m7.2.2.2.3" xref="S3.SS3.p2.17.m7.2.2.3.cmml">(</mo><msubsup id="S3.SS3.p2.17.m7.1.1.1.1" xref="S3.SS3.p2.17.m7.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.17.m7.1.1.1.1.2.2" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.17.m7.1.1.1.1.2.2.2" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2.2.cmml">s</mi><mo id="S3.SS3.p2.17.m7.1.1.1.1.2.2.1" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.17.m7.1.1.1.1.3" xref="S3.SS3.p2.17.m7.1.1.1.1.3.cmml">t</mi><msub id="S3.SS3.p2.17.m7.1.1.1.1.2.3" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p2.17.m7.1.1.1.1.2.3.2" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.2.cmml">θ</mi><mtext id="S3.SS3.p2.17.m7.1.1.1.1.2.3.3" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.3a.cmml">old</mtext></msub></msubsup><mo id="S3.SS3.p2.17.m7.2.2.2.4" xref="S3.SS3.p2.17.m7.2.2.3.cmml">,</mo><msubsup id="S3.SS3.p2.17.m7.2.2.2.2" xref="S3.SS3.p2.17.m7.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.p2.17.m7.2.2.2.2.2.2" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.17.m7.2.2.2.2.2.2.2" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p2.17.m7.2.2.2.2.2.2.1" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.17.m7.2.2.2.2.3" xref="S3.SS3.p2.17.m7.2.2.2.2.3.cmml">t</mi><msub id="S3.SS3.p2.17.m7.2.2.2.2.2.3" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p2.17.m7.2.2.2.2.2.3.2" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.2.cmml">θ</mi><mtext id="S3.SS3.p2.17.m7.2.2.2.2.2.3.3" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.3a.cmml">old</mtext></msub></msubsup><mo stretchy="false" id="S3.SS3.p2.17.m7.2.2.2.5" xref="S3.SS3.p2.17.m7.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m7.2b"><interval closure="open" id="S3.SS3.p2.17.m7.2.2.3.cmml" xref="S3.SS3.p2.17.m7.2.2.2"><apply id="S3.SS3.p2.17.m7.1.1.1.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.1.1.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.17.m7.1.1.1.1.2.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.17.m7.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2"><ci id="S3.SS3.p2.17.m7.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p2.17.m7.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.2.2">𝑠</ci></apply><apply id="S3.SS3.p2.17.m7.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p2.17.m7.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.2">𝜃</ci><ci id="S3.SS3.p2.17.m7.1.1.1.1.2.3.3a.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.3"><mtext mathsize="50%" id="S3.SS3.p2.17.m7.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.2.3.3">old</mtext></ci></apply></apply><ci id="S3.SS3.p2.17.m7.1.1.1.1.3.cmml" xref="S3.SS3.p2.17.m7.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.p2.17.m7.2.2.2.2.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.2.2.2.2.1.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.17.m7.2.2.2.2.2.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.17.m7.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2"><ci id="S3.SS3.p2.17.m7.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2.1">^</ci><ci id="S3.SS3.p2.17.m7.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.2.2">𝑎</ci></apply><apply id="S3.SS3.p2.17.m7.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.17.m7.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.2">𝜃</ci><ci id="S3.SS3.p2.17.m7.2.2.2.2.2.3.3a.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.3"><mtext mathsize="50%" id="S3.SS3.p2.17.m7.2.2.2.2.2.3.3.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.2.3.3">old</mtext></ci></apply></apply><ci id="S3.SS3.p2.17.m7.2.2.2.2.3.cmml" xref="S3.SS3.p2.17.m7.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m7.2c">(\hat{s}^{\theta_{\text{old}}}_{t},\hat{a}^{\theta_{\text{old}}}_{t})</annotation></semantics></math> is negative, the on-policy loss <math id="S3.SS3.p2.18.m8.1" class="ltx_Math" alttext="\mathcal{L}_{AC}^{\mathrm{on}}" display="inline"><semantics id="S3.SS3.p2.18.m8.1a"><msubsup id="S3.SS3.p2.18.m8.1.1" xref="S3.SS3.p2.18.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.18.m8.1.1.2.2" xref="S3.SS3.p2.18.m8.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.p2.18.m8.1.1.2.3" xref="S3.SS3.p2.18.m8.1.1.2.3.cmml"><mi id="S3.SS3.p2.18.m8.1.1.2.3.2" xref="S3.SS3.p2.18.m8.1.1.2.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.18.m8.1.1.2.3.1" xref="S3.SS3.p2.18.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.18.m8.1.1.2.3.3" xref="S3.SS3.p2.18.m8.1.1.2.3.3.cmml">C</mi></mrow><mi id="S3.SS3.p2.18.m8.1.1.3" xref="S3.SS3.p2.18.m8.1.1.3.cmml">on</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m8.1b"><apply id="S3.SS3.p2.18.m8.1.1.cmml" xref="S3.SS3.p2.18.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m8.1.1.1.cmml" xref="S3.SS3.p2.18.m8.1.1">superscript</csymbol><apply id="S3.SS3.p2.18.m8.1.1.2.cmml" xref="S3.SS3.p2.18.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m8.1.1.2.1.cmml" xref="S3.SS3.p2.18.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.18.m8.1.1.2.2.cmml" xref="S3.SS3.p2.18.m8.1.1.2.2">ℒ</ci><apply id="S3.SS3.p2.18.m8.1.1.2.3.cmml" xref="S3.SS3.p2.18.m8.1.1.2.3"><times id="S3.SS3.p2.18.m8.1.1.2.3.1.cmml" xref="S3.SS3.p2.18.m8.1.1.2.3.1"></times><ci id="S3.SS3.p2.18.m8.1.1.2.3.2.cmml" xref="S3.SS3.p2.18.m8.1.1.2.3.2">𝐴</ci><ci id="S3.SS3.p2.18.m8.1.1.2.3.3.cmml" xref="S3.SS3.p2.18.m8.1.1.2.3.3">𝐶</ci></apply></apply><ci id="S3.SS3.p2.18.m8.1.1.3.cmml" xref="S3.SS3.p2.18.m8.1.1.3">on</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m8.1c">\mathcal{L}_{AC}^{\mathrm{on}}</annotation></semantics></math> will persist in pushing associated values to decrease, regardless of the current probability already being very small.
Such misalignment is counter-logical and potentially harmful to network training due to the misleading optimization target.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.10" class="ltx_p">To address this issue, we extend the RL on GPT off policy by establishing an <span id="S3.SS3.p3.10.1" class="ltx_text ltx_font_italic">explicit optimization target</span> for the probability <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}(\hat{a}_{t}|\hat{s}_{t})" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">π</mi><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.1.m1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS3.p3.1.m1.1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p3.1.m1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><times id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"></times><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝜋</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2"><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2"><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.2.2">𝑠</ci></apply><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\pi_{\theta}(\hat{a}_{t}|\hat{s}_{t})</annotation></semantics></math>.
Drawing from ideas in energy-based policy modeling <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al., <a href="#bib.bib12" title="" class="ltx_ref">2017</a>; <a href="#bib.bib13" title="" class="ltx_ref">2018</a>)</cite>, an equivalence can be established between the policy probability and the expected reward income, implemented by a monotonic mapping <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="\sigma:\mathbb{R}\rightarrow[0,1]" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.3" xref="S3.SS3.p3.2.m2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.2.3.2" xref="S3.SS3.p3.2.m2.2.3.2.cmml">σ</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS3.p3.2.m2.2.3.1" xref="S3.SS3.p3.2.m2.2.3.1.cmml">:</mo><mrow id="S3.SS3.p3.2.m2.2.3.3" xref="S3.SS3.p3.2.m2.2.3.3.cmml"><mi id="S3.SS3.p3.2.m2.2.3.3.2" xref="S3.SS3.p3.2.m2.2.3.3.2.cmml">ℝ</mi><mo stretchy="false" id="S3.SS3.p3.2.m2.2.3.3.1" xref="S3.SS3.p3.2.m2.2.3.3.1.cmml">→</mo><mrow id="S3.SS3.p3.2.m2.2.3.3.3.2" xref="S3.SS3.p3.2.m2.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.2.3.3.3.2.1" xref="S3.SS3.p3.2.m2.2.3.3.3.1.cmml">[</mo><mn id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">0</mn><mo id="S3.SS3.p3.2.m2.2.3.3.3.2.2" xref="S3.SS3.p3.2.m2.2.3.3.3.1.cmml">,</mo><mn id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p3.2.m2.2.3.3.3.2.3" xref="S3.SS3.p3.2.m2.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.3"><ci id="S3.SS3.p3.2.m2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.3.1">:</ci><ci id="S3.SS3.p3.2.m2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.2.3.2">𝜎</ci><apply id="S3.SS3.p3.2.m2.2.3.3.cmml" xref="S3.SS3.p3.2.m2.2.3.3"><ci id="S3.SS3.p3.2.m2.2.3.3.1.cmml" xref="S3.SS3.p3.2.m2.2.3.3.1">→</ci><ci id="S3.SS3.p3.2.m2.2.3.3.2.cmml" xref="S3.SS3.p3.2.m2.2.3.3.2">ℝ</ci><interval closure="closed" id="S3.SS3.p3.2.m2.2.3.3.3.1.cmml" xref="S3.SS3.p3.2.m2.2.3.3.3.2"><cn type="integer" id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">0</cn><cn type="integer" id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">\sigma:\mathbb{R}\rightarrow[0,1]</annotation></semantics></math>.
This relationship can be formulated as <math id="S3.SS3.p3.3.m3.4" class="ltx_Math" alttext="\pi_{\theta}(a|s)=\sigma(Q(s,a))" display="inline"><semantics id="S3.SS3.p3.3.m3.4a"><mrow id="S3.SS3.p3.3.m3.4.4" xref="S3.SS3.p3.3.m3.4.4.cmml"><mrow id="S3.SS3.p3.3.m3.3.3.1" xref="S3.SS3.p3.3.m3.3.3.1.cmml"><msub id="S3.SS3.p3.3.m3.3.3.1.3" xref="S3.SS3.p3.3.m3.3.3.1.3.cmml"><mi id="S3.SS3.p3.3.m3.3.3.1.3.2" xref="S3.SS3.p3.3.m3.3.3.1.3.2.cmml">π</mi><mi id="S3.SS3.p3.3.m3.3.3.1.3.3" xref="S3.SS3.p3.3.m3.3.3.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.3.3.1.2" xref="S3.SS3.p3.3.m3.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.3.3.1.1.1" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.3.3.1.1.1.2" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.3.m3.3.3.1.1.1.1" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.3.3.1.1.1.1.2" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS3.p3.3.m3.3.3.1.1.1.1.1" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.3.m3.3.3.1.1.1.1.3" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S3.SS3.p3.3.m3.3.3.1.1.1.3" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.3.m3.4.4.3" xref="S3.SS3.p3.3.m3.4.4.3.cmml">=</mo><mrow id="S3.SS3.p3.3.m3.4.4.2" xref="S3.SS3.p3.3.m3.4.4.2.cmml"><mi id="S3.SS3.p3.3.m3.4.4.2.3" xref="S3.SS3.p3.3.m3.4.4.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.4.4.2.2" xref="S3.SS3.p3.3.m3.4.4.2.2.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.4.4.2.1.1" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.2.1.1.2" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.3.m3.4.4.2.1.1.1" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.4.4.2.1.1.1.2" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.4.4.2.1.1.1.1" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.1.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.2" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.2.1" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">s</mi><mo id="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.2.2" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.2.3" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.2.1.1.3" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.4b"><apply id="S3.SS3.p3.3.m3.4.4.cmml" xref="S3.SS3.p3.3.m3.4.4"><eq id="S3.SS3.p3.3.m3.4.4.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3"></eq><apply id="S3.SS3.p3.3.m3.3.3.1.cmml" xref="S3.SS3.p3.3.m3.3.3.1"><times id="S3.SS3.p3.3.m3.3.3.1.2.cmml" xref="S3.SS3.p3.3.m3.3.3.1.2"></times><apply id="S3.SS3.p3.3.m3.3.3.1.3.cmml" xref="S3.SS3.p3.3.m3.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.3.3.1.3.1.cmml" xref="S3.SS3.p3.3.m3.3.3.1.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.3.3.1.3.2.cmml" xref="S3.SS3.p3.3.m3.3.3.1.3.2">𝜋</ci><ci id="S3.SS3.p3.3.m3.3.3.1.3.3.cmml" xref="S3.SS3.p3.3.m3.3.3.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p3.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.3.3.1.1.1.1.3">𝑠</ci></apply></apply><apply id="S3.SS3.p3.3.m3.4.4.2.cmml" xref="S3.SS3.p3.3.m3.4.4.2"><times id="S3.SS3.p3.3.m3.4.4.2.2.cmml" xref="S3.SS3.p3.3.m3.4.4.2.2"></times><ci id="S3.SS3.p3.3.m3.4.4.2.3.cmml" xref="S3.SS3.p3.3.m3.4.4.2.3">𝜎</ci><apply id="S3.SS3.p3.3.m3.4.4.2.1.1.1.cmml" xref="S3.SS3.p3.3.m3.4.4.2.1.1"><times id="S3.SS3.p3.3.m3.4.4.2.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.1"></times><ci id="S3.SS3.p3.3.m3.4.4.2.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.2">𝑄</ci><interval closure="open" id="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.4.4.2.1.1.1.3.2"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑠</ci><ci id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.4c">\pi_{\theta}(a|s)=\sigma(Q(s,a))</annotation></semantics></math>, where the <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">Q</annotation></semantics></math> value represents the expected total future income after executing action <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">a</annotation></semantics></math> at state <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">s</annotation></semantics></math>.
In light of this equivalence, if an action <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">a</annotation></semantics></math> results in greater future income <math id="S3.SS3.p3.8.m8.2" class="ltx_Math" alttext="Q(s,a)" display="inline"><semantics id="S3.SS3.p3.8.m8.2a"><mrow id="S3.SS3.p3.8.m8.2.3" xref="S3.SS3.p3.8.m8.2.3.cmml"><mi id="S3.SS3.p3.8.m8.2.3.2" xref="S3.SS3.p3.8.m8.2.3.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.8.m8.2.3.1" xref="S3.SS3.p3.8.m8.2.3.1.cmml">​</mo><mrow id="S3.SS3.p3.8.m8.2.3.3.2" xref="S3.SS3.p3.8.m8.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.8.m8.2.3.3.2.1" xref="S3.SS3.p3.8.m8.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">s</mi><mo id="S3.SS3.p3.8.m8.2.3.3.2.2" xref="S3.SS3.p3.8.m8.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p3.8.m8.2.2" xref="S3.SS3.p3.8.m8.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS3.p3.8.m8.2.3.3.2.3" xref="S3.SS3.p3.8.m8.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.2b"><apply id="S3.SS3.p3.8.m8.2.3.cmml" xref="S3.SS3.p3.8.m8.2.3"><times id="S3.SS3.p3.8.m8.2.3.1.cmml" xref="S3.SS3.p3.8.m8.2.3.1"></times><ci id="S3.SS3.p3.8.m8.2.3.2.cmml" xref="S3.SS3.p3.8.m8.2.3.2">𝑄</ci><interval closure="open" id="S3.SS3.p3.8.m8.2.3.3.1.cmml" xref="S3.SS3.p3.8.m8.2.3.3.2"><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝑠</ci><ci id="S3.SS3.p3.8.m8.2.2.cmml" xref="S3.SS3.p3.8.m8.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.2c">Q(s,a)</annotation></semantics></math>, it should hold a larger probability <math id="S3.SS3.p3.9.m9.3" class="ltx_Math" alttext="\sigma(Q(s,a))" display="inline"><semantics id="S3.SS3.p3.9.m9.3a"><mrow id="S3.SS3.p3.9.m9.3.3" xref="S3.SS3.p3.9.m9.3.3.cmml"><mi id="S3.SS3.p3.9.m9.3.3.3" xref="S3.SS3.p3.9.m9.3.3.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.9.m9.3.3.2" xref="S3.SS3.p3.9.m9.3.3.2.cmml">​</mo><mrow id="S3.SS3.p3.9.m9.3.3.1.1" xref="S3.SS3.p3.9.m9.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.9.m9.3.3.1.1.2" xref="S3.SS3.p3.9.m9.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.9.m9.3.3.1.1.1" xref="S3.SS3.p3.9.m9.3.3.1.1.1.cmml"><mi id="S3.SS3.p3.9.m9.3.3.1.1.1.2" xref="S3.SS3.p3.9.m9.3.3.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.9.m9.3.3.1.1.1.1" xref="S3.SS3.p3.9.m9.3.3.1.1.1.1.cmml">​</mo><mrow id="S3.SS3.p3.9.m9.3.3.1.1.1.3.2" xref="S3.SS3.p3.9.m9.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.9.m9.3.3.1.1.1.3.2.1" xref="S3.SS3.p3.9.m9.3.3.1.1.1.3.1.cmml">(</mo><mi id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml">s</mi><mo id="S3.SS3.p3.9.m9.3.3.1.1.1.3.2.2" xref="S3.SS3.p3.9.m9.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p3.9.m9.2.2" xref="S3.SS3.p3.9.m9.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS3.p3.9.m9.3.3.1.1.1.3.2.3" xref="S3.SS3.p3.9.m9.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p3.9.m9.3.3.1.1.3" xref="S3.SS3.p3.9.m9.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.3b"><apply id="S3.SS3.p3.9.m9.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3"><times id="S3.SS3.p3.9.m9.3.3.2.cmml" xref="S3.SS3.p3.9.m9.3.3.2"></times><ci id="S3.SS3.p3.9.m9.3.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3">𝜎</ci><apply id="S3.SS3.p3.9.m9.3.3.1.1.1.cmml" xref="S3.SS3.p3.9.m9.3.3.1.1"><times id="S3.SS3.p3.9.m9.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.3.3.1.1.1.1"></times><ci id="S3.SS3.p3.9.m9.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.9.m9.3.3.1.1.1.2">𝑄</ci><interval closure="open" id="S3.SS3.p3.9.m9.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.9.m9.3.3.1.1.1.3.2"><ci id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">𝑠</ci><ci id="S3.SS3.p3.9.m9.2.2.cmml" xref="S3.SS3.p3.9.m9.2.2">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.3c">\sigma(Q(s,a))</annotation></semantics></math> of being selected, which leads to an explicit optimization reference to <math id="S3.SS3.p3.10.m10.1" class="ltx_Math" alttext="\pi_{\theta}(a|s)" display="inline"><semantics id="S3.SS3.p3.10.m10.1a"><mrow id="S3.SS3.p3.10.m10.1.1" xref="S3.SS3.p3.10.m10.1.1.cmml"><msub id="S3.SS3.p3.10.m10.1.1.3" xref="S3.SS3.p3.10.m10.1.1.3.cmml"><mi id="S3.SS3.p3.10.m10.1.1.3.2" xref="S3.SS3.p3.10.m10.1.1.3.2.cmml">π</mi><mi id="S3.SS3.p3.10.m10.1.1.3.3" xref="S3.SS3.p3.10.m10.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.10.m10.1.1.2" xref="S3.SS3.p3.10.m10.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.10.m10.1.1.1.1" xref="S3.SS3.p3.10.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.10.m10.1.1.1.1.2" xref="S3.SS3.p3.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.10.m10.1.1.1.1.1" xref="S3.SS3.p3.10.m10.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.10.m10.1.1.1.1.1.2" xref="S3.SS3.p3.10.m10.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS3.p3.10.m10.1.1.1.1.1.1" xref="S3.SS3.p3.10.m10.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.10.m10.1.1.1.1.1.3" xref="S3.SS3.p3.10.m10.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S3.SS3.p3.10.m10.1.1.1.1.3" xref="S3.SS3.p3.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><apply id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1"><times id="S3.SS3.p3.10.m10.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.2"></times><apply id="S3.SS3.p3.10.m10.1.1.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.1.1.3.1.cmml" xref="S3.SS3.p3.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.10.m10.1.1.3.2.cmml" xref="S3.SS3.p3.10.m10.1.1.3.2">𝜋</ci><ci id="S3.SS3.p3.10.m10.1.1.3.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.10.m10.1.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.10.m10.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p3.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">\pi_{\theta}(a|s)</annotation></semantics></math>.
With this concept as our foundation, we construct a novel learning strategy using a loss function defined as</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{\mathrm{off}}_{RL}(\theta)" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.2" xref="S3.E5X.2.1.1.m1.1.2.cmml"><msubsup id="S3.E5X.2.1.1.m1.1.2.2" xref="S3.E5X.2.1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.2.1.1.m1.1.2.2.2.2" xref="S3.E5X.2.1.1.m1.1.2.2.2.2.cmml">ℒ</mi><mrow id="S3.E5X.2.1.1.m1.1.2.2.3" xref="S3.E5X.2.1.1.m1.1.2.2.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.2.2.3.2" xref="S3.E5X.2.1.1.m1.1.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.2.2.3.1" xref="S3.E5X.2.1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.2.2.3.3" xref="S3.E5X.2.1.1.m1.1.2.2.3.3.cmml">L</mi></mrow><mi id="S3.E5X.2.1.1.m1.1.2.2.2.3" xref="S3.E5X.2.1.1.m1.1.2.2.2.3.cmml">off</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.2.1" xref="S3.E5X.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.E5X.2.1.1.m1.1.2.3.2" xref="S3.E5X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.1.2.3.2.1" xref="S3.E5X.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E5X.2.1.1.m1.1.2.3.2.2" xref="S3.E5X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.2"><times id="S3.E5X.2.1.1.m1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.2.1"></times><apply id="S3.E5X.2.1.1.m1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.2.2">subscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.2.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.2.2">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.2.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.2.2">ℒ</ci><ci id="S3.E5X.2.1.1.m1.1.2.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.2.3">off</ci></apply><apply id="S3.E5X.2.1.1.m1.1.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.3"><times id="S3.E5X.2.1.1.m1.1.2.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.3.1"></times><ci id="S3.E5X.2.1.1.m1.1.2.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.3.2">𝑅</ci><ci id="S3.E5X.2.1.1.m1.1.2.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.2.2.3.3">𝐿</ci></apply></apply><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathcal{L}^{\mathrm{off}}_{RL}(\theta)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\sum_{t=0}^{T-1}-\log\left(1-\mathrm{abs}\big{[}\pi_{\theta}\left(\hat{a}_{t}|\hat{s}_{t}\right)-\sigma\left(Q\left(\hat{s}_{t},\hat{a}_{t}\right)\right)\big{]}\right)." display="inline"><semantics id="S3.E5X.3.2.2.m1.2a"><mrow id="S3.E5X.3.2.2.m1.2.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.2.2.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.cmml"><munderover id="S3.E5X.3.2.2.m1.2.2.1.1.1.3a" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.cmml"><mo movablelimits="false" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.2.cmml">∑</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.2.cmml">T</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml">log</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1a" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mn id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">abs</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.4" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.4.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml"><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">(</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.4" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.2.cmml">a</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.5" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="120%" minsize="120%" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5X.3.2.2.m1.2.2.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.2b"><apply id="S3.E5X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"><eq id="S3.E5X.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1"><minus id="S3.E5X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.2"></minus><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.2"></sum><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3"><eq id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.1"></eq><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3"><minus id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.1"></minus><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.2">𝑇</ci><cn type="integer" id="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1"><log id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"></log><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><minus id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2"></minus><cn type="integer" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3">1</cn><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">abs</ci><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑠</ci></apply><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2"></times><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜎</ci><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1"><times id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"></times><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.4.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.4">𝑄</ci><interval closure="open" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2"><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2"><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.2.2">𝑎</ci></apply><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.2c">\displaystyle=\sum_{t=0}^{T-1}-\log\left(1-\mathrm{abs}\big{[}\pi_{\theta}\left(\hat{a}_{t}|\hat{s}_{t}\right)-\sigma\left(Q\left(\hat{s}_{t},\hat{a}_{t}\right)\right)\big{]}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p3.15" class="ltx_p">The proposed learning strategy is off-policy since <math id="S3.SS3.p3.11.m1.1" class="ltx_Math" alttext="\mathcal{L}_{RL}^{\mathrm{off}}" display="inline"><semantics id="S3.SS3.p3.11.m1.1a"><msubsup id="S3.SS3.p3.11.m1.1.1" xref="S3.SS3.p3.11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.11.m1.1.1.2.2" xref="S3.SS3.p3.11.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.p3.11.m1.1.1.2.3" xref="S3.SS3.p3.11.m1.1.1.2.3.cmml"><mi id="S3.SS3.p3.11.m1.1.1.2.3.2" xref="S3.SS3.p3.11.m1.1.1.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.11.m1.1.1.2.3.1" xref="S3.SS3.p3.11.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.11.m1.1.1.2.3.3" xref="S3.SS3.p3.11.m1.1.1.2.3.3.cmml">L</mi></mrow><mi id="S3.SS3.p3.11.m1.1.1.3" xref="S3.SS3.p3.11.m1.1.1.3.cmml">off</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m1.1b"><apply id="S3.SS3.p3.11.m1.1.1.cmml" xref="S3.SS3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m1.1.1.1.cmml" xref="S3.SS3.p3.11.m1.1.1">superscript</csymbol><apply id="S3.SS3.p3.11.m1.1.1.2.cmml" xref="S3.SS3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m1.1.1.2.1.cmml" xref="S3.SS3.p3.11.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.11.m1.1.1.2.2.cmml" xref="S3.SS3.p3.11.m1.1.1.2.2">ℒ</ci><apply id="S3.SS3.p3.11.m1.1.1.2.3.cmml" xref="S3.SS3.p3.11.m1.1.1.2.3"><times id="S3.SS3.p3.11.m1.1.1.2.3.1.cmml" xref="S3.SS3.p3.11.m1.1.1.2.3.1"></times><ci id="S3.SS3.p3.11.m1.1.1.2.3.2.cmml" xref="S3.SS3.p3.11.m1.1.1.2.3.2">𝑅</ci><ci id="S3.SS3.p3.11.m1.1.1.2.3.3.cmml" xref="S3.SS3.p3.11.m1.1.1.2.3.3">𝐿</ci></apply></apply><ci id="S3.SS3.p3.11.m1.1.1.3.cmml" xref="S3.SS3.p3.11.m1.1.1.3">off</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m1.1c">\mathcal{L}_{RL}^{\mathrm{off}}</annotation></semantics></math> can be reused on past data to guide the GPT to learn a specific probability of <math id="S3.SS3.p3.12.m2.1" class="ltx_Math" alttext="\hat{a}_{t}" display="inline"><semantics id="S3.SS3.p3.12.m2.1a"><msub id="S3.SS3.p3.12.m2.1.1" xref="S3.SS3.p3.12.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p3.12.m2.1.1.2" xref="S3.SS3.p3.12.m2.1.1.2.cmml"><mi id="S3.SS3.p3.12.m2.1.1.2.2" xref="S3.SS3.p3.12.m2.1.1.2.2.cmml">a</mi><mo id="S3.SS3.p3.12.m2.1.1.2.1" xref="S3.SS3.p3.12.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.12.m2.1.1.3" xref="S3.SS3.p3.12.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m2.1b"><apply id="S3.SS3.p3.12.m2.1.1.cmml" xref="S3.SS3.p3.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m2.1.1.1.cmml" xref="S3.SS3.p3.12.m2.1.1">subscript</csymbol><apply id="S3.SS3.p3.12.m2.1.1.2.cmml" xref="S3.SS3.p3.12.m2.1.1.2"><ci id="S3.SS3.p3.12.m2.1.1.2.1.cmml" xref="S3.SS3.p3.12.m2.1.1.2.1">^</ci><ci id="S3.SS3.p3.12.m2.1.1.2.2.cmml" xref="S3.SS3.p3.12.m2.1.1.2.2">𝑎</ci></apply><ci id="S3.SS3.p3.12.m2.1.1.3.cmml" xref="S3.SS3.p3.12.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m2.1c">\hat{a}_{t}</annotation></semantics></math>.
In practice, we set <math id="S3.SS3.p3.13.m3.1" class="ltx_Math" alttext="\sigma=\mathrm{sigmoid}(\alpha*Q+\beta)" display="inline"><semantics id="S3.SS3.p3.13.m3.1a"><mrow id="S3.SS3.p3.13.m3.1.1" xref="S3.SS3.p3.13.m3.1.1.cmml"><mi id="S3.SS3.p3.13.m3.1.1.3" xref="S3.SS3.p3.13.m3.1.1.3.cmml">σ</mi><mo id="S3.SS3.p3.13.m3.1.1.2" xref="S3.SS3.p3.13.m3.1.1.2.cmml">=</mo><mrow id="S3.SS3.p3.13.m3.1.1.1" xref="S3.SS3.p3.13.m3.1.1.1.cmml"><mi id="S3.SS3.p3.13.m3.1.1.1.3" xref="S3.SS3.p3.13.m3.1.1.1.3.cmml">sigmoid</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.13.m3.1.1.1.2" xref="S3.SS3.p3.13.m3.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.13.m3.1.1.1.1.1" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.13.m3.1.1.1.1.1.2" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.13.m3.1.1.1.1.1.1" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.1" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.1.cmml">∗</mo><mi id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.3" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.3.cmml">Q</mi></mrow><mo id="S3.SS3.p3.13.m3.1.1.1.1.1.1.1" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS3.p3.13.m3.1.1.1.1.1.1.3" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S3.SS3.p3.13.m3.1.1.1.1.1.3" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m3.1b"><apply id="S3.SS3.p3.13.m3.1.1.cmml" xref="S3.SS3.p3.13.m3.1.1"><eq id="S3.SS3.p3.13.m3.1.1.2.cmml" xref="S3.SS3.p3.13.m3.1.1.2"></eq><ci id="S3.SS3.p3.13.m3.1.1.3.cmml" xref="S3.SS3.p3.13.m3.1.1.3">𝜎</ci><apply id="S3.SS3.p3.13.m3.1.1.1.cmml" xref="S3.SS3.p3.13.m3.1.1.1"><times id="S3.SS3.p3.13.m3.1.1.1.2.cmml" xref="S3.SS3.p3.13.m3.1.1.1.2"></times><ci id="S3.SS3.p3.13.m3.1.1.1.3.cmml" xref="S3.SS3.p3.13.m3.1.1.1.3">sigmoid</ci><apply id="S3.SS3.p3.13.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1"><plus id="S3.SS3.p3.13.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2"><times id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.1"></times><ci id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.2">𝛼</ci><ci id="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.2.3">𝑄</ci></apply><ci id="S3.SS3.p3.13.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.13.m3.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m3.1c">\sigma=\mathrm{sigmoid}(\alpha*Q+\beta)</annotation></semantics></math> and approximate <math id="S3.SS3.p3.14.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.p3.14.m4.1a"><mi id="S3.SS3.p3.14.m4.1.1" xref="S3.SS3.p3.14.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m4.1b"><ci id="S3.SS3.p3.14.m4.1.1.cmml" xref="S3.SS3.p3.14.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m4.1c">Q</annotation></semantics></math> by two-step accumulation of rewards on sampled trajectory as <math id="S3.SS3.p3.15.m5.4" class="ltx_Math" alttext="\hat{Q}\approx r(\hat{s}_{t},\hat{a}_{t})+\gamma r(\hat{s}_{t+1},\hat{a}_{t+1})" display="inline"><semantics id="S3.SS3.p3.15.m5.4a"><mrow id="S3.SS3.p3.15.m5.4.4" xref="S3.SS3.p3.15.m5.4.4.cmml"><mover accent="true" id="S3.SS3.p3.15.m5.4.4.6" xref="S3.SS3.p3.15.m5.4.4.6.cmml"><mi id="S3.SS3.p3.15.m5.4.4.6.2" xref="S3.SS3.p3.15.m5.4.4.6.2.cmml">Q</mi><mo id="S3.SS3.p3.15.m5.4.4.6.1" xref="S3.SS3.p3.15.m5.4.4.6.1.cmml">^</mo></mover><mo id="S3.SS3.p3.15.m5.4.4.5" xref="S3.SS3.p3.15.m5.4.4.5.cmml">≈</mo><mrow id="S3.SS3.p3.15.m5.4.4.4" xref="S3.SS3.p3.15.m5.4.4.4.cmml"><mrow id="S3.SS3.p3.15.m5.2.2.2.2" xref="S3.SS3.p3.15.m5.2.2.2.2.cmml"><mi id="S3.SS3.p3.15.m5.2.2.2.2.4" xref="S3.SS3.p3.15.m5.2.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.15.m5.2.2.2.2.3" xref="S3.SS3.p3.15.m5.2.2.2.2.3.cmml">​</mo><mrow id="S3.SS3.p3.15.m5.2.2.2.2.2.2" xref="S3.SS3.p3.15.m5.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.15.m5.2.2.2.2.2.2.3" xref="S3.SS3.p3.15.m5.2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.1" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p3.15.m5.2.2.2.2.2.2.4" xref="S3.SS3.p3.15.m5.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.2" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.1" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.3" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS3.p3.15.m5.2.2.2.2.2.2.5" xref="S3.SS3.p3.15.m5.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.15.m5.4.4.4.5" xref="S3.SS3.p3.15.m5.4.4.4.5.cmml">+</mo><mrow id="S3.SS3.p3.15.m5.4.4.4.4" xref="S3.SS3.p3.15.m5.4.4.4.4.cmml"><mi id="S3.SS3.p3.15.m5.4.4.4.4.4" xref="S3.SS3.p3.15.m5.4.4.4.4.4.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.15.m5.4.4.4.4.3" xref="S3.SS3.p3.15.m5.4.4.4.4.3.cmml">​</mo><mi id="S3.SS3.p3.15.m5.4.4.4.4.5" xref="S3.SS3.p3.15.m5.4.4.4.4.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.15.m5.4.4.4.4.3a" xref="S3.SS3.p3.15.m5.4.4.4.4.3.cmml">​</mo><mrow id="S3.SS3.p3.15.m5.4.4.4.4.2.2" xref="S3.SS3.p3.15.m5.4.4.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.15.m5.4.4.4.4.2.2.3" xref="S3.SS3.p3.15.m5.4.4.4.4.2.3.cmml">(</mo><msub id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.cmml"><mi id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.2" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.2.cmml">s</mi><mo id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.1" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.cmml"><mi id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.2" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.1" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.3" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p3.15.m5.4.4.4.4.2.2.4" xref="S3.SS3.p3.15.m5.4.4.4.4.2.3.cmml">,</mo><msub id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.cmml"><mover accent="true" id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.cmml"><mi id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.2" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.1" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.cmml"><mi id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.2" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.1" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.3" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS3.p3.15.m5.4.4.4.4.2.2.5" xref="S3.SS3.p3.15.m5.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m5.4b"><apply id="S3.SS3.p3.15.m5.4.4.cmml" xref="S3.SS3.p3.15.m5.4.4"><approx id="S3.SS3.p3.15.m5.4.4.5.cmml" xref="S3.SS3.p3.15.m5.4.4.5"></approx><apply id="S3.SS3.p3.15.m5.4.4.6.cmml" xref="S3.SS3.p3.15.m5.4.4.6"><ci id="S3.SS3.p3.15.m5.4.4.6.1.cmml" xref="S3.SS3.p3.15.m5.4.4.6.1">^</ci><ci id="S3.SS3.p3.15.m5.4.4.6.2.cmml" xref="S3.SS3.p3.15.m5.4.4.6.2">𝑄</ci></apply><apply id="S3.SS3.p3.15.m5.4.4.4.cmml" xref="S3.SS3.p3.15.m5.4.4.4"><plus id="S3.SS3.p3.15.m5.4.4.4.5.cmml" xref="S3.SS3.p3.15.m5.4.4.4.5"></plus><apply id="S3.SS3.p3.15.m5.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2"><times id="S3.SS3.p3.15.m5.2.2.2.2.3.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.3"></times><ci id="S3.SS3.p3.15.m5.2.2.2.2.4.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.4">𝑟</ci><interval closure="open" id="S3.SS3.p3.15.m5.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2"><apply id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2"><ci id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.15.m5.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2"><ci id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.1">^</ci><ci id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.2.2">𝑎</ci></apply><ci id="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.15.m5.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S3.SS3.p3.15.m5.4.4.4.4.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4"><times id="S3.SS3.p3.15.m5.4.4.4.4.3.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.3"></times><ci id="S3.SS3.p3.15.m5.4.4.4.4.4.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.4">𝛾</ci><ci id="S3.SS3.p3.15.m5.4.4.4.4.5.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.5">𝑟</ci><interval closure="open" id="S3.SS3.p3.15.m5.4.4.4.4.2.3.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2"><apply id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2"><ci id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.1">^</ci><ci id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.2.2">𝑠</ci></apply><apply id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3"><plus id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.1"></plus><ci id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.2.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.3.cmml" xref="S3.SS3.p3.15.m5.3.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.1.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2">subscript</csymbol><apply id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2"><ci id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.1.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.1">^</ci><ci id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.2.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.2.2">𝑎</ci></apply><apply id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3"><plus id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.1.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.1"></plus><ci id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.2.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.3.cmml" xref="S3.SS3.p3.15.m5.4.4.4.4.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m5.4c">\hat{Q}\approx r(\hat{s}_{t},\hat{a}_{t})+\gamma r(\hat{s}_{t+1},\hat{a}_{t+1})</annotation></semantics></math>.
Detailed algorithms pipeline is shown in the supplementary file.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.11" class="ltx_p"><span id="S3.SS3.p4.11.1" class="ltx_text ltx_font_bold">Step-wise Rewards in Dance Accompaniment.</span> In this implementation, we specifically address the skating artifacts caused by the inconsistency between predicted translation and the lower body movement. To this end, we design a step-wise reward for each predicted token.
Specifically, we train an additional velocity decoding branch, namely <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="D_{V}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">D</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝐷</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">D_{V}</annotation></semantics></math>, for lower-body motion VQ-VAE in an unsupervised manner, as per implementation by <cite class="ltx_cite ltx_citemacro_citet">Siyao et al. (<a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>, to decode the predicted lower body sequence <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}}^{down\heartsuit}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msup id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">𝒛</mi><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1a" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.2.m2.1.1.3.4" xref="S3.SS3.p4.2.m2.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1b" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.2.m2.1.1.3.5" xref="S3.SS3.p4.2.m2.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1c" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS3.p4.2.m2.1.1.3.6" xref="S3.SS3.p4.2.m2.1.1.3.6.cmml">♡</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝒛</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><times id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑑</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS3.p4.2.m2.1.1.3.4.cmml" xref="S3.SS3.p4.2.m2.1.1.3.4">𝑤</ci><ci id="S3.SS3.p4.2.m2.1.1.3.5.cmml" xref="S3.SS3.p4.2.m2.1.1.3.5">𝑛</ci><ci id="S3.SS3.p4.2.m2.1.1.3.6.cmml" xref="S3.SS3.p4.2.m2.1.1.3.6">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}}^{down\heartsuit}</annotation></semantics></math> to velocity <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">V</annotation></semantics></math> by <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="V=D_{V}({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}}^{down\heartsuit}})" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml">V</mi><mo id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS3.p4.4.m4.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.cmml"><msub id="S3.SS3.p4.4.m4.1.1.1.3" xref="S3.SS3.p4.4.m4.1.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.1.3.2.cmml">D</mi><mi id="S3.SS3.p4.4.m4.1.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.1.3.3.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.2" xref="S3.SS3.p4.4.m4.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p4.4.m4.1.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.1.1.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p4.4.m4.1.1.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1a" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.4" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1b" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.5" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1c" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.6" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.6.cmml">♡</mi></mrow></msup><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.1.1.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><eq id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"></eq><ci id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3">𝑉</ci><apply id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1"><times id="S3.SS3.p4.4.m4.1.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.2"></times><apply id="S3.SS3.p4.4.m4.1.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.3.2">𝐷</ci><ci id="S3.SS3.p4.4.m4.1.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.3.3">𝑉</ci></apply><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.2">𝒛</ci><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3"><times id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.4.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.4">𝑤</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.5.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.5">𝑛</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.6.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.3.6">♡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">V=D_{V}({\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}}^{down\heartsuit}})</annotation></semantics></math>.
We then use <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">V</annotation></semantics></math> as a reference to judge whether the follower’s global position <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}^{\heartsuit}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><msup id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">𝒒</mi><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">♡</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝒒</ci><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">♡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}^{\heartsuit}</annotation></semantics></math>, calculated from translation, synchronizes with the lower body movement by computing a difference <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">\delta</annotation></semantics></math> as
<math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="\delta=\sum_{u=0}^{d-1}\|\dot{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}}^{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\heartsuit}_{t\cdot d+u}-{V}_{t\cdot d+u}\|/d" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><mrow id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml"><mi id="S3.SS3.p4.8.m8.1.1.3" xref="S3.SS3.p4.8.m8.1.1.3.cmml">δ</mi><mo rspace="0.111em" id="S3.SS3.p4.8.m8.1.1.2" xref="S3.SS3.p4.8.m8.1.1.2.cmml">=</mo><mrow id="S3.SS3.p4.8.m8.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.cmml"><msubsup id="S3.SS3.p4.8.m8.1.1.1.2" xref="S3.SS3.p4.8.m8.1.1.1.2.cmml"><mo rspace="0em" id="S3.SS3.p4.8.m8.1.1.1.2.2.2" xref="S3.SS3.p4.8.m8.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p4.8.m8.1.1.1.2.2.3" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.cmml"><mi id="S3.SS3.p4.8.m8.1.1.1.2.2.3.2" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.2.cmml">u</mi><mo id="S3.SS3.p4.8.m8.1.1.1.2.2.3.1" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p4.8.m8.1.1.1.2.2.3.3" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.SS3.p4.8.m8.1.1.1.2.3" xref="S3.SS3.p4.8.m8.1.1.1.2.3.cmml"><mi id="S3.SS3.p4.8.m8.1.1.1.2.3.2" xref="S3.SS3.p4.8.m8.1.1.1.2.3.2.cmml">d</mi><mo id="S3.SS3.p4.8.m8.1.1.1.2.3.1" xref="S3.SS3.p4.8.m8.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.p4.8.m8.1.1.1.2.3.3" xref="S3.SS3.p4.8.m8.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.SS3.p4.8.m8.1.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.1.cmml"><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.cmml"><msubsup id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml">𝒒</mi><mo id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.1.cmml">˙</mo></mover><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.2.cmml">t</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.1.cmml">⋅</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.3.cmml">d</mi></mrow><mo id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.3.cmml">u</mi></mrow><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.3.cmml">♡</mi></msubsup><mo id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.2.cmml">V</mi><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.2" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.2.cmml">t</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.1.cmml">⋅</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.1" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.3.cmml">u</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.p4.8.m8.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.SS3.p4.8.m8.1.1.1.1.2" xref="S3.SS3.p4.8.m8.1.1.1.1.2.cmml">/</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1.3" xref="S3.SS3.p4.8.m8.1.1.1.1.3.cmml">d</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><apply id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1"><eq id="S3.SS3.p4.8.m8.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.2"></eq><ci id="S3.SS3.p4.8.m8.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.3">𝛿</ci><apply id="S3.SS3.p4.8.m8.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1"><apply id="S3.SS3.p4.8.m8.1.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.8.m8.1.1.1.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.2.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2">subscript</csymbol><sum id="S3.SS3.p4.8.m8.1.1.1.2.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.2.2"></sum><apply id="S3.SS3.p4.8.m8.1.1.1.2.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3"><eq id="S3.SS3.p4.8.m8.1.1.1.2.2.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.1"></eq><ci id="S3.SS3.p4.8.m8.1.1.1.2.2.3.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.2">𝑢</ci><cn type="integer" id="S3.SS3.p4.8.m8.1.1.1.2.2.3.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.SS3.p4.8.m8.1.1.1.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.3"><minus id="S3.SS3.p4.8.m8.1.1.1.2.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.3.1"></minus><ci id="S3.SS3.p4.8.m8.1.1.1.2.3.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.3.2">𝑑</ci><cn type="integer" id="S3.SS3.p4.8.m8.1.1.1.2.3.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p4.8.m8.1.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1"><divide id="S3.SS3.p4.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.2"></divide><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p4.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1"><minus id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.1"></minus><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2"><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.1">˙</ci><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.2.2">𝒒</ci></apply><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.2.3">♡</ci></apply><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3"><plus id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.1"></plus><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2"><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.1">⋅</ci><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.2">𝑡</ci><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.2">𝑉</ci><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3"><plus id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.1"></plus><apply id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2"><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.1">⋅</ci><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.2">𝑡</ci><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.1.1.1.3.3.3">𝑢</ci></apply></apply></apply></apply><ci id="S3.SS3.p4.8.m8.1.1.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">\delta=\sum_{u=0}^{d-1}\|\dot{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}}^{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\heartsuit}_{t\cdot d+u}-{V}_{t\cdot d+u}\|/d</annotation></semantics></math>, where <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="\dot{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}}^{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\heartsuit}" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><msup id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml"><mover accent="true" id="S3.SS3.p4.9.m9.1.1.2" xref="S3.SS3.p4.9.m9.1.1.2.cmml"><mi mathcolor="#C93756" id="S3.SS3.p4.9.m9.1.1.2.2" xref="S3.SS3.p4.9.m9.1.1.2.2.cmml">𝒒</mi><mo id="S3.SS3.p4.9.m9.1.1.2.1" xref="S3.SS3.p4.9.m9.1.1.2.1.cmml">˙</mo></mover><mi mathcolor="#C93756" mathvariant="normal" id="S3.SS3.p4.9.m9.1.1.3" xref="S3.SS3.p4.9.m9.1.1.3.cmml">♡</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><apply id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">superscript</csymbol><apply id="S3.SS3.p4.9.m9.1.1.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2"><ci id="S3.SS3.p4.9.m9.1.1.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1.2.1">˙</ci><ci id="S3.SS3.p4.9.m9.1.1.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2.2">𝒒</ci></apply><ci id="S3.SS3.p4.9.m9.1.1.3.cmml" xref="S3.SS3.p4.9.m9.1.1.3">♡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">\dot{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{q}}}^{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}\heartsuit}</annotation></semantics></math> is the first derivative approximated by subtraction between adjacent items.
The reward <math id="S3.SS3.p4.10.m10.1" class="ltx_Math" alttext="r^{down}_{t}" display="inline"><semantics id="S3.SS3.p4.10.m10.1a"><msubsup id="S3.SS3.p4.10.m10.1.1" xref="S3.SS3.p4.10.m10.1.1.cmml"><mi id="S3.SS3.p4.10.m10.1.1.2.2" xref="S3.SS3.p4.10.m10.1.1.2.2.cmml">r</mi><mi id="S3.SS3.p4.10.m10.1.1.3" xref="S3.SS3.p4.10.m10.1.1.3.cmml">t</mi><mrow id="S3.SS3.p4.10.m10.1.1.2.3" xref="S3.SS3.p4.10.m10.1.1.2.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.2.3.2" xref="S3.SS3.p4.10.m10.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.10.m10.1.1.2.3.1" xref="S3.SS3.p4.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.10.m10.1.1.2.3.3" xref="S3.SS3.p4.10.m10.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.10.m10.1.1.2.3.1a" xref="S3.SS3.p4.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.10.m10.1.1.2.3.4" xref="S3.SS3.p4.10.m10.1.1.2.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.10.m10.1.1.2.3.1b" xref="S3.SS3.p4.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.10.m10.1.1.2.3.5" xref="S3.SS3.p4.10.m10.1.1.2.3.5.cmml">n</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.1b"><apply id="S3.SS3.p4.10.m10.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1">subscript</csymbol><apply id="S3.SS3.p4.10.m10.1.1.2.cmml" xref="S3.SS3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.2.1.cmml" xref="S3.SS3.p4.10.m10.1.1">superscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.2.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2.2">𝑟</ci><apply id="S3.SS3.p4.10.m10.1.1.2.3.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3"><times id="S3.SS3.p4.10.m10.1.1.2.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3.1"></times><ci id="S3.SS3.p4.10.m10.1.1.2.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3.2">𝑑</ci><ci id="S3.SS3.p4.10.m10.1.1.2.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3.3">𝑜</ci><ci id="S3.SS3.p4.10.m10.1.1.2.3.4.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3.4">𝑤</ci><ci id="S3.SS3.p4.10.m10.1.1.2.3.5.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3.5">𝑛</ci></apply></apply><ci id="S3.SS3.p4.10.m10.1.1.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.1c">r^{down}_{t}</annotation></semantics></math> for lower body at step <math id="S3.SS3.p4.11.m11.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p4.11.m11.1a"><mi id="S3.SS3.p4.11.m11.1.1" xref="S3.SS3.p4.11.m11.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m11.1b"><ci id="S3.SS3.p4.11.m11.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m11.1c">t</annotation></semantics></math> is then defined as</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.4" class="ltx_math_unparsed" alttext="r^{down}_{t}=\left\{\begin{aligned} 1,\,\,\,\,\text{if}\,\,\delta&lt;\text{threshold},\\
-\eta\cdot\delta,\,\,\,\,\,\,\text{otherwise},\end{aligned}\right." display="block"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4b"><msubsup id="S3.E6.m1.4.5"><mi id="S3.E6.m1.4.5.2.2">r</mi><mi id="S3.E6.m1.4.5.3">t</mi><mrow id="S3.E6.m1.4.5.2.3"><mi id="S3.E6.m1.4.5.2.3.2">d</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.5.2.3.1">​</mo><mi id="S3.E6.m1.4.5.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.5.2.3.1a">​</mo><mi id="S3.E6.m1.4.5.2.3.4">w</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.5.2.3.1b">​</mo><mi id="S3.E6.m1.4.5.2.3.5">n</mi></mrow></msubsup><mo id="S3.E6.m1.4.6">=</mo><mrow id="S3.E6.m1.4.7"><mo id="S3.E6.m1.4.7.1">{</mo><mtable displaystyle="true" rowspacing="0pt" id="S3.E6.m1.4.4"><mtr id="S3.E6.m1.4.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.4.4b"><mrow id="S3.E6.m1.2.2.2.2.2.2"><mrow id="S3.E6.m1.2.2.2.2.2.2.1"><mrow id="S3.E6.m1.2.2.2.2.2.2.1.1.1"><mn id="S3.E6.m1.1.1.1.1.1.1">1</mn><mo rspace="0.837em" id="S3.E6.m1.2.2.2.2.2.2.1.1.1.2">,</mo><mrow id="S3.E6.m1.2.2.2.2.2.2.1.1.1.1"><mtext id="S3.E6.m1.2.2.2.2.2.2.1.1.1.1.2">if</mtext><mo lspace="0.330em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.1.1.1.1.1">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.1.1.1.1.3">δ</mi></mrow></mrow><mo id="S3.E6.m1.2.2.2.2.2.2.1.2">&lt;</mo><mtext id="S3.E6.m1.2.2.2.2.2.2.1.3">threshold</mtext></mrow><mo id="S3.E6.m1.2.2.2.2.2.2.2">,</mo></mrow></mtd></mtr><mtr id="S3.E6.m1.4.4c"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.4.4d"><mrow id="S3.E6.m1.4.4.4.2.2.2"><mrow id="S3.E6.m1.4.4.4.2.2.2.1.1"><mrow id="S3.E6.m1.4.4.4.2.2.2.1.1.1"><mo id="S3.E6.m1.4.4.4.2.2.2.1.1.1a">−</mo><mrow id="S3.E6.m1.4.4.4.2.2.2.1.1.1.2"><mi id="S3.E6.m1.4.4.4.2.2.2.1.1.1.2.2">η</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.4.4.4.2.2.2.1.1.1.2.1">⋅</mo><mi id="S3.E6.m1.4.4.4.2.2.2.1.1.1.2.3">δ</mi></mrow></mrow><mo rspace="1.167em" id="S3.E6.m1.4.4.4.2.2.2.1.1.2">,</mo><mtext id="S3.E6.m1.3.3.3.1.1.1">otherwise</mtext></mrow><mo id="S3.E6.m1.4.4.4.2.2.2.2">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.4c">r^{down}_{t}=\left\{\begin{aligned} 1,\,\,\,\,\text{if}\,\,\delta&lt;\text{threshold},\\
-\eta\cdot\delta,\,\,\,\,\,\,\text{otherwise},\end{aligned}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.20" class="ltx_p">where <math id="S3.SS3.p4.12.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS3.p4.12.m1.1a"><mi id="S3.SS3.p4.12.m1.1.1" xref="S3.SS3.p4.12.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m1.1b"><ci id="S3.SS3.p4.12.m1.1.1.cmml" xref="S3.SS3.p4.12.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m1.1c">\eta</annotation></semantics></math> is a parameter to control the punishment magnitude. <math id="S3.SS3.p4.13.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS3.p4.13.m2.1a"><mi id="S3.SS3.p4.13.m2.1.1" xref="S3.SS3.p4.13.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m2.1b"><ci id="S3.SS3.p4.13.m2.1.1.cmml" xref="S3.SS3.p4.13.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m2.1c">\eta</annotation></semantics></math> is set to <math id="S3.SS3.p4.14.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S3.SS3.p4.14.m3.1a"><mn id="S3.SS3.p4.14.m3.1.1" xref="S3.SS3.p4.14.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m3.1b"><cn type="integer" id="S3.SS3.p4.14.m3.1.1.cmml" xref="S3.SS3.p4.14.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m3.1c">100</annotation></semantics></math> and the threshold is <math id="S3.SS3.p4.15.m4.1" class="ltx_Math" alttext="0.03" display="inline"><semantics id="S3.SS3.p4.15.m4.1a"><mn id="S3.SS3.p4.15.m4.1.1" xref="S3.SS3.p4.15.m4.1.1.cmml">0.03</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.15.m4.1b"><cn type="float" id="S3.SS3.p4.15.m4.1.1.cmml" xref="S3.SS3.p4.15.m4.1.1">0.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.15.m4.1c">0.03</annotation></semantics></math> in our experiment.
Rewards for other components (<math id="S3.SS3.p4.16.m5.1" class="ltx_Math" alttext="up" display="inline"><semantics id="S3.SS3.p4.16.m5.1a"><mrow id="S3.SS3.p4.16.m5.1.1" xref="S3.SS3.p4.16.m5.1.1.cmml"><mi id="S3.SS3.p4.16.m5.1.1.2" xref="S3.SS3.p4.16.m5.1.1.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.16.m5.1.1.1" xref="S3.SS3.p4.16.m5.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.16.m5.1.1.3" xref="S3.SS3.p4.16.m5.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.16.m5.1b"><apply id="S3.SS3.p4.16.m5.1.1.cmml" xref="S3.SS3.p4.16.m5.1.1"><times id="S3.SS3.p4.16.m5.1.1.1.cmml" xref="S3.SS3.p4.16.m5.1.1.1"></times><ci id="S3.SS3.p4.16.m5.1.1.2.cmml" xref="S3.SS3.p4.16.m5.1.1.2">𝑢</ci><ci id="S3.SS3.p4.16.m5.1.1.3.cmml" xref="S3.SS3.p4.16.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.16.m5.1c">up</annotation></semantics></math>, <math id="S3.SS3.p4.17.m6.1" class="ltx_Math" alttext="lhand" display="inline"><semantics id="S3.SS3.p4.17.m6.1a"><mrow id="S3.SS3.p4.17.m6.1.1" xref="S3.SS3.p4.17.m6.1.1.cmml"><mi id="S3.SS3.p4.17.m6.1.1.2" xref="S3.SS3.p4.17.m6.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m6.1.1.1" xref="S3.SS3.p4.17.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.17.m6.1.1.3" xref="S3.SS3.p4.17.m6.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m6.1.1.1a" xref="S3.SS3.p4.17.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.17.m6.1.1.4" xref="S3.SS3.p4.17.m6.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m6.1.1.1b" xref="S3.SS3.p4.17.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.17.m6.1.1.5" xref="S3.SS3.p4.17.m6.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m6.1.1.1c" xref="S3.SS3.p4.17.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.17.m6.1.1.6" xref="S3.SS3.p4.17.m6.1.1.6.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.17.m6.1b"><apply id="S3.SS3.p4.17.m6.1.1.cmml" xref="S3.SS3.p4.17.m6.1.1"><times id="S3.SS3.p4.17.m6.1.1.1.cmml" xref="S3.SS3.p4.17.m6.1.1.1"></times><ci id="S3.SS3.p4.17.m6.1.1.2.cmml" xref="S3.SS3.p4.17.m6.1.1.2">𝑙</ci><ci id="S3.SS3.p4.17.m6.1.1.3.cmml" xref="S3.SS3.p4.17.m6.1.1.3">ℎ</ci><ci id="S3.SS3.p4.17.m6.1.1.4.cmml" xref="S3.SS3.p4.17.m6.1.1.4">𝑎</ci><ci id="S3.SS3.p4.17.m6.1.1.5.cmml" xref="S3.SS3.p4.17.m6.1.1.5">𝑛</ci><ci id="S3.SS3.p4.17.m6.1.1.6.cmml" xref="S3.SS3.p4.17.m6.1.1.6">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.17.m6.1c">lhand</annotation></semantics></math>, <math id="S3.SS3.p4.18.m7.1" class="ltx_Math" alttext="rhand" display="inline"><semantics id="S3.SS3.p4.18.m7.1a"><mrow id="S3.SS3.p4.18.m7.1.1" xref="S3.SS3.p4.18.m7.1.1.cmml"><mi id="S3.SS3.p4.18.m7.1.1.2" xref="S3.SS3.p4.18.m7.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m7.1.1.1" xref="S3.SS3.p4.18.m7.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m7.1.1.3" xref="S3.SS3.p4.18.m7.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m7.1.1.1a" xref="S3.SS3.p4.18.m7.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m7.1.1.4" xref="S3.SS3.p4.18.m7.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m7.1.1.1b" xref="S3.SS3.p4.18.m7.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m7.1.1.5" xref="S3.SS3.p4.18.m7.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m7.1.1.1c" xref="S3.SS3.p4.18.m7.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m7.1.1.6" xref="S3.SS3.p4.18.m7.1.1.6.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.18.m7.1b"><apply id="S3.SS3.p4.18.m7.1.1.cmml" xref="S3.SS3.p4.18.m7.1.1"><times id="S3.SS3.p4.18.m7.1.1.1.cmml" xref="S3.SS3.p4.18.m7.1.1.1"></times><ci id="S3.SS3.p4.18.m7.1.1.2.cmml" xref="S3.SS3.p4.18.m7.1.1.2">𝑟</ci><ci id="S3.SS3.p4.18.m7.1.1.3.cmml" xref="S3.SS3.p4.18.m7.1.1.3">ℎ</ci><ci id="S3.SS3.p4.18.m7.1.1.4.cmml" xref="S3.SS3.p4.18.m7.1.1.4">𝑎</ci><ci id="S3.SS3.p4.18.m7.1.1.5.cmml" xref="S3.SS3.p4.18.m7.1.1.5">𝑛</ci><ci id="S3.SS3.p4.18.m7.1.1.6.cmml" xref="S3.SS3.p4.18.m7.1.1.6">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.18.m7.1c">rhand</annotation></semantics></math> and <math id="S3.SS3.p4.19.m8.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S3.SS3.p4.19.m8.1a"><mrow id="S3.SS3.p4.19.m8.1.1" xref="S3.SS3.p4.19.m8.1.1.cmml"><mi id="S3.SS3.p4.19.m8.1.1.2" xref="S3.SS3.p4.19.m8.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.19.m8.1.1.1" xref="S3.SS3.p4.19.m8.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.19.m8.1.1.3" xref="S3.SS3.p4.19.m8.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.19.m8.1b"><apply id="S3.SS3.p4.19.m8.1.1.cmml" xref="S3.SS3.p4.19.m8.1.1"><times id="S3.SS3.p4.19.m8.1.1.1.cmml" xref="S3.SS3.p4.19.m8.1.1.1"></times><ci id="S3.SS3.p4.19.m8.1.1.2.cmml" xref="S3.SS3.p4.19.m8.1.1.2">𝑡</ci><ci id="S3.SS3.p4.19.m8.1.1.3.cmml" xref="S3.SS3.p4.19.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.19.m8.1c">tr</annotation></semantics></math>) are consistent to be <math id="S3.SS3.p4.20.m9.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS3.p4.20.m9.1a"><mn id="S3.SS3.p4.20.m9.1.1" xref="S3.SS3.p4.20.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.20.m9.1b"><cn type="integer" id="S3.SS3.p4.20.m9.1.1.cmml" xref="S3.SS3.p4.20.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.20.m9.1c">1</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">Detailed descriptions and implementations of the VQ-VAE and GPT are in Appendix <a href="#A2" title="Appendix B More details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.8" class="ltx_p"><span id="S4.p2.8.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span>
We apply a series of quantitative metrics to evaluate the generated follower’s movement in three distinct aspects: <span id="S4.p2.8.2" class="ltx_text ltx_font_bold">(1)</span> the inherent quality of the follower’s motion, independent of its interaction with the leader, <span id="S4.p2.8.3" class="ltx_text ltx_font_bold">(2)</span> the follower’s interaction with the leader, and <span id="S4.p2.8.4" class="ltx_text ltx_font_bold">(3)</span> the alignment of the dance with the background music.
For <span id="S4.p2.8.5" class="ltx_text ltx_font_bold">(1)</span>,
we adopt metrics used in the solo dance benchmark AIST++ <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>)</cite>.
Specifically, we compute the Fréchet Inception Distance (FID) between the generated follower’s motion and the real dance in the whole <span id="S4.p2.8.6" class="ltx_text ltx_font_typewriter">DD100</span> dataset on kinematic (denoted as “<math id="S4.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">k</annotation></semantics></math>”) <cite class="ltx_cite ltx_citemacro_citep">(Onuma et al., <a href="#bib.bib35" title="" class="ltx_ref">2008</a>)</cite> and graphical (denoted as “<math id="S4.p2.2.m2.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">g</annotation></semantics></math>”) <cite class="ltx_cite ltx_citemacro_citep">(Müller et al., <a href="#bib.bib32" title="" class="ltx_ref">2005</a>)</cite> features, and compute the standard deviation between features of the generated follower sequences as the diversities Div<sub id="S4.p2.8.7" class="ltx_sub"><span id="S4.p2.8.7.1" class="ltx_text ltx_font_italic">k</span></sub> and Div<sub id="S4.p2.8.8" class="ltx_sub"><span id="S4.p2.8.8.1" class="ltx_text ltx_font_italic">g</span></sub> that indicate the difference among those sequences.
As to <span id="S4.p2.8.9" class="ltx_text ltx_font_bold">(2)</span>, the interactive quality, we first extract a <span id="S4.p2.8.10" class="ltx_text ltx_font_italic">cross-distance</span> (<math id="S4.p2.5.m5.1" class="ltx_Math" alttext="cd" display="inline"><semantics id="S4.p2.5.m5.1a"><mrow id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.p2.5.m5.1.1.1" xref="S4.p2.5.m5.1.1.1.cmml">​</mo><mi id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><times id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1"></times><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝑐</ci><ci id="S4.p2.5.m5.1.1.3.cmml" xref="S4.p2.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">cd</annotation></semantics></math>) feature from the duet dance sequences. Specifically, for each frame, we calculate the pairwise distances between ten joints’ positions, including the pelvis, both knees, feet, shoulders, the head, and two twists, of the leader and those of the follower to obtain a 100-dimension (<math id="S4.p2.6.m6.1" class="ltx_Math" alttext="10\times 10" display="inline"><semantics id="S4.p2.6.m6.1a"><mrow id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml"><mn id="S4.p2.6.m6.1.1.2" xref="S4.p2.6.m6.1.1.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S4.p2.6.m6.1.1.1" xref="S4.p2.6.m6.1.1.1.cmml">×</mo><mn id="S4.p2.6.m6.1.1.3" xref="S4.p2.6.m6.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><apply id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1"><times id="S4.p2.6.m6.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1"></times><cn type="integer" id="S4.p2.6.m6.1.1.2.cmml" xref="S4.p2.6.m6.1.1.2">10</cn><cn type="integer" id="S4.p2.6.m6.1.1.3.cmml" xref="S4.p2.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">10\times 10</annotation></semantics></math>) features.
Then, we use these distances as an interactive feature and compute the FID<sub id="S4.p2.8.11" class="ltx_sub"><span id="S4.p2.8.11.1" class="ltx_text ltx_font_italic">cd</span></sub> and Div<sub id="S4.p2.8.12" class="ltx_sub"><span id="S4.p2.8.12.1" class="ltx_text ltx_font_italic">cd</span></sub>.
Meanwhile, we compute contact frequency (CF) value to explicitly explore the strength of interaction.
CF is defined as the ratio of the number of frames in which two dancers are in physical contact, where physical contact is defined as two SMPL-X models having a minimum absolute mesh distance below a 2-<span id="S4.p2.8.13" class="ltx_text ltx_font_italic">cm</span> threshold.
Finally, we define Beat Echo Degree (BED) to evaluate the consistency of dynamic rhythms of two dancers:
</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.4" class="ltx_Math" alttext="\frac{1}{|B^{l}|}\sum_{t^{l}\in B^{l}}\exp{\left\{-\frac{\min_{t^{f}\in B^{f}}{\|t^{l}-t^{f}\|^{2}}}{2\sigma^{2}}\right\}}," display="block"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml"><mfrac id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mn id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">1</mn><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">B</mi><mi id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.cmml"><munder id="S4.E7.m1.4.4.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E7.m1.4.4.1.1.1.2.2" xref="S4.E7.m1.4.4.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.4.4.1.1.1.2.3" xref="S4.E7.m1.4.4.1.1.1.2.3.cmml"><msup id="S4.E7.m1.4.4.1.1.1.2.3.2" xref="S4.E7.m1.4.4.1.1.1.2.3.2.cmml"><mi id="S4.E7.m1.4.4.1.1.1.2.3.2.2" xref="S4.E7.m1.4.4.1.1.1.2.3.2.2.cmml">t</mi><mi id="S4.E7.m1.4.4.1.1.1.2.3.2.3" xref="S4.E7.m1.4.4.1.1.1.2.3.2.3.cmml">l</mi></msup><mo id="S4.E7.m1.4.4.1.1.1.2.3.1" xref="S4.E7.m1.4.4.1.1.1.2.3.1.cmml">∈</mo><msup id="S4.E7.m1.4.4.1.1.1.2.3.3" xref="S4.E7.m1.4.4.1.1.1.2.3.3.cmml"><mi id="S4.E7.m1.4.4.1.1.1.2.3.3.2" xref="S4.E7.m1.4.4.1.1.1.2.3.3.2.cmml">B</mi><mi id="S4.E7.m1.4.4.1.1.1.2.3.3.3" xref="S4.E7.m1.4.4.1.1.1.2.3.3.3.cmml">l</mi></msup></mrow></munder><mrow id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">exp</mi><mo id="S4.E7.m1.4.4.1.1.1.1.1a" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">{</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1a" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml"><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.cmml"><msub id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.2.cmml"><mi id="S4.E7.m1.2.2.1.2.2" xref="S4.E7.m1.2.2.1.2.2.cmml">min</mi><mrow id="S4.E7.m1.2.2.1.2.3" xref="S4.E7.m1.2.2.1.2.3.cmml"><msup id="S4.E7.m1.2.2.1.2.3.2" xref="S4.E7.m1.2.2.1.2.3.2.cmml"><mi id="S4.E7.m1.2.2.1.2.3.2.2" xref="S4.E7.m1.2.2.1.2.3.2.2.cmml">t</mi><mi id="S4.E7.m1.2.2.1.2.3.2.3" xref="S4.E7.m1.2.2.1.2.3.2.3.cmml">f</mi></msup><mo id="S4.E7.m1.2.2.1.2.3.1" xref="S4.E7.m1.2.2.1.2.3.1.cmml">∈</mo><msup id="S4.E7.m1.2.2.1.2.3.3" xref="S4.E7.m1.2.2.1.2.3.3.cmml"><mi id="S4.E7.m1.2.2.1.2.3.3.2" xref="S4.E7.m1.2.2.1.2.3.3.2.cmml">B</mi><mi id="S4.E7.m1.2.2.1.2.3.3.3" xref="S4.E7.m1.2.2.1.2.3.3.3.cmml">f</mi></msup></mrow></msub><mo id="S4.E7.m1.2.2.1a" xref="S4.E7.m1.2.2.1.cmml">⁡</mo><msup id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.cmml"><msup id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.2.2" xref="S4.E7.m1.2.2.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.2.3" xref="S4.E7.m1.2.2.1.1.1.1.1.2.3.cmml">l</mi></msup><mo id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.3.2" xref="S4.E7.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.3.3" xref="S4.E7.m1.2.2.1.1.1.1.1.3.3.cmml">f</mi></msup></mrow><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.1.3.cmml">2</mn></msup></mrow><mrow id="S4.E7.m1.2.2.3" xref="S4.E7.m1.2.2.3.cmml"><mn id="S4.E7.m1.2.2.3.2" xref="S4.E7.m1.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.3.1" xref="S4.E7.m1.2.2.3.1.cmml">​</mo><msup id="S4.E7.m1.2.2.3.3" xref="S4.E7.m1.2.2.3.3.cmml"><mi id="S4.E7.m1.2.2.3.3.2" xref="S4.E7.m1.2.2.3.3.2.cmml">σ</mi><mn id="S4.E7.m1.2.2.3.3.3" xref="S4.E7.m1.2.2.3.3.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1"><times id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2"></times><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><divide id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"></divide><cn type="integer" id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3">1</cn><apply id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1"><abs id="S4.E7.m1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2"></abs><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2">𝐵</ci><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1"><apply id="S4.E7.m1.4.4.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.4.4.1.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2.2"></sum><apply id="S4.E7.m1.4.4.1.1.1.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3"><in id="S4.E7.m1.4.4.1.1.1.2.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.1"></in><apply id="S4.E7.m1.4.4.1.1.1.2.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.2.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.2">superscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.2.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.2.2">𝑡</ci><ci id="S4.E7.m1.4.4.1.1.1.2.3.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.2.3">𝑙</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.2.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.2.3.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.3">superscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.2.3.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.3.2">𝐵</ci><ci id="S4.E7.m1.4.4.1.1.1.2.3.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.2.3.3.3">𝑙</ci></apply></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1"><exp id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"></exp><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1"><minus id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"><divide id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2"></divide><apply id="S4.E7.m1.2.2.1.cmml" xref="S4.E7.m1.2.2.1"><apply id="S4.E7.m1.2.2.1.2.cmml" xref="S4.E7.m1.2.2.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.2.1.cmml" xref="S4.E7.m1.2.2.1.2">subscript</csymbol><min id="S4.E7.m1.2.2.1.2.2.cmml" xref="S4.E7.m1.2.2.1.2.2"></min><apply id="S4.E7.m1.2.2.1.2.3.cmml" xref="S4.E7.m1.2.2.1.2.3"><in id="S4.E7.m1.2.2.1.2.3.1.cmml" xref="S4.E7.m1.2.2.1.2.3.1"></in><apply id="S4.E7.m1.2.2.1.2.3.2.cmml" xref="S4.E7.m1.2.2.1.2.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.2.3.2.1.cmml" xref="S4.E7.m1.2.2.1.2.3.2">superscript</csymbol><ci id="S4.E7.m1.2.2.1.2.3.2.2.cmml" xref="S4.E7.m1.2.2.1.2.3.2.2">𝑡</ci><ci id="S4.E7.m1.2.2.1.2.3.2.3.cmml" xref="S4.E7.m1.2.2.1.2.3.2.3">𝑓</ci></apply><apply id="S4.E7.m1.2.2.1.2.3.3.cmml" xref="S4.E7.m1.2.2.1.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.2.3.3.1.cmml" xref="S4.E7.m1.2.2.1.2.3.3">superscript</csymbol><ci id="S4.E7.m1.2.2.1.2.3.3.2.cmml" xref="S4.E7.m1.2.2.1.2.3.3.2">𝐵</ci><ci id="S4.E7.m1.2.2.1.2.3.3.3.cmml" xref="S4.E7.m1.2.2.1.2.3.3.3">𝑓</ci></apply></apply></apply><apply id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1">superscript</csymbol><apply id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="S4.E7.m1.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1"><minus id="S4.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E7.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply><cn type="integer" id="S4.E7.m1.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.3">2</cn></apply></apply><apply id="S4.E7.m1.2.2.3.cmml" xref="S4.E7.m1.2.2.3"><times id="S4.E7.m1.2.2.3.1.cmml" xref="S4.E7.m1.2.2.3.1"></times><cn type="integer" id="S4.E7.m1.2.2.3.2.cmml" xref="S4.E7.m1.2.2.3.2">2</cn><apply id="S4.E7.m1.2.2.3.3.cmml" xref="S4.E7.m1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.3.3.1.cmml" xref="S4.E7.m1.2.2.3.3">superscript</csymbol><ci id="S4.E7.m1.2.2.3.3.2.cmml" xref="S4.E7.m1.2.2.3.3.2">𝜎</ci><cn type="integer" id="S4.E7.m1.2.2.3.3.3.cmml" xref="S4.E7.m1.2.2.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\frac{1}{|B^{l}|}\sum_{t^{l}\in B^{l}}\exp{\left\{-\frac{\min_{t^{f}\in B^{f}}{\|t^{l}-t^{f}\|^{2}}}{2\sigma^{2}}\right\}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.12" class="ltx_p">where <math id="S4.p2.9.m1.1" class="ltx_Math" alttext="B^{l}=\{t^{l}\}" display="inline"><semantics id="S4.p2.9.m1.1a"><mrow id="S4.p2.9.m1.1.1" xref="S4.p2.9.m1.1.1.cmml"><msup id="S4.p2.9.m1.1.1.3" xref="S4.p2.9.m1.1.1.3.cmml"><mi id="S4.p2.9.m1.1.1.3.2" xref="S4.p2.9.m1.1.1.3.2.cmml">B</mi><mi id="S4.p2.9.m1.1.1.3.3" xref="S4.p2.9.m1.1.1.3.3.cmml">l</mi></msup><mo id="S4.p2.9.m1.1.1.2" xref="S4.p2.9.m1.1.1.2.cmml">=</mo><mrow id="S4.p2.9.m1.1.1.1.1" xref="S4.p2.9.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p2.9.m1.1.1.1.1.2" xref="S4.p2.9.m1.1.1.1.2.cmml">{</mo><msup id="S4.p2.9.m1.1.1.1.1.1" xref="S4.p2.9.m1.1.1.1.1.1.cmml"><mi id="S4.p2.9.m1.1.1.1.1.1.2" xref="S4.p2.9.m1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.p2.9.m1.1.1.1.1.1.3" xref="S4.p2.9.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.p2.9.m1.1.1.1.1.3" xref="S4.p2.9.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.9.m1.1b"><apply id="S4.p2.9.m1.1.1.cmml" xref="S4.p2.9.m1.1.1"><eq id="S4.p2.9.m1.1.1.2.cmml" xref="S4.p2.9.m1.1.1.2"></eq><apply id="S4.p2.9.m1.1.1.3.cmml" xref="S4.p2.9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.9.m1.1.1.3.1.cmml" xref="S4.p2.9.m1.1.1.3">superscript</csymbol><ci id="S4.p2.9.m1.1.1.3.2.cmml" xref="S4.p2.9.m1.1.1.3.2">𝐵</ci><ci id="S4.p2.9.m1.1.1.3.3.cmml" xref="S4.p2.9.m1.1.1.3.3">𝑙</ci></apply><set id="S4.p2.9.m1.1.1.1.2.cmml" xref="S4.p2.9.m1.1.1.1.1"><apply id="S4.p2.9.m1.1.1.1.1.1.cmml" xref="S4.p2.9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.9.m1.1.1.1.1.1.1.cmml" xref="S4.p2.9.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.p2.9.m1.1.1.1.1.1.2.cmml" xref="S4.p2.9.m1.1.1.1.1.1.2">𝑡</ci><ci id="S4.p2.9.m1.1.1.1.1.1.3.cmml" xref="S4.p2.9.m1.1.1.1.1.1.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m1.1c">B^{l}=\{t^{l}\}</annotation></semantics></math> and <math id="S4.p2.10.m2.1" class="ltx_Math" alttext="B^{f}=\{t^{f}\}" display="inline"><semantics id="S4.p2.10.m2.1a"><mrow id="S4.p2.10.m2.1.1" xref="S4.p2.10.m2.1.1.cmml"><msup id="S4.p2.10.m2.1.1.3" xref="S4.p2.10.m2.1.1.3.cmml"><mi id="S4.p2.10.m2.1.1.3.2" xref="S4.p2.10.m2.1.1.3.2.cmml">B</mi><mi id="S4.p2.10.m2.1.1.3.3" xref="S4.p2.10.m2.1.1.3.3.cmml">f</mi></msup><mo id="S4.p2.10.m2.1.1.2" xref="S4.p2.10.m2.1.1.2.cmml">=</mo><mrow id="S4.p2.10.m2.1.1.1.1" xref="S4.p2.10.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.p2.10.m2.1.1.1.1.2" xref="S4.p2.10.m2.1.1.1.2.cmml">{</mo><msup id="S4.p2.10.m2.1.1.1.1.1" xref="S4.p2.10.m2.1.1.1.1.1.cmml"><mi id="S4.p2.10.m2.1.1.1.1.1.2" xref="S4.p2.10.m2.1.1.1.1.1.2.cmml">t</mi><mi id="S4.p2.10.m2.1.1.1.1.1.3" xref="S4.p2.10.m2.1.1.1.1.1.3.cmml">f</mi></msup><mo stretchy="false" id="S4.p2.10.m2.1.1.1.1.3" xref="S4.p2.10.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.10.m2.1b"><apply id="S4.p2.10.m2.1.1.cmml" xref="S4.p2.10.m2.1.1"><eq id="S4.p2.10.m2.1.1.2.cmml" xref="S4.p2.10.m2.1.1.2"></eq><apply id="S4.p2.10.m2.1.1.3.cmml" xref="S4.p2.10.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p2.10.m2.1.1.3.1.cmml" xref="S4.p2.10.m2.1.1.3">superscript</csymbol><ci id="S4.p2.10.m2.1.1.3.2.cmml" xref="S4.p2.10.m2.1.1.3.2">𝐵</ci><ci id="S4.p2.10.m2.1.1.3.3.cmml" xref="S4.p2.10.m2.1.1.3.3">𝑓</ci></apply><set id="S4.p2.10.m2.1.1.1.2.cmml" xref="S4.p2.10.m2.1.1.1.1"><apply id="S4.p2.10.m2.1.1.1.1.1.cmml" xref="S4.p2.10.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.10.m2.1.1.1.1.1.1.cmml" xref="S4.p2.10.m2.1.1.1.1.1">superscript</csymbol><ci id="S4.p2.10.m2.1.1.1.1.1.2.cmml" xref="S4.p2.10.m2.1.1.1.1.1.2">𝑡</ci><ci id="S4.p2.10.m2.1.1.1.1.1.3.cmml" xref="S4.p2.10.m2.1.1.1.1.1.3">𝑓</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m2.1c">B^{f}=\{t^{f}\}</annotation></semantics></math> represent the timing of beats in the leader and follower movements, respectively, while the motion beat time is calculated by finding the local minimum time of the motion velocity; <math id="S4.p2.11.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.p2.11.m3.1a"><mi id="S4.p2.11.m3.1.1" xref="S4.p2.11.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.11.m3.1b"><ci id="S4.p2.11.m3.1.1.cmml" xref="S4.p2.11.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m3.1c">\sigma</annotation></semantics></math> is a normalization parameter (<math id="S4.p2.12.m4.1" class="ltx_Math" alttext="\sigma=3" display="inline"><semantics id="S4.p2.12.m4.1a"><mrow id="S4.p2.12.m4.1.1" xref="S4.p2.12.m4.1.1.cmml"><mi id="S4.p2.12.m4.1.1.2" xref="S4.p2.12.m4.1.1.2.cmml">σ</mi><mo id="S4.p2.12.m4.1.1.1" xref="S4.p2.12.m4.1.1.1.cmml">=</mo><mn id="S4.p2.12.m4.1.1.3" xref="S4.p2.12.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.12.m4.1b"><apply id="S4.p2.12.m4.1.1.cmml" xref="S4.p2.12.m4.1.1"><eq id="S4.p2.12.m4.1.1.1.cmml" xref="S4.p2.12.m4.1.1.1"></eq><ci id="S4.p2.12.m4.1.1.2.cmml" xref="S4.p2.12.m4.1.1.2">𝜎</ci><cn type="integer" id="S4.p2.12.m4.1.1.3.cmml" xref="S4.p2.12.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m4.1c">\sigma=3</annotation></semantics></math> in our experiments).
The BED takes a similar formulation as the Beat-Align Score (BAS) <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>, where the reference base is substituted with leader’s dynamic beats instead of the music’s rhythmic beats.
For <span id="S4.p2.12.1" class="ltx_text ltx_font_bold">(3)</span>, we adopt the BAS defined by <cite class="ltx_cite ltx_citemacro_cite">Siyao et al. (<a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>, to assess the correspondence between the generated motion and the rhythm of the background music.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S4.T2.21.1" class="ltx_text ltx_font_bold">Quantitative benchmark for dance accompaniment.</span> The first place and runner-up are highlighted in bold and underlined, respectively.
<span id="S4.T2.22.2" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#BF8040;background-color:#FFFF00;">S</span> denotes a solo dance generation model that does not take the leader into condition, while <span id="S4.T2.23.3" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#008080;background-color:#BFFF00;">D</span> denotes that one does.
<span id="S4.T2.24.4" class="ltx_text" style="color:#000000;">*Since solo dance has no interaction, the cross-distance between two agents are completely irregular, making the diversity particularly high.</span>
</figcaption>
<table id="S4.T2.16" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.16.17" class="ltx_tr">
<td id="S4.T2.16.17.1" class="ltx_td ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td id="S4.T2.16.17.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="4">Solo Metrics</td>
<td id="S4.T2.16.17.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="4">Interactive Metrics</td>
<td id="S4.T2.16.17.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">Rhythmic</td>
</tr>
<tr id="S4.T2.14.14" class="ltx_tr">
<td id="S4.T2.14.14.15" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">Method</td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="S4.T2.2.2.2.1" class="ltx_sub"><span id="S4.T2.2.2.2.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="S4.T2.2.2.2.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T2.2.2.2.m2.1.1" xref="S4.T2.2.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m2.1b"><ci id="S4.T2.2.2.2.m2.1.1.cmml" xref="S4.T2.2.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="S4.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="S4.T2.4.4.4.1" class="ltx_sub"><span id="S4.T2.4.4.4.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="S4.T2.4.4.4.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.4.4.4.m2.1a"><mo stretchy="false" id="S4.T2.4.4.4.m2.1.1" xref="S4.T2.4.4.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m2.1b"><ci id="S4.T2.4.4.4.m2.1.1.cmml" xref="S4.T2.4.4.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="S4.T2.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="S4.T2.6.6.6.1" class="ltx_sub"><span id="S4.T2.6.6.6.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="S4.T2.6.6.6.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.6.6.6.m2.1a"><mo stretchy="false" id="S4.T2.6.6.6.m2.1.1" xref="S4.T2.6.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.m2.1b"><ci id="S4.T2.6.6.6.m2.1.1.cmml" xref="S4.T2.6.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S4.T2.8.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="S4.T2.8.8.8.1" class="ltx_sub"><span id="S4.T2.8.8.8.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="S4.T2.8.8.8.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.8.8.8.m2.1a"><mo stretchy="false" id="S4.T2.8.8.8.m2.1.1" xref="S4.T2.8.8.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.m2.1b"><ci id="S4.T2.8.8.8.m2.1.1.cmml" xref="S4.T2.8.8.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S4.T2.10.10.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="S4.T2.10.10.10.1" class="ltx_sub"><span id="S4.T2.10.10.10.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="S4.T2.10.10.10.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.10.10.10.m2.1a"><mo stretchy="false" id="S4.T2.10.10.10.m2.1.1" xref="S4.T2.10.10.10.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.m2.1b"><ci id="S4.T2.10.10.10.m2.1.1.cmml" xref="S4.T2.10.10.10.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="S4.T2.12.12.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="S4.T2.12.12.12.1" class="ltx_sub"><span id="S4.T2.12.12.12.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="S4.T2.12.12.12.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.12.12.12.m2.1a"><mo stretchy="false" id="S4.T2.12.12.12.m2.1.1" xref="S4.T2.12.12.12.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.m2.1b"><ci id="S4.T2.12.12.12.m2.1.1.cmml" xref="S4.T2.12.12.12.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S4.T2.14.14.16" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">CF(%)</td>
<td id="S4.T2.13.13.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">BED(<math id="S4.T2.13.13.13.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.13.13.13.m1.1a"><mo stretchy="false" id="S4.T2.13.13.13.m1.1.1" xref="S4.T2.13.13.13.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.m1.1b"><ci id="S4.T2.13.13.13.m1.1.1.cmml" xref="S4.T2.13.13.13.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.m1.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S4.T2.14.14.14" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">BAS(<math id="S4.T2.14.14.14.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.14.14.14.m1.1a"><mo stretchy="false" id="S4.T2.14.14.14.m1.1.1" xref="S4.T2.14.14.14.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.m1.1b"><ci id="S4.T2.14.14.14.m1.1.1.cmml" xref="S4.T2.14.14.14.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.m1.1c">\uparrow</annotation></semantics></math>)</td>
</tr>
<tr id="S4.T2.16.18" class="ltx_tr">
<td id="S4.T2.16.18.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Ground Truth</td>
<td id="S4.T2.16.18.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">    6.56</td>
<td id="S4.T2.16.18.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">   6.37</td>
<td id="S4.T2.16.18.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">11.31</td>
<td id="S4.T2.16.18.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">7.61</td>
<td id="S4.T2.16.18.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">      3.41</td>
<td id="S4.T2.16.18.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">12.35</td>
<td id="S4.T2.16.18.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">74.25</td>
<td id="S4.T2.16.18.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.5308</td>
<td id="S4.T2.16.18.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.1839</td>
</tr>
<tr id="S4.T2.16.19" class="ltx_tr">
<td id="S4.T2.16.19.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.16.19.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#BF8040;background-color:#FFFF00;">S</span> <span id="S4.T2.16.19.1.2" class="ltx_text ltx_font_italic">Bailando</span> <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>
</td>
<td id="S4.T2.16.19.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">  78.52</td>
<td id="S4.T2.16.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">36.19</td>
<td id="S4.T2.16.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">11.15</td>
<td id="S4.T2.16.19.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">7.92</td>
<td id="S4.T2.16.19.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6643.31</td>
<td id="S4.T2.16.19.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">  52.50*</td>
<td id="S4.T2.16.19.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">  7.13</td>
<td id="S4.T2.16.19.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.1831</td>
<td id="S4.T2.16.19.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.1930</td>
</tr>
<tr id="S4.T2.16.20" class="ltx_tr">
<td id="S4.T2.16.20.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.16.20.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#BF8040;background-color:#FFFF00;">S</span> <span id="S4.T2.16.20.1.2" class="ltx_text" style="color:#000000;"> EDGE <cite class="ltx_cite ltx_citemacro_citep">(Tseng et al., <a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite></span>
</td>
<td id="S4.T2.16.20.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  69.14</td>
<td id="S4.T2.16.20.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">44.58</td>
<td id="S4.T2.16.20.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  8.62</td>
<td id="S4.T2.16.20.5" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">6.35</td>
<td id="S4.T2.16.20.6" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">5894.45</td>
<td id="S4.T2.16.20.7" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  60.62*</td>
<td id="S4.T2.16.20.8" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  6.82</td>
<td id="S4.T2.16.20.9" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.1822</td>
<td id="S4.T2.16.20.10" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.1875</td>
</tr>
<tr id="S4.T2.15.15" class="ltx_tr">
<td id="S4.T2.15.15.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.15.15.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#BF8040;background-color:#FFFF00;">S</span> <span id="S4.T2.15.15.1.2" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.T2.15.15.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.T2.15.15.1.m1.1a"><mrow id="S4.T2.15.15.1.m1.1.1" xref="S4.T2.15.15.1.m1.1.1.cmml"><mi id="S4.T2.15.15.1.m1.1.1.2" xref="S4.T2.15.15.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.15.15.1.m1.1.1.1" xref="S4.T2.15.15.1.m1.1.1.1.cmml">​</mo><mi id="S4.T2.15.15.1.m1.1.1.3" xref="S4.T2.15.15.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.1.m1.1b"><apply id="S4.T2.15.15.1.m1.1.1.cmml" xref="S4.T2.15.15.1.m1.1.1"><times id="S4.T2.15.15.1.m1.1.1.1.cmml" xref="S4.T2.15.15.1.m1.1.1.1"></times><ci id="S4.T2.15.15.1.m1.1.1.2.cmml" xref="S4.T2.15.15.1.m1.1.1.2">𝑡</ci><ci id="S4.T2.15.15.1.m1.1.1.3.cmml" xref="S4.T2.15.15.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.1.m1.1c">tr</annotation></semantics></math> IC</td>
<td id="S4.T2.15.15.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">   <span id="S4.T2.15.15.2.1" class="ltx_text ltx_font_bold">12.53</span>
</td>
<td id="S4.T2.15.15.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.15.15.3.1" class="ltx_text ltx_font_bold">24.17</span></td>
<td id="S4.T2.15.15.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">10.51</td>
<td id="S4.T2.15.15.5" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.15.15.5.1" class="ltx_text ltx_font_bold">9.42</span></td>
<td id="S4.T2.15.15.6" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">4803.20</td>
<td id="S4.T2.15.15.7" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  42.72*</td>
<td id="S4.T2.15.15.8" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  7.04</td>
<td id="S4.T2.15.15.9" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.1826</td>
<td id="S4.T2.15.15.10" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.1852</td>
</tr>
<tr id="S4.T2.16.16" class="ltx_tr">
<td id="S4.T2.16.16.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.16.16.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#008080;background-color:#BFFF00;">D</span> <span id="S4.T2.16.16.1.2" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.T2.16.16.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.T2.16.16.1.m1.1a"><mrow id="S4.T2.16.16.1.m1.1.1" xref="S4.T2.16.16.1.m1.1.1.cmml"><mi id="S4.T2.16.16.1.m1.1.1.2" xref="S4.T2.16.16.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.16.16.1.m1.1.1.1" xref="S4.T2.16.16.1.m1.1.1.1.cmml">​</mo><mi id="S4.T2.16.16.1.m1.1.1.3" xref="S4.T2.16.16.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.1.m1.1b"><apply id="S4.T2.16.16.1.m1.1.1.cmml" xref="S4.T2.16.16.1.m1.1.1"><times id="S4.T2.16.16.1.m1.1.1.1.cmml" xref="S4.T2.16.16.1.m1.1.1.1"></times><ci id="S4.T2.16.16.1.m1.1.1.2.cmml" xref="S4.T2.16.16.1.m1.1.1.2">𝑡</ci><ci id="S4.T2.16.16.1.m1.1.1.3.cmml" xref="S4.T2.16.16.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.1.m1.1c">tr</annotation></semantics></math>
</td>
<td id="S4.T2.16.16.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">   62.29</td>
<td id="S4.T2.16.16.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.16.3.1" class="ltx_text ltx_framed ltx_framed_underline">27.95</span></td>
<td id="S4.T2.16.16.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.16.4.1" class="ltx_text ltx_framed ltx_framed_underline">13.16</span></td>
<td id="S4.T2.16.16.5" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.16.5.1" class="ltx_text ltx_framed ltx_framed_underline">8.53</span></td>
<td id="S4.T2.16.16.6" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">7970.19</td>
<td id="S4.T2.16.16.7" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  54.53*</td>
<td id="S4.T2.16.16.8" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  7.76</td>
<td id="S4.T2.16.16.9" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.2194</td>
<td id="S4.T2.16.16.10" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">0.2002</td>
</tr>
<tr id="S4.T2.16.21" class="ltx_tr">
<td id="S4.T2.16.21.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.16.21.1.1" class="ltx_text"><span id="S4.T2.16.21.1.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#008080;background-color:#BFFF00;">D</span></span> <span id="S4.T2.16.21.1.2" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL</td>
<td id="S4.T2.16.21.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">106.72</td>
<td id="S4.T2.16.21.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">34.10</td>
<td id="S4.T2.16.21.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.21.4.1" class="ltx_text ltx_font_bold">13.88</span></td>
<td id="S4.T2.16.21.5" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">7.03</td>
<td id="S4.T2.16.21.6" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">    <span id="S4.T2.16.21.6.1" class="ltx_text ltx_framed ltx_framed_underline">21.68</span>
</td>
<td id="S4.T2.16.21.7" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">  <span id="S4.T2.16.21.7.1" class="ltx_text ltx_framed ltx_framed_underline">9.33</span>
</td>
<td id="S4.T2.16.21.8" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.21.8.1" class="ltx_text ltx_font_bold">57.43</span></td>
<td id="S4.T2.16.21.9" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.21.9.1" class="ltx_text ltx_framed ltx_framed_underline">0.2795</span></td>
<td id="S4.T2.16.21.10" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.21.10.1" class="ltx_text ltx_font_bold">0.2193</span></td>
</tr>
<tr id="S4.T2.16.22" class="ltx_tr">
<td id="S4.T2.16.22.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S4.T2.16.22.1.1" class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#008080;background-color:#BFFF00;">D</span> <span id="S4.T2.16.22.1.2" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span>
</td>
<td id="S4.T2.16.22.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">  <span id="S4.T2.16.22.2.1" class="ltx_text ltx_framed ltx_framed_underline">25.30</span>
</td>
<td id="S4.T2.16.22.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">33.52</td>
<td id="S4.T2.16.22.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">10.92</td>
<td id="S4.T2.16.22.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">7.97</td>
<td id="S4.T2.16.22.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">       <span id="S4.T2.16.22.6.1" class="ltx_text ltx_font_bold">9.97</span>
</td>
<td id="S4.T2.16.22.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.22.7.1" class="ltx_text ltx_font_bold">14.02</span></td>
<td id="S4.T2.16.22.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.22.8.1" class="ltx_text ltx_framed ltx_framed_underline">52.36</span></td>
<td id="S4.T2.16.22.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.22.9.1" class="ltx_text ltx_font_bold">0.2858</span></td>
<td id="S4.T2.16.22.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T2.16.22.10.1" class="ltx_text ltx_framed ltx_framed_underline">0.2046</span></td>
</tr>
</table>
</figure>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.12" class="ltx_p"><span id="S4.p3.12.1" class="ltx_text ltx_font_bold">Baseline Setup.</span>
In addition to our proposed <span id="S4.p3.12.2" class="ltx_text ltx_font_italic">Duolando</span>, we evaluate <span id="S4.p3.12.3" class="ltx_text" style="color:#000000;">two</span> state-of-the-art solo dance generation methods, <span id="S4.p3.12.4" class="ltx_text ltx_font_italic">Bailando</span> <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite> <span id="S4.p3.12.5" class="ltx_text" style="color:#000000;">and EDGE <cite class="ltx_cite ltx_citemacro_citep">(Tseng et al., <a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite></span>, to discern the differences between solo dance and interactive duet dance.
Considering the absence of existing dance accompaniment methods conditioned on both music and a leader’s motion, we also perform ablation studies using various <span id="S4.p3.12.6" class="ltx_text ltx_font_italic">Duolando</span> variants. Specifically, we investigate the effectiveness of reinforcement learning (RL), relative translation (<math id="S4.p3.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">​</mo><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><times id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></times><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝑡</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">tr</annotation></semantics></math>), and interaction coordination (IC), through the evaluation of variants "w/o. RL", "w/o. RL <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">​</mo><mi id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></times><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑡</ci><ci id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">tr</annotation></semantics></math>", and "w/o. RL <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">​</mo><mi id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><times id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></times><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝑡</ci><ci id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">tr</annotation></semantics></math> IC", respectively.
For the variant without <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p3.4.m4.1a"><mrow id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p3.4.m4.1.1.1" xref="S4.p3.4.m4.1.1.1.cmml">​</mo><mi id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><times id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1.1"></times><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝑡</ci><ci id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">tr</annotation></semantics></math>, we delete <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="z^{\bm{t}r}" display="inline"><semantics id="S4.p3.5.m5.1a"><msup id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml"><mi id="S4.p3.5.m5.1.1.2" xref="S4.p3.5.m5.1.1.2.cmml">z</mi><mrow id="S4.p3.5.m5.1.1.3" xref="S4.p3.5.m5.1.1.3.cmml"><mi id="S4.p3.5.m5.1.1.3.2" xref="S4.p3.5.m5.1.1.3.2.cmml">𝒕</mi><mo lspace="0em" rspace="0em" id="S4.p3.5.m5.1.1.3.1" xref="S4.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.p3.5.m5.1.1.3.3" xref="S4.p3.5.m5.1.1.3.3.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><apply id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.1.cmml" xref="S4.p3.5.m5.1.1">superscript</csymbol><ci id="S4.p3.5.m5.1.1.2.cmml" xref="S4.p3.5.m5.1.1.2">𝑧</ci><apply id="S4.p3.5.m5.1.1.3.cmml" xref="S4.p3.5.m5.1.1.3"><times id="S4.p3.5.m5.1.1.3.1.cmml" xref="S4.p3.5.m5.1.1.3.1"></times><ci id="S4.p3.5.m5.1.1.3.2.cmml" xref="S4.p3.5.m5.1.1.3.2">𝒕</ci><ci id="S4.p3.5.m5.1.1.3.3.cmml" xref="S4.p3.5.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">z^{\bm{t}r}</annotation></semantics></math> from the input of GPT and predict the translation via the velocity decoding branch <math id="S4.p3.6.m6.1" class="ltx_Math" alttext="D_{V}" display="inline"><semantics id="S4.p3.6.m6.1a"><msub id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml"><mi id="S4.p3.6.m6.1.1.2" xref="S4.p3.6.m6.1.1.2.cmml">D</mi><mi id="S4.p3.6.m6.1.1.3" xref="S4.p3.6.m6.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><apply id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.1.cmml" xref="S4.p3.6.m6.1.1">subscript</csymbol><ci id="S4.p3.6.m6.1.1.2.cmml" xref="S4.p3.6.m6.1.1.2">𝐷</ci><ci id="S4.p3.6.m6.1.1.3.cmml" xref="S4.p3.6.m6.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">D_{V}</annotation></semantics></math>, which is trained in an unsupervised manner, as detailed in Section <a href="#S3.SS3" title="3.3 Off-Policy GPT Reinforcement Learning ‣ 3 Our Approach ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> and <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>.
In the case of "w/o. RL <math id="S4.p3.7.m7.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p3.7.m7.1a"><mrow id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml"><mi id="S4.p3.7.m7.1.1.2" xref="S4.p3.7.m7.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p3.7.m7.1.1.1" xref="S4.p3.7.m7.1.1.1.cmml">​</mo><mi id="S4.p3.7.m7.1.1.3" xref="S4.p3.7.m7.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><apply id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1"><times id="S4.p3.7.m7.1.1.1.cmml" xref="S4.p3.7.m7.1.1.1"></times><ci id="S4.p3.7.m7.1.1.2.cmml" xref="S4.p3.7.m7.1.1.2">𝑡</ci><ci id="S4.p3.7.m7.1.1.3.cmml" xref="S4.p3.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">tr</annotation></semantics></math> IC", we further simplify the model’s input to <math id="S4.p3.8.m8.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="S4.p3.8.m8.1a"><mi id="S4.p3.8.m8.1.1" xref="S4.p3.8.m8.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.1b"><ci id="S4.p3.8.m8.1.1.cmml" xref="S4.p3.8.m8.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.1c">\bm{m}</annotation></semantics></math>, <math id="S4.p3.9.m9.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{up\heartsuit}}" display="inline"><semantics id="S4.p3.9.m9.1a"><msup id="S4.p3.9.m9.1.1" xref="S4.p3.9.m9.1.1.cmml"><mi mathcolor="#C93756" id="S4.p3.9.m9.1.1.2" xref="S4.p3.9.m9.1.1.2.cmml">𝒛</mi><mrow id="S4.p3.9.m9.1.1.3" xref="S4.p3.9.m9.1.1.3.cmml"><mi mathcolor="#C93756" id="S4.p3.9.m9.1.1.3.2" xref="S4.p3.9.m9.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.p3.9.m9.1.1.3.1" xref="S4.p3.9.m9.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.9.m9.1.1.3.3" xref="S4.p3.9.m9.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.p3.9.m9.1.1.3.1a" xref="S4.p3.9.m9.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S4.p3.9.m9.1.1.3.4" xref="S4.p3.9.m9.1.1.3.4.cmml">♡</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.9.m9.1b"><apply id="S4.p3.9.m9.1.1.cmml" xref="S4.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m9.1.1.1.cmml" xref="S4.p3.9.m9.1.1">superscript</csymbol><ci id="S4.p3.9.m9.1.1.2.cmml" xref="S4.p3.9.m9.1.1.2">𝒛</ci><apply id="S4.p3.9.m9.1.1.3.cmml" xref="S4.p3.9.m9.1.1.3"><times id="S4.p3.9.m9.1.1.3.1.cmml" xref="S4.p3.9.m9.1.1.3.1"></times><ci id="S4.p3.9.m9.1.1.3.2.cmml" xref="S4.p3.9.m9.1.1.3.2">𝑢</ci><ci id="S4.p3.9.m9.1.1.3.3.cmml" xref="S4.p3.9.m9.1.1.3.3">𝑝</ci><ci id="S4.p3.9.m9.1.1.3.4.cmml" xref="S4.p3.9.m9.1.1.3.4">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m9.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{up\heartsuit}}</annotation></semantics></math>, <math id="S4.p3.10.m10.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{down\heartsuit}}" display="inline"><semantics id="S4.p3.10.m10.1a"><msup id="S4.p3.10.m10.1.1" xref="S4.p3.10.m10.1.1.cmml"><mi mathcolor="#C93756" id="S4.p3.10.m10.1.1.2" xref="S4.p3.10.m10.1.1.2.cmml">𝒛</mi><mrow id="S4.p3.10.m10.1.1.3" xref="S4.p3.10.m10.1.1.3.cmml"><mi mathcolor="#C93756" id="S4.p3.10.m10.1.1.3.2" xref="S4.p3.10.m10.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.p3.10.m10.1.1.3.1" xref="S4.p3.10.m10.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.10.m10.1.1.3.3" xref="S4.p3.10.m10.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.p3.10.m10.1.1.3.1a" xref="S4.p3.10.m10.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.10.m10.1.1.3.4" xref="S4.p3.10.m10.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p3.10.m10.1.1.3.1b" xref="S4.p3.10.m10.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.10.m10.1.1.3.5" xref="S4.p3.10.m10.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.p3.10.m10.1.1.3.1c" xref="S4.p3.10.m10.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S4.p3.10.m10.1.1.3.6" xref="S4.p3.10.m10.1.1.3.6.cmml">♡</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.10.m10.1b"><apply id="S4.p3.10.m10.1.1.cmml" xref="S4.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p3.10.m10.1.1.1.cmml" xref="S4.p3.10.m10.1.1">superscript</csymbol><ci id="S4.p3.10.m10.1.1.2.cmml" xref="S4.p3.10.m10.1.1.2">𝒛</ci><apply id="S4.p3.10.m10.1.1.3.cmml" xref="S4.p3.10.m10.1.1.3"><times id="S4.p3.10.m10.1.1.3.1.cmml" xref="S4.p3.10.m10.1.1.3.1"></times><ci id="S4.p3.10.m10.1.1.3.2.cmml" xref="S4.p3.10.m10.1.1.3.2">𝑑</ci><ci id="S4.p3.10.m10.1.1.3.3.cmml" xref="S4.p3.10.m10.1.1.3.3">𝑜</ci><ci id="S4.p3.10.m10.1.1.3.4.cmml" xref="S4.p3.10.m10.1.1.3.4">𝑤</ci><ci id="S4.p3.10.m10.1.1.3.5.cmml" xref="S4.p3.10.m10.1.1.3.5">𝑛</ci><ci id="S4.p3.10.m10.1.1.3.6.cmml" xref="S4.p3.10.m10.1.1.3.6">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m10.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{down\heartsuit}}</annotation></semantics></math>, <math id="S4.p3.11.m11.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{lhand\heartsuit}}" display="inline"><semantics id="S4.p3.11.m11.1a"><msup id="S4.p3.11.m11.1.1" xref="S4.p3.11.m11.1.1.cmml"><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.2" xref="S4.p3.11.m11.1.1.2.cmml">𝒛</mi><mrow id="S4.p3.11.m11.1.1.3" xref="S4.p3.11.m11.1.1.3.cmml"><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.3.2" xref="S4.p3.11.m11.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.p3.11.m11.1.1.3.1" xref="S4.p3.11.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.3.3" xref="S4.p3.11.m11.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.p3.11.m11.1.1.3.1a" xref="S4.p3.11.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.3.4" xref="S4.p3.11.m11.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.p3.11.m11.1.1.3.1b" xref="S4.p3.11.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.3.5" xref="S4.p3.11.m11.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.p3.11.m11.1.1.3.1c" xref="S4.p3.11.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.11.m11.1.1.3.6" xref="S4.p3.11.m11.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.p3.11.m11.1.1.3.1d" xref="S4.p3.11.m11.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S4.p3.11.m11.1.1.3.7" xref="S4.p3.11.m11.1.1.3.7.cmml">♡</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.11.m11.1b"><apply id="S4.p3.11.m11.1.1.cmml" xref="S4.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p3.11.m11.1.1.1.cmml" xref="S4.p3.11.m11.1.1">superscript</csymbol><ci id="S4.p3.11.m11.1.1.2.cmml" xref="S4.p3.11.m11.1.1.2">𝒛</ci><apply id="S4.p3.11.m11.1.1.3.cmml" xref="S4.p3.11.m11.1.1.3"><times id="S4.p3.11.m11.1.1.3.1.cmml" xref="S4.p3.11.m11.1.1.3.1"></times><ci id="S4.p3.11.m11.1.1.3.2.cmml" xref="S4.p3.11.m11.1.1.3.2">𝑙</ci><ci id="S4.p3.11.m11.1.1.3.3.cmml" xref="S4.p3.11.m11.1.1.3.3">ℎ</ci><ci id="S4.p3.11.m11.1.1.3.4.cmml" xref="S4.p3.11.m11.1.1.3.4">𝑎</ci><ci id="S4.p3.11.m11.1.1.3.5.cmml" xref="S4.p3.11.m11.1.1.3.5">𝑛</ci><ci id="S4.p3.11.m11.1.1.3.6.cmml" xref="S4.p3.11.m11.1.1.3.6">𝑑</ci><ci id="S4.p3.11.m11.1.1.3.7.cmml" xref="S4.p3.11.m11.1.1.3.7">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.11.m11.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{lhand\heartsuit}}</annotation></semantics></math>, and <math id="S4.p3.12.m12.1" class="ltx_Math" alttext="\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{rhand\heartsuit}}" display="inline"><semantics id="S4.p3.12.m12.1a"><msup id="S4.p3.12.m12.1.1" xref="S4.p3.12.m12.1.1.cmml"><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.2" xref="S4.p3.12.m12.1.1.2.cmml">𝒛</mi><mrow id="S4.p3.12.m12.1.1.3" xref="S4.p3.12.m12.1.1.3.cmml"><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.3.2" xref="S4.p3.12.m12.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.p3.12.m12.1.1.3.1" xref="S4.p3.12.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.3.3" xref="S4.p3.12.m12.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.p3.12.m12.1.1.3.1a" xref="S4.p3.12.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.3.4" xref="S4.p3.12.m12.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.p3.12.m12.1.1.3.1b" xref="S4.p3.12.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.3.5" xref="S4.p3.12.m12.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.p3.12.m12.1.1.3.1c" xref="S4.p3.12.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" id="S4.p3.12.m12.1.1.3.6" xref="S4.p3.12.m12.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.p3.12.m12.1.1.3.1d" xref="S4.p3.12.m12.1.1.3.1.cmml">​</mo><mi mathcolor="#C93756" mathvariant="normal" id="S4.p3.12.m12.1.1.3.7" xref="S4.p3.12.m12.1.1.3.7.cmml">♡</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.12.m12.1b"><apply id="S4.p3.12.m12.1.1.cmml" xref="S4.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p3.12.m12.1.1.1.cmml" xref="S4.p3.12.m12.1.1">superscript</csymbol><ci id="S4.p3.12.m12.1.1.2.cmml" xref="S4.p3.12.m12.1.1.2">𝒛</ci><apply id="S4.p3.12.m12.1.1.3.cmml" xref="S4.p3.12.m12.1.1.3"><times id="S4.p3.12.m12.1.1.3.1.cmml" xref="S4.p3.12.m12.1.1.3.1"></times><ci id="S4.p3.12.m12.1.1.3.2.cmml" xref="S4.p3.12.m12.1.1.3.2">𝑟</ci><ci id="S4.p3.12.m12.1.1.3.3.cmml" xref="S4.p3.12.m12.1.1.3.3">ℎ</ci><ci id="S4.p3.12.m12.1.1.3.4.cmml" xref="S4.p3.12.m12.1.1.3.4">𝑎</ci><ci id="S4.p3.12.m12.1.1.3.5.cmml" xref="S4.p3.12.m12.1.1.3.5">𝑛</ci><ci id="S4.p3.12.m12.1.1.3.6.cmml" xref="S4.p3.12.m12.1.1.3.6">𝑑</ci><ci id="S4.p3.12.m12.1.1.3.7.cmml" xref="S4.p3.12.m12.1.1.3.7">♡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.12.m12.1c">\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{\bm{z}^{rhand\heartsuit}}</annotation></semantics></math>, excluding the influence of the leading dancer, to observe the effectiveness of interactive coordination in dance accompaniment.
Along with these methods, we include the scores of the ground truth test data as reference points. The quantitative benchmark is provided in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.42" class="ltx_p"><span id="S4.p4.42.3" class="ltx_text ltx_font_bold">Analysis.</span>
Given that the methods presented in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> are organized in an order with incremental addition of modules, we conduct a detailed pairwise analysis of each successive pair.
Upon examination of the first two solo dance models, <span id="S4.p4.42.4" class="ltx_text ltx_font_italic">Bailando</span> achieves FID<sub id="S4.p4.42.5" class="ltx_sub"><span id="S4.p4.42.5.1" class="ltx_text ltx_font_italic">k</span></sub> and FID<sub id="S4.p4.42.6" class="ltx_sub"><span id="S4.p4.42.6.1" class="ltx_text ltx_font_italic">g</span></sub> scores of <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="78.52" display="inline"><semantics id="S4.p4.3.m3.1a"><mn id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">78.52</mn><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><cn type="float" id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">78.52</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">78.52</annotation></semantics></math> and <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="36.19" display="inline"><semantics id="S4.p4.4.m4.1a"><mn id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">36.19</mn><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><cn type="float" id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">36.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">36.19</annotation></semantics></math>, respectively, <span id="S4.p4.6.2" class="ltx_text" style="color:#000000;">while those of EDGE are <math id="S4.p4.5.1.m1.1" class="ltx_Math" alttext="69.14" display="inline"><semantics id="S4.p4.5.1.m1.1a"><mn mathcolor="#000000" id="S4.p4.5.1.m1.1.1" xref="S4.p4.5.1.m1.1.1.cmml">69.14</mn><annotation-xml encoding="MathML-Content" id="S4.p4.5.1.m1.1b"><cn type="float" id="S4.p4.5.1.m1.1.1.cmml" xref="S4.p4.5.1.m1.1.1">69.14</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.1.m1.1c">69.14</annotation></semantics></math> and <math id="S4.p4.6.2.m2.1" class="ltx_Math" alttext="44.58" display="inline"><semantics id="S4.p4.6.2.m2.1a"><mn mathcolor="#000000" id="S4.p4.6.2.m2.1.1" xref="S4.p4.6.2.m2.1.1.cmml">44.58</mn><annotation-xml encoding="MathML-Content" id="S4.p4.6.2.m2.1b"><cn type="float" id="S4.p4.6.2.m2.1.1.cmml" xref="S4.p4.6.2.m2.1.1">44.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.2.m2.1c">44.58</annotation></semantics></math></span>.
In contrast, the model “<span id="S4.p4.42.7" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p4.7.m5.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.7.m5.1a"><mrow id="S4.p4.7.m5.1.1" xref="S4.p4.7.m5.1.1.cmml"><mi id="S4.p4.7.m5.1.1.2" xref="S4.p4.7.m5.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.7.m5.1.1.1" xref="S4.p4.7.m5.1.1.1.cmml">​</mo><mi id="S4.p4.7.m5.1.1.3" xref="S4.p4.7.m5.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.7.m5.1b"><apply id="S4.p4.7.m5.1.1.cmml" xref="S4.p4.7.m5.1.1"><times id="S4.p4.7.m5.1.1.1.cmml" xref="S4.p4.7.m5.1.1.1"></times><ci id="S4.p4.7.m5.1.1.2.cmml" xref="S4.p4.7.m5.1.1.2">𝑡</ci><ci id="S4.p4.7.m5.1.1.3.cmml" xref="S4.p4.7.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m5.1c">tr</annotation></semantics></math> IC” significantly improves upon these solo metrics, with scores increasing by <math id="S4.p4.8.m6.1" class="ltx_Math" alttext="65.99" display="inline"><semantics id="S4.p4.8.m6.1a"><mn id="S4.p4.8.m6.1.1" xref="S4.p4.8.m6.1.1.cmml">65.99</mn><annotation-xml encoding="MathML-Content" id="S4.p4.8.m6.1b"><cn type="float" id="S4.p4.8.m6.1.1.cmml" xref="S4.p4.8.m6.1.1">65.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m6.1c">65.99</annotation></semantics></math> (<math id="S4.p4.9.m7.1" class="ltx_Math" alttext="84" display="inline"><semantics id="S4.p4.9.m7.1a"><mn id="S4.p4.9.m7.1.1" xref="S4.p4.9.m7.1.1.cmml">84</mn><annotation-xml encoding="MathML-Content" id="S4.p4.9.m7.1b"><cn type="integer" id="S4.p4.9.m7.1.1.cmml" xref="S4.p4.9.m7.1.1">84</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m7.1c">84</annotation></semantics></math>%) and <math id="S4.p4.10.m8.1" class="ltx_Math" alttext="56.61" display="inline"><semantics id="S4.p4.10.m8.1a"><mn id="S4.p4.10.m8.1.1" xref="S4.p4.10.m8.1.1.cmml">56.61</mn><annotation-xml encoding="MathML-Content" id="S4.p4.10.m8.1b"><cn type="float" id="S4.p4.10.m8.1.1.cmml" xref="S4.p4.10.m8.1.1">56.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m8.1c">56.61</annotation></semantics></math> (<math id="S4.p4.11.m9.1" class="ltx_Math" alttext="72" display="inline"><semantics id="S4.p4.11.m9.1a"><mn id="S4.p4.11.m9.1.1" xref="S4.p4.11.m9.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="S4.p4.11.m9.1b"><cn type="integer" id="S4.p4.11.m9.1.1.cmml" xref="S4.p4.11.m9.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m9.1c">72</annotation></semantics></math>%) respectively.
Compared to <span id="S4.p4.42.8" class="ltx_text ltx_font_italic">Bailando</span>, this variant of <span id="S4.p4.42.9" class="ltx_text ltx_font_italic">Duolando</span> includes a look-ahead (LA) mechanism, which allows for the generation of more fluent and continuous dance movements over long durations, contributing to the significant improvement of the FID scores.
However, since <span id="S4.p4.42.10" class="ltx_text" style="color:#000000;">all solo dance methods</span>
lack the condition of a leader, <span id="S4.p4.42.11" class="ltx_text" style="color:#000000;">they do not exhibit a noticeable change in poor interactive values</span>.
By taking the leader’s movement into account and using the proposed interactive coordination (IC), “<span id="S4.p4.42.12" class="ltx_text ltx_font_italic">Duolando</span> (w/o. RL <math id="S4.p4.12.m10.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.12.m10.1a"><mrow id="S4.p4.12.m10.1.1" xref="S4.p4.12.m10.1.1.cmml"><mi id="S4.p4.12.m10.1.1.2" xref="S4.p4.12.m10.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.12.m10.1.1.1" xref="S4.p4.12.m10.1.1.1.cmml">​</mo><mi id="S4.p4.12.m10.1.1.3" xref="S4.p4.12.m10.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.12.m10.1b"><apply id="S4.p4.12.m10.1.1.cmml" xref="S4.p4.12.m10.1.1"><times id="S4.p4.12.m10.1.1.1.cmml" xref="S4.p4.12.m10.1.1.1"></times><ci id="S4.p4.12.m10.1.1.2.cmml" xref="S4.p4.12.m10.1.1.2">𝑡</ci><ci id="S4.p4.12.m10.1.1.3.cmml" xref="S4.p4.12.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m10.1c">tr</annotation></semantics></math>)” achieves a <math id="S4.p4.13.m11.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.p4.13.m11.1a"><mrow id="S4.p4.13.m11.1.1" xref="S4.p4.13.m11.1.1.cmml"><mn id="S4.p4.13.m11.1.1.2" xref="S4.p4.13.m11.1.1.2.cmml">20</mn><mo id="S4.p4.13.m11.1.1.1" xref="S4.p4.13.m11.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.13.m11.1b"><apply id="S4.p4.13.m11.1.1.cmml" xref="S4.p4.13.m11.1.1"><csymbol cd="latexml" id="S4.p4.13.m11.1.1.1.cmml" xref="S4.p4.13.m11.1.1.1">percent</csymbol><cn type="integer" id="S4.p4.13.m11.1.1.2.cmml" xref="S4.p4.13.m11.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.13.m11.1c">20\%</annotation></semantics></math> improvement on BED, increasing from <math id="S4.p4.14.m12.1" class="ltx_Math" alttext="0.1826" display="inline"><semantics id="S4.p4.14.m12.1a"><mn id="S4.p4.14.m12.1.1" xref="S4.p4.14.m12.1.1.cmml">0.1826</mn><annotation-xml encoding="MathML-Content" id="S4.p4.14.m12.1b"><cn type="float" id="S4.p4.14.m12.1.1.cmml" xref="S4.p4.14.m12.1.1">0.1826</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.14.m12.1c">0.1826</annotation></semantics></math> to <math id="S4.p4.15.m13.1" class="ltx_Math" alttext="0.2194" display="inline"><semantics id="S4.p4.15.m13.1a"><mn id="S4.p4.15.m13.1.1" xref="S4.p4.15.m13.1.1.cmml">0.2194</mn><annotation-xml encoding="MathML-Content" id="S4.p4.15.m13.1b"><cn type="float" id="S4.p4.15.m13.1.1.cmml" xref="S4.p4.15.m13.1.1">0.2194</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.15.m13.1c">0.2194</annotation></semantics></math>, which can be attributed to better synchronization with the leader’s dynamics.
Nonetheless, when compared with “<span id="S4.p4.42.13" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p4.16.m14.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.16.m14.1a"><mrow id="S4.p4.16.m14.1.1" xref="S4.p4.16.m14.1.1.cmml"><mi id="S4.p4.16.m14.1.1.2" xref="S4.p4.16.m14.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.16.m14.1.1.1" xref="S4.p4.16.m14.1.1.1.cmml">​</mo><mi id="S4.p4.16.m14.1.1.3" xref="S4.p4.16.m14.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.16.m14.1b"><apply id="S4.p4.16.m14.1.1.cmml" xref="S4.p4.16.m14.1.1"><times id="S4.p4.16.m14.1.1.1.cmml" xref="S4.p4.16.m14.1.1.1"></times><ci id="S4.p4.16.m14.1.1.2.cmml" xref="S4.p4.16.m14.1.1.2">𝑡</ci><ci id="S4.p4.16.m14.1.1.3.cmml" xref="S4.p4.16.m14.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.16.m14.1c">tr</annotation></semantics></math> IC”, “Duolando w/o. RL <math id="S4.p4.17.m15.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.17.m15.1a"><mrow id="S4.p4.17.m15.1.1" xref="S4.p4.17.m15.1.1.cmml"><mi id="S4.p4.17.m15.1.1.2" xref="S4.p4.17.m15.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.17.m15.1.1.1" xref="S4.p4.17.m15.1.1.1.cmml">​</mo><mi id="S4.p4.17.m15.1.1.3" xref="S4.p4.17.m15.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.17.m15.1b"><apply id="S4.p4.17.m15.1.1.cmml" xref="S4.p4.17.m15.1.1"><times id="S4.p4.17.m15.1.1.1.cmml" xref="S4.p4.17.m15.1.1.1"></times><ci id="S4.p4.17.m15.1.1.2.cmml" xref="S4.p4.17.m15.1.1.2">𝑡</ci><ci id="S4.p4.17.m15.1.1.3.cmml" xref="S4.p4.17.m15.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.17.m15.1c">tr</annotation></semantics></math>” still shows suboptimal performance in terms of FID<sub id="S4.p4.42.14" class="ltx_sub"><span id="S4.p4.42.14.1" class="ltx_text ltx_font_italic">cd</span></sub> and Div<sub id="S4.p4.42.15" class="ltx_sub"><span id="S4.p4.42.15.1" class="ltx_text ltx_font_italic">cd</span></sub>.
This is because the <math id="S4.p4.20.m18.1" class="ltx_Math" alttext="cd" display="inline"><semantics id="S4.p4.20.m18.1a"><mrow id="S4.p4.20.m18.1.1" xref="S4.p4.20.m18.1.1.cmml"><mi id="S4.p4.20.m18.1.1.2" xref="S4.p4.20.m18.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.p4.20.m18.1.1.1" xref="S4.p4.20.m18.1.1.1.cmml">​</mo><mi id="S4.p4.20.m18.1.1.3" xref="S4.p4.20.m18.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.20.m18.1b"><apply id="S4.p4.20.m18.1.1.cmml" xref="S4.p4.20.m18.1.1"><times id="S4.p4.20.m18.1.1.1.cmml" xref="S4.p4.20.m18.1.1.1"></times><ci id="S4.p4.20.m18.1.1.2.cmml" xref="S4.p4.20.m18.1.1.2">𝑐</ci><ci id="S4.p4.20.m18.1.1.3.cmml" xref="S4.p4.20.m18.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.20.m18.1c">cd</annotation></semantics></math> feature is strongly affected by the relative translation between the two dancers.
While the virtual follower can respond to the leader’s motion pattern, it still fails with positioning itself in a reasonable location based on unsupervised velocity prediction.
Moreover, the low CF value of <math id="S4.p4.21.m19.1" class="ltx_Math" alttext="7.76\%" display="inline"><semantics id="S4.p4.21.m19.1a"><mrow id="S4.p4.21.m19.1.1" xref="S4.p4.21.m19.1.1.cmml"><mn id="S4.p4.21.m19.1.1.2" xref="S4.p4.21.m19.1.1.2.cmml">7.76</mn><mo id="S4.p4.21.m19.1.1.1" xref="S4.p4.21.m19.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.21.m19.1b"><apply id="S4.p4.21.m19.1.1.cmml" xref="S4.p4.21.m19.1.1"><csymbol cd="latexml" id="S4.p4.21.m19.1.1.1.cmml" xref="S4.p4.21.m19.1.1.1">percent</csymbol><cn type="float" id="S4.p4.21.m19.1.1.2.cmml" xref="S4.p4.21.m19.1.1.2">7.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.21.m19.1c">7.76\%</annotation></semantics></math> indicates that the generated follower rarely makes contact with the leader, contradicting the fundamental requirements of dance accompaniment.
With the introduction of explicit relative translation (<math id="S4.p4.22.m20.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.22.m20.1a"><mrow id="S4.p4.22.m20.1.1" xref="S4.p4.22.m20.1.1.cmml"><mi id="S4.p4.22.m20.1.1.2" xref="S4.p4.22.m20.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.22.m20.1.1.1" xref="S4.p4.22.m20.1.1.1.cmml">​</mo><mi id="S4.p4.22.m20.1.1.3" xref="S4.p4.22.m20.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.22.m20.1b"><apply id="S4.p4.22.m20.1.1.cmml" xref="S4.p4.22.m20.1.1"><times id="S4.p4.22.m20.1.1.1.cmml" xref="S4.p4.22.m20.1.1.1"></times><ci id="S4.p4.22.m20.1.1.2.cmml" xref="S4.p4.22.m20.1.1.2">𝑡</ci><ci id="S4.p4.22.m20.1.1.3.cmml" xref="S4.p4.22.m20.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.22.m20.1c">tr</annotation></semantics></math>) prediction via interactive coordination, the FID<sub id="S4.p4.42.16" class="ltx_sub"><span id="S4.p4.42.16.1" class="ltx_text ltx_font_italic">cd</span></sub> of “<span id="S4.p4.42.17" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL” reduces drastically from <math id="S4.p4.24.m22.1" class="ltx_Math" alttext="7970.19" display="inline"><semantics id="S4.p4.24.m22.1a"><mn id="S4.p4.24.m22.1.1" xref="S4.p4.24.m22.1.1.cmml">7970.19</mn><annotation-xml encoding="MathML-Content" id="S4.p4.24.m22.1b"><cn type="float" id="S4.p4.24.m22.1.1.cmml" xref="S4.p4.24.m22.1.1">7970.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.24.m22.1c">7970.19</annotation></semantics></math> to <math id="S4.p4.25.m23.1" class="ltx_Math" alttext="21.68" display="inline"><semantics id="S4.p4.25.m23.1a"><mn mathcolor="#000000" id="S4.p4.25.m23.1.1" xref="S4.p4.25.m23.1.1.cmml">21.68</mn><annotation-xml encoding="MathML-Content" id="S4.p4.25.m23.1b"><cn type="float" id="S4.p4.25.m23.1.1.cmml" xref="S4.p4.25.m23.1.1">21.68</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.25.m23.1c">21.68</annotation></semantics></math>, aligning much more closer with the ground truth.
Simultaneously, the CF value increases to <math id="S4.p4.26.m24.1" class="ltx_Math" alttext="57.43\%" display="inline"><semantics id="S4.p4.26.m24.1a"><mrow id="S4.p4.26.m24.1.1" xref="S4.p4.26.m24.1.1.cmml"><mn id="S4.p4.26.m24.1.1.2" xref="S4.p4.26.m24.1.1.2.cmml">57.43</mn><mo id="S4.p4.26.m24.1.1.1" xref="S4.p4.26.m24.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.26.m24.1b"><apply id="S4.p4.26.m24.1.1.cmml" xref="S4.p4.26.m24.1.1"><csymbol cd="latexml" id="S4.p4.26.m24.1.1.1.cmml" xref="S4.p4.26.m24.1.1.1">percent</csymbol><cn type="float" id="S4.p4.26.m24.1.1.2.cmml" xref="S4.p4.26.m24.1.1.2">57.43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.26.m24.1c">57.43\%</annotation></semantics></math> (a 7-fold increment), and BED is raised to <math id="S4.p4.27.m25.1" class="ltx_Math" alttext="0.27955" display="inline"><semantics id="S4.p4.27.m25.1a"><mn id="S4.p4.27.m25.1.1" xref="S4.p4.27.m25.1.1.cmml">0.27955</mn><annotation-xml encoding="MathML-Content" id="S4.p4.27.m25.1b"><cn type="float" id="S4.p4.27.m25.1.1.cmml" xref="S4.p4.27.m25.1.1">0.27955</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.27.m25.1c">0.27955</annotation></semantics></math> (<math id="S4.p4.28.m26.1" class="ltx_Math" alttext="27\%\uparrow" display="inline"><semantics id="S4.p4.28.m26.1a"><mrow id="S4.p4.28.m26.1.1" xref="S4.p4.28.m26.1.1.cmml"><mrow id="S4.p4.28.m26.1.1.2" xref="S4.p4.28.m26.1.1.2.cmml"><mn id="S4.p4.28.m26.1.1.2.2" xref="S4.p4.28.m26.1.1.2.2.cmml">27</mn><mo id="S4.p4.28.m26.1.1.2.1" xref="S4.p4.28.m26.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.p4.28.m26.1.1.1" xref="S4.p4.28.m26.1.1.1.cmml">↑</mo><mi id="S4.p4.28.m26.1.1.3" xref="S4.p4.28.m26.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.28.m26.1b"><apply id="S4.p4.28.m26.1.1.cmml" xref="S4.p4.28.m26.1.1"><ci id="S4.p4.28.m26.1.1.1.cmml" xref="S4.p4.28.m26.1.1.1">↑</ci><apply id="S4.p4.28.m26.1.1.2.cmml" xref="S4.p4.28.m26.1.1.2"><csymbol cd="latexml" id="S4.p4.28.m26.1.1.2.1.cmml" xref="S4.p4.28.m26.1.1.2.1">percent</csymbol><cn type="integer" id="S4.p4.28.m26.1.1.2.2.cmml" xref="S4.p4.28.m26.1.1.2.2">27</cn></apply><csymbol cd="latexml" id="S4.p4.28.m26.1.1.3.cmml" xref="S4.p4.28.m26.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.28.m26.1c">27\%\uparrow</annotation></semantics></math>), indicating a higher level of interaction with the leader.
However, the explicitly predicted translation can sometimes clash with the generated movements, deteriorating the quality of the dance generated. Upon closer examination, compared to “<span id="S4.p4.42.18" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p4.29.m27.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p4.29.m27.1a"><mrow id="S4.p4.29.m27.1.1" xref="S4.p4.29.m27.1.1.cmml"><mi id="S4.p4.29.m27.1.1.2" xref="S4.p4.29.m27.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.29.m27.1.1.1" xref="S4.p4.29.m27.1.1.1.cmml">​</mo><mi id="S4.p4.29.m27.1.1.3" xref="S4.p4.29.m27.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.29.m27.1b"><apply id="S4.p4.29.m27.1.1.cmml" xref="S4.p4.29.m27.1.1"><times id="S4.p4.29.m27.1.1.1.cmml" xref="S4.p4.29.m27.1.1.1"></times><ci id="S4.p4.29.m27.1.1.2.cmml" xref="S4.p4.29.m27.1.1.2">𝑡</ci><ci id="S4.p4.29.m27.1.1.3.cmml" xref="S4.p4.29.m27.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.29.m27.1c">tr</annotation></semantics></math>”, the FID<sub id="S4.p4.42.19" class="ltx_sub"><span id="S4.p4.42.19.1" class="ltx_text ltx_font_italic">k</span></sub> value of “<span id="S4.p4.42.20" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL” drops significantly from <math id="S4.p4.31.m29.1" class="ltx_Math" alttext="62.29" display="inline"><semantics id="S4.p4.31.m29.1a"><mn id="S4.p4.31.m29.1.1" xref="S4.p4.31.m29.1.1.cmml">62.29</mn><annotation-xml encoding="MathML-Content" id="S4.p4.31.m29.1b"><cn type="float" id="S4.p4.31.m29.1.1.cmml" xref="S4.p4.31.m29.1.1">62.29</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.31.m29.1c">62.29</annotation></semantics></math> to <math id="S4.p4.32.m30.1" class="ltx_Math" alttext="106.72" display="inline"><semantics id="S4.p4.32.m30.1a"><mn id="S4.p4.32.m30.1.1" xref="S4.p4.32.m30.1.1.cmml">106.72</mn><annotation-xml encoding="MathML-Content" id="S4.p4.32.m30.1b"><cn type="float" id="S4.p4.32.m30.1.1.cmml" xref="S4.p4.32.m30.1.1">106.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.32.m30.1c">106.72</annotation></semantics></math> (<math id="S4.p4.33.m31.1" class="ltx_Math" alttext="71\%\uparrow" display="inline"><semantics id="S4.p4.33.m31.1a"><mrow id="S4.p4.33.m31.1.1" xref="S4.p4.33.m31.1.1.cmml"><mrow id="S4.p4.33.m31.1.1.2" xref="S4.p4.33.m31.1.1.2.cmml"><mn id="S4.p4.33.m31.1.1.2.2" xref="S4.p4.33.m31.1.1.2.2.cmml">71</mn><mo id="S4.p4.33.m31.1.1.2.1" xref="S4.p4.33.m31.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.p4.33.m31.1.1.1" xref="S4.p4.33.m31.1.1.1.cmml">↑</mo><mi id="S4.p4.33.m31.1.1.3" xref="S4.p4.33.m31.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.33.m31.1b"><apply id="S4.p4.33.m31.1.1.cmml" xref="S4.p4.33.m31.1.1"><ci id="S4.p4.33.m31.1.1.1.cmml" xref="S4.p4.33.m31.1.1.1">↑</ci><apply id="S4.p4.33.m31.1.1.2.cmml" xref="S4.p4.33.m31.1.1.2"><csymbol cd="latexml" id="S4.p4.33.m31.1.1.2.1.cmml" xref="S4.p4.33.m31.1.1.2.1">percent</csymbol><cn type="integer" id="S4.p4.33.m31.1.1.2.2.cmml" xref="S4.p4.33.m31.1.1.2.2">71</cn></apply><csymbol cd="latexml" id="S4.p4.33.m31.1.1.3.cmml" xref="S4.p4.33.m31.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.33.m31.1c">71\%\uparrow</annotation></semantics></math>). Given that the kinetic features <cite class="ltx_cite ltx_citemacro_citep">(Onuma et al., <a href="#bib.bib35" title="" class="ltx_ref">2008</a>)</cite> are computed based on motion velocity, they are particularly susceptible to unreasonable global shifts like the so-called “skating artifacts”.
This issue is resolved by the proposed reinforcement learning mechanism, enabling the full <span id="S4.p4.42.21" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> model to show a <math id="S4.p4.34.m32.1" class="ltx_Math" alttext="81.42" display="inline"><semantics id="S4.p4.34.m32.1a"><mn id="S4.p4.34.m32.1.1" xref="S4.p4.34.m32.1.1.cmml">81.42</mn><annotation-xml encoding="MathML-Content" id="S4.p4.34.m32.1b"><cn type="float" id="S4.p4.34.m32.1.1.cmml" xref="S4.p4.34.m32.1.1">81.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.34.m32.1c">81.42</annotation></semantics></math> (<math id="S4.p4.35.m33.1" class="ltx_Math" alttext="76\%" display="inline"><semantics id="S4.p4.35.m33.1a"><mrow id="S4.p4.35.m33.1.1" xref="S4.p4.35.m33.1.1.cmml"><mn id="S4.p4.35.m33.1.1.2" xref="S4.p4.35.m33.1.1.2.cmml">76</mn><mo id="S4.p4.35.m33.1.1.1" xref="S4.p4.35.m33.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.35.m33.1b"><apply id="S4.p4.35.m33.1.1.cmml" xref="S4.p4.35.m33.1.1"><csymbol cd="latexml" id="S4.p4.35.m33.1.1.1.cmml" xref="S4.p4.35.m33.1.1.1">percent</csymbol><cn type="integer" id="S4.p4.35.m33.1.1.2.cmml" xref="S4.p4.35.m33.1.1.2">76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.35.m33.1c">76\%</annotation></semantics></math>) improvement on FID<sub id="S4.p4.42.22" class="ltx_sub"><span id="S4.p4.42.22.1" class="ltx_text ltx_font_italic">k</span></sub> compared to the variant without RL.
Moreover, the reinforcement learning mechanism contributes to an improvement in interactive quality (<math id="S4.p4.37.m35.1" class="ltx_Math" alttext="11.71" display="inline"><semantics id="S4.p4.37.m35.1a"><mn id="S4.p4.37.m35.1.1" xref="S4.p4.37.m35.1.1.cmml">11.71</mn><annotation-xml encoding="MathML-Content" id="S4.p4.37.m35.1b"><cn type="float" id="S4.p4.37.m35.1.1.cmml" xref="S4.p4.37.m35.1.1">11.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.37.m35.1c">11.71</annotation></semantics></math>, <math id="S4.p4.38.m36.1" class="ltx_Math" alttext="54\%\downarrow" display="inline"><semantics id="S4.p4.38.m36.1a"><mrow id="S4.p4.38.m36.1.1" xref="S4.p4.38.m36.1.1.cmml"><mrow id="S4.p4.38.m36.1.1.2" xref="S4.p4.38.m36.1.1.2.cmml"><mn id="S4.p4.38.m36.1.1.2.2" xref="S4.p4.38.m36.1.1.2.2.cmml">54</mn><mo id="S4.p4.38.m36.1.1.2.1" xref="S4.p4.38.m36.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.p4.38.m36.1.1.1" xref="S4.p4.38.m36.1.1.1.cmml">↓</mo><mi id="S4.p4.38.m36.1.1.3" xref="S4.p4.38.m36.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.38.m36.1b"><apply id="S4.p4.38.m36.1.1.cmml" xref="S4.p4.38.m36.1.1"><ci id="S4.p4.38.m36.1.1.1.cmml" xref="S4.p4.38.m36.1.1.1">↓</ci><apply id="S4.p4.38.m36.1.1.2.cmml" xref="S4.p4.38.m36.1.1.2"><csymbol cd="latexml" id="S4.p4.38.m36.1.1.2.1.cmml" xref="S4.p4.38.m36.1.1.2.1">percent</csymbol><cn type="integer" id="S4.p4.38.m36.1.1.2.2.cmml" xref="S4.p4.38.m36.1.1.2.2">54</cn></apply><csymbol cd="latexml" id="S4.p4.38.m36.1.1.3.cmml" xref="S4.p4.38.m36.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.38.m36.1c">54\%\downarrow</annotation></semantics></math>), diversity (<math id="S4.p4.39.m37.1" class="ltx_Math" alttext="4.69" display="inline"><semantics id="S4.p4.39.m37.1a"><mn id="S4.p4.39.m37.1.1" xref="S4.p4.39.m37.1.1.cmml">4.69</mn><annotation-xml encoding="MathML-Content" id="S4.p4.39.m37.1b"><cn type="float" id="S4.p4.39.m37.1.1.cmml" xref="S4.p4.39.m37.1.1">4.69</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.39.m37.1c">4.69</annotation></semantics></math>, <math id="S4.p4.40.m38.1" class="ltx_Math" alttext="50\%\uparrow" display="inline"><semantics id="S4.p4.40.m38.1a"><mrow id="S4.p4.40.m38.1.1" xref="S4.p4.40.m38.1.1.cmml"><mrow id="S4.p4.40.m38.1.1.2" xref="S4.p4.40.m38.1.1.2.cmml"><mn id="S4.p4.40.m38.1.1.2.2" xref="S4.p4.40.m38.1.1.2.2.cmml">50</mn><mo id="S4.p4.40.m38.1.1.2.1" xref="S4.p4.40.m38.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.p4.40.m38.1.1.1" xref="S4.p4.40.m38.1.1.1.cmml">↑</mo><mi id="S4.p4.40.m38.1.1.3" xref="S4.p4.40.m38.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.40.m38.1b"><apply id="S4.p4.40.m38.1.1.cmml" xref="S4.p4.40.m38.1.1"><ci id="S4.p4.40.m38.1.1.1.cmml" xref="S4.p4.40.m38.1.1.1">↑</ci><apply id="S4.p4.40.m38.1.1.2.cmml" xref="S4.p4.40.m38.1.1.2"><csymbol cd="latexml" id="S4.p4.40.m38.1.1.2.1.cmml" xref="S4.p4.40.m38.1.1.2.1">percent</csymbol><cn type="integer" id="S4.p4.40.m38.1.1.2.2.cmml" xref="S4.p4.40.m38.1.1.2.2">50</cn></apply><csymbol cd="latexml" id="S4.p4.40.m38.1.1.3.cmml" xref="S4.p4.40.m38.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.40.m38.1c">50\%\uparrow</annotation></semantics></math>) and motion alignment (<math id="S4.p4.41.m39.1" class="ltx_Math" alttext="0.063" display="inline"><semantics id="S4.p4.41.m39.1a"><mn id="S4.p4.41.m39.1.1" xref="S4.p4.41.m39.1.1.cmml">0.063</mn><annotation-xml encoding="MathML-Content" id="S4.p4.41.m39.1b"><cn type="float" id="S4.p4.41.m39.1.1.cmml" xref="S4.p4.41.m39.1.1">0.063</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.41.m39.1c">0.063</annotation></semantics></math>, <math id="S4.p4.42.m40.1" class="ltx_Math" alttext="22\%\uparrow" display="inline"><semantics id="S4.p4.42.m40.1a"><mrow id="S4.p4.42.m40.1.1" xref="S4.p4.42.m40.1.1.cmml"><mrow id="S4.p4.42.m40.1.1.2" xref="S4.p4.42.m40.1.1.2.cmml"><mn id="S4.p4.42.m40.1.1.2.2" xref="S4.p4.42.m40.1.1.2.2.cmml">22</mn><mo id="S4.p4.42.m40.1.1.2.1" xref="S4.p4.42.m40.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.p4.42.m40.1.1.1" xref="S4.p4.42.m40.1.1.1.cmml">↑</mo><mi id="S4.p4.42.m40.1.1.3" xref="S4.p4.42.m40.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.42.m40.1b"><apply id="S4.p4.42.m40.1.1.cmml" xref="S4.p4.42.m40.1.1"><ci id="S4.p4.42.m40.1.1.1.cmml" xref="S4.p4.42.m40.1.1.1">↑</ci><apply id="S4.p4.42.m40.1.1.2.cmml" xref="S4.p4.42.m40.1.1.2"><csymbol cd="latexml" id="S4.p4.42.m40.1.1.2.1.cmml" xref="S4.p4.42.m40.1.1.2.1">percent</csymbol><cn type="integer" id="S4.p4.42.m40.1.1.2.2.cmml" xref="S4.p4.42.m40.1.1.2.2">22</cn></apply><csymbol cd="latexml" id="S4.p4.42.m40.1.1.3.cmml" xref="S4.p4.42.m40.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.42.m40.1c">22\%\uparrow</annotation></semantics></math>), demonstrating its effectiveness in enhancing the performance of the full <span id="S4.p4.42.23" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> model.
In conclusion, the improvements of different metrics attest to the effectiveness of each proposed module, underscoring their potential in producing more fluent, interactive, and diverse dance movements.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2403.18811/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="165" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S4.F6.7.1" class="ltx_text ltx_font_bold">Qualitative results (a) and user study (b).</span> <span id="S4.F6.8.2" class="ltx_text" style="color:#000000;">In qualitative results, conditioning leader is colored in gray while generated followers are in red.</span> In boxplot of user study, triangles and colored lines are mean and median values, respectively. Circles are outliers beyond <math id="S4.F6.3.m1.1" class="ltx_math_unparsed" alttext="1.5\times" display="inline"><semantics id="S4.F6.3.m1.1b"><mrow id="S4.F6.3.m1.1c"><mn id="S4.F6.3.m1.1.1">1.5</mn><mo lspace="0.222em" id="S4.F6.3.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">1.5\times</annotation></semantics></math> interquartile range (<math id="S4.F6.4.m2.1" class="ltx_Math" alttext="3\sigma" display="inline"><semantics id="S4.F6.4.m2.1b"><mrow id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml"><mn id="S4.F6.4.m2.1.1.2" xref="S4.F6.4.m2.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.F6.4.m2.1.1.1" xref="S4.F6.4.m2.1.1.1.cmml">​</mo><mi id="S4.F6.4.m2.1.1.3" xref="S4.F6.4.m2.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><apply id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1"><times id="S4.F6.4.m2.1.1.1.cmml" xref="S4.F6.4.m2.1.1.1"></times><cn type="integer" id="S4.F6.4.m2.1.1.2.cmml" xref="S4.F6.4.m2.1.1.2">3</cn><ci id="S4.F6.4.m2.1.1.3.cmml" xref="S4.F6.4.m2.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">3\sigma</annotation></semantics></math> in normal dist.).</figcaption>
</figure>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.2" class="ltx_p"><span id="S4.p5.2.1" class="ltx_text ltx_font_bold" style="color:#000000;">Qualitative Comparisons.</span>
To clearly demonstrate the effectiveness of each proposed module, we provide several visualizations of results produced by different variations in Figure <a href="#S4.F6" title="Figure 6 ‣ 4 Experiments ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
In the case of “<span id="S4.p5.2.2" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p5.1.m1.1a"><mrow id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml"><mi id="S4.p5.1.m1.1.1.2" xref="S4.p5.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.1" xref="S4.p5.1.m1.1.1.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.3" xref="S4.p5.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><apply id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1"><times id="S4.p5.1.m1.1.1.1.cmml" xref="S4.p5.1.m1.1.1.1"></times><ci id="S4.p5.1.m1.1.1.2.cmml" xref="S4.p5.1.m1.1.1.2">𝑡</ci><ci id="S4.p5.1.m1.1.1.3.cmml" xref="S4.p5.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">tr</annotation></semantics></math> IC”, the model lacks a condition for the leader, resulting in the virtual follower operating independently and not responding to the “dance hold” (the pose holding arms) initiated by the leader.
Conversely, the follower in “<span id="S4.p5.2.3" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p5.2.m2.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p5.2.m2.1a"><mrow id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml"><mi id="S4.p5.2.m2.1.1.2" xref="S4.p5.2.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p5.2.m2.1.1.1" xref="S4.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.p5.2.m2.1.1.3" xref="S4.p5.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><apply id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1"><times id="S4.p5.2.m2.1.1.1.cmml" xref="S4.p5.2.m2.1.1.1"></times><ci id="S4.p5.2.m2.1.1.2.cmml" xref="S4.p5.2.m2.1.1.2">𝑡</ci><ci id="S4.p5.2.m2.1.1.3.cmml" xref="S4.p5.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">tr</annotation></semantics></math>” can pose responsively, but she still fails to accurately follow the leader’s displacement, causing a unreasonable distance between the dancers.
The relative translation module allows the two dancers to interact closely in “Duolando w/o. RL”. However, as highlighted in the red dotted box, the follower’s legs do not move appropriately when shifting with the leader, leading to a noticeable skating artifact.
With the integration of reinforcement learning, the follower can alternate footwork, presenting a proper displacement of steps backwards.</p>
</div>
<div id="S4.p6" class="ltx_para ltx_noindent">
<p id="S4.p6.7" class="ltx_p"><span id="S4.p6.7.3" class="ltx_text ltx_font_bold">User Study.</span>
To explore subjective judgments of quality, we conduct a user study wherein <span id="S4.p6.7.4" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> is compared against each of its variants individually.
As both <span id="S4.p6.7.5" class="ltx_text ltx_font_italic">Bailando</span> and “<span id="S4.p6.7.6" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p6.1.m1.1a"><mrow id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p6.1.m1.1.1.1" xref="S4.p6.1.m1.1.1.1.cmml">​</mo><mi id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><times id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1.1"></times><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">𝑡</ci><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">tr</annotation></semantics></math> IC” are solo dance generation frameworks, we only conduct this study exclusively on the latter model, which demonstrates higher performance quantitatively.
Specifically, we recruit <span id="S4.p6.7.7" class="ltx_text" style="color:#000000;">15</span> participants, while for each participant, we randomly display 40 pairs of dance clips, with each pair comprising one <span id="S4.p6.7.8" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> result and one result from the comparison method. We then ask to indicate <span id="S4.p6.7.9" class="ltx_text ltx_font_italic">which one dances better in response to the leader and the music</span>.
As depicted in Figure <a href="#S4.F6" title="Figure 6 ‣ 4 Experiments ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(b), the full <span id="S4.p6.7.10" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> model outperforms the “w/o. RL <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p6.2.m2.1a"><mrow id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><mi id="S4.p6.2.m2.1.1.2" xref="S4.p6.2.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p6.2.m2.1.1.1" xref="S4.p6.2.m2.1.1.1.cmml">​</mo><mi id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><times id="S4.p6.2.m2.1.1.1.cmml" xref="S4.p6.2.m2.1.1.1"></times><ci id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1.2">𝑡</ci><ci id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">tr</annotation></semantics></math> IC”, w/o. RL <math id="S4.p6.3.m3.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="S4.p6.3.m3.1a"><mrow id="S4.p6.3.m3.1.1" xref="S4.p6.3.m3.1.1.cmml"><mi id="S4.p6.3.m3.1.1.2" xref="S4.p6.3.m3.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p6.3.m3.1.1.1" xref="S4.p6.3.m3.1.1.1.cmml">​</mo><mi id="S4.p6.3.m3.1.1.3" xref="S4.p6.3.m3.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.3.m3.1b"><apply id="S4.p6.3.m3.1.1.cmml" xref="S4.p6.3.m3.1.1"><times id="S4.p6.3.m3.1.1.1.cmml" xref="S4.p6.3.m3.1.1.1"></times><ci id="S4.p6.3.m3.1.1.2.cmml" xref="S4.p6.3.m3.1.1.2">𝑡</ci><ci id="S4.p6.3.m3.1.1.3.cmml" xref="S4.p6.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m3.1c">tr</annotation></semantics></math>”, and “w/o, RL” variants in <math id="S4.p6.4.m4.1" class="ltx_Math" alttext="80\%" display="inline"><semantics id="S4.p6.4.m4.1a"><mrow id="S4.p6.4.m4.1.1" xref="S4.p6.4.m4.1.1.cmml"><mn mathcolor="#000000" id="S4.p6.4.m4.1.1.2" xref="S4.p6.4.m4.1.1.2.cmml">80</mn><mo mathcolor="#000000" id="S4.p6.4.m4.1.1.1" xref="S4.p6.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.4.m4.1b"><apply id="S4.p6.4.m4.1.1.cmml" xref="S4.p6.4.m4.1.1"><csymbol cd="latexml" id="S4.p6.4.m4.1.1.1.cmml" xref="S4.p6.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.p6.4.m4.1.1.2.cmml" xref="S4.p6.4.m4.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.4.m4.1c">80\%</annotation></semantics></math><span id="S4.p6.6.2" class="ltx_text" style="color:#000000;">, <math id="S4.p6.5.1.m1.1" class="ltx_Math" alttext="83\%" display="inline"><semantics id="S4.p6.5.1.m1.1a"><mrow id="S4.p6.5.1.m1.1.1" xref="S4.p6.5.1.m1.1.1.cmml"><mn mathcolor="#000000" id="S4.p6.5.1.m1.1.1.2" xref="S4.p6.5.1.m1.1.1.2.cmml">83</mn><mo mathcolor="#000000" id="S4.p6.5.1.m1.1.1.1" xref="S4.p6.5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.5.1.m1.1b"><apply id="S4.p6.5.1.m1.1.1.cmml" xref="S4.p6.5.1.m1.1.1"><csymbol cd="latexml" id="S4.p6.5.1.m1.1.1.1.cmml" xref="S4.p6.5.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.p6.5.1.m1.1.1.2.cmml" xref="S4.p6.5.1.m1.1.1.2">83</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.5.1.m1.1c">83\%</annotation></semantics></math>, and <math id="S4.p6.6.2.m2.1" class="ltx_Math" alttext="62\%" display="inline"><semantics id="S4.p6.6.2.m2.1a"><mrow id="S4.p6.6.2.m2.1.1" xref="S4.p6.6.2.m2.1.1.cmml"><mn mathcolor="#000000" id="S4.p6.6.2.m2.1.1.2" xref="S4.p6.6.2.m2.1.1.2.cmml">62</mn><mo mathcolor="#000000" id="S4.p6.6.2.m2.1.1.1" xref="S4.p6.6.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.6.2.m2.1b"><apply id="S4.p6.6.2.m2.1.1.cmml" xref="S4.p6.6.2.m2.1.1"><csymbol cd="latexml" id="S4.p6.6.2.m2.1.1.1.cmml" xref="S4.p6.6.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.p6.6.2.m2.1.1.2.cmml" xref="S4.p6.6.2.m2.1.1.2">62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.6.2.m2.1c">62\%</annotation></semantics></math></span> of comparisons respectively, demonstrating the significance of each proposed module.
However, when compared to the ground truth, <span id="S4.p6.7.11" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span> only surpasses it around <math id="S4.p6.7.m5.1" class="ltx_Math" alttext="15\%" display="inline"><semantics id="S4.p6.7.m5.1a"><mrow id="S4.p6.7.m5.1.1" xref="S4.p6.7.m5.1.1.cmml"><mn mathcolor="#000000" id="S4.p6.7.m5.1.1.2" xref="S4.p6.7.m5.1.1.2.cmml">15</mn><mo mathcolor="#000000" id="S4.p6.7.m5.1.1.1" xref="S4.p6.7.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.7.m5.1b"><apply id="S4.p6.7.m5.1.1.cmml" xref="S4.p6.7.m5.1.1"><csymbol cd="latexml" id="S4.p6.7.m5.1.1.1.cmml" xref="S4.p6.7.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.p6.7.m5.1.1.2.cmml" xref="S4.p6.7.m5.1.1.2">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.7.m5.1c">15\%</annotation></semantics></math> of the time, indicating that dance accompaniment remains a challenging and open task for future works.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We introduce a new task named dance accompaniment.
To support this task, we first collect a large-scale duet dance dataset <span id="S5.p1.1.1" class="ltx_text ltx_font_typewriter">DD100</span>, and propose a baseline framework named Duolando, which develops a follower GPT with <span id="S5.p1.1.2" class="ltx_text" style="color:#000000;">off-policy</span> reinforcement learning.
We establish a benchmark with several metrics to evaluate the dance quality, interaction, and alignment with music.
Additionally, <span id="S5.p1.1.3" class="ltx_text ltx_font_typewriter">DD100</span> has the potential to support more multi-modal human-human interaction tasks.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Ethics Statement</span>
The task we’re proposing - dance accompaniment - holds significant potential for enhancing a multitude of VR/AR applications, including the prospect of virtually dancing alongside AI. Furthermore, research into human-human interaction could substantially aid in improving the immersive and interactive experiences offered by VR games.
However, such applications or games have a potential risk in the future that users might be addicted to interacting with virtual agent instead of real-world social events, once the response of the virtual agent is developed to be charming and real-looking enough.
Meanwhile, the research on real-looking motion generation in response to human may also lead to AI fraud, where the existing verifying methods could be more difficult to judge whether it is fake based on response.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">The data collection process (including contracts with actors) in our research was conducted ethically. The data will be released without containing any personally identifiable information.
<span id="S5.p3.1.1" class="ltx_text" style="color:#000000;">Some audio tracks in our dataset come from copyrighted musics. The inclusion of these tracks should be regarded as ‘fair use’ provisions due to three reasons. (1) The music segments used are modified (shortened, and partially slowed down), deviating from their original form. (2) The use of these tracks is solely for model training/testing the model rather than entertainment. (3) The academic nature of this work and the absence of public searchability (we won’t provide music info beyond the audio signals) avoid potential commercial impact.</span></p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Acknowledgement</span>
This research is supported by the National Research Foundation, Singapore under its AI Singapore Programme (AISG Award No: AISG-PhD/2021-01-031[T]). This study is supported under the RIE2020 Industry Alignment Fund Industry Collaboration Projects (IAF-ICP) Funding Initiative, as well as cash and in-kind contribution from the industry partner(s). It is also supported by Singapore MOE AcRF Tier 2 (MOE-T2EP20221-0011) and AcRF Tier 2 (MOE-T2EP20221-0012).</p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.1" class="ltx_p">We sincerely thank Mingyang Song, the PM in SenseTime, for helping kick off this project and thank Judy for organizing the dancers. We also appreciate Lai Jiang, Zhijie Cao, Tinghao Liu and Quan Wang for their significant help during data pre-processing. Siyao is grateful to Mr. Zhuo Sun and Dr. Chen Qian for their indispensable supports. The Mocap data are collected through services of QINGMU TECH LTD., Shanghai.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
Cmu mocap.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://mocap.cs.cmu.edu/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://mocap.cs.cmu.edu/</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ao et al. (2022)</span>
<span class="ltx_bibblock">
Tenglong Ao, Qingzhe Gao, Yuke Lou, Baoquan Chen, and Libin Liu.

</span>
<span class="ltx_bibblock">Rhythmic gesticulator: Rhythm-aware co-speech gesture synthesis with
hierarchical neural embeddings.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">SIGGRAPH Asia</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Athanasiou et al. (2022)</span>
<span class="ltx_bibblock">
Nikos Athanasiou, Mathis Petrovich, Michael J Black, and Gül Varol.

</span>
<span class="ltx_bibblock">Teach: Temporal action composition for 3d humans.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.04066</em>, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2021)</span>
<span class="ltx_bibblock">
Zhongang Cai, Mingyuan Zhang, Jiawei Ren, Chen Wei, Daxuan Ren, Jiatong Li,
Zhengyu Lin, Haiyu Zhao, Shuai Yi, Lei Yang, et al.

</span>
<span class="ltx_bibblock">Playing for 3d human recovery.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.07588</em>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2022)</span>
<span class="ltx_bibblock">
Zhongang Cai, Daxuan Ren, Ailing Zeng, Zhengyu Lin, Tao Yu, Wenjia Wang,
Xiangyu Fan, Yang Gao, Yifan Yu, Liang Pan, et al.

</span>
<span class="ltx_bibblock">Humman: Multi-modal 4d human dataset for versatile sensing and
modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; He (2021)</span>
<span class="ltx_bibblock">
Xinlei Chen and Kaiming He.

</span>
<span class="ltx_bibblock">Exploring simple siamese representation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhariwal et al. (2020)</span>
<span class="ltx_bibblock">
Prafulla Dhariwal, Heewoo Jun, Christine Payne, Jong Wook Kim, Alec Radford,
and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Jukebox: A generative model for music.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2005.00341</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghorbani &amp; Black (2021)</span>
<span class="ltx_bibblock">
Nima Ghorbani and Michael J Black.

</span>
<span class="ltx_bibblock">Soma: Solving optical marker-based mocap automatically.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. (2023)</span>
<span class="ltx_bibblock">
Anindita Ghosh, Rishabh Dabral, Vladislav Golyanik, Christian Theobalt, and
Philipp Slusallek.

</span>
<span class="ltx_bibblock">Imos: Intent-driven full-body motion synthesis for human-object
interactions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Computer Graphics Forum</em>, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2023)</span>
<span class="ltx_bibblock">
Kehong Gong, Dongze Lian, Heng Chang, Chuan Guo, Xinxin Zuo, Zihang Jiang, and
Xinchao Wang.

</span>
<span class="ltx_bibblock">Tm2d: Bimodality driven 3d dance generation via music-text
integration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Chuan Guo, Xinxin Zuo, Sen Wang, and Li Cheng.

</span>
<span class="ltx_bibblock">Tm2t: Stochastic and tokenized modeling for the reciprocal generation
of 3d human motions and texts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al. (2017)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Haoran Tang, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Reinforcement learning with deep energy-based policies.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al. (2018)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep reinforcement
learning with a stochastic actor.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2022)</span>
<span class="ltx_bibblock">
Fangzhou Hong, Mingyuan Zhang, Liang Pan, Zhongang Cai, Lei Yang, and Ziwei
Liu.

</span>
<span class="ltx_bibblock">Avatarclip: Zero-shot text-driven generation and animation of 3d
avatars.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2205.08535</em>, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Ruozi Huang, Huang Hu, Wei Wu, Kei Sawada, Mi Zhang, and Daxin Jiang.

</span>
<span class="ltx_bibblock">Dance revolution: Long-term dance generation with music via
curriculum learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jain &amp; Liu (2009)</span>
<span class="ltx_bibblock">
Sumit Jain and C Karen Liu.

</span>
<span class="ltx_bibblock">Interactive synthesis of human-object interaction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">SIGGRAPH</em>, 2009.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Biao Jiang, Xin Chen, Wen Liu, Jingyi Yu, Gang Yu, and Tao Chen.

</span>
<span class="ltx_bibblock">Motiongpt: Human motion as a foreign language.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.14795</em>, 2023.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpathy (2020)</span>
<span class="ltx_bibblock">
Andrej Karpathy.

</span>
<span class="ltx_bibblock">https://github.com/karpathy/minGPT, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Diederik Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al. (2023)</span>
<span class="ltx_bibblock">
Nhat Le, Thang Pham, Tuong Do, Erman Tjiputra, Quang D Tran, and Anh Nguyen.

</span>
<span class="ltx_bibblock">Music-driven group choreography.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2019)</span>
<span class="ltx_bibblock">
Hsin-Ying Lee, Xiaodong Yang, Ming-Yu Liu, Ting-Chun Wang, Yu-Ding Lu,
Ming-Hsuan Yang, and Jan Kautz.

</span>
<span class="ltx_bibblock">Dancing to music.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(22)</span>
<span class="ltx_bibblock">
Sergey Levine.

</span>
<span class="ltx_bibblock">https://rail.eecs.berkeley.edu/deeprlcourse/.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Buyu Li, Yongchi Zhao, Shi Zhelun, and Lu Sheng.

</span>
<span class="ltx_bibblock">Danceformer: Music conditioned 3d dance generation with parametric
motion transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021a)</span>
<span class="ltx_bibblock">
Jing Li, Di Kang, Wenjie Pei, Xuefei Zhe, Ying Zhang, Zhenyu He, and Linchao
Bao.

</span>
<span class="ltx_bibblock">Audio2gestures: Generating diverse gestures from speech audio with
conditional variational autoencoders.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021a.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Quanzhou Li, Jingbo Wang, Chen Change Loy, and Bo Dai.

</span>
<span class="ltx_bibblock">Task-oriented human-object interactions generation with implicit
neural representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.13129</em>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021b)</span>
<span class="ltx_bibblock">
Ruilong Li, Shan Yang, David A Ross, and Angjoo Kanazawa.

</span>
<span class="ltx_bibblock">Ai choreographer: Music conditioned 3d dance generation with aist++.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021b.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2023)</span>
<span class="ltx_bibblock">
Han Liang, Wenqian Zhang, Wenxuan Li, Jingyi Yu, and Lan Xu.

</span>
<span class="ltx_bibblock">Intergen: Diffusion-based multi-human motion generation under complex
interactions.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.05684</em>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Jun Liu, Amir Shahroudy, Mauricio Perez, Gang Wang, Ling-Yu Duan, and Alex C
Kot.

</span>
<span class="ltx_bibblock">Ntu rgb+d 120: A large-scale benchmark for 3d human activity
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE TPAMI</em>, 42(10), 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahmood et al. (2019)</span>
<span class="ltx_bibblock">
Naureen Mahmood, Nima Ghorbani, Nikolaus F Troje, Gerard Pons-Moll, and
Michael J Black.

</span>
<span class="ltx_bibblock">Amass: Archive of motion capture as surface shapes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McFee et al. (2015)</span>
<span class="ltx_bibblock">
Brian McFee, Colin Raffel, Dawen Liang, Daniel P Ellis, Matt McVicar, Eric
Battenberg, and Oriol Nieto.

</span>
<span class="ltx_bibblock">librosa: Audio and music signal analysis in python.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 14th python in science conference</em>, 2015.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Men et al. (2022)</span>
<span class="ltx_bibblock">
Qianhui Men, Hubert PH Shum, Edmond SL Ho, and Howard Leung.

</span>
<span class="ltx_bibblock">Gan-based reactive motion synthesis with class-aware discriminators
for human–human interaction.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">CG</em>, 102, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Müller et al. (2005)</span>
<span class="ltx_bibblock">
Meinard Müller, Tido Röder, and Michael Clausen.

</span>
<span class="ltx_bibblock">Efficient content-based retrieval of motion capture data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">SIGGRAPH</em>. 2005.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ng et al. (2020)</span>
<span class="ltx_bibblock">
Evonne Ng, Donglai Xiang, Hanbyul Joo, and Kristen Grauman.

</span>
<span class="ltx_bibblock">You2me: Inferring body pose in egocentric video via first and second
person interactions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ng et al. (2022)</span>
<span class="ltx_bibblock">
Evonne Ng, Hanbyul Joo, Liwen Hu, Hao Li, Trevor Darrell, Angjoo Kanazawa, and
Shiry Ginosar.

</span>
<span class="ltx_bibblock">Learning to listen: Modeling non-deterministic dyadic facial motion.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Onuma et al. (2008)</span>
<span class="ltx_bibblock">
Kensuke Onuma, Christos Faloutsos, and Jessica K Hodgins.

</span>
<span class="ltx_bibblock">Fmdistance: A fast and effective distance function for motion capture
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Eurographics</em>, 2008.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela
Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pavlakos et al. (2019)</span>
<span class="ltx_bibblock">
Georgios Pavlakos, Vasileios Choutas, Nima Ghorbani, Timo Bolkart, Ahmed AA
Osman, Dimitrios Tzionas, and Michael J Black.

</span>
<span class="ltx_bibblock">Expressive body capture: 3d hands, face, and body from a single
image.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrovich et al. (2021)</span>
<span class="ltx_bibblock">
Mathis Petrovich, Michael J Black, and Gül Varol.

</span>
<span class="ltx_bibblock">Action-conditioned 3d human motion synthesis with transformer vae.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrovich et al. (2022)</span>
<span class="ltx_bibblock">
Mathis Petrovich, Michael J Black, and Gül Varol.

</span>
<span class="ltx_bibblock">Temos: Generating diverse human motions from textual descriptions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2020)</span>
<span class="ltx_bibblock">
Xuanchi Ren, Haoran Li, Zijian Huang, and Qifeng Chen.

</span>
<span class="ltx_bibblock">Self-supervised dance video synthesis conditioned on music.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">ACM MM</em>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romero et al. (2022)</span>
<span class="ltx_bibblock">
Javier Romero, Dimitrios Tzionas, and Michael J Black.

</span>
<span class="ltx_bibblock">Embodied hands: Modeling and capturing hands and bodies together.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2201.02610</em>, 2022.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shafir et al. (2023)</span>
<span class="ltx_bibblock">
Yonatan Shafir, Guy Tevet, Roy Kapon, and Amit H Bermano.

</span>
<span class="ltx_bibblock">Human motion diffusion as a generative prior.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.01418</em>, 2023.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Siyao et al. (2022)</span>
<span class="ltx_bibblock">
Li Siyao, Weijiang Yu, Tianpei Gu, Chunze Lin, Quan Wang, Chen Qian,
Chen Change Loy, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Bailando: 3d dance generation by actor-critic gpt with choreographic
memory.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2020)</span>
<span class="ltx_bibblock">
Guofei Sun, Yongkang Wong, Zhiyong Cheng, Mohan S Kankanhalli, Weidong Geng,
and Xiangdong Li.

</span>
<span class="ltx_bibblock">Deepdance: music-to-dance motion choreography with adversarial
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">TMM</em>, 23, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Jiangxin Sun, Chunyu Wang, Huang Hu, Hanjiang Lai, Zhi Jin, and Jian-Fang Hu.

</span>
<span class="ltx_bibblock">You never stop dancing: Non-freezing dance generation via
bank-constrained manifold projection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. (2018)</span>
<span class="ltx_bibblock">
Taoran Tang, Jia Jia, and Hanyang Mao.

</span>
<span class="ltx_bibblock">Dance with melody: An lstm-autoencoder approach to music-oriented
dance synthesis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">ACM MM</em>, 2018.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tevet et al. (2022)</span>
<span class="ltx_bibblock">
Guy Tevet, Sigal Raab, Brian Gordon, Yonatan Shafir, Daniel Cohen-Or, and
Amit H Bermano.

</span>
<span class="ltx_bibblock">Human motion diffusion model.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.14916</em>, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tseng et al. (2023)</span>
<span class="ltx_bibblock">
Jonathan Tseng, Rodrigo Castellon, and C Karen Liu.

</span>
<span class="ltx_bibblock">Edge: editable dance generation from music.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valle-Pérez et al. (2021)</span>
<span class="ltx_bibblock">
Guillermo Valle-Pérez, Gustav Eje Henter, Jonas Beskow, Andre Holzapfel,
Pierre-Yves Oudeyer, and Simon Alexanderson.

</span>
<span class="ltx_bibblock">Transflower: probabilistic autoregressive dance generation with
multimodal attention.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">ACM TOG</em>, 40(6), 2021.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Den Oord et al. (2017)</span>
<span class="ltx_bibblock">
Aaron Van Den Oord, Oriol Vinyals, et al.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2017.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van der Aa et al. (2011)</span>
<span class="ltx_bibblock">
NP Van der Aa, Xinghan Luo, Geert-Jan Giezeman, Robby T Tan, and Remco C
Veltkamp.

</span>
<span class="ltx_bibblock">Umpm benchmark: A multi-person dataset with synchronized video and
motion capture data for evaluation of articulated human motion and
interaction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">ICCVW</em>, 2011.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam M. Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1706.03762, 2017.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vendrow et al. (2022)</span>
<span class="ltx_bibblock">
Edward Vendrow, Satyajit Kumar, Ehsan Adeli, and Hamid Rezatofighi.

</span>
<span class="ltx_bibblock">Somoformer: Multi-person pose forecasting with transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.14023</em>, 2022.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023a)</span>
<span class="ltx_bibblock">
Sicheng Yang, Zhiyong Wu, Minglei Li, Zhensong Zhang, Lei Hao, Weihong Bao,
Ming Cheng, and Long Xiao.

</span>
<span class="ltx_bibblock">Diffusestylegesture: Stylized audio-driven co-speech gesture
generation with diffusion models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">IJCAI</em>, 2023a.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023b)</span>
<span class="ltx_bibblock">
Zhitao Yang, Zhongang Cai, Haiyi Mei, Shuai Liu, Zhaoxi Chen, Weiye Xiao, Yukun
Wei, Zhongfei Qing, Chen Wei, Bo Dai, et al.

</span>
<span class="ltx_bibblock">Synbody: Synthetic dataset with layered human models for 3d human
perception and modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2023b.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2022)</span>
<span class="ltx_bibblock">
Hongwei Yi, Chun-Hao P Huang, Dimitrios Tzionas, Muhammed Kocabas, Mohamed
Hassan, Siyu Tang, Justus Thies, and Michael J Black.

</span>
<span class="ltx_bibblock">Human-aware object placement for visual environment reconstruction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2023)</span>
<span class="ltx_bibblock">
Hongwei Yi, Chun-Hao P Huang, Shashank Tripathi, Lea Hering, Justus Thies, and
Michael J Black.

</span>
<span class="ltx_bibblock">Mime: Human-aware 3d scene generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2023.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023a)</span>
<span class="ltx_bibblock">
Jianrong Zhang, Yangsong Zhang, Xiaodong Cun, Shaoli Huang, Yong Zhang, Hongwei
Zhao, Hongtao Lu, and Xi Shen.

</span>
<span class="ltx_bibblock">T2m-gpt: Generating human motion from textual descriptions with
discrete representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2023a.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Mingyuan Zhang, Zhongang Cai, Liang Pan, Fangzhou Hong, Xinying Guo, Lei Yang,
and Ziwei Liu.

</span>
<span class="ltx_bibblock">Motiondiffuse: Text-driven human motion generation with diffusion
model.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.15001</em>, 2022.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023b)</span>
<span class="ltx_bibblock">
Mingyuan Zhang, Xinying Guo, Liang Pan, Zhongang Cai, Fangzhou Hong, Huirong
Li, Lei Yang, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Remodiffuse: Retrieval-augmented motion diffusion model.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.01116</em>, 2023b.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2022)</span>
<span class="ltx_bibblock">
Kaifeng Zhao, Shaofei Wang, Yan Zhang, Thabo Beeler, and Siyu Tang.

</span>
<span class="ltx_bibblock">Compositional human-scene interaction synthesis with semantic
control.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. (2022)</span>
<span class="ltx_bibblock">
Wenlin Zhuang, Congyi Wang, Jinxiang Chai, Yangang Wang, Ming Shao, and Siyu
Xia.

</span>
<span class="ltx_bibblock">Music2dance: Dancenet for music-driven dance generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">ACM TOMM</em>, 18(2), 2022.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">Recent years have witnessed numerous studies on conditional human motion synthesis.
One one hand, it can be classified according to conditions, such as text-to-motion <cite class="ltx_cite ltx_citemacro_citep">(Petrovich et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>; Guo et al., <a href="#bib.bib11" title="" class="ltx_ref">2022</a>; Tevet et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>; Hong et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>; Petrovich et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>; Athanasiou et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>; Zhang et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>; <a href="#bib.bib58" title="" class="ltx_ref">2023a</a>; <a href="#bib.bib60" title="" class="ltx_ref">2023b</a>)</cite>, voice-to-gesture <cite class="ltx_cite ltx_citemacro_citep">(Ng et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib24" title="" class="ltx_ref">2021a</a>; Ao et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; Yang et al., <a href="#bib.bib54" title="" class="ltx_ref">2023a</a>)</cite> and music-to-dance <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>; <a href="#bib.bib23" title="" class="ltx_ref">2022</a>; Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>.
On the other hand, it can be categorized based on the type of interaction, including single-human motion synthesis <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>; Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Zhang et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>; <a href="#bib.bib60" title="" class="ltx_ref">2023b</a>; Gong et al., <a href="#bib.bib10" title="" class="ltx_ref">2023</a>; Jiang et al., <a href="#bib.bib17" title="" class="ltx_ref">2023</a>)</cite>, group human motion synthesis <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Vendrow et al., <a href="#bib.bib53" title="" class="ltx_ref">2022</a>)</cite>, human-scene interaction <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib61" title="" class="ltx_ref">2022</a>; Yi et al., <a href="#bib.bib56" title="" class="ltx_ref">2022</a>; <a href="#bib.bib57" title="" class="ltx_ref">2023</a>)</cite>, human-object interaction <cite class="ltx_cite ltx_citemacro_citep">(Jain &amp; Liu, <a href="#bib.bib16" title="" class="ltx_ref">2009</a>; Ghosh et al., <a href="#bib.bib9" title="" class="ltx_ref">2023</a>; Li et al., <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite>, and human-human interaction <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">cmu, </a>; Men et al., <a href="#bib.bib31" title="" class="ltx_ref">2022</a>; Shafir et al., <a href="#bib.bib42" title="" class="ltx_ref">2023</a>; Liang et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Music-to-Dance</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.1" class="ltx_p"><span id="A1.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
Music-to-dance represents a crucial category within the realm of conditional human motion synthesis, where music serves as the input to generate a sequence of human body movements.
Previous studies have made significant strides in this field by developing several datasets <cite class="ltx_cite ltx_citemacro_citep">(Tang et al., <a href="#bib.bib46" title="" class="ltx_ref">2018</a>; Mahmood et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>; Valle-Pérez et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>; Cai et al., <a href="#bib.bib4" title="" class="ltx_ref">2021</a>; Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>; Cai et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>; Yang et al., <a href="#bib.bib55" title="" class="ltx_ref">2023b</a>; Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> either compiled through motion capture (MoCap) systems or reconstructed from videos using automated algorithms.
AIST++<cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>)</cite> is a dataset derived from multi-camera videos spanning 10 dance genres and 30 subjects, compiling a total of 1408 sequences or 5.2 hours of content. AIOZ-GDANCE<cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> consists of 16.7 hours of paired music and 3D motion gathered from in-the-wild videos, featuring 7 dance styles and 16 music genres. Despite the advantage of an automated approach in terms of large-scale dataset collection, the quality of reconstruction is often compromised, particularly when occlusions are present or human poses are complex.
To capture high-quality motions, professional motion capture equipment is utilized. Dance Melody <cite class="ltx_cite ltx_citemacro_citep">(Tang et al., <a href="#bib.bib46" title="" class="ltx_ref">2018</a>)</cite> employs the MoCap of 3D skeletons from dancers, establishing a music-to-dance dataset with four types of dance. PMSD <cite class="ltx_cite ltx_citemacro_citep">(Valle-Pérez et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>)</cite> uses an Optitrack system comprising 17 cameras to collect 142 minutes of casual dancing and 44 minutes of street dance.
Notably, DanceFormer <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> employs animators to manually create high-quality dancing data. It took approximately 18 months for the animators to produce the 300 dance animations, which underscores the scalability challenges inherent in this approach.
However, these datasets do not incorporate strong interactions between individuals, rendering them unsuitable for either dance accompaniment or duet dance generation tasks.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.p2.1" class="ltx_p"><span id="A1.SS1.p2.1.1" class="ltx_text ltx_font_bold">Existing Methods.</span>
With the rapid development of datasets and benchmarks, numerous new methods have emerged in this field.
To generates 3D dance with input music, Dance Revolution <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> formalizes music-conditioned dance generation as a sequence-to-sequence learning problem and devise a seq2seq architecture.
FACT <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2021b</a>)</cite> incorporates a deep cross-modal transformer block with full-attention.
<span id="A1.SS1.p2.1.2" class="ltx_text ltx_font_italic">Bailando</span> <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite> proposes a two-stage procedure, where the first stage applies a VQ-VAE to quantize dancing-style poses and the latter stage employs an on-policy actor-crtic GPT to generate dancing motions, improving temporal coherency with music.
GDanceR <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> is recently proposed to produce coherent group dance, with a transformer music encoder and a group motion generator.
The existing methods, however, focus on either synthesizing solo dance motion or simultaneously generating multiple agents with weak interactions, which is not suitable for the requirement to respond to preconditioned lead dancing motion.</p>
</div>
<div id="A1.SS1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.p3.1" class="ltx_p">In contrast to previous datasets and methods, we propose a new task called dance accompaniment that requires conditioning on both music and the leader’s dance movements.
We collect a large-scale and diverse duet dance dataset named <span id="A1.SS1.p3.1.1" class="ltx_text ltx_font_typewriter">DD100</span>, which consists of both dancing sequences and the music signals, and develop a baseline method on top of it, along with evaluation protocols.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Human-human Interaction</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p"><span id="A1.SS2.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
As the quality of single-person motion generation improves, researchers are shifting their focus to the human-human interaction task.
An early attempt in this direction is CMU-MoCap <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">cmu, </a>)</cite>, which collects weak interactions like handshaking using motion capture equipment.
Since then, various multi-person motion datasets have been developed, including NTU-RGBD <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>, You2Me <cite class="ltx_cite ltx_citemacro_citep">(Ng et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, and UMPM <cite class="ltx_cite ltx_citemacro_citep">(Van der Aa et al., <a href="#bib.bib51" title="" class="ltx_ref">2011</a>)</cite>.
However, while these datasets contain multi-person motion data, they are limited in interaction type and strength.
A recent dataset, InterHuman <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>, also captures interactions through MocCap, and labels the motions
with textual descriptions.
However, InterHuman does not provide music as a multi-modality condition, which is not comprehensive enough for the task of dance accompaniment.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.1" class="ltx_p"><span id="A1.SS2.p2.1.1" class="ltx_text ltx_font_bold">Existing Methods.</span>
With the availability of these datasets, several methods have been proposed for generating human-human interaction motions.
 <cite class="ltx_cite ltx_citemacro_citep">(Men et al., <a href="#bib.bib31" title="" class="ltx_ref">2022</a>)</cite> propose a seq2seq GAN system that synthesizes the reactive motion of a character given the active motion from another character.
ComMDM <cite class="ltx_cite ltx_citemacro_citep">(Shafir et al., <a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite> devises a communication block to infuse interaction between two generated motions, using a pretrained diffusion-based model as a generative prior.
InterGen <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> tailors the motion diffusion model to a two-person interaction setting, via two cooperative transformer-based denoisers with mutual attention mechanism.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS2.p3.1" class="ltx_p">In contrast to these human-human interaction datasets and approaches, our dance accompaniment introduces the music modality and requires adherence to both the rhythm of the music and the motion from another person.
Moreover, due to the unique nature of dance, it involves long-term strong interaction between dancers.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More details</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">In this section we introduce statistics of the motion speed in different dance types, the detailed network structures and training process of <span id="A2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span>.</p>
</div>
<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Speed Statistics</h3>

<figure id="A2.F7" class="ltx_figure"><img src="/html/2403.18811/assets/x7.png" id="A2.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="118" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="A2.F7.2.1" class="ltx_text ltx_font_bold">Statistics of average speed values (cm per frame) for different dances.</span> We present the speed values of three kinds of joints: root (pelvis), hands and feet.</figcaption>
</figure>
<div id="A2.SS1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.p1.1" class="ltx_p">We calculated the average speed for each dance type by computing the average difference in 3D coordinates between frames for the root (pelvis), hands, and feet, as shown in Figure <a href="#A2.F7" title="Figure 7 ‣ B.1 Speed Statistics ‣ Appendix B More details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
Typically, Ballet involves many spinning in place, resulting in a low overall global (root) speed, while Quickstep, known for its lightness and speed, exhibit a higher overall velocity.
Meanwhile, some dances with relatively low overall movement speed but expressive hand movements (like Jive and Cha Cha), contrast with those that have smaller hand variations and primarily rely on footwork (such as Waltz and Foxtrot).</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Network Structures</h3>

<div id="A2.SS2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.p1.1" class="ltx_p"><span id="A2.SS2.p1.1.1" class="ltx_text ltx_font_bold">VQ-VAEs</span>.
The encoder and decoders in Section 3.1 of the main paper are complied as 1D temporal CNNs. The detailed structures are shown in Table <a href="#A2.T3" title="Table 3 ‣ B.3 Training Hyper-parameters ‣ Appendix B More details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The encoder is designed to downsample the 3D joint sequence 8 times into the encoding features, and therefore the learned quantized features are aware of contextual poses in the dance sequence.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para ltx_noindent">
<p id="A2.SS2.p2.4" class="ltx_p">Separate VQVAEs are trained for the compositional upper-and-lower half bodies, respectively.
The joint number <math id="A2.SS2.p2.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A2.SS2.p2.1.m1.1a"><mi id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.1b"><ci id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">J</annotation></semantics></math> of the upper half body is <math id="A2.SS2.p2.2.m2.1" class="ltx_Math" alttext="15" display="inline"><semantics id="A2.SS2.p2.2.m2.1a"><mn id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.1b"><cn type="integer" id="A2.SS2.p2.2.m2.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.1c">15</annotation></semantics></math> and that of the lower is <math id="A2.SS2.p2.3.m3.1" class="ltx_Math" alttext="9" display="inline"><semantics id="A2.SS2.p2.3.m3.1a"><mn id="A2.SS2.p2.3.m3.1.1" xref="A2.SS2.p2.3.m3.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.3.m3.1b"><cn type="integer" id="A2.SS2.p2.3.m3.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.3.m3.1c">9</annotation></semantics></math>, while <math id="A2.SS2.p2.4.m4.1" class="ltx_Math" alttext="J=1" display="inline"><semantics id="A2.SS2.p2.4.m4.1a"><mrow id="A2.SS2.p2.4.m4.1.1" xref="A2.SS2.p2.4.m4.1.1.cmml"><mi id="A2.SS2.p2.4.m4.1.1.2" xref="A2.SS2.p2.4.m4.1.1.2.cmml">J</mi><mo id="A2.SS2.p2.4.m4.1.1.1" xref="A2.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A2.SS2.p2.4.m4.1.1.3" xref="A2.SS2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.4.m4.1b"><apply id="A2.SS2.p2.4.m4.1.1.cmml" xref="A2.SS2.p2.4.m4.1.1"><eq id="A2.SS2.p2.4.m4.1.1.1.cmml" xref="A2.SS2.p2.4.m4.1.1.1"></eq><ci id="A2.SS2.p2.4.m4.1.1.2.cmml" xref="A2.SS2.p2.4.m4.1.1.2">𝐽</ci><cn type="integer" id="A2.SS2.p2.4.m4.1.1.3.cmml" xref="A2.SS2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.4.m4.1c">J=1</annotation></semantics></math> in the global-velocity branch.</p>
</div>
<div id="A2.SS2.p3" class="ltx_para ltx_noindent">
<p id="A2.SS2.p3.6" class="ltx_p"><span id="A2.SS2.p3.6.1" class="ltx_text ltx_font_bold">GPT</span>.
We follow the fundamental structure of minGPT by <cite class="ltx_cite ltx_citemacro_cite">Karpathy (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>.
Specifically, the we employ <math id="A2.SS2.p3.1.m1.1" class="ltx_Math" alttext="12" display="inline"><semantics id="A2.SS2.p3.1.m1.1a"><mn id="A2.SS2.p3.1.m1.1.1" xref="A2.SS2.p3.1.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.1.m1.1b"><cn type="integer" id="A2.SS2.p3.1.m1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">12</annotation></semantics></math> Transformer layers with the block size <math id="A2.SS2.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.SS2.p3.2.m2.1a"><mi id="A2.SS2.p3.2.m2.1.1" xref="A2.SS2.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.2.m2.1b"><ci id="A2.SS2.p3.2.m2.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.2.m2.1c">T</annotation></semantics></math> of <math id="A2.SS2.p3.3.m3.1" class="ltx_Math" alttext="30" display="inline"><semantics id="A2.SS2.p3.3.m3.1a"><mn id="A2.SS2.p3.3.m3.1.1" xref="A2.SS2.p3.3.m3.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.3.m3.1b"><cn type="integer" id="A2.SS2.p3.3.m3.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.3.m3.1c">30</annotation></semantics></math> and feature dimension of <math id="A2.SS2.p3.4.m4.1" class="ltx_Math" alttext="768" display="inline"><semantics id="A2.SS2.p3.4.m4.1a"><mn id="A2.SS2.p3.4.m4.1.1" xref="A2.SS2.p3.4.m4.1.1.cmml">768</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.4.m4.1b"><cn type="integer" id="A2.SS2.p3.4.m4.1.1.cmml" xref="A2.SS2.p3.4.m4.1.1">768</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.4.m4.1c">768</annotation></semantics></math>, while the LAT consists of three Transformer layers with the look-ahead length <math id="A2.SS2.p3.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="A2.SS2.p3.5.m5.1a"><mi id="A2.SS2.p3.5.m5.1.1" xref="A2.SS2.p3.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.5.m5.1b"><ci id="A2.SS2.p3.5.m5.1.1.cmml" xref="A2.SS2.p3.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.5.m5.1c">L</annotation></semantics></math> of <math id="A2.SS2.p3.6.m6.1" class="ltx_Math" alttext="29" display="inline"><semantics id="A2.SS2.p3.6.m6.1a"><mn id="A2.SS2.p3.6.m6.1.1" xref="A2.SS2.p3.6.m6.1.1.cmml">29</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.6.m6.1b"><cn type="integer" id="A2.SS2.p3.6.m6.1.1.cmml" xref="A2.SS2.p3.6.m6.1.1">29</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.6.m6.1c">29</annotation></semantics></math> (around 4 seconds).</p>
</div>
<div id="A2.SS2.p4" class="ltx_para ltx_noindent">
<p id="A2.SS2.p4.1" class="ltx_p">The music features <math id="A2.SS2.p4.1.m1.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="A2.SS2.p4.1.m1.1a"><mi id="A2.SS2.p4.1.m1.1.1" xref="A2.SS2.p4.1.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.1.m1.1b"><ci id="A2.SS2.p4.1.m1.1.1.cmml" xref="A2.SS2.p4.1.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.1.m1.1c">\bm{m}</annotation></semantics></math> are extracted from the audio signal using the public audio processing toolbox Librosa <cite class="ltx_cite ltx_citemacro_citep">(McFee et al., <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>, including mel frequency cepstral coefficients
(MFCC), MFCC delta, constant-Q chromagram,
onset strength and onset beat, which are 54-dimension in total,
and are mapped to the same dimension of GPT via a learned
linear layer.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Training Hyper-parameters</h3>

<div id="A2.SS3.p1" class="ltx_para ltx_noindent">
<p id="A2.SS3.p1.23" class="ltx_p">In terms of hyper-parameters, we set the codebook capacity <math id="A2.SS3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.SS3.p1.1.m1.1a"><mi id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><ci id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">K</annotation></semantics></math> to <math id="A2.SS3.p1.2.m2.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A2.SS3.p1.2.m2.1a"><mn id="A2.SS3.p1.2.m2.1.1" xref="A2.SS3.p1.2.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.2.m2.1b"><cn type="integer" id="A2.SS3.p1.2.m2.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.2.m2.1c">512</annotation></semantics></math> for all quantized items (<math id="A2.SS3.p1.3.m3.1" class="ltx_Math" alttext="z^{up}" display="inline"><semantics id="A2.SS3.p1.3.m3.1a"><msup id="A2.SS3.p1.3.m3.1.1" xref="A2.SS3.p1.3.m3.1.1.cmml"><mi id="A2.SS3.p1.3.m3.1.1.2" xref="A2.SS3.p1.3.m3.1.1.2.cmml">z</mi><mrow id="A2.SS3.p1.3.m3.1.1.3" xref="A2.SS3.p1.3.m3.1.1.3.cmml"><mi id="A2.SS3.p1.3.m3.1.1.3.2" xref="A2.SS3.p1.3.m3.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.3.m3.1.1.3.1" xref="A2.SS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.3.m3.1.1.3.3" xref="A2.SS3.p1.3.m3.1.1.3.3.cmml">p</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.3.m3.1b"><apply id="A2.SS3.p1.3.m3.1.1.cmml" xref="A2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.3.m3.1.1.1.cmml" xref="A2.SS3.p1.3.m3.1.1">superscript</csymbol><ci id="A2.SS3.p1.3.m3.1.1.2.cmml" xref="A2.SS3.p1.3.m3.1.1.2">𝑧</ci><apply id="A2.SS3.p1.3.m3.1.1.3.cmml" xref="A2.SS3.p1.3.m3.1.1.3"><times id="A2.SS3.p1.3.m3.1.1.3.1.cmml" xref="A2.SS3.p1.3.m3.1.1.3.1"></times><ci id="A2.SS3.p1.3.m3.1.1.3.2.cmml" xref="A2.SS3.p1.3.m3.1.1.3.2">𝑢</ci><ci id="A2.SS3.p1.3.m3.1.1.3.3.cmml" xref="A2.SS3.p1.3.m3.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.3.m3.1c">z^{up}</annotation></semantics></math>, <math id="A2.SS3.p1.4.m4.1" class="ltx_Math" alttext="z^{down}" display="inline"><semantics id="A2.SS3.p1.4.m4.1a"><msup id="A2.SS3.p1.4.m4.1.1" xref="A2.SS3.p1.4.m4.1.1.cmml"><mi id="A2.SS3.p1.4.m4.1.1.2" xref="A2.SS3.p1.4.m4.1.1.2.cmml">z</mi><mrow id="A2.SS3.p1.4.m4.1.1.3" xref="A2.SS3.p1.4.m4.1.1.3.cmml"><mi id="A2.SS3.p1.4.m4.1.1.3.2" xref="A2.SS3.p1.4.m4.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.1.1.3.1" xref="A2.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.1.1.3.3" xref="A2.SS3.p1.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.1.1.3.1a" xref="A2.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.1.1.3.4" xref="A2.SS3.p1.4.m4.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.1.1.3.1b" xref="A2.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.1.1.3.5" xref="A2.SS3.p1.4.m4.1.1.3.5.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.4.m4.1b"><apply id="A2.SS3.p1.4.m4.1.1.cmml" xref="A2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.4.m4.1.1.1.cmml" xref="A2.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="A2.SS3.p1.4.m4.1.1.2.cmml" xref="A2.SS3.p1.4.m4.1.1.2">𝑧</ci><apply id="A2.SS3.p1.4.m4.1.1.3.cmml" xref="A2.SS3.p1.4.m4.1.1.3"><times id="A2.SS3.p1.4.m4.1.1.3.1.cmml" xref="A2.SS3.p1.4.m4.1.1.3.1"></times><ci id="A2.SS3.p1.4.m4.1.1.3.2.cmml" xref="A2.SS3.p1.4.m4.1.1.3.2">𝑑</ci><ci id="A2.SS3.p1.4.m4.1.1.3.3.cmml" xref="A2.SS3.p1.4.m4.1.1.3.3">𝑜</ci><ci id="A2.SS3.p1.4.m4.1.1.3.4.cmml" xref="A2.SS3.p1.4.m4.1.1.3.4">𝑤</ci><ci id="A2.SS3.p1.4.m4.1.1.3.5.cmml" xref="A2.SS3.p1.4.m4.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.4.m4.1c">z^{down}</annotation></semantics></math>, <math id="A2.SS3.p1.5.m5.1" class="ltx_Math" alttext="z^{lhand}" display="inline"><semantics id="A2.SS3.p1.5.m5.1a"><msup id="A2.SS3.p1.5.m5.1.1" xref="A2.SS3.p1.5.m5.1.1.cmml"><mi id="A2.SS3.p1.5.m5.1.1.2" xref="A2.SS3.p1.5.m5.1.1.2.cmml">z</mi><mrow id="A2.SS3.p1.5.m5.1.1.3" xref="A2.SS3.p1.5.m5.1.1.3.cmml"><mi id="A2.SS3.p1.5.m5.1.1.3.2" xref="A2.SS3.p1.5.m5.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.5.m5.1.1.3.1" xref="A2.SS3.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.5.m5.1.1.3.3" xref="A2.SS3.p1.5.m5.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.5.m5.1.1.3.1a" xref="A2.SS3.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.5.m5.1.1.3.4" xref="A2.SS3.p1.5.m5.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.5.m5.1.1.3.1b" xref="A2.SS3.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.5.m5.1.1.3.5" xref="A2.SS3.p1.5.m5.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.5.m5.1.1.3.1c" xref="A2.SS3.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.5.m5.1.1.3.6" xref="A2.SS3.p1.5.m5.1.1.3.6.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.5.m5.1b"><apply id="A2.SS3.p1.5.m5.1.1.cmml" xref="A2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.5.m5.1.1.1.cmml" xref="A2.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="A2.SS3.p1.5.m5.1.1.2.cmml" xref="A2.SS3.p1.5.m5.1.1.2">𝑧</ci><apply id="A2.SS3.p1.5.m5.1.1.3.cmml" xref="A2.SS3.p1.5.m5.1.1.3"><times id="A2.SS3.p1.5.m5.1.1.3.1.cmml" xref="A2.SS3.p1.5.m5.1.1.3.1"></times><ci id="A2.SS3.p1.5.m5.1.1.3.2.cmml" xref="A2.SS3.p1.5.m5.1.1.3.2">𝑙</ci><ci id="A2.SS3.p1.5.m5.1.1.3.3.cmml" xref="A2.SS3.p1.5.m5.1.1.3.3">ℎ</ci><ci id="A2.SS3.p1.5.m5.1.1.3.4.cmml" xref="A2.SS3.p1.5.m5.1.1.3.4">𝑎</ci><ci id="A2.SS3.p1.5.m5.1.1.3.5.cmml" xref="A2.SS3.p1.5.m5.1.1.3.5">𝑛</ci><ci id="A2.SS3.p1.5.m5.1.1.3.6.cmml" xref="A2.SS3.p1.5.m5.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.5.m5.1c">z^{lhand}</annotation></semantics></math>, <math id="A2.SS3.p1.6.m6.1" class="ltx_Math" alttext="z^{rhand}" display="inline"><semantics id="A2.SS3.p1.6.m6.1a"><msup id="A2.SS3.p1.6.m6.1.1" xref="A2.SS3.p1.6.m6.1.1.cmml"><mi id="A2.SS3.p1.6.m6.1.1.2" xref="A2.SS3.p1.6.m6.1.1.2.cmml">z</mi><mrow id="A2.SS3.p1.6.m6.1.1.3" xref="A2.SS3.p1.6.m6.1.1.3.cmml"><mi id="A2.SS3.p1.6.m6.1.1.3.2" xref="A2.SS3.p1.6.m6.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.6.m6.1.1.3.1" xref="A2.SS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.6.m6.1.1.3.3" xref="A2.SS3.p1.6.m6.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.6.m6.1.1.3.1a" xref="A2.SS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.6.m6.1.1.3.4" xref="A2.SS3.p1.6.m6.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.6.m6.1.1.3.1b" xref="A2.SS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.6.m6.1.1.3.5" xref="A2.SS3.p1.6.m6.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.6.m6.1.1.3.1c" xref="A2.SS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.6.m6.1.1.3.6" xref="A2.SS3.p1.6.m6.1.1.3.6.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.6.m6.1b"><apply id="A2.SS3.p1.6.m6.1.1.cmml" xref="A2.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.6.m6.1.1.1.cmml" xref="A2.SS3.p1.6.m6.1.1">superscript</csymbol><ci id="A2.SS3.p1.6.m6.1.1.2.cmml" xref="A2.SS3.p1.6.m6.1.1.2">𝑧</ci><apply id="A2.SS3.p1.6.m6.1.1.3.cmml" xref="A2.SS3.p1.6.m6.1.1.3"><times id="A2.SS3.p1.6.m6.1.1.3.1.cmml" xref="A2.SS3.p1.6.m6.1.1.3.1"></times><ci id="A2.SS3.p1.6.m6.1.1.3.2.cmml" xref="A2.SS3.p1.6.m6.1.1.3.2">𝑟</ci><ci id="A2.SS3.p1.6.m6.1.1.3.3.cmml" xref="A2.SS3.p1.6.m6.1.1.3.3">ℎ</ci><ci id="A2.SS3.p1.6.m6.1.1.3.4.cmml" xref="A2.SS3.p1.6.m6.1.1.3.4">𝑎</ci><ci id="A2.SS3.p1.6.m6.1.1.3.5.cmml" xref="A2.SS3.p1.6.m6.1.1.3.5">𝑛</ci><ci id="A2.SS3.p1.6.m6.1.1.3.6.cmml" xref="A2.SS3.p1.6.m6.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.6.m6.1c">z^{rhand}</annotation></semantics></math>, and <math id="A2.SS3.p1.7.m7.1" class="ltx_Math" alttext="z^{tr}" display="inline"><semantics id="A2.SS3.p1.7.m7.1a"><msup id="A2.SS3.p1.7.m7.1.1" xref="A2.SS3.p1.7.m7.1.1.cmml"><mi id="A2.SS3.p1.7.m7.1.1.2" xref="A2.SS3.p1.7.m7.1.1.2.cmml">z</mi><mrow id="A2.SS3.p1.7.m7.1.1.3" xref="A2.SS3.p1.7.m7.1.1.3.cmml"><mi id="A2.SS3.p1.7.m7.1.1.3.2" xref="A2.SS3.p1.7.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.7.m7.1.1.3.1" xref="A2.SS3.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.7.m7.1.1.3.3" xref="A2.SS3.p1.7.m7.1.1.3.3.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.7.m7.1b"><apply id="A2.SS3.p1.7.m7.1.1.cmml" xref="A2.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.7.m7.1.1.1.cmml" xref="A2.SS3.p1.7.m7.1.1">superscript</csymbol><ci id="A2.SS3.p1.7.m7.1.1.2.cmml" xref="A2.SS3.p1.7.m7.1.1.2">𝑧</ci><apply id="A2.SS3.p1.7.m7.1.1.3.cmml" xref="A2.SS3.p1.7.m7.1.1.3"><times id="A2.SS3.p1.7.m7.1.1.3.1.cmml" xref="A2.SS3.p1.7.m7.1.1.3.1"></times><ci id="A2.SS3.p1.7.m7.1.1.3.2.cmml" xref="A2.SS3.p1.7.m7.1.1.3.2">𝑡</ci><ci id="A2.SS3.p1.7.m7.1.1.3.3.cmml" xref="A2.SS3.p1.7.m7.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.7.m7.1c">z^{tr}</annotation></semantics></math>).
During VQ-VAE training, we segment motion sequences into 4-second (<math id="A2.SS3.p1.8.m8.1" class="ltx_math_unparsed" alttext="T=120)" display="inline"><semantics id="A2.SS3.p1.8.m8.1a"><mrow id="A2.SS3.p1.8.m8.1b"><mi id="A2.SS3.p1.8.m8.1.1">T</mi><mo id="A2.SS3.p1.8.m8.1.2">=</mo><mn id="A2.SS3.p1.8.m8.1.3">120</mn><mo stretchy="false" id="A2.SS3.p1.8.m8.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="A2.SS3.p1.8.m8.1c">T=120)</annotation></semantics></math> slices with a batch size of <math id="A2.SS3.p1.9.m9.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A2.SS3.p1.9.m9.1a"><mn id="A2.SS3.p1.9.m9.1.1" xref="A2.SS3.p1.9.m9.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.9.m9.1b"><cn type="integer" id="A2.SS3.p1.9.m9.1.1.cmml" xref="A2.SS3.p1.9.m9.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.9.m9.1c">64</annotation></semantics></math>. The encoder’s temporal downsampling rate <math id="A2.SS3.p1.10.m10.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.SS3.p1.10.m10.1a"><mi id="A2.SS3.p1.10.m10.1.1" xref="A2.SS3.p1.10.m10.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.10.m10.1b"><ci id="A2.SS3.p1.10.m10.1.1.cmml" xref="A2.SS3.p1.10.m10.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.10.m10.1c">d</annotation></semantics></math> is set to <math id="A2.SS3.p1.11.m11.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A2.SS3.p1.11.m11.1a"><mn id="A2.SS3.p1.11.m11.1.1" xref="A2.SS3.p1.11.m11.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.11.m11.1b"><cn type="integer" id="A2.SS3.p1.11.m11.1.1.cmml" xref="A2.SS3.p1.11.m11.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.11.m11.1c">4</annotation></semantics></math>, and the commitment trade-off <math id="A2.SS3.p1.12.m12.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.SS3.p1.12.m12.1a"><mi id="A2.SS3.p1.12.m12.1.1" xref="A2.SS3.p1.12.m12.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.12.m12.1b"><ci id="A2.SS3.p1.12.m12.1.1.cmml" xref="A2.SS3.p1.12.m12.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.12.m12.1c">\lambda</annotation></semantics></math> is <math id="A2.SS3.p1.13.m13.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A2.SS3.p1.13.m13.1a"><mn id="A2.SS3.p1.13.m13.1.1" xref="A2.SS3.p1.13.m13.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.13.m13.1b"><cn type="float" id="A2.SS3.p1.13.m13.1.1.cmml" xref="A2.SS3.p1.13.m13.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.13.m13.1c">0.1</annotation></semantics></math>. We adopt a learning rate of <math id="A2.SS3.p1.14.m14.1" class="ltx_Math" alttext="3\times 10^{-5}" display="inline"><semantics id="A2.SS3.p1.14.m14.1a"><mrow id="A2.SS3.p1.14.m14.1.1" xref="A2.SS3.p1.14.m14.1.1.cmml"><mn id="A2.SS3.p1.14.m14.1.1.2" xref="A2.SS3.p1.14.m14.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS3.p1.14.m14.1.1.1" xref="A2.SS3.p1.14.m14.1.1.1.cmml">×</mo><msup id="A2.SS3.p1.14.m14.1.1.3" xref="A2.SS3.p1.14.m14.1.1.3.cmml"><mn id="A2.SS3.p1.14.m14.1.1.3.2" xref="A2.SS3.p1.14.m14.1.1.3.2.cmml">10</mn><mrow id="A2.SS3.p1.14.m14.1.1.3.3" xref="A2.SS3.p1.14.m14.1.1.3.3.cmml"><mo id="A2.SS3.p1.14.m14.1.1.3.3a" xref="A2.SS3.p1.14.m14.1.1.3.3.cmml">−</mo><mn id="A2.SS3.p1.14.m14.1.1.3.3.2" xref="A2.SS3.p1.14.m14.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.14.m14.1b"><apply id="A2.SS3.p1.14.m14.1.1.cmml" xref="A2.SS3.p1.14.m14.1.1"><times id="A2.SS3.p1.14.m14.1.1.1.cmml" xref="A2.SS3.p1.14.m14.1.1.1"></times><cn type="integer" id="A2.SS3.p1.14.m14.1.1.2.cmml" xref="A2.SS3.p1.14.m14.1.1.2">3</cn><apply id="A2.SS3.p1.14.m14.1.1.3.cmml" xref="A2.SS3.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="A2.SS3.p1.14.m14.1.1.3.1.cmml" xref="A2.SS3.p1.14.m14.1.1.3">superscript</csymbol><cn type="integer" id="A2.SS3.p1.14.m14.1.1.3.2.cmml" xref="A2.SS3.p1.14.m14.1.1.3.2">10</cn><apply id="A2.SS3.p1.14.m14.1.1.3.3.cmml" xref="A2.SS3.p1.14.m14.1.1.3.3"><minus id="A2.SS3.p1.14.m14.1.1.3.3.1.cmml" xref="A2.SS3.p1.14.m14.1.1.3.3"></minus><cn type="integer" id="A2.SS3.p1.14.m14.1.1.3.3.2.cmml" xref="A2.SS3.p1.14.m14.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.14.m14.1c">3\times 10^{-5}</annotation></semantics></math> to train the VQ-VAE for <math id="A2.SS3.p1.15.m15.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A2.SS3.p1.15.m15.1a"><mn id="A2.SS3.p1.15.m15.1.1" xref="A2.SS3.p1.15.m15.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.15.m15.1b"><cn type="integer" id="A2.SS3.p1.15.m15.1.1.cmml" xref="A2.SS3.p1.15.m15.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.15.m15.1c">500</annotation></semantics></math> epochs, with a decay of <math id="A2.SS3.p1.16.m16.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A2.SS3.p1.16.m16.1a"><mn id="A2.SS3.p1.16.m16.1.1" xref="A2.SS3.p1.16.m16.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.16.m16.1b"><cn type="float" id="A2.SS3.p1.16.m16.1.1.cmml" xref="A2.SS3.p1.16.m16.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.16.m16.1c">0.1</annotation></semantics></math> after both the 200th and 300th epochs.
Throughout the supervised training state of GPT, we adopt cross-entropy loss with a learning rate of <math id="A2.SS3.p1.17.m17.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="A2.SS3.p1.17.m17.1a"><msup id="A2.SS3.p1.17.m17.1.1" xref="A2.SS3.p1.17.m17.1.1.cmml"><mn id="A2.SS3.p1.17.m17.1.1.2" xref="A2.SS3.p1.17.m17.1.1.2.cmml">10</mn><mrow id="A2.SS3.p1.17.m17.1.1.3" xref="A2.SS3.p1.17.m17.1.1.3.cmml"><mo id="A2.SS3.p1.17.m17.1.1.3a" xref="A2.SS3.p1.17.m17.1.1.3.cmml">−</mo><mn id="A2.SS3.p1.17.m17.1.1.3.2" xref="A2.SS3.p1.17.m17.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.17.m17.1b"><apply id="A2.SS3.p1.17.m17.1.1.cmml" xref="A2.SS3.p1.17.m17.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.17.m17.1.1.1.cmml" xref="A2.SS3.p1.17.m17.1.1">superscript</csymbol><cn type="integer" id="A2.SS3.p1.17.m17.1.1.2.cmml" xref="A2.SS3.p1.17.m17.1.1.2">10</cn><apply id="A2.SS3.p1.17.m17.1.1.3.cmml" xref="A2.SS3.p1.17.m17.1.1.3"><minus id="A2.SS3.p1.17.m17.1.1.3.1.cmml" xref="A2.SS3.p1.17.m17.1.1.3"></minus><cn type="integer" id="A2.SS3.p1.17.m17.1.1.3.2.cmml" xref="A2.SS3.p1.17.m17.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.17.m17.1c">10^{-4}</annotation></semantics></math> for 500 epochs.
For the reinforcement learning stage, we apply <math id="A2.SS3.p1.18.m18.1" class="ltx_Math" alttext="\mathcal{L}^{\text{off}}_{RL}" display="inline"><semantics id="A2.SS3.p1.18.m18.1a"><msubsup id="A2.SS3.p1.18.m18.1.1" xref="A2.SS3.p1.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS3.p1.18.m18.1.1.2.2" xref="A2.SS3.p1.18.m18.1.1.2.2.cmml">ℒ</mi><mrow id="A2.SS3.p1.18.m18.1.1.3" xref="A2.SS3.p1.18.m18.1.1.3.cmml"><mi id="A2.SS3.p1.18.m18.1.1.3.2" xref="A2.SS3.p1.18.m18.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.18.m18.1.1.3.1" xref="A2.SS3.p1.18.m18.1.1.3.1.cmml">​</mo><mi id="A2.SS3.p1.18.m18.1.1.3.3" xref="A2.SS3.p1.18.m18.1.1.3.3.cmml">L</mi></mrow><mtext id="A2.SS3.p1.18.m18.1.1.2.3" xref="A2.SS3.p1.18.m18.1.1.2.3a.cmml">off</mtext></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.18.m18.1b"><apply id="A2.SS3.p1.18.m18.1.1.cmml" xref="A2.SS3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.18.m18.1.1.1.cmml" xref="A2.SS3.p1.18.m18.1.1">subscript</csymbol><apply id="A2.SS3.p1.18.m18.1.1.2.cmml" xref="A2.SS3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.18.m18.1.1.2.1.cmml" xref="A2.SS3.p1.18.m18.1.1">superscript</csymbol><ci id="A2.SS3.p1.18.m18.1.1.2.2.cmml" xref="A2.SS3.p1.18.m18.1.1.2.2">ℒ</ci><ci id="A2.SS3.p1.18.m18.1.1.2.3a.cmml" xref="A2.SS3.p1.18.m18.1.1.2.3"><mtext mathsize="70%" id="A2.SS3.p1.18.m18.1.1.2.3.cmml" xref="A2.SS3.p1.18.m18.1.1.2.3">off</mtext></ci></apply><apply id="A2.SS3.p1.18.m18.1.1.3.cmml" xref="A2.SS3.p1.18.m18.1.1.3"><times id="A2.SS3.p1.18.m18.1.1.3.1.cmml" xref="A2.SS3.p1.18.m18.1.1.3.1"></times><ci id="A2.SS3.p1.18.m18.1.1.3.2.cmml" xref="A2.SS3.p1.18.m18.1.1.3.2">𝑅</ci><ci id="A2.SS3.p1.18.m18.1.1.3.3.cmml" xref="A2.SS3.p1.18.m18.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.18.m18.1c">\mathcal{L}^{\text{off}}_{RL}</annotation></semantics></math> learning rate of <math id="A2.SS3.p1.19.m19.1" class="ltx_Math" alttext="3\times 10^{-5}" display="inline"><semantics id="A2.SS3.p1.19.m19.1a"><mrow id="A2.SS3.p1.19.m19.1.1" xref="A2.SS3.p1.19.m19.1.1.cmml"><mn id="A2.SS3.p1.19.m19.1.1.2" xref="A2.SS3.p1.19.m19.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS3.p1.19.m19.1.1.1" xref="A2.SS3.p1.19.m19.1.1.1.cmml">×</mo><msup id="A2.SS3.p1.19.m19.1.1.3" xref="A2.SS3.p1.19.m19.1.1.3.cmml"><mn id="A2.SS3.p1.19.m19.1.1.3.2" xref="A2.SS3.p1.19.m19.1.1.3.2.cmml">10</mn><mrow id="A2.SS3.p1.19.m19.1.1.3.3" xref="A2.SS3.p1.19.m19.1.1.3.3.cmml"><mo id="A2.SS3.p1.19.m19.1.1.3.3a" xref="A2.SS3.p1.19.m19.1.1.3.3.cmml">−</mo><mn id="A2.SS3.p1.19.m19.1.1.3.3.2" xref="A2.SS3.p1.19.m19.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.19.m19.1b"><apply id="A2.SS3.p1.19.m19.1.1.cmml" xref="A2.SS3.p1.19.m19.1.1"><times id="A2.SS3.p1.19.m19.1.1.1.cmml" xref="A2.SS3.p1.19.m19.1.1.1"></times><cn type="integer" id="A2.SS3.p1.19.m19.1.1.2.cmml" xref="A2.SS3.p1.19.m19.1.1.2">3</cn><apply id="A2.SS3.p1.19.m19.1.1.3.cmml" xref="A2.SS3.p1.19.m19.1.1.3"><csymbol cd="ambiguous" id="A2.SS3.p1.19.m19.1.1.3.1.cmml" xref="A2.SS3.p1.19.m19.1.1.3">superscript</csymbol><cn type="integer" id="A2.SS3.p1.19.m19.1.1.3.2.cmml" xref="A2.SS3.p1.19.m19.1.1.3.2">10</cn><apply id="A2.SS3.p1.19.m19.1.1.3.3.cmml" xref="A2.SS3.p1.19.m19.1.1.3.3"><minus id="A2.SS3.p1.19.m19.1.1.3.3.1.cmml" xref="A2.SS3.p1.19.m19.1.1.3.3"></minus><cn type="integer" id="A2.SS3.p1.19.m19.1.1.3.3.2.cmml" xref="A2.SS3.p1.19.m19.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.19.m19.1c">3\times 10^{-5}</annotation></semantics></math> for <math id="A2.SS3.p1.20.m20.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A2.SS3.p1.20.m20.1a"><mn id="A2.SS3.p1.20.m20.1.1" xref="A2.SS3.p1.20.m20.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.20.m20.1b"><cn type="integer" id="A2.SS3.p1.20.m20.1.1.cmml" xref="A2.SS3.p1.20.m20.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.20.m20.1c">50</annotation></semantics></math> epochs.
The OOD dataset <math id="A2.SS3.p1.21.m21.1" class="ltx_Math" alttext="\hat{\mathcal{D}}" display="inline"><semantics id="A2.SS3.p1.21.m21.1a"><mover accent="true" id="A2.SS3.p1.21.m21.1.1" xref="A2.SS3.p1.21.m21.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS3.p1.21.m21.1.1.2" xref="A2.SS3.p1.21.m21.1.1.2.cmml">𝒟</mi><mo id="A2.SS3.p1.21.m21.1.1.1" xref="A2.SS3.p1.21.m21.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.21.m21.1b"><apply id="A2.SS3.p1.21.m21.1.1.cmml" xref="A2.SS3.p1.21.m21.1.1"><ci id="A2.SS3.p1.21.m21.1.1.1.cmml" xref="A2.SS3.p1.21.m21.1.1.1">^</ci><ci id="A2.SS3.p1.21.m21.1.1.2.cmml" xref="A2.SS3.p1.21.m21.1.1.2">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.21.m21.1c">\hat{\mathcal{D}}</annotation></semantics></math> is compiled on the sequences <span id="A2.SS3.p1.23.1" class="ltx_text ltx_font_italic">generated</span> by GPT conditioned on the music and leader motion in test set, without using any ground-truth follower information.
During the entire training process, we employ the Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib19" title="" class="ltx_ref">2014</a>)</cite> with <math id="A2.SS3.p1.22.m22.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="A2.SS3.p1.22.m22.1a"><mrow id="A2.SS3.p1.22.m22.1.1" xref="A2.SS3.p1.22.m22.1.1.cmml"><msub id="A2.SS3.p1.22.m22.1.1.2" xref="A2.SS3.p1.22.m22.1.1.2.cmml"><mi id="A2.SS3.p1.22.m22.1.1.2.2" xref="A2.SS3.p1.22.m22.1.1.2.2.cmml">β</mi><mn id="A2.SS3.p1.22.m22.1.1.2.3" xref="A2.SS3.p1.22.m22.1.1.2.3.cmml">1</mn></msub><mo id="A2.SS3.p1.22.m22.1.1.1" xref="A2.SS3.p1.22.m22.1.1.1.cmml">=</mo><mn id="A2.SS3.p1.22.m22.1.1.3" xref="A2.SS3.p1.22.m22.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.22.m22.1b"><apply id="A2.SS3.p1.22.m22.1.1.cmml" xref="A2.SS3.p1.22.m22.1.1"><eq id="A2.SS3.p1.22.m22.1.1.1.cmml" xref="A2.SS3.p1.22.m22.1.1.1"></eq><apply id="A2.SS3.p1.22.m22.1.1.2.cmml" xref="A2.SS3.p1.22.m22.1.1.2"><csymbol cd="ambiguous" id="A2.SS3.p1.22.m22.1.1.2.1.cmml" xref="A2.SS3.p1.22.m22.1.1.2">subscript</csymbol><ci id="A2.SS3.p1.22.m22.1.1.2.2.cmml" xref="A2.SS3.p1.22.m22.1.1.2.2">𝛽</ci><cn type="integer" id="A2.SS3.p1.22.m22.1.1.2.3.cmml" xref="A2.SS3.p1.22.m22.1.1.2.3">1</cn></apply><cn type="float" id="A2.SS3.p1.22.m22.1.1.3.cmml" xref="A2.SS3.p1.22.m22.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.22.m22.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="A2.SS3.p1.23.m23.1" class="ltx_Math" alttext="\beta_{2}=0.99" display="inline"><semantics id="A2.SS3.p1.23.m23.1a"><mrow id="A2.SS3.p1.23.m23.1.1" xref="A2.SS3.p1.23.m23.1.1.cmml"><msub id="A2.SS3.p1.23.m23.1.1.2" xref="A2.SS3.p1.23.m23.1.1.2.cmml"><mi id="A2.SS3.p1.23.m23.1.1.2.2" xref="A2.SS3.p1.23.m23.1.1.2.2.cmml">β</mi><mn id="A2.SS3.p1.23.m23.1.1.2.3" xref="A2.SS3.p1.23.m23.1.1.2.3.cmml">2</mn></msub><mo id="A2.SS3.p1.23.m23.1.1.1" xref="A2.SS3.p1.23.m23.1.1.1.cmml">=</mo><mn id="A2.SS3.p1.23.m23.1.1.3" xref="A2.SS3.p1.23.m23.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.23.m23.1b"><apply id="A2.SS3.p1.23.m23.1.1.cmml" xref="A2.SS3.p1.23.m23.1.1"><eq id="A2.SS3.p1.23.m23.1.1.1.cmml" xref="A2.SS3.p1.23.m23.1.1.1"></eq><apply id="A2.SS3.p1.23.m23.1.1.2.cmml" xref="A2.SS3.p1.23.m23.1.1.2"><csymbol cd="ambiguous" id="A2.SS3.p1.23.m23.1.1.2.1.cmml" xref="A2.SS3.p1.23.m23.1.1.2">subscript</csymbol><ci id="A2.SS3.p1.23.m23.1.1.2.2.cmml" xref="A2.SS3.p1.23.m23.1.1.2.2">𝛽</ci><cn type="integer" id="A2.SS3.p1.23.m23.1.1.2.3.cmml" xref="A2.SS3.p1.23.m23.1.1.2.3">2</cn></apply><cn type="float" id="A2.SS3.p1.23.m23.1.1.3.cmml" xref="A2.SS3.p1.23.m23.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.23.m23.1c">\beta_{2}=0.99</annotation></semantics></math>. The training is conducted on four NVIDIA Tesla V100 GPUs, taking approximately seven days in total.</p>
</div>
<figure id="A2.T3" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="A2.T3.35.1" class="ltx_text ltx_font_bold">Architectures of VQ-VAE encoder and decoders. (Section 3.1</span>). “Conv” and “TransConv” represent 1D temporal the convolution and transpose-convolution operations, respectively, and their arguments represent the input channel number, the output channel number, the kernel size, the convolution stride, the padding size on both ends of input data, and the dilation number in turn. <span id="A2.T3.36.2" class="ltx_text ltx_font_bold">RB</span> denotes Residual Block. <math id="A2.T3.2.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A2.T3.2.m1.1b"><mi id="A2.T3.2.m1.1.1" xref="A2.T3.2.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A2.T3.2.m1.1c"><ci id="A2.T3.2.m1.1.1.cmml" xref="A2.T3.2.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.2.m1.1d">J</annotation></semantics></math> denotes the 3D joint number. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.T3.14" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="A2.T3.14.12" class="ltx_tabular ltx_align_middle">
<tr id="A2.T3.14.12.13" class="ltx_tr">
<td id="A2.T3.14.12.13.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_tt"></td>
<td id="A2.T3.14.12.13.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="A2.T3.14.12.13.2.1" class="ltx_text ltx_font_bold">Residual Block</span></td>
</tr>
<tr id="A2.T3.3.1.1" class="ltx_tr">
<td id="A2.T3.3.1.1.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="A2.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="A2.T3.3.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> <span id="A2.T3.3.1.1.1.2" class="ltx_text ltx_font_bold">0</span>; <span id="A2.T3.3.1.1.1.3" class="ltx_text ltx_font_bold">Argument:</span> <math id="A2.T3.3.1.1.1.m1.2" class="ltx_Math" alttext="p,d" display="inline"><semantics id="A2.T3.3.1.1.1.m1.2a"><mrow id="A2.T3.3.1.1.1.m1.2.3.2" xref="A2.T3.3.1.1.1.m1.2.3.1.cmml"><mi id="A2.T3.3.1.1.1.m1.1.1" xref="A2.T3.3.1.1.1.m1.1.1.cmml">p</mi><mo id="A2.T3.3.1.1.1.m1.2.3.2.1" xref="A2.T3.3.1.1.1.m1.2.3.1.cmml">,</mo><mi id="A2.T3.3.1.1.1.m1.2.2" xref="A2.T3.3.1.1.1.m1.2.2.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.3.1.1.1.m1.2b"><list id="A2.T3.3.1.1.1.m1.2.3.1.cmml" xref="A2.T3.3.1.1.1.m1.2.3.2"><ci id="A2.T3.3.1.1.1.m1.1.1.cmml" xref="A2.T3.3.1.1.1.m1.1.1">𝑝</ci><ci id="A2.T3.3.1.1.1.m1.2.2.cmml" xref="A2.T3.3.1.1.1.m1.2.2">𝑑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.3.1.1.1.m1.2c">p,d</annotation></semantics></math>
</td>
</tr>
<tr id="A2.T3.5.3.3" class="ltx_tr">
<td id="A2.T3.5.3.3.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.5.3.3.3.1" class="ltx_text ltx_font_bold">1</span></td>
<td id="A2.T3.5.3.3.2" class="ltx_td ltx_align_left ltx_border_r">ReLU, Conv(512, 512, 3, 1, <math id="A2.T3.4.2.2.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="A2.T3.4.2.2.1.m1.1a"><mi id="A2.T3.4.2.2.1.m1.1.1" xref="A2.T3.4.2.2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A2.T3.4.2.2.1.m1.1b"><ci id="A2.T3.4.2.2.1.m1.1.1.cmml" xref="A2.T3.4.2.2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.4.2.2.1.m1.1c">p</annotation></semantics></math>, <math id="A2.T3.5.3.3.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.T3.5.3.3.2.m2.1a"><mi id="A2.T3.5.3.3.2.m2.1.1" xref="A2.T3.5.3.3.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.T3.5.3.3.2.m2.1b"><ci id="A2.T3.5.3.3.2.m2.1.1.cmml" xref="A2.T3.5.3.3.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.5.3.3.2.m2.1c">d</annotation></semantics></math>)</td>
</tr>
<tr id="A2.T3.14.12.14" class="ltx_tr">
<td id="A2.T3.14.12.14.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.14.12.14.1.1" class="ltx_text ltx_font_bold">2</span></td>
<td id="A2.T3.14.12.14.2" class="ltx_td ltx_align_left ltx_border_r">ReLU, Conv(512, 512, 1, 1, 0, 1)</td>
</tr>
<tr id="A2.T3.14.12.15" class="ltx_tr">
<td id="A2.T3.14.12.15.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="A2.T3.14.12.15.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.14.12.15.2.1" class="ltx_text ltx_font_bold">Output:</span> <span id="A2.T3.14.12.15.2.2" class="ltx_text ltx_font_bold">0</span> + <span id="A2.T3.14.12.15.2.3" class="ltx_text ltx_font_bold">2</span>
</td>
</tr>
<tr id="A2.T3.6.4.4" class="ltx_tr">
<td id="A2.T3.6.4.4.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_tt"></td>
<td id="A2.T3.6.4.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">
<span id="A2.T3.6.4.4.1.1" class="ltx_text ltx_font_bold">Encoder</span> <math id="A2.T3.6.4.4.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A2.T3.6.4.4.1.m1.1a"><mi id="A2.T3.6.4.4.1.m1.1.1" xref="A2.T3.6.4.4.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A2.T3.6.4.4.1.m1.1b"><ci id="A2.T3.6.4.4.1.m1.1.1.cmml" xref="A2.T3.6.4.4.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.6.4.4.1.m1.1c">E</annotation></semantics></math>
</td>
</tr>
<tr id="A2.T3.7.5.5" class="ltx_tr">
<td id="A2.T3.7.5.5.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="A2.T3.7.5.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="A2.T3.7.5.5.1.2" class="ltx_text ltx_font_bold">Input: 0</span>, <span id="A2.T3.7.5.5.1.1" class="ltx_text ltx_font_bold">Argument: <math id="A2.T3.7.5.5.1.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A2.T3.7.5.5.1.1.m1.1a"><mi id="A2.T3.7.5.5.1.1.m1.1.1" xref="A2.T3.7.5.5.1.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A2.T3.7.5.5.1.1.m1.1b"><ci id="A2.T3.7.5.5.1.1.m1.1.1.cmml" xref="A2.T3.7.5.5.1.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.7.5.5.1.1.m1.1c">J</annotation></semantics></math></span>
</td>
</tr>
<tr id="A2.T3.8.6.6" class="ltx_tr">
<td id="A2.T3.8.6.6.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.8.6.6.2.1" class="ltx_text ltx_font_bold">1</span></td>
<td id="A2.T3.8.6.6.1" class="ltx_td ltx_align_left ltx_border_r">Conv(<math id="A2.T3.8.6.6.1.m1.1" class="ltx_Math" alttext="J\times 3" display="inline"><semantics id="A2.T3.8.6.6.1.m1.1a"><mrow id="A2.T3.8.6.6.1.m1.1.1" xref="A2.T3.8.6.6.1.m1.1.1.cmml"><mi id="A2.T3.8.6.6.1.m1.1.1.2" xref="A2.T3.8.6.6.1.m1.1.1.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="A2.T3.8.6.6.1.m1.1.1.1" xref="A2.T3.8.6.6.1.m1.1.1.1.cmml">×</mo><mn id="A2.T3.8.6.6.1.m1.1.1.3" xref="A2.T3.8.6.6.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.8.6.6.1.m1.1b"><apply id="A2.T3.8.6.6.1.m1.1.1.cmml" xref="A2.T3.8.6.6.1.m1.1.1"><times id="A2.T3.8.6.6.1.m1.1.1.1.cmml" xref="A2.T3.8.6.6.1.m1.1.1.1"></times><ci id="A2.T3.8.6.6.1.m1.1.1.2.cmml" xref="A2.T3.8.6.6.1.m1.1.1.2">𝐽</ci><cn type="integer" id="A2.T3.8.6.6.1.m1.1.1.3.cmml" xref="A2.T3.8.6.6.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.8.6.6.1.m1.1c">J\times 3</annotation></semantics></math>, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.10.8.8" class="ltx_tr">
<td id="A2.T3.10.8.8.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.10.8.8.3.1" class="ltx_text ltx_font_bold">2</span></td>
<td id="A2.T3.10.8.8.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.10.8.8.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.9.7.7.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.9.7.7.1.m1.1a"><mrow id="A2.T3.9.7.7.1.m1.1.1" xref="A2.T3.9.7.7.1.m1.1.1.cmml"><mi id="A2.T3.9.7.7.1.m1.1.1.2" xref="A2.T3.9.7.7.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.9.7.7.1.m1.1.1.1" xref="A2.T3.9.7.7.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.9.7.7.1.m1.1.1.3" xref="A2.T3.9.7.7.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.9.7.7.1.m1.1b"><apply id="A2.T3.9.7.7.1.m1.1.1.cmml" xref="A2.T3.9.7.7.1.m1.1.1"><eq id="A2.T3.9.7.7.1.m1.1.1.1.cmml" xref="A2.T3.9.7.7.1.m1.1.1.1"></eq><ci id="A2.T3.9.7.7.1.m1.1.1.2.cmml" xref="A2.T3.9.7.7.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.9.7.7.1.m1.1.1.3.cmml" xref="A2.T3.9.7.7.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.9.7.7.1.m1.1c">p=</annotation></semantics></math> 1, <math id="A2.T3.10.8.8.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.10.8.8.2.m2.1a"><mrow id="A2.T3.10.8.8.2.m2.1.1" xref="A2.T3.10.8.8.2.m2.1.1.cmml"><mi id="A2.T3.10.8.8.2.m2.1.1.2" xref="A2.T3.10.8.8.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.10.8.8.2.m2.1.1.1" xref="A2.T3.10.8.8.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.10.8.8.2.m2.1.1.3" xref="A2.T3.10.8.8.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.10.8.8.2.m2.1b"><apply id="A2.T3.10.8.8.2.m2.1.1.cmml" xref="A2.T3.10.8.8.2.m2.1.1"><eq id="A2.T3.10.8.8.2.m2.1.1.1.cmml" xref="A2.T3.10.8.8.2.m2.1.1.1"></eq><ci id="A2.T3.10.8.8.2.m2.1.1.2.cmml" xref="A2.T3.10.8.8.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.10.8.8.2.m2.1.1.3.cmml" xref="A2.T3.10.8.8.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.10.8.8.2.m2.1c">d=</annotation></semantics></math> 1)</td>
</tr>
<tr id="A2.T3.14.12.16" class="ltx_tr">
<td id="A2.T3.14.12.16.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.14.12.16.1.1" class="ltx_text ltx_font_bold">3</span></td>
<td id="A2.T3.14.12.16.2" class="ltx_td ltx_align_left ltx_border_r">Conv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.12.10.10" class="ltx_tr">
<td id="A2.T3.12.10.10.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.12.10.10.3.1" class="ltx_text ltx_font_bold">4</span></td>
<td id="A2.T3.12.10.10.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.12.10.10.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.11.9.9.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.11.9.9.1.m1.1a"><mrow id="A2.T3.11.9.9.1.m1.1.1" xref="A2.T3.11.9.9.1.m1.1.1.cmml"><mi id="A2.T3.11.9.9.1.m1.1.1.2" xref="A2.T3.11.9.9.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.11.9.9.1.m1.1.1.1" xref="A2.T3.11.9.9.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.11.9.9.1.m1.1.1.3" xref="A2.T3.11.9.9.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.11.9.9.1.m1.1b"><apply id="A2.T3.11.9.9.1.m1.1.1.cmml" xref="A2.T3.11.9.9.1.m1.1.1"><eq id="A2.T3.11.9.9.1.m1.1.1.1.cmml" xref="A2.T3.11.9.9.1.m1.1.1.1"></eq><ci id="A2.T3.11.9.9.1.m1.1.1.2.cmml" xref="A2.T3.11.9.9.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.11.9.9.1.m1.1.1.3.cmml" xref="A2.T3.11.9.9.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.11.9.9.1.m1.1c">p=</annotation></semantics></math> 3, <math id="A2.T3.12.10.10.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.12.10.10.2.m2.1a"><mrow id="A2.T3.12.10.10.2.m2.1.1" xref="A2.T3.12.10.10.2.m2.1.1.cmml"><mi id="A2.T3.12.10.10.2.m2.1.1.2" xref="A2.T3.12.10.10.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.12.10.10.2.m2.1.1.1" xref="A2.T3.12.10.10.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.12.10.10.2.m2.1.1.3" xref="A2.T3.12.10.10.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.12.10.10.2.m2.1b"><apply id="A2.T3.12.10.10.2.m2.1.1.cmml" xref="A2.T3.12.10.10.2.m2.1.1"><eq id="A2.T3.12.10.10.2.m2.1.1.1.cmml" xref="A2.T3.12.10.10.2.m2.1.1.1"></eq><ci id="A2.T3.12.10.10.2.m2.1.1.2.cmml" xref="A2.T3.12.10.10.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.12.10.10.2.m2.1.1.3.cmml" xref="A2.T3.12.10.10.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.12.10.10.2.m2.1c">d=</annotation></semantics></math> 3)</td>
</tr>
<tr id="A2.T3.14.12.17" class="ltx_tr">
<td id="A2.T3.14.12.17.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.14.12.17.1.1" class="ltx_text ltx_font_bold">5</span></td>
<td id="A2.T3.14.12.17.2" class="ltx_td ltx_align_left ltx_border_r">Conv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.14.12.12" class="ltx_tr">
<td id="A2.T3.14.12.12.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.14.12.12.3.1" class="ltx_text ltx_font_bold">6</span></td>
<td id="A2.T3.14.12.12.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.14.12.12.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.13.11.11.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.13.11.11.1.m1.1a"><mrow id="A2.T3.13.11.11.1.m1.1.1" xref="A2.T3.13.11.11.1.m1.1.1.cmml"><mi id="A2.T3.13.11.11.1.m1.1.1.2" xref="A2.T3.13.11.11.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.13.11.11.1.m1.1.1.1" xref="A2.T3.13.11.11.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.13.11.11.1.m1.1.1.3" xref="A2.T3.13.11.11.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.13.11.11.1.m1.1b"><apply id="A2.T3.13.11.11.1.m1.1.1.cmml" xref="A2.T3.13.11.11.1.m1.1.1"><eq id="A2.T3.13.11.11.1.m1.1.1.1.cmml" xref="A2.T3.13.11.11.1.m1.1.1.1"></eq><ci id="A2.T3.13.11.11.1.m1.1.1.2.cmml" xref="A2.T3.13.11.11.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.13.11.11.1.m1.1.1.3.cmml" xref="A2.T3.13.11.11.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.13.11.11.1.m1.1c">p=</annotation></semantics></math> 9, <math id="A2.T3.14.12.12.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.14.12.12.2.m2.1a"><mrow id="A2.T3.14.12.12.2.m2.1.1" xref="A2.T3.14.12.12.2.m2.1.1.cmml"><mi id="A2.T3.14.12.12.2.m2.1.1.2" xref="A2.T3.14.12.12.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.14.12.12.2.m2.1.1.1" xref="A2.T3.14.12.12.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.14.12.12.2.m2.1.1.3" xref="A2.T3.14.12.12.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.14.12.12.2.m2.1b"><apply id="A2.T3.14.12.12.2.m2.1.1.cmml" xref="A2.T3.14.12.12.2.m2.1.1"><eq id="A2.T3.14.12.12.2.m2.1.1.1.cmml" xref="A2.T3.14.12.12.2.m2.1.1.1"></eq><ci id="A2.T3.14.12.12.2.m2.1.1.2.cmml" xref="A2.T3.14.12.12.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.14.12.12.2.m2.1.1.3.cmml" xref="A2.T3.14.12.12.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.14.12.12.2.m2.1c">d=</annotation></semantics></math> 9)</td>
</tr>
<tr id="A2.T3.14.12.18" class="ltx_tr">
<td id="A2.T3.14.12.18.1" class="ltx_td ltx_border_bb ltx_border_l ltx_border_r"></td>
<td id="A2.T3.14.12.18.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="A2.T3.14.12.18.2.1" class="ltx_text ltx_font_bold">Output: 6</span></td>
</tr>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.T3.32" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="A2.T3.32.18" class="ltx_tabular ltx_align_middle">
<tr id="A2.T3.15.1.1" class="ltx_tr">
<td id="A2.T3.15.1.1.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_tt"></td>
<td id="A2.T3.15.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><math id="A2.T3.15.1.1.1.m1.1" class="ltx_Math" alttext="D_{P}" display="inline"><semantics id="A2.T3.15.1.1.1.m1.1a"><msub id="A2.T3.15.1.1.1.m1.1.1" xref="A2.T3.15.1.1.1.m1.1.1.cmml"><mi id="A2.T3.15.1.1.1.m1.1.1.2" xref="A2.T3.15.1.1.1.m1.1.1.2.cmml">D</mi><mi id="A2.T3.15.1.1.1.m1.1.1.3" xref="A2.T3.15.1.1.1.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T3.15.1.1.1.m1.1b"><apply id="A2.T3.15.1.1.1.m1.1.1.cmml" xref="A2.T3.15.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T3.15.1.1.1.m1.1.1.1.cmml" xref="A2.T3.15.1.1.1.m1.1.1">subscript</csymbol><ci id="A2.T3.15.1.1.1.m1.1.1.2.cmml" xref="A2.T3.15.1.1.1.m1.1.1.2">𝐷</ci><ci id="A2.T3.15.1.1.1.m1.1.1.3.cmml" xref="A2.T3.15.1.1.1.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.15.1.1.1.m1.1c">D_{P}</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.16.2.2" class="ltx_tr">
<td id="A2.T3.16.2.2.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="A2.T3.16.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="A2.T3.16.2.2.1.2" class="ltx_text ltx_font_bold">Input: 0</span>, <span id="A2.T3.16.2.2.1.1" class="ltx_text ltx_font_bold">Argument: <math id="A2.T3.16.2.2.1.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A2.T3.16.2.2.1.1.m1.1a"><mi id="A2.T3.16.2.2.1.1.m1.1.1" xref="A2.T3.16.2.2.1.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A2.T3.16.2.2.1.1.m1.1b"><ci id="A2.T3.16.2.2.1.1.m1.1.1.cmml" xref="A2.T3.16.2.2.1.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.16.2.2.1.1.m1.1c">J</annotation></semantics></math></span>
</td>
</tr>
<tr id="A2.T3.18.4.4" class="ltx_tr">
<td id="A2.T3.18.4.4.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.18.4.4.3.1" class="ltx_text ltx_font_bold">1</span></td>
<td id="A2.T3.18.4.4.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.18.4.4.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.17.3.3.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.17.3.3.1.m1.1a"><mrow id="A2.T3.17.3.3.1.m1.1.1" xref="A2.T3.17.3.3.1.m1.1.1.cmml"><mi id="A2.T3.17.3.3.1.m1.1.1.2" xref="A2.T3.17.3.3.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.17.3.3.1.m1.1.1.1" xref="A2.T3.17.3.3.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.17.3.3.1.m1.1.1.3" xref="A2.T3.17.3.3.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.17.3.3.1.m1.1b"><apply id="A2.T3.17.3.3.1.m1.1.1.cmml" xref="A2.T3.17.3.3.1.m1.1.1"><eq id="A2.T3.17.3.3.1.m1.1.1.1.cmml" xref="A2.T3.17.3.3.1.m1.1.1.1"></eq><ci id="A2.T3.17.3.3.1.m1.1.1.2.cmml" xref="A2.T3.17.3.3.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.17.3.3.1.m1.1.1.3.cmml" xref="A2.T3.17.3.3.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.17.3.3.1.m1.1c">p=</annotation></semantics></math> 9, <math id="A2.T3.18.4.4.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.18.4.4.2.m2.1a"><mrow id="A2.T3.18.4.4.2.m2.1.1" xref="A2.T3.18.4.4.2.m2.1.1.cmml"><mi id="A2.T3.18.4.4.2.m2.1.1.2" xref="A2.T3.18.4.4.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.18.4.4.2.m2.1.1.1" xref="A2.T3.18.4.4.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.18.4.4.2.m2.1.1.3" xref="A2.T3.18.4.4.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.18.4.4.2.m2.1b"><apply id="A2.T3.18.4.4.2.m2.1.1.cmml" xref="A2.T3.18.4.4.2.m2.1.1"><eq id="A2.T3.18.4.4.2.m2.1.1.1.cmml" xref="A2.T3.18.4.4.2.m2.1.1.1"></eq><ci id="A2.T3.18.4.4.2.m2.1.1.2.cmml" xref="A2.T3.18.4.4.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.18.4.4.2.m2.1.1.3.cmml" xref="A2.T3.18.4.4.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.18.4.4.2.m2.1c">d=</annotation></semantics></math> 9)</td>
</tr>
<tr id="A2.T3.32.18.19" class="ltx_tr">
<td id="A2.T3.32.18.19.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.19.1.1" class="ltx_text ltx_font_bold">2</span></td>
<td id="A2.T3.32.18.19.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.20.6.6" class="ltx_tr">
<td id="A2.T3.20.6.6.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.20.6.6.3.1" class="ltx_text ltx_font_bold">3</span></td>
<td id="A2.T3.20.6.6.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.20.6.6.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.19.5.5.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.19.5.5.1.m1.1a"><mrow id="A2.T3.19.5.5.1.m1.1.1" xref="A2.T3.19.5.5.1.m1.1.1.cmml"><mi id="A2.T3.19.5.5.1.m1.1.1.2" xref="A2.T3.19.5.5.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.19.5.5.1.m1.1.1.1" xref="A2.T3.19.5.5.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.19.5.5.1.m1.1.1.3" xref="A2.T3.19.5.5.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.19.5.5.1.m1.1b"><apply id="A2.T3.19.5.5.1.m1.1.1.cmml" xref="A2.T3.19.5.5.1.m1.1.1"><eq id="A2.T3.19.5.5.1.m1.1.1.1.cmml" xref="A2.T3.19.5.5.1.m1.1.1.1"></eq><ci id="A2.T3.19.5.5.1.m1.1.1.2.cmml" xref="A2.T3.19.5.5.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.19.5.5.1.m1.1.1.3.cmml" xref="A2.T3.19.5.5.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.19.5.5.1.m1.1c">p=</annotation></semantics></math> 3, <math id="A2.T3.20.6.6.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.20.6.6.2.m2.1a"><mrow id="A2.T3.20.6.6.2.m2.1.1" xref="A2.T3.20.6.6.2.m2.1.1.cmml"><mi id="A2.T3.20.6.6.2.m2.1.1.2" xref="A2.T3.20.6.6.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.20.6.6.2.m2.1.1.1" xref="A2.T3.20.6.6.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.20.6.6.2.m2.1.1.3" xref="A2.T3.20.6.6.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.20.6.6.2.m2.1b"><apply id="A2.T3.20.6.6.2.m2.1.1.cmml" xref="A2.T3.20.6.6.2.m2.1.1"><eq id="A2.T3.20.6.6.2.m2.1.1.1.cmml" xref="A2.T3.20.6.6.2.m2.1.1.1"></eq><ci id="A2.T3.20.6.6.2.m2.1.1.2.cmml" xref="A2.T3.20.6.6.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.20.6.6.2.m2.1.1.3.cmml" xref="A2.T3.20.6.6.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.20.6.6.2.m2.1c">d=</annotation></semantics></math> 3)</td>
</tr>
<tr id="A2.T3.32.18.20" class="ltx_tr">
<td id="A2.T3.32.18.20.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.20.1.1" class="ltx_text ltx_font_bold">4</span></td>
<td id="A2.T3.32.18.20.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.22.8.8" class="ltx_tr">
<td id="A2.T3.22.8.8.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.22.8.8.3.1" class="ltx_text ltx_font_bold">5</span></td>
<td id="A2.T3.22.8.8.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.22.8.8.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.21.7.7.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.21.7.7.1.m1.1a"><mrow id="A2.T3.21.7.7.1.m1.1.1" xref="A2.T3.21.7.7.1.m1.1.1.cmml"><mi id="A2.T3.21.7.7.1.m1.1.1.2" xref="A2.T3.21.7.7.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.21.7.7.1.m1.1.1.1" xref="A2.T3.21.7.7.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.21.7.7.1.m1.1.1.3" xref="A2.T3.21.7.7.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.21.7.7.1.m1.1b"><apply id="A2.T3.21.7.7.1.m1.1.1.cmml" xref="A2.T3.21.7.7.1.m1.1.1"><eq id="A2.T3.21.7.7.1.m1.1.1.1.cmml" xref="A2.T3.21.7.7.1.m1.1.1.1"></eq><ci id="A2.T3.21.7.7.1.m1.1.1.2.cmml" xref="A2.T3.21.7.7.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.21.7.7.1.m1.1.1.3.cmml" xref="A2.T3.21.7.7.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.21.7.7.1.m1.1c">p=</annotation></semantics></math> 3, <math id="A2.T3.22.8.8.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.22.8.8.2.m2.1a"><mrow id="A2.T3.22.8.8.2.m2.1.1" xref="A2.T3.22.8.8.2.m2.1.1.cmml"><mi id="A2.T3.22.8.8.2.m2.1.1.2" xref="A2.T3.22.8.8.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.22.8.8.2.m2.1.1.1" xref="A2.T3.22.8.8.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.22.8.8.2.m2.1.1.3" xref="A2.T3.22.8.8.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.22.8.8.2.m2.1b"><apply id="A2.T3.22.8.8.2.m2.1.1.cmml" xref="A2.T3.22.8.8.2.m2.1.1"><eq id="A2.T3.22.8.8.2.m2.1.1.1.cmml" xref="A2.T3.22.8.8.2.m2.1.1.1"></eq><ci id="A2.T3.22.8.8.2.m2.1.1.2.cmml" xref="A2.T3.22.8.8.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.22.8.8.2.m2.1.1.3.cmml" xref="A2.T3.22.8.8.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.22.8.8.2.m2.1c">d=</annotation></semantics></math> 3)</td>
</tr>
<tr id="A2.T3.32.18.21" class="ltx_tr">
<td id="A2.T3.32.18.21.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.21.1.1" class="ltx_text ltx_font_bold">6</span></td>
<td id="A2.T3.32.18.21.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.23.9.9" class="ltx_tr">
<td id="A2.T3.23.9.9.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.23.9.9.2.1" class="ltx_text ltx_font_bold">7</span></td>
<td id="A2.T3.23.9.9.1" class="ltx_td ltx_align_left ltx_border_r">Conv(512, <math id="A2.T3.23.9.9.1.m1.1" class="ltx_Math" alttext="J\times 3" display="inline"><semantics id="A2.T3.23.9.9.1.m1.1a"><mrow id="A2.T3.23.9.9.1.m1.1.1" xref="A2.T3.23.9.9.1.m1.1.1.cmml"><mi id="A2.T3.23.9.9.1.m1.1.1.2" xref="A2.T3.23.9.9.1.m1.1.1.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="A2.T3.23.9.9.1.m1.1.1.1" xref="A2.T3.23.9.9.1.m1.1.1.1.cmml">×</mo><mn id="A2.T3.23.9.9.1.m1.1.1.3" xref="A2.T3.23.9.9.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.23.9.9.1.m1.1b"><apply id="A2.T3.23.9.9.1.m1.1.1.cmml" xref="A2.T3.23.9.9.1.m1.1.1"><times id="A2.T3.23.9.9.1.m1.1.1.1.cmml" xref="A2.T3.23.9.9.1.m1.1.1.1"></times><ci id="A2.T3.23.9.9.1.m1.1.1.2.cmml" xref="A2.T3.23.9.9.1.m1.1.1.2">𝐽</ci><cn type="integer" id="A2.T3.23.9.9.1.m1.1.1.3.cmml" xref="A2.T3.23.9.9.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.23.9.9.1.m1.1c">J\times 3</annotation></semantics></math>, 3, 1, 1, 1)</td>
</tr>
<tr id="A2.T3.32.18.22" class="ltx_tr">
<td id="A2.T3.32.18.22.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="A2.T3.32.18.22.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A2.T3.32.18.22.2.1" class="ltx_text ltx_font_bold">Output: 7</span></td>
</tr>
<tr id="A2.T3.24.10.10" class="ltx_tr">
<td id="A2.T3.24.10.10.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_tt"></td>
<td id="A2.T3.24.10.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><math id="A2.T3.24.10.10.1.m1.1" class="ltx_Math" alttext="D_{M}" display="inline"><semantics id="A2.T3.24.10.10.1.m1.1a"><msub id="A2.T3.24.10.10.1.m1.1.1" xref="A2.T3.24.10.10.1.m1.1.1.cmml"><mi id="A2.T3.24.10.10.1.m1.1.1.2" xref="A2.T3.24.10.10.1.m1.1.1.2.cmml">D</mi><mi id="A2.T3.24.10.10.1.m1.1.1.3" xref="A2.T3.24.10.10.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T3.24.10.10.1.m1.1b"><apply id="A2.T3.24.10.10.1.m1.1.1.cmml" xref="A2.T3.24.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T3.24.10.10.1.m1.1.1.1.cmml" xref="A2.T3.24.10.10.1.m1.1.1">subscript</csymbol><ci id="A2.T3.24.10.10.1.m1.1.1.2.cmml" xref="A2.T3.24.10.10.1.m1.1.1.2">𝐷</ci><ci id="A2.T3.24.10.10.1.m1.1.1.3.cmml" xref="A2.T3.24.10.10.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.24.10.10.1.m1.1c">D_{M}</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.25.11.11" class="ltx_tr">
<td id="A2.T3.25.11.11.2" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="A2.T3.25.11.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="A2.T3.25.11.11.1.2" class="ltx_text ltx_font_bold">Input: 0</span>, <span id="A2.T3.25.11.11.1.1" class="ltx_text ltx_font_bold">Argument: <math id="A2.T3.25.11.11.1.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A2.T3.25.11.11.1.1.m1.1a"><mi id="A2.T3.25.11.11.1.1.m1.1.1" xref="A2.T3.25.11.11.1.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A2.T3.25.11.11.1.1.m1.1b"><ci id="A2.T3.25.11.11.1.1.m1.1.1.cmml" xref="A2.T3.25.11.11.1.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.25.11.11.1.1.m1.1c">J</annotation></semantics></math></span>
</td>
</tr>
<tr id="A2.T3.27.13.13" class="ltx_tr">
<td id="A2.T3.27.13.13.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.27.13.13.3.1" class="ltx_text ltx_font_bold">1</span></td>
<td id="A2.T3.27.13.13.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.27.13.13.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.26.12.12.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.26.12.12.1.m1.1a"><mrow id="A2.T3.26.12.12.1.m1.1.1" xref="A2.T3.26.12.12.1.m1.1.1.cmml"><mi id="A2.T3.26.12.12.1.m1.1.1.2" xref="A2.T3.26.12.12.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.26.12.12.1.m1.1.1.1" xref="A2.T3.26.12.12.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.26.12.12.1.m1.1.1.3" xref="A2.T3.26.12.12.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.26.12.12.1.m1.1b"><apply id="A2.T3.26.12.12.1.m1.1.1.cmml" xref="A2.T3.26.12.12.1.m1.1.1"><eq id="A2.T3.26.12.12.1.m1.1.1.1.cmml" xref="A2.T3.26.12.12.1.m1.1.1.1"></eq><ci id="A2.T3.26.12.12.1.m1.1.1.2.cmml" xref="A2.T3.26.12.12.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.26.12.12.1.m1.1.1.3.cmml" xref="A2.T3.26.12.12.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.26.12.12.1.m1.1c">p=</annotation></semantics></math> 9, <math id="A2.T3.27.13.13.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.27.13.13.2.m2.1a"><mrow id="A2.T3.27.13.13.2.m2.1.1" xref="A2.T3.27.13.13.2.m2.1.1.cmml"><mi id="A2.T3.27.13.13.2.m2.1.1.2" xref="A2.T3.27.13.13.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.27.13.13.2.m2.1.1.1" xref="A2.T3.27.13.13.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.27.13.13.2.m2.1.1.3" xref="A2.T3.27.13.13.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.27.13.13.2.m2.1b"><apply id="A2.T3.27.13.13.2.m2.1.1.cmml" xref="A2.T3.27.13.13.2.m2.1.1"><eq id="A2.T3.27.13.13.2.m2.1.1.1.cmml" xref="A2.T3.27.13.13.2.m2.1.1.1"></eq><ci id="A2.T3.27.13.13.2.m2.1.1.2.cmml" xref="A2.T3.27.13.13.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.27.13.13.2.m2.1.1.3.cmml" xref="A2.T3.27.13.13.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.27.13.13.2.m2.1c">d=</annotation></semantics></math> 9)</td>
</tr>
<tr id="A2.T3.32.18.23" class="ltx_tr">
<td id="A2.T3.32.18.23.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.23.1.1" class="ltx_text ltx_font_bold">2</span></td>
<td id="A2.T3.32.18.23.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.29.15.15" class="ltx_tr">
<td id="A2.T3.29.15.15.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.29.15.15.3.1" class="ltx_text ltx_font_bold">3</span></td>
<td id="A2.T3.29.15.15.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.29.15.15.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.28.14.14.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.28.14.14.1.m1.1a"><mrow id="A2.T3.28.14.14.1.m1.1.1" xref="A2.T3.28.14.14.1.m1.1.1.cmml"><mi id="A2.T3.28.14.14.1.m1.1.1.2" xref="A2.T3.28.14.14.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.28.14.14.1.m1.1.1.1" xref="A2.T3.28.14.14.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.28.14.14.1.m1.1.1.3" xref="A2.T3.28.14.14.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.28.14.14.1.m1.1b"><apply id="A2.T3.28.14.14.1.m1.1.1.cmml" xref="A2.T3.28.14.14.1.m1.1.1"><eq id="A2.T3.28.14.14.1.m1.1.1.1.cmml" xref="A2.T3.28.14.14.1.m1.1.1.1"></eq><ci id="A2.T3.28.14.14.1.m1.1.1.2.cmml" xref="A2.T3.28.14.14.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.28.14.14.1.m1.1.1.3.cmml" xref="A2.T3.28.14.14.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.28.14.14.1.m1.1c">p=</annotation></semantics></math> 3, <math id="A2.T3.29.15.15.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.29.15.15.2.m2.1a"><mrow id="A2.T3.29.15.15.2.m2.1.1" xref="A2.T3.29.15.15.2.m2.1.1.cmml"><mi id="A2.T3.29.15.15.2.m2.1.1.2" xref="A2.T3.29.15.15.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.29.15.15.2.m2.1.1.1" xref="A2.T3.29.15.15.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.29.15.15.2.m2.1.1.3" xref="A2.T3.29.15.15.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.29.15.15.2.m2.1b"><apply id="A2.T3.29.15.15.2.m2.1.1.cmml" xref="A2.T3.29.15.15.2.m2.1.1"><eq id="A2.T3.29.15.15.2.m2.1.1.1.cmml" xref="A2.T3.29.15.15.2.m2.1.1.1"></eq><ci id="A2.T3.29.15.15.2.m2.1.1.2.cmml" xref="A2.T3.29.15.15.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.29.15.15.2.m2.1.1.3.cmml" xref="A2.T3.29.15.15.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.29.15.15.2.m2.1c">d=</annotation></semantics></math> 3)</td>
</tr>
<tr id="A2.T3.32.18.24" class="ltx_tr">
<td id="A2.T3.32.18.24.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.24.1.1" class="ltx_text ltx_font_bold">4</span></td>
<td id="A2.T3.32.18.24.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.31.17.17" class="ltx_tr">
<td id="A2.T3.31.17.17.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.31.17.17.3.1" class="ltx_text ltx_font_bold">5</span></td>
<td id="A2.T3.31.17.17.2" class="ltx_td ltx_align_left ltx_border_r">
<span id="A2.T3.31.17.17.2.1" class="ltx_text ltx_font_bold">RB</span>(<math id="A2.T3.30.16.16.1.m1.1" class="ltx_Math" alttext="p=" display="inline"><semantics id="A2.T3.30.16.16.1.m1.1a"><mrow id="A2.T3.30.16.16.1.m1.1.1" xref="A2.T3.30.16.16.1.m1.1.1.cmml"><mi id="A2.T3.30.16.16.1.m1.1.1.2" xref="A2.T3.30.16.16.1.m1.1.1.2.cmml">p</mi><mo id="A2.T3.30.16.16.1.m1.1.1.1" xref="A2.T3.30.16.16.1.m1.1.1.1.cmml">=</mo><mi id="A2.T3.30.16.16.1.m1.1.1.3" xref="A2.T3.30.16.16.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.30.16.16.1.m1.1b"><apply id="A2.T3.30.16.16.1.m1.1.1.cmml" xref="A2.T3.30.16.16.1.m1.1.1"><eq id="A2.T3.30.16.16.1.m1.1.1.1.cmml" xref="A2.T3.30.16.16.1.m1.1.1.1"></eq><ci id="A2.T3.30.16.16.1.m1.1.1.2.cmml" xref="A2.T3.30.16.16.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="A2.T3.30.16.16.1.m1.1.1.3.cmml" xref="A2.T3.30.16.16.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.30.16.16.1.m1.1c">p=</annotation></semantics></math> 3, <math id="A2.T3.31.17.17.2.m2.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="A2.T3.31.17.17.2.m2.1a"><mrow id="A2.T3.31.17.17.2.m2.1.1" xref="A2.T3.31.17.17.2.m2.1.1.cmml"><mi id="A2.T3.31.17.17.2.m2.1.1.2" xref="A2.T3.31.17.17.2.m2.1.1.2.cmml">d</mi><mo id="A2.T3.31.17.17.2.m2.1.1.1" xref="A2.T3.31.17.17.2.m2.1.1.1.cmml">=</mo><mi id="A2.T3.31.17.17.2.m2.1.1.3" xref="A2.T3.31.17.17.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.31.17.17.2.m2.1b"><apply id="A2.T3.31.17.17.2.m2.1.1.cmml" xref="A2.T3.31.17.17.2.m2.1.1"><eq id="A2.T3.31.17.17.2.m2.1.1.1.cmml" xref="A2.T3.31.17.17.2.m2.1.1.1"></eq><ci id="A2.T3.31.17.17.2.m2.1.1.2.cmml" xref="A2.T3.31.17.17.2.m2.1.1.2">𝑑</ci><csymbol cd="latexml" id="A2.T3.31.17.17.2.m2.1.1.3.cmml" xref="A2.T3.31.17.17.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.31.17.17.2.m2.1c">d=</annotation></semantics></math> 3)</td>
</tr>
<tr id="A2.T3.32.18.25" class="ltx_tr">
<td id="A2.T3.32.18.25.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.25.1.1" class="ltx_text ltx_font_bold">6</span></td>
<td id="A2.T3.32.18.25.2" class="ltx_td ltx_align_left ltx_border_r">TransConv(512, 512, 4, 2, 1, 1)</td>
</tr>
<tr id="A2.T3.32.18.18" class="ltx_tr">
<td id="A2.T3.32.18.18.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A2.T3.32.18.18.2.1" class="ltx_text ltx_font_bold">7</span></td>
<td id="A2.T3.32.18.18.1" class="ltx_td ltx_align_left ltx_border_r">Conv(512, <math id="A2.T3.32.18.18.1.m1.1" class="ltx_Math" alttext="J\times 9" display="inline"><semantics id="A2.T3.32.18.18.1.m1.1a"><mrow id="A2.T3.32.18.18.1.m1.1.1" xref="A2.T3.32.18.18.1.m1.1.1.cmml"><mi id="A2.T3.32.18.18.1.m1.1.1.2" xref="A2.T3.32.18.18.1.m1.1.1.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="A2.T3.32.18.18.1.m1.1.1.1" xref="A2.T3.32.18.18.1.m1.1.1.1.cmml">×</mo><mn id="A2.T3.32.18.18.1.m1.1.1.3" xref="A2.T3.32.18.18.1.m1.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.32.18.18.1.m1.1b"><apply id="A2.T3.32.18.18.1.m1.1.1.cmml" xref="A2.T3.32.18.18.1.m1.1.1"><times id="A2.T3.32.18.18.1.m1.1.1.1.cmml" xref="A2.T3.32.18.18.1.m1.1.1.1"></times><ci id="A2.T3.32.18.18.1.m1.1.1.2.cmml" xref="A2.T3.32.18.18.1.m1.1.1.2">𝐽</ci><cn type="integer" id="A2.T3.32.18.18.1.m1.1.1.3.cmml" xref="A2.T3.32.18.18.1.m1.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.32.18.18.1.m1.1c">J\times 9</annotation></semantics></math>, 3, 1, 1, 1)</td>
</tr>
<tr id="A2.T3.32.18.26" class="ltx_tr">
<td id="A2.T3.32.18.26.1" class="ltx_td ltx_border_bb ltx_border_l ltx_border_r"></td>
<td id="A2.T3.32.18.26.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="A2.T3.32.18.26.2.1" class="ltx_text ltx_font_bold">Output: 7</span></td>
</tr>
</table>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Reinforcement Learning Details</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Derivation to On-Policy Actor-Critic Loss</h3>

<div id="A3.SS1.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.p1.1" class="ltx_p">Here we derive the on-policy actor-critic loss <math id="A3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{AC}" display="inline"><semantics id="A3.SS1.p1.1.m1.1a"><msub id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS1.p1.1.m1.1.1.2" xref="A3.SS1.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="A3.SS1.p1.1.m1.1.1.3" xref="A3.SS1.p1.1.m1.1.1.3.cmml"><mi id="A3.SS1.p1.1.m1.1.1.3.2" xref="A3.SS1.p1.1.m1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p1.1.m1.1.1.3.1" xref="A3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.SS1.p1.1.m1.1.1.3.3" xref="A3.SS1.p1.1.m1.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b"><apply id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A3.SS1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.p1.1.m1.1.1.2">ℒ</ci><apply id="A3.SS1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3"><times id="A3.SS1.p1.1.m1.1.1.3.1.cmml" xref="A3.SS1.p1.1.m1.1.1.3.1"></times><ci id="A3.SS1.p1.1.m1.1.1.3.2.cmml" xref="A3.SS1.p1.1.m1.1.1.3.2">𝐴</ci><ci id="A3.SS1.p1.1.m1.1.1.3.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">\mathcal{L}_{AC}</annotation></semantics></math> from the initial reinforcement learning objective. The derivation is mainly based on the instruction of <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib22" title="" class="ltx_ref">Levine </a></cite>.</p>
</div>
<div id="A3.SS1.p2" class="ltx_para ltx_noindent">
<p id="A3.SS1.p2.3" class="ltx_p">From an RL standpoint, GPT predicting the next token at step <math id="A3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A3.SS1.p2.1.m1.1a"><mi id="A3.SS1.p2.1.m1.1.1" xref="A3.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.1b"><ci id="A3.SS1.p2.1.m1.1.1.cmml" xref="A3.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.1c">t</annotation></semantics></math> is construed as an <span id="A3.SS1.p2.3.1" class="ltx_text ltx_font_italic">action</span> <math id="A3.SS1.p2.2.m2.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="A3.SS1.p2.2.m2.1a"><msub id="A3.SS1.p2.2.m2.1.1" xref="A3.SS1.p2.2.m2.1.1.cmml"><mi id="A3.SS1.p2.2.m2.1.1.2" xref="A3.SS1.p2.2.m2.1.1.2.cmml">a</mi><mi id="A3.SS1.p2.2.m2.1.1.3" xref="A3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.1b"><apply id="A3.SS1.p2.2.m2.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.2.m2.1.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A3.SS1.p2.2.m2.1.1.2.cmml" xref="A3.SS1.p2.2.m2.1.1.2">𝑎</ci><ci id="A3.SS1.p2.2.m2.1.1.3.cmml" xref="A3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.1c">a_{t}</annotation></semantics></math>, which involves selecting an appropriate token <math id="A3.SS1.p2.3.m3.1" class="ltx_Math" alttext="z_{t+1}" display="inline"><semantics id="A3.SS1.p2.3.m3.1a"><msub id="A3.SS1.p2.3.m3.1.1" xref="A3.SS1.p2.3.m3.1.1.cmml"><mi id="A3.SS1.p2.3.m3.1.1.2" xref="A3.SS1.p2.3.m3.1.1.2.cmml">z</mi><mrow id="A3.SS1.p2.3.m3.1.1.3" xref="A3.SS1.p2.3.m3.1.1.3.cmml"><mi id="A3.SS1.p2.3.m3.1.1.3.2" xref="A3.SS1.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="A3.SS1.p2.3.m3.1.1.3.1" xref="A3.SS1.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="A3.SS1.p2.3.m3.1.1.3.3" xref="A3.SS1.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><apply id="A3.SS1.p2.3.m3.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A3.SS1.p2.3.m3.1.1.2.cmml" xref="A3.SS1.p2.3.m3.1.1.2">𝑧</ci><apply id="A3.SS1.p2.3.m3.1.1.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3"><plus id="A3.SS1.p2.3.m3.1.1.3.1.cmml" xref="A3.SS1.p2.3.m3.1.1.3.1"></plus><ci id="A3.SS1.p2.3.m3.1.1.3.2.cmml" xref="A3.SS1.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p2.3.m3.1.1.3.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">z_{t+1}</annotation></semantics></math> from the dictionary.
As such, the cross-entropy loss in the supervised stage can be reformulated as</p>
<table id="A3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E8.m1.3" class="ltx_Math" alttext="\mathcal{L}_{ST}(\theta)=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(a_{t}|s_{t})\right)." display="block"><semantics id="A3.E8.m1.3a"><mrow id="A3.E8.m1.3.3.1" xref="A3.E8.m1.3.3.1.1.cmml"><mrow id="A3.E8.m1.3.3.1.1" xref="A3.E8.m1.3.3.1.1.cmml"><mrow id="A3.E8.m1.3.3.1.1.3" xref="A3.E8.m1.3.3.1.1.3.cmml"><msub id="A3.E8.m1.3.3.1.1.3.2" xref="A3.E8.m1.3.3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E8.m1.3.3.1.1.3.2.2" xref="A3.E8.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mrow id="A3.E8.m1.3.3.1.1.3.2.3" xref="A3.E8.m1.3.3.1.1.3.2.3.cmml"><mi id="A3.E8.m1.3.3.1.1.3.2.3.2" xref="A3.E8.m1.3.3.1.1.3.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="A3.E8.m1.3.3.1.1.3.2.3.1" xref="A3.E8.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="A3.E8.m1.3.3.1.1.3.2.3.3" xref="A3.E8.m1.3.3.1.1.3.2.3.3.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E8.m1.3.3.1.1.3.1" xref="A3.E8.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="A3.E8.m1.3.3.1.1.3.3.2" xref="A3.E8.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="A3.E8.m1.3.3.1.1.3.3.2.1" xref="A3.E8.m1.3.3.1.1.3.cmml">(</mo><mi id="A3.E8.m1.1.1" xref="A3.E8.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A3.E8.m1.3.3.1.1.3.3.2.2" xref="A3.E8.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A3.E8.m1.3.3.1.1.2" xref="A3.E8.m1.3.3.1.1.2.cmml">=</mo><mrow id="A3.E8.m1.3.3.1.1.1" xref="A3.E8.m1.3.3.1.1.1.cmml"><munderover id="A3.E8.m1.3.3.1.1.1.3" xref="A3.E8.m1.3.3.1.1.1.3.cmml"><mo movablelimits="false" rspace="0em" id="A3.E8.m1.3.3.1.1.1.3.2.2" xref="A3.E8.m1.3.3.1.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E8.m1.3.3.1.1.1.3.2.3" xref="A3.E8.m1.3.3.1.1.1.3.2.3.cmml"><mi id="A3.E8.m1.3.3.1.1.1.3.2.3.2" xref="A3.E8.m1.3.3.1.1.1.3.2.3.2.cmml">t</mi><mo id="A3.E8.m1.3.3.1.1.1.3.2.3.1" xref="A3.E8.m1.3.3.1.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E8.m1.3.3.1.1.1.3.2.3.3" xref="A3.E8.m1.3.3.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E8.m1.3.3.1.1.1.3.3" xref="A3.E8.m1.3.3.1.1.1.3.3.cmml"><mi id="A3.E8.m1.3.3.1.1.1.3.3.2" xref="A3.E8.m1.3.3.1.1.1.3.3.2.cmml">T</mi><mo id="A3.E8.m1.3.3.1.1.1.3.3.1" xref="A3.E8.m1.3.3.1.1.1.3.3.1.cmml">−</mo><mn id="A3.E8.m1.3.3.1.1.1.3.3.3" xref="A3.E8.m1.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></munderover><mo lspace="0em" id="A3.E8.m1.3.3.1.1.1.2" xref="A3.E8.m1.3.3.1.1.1.2.cmml">−</mo><mrow id="A3.E8.m1.3.3.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.2.cmml"><mi id="A3.E8.m1.2.2" xref="A3.E8.m1.2.2.cmml">log</mi><mo id="A3.E8.m1.3.3.1.1.1.1.1a" xref="A3.E8.m1.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="A3.E8.m1.3.3.1.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.2.cmml"><mo id="A3.E8.m1.3.3.1.1.1.1.1.1.2" xref="A3.E8.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="A3.E8.m1.3.3.1.1.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E8.m1.3.3.1.1.1.1.1.1.3" xref="A3.E8.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A3.E8.m1.3.3.1.2" xref="A3.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E8.m1.3b"><apply id="A3.E8.m1.3.3.1.1.cmml" xref="A3.E8.m1.3.3.1"><eq id="A3.E8.m1.3.3.1.1.2.cmml" xref="A3.E8.m1.3.3.1.1.2"></eq><apply id="A3.E8.m1.3.3.1.1.3.cmml" xref="A3.E8.m1.3.3.1.1.3"><times id="A3.E8.m1.3.3.1.1.3.1.cmml" xref="A3.E8.m1.3.3.1.1.3.1"></times><apply id="A3.E8.m1.3.3.1.1.3.2.cmml" xref="A3.E8.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.3.2.1.cmml" xref="A3.E8.m1.3.3.1.1.3.2">subscript</csymbol><ci id="A3.E8.m1.3.3.1.1.3.2.2.cmml" xref="A3.E8.m1.3.3.1.1.3.2.2">ℒ</ci><apply id="A3.E8.m1.3.3.1.1.3.2.3.cmml" xref="A3.E8.m1.3.3.1.1.3.2.3"><times id="A3.E8.m1.3.3.1.1.3.2.3.1.cmml" xref="A3.E8.m1.3.3.1.1.3.2.3.1"></times><ci id="A3.E8.m1.3.3.1.1.3.2.3.2.cmml" xref="A3.E8.m1.3.3.1.1.3.2.3.2">𝑆</ci><ci id="A3.E8.m1.3.3.1.1.3.2.3.3.cmml" xref="A3.E8.m1.3.3.1.1.3.2.3.3">𝑇</ci></apply></apply><ci id="A3.E8.m1.1.1.cmml" xref="A3.E8.m1.1.1">𝜃</ci></apply><apply id="A3.E8.m1.3.3.1.1.1.cmml" xref="A3.E8.m1.3.3.1.1.1"><minus id="A3.E8.m1.3.3.1.1.1.2.cmml" xref="A3.E8.m1.3.3.1.1.1.2"></minus><apply id="A3.E8.m1.3.3.1.1.1.3.cmml" xref="A3.E8.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.1.3.1.cmml" xref="A3.E8.m1.3.3.1.1.1.3">superscript</csymbol><apply id="A3.E8.m1.3.3.1.1.1.3.2.cmml" xref="A3.E8.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.1.3.2.1.cmml" xref="A3.E8.m1.3.3.1.1.1.3">subscript</csymbol><sum id="A3.E8.m1.3.3.1.1.1.3.2.2.cmml" xref="A3.E8.m1.3.3.1.1.1.3.2.2"></sum><apply id="A3.E8.m1.3.3.1.1.1.3.2.3.cmml" xref="A3.E8.m1.3.3.1.1.1.3.2.3"><eq id="A3.E8.m1.3.3.1.1.1.3.2.3.1.cmml" xref="A3.E8.m1.3.3.1.1.1.3.2.3.1"></eq><ci id="A3.E8.m1.3.3.1.1.1.3.2.3.2.cmml" xref="A3.E8.m1.3.3.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A3.E8.m1.3.3.1.1.1.3.2.3.3.cmml" xref="A3.E8.m1.3.3.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E8.m1.3.3.1.1.1.3.3.cmml" xref="A3.E8.m1.3.3.1.1.1.3.3"><minus id="A3.E8.m1.3.3.1.1.1.3.3.1.cmml" xref="A3.E8.m1.3.3.1.1.1.3.3.1"></minus><ci id="A3.E8.m1.3.3.1.1.1.3.3.2.cmml" xref="A3.E8.m1.3.3.1.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E8.m1.3.3.1.1.1.3.3.3.cmml" xref="A3.E8.m1.3.3.1.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E8.m1.3.3.1.1.1.1.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1"><log id="A3.E8.m1.2.2.cmml" xref="A3.E8.m1.2.2"></log><apply id="A3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1"><times id="A3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E8.m1.3c">\mathcal{L}_{ST}(\theta)=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(a_{t}|s_{t})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="A3.SS1.p3" class="ltx_para ltx_noindent">
<p id="A3.SS1.p3.2" class="ltx_p">For RL, the object <math id="A3.SS1.p3.1.m1.1" class="ltx_Math" alttext="J(\theta)" display="inline"><semantics id="A3.SS1.p3.1.m1.1a"><mrow id="A3.SS1.p3.1.m1.1.2" xref="A3.SS1.p3.1.m1.1.2.cmml"><mi id="A3.SS1.p3.1.m1.1.2.2" xref="A3.SS1.p3.1.m1.1.2.2.cmml">J</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.1.m1.1.2.1" xref="A3.SS1.p3.1.m1.1.2.1.cmml">​</mo><mrow id="A3.SS1.p3.1.m1.1.2.3.2" xref="A3.SS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="A3.SS1.p3.1.m1.1.2.3.2.1" xref="A3.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="A3.SS1.p3.1.m1.1.1" xref="A3.SS1.p3.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A3.SS1.p3.1.m1.1.2.3.2.2" xref="A3.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.1.m1.1b"><apply id="A3.SS1.p3.1.m1.1.2.cmml" xref="A3.SS1.p3.1.m1.1.2"><times id="A3.SS1.p3.1.m1.1.2.1.cmml" xref="A3.SS1.p3.1.m1.1.2.1"></times><ci id="A3.SS1.p3.1.m1.1.2.2.cmml" xref="A3.SS1.p3.1.m1.1.2.2">𝐽</ci><ci id="A3.SS1.p3.1.m1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.1.m1.1c">J(\theta)</annotation></semantics></math> is to maximize the total income <math id="A3.SS1.p3.2.m2.3" class="ltx_Math" alttext="\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}[r(\tau)]" display="inline"><semantics id="A3.SS1.p3.2.m2.3a"><mrow id="A3.SS1.p3.2.m2.3.3" xref="A3.SS1.p3.2.m2.3.3.cmml"><msub id="A3.SS1.p3.2.m2.3.3.3" xref="A3.SS1.p3.2.m2.3.3.3.cmml"><mi id="A3.SS1.p3.2.m2.3.3.3.2" xref="A3.SS1.p3.2.m2.3.3.3.2.cmml">𝔼</mi><mrow id="A3.SS1.p3.2.m2.1.1.1" xref="A3.SS1.p3.2.m2.1.1.1.cmml"><mi id="A3.SS1.p3.2.m2.1.1.1.3" xref="A3.SS1.p3.2.m2.1.1.1.3.cmml">τ</mi><mo id="A3.SS1.p3.2.m2.1.1.1.2" xref="A3.SS1.p3.2.m2.1.1.1.2.cmml">∼</mo><mrow id="A3.SS1.p3.2.m2.1.1.1.4" xref="A3.SS1.p3.2.m2.1.1.1.4.cmml"><msub id="A3.SS1.p3.2.m2.1.1.1.4.2" xref="A3.SS1.p3.2.m2.1.1.1.4.2.cmml"><mi id="A3.SS1.p3.2.m2.1.1.1.4.2.2" xref="A3.SS1.p3.2.m2.1.1.1.4.2.2.cmml">π</mi><mi id="A3.SS1.p3.2.m2.1.1.1.4.2.3" xref="A3.SS1.p3.2.m2.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.1.1.4.1" xref="A3.SS1.p3.2.m2.1.1.1.4.1.cmml">​</mo><mrow id="A3.SS1.p3.2.m2.1.1.1.4.3.2" xref="A3.SS1.p3.2.m2.1.1.1.4.cmml"><mo stretchy="false" id="A3.SS1.p3.2.m2.1.1.1.4.3.2.1" xref="A3.SS1.p3.2.m2.1.1.1.4.cmml">(</mo><mi id="A3.SS1.p3.2.m2.1.1.1.1" xref="A3.SS1.p3.2.m2.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.SS1.p3.2.m2.1.1.1.4.3.2.2" xref="A3.SS1.p3.2.m2.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.3.3.2" xref="A3.SS1.p3.2.m2.3.3.2.cmml">​</mo><mrow id="A3.SS1.p3.2.m2.3.3.1.1" xref="A3.SS1.p3.2.m2.3.3.1.2.cmml"><mo stretchy="false" id="A3.SS1.p3.2.m2.3.3.1.1.2" xref="A3.SS1.p3.2.m2.3.3.1.2.1.cmml">[</mo><mrow id="A3.SS1.p3.2.m2.3.3.1.1.1" xref="A3.SS1.p3.2.m2.3.3.1.1.1.cmml"><mi id="A3.SS1.p3.2.m2.3.3.1.1.1.2" xref="A3.SS1.p3.2.m2.3.3.1.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.3.3.1.1.1.1" xref="A3.SS1.p3.2.m2.3.3.1.1.1.1.cmml">​</mo><mrow id="A3.SS1.p3.2.m2.3.3.1.1.1.3.2" xref="A3.SS1.p3.2.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="A3.SS1.p3.2.m2.3.3.1.1.1.3.2.1" xref="A3.SS1.p3.2.m2.3.3.1.1.1.cmml">(</mo><mi id="A3.SS1.p3.2.m2.2.2" xref="A3.SS1.p3.2.m2.2.2.cmml">τ</mi><mo stretchy="false" id="A3.SS1.p3.2.m2.3.3.1.1.1.3.2.2" xref="A3.SS1.p3.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.SS1.p3.2.m2.3.3.1.1.3" xref="A3.SS1.p3.2.m2.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.2.m2.3b"><apply id="A3.SS1.p3.2.m2.3.3.cmml" xref="A3.SS1.p3.2.m2.3.3"><times id="A3.SS1.p3.2.m2.3.3.2.cmml" xref="A3.SS1.p3.2.m2.3.3.2"></times><apply id="A3.SS1.p3.2.m2.3.3.3.cmml" xref="A3.SS1.p3.2.m2.3.3.3"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m2.3.3.3.1.cmml" xref="A3.SS1.p3.2.m2.3.3.3">subscript</csymbol><ci id="A3.SS1.p3.2.m2.3.3.3.2.cmml" xref="A3.SS1.p3.2.m2.3.3.3.2">𝔼</ci><apply id="A3.SS1.p3.2.m2.1.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1"><csymbol cd="latexml" id="A3.SS1.p3.2.m2.1.1.1.2.cmml" xref="A3.SS1.p3.2.m2.1.1.1.2">similar-to</csymbol><ci id="A3.SS1.p3.2.m2.1.1.1.3.cmml" xref="A3.SS1.p3.2.m2.1.1.1.3">𝜏</ci><apply id="A3.SS1.p3.2.m2.1.1.1.4.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4"><times id="A3.SS1.p3.2.m2.1.1.1.4.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4.1"></times><apply id="A3.SS1.p3.2.m2.1.1.1.4.2.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m2.1.1.1.4.2.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4.2">subscript</csymbol><ci id="A3.SS1.p3.2.m2.1.1.1.4.2.2.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4.2.2">𝜋</ci><ci id="A3.SS1.p3.2.m2.1.1.1.4.2.3.cmml" xref="A3.SS1.p3.2.m2.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.SS1.p3.2.m2.1.1.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.SS1.p3.2.m2.3.3.1.2.cmml" xref="A3.SS1.p3.2.m2.3.3.1.1"><csymbol cd="latexml" id="A3.SS1.p3.2.m2.3.3.1.2.1.cmml" xref="A3.SS1.p3.2.m2.3.3.1.1.2">delimited-[]</csymbol><apply id="A3.SS1.p3.2.m2.3.3.1.1.1.cmml" xref="A3.SS1.p3.2.m2.3.3.1.1.1"><times id="A3.SS1.p3.2.m2.3.3.1.1.1.1.cmml" xref="A3.SS1.p3.2.m2.3.3.1.1.1.1"></times><ci id="A3.SS1.p3.2.m2.3.3.1.1.1.2.cmml" xref="A3.SS1.p3.2.m2.3.3.1.1.1.2">𝑟</ci><ci id="A3.SS1.p3.2.m2.2.2.cmml" xref="A3.SS1.p3.2.m2.2.2">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.2.m2.3c">\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}[r(\tau)]</annotation></semantics></math>, while it can be reframed as</p>
</div>
<div id="A3.SS1.p4" class="ltx_para ltx_noindent">
<table id="A3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E9.m1.6" class="ltx_Math" alttext="J(\theta)=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}[r(\tau)]=\sum_{\text{all }\tau}\pi_{\theta}(\tau)r(\tau)," display="block"><semantics id="A3.E9.m1.6a"><mrow id="A3.E9.m1.6.6.1" xref="A3.E9.m1.6.6.1.1.cmml"><mrow id="A3.E9.m1.6.6.1.1" xref="A3.E9.m1.6.6.1.1.cmml"><mrow id="A3.E9.m1.6.6.1.1.3" xref="A3.E9.m1.6.6.1.1.3.cmml"><mi id="A3.E9.m1.6.6.1.1.3.2" xref="A3.E9.m1.6.6.1.1.3.2.cmml">J</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.3.1" xref="A3.E9.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="A3.E9.m1.6.6.1.1.3.3.2" xref="A3.E9.m1.6.6.1.1.3.cmml"><mo stretchy="false" id="A3.E9.m1.6.6.1.1.3.3.2.1" xref="A3.E9.m1.6.6.1.1.3.cmml">(</mo><mi id="A3.E9.m1.2.2" xref="A3.E9.m1.2.2.cmml">θ</mi><mo stretchy="false" id="A3.E9.m1.6.6.1.1.3.3.2.2" xref="A3.E9.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo id="A3.E9.m1.6.6.1.1.4" xref="A3.E9.m1.6.6.1.1.4.cmml">=</mo><mrow id="A3.E9.m1.6.6.1.1.1" xref="A3.E9.m1.6.6.1.1.1.cmml"><msub id="A3.E9.m1.6.6.1.1.1.3" xref="A3.E9.m1.6.6.1.1.1.3.cmml"><mi id="A3.E9.m1.6.6.1.1.1.3.2" xref="A3.E9.m1.6.6.1.1.1.3.2.cmml">𝔼</mi><mrow id="A3.E9.m1.1.1.1" xref="A3.E9.m1.1.1.1.cmml"><mi id="A3.E9.m1.1.1.1.3" xref="A3.E9.m1.1.1.1.3.cmml">τ</mi><mo id="A3.E9.m1.1.1.1.2" xref="A3.E9.m1.1.1.1.2.cmml">∼</mo><mrow id="A3.E9.m1.1.1.1.4" xref="A3.E9.m1.1.1.1.4.cmml"><msub id="A3.E9.m1.1.1.1.4.2" xref="A3.E9.m1.1.1.1.4.2.cmml"><mi id="A3.E9.m1.1.1.1.4.2.2" xref="A3.E9.m1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E9.m1.1.1.1.4.2.3" xref="A3.E9.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E9.m1.1.1.1.4.1" xref="A3.E9.m1.1.1.1.4.1.cmml">​</mo><mrow id="A3.E9.m1.1.1.1.4.3.2" xref="A3.E9.m1.1.1.1.4.cmml"><mo stretchy="false" id="A3.E9.m1.1.1.1.4.3.2.1" xref="A3.E9.m1.1.1.1.4.cmml">(</mo><mi id="A3.E9.m1.1.1.1.1" xref="A3.E9.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E9.m1.1.1.1.4.3.2.2" xref="A3.E9.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.1.2" xref="A3.E9.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="A3.E9.m1.6.6.1.1.1.1.1" xref="A3.E9.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="A3.E9.m1.6.6.1.1.1.1.1.2" xref="A3.E9.m1.6.6.1.1.1.1.2.1.cmml">[</mo><mrow id="A3.E9.m1.6.6.1.1.1.1.1.1" xref="A3.E9.m1.6.6.1.1.1.1.1.1.cmml"><mi id="A3.E9.m1.6.6.1.1.1.1.1.1.2" xref="A3.E9.m1.6.6.1.1.1.1.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.1.1.1.1.1" xref="A3.E9.m1.6.6.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A3.E9.m1.6.6.1.1.1.1.1.1.3.2" xref="A3.E9.m1.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E9.m1.6.6.1.1.1.1.1.1.3.2.1" xref="A3.E9.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="A3.E9.m1.3.3" xref="A3.E9.m1.3.3.cmml">τ</mi><mo stretchy="false" id="A3.E9.m1.6.6.1.1.1.1.1.1.3.2.2" xref="A3.E9.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.E9.m1.6.6.1.1.1.1.1.3" xref="A3.E9.m1.6.6.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo rspace="0.111em" id="A3.E9.m1.6.6.1.1.5" xref="A3.E9.m1.6.6.1.1.5.cmml">=</mo><mrow id="A3.E9.m1.6.6.1.1.6" xref="A3.E9.m1.6.6.1.1.6.cmml"><munder id="A3.E9.m1.6.6.1.1.6.1" xref="A3.E9.m1.6.6.1.1.6.1.cmml"><mo movablelimits="false" id="A3.E9.m1.6.6.1.1.6.1.2" xref="A3.E9.m1.6.6.1.1.6.1.2.cmml">∑</mo><mrow id="A3.E9.m1.6.6.1.1.6.1.3" xref="A3.E9.m1.6.6.1.1.6.1.3.cmml"><mtext id="A3.E9.m1.6.6.1.1.6.1.3.2" xref="A3.E9.m1.6.6.1.1.6.1.3.2a.cmml">all </mtext><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.6.1.3.1" xref="A3.E9.m1.6.6.1.1.6.1.3.1.cmml">​</mo><mi id="A3.E9.m1.6.6.1.1.6.1.3.3" xref="A3.E9.m1.6.6.1.1.6.1.3.3.cmml">τ</mi></mrow></munder><mrow id="A3.E9.m1.6.6.1.1.6.2" xref="A3.E9.m1.6.6.1.1.6.2.cmml"><msub id="A3.E9.m1.6.6.1.1.6.2.2" xref="A3.E9.m1.6.6.1.1.6.2.2.cmml"><mi id="A3.E9.m1.6.6.1.1.6.2.2.2" xref="A3.E9.m1.6.6.1.1.6.2.2.2.cmml">π</mi><mi id="A3.E9.m1.6.6.1.1.6.2.2.3" xref="A3.E9.m1.6.6.1.1.6.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.6.2.1" xref="A3.E9.m1.6.6.1.1.6.2.1.cmml">​</mo><mrow id="A3.E9.m1.6.6.1.1.6.2.3.2" xref="A3.E9.m1.6.6.1.1.6.2.cmml"><mo stretchy="false" id="A3.E9.m1.6.6.1.1.6.2.3.2.1" xref="A3.E9.m1.6.6.1.1.6.2.cmml">(</mo><mi id="A3.E9.m1.4.4" xref="A3.E9.m1.4.4.cmml">τ</mi><mo stretchy="false" id="A3.E9.m1.6.6.1.1.6.2.3.2.2" xref="A3.E9.m1.6.6.1.1.6.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.6.2.1a" xref="A3.E9.m1.6.6.1.1.6.2.1.cmml">​</mo><mi id="A3.E9.m1.6.6.1.1.6.2.4" xref="A3.E9.m1.6.6.1.1.6.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.6.6.1.1.6.2.1b" xref="A3.E9.m1.6.6.1.1.6.2.1.cmml">​</mo><mrow id="A3.E9.m1.6.6.1.1.6.2.5.2" xref="A3.E9.m1.6.6.1.1.6.2.cmml"><mo stretchy="false" id="A3.E9.m1.6.6.1.1.6.2.5.2.1" xref="A3.E9.m1.6.6.1.1.6.2.cmml">(</mo><mi id="A3.E9.m1.5.5" xref="A3.E9.m1.5.5.cmml">τ</mi><mo stretchy="false" id="A3.E9.m1.6.6.1.1.6.2.5.2.2" xref="A3.E9.m1.6.6.1.1.6.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E9.m1.6.6.1.2" xref="A3.E9.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E9.m1.6b"><apply id="A3.E9.m1.6.6.1.1.cmml" xref="A3.E9.m1.6.6.1"><and id="A3.E9.m1.6.6.1.1a.cmml" xref="A3.E9.m1.6.6.1"></and><apply id="A3.E9.m1.6.6.1.1b.cmml" xref="A3.E9.m1.6.6.1"><eq id="A3.E9.m1.6.6.1.1.4.cmml" xref="A3.E9.m1.6.6.1.1.4"></eq><apply id="A3.E9.m1.6.6.1.1.3.cmml" xref="A3.E9.m1.6.6.1.1.3"><times id="A3.E9.m1.6.6.1.1.3.1.cmml" xref="A3.E9.m1.6.6.1.1.3.1"></times><ci id="A3.E9.m1.6.6.1.1.3.2.cmml" xref="A3.E9.m1.6.6.1.1.3.2">𝐽</ci><ci id="A3.E9.m1.2.2.cmml" xref="A3.E9.m1.2.2">𝜃</ci></apply><apply id="A3.E9.m1.6.6.1.1.1.cmml" xref="A3.E9.m1.6.6.1.1.1"><times id="A3.E9.m1.6.6.1.1.1.2.cmml" xref="A3.E9.m1.6.6.1.1.1.2"></times><apply id="A3.E9.m1.6.6.1.1.1.3.cmml" xref="A3.E9.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A3.E9.m1.6.6.1.1.1.3.1.cmml" xref="A3.E9.m1.6.6.1.1.1.3">subscript</csymbol><ci id="A3.E9.m1.6.6.1.1.1.3.2.cmml" xref="A3.E9.m1.6.6.1.1.1.3.2">𝔼</ci><apply id="A3.E9.m1.1.1.1.cmml" xref="A3.E9.m1.1.1.1"><csymbol cd="latexml" id="A3.E9.m1.1.1.1.2.cmml" xref="A3.E9.m1.1.1.1.2">similar-to</csymbol><ci id="A3.E9.m1.1.1.1.3.cmml" xref="A3.E9.m1.1.1.1.3">𝜏</ci><apply id="A3.E9.m1.1.1.1.4.cmml" xref="A3.E9.m1.1.1.1.4"><times id="A3.E9.m1.1.1.1.4.1.cmml" xref="A3.E9.m1.1.1.1.4.1"></times><apply id="A3.E9.m1.1.1.1.4.2.cmml" xref="A3.E9.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E9.m1.1.1.1.4.2.1.cmml" xref="A3.E9.m1.1.1.1.4.2">subscript</csymbol><ci id="A3.E9.m1.1.1.1.4.2.2.cmml" xref="A3.E9.m1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E9.m1.1.1.1.4.2.3.cmml" xref="A3.E9.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.E9.m1.1.1.1.1.cmml" xref="A3.E9.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.E9.m1.6.6.1.1.1.1.2.cmml" xref="A3.E9.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="A3.E9.m1.6.6.1.1.1.1.2.1.cmml" xref="A3.E9.m1.6.6.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A3.E9.m1.6.6.1.1.1.1.1.1.cmml" xref="A3.E9.m1.6.6.1.1.1.1.1.1"><times id="A3.E9.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A3.E9.m1.6.6.1.1.1.1.1.1.1"></times><ci id="A3.E9.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A3.E9.m1.6.6.1.1.1.1.1.1.2">𝑟</ci><ci id="A3.E9.m1.3.3.cmml" xref="A3.E9.m1.3.3">𝜏</ci></apply></apply></apply></apply><apply id="A3.E9.m1.6.6.1.1c.cmml" xref="A3.E9.m1.6.6.1"><eq id="A3.E9.m1.6.6.1.1.5.cmml" xref="A3.E9.m1.6.6.1.1.5"></eq><share href="#A3.E9.m1.6.6.1.1.1.cmml" id="A3.E9.m1.6.6.1.1d.cmml" xref="A3.E9.m1.6.6.1"></share><apply id="A3.E9.m1.6.6.1.1.6.cmml" xref="A3.E9.m1.6.6.1.1.6"><apply id="A3.E9.m1.6.6.1.1.6.1.cmml" xref="A3.E9.m1.6.6.1.1.6.1"><csymbol cd="ambiguous" id="A3.E9.m1.6.6.1.1.6.1.1.cmml" xref="A3.E9.m1.6.6.1.1.6.1">subscript</csymbol><sum id="A3.E9.m1.6.6.1.1.6.1.2.cmml" xref="A3.E9.m1.6.6.1.1.6.1.2"></sum><apply id="A3.E9.m1.6.6.1.1.6.1.3.cmml" xref="A3.E9.m1.6.6.1.1.6.1.3"><times id="A3.E9.m1.6.6.1.1.6.1.3.1.cmml" xref="A3.E9.m1.6.6.1.1.6.1.3.1"></times><ci id="A3.E9.m1.6.6.1.1.6.1.3.2a.cmml" xref="A3.E9.m1.6.6.1.1.6.1.3.2"><mtext mathsize="70%" id="A3.E9.m1.6.6.1.1.6.1.3.2.cmml" xref="A3.E9.m1.6.6.1.1.6.1.3.2">all </mtext></ci><ci id="A3.E9.m1.6.6.1.1.6.1.3.3.cmml" xref="A3.E9.m1.6.6.1.1.6.1.3.3">𝜏</ci></apply></apply><apply id="A3.E9.m1.6.6.1.1.6.2.cmml" xref="A3.E9.m1.6.6.1.1.6.2"><times id="A3.E9.m1.6.6.1.1.6.2.1.cmml" xref="A3.E9.m1.6.6.1.1.6.2.1"></times><apply id="A3.E9.m1.6.6.1.1.6.2.2.cmml" xref="A3.E9.m1.6.6.1.1.6.2.2"><csymbol cd="ambiguous" id="A3.E9.m1.6.6.1.1.6.2.2.1.cmml" xref="A3.E9.m1.6.6.1.1.6.2.2">subscript</csymbol><ci id="A3.E9.m1.6.6.1.1.6.2.2.2.cmml" xref="A3.E9.m1.6.6.1.1.6.2.2.2">𝜋</ci><ci id="A3.E9.m1.6.6.1.1.6.2.2.3.cmml" xref="A3.E9.m1.6.6.1.1.6.2.2.3">𝜃</ci></apply><ci id="A3.E9.m1.4.4.cmml" xref="A3.E9.m1.4.4">𝜏</ci><ci id="A3.E9.m1.6.6.1.1.6.2.4.cmml" xref="A3.E9.m1.6.6.1.1.6.2.4">𝑟</ci><ci id="A3.E9.m1.5.5.cmml" xref="A3.E9.m1.5.5">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E9.m1.6c">J(\theta)=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}[r(\tau)]=\sum_{\text{all }\tau}\pi_{\theta}(\tau)r(\tau),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p4.8" class="ltx_p">where <math id="A3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.SS1.p4.1.m1.1a"><mi id="A3.SS1.p4.1.m1.1.1" xref="A3.SS1.p4.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.1.m1.1b"><ci id="A3.SS1.p4.1.m1.1.1.cmml" xref="A3.SS1.p4.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.1.m1.1c">\theta</annotation></semantics></math> denotes the weights of the policy making network, <math id="A3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A3.SS1.p4.2.m2.1a"><mi id="A3.SS1.p4.2.m2.1.1" xref="A3.SS1.p4.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.2.m2.1b"><ci id="A3.SS1.p4.2.m2.1.1.cmml" xref="A3.SS1.p4.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.2.m2.1c">\tau</annotation></semantics></math> represents a string of actions <math id="A3.SS1.p4.3.m3.1" class="ltx_Math" alttext="\tau=\{{a}_{t}\}^{T-1}_{t=0}" display="inline"><semantics id="A3.SS1.p4.3.m3.1a"><mrow id="A3.SS1.p4.3.m3.1.1" xref="A3.SS1.p4.3.m3.1.1.cmml"><mi id="A3.SS1.p4.3.m3.1.1.3" xref="A3.SS1.p4.3.m3.1.1.3.cmml">τ</mi><mo id="A3.SS1.p4.3.m3.1.1.2" xref="A3.SS1.p4.3.m3.1.1.2.cmml">=</mo><msubsup id="A3.SS1.p4.3.m3.1.1.1" xref="A3.SS1.p4.3.m3.1.1.1.cmml"><mrow id="A3.SS1.p4.3.m3.1.1.1.1.1.1" xref="A3.SS1.p4.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A3.SS1.p4.3.m3.1.1.1.1.1.1.2" xref="A3.SS1.p4.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.2" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.3" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="A3.SS1.p4.3.m3.1.1.1.1.1.1.3" xref="A3.SS1.p4.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A3.SS1.p4.3.m3.1.1.1.3" xref="A3.SS1.p4.3.m3.1.1.1.3.cmml"><mi id="A3.SS1.p4.3.m3.1.1.1.3.2" xref="A3.SS1.p4.3.m3.1.1.1.3.2.cmml">t</mi><mo id="A3.SS1.p4.3.m3.1.1.1.3.1" xref="A3.SS1.p4.3.m3.1.1.1.3.1.cmml">=</mo><mn id="A3.SS1.p4.3.m3.1.1.1.3.3" xref="A3.SS1.p4.3.m3.1.1.1.3.3.cmml">0</mn></mrow><mrow id="A3.SS1.p4.3.m3.1.1.1.1.3" xref="A3.SS1.p4.3.m3.1.1.1.1.3.cmml"><mi id="A3.SS1.p4.3.m3.1.1.1.1.3.2" xref="A3.SS1.p4.3.m3.1.1.1.1.3.2.cmml">T</mi><mo id="A3.SS1.p4.3.m3.1.1.1.1.3.1" xref="A3.SS1.p4.3.m3.1.1.1.1.3.1.cmml">−</mo><mn id="A3.SS1.p4.3.m3.1.1.1.1.3.3" xref="A3.SS1.p4.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.3.m3.1b"><apply id="A3.SS1.p4.3.m3.1.1.cmml" xref="A3.SS1.p4.3.m3.1.1"><eq id="A3.SS1.p4.3.m3.1.1.2.cmml" xref="A3.SS1.p4.3.m3.1.1.2"></eq><ci id="A3.SS1.p4.3.m3.1.1.3.cmml" xref="A3.SS1.p4.3.m3.1.1.3">𝜏</ci><apply id="A3.SS1.p4.3.m3.1.1.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p4.3.m3.1.1.1.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1">subscript</csymbol><apply id="A3.SS1.p4.3.m3.1.1.1.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p4.3.m3.1.1.1.1.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1">superscript</csymbol><set id="A3.SS1.p4.3.m3.1.1.1.1.1.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1"><apply id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="A3.SS1.p4.3.m3.1.1.1.1.3.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.3"><minus id="A3.SS1.p4.3.m3.1.1.1.1.3.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.3.1"></minus><ci id="A3.SS1.p4.3.m3.1.1.1.1.3.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.3.2">𝑇</ci><cn type="integer" id="A3.SS1.p4.3.m3.1.1.1.1.3.3.cmml" xref="A3.SS1.p4.3.m3.1.1.1.1.3.3">1</cn></apply></apply><apply id="A3.SS1.p4.3.m3.1.1.1.3.cmml" xref="A3.SS1.p4.3.m3.1.1.1.3"><eq id="A3.SS1.p4.3.m3.1.1.1.3.1.cmml" xref="A3.SS1.p4.3.m3.1.1.1.3.1"></eq><ci id="A3.SS1.p4.3.m3.1.1.1.3.2.cmml" xref="A3.SS1.p4.3.m3.1.1.1.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p4.3.m3.1.1.1.3.3.cmml" xref="A3.SS1.p4.3.m3.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.3.m3.1c">\tau=\{{a}_{t}\}^{T-1}_{t=0}</annotation></semantics></math> and <math id="A3.SS1.p4.4.m4.1" class="ltx_Math" alttext="\pi_{\theta}(\tau)" display="inline"><semantics id="A3.SS1.p4.4.m4.1a"><mrow id="A3.SS1.p4.4.m4.1.2" xref="A3.SS1.p4.4.m4.1.2.cmml"><msub id="A3.SS1.p4.4.m4.1.2.2" xref="A3.SS1.p4.4.m4.1.2.2.cmml"><mi id="A3.SS1.p4.4.m4.1.2.2.2" xref="A3.SS1.p4.4.m4.1.2.2.2.cmml">π</mi><mi id="A3.SS1.p4.4.m4.1.2.2.3" xref="A3.SS1.p4.4.m4.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p4.4.m4.1.2.1" xref="A3.SS1.p4.4.m4.1.2.1.cmml">​</mo><mrow id="A3.SS1.p4.4.m4.1.2.3.2" xref="A3.SS1.p4.4.m4.1.2.cmml"><mo stretchy="false" id="A3.SS1.p4.4.m4.1.2.3.2.1" xref="A3.SS1.p4.4.m4.1.2.cmml">(</mo><mi id="A3.SS1.p4.4.m4.1.1" xref="A3.SS1.p4.4.m4.1.1.cmml">τ</mi><mo stretchy="false" id="A3.SS1.p4.4.m4.1.2.3.2.2" xref="A3.SS1.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.4.m4.1b"><apply id="A3.SS1.p4.4.m4.1.2.cmml" xref="A3.SS1.p4.4.m4.1.2"><times id="A3.SS1.p4.4.m4.1.2.1.cmml" xref="A3.SS1.p4.4.m4.1.2.1"></times><apply id="A3.SS1.p4.4.m4.1.2.2.cmml" xref="A3.SS1.p4.4.m4.1.2.2"><csymbol cd="ambiguous" id="A3.SS1.p4.4.m4.1.2.2.1.cmml" xref="A3.SS1.p4.4.m4.1.2.2">subscript</csymbol><ci id="A3.SS1.p4.4.m4.1.2.2.2.cmml" xref="A3.SS1.p4.4.m4.1.2.2.2">𝜋</ci><ci id="A3.SS1.p4.4.m4.1.2.2.3.cmml" xref="A3.SS1.p4.4.m4.1.2.2.3">𝜃</ci></apply><ci id="A3.SS1.p4.4.m4.1.1.cmml" xref="A3.SS1.p4.4.m4.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.4.m4.1c">\pi_{\theta}(\tau)</annotation></semantics></math> is the probability <math id="A3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\prod_{t=0}^{T-1}\pi_{\theta}({a}_{t}|{s}_{t})" display="inline"><semantics id="A3.SS1.p4.5.m5.1a"><mrow id="A3.SS1.p4.5.m5.1.1" xref="A3.SS1.p4.5.m5.1.1.cmml"><msubsup id="A3.SS1.p4.5.m5.1.1.2" xref="A3.SS1.p4.5.m5.1.1.2.cmml"><mo id="A3.SS1.p4.5.m5.1.1.2.2.2" xref="A3.SS1.p4.5.m5.1.1.2.2.2.cmml">∏</mo><mrow id="A3.SS1.p4.5.m5.1.1.2.2.3" xref="A3.SS1.p4.5.m5.1.1.2.2.3.cmml"><mi id="A3.SS1.p4.5.m5.1.1.2.2.3.2" xref="A3.SS1.p4.5.m5.1.1.2.2.3.2.cmml">t</mi><mo id="A3.SS1.p4.5.m5.1.1.2.2.3.1" xref="A3.SS1.p4.5.m5.1.1.2.2.3.1.cmml">=</mo><mn id="A3.SS1.p4.5.m5.1.1.2.2.3.3" xref="A3.SS1.p4.5.m5.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A3.SS1.p4.5.m5.1.1.2.3" xref="A3.SS1.p4.5.m5.1.1.2.3.cmml"><mi id="A3.SS1.p4.5.m5.1.1.2.3.2" xref="A3.SS1.p4.5.m5.1.1.2.3.2.cmml">T</mi><mo id="A3.SS1.p4.5.m5.1.1.2.3.1" xref="A3.SS1.p4.5.m5.1.1.2.3.1.cmml">−</mo><mn id="A3.SS1.p4.5.m5.1.1.2.3.3" xref="A3.SS1.p4.5.m5.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="A3.SS1.p4.5.m5.1.1.1" xref="A3.SS1.p4.5.m5.1.1.1.cmml"><msub id="A3.SS1.p4.5.m5.1.1.1.3" xref="A3.SS1.p4.5.m5.1.1.1.3.cmml"><mi id="A3.SS1.p4.5.m5.1.1.1.3.2" xref="A3.SS1.p4.5.m5.1.1.1.3.2.cmml">π</mi><mi id="A3.SS1.p4.5.m5.1.1.1.3.3" xref="A3.SS1.p4.5.m5.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p4.5.m5.1.1.1.2" xref="A3.SS1.p4.5.m5.1.1.1.2.cmml">​</mo><mrow id="A3.SS1.p4.5.m5.1.1.1.1.1" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.SS1.p4.5.m5.1.1.1.1.1.2" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS1.p4.5.m5.1.1.1.1.1.1" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.cmml"><msub id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.cmml"><mi id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.2" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.3" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.SS1.p4.5.m5.1.1.1.1.1.1.1" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.cmml"><mi id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.2" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.3" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.SS1.p4.5.m5.1.1.1.1.1.3" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.5.m5.1b"><apply id="A3.SS1.p4.5.m5.1.1.cmml" xref="A3.SS1.p4.5.m5.1.1"><apply id="A3.SS1.p4.5.m5.1.1.2.cmml" xref="A3.SS1.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p4.5.m5.1.1.2.1.cmml" xref="A3.SS1.p4.5.m5.1.1.2">superscript</csymbol><apply id="A3.SS1.p4.5.m5.1.1.2.2.cmml" xref="A3.SS1.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p4.5.m5.1.1.2.2.1.cmml" xref="A3.SS1.p4.5.m5.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A3.SS1.p4.5.m5.1.1.2.2.2.cmml" xref="A3.SS1.p4.5.m5.1.1.2.2.2">product</csymbol><apply id="A3.SS1.p4.5.m5.1.1.2.2.3.cmml" xref="A3.SS1.p4.5.m5.1.1.2.2.3"><eq id="A3.SS1.p4.5.m5.1.1.2.2.3.1.cmml" xref="A3.SS1.p4.5.m5.1.1.2.2.3.1"></eq><ci id="A3.SS1.p4.5.m5.1.1.2.2.3.2.cmml" xref="A3.SS1.p4.5.m5.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p4.5.m5.1.1.2.2.3.3.cmml" xref="A3.SS1.p4.5.m5.1.1.2.2.3.3">0</cn></apply></apply><apply id="A3.SS1.p4.5.m5.1.1.2.3.cmml" xref="A3.SS1.p4.5.m5.1.1.2.3"><minus id="A3.SS1.p4.5.m5.1.1.2.3.1.cmml" xref="A3.SS1.p4.5.m5.1.1.2.3.1"></minus><ci id="A3.SS1.p4.5.m5.1.1.2.3.2.cmml" xref="A3.SS1.p4.5.m5.1.1.2.3.2">𝑇</ci><cn type="integer" id="A3.SS1.p4.5.m5.1.1.2.3.3.cmml" xref="A3.SS1.p4.5.m5.1.1.2.3.3">1</cn></apply></apply><apply id="A3.SS1.p4.5.m5.1.1.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1"><times id="A3.SS1.p4.5.m5.1.1.1.2.cmml" xref="A3.SS1.p4.5.m5.1.1.1.2"></times><apply id="A3.SS1.p4.5.m5.1.1.1.3.cmml" xref="A3.SS1.p4.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p4.5.m5.1.1.1.3.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1.3">subscript</csymbol><ci id="A3.SS1.p4.5.m5.1.1.1.3.2.cmml" xref="A3.SS1.p4.5.m5.1.1.1.3.2">𝜋</ci><ci id="A3.SS1.p4.5.m5.1.1.1.3.3.cmml" xref="A3.SS1.p4.5.m5.1.1.1.3.3">𝜃</ci></apply><apply id="A3.SS1.p4.5.m5.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.p4.5.m5.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.2.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.1.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.2.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.3.cmml" xref="A3.SS1.p4.5.m5.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.5.m5.1c">\prod_{t=0}^{T-1}\pi_{\theta}({a}_{t}|{s}_{t})</annotation></semantics></math> that the policy network predicts to take such trajectory; <math id="A3.SS1.p4.6.m6.1" class="ltx_Math" alttext="r(\tau)" display="inline"><semantics id="A3.SS1.p4.6.m6.1a"><mrow id="A3.SS1.p4.6.m6.1.2" xref="A3.SS1.p4.6.m6.1.2.cmml"><mi id="A3.SS1.p4.6.m6.1.2.2" xref="A3.SS1.p4.6.m6.1.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p4.6.m6.1.2.1" xref="A3.SS1.p4.6.m6.1.2.1.cmml">​</mo><mrow id="A3.SS1.p4.6.m6.1.2.3.2" xref="A3.SS1.p4.6.m6.1.2.cmml"><mo stretchy="false" id="A3.SS1.p4.6.m6.1.2.3.2.1" xref="A3.SS1.p4.6.m6.1.2.cmml">(</mo><mi id="A3.SS1.p4.6.m6.1.1" xref="A3.SS1.p4.6.m6.1.1.cmml">τ</mi><mo stretchy="false" id="A3.SS1.p4.6.m6.1.2.3.2.2" xref="A3.SS1.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.6.m6.1b"><apply id="A3.SS1.p4.6.m6.1.2.cmml" xref="A3.SS1.p4.6.m6.1.2"><times id="A3.SS1.p4.6.m6.1.2.1.cmml" xref="A3.SS1.p4.6.m6.1.2.1"></times><ci id="A3.SS1.p4.6.m6.1.2.2.cmml" xref="A3.SS1.p4.6.m6.1.2.2">𝑟</ci><ci id="A3.SS1.p4.6.m6.1.1.cmml" xref="A3.SS1.p4.6.m6.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.6.m6.1c">r(\tau)</annotation></semantics></math> is the total income taking trajectory <math id="A3.SS1.p4.7.m7.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A3.SS1.p4.7.m7.1a"><mi id="A3.SS1.p4.7.m7.1.1" xref="A3.SS1.p4.7.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.7.m7.1b"><ci id="A3.SS1.p4.7.m7.1.1.cmml" xref="A3.SS1.p4.7.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.7.m7.1c">\tau</annotation></semantics></math> as <math id="A3.SS1.p4.8.m8.2" class="ltx_Math" alttext="\sum_{t=0}^{T-1}r(a_{t},s_{t})" display="inline"><semantics id="A3.SS1.p4.8.m8.2a"><mrow id="A3.SS1.p4.8.m8.2.2" xref="A3.SS1.p4.8.m8.2.2.cmml"><msubsup id="A3.SS1.p4.8.m8.2.2.3" xref="A3.SS1.p4.8.m8.2.2.3.cmml"><mo id="A3.SS1.p4.8.m8.2.2.3.2.2" xref="A3.SS1.p4.8.m8.2.2.3.2.2.cmml">∑</mo><mrow id="A3.SS1.p4.8.m8.2.2.3.2.3" xref="A3.SS1.p4.8.m8.2.2.3.2.3.cmml"><mi id="A3.SS1.p4.8.m8.2.2.3.2.3.2" xref="A3.SS1.p4.8.m8.2.2.3.2.3.2.cmml">t</mi><mo id="A3.SS1.p4.8.m8.2.2.3.2.3.1" xref="A3.SS1.p4.8.m8.2.2.3.2.3.1.cmml">=</mo><mn id="A3.SS1.p4.8.m8.2.2.3.2.3.3" xref="A3.SS1.p4.8.m8.2.2.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.SS1.p4.8.m8.2.2.3.3" xref="A3.SS1.p4.8.m8.2.2.3.3.cmml"><mi id="A3.SS1.p4.8.m8.2.2.3.3.2" xref="A3.SS1.p4.8.m8.2.2.3.3.2.cmml">T</mi><mo id="A3.SS1.p4.8.m8.2.2.3.3.1" xref="A3.SS1.p4.8.m8.2.2.3.3.1.cmml">−</mo><mn id="A3.SS1.p4.8.m8.2.2.3.3.3" xref="A3.SS1.p4.8.m8.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A3.SS1.p4.8.m8.2.2.2" xref="A3.SS1.p4.8.m8.2.2.2.cmml"><mi id="A3.SS1.p4.8.m8.2.2.2.4" xref="A3.SS1.p4.8.m8.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p4.8.m8.2.2.2.3" xref="A3.SS1.p4.8.m8.2.2.2.3.cmml">​</mo><mrow id="A3.SS1.p4.8.m8.2.2.2.2.2" xref="A3.SS1.p4.8.m8.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.p4.8.m8.2.2.2.2.2.3" xref="A3.SS1.p4.8.m8.2.2.2.2.3.cmml">(</mo><msub id="A3.SS1.p4.8.m8.1.1.1.1.1.1" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p4.8.m8.1.1.1.1.1.1.2" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1.2.cmml">a</mi><mi id="A3.SS1.p4.8.m8.1.1.1.1.1.1.3" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.SS1.p4.8.m8.2.2.2.2.2.4" xref="A3.SS1.p4.8.m8.2.2.2.2.3.cmml">,</mo><msub id="A3.SS1.p4.8.m8.2.2.2.2.2.2" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2.cmml"><mi id="A3.SS1.p4.8.m8.2.2.2.2.2.2.2" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2.2.cmml">s</mi><mi id="A3.SS1.p4.8.m8.2.2.2.2.2.2.3" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="A3.SS1.p4.8.m8.2.2.2.2.2.5" xref="A3.SS1.p4.8.m8.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.8.m8.2b"><apply id="A3.SS1.p4.8.m8.2.2.cmml" xref="A3.SS1.p4.8.m8.2.2"><apply id="A3.SS1.p4.8.m8.2.2.3.cmml" xref="A3.SS1.p4.8.m8.2.2.3"><csymbol cd="ambiguous" id="A3.SS1.p4.8.m8.2.2.3.1.cmml" xref="A3.SS1.p4.8.m8.2.2.3">superscript</csymbol><apply id="A3.SS1.p4.8.m8.2.2.3.2.cmml" xref="A3.SS1.p4.8.m8.2.2.3"><csymbol cd="ambiguous" id="A3.SS1.p4.8.m8.2.2.3.2.1.cmml" xref="A3.SS1.p4.8.m8.2.2.3">subscript</csymbol><sum id="A3.SS1.p4.8.m8.2.2.3.2.2.cmml" xref="A3.SS1.p4.8.m8.2.2.3.2.2"></sum><apply id="A3.SS1.p4.8.m8.2.2.3.2.3.cmml" xref="A3.SS1.p4.8.m8.2.2.3.2.3"><eq id="A3.SS1.p4.8.m8.2.2.3.2.3.1.cmml" xref="A3.SS1.p4.8.m8.2.2.3.2.3.1"></eq><ci id="A3.SS1.p4.8.m8.2.2.3.2.3.2.cmml" xref="A3.SS1.p4.8.m8.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p4.8.m8.2.2.3.2.3.3.cmml" xref="A3.SS1.p4.8.m8.2.2.3.2.3.3">0</cn></apply></apply><apply id="A3.SS1.p4.8.m8.2.2.3.3.cmml" xref="A3.SS1.p4.8.m8.2.2.3.3"><minus id="A3.SS1.p4.8.m8.2.2.3.3.1.cmml" xref="A3.SS1.p4.8.m8.2.2.3.3.1"></minus><ci id="A3.SS1.p4.8.m8.2.2.3.3.2.cmml" xref="A3.SS1.p4.8.m8.2.2.3.3.2">𝑇</ci><cn type="integer" id="A3.SS1.p4.8.m8.2.2.3.3.3.cmml" xref="A3.SS1.p4.8.m8.2.2.3.3.3">1</cn></apply></apply><apply id="A3.SS1.p4.8.m8.2.2.2.cmml" xref="A3.SS1.p4.8.m8.2.2.2"><times id="A3.SS1.p4.8.m8.2.2.2.3.cmml" xref="A3.SS1.p4.8.m8.2.2.2.3"></times><ci id="A3.SS1.p4.8.m8.2.2.2.4.cmml" xref="A3.SS1.p4.8.m8.2.2.2.4">𝑟</ci><interval closure="open" id="A3.SS1.p4.8.m8.2.2.2.2.3.cmml" xref="A3.SS1.p4.8.m8.2.2.2.2.2"><apply id="A3.SS1.p4.8.m8.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p4.8.m8.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.p4.8.m8.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1.2">𝑎</ci><ci id="A3.SS1.p4.8.m8.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p4.8.m8.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.SS1.p4.8.m8.2.2.2.2.2.2.cmml" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p4.8.m8.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2">subscript</csymbol><ci id="A3.SS1.p4.8.m8.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2.2">𝑠</ci><ci id="A3.SS1.p4.8.m8.2.2.2.2.2.2.3.cmml" xref="A3.SS1.p4.8.m8.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.8.m8.2c">\sum_{t=0}^{T-1}r(a_{t},s_{t})</annotation></semantics></math>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Off-Policy RL in <span id="alg1.4.2" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>pertained GPT weights <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\theta</annotation></semantics></math>, OOD conditions <math id="alg1.l1.m2.3" class="ltx_Math" alttext="\{(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}})\}" display="inline"><semantics id="alg1.l1.m2.3a"><mrow id="alg1.l1.m2.3.3.1" xref="alg1.l1.m2.3.3.2.cmml"><mo stretchy="false" id="alg1.l1.m2.3.3.1.2" xref="alg1.l1.m2.3.3.2.cmml">{</mo><mrow id="alg1.l1.m2.3.3.1.1.2" xref="alg1.l1.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m2.3.3.1.1.2.1" xref="alg1.l1.m2.3.3.1.1.1.cmml">(</mo><mover accent="true" id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">m</mi><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">^</mo></mover><mo id="alg1.l1.m2.3.3.1.1.2.2" xref="alg1.l1.m2.3.3.1.1.1.cmml">,</mo><mover accent="true" id="alg1.l1.m2.2.2" xref="alg1.l1.m2.2.2.cmml"><mi mathcolor="#0AA344" id="alg1.l1.m2.2.2.2" xref="alg1.l1.m2.2.2.2.cmml">z</mi><mo id="alg1.l1.m2.2.2.1" xref="alg1.l1.m2.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l1.m2.3.3.1.1.2.3" xref="alg1.l1.m2.3.3.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l1.m2.3.3.1.3" xref="alg1.l1.m2.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.3b"><set id="alg1.l1.m2.3.3.2.cmml" xref="alg1.l1.m2.3.3.1"><interval closure="open" id="alg1.l1.m2.3.3.1.1.1.cmml" xref="alg1.l1.m2.3.3.1.1.2"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><ci id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1">^</ci><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑚</ci></apply><apply id="alg1.l1.m2.2.2.cmml" xref="alg1.l1.m2.2.2"><ci id="alg1.l1.m2.2.2.1.cmml" xref="alg1.l1.m2.2.2.1">^</ci><ci id="alg1.l1.m2.2.2.2.cmml" xref="alg1.l1.m2.2.2.2">𝑧</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.3c">\{(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}})\}</annotation></semantics></math>, Epoch number <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="alg1.l1.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\mathcal{E}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="\epsilon\leftarrow 0" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">ϵ</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\epsilon\leftarrow 0</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="\hat{\mathcal{D}}\leftarrow\varnothing" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mover accent="true" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">𝒟</mi><mo id="alg1.l3.m1.1.1.2.1" xref="alg1.l3.m1.1.1.2.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><merror class="ltx_ERROR undefined undefined" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3b.cmml"><mtext id="alg1.l3.m1.1.1.3a" xref="alg1.l3.m1.1.1.3b.cmml">\varnothing</mtext></merror></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><ci id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2.1">^</ci><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝒟</ci></apply><ci id="alg1.l3.m1.1.1.3b.cmml" xref="alg1.l3.m1.1.1.3"><merror class="ltx_ERROR undefined undefined" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><mtext id="alg1.l3.m1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.3">\varnothing</mtext></merror></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\hat{\mathcal{D}}\leftarrow\varnothing</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg1.l4.1" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\epsilon&lt;\mathcal{E}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">ϵ</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">&lt;</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><lt id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></lt><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">italic-ϵ</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\epsilon&lt;\mathcal{E}</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     generate sequence <math id="alg1.l5.m1.4" class="ltx_Math" alttext="\{\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}^{\epsilon},\hat{tr}^{\epsilon}\}\leftarrow\text{GPT}_{\theta}(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}})" display="inline"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mrow id="alg1.l5.m1.4.4.2.2" xref="alg1.l5.m1.4.4.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.4.4.2.2.3" xref="alg1.l5.m1.4.4.2.3.cmml">{</mo><msup id="alg1.l5.m1.3.3.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.cmml"><mover accent="true" id="alg1.l5.m1.3.3.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.1.2.cmml"><mi mathcolor="#C93756" id="alg1.l5.m1.3.3.1.1.1.2.2" xref="alg1.l5.m1.3.3.1.1.1.2.2.cmml">z</mi><mo id="alg1.l5.m1.3.3.1.1.1.2.1" xref="alg1.l5.m1.3.3.1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l5.m1.3.3.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.1.3.cmml">ϵ</mi></msup><mo id="alg1.l5.m1.4.4.2.2.4" xref="alg1.l5.m1.4.4.2.3.cmml">,</mo><msup id="alg1.l5.m1.4.4.2.2.2" xref="alg1.l5.m1.4.4.2.2.2.cmml"><mover accent="true" id="alg1.l5.m1.4.4.2.2.2.2" xref="alg1.l5.m1.4.4.2.2.2.2.cmml"><mrow id="alg1.l5.m1.4.4.2.2.2.2.2" xref="alg1.l5.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.4.4.2.2.2.2.2.2" xref="alg1.l5.m1.4.4.2.2.2.2.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.4.4.2.2.2.2.2.1" xref="alg1.l5.m1.4.4.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l5.m1.4.4.2.2.2.2.2.3" xref="alg1.l5.m1.4.4.2.2.2.2.2.3.cmml">r</mi></mrow><mo id="alg1.l5.m1.4.4.2.2.2.2.1" xref="alg1.l5.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l5.m1.4.4.2.2.2.3" xref="alg1.l5.m1.4.4.2.2.2.3.cmml">ϵ</mi></msup><mo stretchy="false" id="alg1.l5.m1.4.4.2.2.5" xref="alg1.l5.m1.4.4.2.3.cmml">}</mo></mrow><mo stretchy="false" id="alg1.l5.m1.4.4.3" xref="alg1.l5.m1.4.4.3.cmml">←</mo><mrow id="alg1.l5.m1.4.4.4" xref="alg1.l5.m1.4.4.4.cmml"><msub id="alg1.l5.m1.4.4.4.2" xref="alg1.l5.m1.4.4.4.2.cmml"><mtext id="alg1.l5.m1.4.4.4.2.2" xref="alg1.l5.m1.4.4.4.2.2a.cmml">GPT</mtext><mi id="alg1.l5.m1.4.4.4.2.3" xref="alg1.l5.m1.4.4.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m1.4.4.4.1" xref="alg1.l5.m1.4.4.4.1.cmml">​</mo><mrow id="alg1.l5.m1.4.4.4.3.2" xref="alg1.l5.m1.4.4.4.3.1.cmml"><mo stretchy="false" id="alg1.l5.m1.4.4.4.3.2.1" xref="alg1.l5.m1.4.4.4.3.1.cmml">(</mo><mover accent="true" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">m</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l5.m1.4.4.4.3.2.2" xref="alg1.l5.m1.4.4.4.3.1.cmml">,</mo><mover accent="true" id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><mi mathcolor="#0AA344" id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml">z</mi><mo id="alg1.l5.m1.2.2.1" xref="alg1.l5.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l5.m1.4.4.4.3.2.3" xref="alg1.l5.m1.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><ci id="alg1.l5.m1.4.4.3.cmml" xref="alg1.l5.m1.4.4.3">←</ci><set id="alg1.l5.m1.4.4.2.3.cmml" xref="alg1.l5.m1.4.4.2.2"><apply id="alg1.l5.m1.3.3.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1">superscript</csymbol><apply id="alg1.l5.m1.3.3.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.2"><ci id="alg1.l5.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.2.1">^</ci><ci id="alg1.l5.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.2.2">𝑧</ci></apply><ci id="alg1.l5.m1.3.3.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.3">italic-ϵ</ci></apply><apply id="alg1.l5.m1.4.4.2.2.2.cmml" xref="alg1.l5.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.2.2.2.1.cmml" xref="alg1.l5.m1.4.4.2.2.2">superscript</csymbol><apply id="alg1.l5.m1.4.4.2.2.2.2.cmml" xref="alg1.l5.m1.4.4.2.2.2.2"><ci id="alg1.l5.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l5.m1.4.4.2.2.2.2.1">^</ci><apply id="alg1.l5.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l5.m1.4.4.2.2.2.2.2"><times id="alg1.l5.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.4.4.2.2.2.2.2.1"></times><ci id="alg1.l5.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.4.4.2.2.2.2.2.2">𝑡</ci><ci id="alg1.l5.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.4.4.2.2.2.2.2.3">𝑟</ci></apply></apply><ci id="alg1.l5.m1.4.4.2.2.2.3.cmml" xref="alg1.l5.m1.4.4.2.2.2.3">italic-ϵ</ci></apply></set><apply id="alg1.l5.m1.4.4.4.cmml" xref="alg1.l5.m1.4.4.4"><times id="alg1.l5.m1.4.4.4.1.cmml" xref="alg1.l5.m1.4.4.4.1"></times><apply id="alg1.l5.m1.4.4.4.2.cmml" xref="alg1.l5.m1.4.4.4.2"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.4.2.1.cmml" xref="alg1.l5.m1.4.4.4.2">subscript</csymbol><ci id="alg1.l5.m1.4.4.4.2.2a.cmml" xref="alg1.l5.m1.4.4.4.2.2"><mtext id="alg1.l5.m1.4.4.4.2.2.cmml" xref="alg1.l5.m1.4.4.4.2.2">GPT</mtext></ci><ci id="alg1.l5.m1.4.4.4.2.3.cmml" xref="alg1.l5.m1.4.4.4.2.3">𝜃</ci></apply><interval closure="open" id="alg1.l5.m1.4.4.4.3.1.cmml" xref="alg1.l5.m1.4.4.4.3.2"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">^</ci><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑚</ci></apply><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.1.cmml" xref="alg1.l5.m1.2.2.1">^</ci><ci id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2">𝑧</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">\{\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}^{\epsilon},\hat{tr}^{\epsilon}\}\leftarrow\text{GPT}_{\theta}(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.3" class="ltx_Math" alttext="\hat{\mathcal{D}}\leftarrow\hat{\mathcal{D}}\cup\{(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}^{\epsilon},\hat{tr}^{\epsilon})\}" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mover accent="true" id="alg1.l6.m1.3.3.3" xref="alg1.l6.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.3.3.3.2" xref="alg1.l6.m1.3.3.3.2.cmml">𝒟</mi><mo id="alg1.l6.m1.3.3.3.1" xref="alg1.l6.m1.3.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l6.m1.3.3.2" xref="alg1.l6.m1.3.3.2.cmml">←</mo><mrow id="alg1.l6.m1.3.3.1" xref="alg1.l6.m1.3.3.1.cmml"><mover accent="true" id="alg1.l6.m1.3.3.1.3" xref="alg1.l6.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.3.3.1.3.2" xref="alg1.l6.m1.3.3.1.3.2.cmml">𝒟</mi><mo id="alg1.l6.m1.3.3.1.3.1" xref="alg1.l6.m1.3.3.1.3.1.cmml">^</mo></mover><mo id="alg1.l6.m1.3.3.1.2" xref="alg1.l6.m1.3.3.1.2.cmml">∪</mo><mrow id="alg1.l6.m1.3.3.1.1.1" xref="alg1.l6.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.1.1.1.2" xref="alg1.l6.m1.3.3.1.1.2.cmml">{</mo><mrow id="alg1.l6.m1.3.3.1.1.1.1.2" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.1.1.1.1.2.3" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">(</mo><mover accent="true" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">m</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l6.m1.3.3.1.1.1.1.2.4" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">,</mo><mover accent="true" id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mi mathcolor="#0AA344" id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml">z</mi><mo id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml">^</mo></mover><mo id="alg1.l6.m1.3.3.1.1.1.1.2.5" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">,</mo><msup id="alg1.l6.m1.3.3.1.1.1.1.1.1" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l6.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2.cmml"><mi mathcolor="#C93756" id="alg1.l6.m1.3.3.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2.2.cmml">z</mi><mo id="alg1.l6.m1.3.3.1.1.1.1.1.1.2.1" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l6.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.3.cmml">ϵ</mi></msup><mo id="alg1.l6.m1.3.3.1.1.1.1.2.6" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">,</mo><msup id="alg1.l6.m1.3.3.1.1.1.1.2.2" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.cmml"><mover accent="true" id="alg1.l6.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.cmml"><mrow id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.2" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.1" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.1.cmml">​</mo><mi id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.3" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">r</mi></mrow><mo id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.1" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l6.m1.3.3.1.1.1.1.2.2.3" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.3.cmml">ϵ</mi></msup><mo stretchy="false" id="alg1.l6.m1.3.3.1.1.1.1.2.7" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l6.m1.3.3.1.1.1.3" xref="alg1.l6.m1.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><ci id="alg1.l6.m1.3.3.2.cmml" xref="alg1.l6.m1.3.3.2">←</ci><apply id="alg1.l6.m1.3.3.3.cmml" xref="alg1.l6.m1.3.3.3"><ci id="alg1.l6.m1.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.1">^</ci><ci id="alg1.l6.m1.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.2">𝒟</ci></apply><apply id="alg1.l6.m1.3.3.1.cmml" xref="alg1.l6.m1.3.3.1"><union id="alg1.l6.m1.3.3.1.2.cmml" xref="alg1.l6.m1.3.3.1.2"></union><apply id="alg1.l6.m1.3.3.1.3.cmml" xref="alg1.l6.m1.3.3.1.3"><ci id="alg1.l6.m1.3.3.1.3.1.cmml" xref="alg1.l6.m1.3.3.1.3.1">^</ci><ci id="alg1.l6.m1.3.3.1.3.2.cmml" xref="alg1.l6.m1.3.3.1.3.2">𝒟</ci></apply><set id="alg1.l6.m1.3.3.1.1.2.cmml" xref="alg1.l6.m1.3.3.1.1.1"><vector id="alg1.l6.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">^</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑚</ci></apply><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1">^</ci><ci id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2">𝑧</ci></apply><apply id="alg1.l6.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2"><ci id="alg1.l6.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l6.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.2.2">𝑧</ci></apply><ci id="alg1.l6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.1.1.3">italic-ϵ</ci></apply><apply id="alg1.l6.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.1.1.1.1.2.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2">superscript</csymbol><apply id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2"><ci id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.1">^</ci><apply id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2"><times id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.1"></times><ci id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.2">𝑡</ci><ci id="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.2.2.3">𝑟</ci></apply></apply><ci id="alg1.l6.m1.3.3.1.1.1.1.2.2.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2.2.3">italic-ϵ</ci></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">\hat{\mathcal{D}}\leftarrow\hat{\mathcal{D}}\cup\{(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}^{\epsilon},\hat{tr}^{\epsilon})\}</annotation></semantics></math> <span id="alg1.l6.1" class="ltx_text" style="float:right;"><math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation></semantics></math> Reuse past generated data
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7.m1.4" class="ltx_Math" alttext="(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}},\hat{tr})\in\hat{\mathcal{D}}" display="inline"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.5" xref="alg1.l7.m1.4.5.cmml"><mrow id="alg1.l7.m1.4.5.2.2" xref="alg1.l7.m1.4.5.2.1.cmml"><mo stretchy="false" id="alg1.l7.m1.4.5.2.2.1" xref="alg1.l7.m1.4.5.2.1.cmml">(</mo><mover accent="true" id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">m</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l7.m1.4.5.2.2.2" xref="alg1.l7.m1.4.5.2.1.cmml">,</mo><mover accent="true" id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mi mathcolor="#0AA344" id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml">z</mi><mo id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml">^</mo></mover><mo id="alg1.l7.m1.4.5.2.2.3" xref="alg1.l7.m1.4.5.2.1.cmml">,</mo><mover accent="true" id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><mi mathcolor="#C93756" id="alg1.l7.m1.3.3.2" xref="alg1.l7.m1.3.3.2.cmml">z</mi><mo id="alg1.l7.m1.3.3.1" xref="alg1.l7.m1.3.3.1.cmml">^</mo></mover><mo id="alg1.l7.m1.4.5.2.2.4" xref="alg1.l7.m1.4.5.2.1.cmml">,</mo><mover accent="true" id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml"><mrow id="alg1.l7.m1.4.4.2" xref="alg1.l7.m1.4.4.2.cmml"><mi id="alg1.l7.m1.4.4.2.2" xref="alg1.l7.m1.4.4.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.4.4.2.1" xref="alg1.l7.m1.4.4.2.1.cmml">​</mo><mi id="alg1.l7.m1.4.4.2.3" xref="alg1.l7.m1.4.4.2.3.cmml">r</mi></mrow><mo id="alg1.l7.m1.4.4.1" xref="alg1.l7.m1.4.4.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l7.m1.4.5.2.2.5" xref="alg1.l7.m1.4.5.2.1.cmml">)</mo></mrow><mo id="alg1.l7.m1.4.5.1" xref="alg1.l7.m1.4.5.1.cmml">∈</mo><mover accent="true" id="alg1.l7.m1.4.5.3" xref="alg1.l7.m1.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.4.5.3.2" xref="alg1.l7.m1.4.5.3.2.cmml">𝒟</mi><mo id="alg1.l7.m1.4.5.3.1" xref="alg1.l7.m1.4.5.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.5.cmml" xref="alg1.l7.m1.4.5"><in id="alg1.l7.m1.4.5.1.cmml" xref="alg1.l7.m1.4.5.1"></in><vector id="alg1.l7.m1.4.5.2.1.cmml" xref="alg1.l7.m1.4.5.2.2"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">^</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑚</ci></apply><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1">^</ci><ci id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2">𝑧</ci></apply><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.1.cmml" xref="alg1.l7.m1.3.3.1">^</ci><ci id="alg1.l7.m1.3.3.2.cmml" xref="alg1.l7.m1.3.3.2">𝑧</ci></apply><apply id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4"><ci id="alg1.l7.m1.4.4.1.cmml" xref="alg1.l7.m1.4.4.1">^</ci><apply id="alg1.l7.m1.4.4.2.cmml" xref="alg1.l7.m1.4.4.2"><times id="alg1.l7.m1.4.4.2.1.cmml" xref="alg1.l7.m1.4.4.2.1"></times><ci id="alg1.l7.m1.4.4.2.2.cmml" xref="alg1.l7.m1.4.4.2.2">𝑡</ci><ci id="alg1.l7.m1.4.4.2.3.cmml" xref="alg1.l7.m1.4.4.2.3">𝑟</ci></apply></apply></vector><apply id="alg1.l7.m1.4.5.3.cmml" xref="alg1.l7.m1.4.5.3"><ci id="alg1.l7.m1.4.5.3.1.cmml" xref="alg1.l7.m1.4.5.3.1">^</ci><ci id="alg1.l7.m1.4.5.3.2.cmml" xref="alg1.l7.m1.4.5.3.2">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}},\hat{tr})\in\hat{\mathcal{D}}</annotation></semantics></math>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>         <math id="alg1.l8.m1.4" class="ltx_Math" alttext="\hat{s}\leftarrow(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}_{0...T-1},\hat{tr}_{0...T-1})" display="inline"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml"><mover accent="true" id="alg1.l8.m1.4.4.4" xref="alg1.l8.m1.4.4.4.cmml"><mi id="alg1.l8.m1.4.4.4.2" xref="alg1.l8.m1.4.4.4.2.cmml">s</mi><mo id="alg1.l8.m1.4.4.4.1" xref="alg1.l8.m1.4.4.4.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l8.m1.4.4.3" xref="alg1.l8.m1.4.4.3.cmml">←</mo><mrow id="alg1.l8.m1.4.4.2.2" xref="alg1.l8.m1.4.4.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.4.4.2.2.3" xref="alg1.l8.m1.4.4.2.3.cmml">(</mo><mover accent="true" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">m</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l8.m1.4.4.2.2.4" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><mover accent="true" id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mi mathcolor="#0AA344" id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">z</mi><mo id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.1.cmml">^</mo></mover><mo id="alg1.l8.m1.4.4.2.2.5" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l8.m1.3.3.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.cmml"><mover accent="true" id="alg1.l8.m1.3.3.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.2.cmml"><mi mathcolor="#C93756" id="alg1.l8.m1.3.3.1.1.1.2.2" xref="alg1.l8.m1.3.3.1.1.1.2.2.cmml">z</mi><mo id="alg1.l8.m1.3.3.1.1.1.2.1" xref="alg1.l8.m1.3.3.1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l8.m1.3.3.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.3.cmml"><mrow id="alg1.l8.m1.3.3.1.1.1.3.2" xref="alg1.l8.m1.3.3.1.1.1.3.2.cmml"><mn id="alg1.l8.m1.3.3.1.1.1.3.2.2" xref="alg1.l8.m1.3.3.1.1.1.3.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.1.1.1.3.2.1" xref="alg1.l8.m1.3.3.1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l8.m1.3.3.1.1.1.3.2.3" xref="alg1.l8.m1.3.3.1.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.1.1.1.3.2.1a" xref="alg1.l8.m1.3.3.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.l8.m1.3.3.1.1.1.3.2.4" xref="alg1.l8.m1.3.3.1.1.1.3.2.4.cmml">T</mi></mrow><mo id="alg1.l8.m1.3.3.1.1.1.3.1" xref="alg1.l8.m1.3.3.1.1.1.3.1.cmml">−</mo><mn id="alg1.l8.m1.3.3.1.1.1.3.3" xref="alg1.l8.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l8.m1.4.4.2.2.6" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.cmml"><mover accent="true" id="alg1.l8.m1.4.4.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.2.2.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l8.m1.4.4.2.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.3.cmml">r</mi></mrow><mo id="alg1.l8.m1.4.4.2.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l8.m1.4.4.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.3.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.3.2" xref="alg1.l8.m1.4.4.2.2.2.3.2.cmml"><mn id="alg1.l8.m1.4.4.2.2.2.3.2.2" xref="alg1.l8.m1.4.4.2.2.2.3.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.2.2.2.3.2.1" xref="alg1.l8.m1.4.4.2.2.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l8.m1.4.4.2.2.2.3.2.3" xref="alg1.l8.m1.4.4.2.2.2.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.2.2.2.3.2.1a" xref="alg1.l8.m1.4.4.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.l8.m1.4.4.2.2.2.3.2.4" xref="alg1.l8.m1.4.4.2.2.2.3.2.4.cmml">T</mi></mrow><mo id="alg1.l8.m1.4.4.2.2.2.3.1" xref="alg1.l8.m1.4.4.2.2.2.3.1.cmml">−</mo><mn id="alg1.l8.m1.4.4.2.2.2.3.3" xref="alg1.l8.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l8.m1.4.4.2.2.7" xref="alg1.l8.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4"><ci id="alg1.l8.m1.4.4.3.cmml" xref="alg1.l8.m1.4.4.3">←</ci><apply id="alg1.l8.m1.4.4.4.cmml" xref="alg1.l8.m1.4.4.4"><ci id="alg1.l8.m1.4.4.4.1.cmml" xref="alg1.l8.m1.4.4.4.1">^</ci><ci id="alg1.l8.m1.4.4.4.2.cmml" xref="alg1.l8.m1.4.4.4.2">𝑠</ci></apply><vector id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.2"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">^</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑚</ci></apply><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.1.cmml" xref="alg1.l8.m1.2.2.1">^</ci><ci id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2">𝑧</ci></apply><apply id="alg1.l8.m1.3.3.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1">subscript</csymbol><apply id="alg1.l8.m1.3.3.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.2"><ci id="alg1.l8.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.2.1">^</ci><ci id="alg1.l8.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.2.2">𝑧</ci></apply><apply id="alg1.l8.m1.3.3.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.3"><minus id="alg1.l8.m1.3.3.1.1.1.3.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.1"></minus><apply id="alg1.l8.m1.3.3.1.1.1.3.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.2"><times id="alg1.l8.m1.3.3.1.1.1.3.2.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.2.1"></times><cn type="integer" id="alg1.l8.m1.3.3.1.1.1.3.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.2.2">0</cn><ci id="alg1.l8.m1.3.3.1.1.1.3.2.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.2.3">…</ci><ci id="alg1.l8.m1.3.3.1.1.1.3.2.4.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.2.4">𝑇</ci></apply><cn type="integer" id="alg1.l8.m1.3.3.1.1.1.3.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l8.m1.4.4.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2">subscript</csymbol><apply id="alg1.l8.m1.4.4.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2"><ci id="alg1.l8.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1">^</ci><apply id="alg1.l8.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2"><times id="alg1.l8.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1"></times><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2">𝑡</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.3">𝑟</ci></apply></apply><apply id="alg1.l8.m1.4.4.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.3"><minus id="alg1.l8.m1.4.4.2.2.2.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.1"></minus><apply id="alg1.l8.m1.4.4.2.2.2.3.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.2"><times id="alg1.l8.m1.4.4.2.2.2.3.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.2.1"></times><cn type="integer" id="alg1.l8.m1.4.4.2.2.2.3.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.2.2">0</cn><ci id="alg1.l8.m1.4.4.2.2.2.3.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.2.3">…</ci><ci id="alg1.l8.m1.4.4.2.2.2.3.2.4.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.2.4">𝑇</ci></apply><cn type="integer" id="alg1.l8.m1.4.4.2.2.2.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">\hat{s}\leftarrow(\hat{m},\hat{\color[rgb]{0.0390625,0.640625,0.265625}\definecolor[named]{pgfstrokecolor}{rgb}{0.0390625,0.640625,0.265625}{z}},\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}_{0...T-1},\hat{tr}_{0...T-1})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>         <math id="alg1.l9.m1.2" class="ltx_Math" alttext="\hat{a}\leftarrow(\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}_{1...T},\hat{tr}_{1...T})" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><mover accent="true" id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"><mi id="alg1.l9.m1.2.2.4.2" xref="alg1.l9.m1.2.2.4.2.cmml">a</mi><mo id="alg1.l9.m1.2.2.4.1" xref="alg1.l9.m1.2.2.4.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml">←</mo><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml"><mi mathcolor="#C93756" id="alg1.l9.m1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.2.2.cmml">z</mi><mo id="alg1.l9.m1.1.1.1.1.1.2.1" xref="alg1.l9.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml"><mn id="alg1.l9.m1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l9.m1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.1.1.3.1a" xref="alg1.l9.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.1.1.1.3.4" xref="alg1.l9.m1.1.1.1.1.1.3.4.cmml">T</mi></mrow></msub><mo id="alg1.l9.m1.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml"><mrow id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l9.m1.2.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.2.3.cmml">r</mi></mrow><mo id="alg1.l9.m1.2.2.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l9.m1.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.3.cmml"><mn id="alg1.l9.m1.2.2.2.2.2.3.2" xref="alg1.l9.m1.2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.2.2.3.1" xref="alg1.l9.m1.2.2.2.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l9.m1.2.2.2.2.2.3.3" xref="alg1.l9.m1.2.2.2.2.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.2.2.3.1a" xref="alg1.l9.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.2.2.2.2.2.3.4" xref="alg1.l9.m1.2.2.2.2.2.3.4.cmml">T</mi></mrow></msub><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.5" xref="alg1.l9.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><ci id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3">←</ci><apply id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4"><ci id="alg1.l9.m1.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.4.1">^</ci><ci id="alg1.l9.m1.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.4.2">𝑎</ci></apply><interval closure="open" id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2"><ci id="alg1.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.2">𝑧</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3"><times id="alg1.l9.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.1"></times><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.2">1</cn><ci id="alg1.l9.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.3">…</ci><ci id="alg1.l9.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.4">𝑇</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><ci id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.1">^</ci><apply id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2"><times id="alg1.l9.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.1"></times><ci id="alg1.l9.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.2">𝑡</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.3">𝑟</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3"><times id="alg1.l9.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.1"></times><cn type="integer" id="alg1.l9.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.2">1</cn><ci id="alg1.l9.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.3">…</ci><ci id="alg1.l9.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l9.m1.2.2.2.2.2.3.4">𝑇</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\hat{a}\leftarrow(\hat{\color[rgb]{0.7890625,0.21484375,0.3359375}\definecolor[named]{pgfstrokecolor}{rgb}{0.7890625,0.21484375,0.3359375}{z}}_{1...T},\hat{tr}_{1...T})</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>         Compute <math id="alg1.l10.m1.1" class="ltx_Math" alttext="r_{1...T}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">r</mi><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mn id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1a" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.3.4" xref="alg1.l10.m1.1.1.3.4.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑟</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><cn type="integer" id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">1</cn><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">…</ci><ci id="alg1.l10.m1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">r_{1...T}</annotation></semantics></math> as described in Sec. 3.3

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>         Compute <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\mathcal{L}^{\text{off}}_{RL}" display="inline"><semantics id="alg1.l11.m1.1a"><msubsup id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">ℒ</mi><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">L</mi></mrow><mtext id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3a.cmml">off</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">ℒ</ci><ci id="alg1.l11.m1.1.1.2.3a.cmml" xref="alg1.l11.m1.1.1.2.3"><mtext mathsize="70%" id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">off</mtext></ci></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><times id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></times><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑅</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{L}^{\text{off}}_{RL}</annotation></semantics></math> by Eq. (4) (main paper)

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\theta\leftarrow\theta-\nabla_{\theta}L^{\text{off}}_{RL}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">θ</mi><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">θ</mi><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><msub id="alg1.l12.m1.1.1.3.3.1" xref="alg1.l12.m1.1.1.3.3.1.cmml"><mo rspace="0.167em" id="alg1.l12.m1.1.1.3.3.1.2" xref="alg1.l12.m1.1.1.3.3.1.2.cmml">∇</mo><mi id="alg1.l12.m1.1.1.3.3.1.3" xref="alg1.l12.m1.1.1.3.3.1.3.cmml">θ</mi></msub><msubsup id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.3.2.2.2" xref="alg1.l12.m1.1.1.3.3.2.2.2.cmml">L</mi><mrow id="alg1.l12.m1.1.1.3.3.2.3" xref="alg1.l12.m1.1.1.3.3.2.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2.3.2" xref="alg1.l12.m1.1.1.3.3.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.3.2.3.1" xref="alg1.l12.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="alg1.l12.m1.1.1.3.3.2.3.3" xref="alg1.l12.m1.1.1.3.3.2.3.3.cmml">L</mi></mrow><mtext id="alg1.l12.m1.1.1.3.3.2.2.3" xref="alg1.l12.m1.1.1.3.3.2.2.3a.cmml">off</mtext></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝜃</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><minus id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></minus><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝜃</ci><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><apply id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.1.cmml" xref="alg1.l12.m1.1.1.3.3.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.1.2.cmml" xref="alg1.l12.m1.1.1.3.3.1.2">∇</ci><ci id="alg1.l12.m1.1.1.3.3.1.3.cmml" xref="alg1.l12.m1.1.1.3.3.1.3">𝜃</ci></apply><apply id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2">subscript</csymbol><apply id="alg1.l12.m1.1.1.3.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.2.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2">superscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.2">𝐿</ci><ci id="alg1.l12.m1.1.1.3.3.2.2.3a.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.3"><mtext mathsize="70%" id="alg1.l12.m1.1.1.3.3.2.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.3">off</mtext></ci></apply><apply id="alg1.l12.m1.1.1.3.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.3"><times id="alg1.l12.m1.1.1.3.3.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.1"></times><ci id="alg1.l12.m1.1.1.3.3.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.2">𝑅</ci><ci id="alg1.l12.m1.1.1.3.3.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.3">𝐿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\theta\leftarrow\theta-\nabla_{\theta}L^{\text{off}}_{RL}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <math id="alg1.l14.m1.1" class="ltx_Math" alttext="\epsilon\leftarrow\epsilon+1" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">ϵ</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">ϵ</mi><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">italic-ϵ</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><plus id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></plus><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">italic-ϵ</ci><cn type="integer" id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\epsilon\leftarrow\epsilon+1</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span><span id="alg1.l15.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
<div id="A3.SS1.p5" class="ltx_para ltx_noindent">
<p id="A3.SS1.p5.4" class="ltx_p">One approach to maximize <math id="A3.SS1.p5.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A3.SS1.p5.1.m1.1a"><mi id="A3.SS1.p5.1.m1.1.1" xref="A3.SS1.p5.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.1.m1.1b"><ci id="A3.SS1.p5.1.m1.1.1.cmml" xref="A3.SS1.p5.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.1.m1.1c">J</annotation></semantics></math> is to optimize the network weight <math id="A3.SS1.p5.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.SS1.p5.2.m2.1a"><mi id="A3.SS1.p5.2.m2.1.1" xref="A3.SS1.p5.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.2.m2.1b"><ci id="A3.SS1.p5.2.m2.1.1.cmml" xref="A3.SS1.p5.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.2.m2.1c">\theta</annotation></semantics></math> along the gradient <math id="A3.SS1.p5.3.m3.1" class="ltx_Math" alttext="{\nabla_{\theta}}J" display="inline"><semantics id="A3.SS1.p5.3.m3.1a"><mrow id="A3.SS1.p5.3.m3.1.1" xref="A3.SS1.p5.3.m3.1.1.cmml"><msub id="A3.SS1.p5.3.m3.1.1.1" xref="A3.SS1.p5.3.m3.1.1.1.cmml"><mo id="A3.SS1.p5.3.m3.1.1.1.2" xref="A3.SS1.p5.3.m3.1.1.1.2.cmml">∇</mo><mi id="A3.SS1.p5.3.m3.1.1.1.3" xref="A3.SS1.p5.3.m3.1.1.1.3.cmml">θ</mi></msub><mi id="A3.SS1.p5.3.m3.1.1.2" xref="A3.SS1.p5.3.m3.1.1.2.cmml">J</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.3.m3.1b"><apply id="A3.SS1.p5.3.m3.1.1.cmml" xref="A3.SS1.p5.3.m3.1.1"><apply id="A3.SS1.p5.3.m3.1.1.1.cmml" xref="A3.SS1.p5.3.m3.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p5.3.m3.1.1.1.1.cmml" xref="A3.SS1.p5.3.m3.1.1.1">subscript</csymbol><ci id="A3.SS1.p5.3.m3.1.1.1.2.cmml" xref="A3.SS1.p5.3.m3.1.1.1.2">∇</ci><ci id="A3.SS1.p5.3.m3.1.1.1.3.cmml" xref="A3.SS1.p5.3.m3.1.1.1.3">𝜃</ci></apply><ci id="A3.SS1.p5.3.m3.1.1.2.cmml" xref="A3.SS1.p5.3.m3.1.1.2">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.3.m3.1c">{\nabla_{\theta}}J</annotation></semantics></math> as <math id="A3.SS1.p5.4.m4.1" class="ltx_Math" alttext="\theta\leftarrow\theta+\alpha{\nabla_{\theta}}J" display="inline"><semantics id="A3.SS1.p5.4.m4.1a"><mrow id="A3.SS1.p5.4.m4.1.1" xref="A3.SS1.p5.4.m4.1.1.cmml"><mi id="A3.SS1.p5.4.m4.1.1.2" xref="A3.SS1.p5.4.m4.1.1.2.cmml">θ</mi><mo stretchy="false" id="A3.SS1.p5.4.m4.1.1.1" xref="A3.SS1.p5.4.m4.1.1.1.cmml">←</mo><mrow id="A3.SS1.p5.4.m4.1.1.3" xref="A3.SS1.p5.4.m4.1.1.3.cmml"><mi id="A3.SS1.p5.4.m4.1.1.3.2" xref="A3.SS1.p5.4.m4.1.1.3.2.cmml">θ</mi><mo id="A3.SS1.p5.4.m4.1.1.3.1" xref="A3.SS1.p5.4.m4.1.1.3.1.cmml">+</mo><mrow id="A3.SS1.p5.4.m4.1.1.3.3" xref="A3.SS1.p5.4.m4.1.1.3.3.cmml"><mi id="A3.SS1.p5.4.m4.1.1.3.3.2" xref="A3.SS1.p5.4.m4.1.1.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="A3.SS1.p5.4.m4.1.1.3.3.1" xref="A3.SS1.p5.4.m4.1.1.3.3.1.cmml">​</mo><mrow id="A3.SS1.p5.4.m4.1.1.3.3.3" xref="A3.SS1.p5.4.m4.1.1.3.3.3.cmml"><msub id="A3.SS1.p5.4.m4.1.1.3.3.3.1" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="A3.SS1.p5.4.m4.1.1.3.3.3.1.2" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1.2.cmml">∇</mo><mi id="A3.SS1.p5.4.m4.1.1.3.3.3.1.3" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1.3.cmml">θ</mi></msub><mi id="A3.SS1.p5.4.m4.1.1.3.3.3.2" xref="A3.SS1.p5.4.m4.1.1.3.3.3.2.cmml">J</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.4.m4.1b"><apply id="A3.SS1.p5.4.m4.1.1.cmml" xref="A3.SS1.p5.4.m4.1.1"><ci id="A3.SS1.p5.4.m4.1.1.1.cmml" xref="A3.SS1.p5.4.m4.1.1.1">←</ci><ci id="A3.SS1.p5.4.m4.1.1.2.cmml" xref="A3.SS1.p5.4.m4.1.1.2">𝜃</ci><apply id="A3.SS1.p5.4.m4.1.1.3.cmml" xref="A3.SS1.p5.4.m4.1.1.3"><plus id="A3.SS1.p5.4.m4.1.1.3.1.cmml" xref="A3.SS1.p5.4.m4.1.1.3.1"></plus><ci id="A3.SS1.p5.4.m4.1.1.3.2.cmml" xref="A3.SS1.p5.4.m4.1.1.3.2">𝜃</ci><apply id="A3.SS1.p5.4.m4.1.1.3.3.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3"><times id="A3.SS1.p5.4.m4.1.1.3.3.1.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.1"></times><ci id="A3.SS1.p5.4.m4.1.1.3.3.2.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.2">𝛼</ci><apply id="A3.SS1.p5.4.m4.1.1.3.3.3.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3"><apply id="A3.SS1.p5.4.m4.1.1.3.3.3.1.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1"><csymbol cd="ambiguous" id="A3.SS1.p5.4.m4.1.1.3.3.3.1.1.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1">subscript</csymbol><ci id="A3.SS1.p5.4.m4.1.1.3.3.3.1.2.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1.2">∇</ci><ci id="A3.SS1.p5.4.m4.1.1.3.3.3.1.3.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3.1.3">𝜃</ci></apply><ci id="A3.SS1.p5.4.m4.1.1.3.3.3.2.cmml" xref="A3.SS1.p5.4.m4.1.1.3.3.3.2">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.4.m4.1c">\theta\leftarrow\theta+\alpha{\nabla_{\theta}}J</annotation></semantics></math>.
Since</p>
<table id="A3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E10.m1.1" class="ltx_Math" alttext="{\nabla_{\theta}}\pi_{\theta}=\pi_{\theta}\frac{{\nabla_{\theta}}\pi_{\theta}}{\pi_{\theta}}=\pi_{\theta}{\nabla_{\theta}}\log\pi_{\theta}," display="block"><semantics id="A3.E10.m1.1a"><mrow id="A3.E10.m1.1.1.1" xref="A3.E10.m1.1.1.1.1.cmml"><mrow id="A3.E10.m1.1.1.1.1" xref="A3.E10.m1.1.1.1.1.cmml"><mrow id="A3.E10.m1.1.1.1.1.2" xref="A3.E10.m1.1.1.1.1.2.cmml"><msub id="A3.E10.m1.1.1.1.1.2.1" xref="A3.E10.m1.1.1.1.1.2.1.cmml"><mo id="A3.E10.m1.1.1.1.1.2.1.2" xref="A3.E10.m1.1.1.1.1.2.1.2.cmml">∇</mo><mi id="A3.E10.m1.1.1.1.1.2.1.3" xref="A3.E10.m1.1.1.1.1.2.1.3.cmml">θ</mi></msub><msub id="A3.E10.m1.1.1.1.1.2.2" xref="A3.E10.m1.1.1.1.1.2.2.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.2" xref="A3.E10.m1.1.1.1.1.2.2.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.2.2.3" xref="A3.E10.m1.1.1.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo id="A3.E10.m1.1.1.1.1.3" xref="A3.E10.m1.1.1.1.1.3.cmml">=</mo><mrow id="A3.E10.m1.1.1.1.1.4" xref="A3.E10.m1.1.1.1.1.4.cmml"><msub id="A3.E10.m1.1.1.1.1.4.2" xref="A3.E10.m1.1.1.1.1.4.2.cmml"><mi id="A3.E10.m1.1.1.1.1.4.2.2" xref="A3.E10.m1.1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.4.2.3" xref="A3.E10.m1.1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E10.m1.1.1.1.1.4.1" xref="A3.E10.m1.1.1.1.1.4.1.cmml">​</mo><mfrac id="A3.E10.m1.1.1.1.1.4.3" xref="A3.E10.m1.1.1.1.1.4.3.cmml"><mrow id="A3.E10.m1.1.1.1.1.4.3.2" xref="A3.E10.m1.1.1.1.1.4.3.2.cmml"><msub id="A3.E10.m1.1.1.1.1.4.3.2.1" xref="A3.E10.m1.1.1.1.1.4.3.2.1.cmml"><mo id="A3.E10.m1.1.1.1.1.4.3.2.1.2" xref="A3.E10.m1.1.1.1.1.4.3.2.1.2.cmml">∇</mo><mi id="A3.E10.m1.1.1.1.1.4.3.2.1.3" xref="A3.E10.m1.1.1.1.1.4.3.2.1.3.cmml">θ</mi></msub><msub id="A3.E10.m1.1.1.1.1.4.3.2.2" xref="A3.E10.m1.1.1.1.1.4.3.2.2.cmml"><mi id="A3.E10.m1.1.1.1.1.4.3.2.2.2" xref="A3.E10.m1.1.1.1.1.4.3.2.2.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.4.3.2.2.3" xref="A3.E10.m1.1.1.1.1.4.3.2.2.3.cmml">θ</mi></msub></mrow><msub id="A3.E10.m1.1.1.1.1.4.3.3" xref="A3.E10.m1.1.1.1.1.4.3.3.cmml"><mi id="A3.E10.m1.1.1.1.1.4.3.3.2" xref="A3.E10.m1.1.1.1.1.4.3.3.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.4.3.3.3" xref="A3.E10.m1.1.1.1.1.4.3.3.3.cmml">θ</mi></msub></mfrac></mrow><mo id="A3.E10.m1.1.1.1.1.5" xref="A3.E10.m1.1.1.1.1.5.cmml">=</mo><mrow id="A3.E10.m1.1.1.1.1.6" xref="A3.E10.m1.1.1.1.1.6.cmml"><msub id="A3.E10.m1.1.1.1.1.6.2" xref="A3.E10.m1.1.1.1.1.6.2.cmml"><mi id="A3.E10.m1.1.1.1.1.6.2.2" xref="A3.E10.m1.1.1.1.1.6.2.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.6.2.3" xref="A3.E10.m1.1.1.1.1.6.2.3.cmml">θ</mi></msub><mo lspace="0.167em" rspace="0em" id="A3.E10.m1.1.1.1.1.6.1" xref="A3.E10.m1.1.1.1.1.6.1.cmml">​</mo><mrow id="A3.E10.m1.1.1.1.1.6.3" xref="A3.E10.m1.1.1.1.1.6.3.cmml"><mrow id="A3.E10.m1.1.1.1.1.6.3.1" xref="A3.E10.m1.1.1.1.1.6.3.1.cmml"><msub id="A3.E10.m1.1.1.1.1.6.3.1.1" xref="A3.E10.m1.1.1.1.1.6.3.1.1.cmml"><mo rspace="0.167em" id="A3.E10.m1.1.1.1.1.6.3.1.1.2" xref="A3.E10.m1.1.1.1.1.6.3.1.1.2.cmml">∇</mo><mi id="A3.E10.m1.1.1.1.1.6.3.1.1.3" xref="A3.E10.m1.1.1.1.1.6.3.1.1.3.cmml">θ</mi></msub><mi id="A3.E10.m1.1.1.1.1.6.3.1.2" xref="A3.E10.m1.1.1.1.1.6.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E10.m1.1.1.1.1.6.3a" xref="A3.E10.m1.1.1.1.1.6.3.cmml">⁡</mo><msub id="A3.E10.m1.1.1.1.1.6.3.2" xref="A3.E10.m1.1.1.1.1.6.3.2.cmml"><mi id="A3.E10.m1.1.1.1.1.6.3.2.2" xref="A3.E10.m1.1.1.1.1.6.3.2.2.cmml">π</mi><mi id="A3.E10.m1.1.1.1.1.6.3.2.3" xref="A3.E10.m1.1.1.1.1.6.3.2.3.cmml">θ</mi></msub></mrow></mrow></mrow><mo id="A3.E10.m1.1.1.1.2" xref="A3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E10.m1.1b"><apply id="A3.E10.m1.1.1.1.1.cmml" xref="A3.E10.m1.1.1.1"><and id="A3.E10.m1.1.1.1.1a.cmml" xref="A3.E10.m1.1.1.1"></and><apply id="A3.E10.m1.1.1.1.1b.cmml" xref="A3.E10.m1.1.1.1"><eq id="A3.E10.m1.1.1.1.1.3.cmml" xref="A3.E10.m1.1.1.1.1.3"></eq><apply id="A3.E10.m1.1.1.1.1.2.cmml" xref="A3.E10.m1.1.1.1.1.2"><apply id="A3.E10.m1.1.1.1.1.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.1.1.cmml" xref="A3.E10.m1.1.1.1.1.2.1">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.1.2.cmml" xref="A3.E10.m1.1.1.1.1.2.1.2">∇</ci><ci id="A3.E10.m1.1.1.1.1.2.1.3.cmml" xref="A3.E10.m1.1.1.1.1.2.1.3">𝜃</ci></apply><apply id="A3.E10.m1.1.1.1.1.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3">𝜃</ci></apply></apply><apply id="A3.E10.m1.1.1.1.1.4.cmml" xref="A3.E10.m1.1.1.1.1.4"><times id="A3.E10.m1.1.1.1.1.4.1.cmml" xref="A3.E10.m1.1.1.1.1.4.1"></times><apply id="A3.E10.m1.1.1.1.1.4.2.cmml" xref="A3.E10.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.4.2.1.cmml" xref="A3.E10.m1.1.1.1.1.4.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.4.2.2.cmml" xref="A3.E10.m1.1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.4.2.3.cmml" xref="A3.E10.m1.1.1.1.1.4.2.3">𝜃</ci></apply><apply id="A3.E10.m1.1.1.1.1.4.3.cmml" xref="A3.E10.m1.1.1.1.1.4.3"><divide id="A3.E10.m1.1.1.1.1.4.3.1.cmml" xref="A3.E10.m1.1.1.1.1.4.3"></divide><apply id="A3.E10.m1.1.1.1.1.4.3.2.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2"><apply id="A3.E10.m1.1.1.1.1.4.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.4.3.2.1.1.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.1">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.4.3.2.1.2.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.1.2">∇</ci><ci id="A3.E10.m1.1.1.1.1.4.3.2.1.3.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.1.3">𝜃</ci></apply><apply id="A3.E10.m1.1.1.1.1.4.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.4.3.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.4.3.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.2.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.4.3.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.4.3.2.2.3">𝜃</ci></apply></apply><apply id="A3.E10.m1.1.1.1.1.4.3.3.cmml" xref="A3.E10.m1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.4.3.3.1.cmml" xref="A3.E10.m1.1.1.1.1.4.3.3">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.4.3.3.2.cmml" xref="A3.E10.m1.1.1.1.1.4.3.3.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.4.3.3.3.cmml" xref="A3.E10.m1.1.1.1.1.4.3.3.3">𝜃</ci></apply></apply></apply></apply><apply id="A3.E10.m1.1.1.1.1c.cmml" xref="A3.E10.m1.1.1.1"><eq id="A3.E10.m1.1.1.1.1.5.cmml" xref="A3.E10.m1.1.1.1.1.5"></eq><share href="#A3.E10.m1.1.1.1.1.4.cmml" id="A3.E10.m1.1.1.1.1d.cmml" xref="A3.E10.m1.1.1.1"></share><apply id="A3.E10.m1.1.1.1.1.6.cmml" xref="A3.E10.m1.1.1.1.1.6"><times id="A3.E10.m1.1.1.1.1.6.1.cmml" xref="A3.E10.m1.1.1.1.1.6.1"></times><apply id="A3.E10.m1.1.1.1.1.6.2.cmml" xref="A3.E10.m1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.6.2.1.cmml" xref="A3.E10.m1.1.1.1.1.6.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.6.2.2.cmml" xref="A3.E10.m1.1.1.1.1.6.2.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.6.2.3.cmml" xref="A3.E10.m1.1.1.1.1.6.2.3">𝜃</ci></apply><apply id="A3.E10.m1.1.1.1.1.6.3.cmml" xref="A3.E10.m1.1.1.1.1.6.3"><apply id="A3.E10.m1.1.1.1.1.6.3.1.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1"><apply id="A3.E10.m1.1.1.1.1.6.3.1.1.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.6.3.1.1.1.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1.1">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.6.3.1.1.2.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1.1.2">∇</ci><ci id="A3.E10.m1.1.1.1.1.6.3.1.1.3.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1.1.3">𝜃</ci></apply><log id="A3.E10.m1.1.1.1.1.6.3.1.2.cmml" xref="A3.E10.m1.1.1.1.1.6.3.1.2"></log></apply><apply id="A3.E10.m1.1.1.1.1.6.3.2.cmml" xref="A3.E10.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.6.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.6.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.6.3.2.2">𝜋</ci><ci id="A3.E10.m1.1.1.1.1.6.3.2.3.cmml" xref="A3.E10.m1.1.1.1.1.6.3.2.3">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E10.m1.1c">{\nabla_{\theta}}\pi_{\theta}=\pi_{\theta}\frac{{\nabla_{\theta}}\pi_{\theta}}{\pi_{\theta}}=\pi_{\theta}{\nabla_{\theta}}\log\pi_{\theta},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p5.5" class="ltx_p">we can rewrite <math id="A3.SS1.p5.5.m1.1" class="ltx_Math" alttext="{\nabla_{\theta}}J" display="inline"><semantics id="A3.SS1.p5.5.m1.1a"><mrow id="A3.SS1.p5.5.m1.1.1" xref="A3.SS1.p5.5.m1.1.1.cmml"><msub id="A3.SS1.p5.5.m1.1.1.1" xref="A3.SS1.p5.5.m1.1.1.1.cmml"><mo id="A3.SS1.p5.5.m1.1.1.1.2" xref="A3.SS1.p5.5.m1.1.1.1.2.cmml">∇</mo><mi id="A3.SS1.p5.5.m1.1.1.1.3" xref="A3.SS1.p5.5.m1.1.1.1.3.cmml">θ</mi></msub><mi id="A3.SS1.p5.5.m1.1.1.2" xref="A3.SS1.p5.5.m1.1.1.2.cmml">J</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.5.m1.1b"><apply id="A3.SS1.p5.5.m1.1.1.cmml" xref="A3.SS1.p5.5.m1.1.1"><apply id="A3.SS1.p5.5.m1.1.1.1.cmml" xref="A3.SS1.p5.5.m1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p5.5.m1.1.1.1.1.cmml" xref="A3.SS1.p5.5.m1.1.1.1">subscript</csymbol><ci id="A3.SS1.p5.5.m1.1.1.1.2.cmml" xref="A3.SS1.p5.5.m1.1.1.1.2">∇</ci><ci id="A3.SS1.p5.5.m1.1.1.1.3.cmml" xref="A3.SS1.p5.5.m1.1.1.1.3">𝜃</ci></apply><ci id="A3.SS1.p5.5.m1.1.1.2.cmml" xref="A3.SS1.p5.5.m1.1.1.2">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.5.m1.1c">{\nabla_{\theta}}J</annotation></semantics></math> into</p>
<table id="A3.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A3.E11X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\nabla_{\theta}}J" display="inline"><semantics id="A3.E11X.2.1.1.m1.1a"><mrow id="A3.E11X.2.1.1.m1.1.1" xref="A3.E11X.2.1.1.m1.1.1.cmml"><msub id="A3.E11X.2.1.1.m1.1.1.1" xref="A3.E11X.2.1.1.m1.1.1.1.cmml"><mo id="A3.E11X.2.1.1.m1.1.1.1.2" xref="A3.E11X.2.1.1.m1.1.1.1.2.cmml">∇</mo><mi id="A3.E11X.2.1.1.m1.1.1.1.3" xref="A3.E11X.2.1.1.m1.1.1.1.3.cmml">θ</mi></msub><mi id="A3.E11X.2.1.1.m1.1.1.2" xref="A3.E11X.2.1.1.m1.1.1.2.cmml">J</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.E11X.2.1.1.m1.1b"><apply id="A3.E11X.2.1.1.m1.1.1.cmml" xref="A3.E11X.2.1.1.m1.1.1"><apply id="A3.E11X.2.1.1.m1.1.1.1.cmml" xref="A3.E11X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="A3.E11X.2.1.1.m1.1.1.1">subscript</csymbol><ci id="A3.E11X.2.1.1.m1.1.1.1.2.cmml" xref="A3.E11X.2.1.1.m1.1.1.1.2">∇</ci><ci id="A3.E11X.2.1.1.m1.1.1.1.3.cmml" xref="A3.E11X.2.1.1.m1.1.1.1.3">𝜃</ci></apply><ci id="A3.E11X.2.1.1.m1.1.1.2.cmml" xref="A3.E11X.2.1.1.m1.1.1.2">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11X.2.1.1.m1.1c">\displaystyle{\nabla_{\theta}}J</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E11X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\sum_{\tau}\nabla_{\theta}\pi_{\theta}(\tau)r(\tau)" display="inline"><semantics id="A3.E11X.3.2.2.m1.2a"><mrow id="A3.E11X.3.2.2.m1.2.3" xref="A3.E11X.3.2.2.m1.2.3.cmml"><mi id="A3.E11X.3.2.2.m1.2.3.2" xref="A3.E11X.3.2.2.m1.2.3.2.cmml"></mi><mo id="A3.E11X.3.2.2.m1.2.3.1" xref="A3.E11X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="A3.E11X.3.2.2.m1.2.3.3" xref="A3.E11X.3.2.2.m1.2.3.3.cmml"><mstyle displaystyle="true" id="A3.E11X.3.2.2.m1.2.3.3.1" xref="A3.E11X.3.2.2.m1.2.3.3.1.cmml"><munder id="A3.E11X.3.2.2.m1.2.3.3.1a" xref="A3.E11X.3.2.2.m1.2.3.3.1.cmml"><mo movablelimits="false" id="A3.E11X.3.2.2.m1.2.3.3.1.2" xref="A3.E11X.3.2.2.m1.2.3.3.1.2.cmml">∑</mo><mi id="A3.E11X.3.2.2.m1.2.3.3.1.3" xref="A3.E11X.3.2.2.m1.2.3.3.1.3.cmml">τ</mi></munder></mstyle><mrow id="A3.E11X.3.2.2.m1.2.3.3.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml"><mrow id="A3.E11X.3.2.2.m1.2.3.3.2.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.cmml"><msub id="A3.E11X.3.2.2.m1.2.3.3.2.2.1" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1.2.cmml">∇</mo><mi id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.3" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1.3.cmml">θ</mi></msub><msub id="A3.E11X.3.2.2.m1.2.3.3.2.2.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2.cmml"><mi id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2.2.cmml">π</mi><mi id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.3" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E11X.3.2.2.m1.2.3.3.2.1" xref="A3.E11X.3.2.2.m1.2.3.3.2.1.cmml">​</mo><mrow id="A3.E11X.3.2.2.m1.2.3.3.2.3.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml"><mo stretchy="false" id="A3.E11X.3.2.2.m1.2.3.3.2.3.2.1" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml">(</mo><mi id="A3.E11X.3.2.2.m1.1.1" xref="A3.E11X.3.2.2.m1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E11X.3.2.2.m1.2.3.3.2.3.2.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E11X.3.2.2.m1.2.3.3.2.1a" xref="A3.E11X.3.2.2.m1.2.3.3.2.1.cmml">​</mo><mi id="A3.E11X.3.2.2.m1.2.3.3.2.4" xref="A3.E11X.3.2.2.m1.2.3.3.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E11X.3.2.2.m1.2.3.3.2.1b" xref="A3.E11X.3.2.2.m1.2.3.3.2.1.cmml">​</mo><mrow id="A3.E11X.3.2.2.m1.2.3.3.2.5.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml"><mo stretchy="false" id="A3.E11X.3.2.2.m1.2.3.3.2.5.2.1" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml">(</mo><mi id="A3.E11X.3.2.2.m1.2.2" xref="A3.E11X.3.2.2.m1.2.2.cmml">τ</mi><mo stretchy="false" id="A3.E11X.3.2.2.m1.2.3.3.2.5.2.2" xref="A3.E11X.3.2.2.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E11X.3.2.2.m1.2b"><apply id="A3.E11X.3.2.2.m1.2.3.cmml" xref="A3.E11X.3.2.2.m1.2.3"><eq id="A3.E11X.3.2.2.m1.2.3.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="A3.E11X.3.2.2.m1.2.3.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.2">absent</csymbol><apply id="A3.E11X.3.2.2.m1.2.3.3.cmml" xref="A3.E11X.3.2.2.m1.2.3.3"><apply id="A3.E11X.3.2.2.m1.2.3.3.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.1"><csymbol cd="ambiguous" id="A3.E11X.3.2.2.m1.2.3.3.1.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.1">subscript</csymbol><sum id="A3.E11X.3.2.2.m1.2.3.3.1.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.1.2"></sum><ci id="A3.E11X.3.2.2.m1.2.3.3.1.3.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.1.3">𝜏</ci></apply><apply id="A3.E11X.3.2.2.m1.2.3.3.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2"><times id="A3.E11X.3.2.2.m1.2.3.3.2.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.1"></times><apply id="A3.E11X.3.2.2.m1.2.3.3.2.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2"><apply id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1"><csymbol cd="ambiguous" id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1">subscript</csymbol><ci id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1.2">∇</ci><ci id="A3.E11X.3.2.2.m1.2.3.3.2.2.1.3.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.1.3">𝜃</ci></apply><apply id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.1.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2">subscript</csymbol><ci id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.2.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2.2">𝜋</ci><ci id="A3.E11X.3.2.2.m1.2.3.3.2.2.2.3.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.2.2.3">𝜃</ci></apply></apply><ci id="A3.E11X.3.2.2.m1.1.1.cmml" xref="A3.E11X.3.2.2.m1.1.1">𝜏</ci><ci id="A3.E11X.3.2.2.m1.2.3.3.2.4.cmml" xref="A3.E11X.3.2.2.m1.2.3.3.2.4">𝑟</ci><ci id="A3.E11X.3.2.2.m1.2.2.cmml" xref="A3.E11X.3.2.2.m1.2.2">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11X.3.2.2.m1.2c">\displaystyle=\sum_{\tau}\nabla_{\theta}\pi_{\theta}(\tau)r(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
<tr id="A3.E11Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E11Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\sum_{\tau}\pi_{\theta}{\nabla_{\theta}}(\tau)\log\pi_{\theta}(\tau)r(\tau)" display="inline"><semantics id="A3.E11Xa.2.1.1.m1.4a"><mrow id="A3.E11Xa.2.1.1.m1.4.4" xref="A3.E11Xa.2.1.1.m1.4.4.cmml"><mi id="A3.E11Xa.2.1.1.m1.4.4.3" xref="A3.E11Xa.2.1.1.m1.4.4.3.cmml"></mi><mo id="A3.E11Xa.2.1.1.m1.4.4.2" xref="A3.E11Xa.2.1.1.m1.4.4.2.cmml">=</mo><mrow id="A3.E11Xa.2.1.1.m1.4.4.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.cmml"><mstyle displaystyle="true" id="A3.E11Xa.2.1.1.m1.4.4.1.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.cmml"><munder id="A3.E11Xa.2.1.1.m1.4.4.1.2a" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.cmml"><mo movablelimits="false" id="A3.E11Xa.2.1.1.m1.4.4.1.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.2.cmml">∑</mo><mi id="A3.E11Xa.2.1.1.m1.4.4.1.2.3" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.3.cmml">τ</mi></munder></mstyle><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml"><msub id="A3.E11Xa.2.1.1.m1.4.4.1.1.3" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3.cmml"><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3.2.cmml">π</mi><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.3" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3.3.cmml">θ</mi></msub><mo lspace="0.167em" rspace="0em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml">​</mo><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.cmml"><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml"><msub id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">∇</mo><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="A3.E11Xa.2.1.1.m1.1.1" xref="A3.E11Xa.2.1.1.m1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0.167em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1a" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.cmml">⁡</mo><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.cmml"><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2a" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.cmml">⁡</mo><msub id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.cmml"><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.2.cmml">π</mi><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.3" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.3.cmml">θ</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.2a" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml">​</mo><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.4.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml"><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.4.2.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml">(</mo><mi id="A3.E11Xa.2.1.1.m1.2.2" xref="A3.E11Xa.2.1.1.m1.2.2.cmml">τ</mi><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.4.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.2b" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml">​</mo><mi id="A3.E11Xa.2.1.1.m1.4.4.1.1.5" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E11Xa.2.1.1.m1.4.4.1.1.2c" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml">​</mo><mrow id="A3.E11Xa.2.1.1.m1.4.4.1.1.6.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml"><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.6.2.1" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml">(</mo><mi id="A3.E11Xa.2.1.1.m1.3.3" xref="A3.E11Xa.2.1.1.m1.3.3.cmml">τ</mi><mo stretchy="false" id="A3.E11Xa.2.1.1.m1.4.4.1.1.6.2.2" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E11Xa.2.1.1.m1.4b"><apply id="A3.E11Xa.2.1.1.m1.4.4.cmml" xref="A3.E11Xa.2.1.1.m1.4.4"><eq id="A3.E11Xa.2.1.1.m1.4.4.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.2"></eq><csymbol cd="latexml" id="A3.E11Xa.2.1.1.m1.4.4.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.3">absent</csymbol><apply id="A3.E11Xa.2.1.1.m1.4.4.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1"><apply id="A3.E11Xa.2.1.1.m1.4.4.1.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.2"><csymbol cd="ambiguous" id="A3.E11Xa.2.1.1.m1.4.4.1.2.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.2">subscript</csymbol><sum id="A3.E11Xa.2.1.1.m1.4.4.1.2.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.2"></sum><ci id="A3.E11Xa.2.1.1.m1.4.4.1.2.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.2.3">𝜏</ci></apply><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1"><times id="A3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.2"></times><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3">subscript</csymbol><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3.2">𝜋</ci><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.3.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.3.3">𝜃</ci></apply><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1"><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1"><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2">∇</ci><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="A3.E11Xa.2.1.1.m1.1.1.cmml" xref="A3.E11Xa.2.1.1.m1.1.1">𝜏</ci></apply><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2"><log id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.1"></log><apply id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.1.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2">subscript</csymbol><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.2.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.2">𝜋</ci><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.3.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.1.2.2.3">𝜃</ci></apply></apply></apply><ci id="A3.E11Xa.2.1.1.m1.2.2.cmml" xref="A3.E11Xa.2.1.1.m1.2.2">𝜏</ci><ci id="A3.E11Xa.2.1.1.m1.4.4.1.1.5.cmml" xref="A3.E11Xa.2.1.1.m1.4.4.1.1.5">𝑟</ci><ci id="A3.E11Xa.2.1.1.m1.3.3.cmml" xref="A3.E11Xa.2.1.1.m1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11Xa.2.1.1.m1.4c">\displaystyle=\sum_{\tau}\pi_{\theta}{\nabla_{\theta}}(\tau)\log\pi_{\theta}(\tau)r(\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A3.E11Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E11Xb.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[{\nabla_{\theta}}\log\pi_{\theta}(\tau)r(\tau)\right]." display="inline"><semantics id="A3.E11Xb.2.1.1.m1.4a"><mrow id="A3.E11Xb.2.1.1.m1.4.4.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.cmml"><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.cmml"><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.3" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.3.cmml"></mi><mo id="A3.E11Xb.2.1.1.m1.4.4.1.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.2.cmml">=</mo><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.cmml"><msub id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.cmml"><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.2.cmml">𝔼</mi><mrow id="A3.E11Xb.2.1.1.m1.1.1.1" xref="A3.E11Xb.2.1.1.m1.1.1.1.cmml"><mi id="A3.E11Xb.2.1.1.m1.1.1.1.3" xref="A3.E11Xb.2.1.1.m1.1.1.1.3.cmml">τ</mi><mo id="A3.E11Xb.2.1.1.m1.1.1.1.2" xref="A3.E11Xb.2.1.1.m1.1.1.1.2.cmml">∼</mo><mrow id="A3.E11Xb.2.1.1.m1.1.1.1.4" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.cmml"><msub id="A3.E11Xb.2.1.1.m1.1.1.1.4.2" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2.cmml"><mi id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.2" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.3" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E11Xb.2.1.1.m1.1.1.1.4.1" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.1.cmml">​</mo><mrow id="A3.E11Xb.2.1.1.m1.1.1.1.4.3.2" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.cmml"><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.1.1.1.4.3.2.1" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.cmml">(</mo><mi id="A3.E11Xb.2.1.1.m1.1.1.1.1" xref="A3.E11Xb.2.1.1.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.1.1.1.4.3.2.2" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.2.cmml"><mo id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml"><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.cmml"><msub id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.cmml"><mo rspace="0.167em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml">∇</mo><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.3" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.3.cmml">θ</mi></msub><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2a" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><msub id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">π</mi><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.3" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.3.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="A3.E11Xb.2.1.1.m1.2.2" xref="A3.E11Xb.2.1.1.m1.2.2.cmml">τ</mi><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1a" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml">​</mo><mi id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.4" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1b" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.5.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.5.2.1" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="A3.E11Xb.2.1.1.m1.3.3" xref="A3.E11Xb.2.1.1.m1.3.3.cmml">τ</mi><mo stretchy="false" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.5.2.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.3" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E11Xb.2.1.1.m1.4.4.1.2" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E11Xb.2.1.1.m1.4b"><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1"><eq id="A3.E11Xb.2.1.1.m1.4.4.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="A3.E11Xb.2.1.1.m1.4.4.1.1.3.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.3">absent</csymbol><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1"><times id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.2"></times><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.3.2">𝔼</ci><apply id="A3.E11Xb.2.1.1.m1.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1"><csymbol cd="latexml" id="A3.E11Xb.2.1.1.m1.1.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.2">similar-to</csymbol><ci id="A3.E11Xb.2.1.1.m1.1.1.1.3.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.3">𝜏</ci><apply id="A3.E11Xb.2.1.1.m1.1.1.1.4.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4"><times id="A3.E11Xb.2.1.1.m1.1.1.1.4.1.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.1"></times><apply id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.1.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2">subscript</csymbol><ci id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.2.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E11Xb.2.1.1.m1.1.1.1.4.2.3.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.E11Xb.2.1.1.m1.1.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1"><times id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.1"></times><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2"><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1"><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.2">∇</ci><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.3.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.1.3">𝜃</ci></apply><log id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.1.2"></log></apply><apply id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.2">𝜋</ci><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.2.2.3">𝜃</ci></apply></apply><ci id="A3.E11Xb.2.1.1.m1.2.2.cmml" xref="A3.E11Xb.2.1.1.m1.2.2">𝜏</ci><ci id="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.4.cmml" xref="A3.E11Xb.2.1.1.m1.4.4.1.1.1.1.1.1.4">𝑟</ci><ci id="A3.E11Xb.2.1.1.m1.3.3.cmml" xref="A3.E11Xb.2.1.1.m1.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11Xb.2.1.1.m1.4c">\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[{\nabla_{\theta}}\log\pi_{\theta}(\tau)r(\tau)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="A3.SS1.p5.6" class="ltx_p">Since <math id="A3.SS1.p5.6.m1.2" class="ltx_Math" alttext="\pi_{\theta}(\tau)=\prod_{t=0}^{T-1}\pi_{\theta}({a}_{t}|{s}_{t})" display="inline"><semantics id="A3.SS1.p5.6.m1.2a"><mrow id="A3.SS1.p5.6.m1.2.2" xref="A3.SS1.p5.6.m1.2.2.cmml"><mrow id="A3.SS1.p5.6.m1.2.2.3" xref="A3.SS1.p5.6.m1.2.2.3.cmml"><msub id="A3.SS1.p5.6.m1.2.2.3.2" xref="A3.SS1.p5.6.m1.2.2.3.2.cmml"><mi id="A3.SS1.p5.6.m1.2.2.3.2.2" xref="A3.SS1.p5.6.m1.2.2.3.2.2.cmml">π</mi><mi id="A3.SS1.p5.6.m1.2.2.3.2.3" xref="A3.SS1.p5.6.m1.2.2.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p5.6.m1.2.2.3.1" xref="A3.SS1.p5.6.m1.2.2.3.1.cmml">​</mo><mrow id="A3.SS1.p5.6.m1.2.2.3.3.2" xref="A3.SS1.p5.6.m1.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.p5.6.m1.2.2.3.3.2.1" xref="A3.SS1.p5.6.m1.2.2.3.cmml">(</mo><mi id="A3.SS1.p5.6.m1.1.1" xref="A3.SS1.p5.6.m1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.SS1.p5.6.m1.2.2.3.3.2.2" xref="A3.SS1.p5.6.m1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A3.SS1.p5.6.m1.2.2.2" xref="A3.SS1.p5.6.m1.2.2.2.cmml">=</mo><mrow id="A3.SS1.p5.6.m1.2.2.1" xref="A3.SS1.p5.6.m1.2.2.1.cmml"><msubsup id="A3.SS1.p5.6.m1.2.2.1.2" xref="A3.SS1.p5.6.m1.2.2.1.2.cmml"><mo id="A3.SS1.p5.6.m1.2.2.1.2.2.2" xref="A3.SS1.p5.6.m1.2.2.1.2.2.2.cmml">∏</mo><mrow id="A3.SS1.p5.6.m1.2.2.1.2.2.3" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.cmml"><mi id="A3.SS1.p5.6.m1.2.2.1.2.2.3.2" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.2.cmml">t</mi><mo id="A3.SS1.p5.6.m1.2.2.1.2.2.3.1" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="A3.SS1.p5.6.m1.2.2.1.2.2.3.3" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A3.SS1.p5.6.m1.2.2.1.2.3" xref="A3.SS1.p5.6.m1.2.2.1.2.3.cmml"><mi id="A3.SS1.p5.6.m1.2.2.1.2.3.2" xref="A3.SS1.p5.6.m1.2.2.1.2.3.2.cmml">T</mi><mo id="A3.SS1.p5.6.m1.2.2.1.2.3.1" xref="A3.SS1.p5.6.m1.2.2.1.2.3.1.cmml">−</mo><mn id="A3.SS1.p5.6.m1.2.2.1.2.3.3" xref="A3.SS1.p5.6.m1.2.2.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="A3.SS1.p5.6.m1.2.2.1.1" xref="A3.SS1.p5.6.m1.2.2.1.1.cmml"><msub id="A3.SS1.p5.6.m1.2.2.1.1.3" xref="A3.SS1.p5.6.m1.2.2.1.1.3.cmml"><mi id="A3.SS1.p5.6.m1.2.2.1.1.3.2" xref="A3.SS1.p5.6.m1.2.2.1.1.3.2.cmml">π</mi><mi id="A3.SS1.p5.6.m1.2.2.1.1.3.3" xref="A3.SS1.p5.6.m1.2.2.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p5.6.m1.2.2.1.1.2" xref="A3.SS1.p5.6.m1.2.2.1.1.2.cmml">​</mo><mrow id="A3.SS1.p5.6.m1.2.2.1.1.1.1" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.2" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.cmml"><msub id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.2" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.3" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.1" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.2" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.3" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.3" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p5.6.m1.2b"><apply id="A3.SS1.p5.6.m1.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2"><eq id="A3.SS1.p5.6.m1.2.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2.2"></eq><apply id="A3.SS1.p5.6.m1.2.2.3.cmml" xref="A3.SS1.p5.6.m1.2.2.3"><times id="A3.SS1.p5.6.m1.2.2.3.1.cmml" xref="A3.SS1.p5.6.m1.2.2.3.1"></times><apply id="A3.SS1.p5.6.m1.2.2.3.2.cmml" xref="A3.SS1.p5.6.m1.2.2.3.2"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.3.2.1.cmml" xref="A3.SS1.p5.6.m1.2.2.3.2">subscript</csymbol><ci id="A3.SS1.p5.6.m1.2.2.3.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2.3.2.2">𝜋</ci><ci id="A3.SS1.p5.6.m1.2.2.3.2.3.cmml" xref="A3.SS1.p5.6.m1.2.2.3.2.3">𝜃</ci></apply><ci id="A3.SS1.p5.6.m1.1.1.cmml" xref="A3.SS1.p5.6.m1.1.1">𝜏</ci></apply><apply id="A3.SS1.p5.6.m1.2.2.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1"><apply id="A3.SS1.p5.6.m1.2.2.1.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.1.2.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2">superscript</csymbol><apply id="A3.SS1.p5.6.m1.2.2.1.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.1.2.2.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="A3.SS1.p5.6.m1.2.2.1.2.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.2.2">product</csymbol><apply id="A3.SS1.p5.6.m1.2.2.1.2.2.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3"><eq id="A3.SS1.p5.6.m1.2.2.1.2.2.3.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.1"></eq><ci id="A3.SS1.p5.6.m1.2.2.1.2.2.3.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p5.6.m1.2.2.1.2.2.3.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.2.3.3">0</cn></apply></apply><apply id="A3.SS1.p5.6.m1.2.2.1.2.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.3"><minus id="A3.SS1.p5.6.m1.2.2.1.2.3.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.3.1"></minus><ci id="A3.SS1.p5.6.m1.2.2.1.2.3.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.3.2">𝑇</ci><cn type="integer" id="A3.SS1.p5.6.m1.2.2.1.2.3.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.2.3.3">1</cn></apply></apply><apply id="A3.SS1.p5.6.m1.2.2.1.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1"><times id="A3.SS1.p5.6.m1.2.2.1.1.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.2"></times><apply id="A3.SS1.p5.6.m1.2.2.1.1.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.1.1.3.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.3">subscript</csymbol><ci id="A3.SS1.p5.6.m1.2.2.1.1.3.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.3.2">𝜋</ci><ci id="A3.SS1.p5.6.m1.2.2.1.1.3.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.3.3">𝜃</ci></apply><apply id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A3.SS1.p5.6.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p5.6.m1.2c">\pi_{\theta}(\tau)=\prod_{t=0}^{T-1}\pi_{\theta}({a}_{t}|{s}_{t})</annotation></semantics></math>, we have</p>
<table id="A3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E12.m1.2" class="ltx_Math" alttext="\nabla_{\theta}\log\pi_{\theta}(\tau)=\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t})." display="block"><semantics id="A3.E12.m1.2a"><mrow id="A3.E12.m1.2.2.1" xref="A3.E12.m1.2.2.1.1.cmml"><mrow id="A3.E12.m1.2.2.1.1" xref="A3.E12.m1.2.2.1.1.cmml"><mrow id="A3.E12.m1.2.2.1.1.3" xref="A3.E12.m1.2.2.1.1.3.cmml"><mrow id="A3.E12.m1.2.2.1.1.3.2" xref="A3.E12.m1.2.2.1.1.3.2.cmml"><mrow id="A3.E12.m1.2.2.1.1.3.2.1" xref="A3.E12.m1.2.2.1.1.3.2.1.cmml"><msub id="A3.E12.m1.2.2.1.1.3.2.1.1" xref="A3.E12.m1.2.2.1.1.3.2.1.1.cmml"><mo id="A3.E12.m1.2.2.1.1.3.2.1.1.2" xref="A3.E12.m1.2.2.1.1.3.2.1.1.2.cmml">∇</mo><mi id="A3.E12.m1.2.2.1.1.3.2.1.1.3" xref="A3.E12.m1.2.2.1.1.3.2.1.1.3.cmml">θ</mi></msub><mi id="A3.E12.m1.2.2.1.1.3.2.1.2" xref="A3.E12.m1.2.2.1.1.3.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E12.m1.2.2.1.1.3.2a" xref="A3.E12.m1.2.2.1.1.3.2.cmml">⁡</mo><msub id="A3.E12.m1.2.2.1.1.3.2.2" xref="A3.E12.m1.2.2.1.1.3.2.2.cmml"><mi id="A3.E12.m1.2.2.1.1.3.2.2.2" xref="A3.E12.m1.2.2.1.1.3.2.2.2.cmml">π</mi><mi id="A3.E12.m1.2.2.1.1.3.2.2.3" xref="A3.E12.m1.2.2.1.1.3.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E12.m1.2.2.1.1.3.1" xref="A3.E12.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="A3.E12.m1.2.2.1.1.3.3.2" xref="A3.E12.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="A3.E12.m1.2.2.1.1.3.3.2.1" xref="A3.E12.m1.2.2.1.1.3.cmml">(</mo><mi id="A3.E12.m1.1.1" xref="A3.E12.m1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E12.m1.2.2.1.1.3.3.2.2" xref="A3.E12.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A3.E12.m1.2.2.1.1.2" xref="A3.E12.m1.2.2.1.1.2.cmml">=</mo><mrow id="A3.E12.m1.2.2.1.1.1" xref="A3.E12.m1.2.2.1.1.1.cmml"><munderover id="A3.E12.m1.2.2.1.1.1.2" xref="A3.E12.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="A3.E12.m1.2.2.1.1.1.2.2.2" xref="A3.E12.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="A3.E12.m1.2.2.1.1.1.2.2.3" xref="A3.E12.m1.2.2.1.1.1.2.2.3.cmml"><mi id="A3.E12.m1.2.2.1.1.1.2.2.3.2" xref="A3.E12.m1.2.2.1.1.1.2.2.3.2.cmml">t</mi><mo id="A3.E12.m1.2.2.1.1.1.2.2.3.1" xref="A3.E12.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="A3.E12.m1.2.2.1.1.1.2.2.3.3" xref="A3.E12.m1.2.2.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A3.E12.m1.2.2.1.1.1.2.3" xref="A3.E12.m1.2.2.1.1.1.2.3.cmml"><mi id="A3.E12.m1.2.2.1.1.1.2.3.2" xref="A3.E12.m1.2.2.1.1.1.2.3.2.cmml">T</mi><mo id="A3.E12.m1.2.2.1.1.1.2.3.1" xref="A3.E12.m1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="A3.E12.m1.2.2.1.1.1.2.3.3" xref="A3.E12.m1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="A3.E12.m1.2.2.1.1.1.1" xref="A3.E12.m1.2.2.1.1.1.1.cmml"><mrow id="A3.E12.m1.2.2.1.1.1.1.3" xref="A3.E12.m1.2.2.1.1.1.1.3.cmml"><mrow id="A3.E12.m1.2.2.1.1.1.1.3.1" xref="A3.E12.m1.2.2.1.1.1.1.3.1.cmml"><msub id="A3.E12.m1.2.2.1.1.1.1.3.1.1" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1.cmml"><mo rspace="0.167em" id="A3.E12.m1.2.2.1.1.1.1.3.1.1.2" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="A3.E12.m1.2.2.1.1.1.1.3.1.1.3" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1.3.cmml">θ</mi></msub><mi id="A3.E12.m1.2.2.1.1.1.1.3.1.2" xref="A3.E12.m1.2.2.1.1.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E12.m1.2.2.1.1.1.1.3a" xref="A3.E12.m1.2.2.1.1.1.1.3.cmml">⁡</mo><msub id="A3.E12.m1.2.2.1.1.1.1.3.2" xref="A3.E12.m1.2.2.1.1.1.1.3.2.cmml"><mi id="A3.E12.m1.2.2.1.1.1.1.3.2.2" xref="A3.E12.m1.2.2.1.1.1.1.3.2.2.cmml">π</mi><mi id="A3.E12.m1.2.2.1.1.1.1.3.2.3" xref="A3.E12.m1.2.2.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E12.m1.2.2.1.1.1.1.2" xref="A3.E12.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A3.E12.m1.2.2.1.1.1.1.1.1" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E12.m1.2.2.1.1.1.1.1.1.2" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E12.m1.2.2.1.1.1.1.1.1.1" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.2" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.3" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.E12.m1.2.2.1.1.1.1.1.1.1.1" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.2" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.3" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.E12.m1.2.2.1.1.1.1.1.1.3" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A3.E12.m1.2.2.1.2" xref="A3.E12.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E12.m1.2b"><apply id="A3.E12.m1.2.2.1.1.cmml" xref="A3.E12.m1.2.2.1"><eq id="A3.E12.m1.2.2.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.2"></eq><apply id="A3.E12.m1.2.2.1.1.3.cmml" xref="A3.E12.m1.2.2.1.1.3"><times id="A3.E12.m1.2.2.1.1.3.1.cmml" xref="A3.E12.m1.2.2.1.1.3.1"></times><apply id="A3.E12.m1.2.2.1.1.3.2.cmml" xref="A3.E12.m1.2.2.1.1.3.2"><apply id="A3.E12.m1.2.2.1.1.3.2.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1"><apply id="A3.E12.m1.2.2.1.1.3.2.1.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.3.2.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1.1">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.3.2.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1.1.2">∇</ci><ci id="A3.E12.m1.2.2.1.1.3.2.1.1.3.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1.1.3">𝜃</ci></apply><log id="A3.E12.m1.2.2.1.1.3.2.1.2.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1.2"></log></apply><apply id="A3.E12.m1.2.2.1.1.3.2.2.cmml" xref="A3.E12.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.3.2.2.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.3.2.2.2.cmml" xref="A3.E12.m1.2.2.1.1.3.2.2.2">𝜋</ci><ci id="A3.E12.m1.2.2.1.1.3.2.2.3.cmml" xref="A3.E12.m1.2.2.1.1.3.2.2.3">𝜃</ci></apply></apply><ci id="A3.E12.m1.1.1.cmml" xref="A3.E12.m1.1.1">𝜏</ci></apply><apply id="A3.E12.m1.2.2.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1"><apply id="A3.E12.m1.2.2.1.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.2.1.cmml" xref="A3.E12.m1.2.2.1.1.1.2">superscript</csymbol><apply id="A3.E12.m1.2.2.1.1.1.2.2.cmml" xref="A3.E12.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.2.2.1.cmml" xref="A3.E12.m1.2.2.1.1.1.2">subscript</csymbol><sum id="A3.E12.m1.2.2.1.1.1.2.2.2.cmml" xref="A3.E12.m1.2.2.1.1.1.2.2.2"></sum><apply id="A3.E12.m1.2.2.1.1.1.2.2.3.cmml" xref="A3.E12.m1.2.2.1.1.1.2.2.3"><eq id="A3.E12.m1.2.2.1.1.1.2.2.3.1.cmml" xref="A3.E12.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="A3.E12.m1.2.2.1.1.1.2.2.3.2.cmml" xref="A3.E12.m1.2.2.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="A3.E12.m1.2.2.1.1.1.2.2.3.3.cmml" xref="A3.E12.m1.2.2.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A3.E12.m1.2.2.1.1.1.2.3.cmml" xref="A3.E12.m1.2.2.1.1.1.2.3"><minus id="A3.E12.m1.2.2.1.1.1.2.3.1.cmml" xref="A3.E12.m1.2.2.1.1.1.2.3.1"></minus><ci id="A3.E12.m1.2.2.1.1.1.2.3.2.cmml" xref="A3.E12.m1.2.2.1.1.1.2.3.2">𝑇</ci><cn type="integer" id="A3.E12.m1.2.2.1.1.1.2.3.3.cmml" xref="A3.E12.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="A3.E12.m1.2.2.1.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1"><times id="A3.E12.m1.2.2.1.1.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.2"></times><apply id="A3.E12.m1.2.2.1.1.1.1.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3"><apply id="A3.E12.m1.2.2.1.1.1.1.3.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1"><apply id="A3.E12.m1.2.2.1.1.1.1.3.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.1.3.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.1.1.3.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1.2">∇</ci><ci id="A3.E12.m1.2.2.1.1.1.1.3.1.1.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1.1.3">𝜃</ci></apply><log id="A3.E12.m1.2.2.1.1.1.1.3.1.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.1.2"></log></apply><apply id="A3.E12.m1.2.2.1.1.1.1.3.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.2.2">𝜋</ci><ci id="A3.E12.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="A3.E12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E12.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E12.m1.2.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m1.2c">\nabla_{\theta}\log\pi_{\theta}(\tau)=\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p5.7" class="ltx_p">Hence,</p>
<table id="A3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E13X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[{\nabla_{\theta}}\log\pi_{\theta}(\tau)r(\tau)\right]" display="inline"><semantics id="A3.E13X.2.1.1.m1.4a"><mrow id="A3.E13X.2.1.1.m1.4.4" xref="A3.E13X.2.1.1.m1.4.4.cmml"><mrow id="A3.E13X.2.1.1.m1.4.4.3" xref="A3.E13X.2.1.1.m1.4.4.3.cmml"><msub id="A3.E13X.2.1.1.m1.4.4.3.1" xref="A3.E13X.2.1.1.m1.4.4.3.1.cmml"><mo id="A3.E13X.2.1.1.m1.4.4.3.1.2" xref="A3.E13X.2.1.1.m1.4.4.3.1.2.cmml">∇</mo><mi id="A3.E13X.2.1.1.m1.4.4.3.1.3" xref="A3.E13X.2.1.1.m1.4.4.3.1.3.cmml">θ</mi></msub><mi id="A3.E13X.2.1.1.m1.4.4.3.2" xref="A3.E13X.2.1.1.m1.4.4.3.2.cmml">J</mi></mrow><mo id="A3.E13X.2.1.1.m1.4.4.2" xref="A3.E13X.2.1.1.m1.4.4.2.cmml">=</mo><mrow id="A3.E13X.2.1.1.m1.4.4.1" xref="A3.E13X.2.1.1.m1.4.4.1.cmml"><msub id="A3.E13X.2.1.1.m1.4.4.1.3" xref="A3.E13X.2.1.1.m1.4.4.1.3.cmml"><mi id="A3.E13X.2.1.1.m1.4.4.1.3.2" xref="A3.E13X.2.1.1.m1.4.4.1.3.2.cmml">𝔼</mi><mrow id="A3.E13X.2.1.1.m1.1.1.1" xref="A3.E13X.2.1.1.m1.1.1.1.cmml"><mi id="A3.E13X.2.1.1.m1.1.1.1.3" xref="A3.E13X.2.1.1.m1.1.1.1.3.cmml">τ</mi><mo id="A3.E13X.2.1.1.m1.1.1.1.2" xref="A3.E13X.2.1.1.m1.1.1.1.2.cmml">∼</mo><mrow id="A3.E13X.2.1.1.m1.1.1.1.4" xref="A3.E13X.2.1.1.m1.1.1.1.4.cmml"><msub id="A3.E13X.2.1.1.m1.1.1.1.4.2" xref="A3.E13X.2.1.1.m1.1.1.1.4.2.cmml"><mi id="A3.E13X.2.1.1.m1.1.1.1.4.2.2" xref="A3.E13X.2.1.1.m1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E13X.2.1.1.m1.1.1.1.4.2.3" xref="A3.E13X.2.1.1.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E13X.2.1.1.m1.1.1.1.4.1" xref="A3.E13X.2.1.1.m1.1.1.1.4.1.cmml">​</mo><mrow id="A3.E13X.2.1.1.m1.1.1.1.4.3.2" xref="A3.E13X.2.1.1.m1.1.1.1.4.cmml"><mo stretchy="false" id="A3.E13X.2.1.1.m1.1.1.1.4.3.2.1" xref="A3.E13X.2.1.1.m1.1.1.1.4.cmml">(</mo><mi id="A3.E13X.2.1.1.m1.1.1.1.1" xref="A3.E13X.2.1.1.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E13X.2.1.1.m1.1.1.1.4.3.2.2" xref="A3.E13X.2.1.1.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E13X.2.1.1.m1.4.4.1.2" xref="A3.E13X.2.1.1.m1.4.4.1.2.cmml">​</mo><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.2.cmml"><mo id="A3.E13X.2.1.1.m1.4.4.1.1.1.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml"><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml"><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.cmml"><msub id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.cmml"><mo rspace="0.167em" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.2.cmml">∇</mo><mi id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.3" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.3.cmml">θ</mi></msub><mi id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2a" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml">⁡</mo><msub id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.cmml"><mi id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml">π</mi><mi id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.3" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1.cmml">​</mo><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml">(</mo><mi id="A3.E13X.2.1.1.m1.2.2" xref="A3.E13X.2.1.1.m1.2.2.cmml">τ</mi><mo stretchy="false" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1a" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1.cmml">​</mo><mi id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.4" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1b" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1.cmml">​</mo><mrow id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.5.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.5.2.1" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml">(</mo><mi id="A3.E13X.2.1.1.m1.3.3" xref="A3.E13X.2.1.1.m1.3.3.cmml">τ</mi><mo stretchy="false" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.5.2.2" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E13X.2.1.1.m1.4.4.1.1.1.3" xref="A3.E13X.2.1.1.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E13X.2.1.1.m1.4b"><apply id="A3.E13X.2.1.1.m1.4.4.cmml" xref="A3.E13X.2.1.1.m1.4.4"><eq id="A3.E13X.2.1.1.m1.4.4.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.2"></eq><apply id="A3.E13X.2.1.1.m1.4.4.3.cmml" xref="A3.E13X.2.1.1.m1.4.4.3"><apply id="A3.E13X.2.1.1.m1.4.4.3.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.3.1"><csymbol cd="ambiguous" id="A3.E13X.2.1.1.m1.4.4.3.1.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.3.1">subscript</csymbol><ci id="A3.E13X.2.1.1.m1.4.4.3.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.3.1.2">∇</ci><ci id="A3.E13X.2.1.1.m1.4.4.3.1.3.cmml" xref="A3.E13X.2.1.1.m1.4.4.3.1.3">𝜃</ci></apply><ci id="A3.E13X.2.1.1.m1.4.4.3.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.3.2">𝐽</ci></apply><apply id="A3.E13X.2.1.1.m1.4.4.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1"><times id="A3.E13X.2.1.1.m1.4.4.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.2"></times><apply id="A3.E13X.2.1.1.m1.4.4.1.3.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.3"><csymbol cd="ambiguous" id="A3.E13X.2.1.1.m1.4.4.1.3.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.3">subscript</csymbol><ci id="A3.E13X.2.1.1.m1.4.4.1.3.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.3.2">𝔼</ci><apply id="A3.E13X.2.1.1.m1.1.1.1.cmml" xref="A3.E13X.2.1.1.m1.1.1.1"><csymbol cd="latexml" id="A3.E13X.2.1.1.m1.1.1.1.2.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.2">similar-to</csymbol><ci id="A3.E13X.2.1.1.m1.1.1.1.3.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.3">𝜏</ci><apply id="A3.E13X.2.1.1.m1.1.1.1.4.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4"><times id="A3.E13X.2.1.1.m1.1.1.1.4.1.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4.1"></times><apply id="A3.E13X.2.1.1.m1.1.1.1.4.2.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E13X.2.1.1.m1.1.1.1.4.2.1.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4.2">subscript</csymbol><ci id="A3.E13X.2.1.1.m1.1.1.1.4.2.2.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E13X.2.1.1.m1.1.1.1.4.2.3.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.E13X.2.1.1.m1.1.1.1.1.cmml" xref="A3.E13X.2.1.1.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.E13X.2.1.1.m1.4.4.1.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1"><csymbol cd="latexml" id="A3.E13X.2.1.1.m1.4.4.1.1.2.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1"><times id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.1"></times><apply id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2"><apply id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1"><apply id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1">subscript</csymbol><ci id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.2">∇</ci><ci id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.3.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.1.3">𝜃</ci></apply><log id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.1.2"></log></apply><apply id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.1.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.2">𝜋</ci><ci id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.2.2.3">𝜃</ci></apply></apply><ci id="A3.E13X.2.1.1.m1.2.2.cmml" xref="A3.E13X.2.1.1.m1.2.2">𝜏</ci><ci id="A3.E13X.2.1.1.m1.4.4.1.1.1.1.4.cmml" xref="A3.E13X.2.1.1.m1.4.4.1.1.1.1.4">𝑟</ci><ci id="A3.E13X.2.1.1.m1.3.3.cmml" xref="A3.E13X.2.1.1.m1.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13X.2.1.1.m1.4c">\displaystyle\nabla_{\theta}J=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[{\nabla_{\theta}}\log\pi_{\theta}(\tau)r(\tau)\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
<tr id="A3.E13Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E13Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[\left(\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t})\right)\left(\sum_{t=0}^{T-1}r({a}_{t},{s}_{t})\right)\right]" display="inline"><semantics id="A3.E13Xa.2.1.1.m1.2a"><mrow id="A3.E13Xa.2.1.1.m1.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.3.cmml"></mi><mo id="A3.E13Xa.2.1.1.m1.2.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.2.cmml">=</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.cmml"><msub id="A3.E13Xa.2.1.1.m1.2.2.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.3.2.cmml">𝔼</mi><mrow id="A3.E13Xa.2.1.1.m1.1.1.1" xref="A3.E13Xa.2.1.1.m1.1.1.1.cmml"><mi id="A3.E13Xa.2.1.1.m1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.1.1.1.3.cmml">τ</mi><mo id="A3.E13Xa.2.1.1.m1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.1.1.1.2.cmml">∼</mo><mrow id="A3.E13Xa.2.1.1.m1.1.1.1.4" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.cmml"><msub id="A3.E13Xa.2.1.1.m1.1.1.1.4.2" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.2" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.3" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E13Xa.2.1.1.m1.1.1.1.4.1" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.1.cmml">​</mo><mrow id="A3.E13Xa.2.1.1.m1.1.1.1.4.3.2" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.cmml"><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.1.1.1.4.3.2.1" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.cmml">(</mo><mi id="A3.E13Xa.2.1.1.m1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.1.1.1.4.3.2.2" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E13Xa.2.1.1.m1.2.2.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.2.cmml"><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.cmml"><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><munderover id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2a" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">T</mi><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml"><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.3.cmml">θ</mi></msub><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3a" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.cmml"><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.cmml"><mstyle displaystyle="true" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.cmml"><munderover id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3a" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.cmml"><mo movablelimits="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.2.cmml">t</mi><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.2.cmml">T</mi><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.1.cmml">−</mo><mn id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.4" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.3.cmml">​</mo><mrow id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.3.cmml">(</mo><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2.cmml">a</mi><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.4" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.3.cmml">,</mo><msub id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.cmml"><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.2" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.2.cmml">s</mi><mi id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.5" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.3" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E13Xa.2.1.1.m1.2b"><apply id="A3.E13Xa.2.1.1.m1.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2"><eq id="A3.E13Xa.2.1.1.m1.2.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.2"></eq><csymbol cd="latexml" id="A3.E13Xa.2.1.1.m1.2.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.3">absent</csymbol><apply id="A3.E13Xa.2.1.1.m1.2.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1"><times id="A3.E13Xa.2.1.1.m1.2.2.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.2"></times><apply id="A3.E13Xa.2.1.1.m1.2.2.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.3">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.3.2">𝔼</ci><apply id="A3.E13Xa.2.1.1.m1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1"><csymbol cd="latexml" id="A3.E13Xa.2.1.1.m1.1.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.2">similar-to</csymbol><ci id="A3.E13Xa.2.1.1.m1.1.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.3">𝜏</ci><apply id="A3.E13Xa.2.1.1.m1.1.1.1.4.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4"><times id="A3.E13Xa.2.1.1.m1.1.1.1.4.1.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.1"></times><apply id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E13Xa.2.1.1.m1.1.1.1.4.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.E13Xa.2.1.1.m1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="A3.E13Xa.2.1.1.m1.2.2.1.1.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1"><times id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.3"></times><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1"><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2"></sum><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3"><eq id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><minus id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑇</ci><cn type="integer" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><times id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3"><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1"><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.2">∇</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.3">𝜃</ci></apply><log id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2"></log></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1"><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3">superscript</csymbol><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3">subscript</csymbol><sum id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.2"></sum><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3"><eq id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.1"></eq><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3"><minus id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.1"></minus><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2"><times id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.3"></times><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.4.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.4">𝑟</ci><interval closure="open" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2"><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2">𝑎</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.1.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2">subscript</csymbol><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.2.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.2">𝑠</ci><ci id="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.3.cmml" xref="A3.E13Xa.2.1.1.m1.2.2.1.1.1.1.2.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13Xa.2.1.1.m1.2c">\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[\left(\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t})\right)\left(\sum_{t=0}^{T-1}r({a}_{t},{s}_{t})\right)\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A3.E13Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E13Xb.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t})\left(\sum_{u=0}^{T-1}r({a}_{u},{s}_{u})\right)\right]." display="inline"><semantics id="A3.E13Xb.2.1.1.m1.2a"><mrow id="A3.E13Xb.2.1.1.m1.2.2.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.cmml"><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.3.cmml"></mi><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.cmml"><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="A3.E13Xb.2.1.1.m1.1.1.1" xref="A3.E13Xb.2.1.1.m1.1.1.1.cmml"><mi id="A3.E13Xb.2.1.1.m1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.1.1.1.3.cmml">τ</mi><mo id="A3.E13Xb.2.1.1.m1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.1.1.1.2.cmml">∼</mo><mrow id="A3.E13Xb.2.1.1.m1.1.1.1.4" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.cmml"><msub id="A3.E13Xb.2.1.1.m1.1.1.1.4.2" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2.cmml"><mi id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.2" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2.2.cmml">π</mi><mi id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.3" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E13Xb.2.1.1.m1.1.1.1.4.1" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.1.cmml">​</mo><mrow id="A3.E13Xb.2.1.1.m1.1.1.1.4.3.2" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.cmml"><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.1.1.1.4.3.2.1" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.cmml">(</mo><mi id="A3.E13Xb.2.1.1.m1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.1.1.1.4.3.2.2" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><munderover id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3a" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mo movablelimits="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">T</mi><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.cmml"><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.cmml"><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.2.cmml">∇</mo><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.3.cmml">θ</mi></msub><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4a" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.cmml">⁡</mo><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.2.cmml">π</mi><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3a" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml"><mstyle displaystyle="true" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.cmml"><munderover id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3a" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.cmml"><mo movablelimits="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.2.cmml">u</mi><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.2.cmml">T</mi><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.1.cmml">−</mo><mn id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.4" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.3.cmml">​</mo><mrow id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.3.cmml">(</mo><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">a</mi><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.4" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.3.cmml">,</mo><msub id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.cmml"><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.2.cmml">s</mi><mi id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.3.cmml">u</mi></msub><mo stretchy="false" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.5" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.3" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E13Xb.2.1.1.m1.2.2.1.2" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E13Xb.2.1.1.m1.2b"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1"><eq id="A3.E13Xb.2.1.1.m1.2.2.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="A3.E13Xb.2.1.1.m1.2.2.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.3">absent</csymbol><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1"><times id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.2"></times><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.3.2">𝔼</ci><apply id="A3.E13Xb.2.1.1.m1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1"><csymbol cd="latexml" id="A3.E13Xb.2.1.1.m1.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.2">similar-to</csymbol><ci id="A3.E13Xb.2.1.1.m1.1.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.3">𝜏</ci><apply id="A3.E13Xb.2.1.1.m1.1.1.1.4.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4"><times id="A3.E13Xb.2.1.1.m1.1.1.1.4.1.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.1"></times><apply id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2.2">𝜋</ci><ci id="A3.E13Xb.2.1.1.m1.1.1.1.4.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="A3.E13Xb.2.1.1.m1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><sum id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2"></sum><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3"><eq id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.1"></eq><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3"><minus id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2"><times id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.3"></times><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.2">∇</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.1.3">𝜃</ci></apply><log id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.1.2"></log></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.2">𝜋</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.4.2.3">𝜃</ci></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3">superscript</csymbol><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><sum id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.2"></sum><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3"><eq id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.1"></eq><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.2">𝑢</ci><cn type="integer" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3"><minus id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.1"></minus><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2"><times id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.3"></times><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.4.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.4">𝑟</ci><interval closure="open" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2"><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.2">𝑎</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.1.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.2.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.2">𝑠</ci><ci id="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.3.cmml" xref="A3.E13Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13Xb.2.1.1.m1.2c">\displaystyle=\mathbb{E}_{\tau\sim\pi_{\theta}(\tau)}\left[\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}({a}_{t}|{s}_{t})\left(\sum_{u=0}^{T-1}r({a}_{u},{s}_{u})\right)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="A3.SS1.p6" class="ltx_para ltx_noindent">
<p id="A3.SS1.p6.2" class="ltx_p">For on-policy reinforcement learning, <math id="A3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\nabla_{\theta}J" display="inline"><semantics id="A3.SS1.p6.1.m1.1a"><mrow id="A3.SS1.p6.1.m1.1.1" xref="A3.SS1.p6.1.m1.1.1.cmml"><msub id="A3.SS1.p6.1.m1.1.1.1" xref="A3.SS1.p6.1.m1.1.1.1.cmml"><mo id="A3.SS1.p6.1.m1.1.1.1.2" xref="A3.SS1.p6.1.m1.1.1.1.2.cmml">∇</mo><mi id="A3.SS1.p6.1.m1.1.1.1.3" xref="A3.SS1.p6.1.m1.1.1.1.3.cmml">θ</mi></msub><mi id="A3.SS1.p6.1.m1.1.1.2" xref="A3.SS1.p6.1.m1.1.1.2.cmml">J</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.1.m1.1b"><apply id="A3.SS1.p6.1.m1.1.1.cmml" xref="A3.SS1.p6.1.m1.1.1"><apply id="A3.SS1.p6.1.m1.1.1.1.cmml" xref="A3.SS1.p6.1.m1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.1.m1.1.1.1.1.cmml" xref="A3.SS1.p6.1.m1.1.1.1">subscript</csymbol><ci id="A3.SS1.p6.1.m1.1.1.1.2.cmml" xref="A3.SS1.p6.1.m1.1.1.1.2">∇</ci><ci id="A3.SS1.p6.1.m1.1.1.1.3.cmml" xref="A3.SS1.p6.1.m1.1.1.1.3">𝜃</ci></apply><ci id="A3.SS1.p6.1.m1.1.1.2.cmml" xref="A3.SS1.p6.1.m1.1.1.2">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.1.m1.1c">\nabla_{\theta}J</annotation></semantics></math> is estimated on simultaneously sampled sectional trajectories <math id="A3.SS1.p6.2.m2.1" class="ltx_Math" alttext="\{(\hat{a}_{t}^{\theta},\hat{s}_{t}^{\theta})\}" display="inline"><semantics id="A3.SS1.p6.2.m2.1a"><mrow id="A3.SS1.p6.2.m2.1.1.1" xref="A3.SS1.p6.2.m2.1.1.2.cmml"><mo stretchy="false" id="A3.SS1.p6.2.m2.1.1.1.2" xref="A3.SS1.p6.2.m2.1.1.2.cmml">{</mo><mrow id="A3.SS1.p6.2.m2.1.1.1.1.2" xref="A3.SS1.p6.2.m2.1.1.1.1.3.cmml"><mo stretchy="false" id="A3.SS1.p6.2.m2.1.1.1.1.2.3" xref="A3.SS1.p6.2.m2.1.1.1.1.3.cmml">(</mo><msubsup id="A3.SS1.p6.2.m2.1.1.1.1.1.1" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.2" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.1" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.3" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="A3.SS1.p6.2.m2.1.1.1.1.1.1.3" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.3.cmml">θ</mi></msubsup><mo id="A3.SS1.p6.2.m2.1.1.1.1.2.4" xref="A3.SS1.p6.2.m2.1.1.1.1.3.cmml">,</mo><msubsup id="A3.SS1.p6.2.m2.1.1.1.1.2.2" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.cmml"><mover accent="true" id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.cmml"><mi id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.2" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.2.cmml">s</mi><mo id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.1" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.3" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.3.cmml">t</mi><mi id="A3.SS1.p6.2.m2.1.1.1.1.2.2.3" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.SS1.p6.2.m2.1.1.1.1.2.5" xref="A3.SS1.p6.2.m2.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="A3.SS1.p6.2.m2.1.1.1.3" xref="A3.SS1.p6.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.2.m2.1b"><set id="A3.SS1.p6.2.m2.1.1.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1"><interval closure="open" id="A3.SS1.p6.2.m2.1.1.1.1.3.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2"><apply id="A3.SS1.p6.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.2.m2.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1">subscript</csymbol><apply id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2"><ci id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A3.SS1.p6.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="A3.SS1.p6.2.m2.1.1.1.1.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.2.m2.1.1.1.1.2.2.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2">superscript</csymbol><apply id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2">subscript</csymbol><apply id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2"><ci id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.1.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.1">^</ci><ci id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.2.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.2.2">𝑠</ci></apply><ci id="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.3.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="A3.SS1.p6.2.m2.1.1.1.1.2.2.3.cmml" xref="A3.SS1.p6.2.m2.1.1.1.1.2.2.3">𝜃</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.2.m2.1c">\{(\hat{a}_{t}^{\theta},\hat{s}_{t}^{\theta})\}</annotation></semantics></math>, such that the equation above is approximated to be</p>
<table id="A3.E14" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E14X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A3.E14X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(\sum_{u=0}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})\right)." display="inline"><semantics id="A3.E14X.2.1.1.m1.1a"><mrow id="A3.E14X.2.1.1.m1.1.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.cmml"><mrow id="A3.E14X.2.1.1.m1.1.1.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.cmml"><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.5" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.cmml"><msub id="A3.E14X.2.1.1.m1.1.1.1.1.5.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1.cmml"><mo id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1.2.cmml">∇</mo><mi id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1.3.cmml">θ</mi></msub><mi id="A3.E14X.2.1.1.m1.1.1.1.1.5.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.2.cmml">J</mi></mrow><mo id="A3.E14X.2.1.1.m1.1.1.1.1.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.4.cmml">≈</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.cmml"><munderover id="A3.E14X.2.1.1.m1.1.1.1.1.3.4a" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.cmml"><mo movablelimits="false" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.2.cmml">∑</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml">t</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml">=</mo><mn id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml">0</mn></mrow><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml">T</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.1.cmml">−</mo><mn id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.cmml"><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.cmml"><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.cmml"><msub id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml">∇</mo><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml">θ</mi></msub><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5a" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.cmml">⁡</mo><msub id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml">π</mi><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.5" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4a" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">(</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mstyle displaystyle="true" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml"><munderover id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3a" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml"><mo movablelimits="false" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2.cmml">u</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml">T</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.cmml">−</mo><mn id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3.cmml">​</mo><mrow id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml">u</mi><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.4" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3.cmml">u</mi><mi id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.5" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A3.E14X.2.1.1.m1.1.1.1.2" xref="A3.E14X.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E14X.2.1.1.m1.1b"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1"><approx id="A3.E14X.2.1.1.m1.1.1.1.1.4.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.4"></approx><apply id="A3.E14X.2.1.1.m1.1.1.1.1.5.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1">subscript</csymbol><ci id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1.2">∇</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.5.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.1.3">𝜃</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.5.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.5.2">𝐽</ci></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4">subscript</csymbol><sum id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.2"></sum><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3"><eq id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.1"></eq><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.2">𝑡</ci><cn type="integer" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.2.3.3">0</cn></apply></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3"><minus id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.1"></minus><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.2">𝑇</ci><cn type="integer" id="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.4.3.3">1</cn></apply></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3"><times id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.4"></times><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1">subscript</csymbol><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2">∇</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3">𝜃</ci></apply><log id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.1.2"></log></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2">subscript</csymbol><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.2">𝜋</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.5.2.3">𝜃</ci></apply></apply><interval closure="open" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3">subscript</csymbol><sum id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2"></sum><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3"><eq id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1"></eq><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2">𝑢</ci><cn type="integer" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3"><minus id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1"></minus><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2"><times id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3"></times><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4">𝑟</ci><interval closure="open" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2"><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2"><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2"><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1">^</ci><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E14X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14X.2.1.1.m1.1c">\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(\sum_{u=0}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(14)</span></td>
</tr>
</tbody>
</table>
<p id="A3.SS1.p6.4" class="ltx_p">Note that the optimization of the policy making network for policy <math id="A3.SS1.p6.3.m1.2" class="ltx_Math" alttext="({a}_{t},{s}_{t})" display="inline"><semantics id="A3.SS1.p6.3.m1.2a"><mrow id="A3.SS1.p6.3.m1.2.2.2" xref="A3.SS1.p6.3.m1.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.p6.3.m1.2.2.2.3" xref="A3.SS1.p6.3.m1.2.2.3.cmml">(</mo><msub id="A3.SS1.p6.3.m1.1.1.1.1" xref="A3.SS1.p6.3.m1.1.1.1.1.cmml"><mi id="A3.SS1.p6.3.m1.1.1.1.1.2" xref="A3.SS1.p6.3.m1.1.1.1.1.2.cmml">a</mi><mi id="A3.SS1.p6.3.m1.1.1.1.1.3" xref="A3.SS1.p6.3.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.SS1.p6.3.m1.2.2.2.4" xref="A3.SS1.p6.3.m1.2.2.3.cmml">,</mo><msub id="A3.SS1.p6.3.m1.2.2.2.2" xref="A3.SS1.p6.3.m1.2.2.2.2.cmml"><mi id="A3.SS1.p6.3.m1.2.2.2.2.2" xref="A3.SS1.p6.3.m1.2.2.2.2.2.cmml">s</mi><mi id="A3.SS1.p6.3.m1.2.2.2.2.3" xref="A3.SS1.p6.3.m1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="A3.SS1.p6.3.m1.2.2.2.5" xref="A3.SS1.p6.3.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.3.m1.2b"><interval closure="open" id="A3.SS1.p6.3.m1.2.2.3.cmml" xref="A3.SS1.p6.3.m1.2.2.2"><apply id="A3.SS1.p6.3.m1.1.1.1.1.cmml" xref="A3.SS1.p6.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.3.m1.1.1.1.1.1.cmml" xref="A3.SS1.p6.3.m1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.p6.3.m1.1.1.1.1.2.cmml" xref="A3.SS1.p6.3.m1.1.1.1.1.2">𝑎</ci><ci id="A3.SS1.p6.3.m1.1.1.1.1.3.cmml" xref="A3.SS1.p6.3.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.SS1.p6.3.m1.2.2.2.2.cmml" xref="A3.SS1.p6.3.m1.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.3.m1.2.2.2.2.1.cmml" xref="A3.SS1.p6.3.m1.2.2.2.2">subscript</csymbol><ci id="A3.SS1.p6.3.m1.2.2.2.2.2.cmml" xref="A3.SS1.p6.3.m1.2.2.2.2.2">𝑠</ci><ci id="A3.SS1.p6.3.m1.2.2.2.2.3.cmml" xref="A3.SS1.p6.3.m1.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.3.m1.2c">({a}_{t},{s}_{t})</annotation></semantics></math> is not expected to be influenced by the past trajectories, <span id="A3.SS1.p6.4.1" class="ltx_text ltx_font_italic">i.e.</span>, the rewards before <math id="A3.SS1.p6.4.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A3.SS1.p6.4.m2.1a"><mi id="A3.SS1.p6.4.m2.1.1" xref="A3.SS1.p6.4.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.4.m2.1b"><ci id="A3.SS1.p6.4.m2.1.1.cmml" xref="A3.SS1.p6.4.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.4.m2.1c">t</annotation></semantics></math>.
Therefore, Equation (<a href="#A3.E14" title="In C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) is reframed as</p>
<table id="A3.E15" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E15X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A3.E15X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(\sum_{u=t}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})\right)," display="inline"><semantics id="A3.E15X.2.1.1.m1.1a"><mrow id="A3.E15X.2.1.1.m1.1.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.cmml"><mrow id="A3.E15X.2.1.1.m1.1.1.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.cmml"><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.5" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.cmml"><msub id="A3.E15X.2.1.1.m1.1.1.1.1.5.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1.cmml"><mo id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1.2.cmml">∇</mo><mi id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1.3.cmml">θ</mi></msub><mi id="A3.E15X.2.1.1.m1.1.1.1.1.5.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.2.cmml">J</mi></mrow><mo id="A3.E15X.2.1.1.m1.1.1.1.1.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.4.cmml">≈</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.cmml"><munderover id="A3.E15X.2.1.1.m1.1.1.1.1.3.4a" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.cmml"><mo movablelimits="false" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.2.cmml">∑</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml">t</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml">=</mo><mn id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml">0</mn></mrow><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml">T</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.1.cmml">−</mo><mn id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.cmml"><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.cmml"><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.cmml"><msub id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml">∇</mo><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml">θ</mi></msub><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5a" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.cmml">⁡</mo><msub id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml">π</mi><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.5" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4a" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">(</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mstyle displaystyle="true" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml"><munderover id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3a" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml"><mo movablelimits="false" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2.cmml">u</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1.cmml">=</mo><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3.cmml">t</mi></mrow><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml">T</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.cmml">−</mo><mn id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3.cmml">​</mo><mrow id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml">u</mi><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.4" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3.cmml">u</mi><mi id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.5" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E15X.2.1.1.m1.1.1.1.2" xref="A3.E15X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E15X.2.1.1.m1.1b"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1"><approx id="A3.E15X.2.1.1.m1.1.1.1.1.4.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.4"></approx><apply id="A3.E15X.2.1.1.m1.1.1.1.1.5.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1">subscript</csymbol><ci id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1.2">∇</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.5.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.1.3">𝜃</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.5.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.5.2">𝐽</ci></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4">subscript</csymbol><sum id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.2"></sum><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3"><eq id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.1"></eq><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.2">𝑡</ci><cn type="integer" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.2.3.3">0</cn></apply></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3"><minus id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.1"></minus><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.2">𝑇</ci><cn type="integer" id="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.4.3.3">1</cn></apply></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3"><times id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.4"></times><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1">subscript</csymbol><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.2">∇</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.1.3">𝜃</ci></apply><log id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.1.2"></log></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2">subscript</csymbol><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.2">𝜋</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.5.2.3">𝜃</ci></apply></apply><interval closure="open" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3">subscript</csymbol><sum id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.2"></sum><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3"><eq id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.1"></eq><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.2">𝑢</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3"><minus id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1"></minus><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2"><times id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.3"></times><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.4">𝑟</ci><interval closure="open" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2"><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2"><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2"><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1">^</ci><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E15X.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15X.2.1.1.m1.1c">\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(\sum_{u=t}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
</tbody>
</table>
<p id="A3.SS1.p6.8" class="ltx_p">where <math id="A3.SS1.p6.5.m1.2" class="ltx_Math" alttext="\sum_{u=t}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})" display="inline"><semantics id="A3.SS1.p6.5.m1.2a"><mrow id="A3.SS1.p6.5.m1.2.2" xref="A3.SS1.p6.5.m1.2.2.cmml"><msubsup id="A3.SS1.p6.5.m1.2.2.3" xref="A3.SS1.p6.5.m1.2.2.3.cmml"><mo id="A3.SS1.p6.5.m1.2.2.3.2.2" xref="A3.SS1.p6.5.m1.2.2.3.2.2.cmml">∑</mo><mrow id="A3.SS1.p6.5.m1.2.2.3.2.3" xref="A3.SS1.p6.5.m1.2.2.3.2.3.cmml"><mi id="A3.SS1.p6.5.m1.2.2.3.2.3.2" xref="A3.SS1.p6.5.m1.2.2.3.2.3.2.cmml">u</mi><mo id="A3.SS1.p6.5.m1.2.2.3.2.3.1" xref="A3.SS1.p6.5.m1.2.2.3.2.3.1.cmml">=</mo><mi id="A3.SS1.p6.5.m1.2.2.3.2.3.3" xref="A3.SS1.p6.5.m1.2.2.3.2.3.3.cmml">t</mi></mrow><mrow id="A3.SS1.p6.5.m1.2.2.3.3" xref="A3.SS1.p6.5.m1.2.2.3.3.cmml"><mi id="A3.SS1.p6.5.m1.2.2.3.3.2" xref="A3.SS1.p6.5.m1.2.2.3.3.2.cmml">T</mi><mo id="A3.SS1.p6.5.m1.2.2.3.3.1" xref="A3.SS1.p6.5.m1.2.2.3.3.1.cmml">−</mo><mn id="A3.SS1.p6.5.m1.2.2.3.3.3" xref="A3.SS1.p6.5.m1.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A3.SS1.p6.5.m1.2.2.2" xref="A3.SS1.p6.5.m1.2.2.2.cmml"><mi id="A3.SS1.p6.5.m1.2.2.2.4" xref="A3.SS1.p6.5.m1.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p6.5.m1.2.2.2.3" xref="A3.SS1.p6.5.m1.2.2.2.3.cmml">​</mo><mrow id="A3.SS1.p6.5.m1.2.2.2.2.2" xref="A3.SS1.p6.5.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.p6.5.m1.2.2.2.2.2.3" xref="A3.SS1.p6.5.m1.2.2.2.2.3.cmml">(</mo><msubsup id="A3.SS1.p6.5.m1.1.1.1.1.1.1" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.2" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.1" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.5.m1.1.1.1.1.1.1.3" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.3.cmml">u</mi><mi id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.3" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.SS1.p6.5.m1.2.2.2.2.2.4" xref="A3.SS1.p6.5.m1.2.2.2.2.3.cmml">,</mo><msubsup id="A3.SS1.p6.5.m1.2.2.2.2.2.2" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.cmml"><mi id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.2" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.1" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.5.m1.2.2.2.2.2.2.3" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.3.cmml">u</mi><mi id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.3" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.SS1.p6.5.m1.2.2.2.2.2.5" xref="A3.SS1.p6.5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.5.m1.2b"><apply id="A3.SS1.p6.5.m1.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2"><apply id="A3.SS1.p6.5.m1.2.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.3"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.2.2.3.1.cmml" xref="A3.SS1.p6.5.m1.2.2.3">superscript</csymbol><apply id="A3.SS1.p6.5.m1.2.2.3.2.cmml" xref="A3.SS1.p6.5.m1.2.2.3"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.2.2.3.2.1.cmml" xref="A3.SS1.p6.5.m1.2.2.3">subscript</csymbol><sum id="A3.SS1.p6.5.m1.2.2.3.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.3.2.2"></sum><apply id="A3.SS1.p6.5.m1.2.2.3.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.3.2.3"><eq id="A3.SS1.p6.5.m1.2.2.3.2.3.1.cmml" xref="A3.SS1.p6.5.m1.2.2.3.2.3.1"></eq><ci id="A3.SS1.p6.5.m1.2.2.3.2.3.2.cmml" xref="A3.SS1.p6.5.m1.2.2.3.2.3.2">𝑢</ci><ci id="A3.SS1.p6.5.m1.2.2.3.2.3.3.cmml" xref="A3.SS1.p6.5.m1.2.2.3.2.3.3">𝑡</ci></apply></apply><apply id="A3.SS1.p6.5.m1.2.2.3.3.cmml" xref="A3.SS1.p6.5.m1.2.2.3.3"><minus id="A3.SS1.p6.5.m1.2.2.3.3.1.cmml" xref="A3.SS1.p6.5.m1.2.2.3.3.1"></minus><ci id="A3.SS1.p6.5.m1.2.2.3.3.2.cmml" xref="A3.SS1.p6.5.m1.2.2.3.3.2">𝑇</ci><cn type="integer" id="A3.SS1.p6.5.m1.2.2.3.3.3.cmml" xref="A3.SS1.p6.5.m1.2.2.3.3.3">1</cn></apply></apply><apply id="A3.SS1.p6.5.m1.2.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.2"><times id="A3.SS1.p6.5.m1.2.2.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.2.3"></times><ci id="A3.SS1.p6.5.m1.2.2.2.4.cmml" xref="A3.SS1.p6.5.m1.2.2.2.4">𝑟</ci><interval closure="open" id="A3.SS1.p6.5.m1.2.2.2.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2"><apply id="A3.SS1.p6.5.m1.1.1.1.1.1.1.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.1.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2"><ci id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.5.m1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p6.5.m1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="A3.SS1.p6.5.m1.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2">subscript</csymbol><apply id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2">superscript</csymbol><apply id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2"><ci id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.1">^</ci><ci id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.5.m1.2.2.2.2.2.2.3.cmml" xref="A3.SS1.p6.5.m1.2.2.2.2.2.2.3">𝑢</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.5.m1.2c">\sum_{u=t}^{T-1}r(\hat{a}^{\theta}_{u},\hat{s}^{\theta}_{u})</annotation></semantics></math> is the expected total future income after taking <math id="A3.SS1.p6.6.m2.1" class="ltx_Math" alttext="\hat{a}^{\theta}_{u}" display="inline"><semantics id="A3.SS1.p6.6.m2.1a"><msubsup id="A3.SS1.p6.6.m2.1.1" xref="A3.SS1.p6.6.m2.1.1.cmml"><mover accent="true" id="A3.SS1.p6.6.m2.1.1.2.2" xref="A3.SS1.p6.6.m2.1.1.2.2.cmml"><mi id="A3.SS1.p6.6.m2.1.1.2.2.2" xref="A3.SS1.p6.6.m2.1.1.2.2.2.cmml">a</mi><mo id="A3.SS1.p6.6.m2.1.1.2.2.1" xref="A3.SS1.p6.6.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.6.m2.1.1.3" xref="A3.SS1.p6.6.m2.1.1.3.cmml">u</mi><mi id="A3.SS1.p6.6.m2.1.1.2.3" xref="A3.SS1.p6.6.m2.1.1.2.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.6.m2.1b"><apply id="A3.SS1.p6.6.m2.1.1.cmml" xref="A3.SS1.p6.6.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.6.m2.1.1.1.cmml" xref="A3.SS1.p6.6.m2.1.1">subscript</csymbol><apply id="A3.SS1.p6.6.m2.1.1.2.cmml" xref="A3.SS1.p6.6.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.6.m2.1.1.2.1.cmml" xref="A3.SS1.p6.6.m2.1.1">superscript</csymbol><apply id="A3.SS1.p6.6.m2.1.1.2.2.cmml" xref="A3.SS1.p6.6.m2.1.1.2.2"><ci id="A3.SS1.p6.6.m2.1.1.2.2.1.cmml" xref="A3.SS1.p6.6.m2.1.1.2.2.1">^</ci><ci id="A3.SS1.p6.6.m2.1.1.2.2.2.cmml" xref="A3.SS1.p6.6.m2.1.1.2.2.2">𝑎</ci></apply><ci id="A3.SS1.p6.6.m2.1.1.2.3.cmml" xref="A3.SS1.p6.6.m2.1.1.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.6.m2.1.1.3.cmml" xref="A3.SS1.p6.6.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.6.m2.1c">\hat{a}^{\theta}_{u}</annotation></semantics></math> under state <math id="A3.SS1.p6.7.m3.1" class="ltx_Math" alttext="\hat{s}^{\theta}_{u}" display="inline"><semantics id="A3.SS1.p6.7.m3.1a"><msubsup id="A3.SS1.p6.7.m3.1.1" xref="A3.SS1.p6.7.m3.1.1.cmml"><mover accent="true" id="A3.SS1.p6.7.m3.1.1.2.2" xref="A3.SS1.p6.7.m3.1.1.2.2.cmml"><mi id="A3.SS1.p6.7.m3.1.1.2.2.2" xref="A3.SS1.p6.7.m3.1.1.2.2.2.cmml">s</mi><mo id="A3.SS1.p6.7.m3.1.1.2.2.1" xref="A3.SS1.p6.7.m3.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.7.m3.1.1.3" xref="A3.SS1.p6.7.m3.1.1.3.cmml">u</mi><mi id="A3.SS1.p6.7.m3.1.1.2.3" xref="A3.SS1.p6.7.m3.1.1.2.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.7.m3.1b"><apply id="A3.SS1.p6.7.m3.1.1.cmml" xref="A3.SS1.p6.7.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.7.m3.1.1.1.cmml" xref="A3.SS1.p6.7.m3.1.1">subscript</csymbol><apply id="A3.SS1.p6.7.m3.1.1.2.cmml" xref="A3.SS1.p6.7.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.7.m3.1.1.2.1.cmml" xref="A3.SS1.p6.7.m3.1.1">superscript</csymbol><apply id="A3.SS1.p6.7.m3.1.1.2.2.cmml" xref="A3.SS1.p6.7.m3.1.1.2.2"><ci id="A3.SS1.p6.7.m3.1.1.2.2.1.cmml" xref="A3.SS1.p6.7.m3.1.1.2.2.1">^</ci><ci id="A3.SS1.p6.7.m3.1.1.2.2.2.cmml" xref="A3.SS1.p6.7.m3.1.1.2.2.2">𝑠</ci></apply><ci id="A3.SS1.p6.7.m3.1.1.2.3.cmml" xref="A3.SS1.p6.7.m3.1.1.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.7.m3.1.1.3.cmml" xref="A3.SS1.p6.7.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.7.m3.1c">\hat{s}^{\theta}_{u}</annotation></semantics></math>, or to say, the expected “reward to go”
which is formally named as the Q-value <math id="A3.SS1.p6.8.m4.2" class="ltx_Math" alttext="Q(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})" display="inline"><semantics id="A3.SS1.p6.8.m4.2a"><mrow id="A3.SS1.p6.8.m4.2.2" xref="A3.SS1.p6.8.m4.2.2.cmml"><mi id="A3.SS1.p6.8.m4.2.2.4" xref="A3.SS1.p6.8.m4.2.2.4.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p6.8.m4.2.2.3" xref="A3.SS1.p6.8.m4.2.2.3.cmml">​</mo><mrow id="A3.SS1.p6.8.m4.2.2.2.2" xref="A3.SS1.p6.8.m4.2.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.p6.8.m4.2.2.2.2.3" xref="A3.SS1.p6.8.m4.2.2.2.3.cmml">(</mo><msubsup id="A3.SS1.p6.8.m4.1.1.1.1.1" xref="A3.SS1.p6.8.m4.1.1.1.1.1.cmml"><mover accent="true" id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.cmml"><mi id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.2" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.1" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.8.m4.1.1.1.1.1.3" xref="A3.SS1.p6.8.m4.1.1.1.1.1.3.cmml">t</mi><mi id="A3.SS1.p6.8.m4.1.1.1.1.1.2.3" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.SS1.p6.8.m4.2.2.2.2.4" xref="A3.SS1.p6.8.m4.2.2.2.3.cmml">,</mo><msubsup id="A3.SS1.p6.8.m4.2.2.2.2.2" xref="A3.SS1.p6.8.m4.2.2.2.2.2.cmml"><mover accent="true" id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.cmml"><mi id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.2" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.1" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p6.8.m4.2.2.2.2.2.3" xref="A3.SS1.p6.8.m4.2.2.2.2.2.3.cmml">t</mi><mi id="A3.SS1.p6.8.m4.2.2.2.2.2.2.3" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.SS1.p6.8.m4.2.2.2.2.5" xref="A3.SS1.p6.8.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p6.8.m4.2b"><apply id="A3.SS1.p6.8.m4.2.2.cmml" xref="A3.SS1.p6.8.m4.2.2"><times id="A3.SS1.p6.8.m4.2.2.3.cmml" xref="A3.SS1.p6.8.m4.2.2.3"></times><ci id="A3.SS1.p6.8.m4.2.2.4.cmml" xref="A3.SS1.p6.8.m4.2.2.4">𝑄</ci><interval closure="open" id="A3.SS1.p6.8.m4.2.2.2.3.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2"><apply id="A3.SS1.p6.8.m4.1.1.1.1.1.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.8.m4.1.1.1.1.1.1.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1">subscript</csymbol><apply id="A3.SS1.p6.8.m4.1.1.1.1.1.2.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p6.8.m4.1.1.1.1.1.2.1.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1">superscript</csymbol><apply id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2"><ci id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.1.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.1">^</ci><ci id="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.2.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.SS1.p6.8.m4.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.8.m4.1.1.1.1.1.3.cmml" xref="A3.SS1.p6.8.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.SS1.p6.8.m4.2.2.2.2.2.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.8.m4.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2">subscript</csymbol><apply id="A3.SS1.p6.8.m4.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p6.8.m4.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2">superscript</csymbol><apply id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2"><ci id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.1">^</ci><ci id="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.SS1.p6.8.m4.2.2.2.2.2.2.3.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.SS1.p6.8.m4.2.2.2.2.2.3.cmml" xref="A3.SS1.p6.8.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p6.8.m4.2c">Q(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})</annotation></semantics></math>.</p>
</div>
<div id="A3.SS1.p7" class="ltx_para ltx_noindent">
<p id="A3.SS1.p7.2" class="ltx_p">To avoid the bias of rewards, <span id="A3.SS1.p7.2.1" class="ltx_text ltx_font_italic">e.g.</span>, all rewards are positive, the Q-value item in Equation (<a href="#A3.E15" title="In C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>) is normalized by an expected “reward to go” on state <math id="A3.SS1.p7.1.m1.1" class="ltx_Math" alttext="{s}_{t}" display="inline"><semantics id="A3.SS1.p7.1.m1.1a"><msub id="A3.SS1.p7.1.m1.1.1" xref="A3.SS1.p7.1.m1.1.1.cmml"><mi id="A3.SS1.p7.1.m1.1.1.2" xref="A3.SS1.p7.1.m1.1.1.2.cmml">s</mi><mi id="A3.SS1.p7.1.m1.1.1.3" xref="A3.SS1.p7.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.1.m1.1b"><apply id="A3.SS1.p7.1.m1.1.1.cmml" xref="A3.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.1.m1.1.1.1.cmml" xref="A3.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="A3.SS1.p7.1.m1.1.1.2.cmml" xref="A3.SS1.p7.1.m1.1.1.2">𝑠</ci><ci id="A3.SS1.p7.1.m1.1.1.3.cmml" xref="A3.SS1.p7.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.1.m1.1c">{s}_{t}</annotation></semantics></math>, <span id="A3.SS1.p7.2.2" class="ltx_text ltx_font_italic">i.e.</span>, the critic value <math id="A3.SS1.p7.2.m2.1" class="ltx_Math" alttext="V_{t}=\mathbb{E}_{{a}_{t}}[Q({a}_{t},{s}_{t})]" display="inline"><semantics id="A3.SS1.p7.2.m2.1a"><mrow id="A3.SS1.p7.2.m2.1.1" xref="A3.SS1.p7.2.m2.1.1.cmml"><msub id="A3.SS1.p7.2.m2.1.1.3" xref="A3.SS1.p7.2.m2.1.1.3.cmml"><mi id="A3.SS1.p7.2.m2.1.1.3.2" xref="A3.SS1.p7.2.m2.1.1.3.2.cmml">V</mi><mi id="A3.SS1.p7.2.m2.1.1.3.3" xref="A3.SS1.p7.2.m2.1.1.3.3.cmml">t</mi></msub><mo id="A3.SS1.p7.2.m2.1.1.2" xref="A3.SS1.p7.2.m2.1.1.2.cmml">=</mo><mrow id="A3.SS1.p7.2.m2.1.1.1" xref="A3.SS1.p7.2.m2.1.1.1.cmml"><msub id="A3.SS1.p7.2.m2.1.1.1.3" xref="A3.SS1.p7.2.m2.1.1.1.3.cmml"><mi id="A3.SS1.p7.2.m2.1.1.1.3.2" xref="A3.SS1.p7.2.m2.1.1.1.3.2.cmml">𝔼</mi><msub id="A3.SS1.p7.2.m2.1.1.1.3.3" xref="A3.SS1.p7.2.m2.1.1.1.3.3.cmml"><mi id="A3.SS1.p7.2.m2.1.1.1.3.3.2" xref="A3.SS1.p7.2.m2.1.1.1.3.3.2.cmml">a</mi><mi id="A3.SS1.p7.2.m2.1.1.1.3.3.3" xref="A3.SS1.p7.2.m2.1.1.1.3.3.3.cmml">t</mi></msub></msub><mo lspace="0em" rspace="0em" id="A3.SS1.p7.2.m2.1.1.1.2" xref="A3.SS1.p7.2.m2.1.1.1.2.cmml">​</mo><mrow id="A3.SS1.p7.2.m2.1.1.1.1.1" xref="A3.SS1.p7.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="A3.SS1.p7.2.m2.1.1.1.1.1.2" xref="A3.SS1.p7.2.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="A3.SS1.p7.2.m2.1.1.1.1.1.1" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p7.2.m2.1.1.1.1.1.1.4" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.4.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.3" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.3" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.2" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.3" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.4" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.2" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.2.cmml">s</mi><mi id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.3" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.5" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.SS1.p7.2.m2.1.1.1.1.1.3" xref="A3.SS1.p7.2.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.2.m2.1b"><apply id="A3.SS1.p7.2.m2.1.1.cmml" xref="A3.SS1.p7.2.m2.1.1"><eq id="A3.SS1.p7.2.m2.1.1.2.cmml" xref="A3.SS1.p7.2.m2.1.1.2"></eq><apply id="A3.SS1.p7.2.m2.1.1.3.cmml" xref="A3.SS1.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p7.2.m2.1.1.3.1.cmml" xref="A3.SS1.p7.2.m2.1.1.3">subscript</csymbol><ci id="A3.SS1.p7.2.m2.1.1.3.2.cmml" xref="A3.SS1.p7.2.m2.1.1.3.2">𝑉</ci><ci id="A3.SS1.p7.2.m2.1.1.3.3.cmml" xref="A3.SS1.p7.2.m2.1.1.3.3">𝑡</ci></apply><apply id="A3.SS1.p7.2.m2.1.1.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1"><times id="A3.SS1.p7.2.m2.1.1.1.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.2"></times><apply id="A3.SS1.p7.2.m2.1.1.1.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p7.2.m2.1.1.1.3.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3">subscript</csymbol><ci id="A3.SS1.p7.2.m2.1.1.1.3.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3.2">𝔼</ci><apply id="A3.SS1.p7.2.m2.1.1.1.3.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.SS1.p7.2.m2.1.1.1.3.3.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3.3">subscript</csymbol><ci id="A3.SS1.p7.2.m2.1.1.1.3.3.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3.3.2">𝑎</ci><ci id="A3.SS1.p7.2.m2.1.1.1.3.3.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="A3.SS1.p7.2.m2.1.1.1.1.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.p7.2.m2.1.1.1.1.2.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A3.SS1.p7.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1"><times id="A3.SS1.p7.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.3"></times><ci id="A3.SS1.p7.2.m2.1.1.1.1.1.1.4.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.4">𝑄</ci><interval closure="open" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2"><apply id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.2">𝑠</ci><ci id="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A3.SS1.p7.2.m2.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.2.m2.1c">V_{t}=\mathbb{E}_{{a}_{t}}[Q({a}_{t},{s}_{t})]</annotation></semantics></math>, such that</p>
<table id="A3.E16" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E16X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E16X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(Q(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})-V(\hat{s}^{\theta}_{t})\right)" display="inline"><semantics id="A3.E16X.2.1.1.m1.3a"><mrow id="A3.E16X.2.1.1.m1.3.3" xref="A3.E16X.2.1.1.m1.3.3.cmml"><mrow id="A3.E16X.2.1.1.m1.3.3.5" xref="A3.E16X.2.1.1.m1.3.3.5.cmml"><msub id="A3.E16X.2.1.1.m1.3.3.5.1" xref="A3.E16X.2.1.1.m1.3.3.5.1.cmml"><mo id="A3.E16X.2.1.1.m1.3.3.5.1.2" xref="A3.E16X.2.1.1.m1.3.3.5.1.2.cmml">∇</mo><mi id="A3.E16X.2.1.1.m1.3.3.5.1.3" xref="A3.E16X.2.1.1.m1.3.3.5.1.3.cmml">θ</mi></msub><mi id="A3.E16X.2.1.1.m1.3.3.5.2" xref="A3.E16X.2.1.1.m1.3.3.5.2.cmml">J</mi></mrow><mo id="A3.E16X.2.1.1.m1.3.3.4" xref="A3.E16X.2.1.1.m1.3.3.4.cmml">≈</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3" xref="A3.E16X.2.1.1.m1.3.3.3.cmml"><mstyle displaystyle="true" id="A3.E16X.2.1.1.m1.3.3.3.4" xref="A3.E16X.2.1.1.m1.3.3.3.4.cmml"><munderover id="A3.E16X.2.1.1.m1.3.3.3.4a" xref="A3.E16X.2.1.1.m1.3.3.3.4.cmml"><mo movablelimits="false" id="A3.E16X.2.1.1.m1.3.3.3.4.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.2.cmml">∑</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.4.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.2" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.2.cmml">t</mi><mo id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.1" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.1.cmml">=</mo><mn id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.3" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.3.cmml">0</mn></mrow><mrow id="A3.E16X.2.1.1.m1.3.3.3.4.3" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.4.3.2" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.2.cmml">T</mi><mo id="A3.E16X.2.1.1.m1.3.3.3.4.3.1" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.1.cmml">−</mo><mn id="A3.E16X.2.1.1.m1.3.3.3.4.3.3" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E16X.2.1.1.m1.3.3.3.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.cmml"><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.5" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.cmml"><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.5.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.cmml"><msub id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.2.cmml">∇</mo><mi id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.3.cmml">θ</mi></msub><mi id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E16X.2.1.1.m1.3.3.3.3.5a" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.cmml">⁡</mo><msub id="A3.E16X.2.1.1.m1.3.3.3.3.5.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2.2.cmml">π</mi><mi id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E16X.2.1.1.m1.3.3.3.3.4" xref="A3.E16X.2.1.1.m1.3.3.3.3.4.cmml">​</mo><mrow id="A3.E16X.2.1.1.m1.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.3" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.1" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.4" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.cmml"><mover accent="true" id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.1" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.3" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.3.cmml">t</mi><mi id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.3" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.5" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E16X.2.1.1.m1.3.3.3.3.4a" xref="A3.E16X.2.1.1.m1.3.3.3.3.4.cmml">​</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.cmml"><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.cmml">(</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.cmml"><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.4" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.4.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.3.cmml">​</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.4" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.3.cmml">t</mi><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.5" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.4" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.4.cmml">−</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.3.cmml">V</mi><mo lspace="0em" rspace="0em" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.2.cmml">​</mo><mrow id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.cmml"><mo stretchy="false" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.cmml">(</mo><msubsup id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.cmml"><mover accent="true" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.cmml"><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.2" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.2.cmml">s</mi><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.1" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.3.cmml">t</mi><mi id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.3" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E16X.2.1.1.m1.3b"><apply id="A3.E16X.2.1.1.m1.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3"><approx id="A3.E16X.2.1.1.m1.3.3.4.cmml" xref="A3.E16X.2.1.1.m1.3.3.4"></approx><apply id="A3.E16X.2.1.1.m1.3.3.5.cmml" xref="A3.E16X.2.1.1.m1.3.3.5"><apply id="A3.E16X.2.1.1.m1.3.3.5.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.5.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.5.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.5.1">subscript</csymbol><ci id="A3.E16X.2.1.1.m1.3.3.5.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.5.1.2">∇</ci><ci id="A3.E16X.2.1.1.m1.3.3.5.1.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.5.1.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.5.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.5.2">𝐽</ci></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3"><apply id="A3.E16X.2.1.1.m1.3.3.3.4.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.4.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.4.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.4.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4">subscript</csymbol><sum id="A3.E16X.2.1.1.m1.3.3.3.4.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.2"></sum><apply id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3"><eq id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.1"></eq><ci id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.2">𝑡</ci><cn type="integer" id="A3.E16X.2.1.1.m1.3.3.3.4.2.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.2.3.3">0</cn></apply></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.4.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.3"><minus id="A3.E16X.2.1.1.m1.3.3.3.4.3.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.1"></minus><ci id="A3.E16X.2.1.1.m1.3.3.3.4.3.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.2">𝑇</ci><cn type="integer" id="A3.E16X.2.1.1.m1.3.3.3.4.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.4.3.3">1</cn></apply></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3"><times id="A3.E16X.2.1.1.m1.3.3.3.3.4.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.4"></times><apply id="A3.E16X.2.1.1.m1.3.3.3.3.5.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5"><apply id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1"><apply id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1">subscript</csymbol><ci id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.2">∇</ci><ci id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.1.3">𝜃</ci></apply><log id="A3.E16X.2.1.1.m1.3.3.3.3.5.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.1.2"></log></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2">subscript</csymbol><ci id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2.2">𝜋</ci><ci id="A3.E16X.2.1.1.m1.3.3.3.3.5.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.5.2.3">𝜃</ci></apply></apply><interval closure="open" id="A3.E16X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2"><apply id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2"><ci id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.E16X.2.1.1.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2"><ci id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1"><minus id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.4.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.4"></minus><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2"><times id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.3"></times><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.4.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.4">𝑄</ci><interval closure="open" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2"><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2"><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2"><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.1">^</ci><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3"><times id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.2"></times><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.3">𝑉</ci><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1">subscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1">superscript</csymbol><apply id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2"><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.1.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.1">^</ci><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.2.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.2.2">𝑠</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.3.cmml" xref="A3.E16X.2.1.1.m1.3.3.3.3.3.1.1.3.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E16X.2.1.1.m1.3c">\displaystyle\nabla_{\theta}J\approx\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(Q(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})-V(\hat{s}^{\theta}_{t})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(16)</span></td>
</tr>
<tr id="A3.E16Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E16Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(r(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})+V(\hat{s}^{\theta}_{t+1})-V(\hat{s}^{\theta}_{t})\right)," display="inline"><semantics id="A3.E16Xa.2.1.1.m1.1a"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.5" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.5.cmml"></mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.4.cmml">=</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.cmml"><munderover id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4a" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.cmml"><mo movablelimits="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.2.cmml">∑</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml">t</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml">=</mo><mn id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml">0</mn></mrow><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.2.cmml">T</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.1.cmml">−</mo><mn id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.cmml"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.cmml"><msub id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml">∇</mo><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml">θ</mi></msub><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5a" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.cmml">⁡</mo><msub id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml">π</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.5" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4a" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml">​</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">(</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml"><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml">​</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3.cmml"><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3.cmml">(</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msubsup><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3.cmml">,</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.2.cmml">s</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.5" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.4.cmml">+</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml">V</mi><mo lspace="0em" rspace="0em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml">​</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.cmml"><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.cmml">(</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.2.cmml">s</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.2.cmml">t</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.1.cmml">+</mo><mn id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.3.cmml">1</mn></mrow><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.5" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.5.cmml">−</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.3.cmml">V</mi><mo lspace="0em" rspace="0em" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.2.cmml">​</mo><mrow id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.cmml"><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.cmml">(</mo><msubsup id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.cmml"><mover accent="true" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.cmml"><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.2.cmml">s</mi><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.1" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.3.cmml">t</mi><mi id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.3.cmml">θ</mi></msubsup><mo stretchy="false" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E16Xa.2.1.1.m1.1.1.1.2" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E16Xa.2.1.1.m1.1b"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1"><eq id="A3.E16Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.4"></eq><csymbol cd="latexml" id="A3.E16Xa.2.1.1.m1.1.1.1.1.5.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.5">absent</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4">subscript</csymbol><sum id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.2"></sum><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3"><eq id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.1"></eq><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.2">𝑡</ci><cn type="integer" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.2.3.3">0</cn></apply></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3"><minus id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.1"></minus><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.2">𝑇</ci><cn type="integer" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.4.3.3">1</cn></apply></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3"><times id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.4"></times><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1">subscript</csymbol><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.2">∇</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.1.3">𝜃</ci></apply><log id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.1.2"></log></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2">subscript</csymbol><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.2">𝜋</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.5.2.3">𝜃</ci></apply></apply><interval closure="open" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1"><minus id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.5.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.5"></minus><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3"><plus id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.4"></plus><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2"><times id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.3"></times><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.4">𝑟</ci><interval closure="open" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2"><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.2.2">𝑎</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.2.2">𝑠</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.2.3">𝜃</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3"><times id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.2"></times><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.3">𝑉</ci><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.2.2">𝑠</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.2.3">𝜃</ci></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3"><plus id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.1"></plus><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.2">𝑡</ci><cn type="integer" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.3.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4"><times id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.2"></times><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.3">𝑉</ci><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1">subscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1"><csymbol cd="ambiguous" id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1">superscript</csymbol><apply id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2"><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.1.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.1">^</ci><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.2.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.2.2">𝑠</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.2.3">𝜃</ci></apply><ci id="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.3.cmml" xref="A3.E16Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.4.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E16Xa.2.1.1.m1.1c">\displaystyle=\sum_{t=0}^{T-1}\nabla_{\theta}\log\pi_{\theta}(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})\left(r(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})+V(\hat{s}^{\theta}_{t+1})-V(\hat{s}^{\theta}_{t})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="A3.SS1.p7.8" class="ltx_p">where <math id="A3.SS1.p7.3.m1.1" class="ltx_math_unparsed" alttext="r(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})+V(\hat{s}^{\theta}_{t+1})-V(\hat{s}^{\theta}_{t}" display="inline"><semantics id="A3.SS1.p7.3.m1.1a"><mrow id="A3.SS1.p7.3.m1.1b"><mi id="A3.SS1.p7.3.m1.1.1">r</mi><mrow id="A3.SS1.p7.3.m1.1.2"><mo stretchy="false" id="A3.SS1.p7.3.m1.1.2.1">(</mo><msubsup id="A3.SS1.p7.3.m1.1.2.2"><mover accent="true" id="A3.SS1.p7.3.m1.1.2.2.2.2"><mi id="A3.SS1.p7.3.m1.1.2.2.2.2.2">a</mi><mo id="A3.SS1.p7.3.m1.1.2.2.2.2.1">^</mo></mover><mi id="A3.SS1.p7.3.m1.1.2.2.3">t</mi><mi id="A3.SS1.p7.3.m1.1.2.2.2.3">θ</mi></msubsup><mo id="A3.SS1.p7.3.m1.1.2.3">,</mo><msubsup id="A3.SS1.p7.3.m1.1.2.4"><mover accent="true" id="A3.SS1.p7.3.m1.1.2.4.2.2"><mi id="A3.SS1.p7.3.m1.1.2.4.2.2.2">s</mi><mo id="A3.SS1.p7.3.m1.1.2.4.2.2.1">^</mo></mover><mi id="A3.SS1.p7.3.m1.1.2.4.3">t</mi><mi id="A3.SS1.p7.3.m1.1.2.4.2.3">θ</mi></msubsup><mo stretchy="false" id="A3.SS1.p7.3.m1.1.2.5">)</mo></mrow><mo id="A3.SS1.p7.3.m1.1.3">+</mo><mi id="A3.SS1.p7.3.m1.1.4">V</mi><mrow id="A3.SS1.p7.3.m1.1.5"><mo stretchy="false" id="A3.SS1.p7.3.m1.1.5.1">(</mo><msubsup id="A3.SS1.p7.3.m1.1.5.2"><mover accent="true" id="A3.SS1.p7.3.m1.1.5.2.2.2"><mi id="A3.SS1.p7.3.m1.1.5.2.2.2.2">s</mi><mo id="A3.SS1.p7.3.m1.1.5.2.2.2.1">^</mo></mover><mrow id="A3.SS1.p7.3.m1.1.5.2.3"><mi id="A3.SS1.p7.3.m1.1.5.2.3.2">t</mi><mo id="A3.SS1.p7.3.m1.1.5.2.3.1">+</mo><mn id="A3.SS1.p7.3.m1.1.5.2.3.3">1</mn></mrow><mi id="A3.SS1.p7.3.m1.1.5.2.2.3">θ</mi></msubsup><mo stretchy="false" id="A3.SS1.p7.3.m1.1.5.3">)</mo></mrow><mo id="A3.SS1.p7.3.m1.1.6">−</mo><mi id="A3.SS1.p7.3.m1.1.7">V</mi><mrow id="A3.SS1.p7.3.m1.1.8"><mo stretchy="false" id="A3.SS1.p7.3.m1.1.8.1">(</mo><msubsup id="A3.SS1.p7.3.m1.1.8.2"><mover accent="true" id="A3.SS1.p7.3.m1.1.8.2.2.2"><mi id="A3.SS1.p7.3.m1.1.8.2.2.2.2">s</mi><mo id="A3.SS1.p7.3.m1.1.8.2.2.2.1">^</mo></mover><mi id="A3.SS1.p7.3.m1.1.8.2.3">t</mi><mi id="A3.SS1.p7.3.m1.1.8.2.2.3">θ</mi></msubsup></mrow></mrow><annotation encoding="application/x-tex" id="A3.SS1.p7.3.m1.1c">r(\hat{a}^{\theta}_{t},\hat{s}^{\theta}_{t})+V(\hat{s}^{\theta}_{t+1})-V(\hat{s}^{\theta}_{t}</annotation></semantics></math> is summarized as an “advantage” <math id="A3.SS1.p7.4.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A3.SS1.p7.4.m2.1a"><mi id="A3.SS1.p7.4.m2.1.1" xref="A3.SS1.p7.4.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.4.m2.1b"><ci id="A3.SS1.p7.4.m2.1.1.cmml" xref="A3.SS1.p7.4.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.4.m2.1c">A</annotation></semantics></math>.
Looking closely to Equation (<a href="#A3.E16" title="In C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>), if <math id="A3.SS1.p7.5.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A3.SS1.p7.5.m3.1a"><mi id="A3.SS1.p7.5.m3.1.1" xref="A3.SS1.p7.5.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.5.m3.1b"><ci id="A3.SS1.p7.5.m3.1.1.cmml" xref="A3.SS1.p7.5.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.5.m3.1c">A</annotation></semantics></math> is positive, to increase <math id="A3.SS1.p7.6.m4.1" class="ltx_Math" alttext="J" display="inline"><semantics id="A3.SS1.p7.6.m4.1a"><mi id="A3.SS1.p7.6.m4.1.1" xref="A3.SS1.p7.6.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.6.m4.1b"><ci id="A3.SS1.p7.6.m4.1.1.cmml" xref="A3.SS1.p7.6.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.6.m4.1c">J</annotation></semantics></math>, the policy making network will be optimized to enhance the probability of action <math id="A3.SS1.p7.7.m5.1" class="ltx_Math" alttext="\hat{a}_{t}^{\theta}" display="inline"><semantics id="A3.SS1.p7.7.m5.1a"><msubsup id="A3.SS1.p7.7.m5.1.1" xref="A3.SS1.p7.7.m5.1.1.cmml"><mover accent="true" id="A3.SS1.p7.7.m5.1.1.2.2" xref="A3.SS1.p7.7.m5.1.1.2.2.cmml"><mi id="A3.SS1.p7.7.m5.1.1.2.2.2" xref="A3.SS1.p7.7.m5.1.1.2.2.2.cmml">a</mi><mo id="A3.SS1.p7.7.m5.1.1.2.2.1" xref="A3.SS1.p7.7.m5.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p7.7.m5.1.1.2.3" xref="A3.SS1.p7.7.m5.1.1.2.3.cmml">t</mi><mi id="A3.SS1.p7.7.m5.1.1.3" xref="A3.SS1.p7.7.m5.1.1.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.7.m5.1b"><apply id="A3.SS1.p7.7.m5.1.1.cmml" xref="A3.SS1.p7.7.m5.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.7.m5.1.1.1.cmml" xref="A3.SS1.p7.7.m5.1.1">superscript</csymbol><apply id="A3.SS1.p7.7.m5.1.1.2.cmml" xref="A3.SS1.p7.7.m5.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.7.m5.1.1.2.1.cmml" xref="A3.SS1.p7.7.m5.1.1">subscript</csymbol><apply id="A3.SS1.p7.7.m5.1.1.2.2.cmml" xref="A3.SS1.p7.7.m5.1.1.2.2"><ci id="A3.SS1.p7.7.m5.1.1.2.2.1.cmml" xref="A3.SS1.p7.7.m5.1.1.2.2.1">^</ci><ci id="A3.SS1.p7.7.m5.1.1.2.2.2.cmml" xref="A3.SS1.p7.7.m5.1.1.2.2.2">𝑎</ci></apply><ci id="A3.SS1.p7.7.m5.1.1.2.3.cmml" xref="A3.SS1.p7.7.m5.1.1.2.3">𝑡</ci></apply><ci id="A3.SS1.p7.7.m5.1.1.3.cmml" xref="A3.SS1.p7.7.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.7.m5.1c">\hat{a}_{t}^{\theta}</annotation></semantics></math> under state <math id="A3.SS1.p7.8.m6.1" class="ltx_Math" alttext="\hat{s}_{t}^{\theta}" display="inline"><semantics id="A3.SS1.p7.8.m6.1a"><msubsup id="A3.SS1.p7.8.m6.1.1" xref="A3.SS1.p7.8.m6.1.1.cmml"><mover accent="true" id="A3.SS1.p7.8.m6.1.1.2.2" xref="A3.SS1.p7.8.m6.1.1.2.2.cmml"><mi id="A3.SS1.p7.8.m6.1.1.2.2.2" xref="A3.SS1.p7.8.m6.1.1.2.2.2.cmml">s</mi><mo id="A3.SS1.p7.8.m6.1.1.2.2.1" xref="A3.SS1.p7.8.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.SS1.p7.8.m6.1.1.2.3" xref="A3.SS1.p7.8.m6.1.1.2.3.cmml">t</mi><mi id="A3.SS1.p7.8.m6.1.1.3" xref="A3.SS1.p7.8.m6.1.1.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p7.8.m6.1b"><apply id="A3.SS1.p7.8.m6.1.1.cmml" xref="A3.SS1.p7.8.m6.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.8.m6.1.1.1.cmml" xref="A3.SS1.p7.8.m6.1.1">superscript</csymbol><apply id="A3.SS1.p7.8.m6.1.1.2.cmml" xref="A3.SS1.p7.8.m6.1.1"><csymbol cd="ambiguous" id="A3.SS1.p7.8.m6.1.1.2.1.cmml" xref="A3.SS1.p7.8.m6.1.1">subscript</csymbol><apply id="A3.SS1.p7.8.m6.1.1.2.2.cmml" xref="A3.SS1.p7.8.m6.1.1.2.2"><ci id="A3.SS1.p7.8.m6.1.1.2.2.1.cmml" xref="A3.SS1.p7.8.m6.1.1.2.2.1">^</ci><ci id="A3.SS1.p7.8.m6.1.1.2.2.2.cmml" xref="A3.SS1.p7.8.m6.1.1.2.2.2">𝑠</ci></apply><ci id="A3.SS1.p7.8.m6.1.1.2.3.cmml" xref="A3.SS1.p7.8.m6.1.1.2.3">𝑡</ci></apply><ci id="A3.SS1.p7.8.m6.1.1.3.cmml" xref="A3.SS1.p7.8.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p7.8.m6.1c">\hat{s}_{t}^{\theta}</annotation></semantics></math>.
In our proposed framework, the actions are within finite selections of the choreographic memory. Hence, the optimization along with Equation (<a href="#A3.E16" title="In C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>) is equivalent to the the optimization via an weighted cross-entropy loss on the in-time self predictions of the policy making network:</p>
<table id="A3.E17" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A3.E17X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.E17X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{AC}^{\text{on}}=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(\hat{a}^{\theta}_{t}|\hat{s}^{\theta}_{t})\right)\cdot A." display="inline"><semantics id="A3.E17X.2.1.1.m1.2a"><mrow id="A3.E17X.2.1.1.m1.2.2.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.cmml"><mrow id="A3.E17X.2.1.1.m1.2.2.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.cmml"><msubsup id="A3.E17X.2.1.1.m1.2.2.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.2.cmml">ℒ</mi><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.3.cmml">C</mi></mrow><mtext id="A3.E17X.2.1.1.m1.2.2.1.1.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.3a.cmml">on</mtext></msubsup><mo id="A3.E17X.2.1.1.m1.2.2.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.cmml"><munderover id="A3.E17X.2.1.1.m1.2.2.1.1.1.3a" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.cmml"><mo movablelimits="false" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.2.cmml">∑</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.2.cmml">t</mi><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.1.cmml">=</mo><mn id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.2.cmml">T</mi><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.cmml"><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A3.E17X.2.1.1.m1.1.1" xref="A3.E17X.2.1.1.m1.1.1.cmml">log</mi><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1a" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">a</mi><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msubsup><mo fence="false" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">s</mi><mo id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msubsup></mrow><mo stretchy="false" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.2.cmml">⋅</mo><mi id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.3" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.3.cmml">A</mi></mrow></mrow></mrow><mo lspace="0em" id="A3.E17X.2.1.1.m1.2.2.1.2" xref="A3.E17X.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E17X.2.1.1.m1.2b"><apply id="A3.E17X.2.1.1.m1.2.2.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1"><eq id="A3.E17X.2.1.1.m1.2.2.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.2"></eq><apply id="A3.E17X.2.1.1.m1.2.2.1.1.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3">superscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.2">ℒ</ci><apply id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3"><times id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.1"></times><ci id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.2">𝐴</ci><ci id="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.2.3.3">𝐶</ci></apply></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.3.3a.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.3"><mtext mathsize="70%" id="A3.E17X.2.1.1.m1.2.2.1.1.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.3.3">on</mtext></ci></apply><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1"><minus id="A3.E17X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.2"></minus><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3">superscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3">subscript</csymbol><sum id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.2"></sum><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3"><eq id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.1"></eq><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3"><minus id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.1"></minus><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.2">𝑇</ci><cn type="integer" id="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1"><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.2">⋅</ci><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1"><log id="A3.E17X.2.1.1.m1.1.1.cmml" xref="A3.E17X.2.1.1.m1.1.1"></log><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><times id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑎</ci></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝜃</ci></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑠</ci></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><ci id="A3.E17X.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="A3.E17X.2.1.1.m1.2.2.1.1.1.1.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E17X.2.1.1.m1.2c">\displaystyle\mathcal{L}_{AC}^{\text{on}}=\sum_{t=0}^{T-1}-\log\left(\pi_{\theta}(\hat{a}^{\theta}_{t}|\hat{s}^{\theta}_{t})\right)\cdot A.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(17)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Algorithm Pipeline of Proposed Off-Policy RL</h3>

<div id="A3.SS2.p1" class="ltx_para ltx_noindent">
<p id="A3.SS2.p1.1" class="ltx_p">The detailed pipeline of proposed off-policy RL is shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ C.1 Derivation to On-Policy Actor-Critic Loss ‣ Appendix C Reinforcement Learning Details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>More Ablation Studies</h2>

<figure id="A4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span><span id="A4.T4.17.1" class="ltx_text ltx_font_bold">Ablation studies for music input.</span> <span id="A4.T4.18.2" class="ltx_ERROR undefined">\epsdice</span>5 represents random music input.
</figcaption>
<table id="A4.T4.14" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T4.14.15" class="ltx_tr">
<td id="A4.T4.14.15.1" class="ltx_td ltx_border_tt" style="padding-left:4.8pt;padding-right:4.8pt;"></td>
<td id="A4.T4.14.15.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.8pt;padding-right:4.8pt;" colspan="4">Solo Metrics</td>
<td id="A4.T4.14.15.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.8pt;padding-right:4.8pt;" colspan="4">Interactive Metrics</td>
<td id="A4.T4.14.15.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.8pt;padding-right:4.8pt;">Rhythmic</td>
</tr>
<tr id="A4.T4.14.14" class="ltx_tr">
<td id="A4.T4.14.14.15" class="ltx_td ltx_align_left" style="padding-left:4.8pt;padding-right:4.8pt;">Method</td>
<td id="A4.T4.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">FID<sub id="A4.T4.2.2.2.1" class="ltx_sub"><span id="A4.T4.2.2.2.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="A4.T4.2.2.2.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T4.2.2.2.m2.1a"><mo stretchy="false" id="A4.T4.2.2.2.m2.1.1" xref="A4.T4.2.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.2.2.2.m2.1b"><ci id="A4.T4.2.2.2.m2.1.1.cmml" xref="A4.T4.2.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.2.2.2.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T4.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">FID<sub id="A4.T4.4.4.4.1" class="ltx_sub"><span id="A4.T4.4.4.4.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="A4.T4.4.4.4.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T4.4.4.4.m2.1a"><mo stretchy="false" id="A4.T4.4.4.4.m2.1.1" xref="A4.T4.4.4.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.4.4.4.m2.1b"><ci id="A4.T4.4.4.4.m2.1.1.cmml" xref="A4.T4.4.4.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.4.4.4.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T4.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">Div<sub id="A4.T4.6.6.6.1" class="ltx_sub"><span id="A4.T4.6.6.6.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="A4.T4.6.6.6.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T4.6.6.6.m2.1a"><mo stretchy="false" id="A4.T4.6.6.6.m2.1.1" xref="A4.T4.6.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.6.6.6.m2.1b"><ci id="A4.T4.6.6.6.m2.1.1.cmml" xref="A4.T4.6.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.6.6.6.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T4.8.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">Div<sub id="A4.T4.8.8.8.1" class="ltx_sub"><span id="A4.T4.8.8.8.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="A4.T4.8.8.8.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T4.8.8.8.m2.1a"><mo stretchy="false" id="A4.T4.8.8.8.m2.1.1" xref="A4.T4.8.8.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.8.8.8.m2.1b"><ci id="A4.T4.8.8.8.m2.1.1.cmml" xref="A4.T4.8.8.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.8.8.8.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T4.10.10.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">FID<sub id="A4.T4.10.10.10.1" class="ltx_sub"><span id="A4.T4.10.10.10.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="A4.T4.10.10.10.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T4.10.10.10.m2.1a"><mo stretchy="false" id="A4.T4.10.10.10.m2.1.1" xref="A4.T4.10.10.10.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.10.10.10.m2.1b"><ci id="A4.T4.10.10.10.m2.1.1.cmml" xref="A4.T4.10.10.10.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.10.10.10.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T4.12.12.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">Div<sub id="A4.T4.12.12.12.1" class="ltx_sub"><span id="A4.T4.12.12.12.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="A4.T4.12.12.12.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T4.12.12.12.m2.1a"><mo stretchy="false" id="A4.T4.12.12.12.m2.1.1" xref="A4.T4.12.12.12.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.12.12.12.m2.1b"><ci id="A4.T4.12.12.12.m2.1.1.cmml" xref="A4.T4.12.12.12.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.12.12.12.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T4.14.14.16" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">CF(%)</td>
<td id="A4.T4.13.13.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">BED(<math id="A4.T4.13.13.13.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T4.13.13.13.m1.1a"><mo stretchy="false" id="A4.T4.13.13.13.m1.1.1" xref="A4.T4.13.13.13.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.13.13.13.m1.1b"><ci id="A4.T4.13.13.13.m1.1.1.cmml" xref="A4.T4.13.13.13.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.13.13.13.m1.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T4.14.14.14" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">BAS(<math id="A4.T4.14.14.14.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T4.14.14.14.m1.1a"><mo stretchy="false" id="A4.T4.14.14.14.m1.1.1" xref="A4.T4.14.14.14.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.14.14.14.m1.1b"><ci id="A4.T4.14.14.14.m1.1.1.cmml" xref="A4.T4.14.14.14.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.14.14.14.m1.1c">\uparrow</annotation></semantics></math>)</td>
</tr>
<tr id="A4.T4.14.16" class="ltx_tr">
<td id="A4.T4.14.16.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">Ground Truth</td>
<td id="A4.T4.14.16.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">    6.56</td>
<td id="A4.T4.14.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">   6.37</td>
<td id="A4.T4.14.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">11.31</td>
<td id="A4.T4.14.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">7.61</td>
<td id="A4.T4.14.16.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">3.41</td>
<td id="A4.T4.14.16.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">12.35</td>
<td id="A4.T4.14.16.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">74.25</td>
<td id="A4.T4.14.16.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">0.5308</td>
<td id="A4.T4.14.16.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.8pt;padding-right:4.8pt;">0.1842</td>
</tr>
<tr id="A4.T4.14.17" class="ltx_tr">
<td id="A4.T4.14.17.1" class="ltx_td ltx_align_left" style="padding-left:4.8pt;padding-right:4.8pt;">Ground Truth (<span id="A4.T4.14.17.1.1" class="ltx_ERROR undefined">\epsdice</span>5)</td>
<td id="A4.T4.14.17.2" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">    6.56</td>
<td id="A4.T4.14.17.3" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">   6.37</td>
<td id="A4.T4.14.17.4" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">11.31</td>
<td id="A4.T4.14.17.5" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">7.61</td>
<td id="A4.T4.14.17.6" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">3.41</td>
<td id="A4.T4.14.17.7" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">12.35</td>
<td id="A4.T4.14.17.8" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">74.25</td>
<td id="A4.T4.14.17.9" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">0.5308</td>
<td id="A4.T4.14.17.10" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">0.1760</td>
</tr>
<tr id="A4.T4.14.18" class="ltx_tr">
<td id="A4.T4.14.18.1" class="ltx_td ltx_align_left" style="padding-left:4.8pt;padding-right:4.8pt;"><span id="A4.T4.14.18.1.1" class="ltx_text ltx_font_italic">Duolando</span></td>
<td id="A4.T4.14.18.2" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">  25.30</td>
<td id="A4.T4.14.18.3" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">33.52</td>
<td id="A4.T4.14.18.4" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">10.92</td>
<td id="A4.T4.14.18.5" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">7.97</td>
<td id="A4.T4.14.18.6" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">9.97</td>
<td id="A4.T4.14.18.7" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">14.02</td>
<td id="A4.T4.14.18.8" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">52.36</td>
<td id="A4.T4.14.18.9" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">0.2858</td>
<td id="A4.T4.14.18.10" class="ltx_td ltx_align_center" style="padding-left:4.8pt;padding-right:4.8pt;">0.2046</td>
</tr>
<tr id="A4.T4.14.19" class="ltx_tr">
<td id="A4.T4.14.19.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">
<span id="A4.T4.14.19.1.1" class="ltx_text ltx_font_italic">Duolando</span> (<span id="A4.T4.14.19.1.2" class="ltx_ERROR undefined">\epsdice</span>5)</td>
<td id="A4.T4.14.19.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">  23.73</td>
<td id="A4.T4.14.19.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">35.91</td>
<td id="A4.T4.14.19.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">10.95</td>
<td id="A4.T4.14.19.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">8.36</td>
<td id="A4.T4.14.19.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">7.77</td>
<td id="A4.T4.14.19.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">13.96</td>
<td id="A4.T4.14.19.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">51.77</td>
<td id="A4.T4.14.19.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">0.2582</td>
<td id="A4.T4.14.19.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.8pt;padding-right:4.8pt;">0.2072</td>
</tr>
</table>
</figure>
<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Music</h3>

<div id="A4.SS1.p1" class="ltx_para ltx_noindent">
<p id="A4.SS1.p1.6" class="ltx_p">To explore the case when the music and the leader are not aligned, we randomize the music input during the test phase. The experimental results are shown in Table <a href="#A4.T4" title="Table 4 ‣ Appendix D More Ablation Studies ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, where the random music input are noted with <math id="A4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\epsdice{5}" display="inline"><semantics id="A4.SS1.p1.1.m1.1a"><mrow id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="A4.SS1.p1.1.m1.1.1.2" xref="A4.SS1.p1.1.m1.1.1.2b.cmml"><mtext id="A4.SS1.p1.1.m1.1.1.2a" xref="A4.SS1.p1.1.m1.1.1.2b.cmml">\epsdice</mtext></merror><mo lspace="0em" rspace="0em" id="A4.SS1.p1.1.m1.1.1.1" xref="A4.SS1.p1.1.m1.1.1.1.cmml">​</mo><mn id="A4.SS1.p1.1.m1.1.1.3" xref="A4.SS1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><apply id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1"><times id="A4.SS1.p1.1.m1.1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1.1"></times><ci id="A4.SS1.p1.1.m1.1.1.2b.cmml" xref="A4.SS1.p1.1.m1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="A4.SS1.p1.1.m1.1.1.2.cmml" xref="A4.SS1.p1.1.m1.1.1.2"><mtext id="A4.SS1.p1.1.m1.1.1.2a.cmml" xref="A4.SS1.p1.1.m1.1.1.2">\epsdice</mtext></merror></ci><cn type="integer" id="A4.SS1.p1.1.m1.1.1.3.cmml" xref="A4.SS1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">\epsdice{5}</annotation></semantics></math>. Interestingly, the BAS of <span id="A4.SS1.p1.6.1" class="ltx_text ltx_font_italic">Duolando</span> (<math id="A4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\epsdice{5}" display="inline"><semantics id="A4.SS1.p1.2.m2.1a"><mrow id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="A4.SS1.p1.2.m2.1.1.2" xref="A4.SS1.p1.2.m2.1.1.2b.cmml"><mtext id="A4.SS1.p1.2.m2.1.1.2a" xref="A4.SS1.p1.2.m2.1.1.2b.cmml">\epsdice</mtext></merror><mo lspace="0em" rspace="0em" id="A4.SS1.p1.2.m2.1.1.1" xref="A4.SS1.p1.2.m2.1.1.1.cmml">​</mo><mn id="A4.SS1.p1.2.m2.1.1.3" xref="A4.SS1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><apply id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1"><times id="A4.SS1.p1.2.m2.1.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1.1"></times><ci id="A4.SS1.p1.2.m2.1.1.2b.cmml" xref="A4.SS1.p1.2.m2.1.1.2"><merror class="ltx_ERROR undefined undefined" id="A4.SS1.p1.2.m2.1.1.2.cmml" xref="A4.SS1.p1.2.m2.1.1.2"><mtext id="A4.SS1.p1.2.m2.1.1.2a.cmml" xref="A4.SS1.p1.2.m2.1.1.2">\epsdice</mtext></merror></ci><cn type="integer" id="A4.SS1.p1.2.m2.1.1.3.cmml" xref="A4.SS1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">\epsdice{5}</annotation></semantics></math>) even increases by <math id="A4.SS1.p1.3.m3.1" class="ltx_Math" alttext="0.0026" display="inline"><semantics id="A4.SS1.p1.3.m3.1a"><mn id="A4.SS1.p1.3.m3.1.1" xref="A4.SS1.p1.3.m3.1.1.cmml">0.0026</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m3.1b"><cn type="float" id="A4.SS1.p1.3.m3.1.1.cmml" xref="A4.SS1.p1.3.m3.1.1">0.0026</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m3.1c">0.0026</annotation></semantics></math> (<math id="A4.SS1.p1.4.m4.1" class="ltx_Math" alttext="1.3\%" display="inline"><semantics id="A4.SS1.p1.4.m4.1a"><mrow id="A4.SS1.p1.4.m4.1.1" xref="A4.SS1.p1.4.m4.1.1.cmml"><mn id="A4.SS1.p1.4.m4.1.1.2" xref="A4.SS1.p1.4.m4.1.1.2.cmml">1.3</mn><mo id="A4.SS1.p1.4.m4.1.1.1" xref="A4.SS1.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.4.m4.1b"><apply id="A4.SS1.p1.4.m4.1.1.cmml" xref="A4.SS1.p1.4.m4.1.1"><csymbol cd="latexml" id="A4.SS1.p1.4.m4.1.1.1.cmml" xref="A4.SS1.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="A4.SS1.p1.4.m4.1.1.2.cmml" xref="A4.SS1.p1.4.m4.1.1.2">1.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.4.m4.1c">1.3\%</annotation></semantics></math>) compared to that from the correct musics, while BED score decreases by <math id="A4.SS1.p1.5.m5.1" class="ltx_Math" alttext="0.0276" display="inline"><semantics id="A4.SS1.p1.5.m5.1a"><mn id="A4.SS1.p1.5.m5.1.1" xref="A4.SS1.p1.5.m5.1.1.cmml">0.0276</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.5.m5.1b"><cn type="float" id="A4.SS1.p1.5.m5.1.1.cmml" xref="A4.SS1.p1.5.m5.1.1">0.0276</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.5.m5.1c">0.0276</annotation></semantics></math> (<math id="A4.SS1.p1.6.m6.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="A4.SS1.p1.6.m6.1a"><mrow id="A4.SS1.p1.6.m6.1.1" xref="A4.SS1.p1.6.m6.1.1.cmml"><mn id="A4.SS1.p1.6.m6.1.1.2" xref="A4.SS1.p1.6.m6.1.1.2.cmml">10</mn><mo id="A4.SS1.p1.6.m6.1.1.1" xref="A4.SS1.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.6.m6.1b"><apply id="A4.SS1.p1.6.m6.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1"><csymbol cd="latexml" id="A4.SS1.p1.6.m6.1.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1.1">percent</csymbol><cn type="integer" id="A4.SS1.p1.6.m6.1.1.2.cmml" xref="A4.SS1.p1.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.6.m6.1c">10\%</annotation></semantics></math>), implying the music signal have a significant impact on the rhythm of generated follower’s motion in our proposed framework.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Looking Ahead</h3>

<div id="A4.SS2.p1" class="ltx_para ltx_noindent">
<p id="A4.SS2.p1.4" class="ltx_p">We conduct an ablation study on the looking-ahead mechanism, and we train a variant “Duolando w/o. RL LA” where the LAT is substituted to single linear layer to map each token’s embedding to the same dimension as LAT (see Table <a href="#A4.T5" title="Table 5 ‣ D.2 Looking Ahead ‣ Appendix D More Ablation Studies ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
<span id="A4.SS2.p1.4.4" class="ltx_text" style="color:#000000;">As to the effect of <span id="A4.SS2.p1.4.4.1" class="ltx_text ltx_font_italic">looking ahead</span>, compared with “Duolando w/o. RL”, the variant without LAT shows a salient drop on FID<sub id="A4.SS2.p1.4.4.2" class="ltx_sub"><span id="A4.SS2.p1.4.4.2.1" class="ltx_text ltx_font_italic">k</span></sub> (<math id="A4.SS2.p1.2.2.m2.1" class="ltx_Math" alttext="26.01" display="inline"><semantics id="A4.SS2.p1.2.2.m2.1a"><mn mathcolor="#000000" id="A4.SS2.p1.2.2.m2.1.1" xref="A4.SS2.p1.2.2.m2.1.1.cmml">26.01</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.2.m2.1b"><cn type="float" id="A4.SS2.p1.2.2.m2.1.1.cmml" xref="A4.SS2.p1.2.2.m2.1.1">26.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.2.m2.1c">26.01</annotation></semantics></math>, <math id="A4.SS2.p1.3.3.m3.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="A4.SS2.p1.3.3.m3.1a"><mrow id="A4.SS2.p1.3.3.m3.1.1" xref="A4.SS2.p1.3.3.m3.1.1.cmml"><mn mathcolor="#000000" id="A4.SS2.p1.3.3.m3.1.1.2" xref="A4.SS2.p1.3.3.m3.1.1.2.cmml">20</mn><mo mathcolor="#000000" id="A4.SS2.p1.3.3.m3.1.1.1" xref="A4.SS2.p1.3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.3.m3.1b"><apply id="A4.SS2.p1.3.3.m3.1.1.cmml" xref="A4.SS2.p1.3.3.m3.1.1"><csymbol cd="latexml" id="A4.SS2.p1.3.3.m3.1.1.1.cmml" xref="A4.SS2.p1.3.3.m3.1.1.1">percent</csymbol><cn type="integer" id="A4.SS2.p1.3.3.m3.1.1.2.cmml" xref="A4.SS2.p1.3.3.m3.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.3.m3.1c">20\%</annotation></semantics></math>) while the interactive metrics do not significantly change (less than <math id="A4.SS2.p1.4.4.m4.1" class="ltx_Math" alttext="7\%" display="inline"><semantics id="A4.SS2.p1.4.4.m4.1a"><mrow id="A4.SS2.p1.4.4.m4.1.1" xref="A4.SS2.p1.4.4.m4.1.1.cmml"><mn mathcolor="#000000" id="A4.SS2.p1.4.4.m4.1.1.2" xref="A4.SS2.p1.4.4.m4.1.1.2.cmml">7</mn><mo mathcolor="#000000" id="A4.SS2.p1.4.4.m4.1.1.1" xref="A4.SS2.p1.4.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.4.m4.1b"><apply id="A4.SS2.p1.4.4.m4.1.1.cmml" xref="A4.SS2.p1.4.4.m4.1.1"><csymbol cd="latexml" id="A4.SS2.p1.4.4.m4.1.1.1.cmml" xref="A4.SS2.p1.4.4.m4.1.1.1">percent</csymbol><cn type="integer" id="A4.SS2.p1.4.4.m4.1.1.2.cmml" xref="A4.SS2.p1.4.4.m4.1.1.2">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.4.m4.1c">7\%</annotation></semantics></math>). We observe that lacking the ability to look ahead could lean to some sudden changes in the motion flow, making the movement less smooth.</span></p>
</div>
<figure id="A4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="A4.T5.16.1" class="ltx_text ltx_font_bold">Ablation study on <span id="A4.T5.16.1.1" class="ltx_text ltx_font_italic">looking ahead</span> (LA).</span>
</figcaption>
<table id="A4.T5.14" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T5.14.15" class="ltx_tr">
<td id="A4.T5.14.15.1" class="ltx_td ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td id="A4.T5.14.15.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="4">Solo Metrics</td>
<td id="A4.T5.14.15.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="4">Interactive Metrics</td>
<td id="A4.T5.14.15.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">Rhythmic</td>
</tr>
<tr id="A4.T5.14.14" class="ltx_tr">
<td id="A4.T5.14.14.15" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">Method</td>
<td id="A4.T5.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="A4.T5.2.2.2.1" class="ltx_sub"><span id="A4.T5.2.2.2.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="A4.T5.2.2.2.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T5.2.2.2.m2.1a"><mo stretchy="false" id="A4.T5.2.2.2.m2.1.1" xref="A4.T5.2.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T5.2.2.2.m2.1b"><ci id="A4.T5.2.2.2.m2.1.1.cmml" xref="A4.T5.2.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.2.2.2.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T5.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="A4.T5.4.4.4.1" class="ltx_sub"><span id="A4.T5.4.4.4.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="A4.T5.4.4.4.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T5.4.4.4.m2.1a"><mo stretchy="false" id="A4.T5.4.4.4.m2.1.1" xref="A4.T5.4.4.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T5.4.4.4.m2.1b"><ci id="A4.T5.4.4.4.m2.1.1.cmml" xref="A4.T5.4.4.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.4.4.4.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T5.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="A4.T5.6.6.6.1" class="ltx_sub"><span id="A4.T5.6.6.6.1.1" class="ltx_text ltx_font_italic">k</span></sub>(<math id="A4.T5.6.6.6.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T5.6.6.6.m2.1a"><mo stretchy="false" id="A4.T5.6.6.6.m2.1.1" xref="A4.T5.6.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T5.6.6.6.m2.1b"><ci id="A4.T5.6.6.6.m2.1.1.cmml" xref="A4.T5.6.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.6.6.6.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T5.8.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="A4.T5.8.8.8.1" class="ltx_sub"><span id="A4.T5.8.8.8.1.1" class="ltx_text ltx_font_italic">g</span></sub>(<math id="A4.T5.8.8.8.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T5.8.8.8.m2.1a"><mo stretchy="false" id="A4.T5.8.8.8.m2.1.1" xref="A4.T5.8.8.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T5.8.8.8.m2.1b"><ci id="A4.T5.8.8.8.m2.1.1.cmml" xref="A4.T5.8.8.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.8.8.8.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T5.10.10.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FID<sub id="A4.T5.10.10.10.1" class="ltx_sub"><span id="A4.T5.10.10.10.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="A4.T5.10.10.10.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T5.10.10.10.m2.1a"><mo stretchy="false" id="A4.T5.10.10.10.m2.1.1" xref="A4.T5.10.10.10.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T5.10.10.10.m2.1b"><ci id="A4.T5.10.10.10.m2.1.1.cmml" xref="A4.T5.10.10.10.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.10.10.10.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="A4.T5.12.12.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Div<sub id="A4.T5.12.12.12.1" class="ltx_sub"><span id="A4.T5.12.12.12.1.1" class="ltx_text ltx_font_italic">cd</span></sub>(<math id="A4.T5.12.12.12.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T5.12.12.12.m2.1a"><mo stretchy="false" id="A4.T5.12.12.12.m2.1.1" xref="A4.T5.12.12.12.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T5.12.12.12.m2.1b"><ci id="A4.T5.12.12.12.m2.1.1.cmml" xref="A4.T5.12.12.12.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.12.12.12.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T5.14.14.16" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">CF(%)</td>
<td id="A4.T5.13.13.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">BED(<math id="A4.T5.13.13.13.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T5.13.13.13.m1.1a"><mo stretchy="false" id="A4.T5.13.13.13.m1.1.1" xref="A4.T5.13.13.13.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T5.13.13.13.m1.1b"><ci id="A4.T5.13.13.13.m1.1.1.cmml" xref="A4.T5.13.13.13.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.13.13.13.m1.1c">\uparrow</annotation></semantics></math>)</td>
<td id="A4.T5.14.14.14" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">BAS(<math id="A4.T5.14.14.14.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A4.T5.14.14.14.m1.1a"><mo stretchy="false" id="A4.T5.14.14.14.m1.1.1" xref="A4.T5.14.14.14.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T5.14.14.14.m1.1b"><ci id="A4.T5.14.14.14.m1.1.1.cmml" xref="A4.T5.14.14.14.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.14.14.14.m1.1c">\uparrow</annotation></semantics></math>)</td>
</tr>
<tr id="A4.T5.14.16" class="ltx_tr">
<td id="A4.T5.14.16.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Ground Truth</td>
<td id="A4.T5.14.16.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">    6.56</td>
<td id="A4.T5.14.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">   6.37</td>
<td id="A4.T5.14.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">11.31</td>
<td id="A4.T5.14.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">7.61</td>
<td id="A4.T5.14.16.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">      3.41</td>
<td id="A4.T5.14.16.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">12.35</td>
<td id="A4.T5.14.16.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">74.25</td>
<td id="A4.T5.14.16.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.5308</td>
<td id="A4.T5.14.16.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.1839</td>
</tr>
<tr id="A4.T5.14.17" class="ltx_tr">
<td id="A4.T5.14.17.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="A4.T5.14.17.1.1" class="ltx_text ltx_font_italic" style="color:#000000;">Duolando<span id="A4.T5.14.17.1.1.1" class="ltx_text ltx_font_upright"> w/o. RL LA</span></span></td>
<td id="A4.T5.14.17.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">132.73</td>
<td id="A4.T5.14.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">40.22</td>
<td id="A4.T5.14.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">12.94</td>
<td id="A4.T5.14.17.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6.70</td>
<td id="A4.T5.14.17.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">    20.80</td>
<td id="A4.T5.14.17.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">  9.92</td>
<td id="A4.T5.14.17.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">55.81</td>
<td id="A4.T5.14.17.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.2775</td>
<td id="A4.T5.14.17.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.2121</td>
</tr>
<tr id="A4.T5.14.18" class="ltx_tr">
<td id="A4.T5.14.18.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="A4.T5.14.18.1.1" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL</td>
<td id="A4.T5.14.18.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">106.72</td>
<td id="A4.T5.14.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">34.10</td>
<td id="A4.T5.14.18.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">13.88</td>
<td id="A4.T5.14.18.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">7.03</td>
<td id="A4.T5.14.18.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">    21.68</td>
<td id="A4.T5.14.18.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">  9.33</td>
<td id="A4.T5.14.18.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">57.43</td>
<td id="A4.T5.14.18.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">0.2795</td>
<td id="A4.T5.14.18.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">0.2193</td>
</tr>
</table>
</figure>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Skating Effect</h3>

<div id="A4.SS3.p1" class="ltx_para ltx_noindent">
<p id="A4.SS3.p1.11" class="ltx_p">To assess the severity of the skating effect in generated follower motion, we introduce a new metric, the <span id="A4.SS3.p1.11.1" class="ltx_text ltx_font_italic">skating ratio</span> (SR), which represents the proportion of frames exhibiting skating. Specifically, if the speeds of the motions of both legs (represented by the vector from the ankle to the pelvis) are less than a threshold <math id="A4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\chi_{1}" display="inline"><semantics id="A4.SS3.p1.1.m1.1a"><msub id="A4.SS3.p1.1.m1.1.1" xref="A4.SS3.p1.1.m1.1.1.cmml"><mi id="A4.SS3.p1.1.m1.1.1.2" xref="A4.SS3.p1.1.m1.1.1.2.cmml">χ</mi><mn id="A4.SS3.p1.1.m1.1.1.3" xref="A4.SS3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.1.m1.1b"><apply id="A4.SS3.p1.1.m1.1.1.cmml" xref="A4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS3.p1.1.m1.1.1.1.cmml" xref="A4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS3.p1.1.m1.1.1.2.cmml" xref="A4.SS3.p1.1.m1.1.1.2">𝜒</ci><cn type="integer" id="A4.SS3.p1.1.m1.1.1.3.cmml" xref="A4.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.1.m1.1c">\chi_{1}</annotation></semantics></math>, and the global speed at root (pelvis) is greater than a threshold <math id="A4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\chi_{2}" display="inline"><semantics id="A4.SS3.p1.2.m2.1a"><msub id="A4.SS3.p1.2.m2.1.1" xref="A4.SS3.p1.2.m2.1.1.cmml"><mi id="A4.SS3.p1.2.m2.1.1.2" xref="A4.SS3.p1.2.m2.1.1.2.cmml">χ</mi><mn id="A4.SS3.p1.2.m2.1.1.3" xref="A4.SS3.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.2.m2.1b"><apply id="A4.SS3.p1.2.m2.1.1.cmml" xref="A4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS3.p1.2.m2.1.1.1.cmml" xref="A4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="A4.SS3.p1.2.m2.1.1.2.cmml" xref="A4.SS3.p1.2.m2.1.1.2">𝜒</ci><cn type="integer" id="A4.SS3.p1.2.m2.1.1.3.cmml" xref="A4.SS3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.2.m2.1c">\chi_{2}</annotation></semantics></math>, we consider this count as a skating frame. It’s worthy to note that in calculating global movement, we only consider movement on the <math id="A4.SS3.p1.3.m3.1" class="ltx_Math" alttext="x-y" display="inline"><semantics id="A4.SS3.p1.3.m3.1a"><mrow id="A4.SS3.p1.3.m3.1.1" xref="A4.SS3.p1.3.m3.1.1.cmml"><mi id="A4.SS3.p1.3.m3.1.1.2" xref="A4.SS3.p1.3.m3.1.1.2.cmml">x</mi><mo id="A4.SS3.p1.3.m3.1.1.1" xref="A4.SS3.p1.3.m3.1.1.1.cmml">−</mo><mi id="A4.SS3.p1.3.m3.1.1.3" xref="A4.SS3.p1.3.m3.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.3.m3.1b"><apply id="A4.SS3.p1.3.m3.1.1.cmml" xref="A4.SS3.p1.3.m3.1.1"><minus id="A4.SS3.p1.3.m3.1.1.1.cmml" xref="A4.SS3.p1.3.m3.1.1.1"></minus><ci id="A4.SS3.p1.3.m3.1.1.2.cmml" xref="A4.SS3.p1.3.m3.1.1.2">𝑥</ci><ci id="A4.SS3.p1.3.m3.1.1.3.cmml" xref="A4.SS3.p1.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.3.m3.1c">x-y</annotation></semantics></math> plane to account since there exist reasonable vertical shifts (<span id="A4.SS3.p1.11.2" class="ltx_text ltx_font_italic">e.g.</span>, jumping or lifting) that don’t need stepping. Based on the statistics in Figure <a href="#A2.F7" title="Figure 7 ‣ B.1 Speed Statistics ‣ Appendix B More details ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we set <math id="A4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\chi_{1}" display="inline"><semantics id="A4.SS3.p1.4.m4.1a"><msub id="A4.SS3.p1.4.m4.1.1" xref="A4.SS3.p1.4.m4.1.1.cmml"><mi id="A4.SS3.p1.4.m4.1.1.2" xref="A4.SS3.p1.4.m4.1.1.2.cmml">χ</mi><mn id="A4.SS3.p1.4.m4.1.1.3" xref="A4.SS3.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.4.m4.1b"><apply id="A4.SS3.p1.4.m4.1.1.cmml" xref="A4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A4.SS3.p1.4.m4.1.1.1.cmml" xref="A4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="A4.SS3.p1.4.m4.1.1.2.cmml" xref="A4.SS3.p1.4.m4.1.1.2">𝜒</ci><cn type="integer" id="A4.SS3.p1.4.m4.1.1.3.cmml" xref="A4.SS3.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.4.m4.1c">\chi_{1}</annotation></semantics></math> to <math id="A4.SS3.p1.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A4.SS3.p1.5.m5.1a"><mn id="A4.SS3.p1.5.m5.1.1" xref="A4.SS3.p1.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.5.m5.1b"><cn type="integer" id="A4.SS3.p1.5.m5.1.1.cmml" xref="A4.SS3.p1.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.5.m5.1c">1</annotation></semantics></math> cm per frame and <math id="A4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\chi_{2}" display="inline"><semantics id="A4.SS3.p1.6.m6.1a"><msub id="A4.SS3.p1.6.m6.1.1" xref="A4.SS3.p1.6.m6.1.1.cmml"><mi id="A4.SS3.p1.6.m6.1.1.2" xref="A4.SS3.p1.6.m6.1.1.2.cmml">χ</mi><mn id="A4.SS3.p1.6.m6.1.1.3" xref="A4.SS3.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.6.m6.1b"><apply id="A4.SS3.p1.6.m6.1.1.cmml" xref="A4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A4.SS3.p1.6.m6.1.1.1.cmml" xref="A4.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="A4.SS3.p1.6.m6.1.1.2.cmml" xref="A4.SS3.p1.6.m6.1.1.2">𝜒</ci><cn type="integer" id="A4.SS3.p1.6.m6.1.1.3.cmml" xref="A4.SS3.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.6.m6.1c">\chi_{2}</annotation></semantics></math> to <math id="A4.SS3.p1.7.m7.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A4.SS3.p1.7.m7.1a"><mn id="A4.SS3.p1.7.m7.1.1" xref="A4.SS3.p1.7.m7.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.7.m7.1b"><cn type="integer" id="A4.SS3.p1.7.m7.1.1.cmml" xref="A4.SS3.p1.7.m7.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.7.m7.1c">3</annotation></semantics></math> cm per frame. As shown in Table <a href="#A4.T6" title="Table 6 ‣ D.3 Skating Effect ‣ Appendix D More Ablation Studies ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, due to the high quality of mocap collection, the ground truth statistically does not exhibit skating. Meanwhile, the SRs of methods like <span id="A4.SS3.p1.11.3" class="ltx_text ltx_font_italic">Bailando</span>, “<span id="A4.SS3.p1.11.4" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <span id="A4.SS3.p1.11.5" class="ltx_text ltx_font_italic">tr</span> IC” and “Duolando w/o. RL <span id="A4.SS3.p1.11.6" class="ltx_text ltx_font_italic">tr</span>” that directly predict displacement based on steps, are also near to zero. In contrast, after introducing <math id="A4.SS3.p1.8.m8.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="A4.SS3.p1.8.m8.1a"><mrow id="A4.SS3.p1.8.m8.1.1" xref="A4.SS3.p1.8.m8.1.1.cmml"><mi id="A4.SS3.p1.8.m8.1.1.2" xref="A4.SS3.p1.8.m8.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A4.SS3.p1.8.m8.1.1.1" xref="A4.SS3.p1.8.m8.1.1.1.cmml">​</mo><mi id="A4.SS3.p1.8.m8.1.1.3" xref="A4.SS3.p1.8.m8.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.8.m8.1b"><apply id="A4.SS3.p1.8.m8.1.1.cmml" xref="A4.SS3.p1.8.m8.1.1"><times id="A4.SS3.p1.8.m8.1.1.1.cmml" xref="A4.SS3.p1.8.m8.1.1.1"></times><ci id="A4.SS3.p1.8.m8.1.1.2.cmml" xref="A4.SS3.p1.8.m8.1.1.2">𝑡</ci><ci id="A4.SS3.p1.8.m8.1.1.3.cmml" xref="A4.SS3.p1.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.8.m8.1c">tr</annotation></semantics></math>, the frequency of skating steps in “<span id="A4.SS3.p1.11.7" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL” increases to <math id="A4.SS3.p1.9.m9.1" class="ltx_Math" alttext="1.06\%" display="inline"><semantics id="A4.SS3.p1.9.m9.1a"><mrow id="A4.SS3.p1.9.m9.1.1" xref="A4.SS3.p1.9.m9.1.1.cmml"><mn id="A4.SS3.p1.9.m9.1.1.2" xref="A4.SS3.p1.9.m9.1.1.2.cmml">1.06</mn><mo id="A4.SS3.p1.9.m9.1.1.1" xref="A4.SS3.p1.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.9.m9.1b"><apply id="A4.SS3.p1.9.m9.1.1.cmml" xref="A4.SS3.p1.9.m9.1.1"><csymbol cd="latexml" id="A4.SS3.p1.9.m9.1.1.1.cmml" xref="A4.SS3.p1.9.m9.1.1.1">percent</csymbol><cn type="float" id="A4.SS3.p1.9.m9.1.1.2.cmml" xref="A4.SS3.p1.9.m9.1.1.2">1.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.9.m9.1c">1.06\%</annotation></semantics></math>. Despite the follower’s position being more coordinated with the leader in this variant, the skating effect becomes a significant drawback. To address this issue, we employ RL to align the lower body movement to global shift. As a result, the SR was significantly reduced by <math id="A4.SS3.p1.10.m10.1" class="ltx_Math" alttext="0.73" display="inline"><semantics id="A4.SS3.p1.10.m10.1a"><mn id="A4.SS3.p1.10.m10.1.1" xref="A4.SS3.p1.10.m10.1.1.cmml">0.73</mn><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.10.m10.1b"><cn type="float" id="A4.SS3.p1.10.m10.1.1.cmml" xref="A4.SS3.p1.10.m10.1.1">0.73</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.10.m10.1c">0.73</annotation></semantics></math> (<math id="A4.SS3.p1.11.m11.1" class="ltx_Math" alttext="69\%" display="inline"><semantics id="A4.SS3.p1.11.m11.1a"><mrow id="A4.SS3.p1.11.m11.1.1" xref="A4.SS3.p1.11.m11.1.1.cmml"><mn id="A4.SS3.p1.11.m11.1.1.2" xref="A4.SS3.p1.11.m11.1.1.2.cmml">69</mn><mo id="A4.SS3.p1.11.m11.1.1.1" xref="A4.SS3.p1.11.m11.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.11.m11.1b"><apply id="A4.SS3.p1.11.m11.1.1.cmml" xref="A4.SS3.p1.11.m11.1.1"><csymbol cd="latexml" id="A4.SS3.p1.11.m11.1.1.1.cmml" xref="A4.SS3.p1.11.m11.1.1.1">percent</csymbol><cn type="integer" id="A4.SS3.p1.11.m11.1.1.2.cmml" xref="A4.SS3.p1.11.m11.1.1.2">69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.11.m11.1c">69\%</annotation></semantics></math>), demonstrating the effectiveness of the proposed off-policy RL.</p>
</div>
<figure id="A4.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span><span id="A4.T6.5.1" class="ltx_text ltx_font_bold">Skating ratio (SR) of different methods.</span> The SR is calculated as the percentage of the number of frames with negligible leg movement but significant global displacement. </figcaption>
<table id="A4.T6.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A4.T6.1.1" class="ltx_tr">
<td id="A4.T6.1.1.2" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:39.8pt;padding-right:39.8pt;">            Method</td>
<td id="A4.T6.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:39.8pt;padding-right:39.8pt;">            SR (% <math id="A4.T6.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A4.T6.1.1.1.m1.1a"><mo stretchy="false" id="A4.T6.1.1.1.m1.1.1" xref="A4.T6.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T6.1.1.1.m1.1b"><ci id="A4.T6.1.1.1.m1.1.1.cmml" xref="A4.T6.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.1.1.1.m1.1c">\downarrow</annotation></semantics></math>)</td>
</tr>
<tr id="A4.T6.3.4" class="ltx_tr">
<td id="A4.T6.3.4.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:39.8pt;padding-right:39.8pt;">            Ground Truth</td>
<td id="A4.T6.3.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:39.8pt;padding-right:39.8pt;">            0.00</td>
</tr>
<tr id="A4.T6.3.5" class="ltx_tr">
<td id="A4.T6.3.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.3.5.1.1" class="ltx_text ltx_font_italic">Bailando</span> <cite class="ltx_cite ltx_citemacro_citep">(Siyao et al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite></td>
<td id="A4.T6.3.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:39.8pt;padding-right:39.8pt;">            0.00</td>
</tr>
<tr id="A4.T6.3.6" class="ltx_tr">
<td id="A4.T6.3.6.1" class="ltx_td ltx_align_left" style="padding-left:39.8pt;padding-right:39.8pt;">            EDGE <cite class="ltx_cite ltx_citemacro_citep">(Tseng et al., <a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite></td>
<td id="A4.T6.3.6.2" class="ltx_td ltx_align_center" style="padding-left:39.8pt;padding-right:39.8pt;">            0.06</td>
</tr>
<tr id="A4.T6.2.2" class="ltx_tr">
<td id="A4.T6.2.2.1" class="ltx_td ltx_align_left" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.2.2.1.1" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="A4.T6.2.2.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="A4.T6.2.2.1.m1.1a"><mrow id="A4.T6.2.2.1.m1.1.1" xref="A4.T6.2.2.1.m1.1.1.cmml"><mi id="A4.T6.2.2.1.m1.1.1.2" xref="A4.T6.2.2.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A4.T6.2.2.1.m1.1.1.1" xref="A4.T6.2.2.1.m1.1.1.1.cmml">​</mo><mi id="A4.T6.2.2.1.m1.1.1.3" xref="A4.T6.2.2.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.2.2.1.m1.1b"><apply id="A4.T6.2.2.1.m1.1.1.cmml" xref="A4.T6.2.2.1.m1.1.1"><times id="A4.T6.2.2.1.m1.1.1.1.cmml" xref="A4.T6.2.2.1.m1.1.1.1"></times><ci id="A4.T6.2.2.1.m1.1.1.2.cmml" xref="A4.T6.2.2.1.m1.1.1.2">𝑡</ci><ci id="A4.T6.2.2.1.m1.1.1.3.cmml" xref="A4.T6.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.2.2.1.m1.1c">tr</annotation></semantics></math> IC</td>
<td id="A4.T6.2.2.2" class="ltx_td ltx_align_center" style="padding-left:39.8pt;padding-right:39.8pt;">            0.00</td>
</tr>
<tr id="A4.T6.3.3" class="ltx_tr">
<td id="A4.T6.3.3.1" class="ltx_td ltx_align_left" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.3.3.1.1" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL <math id="A4.T6.3.3.1.m1.1" class="ltx_Math" alttext="tr" display="inline"><semantics id="A4.T6.3.3.1.m1.1a"><mrow id="A4.T6.3.3.1.m1.1.1" xref="A4.T6.3.3.1.m1.1.1.cmml"><mi id="A4.T6.3.3.1.m1.1.1.2" xref="A4.T6.3.3.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A4.T6.3.3.1.m1.1.1.1" xref="A4.T6.3.3.1.m1.1.1.1.cmml">​</mo><mi id="A4.T6.3.3.1.m1.1.1.3" xref="A4.T6.3.3.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.3.3.1.m1.1b"><apply id="A4.T6.3.3.1.m1.1.1.cmml" xref="A4.T6.3.3.1.m1.1.1"><times id="A4.T6.3.3.1.m1.1.1.1.cmml" xref="A4.T6.3.3.1.m1.1.1.1"></times><ci id="A4.T6.3.3.1.m1.1.1.2.cmml" xref="A4.T6.3.3.1.m1.1.1.2">𝑡</ci><ci id="A4.T6.3.3.1.m1.1.1.3.cmml" xref="A4.T6.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.3.3.1.m1.1c">tr</annotation></semantics></math></td>
<td id="A4.T6.3.3.2" class="ltx_td ltx_align_center" style="padding-left:39.8pt;padding-right:39.8pt;">            0.01</td>
</tr>
<tr id="A4.T6.3.7" class="ltx_tr">
<td id="A4.T6.3.7.1" class="ltx_td ltx_align_left" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.3.7.1.1" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL LA</td>
<td id="A4.T6.3.7.2" class="ltx_td ltx_align_center" style="padding-left:39.8pt;padding-right:39.8pt;">            1.24</td>
</tr>
<tr id="A4.T6.3.8" class="ltx_tr">
<td id="A4.T6.3.8.1" class="ltx_td ltx_align_left" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.3.8.1.1" class="ltx_text ltx_font_italic">Duolando</span> w/o. RL</td>
<td id="A4.T6.3.8.2" class="ltx_td ltx_align_center" style="padding-left:39.8pt;padding-right:39.8pt;">            1.06</td>
</tr>
<tr id="A4.T6.3.9" class="ltx_tr">
<td id="A4.T6.3.9.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:39.8pt;padding-right:39.8pt;">            <span id="A4.T6.3.9.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Duolando</span></td>
<td id="A4.T6.3.9.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:39.8pt;padding-right:39.8pt;">            0.33</td>
</tr>
</table>
</figure>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>User Study Screenshots</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">We conduct our user study through Google Form. The screenshot is shown in Figure <a href="#A5.F8" title="Figure 8 ‣ Appendix E User Study Screenshots ‣ Duolando: Follower GPT with Off-Policy Reinforcement Learning for Dance Accompaniment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="A5.F8" class="ltx_figure"><img src="/html/2403.18811/assets/figures/fig_screenshot.png" id="A5.F8.g1" class="ltx_graphics ltx_centering ltx_img_square" width="485" height="494" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="A5.F8.2.1" class="ltx_text ltx_font_bold">Screenshot of user study.</span></figcaption>
</figure>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Data Licence</h2>

<div id="A6.p1" class="ltx_para ltx_noindent">
<p id="A6.p1.1" class="ltx_p">Code and data will be publicly available upon acceptance. The dataset contains the dance sequences in SMPL-X <cite class="ltx_cite ltx_citemacro_citep">(Pavlakos et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite> format stored in <span id="A6.p1.1.1" class="ltx_text ltx_font_typewriter">.npy</span> files and the corresponding music clips in <span id="A6.p1.1.2" class="ltx_text ltx_font_typewriter">.mp3</span> format.
To protect performers’ facial information, we do not release the original raster videos following the contracts with performers.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Video Demo</h2>

<div id="A7.p1" class="ltx_para ltx_noindent">
<p id="A7.p1.1" class="ltx_p">We provide data examples and generated results in the demo.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.18810" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.18811" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.18811">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.18811" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.18812" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 17:08:29 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
