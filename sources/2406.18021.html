<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.18021] SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR</title><meta property="og:description" content="In this work, we propose a Switch-Conformer-based MoE system named SC-MoE for unified streaming and non-streaming code-switching (CS) automatic speech recognition (ASR), where we design a streaming MoE layer consisting…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.18021">

<!--Generated on Sat Jul  6 00:41:30 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\interspeechcameraready</span><span id="p1.2" class="ltx_ERROR undefined">\name</span>
<p id="p1.3" class="ltx_p">Shuaishuai Ye, Shunfei Chen, Xinhui Hu, and Xinkang Xu</p>
</div>
<h1 class="ltx_title ltx_title_document">SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In this work, we propose a Switch-Conformer-based MoE system named SC-MoE for unified streaming and non-streaming code-switching (CS) automatic speech recognition (ASR), where we design a streaming MoE layer consisting of three language experts, which correspond to Mandarin, English, and blank, respectively, and equipped with a language identification (LID) network with a Connectionist Temporal Classification (CTC) loss as a router in the encoder of SC-MoE to achieve a real-time streaming CS ASR system.
To further utilize the language information embedded in text, we also incorporate MoE layers into the decoder of SC-MoE.
In addition, we introduce routers into every MoE layer of the encoder and the decoder and achieve better recognition performance.
Experimental results show that the SC-MoE significantly improves CS ASR performances over baseline with comparable computational efficiency.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>automatic speech recognition, code-switching, streaming, mixture of experts, switch conformer
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Code-switching ASR refers to the ability of a speech recognition system to recognize a conversation or utterance with alternation of two or more languages.
In a world where globalization and multilingualism are becoming increasingly prevalent, accurate and efficient CS ASR is critical.
However, significant challenges remain in CS ASR due to the phonemic confusion among multiple languages<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
To address the data scarcity issues, various data augmentation approaches have been proposed, such as
generating CS audio data<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and CS text data<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
Additionally, self-supervised fine-tuning methods are also proposed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
To solve the phonemic confusion issues, the Mixture of Experts (MoE) has become the mainstream model architecture for CS ASR system due to its ability not only to make use of contextual information between different languages, but also to discriminate different language information and extract language-specific representation<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">MoE models for CS ASR can be mainly divided into bi-encoder-based MoE
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and Switch-Transformer-based MoE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
The bi-encoder-based MoE is structured by decomposing the single transformer encoder originally used for monolingual ASR tasks into two separate language-specific encoders.
It has been shown to have advantages over single-encoder models for CS ASRs
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> .
In order to address the limitations of bi-encoder-based MoE models, which often suffer from insufficient interaction between the separate encoders and neglect linguistic general representation, a language-aware encoder (LAE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> introduces a shared encoder block before the top-level monolingual encoders. This shared block efficiently captures general representations that are common across different languages. Additionally, to leverage the full potential of contextual information between different languages, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> incorporates a speech translation task into LAE, enabling it to learn this information more effectively.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Switch-Transformer-based MoE is another novel MoE model architecture,
which not only mitigates the additional computational cost issue appeared in bi-encoder-based MoE, but also achieves better recognition performance<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.
However, the prior works still have some drawbacks, either ignoring language information or failing to achieve a real-time streaming ASR system.
Studies like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> demonstrate real-time streaming capabilities. However, incorporating language information could further enhance their accuracy.
One approach, exemplified by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, utilizes a Language Identification (LID) network with CTC loss to achieve good recognition performance. However, its reliance on a simplified, rule-based alignment strategy for handling blank tokens hinders real-time streaming functionality.
The development of a robust ASR system that excels in both high accuracy and real-time streaming capabilities remains crucial. Such a system would unlock significant value in diverse applications, including human-computer interaction, real-time subtitles, and seamless meeting transcriptions.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a Switch-Conformer-based MoE (SC-MoE) system that aims to achieve high recognition accuracy with the support of language information while also enabling a streaming CS ASR system that allows users to control the latency at inference time.
To achieve a real-time streaming CS ASR system when employing LID-CTC loss, we consider blank as a language and design a streaming MoE layer composed of three language experts: Mandarin, English and blank, and a router.
To leverage language-specific information from the text, we also incorporate MoE layers into the decoder of SC-MoE.
Additionally, as verified in the experimental section, we introduce routers into every MoE layer of the encoder and the decoder.
Experimental results show that the proposed SC-MoE significantly improves CS ASR performances over baseline with comparable computational costs.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The contributions of this work are summarized as follows:
(1) We propose a SC-MoE model for unified streaming and non-streaming CS ASR,
which significantly outperforms the baseline systems with absolute Mixed Error Rate (MER) reductions of 0.98% and 0.97% in streaming and non-streaming modes, respectively.
(2) We design a streaming MoE layer composed of three language experts and a dedicated router with a LID-CTC loss to achieve a real-time streaming CS ASR system.
(3) We introduced routers into every switch conformer encoder layer and switch transformer decoder layer, resulting in good recognition performances.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Switch Transformer</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Switch Transformer (ST) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> is a sparsely-activated transformer model with a large number of parameters but a constant computational cost.
Each encoder layer of ST is structured by replacing the dense feed-forward network (FFN) layer with a sparse switch FFN (sFFN) layer, resulting in two parts: shared parts and specialized parts.
A sFFN layer comprises <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">n</annotation></semantics></math> expert layer(s) and a router.
The sparsity of ST comes from activating the top-1 expert of sFFN layer with a maximum router gate value for each sample.
The sFFN layer returns top-1 expert's output multiplied by the maximum router gate value.
Additionally, ST incorporates an auxiliary balanced loss to encourage a balanced load across experts.
For each sFNN layer, this auxiliary loss is added to the total model loss during training.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">In CS and multilingual ASR, both the utilization of the contextual information across different languages and the extraction of the language-specific representations contribute to achieve good recognition performance<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.
Compared with the bi-encoder-based MoE with a shared encoder block, ST not only has the ability to boost the contextual information interaction via shared parts and extract language-specific representations through specialized parts but also requires lower computational costs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
So, LR-MoE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> adopted ST as the foundation of CS and multilingual ASR, and significantly improved recognition performance over standard Transformer models
with comparable computational complexity.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Language-Routing Mixture of Experts: LR-MoE</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The architecture of LR-MoE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> is structured by replacing the balanced loss in Switch Transformer with LID-CTC loss that solves the problem of difficulty in obtaining frame-level language labels.
In LR-MoE, the router regarded as a LID network was jointly trained with the ASR model using language labels obtained by replacing the tokens in the text labels with the corresponding
language.
To ensure that all routing paths of MoE layers in encoder are the same when inputting a sample, the LR-MoE adopts the strategy of a shared LID router, which can reduce multi-level error accumulation.
While LR-MoE based on Switch Transformer has acquired great achievements, there exists some limitations as follows:
</p>
<ul id="S2.I1" class="ltx_itemize">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p">Blank replacement rule prevents LR-MoE from performing real-time streaming ASR, due to the uncertain response time of the first packet. Furthermore, one sample cannot be decoded when all outputs of LID are blank under such a rule in more extreme situations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p">While the strategy of shared LID router can reduce multi-level error accumulation, it loses the opportunity for the following routers to correct errors, which results in "one mistake, all mistakes".</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.1" class="ltx_p">The decoder lacks the modeling ability for phonemic confusion when utilizing only MoE layer in the encoder.</p>
</div>
</li>
</ul>
<p id="S2.SS2.p1.2" class="ltx_p">In order to address the above limitations, we propose SC-MoE for unified streaming and non-streaming CS ASR.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2406.18021/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="272" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The architecture of the proposed SC-MoE. m, h, k, g represent the number of different network layers.</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>SC-MoE: Our Proposed Model</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Figure.<a href="#S2.F1" title="Figure 1 ‣ 2.2 Language-Routing Mixture of Experts: LR-MoE ‣ 2 Related work ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows an overview of the architecture of the proposed SC-MoE.
We employ the U2++<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, a two-pass CTC and Attention Encoder Decoder (AED) joint architecture<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> as our backbone.
In order to improve the modeling abilities for phonemic confusion, we not only incorporate the MoE layer into the encoder, but also the decoder of the SC-MoE, which is different from LR-MoE.
Both the encoder and decoder are structured by replacing the standard conformer layer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and the standard transformer decoder layer with Switch Conformer (SC) encoder layer and ST decoder layer, respectively.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Streaming MoE layer</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Due to the sparse spike property of the CTC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, the output of the LID network (router) with CTC loss will contain a large amount of blank symbols.
In LR-MoE, the authors utilize a Blank Replacement Rule (BRR) (detailed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>) to acquire dense frame-wise language routing information. However, this approach suffers from two key drawbacks:
(1) Uncertain first packet response: The BRR can lead to an unknown response time for the first packet, hindering the implementation of a streaming CS ASR system.
(2) Decodability issues: In extreme scenarios, all LID outputs might be blanks, rendering the sample undecodable under the given rule.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">To achieve a real-time streaming CS ASR system with LID-CTC loss, we propose abandoning the BRR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and instead, consider blank as a separate language.
We introduce a novel streaming MoE layer (Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Datasets ‣ 4 Experiments ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a)), composed of three language experts: Mandarin, English and blank, and a dedicated router.
A linear router selects and activates the expert with the highest output probability to extract language-specific representations efficiently.
This approach eliminates the need for the problematic BRR, enabling a truly streaming ASR system.
Notably, compared to the Mixture of Language Expert (MLE) FNN layer in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, our streaming MoE layer introduces an additional blank expert, addressing the limitations of the original rule.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.9" class="ltx_p">Given that the output of the <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">l</annotation></semantics></math>-1-th encoder layer <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="O^{l-1}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msup id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">O</mi><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p3.2.m2.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑂</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><minus id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></minus><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">O^{l-1}</annotation></semantics></math>, the output of the previous layer of a streaming MoE layer is <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="O_{p}^{l}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msubsup id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2.2" xref="S3.SS1.p3.3.m3.1.1.2.2.cmml">O</mi><mi id="S3.SS1.p3.3.m3.1.1.2.3" xref="S3.SS1.p3.3.m3.1.1.2.3.cmml">p</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2.2">𝑂</ci><ci id="S3.SS1.p3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.2.3">𝑝</ci></apply><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">O_{p}^{l}</annotation></semantics></math>, the <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">i</annotation></semantics></math>-th expert weights, the router weights and the router biases of a streaming MoE layer in the <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">l</annotation></semantics></math>-th switch conformer encoder block are <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="W_{i}^{l}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><msubsup id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.2" xref="S3.SS1.p3.6.m6.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p3.6.m6.1.1.2.3" xref="S3.SS1.p3.6.m6.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2">𝑊</ci><ci id="S3.SS1.p3.6.m6.1.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">W_{i}^{l}</annotation></semantics></math>, <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="W_{r}^{l}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msubsup id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2.2" xref="S3.SS1.p3.7.m7.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p3.7.m7.1.1.2.3" xref="S3.SS1.p3.7.m7.1.1.2.3.cmml">r</mi><mi id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">superscript</csymbol><apply id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.2.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2.2">𝑊</ci><ci id="S3.SS1.p3.7.m7.1.1.2.3.cmml" xref="S3.SS1.p3.7.m7.1.1.2.3">𝑟</ci></apply><ci id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">W_{r}^{l}</annotation></semantics></math> and <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="b_{r}^{l}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msubsup id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2.2" xref="S3.SS1.p3.8.m8.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p3.8.m8.1.1.2.3" xref="S3.SS1.p3.8.m8.1.1.2.3.cmml">r</mi><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2.2">𝑏</ci><ci id="S3.SS1.p3.8.m8.1.1.2.3.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3">𝑟</ci></apply><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">b_{r}^{l}</annotation></semantics></math>, respectively. Then, the output <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="O_{s}^{l}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msubsup id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2.2" xref="S3.SS1.p3.9.m9.1.1.2.2.cmml">O</mi><mi id="S3.SS1.p3.9.m9.1.1.2.3" xref="S3.SS1.p3.9.m9.1.1.2.3.cmml">s</mi><mi id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.2.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2.2">𝑂</ci><ci id="S3.SS1.p3.9.m9.1.1.2.3.cmml" xref="S3.SS1.p3.9.m9.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">O_{s}^{l}</annotation></semantics></math> of the streaming MoE layer can be formulated as:</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="O_{s}^{l}={p_{i}^{l}}({O_{p}^{l}*W_{i}^{l}})" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml">O</mi><mi id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3.cmml">s</mi><mi id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">l</mi></msubsup><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E1.m1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml">O</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">∗</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2">𝑂</ci><ci id="S3.E1.m1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3">𝑠</ci></apply><ci id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2">𝑂</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">O_{s}^{l}={p_{i}^{l}}({O_{p}^{l}*W_{i}^{l}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="i=argmax(p_{i}^{l})" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">i</mi><mo id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.4" xref="S3.E2.m1.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2a" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.5" xref="S3.E2.m1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2b" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.6" xref="S3.E2.m1.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2c" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.7" xref="S3.E2.m1.1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2d" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.8" xref="S3.E2.m1.1.1.1.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2e" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></eq><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">𝑖</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑎</ci><ci id="S3.E2.m1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.4">𝑟</ci><ci id="S3.E2.m1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.5">𝑔</ci><ci id="S3.E2.m1.1.1.1.6.cmml" xref="S3.E2.m1.1.1.1.6">𝑚</ci><ci id="S3.E2.m1.1.1.1.7.cmml" xref="S3.E2.m1.1.1.1.7">𝑎</ci><ci id="S3.E2.m1.1.1.1.8.cmml" xref="S3.E2.m1.1.1.1.8">𝑥</ci><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">i=argmax(p_{i}^{l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="p_{i}^{l}=\frac{e^{o_{ri}^{l}}}{{\sum_{j=1}^{3}}e^{o_{rj}^{l}}}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2.2" xref="S3.E3.m1.1.1.2.2.2.cmml">p</mi><mi id="S3.E3.m1.1.1.2.2.3" xref="S3.E3.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><msup id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">e</mi><msubsup id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.2.3.2.2" xref="S3.E3.m1.1.1.3.2.3.2.2.cmml">o</mi><mrow id="S3.E3.m1.1.1.3.2.3.2.3" xref="S3.E3.m1.1.1.3.2.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.2.3.2.3.2" xref="S3.E3.m1.1.1.3.2.3.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.2.3.2.3.1" xref="S3.E3.m1.1.1.3.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.2.3.2.3.3" xref="S3.E3.m1.1.1.3.2.3.2.3.3.cmml">i</mi></mrow><mi id="S3.E3.m1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.3.2.3.3.cmml">l</mi></msubsup></msup><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><msubsup id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml"><mo id="S3.E3.m1.1.1.3.3.1.2.2" xref="S3.E3.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.3.3.1.2.3" xref="S3.E3.m1.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.1.2.3.2" xref="S3.E3.m1.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.1.1.3.3.1.2.3.1" xref="S3.E3.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.3.3.1.2.3.3" xref="S3.E3.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mn id="S3.E3.m1.1.1.3.3.1.3" xref="S3.E3.m1.1.1.3.3.1.3.cmml">3</mn></msubsup><msup id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.3.3.2.2.cmml">e</mi><msubsup id="S3.E3.m1.1.1.3.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.2.2" xref="S3.E3.m1.1.1.3.3.2.3.2.2.cmml">o</mi><mrow id="S3.E3.m1.1.1.3.3.2.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.2.3.2" xref="S3.E3.m1.1.1.3.3.2.3.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.2.3.2.3.1" xref="S3.E3.m1.1.1.3.3.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3.2.3.2.3.3" xref="S3.E3.m1.1.1.3.3.2.3.2.3.3.cmml">j</mi></mrow><mi id="S3.E3.m1.1.1.3.3.2.3.3" xref="S3.E3.m1.1.1.3.3.2.3.3.cmml">l</mi></msubsup></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.2.2.2">𝑝</ci><ci id="S3.E3.m1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3">𝑙</ci></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><divide id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3"></divide><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.3.2.2">𝑜</ci><apply id="S3.E3.m1.1.1.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3.2.3"><times id="S3.E3.m1.1.1.3.2.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.3.2.3.1"></times><ci id="S3.E3.m1.1.1.3.2.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.3.2.3.2">𝑟</ci><ci id="S3.E3.m1.1.1.3.2.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.2.3.3">𝑙</ci></apply></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><apply id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.1.cmml" xref="S3.E3.m1.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.1.2.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3"><eq id="S3.E3.m1.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.1.1.3.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S3.E3.m1.1.1.3.3.1.3.cmml" xref="S3.E3.m1.1.1.3.3.1.3">3</cn></apply><apply id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.2">𝑜</ci><apply id="S3.E3.m1.1.1.3.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.3"><times id="S3.E3.m1.1.1.3.3.2.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.3.1"></times><ci id="S3.E3.m1.1.1.3.3.2.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.3.2">𝑟</ci><ci id="S3.E3.m1.1.1.3.3.2.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.E3.m1.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">p_{i}^{l}=\frac{e^{o_{ri}^{l}}}{{\sum_{j=1}^{3}}e^{o_{rj}^{l}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="O_{r}^{l}=O^{l-1}*W_{r}^{l}+b_{r}^{l}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msubsup id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2.2" xref="S3.E4.m1.1.1.2.2.2.cmml">O</mi><mi id="S3.E4.m1.1.1.2.2.3" xref="S3.E4.m1.1.1.2.2.3.cmml">r</mi><mi id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><msup id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.3.2.2.2.cmml">O</mi><mrow id="S3.E4.m1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.3.2.2.3.cmml"><mi id="S3.E4.m1.1.1.3.2.2.3.2" xref="S3.E4.m1.1.1.3.2.2.3.2.cmml">l</mi><mo id="S3.E4.m1.1.1.3.2.2.3.1" xref="S3.E4.m1.1.1.3.2.2.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.3.2.2.3.3" xref="S3.E4.m1.1.1.3.2.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.3.2.1" xref="S3.E4.m1.1.1.3.2.1.cmml">∗</mo><msubsup id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.1.1.3.2.3.2.2" xref="S3.E4.m1.1.1.3.2.3.2.2.cmml">W</mi><mi id="S3.E4.m1.1.1.3.2.3.2.3" xref="S3.E4.m1.1.1.3.2.3.2.3.cmml">r</mi><mi id="S3.E4.m1.1.1.3.2.3.3" xref="S3.E4.m1.1.1.3.2.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">+</mo><msubsup id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.3.3.2.2.cmml">b</mi><mi id="S3.E4.m1.1.1.3.3.2.3" xref="S3.E4.m1.1.1.3.3.2.3.cmml">r</mi><mi id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">l</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.2.2.2">𝑂</ci><ci id="S3.E4.m1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.2.2.3">𝑟</ci></apply><ci id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">𝑙</ci></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><plus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></plus><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><times id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2.1"></times><apply id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.3.2.2">superscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2.2">𝑂</ci><apply id="S3.E4.m1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3"><minus id="S3.E4.m1.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.1.1.3.2.2.3.1"></minus><ci id="S3.E4.m1.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.1.1.3.2.2.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E4.m1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.3.2.2">𝑊</ci><ci id="S3.E4.m1.1.1.3.2.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3.2.3">𝑟</ci></apply><ci id="S3.E4.m1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.1.1.3.2.3.3">𝑙</ci></apply></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3">superscript</csymbol><apply id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.2.2">𝑏</ci><ci id="S3.E4.m1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.2.3">𝑟</ci></apply><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">O_{r}^{l}=O^{l-1}*W_{r}^{l}+b_{r}^{l}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.3" class="ltx_p">Where <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="O_{r}^{l}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msubsup id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.2.2.cmml">O</mi><mi id="S3.SS1.p4.1.m1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.2.3.cmml">r</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2.2">𝑂</ci><ci id="S3.SS1.p4.1.m1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.2.3">𝑟</ci></apply><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">O_{r}^{l}</annotation></semantics></math> is the logits produced by the router and are normalized via a softmax distribution over the available three experts. <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="p_{i}^{l}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msubsup id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝑝</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">p_{i}^{l}</annotation></semantics></math> is the gate-value for the expert <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">i</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Switch Conformer Encoder</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">As depicted in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Datasets ‣ 4 Experiments ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a), an SC encoder layer is modified by replacing two dense FFN layers in a standard conformer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> layer with two sparse streaming MoE layers (represented by the red dashed box).
Unlike <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, we incorporate LID networks equipped with CTC losses into each SC encoder layer.
This approach mitigates the "one mistake, all mistakes" issue prevalent in LR-MoE by offering subsequent routers the ability to rectify errors.
To guarantee identical routing paths for the two streaming MoE layers within the same encoder layer, a single LID network (router) is shared between them.
Each MoE layer processes the output of the preceding encoder layer as its input.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Switch Transformer Decoder</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In the ST decoder layer of SC-MoE, we adopt the Switch Transformer architecture, as illustrated in Figure.<a href="#S4.F2" title="Figure 2 ‣ 4.1 Datasets ‣ 4 Experiments ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b). Instead of the original balanced loss, we employ cross-entropy (CE) loss specifically tailored for the 2-class LID task (distinguishing Mandarin and English). This integration of MoE layers (represented by the blue dashed box) within the decoder enhances the CS ASR model's ability to differentiate phonemes across languages.</p>
</div>
<figure id="S3.T1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>The performance (WER/CER/MER(%)) of our proposed method and baselines reimplemented using WeNet toolkit. 'Man' is the mono-Mandarin CER, 'Eng' is the mono-English WER, and MER is the code-switching MER. 'INIT.' means using NativeConformer model to initialize the encoder and/or decoder layer of a model. 'SC-MoE-Enc' and 'SC-MoE-Enc-Dec' represent only employing MoE layer to the encoder and to both the encoder and decoder, respectively. 'R1', 'R2' and 'R3' represent three types of router, and their specific meanings can be found in the experimental section. [x, y] represents that chunk size is x, and the number of left chunk is y.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="2"><span id="S3.T1.1.1.1.1.1" class="ltx_text">No.</span></td>
<td id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="2"><span id="S3.T1.1.1.1.2.1" class="ltx_text">Model</span></td>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.1.1.3.1" class="ltx_text">Router</span></td>
<td id="S3.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="2"><span id="S3.T1.1.1.1.4.1" class="ltx_text">INIT.</span></td>
<td id="S3.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.1.1.5.1" class="ltx_text">Model</span></td>
<td id="S3.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.1.1.6.1" class="ltx_text">Activated</span></td>
<td id="S3.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" colspan="3">Streaming [16, 8]</td>
<td id="S3.T1.1.1.1.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" colspan="3">Non-streaming [-1, -1]</td>
</tr>
<tr id="S3.T1.1.2.2" class="ltx_tr">
<td id="S3.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.2.2.1.1" class="ltx_text">Type</span></td>
<td id="S3.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.2.2.2.1" class="ltx_text">Parameters (MP)</span></td>
<td id="S3.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.2.2.3.1" class="ltx_text">MP</span></td>
<td id="S3.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Man</td>
<td id="S3.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Eng</td>
<td id="S3.T1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Mixed</td>
<td id="S3.T1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Man</td>
<td id="S3.T1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Eng</td>
<td id="S3.T1.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">Mixed</td>
</tr>
<tr id="S3.T1.1.3.3" class="ltx_tr">
<td id="S3.T1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">1</td>
<td id="S3.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">NativeConformer</td>
<td id="S3.T1.1.3.3.3" class="ltx_td ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"></td>
<td id="S3.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.3.3.4.1" class="ltx_text" style="font-size:50%;">✗</span></td>
<td id="S3.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">50.2M</td>
<td id="S3.T1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">50.2M</td>
<td id="S3.T1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.95</td>
<td id="S3.T1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">30.53</td>
<td id="S3.T1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">10.40</td>
<td id="S3.T1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.33</td>
<td id="S3.T1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">28.55</td>
<td id="S3.T1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.63</td>
</tr>
<tr id="S3.T1.1.4.4" class="ltx_tr">
<td id="S3.T1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">2</td>
<td id="S3.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">LAE</td>
<td id="S3.T1.1.4.4.3" class="ltx_td ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"></td>
<td id="S3.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.4.4.4.1" class="ltx_text" style="font-size:50%;">✗</span></td>
<td id="S3.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">51.6M</td>
<td id="S3.T1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">50.2M</td>
<td id="S3.T1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.44</td>
<td id="S3.T1.1.4.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">30.60</td>
<td id="S3.T1.1.4.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.89</td>
<td id="S3.T1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.84</td>
<td id="S3.T1.1.4.4.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">28.22</td>
<td id="S3.T1.1.4.4.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.16</td>
</tr>
<tr id="S3.T1.1.5.5" class="ltx_tr">
<td id="S3.T1.1.5.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">3</td>
<td id="S3.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">LR-MoE*</td>
<td id="S3.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R1</td>
<td id="S3.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">✓</td>
<td id="S3.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">62.8M</td>
<td id="S3.T1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">50.2M</td>
<td id="S3.T1.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.34</td>
<td id="S3.T1.1.5.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">30.52</td>
<td id="S3.T1.1.5.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.85</td>
<td id="S3.T1.1.5.5.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.72</td>
<td id="S3.T1.1.5.5.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">28.51</td>
<td id="S3.T1.1.5.5.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.08</td>
</tr>
<tr id="S3.T1.1.6.6" class="ltx_tr">
<td id="S3.T1.1.6.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">4</td>
<td id="S3.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="4"><span id="S3.T1.1.6.6.2.1" class="ltx_text">SC-MoE-Enc</span></td>
<td id="S3.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R1</td>
<td id="S3.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">✓</td>
<td id="S3.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="4"><span id="S3.T1.1.6.6.5.1" class="ltx_text">75.4M</span></td>
<td id="S3.T1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;" rowspan="4"><span id="S3.T1.1.6.6.6.1" class="ltx_text">50.2M</span></td>
<td id="S3.T1.1.6.6.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.6.6.7.1" class="ltx_text ltx_font_bold">7.12</span></td>
<td id="S3.T1.1.6.6.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">29.83</td>
<td id="S3.T1.1.6.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.59</td>
<td id="S3.T1.1.6.6.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.6.6.10.1" class="ltx_text ltx_font_bold">6.47</span></td>
<td id="S3.T1.1.6.6.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">27.96</td>
<td id="S3.T1.1.6.6.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">8.80</td>
</tr>
<tr id="S3.T1.1.7.7" class="ltx_tr">
<td id="S3.T1.1.7.7.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">5</td>
<td id="S3.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R2</td>
<td id="S3.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">✓</td>
<td id="S3.T1.1.7.7.4" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.36</td>
<td id="S3.T1.1.7.7.5" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">29.01</td>
<td id="S3.T1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.71</td>
<td id="S3.T1.1.7.7.7" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.85</td>
<td id="S3.T1.1.7.7.8" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">27.64</td>
<td id="S3.T1.1.7.7.9" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.10</td>
</tr>
<tr id="S3.T1.1.8.8" class="ltx_tr">
<td id="S3.T1.1.8.8.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6</td>
<td id="S3.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R3</td>
<td id="S3.T1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.8.8.3.1" class="ltx_text" style="font-size:50%;">✗</span></td>
<td id="S3.T1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.38</td>
<td id="S3.T1.1.8.8.5" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">29.17</td>
<td id="S3.T1.1.8.8.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.74</td>
<td id="S3.T1.1.8.8.7" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.79</td>
<td id="S3.T1.1.8.8.8" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">27.49</td>
<td id="S3.T1.1.8.8.9" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.03</td>
</tr>
<tr id="S3.T1.1.9.9" class="ltx_tr">
<td id="S3.T1.1.9.9.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7</td>
<td id="S3.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R3</td>
<td id="S3.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">✓</td>
<td id="S3.T1.1.9.9.4" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.16</td>
<td id="S3.T1.1.9.9.5" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">28.68</td>
<td id="S3.T1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">9.50</td>
<td id="S3.T1.1.9.9.7" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.48</td>
<td id="S3.T1.1.9.9.8" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">26.95</td>
<td id="S3.T1.1.9.9.9" class="ltx_td ltx_align_center" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">8.70</td>
</tr>
<tr id="S3.T1.1.10.10" class="ltx_tr">
<td id="S3.T1.1.10.10.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">8</td>
<td id="S3.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">SC-MoE-Enc-Dec</td>
<td id="S3.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">R3</td>
<td id="S3.T1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">✓</td>
<td id="S3.T1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">83.8M</td>
<td id="S3.T1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">50.2M</td>
<td id="S3.T1.1.10.10.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">7.15</td>
<td id="S3.T1.1.10.10.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.10.10.8.1" class="ltx_text ltx_font_bold">28.05</span></td>
<td id="S3.T1.1.10.10.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.10.10.9.1" class="ltx_text ltx_font_bold">9.42</span></td>
<td id="S3.T1.1.10.10.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;">6.50</td>
<td id="S3.T1.1.10.10.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.10.10.11.1" class="ltx_text ltx_font_bold">26.36</span></td>
<td id="S3.T1.1.10.10.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:-0.2pt;padding-bottom:-0.2pt;"><span id="S3.T1.1.10.10.12.1" class="ltx_text ltx_font_bold">8.66</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S3.I1" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S3.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">*</span> 
<div id="S3.I1.ix1.p1" class="ltx_para">
<p id="S3.I1.ix1.p1.1" class="ltx_p"><span id="S3.I1.ix1.p1.1.1" class="ltx_text" style="font-size:80%;">* Pseudo streaming without considering the response time of the first packet.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Training Objectives</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">The training process is to jointly optimize the weight-sum of the CS ASR loss <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{asr}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1a" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.4" xref="S3.SS4.p1.1.m1.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">ℒ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><times id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></times><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑠</ci><ci id="S3.SS4.p1.1.m1.1.1.3.4.cmml" xref="S3.SS4.p1.1.m1.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{L}_{asr}</annotation></semantics></math> and the LID loss <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{lid}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1a" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.4" xref="S3.SS4.p1.2.m2.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ℒ</ci><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><times id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">𝑙</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3">𝑖</ci><ci id="S3.SS4.p1.2.m2.1.1.3.4.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\mathcal{L}_{lid}</annotation></semantics></math>.
Given the acoustic features <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">x</annotation></semantics></math>, the corresponding annotations <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">y</annotation></semantics></math>, the language labels <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">z</annotation></semantics></math>
, the input of the LID (router) in the <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">i</annotation></semantics></math>-th SC encoder layer and the <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><mi id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">j</annotation></semantics></math>-th ST decoder layer <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="h_{re}^{i}" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><msubsup id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2.2" xref="S3.SS4.p1.8.m8.1.1.2.2.cmml">h</mi><mrow id="S3.SS4.p1.8.m8.1.1.2.3" xref="S3.SS4.p1.8.m8.1.1.2.3.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2.3.2" xref="S3.SS4.p1.8.m8.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.1.2.3.1" xref="S3.SS4.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.8.m8.1.1.2.3.3" xref="S3.SS4.p1.8.m8.1.1.2.3.3.cmml">e</mi></mrow><mi id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.2.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2.2">ℎ</ci><apply id="S3.SS4.p1.8.m8.1.1.2.3.cmml" xref="S3.SS4.p1.8.m8.1.1.2.3"><times id="S3.SS4.p1.8.m8.1.1.2.3.1.cmml" xref="S3.SS4.p1.8.m8.1.1.2.3.1"></times><ci id="S3.SS4.p1.8.m8.1.1.2.3.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2.3.2">𝑟</ci><ci id="S3.SS4.p1.8.m8.1.1.2.3.3.cmml" xref="S3.SS4.p1.8.m8.1.1.2.3.3">𝑒</ci></apply></apply><ci id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">h_{re}^{i}</annotation></semantics></math> and <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="h_{rd}^{j}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><msubsup id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">h</mi><mrow id="S3.SS4.p1.9.m9.1.1.2.3" xref="S3.SS4.p1.9.m9.1.1.2.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.3.2" xref="S3.SS4.p1.9.m9.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m9.1.1.2.3.1" xref="S3.SS4.p1.9.m9.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.9.m9.1.1.2.3.3" xref="S3.SS4.p1.9.m9.1.1.2.3.3.cmml">d</mi></mrow><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">ℎ</ci><apply id="S3.SS4.p1.9.m9.1.1.2.3.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3"><times id="S3.SS4.p1.9.m9.1.1.2.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3.1"></times><ci id="S3.SS4.p1.9.m9.1.1.2.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3.2">𝑟</ci><ci id="S3.SS4.p1.9.m9.1.1.2.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">h_{rd}^{j}</annotation></semantics></math> respectively. The full loss <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><ci id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">\mathcal{L}</annotation></semantics></math>, the <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{L}_{asr}" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><msub id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.11.m11.1.1.2" xref="S3.SS4.p1.11.m11.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.3.2" xref="S3.SS4.p1.11.m11.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.11.m11.1.1.3.1" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.11.m11.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.11.m11.1.1.3.1a" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.11.m11.1.1.3.4" xref="S3.SS4.p1.11.m11.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2">ℒ</ci><apply id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><times id="S3.SS4.p1.11.m11.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3.1"></times><ci id="S3.SS4.p1.11.m11.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2">𝑎</ci><ci id="S3.SS4.p1.11.m11.1.1.3.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3.3">𝑠</ci><ci id="S3.SS4.p1.11.m11.1.1.3.4.cmml" xref="S3.SS4.p1.11.m11.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">\mathcal{L}_{asr}</annotation></semantics></math> and the <math id="S3.SS4.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{L}_{lid}" display="inline"><semantics id="S3.SS4.p1.12.m12.1a"><msub id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.12.m12.1.1.2" xref="S3.SS4.p1.12.m12.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.12.m12.1.1.3" xref="S3.SS4.p1.12.m12.1.1.3.cmml"><mi id="S3.SS4.p1.12.m12.1.1.3.2" xref="S3.SS4.p1.12.m12.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.12.m12.1.1.3.1" xref="S3.SS4.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.12.m12.1.1.3.3" xref="S3.SS4.p1.12.m12.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.12.m12.1.1.3.1a" xref="S3.SS4.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.12.m12.1.1.3.4" xref="S3.SS4.p1.12.m12.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.1b"><apply id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m12.1.1.2.cmml" xref="S3.SS4.p1.12.m12.1.1.2">ℒ</ci><apply id="S3.SS4.p1.12.m12.1.1.3.cmml" xref="S3.SS4.p1.12.m12.1.1.3"><times id="S3.SS4.p1.12.m12.1.1.3.1.cmml" xref="S3.SS4.p1.12.m12.1.1.3.1"></times><ci id="S3.SS4.p1.12.m12.1.1.3.2.cmml" xref="S3.SS4.p1.12.m12.1.1.3.2">𝑙</ci><ci id="S3.SS4.p1.12.m12.1.1.3.3.cmml" xref="S3.SS4.p1.12.m12.1.1.3.3">𝑖</ci><ci id="S3.SS4.p1.12.m12.1.1.3.4.cmml" xref="S3.SS4.p1.12.m12.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.1c">\mathcal{L}_{lid}</annotation></semantics></math> can be formulated as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{asr}(x,y)+\mathcal{L}_{lid}(x,z)" display="block"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.5" xref="S3.E5.m1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.5.2" xref="S3.E5.m1.4.5.2.cmml">ℒ</mi><mo id="S3.E5.m1.4.5.1" xref="S3.E5.m1.4.5.1.cmml">=</mo><mrow id="S3.E5.m1.4.5.3" xref="S3.E5.m1.4.5.3.cmml"><mrow id="S3.E5.m1.4.5.3.2" xref="S3.E5.m1.4.5.3.2.cmml"><msub id="S3.E5.m1.4.5.3.2.2" xref="S3.E5.m1.4.5.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.5.3.2.2.2" xref="S3.E5.m1.4.5.3.2.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.4.5.3.2.2.3" xref="S3.E5.m1.4.5.3.2.2.3.cmml"><mi id="S3.E5.m1.4.5.3.2.2.3.2" xref="S3.E5.m1.4.5.3.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.2.2.3.1" xref="S3.E5.m1.4.5.3.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.4.5.3.2.2.3.3" xref="S3.E5.m1.4.5.3.2.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.2.2.3.1a" xref="S3.E5.m1.4.5.3.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.4.5.3.2.2.3.4" xref="S3.E5.m1.4.5.3.2.2.3.4.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.2.1" xref="S3.E5.m1.4.5.3.2.1.cmml">​</mo><mrow id="S3.E5.m1.4.5.3.2.3.2" xref="S3.E5.m1.4.5.3.2.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.5.3.2.3.2.1" xref="S3.E5.m1.4.5.3.2.3.1.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo id="S3.E5.m1.4.5.3.2.3.2.2" xref="S3.E5.m1.4.5.3.2.3.1.cmml">,</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.4.5.3.2.3.2.3" xref="S3.E5.m1.4.5.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.4.5.3.1" xref="S3.E5.m1.4.5.3.1.cmml">+</mo><mrow id="S3.E5.m1.4.5.3.3" xref="S3.E5.m1.4.5.3.3.cmml"><msub id="S3.E5.m1.4.5.3.3.2" xref="S3.E5.m1.4.5.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.5.3.3.2.2" xref="S3.E5.m1.4.5.3.3.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.4.5.3.3.2.3" xref="S3.E5.m1.4.5.3.3.2.3.cmml"><mi id="S3.E5.m1.4.5.3.3.2.3.2" xref="S3.E5.m1.4.5.3.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.3.2.3.1" xref="S3.E5.m1.4.5.3.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.4.5.3.3.2.3.3" xref="S3.E5.m1.4.5.3.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.3.2.3.1a" xref="S3.E5.m1.4.5.3.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.4.5.3.3.2.3.4" xref="S3.E5.m1.4.5.3.3.2.3.4.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.5.3.3.1" xref="S3.E5.m1.4.5.3.3.1.cmml">​</mo><mrow id="S3.E5.m1.4.5.3.3.3.2" xref="S3.E5.m1.4.5.3.3.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.5.3.3.3.2.1" xref="S3.E5.m1.4.5.3.3.3.1.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">x</mi><mo id="S3.E5.m1.4.5.3.3.3.2.2" xref="S3.E5.m1.4.5.3.3.3.1.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">z</mi><mo stretchy="false" id="S3.E5.m1.4.5.3.3.3.2.3" xref="S3.E5.m1.4.5.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.5.cmml" xref="S3.E5.m1.4.5"><eq id="S3.E5.m1.4.5.1.cmml" xref="S3.E5.m1.4.5.1"></eq><ci id="S3.E5.m1.4.5.2.cmml" xref="S3.E5.m1.4.5.2">ℒ</ci><apply id="S3.E5.m1.4.5.3.cmml" xref="S3.E5.m1.4.5.3"><plus id="S3.E5.m1.4.5.3.1.cmml" xref="S3.E5.m1.4.5.3.1"></plus><apply id="S3.E5.m1.4.5.3.2.cmml" xref="S3.E5.m1.4.5.3.2"><times id="S3.E5.m1.4.5.3.2.1.cmml" xref="S3.E5.m1.4.5.3.2.1"></times><apply id="S3.E5.m1.4.5.3.2.2.cmml" xref="S3.E5.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.5.3.2.2.1.cmml" xref="S3.E5.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E5.m1.4.5.3.2.2.2.cmml" xref="S3.E5.m1.4.5.3.2.2.2">ℒ</ci><apply id="S3.E5.m1.4.5.3.2.2.3.cmml" xref="S3.E5.m1.4.5.3.2.2.3"><times id="S3.E5.m1.4.5.3.2.2.3.1.cmml" xref="S3.E5.m1.4.5.3.2.2.3.1"></times><ci id="S3.E5.m1.4.5.3.2.2.3.2.cmml" xref="S3.E5.m1.4.5.3.2.2.3.2">𝑎</ci><ci id="S3.E5.m1.4.5.3.2.2.3.3.cmml" xref="S3.E5.m1.4.5.3.2.2.3.3">𝑠</ci><ci id="S3.E5.m1.4.5.3.2.2.3.4.cmml" xref="S3.E5.m1.4.5.3.2.2.3.4">𝑟</ci></apply></apply><interval closure="open" id="S3.E5.m1.4.5.3.2.3.1.cmml" xref="S3.E5.m1.4.5.3.2.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E5.m1.4.5.3.3.cmml" xref="S3.E5.m1.4.5.3.3"><times id="S3.E5.m1.4.5.3.3.1.cmml" xref="S3.E5.m1.4.5.3.3.1"></times><apply id="S3.E5.m1.4.5.3.3.2.cmml" xref="S3.E5.m1.4.5.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.5.3.3.2.1.cmml" xref="S3.E5.m1.4.5.3.3.2">subscript</csymbol><ci id="S3.E5.m1.4.5.3.3.2.2.cmml" xref="S3.E5.m1.4.5.3.3.2.2">ℒ</ci><apply id="S3.E5.m1.4.5.3.3.2.3.cmml" xref="S3.E5.m1.4.5.3.3.2.3"><times id="S3.E5.m1.4.5.3.3.2.3.1.cmml" xref="S3.E5.m1.4.5.3.3.2.3.1"></times><ci id="S3.E5.m1.4.5.3.3.2.3.2.cmml" xref="S3.E5.m1.4.5.3.3.2.3.2">𝑙</ci><ci id="S3.E5.m1.4.5.3.3.2.3.3.cmml" xref="S3.E5.m1.4.5.3.3.2.3.3">𝑖</ci><ci id="S3.E5.m1.4.5.3.3.2.3.4.cmml" xref="S3.E5.m1.4.5.3.3.2.3.4">𝑑</ci></apply></apply><interval closure="open" id="S3.E5.m1.4.5.3.3.3.1.cmml" xref="S3.E5.m1.4.5.3.3.3.2"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑥</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝑧</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\mathcal{L}=\mathcal{L}_{asr}(x,y)+\mathcal{L}_{lid}(x,z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\mathcal{L}_{asr}=\lambda\mathcal{L}_{asr\_ctc}(x,y)+(1-\lambda)\mathcal{L}_{asr\_ce}(x,y)" display="block"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><msub id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.3.2" xref="S3.E6.m1.5.5.3.2.cmml">ℒ</mi><mrow id="S3.E6.m1.5.5.3.3" xref="S3.E6.m1.5.5.3.3.cmml"><mi id="S3.E6.m1.5.5.3.3.2" xref="S3.E6.m1.5.5.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.3.3.1" xref="S3.E6.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.3.3.3" xref="S3.E6.m1.5.5.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.3.3.1a" xref="S3.E6.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.3.3.4" xref="S3.E6.m1.5.5.3.3.4.cmml">r</mi></mrow></msub><mo id="S3.E6.m1.5.5.2" xref="S3.E6.m1.5.5.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.cmml"><mrow id="S3.E6.m1.5.5.1.3" xref="S3.E6.m1.5.5.1.3.cmml"><mi id="S3.E6.m1.5.5.1.3.2" xref="S3.E6.m1.5.5.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.1" xref="S3.E6.m1.5.5.1.3.1.cmml">​</mo><msub id="S3.E6.m1.5.5.1.3.3" xref="S3.E6.m1.5.5.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.1.3.3.2" xref="S3.E6.m1.5.5.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E6.m1.5.5.1.3.3.3" xref="S3.E6.m1.5.5.1.3.3.3.cmml"><mi id="S3.E6.m1.5.5.1.3.3.3.2" xref="S3.E6.m1.5.5.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.3.3.3.3" xref="S3.E6.m1.5.5.1.3.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1a" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.3.3.3.4" xref="S3.E6.m1.5.5.1.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1b" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E6.m1.5.5.1.3.3.3.5" xref="S3.E6.m1.5.5.1.3.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1c" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.3.3.3.6" xref="S3.E6.m1.5.5.1.3.3.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1d" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.3.3.3.7" xref="S3.E6.m1.5.5.1.3.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.3.3.1e" xref="S3.E6.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.3.3.3.8" xref="S3.E6.m1.5.5.1.3.3.3.8.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.3.1a" xref="S3.E6.m1.5.5.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.3.4.2" xref="S3.E6.m1.5.5.1.3.4.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.3.4.2.1" xref="S3.E6.m1.5.5.1.3.4.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">x</mi><mo id="S3.E6.m1.5.5.1.3.4.2.2" xref="S3.E6.m1.5.5.1.3.4.1.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.5.5.1.3.4.2.3" xref="S3.E6.m1.5.5.1.3.4.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.2.cmml">+</mo><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.cmml"><mn id="S3.E6.m1.5.5.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E6.m1.5.5.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml">​</mo><msub id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E6.m1.5.5.1.1.3.3" xref="S3.E6.m1.5.5.1.1.3.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.3.2" xref="S3.E6.m1.5.5.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.3.3.1" xref="S3.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.3.3.3" xref="S3.E6.m1.5.5.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.3.3.1a" xref="S3.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.3.3.4" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.3.3.1b" xref="S3.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E6.m1.5.5.1.1.3.3.5" xref="S3.E6.m1.5.5.1.1.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.3.3.1c" xref="S3.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.3.3.6" xref="S3.E6.m1.5.5.1.1.3.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.3.3.1d" xref="S3.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.3.3.7" xref="S3.E6.m1.5.5.1.1.3.3.7.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.2a" xref="S3.E6.m1.5.5.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.4.2" xref="S3.E6.m1.5.5.1.1.4.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.4.2.1" xref="S3.E6.m1.5.5.1.1.4.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">x</mi><mo id="S3.E6.m1.5.5.1.1.4.2.2" xref="S3.E6.m1.5.5.1.1.4.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.5.5.1.1.4.2.3" xref="S3.E6.m1.5.5.1.1.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5.2"></eq><apply id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.3.1.cmml" xref="S3.E6.m1.5.5.3">subscript</csymbol><ci id="S3.E6.m1.5.5.3.2.cmml" xref="S3.E6.m1.5.5.3.2">ℒ</ci><apply id="S3.E6.m1.5.5.3.3.cmml" xref="S3.E6.m1.5.5.3.3"><times id="S3.E6.m1.5.5.3.3.1.cmml" xref="S3.E6.m1.5.5.3.3.1"></times><ci id="S3.E6.m1.5.5.3.3.2.cmml" xref="S3.E6.m1.5.5.3.3.2">𝑎</ci><ci id="S3.E6.m1.5.5.3.3.3.cmml" xref="S3.E6.m1.5.5.3.3.3">𝑠</ci><ci id="S3.E6.m1.5.5.3.3.4.cmml" xref="S3.E6.m1.5.5.3.3.4">𝑟</ci></apply></apply><apply id="S3.E6.m1.5.5.1.cmml" xref="S3.E6.m1.5.5.1"><plus id="S3.E6.m1.5.5.1.2.cmml" xref="S3.E6.m1.5.5.1.2"></plus><apply id="S3.E6.m1.5.5.1.3.cmml" xref="S3.E6.m1.5.5.1.3"><times id="S3.E6.m1.5.5.1.3.1.cmml" xref="S3.E6.m1.5.5.1.3.1"></times><ci id="S3.E6.m1.5.5.1.3.2.cmml" xref="S3.E6.m1.5.5.1.3.2">𝜆</ci><apply id="S3.E6.m1.5.5.1.3.3.cmml" xref="S3.E6.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.3.3.1.cmml" xref="S3.E6.m1.5.5.1.3.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.3.3.2.cmml" xref="S3.E6.m1.5.5.1.3.3.2">ℒ</ci><apply id="S3.E6.m1.5.5.1.3.3.3.cmml" xref="S3.E6.m1.5.5.1.3.3.3"><times id="S3.E6.m1.5.5.1.3.3.3.1.cmml" xref="S3.E6.m1.5.5.1.3.3.3.1"></times><ci id="S3.E6.m1.5.5.1.3.3.3.2.cmml" xref="S3.E6.m1.5.5.1.3.3.3.2">𝑎</ci><ci id="S3.E6.m1.5.5.1.3.3.3.3.cmml" xref="S3.E6.m1.5.5.1.3.3.3.3">𝑠</ci><ci id="S3.E6.m1.5.5.1.3.3.3.4.cmml" xref="S3.E6.m1.5.5.1.3.3.3.4">𝑟</ci><ci id="S3.E6.m1.5.5.1.3.3.3.5.cmml" xref="S3.E6.m1.5.5.1.3.3.3.5">_</ci><ci id="S3.E6.m1.5.5.1.3.3.3.6.cmml" xref="S3.E6.m1.5.5.1.3.3.3.6">𝑐</ci><ci id="S3.E6.m1.5.5.1.3.3.3.7.cmml" xref="S3.E6.m1.5.5.1.3.3.3.7">𝑡</ci><ci id="S3.E6.m1.5.5.1.3.3.3.8.cmml" xref="S3.E6.m1.5.5.1.3.3.3.8">𝑐</ci></apply></apply><interval closure="open" id="S3.E6.m1.5.5.1.3.4.1.cmml" xref="S3.E6.m1.5.5.1.3.4.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑥</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1"><times id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"></times><apply id="S3.E6.m1.5.5.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1"><minus id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.2">1</cn><ci id="S3.E6.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.3">𝜆</ci></apply><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2">ℒ</ci><apply id="S3.E6.m1.5.5.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3"><times id="S3.E6.m1.5.5.1.1.3.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.3.1"></times><ci id="S3.E6.m1.5.5.1.1.3.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.3.2">𝑎</ci><ci id="S3.E6.m1.5.5.1.1.3.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3">𝑠</ci><ci id="S3.E6.m1.5.5.1.1.3.3.4.cmml" xref="S3.E6.m1.5.5.1.1.3.3.4">𝑟</ci><ci id="S3.E6.m1.5.5.1.1.3.3.5.cmml" xref="S3.E6.m1.5.5.1.1.3.3.5">_</ci><ci id="S3.E6.m1.5.5.1.1.3.3.6.cmml" xref="S3.E6.m1.5.5.1.1.3.3.6">𝑐</ci><ci id="S3.E6.m1.5.5.1.1.3.3.7.cmml" xref="S3.E6.m1.5.5.1.1.3.3.7">𝑒</ci></apply></apply><interval closure="open" id="S3.E6.m1.5.5.1.1.4.1.cmml" xref="S3.E6.m1.5.5.1.1.4.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑥</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\mathcal{L}_{asr}=\lambda\mathcal{L}_{asr\_ctc}(x,y)+(1-\lambda)\mathcal{L}_{asr\_ce}(x,y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.5" class="ltx_Math" alttext="\mathcal{L}_{lid}=\lambda\sum_{i=m+1}^{m+h}\mathcal{L}_{lid\_ctc}^{i}(h_{re}^{i},z)+(1-\lambda)\sum_{j=k+1}^{k+g}\mathcal{L}_{lid\_ce}^{j}(h_{rd}^{j},z)" display="block"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml"><msub id="S3.E7.m1.5.5.5" xref="S3.E7.m1.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.5.2" xref="S3.E7.m1.5.5.5.2.cmml">ℒ</mi><mrow id="S3.E7.m1.5.5.5.3" xref="S3.E7.m1.5.5.5.3.cmml"><mi id="S3.E7.m1.5.5.5.3.2" xref="S3.E7.m1.5.5.5.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.3.1" xref="S3.E7.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.5.3.3" xref="S3.E7.m1.5.5.5.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.3.1a" xref="S3.E7.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.5.3.4" xref="S3.E7.m1.5.5.5.3.4.cmml">d</mi></mrow></msub><mo id="S3.E7.m1.5.5.4" xref="S3.E7.m1.5.5.4.cmml">=</mo><mrow id="S3.E7.m1.5.5.3" xref="S3.E7.m1.5.5.3.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml"><munderover id="S3.E7.m1.3.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E7.m1.3.3.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E7.m1.3.3.1.1.1.2.2.3.1" xref="S3.E7.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.2.2.3.3.2" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.2.cmml">m</mi><mo id="S3.E7.m1.3.3.1.1.1.2.2.3.3.1" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E7.m1.3.3.1.1.1.2.2.3.3.3" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.E7.m1.3.3.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.2.3.2.cmml">m</mi><mo id="S3.E7.m1.3.3.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.1.2.3.1.cmml">+</mo><mi id="S3.E7.m1.3.3.1.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.1.2.3.3.cmml">h</mi></mrow></munderover><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><msubsup id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.3.2.3" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.3" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1a" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.4" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1b" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.5" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1c" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.6" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1d" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.7" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1e" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.2.3.8" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.8.cmml">c</mi></mrow><mi id="S3.E7.m1.3.3.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.E7.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml">e</mi></mrow><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.4" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.3.4" xref="S3.E7.m1.5.5.3.4.cmml">+</mo><mrow id="S3.E7.m1.5.5.3.3" xref="S3.E7.m1.5.5.3.3.cmml"><mrow id="S3.E7.m1.4.4.2.2.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.2.2.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.cmml"><mn id="S3.E7.m1.4.4.2.2.1.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E7.m1.4.4.2.2.1.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.1.cmml">−</mo><mi id="S3.E7.m1.4.4.2.2.1.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.3" xref="S3.E7.m1.5.5.3.3.3.cmml">​</mo><mrow id="S3.E7.m1.5.5.3.3.2" xref="S3.E7.m1.5.5.3.3.2.cmml"><munderover id="S3.E7.m1.5.5.3.3.2.2" xref="S3.E7.m1.5.5.3.3.2.2.cmml"><mo movablelimits="false" id="S3.E7.m1.5.5.3.3.2.2.2.2" xref="S3.E7.m1.5.5.3.3.2.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.5.5.3.3.2.2.2.3" xref="S3.E7.m1.5.5.3.3.2.2.2.3.cmml"><mi id="S3.E7.m1.5.5.3.3.2.2.2.3.2" xref="S3.E7.m1.5.5.3.3.2.2.2.3.2.cmml">j</mi><mo id="S3.E7.m1.5.5.3.3.2.2.2.3.1" xref="S3.E7.m1.5.5.3.3.2.2.2.3.1.cmml">=</mo><mrow id="S3.E7.m1.5.5.3.3.2.2.2.3.3" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.cmml"><mi id="S3.E7.m1.5.5.3.3.2.2.2.3.3.2" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.2.cmml">k</mi><mo id="S3.E7.m1.5.5.3.3.2.2.2.3.3.1" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.1.cmml">+</mo><mn id="S3.E7.m1.5.5.3.3.2.2.2.3.3.3" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.E7.m1.5.5.3.3.2.2.3" xref="S3.E7.m1.5.5.3.3.2.2.3.cmml"><mi id="S3.E7.m1.5.5.3.3.2.2.3.2" xref="S3.E7.m1.5.5.3.3.2.2.3.2.cmml">k</mi><mo id="S3.E7.m1.5.5.3.3.2.2.3.1" xref="S3.E7.m1.5.5.3.3.2.2.3.1.cmml">+</mo><mi id="S3.E7.m1.5.5.3.3.2.2.3.3" xref="S3.E7.m1.5.5.3.3.2.2.3.3.cmml">g</mi></mrow></munderover><mrow id="S3.E7.m1.5.5.3.3.2.1" xref="S3.E7.m1.5.5.3.3.2.1.cmml"><msubsup id="S3.E7.m1.5.5.3.3.2.1.3" xref="S3.E7.m1.5.5.3.3.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.3.3.2.1.3.2.2" xref="S3.E7.m1.5.5.3.3.2.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E7.m1.5.5.3.3.2.1.3.2.3" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.cmml"><mi id="S3.E7.m1.5.5.3.3.2.1.3.2.3.2" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.3.3.2.1.3.2.3.3" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1a" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.3.3.2.1.3.2.3.4" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1b" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.5" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1c" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.3.3.2.1.3.2.3.6" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1d" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.3.3.2.1.3.2.3.7" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.7.cmml">e</mi></mrow><mi id="S3.E7.m1.5.5.3.3.2.1.3.3" xref="S3.E7.m1.5.5.3.3.2.1.3.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.2" xref="S3.E7.m1.5.5.3.3.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.5.5.3.3.2.1.1.1" xref="S3.E7.m1.5.5.3.3.2.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.3.3.2.1.1.1.2" xref="S3.E7.m1.5.5.3.3.2.1.1.2.cmml">(</mo><msubsup id="S3.E7.m1.5.5.3.3.2.1.1.1.1" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.2" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.2" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.1" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.3" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.3.cmml">d</mi></mrow><mi id="S3.E7.m1.5.5.3.3.2.1.1.1.1.3" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.E7.m1.5.5.3.3.2.1.1.1.3" xref="S3.E7.m1.5.5.3.3.2.1.1.2.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E7.m1.5.5.3.3.2.1.1.1.4" xref="S3.E7.m1.5.5.3.3.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5"><eq id="S3.E7.m1.5.5.4.cmml" xref="S3.E7.m1.5.5.4"></eq><apply id="S3.E7.m1.5.5.5.cmml" xref="S3.E7.m1.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.5.1.cmml" xref="S3.E7.m1.5.5.5">subscript</csymbol><ci id="S3.E7.m1.5.5.5.2.cmml" xref="S3.E7.m1.5.5.5.2">ℒ</ci><apply id="S3.E7.m1.5.5.5.3.cmml" xref="S3.E7.m1.5.5.5.3"><times id="S3.E7.m1.5.5.5.3.1.cmml" xref="S3.E7.m1.5.5.5.3.1"></times><ci id="S3.E7.m1.5.5.5.3.2.cmml" xref="S3.E7.m1.5.5.5.3.2">𝑙</ci><ci id="S3.E7.m1.5.5.5.3.3.cmml" xref="S3.E7.m1.5.5.5.3.3">𝑖</ci><ci id="S3.E7.m1.5.5.5.3.4.cmml" xref="S3.E7.m1.5.5.5.3.4">𝑑</ci></apply></apply><apply id="S3.E7.m1.5.5.3.cmml" xref="S3.E7.m1.5.5.3"><plus id="S3.E7.m1.5.5.3.4.cmml" xref="S3.E7.m1.5.5.3.4"></plus><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1"><times id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"></times><ci id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3">𝜆</ci><apply id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3"><eq id="S3.E7.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E7.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.2">𝑖</ci><apply id="S3.E7.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3"><plus id="S3.E7.m1.3.3.1.1.1.2.2.3.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.1"></plus><ci id="S3.E7.m1.3.3.1.1.1.2.2.3.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.2">𝑚</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.1.2.2.3.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3"><plus id="S3.E7.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3.1"></plus><ci id="S3.E7.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3.2">𝑚</ci><ci id="S3.E7.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3.3">ℎ</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"></times><apply id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E7.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3"><times id="S3.E7.m1.3.3.1.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.2">𝑙</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.3">𝑖</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.4.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.4">𝑑</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.5.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.5">_</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.6.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.6">𝑐</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.7.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.7">𝑡</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.3.8.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2.3.8">𝑐</ci></apply></apply><ci id="S3.E7.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.3">𝑒</ci></apply></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝑧</ci></interval></apply></apply></apply><apply id="S3.E7.m1.5.5.3.3.cmml" xref="S3.E7.m1.5.5.3.3"><times id="S3.E7.m1.5.5.3.3.3.cmml" xref="S3.E7.m1.5.5.3.3.3"></times><apply id="S3.E7.m1.4.4.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1"><minus id="S3.E7.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1"></minus><cn type="integer" id="S3.E7.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.2">1</cn><ci id="S3.E7.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.3">𝜆</ci></apply><apply id="S3.E7.m1.5.5.3.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2"><apply id="S3.E7.m1.5.5.3.3.2.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.2.1.cmml" xref="S3.E7.m1.5.5.3.3.2.2">superscript</csymbol><apply id="S3.E7.m1.5.5.3.3.2.2.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.2.2.1.cmml" xref="S3.E7.m1.5.5.3.3.2.2">subscript</csymbol><sum id="S3.E7.m1.5.5.3.3.2.2.2.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.2"></sum><apply id="S3.E7.m1.5.5.3.3.2.2.2.3.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3"><eq id="S3.E7.m1.5.5.3.3.2.2.2.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.1"></eq><ci id="S3.E7.m1.5.5.3.3.2.2.2.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.2">𝑗</ci><apply id="S3.E7.m1.5.5.3.3.2.2.2.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3"><plus id="S3.E7.m1.5.5.3.3.2.2.2.3.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.1"></plus><ci id="S3.E7.m1.5.5.3.3.2.2.2.3.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.2">𝑘</ci><cn type="integer" id="S3.E7.m1.5.5.3.3.2.2.2.3.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.5.5.3.3.2.2.3.cmml" xref="S3.E7.m1.5.5.3.3.2.2.3"><plus id="S3.E7.m1.5.5.3.3.2.2.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.2.3.1"></plus><ci id="S3.E7.m1.5.5.3.3.2.2.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.2.3.2">𝑘</ci><ci id="S3.E7.m1.5.5.3.3.2.2.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.2.3.3">𝑔</ci></apply></apply><apply id="S3.E7.m1.5.5.3.3.2.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1"><times id="S3.E7.m1.5.5.3.3.2.1.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.2"></times><apply id="S3.E7.m1.5.5.3.3.2.1.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.1.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3">superscript</csymbol><apply id="S3.E7.m1.5.5.3.3.2.1.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.1.3.2.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3">subscript</csymbol><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.2">ℒ</ci><apply id="S3.E7.m1.5.5.3.3.2.1.3.2.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3"><times id="S3.E7.m1.5.5.3.3.2.1.3.2.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.1"></times><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.2">𝑙</ci><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.3">𝑖</ci><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.4.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.4">𝑑</ci><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.5.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.5">_</ci><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.6.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.6">𝑐</ci><ci id="S3.E7.m1.5.5.3.3.2.1.3.2.3.7.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.2.3.7">𝑒</ci></apply></apply><ci id="S3.E7.m1.5.5.3.3.2.1.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.3.3">𝑗</ci></apply><interval closure="open" id="S3.E7.m1.5.5.3.3.2.1.1.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1"><apply id="S3.E7.m1.5.5.3.3.2.1.1.1.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.2">ℎ</ci><apply id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3"><times id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.E7.m1.5.5.3.3.2.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.3.3.2.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝑧</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\mathcal{L}_{lid}=\lambda\sum_{i=m+1}^{m+h}\mathcal{L}_{lid\_ctc}^{i}(h_{re}^{i},z)+(1-\lambda)\sum_{j=k+1}^{k+g}\mathcal{L}_{lid\_ce}^{j}(h_{rd}^{j},z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.5" class="ltx_Math" alttext="\mathcal{L}_{asr\_ce}=(1-\alpha)\mathcal{L}_{l2r\_asr}(x,y)+\alpha\mathcal{L}_{r2l\_asr}(x,y)" display="block"><semantics id="S3.E8.m1.5a"><mrow id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml"><msub id="S3.E8.m1.5.5.3" xref="S3.E8.m1.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.5.5.3.2" xref="S3.E8.m1.5.5.3.2.cmml">ℒ</mi><mrow id="S3.E8.m1.5.5.3.3" xref="S3.E8.m1.5.5.3.3.cmml"><mi id="S3.E8.m1.5.5.3.3.2" xref="S3.E8.m1.5.5.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.3.3.1" xref="S3.E8.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.3.3.3" xref="S3.E8.m1.5.5.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.3.3.1a" xref="S3.E8.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.3.3.4" xref="S3.E8.m1.5.5.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.3.3.1b" xref="S3.E8.m1.5.5.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.5.5.3.3.5" xref="S3.E8.m1.5.5.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.3.3.1c" xref="S3.E8.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.3.3.6" xref="S3.E8.m1.5.5.3.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.3.3.1d" xref="S3.E8.m1.5.5.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.3.3.7" xref="S3.E8.m1.5.5.3.3.7.cmml">e</mi></mrow></msub><mo id="S3.E8.m1.5.5.2" xref="S3.E8.m1.5.5.2.cmml">=</mo><mrow id="S3.E8.m1.5.5.1" xref="S3.E8.m1.5.5.1.cmml"><mrow id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.cmml"><mn id="S3.E8.m1.5.5.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.5.5.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E8.m1.5.5.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.2" xref="S3.E8.m1.5.5.1.1.2.cmml">​</mo><msub id="S3.E8.m1.5.5.1.1.3" xref="S3.E8.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.5.5.1.1.3.2" xref="S3.E8.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E8.m1.5.5.1.1.3.3" xref="S3.E8.m1.5.5.1.1.3.3.cmml"><mi id="S3.E8.m1.5.5.1.1.3.3.2" xref="S3.E8.m1.5.5.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mn id="S3.E8.m1.5.5.1.1.3.3.3" xref="S3.E8.m1.5.5.1.1.3.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1a" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.1.3.3.4" xref="S3.E8.m1.5.5.1.1.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1b" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.5.5.1.1.3.3.5" xref="S3.E8.m1.5.5.1.1.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1c" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.1.3.3.6" xref="S3.E8.m1.5.5.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1d" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.1.3.3.7" xref="S3.E8.m1.5.5.1.1.3.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.3.3.1e" xref="S3.E8.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.1.3.3.8" xref="S3.E8.m1.5.5.1.1.3.3.8.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.2a" xref="S3.E8.m1.5.5.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.5.5.1.1.4.2" xref="S3.E8.m1.5.5.1.1.4.1.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.1.4.2.1" xref="S3.E8.m1.5.5.1.1.4.1.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">x</mi><mo id="S3.E8.m1.5.5.1.1.4.2.2" xref="S3.E8.m1.5.5.1.1.4.1.cmml">,</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E8.m1.5.5.1.1.4.2.3" xref="S3.E8.m1.5.5.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.5.5.1.2" xref="S3.E8.m1.5.5.1.2.cmml">+</mo><mrow id="S3.E8.m1.5.5.1.3" xref="S3.E8.m1.5.5.1.3.cmml"><mi id="S3.E8.m1.5.5.1.3.2" xref="S3.E8.m1.5.5.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.1" xref="S3.E8.m1.5.5.1.3.1.cmml">​</mo><msub id="S3.E8.m1.5.5.1.3.3" xref="S3.E8.m1.5.5.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.5.5.1.3.3.2" xref="S3.E8.m1.5.5.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E8.m1.5.5.1.3.3.3" xref="S3.E8.m1.5.5.1.3.3.3.cmml"><mi id="S3.E8.m1.5.5.1.3.3.3.2" xref="S3.E8.m1.5.5.1.3.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mn id="S3.E8.m1.5.5.1.3.3.3.3" xref="S3.E8.m1.5.5.1.3.3.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1a" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.3.3.3.4" xref="S3.E8.m1.5.5.1.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1b" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.5.5.1.3.3.3.5" xref="S3.E8.m1.5.5.1.3.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1c" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.3.3.3.6" xref="S3.E8.m1.5.5.1.3.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1d" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.3.3.3.7" xref="S3.E8.m1.5.5.1.3.3.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.3.3.1e" xref="S3.E8.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.5.5.1.3.3.3.8" xref="S3.E8.m1.5.5.1.3.3.3.8.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.3.1a" xref="S3.E8.m1.5.5.1.3.1.cmml">​</mo><mrow id="S3.E8.m1.5.5.1.3.4.2" xref="S3.E8.m1.5.5.1.3.4.1.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.3.4.2.1" xref="S3.E8.m1.5.5.1.3.4.1.cmml">(</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">x</mi><mo id="S3.E8.m1.5.5.1.3.4.2.2" xref="S3.E8.m1.5.5.1.3.4.1.cmml">,</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E8.m1.5.5.1.3.4.2.3" xref="S3.E8.m1.5.5.1.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.5b"><apply id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5"><eq id="S3.E8.m1.5.5.2.cmml" xref="S3.E8.m1.5.5.2"></eq><apply id="S3.E8.m1.5.5.3.cmml" xref="S3.E8.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.3.1.cmml" xref="S3.E8.m1.5.5.3">subscript</csymbol><ci id="S3.E8.m1.5.5.3.2.cmml" xref="S3.E8.m1.5.5.3.2">ℒ</ci><apply id="S3.E8.m1.5.5.3.3.cmml" xref="S3.E8.m1.5.5.3.3"><times id="S3.E8.m1.5.5.3.3.1.cmml" xref="S3.E8.m1.5.5.3.3.1"></times><ci id="S3.E8.m1.5.5.3.3.2.cmml" xref="S3.E8.m1.5.5.3.3.2">𝑎</ci><ci id="S3.E8.m1.5.5.3.3.3.cmml" xref="S3.E8.m1.5.5.3.3.3">𝑠</ci><ci id="S3.E8.m1.5.5.3.3.4.cmml" xref="S3.E8.m1.5.5.3.3.4">𝑟</ci><ci id="S3.E8.m1.5.5.3.3.5.cmml" xref="S3.E8.m1.5.5.3.3.5">_</ci><ci id="S3.E8.m1.5.5.3.3.6.cmml" xref="S3.E8.m1.5.5.3.3.6">𝑐</ci><ci id="S3.E8.m1.5.5.3.3.7.cmml" xref="S3.E8.m1.5.5.3.3.7">𝑒</ci></apply></apply><apply id="S3.E8.m1.5.5.1.cmml" xref="S3.E8.m1.5.5.1"><plus id="S3.E8.m1.5.5.1.2.cmml" xref="S3.E8.m1.5.5.1.2"></plus><apply id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1.1"><times id="S3.E8.m1.5.5.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1"><minus id="S3.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E8.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2">1</cn><ci id="S3.E8.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E8.m1.5.5.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.3.2">ℒ</ci><apply id="S3.E8.m1.5.5.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3"><times id="S3.E8.m1.5.5.1.1.3.3.1.cmml" xref="S3.E8.m1.5.5.1.1.3.3.1"></times><ci id="S3.E8.m1.5.5.1.1.3.3.2.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2">𝑙</ci><cn type="integer" id="S3.E8.m1.5.5.1.1.3.3.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3.3">2</cn><ci id="S3.E8.m1.5.5.1.1.3.3.4.cmml" xref="S3.E8.m1.5.5.1.1.3.3.4">𝑟</ci><ci id="S3.E8.m1.5.5.1.1.3.3.5.cmml" xref="S3.E8.m1.5.5.1.1.3.3.5">_</ci><ci id="S3.E8.m1.5.5.1.1.3.3.6.cmml" xref="S3.E8.m1.5.5.1.1.3.3.6">𝑎</ci><ci id="S3.E8.m1.5.5.1.1.3.3.7.cmml" xref="S3.E8.m1.5.5.1.1.3.3.7">𝑠</ci><ci id="S3.E8.m1.5.5.1.1.3.3.8.cmml" xref="S3.E8.m1.5.5.1.1.3.3.8">𝑟</ci></apply></apply><interval closure="open" id="S3.E8.m1.5.5.1.1.4.1.cmml" xref="S3.E8.m1.5.5.1.1.4.2"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑥</ci><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E8.m1.5.5.1.3.cmml" xref="S3.E8.m1.5.5.1.3"><times id="S3.E8.m1.5.5.1.3.1.cmml" xref="S3.E8.m1.5.5.1.3.1"></times><ci id="S3.E8.m1.5.5.1.3.2.cmml" xref="S3.E8.m1.5.5.1.3.2">𝛼</ci><apply id="S3.E8.m1.5.5.1.3.3.cmml" xref="S3.E8.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.3.3.1.cmml" xref="S3.E8.m1.5.5.1.3.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.3.3.2.cmml" xref="S3.E8.m1.5.5.1.3.3.2">ℒ</ci><apply id="S3.E8.m1.5.5.1.3.3.3.cmml" xref="S3.E8.m1.5.5.1.3.3.3"><times id="S3.E8.m1.5.5.1.3.3.3.1.cmml" xref="S3.E8.m1.5.5.1.3.3.3.1"></times><ci id="S3.E8.m1.5.5.1.3.3.3.2.cmml" xref="S3.E8.m1.5.5.1.3.3.3.2">𝑟</ci><cn type="integer" id="S3.E8.m1.5.5.1.3.3.3.3.cmml" xref="S3.E8.m1.5.5.1.3.3.3.3">2</cn><ci id="S3.E8.m1.5.5.1.3.3.3.4.cmml" xref="S3.E8.m1.5.5.1.3.3.3.4">𝑙</ci><ci id="S3.E8.m1.5.5.1.3.3.3.5.cmml" xref="S3.E8.m1.5.5.1.3.3.3.5">_</ci><ci id="S3.E8.m1.5.5.1.3.3.3.6.cmml" xref="S3.E8.m1.5.5.1.3.3.3.6">𝑎</ci><ci id="S3.E8.m1.5.5.1.3.3.3.7.cmml" xref="S3.E8.m1.5.5.1.3.3.3.7">𝑠</ci><ci id="S3.E8.m1.5.5.1.3.3.3.8.cmml" xref="S3.E8.m1.5.5.1.3.3.3.8">𝑟</ci></apply></apply><interval closure="open" id="S3.E8.m1.5.5.1.3.4.1.cmml" xref="S3.E8.m1.5.5.1.3.4.2"><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝑥</ci><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.5c">\mathcal{L}_{asr\_ce}=(1-\alpha)\mathcal{L}_{l2r\_asr}(x,y)+\alpha\mathcal{L}_{r2l\_asr}(x,y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.5" class="ltx_Math" alttext="\mathcal{L}_{lidce}=(1-\alpha)\mathcal{L}_{l2r\_lid}(h_{rd},z)+\alpha\mathcal{L}_{r2l\_lid}(h_{rd},z)" display="block"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><msub id="S3.E9.m1.5.5.5" xref="S3.E9.m1.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.5.2" xref="S3.E9.m1.5.5.5.2.cmml">ℒ</mi><mrow id="S3.E9.m1.5.5.5.3" xref="S3.E9.m1.5.5.5.3.cmml"><mi id="S3.E9.m1.5.5.5.3.2" xref="S3.E9.m1.5.5.5.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.5.3.1" xref="S3.E9.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.5.3.3" xref="S3.E9.m1.5.5.5.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.5.3.1a" xref="S3.E9.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.5.3.4" xref="S3.E9.m1.5.5.5.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.5.3.1b" xref="S3.E9.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.5.3.5" xref="S3.E9.m1.5.5.5.3.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.5.3.1c" xref="S3.E9.m1.5.5.5.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.5.3.6" xref="S3.E9.m1.5.5.5.3.6.cmml">e</mi></mrow></msub><mo id="S3.E9.m1.5.5.4" xref="S3.E9.m1.5.5.4.cmml">=</mo><mrow id="S3.E9.m1.5.5.3" xref="S3.E9.m1.5.5.3.cmml"><mrow id="S3.E9.m1.4.4.2.2" xref="S3.E9.m1.4.4.2.2.cmml"><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml"><mn id="S3.E9.m1.3.3.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.3.3.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m1.3.3.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.3" xref="S3.E9.m1.4.4.2.2.3.cmml">​</mo><msub id="S3.E9.m1.4.4.2.2.4" xref="S3.E9.m1.4.4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.4.4.2.2.4.2" xref="S3.E9.m1.4.4.2.2.4.2.cmml">ℒ</mi><mrow id="S3.E9.m1.4.4.2.2.4.3" xref="S3.E9.m1.4.4.2.2.4.3.cmml"><mi id="S3.E9.m1.4.4.2.2.4.3.2" xref="S3.E9.m1.4.4.2.2.4.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mn id="S3.E9.m1.4.4.2.2.4.3.3" xref="S3.E9.m1.4.4.2.2.4.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1a" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mi id="S3.E9.m1.4.4.2.2.4.3.4" xref="S3.E9.m1.4.4.2.2.4.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1b" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E9.m1.4.4.2.2.4.3.5" xref="S3.E9.m1.4.4.2.2.4.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1c" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mi id="S3.E9.m1.4.4.2.2.4.3.6" xref="S3.E9.m1.4.4.2.2.4.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1d" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mi id="S3.E9.m1.4.4.2.2.4.3.7" xref="S3.E9.m1.4.4.2.2.4.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.4.3.1e" xref="S3.E9.m1.4.4.2.2.4.3.1.cmml">​</mo><mi id="S3.E9.m1.4.4.2.2.4.3.8" xref="S3.E9.m1.4.4.2.2.4.3.8.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.3a" xref="S3.E9.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.4.4.2.2.2.1" xref="S3.E9.m1.4.4.2.2.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.2.2.2.1.2" xref="S3.E9.m1.4.4.2.2.2.2.cmml">(</mo><msub id="S3.E9.m1.4.4.2.2.2.1.1" xref="S3.E9.m1.4.4.2.2.2.1.1.cmml"><mi id="S3.E9.m1.4.4.2.2.2.1.1.2" xref="S3.E9.m1.4.4.2.2.2.1.1.2.cmml">h</mi><mrow id="S3.E9.m1.4.4.2.2.2.1.1.3" xref="S3.E9.m1.4.4.2.2.2.1.1.3.cmml"><mi id="S3.E9.m1.4.4.2.2.2.1.1.3.2" xref="S3.E9.m1.4.4.2.2.2.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.2.2.2.1.1.3.1" xref="S3.E9.m1.4.4.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.4.4.2.2.2.1.1.3.3" xref="S3.E9.m1.4.4.2.2.2.1.1.3.3.cmml">d</mi></mrow></msub><mo id="S3.E9.m1.4.4.2.2.2.1.3" xref="S3.E9.m1.4.4.2.2.2.2.cmml">,</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.E9.m1.4.4.2.2.2.1.4" xref="S3.E9.m1.4.4.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.5.5.3.4" xref="S3.E9.m1.5.5.3.4.cmml">+</mo><mrow id="S3.E9.m1.5.5.3.3" xref="S3.E9.m1.5.5.3.3.cmml"><mi id="S3.E9.m1.5.5.3.3.3" xref="S3.E9.m1.5.5.3.3.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.2" xref="S3.E9.m1.5.5.3.3.2.cmml">​</mo><msub id="S3.E9.m1.5.5.3.3.4" xref="S3.E9.m1.5.5.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.3.3.4.2" xref="S3.E9.m1.5.5.3.3.4.2.cmml">ℒ</mi><mrow id="S3.E9.m1.5.5.3.3.4.3" xref="S3.E9.m1.5.5.3.3.4.3.cmml"><mi id="S3.E9.m1.5.5.3.3.4.3.2" xref="S3.E9.m1.5.5.3.3.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mn id="S3.E9.m1.5.5.3.3.4.3.3" xref="S3.E9.m1.5.5.3.3.4.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1a" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.3.3.4.3.4" xref="S3.E9.m1.5.5.3.3.4.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1b" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E9.m1.5.5.3.3.4.3.5" xref="S3.E9.m1.5.5.3.3.4.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1c" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.3.3.4.3.6" xref="S3.E9.m1.5.5.3.3.4.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1d" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.3.3.4.3.7" xref="S3.E9.m1.5.5.3.3.4.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.4.3.1e" xref="S3.E9.m1.5.5.3.3.4.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.3.3.4.3.8" xref="S3.E9.m1.5.5.3.3.4.3.8.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.2a" xref="S3.E9.m1.5.5.3.3.2.cmml">​</mo><mrow id="S3.E9.m1.5.5.3.3.1.1" xref="S3.E9.m1.5.5.3.3.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.3.3.1.1.2" xref="S3.E9.m1.5.5.3.3.1.2.cmml">(</mo><msub id="S3.E9.m1.5.5.3.3.1.1.1" xref="S3.E9.m1.5.5.3.3.1.1.1.cmml"><mi id="S3.E9.m1.5.5.3.3.1.1.1.2" xref="S3.E9.m1.5.5.3.3.1.1.1.2.cmml">h</mi><mrow id="S3.E9.m1.5.5.3.3.1.1.1.3" xref="S3.E9.m1.5.5.3.3.1.1.1.3.cmml"><mi id="S3.E9.m1.5.5.3.3.1.1.1.3.2" xref="S3.E9.m1.5.5.3.3.1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.1.1.1.3.1" xref="S3.E9.m1.5.5.3.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.3.3.1.1.1.3.3" xref="S3.E9.m1.5.5.3.3.1.1.1.3.3.cmml">d</mi></mrow></msub><mo id="S3.E9.m1.5.5.3.3.1.1.3" xref="S3.E9.m1.5.5.3.3.1.2.cmml">,</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E9.m1.5.5.3.3.1.1.4" xref="S3.E9.m1.5.5.3.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.5b"><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><eq id="S3.E9.m1.5.5.4.cmml" xref="S3.E9.m1.5.5.4"></eq><apply id="S3.E9.m1.5.5.5.cmml" xref="S3.E9.m1.5.5.5"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.5.1.cmml" xref="S3.E9.m1.5.5.5">subscript</csymbol><ci id="S3.E9.m1.5.5.5.2.cmml" xref="S3.E9.m1.5.5.5.2">ℒ</ci><apply id="S3.E9.m1.5.5.5.3.cmml" xref="S3.E9.m1.5.5.5.3"><times id="S3.E9.m1.5.5.5.3.1.cmml" xref="S3.E9.m1.5.5.5.3.1"></times><ci id="S3.E9.m1.5.5.5.3.2.cmml" xref="S3.E9.m1.5.5.5.3.2">𝑙</ci><ci id="S3.E9.m1.5.5.5.3.3.cmml" xref="S3.E9.m1.5.5.5.3.3">𝑖</ci><ci id="S3.E9.m1.5.5.5.3.4.cmml" xref="S3.E9.m1.5.5.5.3.4">𝑑</ci><ci id="S3.E9.m1.5.5.5.3.5.cmml" xref="S3.E9.m1.5.5.5.3.5">𝑐</ci><ci id="S3.E9.m1.5.5.5.3.6.cmml" xref="S3.E9.m1.5.5.5.3.6">𝑒</ci></apply></apply><apply id="S3.E9.m1.5.5.3.cmml" xref="S3.E9.m1.5.5.3"><plus id="S3.E9.m1.5.5.3.4.cmml" xref="S3.E9.m1.5.5.3.4"></plus><apply id="S3.E9.m1.4.4.2.2.cmml" xref="S3.E9.m1.4.4.2.2"><times id="S3.E9.m1.4.4.2.2.3.cmml" xref="S3.E9.m1.4.4.2.2.3"></times><apply id="S3.E9.m1.3.3.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1"><minus id="S3.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2">1</cn><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E9.m1.4.4.2.2.4.cmml" xref="S3.E9.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.2.2.4.1.cmml" xref="S3.E9.m1.4.4.2.2.4">subscript</csymbol><ci id="S3.E9.m1.4.4.2.2.4.2.cmml" xref="S3.E9.m1.4.4.2.2.4.2">ℒ</ci><apply id="S3.E9.m1.4.4.2.2.4.3.cmml" xref="S3.E9.m1.4.4.2.2.4.3"><times id="S3.E9.m1.4.4.2.2.4.3.1.cmml" xref="S3.E9.m1.4.4.2.2.4.3.1"></times><ci id="S3.E9.m1.4.4.2.2.4.3.2.cmml" xref="S3.E9.m1.4.4.2.2.4.3.2">𝑙</ci><cn type="integer" id="S3.E9.m1.4.4.2.2.4.3.3.cmml" xref="S3.E9.m1.4.4.2.2.4.3.3">2</cn><ci id="S3.E9.m1.4.4.2.2.4.3.4.cmml" xref="S3.E9.m1.4.4.2.2.4.3.4">𝑟</ci><ci id="S3.E9.m1.4.4.2.2.4.3.5.cmml" xref="S3.E9.m1.4.4.2.2.4.3.5">_</ci><ci id="S3.E9.m1.4.4.2.2.4.3.6.cmml" xref="S3.E9.m1.4.4.2.2.4.3.6">𝑙</ci><ci id="S3.E9.m1.4.4.2.2.4.3.7.cmml" xref="S3.E9.m1.4.4.2.2.4.3.7">𝑖</ci><ci id="S3.E9.m1.4.4.2.2.4.3.8.cmml" xref="S3.E9.m1.4.4.2.2.4.3.8">𝑑</ci></apply></apply><interval closure="open" id="S3.E9.m1.4.4.2.2.2.2.cmml" xref="S3.E9.m1.4.4.2.2.2.1"><apply id="S3.E9.m1.4.4.2.2.2.1.1.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E9.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1.2">ℎ</ci><apply id="S3.E9.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1.3"><times id="S3.E9.m1.4.4.2.2.2.1.1.3.1.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1.3.1"></times><ci id="S3.E9.m1.4.4.2.2.2.1.1.3.2.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1.3.2">𝑟</ci><ci id="S3.E9.m1.4.4.2.2.2.1.1.3.3.cmml" xref="S3.E9.m1.4.4.2.2.2.1.1.3.3">𝑑</ci></apply></apply><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝑧</ci></interval></apply><apply id="S3.E9.m1.5.5.3.3.cmml" xref="S3.E9.m1.5.5.3.3"><times id="S3.E9.m1.5.5.3.3.2.cmml" xref="S3.E9.m1.5.5.3.3.2"></times><ci id="S3.E9.m1.5.5.3.3.3.cmml" xref="S3.E9.m1.5.5.3.3.3">𝛼</ci><apply id="S3.E9.m1.5.5.3.3.4.cmml" xref="S3.E9.m1.5.5.3.3.4"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.3.3.4.1.cmml" xref="S3.E9.m1.5.5.3.3.4">subscript</csymbol><ci id="S3.E9.m1.5.5.3.3.4.2.cmml" xref="S3.E9.m1.5.5.3.3.4.2">ℒ</ci><apply id="S3.E9.m1.5.5.3.3.4.3.cmml" xref="S3.E9.m1.5.5.3.3.4.3"><times id="S3.E9.m1.5.5.3.3.4.3.1.cmml" xref="S3.E9.m1.5.5.3.3.4.3.1"></times><ci id="S3.E9.m1.5.5.3.3.4.3.2.cmml" xref="S3.E9.m1.5.5.3.3.4.3.2">𝑟</ci><cn type="integer" id="S3.E9.m1.5.5.3.3.4.3.3.cmml" xref="S3.E9.m1.5.5.3.3.4.3.3">2</cn><ci id="S3.E9.m1.5.5.3.3.4.3.4.cmml" xref="S3.E9.m1.5.5.3.3.4.3.4">𝑙</ci><ci id="S3.E9.m1.5.5.3.3.4.3.5.cmml" xref="S3.E9.m1.5.5.3.3.4.3.5">_</ci><ci id="S3.E9.m1.5.5.3.3.4.3.6.cmml" xref="S3.E9.m1.5.5.3.3.4.3.6">𝑙</ci><ci id="S3.E9.m1.5.5.3.3.4.3.7.cmml" xref="S3.E9.m1.5.5.3.3.4.3.7">𝑖</ci><ci id="S3.E9.m1.5.5.3.3.4.3.8.cmml" xref="S3.E9.m1.5.5.3.3.4.3.8">𝑑</ci></apply></apply><interval closure="open" id="S3.E9.m1.5.5.3.3.1.2.cmml" xref="S3.E9.m1.5.5.3.3.1.1"><apply id="S3.E9.m1.5.5.3.3.1.1.1.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1">subscript</csymbol><ci id="S3.E9.m1.5.5.3.3.1.1.1.2.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1.2">ℎ</ci><apply id="S3.E9.m1.5.5.3.3.1.1.1.3.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1.3"><times id="S3.E9.m1.5.5.3.3.1.1.1.3.1.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1.3.1"></times><ci id="S3.E9.m1.5.5.3.3.1.1.1.3.2.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1.3.2">𝑟</ci><ci id="S3.E9.m1.5.5.3.3.1.1.1.3.3.cmml" xref="S3.E9.m1.5.5.3.3.1.1.1.3.3">𝑑</ci></apply></apply><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑧</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.5c">\mathcal{L}_{lidce}=(1-\alpha)\mathcal{L}_{l2r\_lid}(h_{rd},z)+\alpha\mathcal{L}_{r2l\_lid}(h_{rd},z)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.24" class="ltx_p">Where <math id="S3.SS4.p1.13.m1.1" class="ltx_Math" alttext="\mathcal{L}_{asr\_ctc}" display="inline"><semantics id="S3.SS4.p1.13.m1.1a"><msub id="S3.SS4.p1.13.m1.1.1" xref="S3.SS4.p1.13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.13.m1.1.1.2" xref="S3.SS4.p1.13.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.13.m1.1.1.3" xref="S3.SS4.p1.13.m1.1.1.3.cmml"><mi id="S3.SS4.p1.13.m1.1.1.3.2" xref="S3.SS4.p1.13.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.13.m1.1.1.3.3" xref="S3.SS4.p1.13.m1.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1a" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.13.m1.1.1.3.4" xref="S3.SS4.p1.13.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1b" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.13.m1.1.1.3.5" xref="S3.SS4.p1.13.m1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1c" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.13.m1.1.1.3.6" xref="S3.SS4.p1.13.m1.1.1.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1d" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.13.m1.1.1.3.7" xref="S3.SS4.p1.13.m1.1.1.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.1.1.3.1e" xref="S3.SS4.p1.13.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.13.m1.1.1.3.8" xref="S3.SS4.p1.13.m1.1.1.3.8.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m1.1b"><apply id="S3.SS4.p1.13.m1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m1.1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.13.m1.1.1.2.cmml" xref="S3.SS4.p1.13.m1.1.1.2">ℒ</ci><apply id="S3.SS4.p1.13.m1.1.1.3.cmml" xref="S3.SS4.p1.13.m1.1.1.3"><times id="S3.SS4.p1.13.m1.1.1.3.1.cmml" xref="S3.SS4.p1.13.m1.1.1.3.1"></times><ci id="S3.SS4.p1.13.m1.1.1.3.2.cmml" xref="S3.SS4.p1.13.m1.1.1.3.2">𝑎</ci><ci id="S3.SS4.p1.13.m1.1.1.3.3.cmml" xref="S3.SS4.p1.13.m1.1.1.3.3">𝑠</ci><ci id="S3.SS4.p1.13.m1.1.1.3.4.cmml" xref="S3.SS4.p1.13.m1.1.1.3.4">𝑟</ci><ci id="S3.SS4.p1.13.m1.1.1.3.5.cmml" xref="S3.SS4.p1.13.m1.1.1.3.5">_</ci><ci id="S3.SS4.p1.13.m1.1.1.3.6.cmml" xref="S3.SS4.p1.13.m1.1.1.3.6">𝑐</ci><ci id="S3.SS4.p1.13.m1.1.1.3.7.cmml" xref="S3.SS4.p1.13.m1.1.1.3.7">𝑡</ci><ci id="S3.SS4.p1.13.m1.1.1.3.8.cmml" xref="S3.SS4.p1.13.m1.1.1.3.8">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m1.1c">\mathcal{L}_{asr\_ctc}</annotation></semantics></math> is the ASR CTC loss, <math id="S3.SS4.p1.14.m2.1" class="ltx_Math" alttext="\mathcal{L}_{asr\_ce}" display="inline"><semantics id="S3.SS4.p1.14.m2.1a"><msub id="S3.SS4.p1.14.m2.1.1" xref="S3.SS4.p1.14.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.14.m2.1.1.2" xref="S3.SS4.p1.14.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.14.m2.1.1.3" xref="S3.SS4.p1.14.m2.1.1.3.cmml"><mi id="S3.SS4.p1.14.m2.1.1.3.2" xref="S3.SS4.p1.14.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m2.1.1.3.1" xref="S3.SS4.p1.14.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.14.m2.1.1.3.3" xref="S3.SS4.p1.14.m2.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m2.1.1.3.1a" xref="S3.SS4.p1.14.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.14.m2.1.1.3.4" xref="S3.SS4.p1.14.m2.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m2.1.1.3.1b" xref="S3.SS4.p1.14.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.14.m2.1.1.3.5" xref="S3.SS4.p1.14.m2.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m2.1.1.3.1c" xref="S3.SS4.p1.14.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.14.m2.1.1.3.6" xref="S3.SS4.p1.14.m2.1.1.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m2.1.1.3.1d" xref="S3.SS4.p1.14.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.14.m2.1.1.3.7" xref="S3.SS4.p1.14.m2.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m2.1b"><apply id="S3.SS4.p1.14.m2.1.1.cmml" xref="S3.SS4.p1.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.14.m2.1.1.1.cmml" xref="S3.SS4.p1.14.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.14.m2.1.1.2.cmml" xref="S3.SS4.p1.14.m2.1.1.2">ℒ</ci><apply id="S3.SS4.p1.14.m2.1.1.3.cmml" xref="S3.SS4.p1.14.m2.1.1.3"><times id="S3.SS4.p1.14.m2.1.1.3.1.cmml" xref="S3.SS4.p1.14.m2.1.1.3.1"></times><ci id="S3.SS4.p1.14.m2.1.1.3.2.cmml" xref="S3.SS4.p1.14.m2.1.1.3.2">𝑎</ci><ci id="S3.SS4.p1.14.m2.1.1.3.3.cmml" xref="S3.SS4.p1.14.m2.1.1.3.3">𝑠</ci><ci id="S3.SS4.p1.14.m2.1.1.3.4.cmml" xref="S3.SS4.p1.14.m2.1.1.3.4">𝑟</ci><ci id="S3.SS4.p1.14.m2.1.1.3.5.cmml" xref="S3.SS4.p1.14.m2.1.1.3.5">_</ci><ci id="S3.SS4.p1.14.m2.1.1.3.6.cmml" xref="S3.SS4.p1.14.m2.1.1.3.6">𝑐</ci><ci id="S3.SS4.p1.14.m2.1.1.3.7.cmml" xref="S3.SS4.p1.14.m2.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m2.1c">\mathcal{L}_{asr\_ce}</annotation></semantics></math> is the ASR CE loss of the AED model, <math id="S3.SS4.p1.15.m3.1" class="ltx_Math" alttext="\mathcal{L}_{lid\_ctc}^{i}" display="inline"><semantics id="S3.SS4.p1.15.m3.1a"><msubsup id="S3.SS4.p1.15.m3.1.1" xref="S3.SS4.p1.15.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.15.m3.1.1.2.2" xref="S3.SS4.p1.15.m3.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.15.m3.1.1.2.3" xref="S3.SS4.p1.15.m3.1.1.2.3.cmml"><mi id="S3.SS4.p1.15.m3.1.1.2.3.2" xref="S3.SS4.p1.15.m3.1.1.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.15.m3.1.1.2.3.3" xref="S3.SS4.p1.15.m3.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1a" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.15.m3.1.1.2.3.4" xref="S3.SS4.p1.15.m3.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1b" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.15.m3.1.1.2.3.5" xref="S3.SS4.p1.15.m3.1.1.2.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1c" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.15.m3.1.1.2.3.6" xref="S3.SS4.p1.15.m3.1.1.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1d" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.15.m3.1.1.2.3.7" xref="S3.SS4.p1.15.m3.1.1.2.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.2.3.1e" xref="S3.SS4.p1.15.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.15.m3.1.1.2.3.8" xref="S3.SS4.p1.15.m3.1.1.2.3.8.cmml">c</mi></mrow><mi id="S3.SS4.p1.15.m3.1.1.3" xref="S3.SS4.p1.15.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m3.1b"><apply id="S3.SS4.p1.15.m3.1.1.cmml" xref="S3.SS4.p1.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m3.1.1.1.cmml" xref="S3.SS4.p1.15.m3.1.1">superscript</csymbol><apply id="S3.SS4.p1.15.m3.1.1.2.cmml" xref="S3.SS4.p1.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m3.1.1.2.1.cmml" xref="S3.SS4.p1.15.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.15.m3.1.1.2.2.cmml" xref="S3.SS4.p1.15.m3.1.1.2.2">ℒ</ci><apply id="S3.SS4.p1.15.m3.1.1.2.3.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3"><times id="S3.SS4.p1.15.m3.1.1.2.3.1.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.1"></times><ci id="S3.SS4.p1.15.m3.1.1.2.3.2.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.2">𝑙</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.3.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.3">𝑖</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.4.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.4">𝑑</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.5.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.5">_</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.6.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.6">𝑐</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.7.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.7">𝑡</ci><ci id="S3.SS4.p1.15.m3.1.1.2.3.8.cmml" xref="S3.SS4.p1.15.m3.1.1.2.3.8">𝑐</ci></apply></apply><ci id="S3.SS4.p1.15.m3.1.1.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m3.1c">\mathcal{L}_{lid\_ctc}^{i}</annotation></semantics></math> is the LID CTC loss of <math id="S3.SS4.p1.16.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.16.m4.1a"><mi id="S3.SS4.p1.16.m4.1.1" xref="S3.SS4.p1.16.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.m4.1b"><ci id="S3.SS4.p1.16.m4.1.1.cmml" xref="S3.SS4.p1.16.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.m4.1c">i</annotation></semantics></math>-th SC encoder, <math id="S3.SS4.p1.17.m5.1" class="ltx_Math" alttext="\mathcal{L}_{lid\_ce}^{j}" display="inline"><semantics id="S3.SS4.p1.17.m5.1a"><msubsup id="S3.SS4.p1.17.m5.1.1" xref="S3.SS4.p1.17.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.17.m5.1.1.2.2" xref="S3.SS4.p1.17.m5.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.17.m5.1.1.2.3" xref="S3.SS4.p1.17.m5.1.1.2.3.cmml"><mi id="S3.SS4.p1.17.m5.1.1.2.3.2" xref="S3.SS4.p1.17.m5.1.1.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m5.1.1.2.3.1" xref="S3.SS4.p1.17.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.17.m5.1.1.2.3.3" xref="S3.SS4.p1.17.m5.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m5.1.1.2.3.1a" xref="S3.SS4.p1.17.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.17.m5.1.1.2.3.4" xref="S3.SS4.p1.17.m5.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m5.1.1.2.3.1b" xref="S3.SS4.p1.17.m5.1.1.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.17.m5.1.1.2.3.5" xref="S3.SS4.p1.17.m5.1.1.2.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m5.1.1.2.3.1c" xref="S3.SS4.p1.17.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.17.m5.1.1.2.3.6" xref="S3.SS4.p1.17.m5.1.1.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m5.1.1.2.3.1d" xref="S3.SS4.p1.17.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.17.m5.1.1.2.3.7" xref="S3.SS4.p1.17.m5.1.1.2.3.7.cmml">e</mi></mrow><mi id="S3.SS4.p1.17.m5.1.1.3" xref="S3.SS4.p1.17.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.17.m5.1b"><apply id="S3.SS4.p1.17.m5.1.1.cmml" xref="S3.SS4.p1.17.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m5.1.1.1.cmml" xref="S3.SS4.p1.17.m5.1.1">superscript</csymbol><apply id="S3.SS4.p1.17.m5.1.1.2.cmml" xref="S3.SS4.p1.17.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m5.1.1.2.1.cmml" xref="S3.SS4.p1.17.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.17.m5.1.1.2.2.cmml" xref="S3.SS4.p1.17.m5.1.1.2.2">ℒ</ci><apply id="S3.SS4.p1.17.m5.1.1.2.3.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3"><times id="S3.SS4.p1.17.m5.1.1.2.3.1.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.1"></times><ci id="S3.SS4.p1.17.m5.1.1.2.3.2.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.2">𝑙</ci><ci id="S3.SS4.p1.17.m5.1.1.2.3.3.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.3">𝑖</ci><ci id="S3.SS4.p1.17.m5.1.1.2.3.4.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.4">𝑑</ci><ci id="S3.SS4.p1.17.m5.1.1.2.3.5.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.5">_</ci><ci id="S3.SS4.p1.17.m5.1.1.2.3.6.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.6">𝑐</ci><ci id="S3.SS4.p1.17.m5.1.1.2.3.7.cmml" xref="S3.SS4.p1.17.m5.1.1.2.3.7">𝑒</ci></apply></apply><ci id="S3.SS4.p1.17.m5.1.1.3.cmml" xref="S3.SS4.p1.17.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.17.m5.1c">\mathcal{L}_{lid\_ce}^{j}</annotation></semantics></math> is the LID CE of <math id="S3.SS4.p1.18.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.18.m6.1a"><mi id="S3.SS4.p1.18.m6.1.1" xref="S3.SS4.p1.18.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.18.m6.1b"><ci id="S3.SS4.p1.18.m6.1.1.cmml" xref="S3.SS4.p1.18.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.18.m6.1c">j</annotation></semantics></math>-th ST decoder. <math id="S3.SS4.p1.19.m7.1" class="ltx_Math" alttext="\mathcal{L}_{l2r\_asr}" display="inline"><semantics id="S3.SS4.p1.19.m7.1a"><msub id="S3.SS4.p1.19.m7.1.1" xref="S3.SS4.p1.19.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.19.m7.1.1.2" xref="S3.SS4.p1.19.m7.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.19.m7.1.1.3" xref="S3.SS4.p1.19.m7.1.1.3.cmml"><mi id="S3.SS4.p1.19.m7.1.1.3.2" xref="S3.SS4.p1.19.m7.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mn id="S3.SS4.p1.19.m7.1.1.3.3" xref="S3.SS4.p1.19.m7.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1a" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.19.m7.1.1.3.4" xref="S3.SS4.p1.19.m7.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1b" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.19.m7.1.1.3.5" xref="S3.SS4.p1.19.m7.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1c" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.19.m7.1.1.3.6" xref="S3.SS4.p1.19.m7.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1d" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.19.m7.1.1.3.7" xref="S3.SS4.p1.19.m7.1.1.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.19.m7.1.1.3.1e" xref="S3.SS4.p1.19.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.19.m7.1.1.3.8" xref="S3.SS4.p1.19.m7.1.1.3.8.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.19.m7.1b"><apply id="S3.SS4.p1.19.m7.1.1.cmml" xref="S3.SS4.p1.19.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.19.m7.1.1.1.cmml" xref="S3.SS4.p1.19.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.19.m7.1.1.2.cmml" xref="S3.SS4.p1.19.m7.1.1.2">ℒ</ci><apply id="S3.SS4.p1.19.m7.1.1.3.cmml" xref="S3.SS4.p1.19.m7.1.1.3"><times id="S3.SS4.p1.19.m7.1.1.3.1.cmml" xref="S3.SS4.p1.19.m7.1.1.3.1"></times><ci id="S3.SS4.p1.19.m7.1.1.3.2.cmml" xref="S3.SS4.p1.19.m7.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS4.p1.19.m7.1.1.3.3.cmml" xref="S3.SS4.p1.19.m7.1.1.3.3">2</cn><ci id="S3.SS4.p1.19.m7.1.1.3.4.cmml" xref="S3.SS4.p1.19.m7.1.1.3.4">𝑟</ci><ci id="S3.SS4.p1.19.m7.1.1.3.5.cmml" xref="S3.SS4.p1.19.m7.1.1.3.5">_</ci><ci id="S3.SS4.p1.19.m7.1.1.3.6.cmml" xref="S3.SS4.p1.19.m7.1.1.3.6">𝑎</ci><ci id="S3.SS4.p1.19.m7.1.1.3.7.cmml" xref="S3.SS4.p1.19.m7.1.1.3.7">𝑠</ci><ci id="S3.SS4.p1.19.m7.1.1.3.8.cmml" xref="S3.SS4.p1.19.m7.1.1.3.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.19.m7.1c">\mathcal{L}_{l2r\_asr}</annotation></semantics></math> and <math id="S3.SS4.p1.20.m8.1" class="ltx_Math" alttext="\mathcal{L}_{r2l\_asr}" display="inline"><semantics id="S3.SS4.p1.20.m8.1a"><msub id="S3.SS4.p1.20.m8.1.1" xref="S3.SS4.p1.20.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.20.m8.1.1.2" xref="S3.SS4.p1.20.m8.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.20.m8.1.1.3" xref="S3.SS4.p1.20.m8.1.1.3.cmml"><mi id="S3.SS4.p1.20.m8.1.1.3.2" xref="S3.SS4.p1.20.m8.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mn id="S3.SS4.p1.20.m8.1.1.3.3" xref="S3.SS4.p1.20.m8.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1a" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.20.m8.1.1.3.4" xref="S3.SS4.p1.20.m8.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1b" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.20.m8.1.1.3.5" xref="S3.SS4.p1.20.m8.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1c" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.20.m8.1.1.3.6" xref="S3.SS4.p1.20.m8.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1d" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.20.m8.1.1.3.7" xref="S3.SS4.p1.20.m8.1.1.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.20.m8.1.1.3.1e" xref="S3.SS4.p1.20.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.20.m8.1.1.3.8" xref="S3.SS4.p1.20.m8.1.1.3.8.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.20.m8.1b"><apply id="S3.SS4.p1.20.m8.1.1.cmml" xref="S3.SS4.p1.20.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.20.m8.1.1.1.cmml" xref="S3.SS4.p1.20.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.20.m8.1.1.2.cmml" xref="S3.SS4.p1.20.m8.1.1.2">ℒ</ci><apply id="S3.SS4.p1.20.m8.1.1.3.cmml" xref="S3.SS4.p1.20.m8.1.1.3"><times id="S3.SS4.p1.20.m8.1.1.3.1.cmml" xref="S3.SS4.p1.20.m8.1.1.3.1"></times><ci id="S3.SS4.p1.20.m8.1.1.3.2.cmml" xref="S3.SS4.p1.20.m8.1.1.3.2">𝑟</ci><cn type="integer" id="S3.SS4.p1.20.m8.1.1.3.3.cmml" xref="S3.SS4.p1.20.m8.1.1.3.3">2</cn><ci id="S3.SS4.p1.20.m8.1.1.3.4.cmml" xref="S3.SS4.p1.20.m8.1.1.3.4">𝑙</ci><ci id="S3.SS4.p1.20.m8.1.1.3.5.cmml" xref="S3.SS4.p1.20.m8.1.1.3.5">_</ci><ci id="S3.SS4.p1.20.m8.1.1.3.6.cmml" xref="S3.SS4.p1.20.m8.1.1.3.6">𝑎</ci><ci id="S3.SS4.p1.20.m8.1.1.3.7.cmml" xref="S3.SS4.p1.20.m8.1.1.3.7">𝑠</ci><ci id="S3.SS4.p1.20.m8.1.1.3.8.cmml" xref="S3.SS4.p1.20.m8.1.1.3.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.20.m8.1c">\mathcal{L}_{r2l\_asr}</annotation></semantics></math> are the ASR CE losses of the L2R and the R2L AED model respectively. <math id="S3.SS4.p1.21.m9.1" class="ltx_Math" alttext="\mathcal{L}_{l2r\_lid}" display="inline"><semantics id="S3.SS4.p1.21.m9.1a"><msub id="S3.SS4.p1.21.m9.1.1" xref="S3.SS4.p1.21.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.21.m9.1.1.2" xref="S3.SS4.p1.21.m9.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.21.m9.1.1.3" xref="S3.SS4.p1.21.m9.1.1.3.cmml"><mi id="S3.SS4.p1.21.m9.1.1.3.2" xref="S3.SS4.p1.21.m9.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mn id="S3.SS4.p1.21.m9.1.1.3.3" xref="S3.SS4.p1.21.m9.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1a" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.21.m9.1.1.3.4" xref="S3.SS4.p1.21.m9.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1b" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.21.m9.1.1.3.5" xref="S3.SS4.p1.21.m9.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1c" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.21.m9.1.1.3.6" xref="S3.SS4.p1.21.m9.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1d" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.21.m9.1.1.3.7" xref="S3.SS4.p1.21.m9.1.1.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.21.m9.1.1.3.1e" xref="S3.SS4.p1.21.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.21.m9.1.1.3.8" xref="S3.SS4.p1.21.m9.1.1.3.8.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.21.m9.1b"><apply id="S3.SS4.p1.21.m9.1.1.cmml" xref="S3.SS4.p1.21.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.21.m9.1.1.1.cmml" xref="S3.SS4.p1.21.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.21.m9.1.1.2.cmml" xref="S3.SS4.p1.21.m9.1.1.2">ℒ</ci><apply id="S3.SS4.p1.21.m9.1.1.3.cmml" xref="S3.SS4.p1.21.m9.1.1.3"><times id="S3.SS4.p1.21.m9.1.1.3.1.cmml" xref="S3.SS4.p1.21.m9.1.1.3.1"></times><ci id="S3.SS4.p1.21.m9.1.1.3.2.cmml" xref="S3.SS4.p1.21.m9.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS4.p1.21.m9.1.1.3.3.cmml" xref="S3.SS4.p1.21.m9.1.1.3.3">2</cn><ci id="S3.SS4.p1.21.m9.1.1.3.4.cmml" xref="S3.SS4.p1.21.m9.1.1.3.4">𝑟</ci><ci id="S3.SS4.p1.21.m9.1.1.3.5.cmml" xref="S3.SS4.p1.21.m9.1.1.3.5">_</ci><ci id="S3.SS4.p1.21.m9.1.1.3.6.cmml" xref="S3.SS4.p1.21.m9.1.1.3.6">𝑙</ci><ci id="S3.SS4.p1.21.m9.1.1.3.7.cmml" xref="S3.SS4.p1.21.m9.1.1.3.7">𝑖</ci><ci id="S3.SS4.p1.21.m9.1.1.3.8.cmml" xref="S3.SS4.p1.21.m9.1.1.3.8">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.21.m9.1c">\mathcal{L}_{l2r\_lid}</annotation></semantics></math> and <math id="S3.SS4.p1.22.m10.1" class="ltx_Math" alttext="\mathcal{L}_{r2l\_lid}" display="inline"><semantics id="S3.SS4.p1.22.m10.1a"><msub id="S3.SS4.p1.22.m10.1.1" xref="S3.SS4.p1.22.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.22.m10.1.1.2" xref="S3.SS4.p1.22.m10.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.22.m10.1.1.3" xref="S3.SS4.p1.22.m10.1.1.3.cmml"><mi id="S3.SS4.p1.22.m10.1.1.3.2" xref="S3.SS4.p1.22.m10.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mn id="S3.SS4.p1.22.m10.1.1.3.3" xref="S3.SS4.p1.22.m10.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1a" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.22.m10.1.1.3.4" xref="S3.SS4.p1.22.m10.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1b" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p1.22.m10.1.1.3.5" xref="S3.SS4.p1.22.m10.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1c" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.22.m10.1.1.3.6" xref="S3.SS4.p1.22.m10.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1d" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.22.m10.1.1.3.7" xref="S3.SS4.p1.22.m10.1.1.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.22.m10.1.1.3.1e" xref="S3.SS4.p1.22.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.22.m10.1.1.3.8" xref="S3.SS4.p1.22.m10.1.1.3.8.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.22.m10.1b"><apply id="S3.SS4.p1.22.m10.1.1.cmml" xref="S3.SS4.p1.22.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.22.m10.1.1.1.cmml" xref="S3.SS4.p1.22.m10.1.1">subscript</csymbol><ci id="S3.SS4.p1.22.m10.1.1.2.cmml" xref="S3.SS4.p1.22.m10.1.1.2">ℒ</ci><apply id="S3.SS4.p1.22.m10.1.1.3.cmml" xref="S3.SS4.p1.22.m10.1.1.3"><times id="S3.SS4.p1.22.m10.1.1.3.1.cmml" xref="S3.SS4.p1.22.m10.1.1.3.1"></times><ci id="S3.SS4.p1.22.m10.1.1.3.2.cmml" xref="S3.SS4.p1.22.m10.1.1.3.2">𝑟</ci><cn type="integer" id="S3.SS4.p1.22.m10.1.1.3.3.cmml" xref="S3.SS4.p1.22.m10.1.1.3.3">2</cn><ci id="S3.SS4.p1.22.m10.1.1.3.4.cmml" xref="S3.SS4.p1.22.m10.1.1.3.4">𝑙</ci><ci id="S3.SS4.p1.22.m10.1.1.3.5.cmml" xref="S3.SS4.p1.22.m10.1.1.3.5">_</ci><ci id="S3.SS4.p1.22.m10.1.1.3.6.cmml" xref="S3.SS4.p1.22.m10.1.1.3.6">𝑙</ci><ci id="S3.SS4.p1.22.m10.1.1.3.7.cmml" xref="S3.SS4.p1.22.m10.1.1.3.7">𝑖</ci><ci id="S3.SS4.p1.22.m10.1.1.3.8.cmml" xref="S3.SS4.p1.22.m10.1.1.3.8">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.22.m10.1c">\mathcal{L}_{r2l\_lid}</annotation></semantics></math> are the LID CE losses of the L2R and the R2L AED model respectively.
<math id="S3.SS4.p1.23.m11.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS4.p1.23.m11.1a"><mi id="S3.SS4.p1.23.m11.1.1" xref="S3.SS4.p1.23.m11.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.23.m11.1b"><ci id="S3.SS4.p1.23.m11.1.1.cmml" xref="S3.SS4.p1.23.m11.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.23.m11.1c">\lambda</annotation></semantics></math> and <math id="S3.SS4.p1.24.m12.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS4.p1.24.m12.1a"><mi id="S3.SS4.p1.24.m12.1.1" xref="S3.SS4.p1.24.m12.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.24.m12.1b"><ci id="S3.SS4.p1.24.m12.1.1.cmml" xref="S3.SS4.p1.24.m12.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.24.m12.1c">\alpha</annotation></semantics></math> are hyper-parameters used to balance different part of losses.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The CS ASR experiments are conducted on the 1160-hour Mandarin-English dataset. This dataset is composed by combining the ASRU 2019 Mandarin-English Code-Switching dataset (ASRU2019 for short)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and the train_clean dataset of LibriSpeech dataset<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
ASRU2019 contains 200-hour code-switching speech and 500-hour Mandarin speech and the train_clean dataset of LibriSpeech contains 460-hour mono-English data.
The test set for the experiments comprises a 20-hour code-switching speech data set from the ASRU2019.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2406.18021/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> (a) A Switch Conformer encoder layer of the proposed SC-MoE. (b) A Switch Transformer decoder layer of the SC-MoE. MA, EN and BK represent Mandarin, English and blank respectively. For simplicity, all skipping connection lines have been omitted.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experimental Setups</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We conducted all experiments on the WeNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> toolkit and adopted the U2++<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> as our backbone.
We used the 80-dimensional log-Mel filter-bank feature as acoustic features for input, and these features were extracted from every speech frame with a frame-length of 25ms and a frame-shift of 10ms. The cepstral mean and variance normalization and SpecAugment<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> are applied in our all experiments.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Our proposed SC-MoE is configured with a 12-layer encoder, a 3-layer left-to-right (L2R) decoder, a 3-layer right-to-left (R2L) decoder and a CTC layer.
The 12-layer encoder comprise a 6-layer standard conformer encoder and a 6-layer switch conformer encoder.
Both L2R and R2L decoders comprise a 1-layer standard transformer decoder and a 2-layer switch transformer decoder.
To demonstrate the effectiveness of the SC-MoE, we select three baseline systems with a similar computational cost for a fair comparison:
(1) NativeConformer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>: 12 stacked conformer encoder layers,
(2) Language-Aware Encoder (LAE)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>: The shared block contains 6 conformer layers , and the language-specific blocks consist of 3 conformer layers each, and
(3) LR-MoE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>: The LR-MoE encoder consists of a 6-layer standard conformer encoder and a 6-layer MLE conformer encoder, where both two FNN layers are all replaced with MLE FNN layer.
All baseline systems adopted U2++ model with a 3-layer L2R decoder and a 3-layer R2L decoder.
According to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, we adopt the first 6-layer conformer encoder layers and/or the first transformer decoder layer of NativeConformer model as pre-trained model to initialize the corresponding layers of the SC-MoE and LR-MoE.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.4" class="ltx_p">All models are trained using Adam optimizer for 120 epochs with warm-up steps of 25k and peak learning rate of 0.001 on 4 GeForce RTX 3090 GPUs. We adopt the training scheme of dynamic chunk and dynamic left chunk with a dynamic batch size of a maximum frames size of 38000 (380s) to train models. In the process of optimizing model parameters, the loss-balanced hyper-parameters are set as follows: <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\lambda</annotation></semantics></math>=0.3, <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\alpha</annotation></semantics></math>=0.3 in training stage, while <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\lambda</annotation></semantics></math>=0.3, <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\alpha</annotation></semantics></math>=0.6 in decoding stage. We averaged the best 10 models based on the loss value as the final model for decoding, and we adopted the decoding strategy of 'attention_rescoring' in WeNet for all our experiments.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Experimental Results</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Comparisons between SC-MoE and Baselines</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3.3 Switch Transformer Decoder ‣ 3 SC-MoE: Our Proposed Model ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> compares the performance of our proposed SC-MoE against three baseline systems under the comparable computational costs.
For a fair comparison with LR-MoE in streaming mode, we excluded the response time of the first packet.
The proposed SC-MoE-Dec-Enc (No.8) demonstrates superior performance compared to three baselines, particularly in mono-English test set, where it achieves an absolute Word Error Rate (WER) reduction of about 2.5%.
Notably, compared to the Switch-Transformer-based LR-MoE (No.3), the SC-MoE-Dec-Enc (No.8) also achieves a relatively significant improvement in both streaming and non-streaming modes.
In streaming mode, our method surpasses NativeConformer by achieving an absolute Character Error Rate (CER) reduction of 0.8% (from 7.95% to 7.15%) for the mono-Mandarin test set, WER reduction of 2.48% (from 30.53% to 28.05%) for the mono-English test set, and Mixed Error Rate (MER) reduction of 0.98% (from 10.40% to 9.42%) for the CS test set.
In non-streaming mode, our method achieves CER/WER/MER of 6.50%/26.36%/8.66%,
which showed to be superior to other models.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Ablation Studies</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">In addition to comparing the performance of our proposed SC-MoE with baseline systems in Table <a href="#S3.T1" title="Table 1 ‣ 3.3 Switch Transformer Decoder ‣ 3 SC-MoE: Our Proposed Model ‣ SC-MoE: Switch Conformer Mixture of Experts for Unified Streaming and Non-streaming Code-Switching ASR" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we further investigated the effectiveness of the streaming MoE layer and the impact of:
Initialization using a pre-trained model,
Different router types, and
MoE layer incorporation in the decoder.</p>
</div>
<div id="S4.SS3.SSS2.p2" class="ltx_para">
<p id="S4.SS3.SSS2.p2.1" class="ltx_p"><span id="S4.SS3.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Streaming MoE layer</span>:
Compared to LR-MoE (No.3), SC-MoE-Enc (No.4) consistently surpasses its performance in both streaming and non-streaming modes.
This suggests that the streaming MoE layer, equipped with an additional blank expert, outperforms LR-MoE's blank replacement rule, facilitating a real-time streaming system.</p>
</div>
<div id="S4.SS3.SSS2.p3" class="ltx_para">
<p id="S4.SS3.SSS2.p3.1" class="ltx_p"><span id="S4.SS3.SSS2.p3.1.1" class="ltx_text ltx_font_bold">Initialization</span>:
Initializing SC-MoE-Enc with a pre-trained model (Rows 6 and 7) leads to an absolute MER reduction of 0.14% and 0.33% for streaming and non-streaming modes, respectively.
This suggests that initialization improves the initial classification performance of the router, indirectly enhancing the CS ASR model's recognition performance.
Notably, even without initialization (No.6), our model outperforms LR-MoE (No.3). Therefore, to achieve comparable recognition performance, our model can eliminate the need for pre-trained models, consequently reducing GPU requirements and shortening training time.</p>
</div>
<div id="S4.SS3.SSS2.p4" class="ltx_para">
<p id="S4.SS3.SSS2.p4.1" class="ltx_p"><span id="S4.SS3.SSS2.p4.1.1" class="ltx_text ltx_font_bold">Router type</span>:
This section investigates the impact of three router configurations on the CS ASR model's performance:
(1) R1: All streaming MoE (sMoE) layers in SC-MoE or all MLE FNN layers in LR-MoE share the same router.
(2) R2: Each sMoE layer in SC-MoE has its own independent router.
(3) R3: Two sMoE layers from the same SC encoder layer share the same router.
Compared to configurations No.4 and No.5, No.7 with R3 consistently achieves the best performance in both streaming and non-streaming modes.
Compared to No.4 with R1, it is suggested that No.7 with R3 mitigates the "one mistake, all mistakes" issue observed in LR-MoE.
</p>
</div>
<div id="S4.SS3.SSS2.p5" class="ltx_para">
<p id="S4.SS3.SSS2.p5.1" class="ltx_p">On the contrary, the performance of the R1 is better than the R3 in LR-MoE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
The blank replacement rule used in LR-MoE likely results in multi-level error propagation, which stems from errors introduced not only by the router itself but also by the inherent limitations of the rule.
In contrast, our SC-MoE (No.7 with R3) avoids error propagation beyond the language identification (LID) module, eliminating the possibility of additional errors introduced by a rule-based approach. Compared to No.5 with R2, No.7 with R3 achieves an absolute MER reduction of 0.21% (streaming) and 0.4% (non-streaming).
R2's slightly lower performance is likely attributable to the two sMoE layers within the same SC encoder layer potentially taking different routing paths for a single sample.</p>
</div>
<div id="S4.SS3.SSS2.p6" class="ltx_para">
<p id="S4.SS3.SSS2.p6.1" class="ltx_p"><span id="S4.SS3.SSS2.p6.1.1" class="ltx_text ltx_font_bold">Decoder with a MoE layer</span>:
Compared to SC-MoE-Enc (No.7), SC-MoE-Enc-Dec (No.8) achieves modest MER reductions in both streaming and non-streaming modes, albeit with a slight CER increase for mono-Mandarin test set in streaming mode.
The results show that introducing MoE layers into the decoder potentially allows for utilizing language-specific text information, mitigating some phonemic confusion issues.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This paper introduces a novel Switch-Conformer-based Mixture of Experts (SC-MoE) model designed for unified streaming and non-streaming Continuous Speech Recognition (CSR) tasks.
To achieve real-time streaming in a LID-CTC loss setting, we propose a streaming MoE layer. As verified in the experimental section, this layer consists of three language experts (Mandarin, English and blank) and a dedicated router.
Experimental results demonstrate that SC-MoE significantly outperforms baseline systems with comparable computational efficiency in both streaming and non-streaming modes.
Notably, in non-streaming mode, our method achieves CER/WER/MER of 6.50%/26.36%/8.66%. In the future, we will explore the effectiveness of our proposed SC-MoE on multilingual ASR.

</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Liu, H. Xu, L. P. Garcia, A. W. H. Khong, Y. He, and S. Khudanpur, ``Reducing language confusion for code-switching speech recognition with token-level language diarization,'' in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
P. Chen, F. Yu, Y. Liang, and et al., ``Ba-moe: Boundary-aware mixture-of-experts adapter for code-switching speech recognition,'' <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Automatic Speech Recognition and Understanding (ASRU)</em>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Z. Fan, L. Dong, C. Shen, Z. Liang, J. Zhang, L. Lu, and Z. Ma, ``Language-specific Boundary Learning for Improving Mandarin-English Code-switching Speech Recognition,'' in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2023</em>, 2023, pp. 3322–3326.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
C. Du, H. Li, Y. Lu, L. Wang, and Y. Qian, ``Data augmentation for end-to-end code-switching speech recognition,'' in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Spoken Language Technology Workshop (SLT)</em>, 2021, pp. 194–200.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Z. Liang, Z. Song, Z. Ma, C. Du, K. Yu, and X. Chen, ``Improving Code-Switching and Name Entity Recognition in ASR with Speech Editing based Data Augmentation,'' in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2023</em>, 2023, pp. 919–923.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
I. Tarunesh, S. Kumar, and P. Jyothi, ``From machine translation to code-switching: Generating high-quality code-switched text,'' in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing</em>.   Association for Computational Linguistics, Aug. 2021, pp. 3154–3169.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
H. Yu, Y. Hu, Y. Qian, M. Jin, L. Liu, S. Liu, Y. Shi, Y. Qian, E. Lin, and M. Zeng, ``Code-switching text generation and injection in mandarin-english asr,'' in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
H. Ke, S. Tara, L. Bo, and et al., ``Improving multilingual and code-switching asr using large language model generated text,'' <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Automatic Speech Recognition and Understanding (ASRU)</em>, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
T. Ogunremi, C. Manning, and D. Jurafsky, ``Multilingual self-supervised speech representations improve the speech recognition of low-resource African languages with codeswitching,'' in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 6th Workshop on Computational Approaches to Linguistic Code-Switching</em>.   Association for Computational Linguistics, Dec. 2023, pp. 83–88.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Kulkarni, A. Kulkarni, M. Couceiro, and H. Aldarmaki, ``Adapting the adapters for code-switching in multilingual ASR,'' <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, p. arXiv.2310.07423, Oct. 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Tian, J. Yu, C. Zhang, Y. Zou, and D. Yu, ``LAE: Language-Aware Encoder for Monolingual and Multilingual ASR,'' in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2022</em>, 2022, pp. 3178–3182.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Ma, W. Wang, Y. Li, Y. Yang, B. Du, and H. Fu, ``LAE-ST-MoE: Boosted Language-Aware Encoder Using Speech Translation Auxiliary Task for E2E Code-switching ASR,'' <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Automatic Speech Recognition and Understanding (ASRU)</em>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
W. Wang, G. Ma, Y. Li, and B. Du, ``Language-Routing Mixture of Experts for Multilingual and Code-Switching Speech Recognition,'' in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2023</em>, 2023, pp. 1389–1393.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
F. Tan, C. Feng, T. Wei, S. Gong, J. Leng, W. Chu, J. Ma, S. Wang, and J. Xiao, ``Improving End-to-End Modeling For Mandarin-English Code-Switching Using Lightweight Switch-Routing Mixture-of-Experts,'' in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2023</em>, 2023, pp. 4224–4228.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y. Lu, M. Huang, H. Li, J. Guo, and Y. Qian, ``Bi-Encoder Transformer Network for Mandarin-English Code-Switching Speech Recognition Using Mixture of Experts,'' in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 4766–4770.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Fedus, B. Zoph, and N. Shazeer, ``Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity,'' <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, vol. 23, no. 120, pp. 1–39, 2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Zhang, Y. Liu, M. Lei, B. Ma, and L. Xie, ``Towards Language-Universal Mandarin-English Speech Recognition,'' in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, 2019, pp. 2170–2174.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Zhou, E. Yılmaz, Y. Long, Y. Li, and H. Li, ``Multi-Encoder-Decoder Transformer for Code-Switching Speech Recognition,'' in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 1042–1046.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. Song, Q. Xu, M. Ge, L. Wang, H. Shi, Y. Lv, Y. Lin, and J. Dang, ``Language-specific Characteristic Assistance for Code-switching Speech Recognition,'' in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2022</em>, 2022, pp. 3924–3928.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Kwon and S.-W. Chung, ``Mole : Mixture of language experts for multi-lingual automatic speech recognition,'' in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2023, pp. 1–5.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
K. Hu, B. Li, T. N. Sainath, Y. Zhang, and F. Beaufays, ``Mixture-of-expert conformer for streaming multilingual asr,'' <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2305.15663, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
D. Wu, B. Zhang, C. Yang, Z. Peng, W. Xia, X. Chen, and X. Lei, ``U2++: Unified two-pass bidirectional end-to-end model for speech recognition,'' <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2106.05642, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
S. Watanabe, T. Hori, S. Kim, J. R. Hershey, and T. Hayashi, ``Hybrid ctc/attention architecture for end-to-end speech recognition,'' <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, vol. 11, no. 8, p. 1240–1253, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Gulati, J. Qin, C.-C. Chiu, N. Parmar, Y. Zhang, J. Yu, W. Han, S. Wang, Z. Zhang, Y. Wu, and R. Pang, ``Conformer: Convolution-augmented Transformer for Speech Recognition,'' in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2020</em>, 2020, pp. 5036–5040.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Graves, ``Connectionist temporal classification : labelling unsegmented sequence data with recurrent neural networks,'' <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. on Machine Learning, 2006</em>, 2006.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
X. Shi, Q. Feng, and L. Xie, ``The asru 2019 mandarin-english code-switching speech recognition challenge: Open datasets, tracks, methods and results,'' <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proc. WSTCSMC</em>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
V. Panayotov, G. Chen, D. Povey, and S. Khudanpur, ``Librispeech: An asr corpus based on public domain audio books,'' <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. ICASSP</em>, 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Yao, D. Wu, X. Wang, B. Zhang, F. Yu, C. Yang, Z. Peng, X. Chen, L. Xie, and X. Lei, ``Wenet: Production oriented streaming and non-streaming end-to-end speech recognition toolkit,'' in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech</em>, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
D. S. Park, W. Chan, Y. Zhang, C.-C. Chiu, B. Zoph, E. D. Cubuk, and Q. V. Le, ``SpecAugment: A Simple Data Augmentation Method for Automatic Speech Recognition,'' in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2019</em>, 2019, pp. 2613–2617.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
D. Wang, S. Ye, X. Hu, S. Li, and X. Xu, ``An End-to-End Dialect Identification System with Transfer Learning from a Multilingual Automatic Speech Recognition Model,'' in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. Interspeech 2021</em>, 2021, pp. 3266–3270.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="{Under review}"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.18020" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.18021" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.18021">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.18021" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.18022" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Jul  6 00:41:30 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
